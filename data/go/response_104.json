[{"tags": ["go", "phantomjs"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1483577499, "post_id": 41475212, "comment_id": 70157337, "body": "Not sure how easy it is, but it&#39;s possible using <a href=\"https://github.com/fedesog/webdriver\" rel=\"nofollow noreferrer\">webdriver</a> <a href=\"https://gowalker.org/github.com/fedesog/webdriver#Session_Screenshot\" rel=\"nofollow noreferrer\">see also</a>"}, {"owner": {"reputation": 1435, "user_id": 846797, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bf19fe005057ebe6d21f377ac1b5caf5?s=128&d=identicon&r=PG", "display_name": "Ashwini Khare", "link": "https://stackoverflow.com/users/846797/ashwini-khare"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1483640126, "post_id": 41475212, "comment_id": 70189672, "body": "That&#39;s an interesting alternative. How does it comparable to selenium webdriver?"}], "answers": [{"comments": [{"owner": {"reputation": 1435, "user_id": 846797, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bf19fe005057ebe6d21f377ac1b5caf5?s=128&d=identicon&r=PG", "display_name": "Ashwini Khare", "link": "https://stackoverflow.com/users/846797/ashwini-khare"}, "edited": false, "score": 0, "creation_date": 1483640204, "post_id": 41483982, "comment_id": 70189717, "body": "Thanks. I believe this package makes an assumption of the source code being available to the developer, which might not always be the case"}], "tags": [], "owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "is_accepted": false, "score": 0, "last_activity_date": 1483615924, "creation_date": 1483615924, "answer_id": 41483982, "question_id": 41475212, "link": "https://stackoverflow.com/questions/41475212/webpage-screen-capture-using-go/41483982#41483982", "title": "Webpage screen capture using go", "body": "<p>Not sure about any GO package , but you can do it using <a href=\"http://wkhtmltopdf.org/\" rel=\"nofollow noreferrer\">wkhtmltopdf</a> in your Golang code.. </p>\n"}], "owner": {"reputation": 1435, "user_id": 846797, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bf19fe005057ebe6d21f377ac1b5caf5?s=128&d=identicon&r=PG", "display_name": "Ashwini Khare", "link": "https://stackoverflow.com/users/846797/ashwini-khare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483615924, "creation_date": 1483574271, "question_id": 41475212, "link": "https://stackoverflow.com/questions/41475212/webpage-screen-capture-using-go", "title": "Webpage screen capture using go", "body": "<p>I'm porting a screen capture module from Node.Js to Go. The existing module was used to screen capture a webpage. The existing module used <a href=\"https://github.com/amir20/phantomjs-node\" rel=\"nofollow noreferrer\">node-phantom</a> library written on top of phantomjs. Is there a similar alternative available for go? Or is there any alternative better approach to do so?</p>\n\n<p>There seems to exist one <a href=\"https://github.com/urturn/go-phantomjs/\" rel=\"nofollow noreferrer\">lightweight wrapper</a>, but it doesn't expose the methods which the node library does. </p>\n\n<p>This is more of a explorative question. We just need some information before we decide to invest time in it.</p>\n"}, {"tags": ["multithreading", "go", "channel"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1483574304, "post_id": 41474828, "comment_id": 70156469, "body": "Why not have a queue and goroutine for each listener? When a message comes in, you put it on whatever queues are appropriate, and the goroutine for each listener sends the messages when it&#39;s able to do so."}, {"owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1483575450, "post_id": 41474828, "comment_id": 70156796, "body": "Yeah, could work.  I guess that eliminates the sequence problem and makes it so the queue of waiting messages is explicit rather than just waiting to overflow the channel cap."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1483581464, "post_id": 41474828, "comment_id": 70158345, "body": "A generalization of the <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat#hub\" rel=\"nofollow noreferrer\">gorilla chat example</a> might meet your needs.  The chat example is written for websockets, but the core hub has little knowledge that it&#39;s working with websockets."}], "owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483571720, "creation_date": 1483571720, "question_id": 41474828, "link": "https://stackoverflow.com/questions/41474828/how-to-properly-clean-up-a-go-channel-with-lots-of-sends-waiting-on-it", "title": "how to properly clean up a Go channel with lots of sends waiting on it", "body": "<p>I have code that needs to deliver a message (called HintInfo in the sample below) to any number of listeners.  These <strong>listeners will be attached to web or other clients and thus can be volatile - they can freeze up, time out and disappear, etc.  I'm trying to make sure I have a good pattern for how to reliably manage the life cycle on this.</strong>   What I've come up with is shown below.  The basic concept is that a <strong>map of channels is kept that corresponds to each of the listeners.  Listeners are added or removed atomically using an RWMutex.  Sending to these channels is done with a read lock, and a regular synchronous channel send is attempted first.  If this doesn't work, a separate goroutine is launched which blocks until the message can be sent to that channel.</strong>  It is conceivable that thousands of messages could rapidly stack up for a client that is blocked for, let's say a few minutes.  I want to make sure this doesn't cause a leak of some sort. The idea here is that when a message comes in, it gets delivered to all channels right away, even if one or more of them is full.  Sending is attempted without a separate goroutine first in order to preserve sequence, but when queues fill up later messages will still arrive but possibly out of sequence because a bunch of channel sends in separate goroutines I'm pretty sure have no predictable delivery sequence - this is an acceptable trade-off for my application.</p>\n\n<p>A listener is responsible for ensuring that the channel it used is released (by calling ReleaseRecvChannel() ).  This gets a write lock and <strong>calls close() on the channel, causing any goroutines that are blocking for a write to panic, which they recover() from and ignore.</strong>  That should ensure things are properly cleaned up, effectively loosing any undelivered messages for that listener (which is fine, since the listener disconnected, that's the logic course of action).</p>\n\n<p>My question is really just if anyone sees a better way or a problem with this approach.  I think this will work, but it's a bit of a tricky problem and I wanted to see if there was something I'm missing.</p>\n\n<pre><code>type HintInfo struct { /* ... */ }\n\ntype hintFanout struct {\n    hintChs map[chan HintInfo]struct{}\n    l       sync.RWMutex\n}\n\nfunc (hf *hintFanout) deliver(hi HintInfo) {\n    hf.l.RLock()\n    defer hf.l.RUnlock()\n    for ch := range hf.hintChs {\n        // try synchronous send\n        select {\n        case ch &lt;- hi:\n        default:\n            // can't send right now do it in another goroutine\n            go func(ch chan HintInfo) {\n                defer func() { recover() }() // if send panics we ignore it\n                ch &lt;- hi\n            }(ch)\n        }\n    }\n}\n\nfunc (hf *hintFanout) GetRecvChannel() chan HintInfo {\n    hf.l.Lock()\n    defer hf.l.Unlock()\n    ch := make(chan HintInfo, 4096)\n    hf.hintChs[ch] = struct{}{}\n    return ch\n}\n\nfunc (hf *hintFanout) ReleaseRecvChannel(ch chan HintInfo) {\n    hf.l.Lock()\n    defer hf.l.Unlock()\n    // since we have a write lock, there will be no deliver() calls\n    // in progress right now (only possibly old goroutines trying to\n    // send to a full channel)\n    delete(hf.hintChs, ch)\n    close(ch) // this will cause any goroutines waiting for a channel send to panic\n}\n</code></pre>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1483570773, "post_id": 41474638, "comment_id": 70155262, "body": "See <a href=\"https://github.com/golang/go/issues/11724\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/11724</a>"}, {"owner": {"reputation": 3446, "user_id": 540981, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LTwr5.jpg?s=128&g=1", "display_name": "Danish", "link": "https://stackoverflow.com/users/540981/danish"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483629997, "post_id": 41474638, "comment_id": 70182719, "body": "@JimB thank you for sharing that. I&#39;m happy to accept any hack or temporary fix cause I have no control over the source XML. I tried reading it into an array of descriptions. At Least I get both the values."}], "answers": [{"tags": [], "owner": {"reputation": 3446, "user_id": 540981, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LTwr5.jpg?s=128&g=1", "display_name": "Danish", "link": "https://stackoverflow.com/users/540981/danish"}, "is_accepted": true, "score": 0, "last_activity_date": 1483741688, "creation_date": 1483741688, "answer_id": 41515388, "question_id": 41474638, "link": "https://stackoverflow.com/questions/41474638/how-to-deserialize-same-xml-element-with-different-namespace-into-different-elem/41515388#41515388", "title": "How to deserialize same XML Element with different namespace into different elements in a struct", "body": "<p>So Go currently is not able to support this (as pointed out by @JimB), but you can still use some built in capabilities to pull out the right element. Start off by defining a new struct <code>XMLElement</code></p>\n\n<pre><code>type XMLElement struct {\n    XMLName xml.Name\n    Data    string `xml:\",chardata\"`\n}\n</code></pre>\n\n<p>This struct can capture the xml data along with the namespace and element name. Next map <code>xml:\"description\"</code> to an array of <code>XMLElement</code>. This will end up capturing all <code>&lt;*:description&gt;</code> elements in a list. You can then define functions to pull out the right one.</p>\n\n<pre><code>type Item struct {\n    // ...other fields\n    Descriptions           []XMLElement   `xml:\"description\"`\n    // ...other fields\n}\n\n// GetDescription returns the description in the &lt;description&gt; tag\nfunc (i *Item) GetDescription() string {\n    for _, elem := range i.Descriptions {\n        if elem.XMLName.Space == \"\" {\n            return elem.Data\n        }\n    }\n    return \"\"\n}\n\n// GetMediaDescription returns the description in the &lt;media:description&gt; tag\nfunc (i *Item) GetMediaDescription() string {\n    for _, elem := range i.Descriptions {\n        if elem.XMLName.Space == \"http://search.yahoo.com/mrss/\" {\n            return elem.Data\n        }\n    }\n    return \"\"\n}\n</code></pre>\n"}], "owner": {"reputation": 3446, "user_id": 540981, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LTwr5.jpg?s=128&g=1", "display_name": "Danish", "link": "https://stackoverflow.com/users/540981/danish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 41515388, "answer_count": 1, "score": 1, "last_activity_date": 1483741688, "creation_date": 1483570650, "question_id": 41474638, "link": "https://stackoverflow.com/questions/41474638/how-to-deserialize-same-xml-element-with-different-namespace-into-different-elem", "title": "How to deserialize same XML Element with different namespace into different elements in a struct", "body": "<p>I am working with the following kind of an XML structure</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;rss version=\"2.0\" \n    xmlns:content=\"http://purl.org/rss/1.0/modules/content/\" \n    xmlns:media=\"http://search.yahoo.com/mrss/\"&gt;\n    &lt;channel&gt;\n        &lt;title&gt;TITLE&lt;/title&gt;\n        &lt;link&gt;http://something.com&lt;/link&gt;\n        &lt;description&gt;description&lt;/description&gt;\n        &lt;lastBuildDate&gt;Mon, 19 Dec 2016 16:48:54 +0000&lt;/lastBuildDate&gt;\n        &lt;language&gt;en&lt;/language&gt;\n        &lt;item&gt;\n            &lt;title&gt;Title&lt;/title&gt;\n            &lt;description&gt;description&lt;/description&gt;\n            &lt;author&gt;\n                &lt;name&gt;Name&lt;/name&gt;\n                &lt;uri&gt;&lt;/uri&gt;\n            &lt;/author&gt;\n            &lt;pubDate&gt;Mon, 19 Dec 2016 16:42:32 +0000&lt;/pubDate&gt;\n            &lt;link&gt;http://google.com&lt;/link&gt;\n            &lt;image&gt;...&lt;/image&gt;\n            &lt;media:description&gt;&lt;![CDATA[Natalie Massenet]]&gt;&lt;/media:description&gt;\n            &lt;media:credit&gt;David Fisher/REX/Shutterstock&lt;/media:credit&gt;\n            &lt;category&gt;Category1&lt;/category&gt;\n            &lt;category&gt;Category2&lt;/category&gt;\n            &lt;guid isPermaLink=\"false\"&gt;http://something.com/?p=10730393&lt;/guid&gt;\n            &lt;media:group&gt;&lt;/media:group&gt;\n            &lt;content:encoded&gt;content&lt;/content:encoded&gt;\n        &lt;/item&gt;\n    &lt;/channel&gt;\n&lt;/rss&gt;\n</code></pre>\n\n<p>I am having trouble figuring out how to deserialize <code>&lt;description&gt;</code> and <code>&lt;media:description&gt;</code> into two different element in a struct.</p>\n\n<p>I've tried a following kind of a struct to represent an <code>&lt;item&gt;</code>, but the value of <code>media:description</code> ends up in the struct.</p>\n\n<pre><code>type Item struct {\n    // ...other fields\n    Description           string   `xml:\"description\"`\n    MediaDescription      string   `xml:\"media:description\"`\n    // ...other fields\n}\n</code></pre>\n\n<p>What would be the best way to do this?</p>\n"}, {"tags": ["go", "des"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483569490, "post_id": 41474308, "comment_id": 70154743, "body": "please show an example of what you&#39;re trying to do. Using aes and des in the Go cipher package looks nearly identical."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483569733, "post_id": 41474308, "comment_id": 70154832, "body": "Also, how do you have an IV of 32 bytes, when a DES block is only 8 bytes?"}, {"owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483592608, "post_id": 41474308, "comment_id": 70160791, "body": "@JimB The following <a href=\"https://play.golang.org/p/0etXPnCaye\" rel=\"nofollow noreferrer\">code</a> executes, but this is not how I want to implement DES. I am facing two issues. First, the     <b>key</b>     variable throws an error when it is larger than 8 bytes. I would like to be able to specify a     <b>key</b>    in the following format: &quot;2ybc, 2ybc, 2ybc, 2ybc, 2ybc, 2ybc, 2ybc, 2ybc&quot;. Second, the     <b>iv</b>     variable throws an error because     <b>iv</b>    length must equal block size. I would like to be able to specify     <b>iv</b>   in the same format as the key:  &quot;2ybc, 2ybc, 2ybc, 2ybc, 2ybc, 2ybc, 2ybc, 2ybc&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483624214, "post_id": 41474308, "comment_id": 70178556, "body": "You can&#39;t change the key an iv sizes, those are specified by the cipher algorithm."}, {"owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483625197, "post_id": 41474308, "comment_id": 70179257, "body": "@JimB correction on the format. Instead of 2ybc it should read as 0xBC, as in Hex. So, I need to figure out how to encode... which I am going to try as []byte(0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC)."}, {"owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483627471, "post_id": 41474308, "comment_id": 70180931, "body": "@JimB alright, so I am getting closer. I figured out that I was suppose specify the key and iv as []byte{0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC, 0xBC}. Even though the <a href=\"https://play.golang.org/p/g86TgoUf6P\" rel=\"nofollow noreferrer\">code</a> runs, it is not encrypting or decrypting correctly."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483628222, "post_id": 41474308, "comment_id": 70181453, "body": "You&#39;re using a random IV for encryption (which is good, though there&#39;s no reason for the literal values you&#39;re going to overwrite), you&#39;re not prepending the IV to the ciphertext, and you&#39;re trying to use <code>\\xbc\\xbc\\xbc\\xbc\\xbc\\xbc\\xbc\\xbc</code> for the decryption IV rather than anything prepended to the ciphertext."}, {"owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483631009, "post_id": 41474308, "comment_id": 70183467, "body": "@JimB I commented out the random IV in the following <a href=\"https://play.golang.org/p/gIee9raIQV\" rel=\"nofollow noreferrer\">code</a> and now the decryption is working. However, the encrypted string is not what I am expecting. I do not know how to prepend the IV to the ciphertext."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1483631438, "post_id": 41474308, "comment_id": 70183806, "body": "Just copy the iv to the ciphertext slice, and use that portion for decryption, which is the whole reason for prepending it: <a href=\"https://play.golang.org/p/9Qi7y8f-ha\" rel=\"nofollow noreferrer\">play.golang.org/p/9Qi7y8f-ha</a>"}], "answers": [{"tags": [], "owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1483738609, "last_edit_date": 1495542834, "creation_date": 1483738609, "answer_id": 41514759, "question_id": 41474308, "link": "https://stackoverflow.com/questions/41474308/how-do-you-prepend-an-iv-to-the-ciphertext-in-go/41514759#41514759", "title": "How do you prepend an IV to the ciphertext in Go?", "body": "<p>@JimB thank you for your clarifications! I ended up rewording the question <a href=\"https://stackoverflow.com/questions/41490851/golang-how-do-i-encrypt-plain-text-that-is-5-characters-long-with-des-and-cbc?noredirect=1#comment70188445_41490851\">here</a> and found my answer.</p>\n"}], "owner": {"reputation": 376, "user_id": 4021006, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/TV7qH.jpg?s=128&g=1", "display_name": "phil o.O", "link": "https://stackoverflow.com/users/4021006/phil-o-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1483738609, "creation_date": 1483569008, "last_edit_date": 1483630757, "question_id": 41474308, "link": "https://stackoverflow.com/questions/41474308/how-do-you-prepend-an-iv-to-the-ciphertext-in-go", "title": "How do you prepend an IV to the ciphertext in Go?", "body": "<p>I would really appreciate the help. I have the following <a href=\"https://play.golang.org/p/gIee9raIQV\" rel=\"nofollow noreferrer\">code</a> running. Unfortunately, I do not understand how to properly prepend the IV to the ciphertext. Line 1 is the plaintext. Line 2 is the encrypted plaintext in terms of DES (which is wrong). Line 3 is the decryption of Line 2.</p>\n\n<p><code>**output** \n1  Yolandi Visser\n2  AAAAAAAAAAAfiIMmXF4ZPYOcypF5JA== \n3  Yolandi Visser</code></p>\n"}, {"tags": ["go", "range", "render"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 2, "creation_date": 1483590555, "post_id": 41474143, "comment_id": 70160315, "body": "don&#39;t use iris <a href=\"http://www.florinpatan.ro/2016/10/why-you-should-not-use-iris-for-your-go.html\" rel=\"nofollow noreferrer\">florinpatan.ro/2016/10/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483624730, "post_id": 41474143, "comment_id": 70178915, "body": "You&#39;re not going to find much help for iris in the Go community, when the author of the project refuses to be a responsible member of that community."}], "owner": {"reputation": 133, "user_id": 1519258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd0bb6bc7bab7b9cb7c49c990129d9d9?s=128&d=identicon&r=PG", "display_name": "Johan", "link": "https://stackoverflow.com/users/1519258/johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483568177, "creation_date": 1483568177, "question_id": 41474143, "link": "https://stackoverflow.com/questions/41474143/golang-iris-framework-render-inside-a-range", "title": "Golang iris framework render inside a range", "body": "<p>I'm trying to loop over items and render it in separate template, but <code>{{ . }}</code> in <code>item.html</code> contains root variables instead of a single item. I tried to assign item to a variable <code>{{ range $i, $item := .Items }}</code>, but the result is the same.</p>\n\n<pre><code>&lt;!-- list.html --&gt;\n{{ range .Items }}\n    {{ . }} this one is OK\n    {{ render \"item.html\" }}\n{{ end }}\n\n&lt;!-- item.html --&gt;\n{{ . }} this one is not\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483557271, "post_id": 41471313, "comment_id": 70148870, "body": "Just keep a separate bootstrap binary in <code>GOROOT_BOOTSTRAP</code> (outside of <code>GOROOT</code>) and use that every time."}, {"owner": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "edited": false, "score": 0, "creation_date": 1483557298, "post_id": 41471313, "comment_id": 70148886, "body": "could you just run the binary at the location it lives instead of modifying your path, e.g. <code>~&#47;yyyy&#47;go build</code>"}, {"owner": {"reputation": 25, "user_id": 6854075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af21988ec5eca528d6c015070e46f86?s=128&d=identicon&r=PG", "display_name": "basilest", "link": "https://stackoverflow.com/users/6854075/basilest"}, "edited": false, "score": 0, "creation_date": 1483560701, "post_id": 41471313, "comment_id": 70150560, "body": "Thank you very much to all. The <code>go build</code> solution seems to fix my issue. Yes, I could keep a separate bootstrap bin, but it would miss all the new commits, maybe some are bug fixes, and I admit to be quite paranoid on this. Thanks a lot again"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483562764, "post_id": 41471313, "comment_id": 70151581, "body": "@basilest: new commits are irrelevant for the bootstrap compiler (unless you can&#39;t build at all), because you&#39;re building a new compiler each time, so all packages are always built by the latest compiler. <code>GOROOT_BOOTSTRAP</code> is only for bootstrapping, and nothing else."}, {"owner": {"reputation": 73, "user_id": 7089948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b698d69d840aa93f31d5d93bbb59de4?s=128&d=identicon&r=PG&f=1", "display_name": "Chudong", "link": "https://stackoverflow.com/users/7089948/chudong"}, "edited": false, "score": 0, "creation_date": 1613948822, "post_id": 41471313, "comment_id": 117226879, "body": "@basilest: Would you be able to help my issue in <a href=\"https://stackoverflow.com/questions/66306514/problem-building-the-go-compiler-from-source\" title=\"problem building the go compiler from source\">stackoverflow.com/questions/66306514/&hellip;</a>? Thx."}], "owner": {"reputation": 25, "user_id": 6854075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af21988ec5eca528d6c015070e46f86?s=128&d=identicon&r=PG", "display_name": "basilest", "link": "https://stackoverflow.com/users/6854075/basilest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483556241, "creation_date": 1483556241, "question_id": 41471313, "link": "https://stackoverflow.com/questions/41471313/compile-go-source-code-on-regular-intervals", "title": "Compile GO source code (on regular intervals)", "body": "<p>I have a GO compiler available (i.e. installed in a dir <code>~/xxxx/bin/go</code>).</p>\n\n<p>Suppose to call this version <strong>GO.1</strong></p>\n\n<p>I now clone the GO repository from GitHub (ex. into <code>~/yyyy/</code>)</p>\n\n<p>Setting <code>$GOROOT_BOOTSTRAP=~/xxxx/</code> I can compile it\nas <code>cd ~/yyyy/src &amp;&amp; ./all.bash</code>\nobtaining the GO binary in <code>~/yyyy/bin</code> (Suppose to call this <strong>GO.2</strong>)</p>\n\n<p>I'd like now to use this new <strong>GO.2</strong> binary <code>~/yyyy/bin/go</code> to recompile its new source (<code>~/yyyy/src</code>) having a final 'good' <strong>GO.3</strong></p>\n\n<p>I cannot just set <code>$GOROOT_BOOTSTRAP</code> to <code>~/yyyy/</code> or play with some others env vars (at least I tried many attempts with no success). </p>\n\n<p>The only way I've found to do this is:</p>\n\n<ol>\n<li><p>copy  <code>~/yyyy/</code> (about 800MB!) onto <code>~/xxxx/</code> (so that <strong>GO.2</strong>\noverwrites <strong>GO.1</strong> and the <code>$GOROOT_BOOTSTRAP</code> is unchanged)</p></li>\n<li><p>redo <code>cd ~/yyyy/src &amp;&amp; ./all.bash</code></p></li>\n</ol>\n\n<p>This cannot be the expected behaviour.\nI'd like to have the most up-to-date binary <strong>GO.x</strong> just with a <code>git pull &amp;&amp; cd ./src &amp;&amp; ./all.bash</code> and no much more than this.</p>\n\n<p>Any hint is welcome.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1483556178, "post_id": 41471236, "comment_id": 70148227, "body": "I don&#39;t understand what it&#39;s talking about either. The phrase &quot;passed by reference&quot; in a Go book is strange too, since all values in Go are passed by value."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483556283, "post_id": 41471236, "comment_id": 70148282, "body": "Well, the example is passing a pointer. I think that&#39;s what he means by passing by reference. Because although the pointer is copied, but the copy is still pointing to the same memory."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1483556368, "post_id": 41471236, "comment_id": 70148332, "body": "The example isn&#39;t passing a pointer anywhere, it&#39;s dereferencing the pointer and passing the int value (and &quot;pass by reference&quot; has a meaning separate from &quot;passing a pointer value&quot;)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1483562696, "post_id": 41471236, "comment_id": 70151548, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31404471/defer-usage-clarification/31404704#31404704\">Defer usage clarification</a>; and <a href=\"http://stackoverflow.com/questions/28893586/golang-defer-clarification/28894103#28894103\">Golang defer clarification</a>."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483564478, "post_id": 41471236, "comment_id": 70152393, "body": "@JimB Right you are! That was me not paying attention. But that&#39;s beside the point. I think the answer from AJcodez clarified this."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1483638722, "post_id": 41471236, "comment_id": 70188805, "body": "What is the negative vote for? Is this not a right question?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1483655557, "post_id": 41471236, "comment_id": 70197966, "body": "I have a feeling what the author meant is that, if you passed <code>aValue</code> rather than <code>*aValue</code>, since you&#39;re passing in a reference (ok, a pointer by value, but pedantry aside, you&#39;re effectively passing in a reference to the underlying integer), that integer&#39;s value may change before the deferred function is called, and thus have a different value (be in an unexpected state) than it did when you deferred the function."}], "answers": [{"comments": [{"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1483564134, "post_id": 41471718, "comment_id": 70152224, "body": "I&#39;m aware of that. Thanks. But this isn&#39;t the answer to my question. I&#39;m wondering what the author is trying to point out."}], "tags": [], "owner": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "is_accepted": false, "score": 2, "last_activity_date": 1483557744, "creation_date": 1483557744, "answer_id": 41471718, "question_id": 41471236, "link": "https://stackoverflow.com/questions/41471236/data-passed-by-reference-to-defer/41471718#41471718", "title": "Data passed by reference to &quot;defer&quot;", "body": "<p>The defer statement is \"evaluating\" the parameters and saving the result, and the result of evaluating <code>*aValue</code> is 0 at the time of the defer call. Something like this may be what you're looking for:</p>\n\n<pre><code>func main() {\n    aValue := new(int)\n    defer func() { fmt.Println(*aValue) }()\n\n    for i := 0; i &lt; 100; i++ {\n        *aValue++\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1483564967, "post_id": 41472775, "comment_id": 70152646, "body": "Although this is explaining what I already mentioned in the question (how parameters are evaluated), but the use of struct point out what the author might have been trying to say."}, {"owner": {"reputation": 8119, "user_id": 1698887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe33350fa65be5a2630271b0782b0096?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/1698887/daniel-williams"}, "edited": false, "score": 0, "creation_date": 1483568564, "post_id": 41472775, "comment_id": 70154362, "body": "There are some other gotchas with defers. The reference to the called function is saved. All parameters are evaluated and saved (so if you make other function calls as parameters they will execute immediately not after execution)."}], "tags": [], "owner": {"reputation": 26092, "user_id": 824377, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e600bd229c588891a7616f303e30efd9?s=128&d=identicon&r=PG", "display_name": "AJcodez", "link": "https://stackoverflow.com/users/824377/ajcodez"}, "is_accepted": true, "score": 2, "last_activity_date": 1483562150, "creation_date": 1483562150, "answer_id": 41472775, "question_id": 41471236, "link": "https://stackoverflow.com/questions/41471236/data-passed-by-reference-to-defer/41472775#41472775", "title": "Data passed by reference to &quot;defer&quot;", "body": "<p>Consider a situation using structs.</p>\n\n<pre><code>type User struct {\n    Name string\n}\n\nfunc main() {\n    user := User{}\n    defer fmt.Printf(\"%#v\\n\", user)\n    user.Name = \"AJ\"\n}\n</code></pre>\n\n<p>You know <code>defer</code> should run at the end, so you might expect to see <code>User{Name: \"AJ\"}</code> but instead you get <code>User{Name: \"\"}</code> because <code>defer</code> binds parameters. </p>\n\n<p>If you use a pointer it works.</p>\n\n<pre><code>    user := &amp;User{}\n</code></pre>\n\n<p>If you use a closure, it works. </p>\n\n<pre><code>    defer func() {\n        fmt.Printf(\"%#v\\n\", user)\n    }()\n</code></pre>\n"}], "owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 2, "accepted_answer_id": 41472775, "answer_count": 2, "score": 1, "last_activity_date": 1483562150, "creation_date": 1483556005, "question_id": 41471236, "link": "https://stackoverflow.com/questions/41471236/data-passed-by-reference-to-defer", "title": "Data passed by reference to &quot;defer&quot;", "body": "<p>There is a passage in the \"Mastering Concurrency in Go\" book which made me think I might be missing something about \"defer\" functions. </p>\n\n<p><em>You should also take note that any data <strong>passed by reference</strong> may be in an unexpected state.</em></p>\n\n<pre><code>func main() {\n    aValue := new(int)\n    defer fmt.Println(*aValue)\n\n    for i := 0; i &lt; 100; i++ {\n         *aValue++\n    }\n}\n</code></pre>\n\n<p>This prints 0, I thought, because according to spec:</p>\n\n<blockquote>\n  <p>Each time a \"defer\" statement executes, the function value and <strong>parameters</strong> to the call are evaluated as usual and saved anew</p>\n</blockquote>\n\n<p>That is, *aValue is 0 when defer is called and that's why at the end it prints 0. Whether or not a pointer is passed to the differ function in this case is irrelevant. </p>\n\n<p>Is my understanding correct or am I missing something?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 2810, "user_id": 3594657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Otook.png?s=128&g=1", "display_name": "Sethmr", "link": "https://stackoverflow.com/users/3594657/sethmr"}, "edited": false, "score": 0, "creation_date": 1483548817, "post_id": 41468968, "comment_id": 70144062, "body": "You need to add code showing what you have tried. Check out <a href=\"http://stackoverflow.com/help/how-to-answer\">how to write an anser</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3080, "user_id": 3293987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck5de.jpg?s=128&g=1", "display_name": "Quixrick", "link": "https://stackoverflow.com/users/3293987/quixrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1483548347, "creation_date": 1483548347, "answer_id": 41469091, "question_id": 41468968, "link": "https://stackoverflow.com/questions/41468968/golang-regexp-for-matching-characters-till-a-string-excluding-substrings/41469091#41469091", "title": "Golang regExp for matching characters till a string ( excluding substrings)", "body": "<p>I'm not sure that I understand exactly what it is you are wanting, but I can probably get you on the right track.</p>\n\n<p>If you want to match a string that has an <code>a</code>, followed by some word characters, followed by <code>ccc</code>, then you can simply use something like this:</p>\n\n<pre><code>a\\w+ccc\n</code></pre>\n\n<p>If you want the string to start and end with <code>a</code> and <code>ccc</code> respectively, you can do something like this:</p>\n\n<pre><code>^a\\w+ccc$\n</code></pre>\n\n<p>If you want to only allow specific characters like lowercase letters, you can put them into a character class like this:</p>\n\n<pre><code>a[a-z]+ccc\n</code></pre>\n\n<p>Hopefully one of those answers your question.</p>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1483555843, "creation_date": 1483555843, "answer_id": 41471188, "question_id": 41468968, "link": "https://stackoverflow.com/questions/41468968/golang-regexp-for-matching-characters-till-a-string-excluding-substrings/41471188#41471188", "title": "Golang regExp for matching characters till a string ( excluding substrings)", "body": "<p>It all depends on what do you exactly mean with \"all characters\"... it could include or not character sets such as whitespace (optionally including newlines), letters, numbers, symbols, unicode sets, etc.</p>\n\n<p>So... </p>\n\n<p>If you really meant \"all characters\" (i.e. including whitespace) between the first \"a\" and \"ccc\" you need to use:</p>\n\n<pre><code>a.+ccc\n</code></pre>\n\n<p>If you meant just all \"word characters\" you can use one of these:</p>\n\n<pre><code>a\\w+ccc\na[0-9a-zA-Z_]+ccc\n</code></pre>\n\n<p>All letters:</p>\n\n<pre><code>a[a-zA-Z]+ccc\n</code></pre>\n\n<p>All lowcase letters:</p>\n\n<pre><code>a[a-z]+ccc\n</code></pre>\n\n<p>...and there will be more options depending on your real requirements for that definition.</p>\n\n<p>Here you have a small program to test some of that cases:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"regexp\"\n\nfunc main() {\n        res := []string{\n                `a.+ccc`,\n                `a\\w+ccc`,\n                `a[a-z]+ccc`,\n        }\n        ss := []string{\n                \"ablablacccc\",\n                \"adadasdccc\",\n                \"sadlkasdlkcccc\",\n                \"accc\",\n                \"blaafoewoiccc\",\n                \"oirorwccc\",\n                \"abla ablaccc\",\n        }\n        for _, re := range res {\n                r := regexp.MustCompile(re)\n                fmt.Printf(\"regular expression: %q\\n\", re)\n                for _, s := range ss {\n                        fmt.Printf(\"    case %q: matches=%v match=%q\\n\", s, r.MatchString(s), r.FindString(s))\n                }\n        }\n}\n</code></pre>\n\n<p>And the output it produces:</p>\n\n<pre><code>regular expression: \"a.+ccc\"\n    case \"ablablacccc\": matches=true match=\"ablablacccc\"\n    case \"adadasdccc\": matches=true match=\"adadasdccc\"\n    case \"sadlkasdlkcccc\": matches=true match=\"adlkasdlkcccc\"\n    case \"accc\": matches=false match=\"\"\n    case \"blaafoewoiccc\": matches=true match=\"aafoewoiccc\"\n    case \"oirorwccc\": matches=false match=\"\"\n    case \"abla ablaccc\": matches=true match=\"abla ablaccc\"\nregular expression: \"a\\\\w+ccc\"\n    case \"ablablacccc\": matches=true match=\"ablablacccc\"\n    case \"adadasdccc\": matches=true match=\"adadasdccc\"\n    case \"sadlkasdlkcccc\": matches=true match=\"adlkasdlkcccc\"\n    case \"accc\": matches=false match=\"\"\n    case \"blaafoewoiccc\": matches=true match=\"aafoewoiccc\"\n    case \"oirorwccc\": matches=false match=\"\"\n    case \"abla ablaccc\": matches=true match=\"ablaccc\"\nregular expression: \"a[a-z]+ccc\"\n    case \"ablablacccc\": matches=true match=\"ablablacccc\"\n    case \"adadasdccc\": matches=true match=\"adadasdccc\"\n    case \"sadlkasdlkcccc\": matches=true match=\"adlkasdlkcccc\"\n    case \"accc\": matches=false match=\"\"\n    case \"blaafoewoiccc\": matches=true match=\"aafoewoiccc\"\n    case \"oirorwccc\": matches=false match=\"\"\n    case \"abla ablaccc\": matches=true match=\"ablaccc\"\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4003880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a0f169818e3c730b71ec962b4d4529?s=128&d=identicon&r=PG&f=1", "display_name": "Anees A", "link": "https://stackoverflow.com/users/4003880/anees-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1082, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1483555843, "creation_date": 1483547960, "question_id": 41468968, "link": "https://stackoverflow.com/questions/41468968/golang-regexp-for-matching-characters-till-a-string-excluding-substrings", "title": "Golang regExp for matching characters till a string ( excluding substrings)", "body": "<p>I have a use case:  Need to match the following .\nInput string: abpcdcccddd\nMatching criteria: match all characters starting with 'a' and ending with 'ccc' \nExample: abpcdccc  ( single character 'c' in 4th Poistion got successfully ignored in matching)</p>\n\n<p>Can you help me with the Golang regular expression for the same?</p>\n"}, {"tags": ["json", "string", "go", "type-conversion", "slice"], "comments": [{"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 2, "creation_date": 1483523863, "post_id": 41460750, "comment_id": 70127290, "body": "<a href=\"http://stackoverflow.com/a/40384408/1975086\">stackoverflow.com/a/40384408/1975086</a> You do <code>[]byte(s)</code>"}, {"owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "edited": false, "score": 1, "creation_date": 1483523886, "post_id": 41460750, "comment_id": 70127307, "body": "Already answered here - <a href=\"http://stackoverflow.com/questions/8032170/how-to-assign-string-to-bytes-array\" title=\"how to assign string to bytes array\">stackoverflow.com/questions/8032170/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "is_accepted": false, "score": 1, "last_activity_date": 1483523773, "creation_date": 1483523773, "answer_id": 41460890, "question_id": 41460750, "link": "https://stackoverflow.com/questions/41460750/how-to-convert-utf8-string-to-byte/41460890#41460890", "title": "How to convert utf8 string to []byte?", "body": "<p>just use []byte(s) on the string. for example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    s := `{\"test\":\"ok\"}`\n    var data map[string]interface{}\n    if err := json.Unmarshal([]byte(s), &amp;data); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"json data: %v\", data)\n}\n</code></pre>\n\n<p>check it out on the playground <a href=\"https://play.golang.org/p/F_MRLXf3Fz\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594112867, "post_id": 41460993, "comment_id": 111004802, "body": "Another great post that I have quoted. See <a href=\"https://stackoverflow.com/a/62740786/12817546\">stackoverflow.com/a/62740786/12817546</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1483554881, "last_edit_date": 1592644375, "creation_date": 1483524049, "answer_id": 41460993, "question_id": 41460750, "link": "https://stackoverflow.com/questions/41460750/how-to-convert-utf8-string-to-byte/41460993#41460993", "title": "How to convert utf8 string to []byte?", "body": "<p>This question is a possible duplicate of <a href=\"https://stackoverflow.com/questions/8032170/how-to-assign-string-to-bytes-array\">How to assign string to bytes array</a>, but still answering it as there is a better, alternative solution:</p>\n<p>Converting from <code>string</code> to <code>[]byte</code> is allowed by the spec, using a simple <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">conversion</a>:</p>\n<blockquote>\n<p><strong>Conversions to and from a string type</strong></p>\n<p>[...]</p>\n<ol start=\"4\">\n<li>Converting a value of a string type to a slice of bytes type yields a slice whose successive elements are the bytes of the string.</li>\n</ol>\n</blockquote>\n<p>So you can simply do:</p>\n<pre><code>s := &quot;some text&quot;\nb := []byte(s) // b is of type []byte\n</code></pre>\n<p>However, the <code>string =&gt; []byte</code> conversion makes a copy of the string content (it has to, as <code>string</code>s are immutable while <code>[]byte</code> values are not), and in case of large <code>string</code>s it's not efficient. Instead, you can create an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> using <a href=\"https://golang.org/pkg/strings/#NewReader\" rel=\"nofollow noreferrer\"><code>strings.NewReader()</code></a> which will read from the passed <code>string</code> without making a copy of it. And you can pass this <code>io.Reader</code> to <a href=\"https://golang.org/pkg/encoding/json/#Decoder\" rel=\"nofollow noreferrer\"><code>json.NewDecoder()</code></a> and unmarshal using the <a href=\"https://golang.org/pkg/encoding/json/#Decoder.Decode\" rel=\"nofollow noreferrer\"><code>Decoder.Decode()</code></a> method:</p>\n<pre><code>s := `{&quot;somekey&quot;:&quot;somevalue&quot;}`\n\nvar result interface{}\nerr := json.NewDecoder(strings.NewReader(s)).Decode(&amp;result)\nfmt.Println(result, err)\n</code></pre>\n<p>Output (try it on the <a href=\"https://play.golang.org/p/oWn4n5Pqpw\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>map[somekey:somevalue] &lt;nil&gt;\n</code></pre>\n<p>Note: calling <code>strings.NewReader()</code> and <code>json.NewDecoder()</code> does have some overhead, so if you're working with small JSON texts, you can safely convert it to <code>[]byte</code> and use <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a>, it won't be slower:</p>\n<pre><code>s := `{&quot;somekey&quot;:&quot;somevalue&quot;}`\n\nvar result interface{}\nerr := json.Unmarshal([]byte(s), &amp;result)\nfmt.Println(result, err)\n</code></pre>\n<p>Output is the same. Try this on the <a href=\"https://play.golang.org/p/fBs4Hf6_Mt\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n<p>Note: if you're getting your JSON input <code>string</code> by reading some <code>io.Reader</code> (e.g. a file or a network connection), you can directly pass that <code>io.Reader</code> to <code>json.NewDecoder()</code>, without having to read the content from it first.</p>\n"}], "owner": {"reputation": 4421, "user_id": 1173529, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4f64aeede68ff9de9a5100ece80e3a87?s=128&d=identicon&r=PG", "display_name": "Midiparse", "link": "https://stackoverflow.com/users/1173529/midiparse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2841, "favorite_count": 0, "accepted_answer_id": 41460993, "answer_count": 2, "score": 1, "last_activity_date": 1483554881, "creation_date": 1483523383, "last_edit_date": 1483525424, "question_id": 41460750, "link": "https://stackoverflow.com/questions/41460750/how-to-convert-utf8-string-to-byte", "title": "How to convert utf8 string to []byte?", "body": "<p>I want to unmarshal a <code>string</code> that contains JSON,\nhowever the <code>Unmarshal</code> function takes a <code>[]byte</code> as input.</p>\n\n<p>How can I convert my UTF8 <code>string</code> to <code>[]byte</code>?</p>\n"}, {"tags": ["string", "go", "format", "slice"], "comments": [{"owner": {"reputation": 5205, "user_id": 118201, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3332136bbcc2736f3d2118dfd7d98a15?s=128&d=identicon&r=PG", "display_name": "eSniff", "link": "https://stackoverflow.com/users/118201/esniff"}, "edited": false, "score": 0, "creation_date": 1483512721, "post_id": 41457273, "comment_id": 70121560, "body": "this should get you started? <a href=\"https://play.golang.org/p/MazNqAD_Yd\" rel=\"nofollow noreferrer\">play.golang.org/p/MazNqAD_Yd</a>"}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 5205, "user_id": 118201, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3332136bbcc2736f3d2118dfd7d98a15?s=128&d=identicon&r=PG", "display_name": "eSniff", "link": "https://stackoverflow.com/users/118201/esniff"}, "edited": false, "score": 0, "creation_date": 1483513832, "post_id": 41457273, "comment_id": 70122037, "body": "thanks for the comment, but i want in that format <code>where={&quot;node_name&quot;:&quot;node1&quot;,&quot;node_name&quot;:&quot;node_2&quot;}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "edited": false, "score": 1, "creation_date": 1483548183, "post_id": 41459051, "comment_id": 70143622, "body": "Learn so many things from your answer, thank you so much. Hope many others golang folks also learn from this answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1483554699, "last_edit_date": 1495542281, "creation_date": 1483517454, "answer_id": 41459051, "question_id": 41457273, "link": "https://stackoverflow.com/questions/41457273/golang-string-format-using-slice-values/41459051#41459051", "title": "Golang string format using slice values", "body": "<p>Your solution uses way too many allocations due to <code>string</code> concatenations.</p>\n\n<p>We'll create some alternative, faster and/or more elegant solutions. Note that the below solutions do not check if node values contain the quotation mark <code>\"</code> character. If they would, those would have to be escaped somehow (else the result would be an invalid query string).</p>\n\n<p>The complete, runnable code can be found on the <a href=\"https://play.golang.org/p/QAVpmzhCgs\" rel=\"nofollow noreferrer\">Go Playground</a>. The complete testing / benchmarking code can also be found on the <a href=\"https://play.golang.org/p/QDpgFSosUc\" rel=\"nofollow noreferrer\">Go Playground</a>, but it is not runnable, save both to your Go workspace (e.g. <code>$GOPATH/src/query/query.go</code> and <code>$GOPATH/src/query/query_test.go</code>) and run it with <code>go test -bench .</code>.</p>\n\n<p>Also be sure to check out this related question: <a href=\"https://stackoverflow.com/questions/1760757/how-to-efficiently-concatenate-strings-in-go\">How to efficiently concatenate strings in Go?</a></p>\n\n<h1>Alternatives</h1>\n\n<h3>Genesis</h3>\n\n<p>Your logic can be captured by the following function:</p>\n\n<pre><code>func buildOriginal(nodes []string) string {\n    var query string\n    for _, n := range nodes {\n        query += fmt.Sprintf(\"\\\"node_name\\\":\\\"%s\\\",\", n)\n    }\n    query = strings.TrimRight(query, \",\")\n    return fmt.Sprintf(\"where={%s}\", query)\n}\n</code></pre>\n\n<h3>Using <code>bytes.Buffer</code></h3>\n\n<p>Much better would be to use a single buffer, e.g. <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow noreferrer\"><code>bytes.Buffer</code></a>, build the query in that, and convert it to <code>string</code> at the end:</p>\n\n<pre><code>func buildBuffer(nodes []string) string {\n    buf := &amp;bytes.Buffer{}\n    buf.WriteString(\"where={\")\n    for i, v := range nodes {\n        if i &gt; 0 {\n            buf.WriteByte(',')\n        }\n        buf.WriteString(`\"node_name\":\"`)\n        buf.WriteString(v)\n        buf.WriteByte('\"')\n    }\n    buf.WriteByte('}')\n    return buf.String()\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>nodes := []string{\"node1\", \"node2\"}\nfmt.Println(buildBuffer(nodes))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>where={\"node_name\":\"node1\",\"node_name\":\"node2\"}\n</code></pre>\n\n<h3><code>bytes.Buffer</code> improved</h3>\n\n<p><code>bytes.Buffer</code> will still do some reallocations, although much less than your original solution.</p>\n\n<p>However, we can still reduce the allocations to 1, if we pass a big-enough byte slice when creating the <code>bytes.Buffer</code> using <a href=\"https://golang.org/pkg/bytes/#NewBuffer\" rel=\"nofollow noreferrer\"><code>bytes.NewBuffer()</code></a>. We can calculate the required size prior:</p>\n\n<pre><code>func buildBuffer2(nodes []string) string {\n    size := 8 + len(nodes)*15\n    for _, v := range nodes {\n        size += len(v)\n    }\n    buf := bytes.NewBuffer(make([]byte, 0, size))\n    buf.WriteString(\"where={\")\n    for i, v := range nodes {\n        if i &gt; 0 {\n            buf.WriteByte(',')\n        }\n        buf.WriteString(`\"node_name\":\"`)\n        buf.WriteString(v)\n        buf.WriteByte('\"')\n    }\n    buf.WriteByte('}')\n    return buf.String()\n}\n</code></pre>\n\n<p>Note that in <code>size</code> calculation <code>8</code> is the size of the string <code>where={}</code> and <code>15</code> is the size of the string <code>\"node_name\":\"\",</code>.</p>\n\n<h3>Using <code>text/template</code></h3>\n\n<p>We can also create a text template, and use the <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text/template</code></a> package to execute it, efficiently generating the result:</p>\n\n<pre><code>var t = template.Must(template.New(\"\").Parse(templ))\n\nfunc buildTemplate(nodes []string) string {\n    size := 8 + len(nodes)*15\n    for _, v := range nodes {\n        size += len(v)\n    }\n    buf := bytes.NewBuffer(make([]byte, 0, size))\n    if err := t.Execute(buf, nodes); err != nil {\n        log.Fatal(err) // Handle error\n    }\n    return buf.String()\n}\n\nconst templ = `where={\n{{- range $idx, $n := . -}}\n    {{if ne $idx 0}},{{end}}\"node_name\":\"{{$n}}\"\n{{- end -}}\n}`\n</code></pre>\n\n<h3>Using <code>strings.Join()</code></h3>\n\n<p>This solution is interesting due to its simplicity. We can use <a href=\"https://golang.org/pkg/strings/#Join\" rel=\"nofollow noreferrer\"><code>strings.Join()</code></a> to join the nodes with the static text <code>\",\"node_name\":\"</code> in between, proper prefix and postfix applied.</p>\n\n<p>An important thing to note: <code>strings.Join()</code> uses the builtin <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\"><code>copy()</code></a> function with a single preallocated <code>[]byte</code> buffer, so it's very fast! <em>\"As a special case, it (the <code>copy()</code> function) also will copy bytes from a string to a slice of bytes.\"</em></p>\n\n<pre><code>func buildJoin(nodes []string) string {\n    if len(nodes) == 0 {\n        return \"where={}\"\n    }\n    return `where={\"node_name\":\"` + strings.Join(nodes, `\",\"node_name\":\"`) + `\"}`\n}\n</code></pre>\n\n<h1>Benchmark results</h1>\n\n<p>We'll benchmark with the following <code>nodes</code> value:</p>\n\n<pre><code>var nodes = []string{\"n1\", \"node2\", \"nodethree\", \"fourthNode\",\n    \"n1\", \"node2\", \"nodethree\", \"fourthNode\",\n    \"n1\", \"node2\", \"nodethree\", \"fourthNode\",\n    \"n1\", \"node2\", \"nodethree\", \"fourthNode\",\n    \"n1\", \"node2\", \"nodethree\", \"fourthNode\",\n}\n</code></pre>\n\n<p>And the benchmarking code looks like this:</p>\n\n<pre><code>func BenchmarkOriginal(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        buildOriginal(nodes)\n    }\n}\n\nfunc BenchmarkBuffer(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        buildBuffer(nodes)\n    }\n}\n\n// ... All the other benchmarking functions look the same\n</code></pre>\n\n<p>And now the results:</p>\n\n<pre><code>BenchmarkOriginal-4               200000             10572 ns/op\nBenchmarkBuffer-4                 500000              2914 ns/op\nBenchmarkBuffer2-4               1000000              2024 ns/op\nBenchmarkBufferTemplate-4          30000             77634 ns/op\nBenchmarkJoin-4                  2000000               830 ns/op\n</code></pre>\n\n<p>Some unsurprising facts: <code>buildBuffer()</code> is <strong>3.6 times</strong> faster than <code>buildOriginal()</code>, and <code>buildBuffer2()</code> (with pre-calculated size) is about <strong>30%</strong> faster than <code>buildBuffer()</code> because it does not need to reallocate (and copy over) the internal buffer.</p>\n\n<p>Some surprising facts: <code>buildJoin()</code> is extremely fast, even beats <code>buildBuffer2()</code> by <strong>2.4 times</strong> (due to only using a <code>[]byte</code> and <code>copy()</code>). <code>buildTemplate()</code> on the other hand proved quite slow: <strong>7 times</strong> slower than <code>buildOriginal()</code>. The main reason for this is because it uses (has to use) reflection under the hood.</p>\n"}], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3986, "favorite_count": 0, "accepted_answer_id": 41459051, "answer_count": 1, "score": 6, "last_activity_date": 1483554699, "creation_date": 1483510323, "last_edit_date": 1483548469, "question_id": 41457273, "link": "https://stackoverflow.com/questions/41457273/golang-string-format-using-slice-values", "title": "Golang string format using slice values", "body": "<p>Here I am trying to create a query string for my API from a slice containing strings. </p>\n\n<p>ie. <code>where={\"node_name\":\"node1\",\"node_name\":\"node_2\"}</code></p>\n\n<pre><code>import (\n   \"fmt\"\n   \"strings\"\n)\n\nfunc main() {\n    nodes := []string{\"node1\", \"node2\"}\n    var query string\n    for _, n := range nodes {\n        query += fmt.Sprintf(\"\\\"node_name\\\":\\\"%s\\\",\", n)\n    }\n    query = strings.TrimRight(query, \",\")\n    final := fmt.Sprintf(\"where={%s}\", query)\n    fmt.Println(final)\n}\n</code></pre>\n\n<p>Here is <a href=\"https://play.golang.org/p/uz52k2Soyi\" rel=\"nofollow noreferrer\">goplayground</a> link.</p>\n\n<p>What is the best way to get the result?</p>\n"}, {"tags": ["postgresql", "gcc", "go", "makefile", "cgo"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1483536541, "post_id": 41456777, "comment_id": 70135457, "body": "Maybe look at how this CGO based library does it? <a href=\"https://github.com/jgallagher/go-libpq\" rel=\"nofollow noreferrer\">github.com/jgallagher/go-libpq</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2910, "user_id": 1329147, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bb27892c2e4adec367d862a16db8389c?s=128&d=identicon&r=PG", "display_name": "Amos", "link": "https://stackoverflow.com/users/1329147/amos"}, "is_accepted": true, "score": 3, "last_activity_date": 1483540337, "creation_date": 1483540337, "answer_id": 41466328, "question_id": 41456777, "link": "https://stackoverflow.com/questions/41456777/how-to-build-a-postgres-extension-using-cgo/41466328#41466328", "title": "How to build a Postgres extension using cgo", "body": "<p>Ok, I spent a whole day and found a viable solution.</p>\n\n<p>We need to have the extension's main source file start with:</p>\n\n<pre><code>package main  // make sure to use main package\n\n/*\n#cgo CFLAGS: -I/path/to/postgres/include/server\n#cgo LDFLAGS: -Wl,-unresolved-symbols=ignore-all\n</code></pre>\n\n<p>Use <code>go build -o myext.so -buildmode=c-shared myext.go</code> to generate <code>myext.so</code>.</p>\n\n<p>If some Go method is needed from the C side, we should add <code>//export methodname</code> above the method declaration. This will generate symbols without package name prefix. Then we can extern these symbols on the C side. Make sure the exported Go methods reside in packages other than main.</p>\n\n<p><code>package test</code> :</p>\n\n<pre><code>//export Merge\nfunc Merge(cint C.int) C.int ...\n</code></pre>\n\n<p><code>package main</code> :</p>\n\n<pre><code>extern int Merge(int);\n\nimport \"./test\"\nvar _ = test.Somevar  // dumb placeholder to fake use package test.\n</code></pre>\n"}], "owner": {"reputation": 2910, "user_id": 1329147, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bb27892c2e4adec367d862a16db8389c?s=128&d=identicon&r=PG", "display_name": "Amos", "link": "https://stackoverflow.com/users/1329147/amos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 2, "accepted_answer_id": 41466328, "answer_count": 1, "score": 1, "last_activity_date": 1483547031, "creation_date": 1483507635, "last_edit_date": 1483547031, "question_id": 41456777, "link": "https://stackoverflow.com/questions/41456777/how-to-build-a-postgres-extension-using-cgo", "title": "How to build a Postgres extension using cgo", "body": "<p>Here is what I'm doing right now,</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>.\n\u251c\u2500\u2500 helloworld--1.0.sql\n\u251c\u2500\u2500 helloworld.control\n\u251c\u2500\u2500 helloworld.go\n\u2514\u2500\u2500 Makefile\n</code></pre>\n\n<p><code>helloworld.go</code> :</p>\n\n<pre><code>package helloworld\n\n/*\n#cgo LDFLAGS: -rdynamic\n#include \"postgres.h\"\n#include \"fmgr.h\"\n#include \"utils/builtins.h\"\n\nPG_MODULE_MAGIC;\n\nPG_FUNCTION_INFO_V1(helloworld);\nPG_FUNCTION_INFO_V1(hello_text_arg);\nPG_FUNCTION_INFO_V1(hello_ereport);\n\nDatum\nhello_world(PG_FUNCTION_ARGS)\n{\n    PG_RETURN_TEXT_P(cstring_to_text(\"Hello, World!\"));\n}\n\nDatum\nhello_text_arg(PG_FUNCTION_ARGS)\n{\n    text *hello     = cstring_to_text(\"Hello, \");\n    int32 hello_sz  = VARSIZE(hello) - VARHDRSZ;\n\n    text *name      = PG_GETARG_TEXT_P(0);\n    int32 name_sz   = VARSIZE(name) - VARHDRSZ;\n\n    text *tail      = cstring_to_text(\"!\");\n    int32 tail_sz   = VARSIZE(tail) - VARHDRSZ;\n\n    int32 out_sz    = hello_sz + name_sz + tail_sz + VARHDRSZ;\n    text *out       = (text *) palloc(out_sz);\n\n    SET_VARSIZE(out, out_sz);\n\n    memcpy(VARDATA(out), VARDATA(hello), hello_sz);\n    memcpy(VARDATA(out) + hello_sz, VARDATA(name), name_sz);\n    memcpy(VARDATA(out) + hello_sz + name_sz, VARDATA(tail), tail_sz);\n\n    PG_RETURN_TEXT_P(out);\n}\n\nDatum\nhello_ereport(PG_FUNCTION_ARGS)\n{\n    ereport(ERROR, (errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED), errmsg(\"null value not allowed\")));\n\n    PG_RETURN_VOID();\n}\n*/\nimport \"C\"\n</code></pre>\n\n<p><code>Makefile</code> :</p>\n\n<pre><code>MODULES = helloworld\n\nEXTENSION = helloworld\nDATA = helloworld--1.0.sql\nPGFILEDESC = \"helloworld - example extension for postgresql\"\n\nREGRESS = helloworld\n\nPG_CONFIG = pg_config\nPGXS := $(shell $(PG_CONFIG) --pgxs)\nINCLUDEDIR = $(shell $(PG_CONFIG) --includedir-server)\ninclude $(PGXS)\n\nhelloworld.so:\n    CGO_CFLAGS=\"-rdynamic -I$(INCLUDEDIR)\" CGO_LDFLAGS=\"-rdynamic $(LDFLAGS)\" go build -v -buildmode=c-shared -o helloworld.so .\n</code></pre>\n\n<p>It produced these errors when making :</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>/tmp/go-build019341122/github.com/amosbird/rpctest/helloworld/_obj/helloworld.cgo2.o: In function `hello_world':\nhelloworld.cgo2.c:(.text+0x48): undefined reference to `cstring_to_text'\n/tmp/go-build019341122/github.com/amosbird/rpctest/helloworld/_obj/helloworld.cgo2.o: In function `hello_text_arg':\nhelloworld.cgo2.c:(.text+0x63): undefined reference to `cstring_to_text'\nhelloworld.cgo2.c:(.text+0x86): undefined reference to `pg_detoast_datum'\nhelloworld.cgo2.c:(.text+0xa5): undefined reference to `cstring_to_text'\nhelloworld.cgo2.c:(.text+0xd7): undefined reference to `palloc'\n/tmp/go-build019341122/github.com/amosbird/rpctest/helloworld/_obj/helloworld.cgo2.o: In function `hello_ereport':\nhelloworld.cgo2.c:(.text+0x1a8): undefined reference to `errstart'\nhelloworld.cgo2.c:(.text+0x1bd): undefined reference to `errmsg'\nhelloworld.cgo2.c:(.text+0x1c9): undefined reference to `errcode'\nhelloworld.cgo2.c:(.text+0x1d7): undefined reference to `errfinish'\ncollect2: ld returned 1 exit status\nmake: *** [helloworld.so] Error 2\n</code></pre>\n\n<p>I have no idea if this would work. There are so many black magic happened here. </p>\n\n<p>So the main question is, <em>what is the correct Makefile that can be used to build a Postgres extension in cgo?</em></p>\n\n<p>A specific question to these errors is, <em>what can I do to defer those symbol resolution in cgo's linking process?</em></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1483503753, "post_id": 41455724, "comment_id": 70118523, "body": "Here is my answer from the same question asked a while back. <a href=\"http://stackoverflow.com/questions/9543835/how-best-do-i-keep-a-long-running-go-program-running/38856572#38856572\" title=\"how best do i keep a long running go program running\">stackoverflow.com/questions/9543835/&hellip;</a> - It uses a method from the runtime pkg."}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "edited": false, "score": 0, "creation_date": 1483501731, "post_id": 41455808, "comment_id": 70118059, "body": "Getting syntax error on the <code>select</code> statement: <code>syntax error: unexpected semicolon or newline, expecting comma or }</code>"}, {"owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "reply_to_user": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "edited": false, "score": 0, "creation_date": 1483501834, "post_id": 41455808, "comment_id": 70118088, "body": "Think I missed a colon at the end of the case statement."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1483502515, "post_id": 41455808, "comment_id": 70118249, "body": "More precisely, the program exits when the <code>main</code> function returns. The goroutines do not continue in an orphaned state where they eventually die.  All execution in the process stops when the program exits."}, {"owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "edited": false, "score": 0, "creation_date": 1483502731, "post_id": 41455808, "comment_id": 70118296, "body": "That&#39;s what I thought too, but I&#39;ve seen some weird behaviour with this - goroutines logging to STDOUT long after main exits. Maybe <code>go test --race</code> just puts the program in the background or something, or runs main inside a harness."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483551540, "post_id": 41455808, "comment_id": 70145791, "body": "You don&#39;t need a select statement for a single channel receive, and you don&#39;t need a for loop when you&#39;re simply going to call <code>os.Exit</code>. If you&#39;re waiting on more than one goroutine, you should be using a WaitGroup too."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483551820, "post_id": 41455808, "comment_id": 70145946, "body": "Also, you&#39;re recommendation for using <code>for {}</code> is also incorrect, as a busy loop is always a programming error, it wastes 100% of one CPU, and will eventually cause the runtime scheduler to hang."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1483642299, "post_id": 41455808, "comment_id": 70190880, "body": "Just to add a bit, instead of a for {} you could use sync.WaitGroup."}], "tags": [], "owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "is_accepted": true, "score": 6, "last_activity_date": 1564044227, "last_edit_date": 1564044227, "creation_date": 1483500945, "answer_id": 41455808, "question_id": 41455724, "link": "https://stackoverflow.com/questions/41455724/running-a-go-routine-indefinitely/41455808#41455808", "title": "Running a Go routine indefinitely", "body": "<p>When the primary goroutine at <code>main</code> exits, all goroutines you might have spawned will be orphaned and eventually die.</p>\n\n<p>You could keep the main goroutine running forever with an infinite loop with <code>for {}</code>, but you might want to keep an exit channel instead:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>exit := make(chan string)\n\n// Spawn all you worker goroutines, and send a message to exit when you're done.\n\nfor {\n    select {\n    case &lt;-exit:\n        os.Exit(0)\n    }\n}\n</code></pre>\n\n<p>Update: Cerise Lim\u00f3n pointed out that goroutines are just killed immediately when main exits. I think this is supposed to be the officially specified behaviour.</p>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 1430367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599b15af43f2893df8378c6215fada1e?s=128&d=identicon&r=PG", "display_name": "Dhananjay", "link": "https://stackoverflow.com/users/1430367/dhananjay"}, "is_accepted": false, "score": 1, "last_activity_date": 1483852378, "creation_date": 1483852378, "answer_id": 41529710, "question_id": 41455724, "link": "https://stackoverflow.com/questions/41455724/running-a-go-routine-indefinitely/41529710#41529710", "title": "Running a Go routine indefinitely", "body": "<p>Your <code>main()</code> returns before <code>getRoutes()</code>-goroutine finishes. When <code>main()</code> returns, the program exits, thereby killing all the running goroutines. (It's also totally possible that <code>main()</code> returns even before the goroutine gets a chance to get scheduled by go runtime.)</p>\n\n<p>If you want <code>main()</code> (or any other function) to wait for a group of goroutines to finish, you'd have to make the function explicitly wait somehow. There're multiple ways to do that. <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\"><code>sync.WaitGroup.Wait()</code></a> can be used to wait for a group of the goroutines to finish. You could also use channels to communicate when goroutines are done.</p>\n"}, {"tags": [], "owner": {"reputation": 1487, "user_id": 3668541, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ba66d28285a3e98b836178617d096b75?s=128&d=identicon&r=PG&f=1", "display_name": "haz", "link": "https://stackoverflow.com/users/3668541/haz"}, "is_accepted": false, "score": 1, "last_activity_date": 1530938263, "creation_date": 1530938263, "answer_id": 51219961, "question_id": 41455724, "link": "https://stackoverflow.com/questions/41455724/running-a-go-routine-indefinitely/51219961#51219961", "title": "Running a Go routine indefinitely", "body": "<p>Although other people have answered this, I think their solutions can be simplified in some cases.</p>\n\n<p>Take this code snippet:</p>\n\n<pre><code>func main() {\n    go doSomething()\n    fmt.Println(\"Done.\")\n}\n\nfunc doSomething() {\n     for i := 0; i &lt; 10; i++ {\n        fmt.Println(\"Doing something...\")\n        time.Sleep(time.Second)\n     }\n}\n</code></pre>\n\n<p>When <code>main()</code> begins executing, it spawns a thread to concurrently execute <code>doSomething()</code>. It then immediately executes <code>fmt.Println(\"Done.\")</code>, and the <code>main()</code> finishes.</p>\n\n<p>When <code>main()</code> finishes, all other goroutines will be orphaned, and die.</p>\n\n<p>To avoid this, we can put a blocking operation at the end of <code>main()</code> that waits for input from a goroutine. It's easiest to do this with a channel:</p>\n\n<pre><code>var exit = make(chan bool)\n\nfunc main() {\n    go doSomething()\n    &lt;-exit // This blocks until the exit channel receives some input\n    fmt.Println(\"Done.\")\n}\n\nfunc doSomething() {\n     for i := 0; i &lt; 10; i++ {\n        fmt.Println(\"Doing something...\")\n        time.Sleep(time.Second)\n     }\n     exit&lt;-true // Notify main() that this goroutine has finished\n}\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6476, "favorite_count": 2, "accepted_answer_id": 41455808, "answer_count": 3, "score": 4, "last_activity_date": 1564044227, "creation_date": 1483500178, "question_id": 41455724, "link": "https://stackoverflow.com/questions/41455724/running-a-go-routine-indefinitely", "title": "Running a Go routine indefinitely", "body": "<p>I have a function that calls another function that returns a chan array. I currently have a for loop looping over the range in the array which runs the program indefinitely outputting the channel updates as the come through.</p>\n\n<pre><code>func getRoutes() {\n      for r := range rtu {\n        if r.Type == 24 {\n          fmt.Printf(\"Route added: %s via %s\\n\",r.Dst.String(),r.Gw.String())\n        } else if r.Type == 25 {\n          fmt.Printf(\"Route deleted: %s via %s\\n\",r.Dst.String(),r.Gw.String())\n        }\n      }\n}\n</code></pre>\n\n<p>When I call getRoutes() from main() everything works as planned though, it's blocking the application. I've tried calling <code>go getRoutes()</code> from <code>main()</code> though it appears as if the function isn't being called at all. </p>\n\n<p>How can I run this function in the background in a non-blocking way using go routines?</p>\n"}, {"tags": ["go", "neo4j", "cypher", "neoism"], "answers": [{"comments": [{"owner": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "edited": false, "score": 0, "creation_date": 1483671768, "post_id": 41458382, "comment_id": 70202468, "body": "if we user  <code>[]struct{quantity int}</code>, we must <code>return res[0].quantity</code>, right?"}, {"owner": {"reputation": 1157, "user_id": 5154802, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZqLky3QxN2E/AAAAAAAAAAI/AAAAAAAAAEE/MyYiHfmqVe0/photo.jpg?sz=128", "display_name": "shivendra pratap singh", "link": "https://stackoverflow.com/users/5154802/shivendra-pratap-singh"}, "reply_to_user": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "edited": false, "score": 0, "creation_date": 1483678555, "post_id": 41458382, "comment_id": 70204070, "body": "yes !! And there  is a sample code.. Try to understand"}], "tags": [], "owner": {"reputation": 1157, "user_id": 5154802, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZqLky3QxN2E/AAAAAAAAAAI/AAAAAAAAAEE/MyYiHfmqVe0/photo.jpg?sz=128", "display_name": "shivendra pratap singh", "link": "https://stackoverflow.com/users/5154802/shivendra-pratap-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1483514888, "creation_date": 1483514888, "answer_id": 41458382, "question_id": 41455686, "link": "https://stackoverflow.com/questions/41455686/result-of-cypher-query-on-neoism-golang/41458382#41458382", "title": "result of cypher query on neoism golang", "body": "<p>1) res must be of type []struct</p>\n\n<p>2)  Don't use \";\" at the end of query.\nstmt := <code>MATCH (u:User) WHERE u.userId = {userid} delete u RETURN count(u)</code></p>\n"}], "owner": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 41458382, "answer_count": 1, "score": 2, "last_activity_date": 1483514888, "creation_date": 1483499872, "question_id": 41455686, "link": "https://stackoverflow.com/questions/41455686/result-of-cypher-query-on-neoism-golang", "title": "result of cypher query on neoism golang", "body": "<p>I have a function to delete \"User\" node and return count deleted node, but it always return -1.</p>\n\n<pre><code>func DeleteUser(userid int) (int, error) {\n        stmt := `\n        MATCH (u:User) WHERE u.userId = {userid} delete u RETURN count(u) ;\n        `\n        params := neoism.Props{\"userid\": userid}\n        res := -1\n        cq := neoism.CypherQuery{\n            Statement:  stmt,\n            Parameters: params,\n            Result:     &amp;res,\n        }\n\n        err := conn.Cypher(&amp;cq)\n\n        return res, err\n    }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1501023624, "post_id": 41455324, "comment_id": 77592038, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38666404/not-enough-arguments-in-call-to-method-expression\">not enough arguments in call to method expression</a>"}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1528029004, "post_id": 41455324, "comment_id": 88342728, "body": "This happens because you&#39;re trying to transfer your knowledge of other languages into GO. You need to unlearn."}], "answers": [{"comments": [{"owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "edited": false, "score": 0, "creation_date": 1483498500, "post_id": 41455431, "comment_id": 70117336, "body": "Is there an alternate way to organize the code so that I can avoid creating a dummy instance of the struct just to call the methods? Also, why does the error say that an argument is missing?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1483498696, "post_id": 41455431, "comment_id": 70117377, "body": "Methods are called on values.  If you have no meaningful value to use, then use a function instead of a method."}], "tags": [], "owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "is_accepted": false, "score": 4, "last_activity_date": 1483497934, "creation_date": 1483497934, "answer_id": 41455431, "question_id": 41455324, "link": "https://stackoverflow.com/questions/41455324/how-to-call-a-go-method-on-a-struct-type/41455431#41455431", "title": "How to call a Go method on a struct type?", "body": "<p>Try this</p>\n\n<pre><code>acct := SavingsAccount{}\naliceAcct:= acct.Open(\"12345\", \"Alice\", time.Date(1999, time.January, 03, 0, 0, 0, 0, time.UTC))\nfmt.Println(\"Alice's account =\", aliceAcct)\n</code></pre>\n\n<p>You need to create an instance of a struct that properly implements the AccountService interface</p>\n\n<p>--Edit\nWorking example: <a href=\"https://play.golang.org/p/PD2PaBW4KZ\" rel=\"nofollow noreferrer\">play.golang.org</a></p>\n"}, {"comments": [{"owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "edited": false, "score": 0, "creation_date": 1483499123, "post_id": 41455557, "comment_id": 70117477, "body": "So the general Idiom in Go is to declare package level constructor functions to initialize structs and use interfaces for other behavior say deposit, credit &amp; transfer? Also, can you please post an e.g. for second point"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "edited": false, "score": 1, "creation_date": 1483504372, "post_id": 41455557, "comment_id": 70118693, "body": "@AravindR.Yarram: See <code>DefaultClient</code> at <a href=\"https://golang.org/pkg/net/http/#pkg-variables\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#pkg-variables</a>"}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 2, "last_activity_date": 1483498737, "creation_date": 1483498737, "answer_id": 41455557, "question_id": 41455324, "link": "https://stackoverflow.com/questions/41455324/how-to-call-a-go-method-on-a-struct-type/41455557#41455557", "title": "How to call a Go method on a struct type?", "body": "<p>Most Go packages do one of two things:</p>\n\n<ol>\n<li><p>Have a package level function such as <code>OpenSavingsAccount</code> that returns an open, initialized SavingsAccount.</p></li>\n<li><p>Have a default variable in the package named <code>DefaultSavingsAccount</code> and duplicate the SavingsAccount methods at the package level where they operate on the DefaultSavingsAccount. This is a lot of function duplication but all of the logic stays in the methods. And if the DefaultSavingsAccount is not const and is an interface type it can be replaced with another implementation.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "edited": false, "score": 0, "creation_date": 1483499528, "post_id": 41455619, "comment_id": 70117588, "body": "Didn&#39;t know about the method expression. The error message is clear now. Wish the compiler generated a little bit more verbose/clear error message."}, {"owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "edited": false, "score": 0, "creation_date": 1483500425, "post_id": 41455619, "comment_id": 70117801, "body": "Account is an embedded type within SavingsAccount or CheckingAccount structs. How can OpenSavings(...) and OpenChecking() return Account type?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1483502027, "last_edit_date": 1483502027, "creation_date": 1483499194, "answer_id": 41455619, "question_id": 41455324, "link": "https://stackoverflow.com/questions/41455324/how-to-call-a-go-method-on-a-struct-type/41455619#41455619", "title": "How to call a Go method on a struct type?", "body": "<p>The result of the <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">method expression</a> <code>AccountService.Open</code> is a function with with type <code>func(AccountService, string,  string, time.Time) AccountService</code>.  The code is missing the first argument.  You can call it like this:</p>\n\n<pre><code>aliceAcct := AccountService.Open(CheckingAccount{}, \"12345\", \"Alice\", time.Date(1999, time.January, 03, 0, 0, 0, 0, time.UTC))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/_y49ELk9Kd\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>If you have no meaningful value to use as the receiver, then use a function instead:</p>\n\n<pre><code>func OpenCheckingAccount(no string, name string, openingDate time.Time) AccountService {\n    ...\n}\n</code></pre>\n\n<p>If you need to abstract account creation, then define the service as a function:</p>\n\n<pre><code> type AccountService func(no string, name string, openingDate time.Time) AccountType\n func OpenSavings(no string, name string, openingDate time.Time) AccountType { ... }\n func OpenChecking(no string, name string, openingDate time.Time) AccountType { ... }\n</code></pre>\n\n<p>The <code>OpenSavings</code> and <code>OpenChecking</code> functions can be used as an AccountService.</p>\n\n<p>You will want to use different types for the service and accounts. Here, I use AccountService and AccountType.  AccountType is not a very good name, but Account is already used.  AccountType might be defined as the following:</p>\n\n<pre><code>type AccountType interface {\n   func Deposit(int)\n   func Withdraw(int)\n}\n</code></pre>\n"}], "owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2114, "favorite_count": 0, "accepted_answer_id": 41455619, "answer_count": 3, "score": 1, "last_activity_date": 1483502027, "creation_date": 1483497115, "question_id": 41455324, "link": "https://stackoverflow.com/questions/41455324/how-to-call-a-go-method-on-a-struct-type", "title": "How to call a Go method on a struct type?", "body": "<p>I getting the error <code>not enough arguments in call to method expression AccountService.Open</code> when I run the following. Run here: <a href=\"https://play.golang.org/p/Z9y-QIcwNy\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Z9y-QIcwNy</a></p>\n\n<pre><code>type AccountService interface {\n    Open(no string, name string, openingDate time.Time) AccountService\n}\n\ntype Account struct {\n    Num      string\n    Name     string\n    OpenDate time.Time\n    Balance  float64\n}\n\ntype SavingsAccount struct {\n    InterestRate float32\n    Account\n}\n\ntype CheckingAccount struct {\n    TransactionFee float32\n    Account\n}\n\nfunc (a SavingsAccount) Open(no string, name string, openingDate time.Time) AccountService {\n    return SavingsAccount{\n        Account: Account{Num: no,\n            Name:     name,\n            OpenDate: openingDate,\n        },\n        InterestRate: 0.9,\n    }\n}\nfunc (a CheckingAccount) Open(no string, name string, openingDate time.Time) AccountService {\n    return CheckingAccount{\n        Account: Account{Num: no,\n            Name:     name,\n            OpenDate: openingDate,\n        },\n        TransactionFee: 0.15,\n    }\n}\n\nfunc main() {\n    aliceAcct := AccountService.Open(\"12345\", \"Alice\", time.Date(1999, time.January, 03, 0, 0, 0, 0, time.UTC))\n\n    fmt.Println(\"Alice's account =\", aliceAcct)\n}\n</code></pre>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": true, "score": 1, "last_activity_date": 1483492499, "creation_date": 1483492499, "answer_id": 41454783, "question_id": 41454603, "link": "https://stackoverflow.com/questions/41454603/go-xml-unmarshal-array/41454783#41454783", "title": "Go XML unmarshal array", "body": "<p>Your code is missing a definition of the <code>Houses</code> part of the XML. Something like what is shown below and unmarshal on that.</p>\n\n<pre><code>type Houses struct {\n    House    []House `xml:\"house\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "accepted_answer_id": 41454783, "answer_count": 1, "score": 1, "last_activity_date": 1483492499, "creation_date": 1483491092, "question_id": 41454603, "link": "https://stackoverflow.com/questions/41454603/go-xml-unmarshal-array", "title": "Go XML unmarshal array", "body": "<p>I am trying to unmarshal a file that looks like this</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;houses&gt;\n  &lt;house name=\"Rhyves Flats 14\" houseid=\"1\" entryx=\"167\" entryy=\"361\" entryz=\"6\" rent=\"0\" townid=\"2\" size=\"17\" /&gt;\n&lt;/houses&gt;\n</code></pre>\n\n<p>With the following code</p>\n\n<pre><code>// House struct used for houses xml file\ntype House struct {\n    XMLName xml.Name `xml:\"houses\"`\n    HouseID uint32 `xml:\"houseid,attr\"`\n    Name    string `xml:\"name,attr\"`\n    EntryX  uint16 `xml:\"entryx,attr\"`\n    EntryY  uint16 `xml:\"entryy,attr\"`\n    EntryZ  uint16 `xml:\"entryz,attr\"`\n    Size    int    `xml:\"size,attr\"`\n    TownID  uint32 `xml:\"townid,attr\"`\n    Rent    int    `xml:\"rent,attr\"`\n}\n\n// LoadHouses parses the server map houses\nfunc LoadHouses(file string, list []House) error {\n    // Load houses file\n    f, err := ioutil.ReadFile(file)\n\n    if err != nil {\n        return err\n    }\n\n    // Unmarshal houses file\n    return xml.Unmarshal(f, &amp;list)\n}\n</code></pre>\n\n<p>This is not returning any error. But the house slice is empty. Everything seems correct, the attrs are set and the XMLName too.</p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 0, "creation_date": 1483475877, "post_id": 41451787, "comment_id": 70110266, "body": "Connection setup looks correct. This error - are you getting it from _, err := client.Ping().Result() ?"}, {"owner": {"reputation": 149, "user_id": 6290684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ77a.png?s=128&g=1", "display_name": "developer-guy", "link": "https://stackoverflow.com/users/6290684/developer-guy"}, "reply_to_user": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 0, "creation_date": 1483475971, "post_id": 41451787, "comment_id": 70110323, "body": "yes i am getting this error in that code"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1483476479, "post_id": 41451787, "comment_id": 70110575, "body": "Please tell us which redis client you are using and the line of code where the error is returned."}, {"owner": {"reputation": 952, "user_id": 4555798, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/956224387724154/picture?type=large", "display_name": "oharlem", "link": "https://stackoverflow.com/users/4555798/oharlem"}, "edited": false, "score": 0, "creation_date": 1483476517, "post_id": 41451787, "comment_id": 70110587, "body": "&quot;unknown network error&quot; is an error from Go&#39;s net package, so my only conclusion would be some issue with a driver or connection to redis.  For example: &quot;gopkg.in/redis.v5&quot; redis package on Go .7.4 with an official alpine redis Docker and this setup works fine. If I intentionally mess credentials/host/port/container state - I get expected redis errors. Could not reproduce unknown network. Try connecting to a different redis server to double-check."}, {"owner": {"reputation": 149, "user_id": 6290684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ77a.png?s=128&g=1", "display_name": "developer-guy", "link": "https://stackoverflow.com/users/6290684/developer-guy"}, "edited": false, "score": 0, "creation_date": 1483476634, "post_id": 41451787, "comment_id": 70110636, "body": "\u0130 am using redis-cli 3.0.6 and inside my project i am using this library &quot;gopkg.in/redis.v2&quot; .  In this line  --&gt; pong,err := client.Ping().Result()"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1483477351, "post_id": 41451787, "comment_id": 70110982, "body": "If you&#39;re going to use that redis client, I highly recommend you use a more up to date version. There&#39;s been a lot of improvements in the past 3 years."}], "answers": [{"comments": [{"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "reply_to_user": {"reputation": 149, "user_id": 6290684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ77a.png?s=128&g=1", "display_name": "developer-guy", "link": "https://stackoverflow.com/users/6290684/developer-guy"}, "edited": false, "score": 1, "creation_date": 1486548263, "post_id": 41452301, "comment_id": 71388971, "body": "@devguy When an answer is correct and solves your problem, please accept it. See <a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 5, "last_activity_date": 1483477419, "last_edit_date": 1483477419, "creation_date": 1483477289, "answer_id": 41452301, "question_id": 41451787, "link": "https://stackoverflow.com/questions/41451787/redis-connection-with-go-lang/41452301#41452301", "title": "Redis connection with go lang", "body": "<p>You're not providing a network parameter for the Dialer:</p>\n\n<pre><code>client := redis.NewClient(&amp;redis.Options{\n    Network:  \"tcp\",\n    Addr:     \"localhost:6379\",\n    Password: \"\",\n    DB:       0,\n})\n</code></pre>\n\n<p>Or use <a href=\"https://godoc.org/gopkg.in/redis.v2#NewTCPClient\" rel=\"noreferrer\"><code>NewTCPClient</code></a>, which sets the \"tcp\" network parameter for you.</p>\n"}], "owner": {"reputation": 149, "user_id": 6290684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ77a.png?s=128&g=1", "display_name": "developer-guy", "link": "https://stackoverflow.com/users/6290684/developer-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2821, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483477419, "creation_date": 1483475268, "question_id": 41451787, "link": "https://stackoverflow.com/questions/41451787/redis-connection-with-go-lang", "title": "Redis connection with go lang", "body": "<p>I am getting </p>\n\n<blockquote>\n  <p><strong>dial : unknown network error</strong></p>\n</blockquote>\n\n<p>when i try to connect redis in go lang like this :</p>\n\n<pre><code>var client *redis.Client\n\nclient = redis.NewClient(&amp;redis.Options{\n    Addr : \"localhost:6379\",\n    Password:\"\",\n    DB       : 0,\n});\n</code></pre>\n\n<p>Why i am getting this error,please help.</p>\n"}, {"tags": ["mysql", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1483485945, "creation_date": 1483485945, "answer_id": 41453919, "question_id": 41451431, "link": "https://stackoverflow.com/questions/41451431/golang-gorm-error-migrating-struct/41453919#41453919", "title": "Golang Gorm error migrating struct", "body": "<blockquote>\n  <p>AutoMigrate will ONLY create tables, missing columns and missing indexes, and WON'T change existing column's type or delete unused columns to protect your data.</p>\n</blockquote>\n\n<p>I would guess that one of your tables already exists, and the <code>id</code> column in that table is a different type than what <code>gorm.Model</code> wants to create.  I would figure out which table it is by doing:</p>\n\n<pre><code>db.AutoMigrate(&amp;User{})\ndb.AutoMigrate(&amp;Ads{})\ndb.AutoMigrate(&amp;Type{})\ndb.AutoMigrate(&amp;Category{})\ndb.AutoMigrate(&amp;Location{})\n</code></pre>\n\n<p>and seeing where it fails.  Then, I would backup that table (just in case), and then either just drop the table completely, or rename the id column to <code>tmp_id</code>, see if automigrate fixes it, and if so, drop the <code>tmp_id</code> column.</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 1840741, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4a0d659f5bb932844b223b218eab6df?s=128&d=identicon&r=PG", "display_name": "bjm88", "link": "https://stackoverflow.com/users/1840741/bjm88"}, "is_accepted": false, "score": 0, "last_activity_date": 1535479341, "creation_date": 1535479341, "answer_id": 52063880, "question_id": 41451431, "link": "https://stackoverflow.com/questions/41451431/golang-gorm-error-migrating-struct/52063880#52063880", "title": "Golang Gorm error migrating struct", "body": "<p>FYI I've found Gorm will not log proper error or any error if it has permission issues on the user.  For example the table existed when logged in as root, but the user I was logging in as didn't see it at all, Gorm just ran through Migration without creating the table or altering it (even though it was different schema) just didn't report any permission issue at all.</p>\n"}], "owner": {"reputation": 33, "user_id": 5098582, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0454de992e1b6c71584276b5dfd04fa9?s=128&d=identicon&r=PG&f=1", "display_name": "bluebeel", "link": "https://stackoverflow.com/users/5098582/bluebeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2073, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1535479341, "creation_date": 1483473730, "question_id": 41451431, "link": "https://stackoverflow.com/questions/41451431/golang-gorm-error-migrating-struct", "title": "Golang Gorm error migrating struct", "body": "<p>I have a small mistake in my small application and I really do not see where it can come from. So I have 4 structs, one of the 4 struct has several one-to-one relationships.</p>\n\n<p>I connect to my database and use automigrate to migrate my 4 structs and create the necessary tables.\nThe problem is at this point, it does not create anything in the database and in the terminal I have this message:\n(Error 1060: Name of the 'id' field already in use)</p>\n\n<p>My code \n<strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"github.com/jinzhu/gorm\"\n_ \"github.com/jinzhu/gorm/dialects/mysql\"\n)\n\nvar db *gorm.DB\nvar err error\n\nconst (\nmysupersecretpassword = \"cr9ih_pvr9f9kc75n#bz&amp;y%(@+^&amp;1_#hr0^)-$kv%n3dh84$^w\"\n)\n\nfunc main() {\n\ndb, err = gorm.Open(\"mysql\", \"root:root@/test?charset=utf8&amp;parseTime=True\")\nif err != nil {\n    fmt.Println(err)\n}\ndefer db.Close()\ndb.AutoMigrate(&amp;User{}, &amp;Ads{}, &amp;Type{}, &amp;Category{}, &amp;Location{})\n\n}\n</code></pre>\n\n<p><strong>models.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/jinzhu/gorm\"\n)\n\ntype User struct {\n    gorm.Model\n    Username string `json:\"username\"`\n    Email    string `json:\"email\" form:\"email\"`\n    Password string `json:\"password\" form:\"password\"`\n    active   bool   `json:\"active\" gorm:\"default:0\"`\n    level    bool   `json:\"level\" gorm:\"default:0\"`\n}\n\ntype Type struct {\n    gorm.Model\n    Name string `json:\"name\" form:\"name\"`\n}\n\ntype Category struct {\n    gorm.Model\n    CatID uint   `json:\"category-parent\" form:\"category-parent\" gorm:\"default:0\"`\n    Name  string `json:\"name\" form:\"name\"`\n}\n\ntype Location struct {\n    gorm.Model\n    Location string `json:\"location\" form:\"location\"`\n}\n\ntype Ads struct {\n    gorm.Model\n    User     User     `json:\"user\"`\n    Type     Type     `json:\"type\" form:\"type\"`\n    Category Category `json:\"category\" form:\"category\"`\n    Title    string   `json:\"title\" form:\"title\"`\n    Content  string   `json:\"content\" form:\"content\"`\n    Location Location `json:\"location\" form:\"location\"`\n}\n</code></pre>\n\n<p>Waiting for an answer that could put me on the right path :)</p>\n"}, {"tags": ["git", "go", "ssh", "deployment", "gitlab"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1483509136, "creation_date": 1483509136, "answer_id": 41457028, "question_id": 41449746, "link": "https://stackoverflow.com/questions/41449746/how-to-deploy-my-webapp-on-ci-build-success-via-ssh/41457028#41457028", "title": "How to deploy my webapp on CI build success via SSH?", "body": "<blockquote>\n  <p>push the built app to a dedicated repo which I then clone on the target machine and make the necessary scripts run.</p>\n</blockquote>\n\n<p>That would be done through a <a href=\"https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks#Server-Side-Hooks\" rel=\"nofollow noreferrer\"><code>post-receive</code> hook</a> set on a bare repo on your server. The hook script would be:</p>\n\n<pre><code>git --git-dir=/path/to/project_root/.git --work-tree=/var/www/http/ checkout -f\n</code></pre>\n\n<p>You can complete that script with other commands to further modify your deployment.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6334886, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BkCME.jpg?s=128&g=1", "display_name": "limace255", "link": "https://stackoverflow.com/users/6334886/limace255"}, "is_accepted": false, "score": 0, "last_activity_date": 1483515944, "creation_date": 1483515944, "answer_id": 41458662, "question_id": 41449746, "link": "https://stackoverflow.com/questions/41449746/how-to-deploy-my-webapp-on-ci-build-success-via-ssh/41458662#41458662", "title": "How to deploy my webapp on CI build success via SSH?", "body": "<p>Your CI should test if the way you build your app is good or not.\nAfter build and put in a folder, add a test of this app (functional, by deploying it if it's relevant, or just verify integrity of it).\nThen, you can choose to merge (and then, as you said, clone the repo on a target machine); this could be done by another CI pipeline, in fact.\nPushing the app, for me, is not part of the pipeline nor the code, so it should not be integrated on it.</p>\n"}, {"tags": [], "owner": {"reputation": 203, "user_id": 7821842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fdb37f8f5a5d985aa32e7f018cd3418?s=128&d=identicon&r=PG&f=1", "display_name": "jolooket", "link": "https://stackoverflow.com/users/7821842/jolooket"}, "is_accepted": false, "score": 0, "last_activity_date": 1492969951, "creation_date": 1492969951, "answer_id": 43574560, "question_id": 41449746, "link": "https://stackoverflow.com/questions/41449746/how-to-deploy-my-webapp-on-ci-build-success-via-ssh/43574560#43574560", "title": "How to deploy my webapp on CI build success via SSH?", "body": "<p>Gitlab CI gives you a lot of freedom how you want to deploy your app. You can choose to use docker, fabric, puppet, chef, ansible or just plain bash and ssh.</p>\n\n<p>I use <a href=\"http://www.fabfile.org/\" rel=\"nofollow noreferrer\">fabric</a> + docker myself.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1492969951, "creation_date": 1483466843, "question_id": 41449746, "link": "https://stackoverflow.com/questions/41449746/how-to-deploy-my-webapp-on-ci-build-success-via-ssh", "title": "How to deploy my webapp on CI build success via SSH?", "body": "<p>I have a CI pipeline in GitLab that builds my app and puts it in a folder. </p>\n\n<p>What's the proper way to publish it and make some changes on the server where it is deployed?</p>\n\n<p>I am thinking of a \"pull\" scenario: push the built app to a dedicated repo which I then clone on the target machine and make the necessary scripts run.</p>\n\n<p>I suppose I can \"push\" the app from the CI server via SSH, but not sure it's the right way.</p>\n\n<p>How do I make it in a proper and not overcomplicated manner?</p>\n"}, {"tags": ["go", "unicode"], "answers": [{"comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1483466116, "post_id": 41449287, "comment_id": 70105388, "body": "Might be worth mentioning that you can <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">import a package</a> and use its members without a package qualifier, by way of <code>import . &lt;package&gt;</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1483467157, "post_id": 41449287, "comment_id": 70105969, "body": "@TimCooper Thanks, for completeness, I mentioned that too."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1483467137, "last_edit_date": 1495541338, "creation_date": 1483465318, "answer_id": 41449287, "question_id": 41449163, "link": "https://stackoverflow.com/questions/41449163/how-to-help-a-go-test-find-a-custom-type-declaration/41449287#41449287", "title": "How to help a Go test find a custom type declaration?", "body": "<p>Quoting from the <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">Spec: Exported Identifiers:</a></p>\n\n<blockquote>\n  <p>An identifier is exported if [...] the first character of the identifier's name is a Unicode upper case letter (Unicode class \"Lu\"); and [...]</p>\n</blockquote>\n\n<p>There is nothing wrong with Cyrillic runes (Go handles them well), all characters in the Unicode class \"Lu\" (Letter, uppercased) are accepted, but when you import a package, you have to use the package name to construct <a href=\"https://golang.org/ref/spec#Qualified_identifiers\" rel=\"nofollow noreferrer\">qualified identifiers</a> to refer to <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">exported identifiers</a> from the package.</p>\n\n<p>Change this line in your test:</p>\n\n<pre><code>wanted := \u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442{\u0421\u0442\u0440\u043e\u043a\u0430: \"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435!\"}\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>wanted := \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435.\u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442{\u0421\u0442\u0440\u043e\u043a\u0430: \"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435!\"}\n</code></pre>\n\n<p>Once you do this it'll pass. Running <code>go test</code>:</p>\n\n<pre><code>PASS\nok      github.com/mcandre/mcandre/go/\u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 0.001s\n</code></pre>\n\n<p>See this related question for more information: <a href=\"https://stackoverflow.com/questions/36994445/getting-a-use-of-package-without-selector-error\">Getting a use of package without selector error</a></p>\n\n<h3>Note on package names</h3>\n\n<p>You need to use qualified identifier because you used a different package for your test file. You may choose to use the same package, in which case you must not import the package (it would be an import cycle which is not allowed), and in which case you don't need to use a qualified identifier, you may use all exported <em>and</em> unexported identifiers of the package.</p>\n\n<p>This is how the test file would look like with the same package:</p>\n\n<pre><code>package \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435\n\nimport (\n        \"testing\"\n)\n\nfunc Test\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435Returns\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435(t *testing.T) {\n        wanted := \u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442{\u0421\u0442\u0440\u043e\u043a\u0430: \"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435!\"}\n        observed := \u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435()\n\n        if observed != wanted {\n                t.Errorf(\"\u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435.\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435(): Wanted %s, got %s\\n\", wanted, observed)\n        }\n}\n</code></pre>\n\n<p>Using the same package name is called white-box testing, using a different package name is called black-box testing. You can read more about it here: <a href=\"https://stackoverflow.com/questions/40949178/where-to-put-shared-code-for-tests-in-a-go-package/40949505#40949505\">Where to put shared code for tests in a Go package?</a></p>\n\n<h3>Note on changing the name</h3>\n\n<p>With the <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">import declarations</a>, you can also change the name you want to use to refer to the imported package's identifiers; you can even use a <code>.</code> (dot) in place of the name, in which case you can omit the name from the qualified identifiers. For details, see this: <a href=\"https://stackoverflow.com/questions/29898400/import-struct-from-another-package-and-file-golang/29898669#29898669\">Import struct from another package and file golang</a></p>\n"}], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1483467137, "creation_date": 1483464834, "question_id": 41449163, "link": "https://stackoverflow.com/questions/41449163/how-to-help-a-go-test-find-a-custom-type-declaration", "title": "How to help a Go test find a custom type declaration?", "body": "<p>I'm testing Go's support for Unicode, by declaring a type</p>\n\n<pre><code>type \u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 struct {\n    \u0421\u0442\u0440\u043e\u043a\u0430 string\n}\n</code></pre>\n\n<p>in <code>package \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435</code>, and attempting to import into a unit test. However, when I try this, I get an error.</p>\n\n<p>Trace:</p>\n\n<pre><code>$ go test\n# github.com/mcandre/mcandre/go/\u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435_test\n./\u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435_test.go:10: undefined: \u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\nFAIL    github.com/mcandre/mcandre/go/\u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 [build failed]\n</code></pre>\n\n<p>Source:</p>\n\n<p><a href=\"https://github.com/mcandre/mcandre/tree/master/go/%D0%B8%D1%81%D0%BF%D1%8B%D1%82%D0%B0%D0%BD%D0%B8%D0%B5\" rel=\"nofollow noreferrer\">https://github.com/mcandre/mcandre/tree/master/go/\u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435</a></p>\n\n<p>Am I capitalizing my public members correctly? <code>go doc</code> shows my struct being listed publicly:</p>\n\n<pre><code>$ go doc\npackage \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 // import \"github.com/mcandre/mcandre/go/\u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435\"\n\nPackage \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 demonstrates Unicode capabilities in Go source code.\n\ntype \u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442 struct { ... }\n    func \u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435() \u042d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\n</code></pre>\n\n<p>Maybe the Go compiler has a problem with Cyrillic runes in tokens?</p>\n"}, {"tags": ["recursion", "go", "synchronization", "channel", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 6483012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccb6ec0120557d8522de07d5f36d900?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek", "link": "https://stackoverflow.com/users/6483012/maciej-d%c5%82ugoszek"}, "is_accepted": false, "score": 0, "last_activity_date": 1483470581, "last_edit_date": 1495539960, "creation_date": 1483470249, "answer_id": 41450596, "question_id": 41447907, "link": "https://stackoverflow.com/questions/41447907/recursion-in-golang-is-giving-deadlock-or-negative-waitgroup-counter-when-using/41450596#41450596", "title": "Recursion in golang is giving deadlock or negative WaitGroup counter when using goroutines, channels and sync.Waitgroup", "body": "<p>As has been stated already you should close the channel if you want the main goroutine to exit.</p>\n\n<p>Example of implementation : \nIn function <code>func FindDirs</code> you could make an additional channel for every recursive  <code>func FindDirs</code>  call that this function is going to make and pass that new channel in the argument. Then simultaneously listen to all those new channels and forward the strings back to the channel that function got in the argument.\nAfter all new channels has been closed close the channel  given in the argument.</p>\n\n<p>In other words every func call should have its own channel that it sends to. The string is then forwarded all the way to main function.</p>\n\n<p>Dynamic select described here : <a href=\"https://stackoverflow.com/questions/19992334/how-to-listen-to-n-channels-dynamic-select-statement\">how to listen to N channels? (dynamic select statement)</a></p>\n"}, {"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 2, "last_activity_date": 1483533563, "creation_date": 1483533563, "answer_id": 41464057, "question_id": 41447907, "link": "https://stackoverflow.com/questions/41447907/recursion-in-golang-is-giving-deadlock-or-negative-waitgroup-counter-when-using/41464057#41464057", "title": "Recursion in golang is giving deadlock or negative WaitGroup counter when using goroutines, channels and sync.Waitgroup", "body": "<p><strong>Short answer</strong> : You  are not <code>closing</code> the channel. </p>\n\n<p><strong>Fix</strong>          : add <code>defer wg.Done()</code> at beginning of the go routine that calls <code>FindDirs</code></p>\n\n<pre><code>go func() {\n    defer wg.Done()\n    filtermounts.FindDirs(parsedConfig.ScanFrom, []int64{filtermounts.EXT4_SUPER_MAGIC}, wg, dirlistchan)\n}()\n</code></pre>\n\n<p><strong>Why did it happen</strong></p>\n\n<p>The go routine that is responsponsible for closing the channel waits for <strong>wg</strong> there is no <strong>wg.Done</strong> in the code above. So close never happens</p>\n\n<p>Now the for loop blocks on the channel for <strong>close</strong> or a value for ever, this cause the error </p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>So here is your code ,this may be run as </p>\n\n<pre><code>go run filename.go /path/to/folder\n</code></pre>\n\n<h2><em>Code</em></h2>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"os\"\n    \"sync\"\n    \"syscall\"\n)\n\nfunc main() {\n\n    wg := new(sync.WaitGroup)\n    dirlistchan := make(chan string, 1000)\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        FindDirs(os.Args[1], []int64{61267}, wg, dirlistchan)\n    }()\n\n    go func() {\n        wg.Wait()\n        close(dirlistchan)\n    }()\n    for i := range dirlistchan {\n        fmt.Println(i)\n    }\n    wg.Wait()\n\n}\n\nfunc FindDirs(dir string, nativePartitions []int64, wg *sync.WaitGroup, dirlistchan chan string) {\n    fd, err := os.Open(dir)\n    if err != nil {\n        panic(err)\n    }\n    filenames, err := fd.Readdir(0)\n    if err != nil {\n        panic(err)\n    }\n\n    for _, i := range filenames {\n\n        var buff bytes.Buffer\n        buff.WriteString(dir)\n        switch dir {\n        case \"/\":\n        default:\n            buff.WriteString(\"/\")\n        }\n\n        buff.WriteString(i.Name())\n        /*err := os.Chdir(dir)\n          if err != nil {\n              return err\n          }*/\n\n        t := new(syscall.Statfs_t)\n        err = syscall.Statfs(buff.String(), t)\n        if err != nil {\n            //fmt.Println(\"Error accessing\", buff.String())\n        }\n        if checkDirIsNative(t.Type, nativePartitions) &amp;&amp; i.IsDir() {\n            dirlistchan &lt;- buff.String()\n            FindDirs(buff.String(), nativePartitions, wg, dirlistchan) //recursion happens here\n        } else {\n            //fmt.Println(i.Name(), \"is not native\")\n        }\n\n    }\n}\n\nfunc checkDirIsNative(dirtype int64, nativetypes []int64) bool {\n    for _, i := range nativetypes {\n        if dirtype == i {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>Find the go.play link <a href=\"https://play.golang.org/p/LWP7WLVFwi\" rel=\"nofollow noreferrer\">here</a> </p>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2009, "favorite_count": 0, "accepted_answer_id": 41464057, "answer_count": 2, "score": 3, "last_activity_date": 1483533563, "creation_date": 1483460694, "last_edit_date": 1483471864, "question_id": 41447907, "link": "https://stackoverflow.com/questions/41447907/recursion-in-golang-is-giving-deadlock-or-negative-waitgroup-counter-when-using", "title": "Recursion in golang is giving deadlock or negative WaitGroup counter when using goroutines, channels and sync.Waitgroup", "body": "<p>I am trying to find the list of all directories using a recursive function. The code to the function is</p>\n\n<pre><code>func FindDirs(dir string, nativePartitions []int64, wg *sync.WaitGroup, dirlistchan chan string) {\n    // defer wg.Done here will give negative waitgroup panic, commenting it will give negative waitgroup counter panic\n    fd, err := os.Open(dir)\n    if err != nil {\n        panic(err)\n    }\n    filenames, err := fd.Readdir(0)\n    if err != nil {\n        panic(err)\n    }\n\n    for _, i := range filenames {\n\n        var buff bytes.Buffer\n        buff.WriteString(dir)\n        switch dir {\n        case \"/\":\n        default:\n            buff.WriteString(\"/\")\n        }\n\n        buff.WriteString(i.Name())\n        /*err := os.Chdir(dir)\n        if err != nil {\n            return err\n        }*/\n\n        t := new(syscall.Statfs_t)\n        err = syscall.Statfs(buff.String(), t)\n        if err != nil {\n            //fmt.Println(\"Error accessing\", buff.String())\n        }\n        if checkDirIsNative(t.Type, nativePartitions) &amp;&amp; i.IsDir(){\n            dirlistchan &lt;- buff.String()\n            FindDirs(buff.String(), nativePartitions, wg, dirlistchan) //recursion happens here\n        } else {\n            //fmt.Println(i.Name(), \"is not native\")\n        }\n\n\n    }\n}\n</code></pre>\n\n<p>and in the main function, I am calling it as </p>\n\n<pre><code>wg := new(sync.WaitGroup)\ndirlistchan := make(chan string, 1000)\nwg.Add(1)\ngo func() {\n    filtermounts.FindDirs(parsedConfig.ScanFrom, []int64{filtermounts.EXT4_SUPER_MAGIC}, wg, dirlistchan)\n}()\n\n\ngo func() {\n    wg.Wait()\n    close(dirlistchan)\n}()\nfor i := range dirlistchan {\n    fmt.Println(i)\n}\nwg.Wait()\n</code></pre>\n\n<p>and I am getting a </p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>I was able to get this working if I am printing the result instead of using channels, or append to a slice using mutex. (verified with the linux <code>find</code> command to see if the results are same.) Please find the function after omitting channels and using sync.Mutex and append.</p>\n\n<pre><code>func FindDirs(dir string, nativePartitions []int64, dirlist *[]string, mutex *sync.Mutex) []string{\n\n\n    fd, err := os.Open(dir)\n    defer fd.Close()\n    if err != nil {\n        panic(err)\n    }\n    filenames, err := fd.Readdir(0)\n    if err != nil {\n        panic(err)\n    }\n\n    for _, i := range filenames {\n        var buff bytes.Buffer\n        buff.WriteString(dir)\n        switch dir {\n        case \"/\":\n        default:\n            buff.WriteString(\"/\")\n        }\n\n        buff.WriteString(i.Name())\n        /*err := os.Chdir(dir)\n        if err != nil {\n            return err\n        }*/\n\n        t := new(syscall.Statfs_t)\n        err = syscall.Statfs(buff.String(), t)\n        if err != nil {\n            //fmt.Println(\"Error accessing\", buff.String())\n        }\n        if checkDirIsNative(t.Type, nativePartitions) &amp;&amp; i.IsDir(){\n            //dirlistchan &lt;- buff.String()\n            mutex.Lock()\n            *dirlist = append(*dirlist, buff.String())\n            mutex.Unlock()\n            //fmt.Println(buff.String())\n\n            FindDirs(buff.String(), nativePartitions, dirlist, mutex)\n        } else {\n            //fmt.Println(i.Name(), \"is not native\")\n        }\n\n    }\n    return *dirlist\n}\n</code></pre>\n\n<p>But I cannot think of a way to make this work with channels and goroutines. Any help is greatly appreciated.</p>\n\n<p>Note: <a href=\"https://play.golang.org/p/qjiv3FRUdZ\" rel=\"nofollow noreferrer\">Here</a> is a link to the golang playground with the code. I couldn't find a workaround to get the syscall thing to work on the playground either. It works on my system though.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "docker", "dockerfile", "gvm"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483459376, "post_id": 41447459, "comment_id": 70101297, "body": "Where is it installing <code>gvm</code>? Is it in your path? Why do you need <code>gvm</code> in a container, which is usually purpose-built for an application?"}, {"owner": {"reputation": 14499, "user_id": 3589092, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7ROkk.jpg?s=128&g=1", "display_name": "kemicofa ghost", "link": "https://stackoverflow.com/users/3589092/kemicofa-ghost"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483459535, "post_id": 41447459, "comment_id": 70101409, "body": "@JimB using it for developing reasons. Figured would be easier to handle go updates, check update for where GVM is installed. GVM usually gets added to the PATH automatically, no? It&#39;s not in the PATH, I&#39;ll add it later and see if that works."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1483544139, "last_edit_date": 1483544139, "creation_date": 1483461630, "answer_id": 41448227, "question_id": 41447459, "link": "https://stackoverflow.com/questions/41447459/bin-sh-1-gvm-not-found/41448227#41448227", "title": "/bin/sh: 1: gvm: not found", "body": "<p>Your shell is <code>/bin/sh</code>, but <code>gvm</code> puts its initialization in <code>~/.bashrc</code>, and expects <code>/bin/bash</code>.</p>\n\n<p>You need to source the <code>gvm</code> initialization scripts to run the commands from a non-interactive bash shell:</p>\n\n<pre><code>RUN [\"/bin/bash\", \"-c\", \". /root/.gvm/scripts/gvm &amp;&amp; gvm install go1.4 -B\"]\nRUN [\"/bin/bash\", \"-c\", \". /root/.gvm/scripts/gvm &amp;&amp; gvm use go1.4\"]\n</code></pre>\n\n<p>Or even better might be to put the commands you want to execute in a single bash script and add that to the image. </p>\n\n<pre><code>#!/bin/bash\nset -e\n\nsource /root/.gvm/scripts/gvm\ngvm install go1.4\ngvm use go1.4\n</code></pre>\n"}], "owner": {"reputation": 14499, "user_id": 3589092, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7ROkk.jpg?s=128&g=1", "display_name": "kemicofa ghost", "link": "https://stackoverflow.com/users/3589092/kemicofa-ghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3122, "favorite_count": 1, "accepted_answer_id": 41448227, "answer_count": 1, "score": 1, "last_activity_date": 1483544139, "creation_date": 1483459250, "last_edit_date": 1483459377, "question_id": 41447459, "link": "https://stackoverflow.com/questions/41447459/bin-sh-1-gvm-not-found", "title": "/bin/sh: 1: gvm: not found", "body": "<h2>Problem:</h2>\n\n<p>I'm attempting to create a Dockerfile that installs all the components to run Go, to install <a href=\"https://github.com/moovweb/gvm\" rel=\"nofollow noreferrer\">GVM (Go Version Management)</a>, and to install specific Go Versions.</p>\n\n<h2>Error:</h2>\n\n<p>When I try building the container with:</p>\n\n<pre><code>docker build -t ##### .\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>/bin/sh: 1: gvm: not found</p>\n  \n  <p>The command '/bin/sh -c gvm install go1.4 -B' returned a non-zero code: 127</p>\n</blockquote>\n\n<p>Installed here:</p>\n\n<pre><code>/root/.gvm/scripts/env/gvm\n/root/.gvm/scripts/gvm\n/root/.gvm/bin/gvm\n</code></pre>\n\n<h2>What I tried:</h2>\n\n<p>It's clearly able to install GVM but unable to use it. Why?\nI thought maybe I needed to refresh the <code>.bashrc</code> or the <code>.bash_profile</code> ... but that didn't work, since they don't exist.</p>\n\n<h2>Dockerfile:</h2>\n\n<pre><code>FROM #####/#####\n\n#Installing Golang dependencies\nRUN apt-get -y install curl git mercurial make binutils bison gcc build-essential\n\n#Installing Golang\n\nRUN [\"/bin/bash\", \"-c\", \"bash &lt; &lt;(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)\"]\n#gvm does not exist here... why?\nRUN gvm install go1.4 -B\nRUN gvm use go1.4\n</code></pre>\n\n<h2>Question:</h2>\n\n<p>Why does GVM not seem to be installed? How do I get rid of the error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1483462161, "post_id": 41447105, "comment_id": 70103075, "body": "The <code>go doc</code> command reads the source files on every execution of the command.  There is no cache.  Please show the commands you executed, what you got and what you expected."}], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1483458555, "post_id": 41447199, "comment_id": 70100723, "body": "The <code>go doc</code> subcommand and <code>godoc</code> are different tools.   Run <code>go help doc</code> to learn how to show documentation for exported entities with the <code>go doc</code> command."}], "tags": [], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "is_accepted": false, "score": 0, "last_activity_date": 1483458438, "creation_date": 1483458438, "answer_id": 41447199, "question_id": 41447105, "link": "https://stackoverflow.com/questions/41447105/how-to-update-go-doc-against-local-file-changes/41447199#41447199", "title": "How to update go doc against local file changes?", "body": "<p>Strangey, <code>go doc</code> presents an abbreviated version of the documentation: Package documentation is included, and public members are listed, but the <code>go doc</code> command does not show the documentation for the public members, even with the <code>-u</code> option. Instead, the <code>godoc</code> tool must be used.</p>\n"}], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1483458438, "creation_date": 1483458073, "question_id": 41447105, "link": "https://stackoverflow.com/questions/41447105/how-to-update-go-doc-against-local-file-changes", "title": "How to update go doc against local file changes?", "body": "<p>When I tweak my Go documentation, <code>go doc</code> shows the old documentation instead. How do I get <code>go doc</code> to update its cache against local file changes?</p>\n"}, {"tags": ["go", "deployment"], "answers": [{"comments": [{"owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "edited": false, "score": 0, "creation_date": 1483453472, "post_id": 41445477, "comment_id": 70097470, "body": "Should then I in general case just choose amd64, deploy on a amd64 platform and don&#39;t think about it ever?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "edited": false, "score": 0, "creation_date": 1483453595, "post_id": 41445477, "comment_id": 70097545, "body": "@SergeiBasharov Yeah, that&#39;s what I&#39;d do."}, {"owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "edited": false, "score": 0, "creation_date": 1483453651, "post_id": 41445477, "comment_id": 70097587, "body": "Thank you for the answer!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1483462519, "last_edit_date": 1483462519, "creation_date": 1483452867, "answer_id": 41445477, "question_id": 41445348, "link": "https://stackoverflow.com/questions/41445348/what-goarch-to-set-for-my-webapp-written-in-go/41445477#41445477", "title": "What GOARCH to set for my webapp written in Go?", "body": "<p>Set the one that matches the architecture of your droplet. You can view this on your  droplets list. Note that targeting the <code>386</code> platform you can run it on both <code>386</code> and <code>amd64</code> platforms, while compiling to <code>amd64</code> you can only run it on <code>amd64</code>.</p>\n\n<p>If you're asking which to choose, then it's up to you. Know that some operations are faster on <code>amd64</code> (especially those which use / involve 64-bit values like <code>int64</code>), and also some features of the Go tool are only available if you target the <code>amd64</code> architecture, for example the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">race detector</a>, <a href=\"https://golang.org/doc/articles/race_detector.html#Supported_Systems\" rel=\"nofollow noreferrer\">Supported Systems</a>:</p>\n\n<blockquote>\n  <p>The race detector runs on <code>darwin/amd64</code>, <code>freebsd/amd64</code>, <code>linux/amd64</code>, and <code>windows/amd64</code>.</p>\n</blockquote>\n\n<p>Executable binary size and memory usage is somewhat bigger for <code>amd64</code>, but it's not really an issue in case of Go, as a simple, running Go web server uses like 8 MB of memory. Unless you use excessively large arrays / slices like <code>[big_number]int</code> of course, as the size of <code>int</code> will be 4 bytes on <code>386</code> and 8 bytes on <code>amd64</code>.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 41445477, "answer_count": 1, "score": 2, "last_activity_date": 1483462519, "creation_date": 1483452459, "question_id": 41445348, "link": "https://stackoverflow.com/questions/41445348/what-goarch-to-set-for-my-webapp-written-in-go", "title": "What GOARCH to set for my webapp written in Go?", "body": "<p>I want to deploy my webapp (basically CRUD) on DigitalOcean or a similar cloud provider. I found out that I can set <code>GOARCH=386</code> or <code>GOARCH=amd64</code>. Both build properly on my computer.</p>\n\n<p>How do I decide which one I need to deploy on server? There are all popular options like latest Ubuntu, Debian, CentOS.</p>\n"}, {"tags": ["loops", "go", "slice", "indices"], "comments": [{"owner": {"reputation": 1773, "user_id": 1887860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vTWIU.png?s=128&g=1", "display_name": "Matei Radu", "link": "https://stackoverflow.com/users/1887860/matei-radu"}, "edited": false, "score": 0, "creation_date": 1483453341, "post_id": 41445216, "comment_id": 70097395, "body": "In your <code>shift</code> example you are adding 1 to the index each time in addition to the usual increment of the for loop. Wouldn&#39;t this resolve in reading only arguments 1, 3, 5, etc ?"}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "reply_to_user": {"reputation": 1773, "user_id": 1887860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vTWIU.png?s=128&g=1", "display_name": "Matei Radu", "link": "https://stackoverflow.com/users/1887860/matei-radu"}, "edited": false, "score": 2, "creation_date": 1483453761, "post_id": 41445216, "comment_id": 70097655, "body": "@MateiRadu No, index is reassigned for every loop so the code works. It would probably look better with a new variable like <code>originalIndex := index + 1</code> though"}, {"owner": {"reputation": 1773, "user_id": 1887860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vTWIU.png?s=128&g=1", "display_name": "Matei Radu", "link": "https://stackoverflow.com/users/1887860/matei-radu"}, "reply_to_user": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "edited": false, "score": 0, "creation_date": 1483454577, "post_id": 41445216, "comment_id": 70098147, "body": "@FranckJeannin Thanks for the explanation, it cleared my doubts on how <code>range</code> works."}], "answers": [{"comments": [{"owner": {"reputation": 6749, "user_id": 3042856, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/aDWs9.jpg?s=128&g=1", "display_name": "Damaged Organic", "link": "https://stackoverflow.com/users/3042856/damaged-organic"}, "edited": false, "score": 0, "creation_date": 1483455644, "post_id": 41445431, "comment_id": 70098858, "body": "Thank you for answering!"}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": true, "score": 3, "last_activity_date": 1483452687, "creation_date": 1483452687, "answer_id": 41445431, "question_id": 41445216, "link": "https://stackoverflow.com/questions/41445216/go-loop-indices-for-range-on-slice/41445431#41445431", "title": "Go loop indices for range on slice", "body": "<p>There is nothing wrong with your original code, when you are doing <code>os.Args[1:]</code> you are creating a new slice which like any slice starts at index 0.<br>\nIt's a matter of style (and performance) but you could also do this:</p>\n\n<pre><code>for index, arg := range os.Args {\n    if index &lt; 1 {\n        continue\n    }\n    s += fmt.Sprintf(\"%d: %s\", index, arg)\n}\n</code></pre>\n"}], "owner": {"reputation": 6749, "user_id": 3042856, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/aDWs9.jpg?s=128&g=1", "display_name": "Damaged Organic", "link": "https://stackoverflow.com/users/3042856/damaged-organic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1754, "favorite_count": 0, "accepted_answer_id": 41445431, "answer_count": 1, "score": 5, "last_activity_date": 1483452687, "creation_date": 1483451957, "question_id": 41445216, "link": "https://stackoverflow.com/questions/41445216/go-loop-indices-for-range-on-slice", "title": "Go loop indices for range on slice", "body": "<p>I have a fairly simple question, but can't find answer anywhere. I'm iterating over a range of slices, like this:</p>\n\n<pre><code>for index, arg := range os.Args[1:] {\n    s += fmt.Sprintf(\"%d: %s\", index, arg)\n}\n</code></pre>\n\n<p>As I understand <code>range</code> iterates over a slice, and <code>index</code> is created from range, and it's zero-based. I get the output:</p>\n\n<pre><code>0: argument_1\n1: argument_2\n// etc.\n</code></pre>\n\n<p>But it's not what I expect - I need <code>range</code> to preserve indices of that slice, so my output looks like this:</p>\n\n<pre><code>1: argument_1\n2: argument_2\n// etc.\n</code></pre>\n\n<p>The most obvious way to achieve this is to add <code>shift</code> on index in loop:</p>\n\n<pre><code>shift := 1\nfor index, arg := range os.Args[shift:] {\n    index += shift\n    s += fmt.Sprintf(\"%d: %s\", index, arg)\n}\n</code></pre>\n\n<p>But I was wondering, is there more \"Go-ish\" way to do this, and also, how to preserve indices when creating a slice in Go like this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 1, "creation_date": 1483448442, "post_id": 41444049, "comment_id": 70094311, "body": "may be make that string compatible with <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">text/template</a> and parse using that?"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 1, "creation_date": 1483448977, "post_id": 41444049, "comment_id": 70094629, "body": "you need to use <code>reflection</code> package"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 482501, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1992205d1fcadd6c351506daa896c12f?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/482501/greg"}, "edited": false, "score": 0, "creation_date": 1483457806, "post_id": 41446219, "comment_id": 70100254, "body": "Thank you for a great example, i&#39;ll try to figure it out!"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 5, "last_activity_date": 1539835682, "last_edit_date": 1539835682, "creation_date": 1483455269, "answer_id": 41446219, "question_id": 41444049, "link": "https://stackoverflow.com/questions/41444049/accessing-struct-field-by-a-given-string-that-contains-the-full-path/41446219#41446219", "title": "Accessing struct field by a given string that contains the full path", "body": "<p>You need to use <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflect</a> package for this. \nHere I have written a sample function which given an instance and string key like <code>Stream.Details.Name</code> will return the <code>Name</code> from the field Details of instance <code>Stream</code></p>\n\n<p>This works for structs without <code>array</code> or <code>map</code> operators , just the <code>.</code> operator . You may extend this to support the <code>[]</code> aswell</p>\n\n<pre><code>func getValueFromStruct(keyWithDots string, object interface{}) (interface{}, error) {\n    keySlice := strings.Split(keyWithDots, \".\")\n    v := reflect.ValueOf(object)\n    // iterate through field names ,ignore the first name as it might be the current instance name\n    // you can make it recursive also if want to support types like slice,map etc along with struct\n    for _, key := range keySlice[1:] {\n        for v.Kind() == reflect.Ptr {\n            v = v.Elem()\n        }\n        // we only accept structs\n        if v.Kind() != reflect.Struct {\n            return nil, fmt.Errorf(\"only accepts structs; got %T\", v)\n        }\n\n        v = v.FieldByName(key)\n    }\n    return v, nil\n}\n</code></pre>\n\n<p>Here is golang play link : <a href=\"https://play.golang.org/p/NIRdGONZBhP\" rel=\"nofollow noreferrer\">https://play.golang.org/p/NIRdGONZBhP</a></p>\n"}, {"tags": [], "owner": {"reputation": 14824, "user_id": 360539, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7285afee2564b71451f104352eb4d79b?s=128&d=identicon&r=PG", "display_name": "BMiner", "link": "https://stackoverflow.com/users/360539/bminer"}, "is_accepted": false, "score": 0, "last_activity_date": 1539713880, "creation_date": 1539713880, "answer_id": 52841692, "question_id": 41444049, "link": "https://stackoverflow.com/questions/41444049/accessing-struct-field-by-a-given-string-that-contains-the-full-path/52841692#52841692", "title": "Accessing struct field by a given string that contains the full path", "body": "<p>This library also exists, which might do what you want:\n<a href=\"https://github.com/mcuadros/go-lookup\" rel=\"nofollow noreferrer\">https://github.com/mcuadros/go-lookup</a></p>\n\n<p>The lib uses the <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflect package</a> under the hood.</p>\n"}], "owner": {"reputation": 185, "user_id": 482501, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1992205d1fcadd6c351506daa896c12f?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/482501/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5024, "favorite_count": 3, "accepted_answer_id": 41446219, "answer_count": 2, "score": 0, "last_activity_date": 1569960415, "creation_date": 1483448188, "last_edit_date": 1569960415, "question_id": 41444049, "link": "https://stackoverflow.com/questions/41444049/accessing-struct-field-by-a-given-string-that-contains-the-full-path", "title": "Accessing struct field by a given string that contains the full path", "body": "<p>A validator package gives me back strings like this if a given field in my struct doesn't pass the validation:</p>\n\n<pre><code>myString := \"Stream.Fields[0].Name\"\n</code></pre>\n\n<p>How can i use this string to gain access to the struct field specified in it? I need to reference it somehow but i have no idea where to start with.</p>\n\n<p>I'm beginning to learn Go and already came across the \"Reflect\" package which seems to be able to do that but i don't know what to look for or how to formulate the right question.</p>\n"}, {"tags": ["go", "concurrency", "mutex"], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1483458147, "post_id": 41446625, "comment_id": 70100461, "body": "I read on the godoc that a mutex satisfies the sync.Locker interface, but didn&#39;t really understand what it meant. I was looking for an explination. Also, how would I use a mutex to lock only a specific variable? (It&#39;s up to you to decide what that signifies?)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 1, "creation_date": 1483458409, "post_id": 41446625, "comment_id": 70100628, "body": "@Acidic: <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">&quot;Interfaces&quot;</a> are a primary Go concept that you need to understand to use the language. Maybe start with the official documentation, like the corresponding sections in <a href=\"https://golang.org/doc/effective_go.html#interfaces\" rel=\"nofollow noreferrer\">Effective Go</a>, or the <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">Tour of Go</a>. There simply is no relation between a mutex and what it locks other than how you use it in your code."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1483462377, "last_edit_date": 1483462377, "creation_date": 1483456579, "answer_id": 41446625, "question_id": 41443369, "link": "https://stackoverflow.com/questions/41443369/golang-mutex-to-lock-specific-variable-map/41446625#41446625", "title": "Golang Mutex to Lock Specific Variable/Map", "body": "<ol>\n<li>A <code>Mutex</code> only locks itself. It's up to you to decide what that lock signifies in your code.</li>\n<li>Use channels for synchronizing and communicating between goroutines. Use a mutex to provide \"mutual exclusion\" around a single logical resource. </li>\n<li>A mutex satisfies the <code>sync.Locker</code> interface. Something that requires a <code>sync.Locker</code> could use a <code>sync.Mutex</code> or a <code>sync.RWMutex</code> interchangeably. </li>\n</ol>\n\n<p>Synchronization primitives aren't related to the concept of preventing duplicate transactions. Correct use of synchronization will only prevent data races in your program. </p>\n"}, {"comments": [{"owner": {"reputation": 35732, "user_id": 107783, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c4a45b6251a361ee85ac1d3c2bcb2d62?s=128&d=identicon&r=PG", "display_name": "Luke Puplett", "link": "https://stackoverflow.com/users/107783/luke-puplett"}, "edited": false, "score": 1, "creation_date": 1583608157, "post_id": 41447192, "comment_id": 107177380, "body": "-1 Sorry Dan,  the OP asks what exactly is locked and this is not answered. There are links to more details but links rot and SO answers should include all relevant detail in the text of the answer."}, {"owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "reply_to_user": {"reputation": 35732, "user_id": 107783, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c4a45b6251a361ee85ac1d3c2bcb2d62?s=128&d=identicon&r=PG", "display_name": "Luke Puplett", "link": "https://stackoverflow.com/users/107783/luke-puplett"}, "edited": false, "score": 0, "creation_date": 1602682757, "post_id": 41447192, "comment_id": 113797852, "body": "<i>asks what exactly is locked</i> .... Hmmm, I guess I thought I answered that with &quot;mutexes let programmers define a critical section of code that can only be entered by a single thread of execution&quot;"}, {"owner": {"reputation": 35732, "user_id": 107783, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c4a45b6251a361ee85ac1d3c2bcb2d62?s=128&d=identicon&r=PG", "display_name": "Luke Puplett", "link": "https://stackoverflow.com/users/107783/luke-puplett"}, "edited": false, "score": 1, "creation_date": 1602691351, "post_id": 41447192, "comment_id": 113802549, "body": "I think the confusion comes because in other languages a <code>lock</code> statement would apply to an object reference. More confusion exists because a Mutex in Win32 is system wide, its one way for an app to know another is running, so &quot;what gets locked&quot; is just an identifier, e.g. your app name."}], "tags": [], "owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "is_accepted": true, "score": 4, "last_activity_date": 1483458414, "creation_date": 1483458414, "answer_id": 41447192, "question_id": 41443369, "link": "https://stackoverflow.com/questions/41443369/golang-mutex-to-lock-specific-variable-map/41447192#41447192", "title": "Golang Mutex to Lock Specific Variable/Map", "body": "<p><strong>What is a Mutex?</strong></p>\n\n<p>In general, a \"mutual exclusion\" construct (or mutex) helps with concurrency control.  Languages that define mutexes let programmers define a critical section of code that can only be entered by a single thread of execution.  <a href=\"https://gobyexample.com/mutexes\" rel=\"nofollow noreferrer\">Here is a simple example of using mutexes in Go</a>.  <a href=\"https://kylewbanks.com/blog/tutorial-synchronizing-state-with-mutexes-golang\" rel=\"nofollow noreferrer\">Here is a bit more detailed example of using mutexes</a>.</p>\n\n<p><strong>Mutex or Channel?</strong></p>\n\n<p>When deciding whether to use a mutex or channel based design in your Go app, the choices aren't always terribly clear.  This <a href=\"https://github.com/golang/go/wiki/MutexOrChannel\" rel=\"nofollow noreferrer\">wiki article from the Go github repo </a> has the following advice:</p>\n\n<p><em>Channel</em>: passing ownership of data,\ndistributing units of work,\ncommunicating async results </p>\n\n<p><em>Mutex</em>: caches, state</p>\n\n<p><strong>Mutex or sync.Locker?</strong></p>\n\n<p>As @JimB pointed out, the <a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"nofollow noreferrer\"><code>sync.Mutex</code></a> type in Go satisfies the <a href=\"https://golang.org/pkg/sync/#Locker\" rel=\"nofollow noreferrer\"><code>sync.Locker</code></a> interface type.  Notice how <code>sync.Mutex</code> has <code>Lock()</code> and <code>Unlock()</code> methods?  So to Go, a <code>sync.Mutex</code> is a <code>sync.Locker</code>.  </p>\n\n<p>For more <a href=\"http://jordanorelli.com/post/32665860244/how-to-use-interfaces-in-go\" rel=\"nofollow noreferrer\">help with Go interfaces, check out this great blog post</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 7317815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c992f37946da8a3240042a90c0f65e?s=128&d=identicon&r=PG&f=1", "display_name": "XGoVoid", "link": "https://stackoverflow.com/users/7317815/xgovoid"}, "is_accepted": false, "score": 0, "last_activity_date": 1483486646, "creation_date": 1483486646, "answer_id": 41454037, "question_id": 41443369, "link": "https://stackoverflow.com/questions/41443369/golang-mutex-to-lock-specific-variable-map/41454037#41454037", "title": "Golang Mutex to Lock Specific Variable/Map", "body": "<p>If the state is not in memory. You really don't need synchronous locks. But let's say all of the users wallets are inside of one Map. You would need one because concurrent writes will cause a race condition. </p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2075, "favorite_count": 1, "accepted_answer_id": 41447192, "answer_count": 3, "score": 5, "last_activity_date": 1483486646, "creation_date": 1483445758, "question_id": 41443369, "link": "https://stackoverflow.com/questions/41443369/golang-mutex-to-lock-specific-variable-map", "title": "Golang Mutex to Lock Specific Variable/Map", "body": "<p>I'm a little confused on how mutex's work in Golang, even though I've used them before.</p>\n\n<p><strong>Here are my questions:</strong></p>\n\n<ol>\n<li><p>What exactly does a mutex lock? (How) Do you use it to lock a specific variable only?</p></li>\n<li><p>Should I use channels instead of a mutex?</p></li>\n<li><p>Is there a difference between a mutex and a locker?</p></li>\n</ol>\n\n<p>I'm developing a highly concurrent website with golang, and I need to manage each person's wallet at different times and I am trying to avoid any races in my program. For example, if my program wants to add 500 credits to a user, it will read the current balance for the user (from firebase) and add 500 then update the value. But if it does this twice for some reason, there may be an incorrect change to the user's wallet.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 7, "creation_date": 1483438057, "post_id": 41440601, "comment_id": 70087932, "body": "<code>wg.Add(len(listOfDevices))</code> in the loop seems wrong, move it before the loop. Or replace it with <code>wg.Add(1)</code>."}, {"owner": {"reputation": 121, "user_id": 619449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13c3020f8339d37a1253bbb18048ce5?s=128&d=identicon&r=PG", "display_name": "kca", "link": "https://stackoverflow.com/users/619449/kca"}, "edited": false, "score": 2, "creation_date": 1483474569, "post_id": 41440601, "comment_id": 70109658, "body": "What is inchan defined as? Is it a buffered channel or a channel with a constant reader?"}, {"owner": {"reputation": 4498, "user_id": 58768, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9bbffd2d873441279b4661070e8add4b?s=128&d=identicon&r=PG", "display_name": "bohdan_trotsenko", "link": "https://stackoverflow.com/users/58768/bohdan-trotsenko"}, "edited": false, "score": 0, "creation_date": 1483481388, "post_id": 41440601, "comment_id": 70112771, "body": "It looks like inchan has capacity of 1, play with bigger values."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7045754, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_dPZMwhZcyY/AAAAAAAAAAI/AAAAAAAAAC0/95OP3XEgFx4/photo.jpg?sz=128", "display_name": "Charn R", "link": "https://stackoverflow.com/users/7045754/charn-r"}, "is_accepted": false, "score": -1, "last_activity_date": 1483440415, "creation_date": 1483440415, "answer_id": 41441733, "question_id": 41440601, "link": "https://stackoverflow.com/questions/41440601/concurrent-goroutines-inside-a-for-loop/41441733#41441733", "title": "Concurrent goroutines inside a for loop", "body": "<p>do it like following</p>\n\n<pre><code>for ;;{\n        wg.Add(1)\n        go func(){\n            defer wg.Done()\n        }\n    }\n    wg.Wait()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 1, "last_activity_date": 1483498929, "last_edit_date": 1495535457, "creation_date": 1483498929, "answer_id": 41455583, "question_id": 41440601, "link": "https://stackoverflow.com/questions/41440601/concurrent-goroutines-inside-a-for-loop/41455583#41455583", "title": "Concurrent goroutines inside a for loop", "body": "<p>Try using the goroutine <strong>closure</strong>:</p>\n\n<pre><code>            go func(c context.Context) {\n                    defer wg.Done()\n                    pingOneMachine.Run(c)\n            }(ctx) // pass in the lexically scoped variable here\n</code></pre>\n\n<p>That is, the <code>ctx</code> variable name is being overridden in the for loop before it is used in the goroutine (as the variables are lexically scoped), see this question for a nice explanation <a href=\"https://stackoverflow.com/questions/25919213/why-does-golang-handle-closures-differently-in-goroutines\">Why does Golang handle closures differently in goroutines?</a></p>\n\n<p>Basically variables are passed by reference:</p>\n\n<blockquote>\n  <p>This means that any variables referenced within the closure from the \"outer\" scope are not a copy but are in fact a reference.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "is_accepted": false, "score": 0, "last_activity_date": 1483523349, "creation_date": 1483523349, "answer_id": 41460736, "question_id": 41440601, "link": "https://stackoverflow.com/questions/41440601/concurrent-goroutines-inside-a-for-loop/41460736#41460736", "title": "Concurrent goroutines inside a for loop", "body": "<pre><code>for ;;{\n    wg.Add(1)\n    go func(ip string){\n        defer wg.Done()\n    }(ip)\n}\nwg.Wait()\n</code></pre>\n\n<p>It worked in creating parallel goroutines for all the ip addresses.</p>\n"}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2050, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1483523349, "creation_date": 1483436894, "question_id": 41440601, "link": "https://stackoverflow.com/questions/41440601/concurrent-goroutines-inside-a-for-loop", "title": "Concurrent goroutines inside a for loop", "body": "<p>I have written goroutine inside for loop as follow. What I want is to execute the goroutine for each item in the listofDevices list concurrently but this logic is running goroutine for only one item in the listofDevices list.</p>\n\n<pre><code>    for _, ip := range listOfDevices {\n            inChan &lt;- types.NewNotification(time.Now(), \"/cloudtracer/status\", nil,\n                    &amp;map[key.Key]interface{}{\n                            key.New(ip): types.Pointer{Pointer: \"/cloudtracer/status/\" + ip},\n                    })\n            pingOneMachine := probe.NewPing(ip, 2*time.Second, inChan)\n            // For now stopping the probe after few minutes. This will change later\n            ctx, cancel := context.WithTimeout(context.Background(), 2*time.Second)\n            defer cancel()\n\n            wg.Add(len(listOfDevices))\n            go func() {\n                    defer wg.Done()\n                    pingOneMachine.Run(ctx)\n            }()\n    }\n    wg.Wait()\n</code></pre>\n\n<p>Can anyone help me in fixing this out?\nthanks in advance.</p>\n"}, {"tags": ["python", "google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 771, "user_id": 4783390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xZo2V.jpg?s=128&g=1", "display_name": "Nilo_DS", "link": "https://stackoverflow.com/users/4783390/nilo-ds"}, "edited": false, "score": 0, "creation_date": 1483495114, "post_id": 41451339, "comment_id": 70116617, "body": "Have you tried to deploy it from the GCP console? Using the GCP repository service?"}], "tags": [], "owner": {"reputation": 771, "user_id": 4783390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xZo2V.jpg?s=128&g=1", "display_name": "Nilo_DS", "link": "https://stackoverflow.com/users/4783390/nilo-ds"}, "is_accepted": true, "score": 0, "last_activity_date": 1483531613, "last_edit_date": 1483531613, "creation_date": 1483473333, "answer_id": 41451339, "question_id": 41439736, "link": "https://stackoverflow.com/questions/41439736/cant-get-over-you-do-not-have-permission-to-modify-this-app/41451339#41451339", "title": "can&#39;t get over &quot;You do not have permission to modify this app&quot;", "body": "<p>Try checking the appengine-web file at /webapp/WEB-INF sounds like you have a reserved application name or application+version</p>\n\n<p>Edit: For further consultation I am adding the conclusion of the thread.</p>\n\n<p>Deploying from the GCP console was a valid workaround to the issue.</p>\n\n<p><a href=\"https://cloud.google.com/sdk/gcloud/reference/app/create\" rel=\"nofollow noreferrer\">https://cloud.google.com/sdk/gcloud/reference/app/create</a></p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/python/tools/uploadinganapp\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/python/tools/uploadinganapp</a></p>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 3744986, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/065d2b2ed7f25494b55a095a94b1ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Sobotka", "link": "https://stackoverflow.com/users/3744986/adam-sobotka"}, "is_accepted": false, "score": 0, "last_activity_date": 1483520391, "creation_date": 1483520391, "answer_id": 41459802, "question_id": 41439736, "link": "https://stackoverflow.com/questions/41439736/cant-get-over-you-do-not-have-permission-to-modify-this-app/41459802#41459802", "title": "can&#39;t get over &quot;You do not have permission to modify this app&quot;", "body": "<p>Hint from Nilo_DS was pointing in right direction. Using gcloud commands, I was able to upload app correctly. Still not sure what is going on when using goapp command, but this workaround is good enough for me.\nCommands I used were </p>\n\n<pre><code>gcloud init\ngcloud beta app create\ngcloud deploy\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 3744986, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/065d2b2ed7f25494b55a095a94b1ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Sobotka", "link": "https://stackoverflow.com/users/3744986/adam-sobotka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 41451339, "answer_count": 2, "score": 1, "last_activity_date": 1483531613, "creation_date": 1483433879, "last_edit_date": 1483522721, "question_id": 41439736, "link": "https://stackoverflow.com/questions/41439736/cant-get-over-you-do-not-have-permission-to-modify-this-app", "title": "can&#39;t get over &quot;You do not have permission to modify this app&quot;", "body": "<p>I tried:</p>\n\n<pre><code>rm ~/.appcfg_oauth2_tokens\n</code></pre>\n\n<p>Whole process with page authentication finish successfully for both accounts (owner role) with same result</p>\n\n<pre><code>appcfg.py update --no_cookies\n</code></pre>\n\n<p>Same result</p>\n\n<pre><code>appcfg.py update --noauth_local_webserver\n</code></pre>\n\n<p>Token is displayed, accepted in terminal, process continues towards same result.</p>\n\n<p>I also tried to add another google account as owner, with same result. When I mistype application name, error is different, so I guess this is not a problem. <code>Goapp</code> deploy and <code>appcfg</code> seems to be same tool basically, both have same results in the end.</p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["go", "packages"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1483435834, "post_id": 41439435, "comment_id": 70086471, "body": "The most idiomatic approach is to define interface{} types that describe the methods your drop-in type has to satisfy, like net/http&#39;s <code>Handler</code>."}, {"owner": {"reputation": 334, "user_id": 821330, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/33b4306524b28d3fbca3a69ff7f5dbfd?s=128&d=identicon&r=PG", "display_name": "Matteo Suppo", "link": "https://stackoverflow.com/users/821330/matteo-suppo"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1483438999, "post_id": 41439435, "comment_id": 70088543, "body": "Unfortunately the interfaces work only for methods of structs, not for package scoped functions."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1483543272, "post_id": 41439435, "comment_id": 70140061, "body": "You seem to know what needs to be done -- you need to mirror all the exported symbols. Embedding is just a form of automatic delegation, so you can use it where it works, and do it manually where it doesn&#39;t. There&#39;s no magic to be had here."}], "answers": [{"comments": [{"owner": {"reputation": 334, "user_id": 821330, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/33b4306524b28d3fbca3a69ff7f5dbfd?s=128&d=identicon&r=PG", "display_name": "Matteo Suppo", "link": "https://stackoverflow.com/users/821330/matteo-suppo"}, "edited": false, "score": 0, "creation_date": 1483438938, "post_id": 41440340, "comment_id": 70088505, "body": "Yes but my question was about the design of the package."}, {"owner": {"reputation": 321, "user_id": 1203241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVfY4.jpg?s=128&g=1", "display_name": "Fenjin", "link": "https://stackoverflow.com/users/1203241/fenjin"}, "reply_to_user": {"reputation": 334, "user_id": 821330, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/33b4306524b28d3fbca3a69ff7f5dbfd?s=128&d=identicon&r=PG", "display_name": "Matteo Suppo", "link": "https://stackoverflow.com/users/821330/matteo-suppo"}, "edited": false, "score": 1, "creation_date": 1483702977, "post_id": 41440340, "comment_id": 70215125, "body": "You mean you want to create a new package which has the same interface as the previous one?   If that&#39;s the case, it depends on what you want to do in your new package. From your question, seems don&#39;t need to create a new package as the functionality is the same. If not same, you can do whatever you like write a brand new package but with same interface."}], "tags": [], "owner": {"reputation": 321, "user_id": 1203241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVfY4.jpg?s=128&g=1", "display_name": "Fenjin", "link": "https://stackoverflow.com/users/1203241/fenjin"}, "is_accepted": false, "score": 1, "last_activity_date": 1483436054, "creation_date": 1483436054, "answer_id": 41440340, "question_id": 41439435, "link": "https://stackoverflow.com/questions/41439435/wrapping-a-package-in-golang/41440340#41440340", "title": "Wrapping a package in golang", "body": "<p>I think not. Just use the original package, you could use alias if you want to use your own version.</p>\n\n<p>Let's say currently your code is:</p>\n\n<pre><code>import (\n    \"abc.com/package/foo\"\n)\n\nfunc CallFoo() {\n    foo.DoSomething()\n}\n</code></pre>\n\n<p>You can replace foo with bar by alias the import, other codes remain the same.</p>\n\n<pre><code>import (\n    foo \"abc.com/package/bar\" // this is alias\n)\n\nfunc CallFoo() {\n    foo.DoSomething()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 334, "user_id": 821330, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/33b4306524b28d3fbca3a69ff7f5dbfd?s=128&d=identicon&r=PG", "display_name": "Matteo Suppo", "link": "https://stackoverflow.com/users/821330/matteo-suppo"}, "is_accepted": true, "score": 1, "last_activity_date": 1483976731, "creation_date": 1483976731, "answer_id": 41551648, "question_id": 41439435, "link": "https://stackoverflow.com/questions/41439435/wrapping-a-package-in-golang/41551648#41551648", "title": "Wrapping a package in golang", "body": "<p>Seems like this is the idiomatic way. No magic.</p>\n"}], "owner": {"reputation": 334, "user_id": 821330, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/33b4306524b28d3fbca3a69ff7f5dbfd?s=128&d=identicon&r=PG", "display_name": "Matteo Suppo", "link": "https://stackoverflow.com/users/821330/matteo-suppo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1257, "favorite_count": 0, "accepted_answer_id": 41551648, "answer_count": 2, "score": 1, "last_activity_date": 1483976731, "creation_date": 1483432744, "question_id": 41439435, "link": "https://stackoverflow.com/questions/41439435/wrapping-a-package-in-golang", "title": "Wrapping a package in golang", "body": "<p>Imagine a package that exports some structs and some functions. </p>\n\n<p>If I wanted to make a wrapper around that package, so that it could be used as a drop-in,  should I recreate the structs with the old struct embedded in it? Example:</p>\n\n<pre><code>package foo\n\ntype Foo struct {\n    Field string\n}\n\nfunc DoSomething() {\n\n}\n</code></pre>\n\n<hr>\n\n<pre><code>package bar\n\nimport foo\n\ntype Foo struct {\n    foo.Foo\n}\n\nfunc DoSomething() {\n    foo.DoSomething()\n}\n</code></pre>\n\n<p>Is there a better way? Is this the idiomatic way?</p>\n"}, {"tags": ["go", "interface", "language-design", "implements"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594366431, "post_id": 41437046, "comment_id": 111106103, "body": "Interfaces can be added to existing code in an ad hoc manner because of Go\u2019s inferred interfaces. See <a href=\"https://stackoverflow.com/questions/11054830/if-gos-interfaces-arent-enforced-are-they-necessary/62297796#62297796\" title=\"if gos interfaces arent enforced are they necessary\">stackoverflow.com/questions/11054830/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 7, "last_activity_date": 1483422570, "last_edit_date": 1495535363, "creation_date": 1483422061, "answer_id": 41437097, "question_id": 41437046, "link": "https://stackoverflow.com/questions/41437046/golang-inferred-interfaces/41437097#41437097", "title": "Golang inferred interfaces", "body": "<p>This allow to evolve to provide interface even for legacy types (which never explicitly declared respecting said interface)</p>\n\n<p>If those types already provide the right methods (ie the same API as the one specified by your interface), they will satisfy that interface.</p>\n\n<p>That allows to maintain a low coupling between those legacy types (which have no idea your interface exist) and your program, which accepts instances of that interface.</p>\n\n<p>See \"<a href=\"https://stackoverflow.com/a/11753508/6309\">What are some examples of Go interfaces?</a>\"</p>\n\n<blockquote>\n  <p>Go's interfaces aren't a variant on Java or C# interfaces, they're much more.<br>\n  They are a key to large-scale programming and adaptable, evolutionary design.</p>\n  \n  <p>\"It's the fact that I don't have to spend time up front designing some sort of type hierarchy and then rearranging it two or three times before I finish.<br>\n  It's not even the fact that it's easy to do it right -<br>\n  it's the fact that I just don't have to worry about it and can get on with the actual algorithm.\"</p>\n</blockquote>\n\n<p>Those quotes are from this <a href=\"http://golangtutorials.blogspot.fr/2012/01/interfaces-in-go-part-2-aiding.html\" rel=\"nofollow noreferrer\">2012 article</a>, and also from <a href=\"https://news.ycombinator.com/item?id=3371884\" rel=\"nofollow noreferrer\">this thread</a>, where you can read <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/mg-8_jMyasY/lo-kDuEd540J\" rel=\"nofollow noreferrer\">Rob Pike's comment</a>:</p>\n\n<blockquote>\n  <p>\"It's always bothered me in OO languages that we can make Circle, Square, etc. subclasses of Shape (say), but that's the one design decision we get to make.<br>\n  What if we want to align those things along other axes (so to speak), like topological genus or plant genus, if you're a landscaper? You might lose your way or dig yourself into a hole with multiple inheritance.\"</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1483431267, "last_edit_date": 1483431267, "creation_date": 1483429923, "answer_id": 41438757, "question_id": 41437046, "link": "https://stackoverflow.com/questions/41437046/golang-inferred-interfaces/41438757#41438757", "title": "Golang inferred interfaces", "body": "<p>Extending VonC's answer.</p>\n\n<p>From the question:</p>\n\n<blockquote>\n  <p>But why is it that in Go, there are no explicit ways to show what interfaces a struct conforms to?</p>\n</blockquote>\n\n<p>Actually there are some ways. See <a href=\"https://golang.org/doc/faq#guarantee_satisfies_interface\" rel=\"nofollow noreferrer\">Go FAQ: How can I guarantee my type satisfies an interface?</a></p>\n\n<p>Let's say we have the following interface:</p>\n\n<pre><code>type Sayer interface {\n    Say() string\n}\n</code></pre>\n\n<p>And we want to create a new type implementing it:</p>\n\n<pre><code>type MySayer struct{}\n\nfunc (ms MySayer) Say() string {\n    return \"Foo\"\n}\n</code></pre>\n\n<p>In this case <code>MySayer</code> implements <code>Sayer</code>. To make sure it does, you can add the following line:</p>\n\n<pre><code>var _ Sayer = MySayer{}\n</code></pre>\n\n<p>Should you mistype something, e.g. name your <code>Say()</code> method <code>Sai()</code>, it will be a compile-time error.</p>\n\n<p>Still, this is just a compile-time \"check\", and it does not document that <code>MySayer</code> implements <code>Sayer</code>. For this purpose you may add a \"dummy\" method whose <em>name itself</em> documents this property:</p>\n\n<pre><code>type Sayer interface {\n    Say() string\n    ImplementsSayer()\n}\n</code></pre>\n\n<p>Now for any type to implement <code>Sayer</code>, they must declare a method named <code>ImplementsSayer()</code>, which judged by just a glimpse tells you it implements <code>Sayer</code>:</p>\n\n<pre><code>func (MySayer) ImplementsSayer() {}\n</code></pre>\n\n<p>You don't even need to name the receiver as it is not used. The line reads in plain English: <em>\"MySayer implements Sayer\"</em>.</p>\n\n<p>Since this method is exported (starts with a capital letter), it also appears in docs, telling in your face that it implements <code>Sayer</code>. But as the FAQ says:</p>\n\n<blockquote>\n  <p>Most code doesn't make use of such constraints, since they limit the utility of the interface idea. Sometimes, though, they're necessary to resolve ambiguities among similar interfaces.</p>\n</blockquote>\n"}], "owner": {"reputation": 805, "user_id": 4064189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93b53dfc49377dc86f486a9e59200122?s=128&d=identicon&r=PG", "display_name": "Mike JS Choi", "link": "https://stackoverflow.com/users/4064189/mike-js-choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 4, "accepted_answer_id": 41437097, "answer_count": 2, "score": 3, "last_activity_date": 1483431806, "creation_date": 1483421727, "last_edit_date": 1483431806, "question_id": 41437046, "link": "https://stackoverflow.com/questions/41437046/golang-inferred-interfaces", "title": "Golang inferred interfaces", "body": "<p>Just a simple language design related question here.\nIn languages like Swift, in order for a struct/class to conform to a protocol/interface, one needs to explicitly declare it as such</p>\n\n<pre><code>struct Dog: Animal {\n    // implementation of Animal protocols here\n}\n</code></pre>\n\n<p>But why is it that in Go, there are no explicit ways to show what interfaces a struct conforms to?</p>\n\n<p>Isn't this just making things unclear or are there any other reasons behind it?</p>\n"}, {"tags": ["networking", "go", "ssh"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483469152, "post_id": 41436235, "comment_id": 70107045, "body": "How are you closing the session to the remote machine? The ssh server should be cleaning up the connection if the session has been terminated. \u2013"}, {"owner": {"reputation": 67, "user_id": 2915676, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb01246d13713981fd47714eadb54179?s=128&d=identicon&r=PG&f=1", "display_name": "shreyashk", "link": "https://stackoverflow.com/users/2915676/shreyashk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483504403, "post_id": 41436235, "comment_id": 70118697, "body": "I&#39;m testing ssh failure by blocking ssh connections on port 2222 (the port on which I&#39;m ssh-ing) using the following command: <code>sudo iptables -D INPUT -p tcp --dport 2222 -j DROP</code>. This doesn&#39;t seem to clean up the terminated session."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483540860, "post_id": 41436235, "comment_id": 70138419, "body": "If you&#39;re just dropping packets, the remote server has no way to know you&#39;ve terminated the session."}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 2915676, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb01246d13713981fd47714eadb54179?s=128&d=identicon&r=PG&f=1", "display_name": "shreyashk", "link": "https://stackoverflow.com/users/2915676/shreyashk"}, "is_accepted": false, "score": 0, "last_activity_date": 1485760962, "creation_date": 1485760962, "answer_id": 41930726, "question_id": 41436235, "link": "https://stackoverflow.com/questions/41436235/ssh-listener-not-closing/41930726#41930726", "title": "SSH Listener not closing", "body": "<p>I'm just waiting for the timeout after reconnecting. I found no other easy solution for this.</p>\n"}], "owner": {"reputation": 67, "user_id": 2915676, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb01246d13713981fd47714eadb54179?s=128&d=identicon&r=PG&f=1", "display_name": "shreyashk", "link": "https://stackoverflow.com/users/2915676/shreyashk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1485760962, "creation_date": 1483416109, "question_id": 41436235, "link": "https://stackoverflow.com/questions/41436235/ssh-listener-not-closing", "title": "SSH Listener not closing", "body": "<p>I'm trying to write a go application that would allow me to perform reverse ssh tunneling between a Windows machine and a Linux machine using the go ssh library.</p>\n\n<p>In the process of doing so, I create a listener on the remote machine, as follows:\n<code>\nremoteListener, err := sshClient.Listen(\"tcp\", remoteString)\n</code></p>\n\n<p>where sshClient is an object of type ssh.Client and is configured to connect to the remote machine.</p>\n\n<p>The issue here is that when the sshd process on the Linux machine disrupts the connection with the application, the ssh Listener remains alive on the remote machine. So, reconnecting with the application fails because a listener is already running on the same port on the remote machine.</p>\n\n<p>How do I get around this issue? Does the ssh library allow me to define a timeout on the listener?</p>\n"}, {"tags": ["http", "amazon-web-services", "go", "amazon-s3", "goamz"], "answers": [{"tags": [], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "is_accepted": true, "score": 1, "last_activity_date": 1483442946, "creation_date": 1483442946, "answer_id": 41442493, "question_id": 41434410, "link": "https://stackoverflow.com/questions/41434410/unsupported-protocol-scheme-in-golang-with-aws-s3-and-goamz/41442493#41442493", "title": "Unsupported Protocol Scheme &quot;&quot; in Golang with AWS S3 and goamz", "body": "<p>To anyone who might have the same issue. It is an error you get when the bucket name is not set. Seems stupid, but I was running this inside docker, and had forgot to tell docker what the enviroment variable was that held the bucket name. Therefore when I did <code>echo $S3_BUCKET</code> on my terminal, I got the bucket name, and therefore thought all was good. However I didn't test that inside the docker container. Fool on me.</p>\n"}], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3839, "favorite_count": 0, "accepted_answer_id": 41442493, "answer_count": 1, "score": 2, "last_activity_date": 1483442946, "creation_date": 1483398946, "last_edit_date": 1495542327, "question_id": 41434410, "link": "https://stackoverflow.com/questions/41434410/unsupported-protocol-scheme-in-golang-with-aws-s3-and-goamz", "title": "Unsupported Protocol Scheme &quot;&quot; in Golang with AWS S3 and goamz", "body": "<p>Trying to upload file bytes to S3 AWS, using the goamz/s3 package in Go (lang).</p>\n\n<p>My code is:</p>\n\n<pre><code>var (\n    awsAuth aws.Auth\n    region aws.Region\n    connection s3.S3\n    bucket *s3.Bucket\n)\nfunc init() {\n\n    // Set up the AWS S3 Connection config.\n    awsAuth = aws.Auth{\n        AccessKey: os.Getenv(\"ACCESS_KEY\"), // change this to yours\n        SecretKey: os.Getenv(\"SECRET_KEY\"),\n    }\n    fmt.Println(\"AWS: \", awsAuth)\n    region := aws.EUWest    \n    connection := s3.New(awsAuth, region)\n\n    bucket = connection.Bucket(os.Getenv(\"S3_BUCKET\")) // change this your bucket name\n}\nfunc uploadToS3(filename string, byteArray *[]byte) error {\n\n    var err error\n    //should check if file already uploaded, encrypted by this password\n    fmt.Printf(\"[uploadToS3] starting upload of %s\\n\", filename)\n\n    err = bucket.Put(filename, *byteArray, \"text/plain; charset=utf-8\", s3.PublicRead)\n    if err != nil {\n        fmt.Printf(\"[uploadToS3] error uploading: %s\\n\", err)\n        return err\n    } else {\n        fmt.Printf(\"[uploadToS3] done uploading %s\\n\", filename)    \n        return nil\n    }\n\n    return nil // redundancy\n}\n</code></pre>\n\n<p>I get the error </p>\n\n<p><code>[uploadToS3] error uploading: Put /filename: unsupported protocol scheme \"\"</code></p>\n\n<p>Reading from here: <a href=\"https://stackoverflow.com/questions/26505623/unsupported-protocol-scheme-while-creating-ec2-security-group\">unsupported protocol scheme while creating ec2 Security group</a> it reckons that its because the region is incorrect, however as you can see I am setting that in the init() function so I don't know what else it could be</p>\n\n<p>Any thoughts greatly appreciated</p>\n"}, {"tags": ["javascript", "jquery", "json", "go", "highcharts"], "answers": [{"comments": [{"owner": {"reputation": 244, "user_id": 6678740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/OmpyY.jpg?s=128&g=1", "display_name": "pascalallen", "link": "https://stackoverflow.com/users/6678740/pascalallen"}, "edited": false, "score": 0, "creation_date": 1483454631, "post_id": 41444227, "comment_id": 70098187, "body": "This is exactly what I&#39;m looking for. Thank you for your help. If i needed to add another level under people, what would be the easiest way to do that?"}], "tags": [], "owner": {"reputation": 11715, "user_id": 5419325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deed52c8a3e3f1d828166e1e19d291e5?s=128&d=identicon&r=PG&f=1", "display_name": "morganfree", "link": "https://stackoverflow.com/users/5419325/morganfree"}, "is_accepted": true, "score": 1, "last_activity_date": 1483448770, "creation_date": 1483448770, "answer_id": 41444227, "question_id": 41433528, "link": "https://stackoverflow.com/questions/41433528/cant-build-multilevel-drilldown-chart-using-highchart-api/41444227#41444227", "title": "Can&#39;t build multilevel drilldown chart using Highchart API", "body": "<p>Your JS code does not work, it has syntax errors.</p>\n\n<p>Data structure for a tree is as follows:</p>\n\n<pre><code>data: [{\n    name: 'I have children',\n    id: 'id-1'\n}, {\n    name: 'I am a child',\n    parent: 'id-1',\n    value: 2\n}, {\n    name: 'I am a smaller child',\n    parent: 'id-1',\n    value: 1\n}]\n</code></pre>\n\n<p>So, your parents are offices and they have values, their children are people and they also have values - so you need to link the people with the office with the correct id. E.g. like this:</p>\n\n<pre><code>var points = [];\n\nObject.keys(data).forEach((office, i) =&gt; {\n  var people = data[office]['RM'],\n      color = Highcharts.getOptions().colors[i],\n      id = 'id_' + i;\n\n  points.push({\n    name: office,\n    value: Number(data[office]['Balance']),\n    id: id,\n    color: color\n  });\n\n  Object.keys(people).forEach((person, j) =&gt; {\n    points.push({\n      name: person,\n      value: Number(people[person]['Balance']),\n      parent: id,\n      color: color\n    });\n  });\n});\n</code></pre>\n\n<p>example: <a href=\"https://jsfiddle.net/s4LLLo4z/\" rel=\"nofollow noreferrer\">https://jsfiddle.net/s4LLLo4z/</a></p>\n"}], "owner": {"reputation": 244, "user_id": 6678740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/OmpyY.jpg?s=128&g=1", "display_name": "pascalallen", "link": "https://stackoverflow.com/users/6678740/pascalallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 41444227, "answer_count": 1, "score": 0, "last_activity_date": 1483448770, "creation_date": 1483392662, "last_edit_date": 1483393526, "question_id": 41433528, "link": "https://stackoverflow.com/questions/41433528/cant-build-multilevel-drilldown-chart-using-highchart-api", "title": "Can&#39;t build multilevel drilldown chart using Highchart API", "body": "<p>I'm having trouble building a 2 level drilldown chart using the Highcharts API. I am using Jquery's <code>$.getJSON()</code> method which retrieves data from one of my Go methods. For some reason I can't save the data to a javascript variable so I am having to build the chart within the <code>$.getJSON</code> method. I can see that the JSON is being properly displayed when I navigate to that URL. I'm having a lot of trouble manipulating the data to display the proper chart. If someone could please explain/help it would be greatly appreciated as I have been working on this for a while now and I need to get it done for my job. I will try to make this as easy as possible to understand/read. Here is what I have so far:</p>\n\n<p><strong>Go:</strong></p>\n\n<pre><code>type Office struct {\n    Austin struct {\n        Balance string\n        RM struct {\n            Matt struct {\n                Balance string\n            }\n            John struct {\n                Balance string\n            }\n            Blake struct {\n                Balance string\n            }\n            Jamie struct {\n                Balance string\n            }\n        }\n    }\n    ElPaso struct {\n        Balance string\n        RM struct {\n            Brenda struct {\n                Balance string\n            }\n            Ericka struct {\n                Balance string\n            }\n            Nicole struct {\n                Balance string\n            }\n            Stephanie struct {\n                Balance string\n            }\n            Tricia struct {\n                Balance string\n            }\n            Viri struct {\n                Balance string\n            }\n        }\n    }\n    ABL struct {\n        Balance string\n        RM struct {\n            BrianABL struct {\n                Balance string\n            }\n            JamieABL struct {\n                Balance string\n            }\n            JohnABL struct {\n                Balance string\n            }\n            MattABL struct {\n                Balance string\n            }\n            TimABL struct {\n                Balance string\n            }\n        }\n    }\n}\n\nfunc getData(res http.ResponseWriter, req *http.Request) {\n    office := Office{}\n    conn, err := sql.Open(\"mssql\", \"my db credentials\")\n    if err != nil {\n        log.Fatal(\"Open connection failed:\", err.Error())\n    }\n    defer conn.Close()\n\n    rows, err := conn.Query(\"my select query\")\n    if err != nil {\n        panic(err.Error())\n    }\n    for rows.Next() {\n        var Austin, ElPaso, ABL, Matt, John, Blake, Jamie, Brenda, Ericka, Nicole, Stephanie, Tricia, Viri, BrianABL, JamieABL, JohnABL, MattABL, TimABL string\n        rows.Scan(&amp;Austin, &amp;ElPaso, &amp;ABL, &amp;Matt, &amp;John, &amp;Blake, &amp;Jamie, &amp;Brenda, &amp;Ericka, &amp;Nicole, &amp;Stephanie, &amp;Tricia, &amp;Viri, &amp;BrianABL, &amp;JamieABL, &amp;JohnABL, &amp;MattABL, &amp;TimABL)\n        office.Austin.Balance = Austin\n            office.Austin.RM.Matt.Balance = Matt\n            office.Austin.RM.John.Balance = John\n            office.Austin.RM.Blake.Balance = Blake\n            office.Austin.RM.Jamie.Balance = Jamie\n        office.ElPaso.Balance = ElPaso\n            office.ElPaso.RM.Brenda.Balance = Brenda\n            office.ElPaso.RM.Ericka.Balance = Ericka\n            office.ElPaso.RM.Nicole.Balance = Nicole\n            office.ElPaso.RM.Stephanie.Balance = Stephanie\n            office.ElPaso.RM.Tricia.Balance = Tricia\n            office.ElPaso.RM.Viri.Balance = Viri\n        office.ABL.Balance = ABL\n            office.ABL.RM.BrianABL.Balance = BrianABL\n            office.ABL.RM.JamieABL.Balance = JamieABL\n            office.ABL.RM.JohnABL.Balance = JohnABL\n            office.ABL.RM.MattABL.Balance = MattABL\n            office.ABL.RM.TimABL.Balance = TimABL\n    }\n    js, err := json.Marshal(office)\n    if err != nil {\n        http.Error(res, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    res.Header().Set(\"Content-Type\", \"text/json\")\n    res.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    res.Write(js)\n}\n</code></pre>\n\n<p><strong>JavaScript:</strong></p>\n\n<pre><code>$.getJSON('/getdata',  function(data) {\n    for (office in data) {\n        if (data.hasOwnProperty(office)) {\n            officeVal = 0;\n            officeP = {\n                id: 'id_' + officeI,\n                name: office,\n                color: Highcharts.getOptions().colors[officeI]\n            };\n            officeBalI = 0;\n            for (officeBalance in data[office]) {\n                if (data[office].hasOwnProperty(officeBalance)) {\n                    officeBalanceP = {\n                        id: officeP.id + '_' + officeBalI,\n                        name: officeBalance,\n                        parent: officeP.id\n                    };\n                    points.push(officeBalanceP);\n                    causeI = 0;\n                    for (cause in data[office][country]) {\n                        if (data[office][country].hasOwnProperty(cause)) {\n                            causeP = {\n                                id: countryP.id + '_' + causeI,\n                                name: causeName[cause],\n                                parent: countryP.id,\n                                value: Math.round(+data[office][country][cause])\n                            };\n                            officeVal += causeP.value;\n                            points.push(causeP);\n                            causeI = causeI + 1;\n                        }\n                    }\n                    countryI = countryI + 1;\n                }\n            }\n            for (RM in data[office]) {\n                if (data[office].hasOwnProperty(RM)) {\n                    RMP = {\n                        id: officeP.id + '_' + RMI,\n                        name: RM,\n                        parent: officeP.id\n                    };\n                    points.push(RMP);\n              }\n            }\n            officeP.value = Math.round(officeVal / countryI);\n            points.push(officeP);\n            officeI = officeI + 1;\n        }\n    }\n    Highcharts.chart('container', {\n        series: [{\n            type: 'treemap',\n            layoutAlgorithm: 'squarified',\n            allowDrillToNode: true,\n            animationLimit: 1000,\n            dataLabels: {\n                enabled: false\n            },\n            levelIsConstant: false,\n            levels: [{\n                level: 1,\n                dataLabels: {\n                    enabled: true\n                },\n                borderWidth: 3\n            }],\n            data: points\n        }],\n        subtitle: {\n            text: 'Subtitle test'\n        },\n        title: {\n            text: 'Title test'\n        }\n    });\n});\n</code></pre>\n\n<p><strong>Here is my JSON response from /getdata:</strong></p>\n\n<pre><code>{\n    \"Austin\" : {\n        \"Balance\" : \"12345.12\",\n        \"RM\" : {\n            \"Matt\" : {\"Balance\" : \"12345.12\"},\n            \"John\" : {\"Balance\" : \"12345.12\"},\n            \"Blake\" : {\"Balance\" : \"12345.12\"},\n            \"Jamie\" : {\"Balance\" : \"12345.12\"}\n        }\n    },\n    \"ElPaso\" : {\n        \"Balance\" : \"12345.12\",\n        \"RM\" : {\n            \"Brenda\" : {\"Balance\" : \"12345.12\"},\n            \"Ericka\" : {\"Balance\" : \"12345.12\"},\n            \"Nicole\" : {\"Balance\" : \"12345.12\"},\n            \"Stephanie\" : {\"Balance\" : \"12345.12\"},\n            \"Tricia\" : {\"Balance\" : \"12345.12\"},\n            \"Viri\" : {\"Balance\" : \"12345.12\"}\n        }\n    },\n    \"ABL\" : {\n        \"Balance\" : \"12345.12\",\n        \"RM\" : {\n            \"BrianABL\" : {\"Balance\" : \"12345.12\"},\n            \"JamieABL\" : {\"Balance\" : \"12345.12\"},\n            \"JohnABL\" : {\"Balance\" : \"12345.12\"},\n            \"MattABL\" : {\"Balance\" : \"12345.12\"},\n            \"TimABL\" : {\"Balance\" : \"12345.12\"}\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 6, "creation_date": 1483393007, "post_id": 41433422, "comment_id": 70073020, "body": "You can write your own split function to use with a <code>Scanner</code> that splits lines in the manner you described. See <a href=\"https://golang.org/pkg/bufio/#Scanner.Split\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#Scanner.Split</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "is_accepted": true, "score": 4, "last_activity_date": 1483394752, "last_edit_date": 1483394752, "creation_date": 1483393719, "answer_id": 41433698, "question_id": 41433422, "link": "https://stackoverflow.com/questions/41433422/read-lines-from-a-file-with-variable-line-endings-in-go/41433698#41433698", "title": "Read lines from a file with variable line endings in Go", "body": "<p>You can write custom <code>bufio.SplitFunc</code> for <code>bufio.Scanner</code>. E.g:</p>\n\n<pre><code>// Mostly bufio.ScanLines code:\nfunc ScanPDFLines(data []byte, atEOF bool) (advance int, token []byte, err error) {\n    if atEOF &amp;&amp; len(data) == 0 {\n        return 0, nil, nil\n    }\n    if i := bytes.IndexAny(data, \"\\r\\n\"); i &gt;= 0 {\n        if data[i] == '\\n' {\n            // We have a line terminated by single newline.\n            return i + 1, data[0:i], nil\n        }\n        advance = i + 1\n        if len(data) &gt; i+1 &amp;&amp; data[i+1] == '\\n' {\n            advance += 1\n        }\n        return advance, data[0:i], nil\n    }\n    // If we're at EOF, we have a final, non-terminated line. Return it.\n    if atEOF {\n        return len(data), data, nil\n    }\n    // Request more data.\n    return 0, nil, nil\n}\n</code></pre>\n\n<p>And use it like:</p>\n\n<pre><code>scan := bufio.NewScanner(r)\nscan.Split(ScanPDFLines)\n</code></pre>\n"}], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 1, "accepted_answer_id": 41433698, "answer_count": 1, "score": 5, "last_activity_date": 1483394752, "creation_date": 1483392042, "question_id": 41433422, "link": "https://stackoverflow.com/questions/41433422/read-lines-from-a-file-with-variable-line-endings-in-go", "title": "Read lines from a file with variable line endings in Go", "body": "<p>How can I read lines from a file where the line endings are carriage return (CR), newline (NL), or both?</p>\n\n<p>The PDF specification allows lines to end with CR, LF, or CRLF.</p>\n\n<ul>\n<li><p><code>bufio.Reader.ReadString()</code> and <code>bufio.Reader.ReadBytes()</code> allow a single delimiter byte.</p></li>\n<li><p><code>bufio.Scanner.Scan()</code> handles <code>\\n</code> optionally preceded by <code>\\r</code>, but not a lone <code>\\r</code>.</p>\n\n<blockquote>\n  <p>The end-of-line marker is one optional carriage return followed by one mandatory newline.</p>\n</blockquote></li>\n</ul>\n\n<p>Do I need to write my own function that uses <code>bufio.Reader.ReadByte()</code>?</p>\n"}, {"tags": ["go", "go-gorm", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 4807063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9851d6b1619d4321f9237a4cfd1c4a2?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Grayson", "link": "https://stackoverflow.com/users/4807063/evan-grayson"}, "is_accepted": true, "score": 7, "last_activity_date": 1483392082, "creation_date": 1483392082, "answer_id": 41433428, "question_id": 41433207, "link": "https://stackoverflow.com/questions/41433207/gorm-db-findusers-to-json-with-gin-in-golang/41433428#41433428", "title": "gorm db.find(&amp;users) to json with gin in golang", "body": "<p>Try this: </p>\n\n<pre><code>func GetUsers(c *gin.Context) {\n users := []models.Person{}\n db.Find(&amp;users)\n c.JSON(200, &amp;users)\n}\n</code></pre>\n"}], "owner": {"reputation": 951, "user_id": 6504152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://lh6.googleusercontent.com/-QGM0TRKgJxg/AAAAAAAAAAI/AAAAAAAAABw/-jeI8itRwUY/photo.jpg?sz=128", "display_name": "Johannes Gnadlinger", "link": "https://stackoverflow.com/users/6504152/johannes-gnadlinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3686, "favorite_count": 0, "accepted_answer_id": 41433428, "answer_count": 1, "score": 1, "last_activity_date": 1489394700, "creation_date": 1483390733, "last_edit_date": 1489394700, "question_id": 41433207, "link": "https://stackoverflow.com/questions/41433207/gorm-db-findusers-to-json-with-gin-in-golang", "title": "gorm db.find(&amp;users) to json with gin in golang", "body": "<p>This is my GET Method the problem is that all i get in the json is one user instead there are 3 users in my database.</p>\n\n<pre><code>func GetUsers(c *gin.Context) {\n\nvar users = db.Find(&amp;models.Person{})\nc.JSON(200, users)\n}\n</code></pre>\n"}, {"tags": ["go", "garbage-collection", "pprof"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1483385869, "post_id": 41432213, "comment_id": 70070532, "body": "The only thing you can &quot;leak&quot; in a sense are goroutines which aren&#39;t returning. Look at a stack trace to see what you have running."}, {"owner": {"reputation": 119, "user_id": 2474697, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eaea54c85cabee9ef14a738e775e30d5?s=128&d=identicon&r=PG", "display_name": "Niels-Ole", "link": "https://stackoverflow.com/users/2474697/niels-ole"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484068918, "post_id": 41432213, "comment_id": 70354092, "body": "@JimB Thanks for the hint. I refactored the entire code now to always have a fixed amount of workers that communicate with (buffered) queues. This has stopped the runaway consumption of memory."}], "owner": {"reputation": 119, "user_id": 2474697, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eaea54c85cabee9ef14a738e775e30d5?s=128&d=identicon&r=PG", "display_name": "Niels-Ole", "link": "https://stackoverflow.com/users/2474697/niels-ole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 423, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1483385424, "creation_date": 1483384628, "last_edit_date": 1495542830, "question_id": 41432213, "link": "https://stackoverflow.com/questions/41432213/go-inuse-memory-low-while-residential-memory-is-steadily-increasing", "title": "Go inuse_memory low while residential memory is steadily increasing", "body": "<p>I am writing a program in Go that depends on regexp. The memory usage as shown in htop is steadily increasing onto the point where the program is crashing. (> 5-7GB)</p>\n\n<p>Yet when I analyze the memory usage with pprof it shows me that only a tiny fraction is actually in use. (~70MB)</p>\n\n<p>I tried manually triggering GC:</p>\n\n<pre><code>go func() {\nfor range time.Tick(30*time.Second){\n    runtime.GC()\n    debug.FreeOSMemory()\n    runtime.ReadMemStats(&amp;m)\n    fmt.Printf(\"HeapSys: %d, HeapAlloc: %d, HeapIdle: %d, HeapReleased: %d\\n\", m.HeapSys, m.HeapAlloc,\n        m.HeapIdle, m.HeapReleased)\n}}()\n// Sample output(not from the same run as the other numbers):\n// HeapSys: 347308032, HeapAlloc: 123637792, HeapIdle: 194322432, HeapReleased: 0\n</code></pre>\n\n<p>This shows no effect.\nMy understanding was that golang only requests memory if it needs more and cleans up every once in a while (Running with GCTRACE shows that gc is actually running often)\nI do not understand why golang continues to request memory when the actually used memory is comparatively small.</p>\n\n<p>Does someone know the underlying cause of the gap and how I can prevent my program from eating memory? </p>\n\n<p>As the graphs are SVGs I cannot embed them:</p>\n\n<ul>\n<li>pprof inuse_space <a href=\"https://files.niels-ole.com/memory9.svg\" rel=\"nofollow noreferrer\">https://files.niels-ole.com/memory9.svg</a> (acceptable memory usage)</li>\n<li>pprof alloc_space <a href=\"https://files.niels-ole.com/memory9-alloc.svg\" rel=\"nofollow noreferrer\">https://files.niels-ole.com/memory9-alloc.svg</a> (frequently called regular expression allocating vast amounts of memory)</li>\n</ul>\n\n<p>Possibly related:\n<a href=\"https://stackoverflow.com/questions/24863164/how-to-analyse-golang-memory\">how to analyse golang memory</a> \nDoes not explain why the memory continues to increase(and is not reused).</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 2, "creation_date": 1483384709, "post_id": 41432193, "comment_id": 70070107, "body": "The <code>main</code> function is interrupted so you need to install a signal handler and call <code>Remove</code> inside of that function."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1483384965, "post_id": 41432193, "comment_id": 70070191, "body": "Let me look into what a signal handler is. Thanks for responding."}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 2, "creation_date": 1483385095, "post_id": 41432193, "comment_id": 70070238, "body": "Here is an easy example: <a href=\"https://gobyexample.com/signals\" rel=\"nofollow noreferrer\">gobyexample.com/signals</a>"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1483385242, "post_id": 41432193, "comment_id": 70070283, "body": "Thank you so much. That link had exactly what I needed."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1483386943, "post_id": 41432193, "comment_id": 70070944, "body": "@squiguy In my program, i created a channel. Now my problem is, if i wait for the signal before starting the server, the program pauses,waiting for the signal and I dont know how to wait for the signal after I have started the server(nothing gets executed after ListenAndServe). This seems like a very basic problem but I am fairly new to all this. What should I do?"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1483387041, "post_id": 41432193, "comment_id": 70070983, "body": "Alright,I got it."}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1483387069, "post_id": 41432193, "comment_id": 70070999, "body": "Cool, I guess I should have mentioned that a channel read is blocking."}, {"owner": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "edited": false, "score": 0, "creation_date": 1483420558, "post_id": 41432193, "comment_id": 70079585, "body": "@Krash Just a question: why not consider tmp file as an option? I know the tmp may not delete immediately after you stop the program but it will delete quite soon later and save you some line of code."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 4679, "user_id": 749854, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/541a5cb4925d352cac921c21e9213aa4?s=128&d=identicon&r=PG", "display_name": "nvcnvn", "link": "https://stackoverflow.com/users/749854/nvcnvn"}, "edited": false, "score": 0, "creation_date": 1483452333, "post_id": 41432193, "comment_id": 70096761, "body": "@nvcnvn I am very new to go as well as developing applications. I didn&#39;t know that I can simply create a temp file. Thank you for suggesting that.It is a very decent option but I kind of want to have an option of saving the zipped files(using flags) with me as well. This would be easier if all files were created in the same manner and depending on the  flags, os.Remove would or wouldn&#39;t be executed. This question was a win,win for me, I learned two things I didn&#39;t know at all .Thank you."}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1483473382, "post_id": 41432193, "comment_id": 70109079, "body": "@Krash you may want to consider answering your own question for future reference to others."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1483511951, "post_id": 41432193, "comment_id": 70121207, "body": "@squiguy I am sorry. I will keep that in mind from now on."}], "answers": [{"comments": [{"owner": {"reputation": 3638, "user_id": 2884309, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/T1Mo3.jpg?s=128&g=1", "display_name": "Ivan Aracki", "link": "https://stackoverflow.com/users/2884309/ivan-aracki"}, "edited": false, "score": 4, "creation_date": 1516817875, "post_id": 41455960, "comment_id": 83848823, "body": "just to mention - actual delete of file would be <b>os.Remove(path)</b>"}], "tags": [], "owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "is_accepted": true, "score": 17, "last_activity_date": 1483502313, "creation_date": 1483502313, "answer_id": 41455960, "question_id": 41432193, "link": "https://stackoverflow.com/questions/41432193/how-to-delete-a-file-using-golang-on-program-exit/41455960#41455960", "title": "How to delete a file using golang on program exit?", "body": "<p>This has already been answered in the comments, but I'll document it here for completeness. </p>\n\n<p><code>defer</code> works only when the program and code you're using it in runs through its course normally. Stopping a program with with a command or killing it, on the other hand, sends a signal to the program and then terminates it abnormally, which does not allow the program to run all the <code>defer</code> statements cleanly.</p>\n\n<p>If you want to cleanup on OS termination, you can listen for OS signals - code based on <a href=\"https://gobyexample.com/signals\" rel=\"noreferrer\">the example here</a>:</p>\n\n<pre><code>sigs := make(chan os.Signal, 1)\nsignal.Notify(sigs, syscall.SIGINT, syscall.SIGTERM)\ngo func() {\n  &lt;- sigs\n  cleanupAllTheThings()\n  os.Exit(0)\n}()\n</code></pre>\n\n<p>If you call this from <code>main</code>, it will keep a goroutine running for the life of your program listening to the OS signals. And the <code>cleanupAllTheThings()</code> function needs to be written to run as fast as possible without blocking to be effective - you never know when the OS is going to terminate you with prejudice.</p>\n\n<p>Also, this will not protect you from someone pulling out the plug or a kernal panic - so it usually makes sense to have some kind cleanup of the old program state on startup or in a separate cleanup script.</p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9522, "favorite_count": 1, "accepted_answer_id": 41455960, "answer_count": 1, "score": 13, "last_activity_date": 1483502313, "creation_date": 1483384534, "question_id": 41432193, "link": "https://stackoverflow.com/questions/41432193/how-to-delete-a-file-using-golang-on-program-exit", "title": "How to delete a file using golang on program exit?", "body": "<p>I have made a command line application where I am zipping up folders and sharing on my local server for others to download. What I want to do is delete my copy of the zipped folder as soon as I close the server. This is my code:</p>\n\n<pre><code>func main() {\n    //flag to specify whether we will be uploading folder or a single file\n    zipped := flag.Bool(\"z\",false,\"Use for zipping folders and serving them as a single file on the server.(Deletes the zipped file once the server closes.)\")\n    save := flag.Bool(\"s\",false,\"Use with -z for saving the zipped files locally even after the server closes.\")\n    flag.Parse()\n\n\n    if len(flag.Args())&gt;0{\n\n        if *zipped{\n            fmt.Println(\"zipping...\")\n            flag.Args()[0]=ZipFile()\n\n            if !(*save){\n              //I expect this to remove the file when I hit ctrl+c on cmd  \n              defer os.Remove(flag.Args()[0])   \n                 }\n        }\n        http.HandleFunc(\"/\",ShareFile)\n        fmt.Printf(\"Sharing file on %s:8080\\n\",GetOutboundIP())\n\n        log.Fatal(http.ListenAndServe(\":8080\",nil))\n    }else{\n        fmt.Println(\"Invalid usage. No file mentioned. Use wshare -h for help.\")\n    }\n\n}\n</code></pre>\n\n<p>When I hit ctrl-c, the program exits and main function closes and as a result,shouldn't os.Remove(xyz) get executed? <a href=\"https://tour.golang.org/flowcontrol/12\" rel=\"noreferrer\">A tour of go</a> says, defer executes the expression when the function returns. Here, I don't feel main gets the oppurtunity to return anything at all. </p>\n\n<p>What is a workaround to achieve what I am trying to do? I have some solutions in my head like wait for a keypress etc. but I want this program to be super simple,so is there a way to delete the file as soon as the server closes/program exits without requiring any further input from me?</p>\n"}, {"tags": ["json", "go", "couchbase", "json-patch", "nosql"], "comments": [{"owner": {"reputation": 2345, "user_id": 4580460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pq9gW.jpg?s=128&g=1", "display_name": "geraldss", "link": "https://stackoverflow.com/users/4580460/geraldss"}, "edited": false, "score": 0, "creation_date": 1483463030, "post_id": 41431739, "comment_id": 70103652, "body": "I&#39;m sorry, your question is not clear. If you need to generate the paths dynamically, you can generate a N1QL query dynamically."}, {"owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "reply_to_user": {"reputation": 2345, "user_id": 4580460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pq9gW.jpg?s=128&g=1", "display_name": "geraldss", "link": "https://stackoverflow.com/users/4580460/geraldss"}, "edited": false, "score": 0, "creation_date": 1483464900, "post_id": 41431739, "comment_id": 70104744, "body": "I can but even N1Ql requires a path to update the sub document <code>SET path = expression [update-for] [ , path = expression [update-for] ]*</code> so my question is how to generate path for complex nested json like above"}, {"owner": {"reputation": 2345, "user_id": 4580460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pq9gW.jpg?s=128&g=1", "display_name": "geraldss", "link": "https://stackoverflow.com/users/4580460/geraldss"}, "edited": false, "score": 0, "creation_date": 1483466100, "post_id": 41431739, "comment_id": 70105380, "body": "Generate the path in your code, then generate your N1QL query dynamically, on the fly, from your code. It&#39;s just a string."}], "owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501930846, "creation_date": 1483381974, "last_edit_date": 1506103282, "question_id": 41431739, "link": "https://stackoverflow.com/questions/41431739/golang-couchbase-updating-sub-document-and-finding-json-path", "title": "Golang , Couchbase updating sub document and finding json path", "body": "<p>What is the best approach to update sub document in couchbase ? I am taking about nested json documents . Simple fields are easily updatable using syntax like <code>set name = 'Jon Doe'</code> but what about nested json document . I have read all the pages in the official document but all the pages used a phase called <code>keys</code> or <code>path</code> which is a json path.</p>\n\n<p>So for a complex nested json like org.adddress.city.name how to find the path dynamically or programmatically from json . Think a nested json with 6-7 level deep . Its hardly be seen but what about it .</p>\n\n<p>Sub document updating in couchbase means updating a portion or part of the entire document or updating a simple field that could be nested .</p>\n\n<p>My way is to find a Merge Json Patch that will give me which json field is updated and then if that patch contains nested fields like \n<code>\n  \"address\": {\n      \"city\": {\n        \"id\": \"25\",\n        \"name\": \"Atlanta\"\n      }\n  }\n</code>\nthen to update this in Couchbase using mutate_in function I need those path which is <code>address.city.id</code> and <code>address.city.name</code> . Even if in N1QL query to update the doc I need to generate those path I believe . </p>\n\n<p>I have been trying to generate those path from json using recursion function because you don\u2019t know how far the next will be . <a href=\"https://gist.github.com/sh0umik/8e11b98ca5287ac8a6e0a0b35f3ea74a\" rel=\"nofollow noreferrer\">Here is</a> the gist . </p>\n\n<p>I would like to know If there are any other way without generating the path to update complex sub documents.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 1, "creation_date": 1483380919, "post_id": 41431467, "comment_id": 70068806, "body": "Unbuffered means no buffer (zero). See <a href=\"http://stackoverflow.com/questions/11943841/golang-what-is-channel-buffer-size\">Golang - What is channel buffer size?</a>."}, {"owner": {"reputation": 43, "user_id": 6809653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38fe54566a72de5925672b1ed5158d99?s=128&d=identicon&r=PG&f=1", "display_name": "smokeybear", "link": "https://stackoverflow.com/users/6809653/smokeybear"}, "reply_to_user": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483381108, "post_id": 41431467, "comment_id": 70068865, "body": "I get that, however unbuffuered vs buffered property only affects <b>blocking</b> of the execution, rather than number of things that get added to the queue. If I keep calling a go routine concurrently that sends to the unbuffered channel, I will still see all of the messages processed in sequential order, none of the messages are getting lost - from what I can see"}, {"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483381712, "post_id": 41431467, "comment_id": 70069068, "body": "Is your question how many blocked goroutines can be waiting to write to an unbuffered channel?"}, {"owner": {"reputation": 43, "user_id": 6809653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38fe54566a72de5925672b1ed5158d99?s=128&d=identicon&r=PG&f=1", "display_name": "smokeybear", "link": "https://stackoverflow.com/users/6809653/smokeybear"}, "reply_to_user": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483381786, "post_id": 41431467, "comment_id": 70069097, "body": "@e0k most definitely yes! and what order routines will be processed in?"}, {"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483381992, "post_id": 41431467, "comment_id": 70069164, "body": "If you have one goroutine writing to a channel and one reading from it, then they will come out in the same order that you put them in. But if you have multiple goroutines writing to the channel, you can not predict the order that they go in (i.e. without further synchronization). This unpredictability is the nature of concurrency. You cannot (or should not) assume any particular order of concurrent operations."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1483389933, "post_id": 41431467, "comment_id": 70072007, "body": "just a little tip don&#39;t think that a buffered channel is a queue"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6809653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38fe54566a72de5925672b1ed5158d99?s=128&d=identicon&r=PG&f=1", "display_name": "smokeybear", "link": "https://stackoverflow.com/users/6809653/smokeybear"}, "edited": false, "score": 0, "creation_date": 1483381181, "post_id": 41431538, "comment_id": 70068892, "body": "Will accept the answer as it makes most sense, however is the number of goroutines truly unilmited?"}, {"owner": {"reputation": 43, "user_id": 6809653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38fe54566a72de5925672b1ed5158d99?s=128&d=identicon&r=PG&f=1", "display_name": "smokeybear", "link": "https://stackoverflow.com/users/6809653/smokeybear"}, "edited": false, "score": 0, "creation_date": 1483381237, "post_id": 41431538, "comment_id": 70068906, "body": "Also in this case, if channel was unbuffered will goroutines be served in FIFO order as well? or is it random?"}, {"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 1, "creation_date": 1483382405, "post_id": 41431538, "comment_id": 70069304, "body": "See <a href=\"http://stackoverflow.com/questions/8509152/max-number-of-goroutines\">Max number of goroutines</a>. There is no language-imposed limit on the number of goroutines, but since each uses a small amount of memory, this imposes a physical limit."}, {"owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "edited": false, "score": 0, "creation_date": 1483386413, "post_id": 41431538, "comment_id": 70070763, "body": "The blocked goroutines are unblocked in FIFO order as receivers become available."}], "tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": false, "score": 4, "last_activity_date": 1483381023, "creation_date": 1483381023, "answer_id": 41431538, "question_id": 41431467, "link": "https://stackoverflow.com/questions/41431467/how-big-is-the-channel-queue-in-golang/41431538#41431538", "title": "How big is the channel queue in Golang?", "body": "<p>The number of items that can be in the channel itself is zero, because it is unbuffered. But there is no limit on the number of goroutines than can be waiting to send on the channel. (When a goroutine tries to send on a channel with no buffer or a full buffer, it blocks until another goroutine is ready to receive from the channel.)</p>\n"}], "owner": {"reputation": 43, "user_id": 6809653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38fe54566a72de5925672b1ed5158d99?s=128&d=identicon&r=PG&f=1", "display_name": "smokeybear", "link": "https://stackoverflow.com/users/6809653/smokeybear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1830, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1483381023, "creation_date": 1483380701, "question_id": 41431467, "link": "https://stackoverflow.com/questions/41431467/how-big-is-the-channel-queue-in-golang", "title": "How big is the channel queue in Golang?", "body": "<p>In Golang unbuffered channel is just a FIFO queue. How many items can be in that queue at any time? Is there a limit?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 0, "creation_date": 1483380378, "post_id": 41431273, "comment_id": 70068588, "body": "Are you running localhost ?"}, {"owner": {"reputation": 1, "user_id": 2695116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0df0fd021a04ff83c1bd93fa95437e?s=128&d=identicon&r=PG&f=1", "display_name": "mufredat", "link": "https://stackoverflow.com/users/2695116/mufredat"}, "reply_to_user": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 0, "creation_date": 1483380703, "post_id": 41431273, "comment_id": 70068719, "body": "database and go are running on the same laptop, if you are asking this. If &quot;running localhost&quot; is a configuration term about postgres, no, i didn&#39;t adjust anything. Just installed postgresql."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1483406015, "post_id": 41431273, "comment_id": 70076272, "body": "check to see that you don&#39;t have more than one pg installed"}, {"owner": {"reputation": 1, "user_id": 2695116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0df0fd021a04ff83c1bd93fa95437e?s=128&d=identicon&r=PG&f=1", "display_name": "mufredat", "link": "https://stackoverflow.com/users/2695116/mufredat"}, "edited": false, "score": 0, "creation_date": 1483417902, "post_id": 41431273, "comment_id": 70078785, "body": "Thanks, this solved the problem."}], "owner": {"reputation": 1, "user_id": 2695116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0df0fd021a04ff83c1bd93fa95437e?s=128&d=identicon&r=PG&f=1", "display_name": "mufredat", "link": "https://stackoverflow.com/users/2695116/mufredat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 273, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483382933, "creation_date": 1483379764, "last_edit_date": 1483382933, "question_id": 41431273, "link": "https://stackoverflow.com/questions/41431273/golang-cannot-find-existing-table-in-postgresql", "title": "golang cannot find existing table in postgresql", "body": "<p>I'm trying to learn databases in golang with postgresql by tutorials.</p>\n\n<p>Although database exists, program gives  output:</p>\n\n<pre><code>go run dbase.go\n\n2017/01/02 20:43:07 pq: database \"bookstore\" does not exist\n</code></pre>\n\n<p>this is psql output:</p>\n\n<pre><code>deneme=# \\l\n                             List of databases\n   Name    |  Owner   | Encoding | Collate | Ctype |   Access privileges   \n-----------+----------+----------+---------+-------+-----------------------\n bookstore | postgres | UTF8     | C       | C     | \n deneme    | postgres | UTF8     | C       | C     | \n</code></pre>\n\n<p>and this is the relevant part of go code:</p>\n\n<pre><code>const (\n    DB_USER     = \"postgres\"\n    DB_PASSWORD = \"root\"\n    DB_NAME     = \"bookstore\"\n)\n\nfunc main() {\n    dbinfo := fmt.Sprintf(\"user=%s password=%s dbname=%s sslmode=disable\",\n        DB_USER, DB_PASSWORD, DB_NAME)\n    db, err := sql.Open(\"postgres\", dbinfo)\n    if err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n\n<p>Also changing connection code to this gives the same output:</p>\n\n<pre><code>db, err := sql.Open(\"postgres\", \"postgres://postgres:root@localhost/bookstore?sslmode=disable\")\n</code></pre>\n\n<p>Thanks;</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1483380183, "post_id": 41429621, "comment_id": 70068529, "body": "Not that this is the problem, but use <code>strings.NewReader(&lt;very long string&gt;)</code> instead of <code>bytes.NewReader([]byte(&lt;very long string&gt;)</code>.  The former avoids the allocation in the <code>[]byte</code> conversion."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 1, "creation_date": 1483574518, "post_id": 41429621, "comment_id": 70156514, "body": "are you trying to accomplish what httputil.DumpRequest does, while avoiding the large byte array coming back?"}], "answers": [{"comments": [{"owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 0, "creation_date": 1483372503, "post_id": 41429776, "comment_id": 70065280, "body": "I&#39;m trying to pass the http request to a custom writer not execute it"}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "reply_to_user": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 1, "creation_date": 1483372858, "post_id": 41429776, "comment_id": 70065465, "body": "Can you show the complete source code and explain your overall goal (not just how you are trying to do it)? Thanks"}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "reply_to_user": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 1, "creation_date": 1483373058, "post_id": 41429776, "comment_id": 70065550, "body": "Write takes an io.Writer interface which is defined as <code>type Writer interface {         Write(p []byte) (n int, err error) }</code> your own write does not return anything."}, {"owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 0, "creation_date": 1483373087, "post_id": 41429776, "comment_id": 70065571, "body": "The goal is to pass a http request as a byte array to a custom writer"}, {"owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "reply_to_user": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 1, "creation_date": 1483373229, "post_id": 41429776, "comment_id": 70065634, "body": "I think you need to return len(request),nil to tell the caller to carry on writing. What you see is just an artifact of the length of the internal buffer."}, {"owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 0, "creation_date": 1483373639, "post_id": 41429776, "comment_id": 70065832, "body": "Thanks, that seems to be the case! I returned 0, nil which caused the problem"}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 2, "last_activity_date": 1483372414, "creation_date": 1483372414, "answer_id": 41429776, "question_id": 41429621, "link": "https://stackoverflow.com/questions/41429621/go-httprequest-write-pass-a-long-request-to-a-writer-without-being-cut-off/41429776#41429776", "title": "Go - httpRequest.Write(), pass a long request to a Writer without being cut off?", "body": "<p>This is not how you execute HTTP requests in Go. You need to do</p>\n\n<pre><code>req, _ := http.NewRequest(\"POST\", \"/Foo\", bytes.NewReader([]byte(&lt;very long string&gt;)))\nclient := &amp;http.Client{}\nresp, err := client.Do(req)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "edited": false, "score": 0, "creation_date": 1483714724, "post_id": 41475289, "comment_id": 70222325, "body": "Is there a function read the dump back into a http.Request? <code>req, err := http.ReadRequest(bufio.NewReader(bytes.NewReader(rData)))</code> seems to ignore the body even when body is actually in the byte array."}], "tags": [], "owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "is_accepted": true, "score": 1, "last_activity_date": 1483574791, "creation_date": 1483574791, "answer_id": 41475289, "question_id": 41429621, "link": "https://stackoverflow.com/questions/41429621/go-httprequest-write-pass-a-long-request-to-a-writer-without-being-cut-off/41475289#41475289", "title": "Go - httpRequest.Write(), pass a long request to a Writer without being cut off?", "body": "<p>If you are ok with the request being turned into a huge array, this is already part of the Go stdlib:</p>\n\n<pre><code>import \"net/http/httputil\"\n\n...\n    rData, err := httputil.DumpRequest(r, true)\n...\n\n\n...\n\nfunc debugResponse(resp *http.Response) {\n    dump, _ := httputil.DumpResponse(resp, true)\n    fmt.Println(\"DEBUG:\")\n    fmt.Printf(\"%q\", dump)\n}\n</code></pre>\n\n<p>Once you consume the response or request, you have to assume that it has been held in memory.  Use the flag false if you don't want to print the body because it's large or binary.</p>\n"}], "owner": {"reputation": 677, "user_id": 3761308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e67dce3dde174a526dd403e299c25de?s=128&d=identicon&r=PG&f=1", "display_name": "user3761308", "link": "https://stackoverflow.com/users/3761308/user3761308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1056, "favorite_count": 0, "accepted_answer_id": 41475289, "answer_count": 2, "score": 0, "last_activity_date": 1483713821, "creation_date": 1483371797, "last_edit_date": 1483713821, "question_id": 41429621, "link": "https://stackoverflow.com/questions/41429621/go-httprequest-write-pass-a-long-request-to-a-writer-without-being-cut-off", "title": "Go - httpRequest.Write(), pass a long request to a Writer without being cut off?", "body": "<p>Creating a request, then writing it</p>\n\n<pre><code>var w CustomWriter\n\nreq, _ := http.NewRequest(\"POST\", \"/Foo\", bytes.NewReader([]byte(&lt;very long string&gt;)))\nreq.Write(w)\n\nfunc (w *CustomWriter) Write(request []byte) (int, error) {\n    fmt.Println(len(request))\n\n    return 0, nil\n}\n</code></pre>\n\n<p>Output: 4096</p>\n\n<p>But the body of my request is noticeably longer, but it just gets cut off when trying to write it. How do I write and send this HTTP Request that has a very long body without the body being lost or cut off?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "edited": false, "score": 0, "creation_date": 1483354729, "post_id": 41425249, "comment_id": 70056372, "body": "oops, you were faster."}, {"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "reply_to_user": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "edited": false, "score": 0, "creation_date": 1483437084, "post_id": 41425249, "comment_id": 70087289, "body": "Thanks a lot @Peter."}], "tags": [], "owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "is_accepted": false, "score": 7, "last_activity_date": 1483353727, "creation_date": 1483353727, "answer_id": 41425249, "question_id": 41423637, "link": "https://stackoverflow.com/questions/41423637/go-ping-library-for-unprivileged-icmp-ping-in-golang/41425249#41425249", "title": "go-ping library for unprivileged ICMP ping in golang", "body": "<p>This is in the README.md of the library you're using : </p>\n\n<p>This library attempts to send an \"unprivileged\" ping via UDP. On linux, this must be enabled by setting</p>\n\n<pre><code>sudo sysctl -w net.ipv4.ping_group_range=\"0   2147483647\"\n</code></pre>\n\n<p>If you do not wish to do this, you can set pinger.SetPrivileged(true) and use setcap to allow your binary using go-ping to bind to raw sockets (or just run as super-user):</p>\n\n<pre><code>setcap cap_net_raw=+ep /bin/goping-binary\n</code></pre>\n\n<p>See this blog and the Go icmp library for more details.</p>\n\n<p>Hope it helps ! </p>\n"}, {"tags": [], "owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "is_accepted": true, "score": 6, "last_activity_date": 1483354671, "creation_date": 1483354671, "answer_id": 41425527, "question_id": 41423637, "link": "https://stackoverflow.com/questions/41423637/go-ping-library-for-unprivileged-icmp-ping-in-golang/41425527#41425527", "title": "go-ping library for unprivileged ICMP ping in golang", "body": "<p>Make sure your setting haven't changed in any way. Using <strong>ping</strong> from the package still works for me on a 32-bit Ubuntu 16.04 with Go 1.7.4 (linux/386) if I previousely set the net.ipv4.ping_group_range according to the <a href=\"https://github.com/sparrc/go-ping/blob/master/README.md#note-on-linux-support\" rel=\"noreferrer\">instructions on Github</a>.</p>\n\n<blockquote>\n  <h2>Note on Linux Support:</h2>\n  \n  <p>This library attempts to send an \"unprivileged\" ping via UDP. On linux, this must be enabled by setting</p>\n  \n  <p><code>sudo sysctl -w net.ipv4.ping_group_range=\"0   2147483647\"</code></p>\n  \n  <p>If you do not wish to do this, you can set <code>pinger.SetPrivileged(true)</code> and    use setcap to allow your binary\n  using go-ping to bind to raw sockets (or just run as super-user):</p>\n  \n  <p><code>setcap cap_net_raw=+ep /bin/goping-binary</code></p>\n  \n  <p>See <a href=\"https://sturmflut.github.io/linux/ubuntu/2015/01/17/unprivileged-icmp-sockets-on-linux/\" rel=\"noreferrer\">this blog</a>\n  and <a href=\"https://godoc.org/golang.org/x/net/icmp\" rel=\"noreferrer\">the Go icmp library</a> for\n  more details.</p>\n</blockquote>\n"}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3671, "favorite_count": 1, "accepted_answer_id": 41425527, "answer_count": 2, "score": 1, "last_activity_date": 1483354671, "creation_date": 1483346676, "last_edit_date": 1483348152, "question_id": 41423637, "link": "https://stackoverflow.com/questions/41423637/go-ping-library-for-unprivileged-icmp-ping-in-golang", "title": "go-ping library for unprivileged ICMP ping in golang", "body": "<p>I have been using go-ping library for the unprivileged ping and calculate various statistics of network in golang.\ncode snippet is as-></p>\n\n<pre><code>func (p *Ping) doPing() (latency, jitter, packetLoss float64, err error) {\n\n    timeout := time.Second*1000\n    interval := time.Second\n    count := 5\n    host := p.ipAddr\n    pinger, cmdErr := ping.NewPinger(host)\n    if cmdErr != nil {\n            glog.Error(\"Failed to ping \" + p.ipAddr)\n            err = cmdErr\n            return\n    }\n\n\n    pinger.Count = count\n    pinger.Interval = interval\n    pinger.Timeout = timeout\n    pinger.SetPrivileged(false)\n    pinger.Run()\n    stats := pinger.Statistics()\n    latency = float64(stats.AvgRtt)   \n    jitter = float64(stats.StdDevRtt) \n    packetLoss = stats.PacketLoss\n    return\n}\n</code></pre>\n\n<p>It was working fine but now it has started throwing :-\n\"Error listening for ICMP packets: socket: permission denied\" error.\nAnyone knows the reason behind this? Go version I am using is go1.7.4.</p>\n"}, {"tags": ["string", "memory-management", "go", "slice"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1483348674, "post_id": 41423272, "comment_id": 70053585, "body": "Not referring to the link specifically, but <code>strings.Join()</code> does a lot of allocation and copying for concatenation. For large strings, this can be expensive compared to other approaches like using Buffer / <code>io.Writer</code>."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1483390468, "last_edit_date": 1483390468, "creation_date": 1483351463, "answer_id": 41424677, "question_id": 41423272, "link": "https://stackoverflow.com/questions/41423272/golang-optimal-sorting-and-joining-strings/41424677#41424677", "title": "golang: optimal sorting and joining strings", "body": "<p>The <a href=\"https://github.com/golang/net/blob/8fd7f25955530b92e73e9e1932a41b522b22ccd9/http2/transport.go#L661-L663\" rel=\"nofollow noreferrer\">code referenced by the comment</a> is memory efficient as written. Any allocations are in <code>strings.Join</code> which is written to minimize memory allocations.</p>\n\n<p>I suspect that the comment was accidentally copied and pasted from this <a href=\"https://github.com/golang/go/blob/e776975ae61e8db6ff5db33b039513c9d8524794/src/net/http/transfer.go#L289-L294\" rel=\"nofollow noreferrer\">code in the net/http package</a>:</p>\n\n<pre><code>        // TODO: could do better allocation-wise here, but trailers are rare,\n        // so being lazy for now.\n        if _, err := io.WriteString(w, \"Trailer: \"+strings.Join(keys, \",\")+\"\\r\\n\"); err != nil {\n            return err\n        }\n</code></pre>\n\n<p>This snippet has the following possible allocations:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/go/blob/e776975ae61e8db6ff5db33b039513c9d8524794/src/strings/strings.go#L360\" rel=\"nofollow noreferrer\"><code>[]byte</code> created in strings.Join for constructing the result</a></li>\n<li><a href=\"https://github.com/golang/go/blob/e776975ae61e8db6ff5db33b039513c9d8524794/src/strings/strings.go#L366\" rel=\"nofollow noreferrer\"><code>string</code> conversion result returned by strings.Join</a></li>\n<li>string result for expression <code>\"Trailer: \"+strings.Join(keys, \",\")+\"\\r\\n\"</code></li>\n<li><a href=\"https://github.com/golang/go/blob/e776975ae61e8db6ff5db33b039513c9d8524794/src/io/io.go#L291\" rel=\"nofollow noreferrer\">The <code>[]byte</code> conversion result used in io.WriteString</a></li>\n</ul>\n\n<p>A more memory efficient approach is to allocate a single <code>[]byte</code> for the data to be written. </p>\n\n<pre><code>n := len(\"Trailer: \") + len(\"\\r\\n\")\nfor _, s := range keys {\n    n += len(s) + 1\n}\np := make([]byte, 0, n-1) // subtract 1 for len(keys) - 1 commas\np = append(p, \"Trailer: \"...)\nfor i, s := range keys {\n    if i &gt; 0 {\n        p = append(p, ',')\n    }\n    p = append(p, s...)\n}\np = append(p, \"\\r\\n\"...)\nw.Write(p)\n</code></pre>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 41424677, "answer_count": 1, "score": 0, "last_activity_date": 1483390468, "creation_date": 1483344558, "question_id": 41423272, "link": "https://stackoverflow.com/questions/41423272/golang-optimal-sorting-and-joining-strings", "title": "golang: optimal sorting and joining strings", "body": "<p><a href=\"https://github.com/golang/net/blob/master/http2/transport.go#L649\" rel=\"nofollow noreferrer\">This</a> short method in go's source code has a comment which implies that it's not allocating memory in an optimal way.</p>\n\n<blockquote>\n  <p>... could do better allocation-wise here ...</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/src/strings/strings.go?s=8854:8894#L334\" rel=\"nofollow noreferrer\">This</a> is the source code for the <code>Join</code> method.</p>\n\n<p>What exactly is inefficiently allocated here? I don't see a way around allocating the source string slice and the destination byte slice. The source being the slice of keys. The destination being the slice of bytes.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1483362234, "post_id": 41423029, "comment_id": 70060167, "body": "@kostix forgot to share the link, nice"}, {"owner": {"reputation": 5721, "user_id": 142406, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tlIsz.jpg?s=128&g=1", "display_name": "bx2", "link": "https://stackoverflow.com/users/142406/bx2"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1483386847, "post_id": 41423029, "comment_id": 70070905, "body": "@kostix thanks that is exactly the link I was looking for;"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 4, "last_activity_date": 1483343138, "creation_date": 1483343138, "answer_id": 41423029, "question_id": 41422777, "link": "https://stackoverflow.com/questions/41422777/golangs-type-system-behaviour-dividing-an-int-by-an-implicit-float/41423029#41423029", "title": "Golang&#39;s type system behaviour - dividing an int by an implicit float", "body": "<p>Here <code>10000.0</code> is not float64/32 it is a numeric constant. Go will assume the type of <code>x</code> in this case for the expression and <code>truncate</code> the constant 100000.0 to integer</p>\n\n<pre><code>func doesntWork() {\n    x := 1234\n    y := x / 100000.0\n    s := fmt.Sprintf(\"%.8f\", y)\n    fmt.Printf(\"%s\\n\", s)\n}\n</code></pre>\n\n<p>If you update it to </p>\n\n<pre><code>func doesntWork() {\n    x := 1234\n    y := x / float64(100000.0)\n    s := fmt.Sprintf(\"%.8f\", y)\n    fmt.Printf(\"%s\\n\", s)\n}\n</code></pre>\n\n<p>it will error out saying </p>\n\n<pre><code> invalid operation: x / float64(100000) (mismatched types int and float64)\n</code></pre>\n\n<p>Similarly if you change the constant to 100000.111 where <code>truncating</code> to integer will no longer give the same value it will error out </p>\n\n<pre><code>func doesntWork() {\n    x := 1234\n    y := x / 100000.1\n    s := fmt.Sprintf(\"%.8f\", y)\n    fmt.Printf(\"%s\\n\", s)\n}\n</code></pre>\n\n<p>It will error out saying</p>\n\n<pre><code>constant 100000 truncated to integer\n</code></pre>\n"}], "owner": {"reputation": 5721, "user_id": 142406, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tlIsz.jpg?s=128&g=1", "display_name": "bx2", "link": "https://stackoverflow.com/users/142406/bx2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 41423029, "answer_count": 1, "score": 1, "last_activity_date": 1483343377, "creation_date": 1483341551, "last_edit_date": 1483343377, "question_id": 41422777, "link": "https://stackoverflow.com/questions/41422777/golangs-type-system-behaviour-dividing-an-int-by-an-implicit-float", "title": "Golang&#39;s type system behaviour - dividing an int by an implicit float", "body": "<p>I was experimenting lately with golang's type system and encountered an interesting (or not) behaviour related to floats: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    doesntWork()\n    works()\n}\n\nfunc doesntWork() {\n    x := 1234\n    y := x / 100000.0\n    s := fmt.Sprintf(\"%.8f\", y)\n    fmt.Printf(\"%s\\n\", s)\n}\n\nfunc works() {\n    x := 1234\n    y := float64(x) / 100000.0\n    s := fmt.Sprintf(\"%.8f\", y)\n    fmt.Printf(\"%s\\n\", s)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/6axmtCslmU\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n\n<p>I think that in the case presented in the example above, in procedure <code>doesntWork()</code>, golang does not automatically \"assume\" <code>float32/64</code> when dividing an <code>int</code> by an implicit <code>float</code>? Is that correct? Could anyone point me towards some docs or specs where I could learn more about how golang behaves in situations like the one above?</p>\n"}, {"tags": ["c", "go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "is_accepted": false, "score": 2, "last_activity_date": 1483338753, "creation_date": 1483338753, "answer_id": 41422312, "question_id": 41422187, "link": "https://stackoverflow.com/questions/41422187/precompiling-part-of-go-program-that-relies-on-c-for-speed/41422312#41422312", "title": "Precompiling part of Go program that relies on C for speed", "body": "<p>Instead of importing the entire C source code, you can link it with compiled object files and header files. Refer to <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">https://golang.org/cmd/cgo/</a> which covers how to use the <code>LDFLAGS</code> argument for cgo.</p>\n\n<p>There are other documents online which cover how to compile C code into object files (<code>.a</code> and <code>.o</code> files) such as <a href=\"https://stackoverflow.com/questions/14919366/how-to-compile-library-on-c-using-gcc\">this one</a>. You should also refer to documentation in the library you're using, or its Makefile as it will likely already have instructions to compile it into object files that can be linked.</p>\n\n<p>If the library that has <code>import \"C\"</code>, and its source isn't being modified, you can also <code>go get</code> it, (or perhaps <code>go install</code> it) which will store its compiled object files in your <code>$GOPATH/pkg</code>, making compilation of other Go programs that import it faster.</p>\n"}], "owner": {"reputation": 4871, "user_id": 3474089, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9KTt4.png?s=128&g=1", "display_name": "abagshaw", "link": "https://stackoverflow.com/users/3474089/abagshaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1483338753, "creation_date": 1483337961, "question_id": 41422187, "link": "https://stackoverflow.com/questions/41422187/precompiling-part-of-go-program-that-relies-on-c-for-speed", "title": "Precompiling part of Go program that relies on C for speed", "body": "<p>Part of my Go program relies on a very large C codebase using <code>import \"C\"</code> that takes a few minutes to compile. Is there any way to precompile per-se that C library or create a branch of my Go program that will be precompiled along with the C code so that each time I compile the main program I don't have to wait for the entire C library to re-compile each time?</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483338818, "post_id": 41422132, "comment_id": 70050084, "body": "I tried the same on  my machine <code>go version go1.7.3 linux&#47;amd64</code> .It is working fine"}, {"owner": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "edited": false, "score": 0, "creation_date": 1483339078, "post_id": 41422132, "comment_id": 70050145, "body": "I just tried on <code>go version go1.7.4 darwin&#47;amd64</code>, no issues either. What does running <code>go env</code> output in your terminal?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1483358960, "post_id": 41422132, "comment_id": 70058479, "body": "Do not use relative import paths. It&#39;s not necessarily the problem here, but it&#39;s not supported in all cases by the guild tools."}, {"owner": {"reputation": 4871, "user_id": 3474089, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9KTt4.png?s=128&g=1", "display_name": "abagshaw", "link": "https://stackoverflow.com/users/3474089/abagshaw"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483406586, "post_id": 41422132, "comment_id": 70076361, "body": "@JimB - what would you recommend I use other than relative paths?"}, {"owner": {"reputation": 4871, "user_id": 3474089, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9KTt4.png?s=128&g=1", "display_name": "abagshaw", "link": "https://stackoverflow.com/users/3474089/abagshaw"}, "edited": false, "score": 0, "creation_date": 1483406628, "post_id": 41422132, "comment_id": 70076374, "body": "I&#39;m assuming that somehow the specific C code that I am importing is causing the issue (I am importing the darknet YOLO Real Time Object Detection framework)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1483407620, "post_id": 41422132, "comment_id": 70076585, "body": "@abagshaw: an import path should always be relative to <code>$GOPATH&#47;src</code>, or a <code>vendor&#47;</code> directory in your project. See <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}], "owner": {"reputation": 4871, "user_id": 3474089, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9KTt4.png?s=128&g=1", "display_name": "abagshaw", "link": "https://stackoverflow.com/users/3474089/abagshaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483337633, "creation_date": 1483337633, "question_id": 41422132, "link": "https://stackoverflow.com/questions/41422132/main-in-go-not-running-after-c-import", "title": "main() in Go not running after C import", "body": "<p>I am trying to import some C code for use in my Golang application. I am really new to Go so I most likely have done something stupid here:</p>\n\n<p>I have one file <code>main.go</code> in the main directory and <code>yolo.go</code> in the <code>/yolo</code> subdirectory along with all my C code.</p>\n\n<p><strong>yolo.go</strong></p>\n\n<pre><code>package yolo\n\nimport \"C\"\n\nfunc Vals() string {\n    return \"Good to go!\"\n}\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"./yolo\"\n\nfunc main() {\n    fmt.Printf(yolo.Vals())\n    fmt.Printf(\"test\")\n}\n</code></pre>\n\n<p>This seems to compile fine - but none of the code in the <code>main()</code> function in <code>main.go</code> runs - no output is given, but no errors are either. If I forget about the <code>import \"C\"</code> everything runs just fine and I get the output I expect. What am I doing wrong?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7364037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2753ba5770bd0af2dd6608771557d57?s=128&d=identicon&r=PG&f=1", "display_name": "user7364037", "link": "https://stackoverflow.com/users/7364037/user7364037"}, "edited": false, "score": 0, "creation_date": 1483336871, "post_id": 41421942, "comment_id": 70049483, "body": "Thank you, I&#39;m still new to this so I didn&#39;t know how other websites did it. The documents you linked look really helpful and I will start reading them now."}], "tags": [], "owner": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "is_accepted": true, "score": 0, "last_activity_date": 1483336297, "creation_date": 1483336297, "answer_id": 41421942, "question_id": 41421789, "link": "https://stackoverflow.com/questions/41421789/run-golang-online-and-save-it-to-an-online-file/41421942#41421942", "title": "Run golang online and save it to an online file", "body": "<p>Typically most websites generate JSON responses directly into the HTTP request, they don't write the results into a file that is then served over HTTP.</p>\n\n<p>You will need some kind of server that is exposed to the Internet either way. I would recommend you reading about how to use the HTTP server built into Go, so you don't need to write the results into a file: <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">https://golang.org/doc/articles/wiki/</a>. Once you gain a better understand on how web applications work, you can use higher level web frameworks that can help you be more productive, such as gin: <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">https://github.com/gin-gonic/gin</a>.</p>\n\n<p>If you would still really like to write the results in a file and serve that file, you may as well use Go as the web server, and use <a href=\"https://golang.org/pkg/net/http/#ServeFile\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#ServeFile</a>.</p>\n\n<p>Example code of doing this:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/myfile.json\", func(w http.ResponseWriter, r *http.Request) {\n        http.ServeFile(w, r, \"path/to/myfile.json\")\n    })\n\n    // Serve on HTTP port (80)\n    log.Fatal(http.ListenAndServe(\":80\", nil))\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7364037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2753ba5770bd0af2dd6608771557d57?s=128&d=identicon&r=PG&f=1", "display_name": "user7364037", "link": "https://stackoverflow.com/users/7364037/user7364037"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 41421942, "answer_count": 1, "score": -3, "last_activity_date": 1483336297, "creation_date": 1483335139, "question_id": 41421789, "link": "https://stackoverflow.com/questions/41421789/run-golang-online-and-save-it-to-an-online-file", "title": "Run golang online and save it to an online file", "body": "<p>What my local program does right now is connect to a websocket and updates a local file with a json whenever a message is received. </p>\n\n<p>Is there a way to run the golang program online and then update and save the file as a json file online that I will be able to see? I'm not sure but I think I would need a web server?</p>\n\n<p>For example, the program would generate a website like this <a href=\"https://www.reddit.com/r/all.json\" rel=\"nofollow noreferrer\">https://www.reddit.com/r/all.json</a> ?</p>\n"}, {"tags": ["go", "calculator"], "comments": [{"owner": {"reputation": 2539, "user_id": 5010211, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p_adzXHjKuc/AAAAAAAAAAI/AAAAAAAAAHk/ZaZIK9rA414/photo.jpg?sz=128", "display_name": "Akshay Bhat &#39;AB&#39;", "link": "https://stackoverflow.com/users/5010211/akshay-bhat-ab"}, "edited": false, "score": 0, "creation_date": 1483335252, "post_id": 41421782, "comment_id": 70048992, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10280263/how-do-a-simple-calculator-in-android-how-to-do-it-using-buttons-and-single-edi\">How do a simple calculator in Android? How to do it using Buttons and single edit text?</a>"}, {"owner": {"reputation": 2486, "user_id": 5619896, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WsR6U.jpg?s=128&g=1", "display_name": "Senjuti Mahapatra", "link": "https://stackoverflow.com/users/5619896/senjuti-mahapatra"}, "edited": false, "score": 0, "creation_date": 1483336593, "post_id": 41421782, "comment_id": 70049379, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/9435041/calculator-problems-android-programming\">Calculator Problems - Android Programming</a>"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 2486, "user_id": 5619896, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WsR6U.jpg?s=128&g=1", "display_name": "Senjuti Mahapatra", "link": "https://stackoverflow.com/users/5619896/senjuti-mahapatra"}, "edited": false, "score": 1, "creation_date": 1483339712, "post_id": 41421782, "comment_id": 70050312, "body": "@SenjutiMahapatra @Akshay the question is not about how to write a calculator .It is about how to accept arbitary number of arguements in <code>go</code> functions"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "edited": false, "score": 0, "creation_date": 1483411186, "post_id": 41421980, "comment_id": 70077277, "body": "The &#39;go run filename.go&#39; command compiles and runs the program, but I unable to find a command that just compiles the code and gives an executable file(.exe). Do you know how to do that?  @Sarathsp"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 2, "last_activity_date": 1483336663, "creation_date": 1483336663, "answer_id": 41421980, "question_id": 41421782, "link": "https://stackoverflow.com/questions/41421782/this-is-calculator-program-how-to-code-for-unknown-number-of-inputs/41421980#41421980", "title": "This is Calculator Program, How to code for unknown number of inputs?", "body": "<p>You may use <code>...</code> to accept arbitery number of arguements,\nHere is how your program will be then</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc add(m ...int) int {\n    sum := 0\n    for _, i := range m {\n        sum += i\n    }\n    return sum\n}\nfunc sub(m ...int) int {\n    sub := m[0]\n    for _, i := range m[1:] {\n        sub -= i\n    }\n    return sub\n}\nfunc mul(m ...float32) float32 {\n    c := float32(1)\n    for _, i := range m {\n        c *= i\n    }\n    return c\n}\nfunc div(m ...float32) float32 {\n    quo := m[0]\n    for _, i := range m[1:] {\n        quo /= i\n    }\n    return quo\n}\n\nfunc main() {\n    fmt.Println(add(4, 6))\n    fmt.Println(sub(4, 6))\n    fmt.Println(mul(4, 6))\n    fmt.Println(div(6, 4))\n}\n</code></pre>\n\n<p>Here is go play link : <a href=\"https://play.golang.org/p/dWrMa-GdGj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/dWrMa-GdGj</a></p>\n"}, {"tags": [], "owner": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "is_accepted": false, "score": 0, "last_activity_date": 1483336918, "creation_date": 1483336918, "answer_id": 41422015, "question_id": 41421782, "link": "https://stackoverflow.com/questions/41421782/this-is-calculator-program-how-to-code-for-unknown-number-of-inputs/41422015#41422015", "title": "This is Calculator Program, How to code for unknown number of inputs?", "body": "<p>Your question isn't too clear, so I'm going to make some assumptions. I'm assuming you want something that can do <code>add(1, 2, 3)</code> that will return <code>1 + 2 + 3</code>.</p>\n\n<p>There are two ways of doing this, either using slices, or using the <code>...T</code> argument type. (Refer to the <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">Go specifications</a>).</p>\n\n<p>An implementation that makes use of slices will accept a slice of numbers, and then use iterative methods to perform actions on the slice. For example for an add function:</p>\n\n<pre><code>func add(numbers []int) int {\n    sum := 0\n    for _, number := range numbers {\n        sum += number\n    }\n    return sum\n}\n</code></pre>\n\n<p>You can then call it like <code>add([]int{1, 2, 3})</code> which will return the result of 1 + 2 + 3.</p>\n\n<p>Using the <code>...T</code> argument type is almost the same, as it basically turns multiple arguments into a slice.</p>\n\n<pre><code>func add(numbers ...int) int {\n    sum := 0\n    for _, number := range numbers {\n        sum += number\n    }\n    return sum\n}\n</code></pre>\n\n<p>Except calling it becomes different. Either: <code>add(1, 2, 3)</code> or if you would still like to use a slice, <code>add([]int{1, 2, 3}...)</code>.</p>\n\n<p>You should be able to apply these concepts to your other operations.</p>\n"}], "owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 41421980, "answer_count": 2, "score": 2, "last_activity_date": 1483336918, "creation_date": 1483335080, "question_id": 41421782, "link": "https://stackoverflow.com/questions/41421782/this-is-calculator-program-how-to-code-for-unknown-number-of-inputs", "title": "This is Calculator Program, How to code for unknown number of inputs?", "body": "<p>This program is to do different calculations.right now it is only doing the basic operations for two numbers given in main, I'm trying to upgrade it to calculate for more than 2 numbers and more like for unknown number of number given in input.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc add (n int , m int) int {\n     sum := n + m\n     return sum\n}\nfunc sub (n int , m int) int {\n     diff := n - m\n     return diff\n}\nfunc mul (n float32 , m float32) float32 {\n     pro := n * m\n     return pro\n}\n\nfunc div (n float32 , m float32) float32 {\n     quo := n / m\n     return quo\n}\n\nfunc main() {\n    fmt.Println(add(4,6))\n    fmt.Println(sub(4,6))\n    fmt.Println(mul(4,6))\n    fmt.Println(div(6,4))\n}\n</code></pre>\n"}, {"tags": ["mysql", "go", "goroutine"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 2, "creation_date": 1483337115, "post_id": 41421696, "comment_id": 70049577, "body": "You are spawning <code>processBatch()</code> routines, but your <code>main()</code> does not wait for them to finish and just ends. You can use a <code>sync.WaitGroup</code> to make <code>main()</code> wait for all goroutines to finish."}], "answers": [{"comments": [{"owner": {"reputation": 1786, "user_id": 3544233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVQaj.jpg?s=128&g=1", "display_name": "sekl", "link": "https://stackoverflow.com/users/3544233/sekl"}, "edited": false, "score": 0, "creation_date": 1483338250, "post_id": 41422177, "comment_id": 70049918, "body": "Alright, seems I was already close to this solution earlier when I tried out WaitGroup but did not really understand how/where to use it. This helped a lot, thanks!"}], "tags": [], "owner": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "is_accepted": true, "score": 3, "last_activity_date": 1483337923, "creation_date": 1483337923, "answer_id": 41422177, "question_id": 41421696, "link": "https://stackoverflow.com/questions/41421696/db-calls-in-goroutine-failing-without-error/41422177#41422177", "title": "DB calls in goroutine failing without error", "body": "<p>As Nadh mentioned in a comment, that would be because the program exits when the <code>main</code> function finishes, regardless whether or not there are still other goroutines running. To fix this, a *sync.WaitGroup will suffice. A WaitGroup is used for cases where you have multiple concurrent operations, and you would like to wait until they have all completed. Documentation can be found here: <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">https://golang.org/pkg/sync/#WaitGroup</a>.</p>\n\n<p>An example implementation for your program without the use of global variables would look like replacing</p>\n\n<pre><code>fmt.Println(\"Total: \" + strconv.Itoa(total))\nfmt.Println(\"Loops: \" + strconv.Itoa(loops))\n\nfor i := 0; i &lt; loops; i++ {\n    offset := i * batchsize\n\n    go processBatch(offset)\n}\n</code></pre>\n\n<p>with</p>\n\n<pre><code>fmt.Println(\"Total: \" + strconv.Itoa(total))\nfmt.Println(\"Loops: \" + strconv.Itoa(loops))\n\nwg := new(sync.WaitGroup)\nwg.Add(loops)\n\nfor i := 0; i &lt; loops; i++ {\n    offset := i * batchsize\n\n    go func(offset int) {\n        defer wg.Done()\n        processBatch(offset)\n    }(offset)\n}\n\nwg.Wait()\n</code></pre>\n"}], "owner": {"reputation": 1786, "user_id": 3544233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVQaj.jpg?s=128&g=1", "display_name": "sekl", "link": "https://stackoverflow.com/users/3544233/sekl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 41422177, "answer_count": 1, "score": 1, "last_activity_date": 1483337923, "creation_date": 1483334447, "question_id": 41421696, "link": "https://stackoverflow.com/questions/41421696/db-calls-in-goroutine-failing-without-error", "title": "DB calls in goroutine failing without error", "body": "<p>I wrote a script to migrate lots of data from one DB to another and  got it working fine, but now I want to try and use goroutines to speed up the script by using concurrent DB calls. Since making the change to calling <code>go processBatch(offset)</code> instead of just <code>processBatch(offset)</code>, I can see that a few goroutines are started but the script finishes almost instantly and nothing is actually done. Also the number of started goroutines varies every time I call the script. There are no errors (that I can see).</p>\n\n<p>I'm still new to goroutines and Go in general, so any pointers as to what I might be doing wrong are much appreciated. I have removed all logic from the code below that is not related to concurrency or DB access, as it runs fine without the changes. I also left a comment where I believe it fails, as nothing below that line is run (Print gives not output). I also tried using sync.WaitGroup to stagger DB calls, but it didn't seem to change anything.</p>\n\n<pre><code>var (\n    legacyDB     *sql.DB\n    v2DB         *sql.DB\n)\n\nfunc main() {\n\n    var total, loops int\n    var err error\n\n    legacyDB, err = sql.Open(\"mysql\", \"...\")\n    if err != nil {\n        panic(err)\n    }\n    defer legacyDB.Close()\n\n    v2DB, err = sql.Open(\"mysql\", \"...\")\n    if err != nil {\n        panic(err)\n    }\n    defer v2DB.Close()\n\n    err = legacyDB.QueryRow(\"SELECT count(*) FROM users\").Scan(&amp;total)\n    checkErr(err)\n\n    loops = int(math.Ceil(float64(total) / float64(batchsize)))\n\n    fmt.Println(\"Total: \" + strconv.Itoa(total))\n    fmt.Println(\"Loops: \" + strconv.Itoa(loops))\n\n    for i := 0; i &lt; loops; i++ {\n        offset := i * batchsize\n\n        go processBatch(offset)\n    }\n\n    legacyDB.Close()\n    v2DB.Close()\n}\n\nfunc processBatch(offset int) {\n\n    query := namedParameterQuery.NewNamedParameterQuery(`\n        SELECT ...\n        LIMIT :offset,:batchsize\n    `)\n    query.SetValue(...)\n\n    rows, err := legacyDB.Query(query.GetParsedQuery(), (query.GetParsedParameters())...)\n    // nothing after this line gets done (Println here does not show output)\n    checkErr(err)\n    defer rows.Close()\n\n    ....\n\n    var m runtime.MemStats\n    runtime.ReadMemStats(&amp;m)\n    log.Printf(\"\\nAlloc = %v\\nTotalAlloc = %v\\nSys = %v\\nNumGC = %v\\n\\n\", m.Alloc/1024/1024, m.TotalAlloc/1024/1024, m.Sys/1024/1024, m.NumGC)\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["recursion", "go"], "comments": [{"owner": {"reputation": 1107, "user_id": 1979005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c41193776c04ed1d39c21ea82e4d0024?s=128&d=identicon&r=PG", "display_name": "ameed", "link": "https://stackoverflow.com/users/1979005/ameed"}, "edited": false, "score": 0, "creation_date": 1483328578, "post_id": 41421093, "comment_id": 70047619, "body": "What happens when you try using that code? Does it have an error or give incorrect results?"}, {"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 0, "creation_date": 1483329090, "post_id": 41421093, "comment_id": 70047696, "body": "What is the error?"}, {"owner": {"reputation": 65, "user_id": 5474093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f82f4a580589cd4951e03b18a8cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5474093/william"}, "edited": false, "score": 0, "creation_date": 1483379324, "post_id": 41421093, "comment_id": 70068161, "body": "I just get an empty slice returned. I&#39;m pretty sure that line 8 needs to be break instead of a return, as jdd0 has pointed out, but that doesn&#39;t resolve the problem."}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1483382061, "post_id": 41421093, "comment_id": 70069198, "body": "I think you dont wan&#39;t to return or break, you want to <code>continue</code> if not ok (so just skip that case and continue to loop."}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1483714565, "post_id": 41421093, "comment_id": 70222220, "body": "Related: <a href=\"http://stackoverflow.com/questions/41421093/recursion-in-go\">stackoverflow.com/questions/41421093/recursion-in-go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5474093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f82f4a580589cd4951e03b18a8cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5474093/william"}, "edited": false, "score": 0, "creation_date": 1483379410, "post_id": 41421193, "comment_id": 70068206, "body": "You&#39;re absolutely correct, but I&#39;m still getting an empty slice returned."}, {"owner": {"reputation": 65, "user_id": 5474093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f82f4a580589cd4951e03b18a8cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5474093/william"}, "edited": false, "score": 0, "creation_date": 1483379966, "post_id": 41421193, "comment_id": 70068446, "body": "Here&#39;s some output (letters, n.val, and curString), printed at the beginning of the function, having changed the return to a break: [100 97 110 99 101 115] [97 110 99 101 115] d d [110 99 101 115] a da [99 101 115] n dan [101 115] c danc [115] e dance [] s dances [110 101 115] c dac  It seems that n.term is never evaluating to true, even though I can successfully call trie.Find on &quot;dance&quot; and &quot;dances.&quot;"}], "tags": [], "owner": {"reputation": 667, "user_id": 7058050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307b8a4eb324c043ff6bba1370750097?s=128&d=identicon&r=PG&f=1", "display_name": "djd0", "link": "https://stackoverflow.com/users/7058050/djd0"}, "is_accepted": false, "score": 0, "last_activity_date": 1483329576, "creation_date": 1483329576, "answer_id": 41421193, "question_id": 41421093, "link": "https://stackoverflow.com/questions/41421093/recursion-in-go/41421193#41421193", "title": "Recursion in Go", "body": "<p>This may or may not be the only problem with the Go code, but the return statement in the for loop is not doing the same thing as the return statement in the javascript forEach.</p>\n\n<p>Return within the anonymous function in the javascript code returns from the anonymous function to within the <code>findAllWords</code> function. Return within the Go for loop returns from <code>FindAllWords</code>. This will prematurely stop the operation when it comes across a letter not within the root of the trie. I presume the issue you are having is the <code>[]string</code> being returned is empty or incomplete.</p>\n\n<p>Instead of <code>return words</code>, you should use <a href=\"https://golang.org/ref/spec#Break_statements\" rel=\"nofollow noreferrer\"><code>break</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1483713221, "creation_date": 1483713221, "answer_id": 41507881, "question_id": 41421093, "link": "https://stackoverflow.com/questions/41421093/recursion-in-go/41507881#41507881", "title": "Recursion in Go", "body": "<p>OK, there are two problems in OP's implementation:</p>\n\n<ul>\n<li>The action of the if block checking for child existence should \"continue\" the loop instead of returning words as a result (to try other tree branches).</li>\n<li>The if block condition checking whether the current node is a terminal (word) must be changed to accomodate github.com/derekparker/trie author's design decision of storing the terminal node as a child of the node corresponding to the last letter of the word, keyed in its parent as the 0 rune.</li>\n</ul>\n\n<p>Here's the working version:</p>\n\n<pre><code>func FindAllWords(letters []rune, node *trie.Node, curString string) []string {\n    words := []string{}\n    for i, let := range letters {\n        n, ok := node.Children()[let]\n        if !ok {\n            continue\n        }\n        curWord := curString + string(n.Val())\n        newLetters := []rune{}\n        newLetters = append(newLetters, letters[:i]...)\n        newLetters = append(newLetters, letters[i+1:]...)\n        if n.Children()[0x0] != nil {\n            words = append(words, curWord)\n        }\n        words = append(words, FindAllWords(newLetters, n, curWord)...)\n    }\n    return words\n}\n</code></pre>\n\n<p>Here's a somewhat more readable version (to my taste, of course):</p>\n\n<pre><code>func FindAllWords2(s string, n *trie.Node, w string) []string {\n    r := []string{}\n    for i, l := range s {\n        n1, ok := n.Children()[l]\n        if !ok {\n            continue\n        }\n        s1 := s[:i] + s[i+1:]\n        w1 := w + string(l)\n        if n1.Children()[0x0] != nil {\n            r = append(r, w1)\n        }\n        r = append(r, FindAllWords2(s1, n1, w1)...)\n    }\n    return r\n}\n</code></pre>\n\n<p>The second problem is of course coming from depending on an external library with a somewhat leaky API which exposes implementation details to the client code.</p>\n\n<p>To avoid such kind of trouble for this simple case, I would recommend to build a simple trie implementation which can come as easy as this:</p>\n\n<pre><code>type Node struct {\n    Char     rune\n    Term     bool\n    Children map[rune]*Node\n}\n\nfunc (n *Node) Add(s []rune) {\n    if len(s) == 0 {\n        n.Term = true\n        return\n    }\n    r := s[0]\n    c, ok := n.Children[r]\n    if !ok {\n        c = &amp;Node{Char: r, Children: make(map[rune]*Node)}\n        n.Children[r] = c\n    }\n    c.Add(s[1:])\n}\n\nfunc Empty() *Node {\n    return &amp;Node{Children: make(map[rune]*Node)}\n}\n</code></pre>\n\n<p>Using that structure this is how I loaded an english wordlist:</p>\n\n<pre><code>func English() *Node {\n    f, err := os.Open(\"/usr/share/dict/american-english\")\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n    t := Empty()\n    s := bufio.NewScanner(f)\n    for s.Scan() {\n        t.Add([]rune(strings.ToLower(s.Text())))\n    }\n    return t\n}\n</code></pre>\n\n<p>That structure can be used in the same algorithm with very little modification and no implementation misteries:</p>\n\n<pre><code>func FindAllWords3(s string, n *Node, w string) []string {\n    r := []string{}\n    for i, l := range s {\n        n1, ok := n.Children[l]\n        if !ok {\n            continue\n        }\n        s1 := s[:i] + s[i+1:]\n        w1 := w + string(l)\n        if n1.Term {\n            r = append(r, w1)\n        }\n        r = append(r, FindAllWords3(s1, n1, w1)...)\n    }\n    return r\n}\n</code></pre>\n\n<p>Here are the results of the three implementations above applied to the word \"dances\" and the same english wordlist loaded above:</p>\n\n<pre><code>[d dan dance dances dane danes dean deans den dena dens dec a ad aden ads an and andes ac acne ace aced aces as ascend n nd na ne ned c cd ca cad cads can cane caned canes cans case cased cs e ed edna end ends es s sad sade san sand sane sac sn snead sc scad scan se sedan sedna sea sean sen send sec]\n[d dan dance dances dane danes dean deans den dena dens dec a ad aden ads an and andes ac acne ace aced aces as ascend n nd na ne ned c cd ca cad cads can cane caned canes cans case cased cs e ed edna end ends es s sad sade san sand sane sac sn snead sc scad scan se sedan sedna sea sean sen send sec]\n[d dan dance dances dane danes dean deans den dena dens dec a ad aden ads an and andes ac acne ace aced aces as ascend n nd na ne ned c cd ca cad cads can cane caned canes cans case cased cs e ed edna end ends es s sad sade san sand sane sac sn snead sc scad scan se sedan sedna sea sean sen send sec]\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5474093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f82f4a580589cd4951e03b18a8cbe6?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5474093/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1483713221, "creation_date": 1483328460, "last_edit_date": 1483380567, "question_id": 41421093, "link": "https://stackoverflow.com/questions/41421093/recursion-in-go", "title": "Recursion in Go", "body": "<p>I'm a Javascript developer by trade and decided to give Go a spin. As a learning exercise I decided to port a function in one of my node projects, but can't get it working for the life of me. The function's purpose is to display all of the valid english words that can be made from the letters present in a different word (I'm building a multiplayer version of <a href=\"http://zone.msn.com/gameplayer/gameplayer.aspx?game=texttwist\" rel=\"nofollow noreferrer\">Text Twist</a>). For example, findAllWords(\"dances\") would return ['can','scan','dance','dances',etc...]. I've achieved this by recursing on a trie built from an English word list. </p>\n\n<p>Here is the function's implementation in Javascript: </p>\n\n<pre><code>self.findAllWords = function(letters = [], trie = dictionary, curString = '') {\n    let words = [];\n    letters = typeof letters === 'string' ? letters.split('') : letters;\n    letters.forEach( (letter,i,ar) =&gt; {\n        if (!trie[letter]) return;\n        let curWord = curString + letter;\n        let newTrie = trie[letter];\n        let newLetters = [...ar.slice(0,i),...ar.slice(i+1)];\n        if (trie[letter][FLAG_INDEX]) words.push(curWord);\n        if (self.isValidPrefix(curWord, dictionary)) words = [...words,...self.findAllWords(newLetters,newTrie,curWord)];\n    });\n    return uniq(words);\n}\n</code></pre>\n\n<p>and here's my attempt at replicating it in Go (using <a href=\"https://github.com/derekparker/trie\" rel=\"nofollow noreferrer\">this</a> trie implementation):</p>\n\n<pre><code>func FindAllWords(letters []rune, node *Node, curString string) []string {\n\nwords := []string{}\nfor i, let := range letters {\n    n, ok := node.Children()[let]\n\n    if !ok {\n        return words\n    }\n    curWord := curString + string(n.val)\n    newLetters := []rune{}\n    newLetters = append(newLetters, letters[:i]...)\n    newLetters = append(newLetters, letters[i+1:]...)\n\n    if n.term {\n        words = append(words, curWord)\n    }\n\n    words = append(words, FindAllWords(newLetters, n, curWord)...)\n}\nreturn words\n}\n</code></pre>\n\n<p>Would love to know why this is failing, how I can get it working, and any conventions I'm abusing/not making use of. Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1483314895, "post_id": 41420049, "comment_id": 70045441, "body": "ModSqrt has pretty much nothing to do with what you want."}], "answers": [{"comments": [{"owner": {"reputation": 1167, "user_id": 1044603, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c2bb28583b775840a0339150348b8b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Curtis", "link": "https://stackoverflow.com/users/1044603/eddie-curtis"}, "edited": false, "score": 0, "creation_date": 1483315764, "post_id": 41420106, "comment_id": 70045585, "body": "Ah ok, I figured that was probably the wrong thing to be doing. I know a simpler solution than implementing Sqrt in this case, but I really hope they add that function in the future. Thank you for your reply!"}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1483315278, "creation_date": 1483315278, "answer_id": 41420106, "question_id": 41420049, "link": "https://stackoverflow.com/questions/41420049/how-do-you-calculate-the-square-root-of-a-big-int-in-go/41420106#41420106", "title": "How do you calculate the square root of a Big Int in Go?", "body": "<p>The <code>big</code> package contains nothing for taking square roots. You'll have to implement it yourself. <code>ModSqrt</code>, in particular, is useless to you; it's a modular arithmetic thing.</p>\n"}], "owner": {"reputation": 1167, "user_id": 1044603, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c2bb28583b775840a0339150348b8b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Curtis", "link": "https://stackoverflow.com/users/1044603/eddie-curtis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 41420106, "answer_count": 1, "score": 0, "last_activity_date": 1483315278, "creation_date": 1483314658, "question_id": 41420049, "link": "https://stackoverflow.com/questions/41420049/how-do-you-calculate-the-square-root-of-a-big-int-in-go", "title": "How do you calculate the square root of a Big Int in Go?", "body": "<p>I'm attempting to calculate the square root of a Big Int in Go, but I'm not sure if I'm using the function correctly (or even the correct function).</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    x := big.NewInt(10)\n    fmt.Print(x.ModSqrt(big.NewInt(2), big.NewInt(1)))\n}\n</code></pre>\n\n<p>I am trying to calculate the square root of 10, but the output of this code is <code>&lt;nil&gt;</code>.</p>\n\n<p>Can someone please explain how to use this method correctly as I don't understand the documentation and I can't find any usages of this elsewhere that might help me understand how to use the method?</p>\n"}, {"tags": ["json", "recursion", "go", "mapping", "go-reflect"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1483306718, "post_id": 41419195, "comment_id": 70043725, "body": "not sure why you&#39;re doing that, but you can pass a <code>map[string]interface{}</code> directly to Unmarshal()"}, {"owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1483307191, "post_id": 41419195, "comment_id": 70043828, "body": "updated the question with goal however simply i want to get the json path as key for nested json so that i could represent key/path = address.city.name and value = 25"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1483327472, "post_id": 41419195, "comment_id": 70047424, "body": "<a href=\"https://github.com/buger/jsonparser\" rel=\"nofollow noreferrer\">github.com/buger/jsonparser</a> uses paths to access JSON values without unmarshalling. You may be able look at its source for ideas."}, {"owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1483329813, "post_id": 41419195, "comment_id": 70047812, "body": "@Nadh if jsonparser uses path then i need to generate the path from json thats the goal"}], "owner": {"reputation": 971, "user_id": 2202757, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/U5NGN.jpg?s=128&g=1", "display_name": "sh0umik", "link": "https://stackoverflow.com/users/2202757/sh0umik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483332152, "creation_date": 1483306141, "last_edit_date": 1483311398, "question_id": 41419195, "link": "https://stackoverflow.com/questions/41419195/golang-mapping-json-using-reflect-and-recursion", "title": "Golang - Mapping JSON using reflect and recursion", "body": "<p>I am trying to map a json data into <code>map[string]interface{}</code> using reflect and recursion . The function works like expected but it is not mapping all the value when it comes to nested json.</p>\n\n<p>I have this following json structure:</p>\n\n<pre><code>{\n  \"r_id\" : \"123456\",\n  \"title\" : \"brand new restarant with changed name\",\n  \"address\": {\n      \"city\": {\n        \"id\": \"25\",\n        \"name\": \"Dhaka\"\n      },\n      \"postal\":\"1213\"\n  },\n  \"description\" : \"here are some new desciption ...\"\n}\n</code></pre>\n\n<p>I am trying to map this into string for field and interface for value where the string for field if it is a nested will be joined with a dot <code>.</code>. for example mapping <code>title</code> is <code>map[title:brand new restarant with changed name]</code> but for city <code>name</code> and <code>id</code> it will be <code>map[address.city.id:25 address.city.name:Dhaka]</code></p>\n\n<p>I wrote <a href=\"https://gist.github.com/sh0umik/8e11b98ca5287ac8a6e0a0b35f3ea74a\" rel=\"nofollow noreferrer\">this script</a>.</p>\n\n<p>My goal is to get <code>key</code> and <code>value</code> in a map where key for nested json will be a string like <code>parent.child.child.child</code> which is a <code>json path</code> and the value will be the value of the last child</p>\n\n<p>Final output should be like this: <code>map[address.city.id:25 address.city.name:Dhaka address.postal:1213 r_id:123456 title:brand new restarant with changed name descripton:here are some new desciption ...]</code> but it prints <code>map[address.city.id:25 address.city.name:Dhaka r_id:123456 title:brand new restarant with changed name]</code> But not all string field like <code>description</code> and <code>state</code> of address </p>\n\n<p>I guess I need to sort the type then run the recursive function?</p>\n"}, {"tags": ["c", "linux", "go", "filesystems", "stat"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1483305871, "post_id": 41419056, "comment_id": 70043535, "body": "<a href=\"https://godoc.org/github.com/EricLagergren/go-gnulib/dirent\" rel=\"nofollow noreferrer\">This package</a> seems like it should provide the desired behaviour."}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1483339221, "post_id": 41419056, "comment_id": 70050183, "body": "Thank you @TimCooper. If you could put it as an answer, I will accept it."}], "answers": [{"comments": [{"owner": {"reputation": 2428, "user_id": 345350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50cb4981bbaa51b1713269a29f78d826?s=128&d=identicon&r=PG", "display_name": "donatJ", "link": "https://stackoverflow.com/users/345350/donatj"}, "edited": false, "score": 0, "creation_date": 1594661809, "post_id": 41426736, "comment_id": 111197407, "body": "With your example code, I am only getting the first 63 files in a directory of ~28,000,000 files. Any idea why this would be?"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 7, "last_activity_date": 1483359645, "creation_date": 1483359645, "answer_id": 41426736, "question_id": 41419056, "link": "https://stackoverflow.com/questions/41419056/golang-os-file-readdir-using-lstat-on-all-files-can-it-be-optimised/41426736#41426736", "title": "golang os *File.Readdir using lstat on all files. Can it be optimised?", "body": "<p>The package <a href=\"https://godoc.org/github.com/EricLagergren/go-gnulib/dirent\" rel=\"noreferrer\"><code>dirent</code></a> looks like it accomplishes what you are looking for. Below is your C example written in Go:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n\n    \"github.com/EricLagergren/go-gnulib/dirent\"\n    \"golang.org/x/sys/unix\"\n)\n\nfunc int8ToString(s []int8) string {\n    var buff bytes.Buffer\n    for _, chr := range s {\n        if chr == 0x00 {\n            break\n        }\n        buff.WriteByte(byte(chr))\n    }\n    return buff.String()\n}\n\nfunc main() {\n    stream, err := dirent.Open(\"/usr/bin\")\n    if err != nil {\n        panic(err)\n    }\n    defer stream.Close()\n    for {\n        entry, err := stream.Read()\n        if err != nil {\n            if err == io.EOF {\n                break\n            }\n            panic(err)\n        }\n\n        name := int8ToString(entry.Name[:])\n        if entry.Type == unix.DT_DIR {\n            fmt.Printf(\"%s is a directory\\n\", name)\n        } else {\n            fmt.Printf(\"%s is not a directory\\n\", name)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "accepted_answer_id": 41426736, "answer_count": 1, "score": 7, "last_activity_date": 1483359645, "creation_date": 1483304853, "last_edit_date": 1483305241, "question_id": 41419056, "link": "https://stackoverflow.com/questions/41419056/golang-os-file-readdir-using-lstat-on-all-files-can-it-be-optimised", "title": "golang os *File.Readdir using lstat on all files. Can it be optimised?", "body": "<p>I am writing a program that finds all sub-directories from a parent directory which contains a huge number of files using <code>os.File.Readdir</code>,  but running an <code>strace</code> to see the count of systemcalls showed that the go version is using an <code>lstat()</code> on all the files/directories present in the parent directory. (I am testing this with <code>/usr/bin</code> directory for now)</p>\n\n<p>Go code:</p>\n\n<pre><code>package main\nimport (\n        \"fmt\"\n    \"os\"\n)\nfunc main() {\n    x, err := os.Open(\"/usr/bin\")\n    if err != nil {\n        panic(err)\n    }\n    y, err := x.Readdir(0)\n    if err != nil {\n        panic(err)\n    }\n    for _, i := range y {\n    fmt.Println(i)\n    }\n\n}\n</code></pre>\n\n<p>Strace on the program (without following threads):</p>\n\n<pre><code>% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n 93.62    0.004110           2      2466           write\n  3.46    0.000152           7        22           getdents64\n  2.92    0.000128           0      2466           lstat // this increases with increase in no. of files.\n  0.00    0.000000           0        11           mmap\n  0.00    0.000000           0         1           munmap\n  0.00    0.000000           0       114           rt_sigaction\n  0.00    0.000000           0         8           rt_sigprocmask\n  0.00    0.000000           0         1           sched_yield\n  0.00    0.000000           0         3           clone\n  0.00    0.000000           0         1           execve\n  0.00    0.000000           0         2           sigaltstack\n  0.00    0.000000           0         1           arch_prctl\n  0.00    0.000000           0         1           gettid\n  0.00    0.000000           0        57           futex\n  0.00    0.000000           0         1           sched_getaffinity\n  0.00    0.000000           0         1           openat\n------ ----------- ----------- --------- --------- ----------------\n100.00    0.004390                  5156           total\n</code></pre>\n\n<p>I tested the same with the C's <code>readdir()</code> without seeing this behaviour.</p>\n\n<p>C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;dirent.h&gt;\n\nint main (void) {\n    DIR* dir_p;\n    struct dirent* dir_ent;\n\n    dir_p = opendir (\"/usr/bin\");\n\n    if (dir_p != NULL) {\n        // The readdir() function returns a pointer to a dirent structure representing the next\n        // directory entry in the directory stream pointed to by dirp.\n        // It returns NULL on reaching the end of the directory stream or if an error occurred.\n        while ((dir_ent = readdir (dir_p)) != NULL) {\n            // printf(\"%s\", dir_ent-&gt;d_name);\n            // printf(\"%d\", dir_ent-&gt;d_type);\n            if (dir_ent-&gt;d_type == DT_DIR) {\n                printf(\"%s is a directory\", dir_ent-&gt;d_name);\n            } else {\n                printf(\"%s is not a directory\", dir_ent-&gt;d_name);\n            }\n\n            printf(\"\\n\");\n        }\n            (void) closedir(dir_p);\n\n    }\n    else\n        perror (\"Couldn't open the directory\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Strace on the program:</p>\n\n<pre><code>% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n100.00    0.000128           0      2468           write\n  0.00    0.000000           0         1           read\n  0.00    0.000000           0         3           open\n  0.00    0.000000           0         3           close\n  0.00    0.000000           0         4           fstat\n  0.00    0.000000           0         8           mmap\n  0.00    0.000000           0         3           mprotect\n  0.00    0.000000           0         1           munmap\n  0.00    0.000000           0         3           brk\n  0.00    0.000000           0         3         3 access\n  0.00    0.000000           0         1           execve\n  0.00    0.000000           0         4           getdents\n  0.00    0.000000           0         1           arch_prctl\n------ ----------- ----------- --------- --------- ----------------\n100.00    0.000128                  2503         3 total\n</code></pre>\n\n<p>I am aware that the only fields in the dirent structure that are mandated by POSIX.1 are d_name and d_ino, but I am writing this for a specific filesystem. </p>\n\n<p>Tried <code>*File.Readdirnames()</code>, which doesn't use an <code>lstat</code> and gives a list of all files and directories, but to see if the returned string is a file or a directory will eventually do an <code>lstat</code> again.</p>\n\n<ul>\n<li>I was wondering if it is possible to re-write the go program in a way to avoid the <code>lstat()</code> on all the files un-necessarily. I could see the C program is using the following syscalls.   <code>open(\"/usr/bin\", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFDIR|0755, st_size=69632, ...}) = 0\nbrk(NULL)                               = 0x1098000\nbrk(0x10c1000)                          = 0x10c1000\ngetdents(3, /* 986 entries */, 32768)   = 32752</code></li>\n<li>Is this something like a premature optimisation, which I shouldn't be worried about? I raised this question because the number of files in the directory being monitored will be having huge number of small archived files, and the difference in systemcalls is almost twice between <code>C</code> and <code>GO</code> version, which will be hitting the disk.</li>\n</ul>\n"}, {"tags": ["multithreading", "performance", "go", "concurrency", "parallel-processing"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 4, "creation_date": 1483298404, "post_id": 41418210, "comment_id": 70041375, "body": "<a href=\"https://blog.golang.org/concurrency-is-not-parallelism\" rel=\"nofollow noreferrer\">blog.golang.org/concurrency-is-not-parallelism</a>"}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1483298588, "post_id": 41418210, "comment_id": 70041426, "body": "@YandryPozo and yet, how come the concurrent implementation is so much slower?"}], "answers": [{"comments": [{"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "edited": false, "score": 0, "creation_date": 1483302162, "post_id": 41418524, "comment_id": 70042504, "body": "The semaphore example is very nice. Thanks"}], "tags": [], "owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "is_accepted": true, "score": 3, "last_activity_date": 1483303859, "last_edit_date": 1483303859, "creation_date": 1483300858, "answer_id": 41418524, "question_id": 41418210, "link": "https://stackoverflow.com/questions/41418210/golang-why-using-goroutines-to-parallelize-calls-ends-up-being-slower/41418524#41418524", "title": "Golang: why using goroutines to parallelize calls ends up being slower?", "body": "<p>This is because you spawn tons of goroutines which preempt when calling <code>wg.Wait()</code>. Scheduler has no idea which one to pick, it can pick randomly blocked ones till it meets one that finally can return and unblock another one. When I limited number of concurrent calls to MergeSortMulti it became roughly 3x faster than synchronous version.</p>\n\n<p>This code isn't beautiful, but it is a proof.</p>\n\n<pre><code>// MergeSortMulti sorts the slice s using Merge Sort Algorithm\nfunc MergeSortMulti(s []int) []int {\n    if len(s) &lt;= 1 {\n        return s\n    }\n\n    n := len(s) / 2\n\n    wg := sync.WaitGroup{}\n    wg.Add(2)\n\n    var l []int\n    var r []int\n\n    const N = len(s)\n    const FACTOR = 8  // ugly but easy way to limit number of goroutines\n\n    go func() {\n        if n &lt; N/FACTOR {\n            l = MergeSort(s[:n])\n        } else {\n            l = MergeSortMulti(s[:n])\n        }\n        wg.Done()\n    }()\n\n    go func() {\n        if n &lt; N/FACTOR {\n            r = MergeSort(s[n:])\n        } else {\n            r = MergeSortMulti(s[n:])\n        }\n        wg.Done()\n    }()\n\n    wg.Wait()\n    return merge(l, r)\n}\n</code></pre>\n\n<p>Results will be different on your machine, but:</p>\n\n<p>FACTOR = 4:</p>\n\n<pre><code>BenchmarkMergeSortMulti-8             50          33268370 ns/op\nBenchmarkMergeSort-8                  20          91479573 ns/op\n</code></pre>\n\n<p>FACTOR = 10000</p>\n\n<pre><code>BenchmarkMergeSortMulti-8             20          84822824 ns/op\nBenchmarkMergeSort-8                  20         103068609 ns/op\n</code></pre>\n\n<p>FACTOR = N/4</p>\n\n<pre><code>BenchmarkMergeSortMulti-8              3         352870855 ns/op\nBenchmarkMergeSort-8                  10         129107177 ns/op\n</code></pre>\n\n<hr>\n\n<p><strong>Bonus:</strong> You can do also use semaphore to limit the number of goroutines which is a bit slower on my machine (select is used to avoid dead-lock):</p>\n\n<pre><code>var sem = make(chan struct{}, 100)\n\n// MergeSortMulti sorts the slice s using Merge Sort Algorithm\nfunc MergeSortMulti(s []int) []int {\n    if len(s) &lt;= 1 {\n        return s\n    }\n\n    n := len(s) / 2\n\n    wg := sync.WaitGroup{}\n    wg.Add(2)\n\n    var l []int\n    var r []int\n\n    select {\n    case sem &lt;- struct{}{}:\n        go func() {\n            l = MergeSortMulti(s[:n])\n            &lt;-sem\n            wg.Done()\n        }()\n    default:\n        l = MergeSort(s[:n])\n        wg.Done()\n    }\n\n    select {\n    case sem &lt;- struct{}{}:\n        go func() {\n            r = MergeSortMulti(s[n:])\n            &lt;-sem\n            wg.Done()\n        }()\n    default:\n        r = MergeSort(s[n:])\n        wg.Done()\n    }\n\n    wg.Wait()\n    return merge(l, r)\n}\n</code></pre>\n\n<p>It yields:</p>\n\n<pre><code>BenchmarkMergeSortMulti-8             30          36741152 ns/op\nBenchmarkMergeSort-8                  20          90843812 ns/op\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 1, "last_activity_date": 1483531696, "creation_date": 1483531696, "answer_id": 41463482, "question_id": 41418210, "link": "https://stackoverflow.com/questions/41418210/golang-why-using-goroutines-to-parallelize-calls-ends-up-being-slower/41463482#41463482", "title": "Golang: why using goroutines to parallelize calls ends up being slower?", "body": "<p>Your assumption is not correct:</p>\n\n<blockquote>\n  <p>One would assume that being able to parallelize this work would make\n  the concurrent implementation faster: if I need to work on slice A and\n  slice B, then working on them concurrently should be faster than doing\n  so synchronously.</p>\n</blockquote>\n\n<p>All parallel software falls under Amdahl's Law (<a href=\"https://en.wikipedia.org/wiki/Amdahl&#39;s_law\" rel=\"nofollow noreferrer\">on Wikipedia</a>), which I could paraphrase as '<em>the sequential setup is not free</em>'.</p>\n\n<p>This is of course especially so when only using a <em>single</em> CPU core. However, it still matters even with multiple cores, for which the choreography and distribution of units of work across cores <strong>needs to be thought through</strong> if high performance is the aim. Fortunately, kopiczko's answer provides some good tips in the specific case in question.</p>\n\n<p>This has been a research topic for decades: see e.g. an old (but still relevant) summary of tricks of the trade in \"<em>Practical Parallel Processing: An Introduction to Problem Solving in Parallel</em>\" by Tidmus and Chalmers.</p>\n"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "accepted_answer_id": 41418524, "answer_count": 2, "score": 1, "last_activity_date": 1483531696, "creation_date": 1483297998, "question_id": 41418210, "link": "https://stackoverflow.com/questions/41418210/golang-why-using-goroutines-to-parallelize-calls-ends-up-being-slower", "title": "Golang: why using goroutines to parallelize calls ends up being slower?", "body": "<p>I have two versions of merge sort implementation. The first is a \"normal\" version and the second uses <code>goroutines</code> that parallelize the work being done on each subset of the slice in each step of the recursion. </p>\n\n<p>One would assume that being able to parallelize this work would make the concurrent implementation faster: if I need to work on slice A and slice B, then working on them concurrently should be faster than doing so synchronously. </p>\n\n<p>Now I'm assuming something is wrong with either my implementation of my understanding, because my concurrent version ends up being 13-14x slower than the sync version. </p>\n\n<p>Can anyone point me in the right direction as to what I'm missing? </p>\n\n<p>\"Normal\" (synchronous implementation): </p>\n\n<pre><code>// MergeSort sorts the slice s using Merge Sort Algorithm\nfunc MergeSort(s []int) []int {\n    if len(s) &lt;= 1 {\n        return s\n    }\n\n    n := len(s) / 2\n\n    var l []int\n    var r []int\n\n    l = MergeSort(s[:n])\n    r = MergeSort(s[n:])\n\n    return merge(l, r)\n}\n</code></pre>\n\n<p>\"Concurrent\" version:</p>\n\n<pre><code>// MergeSortMulti sorts the slice s using Merge Sort Algorithm\nfunc MergeSortMulti(s []int) []int {\n    if len(s) &lt;= 1 {\n        return s\n    }\n\n    n := len(s) / 2\n\n    wg := sync.WaitGroup{}\n    wg.Add(2)\n\n    var l []int\n    var r []int\n\n    go func() {\n        l = MergeSortMulti(s[:n])\n        wg.Done()\n    }()\n\n    go func() {\n        r = MergeSortMulti(s[n:])\n        wg.Done()\n    }()\n\n    wg.Wait()\n    return merge(l, r)\n}\n</code></pre>\n\n<p>Both use the same <code>merge</code> function:</p>\n\n<pre><code>func merge(l, r []int) []int {\n    ret := make([]int, 0, len(l)+len(r))\n    for len(l) &gt; 0 || len(r) &gt; 0 {\n        if len(l) == 0 {\n            return append(ret, r...)\n        }\n        if len(r) == 0 {\n            return append(ret, l...)\n        }\n        if l[0] &lt;= r[0] {\n            ret = append(ret, l[0])\n            l = l[1:]\n        } else {\n            ret = append(ret, r[0])\n            r = r[1:]\n        }\n    }\n    return ret\n}\n</code></pre>\n\n<p>This is my benchmarking code:</p>\n\n<pre><code>package msort\n\nimport \"testing\"\n\nvar a []int\n\nfunc init() {\n    for i := 0; i &lt; 1000000; i++ {\n        a = append(a, i)\n    }\n}\nfunc BenchmarkMergeSortMulti(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        MergeSortMulti(a)\n    }\n}\n\nfunc BenchmarkMergeSort(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        MergeSort(a)\n    }\n}\n</code></pre>\n\n<p>It reveals that the concurrent version is a lot slower than the normal synchronous version:</p>\n\n<pre><code>BenchmarkMergeSortMulti-8              1    1711428093 ns/op\nBenchmarkMergeSort-8                  10     131232885 ns/op\n</code></pre>\n"}, {"tags": ["json", "rest", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1483294043, "post_id": 41417718, "comment_id": 70040174, "body": "Capitalize the struct field names <code>id</code> and <code>name</code>."}, {"owner": {"reputation": 15341, "user_id": 2228325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Vn6At.png?s=128&g=1", "display_name": "TonyGW", "link": "https://stackoverflow.com/users/2228325/tonygw"}, "edited": false, "score": 0, "creation_date": 1483322713, "post_id": 41417718, "comment_id": 70046695, "body": "This is not a duplicate question. See my edit above"}], "answers": [{"tags": [], "owner": {"reputation": 15341, "user_id": 2228325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Vn6At.png?s=128&g=1", "display_name": "TonyGW", "link": "https://stackoverflow.com/users/2228325/tonygw"}, "is_accepted": true, "score": 0, "last_activity_date": 1483383342, "last_edit_date": 1483383342, "creation_date": 1483368569, "answer_id": 41428925, "question_id": 41417718, "link": "https://stackoverflow.com/questions/41417718/go-json-rest-json-payload-is-empty/41428925#41428925", "title": "go-json-rest: JSON payload is empty", "body": "<p>I was just being silly doing <code>body, _ := ioutil.ReadAll(r.Body)</code> before decoding the JSON parameters without really understanding what <code>ioutil.ReadAll()</code> does to the request body. </p>\n\n<p>As I quoted above in the edited post, <code>ioutil.ReadAll()</code> consumes everything in the request body, leaving nothing for the json decoder to parse. After removing the line <code>body, _ := ioutil.ReadAll(r.Body)</code>, the json parsing works as expected.</p>\n"}], "owner": {"reputation": 15341, "user_id": 2228325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Vn6At.png?s=128&g=1", "display_name": "TonyGW", "link": "https://stackoverflow.com/users/2228325/tonygw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 41428925, "answer_count": 1, "score": 0, "last_activity_date": 1483383342, "creation_date": 1483293869, "last_edit_date": 1483320542, "question_id": 41417718, "link": "https://stackoverflow.com/questions/41417718/go-json-rest-json-payload-is-empty", "title": "go-json-rest: JSON payload is empty", "body": "<p>I'm trying to use <a href=\"https://github.com/ant0ine/go-json-rest\" rel=\"nofollow noreferrer\">go-json-rest</a> to create RESTful APIs</p>\n\n<p>I have this model struct:</p>\n\n<pre><code>type Todo struct {\n    id   int\n    name string\n}\n</code></pre>\n\n<p>And I am trying to do a POST request to create an object of <code>Todo</code> type:</p>\n\n<pre><code>func CreateTodo(w rest.ResponseWriter, r *rest.Request) {\n\n    body, _ := ioutil.ReadAll(r.Body)\n    log.Println(\"body content is: \", string(body)) // here I can see {\"name\": \"test1\"}\n    var todo Todo = Todo{}\n    err := r.DecodeJsonPayload(&amp;todo) // here the error shows JSON payload is empty\n    defer r.Body.Close()\n\n    if err != nil {\n        log.Println(\"error in parsing json\")\n        rest.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    if todo.name == \"\" {\n        rest.Error(w, \"todo name is required\", 400)\n        return\n    }\n    lock.Lock()\n\n    var nextId int = len(todos)\n    //  todos[nextId] = todo\n    todo.id = nextId // set its id\n    todos = append(todos, todo)\n    log.Println(\"num of todos: \", len(todos))\n    lock.Unlock()\n\n    w.WriteJson(&amp;todo)\n}\n</code></pre>\n\n<p>However, in the console of the POSTMAN client, the error shows:</p>\n\n<pre><code>{\n  \"Error\": \"JSON payload is empty\"\n}\n</code></pre>\n\n<p>I was wondering where might go wrong. Thanks</p>\n\n<p><strong>Edit:</strong>\nThis should not be considered a duplicate question, because I am not even trying to use the <code>json</code> package to do marshalling/unmarshalling of JSON object. Instead I am using the <code>rest.Request</code> object (built in go-json-rest) to decode the json parameters as posted from client. </p>\n\n<p>After much digging and search on this problem I found this answer below resolved my issue:</p>\n\n<blockquote>\n  <p><code>body, _ := ioutil.ReadAll(r.Body)</code> will consume everything from the\n  request body. So after removing this line, the json parsing works!</p>\n</blockquote>\n"}, {"tags": ["go", "gpu"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 1, "creation_date": 1483290155, "post_id": 41416808, "comment_id": 70039039, "body": "You can&#39;t do it in pure Go, you could utilise CGO and maybe <a href=\"https://github.com/go-gl/gl\" rel=\"nofollow noreferrer\">github.com/go-gl/gl</a> (given your platform list). If you do all the heavy lifting in C it <i>might</i> perform quite well."}], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "edited": false, "score": 0, "creation_date": 1529887465, "post_id": 41529605, "comment_id": 89022831, "body": "It&#39;s a great talk, thanks!, but could have better if he would have shown performance compare to gpu vs cpu, he just showed cpu performance"}], "tags": [], "owner": {"reputation": 190, "user_id": 1430367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599b15af43f2893df8378c6215fada1e?s=128&d=identicon&r=PG", "display_name": "Dhananjay", "link": "https://stackoverflow.com/users/1430367/dhananjay"}, "is_accepted": false, "score": 4, "last_activity_date": 1483851316, "creation_date": 1483851316, "answer_id": 41529605, "question_id": 41416808, "link": "https://stackoverflow.com/questions/41416808/vector-additions-on-gpu-in-golang/41529605#41529605", "title": "Vector additions on GPU in golang", "body": "<p>You can't directly talk to Nvidia GPUs from Go. You'd need to use <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">cgo</a> to call C library from Go. See <a href=\"https://archive.fosdem.org/2014/schedule/event/hpc_devroom_go/attachments/slides/486/export/events/attachments/hpc_devroom_go/slides/486/FOSDEM14_HPC_devroom_14_GoCUDA.pdf\" rel=\"nofollow noreferrer\">slide #8 in this presentation</a> for one example (also see <a href=\"https://archive.fosdem.org/2014/schedule/event/hpc_devroom_go/\" rel=\"nofollow noreferrer\">full talk</a>).</p>\n\n<p>There're some Go packages that wrap cgo part I mentioned above, into Go a library. <a href=\"https://godoc.org/github.com/mumax/3/cuda\" rel=\"nofollow noreferrer\">mumax</a> is one such package.</p>\n"}], "owner": {"reputation": 476, "user_id": 1235577, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e26e029aeb67386a54fff5db023348b?s=128&d=identicon&r=PG", "display_name": "Pownyan", "link": "https://stackoverflow.com/users/1235577/pownyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6303, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1483851316, "creation_date": 1483286767, "question_id": 41416808, "link": "https://stackoverflow.com/questions/41416808/vector-additions-on-gpu-in-golang", "title": "Vector additions on GPU in golang", "body": "<p>I'm writing a application that requires additions of 5000 length float vectors many times a second. Is it possible to make the GPU perform the calculations, an how would that be done? i need it to run on both windows and linux (later a raspberry pi), so CUDA is out of the question as i don't have a Nvidia graphics card.</p>\n"}, {"tags": ["http", "go", "go-echo"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 8, "last_activity_date": 1483281571, "creation_date": 1483281571, "answer_id": 41416255, "question_id": 41416017, "link": "https://stackoverflow.com/questions/41416017/assignment-to-entry-in-nil-map-when-using-http-header-with-echo-golang/41416255#41416255", "title": "Assignment to entry in nil map when using http header with Echo golang", "body": "<p>The error is self explanatory: <code>req.Header</code> is nil; you cannot assign to a nil map.</p>\n\n<p>The solution is to either:</p>\n\n<ol>\n<li><p>Initialize <code>req.Header</code> with a new instance of <a href=\"https://godoc.org/net/http#Header\" rel=\"noreferrer\"><code>net/http.Header</code></a></p>\n\n<pre><code>req.Header = make(http.Header)\n</code></pre></li>\n<li><p>Or, create the <code>req</code> variable with <a href=\"https://godoc.org/net/http#NewRequest\" rel=\"noreferrer\"><code>net/http.NewRequest</code></a>, which does all the internal initializing for you:</p>\n\n<pre><code>req, err := http.NewRequest(\"GET\", \"https://example.com/path\", nil)\nif err != nil {\n    panic(err)\n}\nreq.Header.Set(\"Authorization\",\"Bearer \"+loginToken.Token)\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 143, "user_id": 5053840, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/4cb19df22047fe6f8fdc632f906e85ee?s=128&d=identicon&r=PG&f=1", "display_name": "Chenko47", "link": "https://stackoverflow.com/users/5053840/chenko47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1886, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521027107, "creation_date": 1483279082, "last_edit_date": 1521027107, "question_id": 41416017, "link": "https://stackoverflow.com/questions/41416017/assignment-to-entry-in-nil-map-when-using-http-header-with-echo-golang", "title": "Assignment to entry in nil map when using http header with Echo golang", "body": "<p>here is my test using testing package and echo web http framework : \n(webserver variable is a global echo instance)</p>\n\n<pre><code>func TestRunFunction(t *testing.T){\n    req := new(http.Request)\n    **req.Header.Set(\"Authorization\",\"Bearer \"+loginToken.Token)**\n    rec := httptest.NewRecorder()\n    c := WebServer.NewContext(standard.NewRequest(req, WebServer.Logger()), standard.NewResponse(rec, WebServer.Logger()))\n    c.SetPath(path)\n    if assert.NoError(t , RunFunction(c)){\n        assert.Equal(t,http.StatusOK, rec.Code)\n    }\n}\n</code></pre>\n\n<p>Im trying to test some function that called by REST GET method, but I get this panic error :</p>\n\n<pre><code>panic: assignment to entry in nil map [recovered]\n        panic: assignment to entry in nil map\n</code></pre>\n\n<p>The panic is on the line in bold (astrix in the code), when Im trying to set the header. What am I doing wrong?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 6893963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154623771900712/picture?type=large", "display_name": "Louis Ng", "link": "https://stackoverflow.com/users/6893963/louis-ng"}, "edited": false, "score": 0, "creation_date": 1483276074, "post_id": 41415447, "comment_id": 70035527, "body": "Thanks! However this still doesn&#39;t help with capturing standard output of the cmd."}, {"owner": {"reputation": 2907, "user_id": 7357841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RJs6M9j2t9Q/AAAAAAAAAAI/AAAAAAAAAAA/f77YfS3xpcs/photo.jpg?sz=128", "display_name": "minamijoyo", "link": "https://stackoverflow.com/users/7357841/minamijoyo"}, "reply_to_user": {"reputation": 429, "user_id": 6893963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154623771900712/picture?type=large", "display_name": "Louis Ng", "link": "https://stackoverflow.com/users/6893963/louis-ng"}, "edited": false, "score": 0, "creation_date": 1483278877, "post_id": 41415447, "comment_id": 70036120, "body": "Oh, I&#39;m sorry. if you want to capture stdout concurrently, how about cmd.StdoutPipe()?"}, {"owner": {"reputation": 429, "user_id": 6893963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154623771900712/picture?type=large", "display_name": "Louis Ng", "link": "https://stackoverflow.com/users/6893963/louis-ng"}, "edited": false, "score": 0, "creation_date": 1483280599, "post_id": 41415447, "comment_id": 70036534, "body": "Hi, Thanks again. I tried the new code but the code block at      for scanner.Scan() and will not readline until my python script exit."}, {"owner": {"reputation": 2907, "user_id": 7357841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RJs6M9j2t9Q/AAAAAAAAAAI/AAAAAAAAAAA/f77YfS3xpcs/photo.jpg?sz=128", "display_name": "minamijoyo", "link": "https://stackoverflow.com/users/7357841/minamijoyo"}, "reply_to_user": {"reputation": 429, "user_id": 6893963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154623771900712/picture?type=large", "display_name": "Louis Ng", "link": "https://stackoverflow.com/users/6893963/louis-ng"}, "edited": false, "score": 2, "creation_date": 1483281371, "post_id": 41415447, "comment_id": 70036699, "body": "I don&#39;t know about the implementation of <code>game.py</code> , but stdout may be bufferd inside Python. How about explicitly specifying <code>sys.stdout.flush()</code> in Python?"}, {"owner": {"reputation": 2907, "user_id": 7357841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RJs6M9j2t9Q/AAAAAAAAAAI/AAAAAAAAAAA/f77YfS3xpcs/photo.jpg?sz=128", "display_name": "minamijoyo", "link": "https://stackoverflow.com/users/7357841/minamijoyo"}, "reply_to_user": {"reputation": 429, "user_id": 6893963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154623771900712/picture?type=large", "display_name": "Louis Ng", "link": "https://stackoverflow.com/users/6893963/louis-ng"}, "edited": false, "score": 0, "creation_date": 1483282343, "post_id": 41415447, "comment_id": 70036947, "body": "Congrats. I added the sample reproduction python code to the answer."}], "tags": [], "owner": {"reputation": 2907, "user_id": 7357841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RJs6M9j2t9Q/AAAAAAAAAAI/AAAAAAAAAAA/f77YfS3xpcs/photo.jpg?sz=128", "display_name": "minamijoyo", "link": "https://stackoverflow.com/users/7357841/minamijoyo"}, "is_accepted": true, "score": 5, "last_activity_date": 1483282185, "last_edit_date": 1592644375, "creation_date": 1483273774, "answer_id": 41415447, "question_id": 41415337, "link": "https://stackoverflow.com/questions/41415337/running-external-python-in-golang-catching-continuous-exec-command-stdout/41415447#41415447", "title": "Running external python in Golang, Catching continuous exec.Command Stdout", "body": "<p>Use <code>cmd.Start()</code> and <code>cmd.Wait()</code> instead of <code>cmd.Run()</code>.</p>\n<p><a href=\"https://golang.org/pkg/os/exec/#Cmd.Run\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/#Cmd.Run</a></p>\n<blockquote>\n<p>Run starts the specified command and waits for it to complete.</p>\n<p>Start starts the specified command but does not wait for it to complete.</p>\n<p>Wait waits for the command to exit. It must have been started by Start.</p>\n</blockquote>\n<p>And if you want to capture stdout/stderr concurrently, use <code>cmd.StdoutPipe()</code> / <code>cmd.StderrPipe()</code> and read it by <code>bufio.NewScanner()</code></p>\n<pre><code>package main\n\nimport (\n    &quot;bufio&quot;\n    &quot;fmt&quot;\n    &quot;io&quot;\n    &quot;os/exec&quot;\n)\n\nfunc main() {\n    cmd := exec.Command(&quot;python&quot;, &quot;game.py&quot;)\n    stdout, err := cmd.StdoutPipe()\n    if err != nil {\n        panic(err)\n    }\n    stderr, err := cmd.StderrPipe()\n    if err != nil {\n        panic(err)\n    }\n    err = cmd.Start()\n    if err != nil {\n        panic(err)\n    }\n\n    go copyOutput(stdout)\n    go copyOutput(stderr)\n    cmd.Wait()\n}\n\nfunc copyOutput(r io.Reader) {\n    scanner := bufio.NewScanner(r)\n    for scanner.Scan() {\n        fmt.Println(scanner.Text())\n    }\n}\n</code></pre>\n<p>The following is a sample python code for reproducing real-time output. The stdout may be buffered in Python. Explicit flush may be required.</p>\n<pre><code>import time\nimport sys\n\nwhile True:\n    print &quot;Hello&quot;\n    sys.stdout.flush()\n    time.sleep(1)\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 6893963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10154623771900712/picture?type=large", "display_name": "Louis Ng", "link": "https://stackoverflow.com/users/6893963/louis-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6279, "favorite_count": 1, "accepted_answer_id": 41415447, "answer_count": 1, "score": 1, "last_activity_date": 1483282185, "creation_date": 1483272587, "question_id": 41415337, "link": "https://stackoverflow.com/questions/41415337/running-external-python-in-golang-catching-continuous-exec-command-stdout", "title": "Running external python in Golang, Catching continuous exec.Command Stdout", "body": "<p>So my go script will call an external python like this</p>\n\n<pre><code>cmd = exec.Command(\"python\",\"game.py\")\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\ngo func(){\n    err := cmd.Run()\n    if err != nil{\n    panic(err)\n    }\n}()\n</code></pre>\n\n<p>It runs my python script concurrently which is awesome.\nBut now the problem is, my python script will run infinitely and it will print out some information from time to time. I want to \"catch\" these Stdout and print them out on my golang terminal. How do I do it concurrently (without waiting my python script to exit)?</p>\n"}, {"tags": ["linux", "go"], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "is_accepted": false, "score": 1, "last_activity_date": 1483259117, "creation_date": 1483259117, "answer_id": 41414245, "question_id": 41414041, "link": "https://stackoverflow.com/questions/41414041/printing-a-list-from-within-a-list-in-go-loop-trouble/41414245#41414245", "title": "Printing a list from within a list in Go. Loop trouble", "body": "<p>This was a bad question. Soon after posting I had realised that the array was obviously empty due to the fact that RouteList was being called without the receiver <code>Handler</code>. This was fixed by simply: </p>\n\n<pre><code>for i, r := range rl {\n    log.Printf(\"%d: %s\", i, LinkIndex)\n  }\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1483259117, "creation_date": 1483256044, "question_id": 41414041, "link": "https://stackoverflow.com/questions/41414041/printing-a-list-from-within-a-list-in-go-loop-trouble", "title": "Printing a list from within a list in Go. Loop trouble", "body": "<p>Trying to print a list of routes from within a network namespace. The <code>netlink.RouteList</code> function requires an <code>Interface</code> type. A list of all interfaces is gathered by <code>LinkList()</code>. </p>\n\n<p>I'm trying to call RouteList with every interface and print it's output. RouteList returns type <code>Route</code> where I'm trying to print the <code>int</code> LinkIndex. </p>\n\n<p>It appears as if my loop</p>\n\n<pre><code>  for j := range rt {\n    log.Printf(\"Route: %d : %d\",rt[j].LinkIndex)\n  }\n</code></pre>\n\n<p>Isn't executing for some reason, running another Printf test in there yields nothing.</p>\n\n<p>Why wouldn't this loop be called?</p>\n\n<pre><code>func (h *NSHandle) showInts() {\n  nh := (*netlink.Handle)(h) //cast required\n  int, err := nh.LinkList()\n  if err != nil {\n      log.Fatal(err)\n  }\n  log.Printf(\"Namespace Ints:\")\n  for i, r := range int {\n      log.Printf(\"%d: %s\", i, r.Attrs().Name)\n      rt, err := netlink.RouteList(r,-1)\n      if err != nil {\n        log.Fatal(err)\n      }\n      for j := range rt {\n        log.Printf(\"Route: %d : %d\",rt[j].LinkIndex)\n      }\n  }\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "gorilla"], "comments": [{"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1483229554, "post_id": 41412317, "comment_id": 70028795, "body": "@MellowMarmot - done. thanks."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1483244702, "post_id": 41412317, "comment_id": 70030624, "body": "For posterity: this was fixed by Gary (the maintainer) after Dheeraj raised the issue: <a href=\"https://github.com/gorilla/websocket/issues/200\" rel=\"nofollow noreferrer\">github.com/gorilla/websocket/issues/200</a>"}, {"owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1483247192, "post_id": 41412317, "comment_id": 70030913, "body": "That was a super quick fix, thank you very much for your help. Meanwhile, does GAE do not support websockets? I am try to connect to it but it is always showing &quot;WebSocket connection to &#39;ws://localhost:8080/websocket&#39; failed: Error during WebSocket handshake: Unexpected response code: 400&quot;"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1483262268, "post_id": 41412317, "comment_id": 70032836, "body": "It looks like they don&#39;t support it on GAE classic: <a href=\"https://code.google.com/p/googleappengine/issues/detail?id=2535\" rel=\"nofollow noreferrer\">code.google.com/p/googleappengine/issues/detail?id=2535</a> - Heroku does, and Google&#39;s Firebase product may."}], "owner": {"reputation": 147, "user_id": 5728873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/R37ba.jpg?s=128&g=1", "display_name": "Dheeraj Sarwaiya", "link": "https://stackoverflow.com/users/5728873/dheeraj-sarwaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 578, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1513239966, "creation_date": 1483226181, "last_edit_date": 1513239966, "question_id": 41412317, "link": "https://stackoverflow.com/questions/41412317/gorilla-websocket-with-google-app-engine", "title": "Gorilla websocket with google app engine", "body": "<p>I am getting following error when I am running \"goapp serve myapp/\" from Myproject folder inside src.</p>\n\n<blockquote>\n  <p>go-app-builder: Failed parsing input: parser: bad import \"unsafe\" in\n  github.com/gorilla/websocket/client.go from GOPATH</p>\n</blockquote>\n\n<p>my file structure is some something like this</p>\n\n<pre><code>$GOPATH/src\n|-github.com/gorilla/websocket\n|-MyProject\n   |-myapp\n      |-app.yaml\n      |-mainApp.go (which contain init function and part of app package)\n</code></pre>\n\n<p>Please let me know how to correct this. </p>\n\n<p>on a related subject, I read that google app provide websocket support only in paid app. Is there a way for me to test my website before getting into payment mode? Or is there a better option that google app engine?</p>\n"}, {"tags": ["go", "go-echo"], "comments": [{"owner": {"reputation": 6663, "user_id": 532685, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/00fed527cb6dfa9b682b361c2de27e42?s=128&d=identicon&r=PG", "display_name": "nycynik", "link": "https://stackoverflow.com/users/532685/nycynik"}, "edited": false, "score": 0, "creation_date": 1483208030, "post_id": 41410655, "comment_id": 70024676, "body": "I do not know Echo, but in most languages that have bindings like this, if you do not know the whole object, you have to resort to parsing the JSON with a lower level library."}, {"owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "edited": false, "score": 1, "creation_date": 1483208602, "post_id": 41410655, "comment_id": 70024815, "body": "I have no problems doing this. Mind posting some of your code?"}], "answers": [{"tags": [], "owner": {"reputation": 737, "user_id": 6275844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f7071f7e0149f02e945420a120a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan 0", "link": "https://stackoverflow.com/users/6275844/dan-0"}, "is_accepted": false, "score": 1, "last_activity_date": 1483209924, "last_edit_date": 1495541339, "creation_date": 1483209924, "answer_id": 41410913, "question_id": 41410655, "link": "https://stackoverflow.com/questions/41410655/extract-json-from-golangs-echo-request/41410913#41410913", "title": "extract JSON from golang&#39;s echo request", "body": "<p>I'm not the most experienced with Echo, but to my knowledge the bind won't work in this case. @elithar provided what may be a good answer to your question in another thread:</p>\n\n<hr>\n\n<p>From: <a href=\"https://stackoverflow.com/questions/35822102/golang-json-single-value-parsing\">Golang Json single value parsing</a></p>\n\n<p>You can decode into a map[string]interface{} and then get the element by key.</p>\n\n<pre><code>data := make(map[string]interface{})\nerr := json.Unmarshal(content, &amp;data)\nif err != nil {\n   return nil, err\n}\n\nprice, ok := data[\"ask_price\"].(string); !ok {\n    // ask_price is not a string\n    return nil, errors.New(\"wrong type\")\n}\n\n// Use price as you wish\n</code></pre>\n\n<p>Structs are often preferred as they are more explicit about the type. You only have to declare the fields in the JSON you care about, and you don't need to type assert the values as you would with a map (encoding/json handles that implicitly).</p>\n\n<hr>\n\n<p>You should be able to grab your context's data and extract the fields you want in this manner.</p>\n"}, {"tags": [], "owner": {"reputation": 1638, "user_id": 448844, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/23d9a83bfedeaa2c56a49edd134ec2ea?s=128&d=identicon&r=PG", "display_name": "7hacker", "link": "https://stackoverflow.com/users/448844/7hacker"}, "is_accepted": true, "score": 9, "last_activity_date": 1483227194, "creation_date": 1483227194, "answer_id": 41412371, "question_id": 41410655, "link": "https://stackoverflow.com/questions/41410655/extract-json-from-golangs-echo-request/41412371#41412371", "title": "extract JSON from golang&#39;s echo request", "body": "<p>This is how I did it:</p>\n\n<pre><code>json_map := make(map[string]interface{})\nerr := json.NewDecoder(c.Request().Body).Decode(&amp;json_map)\nif err != nil {\n    return err\n} else {\n    //json_map has the JSON Payload decoded into a map\n    cb_type := json_map[\"type\"]\n    challenge := json_map[\"challenge\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 659, "user_id": 1155514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjZMX.jpg?s=128&g=1", "display_name": "Muhammad Tariq", "link": "https://stackoverflow.com/users/1155514/muhammad-tariq"}, "is_accepted": false, "score": 0, "last_activity_date": 1612365941, "last_edit_date": 1612365941, "creation_date": 1612354815, "answer_id": 66027447, "question_id": 41410655, "link": "https://stackoverflow.com/questions/41410655/extract-json-from-golangs-echo-request/66027447#66027447", "title": "extract JSON from golang&#39;s echo request", "body": "<p>Using Golang's Echo framework, you extract data from JSON like this</p>\n<h2>Sample Json</h2>\n<pre><code>{\n    &quot;username&quot;: &quot;Super User&quot;,\n    &quot;useremail&quot;: &quot;super@user.email&quot;\n}\n</code></pre>\n<h2>Code</h2>\n<pre class=\"lang-go prettyprint-override\"><code>\nimport (\n    &quot;github.com/labstack/echo&quot;\n)\n\nfunc main() {\n    my_data := echo.Map{}\n    if err := echoCtx.Bind(&amp;my_data); err != nil {\n        return err\n    } else {\n\n        username := fmt.Sprintf(&quot;%v&quot;, my_data[&quot;username&quot;])\n        useremail := fmt.Sprintf(&quot;%v&quot;, my_data[&quot;useremail&quot;])\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 626, "user_id": 4001671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NexwL.png?s=128&g=1", "display_name": "philip mudenyo", "link": "https://stackoverflow.com/users/4001671/philip-mudenyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1612582473, "creation_date": 1612582473, "answer_id": 66073331, "question_id": 41410655, "link": "https://stackoverflow.com/questions/41410655/extract-json-from-golangs-echo-request/66073331#66073331", "title": "extract JSON from golang&#39;s echo request", "body": "<p>I created a custom function that retrieves raw json body and returns a nil if no values present otherwise in returns a map[string]interface{}</p>\n<pre><code>import (\n   &quot;encoding/json&quot;\n   &quot;github.com/labstack/echo/v4&quot;\n   &quot;github.com/labstack/gommon/log&quot;\n)\n \n \nfunc GetJSONRawBody(c echo.Context) map[string]interface{}  {\n\n     jsonBody := make(map[string]interface{})\n     err := json.NewDecoder(c.Request().Body).Decode(&amp;jsonBody)\n     if err != nil {\n\n         log.Error(&quot;empty json body&quot;)\n         return nil\n     }\n\n    return jsonBody\n}\n</code></pre>\n"}], "owner": {"reputation": 1638, "user_id": 448844, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/23d9a83bfedeaa2c56a49edd134ec2ea?s=128&d=identicon&r=PG", "display_name": "7hacker", "link": "https://stackoverflow.com/users/448844/7hacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9056, "favorite_count": 1, "accepted_answer_id": 41412371, "answer_count": 4, "score": 8, "last_activity_date": 1617209919, "creation_date": 1483207459, "last_edit_date": 1521026785, "question_id": 41410655, "link": "https://stackoverflow.com/questions/41410655/extract-json-from-golangs-echo-request", "title": "extract JSON from golang&#39;s echo request", "body": "<p>I'm using <a href=\"https://echo.labstack.com/guide\" rel=\"noreferrer\">Echo</a> to build a minimalist server in Golang.</p>\n\n<p>In, Echo one can <a href=\"https://echo.labstack.com/guide/request\" rel=\"noreferrer\">bind an incoming JSON request payload to a struct</a> internally and access the payload. </p>\n\n<p>However I have a scenario wherein I know only 3 fields of the incoming JSON request payload, and the bind doesn't work in this case.</p>\n\n<p>How do I still access the 3 fields that I care about ? If I cannot do this in Echo, can you recommend me a JSON decoder that works with Echo's context structure?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1483219715, "post_id": 41410459, "comment_id": 70027295, "body": "methods Create and Update need an empty interface{} as parameters no a person struct"}], "answers": [{"tags": [], "owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "is_accepted": false, "score": 1, "last_activity_date": 1483224382, "creation_date": 1483224382, "answer_id": 41412194, "question_id": 41410459, "link": "https://stackoverflow.com/questions/41410459/how-to-create-a-generic-interface-for-a-crud-model/41412194#41412194", "title": "How to create a generic interface for a CRUD model?", "body": "<p>You should try to implement your method like this, it's just because you ask in your func Create and Update an empty interface as params : </p>\n\n<pre><code>func (model *PersonModel) Create(v interface{}) (int64, error) {\n    // do database related stuff to create the person from the struct\n}\n\nfunc (model *PersonModel) Update(id string, v interface{}) (error) {\n    // do database related stuff to update the person model from the struct\n}\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 5076225, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f51749961a6a3233df8063d13375492c?s=128&d=identicon&r=PG&f=1", "display_name": "gauge", "link": "https://stackoverflow.com/users/5076225/gauge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483224382, "creation_date": 1483205524, "question_id": 41410459, "link": "https://stackoverflow.com/questions/41410459/how-to-create-a-generic-interface-for-a-crud-model", "title": "How to create a generic interface for a CRUD model?", "body": "<p>I'm trying to create a generic interface in go for models I wish to use in my api.</p>\n\n<pre><code>type Model interface {\n    Create(interface{}) (int64, error)\n    Update(string, interface{}) (error)\n}\n</code></pre>\n\n<p>And I have a personModel which implements it:</p>\n\n<pre><code>type Person struct {\n    Id int `json:\"id\"`\n    FirstName string `json:\"firstName\"`\n}\n\ntype PersonModel struct {\n    Db *sql.DB\n}\n\nfunc (model *PersonModel) Create(personStruct person) (int64, error) {\n    // do database related stuff to create the person from the struct\n}\n\nfunc (model *PersonModel) Update(id string, personStruct person) (error) {\n    // do database related stuff to update the person model from the struct\n}\n</code></pre>\n\n<p>However, I can't get this to work, as I'm getting errors related to how the <code>PersonModel</code> does not implement the <code>Model</code> interface. </p>\n\n<p>My main goal is to have a unified interface for all models in my application (implementing <code>create</code> and <code>update</code>) that can be used by the controllers. How would I go about overcoming this problem?</p>\n"}, {"tags": ["arrays", "json", "go", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "is_accepted": false, "score": 2, "last_activity_date": 1483198290, "creation_date": 1483198290, "answer_id": 41409632, "question_id": 41409454, "link": "https://stackoverflow.com/questions/41409454/how-to-convert-array-of-errors-to-json-in-go/41409632#41409632", "title": "How to convert array of errors to JSON in Go", "body": "<p>An <code>error</code> type is an interface which must implement an <code>Error()</code> method that returns an error message as a string. This is defined here: <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"nofollow noreferrer\">https://golang.org/pkg/builtin/#error</a>. The reason why the <code>error</code> type is an interface, is to allow for <code>error</code> types that can be type casted to retrieve more detailed information. </p>\n\n<p>Functions like <code>fmt.Println</code> and <code>log.Println</code> automatically resolves <code>error</code> types to display the message from <code>Error()</code>, the JSON library however, does not. The simplest way to get around this problem is by converting the error messages in <code>[]error</code> to a <code>[]string</code> and encoding that.</p>\n\n<p>Here's some example code to do that with a for loop.</p>\n\n<pre><code>errs := person.Validate()\nstrErrors := make([]string, len(errs))\n\nfor i, err := range errs {\n    strErrors[i] = err.Error()\n}\n\nc.JSON(422, gin.H{\"errors\" : strErrors})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1483344230, "last_edit_date": 1483344230, "creation_date": 1483340625, "answer_id": 41422615, "question_id": 41409454, "link": "https://stackoverflow.com/questions/41409454/how-to-convert-array-of-errors-to-json-in-go/41422615#41422615", "title": "How to convert array of errors to JSON in Go", "body": "<p>The <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"nofollow noreferrer\"><code>error</code></a> type is an interface with a single <code>Error()</code> method, but it is not special to the <code>json</code> package (the <code>Error()</code> method is not called on it).</p>\n\n<p>However, <code>error</code> values may hold values of static types which may be nicely marshalable, or they may define their own marshaling logic by implementing <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\"><code>json.Marshaler</code></a>. Simply converting an <code>error</code> to <code>string</code> by calling its <code>Error()</code> method means we're not honoring the custom marshaling logic.</p>\n\n<p>So I would suggest to create our own error slice type, on which we can implement our marshaling logic which should be:</p>\n\n<ul>\n<li>check if the error value implements <code>json.Marshaler</code>, and if so, let it marshal itself</li>\n<li>else as a fallback case call <code>error.Error()</code> to \"obtain\" a <code>string</code> which can easily be marshaled</li>\n</ul>\n\n<p>This is how it could look like:</p>\n\n<pre><code>type JSONErrs []error\n\nfunc (je JSONErrs) MarshalJSON() ([]byte, error) {\n    res := make([]interface{}, len(je))\n    for i, e := range je {\n        if _, ok := e.(json.Marshaler); ok {\n            res[i] = e // e knows how to marshal itself\n        } else {\n            res[i] = e.Error() // Fallback to the error string\n        }\n    }\n    return json.Marshal(res)\n}\n</code></pre>\n\n<p>And this is how you can use it:</p>\n\n<pre><code>err := person.Validate()\nc.JSON(422, gin.H{\"errors\" : JSONErrs(err)})\n</code></pre>\n\n<p>Let's test our <code>JSONErrs</code>. We're also use a custom error type which implements custom marshaling logic:</p>\n\n<pre><code>type MyErr struct{ line int }\n\nfunc (me MyErr) Error() string { return \"Invalid input!\" }\n\nfunc (me MyErr) MarshalJSON() ([]byte, error) {\n    return json.Marshal(\n        struct {\n            Type, Error string\n            AtLine      int\n        }{\"MyErr\", me.Error(), me.line})\n}\n</code></pre>\n\n<p>And the test code:</p>\n\n<pre><code>errs := []error{\n    errors.New(\"first\"),\n    errors.New(\"second\"),\n    MyErr{16},\n}\n\ndata, err := json.Marshal(JSONErrs(errs))\nfmt.Println(string(data), err)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/NSyMcwlLXm\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[\"first\",\"second\",{\"Type\":\"MyErr\",\"Error\":\"Invalid input!\",\"AtLine\":16}] &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 396, "user_id": 5271400, "user_type": "registered", "profile_image": "https://graph.facebook.com/842781095836945/picture?type=large", "display_name": "Wilson Tamarozzi", "link": "https://stackoverflow.com/users/5271400/wilson-tamarozzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3404, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1483344230, "creation_date": 1483197117, "question_id": 41409454, "link": "https://stackoverflow.com/questions/41409454/how-to-convert-array-of-errors-to-json-in-go", "title": "How to convert array of errors to JSON in Go", "body": "<p>I have an array of errors (type of error), but when I try to return the client in JSON format, it arrives empty.</p>\n\n<p><strong>It was created this way:</strong></p>\n\n<pre><code>var (\n    ErrEmptyName = errors.New(\"Nome n\u00e3o pode ser v\u00e1zio\")\n    ErrInvalidType = errors.New(\"Tipo de pessoa inv\u00e1lido\")\n)\n\nfunc (p Person) Validate() []error {\n\n    var errors []error\n\n    if govalidator.IsNull(p.Name) {\n        errors = append(errors, ErrEmptyName)\n    }\n\n    if p.Type != \"F\" &amp;&amp; p.Type != \"J\" {\n        errors = append(errors, ErrInvalidType)\n    }\n\n    return errors\n)\n</code></pre>\n\n<p><strong>In my Controller:</strong></p>\n\n<pre><code>err := person.Validate()\nc.JSON(422, gin.H{\"errors\" : err})\n</code></pre>\n\n<p><strong>My Output:</strong></p>\n\n<pre><code>{\"errors\":\"[{}]\"}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1483173291, "post_id": 41406501, "comment_id": 70016440, "body": "I think so. Take a look at this: (<a href=\"https://play.golang.org/p/b-fyvCiR7b\" rel=\"nofollow noreferrer\">play.golang.org/p/b-fyvCiR7b</a>)  The size of the pointer is always 4 bytes. In a 32bits processor, the word size is 32 bits (4 bytes). Obviously in a 64bits processor you have 8 bytes words. So based on that and the snippet you posted from the documentation I&#39;d say it&#39;s safe."}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "reply_to_user": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1483216142, "post_id": 41406501, "comment_id": 70026487, "body": "@AmirKeibi The important thing to note is that the <i>guarantee</i> from the docs is <b>not</b> saying a <i>single machine word operation</i> is atomic. It&#39;s only saying operations larger than a single machine word are unordered. In reality, regardless of whether a read and write is a single machine word operation, there is still no guarantee (and no way for Go to guarantee) that the operation is atomic. It&#39;s hardware dependent, undefined from Go&#39;s perspective, and therefore, requires synchronization."}, {"owner": {"reputation": 5539, "user_id": 871134, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BKxlV.jpg?s=128&g=1", "display_name": "Deleplace", "link": "https://stackoverflow.com/users/871134/deleplace"}, "edited": false, "score": 1, "creation_date": 1493726805, "post_id": 41406501, "comment_id": 74517875, "body": "I think the question title is a bit misleading. Concurrent reads are safe, but everything collapses when at least one write operation is involved."}], "answers": [{"comments": [{"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1483173798, "post_id": 41406777, "comment_id": 70016537, "body": "That&#39;s a good point. But I don&#39;t think his question was about race conditions. &quot;That is, is it possible for i to be nil, partially assigned, invalid, undefined, ... anything other than either a or b?&quot;"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 2, "creation_date": 1483174027, "post_id": 41406777, "comment_id": 70016590, "body": "<i>The only question is whether assigning to i is safe</i>"}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 0, "creation_date": 1483174100, "post_id": 41406777, "comment_id": 70016606, "body": "Not really, he clarifies what the question is: &quot;anything other than either a or b?&quot;"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "edited": false, "score": 1, "creation_date": 1483174331, "post_id": 41406777, "comment_id": 70016640, "body": "@AmirKeibi And since there is a race condition, the answer is yes."}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 0, "creation_date": 1483210373, "post_id": 41406777, "comment_id": 70025224, "body": "My question isn&#39;t really about a data race. While <code>-race</code> does indeed show a race, i don&#39;t care about it if the value is always guaranteed to valid. I believe this ultimately is more about a hardware question and whether it&#39;s ever possible for a value written to an address to be in a state that&#39;s invalid while a concurrent read is occurring."}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 0, "creation_date": 1483214416, "post_id": 41406777, "comment_id": 70026160, "body": "In the end, I think the best advice is to respect the <code>-race</code> :)"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 5, "last_activity_date": 1483173496, "creation_date": 1483173496, "answer_id": 41406777, "question_id": 41406501, "link": "https://stackoverflow.com/questions/41406501/is-it-safe-to-read-a-function-pointer-concurrently-without-a-lock/41406777#41406777", "title": "Is it safe to read a function pointer concurrently without a lock?", "body": "<p>In terms of <a href=\"https://en.wikipedia.org/wiki/Race_condition\" rel=\"noreferrer\">Race condition</a>, it's not safe. In short my understanding of race condition is when there're more than one asynchronous routine (coroutines, threads, process, goroutines etc.) trying to access the same resource and at least one is a writing operation, so in your example we have 2 goroutines reading and writing variables of type function, I think what's matter from a concurrent point of view is those variables have a memory space somewhere and we're trying to read or write in that portion of memory.</p>\n\n<p><em>Short answer</em>: just run your example using the <a href=\"https://blog.golang.org/race-detector\" rel=\"noreferrer\">-race</a> flag with <code>go run -race</code> \nor <code>go build -race</code> and you'll see a detected <strong>data race</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1483197237, "post_id": 41407827, "comment_id": 70021838, "body": "As usually, very well put. I would also recommend the OP to read <a href=\"http://preshing.com/20130618/atomic-vs-non-atomic-operations/\" rel=\"nofollow noreferrer\">this piece</a> for to get better grasp of the underlying H/W issues. To sum it up for the OP, there exist two problems &quot;below&quot; the code as they write it in the text editor: 1) the compiler can produce machine code which does &quot;strange&quot; things with memory location of your variables; 2) multi-CPU and/or -core hardware has cache coherency issues: when a CPU reads a value from the memory, it&#39;s not necessarily reading it from the same place another CPU wrote it to."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1483197428, "post_id": 41407827, "comment_id": 70021879, "body": "Oh, and the third problem: 3) Contemporary CPUs on widely used H/W platforms routinely perform reordering of memory accesses. All these three issues only &quot;break things&quot; when the programmer has expectations besides what&#39;s guaranteed by the language&#39;s memory model, so please don&#39;t have them. ;-)"}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1483211960, "post_id": 41407827, "comment_id": 70025636, "body": "<i>Stop thinking that some data races are (or may be) benign or unharmful.</i> 1) At one level, what the value of <code>i</code> is, a race is benign since I don&#39;t care whether it&#39;s <code>a</code> or <code>b</code>. 2) I wouldn&#39;t have asked the question if i thought the underlying issue of this being undefined behavior was benign. 3) The main question, which is mostly answered in the @kostix and &quot;what could go wrong?&quot; link is how the hardware handles move and store operations concurrently. I wasn&#39;t seeking a commentary on your assumptions about my understanding of concurrency. I was seeking a clarification on Go&#39;s Memory Model."}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 0, "creation_date": 1483214211, "post_id": 41407827, "comment_id": 70026123, "body": "To clarify <i>point 1</i> in my prior comment: The algorithm is designed to not care about the value in <code>i</code>. In the real algorithm, it is designed to actually randomize the assignment-timing to <code>a</code> from dozens of values randomly. All that matters is that the read will be a valid value. What it seems to boil down to is, in the compiled code, is the <code>mov</code> of the read always going to have a consistent view of the memory its reading? Can the <code>mov</code> into <code>a</code>&#39;s memory overlap the read such that the read is reading a partial write? I think the answer is, it&#39;s undefined because it&#39;s hardware dependent."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 2, "creation_date": 1483214751, "post_id": 41407827, "comment_id": 70026214, "body": "@nicerobot That&#39;s my point. You <i>don&#39;t</i> have that guarantee that <code>i</code>&#39;s value will be valid, that&#39;s what <i>undefined</i> means. Your program may even <i>crash</i>, I guess you don&#39;t take that as being benign. It <i>may</i> be that with the current compiler, hardware and generated code you won&#39;t experience this, but you don&#39;t have the guarantee. It may even be that the next version of Go compiler will generate a different, &quot;optimized&quot; code which will &quot;misbehave&quot; according to what you wanted your program to do \u2013 just because you left data races in your code."}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 0, "creation_date": 1483215155, "post_id": 41407827, "comment_id": 70026278, "body": "@icza Yep, i don&#39;t actually care if the app panics during the read (if <code>recover</code> can trap it and the panic is infrequent). I just wanted the clarification of Go&#39;s guarantees pertaining to the <i>single machine word operations</i>. At any rate, I think this <i>being undefined</i> is the &quot;safe&quot; answer, and <a href=\"http://preshing.com/20130618/atomic-vs-non-atomic-operations/\" rel=\"nofollow noreferrer\">@kostix</a>&#39;s link provides the best clarification for those new to concurrency."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 1, "creation_date": 1483215244, "post_id": 41407827, "comment_id": 70026292, "body": "@nicerobot, consider using <code>sync&#47;atomic</code> operations to access your value: you won&#39;t get any ordering guarantees (and you don&#39;t need them) but you will be safe in terms of the memory model as these functions ensure proper memory fencing where required. You could search for a recent thread on the <code>golang-nuts</code> mailing list dealing exactly with this issue."}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1483215747, "post_id": 41407827, "comment_id": 70026394, "body": "@kostix Thanks. It&#39;s appreciated. I&#39;m well versed in concurrency and Go&#39;s concurrency primitives and options in the std lib. I was only seeking a clarification of the memory model documentation and that specific Go guarantee of <i>single machine word operations</i>. Regardless, great responses all around and will hopefully be helpful to others. And your link above is one of the clearest i&#39;ve read on the subject in a long time. Thanks again."}, {"owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 0, "creation_date": 1483285390, "post_id": 41407827, "comment_id": 70037708, "body": "@icza Here&#39;s the thing, targeting amd64, <code>i := a</code> compiles to a <code>MOVQ</code>. Even in parallel pipelines, I think that won&#39;t ever result in an inconsistent value. You can&#39;t know which value you&#39;ll get but because it&#39;s a single instruction I think it will always get a consistent view of memory. CPU and memory systems certainly enforce that. In other words, while I agree that it&#39;s not, in general, a safe operation, if i had restricted the question to amd64, i think it can be said it will be safe."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 1, "creation_date": 1483352445, "post_id": 41407827, "comment_id": 70055226, "body": "@nicerobot, FYI, that&#39;s <a href=\"https://groups.google.com/d/topic/golang-nuts/I-p5vmyln9c/discussion\" rel=\"nofollow noreferrer\">the thread</a> I referred to, and in particular, <a href=\"https://groups.google.com/d/msg/golang-nuts/I-p5vmyln9c/zRdn4NBEAwAJ\" rel=\"nofollow noreferrer\">this response</a> from one of the core team folks dealing with <code>Load*()</code> and <code>Store*()</code> of <code>sync&#47;atomic</code> and happens-before guarantees they offer according to the memory model; it also mentions an interesting <a href=\"https://golang.org/issue/5045\" rel=\"nofollow noreferrer\">issue</a>. Hope this will be of interest to you."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "edited": false, "score": 1, "creation_date": 1483352731, "post_id": 41407827, "comment_id": 70055356, "body": "@nicerobot, as to &#171;it&#39;s okay on amd64&#187;, my take is that you should extend this definition a bit: &#171;it&#39;s apparently okay on amd64 with the <code>gc</code> toolset version 1.X.Y&#187;. Sure real-world code <i>does</i> rely on <i>implied</i> quirks of particular H/W platforms and compiler suites, but this should be well documented in the code if you intend to actually maintain it (as opposed to using it for some one-off calculation). Otherwise something like that dreaded <a href=\"https://research.swtch.com/openssl\" rel=\"nofollow noreferrer\">Debian&#39;s OpenSSL debacle</a> could happen."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 20, "last_activity_date": 1483208509, "last_edit_date": 1495540476, "creation_date": 1483183114, "answer_id": 41407827, "question_id": 41406501, "link": "https://stackoverflow.com/questions/41406501/is-it-safe-to-read-a-function-pointer-concurrently-without-a-lock/41407827#41407827", "title": "Is it safe to read a function pointer concurrently without a lock?", "body": "<p>Unsynchronized, concurrent access to any variable from multiple goroutines where at least one of them is a write is <strong>undefined behavior</strong> by <a href=\"https://golang.org/ref/mem\" rel=\"noreferrer\">The Go Memory Model</a>.</p>\n\n<p><strong>Undefined</strong> means what it says: <em>undefined</em>. It may be that your program will work correctly, it may be it will work incorrectly. It may result in losing memory and type safety provided by the Go runtime (see example below). It may even crash your program. Or it may even cause the Earth to explode (probability of that is extremely small, maybe even less than 1e-40, but still...).</p>\n\n<p>This <em>undefined</em> in your case means that yes, <code>i</code> may be <code>nil</code>, partially assigned, invalid, undefined, ... anything other than either <code>a</code> or <code>b</code>. This list is just a tiny subset of all the possible outcomes.</p>\n\n<p>Stop thinking that some data races are (or may be) benign or unharmful. They can be the source of the worst things if left unattended.</p>\n\n<p>Since your code writes to the variable <code>a</code> in one goroutine and reads it in another goroutine (which tries to assign its value to another variable <code>i</code>), it's a data race and as such it's not safe. It doesn't matter if in your tests it works \"correctly\". One could take your code as a starting point, extend / build on it and result in a catastrophe due to your initially \"unharmful\" data race.</p>\n\n<p>As related questions, read <a href=\"https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations/36167693#36167693\">How safe are Golang maps for concurrent Read/Write operations?</a> and <a href=\"https://stackoverflow.com/questions/33274920/incorrect-synchronization-in-go-lang/33275092#33275092\">Incorrect synchronization in go lang</a>.</p>\n\n<p>Strongly recommended to read the blog post by Dmitry Vyukov: <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"noreferrer\">Benign data races: what could possibly go wrong?</a></p>\n\n<p>Also a very interesting blog post which shows an example which breaks Go's memory safety with intentional data race: <a href=\"http://blog.stalkr.net/2015/04/golang-data-races-to-break-memory-safety.html\" rel=\"noreferrer\">Golang data races to break memory safety</a></p>\n"}], "owner": {"reputation": 8508, "user_id": 23056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/785b22680d1e326197da097c1aa04a55?s=128&d=identicon&r=PG", "display_name": "nicerobot", "link": "https://stackoverflow.com/users/23056/nicerobot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2375, "favorite_count": 7, "answer_count": 2, "score": 10, "last_activity_date": 1483219028, "creation_date": 1483170572, "last_edit_date": 1483219028, "question_id": 41406501, "link": "https://stackoverflow.com/questions/41406501/is-it-safe-to-read-a-function-pointer-concurrently-without-a-lock", "title": "Is it safe to read a function pointer concurrently without a lock?", "body": "<p>Suppose I have this:</p>\n\n<pre><code>go func() {\n    for range time.Tick(1 * time.Millisecond) {\n        a, b = b, a\n    }\n}()\n</code></pre>\n\n<p>And elsewhere:</p>\n\n<pre><code>i := a // &lt;-- Is this safe?\n</code></pre>\n\n<p>For this question, it's unimportant what the value of <code>i</code> is with respect to the original <code>a</code> or <code>b</code>. The only question is whether reading <code>a</code> is safe. That is, is it possible for <code>a</code> to be <code>nil</code>, partially assigned, invalid, undefined, ... anything other than a valid value?</p>\n\n<p><a href=\"https://play.golang.org/p/cvZQl6ues8\" rel=\"noreferrer\">I've tried to make it fail</a> but so far it always succeeds (on my Mac).</p>\n\n<p>I haven't been able to find anything specific beyond this quote in the <a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"noreferrer\">The Go Memory Model</a> doc:</p>\n\n<blockquote>\n  <p>Reads and writes of values larger than a single machine word behave as\n  multiple machine-word-sized operations in an unspecified order.</p>\n</blockquote>\n\n<p>Is this implying that a single machine word write is effectively atomic? And, if so, are function pointer writes in Go a single machine word operation?</p>\n\n<p><strong>Update:</strong> Here's <a href=\"https://play.golang.org/p/V6MCFF4v1J\" rel=\"noreferrer\"><em>a</em> properly synchronized solution</a></p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "edited": false, "score": 0, "creation_date": 1483156740, "post_id": 41405238, "comment_id": 70013588, "body": "can i instead just do this: apps := []Apps{} ; err := json.Unmarshal([]byte(appsJson), &amp;apps)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "edited": false, "score": 1, "creation_date": 1483156983, "post_id": 41405238, "comment_id": 70013634, "body": "@AravindR.Yarram Sure, you can do that as long as your <code>Apps</code> type doesn&#39;t have any methods expecting pointer receivers (i.e. you don&#39;t have <code>func (a *Apps) Method(...)</code> ). Otherwise, you&#39;ll likely want to use <code>[]*Apps{}</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": true, "score": 3, "last_activity_date": 1483155701, "creation_date": 1483155701, "answer_id": 41405238, "question_id": 41405202, "link": "https://stackoverflow.com/questions/41405202/how-to-access-a-struct-array-through-a-pointer/41405238#41405238", "title": "How to access a struct array through a pointer?", "body": "<pre><code>apps := &amp;[]Apps{}\n</code></pre>\n\n<p><code>apps</code> has type <code>*[]Apps</code> (pointer to slice of Apps objects).</p>\n\n<p>Are you sure you didn't mean to use the type <code>[]*Apps</code> (slice of pointers to Apps objects)?</p>\n\n<p>Assuming <code>*[]Apps</code> really is the type you intended, you'd need to use <code>(*apps)[i]</code> to access every element of <code>apps</code>. That type is also the reason why you also need to use <code>len(*apps)</code> instead of <code>len(apps)</code> (and <code>*apps</code> for pretty much everything actually).</p>\n"}], "owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 41405238, "answer_count": 1, "score": 0, "last_activity_date": 1483155701, "creation_date": 1483155307, "question_id": 41405202, "link": "https://stackoverflow.com/questions/41405202/how-to-access-a-struct-array-through-a-pointer", "title": "How to access a struct array through a pointer?", "body": "<p>Following are my 2 structs</p>\n\n<pre><code>type Attempt struct {\n    StartTime        string `json:\"startTime\"`\n    EndTime          string `json:\"endTime\"`\n    LastUpdated      string `json:\"lastUpdated\"`\n    Duration         uint32 `json:\"duration\"`\n    SparkUser        string `json:\"sparkUser\"`\n    IsCompleted      bool   `json:\"completed\"`\n    LastUpdatedEpoch int64  `json:\"lastUpdatedEpoch\"`\n    StartTimeEpoch   int64  `json:\"startTimeEpoch\"`\n    EndTimeEpoch     int64  `json:\"EndTimeEpoch\"`\n}\n\ntype Apps struct {\n    Id       string    `json:\"id\"`\n    Name     string    `json:\"name\"`\n    Attempts []Attempt `json:\"attempts\"`\n}\n</code></pre>\n\n<p>The following test parses a json string into this <code>apps := &amp;[]Apps{}</code>. When accessing the members of <code>apps</code>, I am getting the following error</p>\n\n<pre><code>invalid operation: apps[0] (type *[]Apps does not support indexing)\n</code></pre>\n\n<p><strong>The test</strong></p>\n\n<pre><code>func TestUnmarshalApps(t *testing.T) {\n    appsJson := `[\n      {\n        \"id\": \"app-20161229224238-0001\",\n        \"name\": \"Spark shell\",\n        \"attempts\": [\n          {\n        \"startTime\": \"2016-12-30T03:42:26.828GMT\",\n        \"endTime\": \"2016-12-30T03:50:05.696GMT\",\n        \"lastUpdated\": \"2016-12-30T03:50:05.719GMT\",\n        \"duration\": 458868,\n        \"sparkUser\": \"esha\",\n        \"completed\": true,\n        \"endTimeEpoch\": 1483069805696,\n        \"lastUpdatedEpoch\": 1483069805719,\n        \"startTimeEpoch\": 1483069346828\n          },\n          {\n        \"startTime\": \"2016-12-30T03:42:26.828GMT\",\n        \"endTime\": \"2016-12-30T03:50:05.696GMT\",\n        \"lastUpdated\": \"2016-12-30T03:50:05.719GMT\",\n        \"duration\": 458868,\n        \"sparkUser\": \"esha\",\n        \"completed\": true,\n        \"endTimeEpoch\": 1483069805696,\n        \"lastUpdatedEpoch\": 1483069805719,\n        \"startTimeEpoch\": 1483069346828\n          }\n        ]\n      },\n      {\n        \"id\": \"app-20161229222707-0000\",\n        \"name\": \"Spark shell\",\n        \"attempts\": [\n          {\n        \"startTime\": \"2016-12-30T03:26:50.679GMT\",\n        \"endTime\": \"2016-12-30T03:38:35.882GMT\",\n        \"lastUpdated\": \"2016-12-30T03:38:36.013GMT\",\n        \"duration\": 705203,\n        \"sparkUser\": \"esha\",\n        \"completed\": true,\n        \"endTimeEpoch\": 1483069115882,\n        \"lastUpdatedEpoch\": 1483069116013,\n        \"startTimeEpoch\": 1483068410679\n          }\n        ]\n      }\n    ]`\n    apps := &amp;[]Apps{}\n    err := json.Unmarshal([]byte(appsJson), apps)\n    if err != nil {\n        t.Fatal(err)\n    }\n    if len(*apps) != 2 {\n        t.Fail()\n    }\n\n    if len(apps[0].Attempts) != 2 {\n        t.Fail()\n    }\n}\n</code></pre>\n\n<p>How to access the fields Attempts, Id etc.?</p>\n"}, {"tags": ["go", "vue.js", "state", "store", "vuex"], "comments": [{"owner": {"reputation": 41, "user_id": 7138909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af1048043134215e81c2c4686d49f62?s=128&d=identicon&r=PG", "display_name": "user7138909", "link": "https://stackoverflow.com/users/7138909/user7138909"}, "edited": false, "score": 0, "creation_date": 1483151348, "post_id": 41404576, "comment_id": 70012763, "body": "here is a very simple version of what I am trying to achieve but with an external javascript file loading the store.   <a href=\"https://jsfiddle.net/laahs/at9decy8/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1483187860, "post_id": 41404576, "comment_id": 70019573, "body": "Your question has more to do with Vue.js than go. Either ways it&#39;s not clear what you are asking."}, {"owner": {"reputation": 3327, "user_id": 682583, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/11K32.png?s=128&g=1", "display_name": "Christof", "link": "https://stackoverflow.com/users/682583/christof"}, "edited": false, "score": 0, "creation_date": 1490364638, "post_id": 41404576, "comment_id": 73092704, "body": "This sounds pretty hacky. What I&#39;ve learned using VueJS is: if it feels wrong, it usually is wrong. Can you not load the initial data from the API via an an action and commit a mutation which sets the initial state? Check out the vuex shopping cart example on github, it&#39;s simple but it does something similar if I understand your question correctly."}], "owner": {"reputation": 41, "user_id": 7138909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af1048043134215e81c2c4686d49f62?s=128&d=identicon&r=PG", "display_name": "user7138909", "link": "https://stackoverflow.com/users/7138909/user7138909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1483173718, "creation_date": 1483146822, "last_edit_date": 1483173718, "question_id": 41404576, "link": "https://stackoverflow.com/questions/41404576/server-side-computation-of-initial-vue-js-vuex-store-state", "title": "Server side computation of initial vue.js vuex store state", "body": "<p>I am working on a project for which I have an API service and webclient service (Hosted on google appengine, just for information). The webapp/webclient is served by a golang server, which will take requests,  make appropriate API calls and compile HTML template with data from the API call In order to initiate the page with some information instead of waiting for the app itself to make API calls, which could be less SEO friendly. </p>\n\n<p>As a <code>javascript</code> Rendering engine/framework I am using <code>vue.js</code>, and in order to share state between components and to have a single source of truth, I am trying to use vuex ... \nThe thing gets a little bit dirty because I am injecting some Javascript in the response served by the webserver, containing a dynamic <code>vuex.Store.state</code> ... The initial state is inserted in the HTML response, which later imports an external Js file (the app) which would call this global Store, and insert it in the root Vue instance and every of its children. </p>\n\n<p>The issue is that when trying to access the store.state via <code>this.$store.state</code> I receive </p>\n\n<pre><code>TypeError: undefined is not an object (evaluating 'this.$store.state') \n</code></pre>\n\n<p>Any idea? Is it possible to initiate the store in a HTML file, use the store in a later imported external file to inject its content?\nIn the external JS I am able to call the global Store and log it in the console, so this object seems to be global as expected.</p>\n\n<p>when starting the root Vue instance and passing the store in the options, seems to be a problem because I get an error when trying to call <code>this.$store.state</code> in child Vue.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "is_accepted": false, "score": 1, "last_activity_date": 1483170219, "creation_date": 1483170219, "answer_id": 41406470, "question_id": 41404011, "link": "https://stackoverflow.com/questions/41404011/error-when-trying-to-install-stackimpact-library-in-go/41406470#41406470", "title": "Error when trying to install StackImpact library in GO", "body": "<p>You're trying to compile a code that's meant for linux in Windows. syscall.Getrusage is a linux system call.</p>\n\n<p><a href=\"https://golang.org/src/syscall/zsyscall_linux_amd64.go?s=13296:13347#L546\" rel=\"nofollow noreferrer\">https://golang.org/src/syscall/zsyscall_linux_amd64.go?s=13296:13347#L546</a></p>\n"}, {"tags": [], "owner": {"reputation": 476, "user_id": 1384136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e64d7676ad56f70760207b2a688b9ff?s=128&d=identicon&r=PG", "display_name": "logix", "link": "https://stackoverflow.com/users/1384136/logix"}, "is_accepted": false, "score": 0, "last_activity_date": 1483694918, "creation_date": 1483694918, "answer_id": 41502618, "question_id": 41404011, "link": "https://stackoverflow.com/questions/41404011/error-when-trying-to-install-stackimpact-library-in-go/41502618#41502618", "title": "Error when trying to install StackImpact library in GO", "body": "<p>Windows is supported starting from agent version <a href=\"https://github.com/stackimpact/stackimpact-go\" rel=\"nofollow noreferrer\">1.2.2</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7355956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be70752cb85b771ddedb62a20e54e3bf?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Gazio", "link": "https://stackoverflow.com/users/7355956/leonardo-gazio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483694918, "creation_date": 1483140848, "question_id": 41404011, "link": "https://stackoverflow.com/questions/41404011/error-when-trying-to-install-stackimpact-library-in-go", "title": "Error when trying to install StackImpact library in GO", "body": "<p>I'm getting the below errors when trying to install StackImpact in GO. Does anyone know how to fix it?</p>\n\n<p>Tnx..</p>\n\n<pre><code>Microsoft Windows [vers\u00e3o 6.1.7601]\nCopyright (c) 2009 Microsoft Corporation. Todos os direitos reservados.\nC:\\Users\\leonardo&gt;go get github.com/stackimpact/stackimpact-go\n# github.com/stackimpact/stackimpact-go/internal\nC:\\gowork\\src\\github.com\\stackimpact\\stackimpact-go\\internal\\process_reporter.go\n:96: undefined: syscall.Getrusage\nC:\\gowork\\src\\github.com\\stackimpact\\stackimpact-go\\internal\\process_reporter.go\n:102: rusage.Utime undefined (type *syscall.Rusage has no field or method Utime)\nC:\\gowork\\src\\github.com\\stackimpact\\stackimpact-go\\internal\\process_reporter.go\n:103: rusage.Utime undefined (type *syscall.Rusage has no field or method Utime)\nC:\\gowork\\src\\github.com\\stackimpact\\stackimpact-go\\internal\\process_reporter.go\n:104: rusage.Stime undefined (type *syscall.Rusage has no field or method Stime)\nC:\\gowork\\src\\github.com\\stackimpact\\stackimpact-go\\internal\\process_reporter.go\n:105: rusage.Stime undefined (type *syscall.Rusage has no field or method Stime)\nC:\\gowork\\src\\github.com\\stackimpact\\stackimpact-go\\internal\\process_reporter.go\n:112: undefined: syscall.Getrusage\nC:\\gowork\\src\\github.com\\stackimpact\\stackimpact-go\\internal\\process_reporter.go\n:117: rusage.Maxrss undefined (type *syscall.Rusage has no field or method Maxrs\ns)\nC:\\Users\\leonardo&gt;\n</code></pre>\n"}, {"tags": ["go", "data-structures"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 1, "last_activity_date": 1483139656, "last_edit_date": 1483139656, "creation_date": 1483139021, "answer_id": 41403788, "question_id": 41403068, "link": "https://stackoverflow.com/questions/41403068/best-way-to-get-array-like-behavior-of-different-but-similar-types-in-go/41403788#41403788", "title": "Best way to get array-like behavior of different but similar types in Go?", "body": "<p>From the information given, it sounds like you should define an interface type that encapsulates what the various client types have in common. That would be the way to actually achieve what you talk about in #2. Remember that Go does not have the concept of classes and subclasses, so if you have a type <code>ClientX</code> and then embed that in other types (the closest thing Go has to subclassing), those other types cannot be used where a type <code>ClientX</code> is expected. The only way to have one type that can represent several different underlying types is by defining an interface.</p>\n\n<p>In addition to the common fields in the <code>ClientX</code> struct, I assume you will have to have some sort of client-specific handler function. That function would then do whatever client-specific operations are necessary. (It's hard to be more specific without knowing more details about what you're doing.)</p>\n\n<p>Here's a simple example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\ntype client interface {\n    getKey() string\n    getSecret() string\n    getHttpClient() *http.Client\n    handler()\n}\n\ntype clientX struct {\n    key    string\n    secret string\n    client *http.Client\n}\n\nfunc (c *clientX) getKey() string {\n    return c.key\n}\n\nfunc (c *clientX) getSecret() string {\n    return c.secret\n}\n\nfunc (c *clientX) getHttpClient() *http.Client {\n    return c.client\n}\n\ntype clientOne struct {\n    clientX\n    data1 string\n    data2 int\n    // ...\n}\n\nfunc (c *clientOne) handler() {\n    fmt.Printf(\"clientOne handler: data1: %q\\n\", c.data1)\n}\n\nfunc main() {\n    c1 := &amp;clientOne{\n        clientX: clientX{\n            key:    \"abc\",\n            secret: \"def\",\n        },\n        data1: \"some data\",\n    }\n\n    var clients []client\n\n    clients = append(clients, c1)\n\n    for _, c := range clients {\n        fmt.Printf(\"key %q secret %q\\n\", c.getKey(), c.getSecret())\n        c.handler()\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "edited": false, "score": 0, "creation_date": 1483479527, "post_id": 41403923, "comment_id": 70111963, "body": "Thank you for your response. There is common behavior among the methods the APIs were calling so I considered making a command interface. However, a problem arose that the response types (format returned by the APIs for the same command) would be different. This involved having to type assert the responses in a switch block and treating each case differently to do anything with the data (aka code bloat). As you hinted, I&#39;ve decided the command interface doesn&#39;t make sense for my particular case. I will have to bite the bullet and use arg []interface{} and switch block in the function."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "reply_to_user": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "edited": false, "score": 0, "creation_date": 1483483131, "post_id": 41403923, "comment_id": 70113395, "body": "Well, you don&#39;t have to abandon the command pattern. The &quot;execute&quot; function in your case could return an interface{}. And if you do have common functions between commands, by all means, add them to a new interface."}], "tags": [], "owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "is_accepted": true, "score": 1, "last_activity_date": 1483140540, "last_edit_date": 1483140540, "creation_date": 1483140151, "answer_id": 41403923, "question_id": 41403068, "link": "https://stackoverflow.com/questions/41403068/best-way-to-get-array-like-behavior-of-different-but-similar-types-in-go/41403923#41403923", "title": "Best way to get array-like behavior of different but similar types in Go?", "body": "<p>First of, there is no inheritance in golang. Also, I'd highly recommend reading about <a href=\"https://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">interfaces in golang</a>.</p>\n\n<p>As for this problem specifically, instead of storing <em>interface{}</em> instances, I'd introduce a <em>command</em> interface and implement it for each API with which the application would have to work. Something like this: <a href=\"https://play.golang.org/p/t5Kldpbu-P\" rel=\"nofollow noreferrer\">https://play.golang.org/p/t5Kldpbu-P</a>.</p>\n\n<p>Since you mentioned that there is no common behaviour amongst the client commands, I wouldn't introduce interfaces for their methods unless there are inter-dependencies amongst them. Interfaces in that case would make them easy to unit test (create a mock that implements the interface).</p>\n\n<p>This is simple and easy to extend.</p>\n"}], "owner": {"reputation": 165, "user_id": 4150729, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/1492722699/picture?type=large", "display_name": "Nik Kunkel", "link": "https://stackoverflow.com/users/4150729/nik-kunkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 41403923, "answer_count": 2, "score": 0, "last_activity_date": 1483140540, "creation_date": 1483134436, "question_id": 41403068, "link": "https://stackoverflow.com/questions/41403068/best-way-to-get-array-like-behavior-of-different-but-similar-types-in-go", "title": "Best way to get array-like behavior of different but similar types in Go?", "body": "<p>Scenario:\nI have a few different clients, each interacting with a different API. </p>\n\n<p>The data fields of these clients are the same:</p>\n\n<pre><code>type clientX struct {\n   key string\n   secret string\n   client *http.Client\n}\n</code></pre>\n\n<p>However these clients each have many methods (all different from each other):</p>\n\n<pre><code>func (c *ClientX) someMethod() (*ResponseType, error) {\n    //code\n}\n</code></pre>\n\n<p>The amount of clients may change over time, as support for new APIs is added, or some number of APIs go offline. Therefore, all functions in the main package need to be modular and adaptable to accept a variable number of clients as arguments.</p>\n\n<p>What is the best way to go about this problem?\nI can't put the clients in an array because they are different types. </p>\n\n<p>Ideas I'm toying around with:</p>\n\n<ol>\n<li><p>The first  solution that comes to mind is an array of type interface{}. However I'm concerned of the performance of an []interface{} as well as the code-bloat I'll have from identifying client types when iterating through the array (type-assertions).</p></li>\n<li><p>I'm not as educated on inheritance as I'd like to be, so I'm not sure if this works. I'm envisioning creating a parent class Client containing the key, secret, and client data fields. The specific clients will be subclasses inheriting from the parent class Client, and then defining all the methods specific to that client. From my basic understanding, I could then put all of these clients into an array by defining the array type as Client. This leaves me a bit confused on how the elements in the array would behave as the would not be of type ClientX but of the more general type Client. Would this lead to having to type assert all over again aka the same problem as in solution 1? If Im going to have to ID and assert the type anyway are there any performance benefits to having an array of type Client over an array of type interface?</p></li>\n<li><p>Have the clients (clientA, clientB, clientC) be global variables. Any function can access them so I won't have to pass them as arguments. In order to handle variable clients (the number is decided at runtime) I would have a clientsEnabled map[string]bool for functions to identify which clients to use and which to ignore. This seems like it would have minimal code-bloat. However, I'm wary of using globals, and was always taught to avoid unless absolutely necessary.</p></li>\n<li><p>Another solution that the SO community has</p></li>\n</ol>\n\n<p>Would love to have some feedback, thank you. </p>\n"}, {"tags": ["bash", "go", "pipe", "ctags"], "comments": [{"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483123483, "post_id": 41400960, "comment_id": 70004401, "body": "Don&#39;t you want to print the output of the <code>awk</code> command instead of the value of a pointer to a <code>Cmd</code> struct?"}, {"owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "reply_to_user": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483123790, "post_id": 41400960, "comment_id": 70004542, "body": "@e0k Yeah, I want to capture the Stdout of awk. Working on that now. You can ignore that fmt.Println() if it&#39;s confusing."}, {"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483124465, "post_id": 41400960, "comment_id": 70004822, "body": "You may find it useful to redirect <code>Stderr</code> streams to <code>os.Stderr</code> so that you can see error messages: <code>awk.Stderr = os.Stderr</code>, etc."}, {"owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "reply_to_user": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483124697, "post_id": 41400960, "comment_id": 70004921, "body": "@e0k Do you know how to grab os.Stdout and use it as a string?"}, {"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483125822, "post_id": 41400960, "comment_id": 70005404, "body": "You probably want to read not from <code>os.Stdout</code> but the last <a href=\"https://golang.org/pkg/os/exec/#Cmd.StdoutPipe\" rel=\"nofollow noreferrer\"><code>StdoutPipe()</code></a>, which gives you an <a href=\"https://golang.org/pkg/io/#ReadCloser\" rel=\"nofollow noreferrer\"><code>io.ReadCloser</code></a> (a <code>Reader</code> that is also a <code>Closer</code>). You could <a href=\"https://golang.org/pkg/bytes/#Buffer.ReadFrom\" rel=\"nofollow noreferrer\"><code>ReadFrom()</code></a> this and store it in a <code>bytes.Buffer</code>. Then (if you really needed it as such), convert it to a <code>string</code>. But this is inefficient: see <a href=\"http://stackoverflow.com/questions/9644139/from-io-reader-to-string-in-go\">From io.Reader to string in Go</a>."}, {"owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "reply_to_user": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483126543, "post_id": 41400960, "comment_id": 70005723, "body": "@e0k That didn&#39;t work :/ buf := new(bytes.Buffer)     buf.ReadFrom(awk.StdoutPipe())     fmt.Println(buf.String()) ./gitscrape.go:321: too many arguments in call to buf.ReadFrom"}, {"owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "reply_to_user": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1483126872, "post_id": 41400960, "comment_id": 70005865, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/131928/discussion-between-soubriquet-and-e0k\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "is_accepted": false, "score": 1, "last_activity_date": 1483123042, "creation_date": 1483123042, "answer_id": 41401046, "question_id": 41400960, "link": "https://stackoverflow.com/questions/41400960/golang-exec-command-multiple-pipes/41401046#41401046", "title": "Golang exec.Command multiple pipes", "body": "<p>The issue was with:</p>\n\n<pre><code>awk   := exec.Command(\"awk\", \"'{$1=$2=$3=$4=\\\"\\\"; print $0}'\")\n</code></pre>\n\n<p>I just needed to remove the single quotes.</p>\n\n<pre><code>awk   := exec.Command(\"awk\", \"{$1=$2=$3=$4=\\\"\\\"; print $0}\")\n</code></pre>\n"}], "owner": {"reputation": 1917, "user_id": 3158028, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea4a357ca24f6f6b54ee9bc5061aef40?s=128&d=identicon&r=PG&f=1", "display_name": "Soubriquet", "link": "https://stackoverflow.com/users/3158028/soubriquet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1906, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1483123042, "creation_date": 1483122621, "question_id": 41400960, "link": "https://stackoverflow.com/questions/41400960/golang-exec-command-multiple-pipes", "title": "Golang exec.Command multiple pipes", "body": "<p>I'm trying to do multiple pipes with Go: </p>\n\n<pre><code>ctags := exec.Command(\"ctags\", \"-x\", \"--c-types=f\", \"./tmp/\"+fileName)\ngrep  := exec.Command(\"grep\", \"member\")\nawk   := exec.Command(\"awk\", \"'{$1=$2=$3=$4=\\\"\\\"; print $0}'\")\ngrep.Stdin, _ = ctags.StdoutPipe()\nawk.Stdin, _ = grep.StdoutPipe()\nawk.Stdout = os.Stdout\n_ = grep.Start()\n_ = awk.Start()\n_ = ctags.Run()\n_ = grep.Wait()\n_ = awk.Wait()\n\nfmt.Println(awk)\n</code></pre>\n\n<p>This is what the expected output should look like:</p>\n\n<pre><code>$ ctags -x --c-types=f ./tmp/genetic_algorithm.py | grep member | awk '{$1=$2=$3=$4=\"\"; print $0}'\n    def __init__(self, vector, fitness_function):\n    def __init__(self, population_size=10, crossover_points=[.3, .6],\n    def apply_crossover(self, genotype_1, genotype_2):\n    def apply_mutation(self, child_genotype):\n    def calc_population_fitness(self, individuals):\n    def evolve(self):\n    def final_genotype(self):\n    def fitness(self):\n    def generate_offspring(self, selected):\n    def genotype(self, indiv):\n    def get_accuracy(nn_hidden_structure=[10]):\n    def parse_bitstring(self, genotype):\n    def run(self):\n    def select_for_crossover(self):\n    def slice_vector(self, vector):\n    def validate_vector(self, vector, max_nodes=100):\n    def vector_from_bitstring(self, genotype):\n</code></pre>\n\n<p>This is what I'm getting:</p>\n\n<pre><code>&amp;{/usr/bin/awk [awk '{$1=$2=$3=$4=\"\"; print $0}'] []  0xc4204ce020 0xc42007e008 &lt;nil&gt; [] &lt;nil&gt; 0xc4201fa900 exit status 2 &lt;nil&gt; &lt;nil&gt; true [0xc4204ce020 0xc42007e008 0xc4204ce048] [0xc4204ce048] [] [] 0xc420070360 &lt;nil&gt;}\n</code></pre>\n\n<p>I've found several examples of piping commands with Go, but most of them only pipe two commands. There's this example <a href=\"https://gist.github.com/dagoof/1477401\" rel=\"nofollow noreferrer\">https://gist.github.com/dagoof/1477401</a>, but  when I arranged my code according to that logic, I got the same issue. Am I piping correctly? The command is just supposed to execute exuberant ctags on that Python file and then grep any rows indicating method and then only ignore the first four columns of the grepped output.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1495, "user_id": 162909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8c2eece0f7bb15687638764b301ade70?s=128&d=identicon&r=PG", "display_name": "F0RR", "link": "https://stackoverflow.com/users/162909/f0rr"}, "edited": false, "score": 0, "creation_date": 1483121156, "post_id": 41400639, "comment_id": 70003360, "body": "And yeah, the file is about 1GB"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1483121314, "post_id": 41400639, "comment_id": 70003428, "body": "There is going to be overhead to <code>binary.Read</code>, as it uses <a href=\"https://godoc.org/reflect\" rel=\"nofollow noreferrer\">reflection</a>. I would suggest benchmarking both: (a) using <code>bufio.Reader</code> instead of reading directly from the file, and (b) using <code>binary.BigEndian.*</code> methods to read the fields directly instead of <code>binary.Read</code> on the entire struct."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1483121352, "post_id": 41400639, "comment_id": 70003446, "body": "Did your C program use a FILE* and e.g. calling fread() ? If so you should wrap the file in go in a bufio.Reader so you do buffered reads like the C program"}, {"owner": {"reputation": 1495, "user_id": 162909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8c2eece0f7bb15687638764b301ade70?s=128&d=identicon&r=PG", "display_name": "F0RR", "link": "https://stackoverflow.com/users/162909/f0rr"}, "edited": false, "score": 0, "creation_date": 1483121709, "post_id": 41400639, "comment_id": 70003596, "body": "I&#39;ve updated the question with profile data with <code>bufio.Reader</code>"}, {"owner": {"reputation": 1495, "user_id": 162909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8c2eece0f7bb15687638764b301ade70?s=128&d=identicon&r=PG", "display_name": "F0RR", "link": "https://stackoverflow.com/users/162909/f0rr"}, "edited": false, "score": 0, "creation_date": 1483121892, "post_id": 41400639, "comment_id": 70003691, "body": "The C program used FILE*, yes."}], "answers": [{"comments": [{"owner": {"reputation": 1495, "user_id": 162909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8c2eece0f7bb15687638764b301ade70?s=128&d=identicon&r=PG", "display_name": "F0RR", "link": "https://stackoverflow.com/users/162909/f0rr"}, "edited": false, "score": 2, "creation_date": 1483123489, "post_id": 41400974, "comment_id": 70004407, "body": "Yes, this is much faster (from 40s to 4s)! But mostly I just don&#39;t understand the output of profiler. Why is <code>Syscall</code> the slowest function??"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1495, "user_id": 162909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8c2eece0f7bb15687638764b301ade70?s=128&d=identicon&r=PG", "display_name": "F0RR", "link": "https://stackoverflow.com/users/162909/f0rr"}, "edited": false, "score": 0, "creation_date": 1483123832, "post_id": 41400974, "comment_id": 70004561, "body": "@F0RR: syscall wasn&#39;t the slowest function, it&#39;s the function that was in process the most often during profiling. You weren&#39;t using buffered io and were making too many small read calls on the file."}, {"owner": {"reputation": 1495, "user_id": 162909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8c2eece0f7bb15687638764b301ade70?s=128&d=identicon&r=PG", "display_name": "F0RR", "link": "https://stackoverflow.com/users/162909/f0rr"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483124010, "post_id": 41400974, "comment_id": 70004635, "body": "@JimB ok, got that. Thanks :)"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1483122694, "creation_date": 1483122694, "answer_id": 41400974, "question_id": 41400639, "link": "https://stackoverflow.com/questions/41400639/is-binary-read-slow/41400974#41400974", "title": "Is binary.Read slow?", "body": "<p><code>binary.Read</code> will be slower, due to the fact that it uses <a href=\"https://godoc.org/reflect\" rel=\"noreferrer\">reflection</a>. I would suggest bench-marking using <code>bufio.Reader</code> and manually invoking the <code>binary.BigEndian</code> methods to read your struct:</p>\n\n<pre><code>type netFlowRow struct {\n    Timestamp uint32   // 0\n    Srcip     [4]byte  // 4\n    Dstip     [4]byte  // 8\n    Proto     uint16   // 12\n    Srcport   uint16   // 14\n    Dstport   uint16   // 16\n    Pkt       uint32   // 18\n    Size      uint64   // 22\n}\n\nfunc main() {\n    // ...\n    file, _ := os.Open(path)\n    r := bufio.NewReader(file)\n    for j := 0; j &lt; infoRow.Count; j++ {\n        var buff [4 + 4 + 4 + 2 + 2 + 2 + 4 + 8]byte\n        if _, err := io.ReadFull(r, buff[:]); err != nil {\n            panic(err)\n        }\n        netRow := netFlowRow{\n            Timestamp: binary.BigEndian.Uint32(buff[:4]),\n            // Srcip\n            // Dstip\n            Proto: binary.BigEndian.Uint16(buff[12:14]),\n            Srcport: binary.BigEndian.Uint16(buff[14:16]),\n            Dstport: binary.BigEndian.Uint16(buff[16:18]),\n            Pkt: binary.BigEndian.Uint32(buff[18:22]),\n            Size: binary.BigEndian.Uint64(buff[22:30]),\n        }\n        copy(netRow.Srcip[:], buff[4:8])\n        copy(netRow.Dstip[:], buff[8:12])\n\n        // ...\n        fmt.Printf(\"%v\", netRow)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1495, "user_id": 162909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8c2eece0f7bb15687638764b301ade70?s=128&d=identicon&r=PG", "display_name": "F0RR", "link": "https://stackoverflow.com/users/162909/f0rr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 2, "accepted_answer_id": 41400974, "answer_count": 1, "score": 1, "last_activity_date": 1483122694, "creation_date": 1483121126, "last_edit_date": 1483121654, "question_id": 41400639, "link": "https://stackoverflow.com/questions/41400639/is-binary-read-slow", "title": "Is binary.Read slow?", "body": "<p>I'm rewriting an old small C project into Go (to learn Go).</p>\n\n<p>The project basically reads some binary data from a file, does some filtering on said data, then prints it into stdout.</p>\n\n<p>The main part of the code looks like this (omitting error handling):</p>\n\n<pre><code>type netFlowRow struct {\n    Timestamp uint32\n    Srcip     [4]byte\n    Dstip     [4]byte\n    Proto     uint16\n    Srcport   uint16\n    Dstport   uint16\n    Pkt       uint32\n    Size      uint64\n}\n\nfunc main() {\n    // ...\n    file, _ := os.Open(path)\n    for j := 0; j &lt; infoRow.Count; j++ {\n        netRow := netFlowRow{}\n        binary.Read(file, binary.BigEndian, &amp;netRow)\n\n        // ...\n        fmt.Printf(\"%v\", netRow)\n    }\n}\n</code></pre>\n\n<p>After doing a naive rewrite go version ran 10 times slower than the C version (~40s vs 2-3s). I did profiling with pprof and it showed me this:</p>\n\n<pre><code>(pprof) top10\n39.96s of 40.39s total (98.94%)\nDropped 71 nodes (cum &lt;= 0.20s)\nShowing top 10 nodes out of 11 (cum &gt;= 39.87s)\n      flat  flat%   sum%        cum   cum%\n    39.87s 98.71% 98.71%     39.87s 98.71%  syscall.Syscall\n     0.09s  0.22% 98.94%     40.03s 99.11%  encoding/binary.Read\n         0     0% 98.94%     39.87s 98.71%  io.ReadAtLeast\n         0     0% 98.94%     39.87s 98.71%  io.ReadFull\n         0     0% 98.94%     40.03s 99.11%  main.main\n         0     0% 98.94%     39.87s 98.71%  os.(*File).Read\n         0     0% 98.94%     39.87s 98.71%  os.(*File).read\n         0     0% 98.94%     40.21s 99.55%  runtime.goexit\n         0     0% 98.94%     40.03s 99.11%  runtime.main\n         0     0% 98.94%     39.87s 98.71%  syscall.Read\n</code></pre>\n\n<p>Am I reading this right? Is syscall.Syscall basically the main time consumer? Is it where the reading from file is going on?</p>\n\n<p>Upd.\nI used bufio.Reader and got this profile:</p>\n\n<pre><code>(pprof) top10\n34.16s of 36s total (94.89%)\nDropped 99 nodes (cum &lt;= 0.18s)\nShowing top 10 nodes out of 33 (cum &gt;= 0.56s)\n      flat  flat%   sum%        cum   cum%\n    31.99s 88.86% 88.86%        32s 88.89%  syscall.Syscall\n     0.43s  1.19% 90.06%      0.64s  1.78%  runtime.mallocgc\n     0.39s  1.08% 91.14%      1.06s  2.94%  encoding/binary.(*decoder).value\n     0.28s  0.78% 91.92%      0.99s  2.75%  reflect.(*structType).Field\n     0.28s  0.78% 92.69%      0.28s  0.78%  runtime.duffcopy\n     0.24s  0.67% 93.36%      1.64s  4.56%  encoding/binary.sizeof\n     0.22s  0.61% 93.97%     34.51s 95.86%  encoding/binary.Read\n     0.22s  0.61% 94.58%      0.22s  0.61%  runtime.mach_semaphore_signal\n     0.07s  0.19% 94.78%      1.28s  3.56%  reflect.(*rtype).Field\n     0.04s  0.11% 94.89%      0.56s  1.56%  runtime.newobject\n</code></pre>\n"}, {"tags": ["go", "autovivification"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483114382, "post_id": 41399222, "comment_id": 70000258, "body": "Go is statically typed, and compiled. You can&#39;t really have an &quot;undefined reference&quot;, and if there&#39;s a nil reference which shouldn&#39;t be, it&#39;s an error in your program."}, {"owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483114496, "post_id": 41399222, "comment_id": 70000307, "body": "This holds for C++, too, and there it is possible. Am I wrong?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1483115327, "post_id": 41399222, "comment_id": 70000689, "body": "I guess it depends on your definition. I wouldn&#39;t call what C++ can do &quot;autovivification&quot; as it&#39;s defined, it&#39;s just listed in comparison or emulation of the behavior. Go can also return a zero value from a map if the key doesn&#39;t exist, but the values still need to be defined."}, {"owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483115485, "post_id": 41399222, "comment_id": 70000763, "body": "Thanks, very good point. I just liked the way of Python via <code>class Tree(dict): def __missing__(self, key)...</code> and I thought there is some similar elegant solution like that. I extended my question."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1483116846, "last_edit_date": 1483116846, "creation_date": 1483116076, "answer_id": 41399603, "question_id": 41399222, "link": "https://stackoverflow.com/questions/41399222/is-there-autovivification-for-go/41399603#41399603", "title": "Is there autovivification for Go?", "body": "<p>Go maps will return a zero value for the type if the key doesn't exist, or the map is <code>nil</code></p>\n\n<p><a href=\"https://play.golang.org/p/sBEiXGfC1c\" rel=\"nofollow noreferrer\">https://play.golang.org/p/sBEiXGfC1c</a></p>\n\n<pre><code>var sliceMap map[string][]string\n\n// slice is a nil []string\nslice := sliceMap[\"does not exist\"]\n\n\nvar stringMap map[string]string\n\n// s is an empty string\ns := stringMap[\"does not exist\"]\n</code></pre>\n\n<p>Since a map with numeric values return will return <code>0</code> for missing entries, Go lets you use the increment and decrement operators on non-existent keys:</p>\n\n<pre><code>counters := map[string]int{}\ncounters[\"one\"]++\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1483130620, "creation_date": 1483130620, "answer_id": 41402468, "question_id": 41399222, "link": "https://stackoverflow.com/questions/41399222/is-there-autovivification-for-go/41402468#41402468", "title": "Is there autovivification for Go?", "body": "<p>Also extending JimB's answer, with the combination of <code>map</code>, <code>interface{}</code> and <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>, you can dynamically create any complex structures:</p>\n\n<pre><code>type Obj map[interface{}]interface{}\n\nfunc main() {\n    var o Obj\n\n    o = Obj{\n        \"Name\": \"Bob\",\n        \"Age\":  23,\n        3:      3.14,\n    }\n    fmt.Printf(\"%+v\\n\", o)\n\n    o[\"Address\"] = Obj{\"Country\": \"USA\", \"State\": \"Ohio\"}\n    fmt.Printf(\"%+v\\n\", o)\n\n    o[\"Address\"].(Obj)[\"City\"] = \"Columbus\"\n    fmt.Printf(\"%+v\\n\", o)\n\n    fmt.Printf(\"City = %v\\n\", o[\"Address\"].(Obj)[\"City\"])\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Q30UxRJ5H1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[Name:Bob Age:23 3:3.14]\nmap[Age:23 3:3.14 Address:map[Country:USA State:Ohio] Name:Bob]\nmap[3:3.14 Address:map[Country:USA State:Ohio City:Columbus] Name:Bob Age:23]\nCity = Columbus\n</code></pre>\n"}], "owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 41399603, "answer_count": 2, "score": 1, "last_activity_date": 1483130620, "creation_date": 1483114274, "last_edit_date": 1483115668, "question_id": 41399222, "link": "https://stackoverflow.com/questions/41399222/is-there-autovivification-for-go", "title": "Is there autovivification for Go?", "body": "<p>Is there <a href=\"https://en.wikipedia.org/wiki/Autovivification\" rel=\"nofollow noreferrer\">autovivification</a> for Go? </p>\n\n<p>As @JimB correctly noticed, my definition is not that strict. About my goal: In Python we have a very elegant <em>\"emulation\"</em> for an autovivification:</p>\n\n<pre><code>class Path(dict):\n    def __missing__(self, key):\n            value = self[key] = type(self)()\n            return value\n</code></pre>\n\n<p>Is there a similar solution for Go?</p>\n"}, {"tags": ["testing", "go", "memprof"], "answers": [{"tags": [], "owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "is_accepted": true, "score": 10, "last_activity_date": 1483107029, "last_edit_date": 1483107029, "creation_date": 1483103813, "answer_id": 41396907, "question_id": 41394227, "link": "https://stackoverflow.com/questions/41394227/cpuprofile-and-memprofile-in-golang-testing/41396907#41396907", "title": "cpuprofile and memprofile in golang testing", "body": "<p>Use the output profiles in coordination with the <code>go tool</code> e.g.:</p>\n\n<pre><code>go tool pprof testbin.test cpu.out\n</code></pre>\n\n<p>I'd recommend some <code>func Benchmark*(b *testing.B)</code> implementations for functionality you're interesting in profiling.</p>\n\n<p>Once in the tool try <code>top10</code>:</p>\n\n<pre><code>Welcome to pprof!  For help, type 'help'.\n(pprof) top10\n</code></pre>\n\n<p>More information: <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"noreferrer\">https://blog.golang.org/profiling-go-programs</a></p>\n"}], "owner": {"reputation": 513, "user_id": 5673789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ade403dabcac1cdd5cd25bbd600f7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jsmith", "link": "https://stackoverflow.com/users/5673789/jsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3917, "favorite_count": 1, "accepted_answer_id": 41396907, "answer_count": 1, "score": 4, "last_activity_date": 1483107029, "creation_date": 1483092005, "question_id": 41394227, "link": "https://stackoverflow.com/questions/41394227/cpuprofile-and-memprofile-in-golang-testing", "title": "cpuprofile and memprofile in golang testing", "body": "<p>I tried the command <strong>go test -cpuprofile cpu.out</strong> on a <strong>GO test file</strong> and it resulted in a file <strong>cpu.out</strong> which is full of many 64 bit numbers. It doesn't make any sense to me. What did the command do and what information can get I extract from cpu.out file?</p>\n\n<p>Similarly <strong>go test -memprofile mem.out</strong> generated a <strong>mem.out</strong> file which also seems to make no sense to me. Help me out.</p>\n\n<p>I have attached both the files.</p>\n\n<p><a href=\"https://drive.google.com/open?id=0B16F4aE0W_m6S3hZVVRGZEVPeXM\" rel=\"nofollow noreferrer\">cpu.out</a> and <a href=\"https://drive.google.com/open?id=0B16F4aE0W_m6UjhpdVdJWTJTNGM\" rel=\"nofollow noreferrer\">mem.out</a></p>\n"}, {"tags": ["serialization", "go", "deserialization"], "comments": [{"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 2, "creation_date": 1483090602, "post_id": 41393573, "comment_id": 69989539, "body": "You&#39;re using the wrong structure, <code>io.Reader</code> is just and interface and <code>bytes.Reader</code> doesn&#39;t have any exported attributes, for that reason <code>Body</code> is blank. You should change the type of <code>Body</code> to something helpful to you, like <code>string</code>, or you can use just <code>[]byte</code>"}, {"owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1483091207, "post_id": 41393573, "comment_id": 69989816, "body": "Thanks, I have defined Body field to to a stream which can read data from any stream, I can&#39;t change the field type."}, {"owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1483091550, "post_id": 41393573, "comment_id": 69989960, "body": "I didn&#39;t get why someone devoted my question."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483092415, "post_id": 41393573, "comment_id": 69990356, "body": "if <code>Headers</code> is a map  how is there a function &#39;SetKeyValue` on it ?"}, {"owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483092620, "post_id": 41393573, "comment_id": 69990447, "body": "I have defined a type type Headers map[HeaderKey][]string and Headers is of type Headers and then that method is of this type. Just to make my question small, I have put the short version of it. You can think that method is just a method to add Headers."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483095116, "post_id": 41393573, "comment_id": 69991669, "body": "@praveen.upadhyay check my answer this is the right way to do this in <code>golang</code>"}], "answers": [{"comments": [{"owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483091290, "post_id": 41393721, "comment_id": 69989861, "body": "Not helpful. I am not dealing with http response."}, {"owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "reply_to_user": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483091362, "post_id": 41393721, "comment_id": 69989883, "body": "You could use the package without http response, please read the link of the package I&#39;ve gived to you ..."}, {"owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483091412, "post_id": 41393721, "comment_id": 69989908, "body": "Thanks, but I have looked at it and not able to solve my problem."}, {"owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "reply_to_user": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483091568, "post_id": 41393721, "comment_id": 69989965, "body": "<a href=\"https://golang.org/pkg/encoding/json/#Encoder.Encode\" rel=\"nofollow noreferrer\">Encoding</a> <a href=\"https://golang.org/pkg/encoding/json/#Decoder.Decode\" rel=\"nofollow noreferrer\">Decoding</a>"}, {"owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483091610, "post_id": 41393721, "comment_id": 69989984, "body": "I did try this also but not helping. Problem is with the io.Reader type."}], "tags": [], "owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "is_accepted": false, "score": 0, "last_activity_date": 1483090248, "last_edit_date": 1483090248, "creation_date": 1483089876, "answer_id": 41393721, "question_id": 41393573, "link": "https://stackoverflow.com/questions/41393573/golang-struct-having-io-reader-unable-to-serialize/41393721#41393721", "title": "Golang struct having io.Reader unable to serialize", "body": "<p>I am using <code>\"encoding/json\"</code> package : <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/json/</a></p>\n\n<p>As I can use the http.ResponseWriter to send JSON Response. Here is two functions you could use to send JSON and read JSON from the body :</p>\n\n<pre><code>// GetJSONContent returns the JSON content of a request\nfunc GetJSONContent(v interface{}, r *http.Request) error {\n    defer r.Body.Close()\n    return json.NewDecoder(r.Body).Decode(v)\n}\n\n// JSONWithHTTPCode Json Output with an HTTP code\nfunc JSONWithHTTPCode(w http.ResponseWriter, d interface{}, code int) {\n    w.Header().Set(\"Content-Type\", \"application/json; charset=UTF-8\")\n    w.WriteHeader(code)\n    if d != nil {\n        err := json.NewEncoder(w).Encode(d)\n        if err != nil {\n            panic(err)\n        }\n    }\n}\n</code></pre>\n\n<p>And then in your handlers just use those func as follow :</p>\n\n<pre><code>// Handler handler\nfunc Handler(w http.ResponseWriter, r *http.Request) {\n        s := YourStruct{}\n        err = GetJSONContent(s, r) \n        if err != nil {\n            panic(err)\n        }\n        return\n    }\n\n    JSONWithHTTPCode(w, s, http.StatusOK)\n}\n</code></pre>\n\n<p>Hope it helped</p>\n"}, {"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483095062, "post_id": 41394955, "comment_id": 69991635, "body": "You may have to implement <code>UnmarshalJSON</code> for the same type for unmarshalling the json to the reader"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483096188, "post_id": 41394955, "comment_id": 69992208, "body": "Added UnmarshalJSON also. You may use it directly in your code now"}, {"owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483338733, "post_id": 41394955, "comment_id": 70050065, "body": "Thanks for the answer. I am only worried about this solution is that, the Response object will tightly be coupled with JSON serialization. What I want to do is to have the Response object generic and based on the Content-Type header, serialization and deserialization can be used, so that it can be flexible enough to even deal with XML serialization. Can&#39;t we use the Response struct as it is in my question ?"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483339282, "post_id": 41394955, "comment_id": 70050200, "body": "All you need to make that work is you need to implement <code>UnmarshalXML</code> and <code>MarshalXML</code> functions aswell to the struct you created and probaly name it properly to be explicit  :D . This is the best you can do"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483339534, "post_id": 41394955, "comment_id": 70050269, "body": "@praveen.upadhyay you may not use the response struct as you have it in your question as     <code>Body    io.Reader</code> does not implement Marshaller or Unmarshaller and the golang json decoder defaults to encode the <code>exported fields</code> inside the object <code>*bytes.Reader</code> . <code>*bytes.Reader</code> does not have any exported fileds  <a href=\"https://golang.org/pkg/bytes/#Reader\" rel=\"nofollow noreferrer\">golang.org/pkg/bytes/#Reader</a>"}, {"owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483340252, "post_id": 41394955, "comment_id": 70050472, "body": "Yas I get that. Thanks. I will accept your solution as answer after few hours (as I need to rethink some other way around)."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "edited": false, "score": 0, "creation_date": 1483531480, "post_id": 41394955, "comment_id": 70132189, "body": "@praveen.upadhyay that is fine. I believe this should be the most <code>go</code>ish way of doing it"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 6, "last_activity_date": 1483102757, "last_edit_date": 1483102757, "creation_date": 1483094911, "answer_id": 41394955, "question_id": 41393573, "link": "https://stackoverflow.com/questions/41393573/golang-struct-having-io-reader-unable-to-serialize/41394955#41394955", "title": "Golang struct having io.Reader unable to serialize", "body": "<p><strong>Short Answer :</strong> JSON marshaller will not use <code>Read()</code> function to read the  string from io.Reader . Instead of using <code>io.Reader</code> you may use a type that implements <code>Marshaler</code> interface. </p>\n\n<p><strong>How Marshaller works :</strong> \nMarshal traverses the value v recursively. If an encountered value implements the <code>Marshaler</code> interface and is not a nil pointer, Marshal calls its <code>MarshalJSON</code> method to produce JSON. If no MarshalJSON method is present but the value implements <code>encoding.TextMarshaler</code> instead, Marshal calls its <code>MarshalText</code> method. The nil pointer exception is not strictly necessary but mimics a similar, necessary exception in the behavior of UnmarshalJSON.</p>\n\n<p>Otherwise, Marshal uses the following <code>type-dependent</code> default encodings:</p>\n\n<ul>\n<li>Boolean values encode as JSON booleans. </li>\n<li>Floating point, integer, and Number values encode as JSON numbers.</li>\n</ul>\n\n<p><strong>Implementaton</strong>\nThis is what you may do </p>\n\n<pre><code>type Response struct {\n    Headers map[string][]string\n    Body    *JSONReader\n    Status  int\n}\n\ntype JSONReader struct {\n    *bytes.Reader\n}\n\nfunc NewJSONReader(outBytes []byte) *JSONReader {\n    jr := new(JSONReader)\n    jr.Reader = bytes.NewReader(outBytes)\n    return jr\n}\n\nfunc (js JSONReader) MarshalJSON() ([]byte, error) {\n    data, err := ioutil.ReadAll(js.Reader)\n    if err != nil {\n        return nil, err\n    }\n    data = []byte(`\"` + string(data) + `\"`)\n    return data, nil\n}\n\n// UnmarshalJSON sets *jr to a copy of data.\nfunc (jr *JSONReader) UnmarshalJSON(data []byte) error {\n    if jr == nil {\n        return errors.New(\"json.JSONReader: UnmarshalJSON on nil pointer\")\n    }\n    if data == nil {\n        return nil\n    }\n    data = []byte(strings.Trim(string(data), \"\\\"\"))\n    jr.Reader = bytes.NewReader(data)\n    return nil\n}\n</code></pre>\n\n<p>Here is a go playground link with the implementation and sample use : <a href=\"https://play.golang.org/p/O8OexgunfX\" rel=\"noreferrer\">link</a></p>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 1, "last_activity_date": 1483179094, "last_edit_date": 1592644375, "creation_date": 1483102710, "answer_id": 41396662, "question_id": 41393573, "link": "https://stackoverflow.com/questions/41393573/golang-struct-having-io-reader-unable-to-serialize/41396662#41396662", "title": "Golang struct having io.Reader unable to serialize", "body": "<h3>Overview</h3>\n<p><a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> is an interface so it can't be marshaled. Each marshaling struct attribute must implement <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\"><code>Marshaler</code></a> interface to be marshaled. You could declare your own marshaler wrapper struct to marshal data from <code>bytes.Reader</code>.</p>\n<h3>Why interface can't be marshaled?</h3>\n<p>Interfaces in Go provide a way to specify the behavior of an object: if something can do this, then it can be used here. In opposite Go\u2019s structs are typed collections of fields. They\u2019re useful for grouping data together to form records. Go supports methods defined on struct types not interface types.</p>\n<h3>Implementation</h3>\n<pre><code>type Response struct {\n    Body *MarshalableReader\n}\n\ntype MarshalableReader struct {\n    *bytes.Reader\n}\n\nfunc (r MarshalableReader) MarshalJSON() ([]byte, error) {\n    data, err := ioutil.ReadAll(r.Reader)\n    if err != nil {\n        return nil, err\n    }\n    return []byte(fmt.Sprintf(&quot;\\&quot;%s\\&quot;&quot;, data)), nil\n}\n\nfunc main() {\n    resp := Response{&amp;MarshalableReader{bytes.NewReader([]byte(&quot;Blah Blah&quot;))}}\n\n    marshaled, err := json.Marshal(resp)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(&quot;JSON: %s\\n&quot;, marshaled)\n}                                                                                               \n</code></pre>\n"}], "owner": {"reputation": 223, "user_id": 2993096, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RG22u.jpg?s=128&g=1", "display_name": "praveen.upadhyay", "link": "https://stackoverflow.com/users/2993096/praveen-upadhyay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7379, "favorite_count": 0, "accepted_answer_id": 41394955, "answer_count": 3, "score": 1, "last_activity_date": 1572516833, "creation_date": 1483089224, "last_edit_date": 1572516833, "question_id": 41393573, "link": "https://stackoverflow.com/questions/41393573/golang-struct-having-io-reader-unable-to-serialize", "title": "Golang struct having io.Reader unable to serialize", "body": "<p>I am trying to serialize below struct into <code>byte[]</code> to store it into DB and then while reading it from DB I am deserializing it.</p>\n\n<pre><code>type Response struct {\n    Headers map[string][]string\n    Body    io.Reader\n    Status  int\n}\n</code></pre>\n\n<p>Below is the code how I am creating response object and setting up the value for it.</p>\n\n<pre><code>resp := new(Response)\nresp.Body = bytes.NewReader(outBytes) //outBytes is byte[]\nresp.Headers.SetKeyValue(\"Content-Type\", \"text/json\") //SetKeyValue is the method created for adding headers\nresp.Headers.SetKeyValue(\"Url-Type\", \"broker\")\nresp.Status = 200\n</code></pre>\n\n<p>I am using <code>json.Marshal()</code> to serialize the <code>resp</code> object as below.</p>\n\n<pre><code>b, _ := json.Marshal(resp)\n</code></pre>\n\n<p>Below is the code, I am using to deserialize.</p>\n\n<pre><code>var r Response\nr.Body = &amp;bytes.Buffer{}\njson.Unmarshal(b,&amp;r)\n</code></pre>\n\n<p>Problem is with deserialization, I am not able to get the <code>resp.Body</code> object. It is always <code>nil</code> or blank in spite of setting body object (see above). I am able to get <code>Headers</code> and <code>Status</code> field of the struct back from deserialize but not <code>Body</code>.</p>\n\n<p>I know there is something to be handle with <code>Body</code> field which is an <code>io.Reader</code>. </p>\n\n<p>Any help would be really great.</p>\n"}, {"tags": ["go", "influxdb"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483096385, "post_id": 41393446, "comment_id": 69992280, "body": "can you put complete output here a small sample would be fine but need to be complete"}, {"owner": {"reputation": 53, "user_id": 7357162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d87cd8865ce54bfceae71172829f4f8e?s=128&d=identicon&r=PG&f=1", "display_name": "myNickname", "link": "https://stackoverflow.com/users/7357162/mynickname"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483098898, "post_id": 41393446, "comment_id": 69993345, "body": "sample output:<code>[{[{events map[] [time distinct] [[1970-01-01T00:00:00Z 192.168.123.100] [1970-01-01T00:00:00Z 192.168.123.233] [1970-01-01T00:00:00Z 192.168.123.24] [1970-01-01T00:00:00Z 192.168.123.222] [1970-01-01T00:00:00Z 192.168.123.112]]}] [] }]</code>"}, {"owner": {"reputation": 984, "user_id": 1244420, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ca029fbc9431b4df66c61c4c7447b3d5?s=128&d=identicon&r=PG", "display_name": "Addison", "link": "https://stackoverflow.com/users/1244420/addison"}, "edited": false, "score": 0, "creation_date": 1483106824, "post_id": 41393446, "comment_id": 69996849, "body": "What&#39;s the structure of <code>resp</code>?"}, {"owner": {"reputation": 53, "user_id": 7357162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d87cd8865ce54bfceae71172829f4f8e?s=128&d=identicon&r=PG&f=1", "display_name": "myNickname", "link": "https://stackoverflow.com/users/7357162/mynickname"}, "edited": false, "score": 0, "creation_date": 1483109454, "post_id": 41393446, "comment_id": 69998074, "body": "function queryDB returns &#180;res []client.Result"}, {"owner": {"reputation": 53, "user_id": 7357162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d87cd8865ce54bfceae71172829f4f8e?s=128&d=identicon&r=PG&f=1", "display_name": "myNickname", "link": "https://stackoverflow.com/users/7357162/mynickname"}, "edited": false, "score": 0, "creation_date": 1483109732, "post_id": 41393446, "comment_id": 69998208, "body": "I think its this: &#180;type Response struct {     Results []Result     Err     error }&#180; <a href=\"https://gowalker.org/github.com/influxdata/influxdb/client#Response\" rel=\"nofollow noreferrer\">gowalker.org/github.com/influxdata/influxdb/client#Response</a> wich has &#180;type Result struct {     Series   []models.Row     Messages []*Message     Err      error }&#180; <a href=\"https://gowalker.org/github.com/influxdata/influxdb/client#Result\" rel=\"nofollow noreferrer\">gowalker.org/github.com/influxdata/influxdb/client#Result</a>"}, {"owner": {"reputation": 4044, "user_id": 2322488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924e749f5c463f19625e51dad78a6b78?s=128&d=identicon&r=PG", "display_name": "Michael Desa", "link": "https://stackoverflow.com/users/2322488/michael-desa"}, "edited": false, "score": 0, "creation_date": 1483640220, "post_id": 41393446, "comment_id": 70189724, "body": "@myNickname I&#39;d recommend against using the InfluxDB client in the repo. There is currently an <a href=\"https://github.com/influxdata/influxdb-client\" rel=\"nofollow noreferrer\">experimental client</a> that is much better."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 7357162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d87cd8865ce54bfceae71172829f4f8e?s=128&d=identicon&r=PG&f=1", "display_name": "myNickname", "link": "https://stackoverflow.com/users/7357162/mynickname"}, "is_accepted": true, "score": 2, "last_activity_date": 1484248244, "creation_date": 1484248244, "answer_id": 41621067, "question_id": 41393446, "link": "https://stackoverflow.com/questions/41393446/golang-influxdb-client-response-to-array-or-slice/41621067#41621067", "title": "golang influxdb client response to array or slice", "body": "<p>Ok, I got it:</p>\n\n<pre><code>var myData [][]interface{} = make([][]interface{}, len(resp[0].Series[0].Values))\n            for i, d := range resp[0].Series[0].Values {\n                myData[i] = d\n            }\n\nfmt.Println(\"\", myData[0]) //first element in slice\nfmt.Println(\"\", myData[0][0])\nfmt.Println(\"\", myData[0][1])\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[2016-10-24T00:12:12.123456Z 192.168.123.107]\n2016-10-24T00:12:12.123456Z\n192.168.123.107\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7357162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d87cd8865ce54bfceae71172829f4f8e?s=128&d=identicon&r=PG&f=1", "display_name": "myNickname", "link": "https://stackoverflow.com/users/7357162/mynickname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 41621067, "answer_count": 1, "score": 0, "last_activity_date": 1484248244, "creation_date": 1483088580, "last_edit_date": 1483092378, "question_id": 41393446, "link": "https://stackoverflow.com/questions/41393446/golang-influxdb-client-response-to-array-or-slice", "title": "golang influxdb client response to array or slice", "body": "<p>I have a go program to query an Influxdb via Influxdb client.</p>\n\n<p>Function queryDB:\n<a href=\"https://github.com/influxdata/influxdb/tree/master/client#querying-data\" rel=\"nofollow noreferrer\">https://github.com/influxdata/influxdb/tree/master/client#querying-data</a>\nis called via </p>\n\n<pre><code>resp, err := queryDB(c, \"SELECT ip FROM events WHERE time &gt;= '2016-10-24T00:00:00Z' AND time &lt; '2016-10-24T01:00:00Z' ORDER BY time DESC\")\n</code></pre>\n\n<p>when I do</p>\n\n<pre><code>fmt.Printf(\"%s\", resp)\n</code></pre>\n\n<p>I get something like</p>\n\n<pre><code>[{[{events map[] [time ip] [[2016-10-24T00:12:12.123456Z 192.168.123.107] /*...and so on...*/ [2016-10-24T00:24:24.123456Z 192.168.123.103]]}] [] }]\n</code></pre>\n\n<p>How can I get a simple array or slice consisting of time and IP address?</p>\n"}, {"tags": ["caching", "go", "redis"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "edited": false, "score": 0, "creation_date": 1483093199, "post_id": 41394328, "comment_id": 69990723, "body": "i have imported gopkg.in/go-redis/cache.v3 to use redis in my code"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "edited": false, "score": 0, "creation_date": 1483093949, "post_id": 41394328, "comment_id": 69991114, "body": "Ok, describe in your questions what the tools you are using and set an appropriate tags."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "edited": false, "score": 0, "creation_date": 1483095196, "post_id": 41394328, "comment_id": 69991722, "body": "Yes I can and I&#39;ll improve it one more time. Don&#39;t wrap Go code to this html/js wrapper."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "edited": false, "score": 0, "creation_date": 1483343645, "post_id": 41394328, "comment_id": 70051594, "body": "@vkc, Go doesn&#39;t use threads directly, see my answer about goroutines <a href=\"http://stackoverflow.com/a/41047899/629685\">stackoverflow.com/a/41047899/629685</a>. Yes,  this implementation is thread safe."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "edited": false, "score": 0, "creation_date": 1483351715, "post_id": 41394328, "comment_id": 70054911, "body": "@vkc, if the answer works for you, please accept it."}, {"owner": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "edited": false, "score": 0, "creation_date": 1483421760, "post_id": 41394328, "comment_id": 70080021, "body": "its like partially working for me because i have to access particular variable/VALUE inside VAR_STRUCT using codec get"}, {"owner": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "edited": false, "score": 0, "creation_date": 1483425112, "post_id": 41394328, "comment_id": 70081363, "body": "@l159 Yeah might be...check out example i have mentioned in question"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "edited": false, "score": 0, "creation_date": 1483425399, "post_id": 41394328, "comment_id": 70081498, "body": "So substitute it! If you expect that somebody will write code which you could just copy and paste, believe me it doesn&#39;t work like that."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": true, "score": 1, "last_activity_date": 1483284603, "last_edit_date": 1483284603, "creation_date": 1483092486, "answer_id": 41394328, "question_id": 41392558, "link": "https://stackoverflow.com/questions/41392558/get-redis-variable-in-different-package-in-golang/41394328#41394328", "title": "Get Redis variable in different package in Golang", "body": "<p>Yes, you can access the same map by using a common <code>Codec</code> instance for both packages and both of set and get operations. For this purposes you need to implement a singleton instance producer. Desirably it should be a thread safe implementation. In this way you will save a lot of resource and guarantee connection correctness. This is significant to keep a client the only to prevent bugs and save resource.</p>\n\n<blockquote>\n  <p>Client is a Redis client representing a pool of zero or more underlying connections. It's safe for concurrent use by multiple goroutines.</p>\n</blockquote>\n\n<h3>Singleton codec</h3>\n\n<pre><code>package singleton\n\nimport (                       \n    \"sync\"                     \n    \"gopkg.in/go-redis/cache.v5\"\n    \"gopkg.in/redis.v5\"\n)                                                            \n\nvar codec *cache.Codec        \nvar once sync.Once             \n\nfunc GetInstance() *cache.Codec {\n    once.Do(func() {           \n        client := redis.NewClient(&amp;redis.Options{\n            Addr:     \"localhost:6379\",\n            Password: \"\", // no password set\n            DB:       0,  // use default DB\n        })\n\n        codec = &amp;cache.Codec{\n            Redis: client,\n\n            Marshal: func(v interface{}) ([]byte, error) {\n                return msgpack.Marshal(v)\n            },\n            Unmarshal: func(b []byte, v interface{}) error {\n                return msgpack.Unmarshal(b, v)\n            },\n        }\n    })                         \n    return codec            \n}        \n</code></pre>\n\n<h3>Set key using codec instance</h3>\n\n<pre><code>package setter                           \n\nimport (                                         \n    \"github.com/Me/myapp/singleton\"  \n    \"sync\"                              \n)                                       \n\nfunc Set(keys []string, vals []SomeObj, wg *sync.WaitGroup){\n    for i, k := range keys {            \n        wg.Add(1)\n        // singleton is thread safe and could be used with goroutines                       \n        go func() {                     \n            codec := single.GetInstance()\n\n            codec.Set(&amp;cache.Item{\n                Key:        k,\n                Object:     vals[i],\n                Expiration: time.Hour,\n            })\n            wg.Done()                   \n        }()                             \n    }                                   \n}                                       \n</code></pre>\n\n<h3>Get object using the same codec instance</h3>\n\n<pre><code>package getter                           \n\nimport (                                         \n    \"github.com/Me/myapp/singleton\"  \n    \"sync\"                              \n)                                       \n\nfunc Set(keys []string, wg *sync.WaitGroup) chan SomeObj {\n    wanted_objs := make(chan *SomeObj)\n    for i, k := range keys {            \n        wg.Add(1)\n        // singleton is thread safe and could be used with goroutines                       \n        go func() {                     \n            codec := singleton.GetInstance()\n            wanted := new(SomeObj)\n            if err := codec.Get(key, wanted); err == nil {\n                wanted_objs &lt;- wanted\n            }\n        }()\n    }\n    return wanted_objs\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4998935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Tj9knt3xf40/AAAAAAAAAAI/AAAAAAAAABM/zeDQzsthYr8/photo.jpg?sz=128", "display_name": "vkc", "link": "https://stackoverflow.com/users/4998935/vkc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 1, "accepted_answer_id": 41394328, "answer_count": 1, "score": 1, "last_activity_date": 1483284603, "creation_date": 1483083758, "last_edit_date": 1483095970, "question_id": 41392558, "link": "https://stackoverflow.com/questions/41392558/get-redis-variable-in-different-package-in-golang", "title": "Get Redis variable in different package in Golang", "body": "<p>I'm using <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">go-redis/redis</a> and <a href=\"https://github.com/go-redis/cache\" rel=\"nofollow noreferrer\">go-redis/cache</a> to cache Go objects.</p>\n\n<pre><code>import (\n    \"communication/MQ_pkg\"\n\n    \"gopkg.in/go-redis/cache.v3\"\n    \"gopkg.in/vmihailenco/msgpack.v2\"\n)\n\nobj := &amp;VAR_STRUCT{}        \n\nCodec.Set(&amp;cache.Item{\n            Key:    key,\n            Object: obj,\n        })\n</code></pre>\n\n<p>where obj is an structure having go maps(key value pair)\nBy Using above code i am setting a key and saving values into it. This is in package common.\nNow i want to access this in different package say GetRedis_pkg without importing pkg. Is there are any way i can do that.\nAnd can i access particular map inside that that structure by any means using redis key\nimorted gopkg.in/go-redis/cache.v3 to use redis in my code</p>\n"}, {"tags": ["batch-file", "go", "environment-variables", "windows-scripting"], "comments": [{"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1483089785, "post_id": 41391723, "comment_id": 69989197, "body": "See the <a href=\"http://ss64.com/nt/setx.html\" rel=\"nofollow noreferrer\"><code>setx</code> command</a> for permanently setting environment variables in user or system context (this is the third possible way, @kostix)..."}, {"owner": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "reply_to_user": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1483090332, "post_id": 41391723, "comment_id": 69989432, "body": "yes it&#39;ll be updated permanently but won&#39;t be available till restart the server. @as"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1483090923, "post_id": 41391723, "comment_id": 69989683, "body": "@aschipfl, thanks! I wasn&#39;t aware of this command. The problem is that I don&#39;t know of any easy solution of replacing the environment block of the current process with the updated one. Well, except for resorting to directly calling out into Win32 API. And another obvious problem is that supposedly communicating a single key+value combo between two processes executed in a sequence <i>this way</i> is a gross overengeneering IMO:"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1483091018, "post_id": 41391723, "comment_id": 69989722, "body": "@aschipfl since on Windows users&#39; and system environment blocks are stored in the registry, the OP&#39;s server could just directly use a dedicated registry entry in HKCU for this purpose. I think this would still be an overengeneering but on on a lesser scale at least :-)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1483091129, "post_id": 41391723, "comment_id": 69989773, "body": "@shagul, by the way, are you <i>already</i> using the <code>setx</code> command in the first batch script? (That would explain that &quot;when i restart server that will show the path otherwise it&#39;ll show nothing&quot; passage to me--which I failed to comprehend initially)."}, {"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1483094287, "post_id": 41391723, "comment_id": 69991277, "body": "@kostix, I agree, using <code>setx</code> and the registry for passing a value from one process to another is kind of over-engineering, I would rather go for a temporary file probably, or for the first option in your answer, if possible..."}, {"owner": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "edited": false, "score": 0, "creation_date": 1483332731, "post_id": 41391723, "comment_id": 70048329, "body": "func one(){     cmd := exec.Command(&quot;cmd&quot;, &quot;/C&quot;, &quot;bat1.bat&quot;)     cmd.Start()     timer := time.AfterFunc(1*time.Second, func() {         err := cmd.Process.Kill()         if err != nil {             panic(err)          }     })     err := cmd.Wait()     timer.Stop()      // read error from here, you will notice the kill from the      fmt.Println(err)     }        ..same thing i did for second script in func two()"}, {"owner": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "edited": false, "score": 0, "creation_date": 1483333039, "post_id": 41391723, "comment_id": 70048413, "body": "The batch file contains just a line &quot;setx /M My_PATH &quot;C:/path&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "edited": false, "score": 0, "creation_date": 1483092858, "post_id": 41393262, "comment_id": 69990562, "body": "thank you so much for your help but script files will be in client side so i can&#39;t add a line [echo VARNAME=value] .so is there any other possible way to do this??"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "edited": false, "score": 0, "creation_date": 1483098678, "post_id": 41393262, "comment_id": 69993224, "body": "@shagul, supposedly yes--consult the update to my answer."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1483098652, "last_edit_date": 1483098652, "creation_date": 1483087702, "answer_id": 41393262, "question_id": 41391723, "link": "https://stackoverflow.com/questions/41391723/use-environment-variable-set-by-a-batch-script-in-the-next-batch-script-run/41393262#41393262", "title": "Use environment variable set by a batch script in the next batch script run", "body": "<p>I don't fully grasp your problem, but here's a couple of observations.</p>\n\n<h3>Some theory</h3>\n\n<ul>\n<li><p>Environment vaiables set in a batch file (which is being executed by a shell process, <code>cmd.exe</code>)&mdash;or any other kind of process&mdash;can only be set for <em>that very</em> process.</p>\n\n<p>That is, each process has a special block with environment variables made available to it by the OS when that process is created.</p>\n\n<p>This also means that when the process which set an environment variable is finished, it's environment block is gone.</p></li>\n<li><p>An environment variable can be inherited by a process which was started by the process which has set that environment variable.</p></li>\n</ul>\n\n<h3>What happens in your case</h3>\n\n<p>What this means is that if you run two batch scripts in a sequence, this means</p>\n\n<ol>\n<li><p>The first <code>cmd.exe</code> process is strated, the batch script it executed\nset an environment variable; then the process is gone, and its environment block is gone, too.</p></li>\n<li><p>Then another <code>cmd.exe</code> is started, it inherits the environment block of your host process (written Go), but as you can see, whatever is set by a first batch script is not available.</p></li>\n</ol>\n\n<h3>What you can do about it</h3>\n\n<p>There are two possible ways to solve the problem:</p>\n\n<ul>\n<li><p>Make the first batch script call the second one by itself.</p>\n\n<p>In this case the second <code>cmd.exe</code> will inherit the environment variables\nset by the first script and will hence \"see\" them.</p>\n\n<p>Note that the Windows batch command language supports the <code>calls</code>\ncommand to call out to other batch scripts by their pathnames.</p></li>\n<li><p>Make the first script communicate the value of that variable to your host process and then arrange in the host process for the second <code>cmd.exe</code> to have the indicated variable with the indicated value in its environment.</p>\n\n<p>Say, the first script could just do something like</p>\n\n<pre><code> echo VARNAME=value\n</code></pre>\n\n<p>to have</p>\n\n<pre><code>VARNAME=value\n</code></pre>\n\n<p>printed to its stdout.</p>\n\n<p>Your Go process could parse that output, tear it apart on the <code>=</code>\ncharacter, sanitize to not affect \"interesting\" variables like <code>PATH</code>,\n<code>USERPROFILE</code> etc, and then the host process could do</p>\n\n<pre><code>env := os.Environ()\nenv = env.append(\"VARNAME=value\") // real value here\n...\ncmd := exec.Command(`cmd.exe`, `/c`, secondScriptFilePath)\ncmd.Env = env\n...\ncmd.Run() // or whatever\n</code></pre></li>\n</ul>\n\n<p>The second case can be done a bit differently: the host process\ncan call <code>os.Setenv(\"VARNAME=value\")</code> to make this variable appear in its\nown environment block; it then will be inherited automatically by whatever processes it starts after that.</p>\n\n<hr>\n\n<p>Update to address the OP's comment</p>\n\n<blockquote>\n  <p>&hellip;script files will be in client side so i can't add a line\n  <code>echo VARNAME=value</code> .\n  so is there any other possible way to do this?</p>\n</blockquote>\n\n<p>There's another approach which might work in your case.</p>\n\n<p>The idea is that <code>cmd.exe</code> is just a shell: when it's started non-interactively (that's what is done by <code>exec.Command(\"cmd.exe\")</code>)\nit reads commands from its standard input stream and executes them one by one&mdash;until the stream is closed (by the sender).</p>\n\n<p>Hence you can do the following:</p>\n\n<ol>\n<li><p>Start <code>cmd.exe</code> while connecting an instance of <code>io.Pipe</code> to its <code>Stdin</code>.</p></li>\n<li><p>Open the first script <em>yourself</em> and shovel it at the running <code>cmd.exe</code> via the pipe set up on the first step.</p>\n\n<p>Don't forget to <code>Flush()</code> the pipe.</p>\n\n<p>You can use the <code>io.Copy()</code> function which sends all the data from an opened <code>io.Reader</code> to some <code>io.Writer</code>.</p></li>\n<li><p>Leave the shell instance running.</p></li>\n<li><p>When it's time, read the second script and shovel it at the same shell.</p></li>\n</ol>\n\n<p>Since the shell is the same, the second script would run as if it were physically appended to the first one, and will see all the variables set by the first script.</p>\n"}], "owner": {"reputation": 399, "user_id": 6926514, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0c42d56e0e17ee20ffaa03a0c89c0d17?s=128&d=identicon&r=PG&f=1", "display_name": "shagul", "link": "https://stackoverflow.com/users/6926514/shagul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2826, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1483098652, "creation_date": 1483079642, "last_edit_date": 1483087951, "question_id": 41391723, "link": "https://stackoverflow.com/questions/41391723/use-environment-variable-set-by-a-batch-script-in-the-next-batch-script-run", "title": "Use environment variable set by a batch script in the next batch script run", "body": "<p>Actually i want to run 2 bat scripts , first script will set a system variable <code>set NEWPATH=\"E:/Some\"</code> and second script will show the path of that variable: <code>echo %NEWPATH%</code>. this is not working with the same server at first time , when i restart server that will show the path otherwise it'll show nothing. so can anyone help me on that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483079517, "post_id": 41391621, "comment_id": 69985347, "body": "looks like very special case, mostly due to bufferig abd getting flushed at the end of process. here is a link <a href=\"https://play.golang.org/p/xWFTHKaKzR\" rel=\"nofollow noreferrer\">play.golang.org/p/xWFTHKaKzR</a>"}, {"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483079769, "post_id": 41391621, "comment_id": 69985453, "body": "Can&#39;t open your link, it&#39;s Forbidden."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483080262, "post_id": 41391621, "comment_id": 69985664, "body": "i have shared the same link in an anwer i posted below. Check and accept  if that solves your problem"}], "answers": [{"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1483082196, "post_id": 41391836, "comment_id": 69986397, "body": "@blackmamba please accept the answer if it helped you"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 3, "last_activity_date": 1483080160, "creation_date": 1483080160, "answer_id": 41391836, "question_id": 41391621, "link": "https://stackoverflow.com/questions/41391621/why-the-output-order-is-changed-when-using-log-println-and-fmt-println/41391836#41391836", "title": "why the output order is changed when using `log.Println` and `fmt.Println`?", "body": "<p>Only difference between those in terms of its printing behaviour  is </p>\n\n<ul>\n<li><code>log.Println</code> writes to <code>Stderr</code></li>\n<li><code>fmt.Println</code> writes to <code>Stdout</code></li>\n</ul>\n\n<p>Both are not buffered. So the fact that <code>StdOut</code> came before <code>StdError</code> is specific to  your terminal or environment.</p>\n\n<p>Here is a play link <a href=\"https://play.golang.org/p/0cukg_a9GR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0cukg_a9GR</a></p>\n"}], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 41391836, "answer_count": 1, "score": -2, "last_activity_date": 1483080160, "creation_date": 1483079117, "question_id": 41391621, "link": "https://stackoverflow.com/questions/41391621/why-the-output-order-is-changed-when-using-log-println-and-fmt-println", "title": "why the output order is changed when using `log.Println` and `fmt.Println`?", "body": "<p>Here is my code:\npackage main</p>\n\n<pre><code>import \"log\"\nimport \"fmt\"\n\nfunc main() {\n    var a string = \"initail\"\n    log.Println(a)\n    var b, c int = 1, 2\n    fmt.Println(b, c)\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>1 2\n2016/12/30 14:22:58 initail\n</code></pre>\n\n<p>So i don't understand why the output's order?\nwhy <code>log.Println</code> is slower than <code>fmt.Println</code>?</p>\n"}, {"tags": ["go", "dry"], "comments": [{"owner": {"reputation": 4609, "user_id": 1699956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oBr6e.jpg?s=128&g=1", "display_name": "Mangat Rai Modi", "link": "https://stackoverflow.com/users/1699956/mangat-rai-modi"}, "edited": false, "score": 0, "creation_date": 1483076875, "post_id": 41391119, "comment_id": 69984549, "body": "Similar problem I had, Creating a fat struct, to parse both type of requests, other variable will be empty? Could you share &quot;BlueprintDetails&quot; struct?"}], "answers": [{"comments": [{"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 0, "creation_date": 1483109111, "post_id": 41391343, "comment_id": 69997897, "body": "@Sarathsp could you explain why <code>( (c *Client) )</code> not using <code>(c *Client)</code> ?"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 1, "creation_date": 1483109470, "post_id": 41391343, "comment_id": 69998086, "body": "@GujaratSantana oh, that was a typo . Thanks  for pointing it out"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 5, "last_activity_date": 1483109440, "last_edit_date": 1483109440, "creation_date": 1483077376, "answer_id": 41391343, "question_id": 41391119, "link": "https://stackoverflow.com/questions/41391119/how-do-i-make-this-go-code-more-dry/41391343#41391343", "title": "How do I make this Go code more DRY?", "body": "<p>You may create a <code>MakeRequest</code> function that does the http request part and unmarshal the json to struct</p>\n\n<p>Here is how you may do it, have a look at the <code>MakeRequest</code> function</p>\n\n<pre><code>// GetBlueprintDetails returns details about a blueprint\nfunc (c *Client) GetBlueprintDetails(projectID string, blueprintID string) (*BlueprintDetails, *APIError) {\n    path := fmt.Sprintf(\"projects/%s/blueprints/%s\", projectID, blueprintID)\n    bluePrintDetails = new(BlueprintDetails)\n    err := c.MakeRequest(\"GET\", path, bluePrintDetails)\n    return bluePrintDetails, err\n}\n\n// GetProjects returns a list of projects for the user\nfunc (c *Client) GetProjects() (*[]Project, *APIError) {\n    projects = make([]Project, 0)\n    err := c.MakeRequest(\"GET\", \"project\", &amp;projects)\n    return &amp;projects, err\n}\n\nfunc (c *Client) MakeRequest(method string, path string, response interface{}) *APIError {\n    res, err := c.Request(method, path, nil, nil)\n    if err != nil {\n        return nil, err\n    }\n    e := json.Unmarshal(res.Body, response)\n    if e != nil {\n        return &amp;APIError{Error: &amp;e}\n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 63072, "user_id": 11208, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jkSDT.jpg?s=128&g=1", "display_name": "Assaf Lavie", "link": "https://stackoverflow.com/users/11208/assaf-lavie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "accepted_answer_id": 41391343, "answer_count": 1, "score": 4, "last_activity_date": 1483109440, "creation_date": 1483075903, "question_id": 41391119, "link": "https://stackoverflow.com/questions/41391119/how-do-i-make-this-go-code-more-dry", "title": "How do I make this Go code more DRY?", "body": "<p>I'm implementing a Go wrapper for a REST API. It basically parses JSON and should return the appropriate struct type. I find myself doing a lot of this:</p>\n\n<pre><code>// GetBlueprintDetails returns details about a blueprint\nfunc (c *Client) GetBlueprintDetails(projectID string, blueprintID string) (*BlueprintDetails, *APIError) {\n    path := fmt.Sprintf(\"projects/%s/blueprints/%s\", projectID, blueprintID)\n    res, err := c.Request(\"GET\", path, nil, nil)\n    if err != nil {\n        return nil, err\n    }\n    var ret BlueprintDetails\n    e := json.Unmarshal(res.Body, &amp;ret)\n    if e != nil {\n        return nil, &amp;APIError{Error: &amp;e}\n    }\n    return &amp;ret, nil\n}\n\n// GetProjects returns a list of projects for the user\nfunc (c *Client) GetProjects() (*[]Project, *APIError) {\n    res, err := c.Request(\"GET\", \"projects\", nil, nil)\n    if err != nil {\n        return nil, err\n    }\n    var ret []Project\n    e := json.Unmarshal(res.Body, &amp;ret)\n    if e != nil {\n        return nil, &amp;APIError{Error: &amp;e}\n    }\n    return &amp;ret, nil\n}\n</code></pre>\n\n<p>The only difference between the two functions is the type of the unmarshaled struct basically. I know there are no generic in Go, but there has to be a pattern to make this more DRY.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go", "garbage-collection"], "answers": [{"comments": [{"owner": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "edited": false, "score": 0, "creation_date": 1530653596, "post_id": 51162706, "comment_id": 89309432, "body": "This is very interesting, thanks. Could you also please explain what is meant by &#39;idle marking&#39;, or provide a link to it."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "edited": false, "score": 0, "creation_date": 1530653813, "post_id": 51162706, "comment_id": 89309507, "body": "@user1952500 I don&#39;t have much beside <a href=\"https://github.com/golang/go/blob/4d7cf3fedbc382215df5ff6167ee9782a9cc9375/src/runtime/mgc.go#L315-L319\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/&hellip;</a>"}, {"owner": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "edited": false, "score": 0, "creation_date": 1530654329, "post_id": 51162706, "comment_id": 89309668, "body": "Thanks for the answer in any case. This definitely answers the question."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1530687317, "last_edit_date": 1530687317, "creation_date": 1530651372, "answer_id": 51162706, "question_id": 41390479, "link": "https://stackoverflow.com/questions/41390479/timing-related-fields-in-gctrace/51162706#51162706", "title": "Timing-related fields in gctrace", "body": "<p>The <a href=\"https://github.com/golang/go/blob/5d4f0474ecb322135612813eadf22db78309b33f/src/runtime/mgc.go#L1678-L1687\" rel=\"nofollow noreferrer\">source code is in <code>runtime/mgc.go</code></a>:</p>\n\n<pre><code>for i, ns := range []int64{\n    sweepTermCpu, \n    gcController.assistTime, \n    gcController.dedicatedMarkTime + gcController.fractionalMarkTime,\n    gcController.idleMarkTime, \n    markTermCpu} {\n    if i == 2 || i == 3 {\n        // Separate mark time components with /.\n        print(\"/\")\n    } else if i != 0 {\n        print(\"+\")\n    }\n    print(string(fmtNSAsMS(sbuf[:], uint64(ns))))\n}\n</code></pre>\n\n<p>So <code>1.9+0/1412/3894+38 ms cpu</code> means:</p>\n\n<pre><code>   1.9 sweepTermCpu, \n   0   gcController.assistTime, \n1412   gcController.dedicatedMarkTime + gcController.fractionalMarkTime,\n3894   gcController.idleMarkTime, \n  38   markTermCpu\n</code></pre>\n\n<p>With <a href=\"https://github.com/golang/go/blob/5d4f0474ecb322135612813eadf22db78309b33f/src/runtime/mgc.go#L381-L384\" rel=\"nofollow noreferrer\"><code>gcController.idleMarkTime</code></a> being the nanoseconds spent in <a href=\"https://github.com/golang/go/blob/4d7cf3fedbc382215df5ff6167ee9782a9cc9375/src/runtime/mgc.go#L315-L319\" rel=\"nofollow noreferrer\">idle marking</a> during this cycle.<br>\nIt is not surprising the the GC takes advantage of an idle processor to do some marking.  </p>\n\n<pre><code>// gcMarkWorkerIdleMode indicates that a P is running the mark\n// worker because it has nothing else to do. The idle worker\n// should run until it is preempted and account its time\n// against gcController.idleMarkTime.\ngcMarkWorkerIdleMode\n</code></pre>\n\n<p>There is actually a <a href=\"https://github.com/golang/go/issues/14179\" rel=\"nofollow noreferrer\">pending issue 14179</a> stating that the GC does not do enough(!) and should wake up idle Processor.</p>\n"}], "owner": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 1, "accepted_answer_id": 51162706, "answer_count": 1, "score": 3, "last_activity_date": 1530687317, "creation_date": 1483070821, "last_edit_date": 1491976766, "question_id": 41390479, "link": "https://stackoverflow.com/questions/41390479/timing-related-fields-in-gctrace", "title": "Timing-related fields in gctrace", "body": "<p>I am trying to understand the exact timing fields that are mentioned when <code>GODEBUG=gctrace=1</code> is enabled on a system running a set of executables compiled from a Go (v1.7) program.</p>\n\n<p>The command I use to get the stats is:</p>\n\n<pre><code>GODEBUG=gctrace=1 ~/golang/go/bin/godoc -http=:5555 -index\n</code></pre>\n\n<p>Now, the documentation says:</p>\n\n<pre><code>gctrace: setting gctrace=1 causes the garbage collector to emit a single line to standard\nerror at each collection, summarizing the amount of memory collected and the\nlength of the pause. Setting gctrace=2 emits the same summary but also\nrepeats each collection. The format of this line is subject to change.\nCurrently, it is:\n    gc # @#s #%: #+#+# ms clock, #+#/#/#+# ms cpu, #-&gt;#-&gt;# MB, # MB goal, # P\nwhere the fields are as follows:\n    gc #        the GC number, incremented at each GC\n    @#s         time in seconds since program start\n    #%          percentage of time spent in GC since program start\n    #+...+#     wall-clock/CPU times for the phases of the GC\n    #-&gt;#-&gt;# MB  heap size at GC start, at GC end, and live heap\n    # MB goal   goal heap size\n    # P         number of processors used\nThe phases are stop-the-world (STW) sweep termination, concurrent\nmark and scan, and STW mark termination. The CPU times\nfor mark/scan are broken down in to assist time (GC performed in\nline with allocation), background GC time, and idle GC time.\nIf the line ends with \"(forced)\", this GC was forced by a\nruntime.GC() call and all phases are STW.\n</code></pre>\n\n<p>A sample line of the output is:</p>\n\n<pre><code>gc 408 @4005.361s 0%: 0.061+86+1.2 ms clock, 1.9+0/1412/3894+38 ms cpu, 1080-&gt;1095-&gt;556 MB, 1108 MB goal, 72 P\n</code></pre>\n\n<p>What I a trying to understand are the pair of fields related to time:</p>\n\n<blockquote>\n  <p>0.061+86+1.2 ms clock <br/>\n  1.9+0/1412/3894+38 ms cpu</p>\n</blockquote>\n\n<p>So as per the documentation:</p>\n\n<pre><code>STW sweep termination: 0.061 ms\nConcurrent mark and scan: 86 ms\nSTW mark termination: 1.2 ms\n</code></pre>\n\n<p>Now the second set of times are supposed to be a breakdown of the mark/scan times earlier. But they seem to be quite large (<code>3894 ms</code> ?), and I don't understand the <code>+</code> in the mix. What do they indicate and how does the breakdown appear larger than the values?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3294, "user_id": 4848859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Slzu.jpg?s=128&g=1", "display_name": "mayo", "link": "https://stackoverflow.com/users/4848859/mayo"}, "edited": false, "score": 1, "creation_date": 1507569817, "post_id": 41389933, "comment_id": 80252602, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19646889/why-should-i-use-log-println-instead-of-fmt-println\">Why should I use log.Println instead of fmt.Println?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1483072465, "post_id": 41390023, "comment_id": 69983440, "body": "Could show me an example about <code>The log functions can print timestamp, source code location and other info.</code> ?"}, {"owner": {"reputation": 623, "user_id": 2603723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/122Td.jpg?s=128&g=1", "display_name": "Serkan Sipahi", "link": "https://stackoverflow.com/users/2603723/serkan-sipahi"}, "reply_to_user": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1576569174, "post_id": 41390023, "comment_id": 104932326, "body": "@BlackMamba It looks like this but is happens automatically when you use log: <code>Dec 16 16:13:20 My-MacBook someDescription[80590]: 2019&#47;12&#47;16 16:13:20 Error 1054: Unknown column &#39;xxx&#39; in &#39;field list&#39;</code>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 41, "last_activity_date": 1483115910, "last_edit_date": 1483115910, "creation_date": 1483066547, "answer_id": 41390023, "question_id": 41389933, "link": "https://stackoverflow.com/questions/41389933/when-to-use-log-over-fmt-for-debugging-and-printing-error/41390023#41390023", "title": "When to use log over fmt for debugging and printing error?", "body": "<p>Select between <code>log</code> and <code>fmt</code> using these facts:</p>\n\n<ul>\n<li>The <code>log</code> functions print to <a href=\"https://godoc.org/os#Stderr\" rel=\"noreferrer\">stderr</a> by default and can <a href=\"https://godoc.org/log#SetOutput\" rel=\"noreferrer\">directed to an arbitrary writer</a>. The <code>fmt.Printf</code> function prints to <a href=\"https://godoc.org/os#Stdout\" rel=\"noreferrer\">stdout</a>.</li>\n<li>The <code>log</code> functions can <a href=\"https://godoc.org/log#pkg-constants\" rel=\"noreferrer\">print timestamp, source code location and other info</a>.</li>\n<li>The <code>log</code> functions and <code>fmt.Printf</code> are both thread safe, but concurrent writes by <code>fmt.Printf</code> above an OS dependent size can be interleaved.</li>\n</ul>\n\n<p>The answer to the three sub questions are \"it depends\". </p>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 4, "last_activity_date": 1483067482, "creation_date": 1483067482, "answer_id": 41390104, "question_id": 41389933, "link": "https://stackoverflow.com/questions/41389933/when-to-use-log-over-fmt-for-debugging-and-printing-error/41390104#41390104", "title": "When to use log over fmt for debugging and printing error?", "body": "<p>You generally don't get into trouble if you stick to use fmt.Print* for program <strong>output</strong> and log.* for program <strong>logging</strong>.</p>\n\n<p>Of course if your program doesn't have \"local\" output (as most network server programs) you could use both for logging, but for logging log.* is more flexible and apt.</p>\n"}, {"comments": [{"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 0, "creation_date": 1483096697, "post_id": 41390114, "comment_id": 69992425, "body": "how do you know if <code>log</code> is thread safe? any reference for this ? thanks"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 3, "creation_date": 1483102590, "post_id": 41390114, "comment_id": 69994956, "body": "@GujaratSantana The <a href=\"https://godoc.org/log#Logger\" rel=\"nofollow noreferrer\">logger documentation</a> states that a logger can be used simultaneously from multiple goroutines.  There is no documentation on the thread safety of <code>fmt.Printf</code>.  The <code>fmt.Printf</code> implementation is thread safe it is very unlikely that it will be changed to not be thread safe."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1483107262, "post_id": 41390114, "comment_id": 69997032, "body": "Actually, though <code>fmt.Printf</code> is thread safe in the sense that it doesn&#39;t have any data races, a <code>Logger</code> uses a mutex to serialize the output, while fmt writes it out directly. With enough concurrency you can get interleaved writes to stdout."}], "tags": [], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "is_accepted": false, "score": 10, "last_activity_date": 1483120453, "last_edit_date": 1483120453, "creation_date": 1483067599, "answer_id": 41390114, "question_id": 41389933, "link": "https://stackoverflow.com/questions/41389933/when-to-use-log-over-fmt-for-debugging-and-printing-error/41390114#41390114", "title": "When to use log over fmt for debugging and printing error?", "body": "<p>I would like to add one more point:</p>\n\n<ul>\n<li><p>Log is thread safe where as fmt is not.</p>\n\n<p>A Logger can be used simultaneously from multiple goroutines; it guarantees to serialize access to the Writer. </p></li>\n</ul>\n\n<p><a href=\"https://godoc.org/log#Logger\" rel=\"noreferrer\">Link</a></p>\n"}, {"tags": [], "owner": {"reputation": 58368, "user_id": 30038, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/mPvRH.jpg?s=128&g=1", "display_name": "Vlad Bezden", "link": "https://stackoverflow.com/users/30038/vlad-bezden"}, "is_accepted": false, "score": 1, "last_activity_date": 1564673098, "creation_date": 1564673098, "answer_id": 57312344, "question_id": 41389933, "link": "https://stackoverflow.com/questions/41389933/when-to-use-log-over-fmt-for-debugging-and-printing-error/57312344#57312344", "title": "When to use log over fmt for debugging and printing error?", "body": "<p>From \"<a href=\"https://www.programming-books.io/essential/go/logging-f7fca2011c3748a19e3b8d66235cbe59\" rel=\"nofollow noreferrer\">Essential Go</a>\" book</p>\n\n<p>Standard package <a href=\"https://golang.org/pkg/log/\" rel=\"nofollow noreferrer\">log</a> offers more functionality:</p>\n\n<pre><code>log.Printf(\"Logging\")\nlog.Printf(\"Second line\\n\")\n\n2019/03/26 10:07:11 Logging\n2019/03/26 10:07:11 Second line\n</code></pre>\n\n<p>Compared to fmt.Printf, log.Printf: </p>\n\n<ul>\n<li>By default logs to stderr (os.Stderr) </li>\n<li>Adds current time to each log line </li>\n<li>Ensures that echo log is on it\u2019s own line by adding \\n if not explicitly provided</li>\n</ul>\n\n<p>To log fatal issues:</p>\n\n<pre><code>f, err := os.Open(\"file.txt\")\nif err != nil {\n    log.Fatalf(\"os.Open('file.txt') failed with '%s'\\n\", err)\n}\n</code></pre>\n\n<p>log.Fatalf logs the message and calls os.Exit(1) to end the process.</p>\n"}], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21914, "favorite_count": 4, "accepted_answer_id": 41390023, "answer_count": 4, "score": 25, "last_activity_date": 1564673098, "creation_date": 1483065809, "last_edit_date": 1483204177, "question_id": 41389933, "link": "https://stackoverflow.com/questions/41389933/when-to-use-log-over-fmt-for-debugging-and-printing-error", "title": "When to use log over fmt for debugging and printing error?", "body": "<p>I know that we can print variable or error using <code>log</code> and <code>fmt</code>. for example if I want to print variable I can do this :</p>\n\n<pre><code>h := \"world\"\nfmt.Printf(\"hello = %v\\n\", h)\nlog.Printf(\"halo = %v\\n\", h)\n</code></pre>\n\n<p>the output would be :</p>\n\n<pre><code>hello = world\n2016/12/30 09:13:12 halo = world\n</code></pre>\n\n<p>and usually in the error handling I found log like this </p>\n\n<pre><code>if err != nil {\n    log.Println(\"Error : something terrible happen -&gt; \", err)\n    return err\n}\n</code></pre>\n\n<p>but from above case I could also use <code>fmt</code> to print the error like this </p>\n\n<pre><code>fmt.Printf(\"Error : something terrible happen -&gt; %v\\n\",err.Error())\n</code></pre>\n\n<p>Is it a good practice to use <code>fmt</code> instead of <code>log</code> for printing the error?\nAnd then I always use <code>fmt</code> instead of <code>log</code> for printing the variable when debugging.</p>\n"}, {"tags": ["php", "arrays", "string", "go", "replace"], "answers": [{"tags": [], "owner": {"reputation": 771, "user_id": 1477995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb5d7f7704c45140f4878ab1b3fe4131?s=128&d=identicon&r=PG", "display_name": "Faouzi FJTech", "link": "https://stackoverflow.com/users/1477995/faouzi-fjtech"}, "is_accepted": false, "score": 0, "last_activity_date": 1483055203, "last_edit_date": 1483055203, "creation_date": 1483054428, "answer_id": 41388662, "question_id": 41388576, "link": "https://stackoverflow.com/questions/41388576/golang-replace-array-elements-by-array-elements-in-string/41388662#41388662", "title": "Golang replace array elements by array elements in string", "body": "<p>The solution I have found is the following : </p>\n\n<pre><code>str := \"hello world\"\narray1 :=  []string {\"hello\",\"world\"}\narray2 :=  []string {\"foo\",\"bar\"}\n\nfor i,toreplace := range array1{\n    r := strings.NewReplacer(toreplace,array2[i])\n    str = r.Replace(str)\n}\n\nfmt.Println(str)\n</code></pre>\n\n<p>A function can be created</p>\n\n<pre><code>func str_replace(str string, original []string, replacement []string) string {\n\n    for i,toreplace := range original{\n        r := strings.NewReplacer(toreplace,replacement[i])\n        str = r.Replace(str)\n    }\n\n    return str\n}\n</code></pre>\n\n<p>Usage : </p>\n\n<pre><code>str := \"hello world\"\narray1 :=  []string {\"hello\",\"world\"}\narray2 :=  []string {\"foo\",\"bar\"}\nstr = str_replace(str,array1,array2)\nfmt.Println(str)\n</code></pre>\n\n<p>Any more elegant solution is more than welcome.</p>\n"}, {"comments": [{"owner": {"reputation": 771, "user_id": 1477995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb5d7f7704c45140f4878ab1b3fe4131?s=128&d=identicon&r=PG", "display_name": "Faouzi FJTech", "link": "https://stackoverflow.com/users/1477995/faouzi-fjtech"}, "edited": false, "score": 0, "creation_date": 1483069202, "post_id": 41390063, "comment_id": 69982812, "body": "Thank you Pablo, that&#39;s a neat solution , I have made a benchmark on the two solutions, and yours is faster and more consistent."}], "tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 6, "last_activity_date": 1483066995, "creation_date": 1483066995, "answer_id": 41390063, "question_id": 41388576, "link": "https://stackoverflow.com/questions/41388576/golang-replace-array-elements-by-array-elements-in-string/41390063#41390063", "title": "Golang replace array elements by array elements in string", "body": "<p>I believe performance would be much better if you first zip both arrays in a single replacement array and then run just one replacer pass over the target string because strings.Replacer is fairly optimized for various cases and because the replacement algorithm would need to be run only once.</p>\n\n<p>Something like this would do:</p>\n\n<pre><code>func zip(a1, a2 []string) []string {\n    r := make([]string, 2*len(a1))\n    for i, e := range a1 {\n        r[i*2] = e\n        r[i*2+1] = a2[i]\n    }\n    return r\n}\n\nfunc main() {\n    str := \"hello world\"\n    array1 := []string{\"hello\", \"world\"}\n    array2 := []string{\"foo\", \"bar\"}\n    str = strings.NewReplacer(zip(array1, array2)...).Replace(str)\n    fmt.Println(str)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7383762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99ec028f64a3b9a7bb193af03d40b28c?s=128&d=identicon&r=PG", "display_name": "Andrei Avram", "link": "https://stackoverflow.com/users/7383762/andrei-avram"}, "is_accepted": false, "score": 0, "last_activity_date": 1485042314, "creation_date": 1485042314, "answer_id": 41785809, "question_id": 41388576, "link": "https://stackoverflow.com/questions/41388576/golang-replace-array-elements-by-array-elements-in-string/41785809#41785809", "title": "Golang replace array elements by array elements in string", "body": "<p>How about a map?</p>\n\n<pre><code>str := \"Lorem Ipsum is simply dummy. Lorem Ipsum is text of the printing. Lorem Ipsum is typesetting industry.\";\n\nreplace := map[string]string{\n    \"Lorem\": \"LoremReplaced\",\n    \"Ipsum\": \"IpsumReplaced\",\n    \"printing\": \"printingReplaced\",\n}\n\nfor s, r := range replace {\n    str = strings.Replace(str, s, r, -1)\n}\n</code></pre>\n"}], "owner": {"reputation": 771, "user_id": 1477995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb5d7f7704c45140f4878ab1b3fe4131?s=128&d=identicon&r=PG", "display_name": "Faouzi FJTech", "link": "https://stackoverflow.com/users/1477995/faouzi-fjtech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4957, "favorite_count": 0, "accepted_answer_id": 41390063, "answer_count": 3, "score": 0, "last_activity_date": 1485042314, "creation_date": 1483053660, "question_id": 41388576, "link": "https://stackoverflow.com/questions/41388576/golang-replace-array-elements-by-array-elements-in-string", "title": "Golang replace array elements by array elements in string", "body": "<p>In PHP we can do something like : </p>\n\n<pre><code>$result = str_replace($str,$array1,$array2);\n</code></pre>\n\n<p>Where $array1 and $array2 are array of elements, this makes php replace all array1 elements by array2 elements.\nIs there any equivalent to this using the Golang? I have tried the same php approach but it did not work :</p>\n\n<pre><code>str := \"hello world\"\narray1 :=  []string {\"hello\",\"world\"}\narray2 :=  []string {\"foo\",\"bar\"}\nr := strings.NewReplacer(array1,array2)\nstr = r.Replace(str)\n</code></pre>\n\n<p>I know I can do something like : </p>\n\n<pre><code>str := \"hello world\"\narray1 :=  []string {\"hello\",\"world\"}\narray2 :=  []string {\"foo\",\"bar\"}\nr := strings.NewReplacer(\"hello\",\"foo\",\"world\",\"bar\")\nstr = r.Replace(str)\n</code></pre>\n\n<p>That would work but I need to use arrays directly because the arrays of replacements will be created dynamically.</p>\n"}, {"tags": ["php", "go"], "comments": [{"owner": {"reputation": 1133, "user_id": 5120280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVWtC.png?s=128&g=1", "display_name": "Nytrix", "link": "https://stackoverflow.com/users/5120280/nytrix"}, "edited": false, "score": 1, "creation_date": 1483035718, "post_id": 41385156, "comment_id": 69972545, "body": "Welcome to Stackoverflow! Learn <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> before you do so. When asking a question, be <a href=\"http://stackoverflow.com/help/on-topic\">on topic</a> and be sure to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1483287567, "last_edit_date": 1495542828, "creation_date": 1483042579, "answer_id": 41386590, "question_id": 41385156, "link": "https://stackoverflow.com/questions/41385156/run-go-script-from-php/41386590#41386590", "title": "Run Go script from PHP", "body": "<p><strong>Go is not a scripting language! It is a compiled one.</strong></p>\n\n<h3>Compiled languages</h3>\n\n<blockquote>\n  <p>A compiled language is a programming language whose implementations are typically compilers (translators that generate machine code from source code), and not interpreters (step-by-step executors of source code, where no pre-runtime translation takes place).</p>\n</blockquote>\n\n<p><strong>So usage of \"script\" term is dramatically wrong!</strong></p>\n\n<h3>How to communicate with Go program from other programs.</h3>\n\n<p>You must build and install your program first. This is easy if you already prepared and configured your Go environment:</p>\n\n<pre><code>$go install github.com/user/hello\n</code></pre>\n\n<p>Than you can invoke it from command line since it is installed to OS.</p>\n\n<pre><code>$hello\n</code></pre>\n\n<p>If your program should expect arguments use <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">flag</a> package to declare it.</p>\n\n<pre><code>$hello -name &lt;value&gt;\n</code></pre>\n\n<p>Obviously you can call it from PHP with <code>system</code> function or whatever is possible (I don't know nothing about PHP).</p>\n\n<p>Other way is to design your Go program as a daemon and communicate with it directly through a port for example. Your Go program must run continuously and listen for a port. A good <a href=\"https://stackoverflow.com/a/10068950/629685\">answer</a> about daemonization of Go programs.</p>\n"}], "owner": {"reputation": 13, "user_id": 7209280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11d0ecdd512142b1e7d54b9813cb777?s=128&d=identicon&r=PG&f=1", "display_name": "\u0418\u0433\u043e\u0440\u044c \u042e\u043d\u0430\u0448", "link": "https://stackoverflow.com/users/7209280/%d0%98%d0%b3%d0%be%d1%80%d1%8c-%d0%ae%d0%bd%d0%b0%d1%88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2522, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1483287567, "creation_date": 1483035585, "last_edit_date": 1483285829, "question_id": 41385156, "link": "https://stackoverflow.com/questions/41385156/run-go-script-from-php", "title": "Run Go script from PHP", "body": "<p>I have a hosting with a PHP file which gets the request, take a string from it and have to give to Go (GoLang) script. How could I do it?</p>\n\n<p>package main\nMy GO script:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n\"log\"\n\"fmt\"\n\"io/ioutil\"\n\"strings\"\nivona \"github.com/jpadilla/ivona-go\"\n)\n\nfunc main() {\n    client := ivona.New(\"GDNAICTDMLSLU5426OAA\", \"2qUFTF8ZF9wqy7xoGBY+YXLEu+M2Qqalf/pSrd9m\")\n    text, err := ioutil.ReadFile(\"/Users/Igralino/Desktop/text.txt\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    arrayOfParagraphs := strings.Split(string(text), \"\\n\\n\")\n    i := 0\n    for _,paragraph := range arrayOfParagraphs {\n        paragraph = strings.TrimSpace(paragraph)\n        if (len(paragraph) &lt; 1) { // against empty lines\n            continue\n        }\n        log.Printf(\"%v\\n\", paragraph)\n        options := ivona.NewSpeechOptions(paragraph)\n        options.Voice.Language = \"ru-RU\"\n        options.Voice.Name = \"Maxim\"\n        options.Voice.Gender = \"Male\"\n        options.OutputFormat.Codec = \"MP3\"\n        r, err := client.CreateSpeech(options)\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        i++\n        file := fmt.Sprintf(\"/Users/Igralino/Desktop/tts%04d.MP3\", i) // files like 0001.ogg\n        ioutil.WriteFile(file, r.Audio, 0644)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "cross-compiling"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1483030766, "post_id": 41383851, "comment_id": 69970124, "body": "you mean you ran the .exe file on linux, and the linux binary on windows, or you&#39;re wondering how go can compile X-platform? Because X-platform compilation is not new.... C was designed to be portable, and if you stick to the standard, the same code can be compiled for any system, too"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1483031207, "post_id": 41383851, "comment_id": 69970378, "body": "Things you should look at is how the go runtime works, and what it does. In a nutshell: go compiles big parts of its runtime into each binary. Check the <code>GOROOT</code> files, and you&#39;ll find OS-specific source files. Some of them will deal with things like goroutines, and memory management. If you can compile the OS-specific quirks into a single binary, and you have a compiler that knows how to spit out executable files in a format that eg windows, linux, and BSD can make sense of, you&#39;re perfectly capable of X-compiling user code"}, {"owner": {"reputation": 343, "user_id": 4367538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1627764219/picture?type=large", "display_name": "P&#233;\u0165a Poliak", "link": "https://stackoverflow.com/users/4367538/p%c3%a9%c5%a5a-poliak"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1483032961, "post_id": 41383851, "comment_id": 69971262, "body": "yes I executed the linux binary on windows and the linux binary was crosscompiled on windowsI thought code compiled for linux can&#39;t run on windows"}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 4367538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1627764219/picture?type=large", "display_name": "P&#233;\u0165a Poliak", "link": "https://stackoverflow.com/users/4367538/p%c3%a9%c5%a5a-poliak"}, "edited": false, "score": 0, "creation_date": 1483039669, "post_id": 41385261, "comment_id": 69974288, "body": "But that shoulden&#39;t be enabled by default no?"}, {"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "edited": false, "score": 0, "creation_date": 1483201683, "post_id": 41385261, "comment_id": 70023052, "body": "As far as I know, it&#39;s a developer tool and not enabled by default. You also have to start bash from a Powershell window to start a complete Ubuntu system to execute ELF binaries. It&#39;s not something that happens behind the scenes. Let me know if I&#39;m wrong."}], "tags": [], "owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "is_accepted": true, "score": 1, "last_activity_date": 1483036080, "creation_date": 1483036080, "answer_id": 41385261, "question_id": 41383851, "link": "https://stackoverflow.com/questions/41383851/running-compiled-code-for-linux-on-windows/41385261#41385261", "title": "Running compiled code for linux on windows", "body": "<p>That'd be the new <a href=\"https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux\" rel=\"nofollow noreferrer\">Windows Subsystem for Linux</a> (WSL) that can run Linux ELF binaries natively on Windows 10.</p>\n"}], "owner": {"reputation": 343, "user_id": 4367538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1627764219/picture?type=large", "display_name": "P&#233;\u0165a Poliak", "link": "https://stackoverflow.com/users/4367538/p%c3%a9%c5%a5a-poliak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 41385261, "answer_count": 1, "score": 0, "last_activity_date": 1483036080, "creation_date": 1483030116, "question_id": 41383851, "link": "https://stackoverflow.com/questions/41383851/running-compiled-code-for-linux-on-windows", "title": "Running compiled code for linux on windows", "body": "<p>So I cross-compiled Go code on Windows(10) for Linux and I was actually able to run the same executable on both Windows and Linux how is that possible?</p>\n"}, {"tags": ["rest", "http", "go", "request", "response"], "answers": [{"comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1483298442, "post_id": 41385563, "comment_id": 70041384, "body": "Your quotation seems wrong, it is about <code>Request.Body</code> but @nos is closing <code>Response.Body</code> which in opposite to <code>Request.Body</code> should be closed by caller."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1483387386, "post_id": 41385563, "comment_id": 70071122, "body": "@I159: The last paragraph in the post is specifically asking about the <code>http.Request</code> &quot;on the server side&quot;."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1483387612, "post_id": 41385563, "comment_id": 70071206, "body": "I&#39;m sorry. I found it out."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1483486768, "last_edit_date": 1483486768, "creation_date": 1483037448, "answer_id": 41385563, "question_id": 41383622, "link": "https://stackoverflow.com/questions/41383622/close-response-body-multiple-times-after-multiple-requests-in-golang/41385563#41385563", "title": "Close response body multiple times after multiple requests in golang", "body": "<p>Yes, you need to close both responses. Deferring one call to <code>resp.Body.Close</code> does not somehow effect the other. The <code>*http.Response</code> is different in each case, and they both can be deferred.</p>\n\n<p>On the server side, you do not need to close the <code>Request.Body</code> -- from the <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\"><code>http.Request</code> documentation</a>:</p>\n\n<pre><code>// The Server will close the request body. The ServeHTTP\n// Handler does not need to.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1483902681, "last_edit_date": 1483902681, "creation_date": 1483040036, "answer_id": 41386113, "question_id": 41383622, "link": "https://stackoverflow.com/questions/41383622/close-response-body-multiple-times-after-multiple-requests-in-golang/41386113#41386113", "title": "Close response body multiple times after multiple requests in golang", "body": "<h3>Bad practice</h3>\n\n<p>If you did not reuse <code>resp</code> variable, it would be obvious that you are dealing with different response instances each of which must be closed.</p>\n\n<blockquote>\n  <p>Do sends an HTTP request and <strong>returns an HTTP response</strong> (instance)...</p>\n</blockquote>\n\n<p>So, the bad practice is not to do several requests but to reuse the same variable for several responses. It causes code unobviousness. And produces unreachable objects which never be finalized.</p>\n\n<h3>Deferred execution</h3>\n\n<blockquote>\n  <p>A defer statement pushes a function call onto a list. The list of saved calls is executed after the surrounding function returns.</p>\n</blockquote>\n\n<p>If you have scheduled single or several <code>defer</code>red executions with reference to the same variable only the last assigned to the variable object's method will be executed (several times for several <code>defer</code>s).</p>\n\n<p><a href=\"https://play.golang.org/p/GRgWMhZ9Gv\" rel=\"nofollow noreferrer\">Playground with an example</a></p>\n\n<h3>Closing <code>Response.Body</code></h3>\n\n<p>From <a href=\"https://golang.org/pkg/net/http/#Response\" rel=\"nofollow noreferrer\"><code>Response</code> documentation</a>:</p>\n\n<blockquote>\n  <p>It is the caller's responsibility to\n  close Body.</p>\n</blockquote>\n\n<p>So, typically you must close each <code>Response.Body</code>.</p>\n\n<h3>Garbage collecting and finalization <em>(edit)</em></h3>\n\n<p>Garbage collector invokes bind to collecting objects finalizers to close files, connections and to do other cleanup actions. And there is no finalizers bind to <code>Body</code> object by default.</p>\n\n<h3>Your improved snippet:</h3>\n\n<pre><code>// ...a lot of code\nresp_one, err := http.DefaultClient.Do(req)                                 \n // BTW, `assert.Nil` just returns whether the assertion was successful (bool) not terminates a test.\nif assert.Nil(t, err) == true {\n    defer resp_one.Body.Close()                                                 \n}\n\n// ...a lot of code\nresp_two, err = http.DefaultClient.Do(req)                                  \nif assert.Nil(t, err) == true {\n    defer resp_two.Body.Close()\n}\n</code></pre>\n"}], "owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2072, "favorite_count": 1, "accepted_answer_id": 41385563, "answer_count": 2, "score": 2, "last_activity_date": 1483902681, "creation_date": 1483029143, "last_edit_date": 1495542277, "question_id": 41383622, "link": "https://stackoverflow.com/questions/41383622/close-response-body-multiple-times-after-multiple-requests-in-golang", "title": "Close response body multiple times after multiple requests in golang", "body": "<p>In <a href=\"https://stackoverflow.com/questions/33238518/what-could-happen-if-i-dont-close-response-body-in-golang\">this post</a>, it is pointed out that response.Body should be closed to avoid resource leak. It is also shown in the overview examples in <a href=\"https://golang.org/pkg/net/http/#Overview\" rel=\"nofollow noreferrer\">http package godoc</a>.</p>\n\n<p>In my test code, I send multiple requests to try an API with</p>\n\n<p><code>resp, err := http.DefaultClient.Do(req)</code></p>\n\n<p>multiple times in the same function. Is this a bad practice? In this case, do I write <code>defer resp.Body.Close()</code> after each of them, or just once?</p>\n\n<pre><code>url := server.URL + \"/ticket/add\"                                       \nreader = strings.NewReader(`{\"id\": \"test1\", \"detail\": \"test1\"}`)        \nreq, err := http.NewRequest(\"POST\", url, reader)                        \nassert.Nil(t, err)               \n\nresp, err := http.DefaultClient.Do(req)                                 \nassert.Nil(t, err)                                                      \n\ndefer resp.Body.Close()                                                 \n\nassert.Equal(t, http.StatusCreated, resp.StatusCode)                    \n// add a ticket with same id                                            \nreader = strings.NewReader(`{\"id\": \"test1\"}`)                           \nreq, err = http.NewRequest(\"POST\", url, reader)                         \nassert.Nil(t, err)                                                      \n\nresp, err = http.DefaultClient.Do(req)                                  \nassert.Nil(t, err)                                                      \nassert.Equal(t, http.StatusInternalServerError, resp.StatusCode)   \n</code></pre>\n\n<p>A related question, on the server side, i.e., inside the <code>func(w http.ResponseWriter, r *http.Request)</code>, is it necessary to close the request body as well?</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1483028591, "post_id": 41383449, "comment_id": 69968987, "body": "Anybody can create interfaces for any type, in Go. It means there&#39;s zero need to declare an interface that you don&#39;t use. As you noticed, the fact there wasn&#39;t any pre-existing interface didn&#39;t prevent you from creating the ones you wanted."}, {"owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "reply_to_user": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1483029129, "post_id": 41383449, "comment_id": 69969248, "body": "Sure, I get that. But I come across many gophers emphasising the usage of interfaces upfront to make it easier for others to mock the concrete types. Maybe I&#39;m overthinking this. Thanks."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 2, "creation_date": 1483030521, "post_id": 41383449, "comment_id": 69969988, "body": "@AmirKeibi: Interfaces make mocking a lot easier, true enough, but that doesn&#39;t mean package maintainers are supposed to create fully interface-based packages. There&#39;s a package out there that allows you to mock <code>database&#47;sql</code> stuff quite easily: <a href=\"https://github.com/DATA-DOG/go-sqlmock\" rel=\"nofollow noreferrer\">go-sqlmock</a>, maybe take a look at that?"}], "answers": [{"tags": [], "owner": {"reputation": 2911, "user_id": 702065, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae529fa78546d54e42c26bd3713946a2?s=128&d=identicon&r=PG", "display_name": "Johan Wikstr&#246;m", "link": "https://stackoverflow.com/users/702065/johan-wikstr%c3%b6m"}, "is_accepted": true, "score": 0, "last_activity_date": 1487980060, "creation_date": 1487980060, "answer_id": 42450171, "question_id": 41383449, "link": "https://stackoverflow.com/questions/41383449/why-database-types-arent-interface-in-go/42450171#42450171", "title": "Why database types aren&#39;t interface in GO", "body": "<p>Exposing interfaces in your public API instead of concrete types increases the risk of breaking other peoples code when you add methods to the interface.</p>\n\n<p>See for example <a href=\"https://golang.org/pkg/os/#File\" rel=\"nofollow noreferrer\"><code>os.File</code></a>. If <code>os.File</code> was an interface it would be an interface with 17 public methods. Adding an 18th method would break everyone who defined their own types that implemented the <code>os.File</code> interface. In contrast, adding an 18th method to the current <code>os.File</code> struct won't break any methods taking an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a>, <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow noreferrer\"><code>io.Writer</code></a> or any other interface that defines a subset of the methods of an <code>os.File</code>. It also won't break test code which mocks these <code>io.Reader</code> and <code>io.Writer</code> interfaces.</p>\n\n<p>So expose an interface in your public API if you want other people to define their own implementations of them. Otherwise expose a concrete type and let people define their own interfaces implemented by your concrete type using only the subset of methods they need.</p>\n"}], "owner": {"reputation": 1609, "user_id": 1307284, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a26e95e08a4dc11c43be0002b4991bca?s=128&d=identicon&r=PG", "display_name": "Amir Keibi", "link": "https://stackoverflow.com/users/1307284/amir-keibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 42450171, "answer_count": 1, "score": 6, "last_activity_date": 1487980060, "creation_date": 1483028450, "question_id": 41383449, "link": "https://stackoverflow.com/questions/41383449/why-database-types-arent-interface-in-go", "title": "Why database types aren&#39;t interface in GO", "body": "<p>There is an emphasis on using interfaces instead of concrete types in order to make the code easier to test. I wonder though why this wasn't done for the types in the <em>sql</em> package like DB or Rows. In order to mock those dependencies I had to create my own interfaces so that I could write unit tests (not integration tests). Aren't DB facing code supposed to be tested that way?</p>\n"}, {"tags": ["php", "go"], "comments": [{"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 4, "creation_date": 1483025568, "post_id": 41382570, "comment_id": 69967325, "body": "<a href=\"https://golang.org/pkg/crypto/rand/\" rel=\"nofollow noreferrer\">golang.org/pkg/crypto/rand</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1483025680, "post_id": 41382708, "comment_id": 69967389, "body": "<a href=\"https://godoc.org/github.com/dgrijalva/jwt-go#example-New--Hmac\" rel=\"nofollow noreferrer\">godoc.org/github.com/dgrijalva/jwt-go#example-New--Hmac</a> I have had this issue for the whole day. I am trying to use the exact code in the link, but what do I use for the hmacSampleSecret? It&#39;s been puzzling me for so long."}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 0, "last_activity_date": 1483026184, "last_edit_date": 1495540393, "creation_date": 1483025567, "answer_id": 41382708, "question_id": 41382570, "link": "https://stackoverflow.com/questions/41382570/phps-openssl-random-pseudo-bytes-alternative-for-golang/41382708#41382708", "title": "PHP&#39;s openssl_random_pseudo_bytes Alternative for Golang?", "body": "<p>Look at package \"crypto/rand\", <a href=\"https://stackoverflow.com/questions/1313223/replace-rand-with-openssl-random-pseudo-bytes?rq=1\">replace rand() with openssl_random_pseudo_bytes()</a> and <a href=\"https://github.com/dgrijalva/jwt-go/blob/master/hmac_example_test.go\" rel=\"nofollow noreferrer\">https://github.com/dgrijalva/jwt-go/blob/master/hmac_example_test.go</a></p>\n\n<pre><code>func init() {\n    // Load sample key data\n    if keyData, e := ioutil.ReadFile(\"test/hmacTestKey\"); e == nil {\n        hmacSampleSecret = keyData\n    } else {\n        panic(e)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 6247904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201838251193652/picture?type=large", "display_name": "Eu Ga", "link": "https://stackoverflow.com/users/6247904/eu-ga"}, "is_accepted": true, "score": 0, "last_activity_date": 1486987011, "last_edit_date": 1486987011, "creation_date": 1486738502, "answer_id": 42162331, "question_id": 41382570, "link": "https://stackoverflow.com/questions/41382570/phps-openssl-random-pseudo-bytes-alternative-for-golang/42162331#42162331", "title": "PHP&#39;s openssl_random_pseudo_bytes Alternative for Golang?", "body": "<p>Quick and lightweight pseudo-random string of bytes generator</p>\n\n<p>At first define array of bytes that we want to use for our generator( in this case it shall be letters)\nThen decide how many bits represent one letter(it will allow us take letters one by one) and letter \"template\" that contains amount of bits for one letter\nAlso I stored maximum index that I can take from my array of bytes</p>\n\n<pre><code>const (\n    letterBytes   = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    letterIdxBits = 6                    // 6 bits to represent a letter index\n    letterIdxMask = 1&lt;&lt;letterIdxBits - 1 // All 1-bits, as many as letterIdxBits\n    letterIdxMax  = 63 / letterIdxBits   // # of letter indices fitting in 63 bits\n)\n</code></pre>\n\n<p>StringRandomizer function gets an argument(length of string that I want to get as result)</p>\n\n<p>Basically, this function just a simple loop that creates a new array of bytes with defined length, and pseudo-random elements.\nUntil I did not fill in all required elements of result array(did not put 'n' elements), I get one random letter from my letterBytes const.\nIf length of the string that I want to get at the end more that letterIdxMax, I just create new random  sequence of 63 bytes(src.Int63()) and proceed looping</p>\n\n<pre><code>func StringRandomizer(n int) string {\n    src := rand.NewSource(time.Now().UnixNano())\n    b := make([]byte, n)\n    // A src.Int63() generates 63 random bits, enough for letterIdxMax characters!\n    for i, cache, remain := n-1, src.Int63(), letterIdxMax; i &gt;= 0; remain-- {\n        if remain == 0 {\n            cache, remain = src.Int63(), letterIdxMax\n        }\n        if idx := int(cache &amp; letterIdxMask); idx &lt; len(letterBytes) {\n            b[i] = letterBytes[idx]\n            i--\n        }\n        cache &gt;&gt;= letterIdxBits\n\n    }\n    return string(b)\n}\n</code></pre>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 42162331, "answer_count": 2, "score": 1, "last_activity_date": 1486987011, "creation_date": 1483025048, "question_id": 41382570, "link": "https://stackoverflow.com/questions/41382570/phps-openssl-random-pseudo-bytes-alternative-for-golang", "title": "PHP&#39;s openssl_random_pseudo_bytes Alternative for Golang?", "body": "<p>Is there a function for Golang which is or nearly is identicle to PHP's <a href=\"http://php.net/manual/en/function.openssl-random-pseudo-bytes.php\" rel=\"nofollow noreferrer\"><code>openssl_random_pseudo_bytes()</code></a> function?</p>\n\n<p>I need this to generate pseudo-random string of bytes in Golang.</p>\n"}, {"tags": ["json", "go", "marshalling", "decode"], "comments": [{"owner": {"reputation": 3044, "user_id": 393581, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f10a8776b856dd7dfbc7fbf8d95c910b?s=128&d=identicon&r=PG", "display_name": "garfbradaz", "link": "https://stackoverflow.com/users/393581/garfbradaz"}, "edited": false, "score": 2, "creation_date": 1483019031, "post_id": 41380899, "comment_id": 69963690, "body": "Hey @user7354163 -  Take time to read this post on how to compose a good SO question:  <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483027374, "post_id": 41380899, "comment_id": 69968295, "body": "Never create a new Transport for each request. You won&#39;t be able to reuse connections, and any idle connections will be leaked. From the docs: <a href=\"https://golang.org/pkg/net/http/#Transport\" rel=\"nofollow noreferrer\"><code>Transports should be reused instead of created as needed</code></a>"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1483040486, "post_id": 41380899, "comment_id": 69974639, "body": "The question is messy and completely unreadable."}], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 1, "last_activity_date": 1483019714, "creation_date": 1483019714, "answer_id": 41381148, "question_id": 41380899, "link": "https://stackoverflow.com/questions/41380899/get-response-from-post-type-method-from-restful-api/41381148#41381148", "title": "Get response from POST type method from restful API", "body": "<p>The way to read the response (if there is one) is the same regardless of what status you get.</p>\n\n<pre><code>defer resp.Body.Close()\nbody, err := ioutil.ReadAll(resp.Body)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1483027081, "creation_date": 1483027081, "answer_id": 41383075, "question_id": 41380899, "link": "https://stackoverflow.com/questions/41380899/get-response-from-post-type-method-from-restful-api/41383075#41383075", "title": "Get response from POST type method from restful API", "body": "<p>As Frank said, regardless of the status code in the response you can simply read its body to use whatever content it has.</p>\n\n<p>Particularly for the case of a JSON message, you have two options depending on whether you know the JSON message structure in advance (or want your code to depend on it).</p>\n\n<p>If you know the structure and are ok with hard-coding it (plus you gain some type safety and better client code) you can have:</p>\n\n<pre><code>type ErrorResponse struct {\n    Messages []string `json:\"errorMessages\"`\n}\n</code></pre>\n\n<p>And then when you detect an error status code unmarshal the response body as that struct:</p>\n\n<pre><code>if resp.StatusCode % 100 != 2 {\n    var error ErrorResponse\n    err := json.Unmarshall(resp.Body, &amp;error)\n    // check err != nil ...\n    // user error.ErrorMessages for whatever you want \n}\n</code></pre>\n\n<p>Alternatively if you don't want to depend on the JSON structure (to some degree) you can try to unmarshall it to a map[string]interface{} and try to use that in the generic way you think you can (generally not very useful).</p>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1483295621, "last_edit_date": 1592644375, "creation_date": 1483041527, "answer_id": 41386411, "question_id": 41380899, "link": "https://stackoverflow.com/questions/41380899/get-response-from-post-type-method-from-restful-api/41386411#41386411", "title": "Get response from POST type method from restful API", "body": "<p>This question is not related to http responses and http methods. Decode json string (wich is http response body in that case) with json decoder.</p>\n<h3>Simple example</h3>\n<p><em>(not directly related to your code snippet)</em></p>\n<pre><code>type Transition struct {\n    Transition map[string]int\n}\n\nfunc main() {\n    resp, err := postUrl(url, byt)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    var trans Transition\n    decoder := json.NewDecoder(resp.Body)\n\n    if err := decoder.Decode(&amp;trans); err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Printf(&quot;%+v\\n&quot;, trans)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7354163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ccb4ce753363abce09c2c1d25dde036?s=128&d=identicon&r=PG&f=1", "display_name": "user7354163", "link": "https://stackoverflow.com/users/7354163/user7354163"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "answer_count": 3, "score": -3, "last_activity_date": 1483295621, "creation_date": 1483018726, "last_edit_date": 1483295433, "question_id": 41380899, "link": "https://stackoverflow.com/questions/41380899/get-response-from-post-type-method-from-restful-api", "title": "Get response from POST type method from restful API", "body": "<p>How can I fetch the json response from the POST method? Currently I'm only able to fetch Status - 401 Unauthorized and StatusCode - 401</p>\n\n<pre><code>func postUrl(url string, byt []byte) (*http.Response, error) {\n    tr := &amp;http.Transport{\n        DisableCompression: true,\n    }\n    client := &amp;http.Client{Transport: tr, Timeout: 10 * time.Second}\n    req, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(byt))\n    req.Header.Set(\"X-Custom-Header\", \"myvalue\")\n    req.Header.Set(\"Content-Type\", \"application/json\")\n    req.Header.Add(\"Authorization\", \"Basic \"+basicAuth(\"username\", \"password\"))\n    resp, err := client.Do(req)\n    return resp, err\n  }\n</code></pre>\n\n<p>Above code produces the output:</p>\n\n<pre><code>{\n  \"errorMessages\": [\n    \"You do not have the permission to see the specified issue.\",\n    \"Login Required\"\n  ],\n    \"errors\": {}\n}\n</code></pre>\n"}, {"tags": ["linux", "go", "network-programming", "netlink"], "answers": [{"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 4, "last_activity_date": 1483020492, "last_edit_date": 1592644375, "creation_date": 1483017273, "answer_id": 41380518, "question_id": 41379417, "link": "https://stackoverflow.com/questions/41379417/how-to-use-go-receiver-when-struct-is-defined-in-imported-package/41380518#41380518", "title": "How to use go receiver when struct is defined in imported package", "body": "<h2>Update</h2>\n<p>While writing the original answer, touched on a number of things, without any clear structure, so here's a more structured version:</p>\n<p>Depending on what you're actually asking (ie <em>&quot;How do I add a receiver function/method to an exported type&quot;</em>, or <em>&quot;What the hell is a receiver function&quot;</em>), the answers are as follows:</p>\n<h3>How do I add a receiver function to an exported type?</h3>\n<p>Easy, same as you do with any other type. You were close, in fact. This doesn't work:</p>\n<pre><code>func (h *Handler) showInts() {}\n</code></pre>\n<p>Because you're adding a method to the <code>Handler</code> type in <em>your</em> package. Given you have a <code>main</code> function, that would be the <code>main</code> package. You're trying to add it to the <code>netlink.Handler</code> type instead. In which case, this will work:</p>\n<pre><code>func (h *netlink.Handler) showInts(){}\n</code></pre>\n<p>The type is <code>netlink.Handler</code> in your main package after all... This, however will <em>not</em> work. The compiler will refuse to compile, telling you: <em>&quot;Cannot define new methods on non-local type&quot;</em>. This is easily mitigated, though, by creating a new type, and add the method there:</p>\n<pre><code>type MyHandler netlink.Handler\nfunc (h *MyHandler) showInts(){}\n</code></pre>\n<p>Be that as it may, the last 2 lines in your code strike me as wrong.\nGiven that <code>NewHandleAt</code> returns <code>(*Handle, error)</code>, and <code>netlink.Handle</code> is a receiver argument, the correct way would be:</p>\n<pre><code>var mh *MyHandle\nif h, err := netlink.NewHandleAt(pid); err != nil {\n    log.Fatal(err) // something went wrong\n} else {\n    mh = (*MyHandle)(h)\n}\nmh.showInts() // call showInts on mh, which is of type *MyHandle\n</code></pre>\n<p>The fact that you've <em>&quot;wrapped&quot;</em> the external type in a custom type does mean you'll find yourself casting the same thing quite a lot. Say <code>netlink.Handle</code> has a <code>Test</code> method, and you want to call it inside <code>showInts</code>:</p>\n<pre><code>func (h *MyHandle) showInts() {\n    nh := (*netlink.Handle)(h) //cast required\n    nh.Test()\n}\n</code></pre>\n<p>I'd also change the varname from <code>pid</code> to <code>nsh</code> or something, because it's a <code>NsHandle</code>, and not a <code>pid</code> after all...</p>\n<hr />\n<h3>What is a receiver argument?</h3>\n<p>Because you wrote this:</p>\n<blockquote>\n<p>This is then a receiver argument (?) to a function that requires that handle,</p>\n</blockquote>\n<p>I get the impression you're not entirely clear on what a receiver argument is. Put simply, it's like a function argument, but instead of an argument that is just passed to a function, it's an argument that holds the object/value on which the function is called. Basically, it's the <em>&quot;instance&quot;</em> on which the function/method is called. Think of it as the <code>this</code> keyword in many OOP languages:</p>\n<pre><code>func (h *MyHandle) showInts() {\n    return\n}\n</code></pre>\n<p>In something like C++ would be</p>\n<pre><code>class MyHandle : Handle\n{\n    public:\n        void showInts(void) { return; } // replace h with this\n}\n</code></pre>\n<p>There are significant differences, however:</p>\n<ul>\n<li>The receiver argument can be a pointer, or a value - in case of a value receiver, the method cannot modify the receiver value</li>\n<li>There's no such thing as private, public, or protected... at least not in the traditional OO way</li>\n<li>...</li>\n</ul>\n<p>There's quite a few differences, perhaps consider going through the golang tour. The stuff about go methods can be found <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">here</a></p>\n<hr />\n<h3>Other issues/weird things</h3>\n<p>After looking at your code again, I'm really not sure whether this is correct:</p>\n<pre><code>h.netlink.LinkList()\n</code></pre>\n<p>In your <code>main</code> function, you call <code>netlink.LinkList()</code>. <code>h</code> is a <code>*netlink.Handler</code>. If you need to call the <code>netlink.LinkList</code> function, it's highly likely <code>h.netlink.LinkList</code> is <strong>not</strong> what you want to do. Instead, you should simply call <code>netlink.LinkList()</code>.<br>\nThat's assuming you need to call the function in the first place.</p>\n<p>Given that you've already called it in the <code>main</code> function, why not pass it as an argument?</p>\n<pre><code>//in main:\nints, err := netlink.LinkList()\n//...\nh.showInts(ints)\n\nfunc (h *MyHandle)showInts(ll []netlink.Link) {\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "is_accepted": false, "score": 1, "last_activity_date": 1483060041, "creation_date": 1483060041, "answer_id": 41389312, "question_id": 41379417, "link": "https://stackoverflow.com/questions/41379417/how-to-use-go-receiver-when-struct-is-defined-in-imported-package/41389312#41389312", "title": "How to use go receiver when struct is defined in imported package", "body": "<p>Thanks Elias, awesome answer!</p>\n\n<p>From that, I've written the following code which will list interfaces belonging to a specific namespace. Thanks!</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/vishvananda/netns\"\n    \"github.com/vishvananda/netlink\"\n    \"log\"\n)\n\ntype NSHandle netlink.Handle\n\nfunc (h *NSHandle) showInts() {\n  nh := (*netlink.Handle)(h) //cast required\n  int, err := nh.LinkList()\n  if err != nil {\n      log.Fatal(err)\n  }\n\n  log.Printf(\"Namespace Ints:\")\n  for i, r := range int {\n      log.Printf(\"%d: %s\", i, r.Attrs().Name)\n  }\n}\n\nfunc getNSFromPID(pid int) (*NSHandle) {\n  hpid, err := netns.GetFromPid(9115)\n  if err != nil {\n      log.Fatal(err)\n  }\n  var nsh *NSHandle\n  if h, err := netlink.NewHandleAt(hpid); err != nil {\n      log.Fatal(err) // something went wrong\n  } else {\n      nsh = (*NSHandle)(h)\n  }\n  return nsh\n}\n\nfunc main() {\n  getNSFromPID(9115).showInts()\n}\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2140, "favorite_count": 2, "accepted_answer_id": 41380518, "answer_count": 2, "score": 3, "last_activity_date": 1483060041, "creation_date": 1483013184, "question_id": 41379417, "link": "https://stackoverflow.com/questions/41379417/how-to-use-go-receiver-when-struct-is-defined-in-imported-package", "title": "How to use go receiver when struct is defined in imported package", "body": "<p>currently working with the <code>vishvananda/netns</code> package trying to extract routes from a specific network namespace. </p>\n\n<p>There is a defined <code>Handle</code> struct which is returned when I request a 'handle' for a specific network namespace. As such:</p>\n\n<p><code>func NewHandleAt(ns netns.NsHandle, nlFamilies ...int) (*Handle, error)</code></p>\n\n<p>This is then a receiver argument (?) to a function that requires that handle,</p>\n\n<p><code>func (h *Handle) LinkList() ([]Link, error)</code> </p>\n\n<p>I'm new to go and not sure how to tie these together. I'm stuck with:</p>\n\n<pre><code>func (h *Handle) showInts() {\n  int, err := h.netlink.LinkList()\n  if err != nil {\n      log.Fatal(err)\n  }\n\n  for i, r := range int {\n      log.Printf(\"%d: %s\", i, r.Attrs().Name)\n  }\n}\n\n\nfunc main() {\n    ints, err := netlink.LinkList()\n    if err != nil {\n        log.Fatal(err)\n    }\n    for i, r := range ints {\n        log.Printf(\"%d: %s\", i, r.Attrs().Name)\n    }\n\n    pid, err := netns.GetFromPid(9097)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    netlink.NewHandleAt(pid)\n    showInts()\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1483014650, "creation_date": 1483014650, "answer_id": 41379788, "question_id": 41378605, "link": "https://stackoverflow.com/questions/41378605/content-length-is-zero-when-http-posting-a-local-file-by-passing-the-io-reader/41379788#41379788", "title": "Content-Length is zero when (HTTP) POSTing a local file by passing the io.Reader from os.Open to http.Post", "body": "<p>Yes, it's possible to pass whatever <code>os.Open()</code> returned directly as the body of a HTTP request to be made.</p>\n\n<p>But there are only two ways to deal with the content length of that file's data.  They are different, but they both revolve around the idea that the receiving side either must know the content length in advance&mdash;that is, from the HTTP response headers is receives before the body or it must use a mechanism which allows to not know it, and then the sender must have a way to signal that it's done sending the data.</p>\n\n<ul>\n<li><p>A \"classic\" one&mdash;working even with HTTP/1.0&mdash; is to calculate it before sending.  This indeed means either reading the whole thing into memory or doing a <code>stat</code> call (you can do it on an opened file BTW).</p></li>\n<li><p>HTTP/1.1 supports the so-called <a href=\"https://en.wikipedia.org/wiki/Chunked_transfer_encoding\" rel=\"nofollow noreferrer\">\"chunked\" transfer encoding</a> of the data it sends.\nIn this case, the payload is cut into pieces and each piece is sent in turn&mdash;using certain framing. A special frame signalizes the end of the data stream. In this case it's OK to set Content-Type to 0, but the client must support chunked encoding (not all do).</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 2, "last_activity_date": 1483026215, "creation_date": 1483026215, "answer_id": 41382879, "question_id": 41378605, "link": "https://stackoverflow.com/questions/41378605/content-length-is-zero-when-http-posting-a-local-file-by-passing-the-io-reader/41382879#41382879", "title": "Content-Length is zero when (HTTP) POSTing a local file by passing the io.Reader from os.Open to http.Post", "body": "<p>Short answer is: you are absolutely right about giving the os.File to http.Request and about using os.File.Stat() to get the file size and setting it on the http.Request headers. Personally I've found it to be the simplest way around.</p>\n\n<p>i.e.</p>\n\n<pre><code>file, _ := os.Open(\"some file\")\ninfo, _ := file.Stat()\nreq, _ := http.NewRequest(\"POST\", \"http://bla.com\", file)\nreq.ContentLength = info.Size()\ndump, _ := httputil.DumpRequestOut(req, false)\nfmt.Println(string(dump))\n</code></pre>\n\n<p>Also note that as per <a href=\"https://golang.org/pkg/net/http/#Request.Write\" rel=\"nofollow noreferrer\">http.Request.Write() documentation</a> (I quote):</p>\n\n<blockquote>\n  <p>If Body is present, Content-Length is &lt;= 0 and TransferEncoding hasn't\n  been set to \"identity\", Write adds \"Transfer-Encoding: chunked\" to the\n  header. Body is closed after it is sent.</p>\n</blockquote>\n\n<p>So in that case the client itself would do the (arguably) most sensible thing to do for you.</p>\n"}], "owner": {"reputation": 186, "user_id": 1478380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b87c879e6953ff8f51ec6c8370d84b?s=128&d=identicon&r=PG", "display_name": "oem", "link": "https://stackoverflow.com/users/1478380/oem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 41382879, "answer_count": 2, "score": 1, "last_activity_date": 1483026215, "creation_date": 1483010101, "question_id": 41378605, "link": "https://stackoverflow.com/questions/41378605/content-length-is-zero-when-http-posting-a-local-file-by-passing-the-io-reader", "title": "Content-Length is zero when (HTTP) POSTing a local file by passing the io.Reader from os.Open to http.Post", "body": "<p>heya everyone: Got a short question, I would like to post(http) a file. I figured, since os.Open returns an io.Reader and http.Post takes an io.Reader I do not have read the file into memory in a separate step and can just pass around the Reader.\nHowever, the Content-Length will be set to zero- which kinda makes sense but is not what I need.</p>\n\n<pre><code>file, _ := os.Open(\"some file\")\nreq, _ := http.NewRequest(\"POST\", \"some url\", file)\ndump, _ := httputil.DumpRequestOut(req, false)\nfmt.Println(string(dump))\n</code></pre>\n\n<p><strong>My question:</strong> Do i have to read the file into memory (with ioutil.ReadFile or some such) and make a new reader or is there a way to pass the reader from the file directly to the Post request without the \"Reading\" step?</p>\n\n<p>I guess I could set the Content-Length by getting it via file.Stat, but I was wondering if there is a more elegant way of doing this?</p>\n"}, {"tags": ["api", "security", "go", "web-applications", "key"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1483063389, "post_id": 41377338, "comment_id": 69981671, "body": "this looks good for you <a href=\"https://www.vaultproject.io/\" rel=\"nofollow noreferrer\">vaultproject.io</a>"}], "answers": [{"tags": [], "owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "is_accepted": false, "score": 1, "last_activity_date": 1483006083, "creation_date": 1483006083, "answer_id": 41377425, "question_id": 41377338, "link": "https://stackoverflow.com/questions/41377338/where-to-keep-private-keys-and-credentials-for-a-web-app/41377425#41377425", "title": "Where to keep private keys and credentials for a web app?", "body": "<p>I think you should, as you said, use configuration files. And maybe encrypt it ?</p>\n"}, {"comments": [{"owner": {"reputation": 775, "user_id": 1544440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75da798fa2e162ff6eab82bc51a2d3a3?s=128&d=identicon&r=PG", "display_name": "Omar Bahareth", "link": "https://stackoverflow.com/users/1544440/omar-bahareth"}, "edited": false, "score": 0, "creation_date": 1483009561, "post_id": 41378394, "comment_id": 69958494, "body": "Definitely use environment variables and as @old_mountain said, make sure they&#39;re never included in your version control systems."}], "tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": false, "score": 2, "last_activity_date": 1483009393, "creation_date": 1483009393, "answer_id": 41378394, "question_id": 41377338, "link": "https://stackoverflow.com/questions/41377338/where-to-keep-private-keys-and-credentials-for-a-web-app/41378394#41378394", "title": "Where to keep private keys and credentials for a web app?", "body": "<p>I would go with <a href=\"http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-environment\" rel=\"nofollow noreferrer\">user environment variables</a>, as it is recommended by both <a href=\"https://support.google.com/cloud/answer/6310037?hl=en&amp;ref_topic=6262490\" rel=\"nofollow noreferrer\">google</a> and <a href=\"http://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html\" rel=\"nofollow noreferrer\">amazon</a>.</p>\n\n<p>If you go for storing in plain text files, remember to not keep them in your app's source tree (if you use some version control, you may end up exposing them to public).</p>\n\n<p>Also, remember to regenerate your keys periodically.</p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1483059134, "creation_date": 1483059134, "answer_id": 41389230, "question_id": 41377338, "link": "https://stackoverflow.com/questions/41377338/where-to-keep-private-keys-and-credentials-for-a-web-app/41389230#41389230", "title": "Where to keep private keys and credentials for a web app?", "body": "<p>If you have lots of keys to manage, environment variables get clumsy. A hybrid approach works for me: encrypt the secrets and put them all in config (typically as base64). Use the <em>same</em> encryption key for all of them, and pass it in as an environment variable.</p>\n\n<p>So you only need to make one environment variable to secure as many other secrets as you need.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1483059134, "creation_date": 1483005773, "question_id": 41377338, "link": "https://stackoverflow.com/questions/41377338/where-to-keep-private-keys-and-credentials-for-a-web-app", "title": "Where to keep private keys and credentials for a web app?", "body": "<p>I have a webapp that uses keys and credentials to call API endpoints from external services like payment gateways, database providers, and such.</p>\n\n<p>I have these options in mind to keep these values:</p>\n\n<ol>\n<li>Set environmental variables before app start and load them when the app runs. If required values are not available, e.g. not set, exit the app.</li>\n<li>On app start, ask user (myself or an administrator) to enter the credentials. If required fields are empty, exit, otherwise continue loading the app.</li>\n<li>Keep them in a config file as plain values. This is the least preferable way as to me.</li>\n</ol>\n\n<p>Which of these should I use if I want to keep keys as safe and secure as possible?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1483008958, "post_id": 41377308, "comment_id": 69958207, "body": "For ambiguous fields you&#39;re best annotating them with a prefix of their struct name, e.g. <code>product_name</code>, <code>stock_name</code>, then alias them appropriately in your SQL statement."}, {"owner": {"reputation": 253, "user_id": 7177729, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mA9oA1YPkkE/AAAAAAAAAAI/AAAAAAAACl4/mzf-itgXvcU/photo.jpg?sz=128", "display_name": "Preethi Rajaraman", "link": "https://stackoverflow.com/users/7177729/preethi-rajaraman"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1483011389, "post_id": 41377308, "comment_id": 69959502, "body": "Thanks Martin.It worked fine:)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1483017500, "post_id": 41377308, "comment_id": 69962836, "body": "@MartinGallagher Post that as an answer."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1483017787, "post_id": 41377308, "comment_id": 69963003, "body": "No problem - done!"}], "answers": [{"tags": [], "owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "is_accepted": false, "score": 2, "last_activity_date": 1483017748, "creation_date": 1483017748, "answer_id": 41380647, "question_id": 41377308, "link": "https://stackoverflow.com/questions/41377308/golang-sqlx-structscan-mapping-db-column-to-struct/41380647#41380647", "title": "Golang: sqlx StructScan mapping db column to struct", "body": "<p>For ambiguous fields you're best annotating them with a prefix of their struct name, e.g. <code>product_name</code>, <code>stock_name</code>, then alias them appropriately in your SQL statement.</p>\n\n<p>I.e.\n</p>\n\n<pre><code>type Detail struct {\n Product\n Stocks\n}\n\ntype Product struct {\n Name        string         `db:\"product_name\"`\n Id          int            `db:\"id\"`\n}\n\ntype  Stocks { \n Name        string         `db:\"stock_name\"`\n Price       float          `db:\"price\"`\n Type        string         `db:\"type\"`\n}\n</code></pre>\n\n<p>And in your SQL:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT p.name AS product_name, s.name AS stock_name, ... FROM Product p, Stocks s WHERE ...\n</code></pre>\n"}], "owner": {"reputation": 253, "user_id": 7177729, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mA9oA1YPkkE/AAAAAAAAAAI/AAAAAAAACl4/mzf-itgXvcU/photo.jpg?sz=128", "display_name": "Preethi Rajaraman", "link": "https://stackoverflow.com/users/7177729/preethi-rajaraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3755, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1483017748, "creation_date": 1483005646, "question_id": 41377308, "link": "https://stackoverflow.com/questions/41377308/golang-sqlx-structscan-mapping-db-column-to-struct", "title": "Golang: sqlx StructScan mapping db column to struct", "body": "<p>i have my model struct like the below :</p>\n\n<pre><code>type Detail struct {\n Product\n Stocks\n}\ntype Product struct {\n Name        string         `db:\"name\"`\n Id          int            `db:\"id\"`\n}\ntype  Stocks { \n Name        string         `db:\"name\"`\n Price       float          `db:\"price\"`\n Type        string         `db:\"type\"`\n}\n</code></pre>\n\n<p>i would have a query to join the above tables like the below : </p>\n\n<pre><code>query, args, err := sqlx.In(\"select p.name , s.price from Product   p,Stocks s where p.name=s.name and type IN (?)\",typecodes)\nquery = s.Cmd.Db.Rebind(query)\nvar rows *sqlx.Rows\nrows, err = s.Cmd.Db.Queryx(query, args...)\n\nfor rows.Next() {\n          var p model.Detail\n          err = rows.StructScan(&amp;p)\n}\n</code></pre>\n\n<p>Would like to know when i do <strong>rows.StructScan(&amp;p)</strong> will the Product structure Name field be populated or will there be any ambuigity found for the same since Stocks also have a Name field ?</p>\n\n<p>Currently i am not getting any result for the above.But when i comment the Name field in the Stocks struct, i am getting the data.</p>\n\n<p>Let me know what i am missing here.</p>\n"}, {"tags": ["go", "deployment"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1483001965, "post_id": 41376092, "comment_id": 69954157, "body": "This may be of help -- <a href=\"https://github.com/jpillora/overseer\" rel=\"nofollow noreferrer\">github.com/jpillora/overseer</a>"}, {"owner": {"reputation": 14380, "user_id": 31818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3487ce6ed9ec277bac79a838537b46a8?s=128&d=identicon&r=PG", "display_name": "seh", "link": "https://stackoverflow.com/users/31818/seh"}, "edited": false, "score": 0, "creation_date": 1483025840, "post_id": 41376092, "comment_id": 69967478, "body": "This question doesn&#39;t have anything to do with Go."}, {"owner": {"reputation": 1908, "user_id": 1269969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3f07b9d9aa93f0d0750ea5f462db0fed?s=128&d=identicon&r=PG", "display_name": "placeybordeaux", "link": "https://stackoverflow.com/users/1269969/placeybordeaux"}, "edited": false, "score": 0, "creation_date": 1483037562, "post_id": 41376092, "comment_id": 69973319, "body": "If you are executing scp, why not change it to <code>scp binary server:&#47;bin &amp;&amp; ssh server restart-server.sh</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 965724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5395c41b2ec6b180a1e28193596b9f49?s=128&d=identicon&r=PG", "display_name": "mlg", "link": "https://stackoverflow.com/users/965724/mlg"}, "is_accepted": false, "score": 2, "last_activity_date": 1483003203, "creation_date": 1483003203, "answer_id": 41376593, "question_id": 41376092, "link": "https://stackoverflow.com/questions/41376092/golang-how-to-auto-restart-process-when-binary-updated/41376593#41376593", "title": "Golang: How to auto-restart process when binary updated?", "body": "<p>Does it need to be sophisticated? You could have <code>entr</code> running and trigger an updater script when the binary changes.</p>\n\n<p><a href=\"http://entrproject.org/\" rel=\"nofollow noreferrer\">http://entrproject.org/</a></p>\n\n<p>e.g.</p>\n\n<pre><code>echo 'binary_path' | entr script.sh &amp;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 6, "last_activity_date": 1483031895, "last_edit_date": 1483031895, "creation_date": 1483031554, "answer_id": 41384244, "question_id": 41376092, "link": "https://stackoverflow.com/questions/41376092/golang-how-to-auto-restart-process-when-binary-updated/41384244#41384244", "title": "Golang: How to auto-restart process when binary updated?", "body": "<p>While this is generally better to be implemented off-process using something like daemontools or similar, there are some cases when you want/need it to be done inside your program.</p>\n\n<p>Doing it inside your program can be tricky depending on the program characteristics such as connections or files it may have open, etc.</p>\n\n<p>Having said that, here you have an implementation which would work in most cases:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"syscall\"\n    \"time\"\n\n    \"github.com/fsnotify/fsnotify\"\n    \"github.com/kardianos/osext\"\n)\n\nfunc setupWatcher() (chan struct{}, error) {\n    file, err := osext.Executable()\n    if err != nil {\n        return nil, err\n    }\n    log.Printf(\"watching %q\\n\", file)\n    w, err := fsnotify.NewWatcher()\n    if err != nil {\n        return nil, err\n    }\n    done := make(chan struct{})\n    go func() {\n        for {\n            select {\n            case e := &lt;-w.Events:\n                log.Printf(\"watcher received: %+v\", e)\n                err := syscall.Exec(file, os.Args, os.Environ())\n                if err != nil {\n                    log.Fatal(err)\n                }\n            case err := &lt;-w.Errors:\n                log.Printf(\"watcher error: %+v\", err)\n            case &lt;-done:\n                log.Print(\"watcher shutting down\")\n                return\n            }\n        }\n    }()\n    err = w.Add(file)\n    if err != nil {\n        return nil, err\n    }\n    return done, nil\n}\n\nfunc main() {\n    log.Print(\"program starting\")\n    watcher, err := setupWatcher()\n    if err != nil {\n        // do something sensible\n        log.Fatal(err)\n    }\n    // continue with app startup\n    time.Sleep(100 * time.Minute) // just for testing\n    // eventually you may need to end the watcher\n    close(watcher) // this way you can\n}\n</code></pre>\n\n<p>Then you do</p>\n\n<pre><code>% go build main.go     \n% ./main\n2016/12/29 14:15:06 program starting\n2016/12/29 14:15:06 watching \"/home/plalloni/tmp/v/main\"\n</code></pre>\n\n<p>And here the output it produced after you run (in other terminal)  some successive \"go build main.go\" (which \"updates\" the running binary).</p>\n\n<pre><code>2016/12/29 14:15:32 watcher received: \"/home/plalloni/tmp/v/main\": CHMOD\n2016/12/29 14:15:32 program starting\n2016/12/29 14:15:32 watching \"/home/plalloni/tmp/v/main\"\n2016/12/29 14:15:38 watcher received: \"/home/plalloni/tmp/v/main\": CHMOD\n2016/12/29 14:15:38 program starting\n2016/12/29 14:15:38 watching \"/home/plalloni/tmp/v/main\"\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 7358439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5wTjy.jpg?s=128&g=1", "display_name": "user7358439", "link": "https://stackoverflow.com/users/7358439/user7358439"}, "is_accepted": false, "score": 1, "last_activity_date": 1483119661, "last_edit_date": 1483119661, "creation_date": 1483114979, "answer_id": 41399366, "question_id": 41376092, "link": "https://stackoverflow.com/questions/41376092/golang-how-to-auto-restart-process-when-binary-updated/41399366#41399366", "title": "Golang: How to auto-restart process when binary updated?", "body": "<p>I have a resolution about this case.</p>\n\n<p>See also.\n<a href=\"https://github.com/narita-takeru/cmdrevive\" rel=\"nofollow noreferrer\">https://github.com/narita-takeru/cmdrevive</a></p>\n\n<p>example</p>\n\n<pre><code>cmdrevive ./htmls/ \".html$\" (application) (arguments)\n</code></pre>\n\n<p>So, this case applicable.</p>\n\n<pre><code>cmdrevive \"/(app path)\" \"(app filename)\" (app full path) (arguments)\n</code></pre>\n\n<p>If (app filename) changed on (app path) directory, then restart (app full path) with (arguments).</p>\n\n<p>How about this one?</p>\n"}, {"tags": [], "owner": {"reputation": 447, "user_id": 154386, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/30aYr.jpg?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/154386/vlad"}, "is_accepted": false, "score": 3, "last_activity_date": 1572388602, "creation_date": 1572388602, "answer_id": 58616318, "question_id": 41376092, "link": "https://stackoverflow.com/questions/41376092/golang-how-to-auto-restart-process-when-binary-updated/58616318#58616318", "title": "Golang: How to auto-restart process when binary updated?", "body": "<p>You can use <a href=\"https://github.com/slayer/autorestart\" rel=\"nofollow noreferrer\">https://github.com/slayer/autorestart</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"github.com/slayer/autorestart\"\n\nfunc main() {\n    autorestart.StartWatcher()\n    http.ListenAndServe(\":8080\", nil) // for example\n}\n\n</code></pre>\n"}], "owner": {"reputation": 15493, "user_id": 380774, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3772ea86cd39ce7e63280ecfffb6512c?s=128&d=identicon&r=PG", "display_name": "fannheyward", "link": "https://stackoverflow.com/users/380774/fannheyward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6854, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1572388602, "creation_date": 1483001343, "question_id": 41376092, "link": "https://stackoverflow.com/questions/41376092/golang-how-to-auto-restart-process-when-binary-updated", "title": "Golang: How to auto-restart process when binary updated?", "body": "<p>I built the golang app in local, then <code>scp</code> to server. I need to stop the process and restart manually. Is there any way to auto-restart the process when binary updated?</p>\n"}, {"tags": ["authentication", "go", "firebase", "oauth", "firebase-authentication"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1483000200, "post_id": 41375810, "comment_id": 69953223, "body": "I used <a href=\"https://github.com/zabawaba99/fireauth/issues/9\" rel=\"nofollow noreferrer\">github.com/zabawaba99/fireauth/issues/9</a> to write the JWT code but it didn&#39;t quite work for me."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1483025741, "post_id": 41375810, "comment_id": 69967418, "body": "godoc.org/github.com/dgrijalva/jwt-go#example-New--Hmac I have had this issue for the whole day. I am trying to use the exact code in the link, but what do I use for the hmacSampleSecret? It&#39;s been puzzling me for so long."}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 641, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1483000105, "creation_date": 1483000105, "question_id": 41375810, "link": "https://stackoverflow.com/questions/41375810/authenticate-steam-oauth-with-firebase-golang", "title": "Authenticate Steam OAuth with Firebase | Golang", "body": "<p>I am developing a website in Golang and need to authenticate each user so only they can read their own firebase user information.</p>\n\n<p>I'm using Firebase V3 and the <a href=\"https://github.com/zabawaba99/firego/\" rel=\"nofollow noreferrer\" title=\"FireGo Github\">firego</a> package for golang. I've tried using the <a href=\"https://github.com/zabawaba99/fireauth/\" rel=\"nofollow noreferrer\" title=\"Fireauth Github\">fireauth</a> package to authenticate a user with a generated token, but this package only supports Firebase V2.</p>\n\n<p>How can I authenticate my users with Firebase 3 when they login through <a href=\"https://steamcommunity.com/dev/\" rel=\"nofollow noreferrer\" title=\"Steam OAuth Documentation\">Steam's OAuth/OpenID</a> on my website in Golang?</p>\n\n<hr>\n\n<p>I've tried using the <a href=\"https://github.com/dgrijalva/jwt-go/\" rel=\"nofollow noreferrer\" title=\"Jwt-go Github\">JWT</a> package for Golang to generate a token then send it to the user to use <code>firebase.auth().signInWithCustomToken(token)</code> to authenticate but I didn't manage to generate the token.</p>\n\n<p>Here is the code I used to generate with JWT:</p>\n\n<pre><code>jwtToken := jwt.NewWithClaims(jwt.SigningMethodHS256, jwt.MapClaims{\n    \"uid\": \"172346362\",\n})\n\nsignKey, err := jwt.ParseRSAPrivateKeyFromPEM([]byte(`I don't know what to put here,\n                                                      I tried a number of things including\n                                                      randomly generated private RSA keys`))\nif err != nil {\n    log.Fatal(err)\n}\n\ntoken, err := jwtToken.SignedString(signKey)\nif err != nil {\n    log.Fatal(err)\n}\n\ntmpl, err := template.ParseFiles(\"index.html\")\nif err != nil {\n    log.Fatal(err)\n}\n\nif err := tmpl.Execute(w, token); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>I recieve the following error message when using this code:</p>\n\n<pre><code>Invalid Key: Key must be PEM encoded PKCS1 or PKCS8 private key\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user849425"}, "edited": false, "score": 1, "creation_date": 1483000700, "post_id": 41375797, "comment_id": 69953472, "body": "There&#39;s not a lot of information to go on here, but if I understand correctly you should be able to just call the function and pass it your two arguments. <a href=\"https://play.golang.org/p/ZUPbJYYCt7\" rel=\"nofollow noreferrer\">play.golang.org/p/ZUPbJYYCt7</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user849425"}, "edited": false, "score": 1, "creation_date": 1483000869, "post_id": 41375797, "comment_id": 69953554, "body": "Actually my comment above may not work in your specific case. The issue is that you&#39;ve named the function starting with a lowercase letter which in Go means that it&#39;s a private function and is only available within its own package. You should start any publicly accessible functions (any functions that will be invoked outside of the current package) with a capital letter - for example: <code>SomeFunc</code>"}, {"owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "edited": false, "score": 0, "creation_date": 1483003180, "post_id": 41375797, "comment_id": 69954870, "body": "@Mike thanks , but your code is taking the interface array as a single interface in the SomeFunc method <a href=\"https://play.golang.org/p/9dK4QjmW0U\" rel=\"nofollow noreferrer\">play.golang.org/p/9dK4QjmW0U</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user849425"}, "edited": false, "score": 0, "creation_date": 1483003202, "post_id": 41375797, "comment_id": 69954884, "body": "Variadic arguments are collapsed into a single array of values regardless of how many arguments are passed. Here&#39;s another example which passes two separate values. <a href=\"https://play.golang.org/p/vvsfgSAk57\" rel=\"nofollow noreferrer\">play.golang.org/p/vvsfgSAk57</a> I added the <code>#</code> formatter to show the Golang representation of the object. You can index into the argument array as you would any other array, for example <code>args[0]</code> extracts the first value."}, {"owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "edited": false, "score": 0, "creation_date": 1483003659, "post_id": 41375797, "comment_id": 69955149, "body": "Yes that is the issue I am facing"}, {"owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "edited": false, "score": 0, "creation_date": 1483003770, "post_id": 41375797, "comment_id": 69955206, "body": "@Mike invoking like this solved the problem SomeFunc(a, b...)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user849425"}, "edited": false, "score": 1, "creation_date": 1483003897, "post_id": 41375797, "comment_id": 69955269, "body": "Glad you found something that worked for you. :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1483018118, "post_id": 41375797, "comment_id": 69963179, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/39914447/unpacking-slice-of-slices/39915311#39915311\">Unpacking slice of slices</a>; and <a href=\"http://stackoverflow.com/questions/36125024/golang-join-array-interface/36125119#36125119\">Golang Join array interface</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "is_accepted": true, "score": 2, "last_activity_date": 1484679776, "last_edit_date": 1495540897, "creation_date": 1483005440, "answer_id": 41377244, "question_id": 41375797, "link": "https://stackoverflow.com/questions/41375797/how-to-invoke-methods-with-variant-interface-when-you-have-array-of-interface/41377244#41377244", "title": "How to invoke methods with variant interface when you have array of interface?", "body": "<pre><code>func main() {\n    b := []interface{}{\"hello\", \"Hi\"}\n    SomeFunc(b...) \n}\n</code></pre>\n\n<p>Solved the issue by using <code>...</code> after b array. <BR><BR>For more details plz see <a href=\"https://stackoverflow.com/questions/39914447/unpacking-slice-of-slices/39915311#39915311\">Unpacking slice of slices</a> and <a href=\"https://stackoverflow.com/questions/36125024/golang-join-array-interface/36125119#36125119\">Golang Join array interface</a></p>\n"}], "owner": {"reputation": 1230, "user_id": 3651739, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/D0irV.gif?s=128&g=1", "display_name": "Jishnu Prathap", "link": "https://stackoverflow.com/users/3651739/jishnu-prathap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 41377244, "answer_count": 1, "score": 0, "last_activity_date": 1485357127, "creation_date": 1483000069, "last_edit_date": 1485357127, "question_id": 41375797, "link": "https://stackoverflow.com/questions/41375797/how-to-invoke-methods-with-variant-interface-when-you-have-array-of-interface", "title": "How to invoke methods with variant interface when you have array of interface?", "body": "<p>how to invoke a method with below signature</p>\n\n<pre><code>SomeFunc( args ...interface{})\n</code></pre>\n\n<p>with variable of type <code>[]interface{}</code> Is it possible to invoke the above method? If yes how?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["java", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user849425"}, "edited": false, "score": 0, "creation_date": 1483001574, "post_id": 41375662, "comment_id": 69953955, "body": "Why are you trying to ignore the Content-Type? Is the Content-Type causing you an issue in code? And if yes, what is the error you&#39;re getting?"}, {"owner": {"reputation": 17, "user_id": 1731093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4yeB.jpg?s=128&g=1", "display_name": "henghanan", "link": "https://stackoverflow.com/users/1731093/henghanan"}, "edited": false, "score": 0, "creation_date": 1483431457, "post_id": 41375662, "comment_id": 70084298, "body": "nothing error returns, i will post another comment to explain."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483023165, "post_id": 41376212, "comment_id": 69965936, "body": "You can also just set the Content-Type header -- the go http server won&#39;t try to detect and overwrite it if it&#39;s there already."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483023734, "post_id": 41376212, "comment_id": 69966266, "body": "@JimB I would have thought the go http server could make its own Response, with its own header depending on how said http server is implemented."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483025348, "post_id": 41376212, "comment_id": 69967195, "body": "I&#39;m not sure I follow, but the headers set in the <code>ReponseWriter</code> take precedence up until <code>WriteHeader</code> is called. If you look for <code>DetectContentType</code> in the server.go source, you can see that it first checks if the <code>Content-Type</code> header has been set."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1483025446, "post_id": 41376212, "comment_id": 69967252, "body": "@JimB OK. I see now."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1483025763, "last_edit_date": 1495539952, "creation_date": 1483001800, "answer_id": 41376212, "question_id": 41375662, "link": "https://stackoverflow.com/questions/41375662/how-to-ignore-content-type-with-golang/41376212#41376212", "title": "how to ignore content type with golang?", "body": "<p>Java <a href=\"https://jsoup.org/apidocs/org/jsoup/Connection.html#ignoreContentType-boolean-\" rel=\"nofollow noreferrer\">jsoup <code>ignoreContentType</code></a> is there to ignore the document's <code>Content-Type</code> when parsing the response.</p>\n\n<p>The <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow noreferrer\"><code>ResponseWriter</code></a> in Go will by default adds a Content-Type set to the result of passing the initial 512 bytes of written data to <code>DetectContentType</code>.</p>\n\n<p>You can implement your own <code>ResponseWriter</code> where you set your own <code>Content-Type</code> to <code>\"\"</code> in order to ignore any (possibly incorrect) content type deduced from the Response's data.</p>\n\n<pre><code>func (writer MyOwnResponseWriter) Write(data []byte) (int, error) {\n    writer.Header().Set(\"Content-Type\", \"\")\n    return len(data), nil\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/users/32880/jimb\">JimB</a> suggests <a href=\"https://stackoverflow.com/questions/41375662/how-to-ignore-content-type-with-golang/41376212?noredirect=1#comment69967195_41376212\">in the comments</a> to simply set your own Content-Type, as <a href=\"https://github.com/golang/go/blob/9719ca9c0e6fdda273cd178e6cce6b88d738518e/src/net/http/server.go#L115-L119\" rel=\"nofollow noreferrer\"><code>server.go</code></a> includes:</p>\n\n<pre><code>//If the Header does not contain a Content-Type line, \n// Write adds a Content-Type set to the result of \n// passing the initial 512 bytes of written data toDetectContentType.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 1731093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4yeB.jpg?s=128&g=1", "display_name": "henghanan", "link": "https://stackoverflow.com/users/1731093/henghanan"}, "is_accepted": true, "score": 0, "last_activity_date": 1483431919, "creation_date": 1483431919, "answer_id": 41439226, "question_id": 41375662, "link": "https://stackoverflow.com/questions/41375662/how-to-ignore-content-type-with-golang/41439226#41439226", "title": "how to ignore content type with golang?", "body": "<p>I have solved my problem after read Jsoup's source code, just set the response header</p>\n\n<pre><code>resp.Header.Set(\"Transfer-Encoding\", \"chunked\")\nresp.Header.Set(\"Content-Type\", \"application/json\")\n</code></pre>\n\n<p>thanks you guys.</p>\n"}], "owner": {"reputation": 17, "user_id": 1731093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4yeB.jpg?s=128&g=1", "display_name": "henghanan", "link": "https://stackoverflow.com/users/1731093/henghanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 1, "accepted_answer_id": 41439226, "answer_count": 2, "score": -1, "last_activity_date": 1483431919, "creation_date": 1482999407, "question_id": 41375662, "link": "https://stackoverflow.com/questions/41375662/how-to-ignore-content-type-with-golang", "title": "how to ignore content type with golang?", "body": "<p>can somebody tell me how to ignore content type with go? I can invoke ignoreContentType method in Jsoup with java, but i can't find any method in go can do like that. Hope someone will tell me, thanks.</p>\n\n<pre><code>Connection.Response response = Jsoup.connect(\"http://example.com/\")\n            .ignoreContentType(true)\n            .execute();\nSystem.out.println(response.body());\n</code></pre>\n"}, {"tags": ["go", "go-gin", "gorp"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1483076760, "post_id": 41375563, "comment_id": 69984513, "body": "Looks like the selected &#39;skills&#39; column isn&#39;t being converted to a []string. What&#39;s the data type of employee.skills in the database? May need to change to []byte or string as the type for skills in your Employee struct."}, {"owner": {"reputation": 1461, "user_id": 2059047, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5e1327cb46137894ca902795db2111ac?s=128&d=identicon&r=PG", "display_name": "Prashant4224", "link": "https://stackoverflow.com/users/2059047/prashant4224"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1483077899, "post_id": 41375563, "comment_id": 69984803, "body": "In database <code>Skills</code> is <code>varchar(255)</code> type. @Mark"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1483085617, "post_id": 41375563, "comment_id": 69987600, "body": "Change Employee.Skills from []string to string"}, {"owner": {"reputation": 1461, "user_id": 2059047, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5e1327cb46137894ca902795db2111ac?s=128&d=identicon&r=PG", "display_name": "Prashant4224", "link": "https://stackoverflow.com/users/2059047/prashant4224"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1483091166, "post_id": 41375563, "comment_id": 69989798, "body": "<code>Skills</code> is repeatable field, so selected []string(slice).My sample JSON for <code>POST</code> is <code>curl -i -X POST -H &quot;Content-Type: application&#47;json&quot; -d &quot;{ \\&quot;firstname\\&quot;: \\&quot;Thea\\&quot;, \\&quot;lastname\\&quot;: \\&quot;Queen\\&quot;, \\&quot;dob\\&quot;: \\&quot;2014-10-19T23:08:24Z\\&quot;, \\&quot;skills\\&quot;: [\\&quot;Go\\&quot;, \\&quot;C\\&quot;,\\&quot;Ruby\\&quot;] }&quot; http:&#47;&#47;localhost:9090&#47;api&#47;v1&#47;emps</code>"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1483140904, "post_id": 41375563, "comment_id": 70010620, "body": "The code is inserting skills as a single string (by marshalling skills as json), so I think you&#39;ll have to select it out into a single string. I doubt gorp will convert a varchar(255) to a slice of strings."}], "answers": [{"comments": [{"owner": {"reputation": 334, "user_id": 4734545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53bb2d9115bd7432d570df349d90c40f?s=128&d=identicon&r=PG&f=1", "display_name": "setiabb", "link": "https://stackoverflow.com/users/4734545/setiabb"}, "edited": false, "score": 0, "creation_date": 1599340620, "post_id": 61446390, "comment_id": 112746693, "body": "Thanks for your excellent answer, I tested the first approach with gorp and I found a mistake in your solution, For the value method, the marshaling on an array that has some elements returns an error, the last line of the Value method should be like this:      <code>return fmt.Sprintf(`[&quot;%s&quot;]`, strings.Join(s, `&quot;,&quot;`)), nil</code>"}], "tags": [], "owner": {"reputation": 1114, "user_id": 8190553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6OTwb.png?s=128&g=1", "display_name": "will7200", "link": "https://stackoverflow.com/users/8190553/will7200"}, "is_accepted": false, "score": 7, "last_activity_date": 1599437161, "last_edit_date": 1599437161, "creation_date": 1587927513, "answer_id": 61446390, "question_id": 41375563, "link": "https://stackoverflow.com/questions/41375563/unsupported-scan-storing-driver-value-type-uint8-into-type-string/61446390#61446390", "title": "unsupported Scan, storing driver.Value type []uint8 into type *[]string", "body": "<p>Two Approaches:<br />\n<strong>1. Implement sql.Scanner and driver.Valuer interfaces for a custom type</strong><br />\nBenefits:</p>\n<ul>\n<li>Simple to store and retrieve</li>\n<li>Don't have to query/load from another table</li>\n</ul>\n<p>Caveats:</p>\n<ul>\n<li>String Size Is Limited by sql column definition (i.e. in this case its 255).\nDepending on your database architecture this will either be truncated or will result in an error that needs handling.</li>\n<li>Jump through hoops to delete specific skills for someone/everyone at the database level.</li>\n<li>Searching needs to be done through contains instead of equal operator</li>\n<li>Modifying the skills structure will be difficult in the future.</li>\n</ul>\n<pre class=\"lang-golang prettyprint-override\"><code>package tgorm\n\nimport (\n    &quot;database/sql/driver&quot;\n    &quot;encoding/json&quot;\n    &quot;errors&quot;\n    &quot;fmt&quot;\n    &quot;github.com/jinzhu/gorm&quot;\n    _ &quot;github.com/jinzhu/gorm/dialects/sqlite&quot;\n    &quot;github.com/stretchr/testify/assert&quot;\n    &quot;strings&quot;\n    &quot;testing&quot;\n    &quot;time&quot;\n)\n\ntype Skills []string\n\nfunc (s Skills) Value() (driver.Value, error) {\n    if len(s) == 0 {\n        return &quot;[]&quot;, nil\n    }\n    return fmt.Sprintf(`[&quot;%s&quot;]`, strings.Join(s, `&quot;,&quot;`)), nil\n}\n\nfunc (s *Skills) Scan(src interface{}) (err error) {\n    var skills []string\n    switch src.(type) {\n    case string:\n        err = json.Unmarshal([]byte(src.(string)), &amp;skills)\n    case []byte:\n        err = json.Unmarshal(src.([]byte), &amp;skills)\n    default:\n        return errors.New(&quot;Incompatible type for Skills&quot;)\n    }\n    if err != nil {\n        return\n    }\n    *s = skills\n    return nil\n}\n\ntype Employee struct {\n    Id        int64     `db:&quot;id&quot; json:&quot;id&quot;`\n    Firstname string    `db:&quot;firstname&quot; json:&quot;firstname&quot;`\n    Lastname  string    `db:&quot;lastname&quot; json:&quot;lastname&quot;`\n    Dob       time.Time `db:&quot;dob&quot; json:&quot;dob&quot;`\n    Skills    Skills    `gorm:&quot;type:varchar(255);&quot; db:&quot;skills&quot; json:&quot;skills&quot;`\n}\n\nfunc (e Employee) TableName() string {\n    return &quot;employee&quot;\n}\n\n\nfunc getMemoryDataBase() *gorm.DB {\n    db, err := gorm.Open(&quot;sqlite3&quot;, &quot;:memory:&quot;)\n    if err != nil {\n        panic(err)\n    }\n    db = db.Debug()\n    db.AutoMigrate(Employee{})\n    return db\n}\n\nfunc TestSaveEmployee(t *testing.T) {\n    db := getMemoryDataBase()\n    emp := Employee{\n        Id:        1,\n        Firstname: &quot;Fake&quot;,\n        Lastname:  &quot;Emp&quot;,\n        Dob:       time.Time{},\n        Skills:    []string{&quot;C#&quot;, &quot;GO&quot;, &quot;C++&quot;},\n    }\n    skills, _ := json.Marshal(emp.Skills)\n    err := db.Exec(`INSERT INTO employee (firstname, lastname, dob, skills) VALUES (?, ?, ?, ?)`, emp.Firstname, emp.Lastname, emp.Dob, skills).Error\n    assert.Nil(t, err)\n    var emps []Employee\n    err = db.Raw(&quot;SELECT * FROM employee&quot;).Scan(&amp;emps).Error\n    assert.Nil(t, err)\n    assert.Equal(t, []Employee{emp}, emps)\n}\n\n</code></pre>\n<p><strong>2. Move Skills into a separate table, with a reference to the employee.</strong></p>\n<p>Benefits:</p>\n<ul>\n<li>Extend Table Definition</li>\n<li>Better searching capabilities</li>\n<li>Easier to drop skills for someone/everyone at the database level</li>\n</ul>\n<p>Caveats:</p>\n<ul>\n<li>Needs another query/load for Skills</li>\n<li>Increased Database Schema Definition</li>\n</ul>\n<pre class=\"lang-golang prettyprint-override\"><code>package subgrom\n\nimport (\n    &quot;github.com/jinzhu/gorm&quot;\n    _ &quot;github.com/jinzhu/gorm/dialects/sqlite&quot;\n    &quot;github.com/stretchr/testify/assert&quot;\n    &quot;testing&quot;\n    &quot;time&quot;\n)\n\ntype Skill struct {\n    Id          int64  `db:&quot;id&quot; json:&quot;id&quot;`\n    Skill       string `db:&quot;skill&quot; json:&quot;skill&quot;`\n    EmployeeRef int64\n}\n\ntype Employee struct {\n    Id        int64     `db:&quot;id&quot; json:&quot;id&quot;`\n    Firstname string    `db:&quot;firstname&quot; json:&quot;firstname&quot;`\n    Lastname  string    `db:&quot;lastname&quot; json:&quot;lastname&quot;`\n    Dob       time.Time `db:&quot;dob&quot; json:&quot;dob&quot;`\n    Skills    []Skill   `db:&quot;skills&quot; json:&quot;skills&quot; gorm:&quot;foreignkey:EmployeeRef&quot;`\n}\n\nfunc (e Employee) TableName() string {\n    return &quot;employee&quot;\n}\n\nfunc getMemoryDataBase() *gorm.DB {\n    db, err := gorm.Open(&quot;sqlite3&quot;, &quot;:memory:&quot;)\n    if err != nil {\n        panic(err)\n    }\n    db = db.Debug()\n    db.AutoMigrate(Employee{}, Skill{})\n    return db\n}\n\nfunc TestSaveEmployee(t *testing.T) {\n    db := getMemoryDataBase()\n    emp := Employee{\n        Id:        1,\n        Firstname: &quot;Fake&quot;,\n        Lastname:  &quot;Emp&quot;,\n        Dob:       time.Time{},\n        Skills:    []Skill{{Skill: &quot;C#&quot;}, {Skill: &quot;GO&quot;}, {Skill: &quot;C++&quot;}},\n    }\n    err := db.Create(&amp;emp).Error\n    assert.Nil(t, err)\n    var emps []Employee\n    err = db.Preload(&quot;Skills&quot;).Find(&amp;emps).Error\n    assert.Nil(t, err)\n    assert.Equal(t, []Employee{emp}, emps)\n}\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 908, "user_id": 3649496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c95010d46812ccabe7eea947a090ab?s=128&d=identicon&r=PG&f=1", "display_name": "infiniteLearner", "link": "https://stackoverflow.com/users/3649496/infinitelearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1611809259, "creation_date": 1611809259, "answer_id": 65931169, "question_id": 41375563, "link": "https://stackoverflow.com/questions/41375563/unsupported-scan-storing-driver-value-type-uint8-into-type-string/65931169#65931169", "title": "unsupported Scan, storing driver.Value type []uint8 into type *[]string", "body": "<p>Faced similar issue, for me problem was sequencing of field &quot;scope_t&quot;.</p>\n<pre><code>selectGroup = `SELECT \nid,\nname,\nfully_qualified_name,\nparent_id,\nscopes,\nscope_t\nFROM groups `\n</code></pre>\n<p>When inserting the data I placed &quot;scope_t&quot; at a random place so SQL return with the error mentioned above reason being that position was mapped with a different data type.</p>\n<pre><code>if err := r.db.QueryRowContext(ctx, createGroup, group.Name, group.FullyQualifiedName,\n    pq.Array(group.Scopes), group.ParentID, userID, scope_type).Scan(&amp;id); err != nil {\n    return nil, err\n}\n</code></pre>\n<p><strong>TL;DR</strong></p>\n<p>Before inserting also check the places you might be interchanging the values due to which type error is caused.</p>\n"}], "owner": {"reputation": 1461, "user_id": 2059047, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5e1327cb46137894ca902795db2111ac?s=128&d=identicon&r=PG", "display_name": "Prashant4224", "link": "https://stackoverflow.com/users/2059047/prashant4224"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11367, "favorite_count": 4, "answer_count": 2, "score": 6, "last_activity_date": 1611809259, "creation_date": 1482998949, "last_edit_date": 1489415998, "question_id": 41375563, "link": "https://stackoverflow.com/questions/41375563/unsupported-scan-storing-driver-value-type-uint8-into-type-string", "title": "unsupported Scan, storing driver.Value type []uint8 into type *[]string", "body": "<p>I have implemented <code>rest api</code> using <code>golang</code>, <code>gin</code> and <code>gorp</code></p>\n\n<pre><code>Employee structure:\n\ntype Employee struct {\n  Id            int64  `db:\"id\" json:\"id\"`\n  Firstname string `db:\"firstname\" json:\"firstname\"`\n  Lastname  string `db:\"lastname\" json:\"lastname\"`\n  Dob           time.Time `db:\"dob\" json:\"dob\"`\n  Skills        []string `db:skills json:\"skills\"`\n}\n</code></pre>\n\n<p>In <code>POST</code> sending request as:</p>\n\n<pre><code>func PostEmployee(c *gin.Context) {\n  var emp Employee\n  c.Bind(&amp;emp)\n\n  skills, _ := json.Marshal(emp.Skills)\n\n  if emp.Firstname != \"\" &amp;&amp; emp.Lastname != \"\" {\n\n    if insert, _ := dbmap.Exec(`INSERT INTO employee (firstname, lastname, dob, skills) VALUES (?, ?, ?, ?)`, emp.Firstname, emp.Lastname, emp.Dob, skills); insert != nil {\n        emp_id, err := insert.LastInsertId()\n    .....\n    }\n  ......\n  }\n</code></pre>\n\n<p>This save data to <code>mysql</code> database, works perfect.</p>\n\n<p>For retrieving data from database implemented <code>GET</code> request</p>\n\n<pre><code> func GetEmployees(c *gin.Context) {\n   var emps []Employee\n   _, err := dbmap.Select(&amp;emps, \"SELECT * FROM employee\")\n   log.Println(err)\n   if err == nil {\n     c.JSON(200, emps)\n } else {\n     c.JSON(404, gin.H{\"error\": \"no employee(s) into the table\"})\n }\n</code></pre>\n\n<p><code>GET</code> query doesn't gives any data from database and <code>log.Println(err)</code> log says:</p>\n\n<pre><code> Scan error on column index 4: unsupported Scan, storing driver.Value type []uint8 into type *[]string\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["mongodb", "model-view-controller", "go"], "comments": [{"owner": {"reputation": 29341, "user_id": 6337748, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7Si7m.jpg?s=128&g=1", "display_name": "notionquest", "link": "https://stackoverflow.com/users/6337748/notionquest"}, "edited": false, "score": 0, "creation_date": 1483024830, "post_id": 41375042, "comment_id": 69966883, "body": "I am not sure what do you mean by bson id is not set in db. The code tries to update the document which satisfies the query condition. Are you saying myvehicle is not set correctly?"}], "answers": [{"tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 2, "last_activity_date": 1483614210, "last_edit_date": 1483614210, "creation_date": 1483600369, "answer_id": 41479177, "question_id": 41375042, "link": "https://stackoverflow.com/questions/41375042/how-to-set-objectid-for-nested-document-in-golang/41479177#41479177", "title": "How to set ObjectId for nested document in golang?", "body": "<p>MongoDB <a href=\"https://docs.mongodb.com/manual/reference/method/ObjectId/\" rel=\"nofollow noreferrer\">ObjectId</a> is auto inserted for document (not sub-document) that does not specify <code>_id</code> field. This is to uniquely identify the document. </p>\n\n<p>In your case above, if you are inserting a nested object (sub-document) the <code>Id</code> field would not be auto-inserted by MongoDB. </p>\n\n<p>You can however create an ObjectId (unique identifier) for the newly pushed Vehicle document. For example: </p>\n\n<pre><code>new_object_id := bson.NewObjectId()\n</code></pre>\n\n<p>See also <a href=\"https://godoc.org/launchpad.net/mgo/v2/bson#NewObjectId\" rel=\"nofollow noreferrer\">NewObjectId</a></p>\n"}], "owner": {"reputation": 25, "user_id": 7255155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a13359a48bec2ca85c91b70490b5a1?s=128&d=identicon&r=PG&f=1", "display_name": "Aswathy Ashok", "link": "https://stackoverflow.com/users/7255155/aswathy-ashok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 0, "accepted_answer_id": 41479177, "answer_count": 1, "score": 2, "last_activity_date": 1549281866, "creation_date": 1482996402, "last_edit_date": 1549281866, "question_id": 41375042, "link": "https://stackoverflow.com/questions/41375042/how-to-set-objectid-for-nested-document-in-golang", "title": "How to set ObjectId for nested document in golang?", "body": "<p>Model:</p>\n\n<pre><code>type Vehicle   struct {\n    Id          bson.ObjectId `bson:\"_vid,omitempty\"`\n    Brand           string\n    Category        string  \n    CategorySubject     string\n    MakeYear        string\n    RegistrationNumber  string\n    Model           string\n    Price           string\n}\nfunc (this *Vehicle)AddToDB(emailId1 string)  {\n    sess, db := GetDatabase()\n    defer sess.Close()\n    c := db.C(\"user\")\n    //newId :=Vehicle{}\n    /*colQuerier := bson.M{\"email\": person.Email}\n    change := bson.M{\"$set\": bson.M{\"profile\" : imgName}}\n    err = c.Update(colQuerier, change)*/\n    colQuerier := bson.M{\"email\": emailId1}\n    change := bson.M{\"$push\": bson.M{\"myvehicle\" : &amp;this}}\n    err := c.Update(colQuerier, change)\n    if err != nil {\n        fmt.Println(\"not inserted\") \n    }\n}\n</code></pre>\n\n<p>The value of <code>Id</code> of Vehicle is empty when it's pushed into <code>myvehicle</code> field. </p>\n\n<p>How do I set a value for the nested Vehicle's id ?</p>\n"}, {"tags": ["go", "stripe-payments"], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": true, "score": 4, "last_activity_date": 1482995048, "last_edit_date": 1482995048, "creation_date": 1482994145, "answer_id": 41374527, "question_id": 41374298, "link": "https://stackoverflow.com/questions/41374298/how-to-add-metadata-to-a-new-subscription-in-stripe/41374527#41374527", "title": "How to add metadata to a new subscription in Stripe?", "body": "<pre><code>subParams := &amp;stripe.SubParams{\n    Customer: \"test_customer\",\n    Plan: \"month-plan\",\n}\nsubParams.AddMeta(\"Product\",\"special-services\")\ns, err := sub.New(subParams)\n</code></pre>\n\n<p><a href=\"https://godoc.org/github.com/stripe/stripe-go#SubParams\" rel=\"nofollow noreferrer\"><code>stripe.SubParams</code></a> embeds <a href=\"https://godoc.org/github.com/stripe/stripe-go#Params\" rel=\"nofollow noreferrer\"><code>stripe.Params</code></a> which has a method <a href=\"https://godoc.org/github.com/stripe/stripe-go#Params.AddMeta\" rel=\"nofollow noreferrer\"><code>AddMeta</code></a>, which adds meta info to a <code>map[string]string</code>.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 41374527, "answer_count": 1, "score": 2, "last_activity_date": 1482995048, "creation_date": 1482992887, "question_id": 41374298, "link": "https://stackoverflow.com/questions/41374298/how-to-add-metadata-to-a-new-subscription-in-stripe", "title": "How to add metadata to a new subscription in Stripe?", "body": "<p>I have this code, from the examples on Stripe API docs site:</p>\n\n<pre><code>stripe.Key = \"my_key\"\n\ns, err := sub.New(&amp;stripe.SubParams{\n    Customer: \"test_customer\",\n    Plan: \"month-plan\",\n\n})\n</code></pre>\n\n<p>This code works just fine. But I couldn't find how to add metadata to this request, like <code>Product: \"special-services\"</code>.</p>\n\n<p>Can I do it in one request on subscription creation, and if so, then how?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["github", "go"], "comments": [{"owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "edited": false, "score": 0, "creation_date": 1482980518, "post_id": 41372420, "comment_id": 69946899, "body": "I&#39;ve met this before. try <code>go get golang.org&#47;x&#47;net&#47;context</code> first, see what this command outputs."}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1482990006, "post_id": 41372420, "comment_id": 69949104, "body": "I&#39;ve faced this issue before and reinstalling/upgrading fixed it."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user849425"}, "is_accepted": true, "score": 6, "last_activity_date": 1482980057, "last_edit_date": 1482980057, "creation_date": 1482979359, "answer_id": 41372449, "question_id": 41372420, "link": "https://stackoverflow.com/questions/41372420/golang-error-cannot-find-package/41372449#41372449", "title": "Golang - error `cannot find package`", "body": "<p>Did you download the source code for the <code>context</code> package?</p>\n\n<p>One common way to do that is to use the bundled tool <code>go get</code> by doing:</p>\n\n<pre><code>go get golang.org/x/net/context\n</code></pre>\n\n<p>This should import the source code for the <code>context</code> package into your Go workspace which is defined by the <code>GOPATH</code> environment variable. (In your case the package's code will be downloaded to <code>$GOPATH/src/golang.org/x/net/context</code>.)</p>\n\n<p>Alternatively you can do a <code>go get</code> on the parent package to include all of its dependencies automatically without needing to find and download them one at a time. For example:</p>\n\n<pre><code>go get github.com/mattn/go-sqlite3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2658, "user_id": 3883911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S0kKj.png?s=128&g=1", "display_name": "julien bouteloup", "link": "https://stackoverflow.com/users/3883911/julien-bouteloup"}, "is_accepted": false, "score": 0, "last_activity_date": 1497878567, "creation_date": 1497878567, "answer_id": 44631794, "question_id": 41372420, "link": "https://stackoverflow.com/questions/41372420/golang-error-cannot-find-package/44631794#44631794", "title": "Golang - error `cannot find package`", "body": "<p>Go to you <code>github.com/mattn/go-sqlite3</code> folder.\nAnd run <code>go get ./...</code> to install all dependencies into your project folder.</p>\n\n<p>As your project's dependencies should come from <code>github</code> It will install all the dependencies into <code>$GOPATH/src/github.com</code></p>\n"}], "owner": {"reputation": 62, "user_id": 4946004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/954991797878601/picture?type=large", "display_name": "Zac Jacob", "link": "https://stackoverflow.com/users/4946004/zac-jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7033, "favorite_count": 0, "accepted_answer_id": 41372449, "answer_count": 2, "score": -1, "last_activity_date": 1497878567, "creation_date": 1482979042, "question_id": 41372420, "link": "https://stackoverflow.com/questions/41372420/golang-error-cannot-find-package", "title": "Golang - error `cannot find package`", "body": "<p>After using go get to get on github.com/mattn/go-sqlite3 I get an error stating \"golang.org/x/net/context\". </p>\n\n<p>I'm not sure as to where to look to resolve this issue</p>\n"}]