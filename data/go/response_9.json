[{"tags": ["go", "io"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1426116500, "post_id": 28998965, "comment_id": 46246540, "body": "<code>git</code> probably checks to see if it&#39;s standard error &quot;<a href=\"http://linux.die.net/man/3/isatty\" rel=\"nofollow noreferrer\"><code>isatty</code></a>&quot; before printing out that extra information. The reason for this is because it &quot;prints&quot; the <code>\\r</code> character to jump to the beginning of the line to update the percentages, etc.. This behaviour would not be desirable if the output file was anything but a terminal."}], "answers": [{"comments": [{"owner": {"reputation": 368, "user_id": 1171706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e893c1d664ec913b5e752dd7c60393?s=128&d=identicon&r=PG", "display_name": "notzippy", "link": "https://stackoverflow.com/users/1171706/notzippy"}, "edited": false, "score": 0, "creation_date": 1426200996, "post_id": 28999453, "comment_id": 46286855, "body": "That makes sense, the work around (using the go io.Copy) works well enough in this instance as it does not have to be an accurate history. I just wanted to show some activity and the io.MultiWriter gave me nothing. Appreciate the answer and the link.."}], "tags": [], "owner": {"reputation": 97745, "user_id": 884978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb4f5f287976278b6e02f66e85c41dc?s=128&d=identicon&r=PG", "display_name": "creack", "link": "https://stackoverflow.com/users/884978/creack"}, "is_accepted": true, "score": 2, "last_activity_date": 1426117168, "creation_date": 1426117168, "answer_id": 28999453, "question_id": 28998965, "link": "https://stackoverflow.com/questions/28998965/exec-command-setting-output-stream-not-getting-all-data/28999453#28999453", "title": "exec.Command setting output stream not getting all data", "body": "<p>The difference is the TTY. Using a MultiWriter (or anything else) would break the TTY. If you want to do so, you need to use a PTY master/slave pair. You can take a look at <a href=\"https://github.com/kr/pty\" rel=\"nofollow\">https://github.com/kr/pty</a> for more info.</p>\n"}], "owner": {"reputation": 368, "user_id": 1171706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e893c1d664ec913b5e752dd7c60393?s=128&d=identicon&r=PG", "display_name": "notzippy", "link": "https://stackoverflow.com/users/1171706/notzippy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 28999453, "answer_count": 1, "score": 0, "last_activity_date": 1426117168, "creation_date": 1426114666, "question_id": 28998965, "link": "https://stackoverflow.com/questions/28998965/exec-command-setting-output-stream-not-getting-all-data", "title": "exec.Command setting output stream not getting all data", "body": "<p>This works</p>\n\n<pre><code>res = exec.Command(gitCmd, cmdArgs...)\nres.Stdout, res.Stderr = os.Stdout,os.Stderr\n</code></pre>\n\n<p>When executing a git command like <code>git clone ..</code> you get full syntax response like</p>\n\n<pre><code>remote: Counting objects: 15, done.\nremote: Compressing objects: 100% (10/10), done.\nremote: Total 15 (delta 4), reused 0 (delta 0)\nReceiving objects: 100% (15/15), done.\nResolving deltas: 100% (4/4), done.\n</code></pre>\n\n<p>BUT if you wrap it in a multiwriter like this</p>\n\n<pre><code>res = exec.Command(gitCmd, cmdArgs...)\nres.Stdout, res.Stderr = io.MultiWriter(os.Stdout),io.MultiWriter(os.Stderr)\n</code></pre>\n\n<p>You lose all the resolving / receiving outputs, that you normally see. \nWhy ?</p>\n\n<p>The following works but to me seems unnecessary, IMHO the io.MultiWriter should do the same ...</p>\n\n<pre><code>res = exec.Command(gitCmd, cmdArgs...)\nres.Stdout, res.Stderr = os.Stdout,os.Stderr\nstdout, stderr = new(bytes.Buffer), new(bytes.Buffer)\ngo io.Copy(os.Stdout,stdout)\ngo io.Copy(os.Stderr,stderr)\n</code></pre>\n"}, {"tags": ["go", "reverse-geocoding"], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 2, "last_activity_date": 1426114680, "creation_date": 1426114680, "answer_id": 28998967, "question_id": 28998709, "link": "https://stackoverflow.com/questions/28998709/how-can-i-get-the-nearest-city-to-geo-coordinates-with-go/28998967#28998967", "title": "How can I get the nearest city to geo-coordinates with Go?", "body": "<p>The documentation for <a href=\"http://godoc.org/github.com/kellydunn/golang-geo#Geocoder\" rel=\"nofollow\">the <code>Geocoder</code> interface from that library</a> says (emphasis mine):</p>\n\n<blockquote>\n  <p>... Reverse geocoding should accept a pointer to a Point, and return the <em>street address</em> that most closely represents it.</p>\n</blockquote>\n\n<p>So you'll have to either parse the city name from the street address (which is its own challenge) or find a different geocoder library that provides a city explicitly.</p>\n"}, {"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 4, "last_activity_date": 1426114884, "creation_date": 1426114884, "answer_id": 28999012, "question_id": 28998709, "link": "https://stackoverflow.com/questions/28998709/how-can-i-get-the-nearest-city-to-geo-coordinates-with-go/28999012#28999012", "title": "How can I get the nearest city to geo-coordinates with Go?", "body": "<p>The data you are looking to extract is not returned directly from the library. You can, however, perform a request and parse the JSON response yourself to extract the city, rather than the full address:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n\n    \"github.com/kellydunn/golang-geo\"\n)\n\ntype googleGeocodeResponse struct {\n    Results []struct {\n        AddressComponents []struct {\n            LongName  string   `json:\"long_name\"`\n            Types     []string `json:\"types\"`\n        } `json:\"address_components\"`\n    }\n}\n\nfunc main() {\n    p := geo.NewPoint(49.014, 8.4043)\n    geocoder := new(geo.GoogleGeocoder)\n    geo.HandleWithSQL()\n    data, err := geocoder.Request(fmt.Sprintf(\"latlng=%f,%f\", p.Lat(), p.Lng()))\n    if err != nil {\n        log.Println(err)\n    }\n    var res googleGeocodeResponse\n    if err := json.Unmarshal(data, &amp;res); err != nil {\n        log.Println(err)\n    }\n    var city string\n    if len(res.Results) &gt; 0 {\n        r := res.Results[0]\n    outer:\n        for _, comp := range r.AddressComponents {\n            // See https://developers.google.com/maps/documentation/geocoding/#Types\n            // for address types\n            for _, compType := range comp.Types {\n                if compType == \"locality\" {\n                    city = comp.LongName\n                    break outer\n                }\n            }\n        }\n    }\n    fmt.Printf(\"City: %s\\n\", city)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1456, "user_id": 384932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2323e73e7d7e8d927bd7d84297d8670?s=128&d=identicon&r=PG", "display_name": "kelly.dunn", "link": "https://stackoverflow.com/users/384932/kelly-dunn"}, "is_accepted": false, "score": 1, "last_activity_date": 1426443573, "creation_date": 1426443573, "answer_id": 29064416, "question_id": 28998709, "link": "https://stackoverflow.com/questions/28998709/how-can-i-get-the-nearest-city-to-geo-coordinates-with-go/29064416#29064416", "title": "How can I get the nearest city to geo-coordinates with Go?", "body": "<p>Author of <code>golang-geo</code> here.</p>\n\n<p>For those following along with this stack overflow question, I've answered @moose 's primary question in issue #31 <a href=\"https://github.com/kellydunn/golang-geo/issues/31#issuecomment-78405990\" rel=\"nofollow\">here</a>.</p>\n\n<p>The tl;dr answer to this question is that while the Google Geocoding APIs do support <a href=\"https://developers.google.com/maps/documentation/geocoding/#reverse-restricted\" rel=\"nofollow\">some fuzzy notion</a> of getting different levels of precision, it has yet to be implemented in golang-geo to date.  </p>\n"}], "owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2395, "favorite_count": 1, "accepted_answer_id": 28999012, "answer_count": 3, "score": 2, "last_activity_date": 1483739256, "creation_date": 1426113438, "last_edit_date": 1426114005, "question_id": 28998709, "link": "https://stackoverflow.com/questions/28998709/how-can-i-get-the-nearest-city-to-geo-coordinates-with-go", "title": "How can I get the nearest city to geo-coordinates with Go?", "body": "<p>How do I get a geolocation (e.g. the nearest city) from coordinates (e.g. 49.014,8.4043) with Go?</p>\n\n<p>I tried to use <a href=\"http://github.com/kellydunn/golang-geo\" rel=\"nofollow\">golang-geo</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/kellydunn/golang-geo\"\n)\n\nfunc main() {\n    p := geo.NewPoint(49.014, 8.4043)\n    geocoder := new(geo.GoogleGeocoder)\n    geo.HandleWithSQL()\n    res, err := geocoder.ReverseGeocode(p)\n    if err != nil {\n        log.Println(err)\n    }\n    log.Println(string(res))\n}\n</code></pre>\n\n<p>but it gives <code>Schlo\u00dfplatz 23, 76131 Karlsruhe, Germany</code>. I would like\n<code>Karlsruhe</code> (so: only the city).</p>\n\n<p>How do I get only the city?</p>\n"}, {"tags": ["string", "go", "bit", "bitwise-operators"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 2205050, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d910db197ae566e4e46b35e9aefbcc18?s=128&d=identicon&r=PG", "display_name": "darul75", "link": "https://stackoverflow.com/users/2205050/darul75"}, "edited": false, "score": 0, "creation_date": 1426151851, "post_id": 28997773, "comment_id": 46257638, "body": "thanks, it is perfect I had looked to math/big but not enough to see this convert methods, Go documentation is not well displayed to my opinon, to much scroll"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 8, "last_activity_date": 1426109508, "creation_date": 1426109508, "answer_id": 28997773, "question_id": 28997600, "link": "https://stackoverflow.com/questions/28997600/golang-bitwise-operation-on-very-long-binary-bit-string-representation/28997773#28997773", "title": "golang: bitwise operation on very long binary bit string representation", "body": "<p>You <em>could</em> create the resulting bitwise OR string by doing character comparisons, or you can perform arbitrary large numeric operations using <a href=\"https://godoc.org/math/big\"><code>math/big</code></a>.  Here is an example of such an operation:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math/big\"\n\nfunc main() {\n    num1 := \"11100\"\n    num2 := \"00011\"\n\n    var bigNum1 big.Int\n    var bigNum2 big.Int\n    var result big.Int\n\n    if _, ok := bigNum1.SetString(num1, 2); !ok {\n        panic(\"invalid num1\")\n    }\n    if _, ok := bigNum2.SetString(num2, 2); !ok {\n        panic(\"invalid num2\")\n    }\n    result.Or(&amp;bigNum1, &amp;bigNum2)\n\n    for i := result.BitLen() - 1; i &gt;= 0; i-- {\n        fmt.Print(result.Bit(i))\n    }\n    fmt.Println()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/6K_nQaqKbl\">Go Playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 2, "creation_date": 1426110447, "post_id": 28997861, "comment_id": 46244082, "body": "You would need to pad them out if their lengths weren&#39;t identical."}], "tags": [], "owner": {"reputation": 584, "user_id": 2528719, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ef4da676524b97d525de1c3a5ad3e87?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2528719/aaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1426125968, "last_edit_date": 1426125968, "creation_date": 1426109800, "answer_id": 28997861, "question_id": 28997600, "link": "https://stackoverflow.com/questions/28997600/golang-bitwise-operation-on-very-long-binary-bit-string-representation/28997861#28997861", "title": "golang: bitwise operation on very long binary bit string representation", "body": "<p>While you could convert these to numbers to perform bitwise operations, if your only goal is to perform a single bitwise OR on the two strings, parsing the strings into numbers will be less efficient than simply iterating over the string to achieve your end result. Doing so would only make sense if you were performing lots of operations on the numbers in their binary form.</p>\n\n<p>Example code for performing an OR operation on the strings below. Do note that this code assumes the strings are the same length as the examples in the question are, if they were of different lengths you would need to handle that as well.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    n1 := \"1100\"\n    n2 := \"0011\"\n\n    fmt.Printf(\"Input: %v | %v\\n\", n1, n2)\n\n    if len(n1) != len(n2) {\n        fmt.Println(\"Only supports strings of the same length\")\n        return\n    }\n\n    result := make([]byte, len(n1))\n\n    for i := 0; i &lt; len(n1); i++ {\n        switch n1[i] {\n        case '0':\n            switch n2[i] {\n            case '0':\n                result[i] = '0'\n            case '1':\n                result[i] = '1'\n            }\n        case '1':\n            switch n2[i] {\n            case '0':\n                result[i] = '1'\n            case '1':\n                result[i] = '1'\n            }\n        }\n    }\n\n    fmt.Println(\"Result: \", string(result))\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/L3o6_jYdi1\" rel=\"nofollow\">http://play.golang.org/p/L3o6_jYdi1</a></p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1426185471, "post_id": 29000637, "comment_id": 46279498, "body": "Don&#39;t use <code>48</code> and <code>49</code> when <code>&#39;0&#39;</code> and <code>&#39;1&#39;</code> are more appropriate and readable."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1426185585, "post_id": 29000637, "comment_id": 46279566, "body": "Instead of mucking about with <code>strings.Repeat</code> (and the associated allocations) it would be simpler just to copy the leading bytes as-is from the longest input before switching to doing bit ops."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426219203, "post_id": 29000637, "comment_id": 46291916, "body": "@DaveC, thanks for the suggestions. I think they are both good; I modified my code to reflect them."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426232247, "post_id": 29000637, "comment_id": 46295802, "body": "Sorry to belabor this, but <code>copy(tmp[:lenDiff], a); a := a[lenDiff:]</code> (or b) (idiomatic Go identifier names use <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#mixed-caps\" rel=\"nofollow noreferrer\">mixedCaps</a> rather than under_scores) would be better than a manual loop and having to remembering an offset to how much remains (i.e. by the last loop it would be nice if the <code>a</code> and <code>b</code> where now the same length with just the remaining bits and <code>tmp</code> could just be appended to to finish off)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426232941, "post_id": 29000637, "comment_id": 46296070, "body": "E.g. perhaps something more like <a href=\"https://play.golang.org/p/V5l73KxaI2\" rel=\"nofollow noreferrer\">play.golang.org/p/V5l73KxaI2</a> maybe (feel free to copy or improve on that)."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426259695, "post_id": 29000637, "comment_id": 46312318, "body": "@DaveC, thanks for your help. I think your answer is significantly different (and better) from mine, so you probably should provide it as separate answer. Please do it is a nice answer."}], "tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 0, "last_activity_date": 1426219007, "last_edit_date": 1426219007, "creation_date": 1426125269, "answer_id": 29000637, "question_id": 28997600, "link": "https://stackoverflow.com/questions/28997600/golang-bitwise-operation-on-very-long-binary-bit-string-representation/29000637#29000637", "title": "golang: bitwise operation on very long binary bit string representation", "body": "<p>How about this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\n    a :=   \"01111100\"\n    b := \"1001000110\"\n\n    var longest, len_diff int \n\n    if len(a) &gt; len(b) {\n        longest = len(a)\n        len_diff = len(a) - len(b)\n    } else {\n        longest = len(b)\n        len_diff = len(b) - len(a)\n    }\n\n    temp_slice := make([] byte, longest)\n\n    var a_start, b_start int\n\n    if len(a) &gt; len(b) {\n        for i := 0; i &lt; len_diff; i++ {\n            temp_slice[i] = a[i]\n        }\n        a_start = len_diff\n\n    } else {\n        for i := 0; i &lt; len_diff; i++ {\n            temp_slice[i] = b[i]\n        }\n        b_start = len_diff\n    }\n\n    for i := 0; i &lt; (longest - len_diff); i++ {\n        if a[a_start + i] == '1' ||  b[b_start + i] == '1' {\n            temp_slice[len_diff + i] = '1'\n        } else {\n            temp_slice[len_diff + i] = '0'\n        }\n    }\n\n    fmt.Println(string(temp_slice))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/GY5ko1nf3x\" rel=\"nofollow\">goplayground</a></p>\n"}], "owner": {"reputation": 325, "user_id": 2205050, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d910db197ae566e4e46b35e9aefbcc18?s=128&d=identicon&r=PG", "display_name": "darul75", "link": "https://stackoverflow.com/users/2205050/darul75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2000, "favorite_count": 3, "accepted_answer_id": 28997773, "answer_count": 3, "score": 4, "last_activity_date": 1503601093, "creation_date": 1426108891, "last_edit_date": 1500149124, "question_id": 28997600, "link": "https://stackoverflow.com/questions/28997600/golang-bitwise-operation-on-very-long-binary-bit-string-representation", "title": "golang: bitwise operation on very long binary bit string representation", "body": "<p>As an exercise, in input I got 2 very big <strong>string</strong> containing long binary representation here a short one but could have more than 100 bits:</p>\n\n<p>Example</p>\n\n<pre><code>11100\n00011\n</code></pre>\n\n<p>With output in bitwise OR (as string)</p>\n\n<pre><code>11111\n</code></pre>\n\n<p>My approach was to parse each string characters and make a bitwise OR and build a new string but it is too long to process on big entry and not effective.</p>\n\n<p>Then ParseInt method is restricted to a 64 bit length</p>\n\n<pre><code>num1, err:= strconv.ParseInt(\"11100\", 2, 64)\nnum2, err:= strconv.ParseInt(\"00011\", 2, 64)\nres := num1 | num2\n</code></pre>\n\n<p>How to deal with a bitwise OR between 2 string binary representation?</p>\n"}, {"tags": ["sockets", "go", "tcp", "raw-sockets", "gopacket"], "comments": [{"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 1, "creation_date": 1426108897, "post_id": 28996734, "comment_id": 46243332, "body": "Make sure you didn&#39;t get network/host ordering mixed up on the edit, and then you need to recompute the checksums that are now invalidated."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1426126214, "post_id": 28996734, "comment_id": 46249254, "body": "<b>Never</b> use the two value version of <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> if you aren&#39;t going to check the second value. The single value version <b>requires</b> the type matches and will panic on failure (with a reasonable message) whereas the two value version will always succeed (returning <code>nil, false</code> where the type is wrong)."}], "owner": {"reputation": 2354, "user_id": 3973051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/594835486/picture?type=large", "display_name": "Jonathan Eustace", "link": "https://stackoverflow.com/users/3973051/jonathan-eustace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1499, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1499722579, "creation_date": 1426105869, "last_edit_date": 1499722579, "question_id": 28996734, "link": "https://stackoverflow.com/questions/28996734/changing-the-ip-address-of-a-gopacket-and-re-transmitting-using-raw-sockets", "title": "Changing the IP address of a Gopacket and re-transmitting using raw sockets", "body": "<p>I'm writing a program that reads all packets passing through the computer running it. I wish to grab a packet (either by dst ip or src ip), then change the dstIP and TCP dstPort and put it back on the wire. </p>\n\n<p>I have no problems with changing the dstIP, but how do I serialize it properly so the packet isn't malformed and gets to the destination in which I want it to go?</p>\n\n<pre><code>package main\n\nimport (\n    \"code.google.com/p/gopacket\"\n    \"code.google.com/p/gopacket/layers\"\n    \"code.google.com/p/gopacket/pcap\"\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    if handle, err := pcap.OpenLive(\"wlp4s0\", 1600, true, 100); err != nil {\n        panic(err)\n    } else {\n        packetSource := gopacket.NewPacketSource(handle, handle.LinkType())\n        for packet := range packetSource.Packets() {\n            if ipLayer := packet.Layer(layers.LayerTypeIPv4); ipLayer != nil {\n                fmt.Println(\"This is a IP packet!\")\n                // Get actual IP data from this layer\n                ip, _ := ipLayer.(*layers.IPv4)\n\n                //see if the source IP is what I'm expecting\n                if ip.SrcIP.Equal(net.ParseIP(\"192.168.1.66\")) {\n                    //change the dst IP to something 192.168.1.65\n                    ip.DstIP = net.ParseIP(\"192.168.1.65\")\n\n                    // create a buffer to serialize to\n                    buf := gopacket.NewSerializeBuffer()\n                    //no options\n                    opts := gopacket.SerializeOptions{}\n\n                    //serialize the packet\n                    ip.SerializeTo(buf, opts)\n\n                    packetDataToGo := buf.Bytes()\n\n                    // send the packet\n                    handle.WritePacketData(packetDataToGo)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1426105448, "post_id": 28994759, "comment_id": 46241361, "body": "I have no experience with gorm, but does your query return the pic data?"}, {"owner": {"reputation": 4633, "user_id": 506712, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QxcR9.jpg?s=128&g=1", "display_name": "Javier Manzano", "link": "https://stackoverflow.com/users/506712/javier-manzano"}, "reply_to_user": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1426162268, "post_id": 28994759, "comment_id": 46263981, "body": "no, that&#39;s the problem, it doesn&#39;t return anything on the array"}], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 2840601, "user_type": "registered", "profile_image": "https://graph.facebook.com/1605469080/picture?type=large", "display_name": "Felix Ribeiro", "link": "https://stackoverflow.com/users/2840601/felix-ribeiro"}, "is_accepted": false, "score": 1, "last_activity_date": 1429201544, "creation_date": 1429201544, "answer_id": 29680702, "question_id": 28994759, "link": "https://stackoverflow.com/questions/28994759/how-to-populate-and-embedded-array-with-gorm/29680702#29680702", "title": "How to populate and embedded array with gorm?", "body": "<p>I had these issues once. Then I used Join function.\nSee my example that works just fine:</p>\n\n<pre><code>type FileType struct {\n     Id         int\n}\ntype File struct {\n     Id           int  \n     FileType     `xorm:\"extends\"`\n}\n\nfile := File{Id: id}\n\n\nhas, err := eng.\n    Join(\"INNER\", \"FileType\", \"FileType.IdFileType = File.IdFileType\").\n    Get(&amp;file)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1429202131, "creation_date": 1429202131, "answer_id": 29680926, "question_id": 28994759, "link": "https://stackoverflow.com/questions/28994759/how-to-populate-and-embedded-array-with-gorm/29680926#29680926", "title": "How to populate and embedded array with gorm?", "body": "<p>Your models (the structs) don't really make sense because <code>User</code> have a <code>Pic</code> array indicates a 'one to many' user to pics relationship however your user has no id property itself and there for cannot be related to items on the <code>Pic</code> table.</p>\n\n<p>User should have a property <code>Id</code> which will be it's primary key and <code>UserId</code> is a foreign key on Pic that relates to it. Without the 'relation' between these two tables/entities there's no way you're going to return pics by querying users.</p>\n\n<p>I'm not sure what all you need to do to make your code work since the example is incomplete but the first thing you need is an <code>Id</code> property which you should designate as a Primarykey with gorm annotations. You also should have annotations on the Pic struct saying UserId is a foreign key and Id is it's primary key.</p>\n\n<p>Also, just fyi your array is not embedded. Embedding is a language feature which you're not using, if you embed the property it has no name and it's properties can be accessed directly from an instance of the embedding type.</p>\n"}, {"tags": [], "owner": {"reputation": 7915, "user_id": 494343, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/446b5d6d3a019f8219b5d8102c1d4bbc?s=128&d=identicon&r=PG", "display_name": "Schultz9999", "link": "https://stackoverflow.com/users/494343/schultz9999"}, "is_accepted": false, "score": 0, "last_activity_date": 1532707573, "creation_date": 1532707573, "answer_id": 51561700, "question_id": 28994759, "link": "https://stackoverflow.com/questions/28994759/how-to-populate-and-embedded-array-with-gorm/51561700#51561700", "title": "How to populate and embedded array with gorm?", "body": "<p>You probably know by now. You got to think as if you are creating a SQL table with 1-to-many relationship. Here is an example:</p>\n\n<pre><code>type Entry struct {\n  ID int\n  Name string\n  ...\n  ContainerID int\n}\n\ntype Container struct {\n  ID int\n  Tag int\n  Name string\n  ...\n  Entries []Entry `gorm:\"foreignkey:ContainerID\"`\n}\n</code></pre>\n\n<p>The trick is to populate it. I am yet to find how to make it in one try. For every such dependency, you got to run something like:</p>\n\n<pre><code>c := getContainerFromDB(...)\nif err := getROConn().Model(c).Related(&amp;c.Entries, \"Entries\").Error; err != nil {\n    return errors.Wrap(err, \"error getting container field\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 3686087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VnoVl.jpg?s=128&g=1", "display_name": "msmaromi", "link": "https://stackoverflow.com/users/3686087/msmaromi"}, "is_accepted": false, "score": 0, "last_activity_date": 1597837504, "creation_date": 1597837504, "answer_id": 63486285, "question_id": 28994759, "link": "https://stackoverflow.com/questions/28994759/how-to-populate-and-embedded-array-with-gorm/63486285#63486285", "title": "How to populate and embedded array with gorm?", "body": "<p>Try <a href=\"http://gorm.io/docs/preload.html\" rel=\"nofollow noreferrer\">Preload</a></p>\n<pre><code>db.Limit(pagesize).Where(&quot;updated_at &gt; ?&quot;, date).Preload(&quot;Pics&quot;).Find(&amp;users)\n</code></pre>\n"}], "owner": {"reputation": 4633, "user_id": 506712, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/QxcR9.jpg?s=128&g=1", "display_name": "Javier Manzano", "link": "https://stackoverflow.com/users/506712/javier-manzano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5631, "favorite_count": 2, "answer_count": 4, "score": 0, "last_activity_date": 1597837504, "creation_date": 1426099115, "question_id": 28994759, "link": "https://stackoverflow.com/questions/28994759/how-to-populate-and-embedded-array-with-gorm", "title": "How to populate and embedded array with gorm?", "body": "<p>I have 2 structs with data like this:</p>\n\n<pre><code>type User struct {\n  Pics Pic[]\n}\n\ntype Pic struct {\n  Id int   \n  UserId int64\n}\n</code></pre>\n\n<p>Although everytime I insert an User, Each of the pics are inserted on their table everytime I find the users, pics are not populated:</p>\n\n<pre><code>var users []User\ndb.Limit(pagesize).Where(\"updated_at &gt; ?\", date).Find(&amp;users)\n</code></pre>\n\n<p>Am I doing something wrong?</p>\n"}, {"tags": ["go", "cgo"], "owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1426152155, "creation_date": 1426096947, "last_edit_date": 1426152155, "question_id": 28994100, "link": "https://stackoverflow.com/questions/28994100/is-there-any-way-to-export-a-go-callback-with-const-parameters", "title": "Is there any way to export a Go callback with const parameters?", "body": "<p>Having this in Go:</p>\n\n<pre><code>//export foo\nfunc foo(bar *C.char) { ... }\n</code></pre>\n\n<p>I can't call it in C++ this way:</p>\n\n<pre><code>foo(\"Hello\");\n</code></pre>\n\n<p>Currently I'm resorting to a wrapper in C++:</p>\n\n<pre><code>inline void go_foo(const char *bar) {\n    foo(const_cast&lt;char *&gt;(bar));\n}\n</code></pre>\n\n<p>and then calling <code>go_foo(\"Hello\")</code>.</p>\n\n<p>Is there an alternative approach to obtain Go callbacks that carry parameter constness?</p>\n"}, {"tags": ["image", "go", "draw"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1426096423, "post_id": 28992396, "comment_id": 46235876, "body": "I haven&#39;t tried these, but <a href=\"https://code.google.com/p/rog-go/source/browse/canvas/\" rel=\"nofollow noreferrer\">code.google.com/p/rog-go/source/browse/canvas</a> and <a href=\"https://code.google.com/p/draw2d/\" rel=\"nofollow noreferrer\">code.google.com/p/draw2d</a> might help."}, {"owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426188559, "post_id": 28992396, "comment_id": 46281155, "body": "thanks looked at draw2d. downloaded but ran into plenty of compile issues (i&#39;m on appengine stack). lot of work to just get started. worst case will try to resolve them."}, {"owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426188622, "post_id": 28992396, "comment_id": 46281187, "body": "lol who how offensive was the requirement to draw a line that the question was downvoted!"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1426195449, "post_id": 28992396, "comment_id": 46284514, "body": "I wasn&#39;t one of the folks that downvoted, so I&#39;m not sure, but I think it might&#39;ve been that the initial phrasing sounded a little exasperated (&quot;simple rectangle&quot;, &quot;Is it just me or...&quot;, &quot;I just want to...&quot;). Usually does better on SO to state the question as objectively as you can, even if you are frustrated (which happens!)."}, {"owner": {"reputation": 113, "user_id": 1211451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b6f66bf0bb6c714a13008acb72b478e?s=128&d=identicon&r=PG", "display_name": "llgcode", "link": "https://stackoverflow.com/users/1211451/llgcode"}, "edited": false, "score": 1, "creation_date": 1431335081, "post_id": 28992396, "comment_id": 48433664, "body": "You may want to use the new <a href=\"http://github.com/llgcode/draw2d\" rel=\"nofollow noreferrer\">github.com/llgcode/draw2d</a> repos. The library works well, a new branch of the library shows that a clean up will be done to enhance readibility and usability of the library: see <a href=\"https://github.com/llgcode/draw2d.samples/blob/master/line/line.go\" rel=\"nofollow noreferrer\">Draw a line</a> sample code and <a href=\"http://godoc.org/github.com/llgcode/draw2d#Rect\" rel=\"nofollow noreferrer\">Rect</a> function"}, {"owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "edited": false, "score": 0, "creation_date": 1618432313, "post_id": 28992396, "comment_id": 118602924, "body": "For posterity I would like to add that I abandoned Go completely in 2016 due to struggle with libs. It has been JS and occasional python since then."}], "answers": [{"comments": [{"owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "edited": false, "score": 2, "creation_date": 1426189590, "post_id": 29004191, "comment_id": 46281686, "body": "icza many thanks. i did see the image pkg structs. just could not &#39;connect the dots&#39; and find something builtin like what you are doing in hline and vline. this is something i did not want to do because line algorithms are not simple with rasterization anti-aliasing, bresenham etc. i will try your example now and learn. and thanks also for suggesting freetype - putting text on the label was also part of my req which i forgot to ask in the question."}, {"owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "edited": false, "score": 1, "creation_date": 1426190180, "post_id": 29004191, "comment_id": 46282001, "body": "icza neat game btw. why not freehost it on appengine?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "edited": false, "score": 0, "creation_date": 1426192355, "post_id": 29004191, "comment_id": 46283101, "body": "@Fakeer Because it&#39;s not AppEngine- and production ready. The game was created in less than 48 hours (Gopher Gala rules). So this is more like a demo and not how good it could be if more time would be spent on it."}, {"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 1, "creation_date": 1475986864, "post_id": 29004191, "comment_id": 67161234, "body": "+1 for providing a simple, working example. This is the first I&#39;ve found that shows me how I can draw pixel by pixel and save to PNG. Now I&#39;m off to start through this learning course <a href=\"https://github.com/ssloy/tinyrenderer/wiki\" rel=\"nofollow noreferrer\">github.com/ssloy/tinyrenderer/wiki</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 49, "last_activity_date": 1548337826, "last_edit_date": 1548337826, "creation_date": 1426145824, "answer_id": 29004191, "question_id": 28992396, "link": "https://stackoverflow.com/questions/28992396/draw-a-rectangle-in-golang/29004191#29004191", "title": "Draw a rectangle in Golang?", "body": "<p>The standard Go library does not provide primitive drawing or painting capabilities.</p>\n\n<p>What it provides is models for colors (<a href=\"http://golang.org/pkg/image/color/\" rel=\"noreferrer\"><code>image/color</code></a> package) and an <a href=\"http://golang.org/pkg/image/#Image\" rel=\"noreferrer\"><code>Image</code></a> interface with several implementations (<a href=\"http://golang.org/pkg/image/\" rel=\"noreferrer\"><code>image</code></a> package). The blog post <a href=\"http://blog.golang.org/go-image-package\" rel=\"noreferrer\"><strong>The Go Image package</strong></a> is a good introduction to this.</p>\n\n<p>It also provides a capability to combine images (e.g. draw them on each other) with different operations in the <a href=\"http://golang.org/pkg/image/draw/\" rel=\"noreferrer\"><code>image/draw</code></a> package. This can be used to a lot more than it sounds at first. There is a nice blog article about the <code>image/draw</code> package which showcases some of its potential:  <a href=\"http://blog.golang.org/go-imagedraw-package\" rel=\"noreferrer\"><strong>The Go image/draw package</strong></a></p>\n\n<p>Another example is the open-source game <a href=\"https://github.com/gophergala/golab\" rel=\"noreferrer\">Gopher's Labyrinth</a> (<em>disclosure: I'm the author</em>) which has a graphical interface and it uses nothing else just the standard Go library to assemble its view.</p>\n\n<p><img src=\"https://i.stack.imgur.com/cIyhe.png\" alt=\"Gopher&#39;s Labyrinth Screenshot\"></p>\n\n<p>It's open source, check out its sources how it is done. It has a scrollable game view with moving images/animations in it.</p>\n\n<p>The standard library also supports reading and writing common image formats like <a href=\"http://golang.org/pkg/image/gif/\" rel=\"noreferrer\">GIF</a>, <a href=\"http://golang.org/pkg/image/jpeg/\" rel=\"noreferrer\">JPEG</a>, <a href=\"http://golang.org/pkg/image/png/\" rel=\"noreferrer\">PNG</a>, and support for other formats are available out of the box: <a href=\"http://godoc.org/golang.org/x/image/bmp\" rel=\"noreferrer\">BMP</a>, <a href=\"http://godoc.org/golang.org/x/image/riff\" rel=\"noreferrer\">RIFF</a>, <a href=\"http://godoc.org/golang.org/x/image/tiff\" rel=\"noreferrer\">TIFF</a> and even <a href=\"http://godoc.org/golang.org/x/image/webp\" rel=\"noreferrer\">WEBP</a> (only a reader/decoder).</p>\n\n<p>Although support is not given by the standard library, it is fairly easy to draw lines and rectangles on an image. Given an <code>img</code> image which supports changing a pixel with a method: <code>Set(x, y int, c color.Color)</code> (for example <a href=\"http://golang.org/pkg/image/#RGBA\" rel=\"noreferrer\"><code>image.RGBA</code></a> is perfect for us) and a <code>col</code> of type <a href=\"http://golang.org/pkg/image/color/#Color\" rel=\"noreferrer\"><code>color.Color</code></a>:</p>\n\n<pre><code>// HLine draws a horizontal line\nfunc HLine(x1, y, x2 int) {\n    for ; x1 &lt;= x2; x1++ {\n        img.Set(x1, y, col)\n    }\n}\n\n// VLine draws a veritcal line\nfunc VLine(x, y1, y2 int) {\n    for ; y1 &lt;= y2; y1++ {\n        img.Set(x, y1, col)\n    }\n}\n\n// Rect draws a rectangle utilizing HLine() and VLine()\nfunc Rect(x1, y1, x2, y2 int) {\n    HLine(x1, y1, x2)\n    HLine(x1, y2, x2)\n    VLine(x1, y1, y2)\n    VLine(x2, y1, y2)\n}\n</code></pre>\n\n<p>Using these simple functions here is a runnable example program which draws a line and a rectangle and saves the image into a <code>.png</code> file:</p>\n\n<pre><code>import (\n    \"image\"\n    \"image/color\"\n    \"image/png\"\n    \"os\"\n)\n\nvar img = image.NewRGBA(image.Rect(0, 0, 100, 100))\nvar col color.Color\n\nfunc main() {\n    col = color.RGBA{255, 0, 0, 255} // Red\n    HLine(10, 20, 80)\n    col = color.RGBA{0, 255, 0, 255} // Green\n    Rect(10, 10, 80, 50)\n\n    f, err := os.Create(\"draw.png\")\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n    png.Encode(f, img)\n}\n</code></pre>\n\n<p>If you want to draw texts, you can use the <a href=\"https://github.com/golang/freetype\" rel=\"noreferrer\">Go implementation of FreeType</a>. Also check out this question for a simple introduction to drawing strings on images: <a href=\"https://stackoverflow.com/questions/38299930/how-do-add-a-text-label-to-an-image-in-go\">How to add a simple text label to an image in Go?</a></p>\n\n<p>If you want advanced and more complex drawing capabilities, there are also <a href=\"https://github.com/golang/go/wiki/Projects#graphics-and-audio\" rel=\"noreferrer\">many external libraries</a> available, for example:</p>\n\n<p><a href=\"https://github.com/llgcode/draw2d\" rel=\"noreferrer\">https://github.com/llgcode/draw2d</a></p>\n\n<p><a href=\"https://github.com/fogleman/gg\" rel=\"noreferrer\">https://github.com/fogleman/gg</a></p>\n"}, {"tags": [], "owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "is_accepted": false, "score": 1, "last_activity_date": 1426391803, "creation_date": 1426391803, "answer_id": 29057073, "question_id": 28992396, "link": "https://stackoverflow.com/questions/28992396/draw-a-rectangle-in-golang/29057073#29057073", "title": "Draw a rectangle in Golang?", "body": "<p>My noob shot at drawing a rectangle of given line thickness. Still primitive</p>\n\n<pre><code>func Rect(x1, y1, x2, y2, thickness int, img *image.RGBA) {\n    col := color.RGBA{0, 0, 0, 255}\n\n    for t:=0; t&lt;thickness; t++ {\n        // draw horizontal lines\n        for x := x1; x&lt;= x2; x++ {\n            img.Set(x, y1+t, col)\n            img.Set(x, y2-t, col)\n        }\n        // draw vertical lines\n        for y := y1; y &lt;= y2; y++ {\n            img.Set(x1+t, y, col)\n            img.Set(x2-t, y, col)\n        }\n    }\n}\n\n\n// handler to test\nfunc draw(w http.ResponseWriter, r *http.Request) {\n    img := image.NewRGBA(image.Rect(0, 0, 1200, 1800))\n    Rect(5, 5, 1195, 1795, 2, img)\n    png.Encode(w, img)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 174, "user_id": 438069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa8097801d794d96bb6e5ef0482397a?s=128&d=identicon&r=PG", "display_name": "Aleksandr Zonov", "link": "https://stackoverflow.com/users/438069/aleksandr-zonov"}, "edited": false, "score": 0, "creation_date": 1441657012, "post_id": 31329533, "comment_id": 52754484, "body": "I can&#39;t understand why everyone posts this broken example. Package draw2d doesn&#39;t contain NewGraphicContext and SaveToPngFile. If you try to run this code you get something like &quot;.\\generate.go:13: undefined: draw2d.NewGraphicContext&quot; Both that functions are inside github.com/llgcode/draw2d/draw2dimg."}, {"owner": {"reputation": 8149, "user_id": 616644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wVwGC.png?s=128&g=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/616644/rick-smith"}, "reply_to_user": {"reputation": 174, "user_id": 438069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa8097801d794d96bb6e5ef0482397a?s=128&d=identicon&r=PG", "display_name": "Aleksandr Zonov", "link": "https://stackoverflow.com/users/438069/aleksandr-zonov"}, "edited": false, "score": 0, "creation_date": 1441904825, "post_id": 31329533, "comment_id": 52874674, "body": "The example on the github page has changed.  I&#39;ve updated my code to use the new version"}, {"owner": {"reputation": 1805, "user_id": 566288, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49eb0eb4881b898ad2e464296025ee00?s=128&d=identicon&r=PG", "display_name": "Robert Ross", "link": "https://stackoverflow.com/users/566288/robert-ross"}, "edited": false, "score": 0, "creation_date": 1442602125, "post_id": 31329533, "comment_id": 53164431, "body": "I think NewGraphicContext takes draw.Image right? image.Image doesn&#39;t have the &quot;set()&quot; func."}, {"owner": {"reputation": 8149, "user_id": 616644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wVwGC.png?s=128&g=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/616644/rick-smith"}, "reply_to_user": {"reputation": 1805, "user_id": 566288, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/49eb0eb4881b898ad2e464296025ee00?s=128&d=identicon&r=PG", "display_name": "Robert Ross", "link": "https://stackoverflow.com/users/566288/robert-ross"}, "edited": false, "score": 0, "creation_date": 1442605969, "post_id": 31329533, "comment_id": 53166435, "body": "@RobertRoss Correct, image.NewRGBA is a struct that implements both interfaces.  NewGraphicContext sees image.RGBA and knows it implements draw.Image (and image.Image).  I hope that answered your question."}, {"owner": {"reputation": 614, "user_id": 954632, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/79a0057d7d4de0f64eac0b10a6e7f518?s=128&d=identicon&r=PG", "display_name": "iacopo", "link": "https://stackoverflow.com/users/954632/iacopo"}, "edited": false, "score": 0, "creation_date": 1494838570, "post_id": 31329533, "comment_id": 74979944, "body": "This example is still broken: <code>.&#47;main.go:16: undefined: draw2d in draw2d.Rect</code>. Instead, the example in the github page it&#39;s working."}, {"owner": {"reputation": 8149, "user_id": 616644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wVwGC.png?s=128&g=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/616644/rick-smith"}, "reply_to_user": {"reputation": 614, "user_id": 954632, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/79a0057d7d4de0f64eac0b10a6e7f518?s=128&d=identicon&r=PG", "display_name": "iacopo", "link": "https://stackoverflow.com/users/954632/iacopo"}, "edited": false, "score": 0, "creation_date": 1494862080, "post_id": 31329533, "comment_id": 74995766, "body": "@iacopo The example above was for v1, which is no longer the the master branch.  I&#39;ve updated my answer to state and and refer to the example on the github page for newer versions."}], "tags": [], "owner": {"reputation": 8149, "user_id": 616644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wVwGC.png?s=128&g=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/616644/rick-smith"}, "is_accepted": false, "score": 6, "last_activity_date": 1494862132, "last_edit_date": 1494862132, "creation_date": 1436481724, "answer_id": 31329533, "question_id": 28992396, "link": "https://stackoverflow.com/questions/28992396/draw-a-rectangle-in-golang/31329533#31329533", "title": "Draw a rectangle in Golang?", "body": "<p>You are probably looking for the <a href=\"https://github.com/llgcode/draw2d\" rel=\"nofollow noreferrer\">draw2d</a> package.  From their <code>github</code> readme:</p>\n\n<blockquote>\n  <p>Operations in draw2d include stroking and filling polygons, arcs, B\u00e9zier curves, drawing images and text rendering with truetype fonts. All drawing operations can be transformed by affine transformations (scale, rotation, translation). </p>\n</blockquote>\n\n<p>The following code draws a black rectangle and writes it to a <code>.png</code> file.   It is using the v1 release (<code>go get -u github.com/llgcode/draw2d</code>).</p>\n\n<pre><code>package main\n\nimport (\n        \"github.com/llgcode/draw2d/draw2dimg\"\n\n        \"image\"\n        \"image/color\"\n)\n\nfunc main() {\n        i := image.NewRGBA(image.Rect(0, 0, 200, 200))\n        gc := draw2dimg.NewGraphicContext(i)\n        gc.Save()\n        gc.SetStrokeColor(color.Black)\n        gc.SetFillColor(color.Black)\n        draw2d.Rect(gc, 10, 10, 100, 100)\n        gc.FillStroke()\n        gc.Restore()\n\n        draw2dimg.SaveToPngFile(\"yay-rectangle.png\", i)\n}\n</code></pre>\n\n<p>Please consult <a href=\"https://github.com/llgcode/draw2d#quick-start\" rel=\"nofollow noreferrer\">the github page</a> for the newest version. </p>\n"}, {"tags": [], "owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "is_accepted": false, "score": 8, "last_activity_date": 1603240194, "last_edit_date": 1603240194, "creation_date": 1506729480, "answer_id": 46498259, "question_id": 28992396, "link": "https://stackoverflow.com/questions/28992396/draw-a-rectangle-in-golang/46498259#46498259", "title": "Draw a rectangle in Golang?", "body": "<p>Here we draw two rectangles using standard golang libraries</p>\n<pre><code>// https://blog.golang.org/go-imagedraw-package\n\npackage main\n\nimport (\n    &quot;image&quot;\n    &quot;image/color&quot;\n    &quot;image/draw&quot;\n    &quot;image/png&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n\n    new_png_file := &quot;/tmp/two_rectangles.png&quot; // output image lives here\n\n    myimage := image.NewRGBA(image.Rect(0, 0, 220, 220)) // x1,y1,  x2,y2\n    mygreen := color.RGBA{0, 100, 0, 255}  //  R, G, B, Alpha\n\n    // backfill entire surface with green\n    draw.Draw(myimage, myimage.Bounds(), &amp;image.Uniform{mygreen}, image.ZP, draw.Src)\n\n    red_rect := image.Rect(60, 80, 120, 160) //  geometry of 2nd rectangle\n    myred := color.RGBA{200, 0, 0, 255}\n\n    // create a red rectangle atop the green surface\n    draw.Draw(myimage, red_rect, &amp;image.Uniform{myred}, image.ZP, draw.Src)\n\n    myfile, err := os.Create(new_png_file)     // ... now lets save imag\n    if err != nil {\n        panic(err)\n    }\n    png.Encode(myfile, myimage)   // output file /tmp/two_rectangles.png\n}\n</code></pre>\n<p>above will generate a png file with our two rectangles :</p>\n<p><a href=\"https://i.stack.imgur.com/su0Em.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/su0Em.png\" alt=\"\" /></a></p>\n<p>following code will create a chessboard image from rectangles</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;image&quot;\n    &quot;image/color&quot;\n    &quot;image/draw&quot;\n    &quot;image/png&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n\n    new_png_file := &quot;/tmp/chessboard.png&quot;\n    board_num_pixels := 240\n\n    myimage := image.NewRGBA(image.Rect(0, 0, board_num_pixels, board_num_pixels))\n    colors := make(map[int]color.RGBA, 2)\n\n    colors[0] = color.RGBA{0, 100, 0, 255}   // green\n    colors[1] = color.RGBA{50, 205, 50, 255} // limegreen\n\n    index_color := 0\n    size_board := 8\n    size_block := int(board_num_pixels / size_board)\n    loc_x := 0\n\n    for curr_x := 0; curr_x &lt; size_board; curr_x++ {\n\n        loc_y := 0\n        for curr_y := 0; curr_y &lt; size_board; curr_y++ {\n\n            draw.Draw(myimage, image.Rect(loc_x, loc_y, loc_x+size_block, loc_y+size_block),\n                &amp;image.Uniform{colors[index_color]}, image.ZP, draw.Src)\n\n            loc_y += size_block\n            index_color = 1 - index_color // toggle from 0 to 1 to 0 to 1 to ...\n        }\n        loc_x += size_block\n        index_color = 1 - index_color // toggle from 0 to 1 to 0 to 1 to ...\n    }\n    myfile, err := os.Create(new_png_file) \n    if err != nil {\n        panic(err.Error())\n    }\n    defer myfile.Close()\n    png.Encode(myfile, myimage) // ... save image\n    fmt.Println(&quot;firefox &quot;, new_png_file) // view image issue : firefox  /tmp/chessboard.png\n}\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/6MB2l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6MB2l.png\" alt=\"\" /></a></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5939867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d57f7e2ff5f00ff3d2ce620592788cf?s=128&d=identicon&r=PG", "display_name": "henyxia", "link": "https://stackoverflow.com/users/5939867/henyxia"}, "is_accepted": false, "score": 1, "last_activity_date": 1618075943, "creation_date": 1618075943, "answer_id": 67037356, "question_id": 28992396, "link": "https://stackoverflow.com/questions/28992396/draw-a-rectangle-in-golang/67037356#67037356", "title": "Draw a rectangle in Golang?", "body": "<p>I got here because I wanted to draw a rectangle (just the border) on from an existing picture. It adds to @Fakeer response the reading and writing on disk.</p>\n<pre><code>import (\n    &quot;os&quot;\n    &quot;image&quot;\n    &quot;image/png&quot;\n    _ &quot;image/jpeg&quot;\n    &quot;image/color&quot;\n    &quot;image/draw&quot;\n)\n\nfunc drawRectangle(img draw.Image, color color.Color, x1, y1, x2, y2 int) {\n    for i:= x1; i&lt;x2; i++ {\n        img.Set(i, y1, color)\n        img.Set(i, y2, color)\n    }\n\n    for i:= y1; i&lt;=y2; i++ {\n        img.Set(x1, i, color)\n        img.Set(x2, i, color)\n    }\n}\n\nfunc addRectangleToFace(img draw.Image, rect image.Rectangle) (draw.Image) {\n    myColor := color.RGBA{255, 0, 255, 255}\n\n    min := rect.Min\n    max := rect.Max\n\n    drawRectangle(img, myColor, min.X, min.Y, max.X, max.Y)\n\n    return img\n}\n\nfunc getImageFromFilePath(filePath string) (draw.Image, error) {\n\n    // read file\n    f, err := os.Open(filePath)\n    if err != nil {\n        return nil, err\n    }\n    defer f.Close()\n\n    // convert as image.Image\n    orig, _, err := image.Decode(f)\n\n    // convert as usable image\n    b := orig.Bounds()\n    img := image.NewRGBA(image.Rect(0, 0, b.Dx(), b.Dy()))\n    draw.Draw(img, img.Bounds(), orig, b.Min, draw.Src)\n\n    return img, err\n}\n\nfunc main() {\n    // read file and convert it\n    src, err := getImageFromFilePath(&quot;src.png&quot;)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    myRectangle := image.Rect(10, 20, 30, 40)\n\n    dst := addRectangleToFace(src, myRectangle)\n\n    outputFile, err := os.Create(&quot;dst.png&quot;)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    png.Encode(outputFile, dst)\n\n    outputFile.Close()\n}\n</code></pre>\n<p>Which gives the following result:\n<a href=\"https://i.stack.imgur.com/nHc6p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nHc6p.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 719, "user_id": 2388005, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/273ccccd4233ba91e2eb7bc0696bedf6?s=128&d=identicon&r=PG", "display_name": "Fakeer", "link": "https://stackoverflow.com/users/2388005/fakeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27865, "favorite_count": 10, "accepted_answer_id": 29004191, "answer_count": 5, "score": 27, "last_activity_date": 1618075943, "creation_date": 1426092040, "last_edit_date": 1542098965, "question_id": 28992396, "link": "https://stackoverflow.com/questions/28992396/draw-a-rectangle-in-golang", "title": "Draw a rectangle in Golang?", "body": "<p>I want to draw a mailing label with some rectangles, barcodes, and then finally generate a PNG/PDF file.</p>\n\n<p>Is there is a better way to draw a shape in Go other than to do it with primitives - pixel by pixel?</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1426093051, "post_id": 28992673, "comment_id": 46233543, "body": "I&#39;m not sure, but for your specific use case <code>&#47;&#47; #include &quot;_cgo_export.h&quot;</code> immediately before the <code>import &quot;C&quot;</code> might also work."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1426885014, "last_edit_date": 1426885014, "creation_date": 1426092807, "answer_id": 28992673, "question_id": 28992375, "link": "https://stackoverflow.com/questions/28992375/preprocessor-flag-to-detect-cgo-build/28992673#28992673", "title": "Preprocessor flag to detect CGO build?", "body": "<p>From the <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">documentation</a> just do:</p>\n\n<pre><code>// #cgo CFLAGS: -DWHATEVER_YOU_WANT_TO_INDICATE_CGO=1\nimport \"C\"\n</code></pre>\n\n<p>(or just <code>-D FOO</code> if you don't want a value) or set <code>CGO_CFLAGS</code> in the environment.</p>\n\n<p>You can see what is happening behind the scenes with <code>go build -x</code>.\nFor me it shows <code>-D GOOS_freebsd -D GOARCH_amd64</code> while compiling the cgo generated <code>_cgo_defun.c</code> file, but <em>only</em> for that file and <strong>not</strong> to my own *.c files. So I don't think there are any usable predefined preprocessor flags (and the documentation also doesn't mention any).</p>\n"}], "owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 28992673, "answer_count": 1, "score": 3, "last_activity_date": 1426885014, "creation_date": 1426091983, "question_id": 28992375, "link": "https://stackoverflow.com/questions/28992375/preprocessor-flag-to-detect-cgo-build", "title": "Preprocessor flag to detect CGO build?", "body": "<p>In a c file that's beside my go file and is compiled together via CGO, I'd like to check via preprocessor whether it's being compiled via go or not. I'd like to do this because, for example, I'd like to protect <code>#include _cgo_export.h</code> with <code>#ifdef</code> flags, since such header exists solely during compilation and I don't want my editor to warn about its absence.</p>\n"}, {"tags": ["syntax", "go", "return-type", "variable-declaration"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 5, "creation_date": 1426093222, "post_id": 28992271, "comment_id": 46233660, "body": "Why do you want to avoid <code>:=</code>? It&#39;s standard idiomatic Go."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1426098036, "post_id": 28992271, "comment_id": 46236910, "body": "A &quot;I do not wish to...&quot;-attitude with Go will become very painful in short time."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426127087, "post_id": 28992271, "comment_id": 46249480, "body": "To be fair, there are reasons (which is why I asked). E.g. wanting an <code>io.Reader</code> variable that gets initialized from one of <code>os.Open</code> or if that fails from something else. In such cases I usually just do something like <code>var r io.Reader; var err error</code> then <code>r, err = os.Open(\u2026)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 6, "last_activity_date": 1426121704, "last_edit_date": 1426121704, "creation_date": 1426092201, "answer_id": 28992452, "question_id": 28992271, "link": "https://stackoverflow.com/questions/28992271/how-do-i-declare-multiple-variables-instantiated-by-a-function-call-returning-mu/28992452#28992452", "title": "How do I declare multiple variables instantiated by a function call returning multiple values in Go?", "body": "<p>In most cases, the correct way to do this is to use the shorthand syntax. That's what it's for.</p>\n\n<p>If you don't want to use the shorthand syntax, then you can use <code>var</code> syntax:</p>\n\n<pre><code>var b bool\nvar s string\nb, s = foo()\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var (\n    b bool\n    s string\n)\nb, s = foo()\n</code></pre>\n\n<p>There is no \"shorthand var\" syntax.</p>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1426092262, "creation_date": 1426092262, "answer_id": 28992479, "question_id": 28992271, "link": "https://stackoverflow.com/questions/28992271/how-do-i-declare-multiple-variables-instantiated-by-a-function-call-returning-mu/28992479#28992479", "title": "How do I declare multiple variables instantiated by a function call returning multiple values in Go?", "body": "<p>You can't do that. The Go Spec defines a <a href=\"http://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow\">variable declaration</a> grammar as follows:</p>\n\n<pre><code>VarDecl     = \"var\" ( VarSpec | \"(\" { VarSpec \";\" } \")\" ) .\nVarSpec     = IdentifierList ( Type [ \"=\" ExpressionList ] | \"=\" ExpressionList ) .\n</code></pre>\n\n<p>Variables in the <code>IdentifierList</code> can only have either one <code>Type</code> for all, or none. The best you can do is either</p>\n\n<pre><code>var b, s = foo()\n</code></pre>\n\n<p>or, if you want them at the top level of your package,</p>\n\n<pre><code>var (\n    b bool\n    s string\n)\n\nfunc init() {\n    b, s = foo()\n}\n</code></pre>\n"}], "owner": {"reputation": 26374, "user_id": 229792, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/NIE5f.jpg?s=128&g=1", "display_name": "jameshfisher", "link": "https://stackoverflow.com/users/229792/jameshfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 28992452, "answer_count": 2, "score": 0, "last_activity_date": 1426121704, "creation_date": 1426091675, "question_id": 28992271, "link": "https://stackoverflow.com/questions/28992271/how-do-i-declare-multiple-variables-instantiated-by-a-function-call-returning-mu", "title": "How do I declare multiple variables instantiated by a function call returning multiple values in Go?", "body": "<p>Let's say I have a function:</p>\n\n<pre><code>func foo() (bool, string) { ... }\n</code></pre>\n\n<p>And then I wish to declare two variables <code>b</code> and <code>s</code>, initialized with values returned by the function call <code>foo()</code>. I'm aware I can do this using the \"shorthand\" syntax which omits type annotations:</p>\n\n<pre><code>b, s := foo();\n</code></pre>\n\n<p>However, I do not wish to use this shorthand syntax. I wish to use the <code>var</code> syntax with a variable name and expected type. I have tried this:</p>\n\n<pre><code>var b bool, s string = foo();\n</code></pre>\n\n<p>However, this gives me a syntax error. What is the correct way to do this?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 2, "creation_date": 1426089029, "post_id": 28991223, "comment_id": 46230643, "body": "<a href=\"https://github.com/antonholmquist/jason\" rel=\"nofollow noreferrer\">This</a> library is excellent if you aren&#39;t opposed to using a third-party solution."}, {"owner": {"reputation": 45, "user_id": 1014937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b42524931faec71b7e52ca45b8210ce?s=128&d=identicon&r=PG", "display_name": "victorcete", "link": "https://stackoverflow.com/users/1014937/victorcete"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1426091005, "post_id": 28991223, "comment_id": 46232114, "body": "Thank you, it seems like a really good alternative!"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 1014937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b42524931faec71b7e52ca45b8210ce?s=128&d=identicon&r=PG", "display_name": "victorcete", "link": "https://stackoverflow.com/users/1014937/victorcete"}, "edited": false, "score": 0, "creation_date": 1426090618, "post_id": 28991664, "comment_id": 46231832, "body": "Thanks for taking your time on explaining this, much appreciated!"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1426092408, "post_id": 28991664, "comment_id": 46233095, "body": "If, like your example data, all data points are exactly two values you can use an array: <code>type DataPoint [2]float64</code>. If you need to detect the difference between 0 and null in the input data (or to re-encode to JSON with a difference between 0 and nil) you can make it a pointer: <code>type DataPoint []*float64</code> or <code>type DataPoint [2]*float64</code>."}], "tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": true, "score": 5, "last_activity_date": 1426089986, "creation_date": 1426089986, "answer_id": 28991664, "question_id": 28991223, "link": "https://stackoverflow.com/questions/28991223/json-on-golang-unmarshal-graphite-data/28991664#28991664", "title": "JSON on Golang - Unmarshal Graphite Data", "body": "<p>I like to start at the simplest type and work my way out.  First you need to represent your data point.</p>\n\n<p><code>type DataPoint []float64</code></p>\n\n<p>Then a metric is just a target and a series of data points.</p>\n\n<pre><code>type Metric struct {\n    Target string      `json:\"target\"`\n    Points []DataPoint `json:\"datapoints\"`\n}\n</code></pre>\n\n<p>There is no need for your <code>Graphite</code> struct.  Your JSON is just a JSON array of <code>Metric</code>s.</p>\n\n<pre><code>var results []Metric\nerr := json.Unmarshal([]byte(data), &amp;results)\n</code></pre>\n\n<p>Here's a <a href=\"http://play.golang.org/p/70vCFF6gI-\" rel=\"noreferrer\">playground</a> link with a complete example.</p>\n"}, {"tags": [], "owner": {"reputation": 777, "user_id": 227168, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/58c7e3f8e966e0a1ed220dd2edef71b7?s=128&d=identicon&r=PG&f=1", "display_name": "Dieter_be", "link": "https://stackoverflow.com/users/227168/dieter-be"}, "is_accepted": false, "score": 0, "last_activity_date": 1510160350, "creation_date": 1510160350, "answer_id": 47185490, "question_id": 28991223, "link": "https://stackoverflow.com/questions/28991223/json-on-golang-unmarshal-graphite-data/47185490#47185490", "title": "JSON on Golang - Unmarshal Graphite Data", "body": "<p>The problem with the above answer is it turns null points into points with value 0, which is not correct. Null means \"not known\". Some people suggest using pointers to floats so nil pointer means \"no value\", but that has a significant overhead (e.g. 8bytes on most 64bit platforms, not to mention the memory dereferencing overhead).</p>\n\n<p>Better to use golang's math NaN support to mark nulls, which requires no additional data as it's built into the float representation.\nYou can do this with a custom Unmarshal function like so:</p>\n\n<pre><code>type Metric struct {\n    Target     string\n    Datapoints []Point\n}\n\ntype Point struct {\n    Val float64\n    Ts  uint32\n}\n\nvar errInvalidFormat = errors.New(\"invalid format\")\n\nfunc (p *Point) UnmarshalJSON(data []byte) error {\n    if len(data) &lt; 2 {\n        return errInvalidFormat\n    }\n    // find first digit or 'n' for \"null\"\n    for (data[0] &lt; 48 || data[0] &gt; 57) &amp;&amp; data[0] != 110 {\n        if len(data) == 1 {\n            return errInvalidFormat\n        }\n        data = data[1:]\n    }\n    // find comma\n    var i int\n    for i = 0; i &lt; len(data); i++ {\n        if data[i] == 44 {\n            break\n        }\n    }\n    if i == 0 {\n        return errInvalidFormat\n    }\n\n    if bytes.HasPrefix(data[:i], []byte(\"null\")) {\n        p.Val = math.NaN()\n    } else {\n        fl, err := strconv.ParseFloat(string(data[:i]), 64)\n        if err != nil {\n            return err\n        }\n        p.Val = fl\n    }\n    data = data[i:]\n    if len(data) &lt; 2 {\n        return errInvalidFormat\n    }\n\n    // find first digit\n    for (data[0] &lt; 48 || data[0] &gt; 57) &amp;&amp; data[0] != 110 {\n        if len(data) == 1 {\n            return errInvalidFormat\n        }\n        data = data[1:]\n    }\n    // find last digit\n    for i = 0; data[i] &gt;= 48 &amp;&amp; data[i] &lt;= 57 &amp;&amp; i &lt; len(data); i++ {\n    }\n    if i == 0 {\n        return errInvalidFormat\n    }\n\n    ts, err := strconv.ParseUint(string(data[:i]), 10, 32)\n    if err != nil {\n        return err\n    }\n    p.Ts = uint32(ts)\n    return nil\n}\n</code></pre>\n\n<p>Full example program: <a href=\"https://play.golang.org/p/qqI1RBqA_H%20qqI1RBqA_H\" rel=\"nofollow noreferrer\">on playground</a></p>\n"}], "owner": {"reputation": 45, "user_id": 1014937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b42524931faec71b7e52ca45b8210ce?s=128&d=identicon&r=PG", "display_name": "victorcete", "link": "https://stackoverflow.com/users/1014937/victorcete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 28991664, "answer_count": 2, "score": 3, "last_activity_date": 1510160350, "creation_date": 1426088875, "question_id": 28991223, "link": "https://stackoverflow.com/questions/28991223/json-on-golang-unmarshal-graphite-data", "title": "JSON on Golang - Unmarshal Graphite Data", "body": "<p>I am playing around with Golang and JSON trying to do some calculations with data extracted from Graphite API.</p>\n\n<p>For simplicity, a snippet of the data sent by Graphite is:</p>\n\n<pre><code>[\n{\n    \"target\": \"server1.loadavg.1min\",\n    \"datapoints\": [\n        [\n            0.16,\n            1422770850\n        ],\n        [\n            0.16,\n            1422770880\n        ],\n        [\n            null,\n            1422771120\n        ]\n    ]\n},\n{\n    \"target\": \"server2.loadavg.1min\",\n    \"datapoints\": [\n        [\n            0.19,\n            1422770850\n        ],\n        [\n            null,\n            1422771390\n        ],\n        [\n            0.14,\n            1422771420\n        ]\n    ]\n}\n]\n</code></pre>\n\n<p>I've been reading through <a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow\">the go json tutorial</a> about how to use a generic interface{} for JSON arbitrary data, but I'm struggling with some aspects of the process.</p>\n\n<p>I've tried to define a structure that will hold this data, read the file contents and unmarshal it to this structure:</p>\n\n<pre><code>type Graphite struct {\n  Metric struct {\n    Target     string      `json:\"target\"`\n    Datapoints [][]float64 `json:\"datapoints\"`\n  }\n}\n\nvar results []Graphite\nerr = json.Unmarshal(d, &amp;r)\nif err != nil {\n    panic(err)\n}\nfmt.Printf(\"%v\\n\", r)\n</code></pre>\n\n<p>But the result is:</p>\n\n<pre><code>[{{ []}} {{ []}}]\n</code></pre>\n\n<p>I could do it of course with a generic interface{} but I would like to know what am I missing here.</p>\n\n<p>Could you please help me?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["email", "ssl", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1426096849, "post_id": 28985665, "comment_id": 46236156, "body": "have you included the intermediate cert in postfix&#39;s cert pem?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1426097200, "post_id": 28985665, "comment_id": 46236391, "body": "openssl&#39;s client can connect to starttls services too: <code>openssl s_client -connect example.com:25 -starttls smtp</code>"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1426407070, "post_id": 28985665, "comment_id": 46353639, "body": "The problem is not the connection itself, but the validation of the certificate. <code>openssl s_client</code> will connect even if the certificate can not be validated but it will tell you about this in the verbose output."}], "owner": {"reputation": 1034, "user_id": 2089648, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b29d87d89de9c1abac217464e57b191?s=128&d=identicon&r=PG", "display_name": "user2089648", "link": "https://stackoverflow.com/users/2089648/user2089648"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1591, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1426073924, "creation_date": 1426073924, "question_id": 28985665, "link": "https://stackoverflow.com/questions/28985665/golang-x-509-unknown-authority-on-smtp-but-no-error-on-tls", "title": "golang &quot;x.509 unknown authority&quot; on smtp, but no error on tls", "body": "<p>When trying to send a mail with golang to my local postfix server I get the error<br>\nx509: certificate signed by unknown authority<br>\nConsider the following code:</p>\n\n<pre><code>config := &amp;tls.Config{ServerName: \"example.com\"}\n_, err := tls.Dial(\"tcp\", \"example.com:443\", config)\n//err == nil\nc,_ := smtp.Dial(\"example.com:25\")\nerr = c.StartTLS(config)\n//err == x509: certificate signed by unknown authority\n</code></pre>\n\n<p>Apache and postfix both use the same cert signed by StartSSL.</p>\n\n<p>How comes it is accepted in one instance and rejected in the other?<br>\nAs a sidenote: is it possible to get more information on the certificate in the smtp case?</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1426071469, "post_id": 28983956, "comment_id": 46218225, "body": "try with a <code>*math&#47;big.Rat</code> and if that doesn&#39;t work use an <code>int64</code> as amount of cents."}, {"owner": {"reputation": 1, "user_id": 7841940, "user_type": "registered", "profile_image": "https://graph.facebook.com/292909697807398/picture?type=large", "display_name": "Vladimir Vasconcelos", "link": "https://stackoverflow.com/users/7841940/vladimir-vasconcelos"}, "edited": false, "score": 0, "creation_date": 1534691473, "post_id": 28983956, "comment_id": 90794771, "body": "I don&#39;t think measure currency with <code>float32</code> seems to be a recommended approach. <code>big.float64</code> or <code>decimal</code> github.com/shopspring/decimal is a better idea indeed."}, {"owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "edited": false, "score": 0, "creation_date": 1534698198, "post_id": 28983956, "comment_id": 90794772, "body": "Why do you think float64 is significantly better than float32 for currencies? Please note I never suggested to use floats for currencies at all."}], "answers": [{"tags": [], "owner": {"reputation": 563, "user_id": 3096935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2b2f03ab65bb90ea760a384c48154e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Babcock", "link": "https://stackoverflow.com/users/3096935/michael-babcock"}, "is_accepted": false, "score": 3, "last_activity_date": 1455510322, "creation_date": 1455510322, "answer_id": 35401474, "question_id": 28983956, "link": "https://stackoverflow.com/questions/28983956/does-gorm-have-a-decimal-datatype/35401474#35401474", "title": "Does GORM have a Decimal datatype?", "body": "<p>If you're using <a href=\"https://github.com/jinzhu/gorm#migration\" rel=\"nofollow\">AutoMigrate</a>, you can give <a href=\"https://github.com/jinzhu/gorm#define-models-structs\" rel=\"nofollow\">GORM SQL instructions (in your struct model)</a> on how to build the table. Try something like the following:</p>\n\n<pre><code>type Product struct {\nId           int\nProductName  string    `sql:\"type:varchar(250);\"`\nAmount       float32   `sql:\"type:decimal(10,2);\"` \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 6710039, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oUkhXKd3g9g/AAAAAAAAAAI/AAAAAAAAADI/s6uf3CtpuO4/photo.jpg?sz=128", "display_name": "Ethan Davis", "link": "https://stackoverflow.com/users/6710039/ethan-davis"}, "is_accepted": false, "score": 4, "last_activity_date": 1495462529, "creation_date": 1495462529, "answer_id": 44115197, "question_id": 28983956, "link": "https://stackoverflow.com/questions/28983956/does-gorm-have-a-decimal-datatype/44115197#44115197", "title": "Does GORM have a Decimal datatype?", "body": "<p>I know this is a little old but I had this issue and it's very hard to find the answer. if you're using Gorm with liquibase use BigDecimal for any floating point numbers. </p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 4221452, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JVAQuULuylE/AAAAAAAAAAI/AAAAAAAABow/NvHTX7tiM2k/photo.jpg?sz=128", "display_name": "devneko", "link": "https://stackoverflow.com/users/4221452/devneko"}, "is_accepted": false, "score": 10, "last_activity_date": 1504602729, "creation_date": 1504602729, "answer_id": 46051199, "question_id": 28983956, "link": "https://stackoverflow.com/questions/28983956/does-gorm-have-a-decimal-datatype/46051199#46051199", "title": "Does GORM have a Decimal datatype?", "body": "<p>Michael's answer works. But If you want to use decimal type with golang, you can use <a href=\"https://github.com/shopspring/decimal\" rel=\"noreferrer\">shopspring/decimal</a> like this:</p>\n\n<pre><code>type TableName struct {\n  Amount    decimal.Decimal `json:\"amount\" sql:\"type:decimal(20,8);\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 10385339, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rtNmbFVAFXM/AAAAAAAAAAI/AAAAAAAAAqU/fKtryjyE0Gc/photo.jpg?sz=128", "display_name": "Simon", "link": "https://stackoverflow.com/users/10385339/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1604350409, "creation_date": 1604350409, "answer_id": 64653182, "question_id": 28983956, "link": "https://stackoverflow.com/questions/28983956/does-gorm-have-a-decimal-datatype/64653182#64653182", "title": "Does GORM have a Decimal datatype?", "body": "<p>This one works for me:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>type Product struct {\n      decimal.Decimal `gorm:&quot;type:decimal(7,6);&quot;`\n}\n</code></pre>\n<p>I was also trying the suggested <code>sql:</code> but columns end up as <code>text</code> fields in sqlite3 when using gorm's <code>AutoMigrate()</code>.</p>\n"}], "owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7606, "favorite_count": 1, "answer_count": 4, "score": 2, "last_activity_date": 1604350409, "creation_date": 1426069308, "question_id": 28983956, "link": "https://stackoverflow.com/questions/28983956/does-gorm-have-a-decimal-datatype", "title": "Does GORM have a Decimal datatype?", "body": "<p>Does <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow\">GORM</a> have a decimal datatype to store money values (-> <code>Decimal(8,2)</code>)?</p>\n\n<p>I could not find it on <a href=\"https://github.com/jinzhu/gorm#define-models-structs\" rel=\"nofollow\">https://github.com/jinzhu/gorm#define-models-structs</a></p>\n"}, {"tags": ["string", "file", "go", "int"], "comments": [{"owner": {"reputation": 325, "user_id": 2205050, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d910db197ae566e4e46b35e9aefbcc18?s=128&d=identicon&r=PG", "display_name": "darul75", "link": "https://stackoverflow.com/users/2205050/darul75"}, "edited": false, "score": 0, "creation_date": 1426069404, "post_id": 28983831, "comment_id": 46216822, "body": "I gonna try ScanLines instead too now"}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 2, "creation_date": 1426075660, "post_id": 28983831, "comment_id": 46220905, "body": "Please, check the errors in the examples (and always). They will tell you why it returned 0 (the zero-value) instead of what you are expecting."}, {"owner": {"reputation": 325, "user_id": 2205050, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d910db197ae566e4e46b35e9aefbcc18?s=128&d=identicon&r=PG", "display_name": "darul75", "link": "https://stackoverflow.com/users/2205050/darul75"}, "reply_to_user": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1426076381, "post_id": 28983831, "comment_id": 46221334, "body": "I will but this case was so trivial to watch it carefuly but thank you for advise"}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 2205050, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d910db197ae566e4e46b35e9aefbcc18?s=128&d=identicon&r=PG", "display_name": "darul75", "link": "https://stackoverflow.com/users/2205050/darul75"}, "edited": false, "score": 0, "creation_date": 1426070318, "post_id": 28984118, "comment_id": 46217395, "body": "I was escaping &#39;\\n&#39; but not &#39;\\r&#39; thank you, trust me I was reading the documentation about delimiter included but forgot about carriage return char"}], "tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": false, "score": 1, "last_activity_date": 1426069720, "creation_date": 1426069720, "answer_id": 28984118, "question_id": 28983831, "link": "https://stackoverflow.com/questions/28983831/golang-read-text-file-line-by-line-of-int-strings/28984118#28984118", "title": "golang: read text file line by line of int strings", "body": "<p>If you look at the documentation of <code>ReadString</code> you will notice that the <code>string</code> returned will include the delimiter (in your case <code>\\n</code>).</p>\n\n<blockquote>\n  <p>ReadString reads until the first occurrence of delim in the input,\n  returning a string containing the data up to and including the\n  delimiter.</p>\n</blockquote>\n\n<p>And because the length of the line after reading 10 is 4 I would assume that the lines are delimited by <code>\\r\\n</code>. The easiest way to remove it is using one of the <code>Trim</code> functions (like <a href=\"http://golang.org/pkg/strings/#TrimSpace\" rel=\"nofollow\">TrimSpace</a>).</p>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 2205050, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d910db197ae566e4e46b35e9aefbcc18?s=128&d=identicon&r=PG", "display_name": "darul75", "link": "https://stackoverflow.com/users/2205050/darul75"}, "edited": false, "score": 0, "creation_date": 1426070385, "post_id": 28984161, "comment_id": 46217441, "body": "I was re implementing it with a scanner and it works, thank you all"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426091111, "post_id": 28984161, "comment_id": 46232193, "body": "Although I like using <code>bufio.Scanner</code> as well, for this specific case a simple <code>fmt.Fscanln(r, &amp;intvar)</code> works well (perhaps wrapping the original reader with <code>bufio.NewReader</code> for more efficient reading depending on the source)."}], "tags": [], "owner": {"reputation": 221, "user_id": 2729715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/477dc0e93e54bedc7521bf85f9ebf7c5?s=128&d=identicon&r=PG&f=1", "display_name": "csabiftw", "link": "https://stackoverflow.com/users/2729715/csabiftw"}, "is_accepted": true, "score": 4, "last_activity_date": 1426069845, "creation_date": 1426069845, "answer_id": 28984161, "question_id": 28983831, "link": "https://stackoverflow.com/questions/28983831/golang-read-text-file-line-by-line-of-int-strings/28984161#28984161", "title": "golang: read text file line by line of int strings", "body": "<p>From the documentation: \"ReadString reads until the first occurrence of delim in the input, returning a string containing the data up to and including the delimiter.\"</p>\n\n<p>Because of this, i suggest you use a scanner, which handles this case like you would expect:</p>\n\n<pre><code>scanner := bufio.NewScanner(file)\nfor scanner.Scan() {\n    lineStr := scanner.Text()\n    num, _ := strconv.Atoi(lineStr)\n    fmt.Println(lineStr, num)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 1, "last_activity_date": 1426070021, "creation_date": 1426070021, "answer_id": 28984217, "question_id": 28983831, "link": "https://stackoverflow.com/questions/28983831/golang-read-text-file-line-by-line-of-int-strings/28984217#28984217", "title": "golang: read text file line by line of int strings", "body": "<p>Citing the documentation of <a href=\"http://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow\">bufio.Reader.ReadString</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>ReadString reads until the first occurrence of delim in the input, returning a string containing the data <strong>up to and including the delimiter</strong>.</p>\n</blockquote>\n\n<p>Now, the documentation of <a href=\"https://godoc.org/strconv#ParseInt\" rel=\"nofollow\">strconv.ParseInt</a></p>\n\n<blockquote>\n  <p>The errors that ParseInt returns have concrete type *NumError and include err.Num = s. <strong>If s is empty or contains invalid digits, err.Err = ErrSyntax and the returned value is 0</strong></p>\n</blockquote>\n\n<p>Your problem is that the <code>ReadString</code> method return also the <code>\\n</code> that terminate the line, which is an invalid character for the <code>ParseInt</code> function.</p>\n\n<p>You can check the real error with the following snippet</p>\n\n<pre><code>i, err := strconv.ParseInt(line, 10, 64)\nif err != nil {\n    switch err.(*strconv.NumError).Err {\n        case strconv.ErrSyntax:\n            fmt.Println(\"syntax error\")\n        case strconv.ErrRange:\n            fmt.Println(\"out of range value\")\n    }\n}\n</code></pre>\n\n<p>Advice: use <a href=\"https://godoc.org/strings#TrimSpace\" rel=\"nofollow\"><code>strings.TrimSpace</code></a> to clean your input.</p>\n"}], "owner": {"reputation": 325, "user_id": 2205050, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d910db197ae566e4e46b35e9aefbcc18?s=128&d=identicon&r=PG", "display_name": "darul75", "link": "https://stackoverflow.com/users/2205050/darul75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4474, "favorite_count": 1, "accepted_answer_id": 28984161, "answer_count": 3, "score": 2, "last_activity_date": 1426070021, "creation_date": 1426068965, "question_id": 28983831, "link": "https://stackoverflow.com/questions/28983831/golang-read-text-file-line-by-line-of-int-strings", "title": "golang: read text file line by line of int strings", "body": "<p>I am dealing with an input file containing a list of integers as a string</p>\n\n<pre><code>10\n..\n</code></pre>\n\n<p>I have choosen to read it line by line with <a href=\"http://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow\">ReadString('\\n')</a> method</p>\n\n<p>The following code </p>\n\n<pre><code>line, error := inputReader.ReadString('\\n')\nlineStr := string(line)\n</code></pre>\n\n<p>console output (length and value)</p>\n\n<pre><code>lineStr %v 4\nlineStr %v 10\n</code></pre>\n\n<p>lineStr as a length of \"4\", maybe because of rune encoding.</p>\n\n<p>Then I have tried several way to convert it to simple integer but with no success.</p>\n\n<p><strong>Ex1</strong></p>\n\n<pre><code>num, _ := strconv.ParseUint(lineStr, 0, 64)\n</code></pre>\n\n<p>ouputs a num of 0 (should be 10)</p>\n\n<p><strong>Ex2</strong></p>\n\n<pre><code>num, _ := strconv.Atoi(lineStr)\n</code></pre>\n\n<p>ouputs a num of 0 (should be 10)</p>\n\n<p><strong>Ex3</strong></p>\n\n<pre><code>num, _ := strconv.Atoi(\"10\")\n</code></pre>\n\n<p>ouputs a num of 10 (ok)</p>\n\n<p><strong>Ex4</strong></p>\n\n<pre><code>num, _ := strconv.ParseUint(\"10\", 0, 64)\n</code></pre>\n\n<p>ouputs a num of 10 (ok)</p>\n\n<p>string in literal are ok but string from file do not work, what is wrong ?</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["javascript", "html", "go"], "comments": [{"owner": {"reputation": 15, "user_id": 4562036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M2pNZv8TfrU/AAAAAAAAAAI/AAAAAAAAABE/c8jspWZe_Tc/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/4562036/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1426067580, "post_id": 28983221, "comment_id": 46215733, "body": "I include by simply writing this line of code in HTML file: &lt;script src=&quot;myscripts.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;"}, {"owner": {"reputation": 10107, "user_id": 142191, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aqN2A.png?s=128&g=1", "display_name": "Ali Habibzadeh", "link": "https://stackoverflow.com/users/142191/ali-habibzadeh"}, "edited": false, "score": 0, "creation_date": 1426067681, "post_id": 28983221, "comment_id": 46215806, "body": "If those html files are fragments in deeper folders ensure that the script path is relative based on the final page they are inject to and not the template itself"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426091353, "post_id": 28983221, "comment_id": 46232381, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/28899675/include-js-file-in-go-template\">Include js file in Go template</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4562036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M2pNZv8TfrU/AAAAAAAAAAI/AAAAAAAAABE/c8jspWZe_Tc/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/4562036/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1426070034, "post_id": 28983367, "comment_id": 46217218, "body": "Thank you. I found a way which add to main() this line of code:"}, {"owner": {"reputation": 931, "user_id": 1136504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QstOL.jpg?s=128&g=1", "display_name": "DannyThunder", "link": "https://stackoverflow.com/users/1136504/dannythunder"}, "reply_to_user": {"reputation": 15, "user_id": 4562036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M2pNZv8TfrU/AAAAAAAAAAI/AAAAAAAAABE/c8jspWZe_Tc/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/4562036/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1426074743, "post_id": 28983367, "comment_id": 46220328, "body": "If the answer helped you, mark it as right answer @RyanNguyen"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 2, "last_activity_date": 1426067731, "creation_date": 1426067731, "answer_id": 28983367, "question_id": 28983221, "link": "https://stackoverflow.com/questions/28983221/go-html-file-cant-load-external-js-file/28983367#28983367", "title": "GO - html file can&#39;t load external js file", "body": "<p>That's normal if you only define handler for your endpoints.</p>\n\n<p>You should add to your router the <a href=\"https://godoc.org/net/http#FileServer\" rel=\"nofollow\"><code>http.FileServer</code></a> handler pointing to the directory that store your project files.</p>\n\n<p>Additionally, think about the <code>&lt;base&gt;</code> that to define the root of your relative links, which will prevent errors such as path nesting.</p>\n"}], "owner": {"reputation": 15, "user_id": 4562036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M2pNZv8TfrU/AAAAAAAAAAI/AAAAAAAAABE/c8jspWZe_Tc/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/4562036/ryan-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 922, "favorite_count": 0, "accepted_answer_id": 28983367, "answer_count": 1, "score": 0, "last_activity_date": 1426070075, "creation_date": 1426067363, "last_edit_date": 1426070075, "question_id": 28983221, "link": "https://stackoverflow.com/questions/28983221/go-html-file-cant-load-external-js-file", "title": "GO - html file can&#39;t load external js file", "body": "<p>I have a GO project which has UI written by html. In HTML file, I have written javascript, and I can install GO and load the UI successfully.</p>\n\n<p>The problem is when I move those javascript code to an external file, and include it: . I only can build GO, but when load the UI, it has error 404 Not Found which is  \"myscripts.js\" file. The weird thing is on its header of error:\nRemote Address:127.0.0.1:8080\nRequest URL:<a href=\"http://localhost:8080/subscribe/myscripts.js\" rel=\"nofollow\">http://localhost:8080/subscribe/myscripts.js</a>\nRequest Method:GET\nStatus Code:404 Not Found</p>\n\n<p>Please help, I can't find any answer yet for this</p>\n"}, {"tags": ["go", "type-assertion", "strconv"], "answers": [{"comments": [{"owner": {"reputation": 13116, "user_id": 17373, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da1209aa320f9bbebbf128ac6a0751d3?s=128&d=identicon&r=PG", "display_name": "Greg Bray", "link": "https://stackoverflow.com/users/17373/greg-bray"}, "edited": false, "score": 3, "creation_date": 1426046140, "post_id": 28978090, "comment_id": 46207222, "body": "Looks like type assertions used in assignment or initialization have a second return of a boolean and do not cause a runtime panic <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Type_assertions</a>"}, {"owner": {"reputation": 4976, "user_id": 1843465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jnASr.jpg?s=128&g=1", "display_name": "Tim Pierce", "link": "https://stackoverflow.com/users/1843465/tim-pierce"}, "reply_to_user": {"reputation": 13116, "user_id": 17373, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da1209aa320f9bbebbf128ac6a0751d3?s=128&d=identicon&r=PG", "display_name": "Greg Bray", "link": "https://stackoverflow.com/users/17373/greg-bray"}, "edited": false, "score": 0, "creation_date": 1426046448, "post_id": 28978090, "comment_id": 46207294, "body": "Good point. But to take advantage of the comma ok, you&#39;ll almost certainly need to make the type assertion all by itself and not also try to dereference <code>.Err.Error()</code>. i.e. <code>if ne, ok := err.(*strconv.NumError); ok { if ne.Err.Error() == &quot;value out of range&quot;) { ... } }</code>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1426091660, "post_id": 28978090, "comment_id": 46232601, "body": "Mucking around with the string output of <code>Error()</code> in Go completely misses the point and is very bad practice."}, {"owner": {"reputation": 4976, "user_id": 1843465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jnASr.jpg?s=128&g=1", "display_name": "Tim Pierce", "link": "https://stackoverflow.com/users/1843465/tim-pierce"}, "edited": false, "score": 0, "creation_date": 1426180922, "post_id": 28978090, "comment_id": 46277047, "body": "I agree, I wasn&#39;t thinking through this problem clearly. I&#39;m glad peterSO posted his superior solution."}], "tags": [], "owner": {"reputation": 4976, "user_id": 1843465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jnASr.jpg?s=128&g=1", "display_name": "Tim Pierce", "link": "https://stackoverflow.com/users/1843465/tim-pierce"}, "is_accepted": false, "score": -1, "last_activity_date": 1426044630, "creation_date": 1426044630, "answer_id": 28978090, "question_id": 28977718, "link": "https://stackoverflow.com/questions/28977718/detect-value-out-of-range-errors-using-type-assertion-in-golang/28978090#28978090", "title": "Detect value out of range errors using type assertion in Golang", "body": "<p>The error that's returned from <code>strconv.ParseInt</code> is only known at compile time to be some type that implements the Error interface.  Type assertion allows you to insist that it's a <code>strconv.NumError</code> and inspect its fields directly, but at the risk of throwing a runtime panic if you turn out to be wrong:</p>\n\n<pre><code>if err.(*strconv.NumError).Err.Error() == \"value out of range\" {\n    uv, err := strconv.ParseUint(\"18446744073709551448\", 10, 64)\n}\n</code></pre>\n\n<p>A more flexible solution (but maybe too loosey-goosey for your purposes) would be to perform a substring match on the <code>err.Error()</code> method:</p>\n\n<pre><code>if strings.Contains(err.Error(), \"value out of range\") {\n    uv, err := strconv.ParseUint(\"18446744073709551448\", 10, 64)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13116, "user_id": 17373, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da1209aa320f9bbebbf128ac6a0751d3?s=128&d=identicon&r=PG", "display_name": "Greg Bray", "link": "https://stackoverflow.com/users/17373/greg-bray"}, "edited": false, "score": 0, "creation_date": 1426046183, "post_id": 28978109, "comment_id": 46207229, "body": "Exactly what I wanted... Thanks!"}, {"owner": {"reputation": 13116, "user_id": 17373, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da1209aa320f9bbebbf128ac6a0751d3?s=128&d=identicon&r=PG", "display_name": "Greg Bray", "link": "https://stackoverflow.com/users/17373/greg-bray"}, "edited": false, "score": 0, "creation_date": 1426097235, "post_id": 28978109, "comment_id": 46236412, "body": "It would be nice if they added more examples. The error handling documentation didn&#39;t really cover this very well."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 11, "last_activity_date": 1426075575, "last_edit_date": 1426075575, "creation_date": 1426044782, "answer_id": 28978109, "question_id": 28977718, "link": "https://stackoverflow.com/questions/28977718/detect-value-out-of-range-errors-using-type-assertion-in-golang/28978109#28978109", "title": "Detect value out of range errors using type assertion in Golang", "body": "<p>We have,</p>\n\n<blockquote>\n  <p><a href=\"http://golang.org/pkg/strconv/\" rel=\"noreferrer\">Package strconv</a></p>\n  \n  <p><code>var ErrRange = errors.New(\"value out of range\")</code></p>\n  \n  <p><a href=\"http://golang.org/pkg/strconv/#pkg-variables\" rel=\"noreferrer\">ErrRange</a> indicates that a value is out of range for the target type.</p>\n\n<pre><code>type NumError struct {\n        Func string // the failing function (ParseBool, ParseInt, ParseUint, ParseFloat)\n        Num  string // the input\n        Err  error  // the reason the conversion failed (ErrRange, ErrSyntax)\n}\n</code></pre>\n  \n  <p>A <a href=\"http://golang.org/pkg/strconv/#NumError\" rel=\"noreferrer\">NumError</a> records a failed conversion.</p>\n\n<pre><code>func (e *NumError) Error() string\n</code></pre>\n</blockquote>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    iv, err := strconv.ParseInt(\"18446744073709551448\", 10, 64)\n    if err != nil {\n        if numError, ok := err.(*strconv.NumError); ok {\n            if numError.Err == strconv.ErrRange {\n                fmt.Println(\"Detected\", numError.Num, \"as a\", strconv.ErrRange)\n                return\n            }\n        }\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(iv)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre>\nDetected 18446744073709551448 as a value out of range\n</pre>\n"}], "owner": {"reputation": 13116, "user_id": 17373, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da1209aa320f9bbebbf128ac6a0751d3?s=128&d=identicon&r=PG", "display_name": "Greg Bray", "link": "https://stackoverflow.com/users/17373/greg-bray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1789, "favorite_count": 2, "accepted_answer_id": 28978109, "answer_count": 2, "score": 1, "last_activity_date": 1426097586, "creation_date": 1426041959, "last_edit_date": 1426097586, "question_id": 28977718, "link": "https://stackoverflow.com/questions/28977718/detect-value-out-of-range-errors-using-type-assertion-in-golang", "title": "Detect value out of range errors using type assertion in Golang", "body": "<p>Given the following code:</p>\n\n<pre><code>iv, err := strconv.ParseInt(\"18446744073709551448\", 10, 64)\nfmt.Println(iv)\nfmt.Printf(\"%#v\\n\", err)\nfmt.Printf(\"%v\\n\", err)\n\n//Output:\n9223372036854775807\n&amp;strconv.NumError{Func:\"ParseInt\", Num:\"18446744073709551448\", Err:(*errors.errorString)(0x1040a040)}\nstrconv.ParseInt: parsing \"18446744073709551448\": value out of range\n</code></pre>\n\n<p>How can I detect that the function failed due to being out of range of an int64? The <a href=\"http://golang.org/src/strconv/atoi.go#L150\" rel=\"nofollow\">strconv.ParseInt</a> function returns an error type, but in this case it is actually a <a href=\"http://golang.org/pkg/strconv/#NumError\" rel=\"nofollow\">strconv.NumError</a> type as indicated by <code>%#v</code>. The <a href=\"http://blog.golang.org/error-handling-and-go\" rel=\"nofollow\">Error Handling and Go</a> article mentions you can use type assertion to check for specific types of errors, but it doesn't give any examples. What expression should I use to complete this code:</p>\n\n<pre><code>if expression {\n    uv, err := strconv.ParseUint(\"18446744073709551448\", 10, 64)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1426037836, "last_edit_date": 1426037836, "creation_date": 1426037237, "answer_id": 28977064, "question_id": 28976458, "link": "https://stackoverflow.com/questions/28976458/why-embedded-structs-are-not-decoded-when-there-is-an-unmarshal-implementation/28977064#28977064", "title": "Why embedded structs are not decoded when there is an Unmarshal implementation?", "body": "<p>I don't think it's a bug but just just how interfaces and embedding works. It just happens not to be what you want/expect here.</p>\n\n<p><code>json.Unmarshal</code> figures out to use the <code>UnmarshalJSON</code> method via <a href=\"https://golang.org/src/encoding/json/decode.go?s=10084:10111#L354\" rel=\"nofollow\">this line</a>:</p>\n\n<pre><code>    if u, ok := v.Interface().(Unmarshaler); ok\n</code></pre>\n\n<p>As you know, something implements an interface if it has the right method set which <code>*Policy</code> and <code>*ServiceAccount</code> do. So it's expected that JSON decoding of the the outer type would just call the appropriate method and think it's done.</p>\n\n<p>Interestingly, if you were to experiment and add a dummy method such as:</p>\n\n<pre><code>func (u *User) UnmarshalJSON([]byte) error {return errors.New(\"not impl\")}\n</code></pre>\n\n<p>then although <code>*User</code> and <code>*Policy</code> would now both implement the interface,\n<code>*ServiceAccount</code> will no longer implement that interface. The reason is clear if you try and explicitly call <code>srvAcc.UnmarshalJSON</code> which would then give a compiler error of \"<strong>ambiguous selector srvAcc.UnmarshalJSON</strong>\". Without such a call the code is legal and the method is just excluded from the method set.</p>\n\n<p>So I think the solution is one of:</p>\n\n<ul>\n<li>Just don't embed things that implement <code>json.Unmarshaller</code> if you want to marshal the result, e.g.\u00a0use a named field instead.</li>\n<li>Make sure you explicitly implement <code>json.Unmarshaller</code> for the outer type yourself when doing such embedding (e.g.\u00a0add an <code>UnmarshalJSON</code> method to <code>*ServiceAccount</code>).</li>\n<li>Make sure at least two embedded things implement <code>json.Unmarshaller</code> and then <strike>they'll work individually</strike>\u00b9 but the \"outer\" type will get the default behaviour.</li>\n</ul>\n\n<p>The last option seems like a hack to me. (And btw could be done on purpose with something like:</p>\n\n<pre><code>    type ServiceAccount struct {\n        User\n        Policy\n        dummyMarshaller\n    }\n\n    type dummyMarshaller struct{}\n    func (dummyMarshaller) MarshalJSON([]byte) error {panic(\"ouch\")}\n</code></pre>\n\n<p>but that looks <em>really</em> hacky to me).</p>\n\n<p>See also:</p>\n\n<ul>\n<li><a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">https://golang.org/ref/spec#Struct_types</a></li>\n<li><a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#embedding</a></li>\n</ul>\n\n<p>\u00b9 <a href=\"http://play.golang.org/p/xiZpjPPmml\" rel=\"nofollow\">Further testing</a> shows that decoding such anonymous (i.e.\u00a0embedded fields), that their <code>UnmarshalJSON</code> methods do not get called.</p>\n"}], "owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 1, "accepted_answer_id": 28977064, "answer_count": 1, "score": 1, "last_activity_date": 1426037836, "creation_date": 1426033224, "question_id": 28976458, "link": "https://stackoverflow.com/questions/28976458/why-embedded-structs-are-not-decoded-when-there-is-an-unmarshal-implementation", "title": "Why embedded structs are not decoded when there is an Unmarshal implementation?", "body": "<p>I have a type <code>ServiceAccount</code> which embeds two other types (User and Policy). However it seems the fields of the <code>User</code> type are totally ignored due the Unmarshaler implementation of the <code>Policy</code> type.\n  Is there any good reason for this behaviour? It looks like a bug to me because the json package can see through reflection that we have two types embedded and not only the type <code>Policy</code>. </p>\n\n<p>I'm aware that I can \"fix\" the issue by implementing the Unmarshaler interface on type ServiceAccount too.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n\n) \ntype ServiceAccount struct {\n    User\n    Policy\n}\ntype User struct {\n    UserID string `json:\"userID\"`\n}\n\ntype Policy struct {\n    Scopes string `json:\"scopes,omitempty\"`\n}\n\n// PolicyRaw is the Policy type as received from client.\ntype PolicyRaw struct {\n    Scopes string `json:\"scopes,omitempty\"`\n}\n\nfunc main() {\n    s := `{\"userID\":\"xyz\", \"scopes\":\"some scopes\"}`\n\n    srvAcc := &amp;ServiceAccount{}\n    if err := json.Unmarshal([]byte(s), srvAcc); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"srvAcc %v\", *srvAcc)\n}\n\nfunc (p *Policy) UnmarshalJSON(b []byte) error {\n    pr := new(PolicyRaw)\n    if err := json.Unmarshal(b, pr); err != nil {\n        return err\n    }\n    p.Scopes = pr.Scopes\n    return nil\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/AoYMtMxluW\" rel=\"nofollow\">Execute</a></p>\n"}, {"tags": ["java", "go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 788, "user_id": 1316011, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/ic7jf.jpg?s=128&g=1", "display_name": "Thad", "link": "https://stackoverflow.com/users/1316011/thad"}, "edited": false, "score": 0, "creation_date": 1426092798, "post_id": 28976385, "comment_id": 46233354, "body": "So what&#39;s the solution? The examples claim to be build off the same <a href=\"https://github.com/grpc/grpc-common/blob/master/protos/helloworld.proto\" rel=\"nofollow noreferrer\">helloworld.proto</a>. Were they? Shouldn&#39;t it build compatible URLs? (Sorry. I might understand this if I could get the <i>expletive</i> C++ stuff to build. I hadn&#39;t planned on having to learn Go when I tackled this.)"}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "reply_to_user": {"reputation": 788, "user_id": 1316011, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/ic7jf.jpg?s=128&g=1", "display_name": "Thad", "link": "https://stackoverflow.com/users/1316011/thad"}, "edited": false, "score": 1, "creation_date": 1426093543, "post_id": 28976385, "comment_id": 46233885, "body": "They are not, the java example is using this one: <a href=\"https://github.com/grpc/grpc-java/blob/master/examples/src/main/proto/hello_world.proto\" rel=\"nofollow noreferrer\">github.com/grpc/grpc-java/blob/master/examples/src/main/prot&zwnj;&#8203;o/&hellip;</a>"}], "tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": false, "score": 4, "last_activity_date": 1426032660, "creation_date": 1426032660, "answer_id": 28976385, "question_id": 28975841, "link": "https://stackoverflow.com/questions/28975841/are-the-grpc-examples-intended-to-speak-across-languages/28976385#28976385", "title": "Are the grpc examples intended to speak across languages?", "body": "<p>The two examples you are using are based on incompatible proto definitions. The problem is that the java example is using the package name <code>grpc.example.helloworld</code> and the go example is using just the <code>helloworld</code>.</p>\n\n<p>And because the package name is part of the <code>URL</code> path (<code>/helloworld.Greeter/SayHello</code>) the call fails (the java server is expecting <code>/grpc.example.helloworld.Greeter/SayHello</code>).</p>\n\n<p>You can see it in the generated code.</p>\n\n<p>Java:</p>\n\n<pre><code>private GreeterServiceDescriptor() {\n  sayHello = createMethodDescriptor(\n      \"grpc.example.helloworld.Greeter\", METHOD_SAY_HELLO);\n}\n</code></pre>\n\n<p>Go:</p>\n\n<pre><code>var _Greeter_serviceDesc = grpc.ServiceDesc{\n        ServiceName: \"helloworld.Greeter\",\n        HandlerType: (*GreeterServer)(nil),\n        Methods: []grpc.MethodDesc{\n            {\n                MethodName: \"SayHello\",\n                Handler: _Greeter_SayHello_Handler,\n            },\n        },\n        Streams: []grpc.StreamDesc{},\n}\n</code></pre>\n"}], "owner": {"reputation": 788, "user_id": 1316011, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/ic7jf.jpg?s=128&g=1", "display_name": "Thad", "link": "https://stackoverflow.com/users/1316011/thad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2577, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1426032660, "creation_date": 1426029499, "last_edit_date": 1495535654, "question_id": 28975841, "link": "https://stackoverflow.com/questions/28975841/are-the-grpc-examples-intended-to-speak-across-languages", "title": "Are the grpc examples intended to speak across languages?", "body": "<p>Are the gRPC examples intended to interoperate? I can run the Java client-server examples entirely with Java. I can Go examples entirely with Go. But Go's hello world client won't talk with Java's hello world server.</p>\n\n<p>In one terminal, from grpc-java:</p>\n\n<pre><code>$ ./gradlew :grpc-examples:helloWorldServer\n:grpc-core:compileJava UP-TO-DATE\n...\n:grpc-examples:helloWorldServer\nMar 10, 2015 7:01:50 PM io.grpc.examples.helloworld.HelloWorldServer start\nINFO: Server started, listening on 50051\n&gt; Building 96% &gt; :grpc-examples:helloWorldServer\n</code></pre>\n\n<p>In another terminal, from grpc-common/go</p>\n\n<pre><code>$ go run greeter_client/main.go\n2015/03/10 19:02:47 could not greet: rpc error: code = 12 desc = \"Method not found: /helloworld.Greeter/SayHello\"\nexit status 1\n</code></pre>\n\n<p>Not the cross-language example I was expecting. SayHello is there, but is the problem with path or case sensitivity? Am I missing something, or is this cross-language cooperation an intent not yet realized?</p>\n\n<p>(Caveat--I don't know Go, and I've been <a href=\"https://stackoverflow.com/q/28974708/1316011\">unable to build grpc for C++</a>).</p>\n"}, {"tags": ["session", "go", "gorilla"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1426018639, "post_id": 28973138, "comment_id": 46197779, "body": "you&#39;re not calling <code>session.Save(r, w)</code>"}, {"owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1426018716, "post_id": 28973138, "comment_id": 46197822, "body": ".... well this is embarrassing. thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1426030278, "post_id": 28973360, "comment_id": 46203046, "body": "Just to add to this: if you have any control flow (e.g. you return early) you need to call <code>session.Save(r, w)</code> before you: a) leave the handler and/or b) write to the ResponseWriter."}], "tags": [], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1426018888, "creation_date": 1426018888, "answer_id": 28973360, "question_id": 28973138, "link": "https://stackoverflow.com/questions/28973138/why-does-this-gorilla-session-code-not-work/28973360#28973360", "title": "Why does this gorilla session code not work?", "body": "<p>thanks to JimB for pointing out the painfully obvious, I needed to add a call to <code>session.Save(r, w)</code> after creating/editing the session.</p>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 28973360, "answer_count": 1, "score": 0, "last_activity_date": 1426018888, "creation_date": 1426018044, "question_id": 28973138, "link": "https://stackoverflow.com/questions/28973138/why-does-this-gorilla-session-code-not-work", "title": "Why does this gorilla session code not work?", "body": "<p>I'm a golang noob, so I'm making my first toy app by setting up a seed project for a gorilla based web app. It's going well but the session code doesn't work as I expect it to, <a href=\"https://github.com/0xor1/gorillaseed/blob/master/src/server/src/api/v1/counter/counter.go#L43\" rel=\"nofollow\">here is the full code</a>, and here is just the relevant snippet:</p>\n\n<pre><code>func getMyCounter(w http.ResponseWriter, r *http.Request){\n    session, _ := sessionStore.Get(r, counterSession)\n    if session.IsNew {\n        session.Values[myCounter] = 0\n    }\n    val := session.Values[myCounter].(int)\n    log.Printf(\"getMyCounter %d\", val)\n    m := make(map[string]int)\n    m[\"counter\"] = val\n    js, _ := json.Marshal(m)\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.Write(js)\n}\n\nfunc incrementMyCounter(w http.ResponseWriter, r *http.Request){\n    log.Println(\"incrementMyCounter\")\n    session, _ := sessionStore.Get(r, counterSession)\n    if session.IsNew {\n        session.Values[myCounter] = 0\n    }\n    val := session.Values[myCounter].(int)\n    session.Values[myCounter] = val + 1\n    getMyCounter(w, r)\n}\n</code></pre>\n\n<p>my calls to getMyCounter and incrementMyCounter always return 0</p>\n"}, {"tags": ["parsing", "go", "yacc", "lex", "lexical-analysis"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1426019652, "post_id": 28973076, "comment_id": 46198338, "body": "I recommend: <a href=\"https://www.youtube.com/watch?v=HxaD_trXwRE\" rel=\"nofollow noreferrer\">Lexical Scanning in Go - Rob Pike</a> (wherein the short answer is that it&#39;s usually easy enough to write your own and you get much better error reporting that way too)."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426020691, "post_id": 28973076, "comment_id": 46198939, "body": "@DaveC: The funny thing is that I was willing to write my own parser (because parsing Scheme is easy), but wanted a lexer generator because some of the tokens get messy with all the &quot;special&quot; tokens such as character literals and escaped symbols. But I guess I&#39;ll take their advice and write everything myself."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1426022470, "post_id": 28973076, "comment_id": 46199888, "body": "@Matt FWIW a while ago I wrote a lexer using the <code>text&#47;scanner</code> package that let me have the basics already there, and I had to add very little to a simple scanning loop in order to be able to &quot;feed my yacc&quot; :)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1426025015, "post_id": 28973076, "comment_id": 46201059, "body": "@Matt I&#39;d still recommend viewing that video first then as he discusses an interesting (to me at least) way of using channels to structure the code and avoid the typical &quot;NextToken&quot; function of a lexer having to unwind/reset its state each call. The code he talks about was the first version of Go&#39;s text/template package <a href=\"https://golang.org/src/text/template/parse/lex.go\" rel=\"nofollow noreferrer\">golang.org/src/text/template/parse/lex.go</a>"}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426025576, "post_id": 28973076, "comment_id": 46201277, "body": "@DaveC: That&#39;s how I already started writing it a few years ago anyway. But I&#39;ll still watch it because I remember having problems with channels not being closed and such."}], "owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466411012, "creation_date": 1426017803, "last_edit_date": 1466411012, "question_id": 28973076, "link": "https://stackoverflow.com/questions/28973076/how-do-i-generate-a-lexer-with-the-go-toolchain", "title": "How do I generate a lexer with the Go toolchain?", "body": "<p>A parser is generated with</p>\n\n<pre><code>go tool yacc foo.y\n</code></pre>\n\n<p>But there is no <code>go tool lex</code> command, so how do I generate a lexer from <code>foo.l</code>?</p>\n"}, {"tags": ["design-patterns", "go", "concurrency", "erlang"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 1723911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9449a5fac4e415ad9ead4984365ccfa?s=128&d=identicon&r=PG", "display_name": "snwight", "link": "https://stackoverflow.com/users/1723911/snwight"}, "edited": false, "score": 1, "creation_date": 1426035141, "post_id": 28973254, "comment_id": 46204526, "body": "fwiw you can insert newlines using the &quot;tilde escape&quot; <a href=\"http://erlang.org/doc/man/io.html#format-1\" rel=\"nofollow noreferrer\">format codes</a>, which are similar to the classic C printf style, but use &quot;~&quot; rather than &quot;\\&quot; as a prefix. So, <code>io:format(&quot;~n&quot;)</code> outputs a newline."}], "tags": [], "owner": {"reputation": 4001, "user_id": 1245380, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/IuBwG.png?s=128&g=1", "display_name": "Stratus3D", "link": "https://stackoverflow.com/users/1245380/stratus3d"}, "is_accepted": true, "score": 1, "last_activity_date": 1426023926, "last_edit_date": 1426023926, "creation_date": 1426018448, "answer_id": 28973254, "question_id": 28972673, "link": "https://stackoverflow.com/questions/28972673/erlang-translation-of-go-walk-trees/28973254#28973254", "title": "Erlang translation of Go walk trees", "body": "<p><strong>The function is indeed concurrent, as you are spawning new processes to walk the subtrees.</strong></p>\n\n<p>You might want to alter <code>tree:walk/1</code> so that it returns the atom <code>ok</code> in the case of a successful walk (I also switch out <code>io:format/1</code> with <code>erlang:display</code> so that values are printed on separate lines):</p>\n\n<pre><code>walk({Left, Value, Right}) -&gt;\n    spawn(tree,walk,[Left]),\n    erlang:display(Value),\n    spawn(tree,walk,[Right]),\n    ok;\nwalk({}) -&gt; continue.\n</code></pre>\n\n<p>Here is a synchronous version of the same function. Instead of processes, we use recursion:</p>\n\n<pre><code>walk_sync({Left, Value, Right}) -&gt;\n    walk_sync(Left),\n    erlang:display(Value),\n    walk_sync(Right);\nwalk_sync({}) -&gt; continue.\n</code></pre>\n"}], "owner": {"reputation": 1806, "user_id": 1290607, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/YHMrJ.png?s=128&g=1", "display_name": "Bula", "link": "https://stackoverflow.com/users/1290607/bula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 28973254, "answer_count": 1, "score": 1, "last_activity_date": 1459815347, "creation_date": 1426016461, "last_edit_date": 1459815347, "question_id": 28972673, "link": "https://stackoverflow.com/questions/28972673/erlang-translation-of-go-walk-trees", "title": "Erlang translation of Go walk trees", "body": "<p>I am trying to implement the <code>Walk</code> function from <a href=\"http://golang.org/doc/play/tree.go\" rel=\"nofollow\">here</a> which is implemented in Go into erlang.</p>\n\n<p>Here is the result:</p>\n\n<pre><code>-module(tree).\n-export([walk/1,test/0]).\n\n\nwalk({Left, Value, Right}) -&gt;\n    spawn(tree,walk,[Left]),\n    io:format(Value),\n    spawn(tree,walk,[Right]);\nwalk({}) -&gt; continue.\n\n\n\ntest() -&gt;\nB = {{}, alina, {}},\nD = {{},vlad,{}},\nC = {D, tea, {}},\nA = {B,maria,C},\nwalk(A).\n</code></pre>\n\n<p>I'm not sure if this belongs to the code review section as I'm not sure that what I did is what I wanted. The code works as expected (in the sense that it does walk a tree) however I'm not sure if the design of the function is concurrent.</p>\n"}, {"tags": ["go", "int", "file-permissions"], "answers": [{"comments": [{"owner": {"reputation": 1208, "user_id": 1198639, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1a4ae40d7871bc0c93776301e28b3548?s=128&d=identicon&r=PG", "display_name": "Will H", "link": "https://stackoverflow.com/users/1198639/will-h"}, "edited": false, "score": 0, "creation_date": 1426015318, "post_id": 28969523, "comment_id": 46195865, "body": "Thanks Jim, always helpful!"}, {"owner": {"reputation": 763, "user_id": 5986227, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-R58sngDauK0/AAAAAAAAAAI/AAAAAAAAB_0/pzxD2AYGNQA/photo.jpg?sz=128", "display_name": "Chris Hopkins", "link": "https://stackoverflow.com/users/5986227/chris-hopkins"}, "edited": false, "score": 5, "creation_date": 1489147085, "post_id": 28969523, "comment_id": 72555576, "body": "Unless I&#39;m much mistaken, this isn&#39;t helpful if you&#39;re trying to have some files that are writable and some not. One can have or in (for example) 0200 to turn on user writable, but it would aid code readability if there were an os constant to control this. Yes I expect every programmer worth their salt to know octal unix permission but it is still bad programming to use a magic value when a descriptive name could be used. As far as I can tell the standard libraries are missing this and just expect everyone to have memorise Unix file permission constants."}, {"owner": {"reputation": 1544, "user_id": 1302438, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ade3d093c3d5d7d8a690a087b37a1dfa?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1302438/ben"}, "edited": false, "score": 0, "creation_date": 1583437428, "post_id": 28969523, "comment_id": 107126466, "body": "Whats the difference between 0755 and 755 in go? Without the 0 my permissions failed."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1544, "user_id": 1302438, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ade3d093c3d5d7d8a690a087b37a1dfa?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1302438/ben"}, "edited": false, "score": 0, "creation_date": 1583438451, "post_id": 28969523, "comment_id": 107126875, "body": "@Ben <code>0755</code> is octal, equal to <code>493</code> in decimal."}, {"owner": {"reputation": 1544, "user_id": 1302438, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ade3d093c3d5d7d8a690a087b37a1dfa?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1302438/ben"}, "edited": false, "score": 0, "creation_date": 1583520890, "post_id": 28969523, "comment_id": 107158241, "body": "I am used to using <code>chmod 755 *file*</code> in linux. <code>0755</code> is not the same thing?"}, {"owner": {"reputation": 111, "user_id": 6033447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08c859e9c69140a37491f897cd2cebb6?s=128&d=identicon&r=PG&f=1", "display_name": "SVUser", "link": "https://stackoverflow.com/users/6033447/svuser"}, "edited": false, "score": 0, "creation_date": 1598905336, "post_id": 28969523, "comment_id": 112603083, "body": "The leading zero forces a base-8 conversion. A safer way is to use a base-8 conversion explicitly, e.g., if the mode is represented by a string: <code>modeVal, _ := strconv.ParseUint(&quot;0775&quot;, 8, 32)</code> and then <code>fm := os.FileMode(modeVal)</code>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 35, "last_activity_date": 1426006731, "last_edit_date": 1426006731, "creation_date": 1426006267, "answer_id": 28969523, "question_id": 28969455, "link": "https://stackoverflow.com/questions/28969455/how-to-properly-instantiate-os-filemode/28969523#28969523", "title": "How to properly instantiate os.FileMode", "body": "<p><code>FileMode</code> is just a uint32. <a href=\"http://golang.org/pkg/os/#FileMode\" rel=\"noreferrer\">http://golang.org/pkg/os/#FileMode</a></p>\n\n<p>Setting via constants isn't \"cheating\", you use it like other numeric values. If you're not using a constant, you can use a conversion on valid numeric values:</p>\n\n<pre><code>mode := int(0777)\nos.FileMode(mode)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1208, "user_id": 1198639, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1a4ae40d7871bc0c93776301e28b3548?s=128&d=identicon&r=PG", "display_name": "Will H", "link": "https://stackoverflow.com/users/1198639/will-h"}, "edited": false, "score": 20, "creation_date": 1510691925, "post_id": 42718395, "comment_id": 81540547, "body": "Chris this is really useful and the fact that this 2 year + old question is still being watched / updated shows the need for constants to be available in the stdlib."}], "tags": [], "owner": {"reputation": 763, "user_id": 5986227, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-R58sngDauK0/AAAAAAAAAAI/AAAAAAAAB_0/pzxD2AYGNQA/photo.jpg?sz=128", "display_name": "Chris Hopkins", "link": "https://stackoverflow.com/users/5986227/chris-hopkins"}, "is_accepted": false, "score": 51, "last_activity_date": 1489148730, "creation_date": 1489148730, "answer_id": 42718395, "question_id": 28969455, "link": "https://stackoverflow.com/questions/28969455/how-to-properly-instantiate-os-filemode/42718395#42718395", "title": "How to properly instantiate os.FileMode", "body": "<p>My fix has been to define my own constants as I couldn't find any in os or syscall:</p>\n\n<pre><code>    const (\n        OS_READ = 04\n        OS_WRITE = 02\n        OS_EX = 01\n        OS_USER_SHIFT = 6\n        OS_GROUP_SHIFT = 3\n        OS_OTH_SHIFT = 0\n\n        OS_USER_R = OS_READ&lt;&lt;OS_USER_SHIFT\n        OS_USER_W = OS_WRITE&lt;&lt;OS_USER_SHIFT\n        OS_USER_X = OS_EX&lt;&lt;OS_USER_SHIFT\n        OS_USER_RW = OS_USER_R | OS_USER_W\n        OS_USER_RWX = OS_USER_RW | OS_USER_X\n\n        OS_GROUP_R = OS_READ&lt;&lt;OS_GROUP_SHIFT\n        OS_GROUP_W = OS_WRITE&lt;&lt;OS_GROUP_SHIFT\n        OS_GROUP_X = OS_EX&lt;&lt;OS_GROUP_SHIFT\n        OS_GROUP_RW = OS_GROUP_R | OS_GROUP_W\n        OS_GROUP_RWX = OS_GROUP_RW | OS_GROUP_X\n\n        OS_OTH_R = OS_READ&lt;&lt;OS_OTH_SHIFT\n        OS_OTH_W = OS_WRITE&lt;&lt;OS_OTH_SHIFT\n        OS_OTH_X = OS_EX&lt;&lt;OS_OTH_SHIFT\n        OS_OTH_RW = OS_OTH_R | OS_OTH_W\n        OS_OTH_RWX = OS_OTH_RW | OS_OTH_X\n\n        OS_ALL_R = OS_USER_R | OS_GROUP_R | OS_OTH_R\n        OS_ALL_W = OS_USER_W | OS_GROUP_W | OS_OTH_W\n        OS_ALL_X = OS_USER_X | OS_GROUP_X | OS_OTH_X\n        OS_ALL_RW = OS_ALL_R | OS_ALL_W\n        OS_ALL_RWX = OS_ALL_RW | OS_GROUP_X\n)\n</code></pre>\n\n<p>This then allows me to specify my intent directly:</p>\n\n<pre><code>        // Create any directories needed to put this file in them\n        var dir_file_mode os.FileMode\n        dir_file_mode = os.ModeDir | (OS_USER_RWX | OS_ALL_R)\n        os.MkdirAll(dir_str, dir_file_mode)\n</code></pre>\n\n<p>I'm sure this could be improved by use of iota, and some more combinations of permissions, but it works for me for now.</p>\n"}], "owner": {"reputation": 1208, "user_id": 1198639, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1a4ae40d7871bc0c93776301e28b3548?s=128&d=identicon&r=PG", "display_name": "Will H", "link": "https://stackoverflow.com/users/1198639/will-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25381, "favorite_count": 7, "accepted_answer_id": 28969523, "answer_count": 2, "score": 22, "last_activity_date": 1588952936, "creation_date": 1426006029, "last_edit_date": 1588952936, "question_id": 28969455, "link": "https://stackoverflow.com/questions/28969455/how-to-properly-instantiate-os-filemode", "title": "How to properly instantiate os.FileMode", "body": "<p>I have seen countless examples and tutorials that show how to create a file and all of them \"cheat\" by just setting the permission bits of the file.  I would like to know / find out how to properly instantiate os.FileMode to provide to a writer during creation / updating of a file.</p>\n\n<p>A crude example is this below:</p>\n\n<pre><code>func FileWrite(path string, r io.Reader, uid, gid int, perms string) (int64, error){\n    w, err := os.OpenFile(path, os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0664)\n    if err != nil {\n        if path == \"\" {\n            w = os.Stdout\n        } else {\n            return 0, err\n        }\n    }\n    defer w.Close()\n\n    size, err := io.Copy(w, r)\n\n    if err != nil {\n        return 0, err\n    }\n    return size, err\n}\n</code></pre>\n\n<p>In the basic function above permission bits 0664 is set and although this may make sense sometimes I prefer to have a proper way of setting the filemode correctly.  As seen above a common example would be that the UID / GID is known and already provided as int values and the perms being octal digits that were previously gathered and inserted into a db as a string.</p>\n"}, {"tags": ["pointers", "go", "linked-list"], "answers": [{"tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 1, "last_activity_date": 1426003077, "creation_date": 1426003077, "answer_id": 28968349, "question_id": 28968119, "link": "https://stackoverflow.com/questions/28968119/go-linked-list-pointer-assignment-from-non-pointer-struct-element/28968349#28968349", "title": "Go linked list pointer assignment from non-pointer struct element", "body": "<p>A pointer is <code>nil</code> by default and needs to be initialized.</p>\n\n<p>This:</p>\n\n<pre><code>// Init initializes or clears list l.\nfunc (l *List) Init() *List {\n  l.root.next = l.root\n  l.root.prev = l.root\n  l.len = 0\n  return l\n}\n</code></pre>\n\n<p>should become this:</p>\n\n<pre><code>// Init initializes or clears list l.\nfunc (l *List) Init() *List {\n  l.root = new(Element) // necessary to avoid dereferencing a nil pointer\n  l.root.next = l.root\n  l.root.prev = l.root\n  l.len = 0\n  return l\n}\n</code></pre>\n\n<p>Demo at <a href=\"http://play.golang.org/p/EYSscTMYnn\" rel=\"nofollow\">http://play.golang.org/p/EYSscTMYnn</a></p>\n\n<p>In the case of the standard library, it is not necessary to have <code>root</code> be a pointer, however, for <code>prev</code> and <code>next</code> it is necessary, otherwise the struct definition would be recursive, which is not allowed, because it would in theory cause a struct of infinite size...</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 28968349, "answer_count": 1, "score": 1, "last_activity_date": 1426003077, "creation_date": 1426002487, "question_id": 28968119, "link": "https://stackoverflow.com/questions/28968119/go-linked-list-pointer-assignment-from-non-pointer-struct-element", "title": "Go linked list pointer assignment from non-pointer struct element", "body": "<p><a href=\"https://github.com/golang/go/blob/master/src/container/list/list.go#L49\" rel=\"nofollow\">https://github.com/golang/go/blob/master/src/container/list/list.go#L49</a></p>\n\n<p>I am having hard time why I am getting <code>cannot assign to pointer</code> error in Go.</p>\n\n<p>Here's the code that works: <a href=\"http://play.golang.org/p/P9FjK8A-32\" rel=\"nofollow\">http://play.golang.org/p/P9FjK8A-32</a> which is same as Go's original container/list code</p>\n\n<pre><code>type List struct {\n    root Element\n    len  int\n}\n\ntype Element struct {\n    next, prev *Element\n    list       *List\n    Value      interface{}\n}\n</code></pre>\n\n<p>The original code has <code>root</code> as a value and reference it everytime it needs to be in pointer type but why not at first place define <code>root</code> as a pointer?</p>\n\n<pre><code>type List struct {\n    root *Element\n    len  int\n}\n\ntype Element struct {\n    next, prev *Element\n    list       *List\n    Value      interface{}\n}\n</code></pre>\n\n<p>This give me an error: <a href=\"http://play.golang.org/p/1gCAR_rcx1\" rel=\"nofollow\">http://play.golang.org/p/1gCAR_rcx1</a> -> <code>invalid memory address or nil pointer dereference</code></p>\n\n<p>Why am I getting this error?\nWhy does Go define <code>root</code> as a non-pointer value when it defines <code>next</code>, and <code>prev</code> as pointers?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["sockets", "tcp", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1426007762, "post_id": 28967701, "comment_id": 46191570, "body": "Never ignore errors. For example code at minimum do <code>if err != nil {log.Fatal(err)}</code>. You make everyone looking at your code wonder if there is some error from <code>Listen</code> or <code>Accept</code> (or <code>Close</code>) or <code>File()</code> that is just being ignored."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1426017683, "post_id": 28967701, "comment_id": 46197242, "body": "Can you use <code>defer f.Close()</code> just on the next line after you open the file?"}, {"owner": {"reputation": 307, "user_id": 1306312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4623558095bc289745e22692ac49d7d8?s=128&d=identicon&r=PG", "display_name": "vzex", "link": "https://stackoverflow.com/users/1306312/vzex"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426042907, "post_id": 28967701, "comment_id": 46206503, "body": "@DaveC ok,you&#39;re very cautious"}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 1306312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4623558095bc289745e22692ac49d7d8?s=128&d=identicon&r=PG", "display_name": "vzex", "link": "https://stackoverflow.com/users/1306312/vzex"}, "edited": false, "score": 0, "creation_date": 1426003630, "post_id": 28968431, "comment_id": 46188607, "body": "if I remove the for { read ...} loop, the close() function is good, so I guess there is some lock bug during close()"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1426021535, "last_edit_date": 1426021535, "creation_date": 1426003285, "answer_id": 28968431, "question_id": 28967701, "link": "https://stackoverflow.com/questions/28967701/golang-tcp-socket-cant-close-after-get-file/28968431#28968431", "title": "golang tcp socket can&#39;t close after get File()", "body": "<p>This is caused by the FDs being put into blocking mode. Once that happens, you're no longer using the runtime network poller, and have to use the socket as if you were using blocking calls and multiple threads. Underneath, a blocking <code>recv</code> call on a socket can't be interrupted by a <code>close</code> in another thread.</p>\n\n<p>A workaround may be to force the FD back into non-blocking mode before closing it:</p>\n\n<pre><code>syscall.SetNonblock(int(d), true)\nf.Close()\n</code></pre>\n\n<p>You can also shutdown the socket for reading before calling close:</p>\n\n<pre><code>conn.CloseRead()\nconn.Close()\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 1306312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4623558095bc289745e22692ac49d7d8?s=128&d=identicon&r=PG", "display_name": "vzex", "link": "https://stackoverflow.com/users/1306312/vzex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1637, "favorite_count": 1, "accepted_answer_id": 28968431, "answer_count": 1, "score": 2, "last_activity_date": 1426021535, "creation_date": 1426001365, "question_id": 28967701, "link": "https://stackoverflow.com/questions/28967701/golang-tcp-socket-cant-close-after-get-file", "title": "golang tcp socket can&#39;t close after get File()", "body": "<p>Please see the code below:</p>\n\n<pre>\n    package main\n    import \"net\"\n    import \"log\"\n    import \"bufio\"\n    import \"time\"\n\n    func main() {\n             l,_:=net.Listen(\"tcp\", \":8888\")\n             for {\n                     conn, _ := l.Accept()\n                     log.Println(\"get conn\", conn.RemoteAddr())\n                     go func() {\n                             f, _:=conn.(*net.TCPConn).File()\n                             d:=f.Fd()\n                             log.Println(d)\n                             f.Close()\n                             arr := make([]byte, 1000)\n                             reader := bufio.NewReader(conn)\n                             time.AfterFunc(3*time.Second, func() {\n                                     log.Println(\"close conn\", conn.RemoteAddr())\n                                     conn.Close()\n                             })\n                             for {\n                                     size, err := reader.Read(arr)\n                                     if err != nil {\n                                             break\n                                     }\n                                     log.Println(\"sss\", arr[:size])\n                             }\n                     }()\n             }\n    }\n\n</pre>\n\n<p>when the program start,I use telnet to connect the localhost:8888,after 3 seconds,the server will kill me out, but the socket status is still ESTABLISHED when I use netstat to watch.If I remove the File() function, the socket can be closed normally.How can I fix this?</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1426002360, "post_id": 28967627, "comment_id": 46187724, "body": "Use the <code>len</code> function to get the length of a slice."}], "answers": [{"comments": [{"owner": {"reputation": 16082, "user_id": 5261, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23297f8eab6e18e0e2a695737fd17e44?s=128&d=identicon&r=PG", "display_name": "SeanDowney", "link": "https://stackoverflow.com/users/5261/seandowney"}, "edited": false, "score": 0, "creation_date": 1426003540, "post_id": 28968065, "comment_id": 46188538, "body": "Thanks, I was thinking the issue was more in my thinking of how to write Go rather than the lack of Go&#39;s ability to test for an element. I do have &quot;real life&quot; situation where I am doing this, but it&#39;s likely because I&#39;m still learning how to correctly write Go"}], "tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": true, "score": 36, "last_activity_date": 1426002716, "last_edit_date": 1426002716, "creation_date": 1426002344, "answer_id": 28968065, "question_id": 28967627, "link": "https://stackoverflow.com/questions/28967627/test-index-out-of-range-golang/28968065#28968065", "title": "Test Index out of range golang", "body": "<p>In Go, this is not quite as easy as in PHP - but keep in mind that in PHP it's only easy because \"indexed\" arrays are actually associative arrays under the hood. Otherwise you wouldn't be able to \"punch holes\" into arrays by unsetting individual elements.</p>\n\n<p>With Go arrays/slices, you have to actually check against the length of the array, as you wrote:</p>\n\n<pre><code>if i&gt;=0 &amp;&amp; i&lt;len(strings) {...}\n</code></pre>\n\n<p>Personally, I've yet to come across a real life situation that requires doing this - in your example, you could use <code>range(strings)</code> and stop worrying about indexes.</p>\n\n<p>With maps, which are the Go equivalent of PHP arrays, you can do \"isset\" by writing:</p>\n\n<pre><code>value, isset := map[index]\n</code></pre>\n\n<p>if <code>index</code> is present in the map, <code>value</code> will be set appropriately and <code>isset</code> will be true; if not, <code>value</code> will be set to the zero value of the map's type and <code>isset</code> will be false.</p>\n"}, {"tags": [], "owner": {"reputation": 702, "user_id": 1614036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57b80cdc7bd62ad727bd7cafdb7a0c9f?s=128&d=identicon&r=PG", "display_name": "Juan de Parras", "link": "https://stackoverflow.com/users/1614036/juan-de-parras"}, "is_accepted": false, "score": 2, "last_activity_date": 1426002436, "creation_date": 1426002436, "answer_id": 28968100, "question_id": 28967627, "link": "https://stackoverflow.com/questions/28967627/test-index-out-of-range-golang/28968100#28968100", "title": "Test Index out of range golang", "body": "<p><code>len()</code> should return the number of elements of the slice.</p>\n\n<blockquote>\n  <p>The length of a nil slice, map or channel is 0. (<a href=\"https://golang.org/ref/spec#Length_and_capacity\" rel=\"nofollow\">https://golang.org/ref/spec#Length_and_capacity</a>)</p>\n</blockquote>\n"}], "owner": {"reputation": 16082, "user_id": 5261, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23297f8eab6e18e0e2a695737fd17e44?s=128&d=identicon&r=PG", "display_name": "SeanDowney", "link": "https://stackoverflow.com/users/5261/seandowney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34055, "favorite_count": 0, "accepted_answer_id": 28968065, "answer_count": 2, "score": 21, "last_activity_date": 1426002716, "creation_date": 1426001164, "question_id": 28967627, "link": "https://stackoverflow.com/questions/28967627/test-index-out-of-range-golang", "title": "Test Index out of range golang", "body": "<p>Sorry for this noob question, but I'm not sure how I test to see if an element I'm accessing is valid for an array, consider the following contrived code:</p>\n\n<pre><code>func main() {\n    strings := []string{\"abc\", \"def\", \"ghi\", \"jkl\"}\n    for i := 0; i&lt;5; i++ {\n        if strings[i] {\n            fmt.Println(strings[i])\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/8QjGadu6Fu\" rel=\"noreferrer\">https://play.golang.org/p/8QjGadu6Fu</a></p>\n\n<p>I'm obviously going outside of the bounds, but I'm not sure how I test to prevent the error. I'm used to PHP where I would use an <code>isset</code> or <code>!empty</code> test, does go have such a thing?</p>\n\n<p>I've browsed other questions and seen the <code>len</code> function used, but that doesn't appear to work.</p>\n"}, {"tags": ["string", "pointers", "go", "uint64"], "comments": [{"owner": {"reputation": 2411, "user_id": 2053848, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/R0Zkb.png?s=128&g=1", "display_name": "Jonny", "link": "https://stackoverflow.com/users/2053848/jonny"}, "edited": false, "score": 0, "creation_date": 1426001187, "post_id": 28967512, "comment_id": 46186949, "body": "I don&#39;t understand golang, but is this page helpful (<a href=\"http://stackoverflow.com/questions/5367961/casting-from-one-pointer-to-pointer-type-to-another-in-golang-error\" title=\"casting from one pointer to pointer type to another in golang error\">stackoverflow.com/questions/5367961/&hellip;</a>)? It deals with casting pointers."}, {"owner": {"reputation": 3296, "user_id": 559885, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6ac5d484694e3d6f8ac6dfef05c27263?s=128&d=identicon&r=PG", "display_name": "ecem", "link": "https://stackoverflow.com/users/559885/ecem"}, "reply_to_user": {"reputation": 2411, "user_id": 2053848, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/R0Zkb.png?s=128&g=1", "display_name": "Jonny", "link": "https://stackoverflow.com/users/2053848/jonny"}, "edited": false, "score": 0, "creation_date": 1426001407, "post_id": 28967512, "comment_id": 46187100, "body": "Thank you, but unfortunately they are not related."}, {"owner": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "edited": false, "score": 0, "creation_date": 1524328738, "post_id": 28967512, "comment_id": 86932091, "body": "<i>but why would you need to do this?</i>"}, {"owner": {"reputation": 3296, "user_id": 559885, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6ac5d484694e3d6f8ac6dfef05c27263?s=128&d=identicon&r=PG", "display_name": "ecem", "link": "https://stackoverflow.com/users/559885/ecem"}, "reply_to_user": {"reputation": 3629, "user_id": 1744107, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/91748b7203b0ef849403e8099da4528f?s=128&d=identicon&r=PG", "display_name": "Rambatino", "link": "https://stackoverflow.com/users/1744107/rambatino"}, "edited": false, "score": 0, "creation_date": 1555432364, "post_id": 28967512, "comment_id": 98106247, "body": "@Rambatino that&#39;s a great question, but let&#39;s just say I was on the dark side once."}], "answers": [{"tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": false, "score": 3, "last_activity_date": 1426001653, "creation_date": 1426001653, "answer_id": 28967798, "question_id": 28967512, "link": "https://stackoverflow.com/questions/28967512/convert-string-to-uint64-in-golang/28967798#28967798", "title": "Convert string to *uint64 in golang", "body": "<p>You can do it with</p>\n\n<pre><code> ip = (*uint64)(unsafe.Pointer(uintptr(u)))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Ei8-WbUp15\" rel=\"nofollow\">playground link</a></p>\n\n<p>Albeit I don't know what guarantees Go gives you about the validity of such a pointer, nor can I think of any use case where this code should be used..</p>\n"}, {"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 3, "last_activity_date": 1426002678, "last_edit_date": 1495542160, "creation_date": 1426002678, "answer_id": 28968196, "question_id": 28967512, "link": "https://stackoverflow.com/questions/28967512/convert-string-to-uint64-in-golang/28968196#28968196", "title": "Convert string to *uint64 in golang", "body": "<p>Based on <a href=\"https://stackoverflow.com/a/28967798/450989\">nos answer</a>.</p>\n\n<p>Although it is technically possible there are reasons not to trust the code you wrote. Garbage collection will use the memory you point to (with string). </p>\n\n<p>Take a look at result of the following code.</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"strconv\"\n    \"reflect\"\n    \"unsafe\"\n)\n\nfunc produce() string {\n    i := uint64(23473824)\n    ip := &amp;i\n    str := fmt.Sprintf(\"%v\", ip)\n    fmt.Println(i, ip, str)\n    return str\n}\n\nfunc main() {\n    str := produce()\n\n    for i := 0; i &lt; 10; i++ {\n         x := make([]int, 1024*1024)\n         x[0] = i\n    }        \n\n    u, _ := strconv.ParseUint(str, 0, 64) \n\n    ip := (*uint64)(unsafe.Pointer(uintptr(u)))\n    fmt.Println(ip,*ip, reflect.TypeOf(u)) // u is uint64, how to get pointer out of this value?\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/85XOhsMTf3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/85XOhsMTf3</a></p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 12633853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h__RqLJJ1CQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcB0i-JRgAijA1J5U9C-1oGahDeRQ/photo.jpg?sz=128", "display_name": "Eduardo A EDUARDO Fernandez Di", "link": "https://stackoverflow.com/users/12633853/eduardo-a-eduardo-fernandez-di"}, "is_accepted": false, "score": 3, "last_activity_date": 1587062693, "creation_date": 1587062693, "answer_id": 61257714, "question_id": 28967512, "link": "https://stackoverflow.com/questions/28967512/convert-string-to-uint64-in-golang/61257714#61257714", "title": "Convert string to *uint64 in golang", "body": "<p>It is as simple as:</p>\n\n<pre><code>number, err := strconv.ParseUint(string(\"90\"), 10, 64)\n</code></pre>\n\n<p>then do some error checking, hope it helps.</p>\n"}], "owner": {"reputation": 3296, "user_id": 559885, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6ac5d484694e3d6f8ac6dfef05c27263?s=128&d=identicon&r=PG", "display_name": "ecem", "link": "https://stackoverflow.com/users/559885/ecem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8275, "favorite_count": 0, "answer_count": 3, "score": 6, "last_activity_date": 1587062693, "creation_date": 1426000804, "last_edit_date": 1500985830, "question_id": 28967512, "link": "https://stackoverflow.com/questions/28967512/convert-string-to-uint64-in-golang", "title": "Convert string to *uint64 in golang", "body": "<p>Assume there is a string holding the address of an <code>uint64</code> type variable, can we parse this address back to an <code>*uint64</code>? </p>\n\n<p>For example:</p>\n\n<pre><code>i := uint64(23473824)\nip := &amp;i\nstr := fmt.Sprintf(\"%v\", ip)\n\nu, _ := strconv.ParseUint(str, 0, 64)\n</code></pre>\n\n<p><code>u</code> is <code>uint64</code>. How to get pointer out of this value?</p>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/1KXFQcozRk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/1KXFQcozRk</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9410, "user_id": 177534, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b7b357241e1241a7326c97262a66e4e3?s=128&d=identicon&r=PG", "display_name": "Dan Short", "link": "https://stackoverflow.com/users/177534/dan-short"}, "edited": false, "score": 0, "creation_date": 1425995511, "post_id": 28965200, "comment_id": 46182703, "body": "Looks like I have some more learning to do around variable assignments. You nailed it. Thanks."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 8, "last_activity_date": 1425995277, "last_edit_date": 1425995277, "creation_date": 1425994527, "answer_id": 28965200, "question_id": 28965092, "link": "https://stackoverflow.com/questions/28965092/reusing-database-connection-in-go-and-invalid-memory-address-errors/28965200#28965200", "title": "Reusing Database Connection in GO and &#39;invalid memory address&#39; errors", "body": "<p>Your problem is that the <code>db</code> pointer is <code>nil</code> in the context of your <code>writeToLog()</code> function. The culprit is this line:</p>\n\n<pre><code>db, err := sql.Open(\"mssql\", connString)\n</code></pre>\n\n<p>Here, you are confusing the short variable declaration operator (<code>:=</code>) with the assignment operator (<code>=</code>).</p>\n\n<p>This instruction override the <code>db</code> global variable with a <code>db</code> local variable, only accessible in your <code>main</code> function (this is called <em>shadowing</em>, and also work with package names, etc). Consequently, the <code>db</code> variable used in <code>writeToLog</code> is never initialized, hence the <code>nil pointer dereference</code> error.</p>\n\n<p>To fix it, you just have to fix your declaration for it to be an affectation:</p>\n\n<pre><code>var err error\ndb, err = sql.Open(\"mssql\", connString)\n</code></pre>\n"}], "owner": {"reputation": 9410, "user_id": 177534, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b7b357241e1241a7326c97262a66e4e3?s=128&d=identicon&r=PG", "display_name": "Dan Short", "link": "https://stackoverflow.com/users/177534/dan-short"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 28965200, "answer_count": 1, "score": 1, "last_activity_date": 1425995277, "creation_date": 1425994243, "question_id": 28965092, "link": "https://stackoverflow.com/questions/28965092/reusing-database-connection-in-go-and-invalid-memory-address-errors", "title": "Reusing Database Connection in GO and &#39;invalid memory address&#39; errors", "body": "<p>I'm new to GO, and can't seem to find any information on an error with reusing a database connection in a global. Here's a simplified version of my code that caues the error:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    _ \"github.com/denisenkom/go-mssqldb\"\n    \"database/sql\"\n)\n\nvar debug = flag.Bool(\"debug\", false, \"enable debugging\")\nvar password = flag.String(\"password\", \"*****\", \"the database password\")\nvar port *int = flag.Int(\"port\", 1433, \"the database port\")\nvar server = flag.String(\"server\", \"localhost\", \"the database server\")\nvar user = flag.String(\"user\", \"*****\", \"the database user\")\nvar db *sql.DB\n\nfunc main() {\n    // Parse the incoming flags to set variables.\n    flag.Parse()\n\n    // Output the database variables if the debug flag is set.\n    if *debug {\n        fmt.Printf(\" password:%s\\n\", *password)\n        fmt.Printf(\" port:%d\\n\", *port)\n        fmt.Printf(\" server:%s\\n\", *server)\n        fmt.Printf(\" user:%s\\n\", *user)\n    }\n\n    // Build out the connection string to the database, and then open the connection to the database.\n    connString := fmt.Sprintf(\"server=%s;user id=%s;password=%s;port=%d\", *server, *user, *password, *port)\n    if *debug { fmt.Printf(\" connString:%s\\n\", connString) }\n    db, err := sql.Open(\"mssql\", connString)\n    if err != nil { log.Fatal(\"Open connection failed:\", err.Error()) }\n    err = db.Ping()\n    if err != nil {\n        fmt.Println(\"Cannot connect: \", err.Error())\n        return\n    }\n\n    // Close the connection when we're all done.\n    defer db.Close()\n\n    // Truncate the existing records in the ListHubFeed\n    res, err := db.Exec( `\n        TRUNCATE TABLE foo\n    ` )\n    _ = res\n\n    if err != nil {\n        fmt.Println( \"TRUNCATE TABLE failed\", err )\n    }\n\n    eligible := verifyEligibility( \"foo\" )\n\n}\n\nfunc verifyEligibility( email string ) ( success bool ) {\n\n    //Run each check individually, and if any one fails, return false and stop processing additional checks\n\n    // if the routing email is bad, then we can't create an account, so kick it out.\n    if( !govalidator.IsEmail( email ) ){\n        writeToLog( email )\n        return false\n    }\n\n    return true;\n\n}\n\nfunc writeToLog( tolog string ) {\n    res, err := db.Exec(`\n        INSERT INTO Log ( \n            Email\n        ) VALUES (\n            ?,\n            ?,\n            ?,\n            ?\n        )` , tolog )\n    if err != nil {\n        fmt.Println( \"insert failed\", err )\n    }\n    _ = res\n}\n</code></pre>\n\n<p>That's really ugly psuedocode, but the point is that the <code>TRUNCATE</code> statements in <code>main</code> run just fine, but after calling <code>verifyEligibility()</code> and then attempting to log the entry in the <code>writeToLog()</code> function, I get the following error:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x1 addr=0x0 pc=0x46d485]\n\ngoroutine 1 [running]:\ndatabase/sql.(*DB).conn(0x0, 0xc082044088, 0x0, 0x0)\n        c:/go/src/database/sql/sql.go:634 +0x7b5\ndatabase/sql.(*DB).exec(0x0, 0x742730, 0x8, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n        c:/go/src/database/sql/sql.go:884 +0x9d\ndatabase/sql.(*DB).Exec(0x0, 0x742730, 0x8, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n        c:/go/src/database/sql/sql.go:875 +0xd4\nmain.writeToLog(0xc082004a20, 0x11, 0x70f370, 0x5, 0x0, 0x0, 0x777ef0, 0x24, 0x71ba70, 0x3)\n</code></pre>\n\n<p>I can't find any information on this error as it relates to <code>go-mssqldb</code>. <code>db</code> is declared as a global, and is opened in <code>main</code>, so I can't figure out why it's not available to me in <code>writeToLog()</code>.</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1425984099, "post_id": 28961072, "comment_id": 46175088, "body": "thanks, I appreciate this ansert. as the funtion receives variadic variables, how can I set type assertion when I do not know which struct slice is being created?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1425984329, "post_id": 28961072, "comment_id": 46175247, "body": "@user2660766 How can you call Full for a specific type if you have many possible types? You can simply do a type switch and call a separate function for each possible model."}, {"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1425986690, "post_id": 28961072, "comment_id": 46176759, "body": "It was just example function for test"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1425988787, "post_id": 28961072, "comment_id": 46178028, "body": "@user2660766 see my expanded answer, I&#39;ve added an exmaple on how to route to multiple functions based on the model"}, {"owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "edited": false, "score": 0, "creation_date": 1478553331, "post_id": 28961072, "comment_id": 68194072, "body": "Any ideas on how this might work without actually knowing the struct type to assert? <a href=\"http://stackoverflow.com/questions/40474682/reflect-set-slice-of-structs-value-to-a-struct-without-type-assertion-because\" title=\"reflect set slice of structs value to a struct without type assertion because\">stackoverflow.com/questions/40474682/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1425984743, "last_edit_date": 1425984743, "creation_date": 1425982703, "answer_id": 28961072, "question_id": 28961004, "link": "https://stackoverflow.com/questions/28961004/how-to-create-slice-of-struct-using-reflection/28961072#28961072", "title": "How to create slice of struct using reflection?", "body": "<p>You're almost there. The problem is that you don't need to type-assert to the struct type, but to the slice type.</p>\n\n<p>So instead of </p>\n\n<pre><code>SliceVal.Interface().(SomeStructType)\n</code></pre>\n\n<p>You should do:</p>\n\n<pre><code>SliceVal.Interface().([]SomeStructType)\n</code></pre>\n\n<p>And in your concrete example - just changing the following line makes your code work:</p>\n\n<pre><code>Full(emptySlice.Interface().([]Order))\n</code></pre>\n\n<p>Now, if you have many possible models you can do the following:</p>\n\n<pre><code>switch s := emptySlice.Interface().(type) {\ncase []Order:\n    Full(s)\ncase []SomeOtherModel:\n    FullForOtherModel(s)\n// etc\n}\n</code></pre>\n"}], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1945, "favorite_count": 0, "accepted_answer_id": 28961072, "answer_count": 1, "score": 7, "last_activity_date": 1579615906, "creation_date": 1425982505, "last_edit_date": 1579615906, "question_id": 28961004, "link": "https://stackoverflow.com/questions/28961004/how-to-create-slice-of-struct-using-reflection", "title": "How to create slice of struct using reflection?", "body": "<p>I need to create a slice of struct from its interface with reflection.</p>\n\n<p>I used Reflection because do not see any other solution without using it.</p>\n\n<p>Briefly, the function receives variadic values of Interface.</p>\n\n<p>Then, with reflection creates slice and passes it into another function.</p>\n\n<p>Reflection asks to type assertion</p>\n\n<pre><code>SliceVal.Interface().(SomeStructType)\n</code></pre>\n\n<p>But, I cannot use it.</p>\n\n<p>Code in playground <a href=\"http://play.golang.org/p/EcQUfIlkTe\">http://play.golang.org/p/EcQUfIlkTe</a>    </p>\n\n<p>The code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Model interface {\n    Hi()\n}\n\ntype Order struct {\n    H string\n}\n\nfunc (o Order) Hi() {\n    fmt.Println(\"hello\")\n}\n\nfunc Full(m []Order) []Order{\n    o := append(m, Order{H:\"Bonjour\"}\n    return o\n}\n\nfunc MakeSlices(models ...Model) {\n    for _, m := range models {\n        v := reflect.ValueOf(m)\n        fmt.Println(v.Type())\n        sliceType := reflect.SliceOf(v.Type())\n        emptySlice := reflect.MakeSlice(sliceType, 1, 1)\n        Full(emptySlice.Interface())\n    }\n}\nfunc main() {\n    MakeSlices(Order{})\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426008165, "post_id": 28958192, "comment_id": 46191854, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/28307783/goroutine-does-not-execute-if-time-sleep-included\">Goroutine does not execute if time.Sleep included</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1425973203, "post_id": 28958240, "comment_id": 46169341, "body": "Right, I just understood your edit after reading <a href=\"http://dave.cheney.net/2014/03/19/channel-axioms\" rel=\"nofollow noreferrer\">dave.cheney.net/2014/03/19/channel-axioms</a>: A send to a <code>nil</code> channel blocks forever, A receive from a <code>nil</code> channel blocks forever."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 584, "user_id": 4165890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/775acc9ac7be8ea4d61018d18a0d1926?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh Panchananam", "link": "https://stackoverflow.com/users/4165890/dinesh-panchananam"}, "edited": false, "score": 0, "creation_date": 1425974601, "post_id": 28958240, "comment_id": 46169959, "body": "@DineshPanchananam What do you mean by &quot;unorderly&quot; fashion? You expect to see mixed numbers randomly from the 2 running <code>SayHello()</code> functions?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 584, "user_id": 4165890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/775acc9ac7be8ea4d61018d18a0d1926?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh Panchananam", "link": "https://stackoverflow.com/users/4165890/dinesh-panchananam"}, "edited": false, "score": 0, "creation_date": 1425976139, "post_id": 28958240, "comment_id": 46170580, "body": "@DineshPanchananam I edited my answer to address this case. But in short, you have no guarantee to observe such behavior (and even if you do, it will not be deterministic)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 41, "last_activity_date": 1426005309, "last_edit_date": 1495540926, "creation_date": 1425972765, "answer_id": 28958240, "question_id": 28958192, "link": "https://stackoverflow.com/questions/28958192/no-output-from-goroutine/28958240#28958240", "title": "No output from goroutine", "body": "<p>When your <code>main()</code> function ends, your program ends as well. It does not wait for other goroutines to finish.</p>\n\n<p>Quoting from the <a href=\"http://golang.org/ref/spec#Program_execution\" rel=\"noreferrer\">Go Language Specification: Program Execution</a>:</p>\n\n<blockquote>\n  <p>Program execution begins by initializing the main package and then invoking the function <code>main</code>. When that function invocation returns, the program exits. It does not wait for other (non-<code>main</code>) goroutines to complete.</p>\n</blockquote>\n\n<p>See <a href=\"https://stackoverflow.com/a/28307829/1705598\">this answer</a> for more details.</p>\n\n<p>You have to tell your <code>main()</code> function to wait for the <code>SayHello()</code> function started as a goroutine to complete. You can synchronize them with channels for example:</p>\n\n<pre><code>func SayHello(done chan int) {\n    for i := 0; i &lt; 10; i++ {\n        fmt.Print(i, \" \")\n    }\n    if done != nil {\n        done &lt;- 0 // Signal that we're done\n    }\n}\n\nfunc main() {\n    SayHello(nil) // Passing nil: we don't want notification here\n    done := make(chan int)\n    go SayHello(done)\n    &lt;-done // Wait until done signal arrives\n}\n</code></pre>\n\n<p>Another alternative is to signal the completion by closing the channel:</p>\n\n<pre><code>func SayHello(done chan struct{}) {\n    for i := 0; i &lt; 10; i++ {\n        fmt.Print(i, \" \")\n    }\n    if done != nil {\n        close(done) // Signal that we're done\n    }\n}\n\nfunc main() {\n    SayHello(nil) // Passing nil: we don't want notification here\n    done := make(chan struct{})\n    go SayHello(done)\n    &lt;-done // A receive from a closed channel returns the zero value immediately\n}\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<p>According to your edits/comments: if you want the 2 running <code>SayHello()</code> functions to print \"mixed\" numbers randomly: you have no guarantee to observe such behaviour. Again, see the <a href=\"https://stackoverflow.com/a/28307829/1705598\">aforementioned answer</a> for more details. The <a href=\"http://golang.org/ref/mem\" rel=\"noreferrer\"><strong>Go Memory Model</strong></a> only guarantees that certain events happen before other events, you have no guarantee how 2 concurrent goroutines are executed.</p>\n\n<p>You might experiment with it, but know that the result will not be deterministic. First you have to enable multiple active goroutines to be executed with:</p>\n\n<pre><code>runtime.GOMAXPROCS(2)\n</code></pre>\n\n<p>And second you have to first start <code>SayHello()</code> as a goroutine because your current code first executes <code>SayHello()</code> in the main goroutine and only once it finished starts the other one:</p>\n\n<pre><code>runtime.GOMAXPROCS(2)\ndone := make(chan struct{})\ngo SayHello(done) // FIRST START goroutine\nSayHello(nil) // And then call SayHello() in the main goroutine\n&lt;-done // Wait for completion\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "reply_to_user": {"reputation": 584, "user_id": 4165890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/775acc9ac7be8ea4d61018d18a0d1926?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh Panchananam", "link": "https://stackoverflow.com/users/4165890/dinesh-panchananam"}, "edited": false, "score": 0, "creation_date": 1425974724, "post_id": 28958521, "comment_id": 46170011, "body": "@DineshPanchananam do you want to print each number in a separate routine?"}, {"owner": {"reputation": 584, "user_id": 4165890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/775acc9ac7be8ea4d61018d18a0d1926?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh Panchananam", "link": "https://stackoverflow.com/users/4165890/dinesh-panchananam"}, "edited": false, "score": 0, "creation_date": 1425975052, "post_id": 28958521, "comment_id": 46170123, "body": "No. i expected something &quot;&quot;parallel&quot;&quot;&quot;. but i think i&#39;m wrong."}, {"owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "reply_to_user": {"reputation": 584, "user_id": 4165890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/775acc9ac7be8ea4d61018d18a0d1926?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh Panchananam", "link": "https://stackoverflow.com/users/4165890/dinesh-panchananam"}, "edited": false, "score": 0, "creation_date": 1425975687, "post_id": 28958521, "comment_id": 46170391, "body": "@DineshPanchananam check the second part of the answer"}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 1, "creation_date": 1425996876, "post_id": 28958521, "comment_id": 46183684, "body": "Also, please don&#39;t use a defer when there&#39;s only one function call (the first code example) - just move wg.Done() to after the function call. There&#39;s not need to use a defer in that situation."}], "tags": [], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "is_accepted": false, "score": 12, "last_activity_date": 1425975500, "last_edit_date": 1425975500, "creation_date": 1425973959, "answer_id": 28958521, "question_id": 28958192, "link": "https://stackoverflow.com/questions/28958192/no-output-from-goroutine/28958521#28958521", "title": "No output from goroutine", "body": "<p>Alternatively (to icza's answer) you can use <code>WaitGroup</code> from <code>sync</code> package and anonymous function to avoid altering original <code>SayHello</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc SayHello() {\n    for i := 0; i &lt; 10; i++ {\n        fmt.Print(i, \" \")\n    }\n}\n\nfunc main() {\n    SayHello()\n\n    var wg sync.WaitGroup\n    wg.Add(1)\n\n    go func() {\n        defer wg.Done()\n        SayHello()\n    }()\n\n    wg.Wait()\n}\n</code></pre>\n\n<p>In order to print numbers simultaneously run each print statement in separate routine like the following</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go func(fnScopeI int) {\n            defer wg.Done()\n\n            // next two strings are here just to show routines work simultaneously\n            amt := time.Duration(rand.Intn(250))\n            time.Sleep(time.Millisecond * amt)\n\n            fmt.Print(fnScopeI, \" \")\n        }(i)\n    }\n\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1306, "user_id": 5705686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jYuOhkTQVgQ/AAAAAAAAAAI/AAAAAAAAA1A/v5x1CDU6W4s/photo.jpg?sz=128", "display_name": "dolan", "link": "https://stackoverflow.com/users/5705686/dolan"}, "is_accepted": false, "score": 1, "last_activity_date": 1596303283, "last_edit_date": 1596303283, "creation_date": 1558212998, "answer_id": 56202791, "question_id": 28958192, "link": "https://stackoverflow.com/questions/28958192/no-output-from-goroutine/56202791#56202791", "title": "No output from goroutine", "body": "<p>A Go program exits when the <code>main</code> function returns.</p>\n<p>One option is to use something like <code>sync.WaitGroup</code> to wait on the other goroutines that <code>main</code> has spawned before returning from <code>main</code>.</p>\n<p>Another option is to call <code>runtime.Goexit()</code> in <code>main</code>. From the <a href=\"https://golang.org/pkg/runtime/#Goexit\" rel=\"nofollow noreferrer\">godoc</a>:</p>\n<blockquote>\n<p>Goexit terminates the goroutine that calls it. No other goroutine is affected. Goexit runs all deferred calls before terminating the goroutine. Because Goexit is not a panic, any recover calls in those deferred functions will return nil.</p>\n<p>Calling Goexit from the main goroutine terminates that goroutine without func main returning. Since func main has not returned, the program continues execution of other goroutines. If all other goroutines exit, the program crashes.</p>\n</blockquote>\n<p>This allows main goroutine to stop executing while the background routines continue to execute. For example:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;runtime&quot;\n    &quot;time&quot;\n)\n\nfunc f() {\n    for i := 0; ; i++ {\n        fmt.Println(i)\n        time.Sleep(10 * time.Millisecond)\n    }\n}\n\nfunc main() {\n    go f()\n    runtime.Goexit()\n}\n</code></pre>\n<p>This can be cleaner than blocking forever in the main function, especially for programs that are infinite. One downside is that if all of the goroutines of a process return or exit (including the main goroutine), Go will detect this as an error and panic:</p>\n<pre><code>fatal error: no goroutines (main called runtime.Goexit) - deadlock!\n</code></pre>\n<p>To avoid this, at least one goroutine must call <code>os.Exit</code> before it returns. Calling <code>os.Exit(0)</code> immediately terminates the program and indicates that it did so without error. For example:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;os&quot;\n    &quot;runtime&quot;\n    &quot;time&quot;\n)\n\nfunc f() {\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(i)\n        time.Sleep(10 * time.Millisecond)\n    }\n    os.Exit(0)\n}\n\nfunc main() {\n    go f()\n    runtime.Goexit()\n}\n</code></pre>\n"}], "owner": {"reputation": 584, "user_id": 4165890, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/775acc9ac7be8ea4d61018d18a0d1926?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh Panchananam", "link": "https://stackoverflow.com/users/4165890/dinesh-panchananam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3025, "favorite_count": 6, "accepted_answer_id": 28958240, "answer_count": 3, "score": 24, "last_activity_date": 1596303283, "creation_date": 1425972527, "last_edit_date": 1578836197, "question_id": 28958192, "link": "https://stackoverflow.com/questions/28958192/no-output-from-goroutine", "title": "No output from goroutine", "body": "<p>While <code>SayHello()</code> executes as expected, the goroutine prints nothing. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc SayHello() {\n    for i := 0; i &lt; 10 ; i++ {\n        fmt.Print(i, \" \")\n    }\n}\n\nfunc main() {\n    SayHello()\n    go SayHello()\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 5, "last_activity_date": 1426008790, "last_edit_date": 1426008790, "creation_date": 1425968616, "answer_id": 28957351, "question_id": 28957282, "link": "https://stackoverflow.com/questions/28957282/why-stringer-cant-find-the-package/28957351#28957351", "title": "Why stringer can&#39;t find the package?", "body": "<p>From <a href=\"https://groups.google.com/d/topic/golang-nuts/4pgvzvy7O20/discussion\" rel=\"nofollow\">this thread</a>:</p>\n\n<blockquote>\n  <p>Seems to be a silly thing: 4 part import are usually subpackages and these must be \"<strong>installed</strong>\" before you can use them. I ran the following on the command line to resolve my problem:</p>\n</blockquote>\n\n<p>So try first:</p>\n\n<pre><code>go install &lt;yourpackage&gt;\n</code></pre>\n\n<p>Ad see if go generate works after that.</p>\n\n<p>Make sure to use the latest go 1.4.2 and to update your stringer as well:</p>\n\n<pre><code>go get -u golang.org/x/tools/cmd/stringer\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2017, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1426008790, "creation_date": 1425968309, "question_id": 28957282, "link": "https://stackoverflow.com/questions/28957282/why-stringer-cant-find-the-package", "title": "Why stringer can&#39;t find the package?", "body": "<p>Any idea how can I fix the error below? I have a go generator (stringer) which I try to run but it keeps reporting that it can't find a package import although the package is definitely imported. </p>\n\n<pre><code>stringer: checking package: main.go:13:3: could not import example.io/api/util (can't find import: example.io/api/util)\nmain.go:33: running \"stringer\": exit status 1\n</code></pre>\n"}, {"tags": ["arrays", "go", "append", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1425968738, "last_edit_date": 1425968738, "creation_date": 1425968029, "answer_id": 28957229, "question_id": 28957190, "link": "https://stackoverflow.com/questions/28957190/what-is-the-fastest-way-to-append-one-array-to-another-in-go/28957229#28957229", "title": "What is the fastest way to append one array to another in Go?", "body": "<p><a href=\"http://golang.org/ref/spec#Array_types\">Arrays</a> in Go are secondary, <a href=\"http://golang.org/ref/spec#Slice_types\"><em>slices</em></a> are the way to go. Go provides a built-in <a href=\"http://golang.org/pkg/builtin/#append\"><code>append()</code></a> function to append slices:</p>\n\n<pre><code>a := []int{1, 2, 3}\nb := []int{4, 5}\na = append(a, b...)\nfmt.Println(a)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[1 2 3 4 5]\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/P3ncHYQ5Fp\">Go Playground</a>.</p>\n\n<p><strong>Notes:</strong></p>\n\n<p>Arrays in Go are fixed sizes: once an array is created, you cannot increase its size so you can't append elements to it. If you would have to, you would need to allocate a new, bigger array; big enough to hold all the elements from the 2 arrays. Slices are much more flexible.</p>\n\n<p>Arrays in Go are so \"inflexible\" that even the size of the array is part of its type so for example the array type <code>[2]int</code> is distinct from the type <code>[3]int</code> so even if you would create a helper function to add/append arrays of type <code>[2]int</code> you couldn't use that to append arrays of type <code>[3]int</code>!</p>\n\n<p>Read these articles to learn more about arrays and slices:</p>\n\n<p><a href=\"http://blog.golang.org/go-slices-usage-and-internals\">Go Slices: usage and internals</a></p>\n\n<p><a href=\"http://blog.golang.org/slices\">Arrays, slices (and strings): The mechanics of 'append'</a></p>\n"}], "owner": {"reputation": 6542, "user_id": 2701950, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a3d89317f2698bf452325a67db8d3dd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jadiel de Armas", "link": "https://stackoverflow.com/users/2701950/jadiel-de-armas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "accepted_answer_id": 28957229, "answer_count": 1, "score": 2, "last_activity_date": 1475314996, "creation_date": 1425967813, "last_edit_date": 1475314996, "question_id": 28957190, "link": "https://stackoverflow.com/questions/28957190/what-is-the-fastest-way-to-append-one-array-to-another-in-go", "title": "What is the fastest way to append one array to another in Go?", "body": "<p>Suppose that I have arrays <code>A</code> and <code>B</code> in Go.  What is the fastest way to append all the values of <code>B</code> to <code>A</code>?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1425956563, "post_id": 28954913, "comment_id": 46164252, "body": "You can even do: <code>job := job</code> to get a new variable with the same name (that shadows the old one). It&#39;s legal and works and is even mentioned in <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow noreferrer\">Effective Go</a> (search for <code>req := req</code>)."}], "tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": true, "score": 8, "last_activity_date": 1425952538, "creation_date": 1425952538, "answer_id": 28954913, "question_id": 28954869, "link": "https://stackoverflow.com/questions/28954869/cannot-assign-variable-to-anonymous-func-in-for-loop/28954913#28954913", "title": "Cannot assign variable to anonymous func in for loop", "body": "<p>While you are not using goroutines, the mistake you are making is almost identical to the one described here: <a href=\"https://github.com/golang/go/wiki/CommonMistakes#using-closures-with-goroutines\" rel=\"noreferrer\">https://github.com/golang/go/wiki/CommonMistakes#using-closures-with-goroutines</a></p>\n\n<p>To quote:</p>\n\n<blockquote>\n  <p>The val variable in the above loop is actually a single variable that takes on the value of each slice element. Because the closures are all only bound to that one variable, there is a very good chance that when you run this code you will see the last element printed for every iteration instead of each value in sequence, because the goroutines will probably not begin executing until after the loop.</p>\n</blockquote>\n\n<p>So your attempted fix (to pass it as a parameter to your function) would in principle fix the problem, however you cannot pass a function with parameters to the cron library - a function with parameters is a different type from one without (in addition to which by adding the <code>()</code> you are actually calling the function in advance and trying to pass its return value).</p>\n\n<p>The simplest fix is to create a new variable for every iteration of the loop and avoid the whole problem, like so:</p>\n\n<pre><code>for _, job := range config.Jobs {\n    realJob := job // a new variable each time through the loop\n    c.AddFunc(\"@every \"+realJob.Interval, func() {\n        DistributeJob(realJob)\n    })\n    log.Println(\"Job \" + realJob.Name + \" has been scheduled!\")\n}\n</code></pre>\n"}], "owner": {"reputation": 6383, "user_id": 2187087, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/1bWfN.jpg?s=128&g=1", "display_name": "Yugang Zhou", "link": "https://stackoverflow.com/users/2187087/yugang-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 0, "accepted_answer_id": 28954913, "answer_count": 1, "score": 3, "last_activity_date": 1425952538, "creation_date": 1425952221, "question_id": 28954869, "link": "https://stackoverflow.com/questions/28954869/cannot-assign-variable-to-anonymous-func-in-for-loop", "title": "Cannot assign variable to anonymous func in for loop", "body": "<p>I'm studying go-lang by developing a task schedular. The <a href=\"https://github.com/robfig/cron\" rel=\"nofollow\">cron library</a> I use accepts a cron expression and a func as parameters to add a scheduler.</p>\n\n<pre>\nc.AddFunc(\"0 30 * * * *\", func() { fmt.Println(\"Every hour on the half hour\") })\n</pre>\n\n<p>The schedular I am developing schedules jobs according to a yaml file. So I iterate the jobs to add schedulars like this:</p>\n\n<pre>\ntype Job struct {\n    Name        string\n    Interval    string\n\n}\n\nfunc DistributeJob(job Job) {\n    log.Println(\"running\", job, job.Interval)\n}\n\nfunc main() {\n    //load config from yaml\n    c := cron.New()\n\n    for _, job := range config.Jobs {\n        c.AddFunc(\"@every \"+job.Interval, func() {\n            DistributeJob(job)\n        })\n        log.Println(\"Job \" + job.Name + \" has been scheduled!\")\n    }\n\n    c.Start()\n    select {}\n}\n</pre>\n\n<p>All jobs are scheduled on their intervals but it turns out that they're printing the last job's description. For example, if I schedule two jobs, the first interval on 3min and the latter interval on 1min. The console prints:</p>\n\n<pre>\n12:01: Running latter 1min\n12:02: Running latter 1min\n12:03: Running latter 1min\n12:03: Running latter 1min//this one should be the first job\n</pre>\n\n<p>I think the problem is at </p>\n\n<pre>\n    func() {\n        DistributeJob(job)\n    })\n</pre>\n\n<p>It seems it only takes the last job but I can't figure out why. I tried using</p>\n\n<pre>\n    c.AddFunc(\"@every \"+job.Interval, func(job JobType) {\n        DistributeJob(job)\n    }(job))\n</pre>\n\n<p>but it fails due to cannot used as value</p>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1425951273, "post_id": 28954729, "comment_id": 46163072, "body": "Not Windows, this must be something Go&#39;s <code>.Command()</code> function is doing.  The first thing to try is putting the entire command in a single string rather than having it split into parts."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1425954086, "post_id": 28954729, "comment_id": 46163730, "body": "@HarryJohnston perhaps look at <a href=\"https://golang.org/pkg/os/exec\" rel=\"nofollow noreferrer\">os/exec</a> docs first and note that it provides no function/method that takes an entire command but only pre-separated arguments (as is sane) before suggesting someone do that."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425954636, "post_id": 28954729, "comment_id": 46163850, "body": "@DaveC: doesn&#39;t the ... in the argument list mean zero or more?  (Also, on Windows, using pre-separated arguments <i>isn&#39;t</i> sane.  The underlying function that starts a new process takes a single string for the command line, not an array like UNIX.  So a function that takes separated arguments has to figure out how to put them together, and as often as not gets it wrong; that&#39;s probably what happened in the OPs case.)"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1425955336, "post_id": 28954729, "comment_id": 46163987, "body": "@HarryJohnston yes the call is legal, but calling <code>exec.Command(&quot;foo bar baz&quot;)</code> just tries to find an executable called &quot;foo bar baz&quot; it does <b>not</b> try and call &quot;foo&quot; with arguments &quot;bar&quot; and &quot;baz&quot;. If you want that then you need to split out the arguments yourself which as proliferation of various shells with slightly different syntax indicates, is not straight forward and doesn&#39;t have a one-size-fits-all solution."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425955722, "post_id": 28954729, "comment_id": 46164079, "body": "@DaveC: I&#39;ll take your word for it, but it isn&#39;t obviously true from the documentation.  In the Windows case there&#39;s no shell involved - or, rather, even if os/exec invokes the shell, that doesn&#39;t affect how command line arguments are parsed."}, {"owner": {"reputation": 1710, "user_id": 1630191, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/179c7e7c696827305522d3e97952f46c?s=128&d=identicon&r=PG&f=1", "display_name": "user232343", "link": "https://stackoverflow.com/users/1630191/user232343"}, "edited": false, "score": 0, "creation_date": 1425977498, "post_id": 28954729, "comment_id": 46171287, "body": "I am running go 1.4. When I executed above command I got panic, and from panic message I saw that &quot;find /SomeText&quot;&quot; was executed and failing."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1425956173, "post_id": 28955182, "comment_id": 46164181, "body": "Further experiments with adding an extra &quot;file.txt&quot; argument to the command and making that include SomeText indicate that it returns that same &quot;error&quot; (exit status 1) but also produces the matched filename as output. (Again, cross-compiled to and run on a Win7 virtual machine)."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1426016359, "post_id": 28955182, "comment_id": 46196470, "body": "I&#39;ve now tried this myself and it is not working as expected.  The &quot;find&quot; command produces the filename as output (because it always does) but does not find the string.  Further investigation demonstrated that this is because the command line being run says <code>find \\&quot;SomeText\\&quot; test.txt</code> instead of <code>find &quot;SomeText&quot; test.txt</code> ; any idea how to correct that?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1426019191, "post_id": 28955182, "comment_id": 46198084, "body": "The prints quoted above have <code>\\&quot;</code> since I used %q formatting which adds quotes and escapes existing quotes (I find that makes it easier to spot things like <code>&quot;foo &quot;</code> and the like). I copied the question&#39;s use of backticks which produces a string that includes the quotes. If that isn&#39;t desired/required then one of the set of quotes around SomeText should be removed."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1426019831, "post_id": 28955182, "comment_id": 46198433, "body": "That&#39;s what I figured originally, but by substituting <code>find.exe</code> with a utility that just pops up a message box showing the command line, I discovered that the backslashes really were winding up in the command line being executed.  If I don&#39;t include both sets of quote marks, then the command line doesn&#39;t have any quote marks: <code>find SomeText test.txt</code> and that won&#39;t work either, because the quote marks are mandatory.  (Perhaps this is a bug in Go?)"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1426112022, "post_id": 28955182, "comment_id": 46244815, "body": "As it turns out, the issue has already been addressed, the fix just hasn&#39;t made it into the documentation yet.  <a href=\"https://github.com/golang/go/issues/1849\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/1849</a>"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1425954924, "last_edit_date": 1425954924, "creation_date": 1425954607, "answer_id": 28955182, "question_id": 28954729, "link": "https://stackoverflow.com/questions/28954729/exec-with-double-quoted-argument/28955182#28955182", "title": "exec with double quoted argument", "body": "<p>FYI, running:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"find\", `\"SomeText\"`)\n    fmt.Printf(\"Path: %q, args[1]: %q\\n\", cmd.Path, cmd.Args[1])\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/yPkNo3SbbI\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n\n<p>On unix gives:</p>\n\n<pre><code>Path: \"/usr/bin/find\", args[1]: \"\\\"SomeText\\\"\"\n</code></pre>\n\n<p>And cross compiled to Windows and run on Win7 gives:</p>\n\n<pre><code>Path: \"C:\\\\Windows\\\\system32\\\\find.exe\", args[1]: \"\\\"SomeText\\\"\"\n</code></pre>\n\n<p>Both look correct to me.</p>\n\n<p>Adding <code>out, err := cmd.Output()</code> to the Windows cross-compile gives the following for <code>fmt.Printf(\"%#v\\%v\\n\", err, err)</code>:</p>\n\n<pre><code>&amp;exec.ExitError{ProcessState:(*os.ProcessState)(0xc0820046a0)}\nexit status 1\n</code></pre>\n\n<p>But I imagine that's just because find fails to find anything.</p>\n"}, {"comments": [{"owner": {"reputation": 1029, "user_id": 2121526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ot3q.jpg?s=128&g=1", "display_name": "DarkerIvy", "link": "https://stackoverflow.com/users/2121526/darkerivy"}, "edited": false, "score": 1, "creation_date": 1539635156, "post_id": 28998651, "comment_id": 92565662, "body": "This does not appear to work in current versions of Go (1.11.1), as it returns <code>cmd.SysProcAttr.CmdLine undefined (type *syscall.SysProcAttr has no field or method CmdLine)</code>"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 1029, "user_id": 2121526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ot3q.jpg?s=128&g=1", "display_name": "DarkerIvy", "link": "https://stackoverflow.com/users/2121526/darkerivy"}, "edited": false, "score": 0, "creation_date": 1539642500, "post_id": 28998651, "comment_id": 92567956, "body": "@DarkerIvy, <a href=\"https://golang.org/src/syscall/exec_windows.go\" rel=\"nofollow noreferrer\">the functionality appears to still be in the source code</a>, although the <a href=\"https://docs.google.com/document/d/1QXzI9I1pOfZPujQzxhyRy6EeHYTQitKKjHfpq0zpxZs/edit\" rel=\"nofollow noreferrer\">syscall package is deprecated</a>.  Presumably the compatibility rules mentioned in the latter link mean this code should still work, if it no longer does perhaps that should be filed as a bug?  (You&#39;re sure you&#39;re running the Windows version of Go and not, e.g., Cygwin or something?)"}], "tags": [], "owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "is_accepted": true, "score": 6, "last_activity_date": 1426113161, "creation_date": 1426113161, "answer_id": 28998651, "question_id": 28954729, "link": "https://stackoverflow.com/questions/28954729/exec-with-double-quoted-argument/28998651#28998651", "title": "exec with double quoted argument", "body": "<p>OK, it's a bit more complicated than you might have expected, but there <em>is</em> a solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n    \"syscall\"\n)\n\nfunc main() {\n    cmd := exec.Command(`find`)\n    cmd.SysProcAttr = &amp;syscall.SysProcAttr{}\n    cmd.SysProcAttr.CmdLine = `find \"SomeText\" test.txt`\n    out, err := cmd.Output()\n    fmt.Printf(\"%s\\n\", out)\n    fmt.Printf(\"%v\\n\", err)\n}\n</code></pre>\n\n<p>Unfortunately, <a href=\"https://github.com/golang/go/issues/1849\" rel=\"noreferrer\">although support for this was added in 2011</a>, it doesn't appear to have made it into <a href=\"http://golang.org/pkg/os/exec/\" rel=\"noreferrer\">the documentation</a> yet.  (Although perhaps I just don't know where to look.)</p>\n"}], "owner": {"reputation": 1710, "user_id": 1630191, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/179c7e7c696827305522d3e97952f46c?s=128&d=identicon&r=PG&f=1", "display_name": "user232343", "link": "https://stackoverflow.com/users/1630191/user232343"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2603, "favorite_count": 4, "accepted_answer_id": 28998651, "answer_count": 2, "score": 7, "last_activity_date": 1426113161, "creation_date": 1425950956, "question_id": 28954729, "link": "https://stackoverflow.com/questions/28954729/exec-with-double-quoted-argument", "title": "exec with double quoted argument", "body": "<p>I want to execute <code>find</code> Windows command using <code>exec</code> package, but windows is doing some weird escaping.</p>\n\n<p>I have something like:\n<code>\nout, err := exec.Command(\"find\", `\"SomeText\"`).Output()\n</code></p>\n\n<p>but this is throwing error because Windows is converting this to\n<code>\nfind /SomeText\"\n</code></p>\n\n<p>Does anyone know why? How I can execute <code>find</code> on windows using exec package?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 9, "last_activity_date": 1593368285, "last_edit_date": 1593368285, "creation_date": 1425953587, "answer_id": 28955038, "question_id": 28954646, "link": "https://stackoverflow.com/questions/28954646/iterating-over-an-array-of-interfaces/28955038#28955038", "title": "Iterating over an array of interfaces", "body": "<p>In a <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">type switch</a>, if you wish to access the variable casted to the appropriate type just use something like <code>switch x := v.(type)</code> and in each case of the switch <code>x</code> will be of the appropriate value. The spec has an example of this. You can even do <code>switch v := v.(type)</code> and within the switch statement there will be a shadowed version of v.</p>\n<p>E.g.:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>switch x := v.(type) {\ncase []interface{}:\n        fmt.Printf(&quot;got %T\\n&quot;, x)\n        for i, e := range x {\n                fmt.Println(i, e)\n        }\ndefault:\n        fmt.Printf(&quot;I don't know how to handle %T\\n&quot;, v)\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/MeHSIbpRwM\" rel=\"nofollow noreferrer\"><kbd>playground</kbd></a></p>\n<p>Also note that you can just use &quot;%T&quot; with <code>fmt.Printf</code> instead of (directly) using the reflect package when you just want to print the type of a variable.</p>\n<p>Finally, note that a type switch is what you want if you have multiple non-default clauses, but if, as in your example, you really only have one type you are interested in then instead you should do something like:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>if x, ok := v.([]interface{}); ok {\n        fmt.Printf(&quot;got %T\\n&quot;, x)\n        for i, e := range x {\n                fmt.Println(i, e)\n        }\n} else {\n        fmt.Printf(&quot;I don't know how to handle %T\\n&quot;, v)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 901, "user_id": 3749292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5UptT.jpg?s=128&g=1", "display_name": "Jerry Ajay", "link": "https://stackoverflow.com/users/3749292/jerry-ajay"}, "edited": false, "score": 0, "creation_date": 1425994697, "post_id": 28956014, "comment_id": 46182086, "body": "I just changed my <code>switch v.(type)</code> to <code>switch vv := v.(type)</code> and everything started working fine when I range over vv. Thanks anyway."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426003901, "post_id": 28956014, "comment_id": 46188834, "body": "I should have noted in my answer that if you only have the two cases in the switch (i.e. you only handle one type) you really should be using <code>vv, ok := v.([]interface{})</code> and just checking <code>ok</code>. A type switch is for when you want to handle multiple types."}], "tags": [], "owner": {"reputation": 481, "user_id": 4625249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XacEU.gif?s=128&g=1", "display_name": "ProfOak", "link": "https://stackoverflow.com/users/4625249/profoak"}, "is_accepted": false, "score": 1, "last_activity_date": 1426004072, "last_edit_date": 1426004072, "creation_date": 1425960570, "answer_id": 28956014, "question_id": 28954646, "link": "https://stackoverflow.com/questions/28954646/iterating-over-an-array-of-interfaces/28956014#28956014", "title": "Iterating over an array of interfaces", "body": "<p>You can always use <code>v.([]interface{})</code>. I ran into the same problem when trying to parse hetrogeneous json objects that had to be treated as interfaces.</p>\n\n<p>Although that might not work in your loop unless you know something about your data beforehand.</p>\n"}], "owner": {"reputation": 901, "user_id": 3749292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5UptT.jpg?s=128&g=1", "display_name": "Jerry Ajay", "link": "https://stackoverflow.com/users/3749292/jerry-ajay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4462, "favorite_count": 1, "accepted_answer_id": 28955038, "answer_count": 2, "score": 4, "last_activity_date": 1593368285, "creation_date": 1425950259, "question_id": 28954646, "link": "https://stackoverflow.com/questions/28954646/iterating-over-an-array-of-interfaces", "title": "Iterating over an array of interfaces", "body": "<p>I wrote the code:</p>\n\n<pre><code>switch v.(type) {\n        case []interface{}:\n            fmt.Println(reflect.TypeOf(v))\n            for index, element := range v {\n                fmt.Println(\"Inside for\")\n            }\n        default:\n            fmt.Println(\"I don't know how to handle this.\")\n        }\n</code></pre>\n\n<p>Now, my <code>reflect.TypeOf(v)</code> outputs the type as <code>[]interface {}</code> . But, I'm not able to iterate over the array of interfaces. I encounter the error:<code>cannot range over v (type interface {})</code>. Could someone please explain me why ? Also, what's the workaround ?</p>\n"}, {"tags": ["xml", "encoding", "go", "marshalling", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 3268232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8718a9666e8ac7a0e170a4b923a70b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3268232", "link": "https://stackoverflow.com/users/3268232/user3268232"}, "edited": false, "score": 0, "creation_date": 1425950927, "post_id": 28954656, "comment_id": 46162994, "body": "Awesome! Thanks for such a detailed response. I will likely go with the 1st option, because the zip and zap are much more nested in reality.  You mention it won&#39;t be possible with encoding/xml. Are there any built-in libraries that are maybe slightly more complex, but allow for the ambiguity?"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 227, "user_id": 3268232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8718a9666e8ac7a0e170a4b923a70b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3268232", "link": "https://stackoverflow.com/users/3268232/user3268232"}, "edited": false, "score": 1, "creation_date": 1425958815, "post_id": 28954656, "comment_id": 46164776, "body": "You might be able to handle some cases by implementing the <code>xml.Unmarshaler</code> interface to implement custom decoding for a type, but that is non-trivial.  It might be simpler to use option (1) above, and then copy the data to your target data structure."}, {"owner": {"reputation": 227, "user_id": 3268232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8718a9666e8ac7a0e170a4b923a70b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3268232", "link": "https://stackoverflow.com/users/3268232/user3268232"}, "edited": false, "score": 0, "creation_date": 1426009571, "post_id": 28954656, "comment_id": 46192673, "body": "Thanks. I&#39;m new to Go and XML so I will stick with option (1) :)"}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 11, "last_activity_date": 1425950383, "creation_date": 1425950383, "answer_id": 28954656, "question_id": 28954415, "link": "https://stackoverflow.com/questions/28954415/unmarshaling-xml-in-go-with-conflicting-element-names/28954656#28954656", "title": "Unmarshaling XML in Go with Conflicting Element Names", "body": "<p>The <code>encoding/xml</code> package won't be able to do exactly what you want, since it makes the decision over which field of <code>Foo</code> to decode into when it encounters the <code>&lt;bar&gt;</code> element, rather than when processing children of that element.  Your struct definitions make this decision ambiguous, as the error from <code>xml.Unmarshal</code> indicates:</p>\n\n<blockquote>\n  <p>main.Foo field \"Bar1\" with tag \"\" conflicts with field \"Bar2\" with tag \"\"</p>\n</blockquote>\n\n<p>Here are two alternatives that will work though:</p>\n\n<p><strong>1. Use one <code>Bar</code> struct to cover both branches</strong></p>\n\n<p>If you modify your types to read as:</p>\n\n<pre><code>type Foo struct {\n    XMLName xml.Name `xml:\"foo\"`\n    Bars    []Bar    `xml:\"bar\"`\n}\n\ntype Bar struct {\n    Zip string `xml:\"zip\"`\n    Zap string `xml:\"zap\"`\n}\n</code></pre>\n\n<p>You will now get a slice that represents all the <code>&lt;bar&gt;</code> elements.  You can tell whether the element had a <code>&lt;zip&gt;</code> or <code>&lt;zap&gt;</code> element by checking whether the corresponding fields are non-empty.</p>\n\n<p>You can try out this version here: <a href=\"https://play.golang.org/p/kguPCYmKX0\">https://play.golang.org/p/kguPCYmKX0</a></p>\n\n<p><strong>2. Use child selectors</strong></p>\n\n<p>If you are only interested in a single child element of <code>&lt;bar&gt;</code> in each branch, then you might not need a struct to represent that element at all.  For example, you could decode into the following type:</p>\n\n<pre><code>type Foo struct {\n    XMLName xml.Name `xml:\"foo\"`\n    Zip     string   `xml:\"bar&gt;zip\"`\n    Zap     string   `xml:\"bar&gt;zap\"`\n}\n</code></pre>\n\n<p>Now the children of the <code>&lt;bar&gt;</code> elements will be decoded directly into members of the <code>Foo</code> struct.  Note that with this option you won't be able to distinguish your chosen input from e.g.</p>\n\n<pre><code>&lt;foo&gt;\n  &lt;bar&gt;\n    &lt;zip&gt;zip&lt;/zip&gt;\n    &lt;zap&gt;zap&lt;/zap&gt;\n  &lt;/bar&gt;\n&lt;/foo&gt;\n</code></pre>\n\n<p>If that will cause problems, then you should pick the first solution.</p>\n\n<p>You can try out this version here: <a href=\"https://play.golang.org/p/fAE_HSrv4y\">https://play.golang.org/p/fAE_HSrv4y</a></p>\n"}], "owner": {"reputation": 227, "user_id": 3268232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8718a9666e8ac7a0e170a4b923a70b5?s=128&d=identicon&r=PG&f=1", "display_name": "user3268232", "link": "https://stackoverflow.com/users/3268232/user3268232"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1726, "favorite_count": 0, "accepted_answer_id": 28954656, "answer_count": 1, "score": 5, "last_activity_date": 1426282785, "creation_date": 1425948744, "question_id": 28954415, "link": "https://stackoverflow.com/questions/28954415/unmarshaling-xml-in-go-with-conflicting-element-names", "title": "Unmarshaling XML in Go with Conflicting Element Names", "body": "<p>I have the following XML, externally defined and outside of my organization's control:</p>\n\n<pre><code>&lt;foo&gt;\n  &lt;bar&gt;\n    &lt;zip&gt;zip&lt;/zip&gt;\n  &lt;/bar&gt;\n  &lt;bar&gt;\n    &lt;zap&gt;zap&lt;/zap&gt;\n  &lt;/bar&gt;\n&lt;/foo&gt;\n</code></pre>\n\n<p>I am using these structs:</p>\n\n<pre><code>type Foo struct {\n    XMLName xml.Name `xml:\"foo\"`\n    Bar1    Bar1\n    Bar2    Bar2\n}\n\ntype Bar1 struct {\n    XMLName xml.Name `xml:\"bar\"`\n    Zip     string   `xml:\"zip\"`\n}\n\ntype Bar2 struct {\n    XMLName xml.Name `xml:\"bar\"`\n    Zap     string   `xml:\"zap\"`\n}\n</code></pre>\n\n<p>Because of the conflicting 'bar' name, nothing gets unmarshaled. How can I populate the Bar1 and Bar2 structs?</p>\n\n<p>This is what I have: <a href=\"https://play.golang.org/p/D2IRLojcTB\" rel=\"noreferrer\">https://play.golang.org/p/D2IRLojcTB</a></p>\n\n<p>This is the result I want: <a href=\"https://play.golang.org/p/Ytrbzzy9Ok\" rel=\"noreferrer\">https://play.golang.org/p/Ytrbzzy9Ok</a></p>\n\n<p>In the second one, I have updated the second 'bar' to be 'bar1,' and it all works. I'd rather come up with a cleaner solution that modifying the incoming XML.</p>\n"}, {"tags": ["debugging", "go"], "comments": [{"owner": {"reputation": 2157, "user_id": 732348, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/595d32f8579f5e964928f78d0219db99?s=128&d=identicon&r=PG&f=1", "display_name": "Andro", "link": "https://stackoverflow.com/users/732348/andro"}, "edited": false, "score": 0, "creation_date": 1425938473, "post_id": 28952513, "comment_id": 46158795, "body": "well <code>err</code> is equal to <code>nil</code> so the condition in if statement is true and the function returns."}, {"owner": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 1, "creation_date": 1425938833, "post_id": 28952513, "comment_id": 46158972, "body": "Are you asking why the if statement is true or why returning from the function stops the rest of the function from being executed? What <i>is</i> the expected behavior?"}], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 1028452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ea497b1757f8a314e1ce2be769aa2f?s=128&d=identicon&r=PG", "display_name": "Skarllot", "link": "https://stackoverflow.com/users/1028452/skarllot"}, "edited": false, "score": 0, "creation_date": 1425990744, "post_id": 28952555, "comment_id": 46179313, "body": "I can&#39;t believe that I done such a primary error. I struggling so much time with interface{} (I miss generics) that I missed it."}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 3, "last_activity_date": 1425938455, "creation_date": 1425938455, "answer_id": 28952555, "question_id": 28952513, "link": "https://stackoverflow.com/questions/28952513/code-below-if-statement-is-never-executed/28952555#28952555", "title": "Code below IF statement is never executed", "body": "<p>Let's step through it.</p>\n\n<pre><code>fmt.Println(\"Error:\", err)\n</code></pre>\n\n<p>If the output is <code>Error: &lt;nil&gt;</code> .. then your <code>err</code> variable is <code>nil</code>.</p>\n\n<pre><code>if err == nil {\n    return err\n}\n</code></pre>\n\n<p>This is saying .. \"if the <code>err</code> variable is <code>nil</code> (which it is .. we established that above) ... then return the <code>nil</code> value.</p>\n\n<p>At this point .. your function has returned.. so nothing else below it will run.</p>\n\n<p>Perhaps you meant this line instead?:</p>\n\n<pre><code>if err != nil {\n//     ^^ NOT equal?\n</code></pre>\n"}], "owner": {"reputation": 685, "user_id": 1028452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ea497b1757f8a314e1ce2be769aa2f?s=128&d=identicon&r=PG", "display_name": "Skarllot", "link": "https://stackoverflow.com/users/1028452/skarllot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 28952555, "answer_count": 1, "score": -3, "last_activity_date": 1425938455, "creation_date": 1425938312, "question_id": 28952513, "link": "https://stackoverflow.com/questions/28952513/code-below-if-statement-is-never-executed", "title": "Code below IF statement is never executed", "body": "<p>There's a section of my code that has unexpected behaviour.</p>\n\n<pre><code>. . .\nfmt.Println(\"Error:\", err)\nif err == nil {\n    return err\n}\nfmt.Println(\"Done category\")\n. . .\n</code></pre>\n\n<p>The section above has the following output</p>\n\n<pre><code>Error: &lt;nil&gt;\n</code></pre>\n\n<p>The code below if statement is never executed. If I remove the if statement the code behaves as expected.</p>\n\n<p>Reference: <a href=\"https://github.com/skarllot/flogviewer/blob/master/wlog/parser.go#L138\" rel=\"nofollow\">https://github.com/skarllot/flogviewer/blob/master/wlog/parser.go#L138</a></p>\n"}, {"tags": ["xml", "go", "slice"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1425932136, "post_id": 28950892, "comment_id": 46155738, "body": "<code>urlSlice = append(urlSlice, url)</code>?"}, {"owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "reply_to_user": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1425932409, "post_id": 28950892, "comment_id": 46155861, "body": "Thanks; but I first need to create a slice, right? My function <code>ReadFileIntoSlice</code> is returning unmarshalled data. Now how can I create a slice of this data?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425935900, "post_id": 28950892, "comment_id": 46157635, "body": "You need to be more specific, We don&#39;t know what &quot;thing&quot; is, or why you want to convert it to a slice (of what?). Your playground link runs, what do you want o do with it?"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1425938302, "post_id": 28950892, "comment_id": 46158712, "body": "<code>Now how can I create a slice of this data?</code> - You have one. <code>records.Records</code> is a slice containing each record in the xml .."}], "answers": [{"tags": [], "owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "is_accepted": true, "score": 2, "last_activity_date": 1425939029, "creation_date": 1425939029, "answer_id": 28952691, "question_id": 28950892, "link": "https://stackoverflow.com/questions/28950892/unmarshal-xml-to-struct-and-convert-to-slice/28952691#28952691", "title": "Unmarshal XML to struct and convert to slice", "body": "<p>In a comment on your question you asked:</p>\n\n<blockquote>\n  <p>I first need to create a slice, right?</p>\n</blockquote>\n\n<p>The answer is yes, but you already have a slice in your <code>ReadingListRecords</code> struct:</p>\n\n\n\n<pre class=\"lang-go prettyprint-override\"><code>type ReadingListRecords struct {\n    XMLName xml.Name `xml:\"records\"`\n    Records []Record `xml:\"record\"`\n}\n</code></pre>\n\n<p>So, you can simply call append on that slice and pass in a new record struct:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>records.Records = append(record.Records, Record{xml.Name{\"\", \"record\"}, 4, \"url\", \"2015-03-09 00:00:00\"})\n</code></pre>\n\n<p>You could also expand the API for your <code>ReadingListRecords</code> structure to include a handy <code>Append</code> function:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>type RecordSet interface {\n    Append(record Record) error\n}\n\nfunc (records *ReadingListRecords) Append(record Record) error {\n    newRecords := append(records.Records, record)\n\n    if newRecords == nil {\n        return errors.New(\"Could not append record\")\n    } else {\n        records.Records = newRecords\n        return nil\n    }\n}\n</code></pre>\n\n<p>Adding an interface seems like a good idea since you would like to use this as a service in multiple applications.</p>\n\n<p>See <a href=\"http://play.golang.org/p/-BgzHqxNbr\" rel=\"nofollow\">my fork of your playground here</a>.</p>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 28952691, "answer_count": 1, "score": -1, "last_activity_date": 1425939029, "creation_date": 1425931845, "last_edit_date": 1425932901, "question_id": 28950892, "link": "https://stackoverflow.com/questions/28950892/unmarshal-xml-to-struct-and-convert-to-slice", "title": "Unmarshal XML to struct and convert to slice", "body": "<p>I have a simple project in Golang which I use to learn this language. Main purpose of the \"service\" which I'm developing is to run a daemon to save URLs which are exposed as XML. This way I can \"produce\" my own read-later service. So far so good :). You can find the project here: <a href=\"https://github.com/rogierlommers/readinglist-golang\" rel=\"nofollow\">https://github.com/rogierlommers/readinglist-golang</a></p>\n\n<p>I'm using Gin-Gonic as the framework for serving html. I've already managed to read an xml file, unmarshal it but now I want to add some new data into this \"thing\". In other words: I think I need to convert it into a slice, but I don't know how to manage this.</p>\n\n<p>F.e. the endpoint <code>r.GET(\"/add/:url\")</code> should use the function util.AddRecord to insert the new url into the slice. But how?</p>\n\n<p>[edit]\nBasically my problem can be viewed in this go playground: <a href=\"http://play.golang.org/p/Vx0s02E12R\" rel=\"nofollow\">http://play.golang.org/p/Vx0s02E12R</a></p>\n"}, {"tags": ["regex", "go", "mux", "gorilla"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1425931052, "post_id": 28950606, "comment_id": 46155131, "body": "That&#39;s not the syntax for matching a path in gorrila/mux:  <code>[paths] are defined using the format {name} or {name:pattern}</code>. <a href=\"http://www.gorillatoolkit.org/pkg/mux\" rel=\"nofollow noreferrer\">gorillatoolkit.org/pkg/mux</a>"}, {"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425931123, "post_id": 28950606, "comment_id": 46155180, "body": "Heh I edited the post before I saw your comment, but I have of course tested with the following two ways as well: 1) Curly brackets doesn&#39;t work with my &quot;exclude&quot; regex. 2) neither does {_dummy: regex}"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1425931251, "post_id": 28950606, "comment_id": 46155274, "body": "that&#39;s also not supported syntax for a Go regexp. You don&#39;t need to exclude install, as it would be matched by the first route."}, {"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425931407, "post_id": 28950606, "comment_id": 46155357, "body": "I have some logic in the admin handler which only works, and only should hit the server, if the user is logged in and the user is set in the request context, so that&#39;s my reasoning for wanting to make an exception and exclude the /admin/install route and include all others. :) I know I can code my way around it inside the admin, handler, but it would have been sweet if this would have worked I think :-)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1427149636, "post_id": 28950606, "comment_id": 46652124, "body": "You have selected the wrong answer: <code>[^install]</code> is not the same as &quot;not followed by the word install&quot;."}, {"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 0, "creation_date": 1427155265, "post_id": 28950606, "comment_id": 46654017, "body": "No but it does solve the problem, by excluding &#39;install&#39; from the url, which is basically what I requested. The problem before was that /admin/install would also match the /admin/{_dummy:.*} (wildcard routes prefixed by /admin/), which was not the desired behavior. This was what I was trying to solve using negative lookahead, but excluding &#39;install&#39;, does give the desired result as well. <a href=\"http://regexone.com/lesson/4\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 0, "creation_date": 1425931461, "post_id": 28950741, "comment_id": 46155391, "body": "I feared it would be something like that. That sucks! :-) I guess I need to code around it inside the admin handler then - easy, but not as pretty as this would have been if it had worked. Thanks! Btw... problem with your proposed solution is that even if admin/install is defined first, /admin/ will also be executed. That&#39;s what I wanted to avoid."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1425933366, "last_edit_date": 1592644375, "creation_date": 1425931233, "answer_id": 28950741, "question_id": 28950606, "link": "https://stackoverflow.com/questions/28950606/gorilla-mux-regex/28950741#28950741", "title": "Gorilla Mux Regex", "body": "<p>It doesn't work because golang regexp follows the <a href=\"https://code.google.com/p/re2/wiki/Syntax\" rel=\"nofollow noreferrer\">re2 syntax</a>, which doesn't support lookahead or lookbehind.</p>\n<p>You might need to define an handler for <code>/admin/install</code> <em>first</em>.<br />\nThen all others <code>/admin/xxx</code> would be for other routes (ie not <code>/admin/install</code>)</p>\n<p>Actually, the <a href=\"https://stackoverflow.com/users/3973406/sk84\">OP SK84</a> adds <a href=\"https://stackoverflow.com/questions/28950606/gorilla-mux-regex/28950741#comment46155391_28950741\">in the comments</a>:</p>\n<blockquote>\n<p>Even if admin/install is defined first, /admin/ will also be executed. That's what I wanted to avoid.</p>\n<p>I guess I need to code around it inside the admin handler then - easy, but not as pretty as this would have been if it had worked.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1427180545, "post_id": 29221581, "comment_id": 46660679, "body": "It does work (+1). I was a bit confused considering <code>[^instal]</code> (you shouldn&#39;t need the second <code>l</code> here) is a negated character class, is it not? (<a href=\"http://www.regular-expressions.info/charclass.html\" rel=\"nofollow noreferrer\">regular-expressions.info/charclass.html</a>)."}], "tags": [], "owner": {"reputation": 379, "user_id": 4692135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZ0WN.jpg?s=128&g=1", "display_name": "S&#248;ren H&#248;yer Kristensen", "link": "https://stackoverflow.com/users/4692135/s%c3%b8ren-h%c3%b8yer-kristensen"}, "is_accepted": true, "score": 5, "last_activity_date": 1427154513, "last_edit_date": 1427154513, "creation_date": 1427149443, "answer_id": 29221581, "question_id": 28950606, "link": "https://stackoverflow.com/questions/28950606/gorilla-mux-regex/29221581#29221581", "title": "Gorilla Mux Regex", "body": "<p>It is actually possible to do this:</p>\n\n<pre><code>m.HandleFunc(`/{_dummy:admin\\/([^install]*).*}`, adminHandler).Methods(\"GET\")\n</code></pre>\n\n<p>Edit:</p>\n\n<p>As my answer to VonC's comment above, here a sample go app: <a href=\"https://play.golang.org/p/nYWNADK7Sr\" rel=\"nofollow\">https://play.golang.org/p/nYWNADK7Sr</a></p>\n\n<p>Run it on your local pc. Try the following routes:</p>\n\n<pre><code>http://localhost:8080/admin/ - (returns \"adminHandler\")\nhttp://localhost:8080/admin/something - (returns \"adminHandler\")\nhttp://localhost:8080/admin/install - (returns \"installHandler\")\n</code></pre>\n\n<p>So yes VonC, it does solve the specific problem:</p>\n\n<blockquote>\n  <p>\"to first match the /admin/install route, and that exact route I then\n  want to exclude from the route below\"</p>\n</blockquote>\n\n<p>But it is correct that it doesn't mean <em>\"not followed by the word, install\"</em> - this is just an alternative approach which is possible within the bounds of the re2 syntax. To simply \"ignore\" or exclude the word install, if it happens to show up in the url.</p>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6540, "favorite_count": 1, "accepted_answer_id": 29221581, "answer_count": 2, "score": 4, "last_activity_date": 1427154513, "creation_date": 1425930627, "last_edit_date": 1425931057, "question_id": 28950606, "link": "https://stackoverflow.com/questions/28950606/gorilla-mux-regex", "title": "Gorilla Mux Regex", "body": "<p>I'm using the Mux package from the <a href=\"http://www.gorillatoolkit.org/pkg/mux\" rel=\"nofollow\">Golang Gorilla Toolkit</a> for my routes.</p>\n\n<p>Consider the following routes: </p>\n\n<pre><code>m.HandleFunc(\"/admin/install\", installHandler).Methods(\"GET\")\nm.HandleFunc(\"/admin/^((?!install).)*$\", adminHandler).Methods(\"GET\")\nm.HandleFunc(\"/admin\", adminHandler).Methods(\"GET\")\n</code></pre>\n\n<p>The problem is with the regex of the middle route - it is not interpreted, so the route will not work!</p>\n\n<pre><code>m.HandleFunc(\"/admin/{^((?!install).)*$}\", adminHandler).Methods(\"GET\")\n</code></pre>\n\n<p>With the {} curly brackets doesn't work either. It is just ignored, and treated as /admin/</p>\n\n<p>Neither does:</p>\n\n<pre><code>m.HandleFunc(\"/admin/{_dummy:^((?!install).)*$}\", adminHandler).Methods(\"GET\")\n</code></pre>\n\n<p>In short, what I'm trying to achieve here is to first match the /admin/install route, and that exact route I then want to exclude from the route below, using the regex, but it doesn't work.</p>\n\n<p>Is there some way to use regex with the gorilla mux package?</p>\n"}, {"tags": ["go", "buffer", "wav"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425939822, "post_id": 28949063, "comment_id": 46159332, "body": "Unrelated to the issue at hand, but your code doesn&#39;t follow the semantics of <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a>. (It turns out <a href=\"https://golang.org/pkg/bufio/#Reader.Read\" rel=\"nofollow noreferrer\"><code>bufio.Buffer</code>&#39;s</a> implementation is documented to be more strict, but in general it&#39;s best to assume any <code>io.Reader</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 994, "user_id": 244690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15437c0c7db2a631f440b29e0a9c4fae?s=128&d=identicon&r=PG", "display_name": "margnus1", "link": "https://stackoverflow.com/users/244690/margnus1"}, "is_accepted": false, "score": 1, "last_activity_date": 1425925689, "creation_date": 1425925689, "answer_id": 28949235, "question_id": 28949063, "link": "https://stackoverflow.com/questions/28949063/golang-read-buffered-input-as-signed-16bit-ints/28949235#28949235", "title": "Golang: Read buffered input as signed 16bit ints", "body": "<p>You can use <a href=\"http://golang.org/pkg/encoding/binary/#Read\" rel=\"nofollow\"><code>encoding/binary.Read</code></a> to fill an <code>[]int16</code> directly from your reader, although technically the answer to your first question is still no (check the source of <code>binary.Read</code>, it reads the data to a <code>[]byte</code> first).</p>\n"}, {"comments": [{"owner": {"reputation": 363, "user_id": 4650757, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v1wkgqnKvrA/AAAAAAAAAAI/AAAAAAAAAHU/JLN05tIpxXM/photo.jpg?sz=128", "display_name": "cannadayr", "link": "https://stackoverflow.com/users/4650757/cannadayr"}, "edited": false, "score": 0, "creation_date": 1425927632, "post_id": 28949296, "comment_id": 46153367, "body": "Looks like I should iterate over the array <a href=\"http://play.golang.org/p/YPw2j8cc3d\" rel=\"nofollow noreferrer\">like this</a>? There isn&#39;t an int16 method for binary.Read, so I lose sign, but that can be converted when I need it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 363, "user_id": 4650757, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v1wkgqnKvrA/AAAAAAAAAAI/AAAAAAAAAHU/JLN05tIpxXM/photo.jpg?sz=128", "display_name": "cannadayr", "link": "https://stackoverflow.com/users/4650757/cannadayr"}, "edited": false, "score": 0, "creation_date": 1425928770, "post_id": 28949296, "comment_id": 46153965, "body": "@smileybone: Yes, that works, just check that you always have 2 bytes to work with at the end of the slice. There&#39;s no Int16 method because you just convert it from a uint16 (the library does this internally when needed, look at the binary.Read function source)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1425926505, "last_edit_date": 1425926505, "creation_date": 1425925871, "answer_id": 28949296, "question_id": 28949063, "link": "https://stackoverflow.com/questions/28949063/golang-read-buffered-input-as-signed-16bit-ints/28949296#28949296", "title": "Golang: Read buffered input as signed 16bit ints", "body": "<p>When working with IO, you always work with <code>[]byte</code>s, there's no way to substitute that with <code>[]int16</code>, or pre-format that as <code>int16</code>s, it's always a stream of bytes.</p>\n\n<p>You can look at the <a href=\"http://golang.org/pkg/encoding/binary/\" rel=\"nofollow\"><code>encoding/binary</code></a> package to decode this stream.</p>\n\n<pre><code>// to get the first uint16 as i\ni := binary.LittleEndian.Uint16(buf[:2])\n</code></pre>\n\n<p>You can then iterate through the buf as needed. </p>\n\n<p>You can also use <a href=\"http://golang.org/pkg/encoding/binary/#Read\" rel=\"nofollow\"><code>binary.Read</code></a> to read directly from the <code>io.Reader</code>. </p>\n\n<pre><code>var i uint16\nfor {\n    err := binary.Read(r, binary.LittleEndian, &amp;i)\n    if err != nil {\n        log.Println(err)\n        break\n    }\n    fmt.Println(i)\n}\n</code></pre>\n\n<p>It may worth noting the simplicity of what needs to be done. Each <code>uint16</code> is created via:</p>\n\n<pre><code>func (littleEndian) Uint16(b []byte) uint16 {\n    return uint16(b[0]) | uint16(b[1])&lt;&lt;8\n}\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 4650757, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v1wkgqnKvrA/AAAAAAAAAAI/AAAAAAAAAHU/JLN05tIpxXM/photo.jpg?sz=128", "display_name": "cannadayr", "link": "https://stackoverflow.com/users/4650757/cannadayr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2398, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1425926505, "creation_date": 1425925095, "question_id": 28949063, "link": "https://stackoverflow.com/questions/28949063/golang-read-buffered-input-as-signed-16bit-ints", "title": "Golang: Read buffered input as signed 16bit ints", "body": "<p>I am trying to read a buffered stream of signed 16 bit integers (wav format), but the bufio.Read method only accepts an array of bytes. My question is a 2-parter:</p>\n\n<ol>\n<li>Can I preformat the byte stream into a buffered int16 array?</li>\n<li><p>If I can't, whats the best way of post-processing the byte array into int16 array? My initial thought is to use tmp arrays and keep pushing/processing them, but I was curious if there was a more idiomatic way of doing this?</p>\n\n<pre><code>package main\n\nimport (\n     \"bufio\"\n     \"io\"\n     \"log\"\n     \"os/exec\"\n)\n\nfunc main() {\n\n    app := \"someapp\"\n\n    cmd := exec.Command(app)\n    stdout, err := cmd.StdoutPipe()\n    r := bufio.NewReader(stdout)\n    if err != nil {\n        log.Fatal(err)\n    }\n    if err := cmd.Start(); err != nil {\n        log.Fatal(err)\n    }\n\n    //\"someapp\" outputs signed 16bit integers (little endian))\n    buf := make([]byte, 0, 4*1024)\n\n    for {\n        n, err := r.Read(buf[:cap(buf)])    //r.Read only accepts type []byte\n        buf = buf[:n]\n        if n == 0 {\n            if err == nil {\n                continue\n            }\n            if err == io.EOF {\n                break\n            }\n            log.Fatal(err)\n        }\n\n        log.Printf(\"%x\\n\", buf)\n        //process buf here\n\n        if err != nil &amp;&amp; err != io.EOF {\n            log.Fatal(err)\n        }\n    }\n}\n</code></pre></li>\n</ol>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3953860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724ab4e7864fe863904a09cd8aa780ac?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/3953860/luke"}, "edited": false, "score": 0, "creation_date": 1425927532, "post_id": 28947959, "comment_id": 46153320, "body": "thx, works great now... how did you know that fields cannot be private?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 41, "user_id": 3953860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724ab4e7864fe863904a09cd8aa780ac?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/3953860/luke"}, "edited": false, "score": 0, "creation_date": 1425938431, "post_id": 28947959, "comment_id": 46158776, "body": "@Lukasz, probably from the <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#Marshal\" rel=\"nofollow noreferrer\">documentation</a>: &quot;In the case of struct values, only exported fields will be serialized.&quot; As alwyas, RTFM."}, {"owner": {"reputation": 41, "user_id": 3953860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724ab4e7864fe863904a09cd8aa780ac?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/3953860/luke"}, "edited": false, "score": 0, "creation_date": 1426001324, "post_id": 28947959, "comment_id": 46187051, "body": "Well... sentence &quot;The lowercased field name is used as the key for each exported field, but this behavior may be changed using the respective field tag. &quot; makes documentation not 100% obvious . You would think that tag controls what is serialized and what is not."}, {"owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "edited": false, "score": 0, "creation_date": 1426119170, "post_id": 28947959, "comment_id": 46247396, "body": "These two sentences are additive and not in conflict. Only exported fields will be serialized, and those serialized may have the <i>key for each exported field</i> changed via the tag."}], "tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": true, "score": 1, "last_activity_date": 1425921304, "creation_date": 1425921304, "answer_id": 28947959, "question_id": 28946273, "link": "https://stackoverflow.com/questions/28946273/update-query-in-mgo-driver-works-with-bson-m-but-does-not-work-with-custome-st/28947959#28947959", "title": "Update query in MGO driver, works with bson.M, but does not work with custome structure", "body": "<p>All Go marshaling packages I'm aware of, including the <a href=\"http://gopkg.in/mgo.v2/bson\" rel=\"nofollow\">bson</a> package, will not marshal fields that are private (start with a lowercase letter). To fix the issue, just export the relevant fields by uppercasing the first letter of their name.</p>\n\n<p>Also note that, besides the issue mentioned above, the first part of your example will not marshal in an equivalent way to the second part. <code>bson.M{\"$set\": zscore}</code> is equivalent to <code>bson.M{\"$set\": bson.M{\"a\": ... etc ...}}</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 3953860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724ab4e7864fe863904a09cd8aa780ac?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/3953860/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "accepted_answer_id": 28947959, "answer_count": 1, "score": 0, "last_activity_date": 1425921304, "creation_date": 1425916312, "last_edit_date": 1425917134, "question_id": 28946273, "link": "https://stackoverflow.com/questions/28946273/update-query-in-mgo-driver-works-with-bson-m-but-does-not-work-with-custome-st", "title": "Update query in MGO driver, works with bson.M, but does not work with custome structure", "body": "<p>Mgo and golang question.</p>\n\n<p>I run into problem again. I try to update record in the database, but running simple command <code>visitors.UpdateId(v.Id, bson.M{\"$set\": zscore});</code> where <code>zscore</code> is a variable of <code>type Zscore</code>, does not work. However if I manually convert <code>zscore</code> to <code>bson.M</code> structure, everything works fine.</p>\n\n<p>Does anybody know how to update the record in mongodb using mgo, without manually dumping structure values into bson.M?</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>type Zscore struct {\n    a float64 `bson:\"a,omitempty\" json:\"a\"`\n    b float64 `bson:\"b,omitempty\" json:\"b\"`\n    c float64 `bson:\"c,omitempty\" json:\"c\"`\n}\n\nv := Visitor{}\nzscore := Zscore{}\n\nvisitors := updater.C(\"visitors\")\n\nfor result.Next(&amp;v) {\n    zscore.a = 1\n    zscore.b = 2\n    zscore.c = 0\n\n    //does not work\n    if err := visitors.UpdateId(v.Id, bson.M{\"$set\": zscore}); err != nil    {\n            log.Printf(\"Got error while updating visitor: %v\\n\", err)\n    }\n\n    //works\n    set := bson.M{\n        \"zscore.a\": zscore.a,\n        \"zscore.b\": zscore.b,\n        \"zscore.c\": zscore.c,\n    }\n\n    if err := visitors.UpdateId(v.Id, bson.M{\"$set\": set}); err != nil {\n        log.Printf(\"Got error while updating visitor: %v\\n\", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1425917260, "post_id": 28946187, "comment_id": 46147241, "body": "Very helpful. Thank You."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1425917344, "post_id": 28946187, "comment_id": 46147293, "body": "A much better example is to use it with a switch.  Go uses type asserts with switches everywhere, so that you can pass around things of unknown type, yet not find yourself going down a branch dealing with an improperly cast object."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1425919729, "post_id": 28946187, "comment_id": 46148821, "body": "@Rob if you feel that a good example is missing feel free to add it in your answer."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 11, "last_activity_date": 1425916990, "last_edit_date": 1425916990, "creation_date": 1425916050, "answer_id": 28946187, "question_id": 28946086, "link": "https://stackoverflow.com/questions/28946086/what-exactly-does-data-type-method-called-do/28946187#28946187", "title": "What exactly does .(data_type) method called/do?", "body": "<p><code>b.(string)</code> is called a <strong><a href=\"https://golang.org/ref/spec#Type_assertions\">type assertion</a></strong>. As written in <strong><a href=\"https://golang.org/doc/effective_go.html#interface_conversions\">Effective Go</a></strong>:</p>\n\n<blockquote>\n  <p>A type assertion takes an interface value and extracts from it a value of the specified explicit type.</p>\n</blockquote>\n\n<p>So, yes, the value you get from a type assertion is not an interface value, but is of the explicit type. You can also test if the type assertion was successful by adding an untyped boolean value:</p>\n\n<pre><code>s, ok := b.(string) // s is of type string\nif !ok {\n    // b did not contain a value of type string!\n}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>To explain further to clear out any possible misunderstanding:</p>\n\n<p>A type assertion doesn't <em>\"tell Go that b is a string\"</em> as you suggested. What it does is that it will, in run time, try to extract a string from <code>b</code>, and panic if <code>b</code> contains some other type (unless assigning the optional bool value).</p>\n\n<p>The value that you get from the assertion will indeed be of type <code>string</code>, allowing you to do things like slicing (you cannot slice an interface value) or checking its <code>len</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425939179, "post_id": 28948589, "comment_id": 46159116, "body": "<a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">Type switches</a> are a separate concept and construct from <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertions</a>. It&#39;s just an arbitrary (but nice) design choice to make the former use a <code>x.(type)</code> syntax rather than (say) <code>typeof(x)</code>."}], "tags": [], "owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "is_accepted": false, "score": 1, "last_activity_date": 1425923449, "creation_date": 1425923449, "answer_id": 28948589, "question_id": 28946086, "link": "https://stackoverflow.com/questions/28946086/what-exactly-does-data-type-method-called-do/28948589#28948589", "title": "What exactly does .(data_type) method called/do?", "body": "<p>The previous answer is correct.  But I submit this as more like what happens in practice.  The .(type) syntax is usually used with type names in the cases of a switch.  In this example, I (integer expr), B (bool expr), and Bop (binary op) are type names.</p>\n\n<pre><code>func commute (e Expr) (r Expr, d bool) {\n    switch exp:= e.(type) {\n        case I: r,d = exp,false\n        case B: r,d = exp,false\n        case Bop: r,d = Bop{exp.op, exp.right, exp.left},true\n        default: r,d = e,false\n    }\n    return\n}\n</code></pre>\n\n<p>This isn't unsafe like a C cast, because inside the case statement you are guaranteed to have the matching type.  I see this quite a bit when reading a channel, where the type of the channel is an interface that all the cases implement.</p>\n"}], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 28946187, "answer_count": 2, "score": 0, "last_activity_date": 1425923449, "creation_date": 1425915807, "question_id": 28946086, "link": "https://stackoverflow.com/questions/28946086/what-exactly-does-data-type-method-called-do", "title": "What exactly does .(data_type) method called/do?", "body": "<p>I came a cross a piece of code that used <code>.(string)</code> method. Not knowing what this is called I had difficulties searching for it.</p>\n\n<p>Here is my try to understand it:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\nfunc main(){\n    var b interface{}\n    b = \"silly\"\n\n    fmt.Println(reflect.TypeOf(b.(string))) // we know that b \n                                            // is a string                     \n                                            // at compile time\n\n    fmt.Println(reflect.TypeOf(b))          // we do not\n\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>string\nstring\n</code></pre>\n\n<p>However, I think that <code>reflect.TypeOf</code> takes place at run time, while <code>.(string)</code> would tell the compiler that <code>b</code> is indeed a string, and this could be used to tell the compiler that a variable is of certain type. Is my understanding right?</p>\n\n<p><a href=\"https://play.golang.org/p/eTz3HXH3fc\" rel=\"nofollow\">goplayground</a></p>\n"}, {"tags": ["java", "android", "google-app-engine", "go", "google-cloud-endpoints"], "answers": [{"tags": [], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "is_accepted": true, "score": 0, "last_activity_date": 1426080397, "creation_date": 1426080397, "answer_id": 28987857, "question_id": 28944144, "link": "https://stackoverflow.com/questions/28944144/google-cloud-endpoints-generate-java-api-http-400-error/28987857#28987857", "title": "Google cloud endpoints generate Java api HTTP 400 error", "body": "<p>I posted an issue in \n<a href=\"https://github.com/crhym3/go-tictactoe/issues/5\" rel=\"nofollow\">crhym3</a> cloud endpoints example and he helped my to understand my error. </p>\n\n<p>My mistake  was that i  tried to create the  client with the wrong URL address .</p>\n\n<p>This is the wrong address.</p>\n\n<p><a href=\"https://winged-precept-894.appspot.com\" rel=\"nofollow\">https://winged-precept-894.appspot.com</a>  this will return 404 </p>\n\n<p>And this is the correct  discovery api URL.</p>\n\n<p><a href=\"https://winged-precept-894.appspot.com/_ah/api/discovery/v1/apis/myapp/v1/rpc\" rel=\"nofollow\">https://winged-precept-894.appspot.com/_ah/api/discovery/v1/apis/myapp/v1/rpc</a> </p>\n\n<p>So  it was a url error and not a Json oriented error .</p>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 28987857, "answer_count": 1, "score": 0, "last_activity_date": 1426080397, "creation_date": 1425910446, "last_edit_date": 1425976929, "question_id": 28944144, "link": "https://stackoverflow.com/questions/28944144/google-cloud-endpoints-generate-java-api-http-400-error", "title": "Google cloud endpoints generate Java api HTTP 400 error", "body": "<p>Hey im trying  to develop a rest API  by using this doc  <a href=\"http://godoc.org/github.com/GoogleCloudPlatform/go-endpoints/endpoints\" rel=\"nofollow\">go-endpoints</a></p>\n\n<p>I can test my app locally and on the app engine .</p>\n\n<p>But i cant create a Java client in order to consume it on android device,\nfor some reason I'm getting an </p>\n\n<blockquote>\n  <p>HTTP 400  No JSON object could be decoded</p>\n</blockquote>\n\n<p>on this command</p>\n\n<pre><code>  GO_SDK/endpointscfg.py gen_client_lib java MY_FILE_NAME\n</code></pre>\n\n<p>This is the full stack trace </p>\n\n<pre><code>    mik@mik-Aspire-S3:~/go-programs/src/cloudEndPoints/app$ $HOME/go_appengine/endpointscfg.py gen_client_lib java ballota_test\nTraceback (most recent call last):\n  File \"/home/mik/go_appengine/endpointscfg.py\", line 133, in &lt;module&gt;\n    run_file(__file__, globals())\n  File \"/home/mik/go_appengine/endpointscfg.py\", line 129, in run_file\n    execfile(_PATHS.script_file(script_name), globals_)\n  File \"/home/mik/go_appengine/google/appengine/tools/endpointscfg.py\", line 561, in &lt;module&gt;\n    main(sys.argv)\n  File \"/home/mik/go_appengine/google/appengine/tools/endpointscfg.py\", line 557, in main\n    args.callback(args)\n  File \"/home/mik/go_appengine/google/appengine/tools/endpointscfg.py\", line 458, in _GenClientLibCallback\n    args.build_system)\n  File \"/home/mik/go_appengine/google/appengine/tools/endpointscfg.py\", line 335, in _GenClientLib\n    build_system, client_name)\n  File \"/home/mik/go_appengine/google/appengine/tools/endpointscfg.py\", line 366, in _GenClientLibFromContents\n    raise ServerRequestException(error)\n__main__.ServerRequestException: HTTP 400 (Bad Request) error when communicating with URL: https://google-api-client-libraries.appspot.com/generate.  Details: ill-formed JSON: No JSON object could be decoded\n</code></pre>\n\n<p><strong>UPDATE</strong> </p>\n\n<p>I tried to built this sample project  <a href=\"https://go-endpoints.appspot.com/tictactoe\" rel=\"nofollow\">tictactoe</a> as a Java client and i got the same error </p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 2243, "user_id": 783657, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/5eF3P.jpg?s=128&g=1", "display_name": "Nijin Narayanan", "link": "https://stackoverflow.com/users/783657/nijin-narayanan"}, "edited": false, "score": 1, "creation_date": 1425912533, "post_id": 28943171, "comment_id": 46143883, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/28879485/unable-to-start-appengine-application-after-updating-it-via-google-cloud-sdk\">Unable to start appengine application after updating it via Google Cloud SDK</a>"}, {"owner": {"reputation": 1995, "user_id": 2263684, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/86294810cc8dccc906fe5d49c623f7a8?s=128&d=identicon&r=PG", "display_name": "Nek", "link": "https://stackoverflow.com/users/2263684/nek"}, "reply_to_user": {"reputation": 2243, "user_id": 783657, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/5eF3P.jpg?s=128&g=1", "display_name": "Nijin Narayanan", "link": "https://stackoverflow.com/users/783657/nijin-narayanan"}, "edited": false, "score": 0, "creation_date": 1425912761, "post_id": 28943171, "comment_id": 46144051, "body": "Clearly. The problem is that I didn&#39;t found it !"}], "answers": [{"tags": [], "owner": {"reputation": 1995, "user_id": 2263684, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/86294810cc8dccc906fe5d49c623f7a8?s=128&d=identicon&r=PG", "display_name": "Nek", "link": "https://stackoverflow.com/users/2263684/nek"}, "is_accepted": false, "score": 0, "last_activity_date": 1425909471, "creation_date": 1425909471, "answer_id": 28943794, "question_id": 28943171, "link": "https://stackoverflow.com/questions/28943171/impossible-to-start-demo-app-in-go-on-google-app-engine-on-my-local/28943794#28943794", "title": "Impossible to start demo app in Go on Google App Engine on my local", "body": "<p>After installed pip, I executed the following command:</p>\n\n<pre><code>sudo pip install docker-py\n</code></pre>\n\n<p>Now it works.</p>\n"}], "owner": {"reputation": 1995, "user_id": 2263684, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/86294810cc8dccc906fe5d49c623f7a8?s=128&d=identicon&r=PG", "display_name": "Nek", "link": "https://stackoverflow.com/users/2263684/nek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 515, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425909471, "creation_date": 1425907641, "question_id": 28943171, "link": "https://stackoverflow.com/questions/28943171/impossible-to-start-demo-app-in-go-on-google-app-engine-on-my-local", "title": "Impossible to start demo app in Go on Google App Engine on my local", "body": "<p>I followed the tutorial from google here: <a href=\"https://console.developers.google.com/start/appengine\" rel=\"nofollow\">https://console.developers.google.com/start/appengine</a></p>\n\n<p>After what I tried started the demo application and got the following error:</p>\n\n<pre><code>$ goapp serve appengine-try-go\n\nTraceback (most recent call last):\n  File \"/home/nek/google-cloud-sdk/platform/google_appengine/dev_appserver.py\", line 83, in &lt;module&gt;\n    _run_file(__file__, globals())\n  File \"/home/nek/google-cloud-sdk/platform/google_appengine/dev_appserver.py\", line 79, in _run_file\n    execfile(_PATHS.script_file(script_name), globals_)\n  File \"/home/nek/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/devappserver2.py\", line 36, in &lt;module&gt;\n    from google.appengine.tools.devappserver2 import dispatcher\n  File \"/home/nek/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/dispatcher.py\", line 29, in &lt;module&gt;\n  from google.appengine.tools.devappserver2 import module\n  File \"/home/nek/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/module.py\", line 71, in &lt;module&gt;\n  from google.appengine.tools.devappserver2 import vm_runtime_factory\nFile \"/home/nek/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/vm_runtime_factory.py\", line 25, in &lt;module&gt;\n  from google.appengine.tools.devappserver2 import vm_runtime_proxy\nFile \"/home/nek/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/vm_runtime_proxy.py\", line 29, in &lt;module&gt;\n  from google.appengine.tools.devappserver2 import log_manager\nFile \"/home/nek/google-cloud-sdk/platform/google_appengine/google/appengine/tools/devappserver2/log_manager.py\", line 34, in &lt;module&gt;\n  from google.appengine.tools.docker import containers\nFile \"/home/nek/google-cloud-sdk/platform/google_appengine/google/appengine/tools/docker/containers.py\", line 47, in &lt;module&gt;\n  import docker\nImportError: No module named docker\nerror while running dev_appserver.py: exit status 1\n</code></pre>\n\n<p>I'm using it on Ubuntu 14.04 with zsh and python 2.7.6.</p>\n\n<p>Does somebody understand why ?</p>\n"}, {"tags": ["google-app-engine", "go", "limits"], "answers": [{"comments": [{"owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "edited": false, "score": 0, "creation_date": 1425906999, "post_id": 28942808, "comment_id": 46140035, "body": "Thanks Jaime.  Do you know if it&#39;s possible to have this increased in the way that many of the other quotas can be increased for paid apps on request?"}, {"owner": {"reputation": 6412, "user_id": 272372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLzr8.png?s=128&g=1", "display_name": "Hanuman", "link": "https://stackoverflow.com/users/272372/hanuman"}, "reply_to_user": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "edited": false, "score": 0, "creation_date": 1425908990, "post_id": 28942808, "comment_id": 46141294, "body": "Honestly I don&#39;t think that you can (without a Premier account); I think the idea is that at that point you should consider implementing a custom solution for your special needs, in this case setting up your own CDN."}], "tags": [], "owner": {"reputation": 6412, "user_id": 272372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLzr8.png?s=128&g=1", "display_name": "Hanuman", "link": "https://stackoverflow.com/users/272372/hanuman"}, "is_accepted": true, "score": 1, "last_activity_date": 1425906619, "last_edit_date": 1592644375, "creation_date": 1425906619, "answer_id": 28942808, "question_id": 28942720, "link": "https://stackoverflow.com/questions/28942720/static-file-hosting-limits-on-app-engine-with-go/28942808#28942808", "title": "Static file hosting limits on App Engine with Go", "body": "<p>It's currently on the Quotas documentation, under <a href=\"https://cloud.google.com/appengine/docs/quotas#Deployments\" rel=\"nofollow noreferrer\">Deployment</a>:</p>\n<blockquote>\n<p>The number of times the application has been uploaded by a developer. The current quota is 10,000 per day.</p>\n<p>An application is limited to 10,000 uploaded files per version. Each file is limited to a maximum size of 32 megabytes. Additionally, if the total size of all files for all versions exceeds the initial free 1 gigabyte, then there will be a $ 0.026 per GB per month charge.</p>\n</blockquote>\n"}], "owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 28942808, "answer_count": 1, "score": 0, "last_activity_date": 1425906619, "creation_date": 1425906325, "question_id": 28942720, "link": "https://stackoverflow.com/questions/28942720/static-file-hosting-limits-on-app-engine-with-go", "title": "Static file hosting limits on App Engine with Go", "body": "<p>I've been trying to find documentation on static file hosting with App Engine and Go for a while now, but can't find anything current in the documentation.</p>\n\n<p>I've found a number of (unofficial) references from about 5 years ago to a 10,000 file limit with a max of 1,000 per directory, but I haven't been able to find any current official documentation on this other than information on billing for static files.</p>\n\n<p><strong>So what are the static file hosting limits on App Engine</strong> (using Go if that changes things)?  Any links to official documentation will be appreciated.</p>\n"}, {"tags": ["google-app-engine", "go", "memcached"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 47, "last_activity_date": 1425903433, "creation_date": 1425903433, "answer_id": 28941788, "question_id": 28941665, "link": "https://stackoverflow.com/questions/28941665/expected-declaration-found-ident-item/28941788#28941788", "title": "expected declaration, found &#39;IDENT&#39; item", "body": "<p>The <code>:=</code> <a href=\"http://golang.org/ref/spec#Short_variable_declarations\">Short variable declaration</a> can only be used inside functions.</p>\n\n<p>So either put the <code>item</code> variable declaration inside a function like this:</p>\n\n<pre><code>import \"appengine/memcache\"\n\nfunc MyFunc() {\n    item := &amp;memcache.Item {\n        Key:   \"lyric\",\n        Value: []byte(\"Oh, give me a home\"),\n    }\n    // do something with item\n}\n</code></pre>\n\n<p>Or make it a global variable and use the <code>var</code> keyword:</p>\n\n<pre><code>import \"appengine/memcache\"\n\nvar item = &amp;memcache.Item {\n    Key:   \"lyric\",\n    Value: []byte(\"Oh, give me a home\"),\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2954, "user_id": 7699859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YOr4P.jpg?s=128&g=1", "display_name": "Bal Krishna Jha", "link": "https://stackoverflow.com/users/7699859/bal-krishna-jha"}, "is_accepted": false, "score": 0, "last_activity_date": 1615702577, "creation_date": 1615702577, "answer_id": 66621649, "question_id": 28941665, "link": "https://stackoverflow.com/questions/28941665/expected-declaration-found-ident-item/66621649#66621649", "title": "expected declaration, found &#39;IDENT&#39; item", "body": "<p>I was getting the same error, but the reason was completely different.</p>\n<p>I was using following package name.</p>\n<p><code>package go-example</code></p>\n<p>Seems like, it's not a valid package name. After removing the hyphen, it worked.</p>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25756, "favorite_count": 3, "accepted_answer_id": 28941788, "answer_count": 2, "score": 25, "last_activity_date": 1615702577, "creation_date": 1425902979, "last_edit_date": 1425903337, "question_id": 28941665, "link": "https://stackoverflow.com/questions/28941665/expected-declaration-found-ident-item", "title": "expected declaration, found &#39;IDENT&#39; item", "body": "<p>Im writing a small code using Memcache Go API to Get data stored in one of its keys . Here are few of lines of code i used ( got the code from <a href=\"https://cloud.google.com/appengine/docs/go/memcache/\">Go app-engine  docs</a> ) </p>\n\n<pre><code>import \"appengine/memcache\"\n\nitem := &amp;memcache.Item {\nKey:   \"lyric\",\nValue: []byte(\"Oh, give me a home\"),\n}\n</code></pre>\n\n<p>But the line 2 gives me a compilation error  <strong><em>\"expected declaration, found 'IDENT' item\"</em></strong></p>\n\n<p>I'm new to Go , not able to figure out the problem </p>\n"}, {"tags": ["go", "liteide"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 2, "creation_date": 1425918881, "post_id": 28940951, "comment_id": 46148232, "body": "While not strictly off-topic, for greater chances to have this question replied, it should be asked on the Liteide forum instead: <a href=\"https://groups.google.com/forum/#!forum/liteide-dev\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!forum/liteide-dev</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426182336, "post_id": 28940951, "comment_id": 46277810, "body": "There was another (also bountied!) related question; the short answer was to make sure GOROOT and GOPATH are set in the environment setup LiteIDE uses: <a href=\"http://stackoverflow.com/questions/19876902/liteide-no-autocomplete\" title=\"liteide no autocomplete\">stackoverflow.com/questions/19876902/liteide-no-autocomplete</a> . The one difference here is that if the SDK is installed somewhere different from your main GOPATH, you need to find it and add it."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426189095, "post_id": 28940951, "comment_id": 46281443, "body": "@twotwotwo  The SDK is here  /home/mik/go_appengine/ and the GOPATH is here  /home/mik/go-programs if i understand you correct the SDK need to be in here /home/mik/go-programs ??"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426191432, "post_id": 28940951, "comment_id": 46282617, "body": "No--change the GOPATH to include the SDK, like <code>GOPATH=&#47;home&#47;mik&#47;go-programs:&#47;home&#47;mik&#47;go_appengine</code>. It might be <code>go_appengine</code> still isn&#39;t the right directory; look for a <code>src&#47;</code> dir with directories under it with Go package names, and add the parent of that to the end of <code>GOPATH</code> (using <code>:</code> as the separator)."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426192540, "post_id": 28940951, "comment_id": 46283197, "body": "@twotwotwo All the Go packages  are under  /home/mik/go_appengine/groot  so i added it to the GOPATH and now the it look like that  /home/mik/go-programs:/home/mik/go_appengine/goroot/ i restart the machine and the result is the same...."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1426193514, "post_id": 28940951, "comment_id": 46283670, "body": "@MIkCode Gotcha--unfortunately I can&#39;t think of what else to try then."}], "answers": [{"tags": [], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "is_accepted": false, "score": 1, "last_activity_date": 1426235802, "creation_date": 1426235802, "answer_id": 29027872, "question_id": 28940951, "link": "https://stackoverflow.com/questions/28940951/liteide-go-code-completion-for-google-cloud-libraries/29027872#29027872", "title": "liteide go code completion for google cloud libraries", "body": "<p>At the end it was a metter of finding the right path  and adding its to the $GOPATH it only took my 4 days :)</p>\n\n<p>This is the correct path that  enabling  me to get app engine SDK  autocomplation  with LiteIDE</p>\n\n<pre><code>SDK_FOLDER/goroot/pkg/\n</code></pre>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426235802, "creation_date": 1425900653, "question_id": 28940951, "link": "https://stackoverflow.com/questions/28940951/liteide-go-code-completion-for-google-cloud-libraries", "title": "liteide go code completion for google cloud libraries", "body": "<p>Im writing some go code in litede all the library's    are \"working\" fine\nexcept the google cloud library's.<br>\nI cant figure out a way how to get liteide auto complete the google cloud library's  .</p>\n\n<p>the sdk is installed well i can build and deploy the code.</p>\n\n<p>thanks,</p>\n\n<p>miki</p>\n"}, {"tags": ["html", "go", "get", "multipartform-data"], "comments": [{"owner": {"reputation": 141, "user_id": 4323559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KnHo0TiSAPE/AAAAAAAAAAI/AAAAAAAABSk/YNxxSCXWdOk/photo.jpg?sz=128", "display_name": "Santosh Suresh", "link": "https://stackoverflow.com/users/4323559/santosh-suresh"}, "edited": false, "score": 0, "creation_date": 1425917884, "post_id": 28940005, "comment_id": 46147636, "body": "for reading files from multipart data, use the request.FormFile which returns a reference to the file, the file header and error - <a href=\"http://golang.org/pkg/net/http/#Request.FormFile\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Request.FormFile</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2214, "user_id": 351397, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c4b52dca22f864d37a3cff9e29762e9?s=128&d=identicon&r=PG", "display_name": "gregtczap", "link": "https://stackoverflow.com/users/351397/gregtczap"}, "edited": false, "score": 3, "creation_date": 1456268241, "post_id": 28940524, "comment_id": 58866122, "body": "This method reads the file contents into memory, where as mutlipartReader is used to stream the contents to disk or to another endpoint. I am still looking for an answer to OP&#39;s question."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 2214, "user_id": 351397, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c4b52dca22f864d37a3cff9e29762e9?s=128&d=identicon&r=PG", "display_name": "gregtczap", "link": "https://stackoverflow.com/users/351397/gregtczap"}, "edited": false, "score": 0, "creation_date": 1456313859, "post_id": 28940524, "comment_id": 58886754, "body": "I don&#39;t understand what you&#39;re asking. The questions was to access the value of the field, using specifically a <code>MultipartReader</code> don&#39;t seems to be the point here."}, {"owner": {"reputation": 2214, "user_id": 351397, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c4b52dca22f864d37a3cff9e29762e9?s=128&d=identicon&r=PG", "display_name": "gregtczap", "link": "https://stackoverflow.com/users/351397/gregtczap"}, "edited": false, "score": 2, "creation_date": 1456344024, "post_id": 28940524, "comment_id": 58907722, "body": "The question was about how to access the value of a field using MultipartReader, not ParseMultipartForm. This is necessary if we don&#39;t want to read the entire request into memory and/or temp files, which is what FormValue does when it calls ParseMultipartForm. The answer for how to do this with MultipartReader is to key off of part.FormName() when you are looping over the parts."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 2214, "user_id": 351397, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c4b52dca22f864d37a3cff9e29762e9?s=128&d=identicon&r=PG", "display_name": "gregtczap", "link": "https://stackoverflow.com/users/351397/gregtczap"}, "edited": false, "score": 0, "creation_date": 1456406053, "post_id": 28940524, "comment_id": 58938101, "body": "Well, it seems the OP was happy enough with my answer, so I guess you&#39;re wrong asserting his intention. Now, what you propose (<i>to key off of part.FormName</i>) doesn&#39;t makes any sense to me. If you really want to read a regular field using a <code>multipart.Part</code>, my guess is that you will have to use the <code>Part</code> as an <code>io.Reader</code>\u2026"}, {"owner": {"reputation": 2214, "user_id": 351397, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c4b52dca22f864d37a3cff9e29762e9?s=128&d=identicon&r=PG", "display_name": "gregtczap", "link": "https://stackoverflow.com/users/351397/gregtczap"}, "edited": false, "score": 2, "creation_date": 1456525354, "post_id": 28940524, "comment_id": 59005832, "body": "I am currently switching on part.FormName inside the loop for multipart.Reader in my own application and it works fine. While each multipart.Part does implement the io.Reader interface that does nothing to help you ascertain which form data param the part represents. The OP was probably just looking for a way to move on with their project and didn&#39;t really care about the memory and/or security implications of the solution. I was not asserting their intention at all, but addressing the literal question they asked, which happens to be what I wanted to know as well."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 2214, "user_id": 351397, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c4b52dca22f864d37a3cff9e29762e9?s=128&d=identicon&r=PG", "display_name": "gregtczap", "link": "https://stackoverflow.com/users/351397/gregtczap"}, "edited": false, "score": 0, "creation_date": 1456566353, "post_id": 28940524, "comment_id": 59015745, "body": "I thinked it would be obvious, given that the OP already switched on the <code>FormName</code>, that saying <i>use the Part as an io.Reader</i> was to get the value\u2026"}, {"owner": {"reputation": 2214, "user_id": 351397, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c4b52dca22f864d37a3cff9e29762e9?s=128&d=identicon&r=PG", "display_name": "gregtczap", "link": "https://stackoverflow.com/users/351397/gregtczap"}, "edited": false, "score": 0, "creation_date": 1456690194, "post_id": 28940524, "comment_id": 59052794, "body": "You are right... I think what they really wanted to know was just how to read the string value from a part/reader. I just demonstrated in a separate answer."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 13, "last_activity_date": 1425899307, "creation_date": 1425899307, "answer_id": 28940524, "question_id": 28940005, "link": "https://stackoverflow.com/questions/28940005/golang-get-multipart-form-data/28940524#28940524", "title": "Golang GET multipart form-data", "body": "<p>You can probably content yourself by using the <code>request.ParseMultipartForm</code> method, then use the <code>request.FormValue</code> to get values as usual. Note that you also have the <code>request.MultipartForm</code> to get access to your files.</p>\n\n<p>Example:</p>\n\n<pre><code>func(w http.ResponseWriter, r *http.Request) {\n    // Here the parameter is the size of the form data that should\n    // be loaded in memory, the remaining being put in temporary\n    // files\n    r.ParseMultipartForm(0)\n\n    fmt.Println(r.FormValue(\"delete\"))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2214, "user_id": 351397, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c4b52dca22f864d37a3cff9e29762e9?s=128&d=identicon&r=PG", "display_name": "gregtczap", "link": "https://stackoverflow.com/users/351397/gregtczap"}, "is_accepted": false, "score": 12, "last_activity_date": 1549855593, "last_edit_date": 1549855593, "creation_date": 1456690092, "answer_id": 35687623, "question_id": 28940005, "link": "https://stackoverflow.com/questions/28940005/golang-get-multipart-form-data/35687623#35687623", "title": "Golang GET multipart form-data", "body": "<p>The part implements the io.Reader interface. I am assuming what you are really asking is how to convert the part reader into a string, in the case that it is not a file. You can do so like this:</p>\n\n<pre><code>for {\n   part, err_part := read_form.NextPart()\n   if err_part == io.EOF {\n      break\n   }\n   if part.FormName() == \"delete\" {\n      buf := new(bytes.Buffer)\n      buf.ReadFrom(part)\n      log.Println(\"delete is: \", buf.String())\n   } \n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4649336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccdd4b467dce990624c63e5568760d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marinescu Bogdan", "link": "https://stackoverflow.com/users/4649336/marinescu-bogdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18905, "favorite_count": 4, "accepted_answer_id": 28940524, "answer_count": 2, "score": 9, "last_activity_date": 1549855593, "creation_date": 1425897723, "question_id": 28940005, "link": "https://stackoverflow.com/questions/28940005/golang-get-multipart-form-data", "title": "Golang GET multipart form-data", "body": "<p>Let say I have a html form</p>\n\n<pre><code>&lt;form enctype=\"multipart/form-data\" action=\"http://localhost:8080/incarcat\" method=\"post\"&gt;\n    &lt;input type=\"file\" name=\"file\" multiple=\"multiple\"/&gt;\n    &lt;input type=\"checkbox\" name=\"delete\" value=\"delete\"&gt;\n    &lt;input type=\"submit\" value=\"Load\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>and the following go code</p>\n\n<pre><code>read_form, err := req.MultipartReader()\nfor {\n    part, err_part := read_form.NextPart()\n    if err_part == io.EOF {\n        break\n    }\n    if part.FormName() == \"file\" {\n        //do something with files\n    } else if part.FormName() == \"delete\" {\n        //curata_folder()\n        log.Println(\"delete is: \", part.Header.Get(\"delete\"))\n    }\n}\n</code></pre>\n\n<p>How do i get the value of \"delete\"?</p>\n\n<pre><code>part.Header.Get(\"delete\"))\n</code></pre>\n\n<p>it's not working</p>\n"}, {"tags": ["go", "minify"], "answers": [{"tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 2, "last_activity_date": 1425880350, "creation_date": 1425880350, "answer_id": 28935934, "question_id": 28935577, "link": "https://stackoverflow.com/questions/28935577/golang-bytes-buffer-max-buffer-exceeded/28935934#28935934", "title": "Golang: bytes.Buffer max buffer exceeded", "body": "<p><a href=\"https://godoc.org/github.com/tdewolff/parse\" rel=\"nofollow\">According to GoDoc.org</a>, that error is actually thrown from another package by that author .. <code>parse</code>.</p>\n\n<p>The doc comment says that the input cannot be larger than 4KB in size. Your libraries appear to be much bigger than that.</p>\n\n<p>Luckily, the <code>MaxBuf</code> variable is exported from that package .. so you should be able to put this line before that code to fix <em>that particular error</em>:</p>\n\n<pre><code>parse.MaxBuf = parse.MaxBuf * 2\n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 28935934, "answer_count": 1, "score": 0, "last_activity_date": 1425880350, "creation_date": 1425877699, "question_id": 28935577, "link": "https://stackoverflow.com/questions/28935577/golang-bytes-buffer-max-buffer-exceeded", "title": "Golang: bytes.Buffer max buffer exceeded", "body": "<p>I'm trying to use <a href=\"https://github.com/tdewolff/minify/issues/13\" rel=\"nofollow\">minify</a> library to bundle and minify all my JavaScripts and CSSs, minimum code:</p>\n\n<pre><code>js := bytes.Buffer{}\ndat, err := ioutil.ReadFile(fname)\nif L.Check(err, `File doesn't exists: `+fname) == nil {\n  dat, err = min.MinifyBytes(`text/js`, dat)\n  js.Write(dat) \n  js.WriteRune(';')\n}\n</code></pre>\n\n<p>But that code failed with <code>err=\"max buffer exceeded\"</code> when minifying <a href=\"https://github.com/ajaxorg/ace-builds/blob/master/src/ace.js\" rel=\"nofollow\">ace.js</a> and <a href=\"http://datatables.net/download/\" rel=\"nofollow\">jquery.dataTables.js</a> (>400 KB) is this <code>bytes.Buffer</code> problem? and how to fix this?</p>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1425872020, "post_id": 28934859, "comment_id": 46125332, "body": "Did you try writing to FD 2?"}], "answers": [{"comments": [{"owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 7, "creation_date": 1425902404, "post_id": 28935032, "comment_id": 46137345, "body": "Just to show some code: <code>log.Println(&quot;Failed.&quot;)</code> will print to stderr."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 17, "last_activity_date": 1425873510, "creation_date": 1425873510, "answer_id": 28935032, "question_id": 28934859, "link": "https://stackoverflow.com/questions/28934859/how-do-i-print-message-to-stderr-in-go/28935032#28935032", "title": "How do I print message to stderr in Go?", "body": "<p>The <code>log</code> package by <a href=\"http://golang.org/src/log/log.go#L58\">default</a> prints to <code>os.Stderr</code>.</p>\n\n<p>You can also use <a href=\"http://golang.org/pkg/os/#pkg-variables\"><code>os.Stderr</code></a> directly (it's an <code>os.File</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 2904, "user_id": 5832720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb8ed71cd77d9da995685ca872b303e7?s=128&d=identicon&r=PG", "display_name": "Nikhita Raghunath", "link": "https://stackoverflow.com/users/5832720/nikhita-raghunath"}, "is_accepted": false, "score": 24, "last_activity_date": 1479566313, "last_edit_date": 1479566313, "creation_date": 1479565743, "answer_id": 40694000, "question_id": 28934859, "link": "https://stackoverflow.com/questions/28934859/how-do-i-print-message-to-stderr-in-go/40694000#40694000", "title": "How do I print message to stderr in Go?", "body": "<p>There are multiple methods to send a message to <code>stderr</code>:</p>\n\n<ol>\n<li><p>Creating a new <a href=\"https://golang.org/pkg/log/#Logger\" rel=\"noreferrer\"><code>log.Logger</code></a>:</p>\n\n<pre><code>l := log.New(os.Stderr, \"\", 1)\nl.Println(\"log message\")\n</code></pre></li>\n<li><p>Using <a href=\"https://golang.org/pkg/fmt/#Fprintf\" rel=\"noreferrer\"><code>fmt.Fprintf</code></a>:</p>\n\n<pre><code>fmt.Fprintf(os.Stderr, \"log message: %s\", str)\n</code></pre></li>\n<li><p>Directly writing to <code>os.Stderr</code> using <a href=\"https://golang.org/pkg/os/#File.WriteString\" rel=\"noreferrer\"><code>os.Stderr.WriteString</code></a>:</p>\n\n<pre><code>os.Stderr.WriteString(\"log message\")\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1592542427, "creation_date": 1592542427, "answer_id": 62463486, "question_id": 28934859, "link": "https://stackoverflow.com/questions/28934859/how-do-i-print-message-to-stderr-in-go/62463486#62463486", "title": "How do I print message to stderr in Go?", "body": "<p>On Linux systems, you could also use <a href=\"https://man7.org/linux/man-pages/man3/syslog.3.html\" rel=\"nofollow noreferrer\">syslog(3)</a> facilities. By default, the underlying <a href=\"https://man7.org/linux/man-pages/man3/openlog.3.html\" rel=\"nofollow noreferrer\">openlog(3)</a> does not go to stderr, but this can be changed.  </p>\n\n<p>See Go package <a href=\"https://golang.org/pkg/log/syslog/\" rel=\"nofollow noreferrer\">log/syslog</a>.</p>\n"}], "owner": {"reputation": 430, "user_id": 992703, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/cxDvv.png?s=128&g=1", "display_name": "kaitian521", "link": "https://stackoverflow.com/users/992703/kaitian521"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8594, "favorite_count": 2, "accepted_answer_id": 28935032, "answer_count": 3, "score": 14, "last_activity_date": 1592542427, "creation_date": 1425871940, "last_edit_date": 1592542054, "question_id": 28934859, "link": "https://stackoverflow.com/questions/28934859/how-do-i-print-message-to-stderr-in-go", "title": "How do I print message to stderr in Go?", "body": "<p>I want to print some logs for debugging and testing, but existing logs are massive, so I want to print my own logs to stderr:</p>\n\n<pre><code>go run main.go 1&gt;/dev/null\n</code></pre>\n\n<p>So that I can just see my own logs.</p>\n\n<p>How can I do that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2854, "user_id": 41292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/939e50606775eea4b7589dd7aebbd8b3?s=128&d=identicon&r=PG", "display_name": "LenW", "link": "https://stackoverflow.com/users/41292/lenw"}, "edited": false, "score": 0, "creation_date": 1425904654, "post_id": 28934618, "comment_id": 46138671, "body": "&quot;go get -u all&quot; after a big upgrade like that should sort it out."}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 31, "last_activity_date": 1462310733, "last_edit_date": 1462310733, "creation_date": 1425873765, "answer_id": 28935073, "question_id": 28934618, "link": "https://stackoverflow.com/questions/28934618/import-object-is-expected-error-in-golang-1-4-2/28935073#28935073", "title": "import object is expected Error in Golang 1.4.2", "body": "<p>Just delete the old pkg files, usually it upgrades automatically though.</p>\n\n<pre><code>rm -rf $GOPATH/pkg/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 188, "user_id": 739714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b22159d12321f26eda62a7eecdd15227?s=128&d=identicon&r=PG", "display_name": "raven", "link": "https://stackoverflow.com/users/739714/raven"}, "is_accepted": false, "score": 5, "last_activity_date": 1430121299, "creation_date": 1430121299, "answer_id": 29890122, "question_id": 28934618, "link": "https://stackoverflow.com/questions/28934618/import-object-is-expected-error-in-golang-1-4-2/29890122#29890122", "title": "import object is expected Error in Golang 1.4.2", "body": "<p>I met this problem too. I deleted the old packages but still get same error. finally I found the old pkg keep get generated by my \"sublime text2\". after restarted it. everything back to work :p</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2715, "favorite_count": 0, "accepted_answer_id": 28935073, "answer_count": 2, "score": 13, "last_activity_date": 1470147370, "creation_date": 1425869986, "last_edit_date": 1470147370, "question_id": 28934618, "link": "https://stackoverflow.com/questions/28934618/import-object-is-expected-error-in-golang-1-4-2", "title": "import object is expected Error in Golang 1.4.2", "body": "<p>I have just upgraded Golang from <code>1.3</code> to version <code>1.4.2</code>. And cannot compile due to error:</p>\n\n<pre><code>../../my/mandrill.go:5: import /path/to/go/home/pkg/darwin_amd64/github.com/keighl/mandrill.a: object is [darwin amd64 go1.3.3 X:precisestack] expected [darwin amd64 go1.4.2 X:precisestack]\nFAIL    folder [build failed]\n</code></pre>\n\n<p>on line <code>m \"github.com/keighl/mandrill\"</code></p>\n\n<pre><code>package my\n\nimport (\n    \"fmt\"\n    m \"github.com/keighl/mandrill\"\n)\n</code></pre>\n\n<p>I guess some rules of importing have changed in <code>1.4.2</code>. But cannot figure out how to change my import code to make it compile.</p>\n"}, {"tags": ["string", "random", "go", "type-conversion", "sha256"], "comments": [{"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 1, "creation_date": 1425864089, "post_id": 28933687, "comment_id": 46123615, "body": "Please post your code. (A link to <code>play.golang.org</code> is fine, but it&#39;s not a substitute for the code itself.)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1425864848, "post_id": 28933687, "comment_id": 46123759, "body": "Why would you want a &quot;random sha256 hash&quot;? A sha256 hash is not random; it&#39;s a deterministic function of its input. If what you need is a random sequence of 256 bits, why should sha256 be involved?"}], "answers": [{"tags": [], "owner": {"reputation": 994, "user_id": 244690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15437c0c7db2a631f440b29e0a9c4fae?s=128&d=identicon&r=PG", "display_name": "margnus1", "link": "https://stackoverflow.com/users/244690/margnus1"}, "is_accepted": false, "score": 3, "last_activity_date": 1425863175, "creation_date": 1425863175, "answer_id": 28933804, "question_id": 28933687, "link": "https://stackoverflow.com/questions/28933687/golang-random-sha256/28933804#28933804", "title": "Golang Random Sha256", "body": "<p>Yes. This:</p>\n\n<pre><code>string(timestamp)\n</code></pre>\n\n<p>does not do what you think it does, see <a href=\"https://golang.org/ref/spec#Conversions_to_and_from_a_string_type\" rel=\"nofollow\">the spec</a>. Long story short, the timestamp is not a valid unicode code point, so the result is always \"\\uFFFD\".</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 10, "last_activity_date": 1425864606, "last_edit_date": 1425864606, "creation_date": 1425863238, "answer_id": 28933817, "question_id": 28933687, "link": "https://stackoverflow.com/questions/28933687/golang-random-sha256/28933817#28933817", "title": "Golang Random Sha256", "body": "<p>Because you do this:</p>\n\n<pre><code>timestamp := time.Now().Unix()\nlog.Print(fmt.Sprintf(\"%x\", sha256.Sum256([]byte(string(timestamp))))[:45])\n</code></pre>\n\n<p>You print the hex form of the SHA-256 digest of the data:</p>\n\n<pre><code>[]byte(string(timestamp))\n</code></pre>\n\n<p>What is it exactly?</p>\n\n<p><code>timestamp</code> is of type <code>int64</code>, <a href=\"http://golang.org/ref/spec#Conversions_to_and_from_a_string_type\" rel=\"noreferrer\">converting it to string is</a>:</p>\n\n<blockquote>\n  <p>Converting a signed or unsigned integer value to a string type yields a string containing the UTF-8 representation of the integer. Values outside the range of valid Unicode code points are converted to \"\\uFFFD\".</p>\n</blockquote>\n\n<p>But its value is not a valid unicode code point so it will always be <code>\"\\uFFFD\"</code> which is <code>efbfbd</code> (UTF-8 encoded), and your code always prints the SHA-256 of the data <code>[]byte{0xef, 0xbf, 0xbd}</code> which is (or rather its first 45 hex digits because you slice the result):</p>\n\n<pre><code>83d544ccc223c057d2bf80d3f2a32982c32c3c0db8e26\n</code></pre>\n\n<p>I guess you wanted to generate some random bytes and calculate the SHA-256 of that, something like this:</p>\n\n<pre><code>data := make([]byte, 10)\nfor i := range data {\n    data[i] = byte(rand.Intn(256))\n}\nfmt.Printf(\"%x\", sha256.Sum256(data))\n</code></pre>\n\n<p>Note that if you'd use the <a href=\"http://golang.org/pkg/crypto/rand/\" rel=\"noreferrer\"><code>crypto/rand</code></a> package instead of <code>math/rand</code>, you could fill a slice of bytes with random values using the <a href=\"http://golang.org/pkg/crypto/rand/#Read\" rel=\"noreferrer\"><code>rand.Read()</code></a> function, and you don't even have to set seed (and so you don't even need the <code>time</code> package):</p>\n\n<pre><code>data := make([]byte, 10)\nif _, err := rand.Read(data); err == nil {\n    fmt.Printf(\"%x\", sha256.Sum256(data))\n}\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 2350858, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/460605907bb0a8083ae1469dbbc7d203?s=128&d=identicon&r=PG", "display_name": "user2350858", "link": "https://stackoverflow.com/users/2350858/user2350858"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4473, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1475355242, "creation_date": 1425861947, "last_edit_date": 1475355242, "question_id": 28933687, "link": "https://stackoverflow.com/questions/28933687/golang-random-sha256", "title": "Golang Random Sha256", "body": "<p>I am having trouble getting a random sha256 hash using a timestamp seed:</p>\n\n<p><a href=\"https://play.golang.org/p/2-_VPe3oFr\" rel=\"nofollow\">https://play.golang.org/p/2-_VPe3oFr</a> (dont use playground - time always same)</p>\n\n<p>Does anyone understand why it always returns the same result? (non-playground runs)</p>\n"}, {"tags": ["google-app-engine", "session", "go"], "answers": [{"tags": [], "owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "is_accepted": true, "score": 3, "last_activity_date": 1425853101, "creation_date": 1425853101, "answer_id": 28932583, "question_id": 28932389, "link": "https://stackoverflow.com/questions/28932389/what-app-types-situations-would-you-use-memcache-or-datastore-for-websessions/28932583#28932583", "title": "what app types / situations would you use memcache or datastore for websessions on a go app engine web app?", "body": "<p>Use both. Check memcache. If a session is present, proceed. If not, check the datastore.</p>\n\n<p>This is exactly how sessions are implemented in the Java runtime, and this is generally the way to use memcache.</p>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 28932583, "answer_count": 1, "score": 2, "last_activity_date": 1425853101, "creation_date": 1425851887, "question_id": 28932389, "link": "https://stackoverflow.com/questions/28932389/what-app-types-situations-would-you-use-memcache-or-datastore-for-websessions", "title": "what app types / situations would you use memcache or datastore for websessions on a go app engine web app?", "body": "<p>I'm looking into building a web app in golang to deploy to google app engine, but I'm not sure whether to use the memcache store or the datastore from this <a href=\"https://godoc.org/code.google.com/p/sadbox/appengine/sessions\" rel=\"nofollow\">sessions</a> package. Is there a rule of thumb as to when to use each type of store? I understand the main pros and cons, the datastore data will always be there but is much slower to access and the memcache data is much faster to access but may not always be there. So are there any situations or types of application that would use one type of session store from the other?</p>\n"}, {"tags": ["string", "encoding", "utf-8", "go"], "answers": [{"comments": [{"owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "edited": false, "score": 0, "creation_date": 1425854683, "post_id": 28932284, "comment_id": 46121336, "body": "It has the dash, it was removed in one of my processing steps."}], "tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": true, "score": 7, "last_activity_date": 1543399144, "last_edit_date": 1543399144, "creation_date": 1425851233, "answer_id": 28932284, "question_id": 28932140, "link": "https://stackoverflow.com/questions/28932140/converting-utf-8-rfc-2047-to-a-regular-string-in-golang/28932284#28932284", "title": "Converting &quot;=?UTF 8?..&quot; (RFC 2047) to a regular string in golang", "body": "<p>Aparrently your API is returning data encoded in <a href=\"https://www.ietf.org/rfc/rfc2047.txt\" rel=\"nofollow noreferrer\">RFC 2047 format</a>. Basically, this defines the following:</p>\n\n<pre><code>encoded-word = \"=?\" charset \"?\" encoding \"?\" encoded-text \"?=\"\n</code></pre>\n\n<p>Which means your charset is UTF-8 (very handy, since this is Go's native character set), and your encoding is Base64. The text you have to decode is the one between the \"B?\" and the \"?=\". So all you have to do is take that text and call:</p>\n\n<pre><code>base64.StdEncoding.DecodeString(text)\n</code></pre>\n\n<p>to get the original UTF-8 string.</p>\n\n<p>There is a <a href=\"https://github.com/golang/go/blob/39eda0dac12a53f7f0c3189e5929d171e8e0b844/src/net/mail/message.go#L681\" rel=\"nofollow noreferrer\"><code>decodeRFC2047Word()</code></a> function in the <code>net/mail</code> package of the Go stdlib, supporting encodings <code>B</code> and <code>Q</code> and charsets <code>UTF-8</code>, <code>US-ASCII</code> and <code>ISO-8859-1</code>. Unfortunately it's not exported, but you're free to take as much inspiration from it as you need ;)</p>\n\n<p><strong>BTW:</strong> I just noticed the charset in your example strings is <code>UTF 8</code>, which is a bit odd, since the official name of the encoding is <code>UTF-8</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1664, "user_id": 1306228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1e732e5ac9820eeb35a70276cf6c05f7?s=128&d=identicon&r=PG", "display_name": "Ale", "link": "https://stackoverflow.com/users/1306228/ale"}, "is_accepted": false, "score": 4, "last_activity_date": 1443523118, "creation_date": 1443523118, "answer_id": 32841792, "question_id": 28932140, "link": "https://stackoverflow.com/questions/28932140/converting-utf-8-rfc-2047-to-a-regular-string-in-golang/32841792#32841792", "title": "Converting &quot;=?UTF 8?..&quot; (RFC 2047) to a regular string in golang", "body": "<p>Since Go 1.5 you can use <a href=\"https://golang.org/pkg/mime/#WordDecoder.DecodeHeader\" rel=\"nofollow\">mime.WordDecoder.DecodeHeader</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"mime\"\n)\n\nfunc main() {\n    dec := new(mime.WordDecoder)\n    header, err := dec.DecodeHeader(\"=?UTF-8?B?2KfZhNiu2LfZiNin2Kog2KfZhNiq2Yog2KrYrNmF2Lkg2KjZitmG?= =?UTF-8?B?INit2YHYuCDYp9mE2YLYsdin2ZPZhiDYp9mE2YPYsdmK2YUg2YjZgQ==?= =?UTF-8?B?2YfZhdmHINmF2YXYpyDYp9mU2YXZhNin2Ycg2KfZhNi52YTYp9mF?= =?UTF-8?B?2Kkg2LnYqNivINin2YTZhNmHINin2YTYutiv2YrYp9mGLnBkZg==?=\")\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(header)\n    // Output: \u0644\u062e\u0637\u0648\u0627\u062a \u0627\u0644\u062a\u064a \u062a\u062c\u0645\u0639 \u0628\u064a\u0646 \u062d\u0641\u0638 \u0627\u0644\u0642\u0631\u0627\u0653\u0646 \u0627\u0644\u0643\u0631\u064a\u0645 \u0648\u0641\u0647\u0645\u0647 \u0645\u0645\u0627 \u0627\u0654\u0645\u0644\u0627\u0647 \u0627\u0644\u0639\u0644\u0627\u0645\u0629 \u0639\u0628\u062f \u0627\u0644\u0644\u0647 \u0627\u0644\u063a\u062f\u064a\u0627\u0646.pdf\n}\n</code></pre>\n\n<p>If you are using an older version of Go, you can use my replacement library: <a href=\"https://github.com/alexcesaro/quotedprintable\" rel=\"nofollow\">https://github.com/alexcesaro/quotedprintable</a></p>\n"}], "owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3914, "favorite_count": 3, "accepted_answer_id": 28932284, "answer_count": 2, "score": 6, "last_activity_date": 1543399144, "creation_date": 1425850215, "last_edit_date": 1442241008, "question_id": 28932140, "link": "https://stackoverflow.com/questions/28932140/converting-utf-8-rfc-2047-to-a-regular-string-in-golang", "title": "Converting &quot;=?UTF 8?..&quot; (RFC 2047) to a regular string in golang", "body": "<p>I'm using an API and it's returning something like this for other language text: </p>\n\n<p><code>=?UTF 8?B?2KfZhNiu2LfZiNin2Kog2KfZhNiq2Yog2KrYrNmF2Lkg2KjZitmG?= =?UTF 8?B?INit2YHYuCDYp9mE2YLYsdin2ZPZhiDYp9mE2YPYsdmK2YUg2YjZgQ==?= =?UTF 8?B?2YfZhdmHINmF2YXYpyDYp9mU2YXZhNin2Ycg2KfZhNi52YTYp9mF?= =?UTF 8?B?2Kkg2LnYqNivINin2YTZhNmHINin2YTYutiv2YrYp9mGLnBkZg==?=</code></p>\n\n<p>Is this a common format? How would I go about converting this to a regular string in golang? </p>\n\n<p>Golang usually handles multiple languages well, but I'm not sure about how to go about converting.</p>\n"}, {"tags": ["random", "go"], "comments": [{"owner": {"reputation": 2281, "user_id": 1914005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab75a260af6eefb1b37b89115f01774a?s=128&d=identicon&r=PG&f=1", "display_name": "Vitruvie", "link": "https://stackoverflow.com/users/1914005/vitruvie"}, "edited": false, "score": 1, "creation_date": 1425845752, "post_id": 28931015, "comment_id": 46118429, "body": "Note also that the time doesn&#39;t change in the Go playground."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1425880800, "post_id": 28931015, "comment_id": 46127291, "body": "Just be aware that math/rand generates pseudo random numbers not real random numbers. (...) And these pseudo random number are vulnerable to many cryptoanalytic attacks - like what happened to PlayStation (en.wikipedia.org/wiki/Random_number_generator_attack)."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4647476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a741a0abc994f83f8826fadf5bba75d?s=128&d=identicon&r=PG&f=1", "display_name": "agoedken", "link": "https://stackoverflow.com/users/4647476/agoedken"}, "edited": false, "score": 0, "creation_date": 1425944589, "post_id": 28931096, "comment_id": 46161123, "body": "Ahhhhhhhhh thanks! But why would I want to seed it just once? Wouldn&#39;t this give me the same result each time?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 25, "user_id": 4647476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a741a0abc994f83f8826fadf5bba75d?s=128&d=identicon&r=PG&f=1", "display_name": "agoedken", "link": "https://stackoverflow.com/users/4647476/agoedken"}, "edited": false, "score": 0, "creation_date": 1425946880, "post_id": 28931096, "comment_id": 46161828, "body": "@agoedken I don&#39;t think you understand what <a href=\"https://en.wikipedia.org/wiki/Random_number_seed\" rel=\"nofollow noreferrer\">seeding</a> is and why it&#39;s done."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 5, "last_activity_date": 1425844045, "creation_date": 1425844045, "answer_id": 28931096, "question_id": 28931015, "link": "https://stackoverflow.com/questions/28931015/generating-a-random-variable-in-golang-using-math-rand/28931096#28931096", "title": "Generating a random variable in golang using math/rand", "body": "<p>Don't reseed in the loop, do it only once.</p>\n\n<p><a href=\"https://golang.org/pkg/math/rand/#Intn\" rel=\"nofollow\"><code>rand.Intn(n)</code></a> returns a value >= 0 and &lt; n. So <code>rand.Intn(1)</code> can only return 0, you want <code>rand.Intn(2)</code> to get 0 or 1.</p>\n\n<p>Fixed code:\n<a href=\"http://play.golang.org/p/3D9osMzRRb\" rel=\"nofollow\">http://play.golang.org/p/3D9osMzRRb</a></p>\n"}], "owner": {"reputation": 25, "user_id": 4647476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a741a0abc994f83f8826fadf5bba75d?s=128&d=identicon&r=PG&f=1", "display_name": "agoedken", "link": "https://stackoverflow.com/users/4647476/agoedken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1792, "favorite_count": 0, "accepted_answer_id": 28931096, "answer_count": 1, "score": 1, "last_activity_date": 1546912917, "creation_date": 1425843525, "last_edit_date": 1546912917, "question_id": 28931015, "link": "https://stackoverflow.com/questions/28931015/generating-a-random-variable-in-golang-using-math-rand", "title": "Generating a random variable in golang using math/rand", "body": "<p>I'm trying to simulate a coin flip for a program in golang. I'm trying to use <code>math/rand</code> and I'm seeding it using <code>time</code>.</p>\n\n<pre><code>import (\n\"fmt\"\n\"math/rand\"\n\"time\"\n)    \n</code></pre>\n\n<p>From what I've looked up elsewhere on here and online, my implementation should work: </p>\n\n<pre><code>func main() {\n    var random int\n    var i int\n    var j int\n    for j != 5 &amp;&amp; i != 5 {\n        rand.Seed(time.Now().UnixNano())\n        random = rand.Intn(1)\n        if random == 0 {\n            i = i + 1\n        }\n        if random == 1 {\n            j = j + 1\n        }\n    }\nfmt.Println(i, j)\n}\n</code></pre>\n\n<p>But, each time I run it, random always end up being 0. The seed doesn't change either, which confuses me. Since it's within the loop, shouldn't the time in nanoseconds change each time it's seeded?</p>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1425840516, "post_id": 28930416, "comment_id": 46116566, "body": "Last I checked, Go maps don&#39;t actually remember insertion order. Keeping track involves a non-negligible amount of overhead."}, {"owner": {"reputation": 732, "user_id": 2832083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/156602af0779465c76263fc9448efda2?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/2832083/mark"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1425840573, "post_id": 28930416, "comment_id": 46116581, "body": "@user2357112 So it&#39;s not possible? That&#39;s really disappointing."}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 6, "creation_date": 1425840624, "post_id": 28930416, "comment_id": 46116596, "body": "@Mark: why are you expecting it would be? This a standard hashmap behavior."}, {"owner": {"reputation": 732, "user_id": 2832083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/156602af0779465c76263fc9448efda2?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/2832083/mark"}, "reply_to_user": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 0, "creation_date": 1425840769, "post_id": 28930416, "comment_id": 46116659, "body": "@Arjan: It is? I&#39;m coming from a PHP and JS background where this pattern seems to work."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 1, "creation_date": 1425840785, "post_id": 28930416, "comment_id": 46116666, "body": "You can just keep around a <code>slice</code> to keep track of insertion order."}, {"owner": {"reputation": 12454, "user_id": 59379, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/874ccf14f980150879d9e2dc9741033e?s=128&d=identicon&r=PG", "display_name": "JoeG", "link": "https://stackoverflow.com/users/59379/joeg"}, "edited": false, "score": 2, "creation_date": 1425853906, "post_id": 28930416, "comment_id": 46121073, "body": "&quot;It seems ridiculous this isn&#39;t possible.&quot; It is possible, but not without sacrificing the <code>O(1)</code> algorithmic complexity of at least of one insert/lookup/delete."}, {"owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "edited": false, "score": 2, "creation_date": 1425902627, "post_id": 28930416, "comment_id": 46137480, "body": "Randomizing key order was a conscious decision and is considered a feature. <a href=\"http://nathanleclaire.com/blog/2014/04/27/a-surprising-feature-of-golang-that-colored-me-impressed/\" rel=\"nofollow noreferrer\">nathanleclaire.com/blog/2014/04/27/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1531041994, "post_id": 28930416, "comment_id": 89440504, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23330781/sort-golang-map-values-by-keys\">sort golang map values by keys</a>"}], "answers": [{"comments": [{"owner": {"reputation": 732, "user_id": 2832083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/156602af0779465c76263fc9448efda2?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/2832083/mark"}, "edited": false, "score": 0, "creation_date": 1425841284, "post_id": 28930550, "comment_id": 46116854, "body": "Thanks, I added a slice to keep track of the keys but I like your version better."}, {"owner": {"reputation": 9148, "user_id": 68707, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/901005efe8195afcad5139a584921962?s=128&d=identicon&r=PG", "display_name": "Ben Hoyt", "link": "https://stackoverflow.com/users/68707/ben-hoyt"}, "edited": false, "score": 0, "creation_date": 1510085602, "post_id": 28930550, "comment_id": 81283116, "body": "It seems to me <code>Set()</code> should only append to <code>keys</code> if the key is not already in the map. That is, do <code>_, present := n.m[k]</code> before the first line, then <code>if !present { ... }</code> around the append."}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "reply_to_user": {"reputation": 9148, "user_id": 68707, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/901005efe8195afcad5139a584921962?s=128&d=identicon&r=PG", "display_name": "Ben Hoyt", "link": "https://stackoverflow.com/users/68707/ben-hoyt"}, "edited": false, "score": 0, "creation_date": 1512895954, "post_id": 28930550, "comment_id": 82434778, "body": "@BenHoyt I expanded the answer to make it clear not all use-cases are covered"}, {"owner": {"reputation": 706, "user_id": 5536665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tw6lx.jpg?s=128&g=1", "display_name": "Rens Tillmann", "link": "https://stackoverflow.com/users/5536665/rens-tillmann"}, "edited": false, "score": 0, "creation_date": 1591541093, "post_id": 28930550, "comment_id": 110089064, "body": "Have been playing around with this, and thought I&#39;d share a multidemensional example of this, it&#39;s plain and simple but might help someone. If someone knows a better method please let me know, I am new to Go. <a href=\"https://play.golang.org/p/jggEnXxTYvN\" rel=\"nofollow noreferrer\">play.golang.org/p/jggEnXxTYvN</a>"}], "tags": [], "owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "is_accepted": true, "score": 23, "last_activity_date": 1512895919, "last_edit_date": 1512895919, "creation_date": 1425841023, "answer_id": 28930550, "question_id": 28930416, "link": "https://stackoverflow.com/questions/28930416/why-cant-go-iterate-maps-in-insertion-order/28930550#28930550", "title": "Why can&#39;t Go iterate maps in insertion order?", "body": "<p>Go maps do not maintain the insertion order; you will have to implement this behavior yourself.</p>\n\n<p>Example:</p>\n\n<pre><code>type NavigationMap struct {\n    m map[string]navbarTab\n    keys []string\n}\n\nfunc NewNavigationMap() *NavigationMap { ... }\n\nfunc (n *NavigationMap) Set(k string, v navbarTab) {\n    n.m[k] = v\n    n.keys = append(n.keys, k)\n}\n</code></pre>\n\n<p>This example is not complete and does not cover all use-cases (eg. updating insertion order on duplicate keys).</p>\n\n<p>If your use-case includes re-inserting the same key multiple times (this will not update insertion order for key <em>k</em> if it was already in the map):</p>\n\n<pre><code>func (n *NavigationMap) Set(k string, v navbarTab) {\n    _, present := n.m[k]\n    n.m[k] = v\n    if !present {\n        n.keys = append(n.keys, k)\n    }\n}\n</code></pre>\n\n<p>Choose the simplest thing that satisfies your requirements.</p>\n"}, {"comments": [{"owner": {"reputation": 732, "user_id": 2832083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/156602af0779465c76263fc9448efda2?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/2832083/mark"}, "edited": false, "score": 1, "creation_date": 1425912353, "post_id": 28931555, "comment_id": 46143751, "body": "Thank you for posting this, it makes a lot more sense now."}, {"owner": {"reputation": 706, "user_id": 5536665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tw6lx.jpg?s=128&g=1", "display_name": "Rens Tillmann", "link": "https://stackoverflow.com/users/5536665/rens-tillmann"}, "edited": false, "score": 0, "creation_date": 1591541089, "post_id": 28931555, "comment_id": 110089060, "body": "Have been playing around with this, and thought I&#39;d share a multidemensional example of this, it&#39;s plain and simple but might help someone. If someone knows a better method please let me know, I am new to Go. <a href=\"https://play.golang.org/p/jggEnXxTYvN\" rel=\"nofollow noreferrer\">play.golang.org/p/jggEnXxTYvN</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 29, "last_activity_date": 1604426661, "last_edit_date": 1604426661, "creation_date": 1425846738, "answer_id": 28931555, "question_id": 28930416, "link": "https://stackoverflow.com/questions/28930416/why-cant-go-iterate-maps-in-insertion-order/28931555#28931555", "title": "Why can&#39;t Go iterate maps in insertion order?", "body": "<p>The <em>general</em> concept of the map data structure is that it is a collection of key-value pairs. <em>&quot;Ordered&quot;</em> or <em>&quot;sorted&quot;</em> is nowhere mentioned.</p>\n<p><a href=\"http://en.wikipedia.org/wiki/Associative_array\" rel=\"nofollow noreferrer\">Wikipedia definition:</a></p>\n<blockquote>\n<p>In computer science, an <strong>associative array</strong>, <strong>map</strong>, <strong>symbol table</strong>, or <strong>dictionary</strong> is an abstract data type composed of a collection of <code>(key, value)</code> pairs, such that each possible key appears just once in the collection.</p>\n</blockquote>\n<p>The <em>map</em> is one of the most useful data structures in computer science, so Go provides it as a built-in type. However, the language specification only specifies a <em>general</em> map (<a href=\"https://golang.org/ref/spec#Map_types\" rel=\"nofollow noreferrer\">Map types</a>):</p>\n<blockquote>\n<p>A map is an unordered group of elements of one type, called the element type, indexed by a set of unique keys of another type, called the key type. The value of an uninitialized map is <code>nil</code>.</p>\n</blockquote>\n<p>Note that the language specification not only leaves out the <em>&quot;ordered&quot;</em> or <em>&quot;sorted&quot;</em> words, it explicitly states the opposite: <strong>&quot;unordered&quot;</strong>. But why? Because this gives <em>greater freedom</em> to the runtime to implement the map type. The language specification allows to use any map implementation like <em>hash</em> map, <em>tree</em> map etc. Note that the current (and previous) versions of Go use a hash map implementation, but you don't need to know that to use it.</p>\n<p>The blog post <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\"><strong>Go maps in action</strong></a> is a must read regarding to this question.</p>\n<p>Before Go 1, when a map was not changed, the runtime returned the keys in the same order when you iterated over its keys/entries multiple times. Note that this order <strong>could have</strong> changed if the map was modified as the implementation might needed to do a rehash to accommodate more entries. People started to rely on the same iteration order (when map was not changed), so starting with Go 1 the runtime randomizies map iteration order <strong>on purpose</strong> to get the attention of the developers that the order is not defined and can't be relied on.</p>\n<p>What to do then?</p>\n<p>If you need a <em>sorted</em> dataset (be it a collection of key-value pairs or anything else) either by insertion order or natural order defined by the key type or an arbitrary order, <code>map</code> is not the right choice. If you need a predefined order, slices (and arrays) are your friend. And if you need to be able to look up the elements by a predefined key, you may <em>additionally</em> build a map from the slice to allow fast look up of the elements by a <em>key</em>.</p>\n<p>Either you build the <code>map</code> first and then a slice in proper order, or the slice first and then build a <code>map</code> from it is entirely up to you.</p>\n<p>The aforementioned <em>Go maps in action</em> blog post has a section dedicated to <a href=\"https://blog.golang.org/go-maps-in-action#TOC_7.\" rel=\"nofollow noreferrer\"><strong>Iteration order</strong></a>:</p>\n<blockquote>\n<p>When iterating over a map with a range loop, the iteration order is not specified and is not guaranteed to be the same from one iteration to the next. Since Go 1 the runtime randomizes map iteration order, as programmers relied on the stable iteration order of the previous implementation. If you require a stable iteration order you must maintain a separate data structure that specifies that order. This example uses a separate sorted slice of keys to print a <code>map[int]string</code> in key order:</p>\n</blockquote>\n<pre><code>import &quot;sort&quot;\n\nvar m map[int]string\nvar keys []int\nfor k := range m {\n    keys = append(keys, k)\n}\nsort.Ints(keys)\nfor _, k := range keys {\n    fmt.Println(&quot;Key:&quot;, k, &quot;Value:&quot;, m[k])\n}\n</code></pre>\n<p><strong>P.S.:</strong></p>\n<blockquote>\n<p>...although it seems to not exhibit the same behavior.</p>\n</blockquote>\n<p>Seemingly you see the &quot;same iteration order&quot; on the Go Playground because the outputs of the applications/codes on the Go Playground are <em>cached</em>. Once a new, yet-unique code is executed, its output is saved as new. Once the same code is executed, the saved output is presented without running the code again. So basically it's not the same iteration order what you see, it's the exactly same output without executing any of the code again.</p>\n<p><strong>P.S. #2</strong></p>\n<p>Although using <code>for range</code> the iteration order is &quot;random&quot;, there are notable exceptions in the standard lib that do process maps in sorted order, namely the <code>encoding/json</code>, <code>text/template</code>, <code>html/template</code> and <code>fmt</code> packages. For more details, see <a href=\"https://stackoverflow.com/questions/55925822/in-golang-why-are-iterations-over-maps-random/55925880#55925880\">In Golang, why are iterations over maps random?</a></p>\n"}], "owner": {"reputation": 732, "user_id": 2832083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/156602af0779465c76263fc9448efda2?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/2832083/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10938, "favorite_count": 5, "accepted_answer_id": 28930550, "answer_count": 2, "score": 13, "last_activity_date": 1604426661, "creation_date": 1425840297, "last_edit_date": 1539070164, "question_id": 28930416, "link": "https://stackoverflow.com/questions/28930416/why-cant-go-iterate-maps-in-insertion-order", "title": "Why can&#39;t Go iterate maps in insertion order?", "body": "<p>I have a navbar as a map:</p>\n\n<pre><code>var navbar = map[string]navbarTab{\n}\n</code></pre>\n\n<p>Where <code>navbarTab</code> has various properties, child items and so on. When I try to render the navbar (with <code>for tabKey := range navbar</code>) it shows up in a random order. I'm aware <code>range</code> randomly sorts when it runs but there appears to be no way to get an ordered list of keys or iterate in the insertion order.</p>\n\n<p>The playground link is here: <a href=\"http://play.golang.org/p/nSL1zhadg5\" rel=\"noreferrer\">http://play.golang.org/p/nSL1zhadg5</a> although it seems to not exhibit the same behavior.</p>\n\n<p>How can I iterate over this map without breaking the insertion order?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 3, "creation_date": 1425840350, "post_id": 28930381, "comment_id": 46116496, "body": "Interfaces don&#39;t specify what the receiver type must be."}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 1, "creation_date": 1425840412, "post_id": 28930381, "comment_id": 46116523, "body": "And everything you are asking again was answered in your previous question."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1425840529, "creation_date": 1425840529, "answer_id": 28930450, "question_id": 28930381, "link": "https://stackoverflow.com/questions/28930381/go-need-to-set-property-but-without-pointer-receiver/28930450#28930450", "title": "Go: Need to set property but without pointer receiver?", "body": "<p>You need to use a pointer receiver, not a value receiver:</p>\n\n<pre><code>func (this *MyClass) MyMethod() {\n    this.data = \"Changed!\"\n}\n</code></pre>\n\n<p>See your modified example in <a href=\"https://play.golang.org/p/51W93Z7n0T\" rel=\"nofollow\">play.golang.org</a>:</p>\n\n<p>The output is:</p>\n\n<pre><code>{Changed!}\n</code></pre>\n"}], "owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 28930450, "answer_count": 1, "score": -1, "last_activity_date": 1425840529, "creation_date": 1425840116, "question_id": 28930381, "link": "https://stackoverflow.com/questions/28930381/go-need-to-set-property-but-without-pointer-receiver", "title": "Go: Need to set property but without pointer receiver?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype MyClass struct{\n    data    string\n}\n\nfunc (this MyClass) MyMethod() {\n    this.data = \"Changed!\"\n}\n\nfunc main() {\n    obj := MyClass{}\n\n    obj.MyMethod()\n\n    fmt.Println(obj)\n}\n</code></pre>\n\n<p>I need that the <code>data</code> property gets changed by <code>MyMethod()</code>, but I cannot change the receiver type to pointer (<code>func (this *MyClass)</code>) because it must satisfy an interface whose receiver is not a pointer, can this achieved some other way?</p>\n"}, {"tags": ["templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "is_accepted": true, "score": 2, "last_activity_date": 1425840226, "creation_date": 1425840226, "answer_id": 28930403, "question_id": 28930267, "link": "https://stackoverflow.com/questions/28930267/how-to-evaluate-fields-using-text-template-package-go/28930403#28930403", "title": "How to evaluate fields using text/template package? go", "body": "<p>There is a global function in the templates package named <code>eq</code> that you can call. Not sure why it works like that but here is the code</p>\n\n<pre><code>type something struct{\n    Brand   string\n}\ntpl := `{{if eq .Brand \"Coke\"}} It's a coke{{else}} It's something else{{end}}`\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 28930403, "answer_count": 1, "score": 0, "last_activity_date": 1425840226, "creation_date": 1425839452, "question_id": 28930267, "link": "https://stackoverflow.com/questions/28930267/how-to-evaluate-fields-using-text-template-package-go", "title": "How to evaluate fields using text/template package? go", "body": "<p>I have a template and I would like to evaluate various fields using the <a href=\"http://golang.org/pkg/text/template/\" rel=\"nofollow\">text/template</a> package. I have a hard to time to figure it out how the evaluation should work because the code below seems to fail. Is the template package powerful enough to handle this kind of evaluations?</p>\n\n<pre><code>type something struct{\n    Brand   string\n}\ntpl := `{{if .Brand == \"Coke\"}} It's a coke{{else}} It's something else{{end}}`\n</code></pre>\n"}, {"tags": ["go", "tdd"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1425832373, "post_id": 28928870, "comment_id": 46113562, "body": "Did you try <code>writer := &amp;WriterMock{}</code>? My last example involved a type assertion to a pointer, and worked just fine."}, {"owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1425833137, "post_id": 28928870, "comment_id": 46113875, "body": "@VonC , that didn&#39;t work. I tried <code>writer := &amp;WriterMock{}</code> then <code>fileLogger := FileLogger{*writer}</code> and still test failed because the <code>[]byte</code> property is empty."}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 0, "creation_date": 1425833856, "post_id": 28928870, "comment_id": 46114194, "body": "Why are you dereferencing <code>writer</code>? Pass it as a pointer and change the receiver of write to be a pointer too."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1425841159, "post_id": 28928870, "comment_id": 46116812, "body": "May I recommend working your way through the Go Tour at tour.golang.org and maybe studying Effective Go?"}], "answers": [{"comments": [{"owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "edited": false, "score": 0, "creation_date": 1425835210, "post_id": 28929426, "comment_id": 46114746, "body": "I did that, and then when running the test, it panicked: <code>panic: interface conversion: io.Writer is logger.WriterMock, not *logger.WriterMock [recovered] \tpanic: interface conversion: io.Writer is logger.WriterMock, not *logger.WriterMock</code>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1425840475, "last_edit_date": 1425840475, "creation_date": 1425834931, "answer_id": 28929426, "question_id": 28928870, "link": "https://stackoverflow.com/questions/28928870/go-test-cannot-pass/28929426#28929426", "title": "Go: Test cannot pass?", "body": "<p>If you keep using a <em>pointer</em> to <code>WriterMock</code>, it should work:</p>\n\n<pre><code>func NewMockedFileLogger() *FileLogger{\n    writer := &amp;WriterMock{}\n    fileLogger := FileLogger{writer}\n    return &amp;fileLogger\n}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code> assert.Equal(t, \"Hello World!\", string(fileLogger.File.(*WriterMock).data))\n</code></pre>\n\n<p>I missed:</p>\n\n<pre><code>func (this *WriterMock) Write(b []byte) (n int, err error) {\n...\n}\n</code></pre>\n\n<p>You need to call <code>Write()</code> on a pointer receiver, not a value receiver.<br>\nSince everything is passed by value in Go, using a value receiver would make a <em>copy</em> of the <code>WriterMock</code> instance.  </p>\n"}], "owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 1, "accepted_answer_id": 28929426, "answer_count": 1, "score": -1, "last_activity_date": 1425840475, "creation_date": 1425832050, "question_id": 28928870, "link": "https://stackoverflow.com/questions/28928870/go-test-cannot-pass", "title": "Go: Test cannot pass?", "body": "<p>I'm having a problem making this test pass. The problem is, the <code>Write()</code> method in my struct needs to write to a property, but <code>io.Writer</code> interface does not accept pointer as its receiver.</p>\n\n<pre><code>filelogger.go:\n\npackage logger\n\nimport (\n    \"io\"\n)\n\ntype FileLogger struct{\n    File io.Writer\n}\n\nfunc NewFileLogger(file io.Writer) *FileLogger{\n    return &amp;FileLogger{file}\n}\n\nfunc (this *FileLogger) Log(message string) error {\n    _, err := this.File.Write([]byte(appendNewLine(message)))\n\n    return err\n}\n\nfilelogger_test.go:\n\npackage logger\n\nimport (\n    \"testing\"\n\n    \"github.com/stretchr/testify/assert\"\n)\n\ntype WriterMock struct{\n    data []byte\n}\n\nfunc (this WriterMock) Write(b []byte) (n int, err error) {\n    this.data = append(this.data, b ...)\n\n    return len(this.data), nil\n}\n\nfunc NewMockedFileLogger() *FileLogger{\n    writer := WriterMock{}\n\n    fileLogger := FileLogger{writer}\n\n    return &amp;fileLogger\n}\n\nfunc TestLog(t *testing.T) {\n    fileLogger := NewMockedFileLogger()\n\n    fileLogger.Log(\"Hello World!\")\n\n    assert.Equal(t, \"Hello World!\", string(fileLogger.File.(WriterMock).data))\n}\n</code></pre>\n\n<p>Test Output:</p>\n\n<pre><code>--- FAIL: TestLog (0.00 seconds)\n        Location:       filelogger_test.go:32\n    Error:      Not equal: \"Hello World!\" (expected)\n                    != \"\" (actual)\n\nFAIL\n</code></pre>\n\n<p>As I mentioned, the <code>data []byte</code> is not being written to, because I cannot set the function receiver as a pointer, as it won't satisfty the <code>io.Writer</code>.</p>\n"}, {"tags": ["go", "tdd"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425841396, "post_id": 28928337, "comment_id": 46116901, "body": "Please don&#39;t use <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#receiver-names\" rel=\"nofollow noreferrer\"><code>this</code> as a receiver name</a>. It was a poor idea that some languages force you to use magic special names and it&#39;s a bad idea idea to continue that with languages that don&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "edited": false, "score": 0, "creation_date": 1425832141, "post_id": 28928422, "comment_id": 46113487, "body": "I&#39;m having a hard time making this test pass, see <a href=\"http://stackoverflow.com/questions/28928870/go-test-cannot-pass\">stackoverflow.com/questions/28928870/go-test-cannot-pass</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1425830074, "last_edit_date": 1425830074, "creation_date": 1425829750, "answer_id": 28928422, "question_id": 28928337, "link": "https://stackoverflow.com/questions/28928337/go-property-exists-but-go-compiler-says-it-doesnt/28928422#28928422", "title": "Go: Property exists but Go compiler says it doesn&#39;t?", "body": "<p>The writer <code>File</code> in a <code>FileLogger</code> is an <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow\">interface</a> (<a href=\"http://golang.org/pkg/io/#Writer\" rel=\"nofollow\"><code>io.Writer</code></a>), not a <code>struct</code>.</p>\n\n<p>You would need a <strong><a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a></strong> in order to access <code>data</code> of <code>WriterMock</code>:</p>\n\n<pre><code>fileLooger.File.(*WriterMock).data\n</code></pre>\n\n<p>(Note: that would fail if File was not a <code>*WriterMock</code>: more on that below)</p>\n\n<hr>\n\n<p>See <a href=\"https://play.golang.org/p/FN4N1o_dlD\" rel=\"nofollow\">this simplified example</a>:</p>\n\n<p>package main</p>\n\n<pre><code>import \"fmt\"\nimport \"io\"\n\ntype WriterMock struct {\n    data []byte\n}\n\nfunc (this WriterMock) Write(b []byte) (n int, err error) {\n    this.data = append(this.data, b...)\n\n    return len(this.data), nil\n}\n\nfunc main() {\n    var w io.Writer = &amp;WriterMock{}\n    fmt.Printf(\"Hello, playground '%+v'\", w.(*WriterMock).data)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Hello, playground '[]'\n</code></pre>\n\n<h2>----</h2>\n\n<p>Since a type asertion car error, and you should always check the error, consider the section \"<a href=\"https://golang.org/doc/effective_go.html#interface_conversions\" rel=\"nofollow\">Interface conversions and type assertions</a>\":</p>\n\n<blockquote>\n  <p>But if it turns out that the value does not contain a string, the program will crash with a run-time error.<br>\n  To guard against that, use the \"comma, ok\" idiom to test, safely, whether the value is a string:</p>\n</blockquote>\n\n<pre><code>str, ok := value.(string)\nif ok {\n    fmt.Printf(\"string value is: %q\\n\", str)\n} else {\n    fmt.Printf(\"value is not a string\\n\")\n}\n</code></pre>\n"}], "owner": {"reputation": 2514, "user_id": 1091856, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/a5035693d3dc0b20b4cc6a0f4db7444f?s=128&d=identicon&r=PG", "display_name": "user1091856", "link": "https://stackoverflow.com/users/1091856/user1091856"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 28928422, "answer_count": 1, "score": 0, "last_activity_date": 1425830074, "creation_date": 1425829349, "question_id": 28928337, "link": "https://stackoverflow.com/questions/28928337/go-property-exists-but-go-compiler-says-it-doesnt", "title": "Go: Property exists but Go compiler says it doesn&#39;t?", "body": "<p>filelogger.go</p>\n\n<pre><code>package logger\n\nimport (\n    \"io\"\n)\n\ntype FileLogger struct{\n    File io.Writer\n}\n\nfunc NewFileLogger(file io.Writer) *FileLogger{\n    return &amp;FileLogger{file}\n}\n\nfunc (this *FileLogger) Log(message string) error {\n    _, err := this.File.Write([]byte(appendNewLine(message)))\n\n    return err\n}\n</code></pre>\n\n<p>filelogger_test.go:</p>\n\n<pre><code>package logger\n\nimport (\n    \"testing\"\n\n    \"github.com/stretchr/testify/assert\"\n)\n\ntype WriterMock struct{\n    data []byte\n}\n\nfunc (this WriterMock) Write(b []byte) (n int, err error) {\n    this.data = append(this.data, b ...)\n\n    return len(this.data), nil\n}\n\nfunc NewMockedFileLogger() *FileLogger{\n    writer := WriterMock{}\n\n    fileLogger := FileLogger{writer}\n\n    return &amp;fileLogger\n}\n\nfunc TestLog(t *testing.T) {\n    fileLogger := NewMockedFileLogger()\n\n    fileLogger.Log(\"Hello World!\")\n\n    assert.Equal(t, \"Hello World!\", string(fileLogger.File.data))\n}\n</code></pre>\n\n<p>My problem: </p>\n\n<p>I'm getting this error message when running go test:</p>\n\n<pre><code>fileLogger.File.data undefined (type io.Writer has no field or method data)\n</code></pre>\n\n<p><code>file.Logger.File</code> is indeed of <code>type io.Writer</code>, but this field <code>data</code> exists, I know Go is a strongly typed language, that's why it's not accepting this. </p>\n\n<p>How can solve this? </p>\n"}, {"tags": ["web", "go", "relative-path", "static-files"], "answers": [{"comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1425827268, "post_id": 28927384, "comment_id": 46111756, "body": "I have become a big fan of static file locations being configurable via a config file so +1 for the suggestion."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "edited": false, "score": 0, "creation_date": 1425831393, "post_id": 28927384, "comment_id": 46113207, "body": "@jayunit100 thanks. I usually don&#39;t keep my code under /src though, so that imports to my code won&#39;t look like &quot;github.com/me/foo/src/bar&quot;"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1425827346, "last_edit_date": 1425827346, "creation_date": 1425823878, "answer_id": 28927384, "question_id": 28927165, "link": "https://stackoverflow.com/questions/28927165/how-does-the-root-of-a-go-web-application-get-resolved/28927384#28927384", "title": "How does the root of a Go web application get resolved?", "body": "<p>Since Go doesn't bundle assets into binaries, it's certainly not a good idea to keep your code and your assets bundled together. </p>\n\n<p>I recommend one of the following:</p>\n\n<p>First of all, in both cases - make your app configurable, so that it accepts where the static assets are saved, either via a command line flag or a config file. It should be an absolute path, as it is irrelevant to where the executable is stored. </p>\n\n<p>And either: </p>\n\n<ol>\n<li><p>Keep a completely separate project for the static assets, and as a build step make sure they are packed together. In fact, you can deploy them separately to your server, thus not having to restart the Go app if you're only deploying HTML/JS/image changes.</p></li>\n<li><p>Keep their sources together in the same project, but make a top level directory named \"html\" or \"static\" or whatever. No Go files are allowed under this directory. The deployment process should be the same as in #1. </p></li>\n</ol>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 28927384, "answer_count": 1, "score": 1, "last_activity_date": 1425829772, "creation_date": 1425822563, "last_edit_date": 1425829772, "question_id": 28927165, "link": "https://stackoverflow.com/questions/28927165/how-does-the-root-of-a-go-web-application-get-resolved", "title": "How does the root of a Go web application get resolved?", "body": "<p>Im using go's <code>net/http</code> library to serve up a web app.  When users come to the site, they can simply go to /, and it serves index.html (like any site).</p>\n\n<p>This is implemented using:</p>\n\n<pre><code>r.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./\")))\n</code></pre>\n\n<p>However, there are two ways to structure such an app.  First you could pack all the files in the same directory.   This seems to me to be a unstable solution (if I run the go file directly it fails).</p>\n\n<pre><code>src/bin/app.go\nsrc/bin/index.html\n</code></pre>\n\n<p>Or, the more \"traditional\" style, where index.html is top level.</p>\n\n<pre><code>src/bin/app.go\nindex.html\n</code></pre>\n\n<ul>\n<li>Where is the <em>right</em> place for index.html, or other static resources in a go web app ?   </li>\n<li>How is the location of ./ determined once we pack a go file into a binary ?   </li>\n<li>Can a go binary file preserve a directory structure of non go resources so that this is consistent between dev and production environments?</li>\n</ul>\n\n<p><em>UPDATE</em> (The answer below is correct, and I implemented the suggestion by Not_a_golfer below and my dir tree looks like this, which is easy to maintain in any environment via conf or dynamic logic in the server).</p>\n\n<pre><code>\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 main\n\u2502       \u2514\u2500\u2500 app.go\n\u2514\u2500\u2500 static\n    \u251c\u2500\u2500 index.html\n    \u251c\u2500\u2500 script.js\n    \u2514\u2500\u2500 style.css\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1425840611, "post_id": 28925688, "comment_id": 46116590, "body": "If by &quot;after each test&quot;/&quot;after executing every test&quot; you mean each <i>individual test</i>, then that&#39;s <b>not</b> what <code>TestMain</code> is for. If instead you meant &quot;after <i>all</i> tests&quot;/&quot;after each &#39;go test&#39; invocation&quot;/etc, then perhaps you should make that clearer."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 8, "last_activity_date": 1425813096, "creation_date": 1425813096, "answer_id": 28925727, "question_id": 28925688, "link": "https://stackoverflow.com/questions/28925688/golang-testing-method-after-each-test-undefined-testing-m/28925727#28925727", "title": "golang testing method after each test: undefined: testing.M", "body": "<p>Check you <code>go version</code> output: this is for <a href=\"https://golang.org/doc/go1.4\">go 1.4+ only</a>.</p>\n\n<blockquote>\n  <p>The testing package has a new facility to provide more control over running a set of tests. If the test code contains a function</p>\n</blockquote>\n\n<pre><code>func TestMain(m *testing.M) \n</code></pre>\n\n<blockquote>\n  <p>that function will be called instead of running the tests directly.<br>\n  The <code>M</code> struct contains methods to access and run the tests.</p>\n</blockquote>\n\n<hr>\n\n<p>You can see <a href=\"https://justinas.org/my-reason-to-be-excited-for-go-14/\">that feature used here</a>:</p>\n\n<blockquote>\n  <p>The introduction of <code>TestMain()</code> made it possible to run these migrations only once. The code now looks like this:</p>\n</blockquote>\n\n<pre><code>func TestSomeFeature(t *testing.T) {\n    defer models.TestDBManager.Reset()\n\n    // Do the tests\n}\n\nfunc TestMain(m *testing.M) {\n    models.TestDBManager.Enter()\n    // os.Exit() does not respect defer statements\n    ret := m.Run()\n    models.TestDBManager.Exit()\n    os.Exit(ret)\n}\n</code></pre>\n\n<blockquote>\n  <p>While each test must still clean up after itself, that only involves restoring the initial data, which is way faster than doing the schema migrations.</p>\n</blockquote>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3398, "favorite_count": 2, "accepted_answer_id": 28925727, "answer_count": 1, "score": 3, "last_activity_date": 1425813096, "creation_date": 1425812821, "question_id": 28925688, "link": "https://stackoverflow.com/questions/28925688/golang-testing-method-after-each-test-undefined-testing-m", "title": "golang testing method after each test: undefined: testing.M", "body": "<p>I am trying to repeat example from <a href=\"http://golang.org/pkg/testing/#hdr-Main\" rel=\"nofollow\">golang testing</a></p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n)\n\nfunc TestSomeTest(t *testing.T) {}\n\nfunc TestMain(m *testing.M) { // cleaning after each test}\n</code></pre>\n\n<p>I want <code>TestMain</code> function to run after every test.</p>\n\n<p>Running command <code>go test</code></p>\n\n<p>And the compiler says </p>\n\n<pre><code>./testingM_test.go:9: undefined: testing.M\n</code></pre>\n\n<p>So how to clean after executing every test? </p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425840061, "post_id": 28925179, "comment_id": 46116421, "body": "You probably want/need to covert the C pointer (and implied length n??) into a Go slice. That is non-trivial, perhaps some support code using reflection?"}], "answers": [{"comments": [{"owner": {"reputation": 243, "user_id": 830738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/642e11fa05005827f2617d2653b55b45?s=128&d=identicon&r=PG", "display_name": "crackcell", "link": "https://stackoverflow.com/users/830738/crackcell"}, "edited": false, "score": 0, "creation_date": 1425881240, "post_id": 28933938, "comment_id": 46127418, "body": "Nice! It works! But I cant get the array slicing part [:teamSize:teamSzie] . I replace it with [:teamSize], it works the same. Why double teamSize?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 243, "user_id": 830738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/642e11fa05005827f2617d2653b55b45?s=128&d=identicon&r=PG", "display_name": "crackcell", "link": "https://stackoverflow.com/users/830738/crackcell"}, "edited": false, "score": 0, "creation_date": 1425905327, "post_id": 28933938, "comment_id": 46139037, "body": "@crackcell: The third field in slice notation (the first is 0, which you can omit here) sets the slice capacity (<a href=\"http://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">Slice Expressions</a>) . You need it to prevent a possible buffer overrun into memory outside that of your array."}, {"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "edited": false, "score": 1, "creation_date": 1512553426, "post_id": 28933938, "comment_id": 82301077, "body": "@JimB: Now that I have enough reputation to write a comment: Could you please correct your answer and add a <code>defer</code> before <code>C.free</code> (see my answer to this question for the other alternative). The way you wrote it, memory is freed before usage, i.e. invalid memory accesses are guaranteed when using <code>teamSlice</code>."}, {"owner": {"reputation": 543, "user_id": 5192980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2324420c345a0e8078b1d5c29cf13395?s=128&d=identicon&r=PG&f=1", "display_name": "ricpacca", "link": "https://stackoverflow.com/users/5192980/ricpacca"}, "edited": false, "score": 0, "creation_date": 1538777605, "post_id": 28933938, "comment_id": 92277386, "body": "Shouldn&#39;t it be <code>C.struct_Person</code> instead of <code>C.team</code> in the last line of the code snippet? This works for me <code>teamSlice := (*[1 &lt;&lt; 30]C.struct_Person)(unsafe.Pointer(team))[:teamSize:teamSize&zwnj;&#8203;]</code>."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 12, "last_activity_date": 1559951451, "last_edit_date": 1559951451, "creation_date": 1425864405, "answer_id": 28933938, "question_id": 28925179, "link": "https://stackoverflow.com/questions/28925179/cgo-how-to-pass-struct-array-from-c-to-go/28933938#28933938", "title": "cgo: How to pass struct array from c to go", "body": "<p>First, even though you\u2019re using Go, when you add cgo there is no longer any \"safe\". It's up to you to determine when and how you free the memory, just as if you were programming in C.</p>\n\n<p>The easiest way to use a C array in go is to convert it to a slice through an array:</p>\n\n<pre><code>team := C.get_team()\ndefer C.free(unsafe.Pointer(team))\nteamSlice := (*[1 &lt;&lt; 30]C.struct_Person)(unsafe.Pointer(team))[:teamSize:teamSize]\n</code></pre>\n\n<p>The max-sized array isn't actually allocated, but Go requires constant size arrays, and <code>1&lt;&lt;30</code> is going to be large enough. That array is immediately converted to a slice, with the length and capacity properly set.</p>\n"}], "owner": {"reputation": 243, "user_id": 830738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/642e11fa05005827f2617d2653b55b45?s=128&d=identicon&r=PG", "display_name": "crackcell", "link": "https://stackoverflow.com/users/830738/crackcell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4184, "favorite_count": 4, "accepted_answer_id": 28933938, "answer_count": 1, "score": 5, "last_activity_date": 1559951451, "creation_date": 1425808638, "question_id": 28925179, "link": "https://stackoverflow.com/questions/28925179/cgo-how-to-pass-struct-array-from-c-to-go", "title": "cgo: How to pass struct array from c to go", "body": "<p>The C part:</p>\n\n<pre><code>struct Person {...}\nstruct Person * get_team(int * n)\n</code></pre>\n\n<p>The Go part:</p>\n\n<pre><code>n := C.int(0)\nvar team *C.struct_Person = C.get_team(&amp;n)\ndefer C.free(unsafe.Pointer(team))\n</code></pre>\n\n<p>I can get the first element of the array in this way. But how to get the whole array with n elements?\nand how to free them safely?</p>\n"}, {"tags": ["xml", "go", "unmarshalling", "cocos2d-js"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1425839927, "post_id": 28925055, "comment_id": 46116364, "body": "Best is to post a full small runnable example via play.golang.org. At minimum for things like XML if you trim it down you should include the appropriate ending tags rather than just cutting it off in the middle and making your example unusable without editing."}], "answers": [{"comments": [{"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 0, "creation_date": 1426054295, "post_id": 28930326, "comment_id": 46209669, "body": "Yeah, than I guess, I can&#39;t use xml.Marshall for this XML-file, because it works with a &quot;key&quot;, &quot;value&quot; system and depends on the order. I used xml.NewDecoder and decoder.Token() now. That works ..."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1425839842, "creation_date": 1425839842, "answer_id": 28930326, "question_id": 28925055, "link": "https://stackoverflow.com/questions/28925055/xml-unmarshal-error-expected-element-type-dict-but-have-plist/28930326#28930326", "title": "xml.Unmarshal error: expected element type &lt;dict&gt; but have &lt;plist&gt;", "body": "<p>The order of your <code>XMLName</code> field within your struct is irrelevant. Unmarshalling happens only with regard to the field names and the tags not order.</p>\n\n<p>By having <code>XMLName</code> anywhere in your type you are declaring the entire type should be of/within that XML element.</p>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 1, "accepted_answer_id": 28930326, "answer_count": 1, "score": 2, "last_activity_date": 1425839842, "creation_date": 1425807518, "question_id": 28925055, "link": "https://stackoverflow.com/questions/28925055/xml-unmarshal-error-expected-element-type-dict-but-have-plist", "title": "xml.Unmarshal error: expected element type &lt;dict&gt; but have &lt;plist&gt;", "body": "<p>I try to unmarshal a XML file using xml.Unmarshal of \"encoding/xml\" package.</p>\n\n<p>The XML file starts like this: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n    &lt;key&gt;frames&lt;/key&gt;\n    &lt;dict&gt;\n        &lt;key&gt;0&lt;/key&gt;\n        &lt;dict&gt;\n            &lt;key&gt;frame&lt;/key&gt;\n            &lt;string&gt;{{0, 0}, {81, 145}}&lt;/string&gt;\n            &lt;key&gt;offset&lt;/key&gt;\n            &lt;string&gt;{0, 0}&lt;/string&gt;\n            &lt;key&gt;rotated&lt;/key&gt;\n            &lt;false/&gt;\n            &lt;key&gt;sourceColorRect&lt;/key&gt;\n            &lt;string&gt;{{0, 0}, {80, 145}}&lt;/string&gt;\n            &lt;key&gt;sourceSize&lt;/key&gt;\n            &lt;string&gt;{81, 145}&lt;/string&gt;\n            &lt;key&gt;aliases&lt;/key&gt;\n            &lt;array&gt;\n\n            &lt;/array&gt;\n        &lt;/dict&gt;\n        &lt;key&gt;1&lt;/key&gt;\n</code></pre>\n\n<p>I define two structs:</p>\n\n<pre><code>// types for createfont command\ntype Characters struct {\n    XMLName xml.Name `xml:\"dict\"`\n    Char []string `xml:\"key\"`\n}\n\ntype Result struct {\n    Plist string `xml:\"plist\"`\n    XMLName xml.Name `xml:\"dict\"`\n    Keys []string `xml:\"key\"`\n    Chars []Characters `xml:\"dict\"`\n}\n</code></pre>\n\n<p>And unmarshal with this:</p>\n\n<pre><code>v := Result{}\nerr = xml.Unmarshal([]byte(data), &amp;v)\nif err != nil {\n    fmt.Printf(\"error: %v\", err)\n    return\n} else {\n    fmt.Println(\"Result\",v)\n}\n</code></pre>\n\n<p>As result I get:</p>\n\n<pre><code>error: expected element type &lt;dict&gt; but have &lt;plist&gt;\n</code></pre>\n\n<p>If I remove the plist line in the XML file and in the struct it works fine. </p>\n\n<p>How do I have to write, that I can let it in?</p>\n"}, {"tags": ["go", "profile", "pprof"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 1446217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r6KcM.jpg?s=128&g=1", "display_name": "A.Glyzov", "link": "https://stackoverflow.com/users/1446217/a-glyzov"}, "is_accepted": true, "score": 5, "last_activity_date": 1538597125, "last_edit_date": 1538597125, "creation_date": 1453900819, "answer_id": 35038523, "question_id": 28924550, "link": "https://stackoverflow.com/questions/28924550/golang-profile-with-pprof-how-to-get-hit-count-not-duration/35038523#35038523", "title": "golang profile with pprof, how to get hit count not duration?", "body": "<p>You can use <code>go tool pprof -callgrind -output callgrind.out innercpu.pprof</code> to generate callgrind data out of your collected profiling data. Which you can then visualise with <a href=\"http://kcachegrind.sourceforge.net/\" rel=\"nofollow noreferrer\">qcachegrind/kcachegrind</a>. It'll display call counts.</p>\n"}], "owner": {"reputation": 169, "user_id": 1627021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MN2cH.jpg?s=128&g=1", "display_name": "chen_767", "link": "https://stackoverflow.com/users/1627021/chen-767"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 1, "accepted_answer_id": 35038523, "answer_count": 1, "score": 4, "last_activity_date": 1538597125, "creation_date": 1425803674, "question_id": 28924550, "link": "https://stackoverflow.com/questions/28924550/golang-profile-with-pprof-how-to-get-hit-count-not-duration", "title": "golang profile with pprof, how to get hit count not duration?", "body": "<p>how to get hit count like:</p>\n\n<pre><code>(pprof) top\nTotal: 2525 samples\n     298  11.8%  11.8%      345  13.7% runtime.mapaccess1_fast64\n     268  10.6%  22.4%     2124  84.1% main.FindLoops\n</code></pre>\n\n<p>not, durations like:</p>\n\n<pre><code>(pprof) top\n2220ms of 3080ms total (72.08%)\nDropped 72 nodes (cum &lt;= 15.40ms)\nShowing top 10 nodes out of 111 (cum &gt;= 60ms)\n      flat  flat%   sum%        cum   cum%\n    1340ms 43.51% 43.51%     1410ms 45.78%  runtime.cgocall_errno\n</code></pre>\n\n<p>env: I using golang1.4, add below codes.</p>\n\n<pre><code>defer pprof.StopCPUProfile()\nf, err := os.Create(\"innercpu.pprof\")\nif err != nil {\n    fmt.Println(\"Error: \", err)\n}\npprof.StartCPUProfile(f)\n</code></pre>\n"}, {"tags": ["c++11", "go", "atomic", "lock-free"], "answers": [{"comments": [{"owner": {"reputation": 4456, "user_id": 4127569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b728c7d6c1dce81f5a82249b7617756?s=128&d=identicon&r=PG&f=1", "display_name": "jch", "link": "https://stackoverflow.com/users/4127569/jch"}, "edited": false, "score": 1, "creation_date": 1592907336, "post_id": 28924435, "comment_id": 110586271, "body": "Does <i>The Go Memory Model</i> say anything about <code>sync&#47;atomic</code>?"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 7, "last_activity_date": 1425802667, "creation_date": 1425802667, "answer_id": 28924435, "question_id": 28924132, "link": "https://stackoverflow.com/questions/28924132/go-atomic-and-memory-order/28924435#28924435", "title": "Go atomic and memory order", "body": "<p>You need to read <a href=\"https://golang.org/ref/mem\">The Go Memory Model</a></p>\n\n<p>You'll discover that Go has nothing like the control that you have in C++ - there isn't a direct translation of the C++ features in your post.  This is a deliberate design decision by the Go authors - the Go motto is <a href=\"https://blog.golang.org/share-memory-by-communicating\">Do not communicate by sharing memory; instead, share memory by communicating</a>.</p>\n\n<p>Assuming that the standard go channel isn't good enough for what you want to do, you'll have 2 choices for each memory access, using the facilities in <a href=\"http://golang.org/pkg/sync/atomic/\">sync/atomic</a> or not, and whether you need to use them or not will depend on a careful reading of the Go Memory Model and analysis of your code which only you can do.</p>\n"}], "owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 1, "accepted_answer_id": 28924435, "answer_count": 1, "score": 3, "last_activity_date": 1434645727, "creation_date": 1425799752, "last_edit_date": 1434645727, "question_id": 28924132, "link": "https://stackoverflow.com/questions/28924132/go-atomic-and-memory-order", "title": "Go atomic and memory order", "body": "<p>I am porting a lock free queue from c++11 to go and i came across things such as</p>\n\n<pre><code>auto currentRead = writeIndex.load(std::memory_order_relaxed);\n</code></pre>\n\n<p>and in some cases <code>std::memory_order_release</code> and <code>std::memory_order_aqcuire</code>\nalso the equivelent for the above in c11 is something like </p>\n\n<pre><code>unsigned long currentRead = atomic_load_explicit(&amp;q-&gt;writeIndex,memory_order_relaxed);\n</code></pre>\n\n<p>the meaning of those is described <a href=\"http://en.cppreference.com/w/cpp/atomic/memory_order\" rel=\"nofollow\">here</a></p>\n\n<p>is there an equivalent to such thing in go or do i just use something like</p>\n\n<pre><code>var currentRead uint64 = atomic.LoadUint64(&amp;q.writeIndex)\n</code></pre>\n\n<p>after porting i benchmarked and just using LoadUint64 it seems to work as expected but orders of magnitude slower and i wonder how much effect dose those specialized ops have on performance.</p>\n\n<ul>\n<li>further info from the link i attached</li>\n</ul>\n\n<blockquote>\n  <p><strong>memory_order_relaxed</strong>:Relaxed operation: there are no synchronization\n  or ordering constraints, only atomicity is required of this operation.</p>\n  \n  <p><strong>memory_order_consume</strong>:A load operation with this memory order performs\n  a consume operation on the affected memory location: no reads in the\n  current thread dependent on the value currently loaded can be\n  reordered before this load. This ensures that writes to data-dependent\n  variables in other threads that release the same atomic variable are\n  visible in the current thread. On most platforms, this affects\n  compiler optimizations only.</p>\n  \n  <p><strong>memory_order_acquire</strong>:A load operation with this memory order performs the acquire operation on the affected memory location: no\n  memory accesses in the current thread can be reordered before this\n  load. This ensures that all writes in other threads that release the\n  same atomic variable are visible in the current thread.</p>\n  \n  <p><strong>memory_order_release</strong>:A store operation with this memory order performs the release operation: no memory accesses in the current\n  thread can be reordered after this store. This ensures that all writes\n  in the current thread are visible in other threads that acquire or the\n  same atomic variable and writes that carry a dependency into the\n  atomic variable become visible in other threads that consume the same\n  atomic.</p>\n</blockquote>\n"}, {"tags": ["bash", "ssh", "go", "tty"], "comments": [{"owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "edited": false, "score": 3, "creation_date": 1425792748, "post_id": 28921409, "comment_id": 46103578, "body": "Have you tried disabling  <code>ECHOCTL</code> terminal mode?"}, {"owner": {"reputation": 1699, "user_id": 356191, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1e2f5505c9fd1adf6a2203556d0791d5?s=128&d=identicon&r=PG", "display_name": "Cera", "link": "https://stackoverflow.com/users/356191/cera"}, "reply_to_user": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "edited": false, "score": 0, "creation_date": 1425797033, "post_id": 28921409, "comment_id": 46104283, "body": "@EmilDavtyan that fixed it! Now to understand why."}, {"owner": {"reputation": 1652, "user_id": 918176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bdb37b11c35de00bb68359342a82f38?s=128&d=identicon&r=PG", "display_name": "user918176", "link": "https://stackoverflow.com/users/918176/user918176"}, "edited": false, "score": 1, "creation_date": 1429637510, "post_id": 28921409, "comment_id": 47688551, "body": "@Cerales Please remember to answer your own question and accept the answer :)"}, {"owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "edited": false, "score": 0, "creation_date": 1430278394, "post_id": 28921409, "comment_id": 47989812, "body": "@Cerales I posted my comment as an answer, so you can mark this answered."}, {"owner": {"reputation": 7319, "user_id": 483528, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/38a7e4742a27f2dd6cdd34a1e27328f1?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Brikman", "link": "https://stackoverflow.com/users/483528/yevgeniy-brikman"}, "edited": false, "score": 0, "creation_date": 1462403983, "post_id": 28921409, "comment_id": 61629194, "body": "@Cera: What signals were you waiting for in you <code>for&#47;select</code>? What did you do with them when you got them? I can&#39;t seem to get <code>SIGINT</code> (<code>CTRL+C</code>) to work the way I expect."}, {"owner": {"reputation": 1699, "user_id": 356191, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1e2f5505c9fd1adf6a2203556d0791d5?s=128&d=identicon&r=PG", "display_name": "Cera", "link": "https://stackoverflow.com/users/356191/cera"}, "reply_to_user": {"reputation": 7319, "user_id": 483528, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/38a7e4742a27f2dd6cdd34a1e27328f1?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Brikman", "link": "https://stackoverflow.com/users/483528/yevgeniy-brikman"}, "edited": false, "score": 0, "creation_date": 1462580611, "post_id": 28921409, "comment_id": 61710956, "body": "@YevgeniyBrikman I need to expand the implementation to handle every signal specified in the RFC, but for the moment I&#39;m just handling SIGINT and SIGQUIT. When I get them I pass them into session.Signal()."}, {"owner": {"reputation": 7319, "user_id": 483528, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/38a7e4742a27f2dd6cdd34a1e27328f1?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Brikman", "link": "https://stackoverflow.com/users/483528/yevgeniy-brikman"}, "edited": false, "score": 0, "creation_date": 1462621422, "post_id": 28921409, "comment_id": 61720127, "body": "@Cera: For some reason, <code>session.Signal()</code> never worked for me. However, see my new response below for a fully-working solution."}], "answers": [{"comments": [{"owner": {"reputation": 1596, "user_id": 127291, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/U3dgL.png?s=128&g=1", "display_name": "aramadia", "link": "https://stackoverflow.com/users/127291/aramadia"}, "edited": false, "score": 2, "creation_date": 1459897004, "post_id": 29933835, "comment_id": 60491796, "body": "This fails to work for me.  I still see character escape codes and autocomplete doesn&#39;t work."}, {"owner": {"reputation": 7319, "user_id": 483528, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/38a7e4742a27f2dd6cdd34a1e27328f1?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Brikman", "link": "https://stackoverflow.com/users/483528/yevgeniy-brikman"}, "edited": false, "score": 0, "creation_date": 1462404032, "post_id": 29933835, "comment_id": 61629204, "body": "I&#39;ve set <code>ssh.ECHOCTL</code> to 0 in my code and still see control characters when I use the arrow keys. Any ideas?"}], "tags": [], "owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "is_accepted": true, "score": 1, "last_activity_date": 1430278361, "creation_date": 1430278361, "answer_id": 29933835, "question_id": 28921409, "link": "https://stackoverflow.com/questions/28921409/how-can-i-send-terminal-escape-sequences-through-ssh-with-go/29933835#29933835", "title": "How can I send terminal escape sequences through SSH with Go?", "body": "<p>Disable <code>ECHOCTL</code> terminal mode.</p>\n\n<pre><code>modes := ssh.TerminalModes{\n    ssh.ECHO: 0,\n    ssh.ECHOCTL: 0,\n    ssh.TTY_OP_ISPEED: 14400,\n    ssh.TTY_OP_OSPEED: 14400\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1486669321, "post_id": 37088088, "comment_id": 71457123, "body": "So basically the problem is that <code>os.Stdin</code> is being buffered somehow? Thanks for this btw, I was getting really frustrated trying to figure out how to solve this problem."}], "tags": [], "owner": {"reputation": 7319, "user_id": 483528, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/38a7e4742a27f2dd6cdd34a1e27328f1?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Brikman", "link": "https://stackoverflow.com/users/483528/yevgeniy-brikman"}, "is_accepted": false, "score": 15, "last_activity_date": 1462621380, "creation_date": 1462621380, "answer_id": 37088088, "question_id": 28921409, "link": "https://stackoverflow.com/questions/28921409/how-can-i-send-terminal-escape-sequences-through-ssh-with-go/37088088#37088088", "title": "How can I send terminal escape sequences through SSH with Go?", "body": "<p>The <code>ssh.ECHO: 0</code> and <code>ssh.ECHOCTL: 0</code> settings didn't work for me. For other people that ran into this issue, below is the rough code it took to get a fully working interactive terminal with the Go ssh library:</p>\n\n<pre><code>config := return &amp;ssh.ClientConfig{\n    User: \"username\",\n    Auth: []ssh.AuthMethod{ssh.Password(\"password\")},\n}\n\nclient, err := ssh.Dial(\"tcp\", \"12.34.56.78:22\", config)\nif err != nil { ... }\ndefer client.Close()\n\nsession, err := client.NewSession()\nif err != nil { ... }\ndefer session.Close()\n\nsession.Stdout = os.Stdout\nsession.Stderr = os.Stderr\nsession.Stdin = os.Stdin\n\nmodes := ssh.TerminalModes{\n    ssh.ECHO:          1,     // enable echoing\n    ssh.TTY_OP_ISPEED: 14400, // input speed = 14.4kbaud\n    ssh.TTY_OP_OSPEED: 14400, // output speed = 14.4kbaud\n}\n\nfileDescriptor := int(os.Stdin.Fd())\n\nif terminal.IsTerminal(fileDescriptor) {\n    originalState, err := terminal.MakeRaw(fileDescriptor)\n    if err != nil { ... }\n    defer terminal.Restore(fileDescriptor, originalState)\n\n    termWidth, termHeight, err := terminal.GetSize(fileDescriptor)\n    if err != nil { ... }\n\n    err = session.RequestPty(\"xterm-256color\", termHeight, termWidth, modes) \n    if err != nil { ... }\n}\n\nerr = session.Shell()\nif err != nil { ... }\n\n// You should now be connected via SSH with a fully-interactive terminal\n// This call blocks until the user exits the session (e.g. via CTRL + D)\nsession.Wait()\n</code></pre>\n\n<p>Note that all keyboard functionality (tab completion, up arrow) and signal handling (<code>CTRL + C</code>, <code>CTRL + D</code>) works correctly with the setup above.</p>\n"}], "owner": {"reputation": 1699, "user_id": 356191, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1e2f5505c9fd1adf6a2203556d0791d5?s=128&d=identicon&r=PG", "display_name": "Cera", "link": "https://stackoverflow.com/users/356191/cera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2302, "favorite_count": 3, "accepted_answer_id": 29933835, "answer_count": 2, "score": 11, "last_activity_date": 1462621380, "creation_date": 1425771693, "question_id": 28921409, "link": "https://stackoverflow.com/questions/28921409/how-can-i-send-terminal-escape-sequences-through-ssh-with-go", "title": "How can I send terminal escape sequences through SSH with Go?", "body": "<p>I'm writing a Go program that will connect to a host via SSH using the native <a href=\"https://godoc.org/golang.org/x/crypto/ssh\" rel=\"noreferrer\">x/crypto/ssh</a> library and drop an interative shell.</p>\n\n<p>I'm using <a href=\"https://godoc.org/golang.org/x/crypto/ssh#Session.RequestPty\" rel=\"noreferrer\"><code>RequestPty()</code></a>, but the (bash) shell on the remote end does not behave as expected with control codes.</p>\n\n<p>When I enter various control characters, they're echoed back by my terminal:</p>\n\n<pre><code>$ ^[[A\n</code></pre>\n\n<p>The characters still <em>work</em> in the sense that if I press enter after pressing the up arrow, the previous command is run - but the control character output clobbers what should be displayed there. The same goes for tab.</p>\n\n<p>Is there some straightforward way to get this to work? When I've implemented similar systems in the past it hasn't been an issue because I've just shelled out to <code>openssh</code>, and the semantics of process groups sort it all out.</p>\n\n<p>I've studied \"<a href=\"http://www.linusakesson.net/programming/tty/\" rel=\"noreferrer\">The TTY Demystified</a>\" and as great as it is it's not clear where to begin.</p>\n\n<p>A couple of things I've thought to investigate:</p>\n\n<ul>\n<li><a href=\"https://godoc.org/golang.org/x/crypto/ssh/terminal#MakeRaw\" rel=\"noreferrer\">enable raw mode in my terminal</a> - but I don't want to do this without understanding why, and it doesn't <em>seem</em> to do the right thing</li>\n<li><a href=\"https://godoc.org/golang.org/x/crypto/ssh#pkg-constants\" rel=\"noreferrer\">fiddle with the terminal mode flags</a></li>\n</ul>\n\n<p><code>openssh</code> itself must be doing this work correctly, but it's a real best of a code base to study.</p>\n\n<p>It's not actually clear to me whether this printing is being done by my local terminal emulator or shell or by the code on the remote host.</p>\n\n<p>Where do I begin?</p>\n\n<hr>\n\n<p>Here is a sample of my code:</p>\n\n<pre><code>conf := ssh.ClientConfig{\n    User: myuser,\n    Auth: []ssh.AuthMethod{ssh.Password(my_password)}\n}\nconn, err := ssh.Dial(\"tcp\", myhost, conf)\nif err != nil {\n    return err\n}\ndefer conn.Close()\nsession, err := conn.NewSession()\nif err != nil {\n    return err\n}\ndefer session.Close()\nsession.Stdout = os.Stdout\nsession.Stderr = os.Stderr\nsession.Stdin = os.Stdin\n\nmodes := ssh.TerminalModes{\n    ssh.ECHO: 0\n    ssh.TTY_OP_ISPEED: 14400,\n    ssh.TTY_OP_OSPEED: 14400\n}\nif err := session.RequestPty(\"xterm\", 80, 40, modes); err != nil {\n    return err\n}\nif err = session.Shell(); err != nil {\n    return err\n}\n\nreturn session.Wait()\n</code></pre>\n\n<p>I've tried this with term values other than <code>xterm</code>: <code>screen-256color</code> and <code>vt100</code>.</p>\n\n<p>For the record - in the real code, instead of just a call to <code>session.Wait()</code>, I have a <code>for/select</code> loop that catches various signals to the process and sends them on to the <code>Session</code>.</p>\n"}, {"tags": ["java", "python", "google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 5916, "user_id": 1359431, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/902fceb06952277fddb1ef6a27a14908?s=128&d=identicon&r=PG", "display_name": "clocksmith", "link": "https://stackoverflow.com/users/1359431/clocksmith"}, "edited": false, "score": 0, "creation_date": 1425774808, "post_id": 28921694, "comment_id": 46100671, "body": "For Java GAE, there is the option to instead generate <code>appengine-web.xml</code> and <code>web.xml</code> from an <code>app.yaml</code>. I chose this option hoping I could do url routing to a static file, but for some reason, it seems this feature is only available in Python and Go GAE."}], "tags": [], "owner": {"reputation": 475, "user_id": 2330325, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36770fc7489816468b0744b7bf66f993?s=128&d=identicon&r=PG", "display_name": "Mark Hayden", "link": "https://stackoverflow.com/users/2330325/mark-hayden"}, "is_accepted": false, "score": 1, "last_activity_date": 1425774498, "last_edit_date": 1425774498, "creation_date": 1425774096, "answer_id": 28921694, "question_id": 28919397, "link": "https://stackoverflow.com/questions/28919397/route-dynamic-urls-to-static-files-in-app-engine-java/28921694#28921694", "title": "Route dynamic URLs to static files in App Engine Java", "body": "<p>I dont use the java version but it looks like the <code>appengine-web.xml</code> serves the same function as the app.yaml in go / python? </p>\n"}], "owner": {"reputation": 5916, "user_id": 1359431, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/902fceb06952277fddb1ef6a27a14908?s=128&d=identicon&r=PG", "display_name": "clocksmith", "link": "https://stackoverflow.com/users/1359431/clocksmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425774498, "creation_date": 1425758746, "last_edit_date": 1425759911, "question_id": 28919397, "link": "https://stackoverflow.com/questions/28919397/route-dynamic-urls-to-static-files-in-app-engine-java", "title": "Route dynamic URLs to static files in App Engine Java", "body": "<p>I have a <strong>Java App Engine</strong> app and want to route <code>mydomain.com/i/&lt;anything&gt;</code> to <code>i.html</code>. For example:</p>\n\n<pre><code>mydomain.com/i/12345 --&gt; i.html\n\nmydomain.com/i/abcde --&gt; i.html\n</code></pre>\n\n<p>This looks like it is possible to do in <a href=\"https://cloud.google.com/appengine/docs/python/config/appconfig#Python_app_yaml_Static_file_handlers\" rel=\"nofollow\">app.yaml for Python</a> and <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig\" rel=\"nofollow\">app.yaml for Go</a> with something like: </p>\n\n<pre><code>handlers:\n  - url: /i/(.*)\n    static_files: i.html\n</code></pre>\n\n<p>but this handler mapping to static files is NOT mentioned in <a href=\"https://cloud.google.com/appengine/docs/java/configyaml/appconfig_yaml#Java_app_yaml_The_welcome_file_list\" rel=\"nofollow\">app.yaml for Java</a>. Instead, there is a separate <strong>Static files and resource files</strong> section that cannot do url mappings, and the only options to map a url in <code>handlers</code> is to a <code>servlet</code>, <code>jsp</code>, or <code>filter</code>. If I try to map to <code>static_files</code> in a Java app.yaml, I get an <code>Unable to find property 'static_files'</code> error.</p>\n\n<p>The key here is that I want to <strong>map a url to a static file that is served as a static file</strong>. Why would this be only possible to do in Python and Go, and not in Java?</p>\n"}, {"tags": ["templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1425754744, "post_id": 28918301, "comment_id": 46095020, "body": "Good idea! Thus there is no way to get content from curly brackets?)"}, {"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 2, "creation_date": 1425768847, "post_id": 28918301, "comment_id": 46099331, "body": "If you aren&#39;t using the slice elements, it is more efficient to use an empty struct. <a href=\"http://play.golang.org/p/_jRV62bOB3\" rel=\"nofollow noreferrer\">play.golang.org/p/_jRV62bOB3</a> This way you only allocate a slice header (constant size) instead of n elements."}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1425810658, "post_id": 28918301, "comment_id": 46107102, "body": "yeap! you are absolutely right!) @Innominate, please update your answer."}], "tags": [], "owner": {"reputation": 2166, "user_id": 3103130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uwRyn.jpg?s=128&g=1", "display_name": "Innominate", "link": "https://stackoverflow.com/users/3103130/innominate"}, "is_accepted": true, "score": 9, "last_activity_date": 1425834818, "last_edit_date": 1425834818, "creation_date": 1425752043, "answer_id": 28918301, "question_id": 28917530, "link": "https://stackoverflow.com/questions/28917530/golang-how-to-create-loop-function-using-html-template-package/28918301#28918301", "title": "Golang. How to create loop function using html/template package", "body": "<p>You can use <code>range</code> on a function that returns a slice. <a href=\"http://play.golang.org/p/FCuLkEHaZn\" rel=\"noreferrer\">http://play.golang.org/p/FCuLkEHaZn</a></p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"os\"\n)\n\nfunc main() {\n    html := `\n&lt;div class=\"row -flex palette\"&gt;\n  {{range loop 16}}\n    &lt;div class=\"col-2\"&gt;&lt;/div&gt;\n  {{end}}\n&lt;/div&gt;`\n    tmpl := template.Must(template.New(\"test\").Funcs(template.FuncMap{\n        \"loop\": func(n int) []struct{} {\n            return make([]struct{}, n)\n        },\n    }).Parse(html))\n    tmpl.Execute(os.Stdout, nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4521, "favorite_count": 0, "accepted_answer_id": 28918301, "answer_count": 1, "score": 5, "last_activity_date": 1425834818, "creation_date": 1425747989, "question_id": 28917530, "link": "https://stackoverflow.com/questions/28917530/golang-how-to-create-loop-function-using-html-template-package", "title": "Golang. How to create loop function using html/template package", "body": "<p>I'm trying to implement loop as custom function. It takes number of iterations and content between curly brackets, then it should iterate content between brackets n times. Please, see example:</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>template.Must(template.ParseFiles(\"palette.html\")).Funcs(template.FuncMap{\n        \"loop\": func(n int, content string) string {\n            var r string\n            for i := 0; i &lt;= n; i++ {\n                r += content\n            }\n            return r\n        },\n    }).ExecuteTemplate(rw, index, nil)\n</code></pre>\n\n<p><strong>index.html</strong></p>\n\n<pre><code>{{define \"index\"}}\n&lt;div class=\"row -flex palette\"&gt;\n  {{loop 16}}\n    &lt;div class=\"col-2\"&gt;&lt;/div&gt;\n  {{end}}\n&lt;/div&gt;\n{{end}}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>&lt;div class=\"row -flex palette\"&gt;\n    &lt;div class=\"col-2\"&gt;&lt;/div&gt;\n    &lt;div class=\"col-2\"&gt;&lt;/div&gt;\n    &lt;div class=\"col-2\"&gt;&lt;/div&gt;\n    &lt;div class=\"col-2\"&gt;&lt;/div&gt;\n    ... 16 times\n&lt;/div&gt;\n</code></pre>\n\n<p>Is it possible to implement it? The motivation is that standard functionality of the <code>text/template</code> doesn't allow just to iterate content between curly bracket. Yes we can do it by <code>range</code> action going through \"outside\" data.</p>\n"}, {"tags": ["unit-testing", "google-app-engine", "go", "google-cloud-endpoints"], "answers": [{"tags": [], "owner": {"reputation": 2450, "user_id": 568473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f38aa26611cbac7ed1157b84d5b9a6b?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/568473/alex"}, "is_accepted": true, "score": 2, "last_activity_date": 1425731277, "creation_date": 1425731277, "answer_id": 28914881, "question_id": 28911212, "link": "https://stackoverflow.com/questions/28911212/use-aetest-newcontext-in-place-of-endpoints-newcontext-for-testing-go-endpoints/28914881#28914881", "title": "use aetest.NewContext in place of endpoints.NewContext for testing go-endpoints with strong consistency", "body": "<p>How about this:</p>\n\n<pre><code>inst := aetest.NewInstance(&amp;aetest.Options{StronglyConsistentDatastore: true})\nr, _ := inst.NewRequest(\"GET\", \"/\", nil)\nc := endpoints.NewContext(r)\n\nsa.Search(c, ...)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1425766034, "creation_date": 1425766034, "answer_id": 28920583, "question_id": 28911212, "link": "https://stackoverflow.com/questions/28911212/use-aetest-newcontext-in-place-of-endpoints-newcontext-for-testing-go-endpoints/28920583#28920583", "title": "use aetest.NewContext in place of endpoints.NewContext for testing go-endpoints with strong consistency", "body": "<p>as per what alex said I have the following solution:</p>\n\n<pre><code>func TestApi(t *testing.T) {\n    inst, _ := aetest.NewInstance(&amp;aetest.Options{StronglyConsistentDatastore: true})\n    defer inst.Close()\n    r, _ := inst.NewRequest(\"GET\", \"/\", nil)\n    c := endpoints.NewContext(r)\n    makeCourses(c)\n    api := SearchApi{}\n    searchQuery := &amp;SearchQuery{\"my-search-term\", nil}\n    searchResults, _ := api.Search(c, searchQuery)\n    log.Println(\"got results %v\", searchResults)\n}\n</code></pre>\n"}], "owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 28914881, "answer_count": 2, "score": 0, "last_activity_date": 1425766034, "creation_date": 1425700729, "question_id": 28911212, "link": "https://stackoverflow.com/questions/28911212/use-aetest-newcontext-in-place-of-endpoints-newcontext-for-testing-go-endpoints", "title": "use aetest.NewContext in place of endpoints.NewContext for testing go-endpoints with strong consistency", "body": "<p>I have a search method:</p>\n\n<pre><code>func (sa *SearchApi) Search(c endpoints.Context, r *SearchQuery) (*SearchResults, error) { .. }\n</code></pre>\n\n<p>as you can see it takes an endpoints.Context e.g:</p>\n\n<pre><code>ctx := endpoints.NewContext(req1)\n</code></pre>\n\n<p>however with aetest, i'm using different context:</p>\n\n<pre><code>otherCtx, err := aetest.NewContext(&amp;aetest.Options{\"\", true})\n</code></pre>\n\n<p>Particularly this context has extra options for strong consistency - since i'm setting up data so I can test a read only api.</p>\n\n<p>I can't pass the otherCxt through to my Search method because it's not an endpoints.Context </p>\n\n<p>otherCtx:</p>\n\n<pre><code>type Context interface {\n    appengine.Context\n\n    // Login causes the context to act as the given user.\n    Login(*user.User)\n    // Logout causes the context to act as a logged-out user.\n    Logout()\n    // Close kills the child api_server.py process,\n    // releasing its resources.\n    io.Closer\n}\n</code></pre>\n\n<p>endpoints.Context:</p>\n\n<pre><code>type Context interface {\n    appengine.Context\n\n    // HTTPRequest returns the request associated with this context.\n    HTTPRequest() *http.Request\n\n    // Namespace returns a replacement context that operates within the given namespace.\n    Namespace(name string) (Context, error)\n\n    // CurrentOAuthClientID returns a clientID associated with the scope.\n    CurrentOAuthClientID(scope string) (string, error)\n\n    // CurrentOAuthUser returns a user of this request for the given scope.\n    // It caches OAuth info at the first call for future invocations.\n    //\n    // Returns an error if data for this scope is not available.\n    CurrentOAuthUser(scope string) (*user.User, error)\n}\n</code></pre>\n\n<p>what's the recommend approach for testing go-endpoints with aetest? Is it possible to just transform the aetest context into the endpoints context?</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "edited": false, "score": 0, "creation_date": 1425688509, "post_id": 28909404, "comment_id": 46079041, "body": "As far as 1 is concerned, it likely uses <a href=\"http://godoc.org/runtime#Caller\" rel=\"nofollow noreferrer\">runtime.Caller</a> for this purpose. Supply a different number for <code>skip</code> to go up some levels. I am not sure you can tell <code>test.XXX</code> to do this without changing the test package code."}], "answers": [{"comments": [{"owner": {"reputation": 64568, "user_id": 399317, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/28235d26ee007743c9d2150759d29139?s=128&d=identicon&r=PG", "display_name": "Kos", "link": "https://stackoverflow.com/users/399317/kos"}, "edited": false, "score": 0, "creation_date": 1425807428, "post_id": 28910201, "comment_id": 46106425, "body": "Wow, thanks. And for testing stateful async code, is there a more idiomatic approach than &quot;put something in one channel, assert there&#39;s something at another channel, repeat&quot;? Any examples I can refer to? I don&#39;t think I can write that table-driven."}, {"owner": {"reputation": 180, "user_id": 1600389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb480c10dca965f39897e209a5bbb6fa?s=128&d=identicon&r=PG", "display_name": "stub", "link": "https://stackoverflow.com/users/1600389/stub"}, "edited": false, "score": 0, "creation_date": 1502194092, "post_id": 28910201, "comment_id": 78094840, "body": "Alas, more complex test helpers (not assertions) are useful and need to adjust the call level for exactly the reasons documented in that FAQ entry - if they perform multiple checks, they should be able to add multiple failures. The magic to add the call site is unfortunately buried in an unexported helper (the decorate method), so adding this feature requires a fair chunk of duplication or an alternative testing library. As an example, you may want to repeat the same series of tests on several objects implementing an interface"}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 12, "last_activity_date": 1479919121, "last_edit_date": 1479919121, "creation_date": 1425690052, "answer_id": 28910201, "question_id": 28909404, "link": "https://stackoverflow.com/questions/28909404/how-to-fix-line-numbers-in-go-test-output/28910201#28910201", "title": "How to fix line numbers in Go test output?", "body": "<p>You <em>can</em> do what you're asking, and you can find out how <code>t.Error</code> works by <a href=\"https://golang.org/src/testing/testing.go?s=17291:17427#L474\" rel=\"nofollow noreferrer\">looking at the source code</a>. The function <a href=\"https://golang.org/src/testing/testing.go?s=11236:11498#L282\" rel=\"nofollow noreferrer\"><code>decorate</code></a> is what you're looking for I think.</p>\n\n<p>But, in the case where you have significant amounts of checking code, and for some reason it's getting duplicated in your test, it's better to extract that as a function that returns an error than passing in a testing.T and making it an \"assertion\". Indeed, writing assertion functions is explicitly discouraged in the language <a href=\"http://golang.org/doc/faq#testing_framework\" rel=\"nofollow noreferrer\">FAQ</a>.</p>\n\n<pre><code>package hello\n\nimport \"testing\"\n\nfunc TestFoo(t *testing.T) {\n    if err := checkSomething(2+2 == 4); err != nil {\n        t.Errorf(\"2+2=4 failed: %s\", err)\n    }\n    if err := checkSomething(2+3 == 6); err != nil {\n        t.Errorf(\"2+3=6 failed: %s\", err)\n    }\n}\n\nfunc checkSomething(v bool) error {\n    if !v {\n        return errors.New(\"something's not right\")\n    }\n    return nil\n}\n</code></pre>\n\n<p>But here's what I think idiomatic testing code would look like. It's table-driven, and the cases include inputs and expected output, leading to really clear error messages when the tests fail.</p>\n\n<pre><code>package hello\n\nimport \"testing\"\n\nfunc TestFoo(t *testing.T) {\n    cases := []struct {\n        a, b, want int\n    }{\n        {2, 2, 4},\n        {2, 3, 6},\n    }\n    for _, c := range cases {\n        if got := operation(c.a, c.b); got != c.want {\n            t.Errorf(\"operation(%d, %d) = %d, want %d\", c.a, c.b, got, c.want)\n        }\n    }\n}\n\nfunc operation(a, b int) int {\n    return a + b\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9649, "user_id": 1052261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4961b82d779d8b8119c69524f1a324cc?s=128&d=identicon&r=PG", "display_name": "Dawid Drozd", "link": "https://stackoverflow.com/users/1052261/dawid-drozd"}, "edited": false, "score": 0, "creation_date": 1542192357, "post_id": 49444845, "comment_id": 93477486, "body": "Very very nice! Thanks for info. Also not such bad design from Go side :P"}], "tags": [], "owner": {"reputation": 581, "user_id": 263833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27e6706d50712f73b7c8b2a85e7317f?s=128&d=identicon&r=PG", "display_name": "roolebo", "link": "https://stackoverflow.com/users/263833/roolebo"}, "is_accepted": true, "score": 11, "last_activity_date": 1551083908, "last_edit_date": 1551083908, "creation_date": 1521791783, "answer_id": 49444845, "question_id": 28909404, "link": "https://stackoverflow.com/questions/28909404/how-to-fix-line-numbers-in-go-test-output/49444845#49444845", "title": "How to fix line numbers in Go test output?", "body": "<p>Things have <a href=\"https://github.com/golang/proposal/blob/master/design/4899-testing-helper.md\" rel=\"nofollow noreferrer\">changed</a> since go 1.9. </p>\n\n<p><code>Helper()</code> method has been added to <code>testing.T</code> and <code>testing.B</code>. It's intended to be invoked from testing helpers such as <code>assertSomething</code> to indicate the function is a helper and we're not interested in line numbers coming from it.</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc TestFoo(t *testing.T) {\n    assertSomething(t, 2+2 == 4) // line 6\n    assertSomething(t, 2+3 == 6) // line 7\n}\n\nfunc assertSomething(t *testing.T, expected bool) {\n    if !expected {\n        t.Helper()\n        t.Error(\"Something's not right\") // line 12\n    }\n}\n</code></pre>\n\n<p>The output contains correct line numbers:</p>\n\n<pre><code>=== RUN   TestFoo\n--- FAIL: TestFoo (0.00s)\n    main.go:7: Something's not right\nFAIL\n</code></pre>\n\n<p>You can also <a href=\"https://play.golang.org/p/gV3JPikcO-S\" rel=\"nofollow noreferrer\">try it</a> on Go Playground.</p>\n"}], "owner": {"reputation": 64568, "user_id": 399317, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/28235d26ee007743c9d2150759d29139?s=128&d=identicon&r=PG", "display_name": "Kos", "link": "https://stackoverflow.com/users/399317/kos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1672, "favorite_count": 1, "accepted_answer_id": 49444845, "answer_count": 2, "score": 11, "last_activity_date": 1551083908, "creation_date": 1425684601, "question_id": 28909404, "link": "https://stackoverflow.com/questions/28909404/how-to-fix-line-numbers-in-go-test-output", "title": "How to fix line numbers in Go test output?", "body": "<p>Let's consider this simple testing code.</p>\n\n<p><em>(Note: <code>assertSomething</code> is super simple here, but normally I'd write a more specialised helper for the task at hand that would look at multiple things and could report more than one type of error.)</em></p>\n\n<pre><code>package hello\n\nimport \"testing\"\n\nfunc TestFoo(t *testing.T) {\n    assertSomething(t, 2+2 == 4) // line 6\n    assertSomething(t, 2+3 == 6) // line 7\n}\n\nfunc assertSomething(t *testing.T, expected bool) {\n    if !expected {\n        t.Error(\"Something's not right\") // line 12\n    }\n}\n</code></pre>\n\n<p>When I run <code>go test</code>, I get the following:</p>\n\n<pre><code>--- FAIL: TestFoo (0.00s)\n    hello.go:12: Something's not right\nFAIL\nexit status 1\nFAIL    kos/hello   0.008s\n</code></pre>\n\n<p>I have two questions:</p>\n\n<p>1) The error points to line 12 - why? How does <code>t.Error</code> find out which line it was called from?</p>\n\n<p>2) In the helper, I'd like to specify that <code>t.Error</code> should look stack level higher to determine the line number to print, so that I would get a message like this:</p>\n\n<pre><code>--- FAIL: TestFoo (0.00s)\n    hello.go:7: Something's not right\n</code></pre>\n\n<p>Python allows me to do this, for instance, in <a href=\"https://docs.python.org/2/library/warnings.html#warnings.warn\" rel=\"noreferrer\"><code>warnings.warn(\"message\", stacklevel=2)</code></a> - how would I implement the equivalent here?</p>\n"}, {"tags": ["go", "thrift"], "comments": [{"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1425677376, "post_id": 28907976, "comment_id": 46075260, "body": "Which version of the Go plugin are you using?"}, {"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 0, "creation_date": 1425677413, "post_id": 28907976, "comment_id": 46075282, "body": "What is the type of p.X?"}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1425677425, "post_id": 28907976, "comment_id": 46075287, "body": "Alpha 164.  It also happens on the command line"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1425677797, "post_id": 28907976, "comment_id": 46075466, "body": "Can you add Bar struct definition?"}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1425677860, "post_id": 28907976, "comment_id": 46075493, "body": "Odd.  NewFoo() is returning a <code>*Foo</code> but is being stored in <code>Bar.X</code>.  <code>Bar.X</code> is a <code>Foo</code> NOT a `*Foo. This is particularly strange, as this is generated code."}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1425678133, "post_id": 28907976, "comment_id": 46075613, "body": "Note, that if I modify the code (which isn&#39;t a viable solution) to be <code>(&amp;(p.X)).Read(iprot)</code> I get an error saying <code>(&amp;p.X).Read undefined (type *Foo has no field or method Read</code> (which it does)"}, {"owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "edited": false, "score": 1, "creation_date": 1425679363, "post_id": 28907976, "comment_id": 46076179, "body": "How exactly is this an IntelliJ-related issue?  Both it and the command line are giving you the same errors, right?"}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1425679985, "post_id": 28907976, "comment_id": 46076451, "body": "It&#39;s not an intelliJ related issue.  I merely mention IntellJ because it is smart enough to find the method that Go says doesn&#39;t exist"}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1425680069, "post_id": 28907976, "comment_id": 46076492, "body": "I figured out the <code>NewFoo</code> part of the mystery.  Thrift creates an alias <code>type Foo *D.Foo</code> in the <code>ttypes.go</code> file"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1425717354, "post_id": 28907976, "comment_id": 46084267, "body": "<code>type</code> in Go doesn&#39;t declare an alias like <code>typedef</code> does in C; instead, it&#39;s a new type that doesn&#39;t carry the methods of the old. If you have two types named Foo, maybe only one has that <code>Read</code>."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1425717445, "post_id": 28907976, "comment_id": 46084293, "body": "&#39;Nother thing I thought of, before reading your last comment, was that maybe the plugin and Go compiler are looking in different paths--not familiar with the plugin, so not sure exactly how you check that."}, {"owner": {"reputation": 12067, "user_id": 499466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc0612ec9a2b6af96500cc6e4bfdc7c?s=128&d=identicon&r=PG", "display_name": "JensG", "link": "https://stackoverflow.com/users/499466/jensg"}, "edited": false, "score": 0, "creation_date": 1425723369, "post_id": 28907976, "comment_id": 46085698, "body": "It would help if we had the IDL code you talk about. There has been a lot of work on the Go support both in 0.9.2 and in current dev trunk. Make sure  you use one of the more recent versions, and more important, make sure compiler and library version do match. The namespace prefixes can be adjusted to some extent, type <code>thrift --help</code> to get all the options available."}, {"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1425742852, "post_id": 28907976, "comment_id": 46091046, "body": "It was generated with 0.9.1.  Let me try 0.9.2 and see if that fixes it."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1425772419, "post_id": 28907976, "comment_id": 46100199, "body": "Type <code>*D.Foo</code> may not be the same as <code>*Foo</code>. The receiver of <code>Read()</code> is <code>*Foo</code>, which means only an instance of <code>*Foo</code> or <code>*Bar</code> (that has <code>Foo</code> embedded) can call the method."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 1, "last_activity_date": 1425777551, "last_edit_date": 1425777551, "creation_date": 1425776951, "answer_id": 28921982, "question_id": 28907976, "link": "https://stackoverflow.com/questions/28907976/type-has-not-field-or-method-read-but-it-does/28921982#28921982", "title": "Type has not field or method Read (but it does)", "body": "<p>Please do not vote down, but I want to express a simple code to reproduce what you might have encountered. (I have no experience with Thrift, but I think it has more to do with packages)</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"D\"\n)\n\ntype Foo struct {}\n\nfunc (f *Foo) PrintIt() {\n    fmt.Println(\"Sample printing\")\n}\n\ntype Bar struct {\n    // For the sake of this experiment\n    X *D.Foo\n}\n\nfunc (b *Bar) PrintFromBar() {\n    // simulates b.x = D.NewFoo()\n    b.X = new(D.Foo) \n    b.X.PrintIt()   // The culprit happens here\n}\n\nfunc main() {\n    b := new(Bar)\n    b.PrintFromBar()\n}\n</code></pre>\n\n<p>The D package:</p>\n\n<pre><code>package D\n\ntype Foo struct {}\n</code></pre>\n\n<p><code>b.PrintFromBar()</code> fails with \"b.X.PrintIt undefined (type *D.Foo has no field or method PrintIt).</p>\n\n<p>The problem might lies in <code>D.NewFoo()</code> creating an alias named <code>Foo</code> for <code>*D.Foo</code>. In your case since your <code>Read()</code> method is already inside the D package, I have no idea without the full code. However, it's interesting that this actually produce the same error.</p>\n"}, {"comments": [{"owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "edited": false, "score": 0, "creation_date": 1425836156, "post_id": 28922101, "comment_id": 46115106, "body": "This is a fairly accurate summation of the problem, however, I can&#39;t simply add the typecasting because the code in error is generated by Thrift."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 8, "last_activity_date": 1425778335, "last_edit_date": 1425778335, "creation_date": 1425778000, "answer_id": 28922101, "question_id": 28907976, "link": "https://stackoverflow.com/questions/28907976/type-has-not-field-or-method-read-but-it-does/28922101#28922101", "title": "Type has not field or method Read (but it does)", "body": "<p>Here's a minimal reproduction of what you're seeing.</p>\n\n<pre><code>package main\n\ntype A struct{}\n\ntype B *A\n\nfunc (a *A) Read() {}\n\nfunc main() {\n    var b B\n    b.Read()\n}\n</code></pre>\n\n<p>Compiling produces this error message:</p>\n\n<pre><code>prog.go:11: b.Read undefined (type B has no field or method Read)\n</code></pre>\n\n<p>The problem is that thrift is defining it's own <code>Foo</code> which is <code>*D.Foo</code>, and that's the type of <code>b.X</code>. The <code>D.Foo</code> type is represented by <code>A</code> in my code, and the <code>Foo</code> type that thrift introduces is represented by <code>B</code>. Although <code>*D.Foo</code> has a <code>Read()</code> method, the <code>Foo</code> alias doesn't. That's why you're seeing the error message. The error message is confusing in your case because <code>Foo</code> is ambiguously referring to <code>D.Foo</code> or the thrift alias in the text of the error &mdash; the compiler means one of them, and you're interpreting it to mean the other.</p>\n\n<p>You can work through the alias by converting the value to the right type by writing <code>(*D.Foo)(b.X).Read()</code> or in the reproduction case:</p>\n\n<pre><code>package main\n\ntype A struct{}\n\ntype B *A\n\nfunc (a *A) Read() {}\n\nfunc main() {\n    var b B\n    (*A)(b).Read()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "is_accepted": true, "score": 1, "last_activity_date": 1425926352, "last_edit_date": 1425926352, "creation_date": 1425925192, "answer_id": 28949091, "question_id": 28907976, "link": "https://stackoverflow.com/questions/28907976/type-has-not-field-or-method-read-but-it-does/28949091#28949091", "title": "Type has not field or method Read (but it does)", "body": "<p>As @Anyonymous points out, this is a problem with thrift aliasing and using the wrong one.  I consider this a bug in the Thrift compiler (in 0.9.2 and current HEAD) in that it will generate code that will never work. We haven't run into this problem with other languages, just go.  Here is a simplification to reproduce the problem:</p>\n\n<pre><code>// Base.thrift\nnamespace go a.X.c\nstruct Foo {\n    1: required string s\n}\n</code></pre>\n\n<p>and the depenant file</p>\n\n<pre><code>// Child.thrift\nnamespace go a.Y.c\ninclude \"Base.thrift\"\n\ntypedef Base.Foo Foo // &lt;---- This is what causes the problem\n\nstruct Bar {\n    1:Foo f  // &lt;-- Will error\n    // 1:Base.Foo f   Need to comment out typedef and use this instead\n}\n</code></pre>\n\n<p>Compiling the thrift as is will be fine, but when you go to install the <code>a.Y.c</code> package will produce:</p>\n\n<pre><code>/scratch/go/src/a/Y/c/ttypes.go:78: cannot use c.Foo literal (type *c.Foo) as type *Foo in assignment\n/scratch/go/src/a/Y/c/ttypes.go:79: p.F.Read undefined (type *Foo has no field or method Read)\n/scratch/go/src/a/Y/c/ttypes.go:105: p.F.Write undefined (type *Foo has no field or method Write)\n</code></pre>\n\n<p>If I comment out the typedef and swap the lines in <code>Bar</code> then everything works fine.  This appears to only happen in Go.</p>\n"}], "owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15042, "favorite_count": 0, "accepted_answer_id": 28949091, "answer_count": 3, "score": 9, "last_activity_date": 1425926352, "creation_date": 1425677271, "last_edit_date": 1425680173, "question_id": 28907976, "link": "https://stackoverflow.com/questions/28907976/type-has-not-field-or-method-read-but-it-does", "title": "Type has not field or method Read (but it does)", "body": "<p>I'm stumped on this one.  In the project that I'm working on, we generate go code from Thrift.  The code gets created in the package A/B/thriftapi (which used to be A/B/thrift which was causing problems because all of the generated code was importing <code>git.apache.org/thrift.git/lib/go/thrift</code> and causing name collisions).  </p>\n\n<p>I generated the code and moved the code into <code>$GOPATH/src/A/B/D</code>  I then tried to build my project and was getting tons of errors of the form:</p>\n\n<pre><code>p.X.Read undefined (type Foo has no field or method Read)\n</code></pre>\n\n<p>I looked at one of the offending lines:</p>\n\n<pre><code>import (\n    \"A/B/D\"\n    \"git.apache.org/thrift.git/lib/go/thrift\"\n)\n\nfunc(p *Bar) readField1(iprot thrift.TProtocol) error {\n    p.X = D.NewFoo()\n    if err := p.X.Read(iprot); err != nil { \n    ...\n }\n</code></pre>\n\n<p>Since I am using IntelliJ, I CTRL+clicked on the <code>Read()</code> method and sure enough it jumps to <code>$GOPATH/A/B/D/ttypes.go</code> to the method</p>\n\n<pre><code>func (p *Foo) Read(iprot thrift.TProtocol) error {\n    ...\n}\n</code></pre>\n\n<p>That's exactly the file I'd expect the method to be in, and it's a method on a pointer to <code>Foo</code> so no problems there.  Everything seems like it should be right, but both in IntelliJ and on the command line I get these problems.  </p>\n\n<p>Any ideas what might be going wrong?  It's frustrating when it tells me the method doesn't exist, yet will take me right to it if I click on it (and also pops up in the intellisense) </p>\n\n<p>EDIT - Per comment</p>\n\n<pre><code>type Bar struct {\n   X Foo `thrift:\"x,1,required\"`    \n}\n</code></pre>\n"}, {"tags": ["sockets", "go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1425673288, "post_id": 28903420, "comment_id": 46073394, "body": "Check the errors and see if they say anything first. If you have and there are no errors, just update your code sample to reflect it--folks are more likely to answer if you do."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1425673706, "post_id": 28903420, "comment_id": 46073600, "body": "Just from searching around, <a href=\"http://stackoverflow.com/questions/18427655/use-raw-sockets-in-go\">I don&#39;t think Go actually does raw sockets natively</a>. For slightly-lower-level-than-normal network access, there is <a href=\"http://stackoverflow.com/questions/21320305/raw-socket-sniffing-in-golang\"><code>ipv4</code></a> (and an equivalent <code>ipv6</code>). There are, apparently, efforts to <a href=\"http://godoc.org/code.google.com/p/gopacket\" rel=\"nofollow noreferrer\">use pcap with Go</a> (via the last answer to the previous question). Not an expert in this area, just searching around for stuff that might help you."}, {"owner": {"reputation": 2354, "user_id": 3973051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/594835486/picture?type=large", "display_name": "Jonathan Eustace", "link": "https://stackoverflow.com/users/3973051/jonathan-eustace"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1425677105, "post_id": 28903420, "comment_id": 46075154, "body": "Thank you, I just did that. :)"}, {"owner": {"reputation": 2354, "user_id": 3973051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/594835486/picture?type=large", "display_name": "Jonathan Eustace", "link": "https://stackoverflow.com/users/3973051/jonathan-eustace"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1425741135, "post_id": 28903420, "comment_id": 46090545, "body": "It seems that the exact same code does what I want it to running on Fedora 21. But on OSX it doesn&#39;t output anything that is UDP or TCP."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 887116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a204338b100e0ed0f9c05b58eafefe?s=128&d=identicon&r=PG", "display_name": "liudanking", "link": "https://stackoverflow.com/users/887116/liudanking"}, "edited": false, "score": 1, "creation_date": 1463325648, "post_id": 29083319, "comment_id": 62009063, "body": "I agree. Just add a reference: <a href=\"http://www.darkcoding.net/software/raw-sockets-in-go-link-layer/\" rel=\"nofollow noreferrer\">darkcoding.net/software/raw-sockets-in-go-link-layer</a> <code>If you have UNIX Network Programmings by Richard Stevens, you might be as confused as I was by section 28.4 which claims \u201creceived TCP packets are never passed to a raw socket.\u201d That\u2019s clearly not true. It\u2019s a historic note related to BSD. man 7 raw says \u201cRaw sockets may tap all IP protocols in Linux, even protocols like ICMP or TCP\u201d but \u201cThis should not be relied upon in portable programs\u201d</code>"}], "tags": [], "owner": {"reputation": 2354, "user_id": 3973051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/594835486/picture?type=large", "display_name": "Jonathan Eustace", "link": "https://stackoverflow.com/users/3973051/jonathan-eustace"}, "is_accepted": true, "score": 1, "last_activity_date": 1426527204, "creation_date": 1426527204, "answer_id": 29083319, "question_id": 28903420, "link": "https://stackoverflow.com/questions/28903420/reading-tcp-packets-via-raw-sockets-in-go/29083319#29083319", "title": "Reading TCP packets via raw sockets in GO", "body": "<p>The problem with this is that OS X is based on BSD, and BSD doesn't allow you to program raw sockets at the TCP level. You have to use go down to the Ethernet level in order to do so. </p>\n\n<p>I'm using the pcap library with gopackets to do the job. </p>\n\n<p><a href=\"https://godoc.org/code.google.com/p/gopacket/pcap\" rel=\"nofollow\">https://godoc.org/code.google.com/p/gopacket/pcap</a></p>\n"}], "owner": {"reputation": 2354, "user_id": 3973051, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/594835486/picture?type=large", "display_name": "Jonathan Eustace", "link": "https://stackoverflow.com/users/3973051/jonathan-eustace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2697, "favorite_count": 1, "accepted_answer_id": 29083319, "answer_count": 1, "score": 3, "last_activity_date": 1426527204, "creation_date": 1425660077, "last_edit_date": 1425677067, "question_id": 28903420, "link": "https://stackoverflow.com/questions/28903420/reading-tcp-packets-via-raw-sockets-in-go", "title": "Reading TCP packets via raw sockets in GO", "body": "<p>I'm researching raw sockets in GO. I would like to be able to read all TCP packets going to my computer (OSX, en0: 192.168.1.65)</p>\n\n<p>If I switch the protocol from tcp to icmp, I will get packets. Why do I have no packets being read with my code?</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"net\"\n)\n\nfunc main() {\n\n    netaddr, err := net.ResolveIPAddr(\"ip4\", \"192.168.1.65\")\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    conn, err := net.ListenIP(\"ip4:tcp\", netaddr)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    buf := make([]byte, 2048)\n    for {\n        numRead, recvAddr, err := conn.ReadFrom(buf)\n        if err != nil {\n            fmt.Println(err)\n        }\n        if recvAddr != nil {\n            fmt.Println(recvAddr)\n        }\n        s := string(buf[:numRead])\n        fmt.Println(s)\n    }\n}\n</code></pre>\n"}, {"tags": ["http", "go", "benchmarking", "revel"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1425658447, "post_id": 28902488, "comment_id": 46065155, "body": "Is your dev environment served from localhost?"}, {"owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "edited": false, "score": 0, "creation_date": 1425717157, "post_id": 28902488, "comment_id": 46084222, "body": "What is the method which you use to measure? Is there any webserver running along with the revel?"}, {"owner": {"reputation": 1, "user_id": 4641547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ccb0e47edc8cbd8f8324231b66d3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Domingues", "link": "https://stackoverflow.com/users/4641547/michael-domingues"}, "edited": false, "score": 0, "creation_date": 1425738024, "post_id": 28902488, "comment_id": 46089716, "body": "Both environments are served from localhost, with the purpose of testing. To measure I&#39;m using apache benchmark (CLI). The configurations are the same. What changes is the run mode.."}, {"owner": {"reputation": 593, "user_id": 3380763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8083eb4cd5c69b1b1e9305bf2495d76?s=128&d=identicon&r=PG", "display_name": "yograterol", "link": "https://stackoverflow.com/users/3380763/yograterol"}, "edited": false, "score": 0, "creation_date": 1425841701, "post_id": 28902488, "comment_id": 46117006, "body": "Can you paste your app.conf?"}, {"owner": {"reputation": 1, "user_id": 4641547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ccb0e47edc8cbd8f8324231b66d3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Domingues", "link": "https://stackoverflow.com/users/4641547/michael-domingues"}, "edited": false, "score": 0, "creation_date": 1425904135, "post_id": 28902488, "comment_id": 46138353, "body": "Here is the conf: <a href=\"http://www.codeshare.io/Oy5ip\" rel=\"nofollow noreferrer\">codeshare.io/Oy5ip</a>"}], "owner": {"reputation": 1, "user_id": 4641547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ccb0e47edc8cbd8f8324231b66d3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Domingues", "link": "https://stackoverflow.com/users/4641547/michael-domingues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1425657174, "creation_date": 1425657174, "question_id": 28902488, "link": "https://stackoverflow.com/questions/28902488/revel-framework-benchmarking-http-request-dev-vs-prod", "title": "Revel framework benchmarking http request dev vs prod", "body": "<p>I've deployed a web framework in Revel and in the last couple of times I've been benchmarking my development and production app and noticed a considerable difference of time for the same request.\nMy configs for both are the most simple possible, with the DB configuration as the only one I did.\nFor example, in dev mode I got for a request (worst case) ~40ms and in prod mode (worst case also) ~90ms.\nHow is that possible ?\nDoes revel, in prod mode, handles http requests differently ?</p>\n\n<p>Many thanks for your help</p>\n"}, {"tags": ["go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1425908983, "post_id": 28902682, "comment_id": 46141288, "body": "I deleted the implemented interface and when I run the application, I&#39;ve got not what I want. <code>&amp;{ObjectIdHex(&quot;54f9ba7d5042ea0af0000001&quot;) map[logged:map[name:Cormier email:cormier@example.com]]}</code>. I expect here by map[logged] not a map as result, but athen based type. How can I do that?"}, {"owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1425919636, "post_id": 28902682, "comment_id": 46148735, "body": "There are multiple ways to do that, but this is unrelated to the original question, and this comment box is not a reasonable place to explain it."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1425929589, "post_id": 28902682, "comment_id": 46154383, "body": "ok, thanks I will open a new question about it. Thanks gustavo."}], "tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": true, "score": 4, "last_activity_date": 1425657731, "creation_date": 1425657731, "answer_id": 28902682, "question_id": 28901604, "link": "https://stackoverflow.com/questions/28901604/mongodb-got-stack-overflow-by-unmarshal/28902682#28902682", "title": "Mongodb got stack overflow by unmarshal", "body": "<p>This logic introduces an infinite recursion:</p>\n\n<pre><code>func (rcv *Session) SetBSON(raw bson.Raw) error {\n    return raw.Unmarshal(rcv)\n}\n</code></pre>\n\n<p><code>Session</code> implements the <a href=\"http://gopkg.in/mgo.v2/bson#Setter\" rel=\"nofollow\">Setter</a> interface, which means its unmarshaling happens via its <code>SetBSON</code> method, which is implemented by asking the <code>bson</code> package to unmarshal itself, which will do that by calling its <code>SetBSON</code> method. This never ends, until the stack space is over.</p>\n\n<p>The solution is, of course, to not implement custom unmarshaling of <code>Session</code> by just asking the <code>bson</code> package to unmarshal it again. </p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 28902682, "answer_count": 1, "score": 1, "last_activity_date": 1425657731, "creation_date": 1425654362, "last_edit_date": 1425654812, "question_id": 28901604, "link": "https://stackoverflow.com/questions/28901604/mongodb-got-stack-overflow-by-unmarshal", "title": "Mongodb got stack overflow by unmarshal", "body": "<p>I want to use mongodb in golang and wrote an sample application:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"labix.org/v2/mgo\"\n    \"labix.org/v2/mgo/bson\"\n    \"os\"\n)\n\ntype Session struct {\n    Id   bson.ObjectId          `bson:\"_id\"`\n    Data map[string]interface{} `bson:\"data\"`\n}\n\nfunc (rcv *Session) SetBSON(raw bson.Raw) error {\n    return raw.Unmarshal(rcv)\n}\n\n\ntype Authen struct {\n    Name  string `bson:\"name\"`\n    Email string `bson:\"email\"`\n}\n\nfunc main() {\n    uri := \"mongodb://localhost/\"\n    if uri == \"\" {\n        fmt.Println(\"no connection string provided\")\n        os.Exit(1)\n    }\n\n    sess, err := mgo.Dial(uri)\n    if err != nil {\n        fmt.Printf(\"Can't connect to mongo, go error %v\\n\", err)\n        os.Exit(1)\n    }\n    defer sess.Close()\n\n    sess.SetSafe(&amp;mgo.Safe{})\n    collection := sess.DB(\"test\").C(\"sess\")\n\n    a := &amp;Authen{Name: \"Cormier\", Email: \"cormier@example.com\"}\n    s := &amp;Session{}\n    s.Id = bson.NewObjectId()\n    s.Data = make(map[string]interface{})\n    s.Data[\"logged\"] = a\n\n    err = collection.Insert(s)\n    if err != nil {\n        fmt.Printf(\"Can't insert document: %v\\n\", err)\n        os.Exit(1)\n    }\n\n    c := &amp;Session{}\n    c.Id = bson.NewObjectId()\n    c.Data = make(map[string]interface{})\n\n    err = sess.DB(\"test\").C(\"sess\").Find(bson.M{}).One(c)\n    if err != nil {\n        fmt.Printf(\"got an error finding a doc %v\\n\")\n        os.Exit(1)\n    }\n\n}\n</code></pre>\n\n<p>Insert into mongodb works like a charm, but to unmarshal back to reference I've got following panic:</p>\n\n<pre><code>runtime: goroutine stack exceeds 1000000000-byte limit\nfatal error: stack overflow\n\nruntime stack:\nruntime.throw(0x6d84d9)\n        c:/go/src/runtime/panic.go:491 +0xad\nruntime.newstack()\n        c:/go/src/runtime/stack.c:784 +0x5ef\nruntime.morestack()\n        c:/go/src/runtime/asm_amd64.s:324 +0x86\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["go", "preprocessor", "gtk3", "gtk2"], "answers": [{"comments": [{"owner": {"reputation": 4036, "user_id": 667457, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/33f9a9233b25c8230f5b5edb38493842?s=128&d=identicon&r=PG", "display_name": "Jeff Burdges", "link": "https://stackoverflow.com/users/667457/jeff-burdges"}, "edited": false, "score": 0, "creation_date": 1425903491, "post_id": 28912109, "comment_id": 46137956, "body": "No.  Build tags do not suffice because the <code>cgo pkg-config</code> lines must appear in <i>every</i> file.  You can use build tags together with a preprocessor like cpp or perl, like I described in the question."}, {"owner": {"reputation": 4036, "user_id": 667457, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/33f9a9233b25c8230f5b5edb38493842?s=128&d=identicon&r=PG", "display_name": "Jeff Burdges", "link": "https://stackoverflow.com/users/667457/jeff-burdges"}, "edited": false, "score": 0, "creation_date": 1425903604, "post_id": 28912109, "comment_id": 46138032, "body": "Yes, I&#39;d agree about gtk3 being the default of course, not sure why anyone even bothers building support for gtk2 at this point, maybe it&#39;s a smaller footprint or something."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1425709837, "creation_date": 1425709837, "answer_id": 28912109, "question_id": 28901292, "link": "https://stackoverflow.com/questions/28901292/build-go-bindings-for-multiple-library-versions/28912109#28912109", "title": "Build Go bindings for multiple library versions?", "body": "<p>You can use <a href=\"http://golang.org/pkg/go/build/\" rel=\"nofollow\">build constrain</a> aka tags to achieve that.</p>\n\n<p>First you have to split the files that use gtk2 and gtk3, then assuming you want gtk3 to be the default (I'll frown if you make gtk2 the default):</p>\n\n<p>gtk3.go:</p>\n\n<pre><code>// +build !gtk2\n\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"gtk3\")\n}\n</code></pre>\n\n<p>gtk2.go:</p>\n\n<pre><code>// +build gtk2\n\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"gtk2\")\n}\n</code></pre>\n\n<p>Then to test it:</p>\n\n<pre><code>$ go build; and ./constrains\ngtk3\n$ go build -tags gtk2; and ./constrains\ngtk2\n</code></pre>\n"}], "owner": {"reputation": 4036, "user_id": 667457, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/33f9a9233b25c8230f5b5edb38493842?s=128&d=identicon&r=PG", "display_name": "Jeff Burdges", "link": "https://stackoverflow.com/users/667457/jeff-burdges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425709837, "creation_date": 1425653394, "question_id": 28901292, "link": "https://stackoverflow.com/questions/28901292/build-go-bindings-for-multiple-library-versions", "title": "Build Go bindings for multiple library versions?", "body": "<p>I've encountered a small <a href=\"https://github.com/mattn/go-gtk/issues/225\" rel=\"nofollow\">hiccup</a> when trying to merge the GTK3 support in the <a href=\"https://github.com/agl/go-gtk\" rel=\"nofollow\">go-gtk fork</a> used by <a href=\"https://github.com/agl/pond\" rel=\"nofollow\">pond</a> with the upstream <a href=\"https://github.com/mattn/go-gtk\" rel=\"nofollow\">go-gtk</a> based on GTK2.</p>\n\n<p>These <code>cgo pkg-config</code> lines that specify the GTK version must afaik appear in every file, which prevents bindings common to both GTK 2 and 3 from existing in a common file.</p>\n\n<p>I suppose the \"idiomatic\" hack to build compile a file against multiple  GTK versions is : Place the common code in a <code>foo_common.go</code> file, so that it never builds.  Use a <code>perl</code> or <code>bash + sed</code> script to build <code>foo2.go</code> and <code>foo3.go</code> from <code>foo_common.go</code> by fixing the <code>cgo pkg-config</code> lines and adding go build directives for a gtk2 tag. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 917268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/187887731a1307f80996ca2eec88bd51?s=128&d=identicon&r=PG", "display_name": "coffekid", "link": "https://stackoverflow.com/users/917268/coffekid"}, "edited": false, "score": 0, "creation_date": 1425672941, "post_id": 28904861, "comment_id": 46073228, "body": "Yep, the more I use go, the more I like it. I didn&#39;t know make wasn&#39;t necessary thanks for pointing me that. Also I changed u.Items = append(item.Items, *item) to be instead u.Items = append(u.Items, item). It is working now as a charm. Great answer!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1425665018, "creation_date": 1425665018, "answer_id": 28904861, "question_id": 28900984, "link": "https://stackoverflow.com/questions/28900984/go-adding-items-to-array-recursively-not-working/28904861#28904861", "title": "Go adding items to array recursively not working", "body": "<p>You won't need a pointer to a slice, as long you are passing around a pointer to the struct which contains your slice. </p>\n\n<p>Each time you call <code>TitleChildrenRecursive</code>, you're replacing your slice with a new one before anything is appended:</p>\n\n<pre><code>u.Items = make([]Title, 0)\n</code></pre>\n\n<p>There's no need to <code>make</code> a new slice, since <code>append</code> works correctly with a nil slice.</p>\n\n<p>You should also change <code>[]Title</code> to <code>[]*Title</code>, so that if any <code>append</code> operations happen to children items after they are added to the slice, it's reflected throughout the tree. </p>\n"}], "owner": {"reputation": 605, "user_id": 917268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/187887731a1307f80996ca2eec88bd51?s=128&d=identicon&r=PG", "display_name": "coffekid", "link": "https://stackoverflow.com/users/917268/coffekid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 28904861, "answer_count": 1, "score": 1, "last_activity_date": 1425665018, "creation_date": 1425652438, "last_edit_date": 1425658660, "question_id": 28900984, "link": "https://stackoverflow.com/questions/28900984/go-adding-items-to-array-recursively-not-working", "title": "Go adding items to array recursively not working", "body": "<p>I have been doing some golang programming and usually has been lot of fun. Now I have this code I need to port from C# to go and it is just not working.\nThe idea is to fill a tree of employees from database but inner slices are not being filled up on each call.\nBetter to write the code here</p>\n\n<pre><code>func (db *DalBase) TitleAllChildren(tx *gorp.Transaction) (items []Title, err error) {\n    var dbChildren []entities.Title\n    _, err = tx.Select(&amp;dbChildren, \"select * from title where idparent is null order by name\")\n    if err != nil {\n        return\n    }\n\n    items = make([]Title, 0)\n    for i := range dbChildren {\n        currItem := &amp;dbChildren[i]\n        item := &amp;Title{Id: currItem.Id, Name: currItem.Name}\n        err = db.TitleChildrenRecursive(tx, item)\n        if err != nil {\n            return\n        }\n        items = append(items, *item)\n    }\n    return\n}\n\nfunc (db *DalBase) TitleChildrenRecursive(tx *gorp.Transaction, u *Title) (err error) {\n    var dbChildren []entities.Title\n    _, err = tx.Select(&amp;dbChildren, \"select * from title where idparent = $1 order by name\", u.Id)\n    if err != nil {\n        return\n    }\n\n    if len(dbChildren) != 0 {\n        u.Items = make([]Title, 0)\n        for i := range dbChildren {\n            currItem := &amp;dbChildren[i]\n            item := &amp;Title{Id: currItem.Id, Name: currItem.Name}\n            err = db.TitleChildrenRecursive(tx, item)\n            if err != nil {\n                return\n            }\n            u.Items = append(item.Items, *item)\n        }\n    }\n\n    return\n}\n</code></pre>\n\n<p>I have logged the values on each recursive call and they are being filled inside the function, but when it bubbles up to the parent, slices are empty.</p>\n\n<p>I wouldn't like to use pointers to slices, is it possible to implement?</p>\n\n<p>Edit: here is the struct I am trying to fill</p>\n\n<pre><code>type Title struct {\n    Id    string  `json:\"id\"`\n    Name  string  `json:\"name\"`\n    Items []Title `json:\"items\"`\n}\n</code></pre>\n"}, {"tags": ["go", "null-pointer", "cgo"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 0, "creation_date": 1425651139, "post_id": 28900065, "comment_id": 46060357, "body": "I haven&#39;t used the C API in Go, but to allow your function to accept a <code>Null</code>, you could do <code>func StrCmp(a, b *string) int { ... }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 2, "creation_date": 1425793977, "post_id": 28902993, "comment_id": 46103778, "body": "7.1.4.1 of the C standard specifies that passing NULL to <code>strcmp</code> results in undefined behavior (since <code>strcmp</code> isn&#39;t documented to accept NULL pointers)."}, {"owner": {"reputation": 81, "user_id": 1965613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06e66ca89d9fc7d272cc789703fd03b?s=128&d=identicon&r=PG", "display_name": "tanbro", "link": "https://stackoverflow.com/users/1965613/tanbro"}, "edited": false, "score": 0, "creation_date": 1426129051, "post_id": 28902993, "comment_id": 46249960, "body": "Thanks, @Sander , i&#39;ll try your exmaples"}], "tags": [], "owner": {"reputation": 556, "user_id": 515781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf521a4ef5c80d978aeaf5af2a21ec0a?s=128&d=identicon&r=PG", "display_name": "Sander", "link": "https://stackoverflow.com/users/515781/sander"}, "is_accepted": false, "score": 12, "last_activity_date": 1425658770, "creation_date": 1425658770, "answer_id": 28902993, "question_id": 28900065, "link": "https://stackoverflow.com/questions/28900065/cgo-how-to-pass-null-parameter-to-c-function/28902993#28902993", "title": "CGO, how to pass NULL parameter to C function", "body": "<p>If you want to pass NULL to a C function you could simply pass <code>nil</code> into it.</p>\n\n<p>However it's not documented what happens when you send a NULL pointer to the function <code>strcmp(...)</code>. I'd guess that the strcmp fails when you are passing NULL to it. It would be better to check your input on before hand and return an error when one of your inputs is set to nil.</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n*/\nimport \"C\"\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc StrCmp(a, b *string) (int, error) {\n    if nil == a || nil == b {\n        return 0, errors.New(\"Both strings have to be set\")\n    }\n    pca := C.CString(*a)\n    defer C.free(unsafe.Pointer(pca))\n    pcb := C.CString(*b)\n    defer C.free(unsafe.Pointer(pcb))\n\n    ret := C.strcmp(pca, pcb)\n    return int(ret), nil\n}\n\nfunc main() {\n    left := \"Left\"\n    right := \"Right\"\n    fmt.Println(StrCmp(&amp;left, &amp;right))\n    fmt.Println(StrCmp(&amp;left, &amp;left))\n    fmt.Println(StrCmp(nil, &amp;right))\n    fmt.Println(StrCmp(&amp;left, nil))\n}\n</code></pre>\n\n<p>If necessary an example how to pass NULL to a function that does accept NULL pointers:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdio.h&gt;\nint am_i_null(int* pointer) {\n  if (NULL == pointer) {\n    return -1;\n  }\n  return *pointer;\n}\n*/\nimport \"C\"\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    fmt.Println(C.am_i_null(nil))\n\n    var cInteger C.int = 8\n    fmt.Println(C.am_i_null(&amp;cInteger))\n\n    var goInteger int = 7\n    fmt.Println(C.am_i_null((*C.int)(unsafe.Pointer(&amp;goInteger))))\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 1965613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e06e66ca89d9fc7d272cc789703fd03b?s=128&d=identicon&r=PG", "display_name": "tanbro", "link": "https://stackoverflow.com/users/1965613/tanbro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7049, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1425658770, "creation_date": 1425649374, "last_edit_date": 1425651019, "question_id": 28900065, "link": "https://stackoverflow.com/questions/28900065/cgo-how-to-pass-null-parameter-to-c-function", "title": "CGO, how to pass NULL parameter to C function", "body": "<p>Sometimes, a NULL pointer may be needed for a C API.</p>\n\n<p>is that possible in CGO?</p>\n\n<p>For example, I want to pass a null argument to <code>strcmp()</code> in a Go language program:</p>\n\n<pre><code>package strutil\n\n/*\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n*/\nimport (\n    \"C\"\n    \"unsafe\"\n)\n\nfunc StrCmp(a, b string) int {\n    pca := C.CString(a)\n    defer C.free(pca)\n    pcb := C.CString(b)\n    defer C.free(pcb)\n    ret := C.strcmp(pca, pcb)\n    return int(ret)\n}\n</code></pre>\n\n<p>If I set <code>pca</code> to <code>nil</code>, this error occurs:</p>\n\n<pre><code>Exception 0xc0000005 0x0 0x0 0x76828b21\nPC=0x76828b21\nsignal arrived during cgo execution\n\nstrutil._Cfunc_strcmp(0x0, 0x761b00, 0x0)\n    strutil/_obj/_cgo_gotypes.go:79 +0x49\nstrutil.StrCmp(0x19, 0x10, 0x4bbf38, 0xa, 0x1fbc1f98, 0x0, 0x0, 0xffff, 0x0,     0x0, ...)\n</code></pre>\n\n<p>So, how can I pass NULL to strcmp?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["jquery", "go", "webserver"], "comments": [{"owner": {"reputation": 5617, "user_id": 1144057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3290f106229a82f934818d2fae029fb?s=128&d=identicon&r=PG", "display_name": "skip405", "link": "https://stackoverflow.com/users/1144057/skip405"}, "edited": false, "score": 0, "creation_date": 1425648333, "post_id": 28899675, "comment_id": 46058676, "body": "first thing I&#39;d try is change <code>&#47;jquery.min.js</code> to <code>jquery.min.js</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2472, "user_id": 1746258, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c80e6ebd8ed195a574b7654a2aeb89b1?s=128&d=identicon&r=PG&f=1", "display_name": "Ulug&#39;bek Ro&#39;zimboyev", "link": "https://stackoverflow.com/users/1746258/ulugbek-rozimboyev"}, "edited": false, "score": 0, "creation_date": 1425649760, "post_id": 28899786, "comment_id": 46059560, "body": "It keeps getting message: &quot;Serving from the file system? Add your files into the workspace. less If you add files into your DevTools workspace, your changes will be persisted to disk. To add a folder into the workspace, drag and drop it into the Sources panel. For more information on workspaces, refer to the workspaces documentation.&quot;"}, {"owner": {"reputation": 2472, "user_id": 1746258, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c80e6ebd8ed195a574b7654a2aeb89b1?s=128&d=identicon&r=PG&f=1", "display_name": "Ulug&#39;bek Ro&#39;zimboyev", "link": "https://stackoverflow.com/users/1746258/ulugbek-rozimboyev"}, "edited": false, "score": 0, "creation_date": 1425650155, "post_id": 28899786, "comment_id": 46059812, "body": "Thanks a lot, we got it !"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1425652712, "last_edit_date": 1495540510, "creation_date": 1425648456, "answer_id": 28899786, "question_id": 28899675, "link": "https://stackoverflow.com/questions/28899675/include-js-file-in-go-template/28899786#28899786", "title": "Include js file in Go template", "body": "<p>You need a <a href=\"http://golang.org/pkg/net/http/#Handler\" rel=\"noreferrer\"><code>Handler</code></a> or a <a href=\"http://golang.org/pkg/net/http/#HandlerFunc\" rel=\"noreferrer\"><code>HandlerFunc</code></a> which will send the file content (<code>jquery.min.js</code>) to the web browser when requested.</p>\n\n<p>You have 3 options:</p>\n\n<h2>Doing It Manually</h2>\n\n<p>This is the more complex solution. It would look like in your handler function you read the content of the file, set proper response content type (<code>application/javascript</code>) and send the content (which is a <code>[]byte</code>) to the response.</p>\n\n<p>Things to look out for: When reading the file, you have to specify an absolute path. If you specify a relative path, be sure the file is in the current folder (working directory) you start your app from.</p>\n\n<p>Example:</p>\n\n<pre><code>func SendJqueryJs(w http.ResponseWriter, r *http.Request) {\n    data, err := ioutil.ReadFile(\"jquery.min.js\")\n    if err != nil {\n        http.Error(w, \"Couldn't read file\", http.StatusInternalServerError)\n        return\n    }\n    w.Header().Set(\"Content-Type\", \"application/javascript; charset=utf-8\")\n    w.Write(data)\n}\n\nfunc main() {\n    http.HandleFunc(\"/jquery.min.js\", SendJqueryJs)\n    panic(http.ListenAndServe(\":8081\", nil))\n}\n</code></pre>\n\n<p>The above example is capable of serving only 1 file: <code>jquery.min.js</code> for the request:</p>\n\n<pre><code>http://localhost:8081/jquery.min.js\n</code></pre>\n\n<h2>Utilizing <code>http.ServeFile()</code></h2>\n\n<p>This is much easier: The function <a href=\"http://golang.org/pkg/net/http/#ServeFile\" rel=\"noreferrer\"><code>http.ServeFile()</code></a> is capable of sending the content of one file to the specified response. You still need to create a function or handler to use it, but it does the rest for you:</p>\n\n<pre><code>func SendJqueryJs(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"jquery.min.js\")\n}\n</code></pre>\n\n<h2>Utilizing <code>http.FileServer()</code></h2>\n\n<p>If you need to serve multiple static files, this is where <a href=\"http://golang.org/pkg/net/http/#FileServer\" rel=\"noreferrer\"><code>FileServer()</code></a> function comes handy which returns you a <code>Handler</code> which automatically serves files from your local file system that are descendants of the root folder you specify.</p>\n\n<p>This solution is much more flexible: it can send many files of multiple types, detects and sets content type automatically. The handler is also capable of rendering HTML pages for listing directory content with links to the files and to parent/child folders.</p>\n\n<p>Example:</p>\n\n<pre><code>http.Handle(\"/tmpfiles/\",\n    http.StripPrefix(\"/tmpfiles/\", http.FileServer(http.Dir(\"/tmp\"))))\n</code></pre>\n\n<p>This will register a <code>Handler</code> at the URL <code>/tmpfiles/</code> which serves files found in your local filesystem in the <code>/tmp</code> folder. So for example the following <code>&lt;script&gt;</code> link:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"/tmpfiles/jquery.min.js\"&gt;\n</code></pre>\n\n<p>Will get the <code>/tmp/jsquery.min.js</code> file from the server.</p>\n\n<p>Check out this answer which details how to use/fire up a <a href=\"https://stackoverflow.com/a/28745280/1705598\">Static File Server</a>.</p>\n"}], "owner": {"reputation": 2472, "user_id": 1746258, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c80e6ebd8ed195a574b7654a2aeb89b1?s=128&d=identicon&r=PG&f=1", "display_name": "Ulug&#39;bek Ro&#39;zimboyev", "link": "https://stackoverflow.com/users/1746258/ulugbek-rozimboyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7455, "favorite_count": 5, "accepted_answer_id": 28899786, "answer_count": 1, "score": 7, "last_activity_date": 1425717583, "creation_date": 1425648124, "last_edit_date": 1425717583, "question_id": 28899675, "link": "https://stackoverflow.com/questions/28899675/include-js-file-in-go-template", "title": "Include js file in Go template", "body": "<p>I started learning Go recently. I got a sample like as web app. I have:</p>\n\n<pre><code>/* tick-tock.go */\npackage main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\n// Content for the main html page..\nvar page = `&lt;html&gt;\n           &lt;head&gt;\n             &lt;script type=\"text/javascript\"\n               src=\"http://localhost:8081/jquery.min.js\"&gt;\n             &lt;/script&gt;\n             &lt;style&gt; \n               div {\n                 font-family: \"Times New Roman\", Georgia, Serif;\n                 font-size: 1em;\n                 width: 13.3em;\n                 padding: 8px 8px; \n                 border: 2px solid #2B1B17;\n                 color: #2B1B17;\n                 text-shadow: 1px 1px #E5E4E2;\n                 background: #FFFFFF;\n               }\n             &lt;/style&gt;\n           &lt;/head&gt;\n           &lt;body&gt;\n             &lt;h2 align=center&gt;Go Timer &lt;/h2&gt;\n             &lt;div id=\"output\" style=\"width: 30%; height: 63%; overflow-y: scroll; float:left;\"&gt;&lt;/div&gt;\n             &lt;div id=\"v1\" style=\"width: 50%; height: 30%; overflow-y: scroll; float:left;\"&gt;&lt;/div&gt;\n             &lt;div id=\"v2\" style=\"width: 50%; height: 30%; overflow-y: scroll; float:left;\"&gt;&lt;/div&gt;\n             &lt;input id=\"sett\" type=\"submit\" name=\"sett\" value=\"Settings\" onclick=\"changeUrl()\"&gt;\n\n             &lt;script type=\"text/javascript\"&gt;\n\n               var myDelay;\n\n               $(document).ready(function () \n               {\n                   $(\"#output\").append(\"Waiting for system time..\");\n\n                   myDelay = setInterval(\"delayedPost()\", 1000);               \n\n                });\n\n               function delayedPost() \n               {\n                 $.post(\"http://localhost:9999/dev\", \"\", function(data, status) \n                 {\n                    //$(\"#output\").empty();\n                    $(\"#output\").prepend(data);\n                 });\n\n                 $.post(\"http://localhost:9999/v1\", \"\", function(data, status) {\n                    //$(\"#output\").empty();\n                    $(\"#v1\").prepend(data);\n                 });\n\n                 $.post(\"http://localhost:9999/v2\", \"\", function(data, status) {\n                    //$(\"#output\").empty();\n                    $(\"#v2\").prepend(data);\n                 });\n               }\n\n               function delayedPost1() \n               {\n                 $.post(\"http://localhost:9999/dev\", \"\", function(data, status) \n                 {                    \n                    $(\"#output\").prepend(data);\n                 });\n\n                 $.post(\"http://localhost:9999/v1\", \"\", function(data, status) \n                 {                   \n                    $(\"#v1\").prepend(data);\n                 });\n\n                 $.post(\"http://localhost:9999/v3\", \"\", function(data, status) \n                 {                    \n                    $(\"#v2\").prepend(data);\n                 });\n               }\n\n               function changeUrl()\n               {\n                  alert('salom');                      \n                  clearInterval(myDelay);\n\n\n\n               }\n\n             &lt;/script&gt;\n           &lt;/body&gt;\n         &lt;/html&gt;`\n\n// handler for the main page.\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprint(w, page)\n}\n\n// handler to cater AJAX requests\nfunc handlerDevs(w http.ResponseWriter, r *http.Request) {\n    //fmt.Fprint(w, time.Now().Format(\"Mon, 02 Jan 2006 15:04:05 MST\"))\n    fmt.Fprint(w, \"&lt;font color=red&gt;Dev1&lt;br&gt;&lt;/font&gt;\")\n}\n\nfunc handlerV1(w http.ResponseWriter, r *http.Request) {\n    //fmt.Fprint(w, time.Now().Format(\"Mon, 02 Jan 2006 15:04:05 MST\"))\n    fmt.Fprint(w, \"&lt;font color=blue&gt;Vertical1&lt;br&gt;&lt;/font&gt;\")\n}\n\nfunc handlerV2(w http.ResponseWriter, r *http.Request) {\n    //fmt.Fprint(w, time.Now().Format(\"Mon, 02 Jan 2006 15:04:05 MST\"))\n    fmt.Fprint(w, \"&lt;font color=green&gt;Vertical2&lt;br&gt;&lt;/font&gt;\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.HandleFunc(\"/dev\", handlerDevs)\n    http.HandleFunc(\"/v1\", handlerV1)\n    http.HandleFunc(\"/v2\", handlerV2)\n    log.Fatal(http.ListenAndServe(\":9999\", nil))\n    http.HandleFunc(\"/jquery.min.js\", SendJqueryJs)\n    panic(http.ListenAndServe(\":8081\", nil))\n}\nfunc SendJqueryJs(w http.ResponseWriter, r *http.Request) {\n    data, err := ioutil.ReadFile(\"jquery.min.js\")\n    if err != nil {\n        http.Error(w, \"Couldn't read file\", http.StatusInternalServerError)\n        return\n    }\n    w.Header().Set(\"Content-Type\", \"application/javascript\")\n    w.Write(data)\n}\n</code></pre>\n\n<p>I couldn't load local <code>jquery.min.js</code>. When I wrote <code>src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"</code> it was loaded. How can I load local js file? I am not good at coding in Go and I did not write full code. So please try to explain very simple. Thanks in advance!</p>\n"}, {"tags": ["ssl", "tcp", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425680728, "post_id": 28898723, "comment_id": 46076763, "body": "Don&#39;t use <code>error</code> as your error value, since that masks the built-in interface name."}, {"owner": {"reputation": 1006, "user_id": 1034613, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7CWMX.jpg?s=128&g=1", "display_name": "Quentin Skousen", "link": "https://stackoverflow.com/users/1034613/quentin-skousen"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425682592, "post_id": 28898723, "comment_id": 46077442, "body": "Thank you, I will correct that!"}], "answers": [{"comments": [{"owner": {"reputation": 1006, "user_id": 1034613, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7CWMX.jpg?s=128&g=1", "display_name": "Quentin Skousen", "link": "https://stackoverflow.com/users/1034613/quentin-skousen"}, "edited": false, "score": 0, "creation_date": 1425680364, "post_id": 28908582, "comment_id": 46076628, "body": "Should the intermediate certificate be added into the example.com.pem file then? So it is loaded with the main certificate?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1006, "user_id": 1034613, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7CWMX.jpg?s=128&g=1", "display_name": "Quentin Skousen", "link": "https://stackoverflow.com/users/1034613/quentin-skousen"}, "edited": false, "score": 0, "creation_date": 1425680616, "post_id": 28908582, "comment_id": 46076718, "body": "@kkhugs: I don&#39;t have a cert requiring an intermediate handy, but I&#39;m fairly certain you should just chain them into your <code>example.com.pem</code>, like you would in nginx for example (docs say <code>Certificates contains one or more certificate chains</code>)."}, {"owner": {"reputation": 1006, "user_id": 1034613, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7CWMX.jpg?s=128&g=1", "display_name": "Quentin Skousen", "link": "https://stackoverflow.com/users/1034613/quentin-skousen"}, "edited": false, "score": 0, "creation_date": 1425683305, "post_id": 28908582, "comment_id": 46077662, "body": "Thanks, adding the intermediate into the cert file and using as suggested worked perfectly!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1425680042, "creation_date": 1425680042, "answer_id": 28908582, "question_id": 28898723, "link": "https://stackoverflow.com/questions/28898723/golang-ssl-tcp-socket-certificate-configuration/28908582#28908582", "title": "Golang SSL TCP socket certificate configuration", "body": "<p>The <code>RootCAs</code> field is for clients verifying server certificates. I assume you only want to present a cert for verification, so anything you need should be loaded into the <code>Certificates</code> slice. </p>\n\n<p>Here is a minimal example:</p>\n\n<pre><code>cert, err := tls.LoadX509KeyPair(\"example.com.pem\", \"example.com.key\")\nif err != nil {\n    log.Fatal(\"Error loading certificate. \", err)\n}\n\ntlsCfg := &amp;tls.Config{Certificates: []tls.Certificate{cert}}\n\nlistener, err := tls.Listen(\"tcp4\", \"127.0.0.1:5555\", tlsCfg)\nif err != nil {\n    log.Fatal(err)\n}\ndefer listener.Close()\n\nfor {\n    log.Println(\"Waiting for clients\")\n    conn, err := listener.Accept()\n    if err != nil {\n        log.Fatal(err)\n    }\n    go handle(conn)\n}\n</code></pre>\n\n<p>Even though you're not using HTTPS, it may still be useful to walk through the server setup starting at <a href=\"http://golang.org/pkg/net/http/#Server.ListenAndServeTLS\" rel=\"noreferrer\"><code>http.ListenAndServeTLS</code></a>.</p>\n"}], "owner": {"reputation": 1006, "user_id": 1034613, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7CWMX.jpg?s=128&g=1", "display_name": "Quentin Skousen", "link": "https://stackoverflow.com/users/1034613/quentin-skousen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6909, "favorite_count": 1, "accepted_answer_id": 28908582, "answer_count": 1, "score": 7, "last_activity_date": 1425680042, "creation_date": 1425644594, "last_edit_date": 1425653232, "question_id": 28898723, "link": "https://stackoverflow.com/questions/28898723/golang-ssl-tcp-socket-certificate-configuration", "title": "Golang SSL TCP socket certificate configuration", "body": "<p>I'm creating a Go TCP server (NOT http/s) and I'm trying to configure it to use SSL. I have a StartCom free SSL certificate which I am trying to use to accomplish this. My server code looks like this:</p>\n\n<pre><code>    cert, err := tls.LoadX509KeyPair(\"example.com.pem\", \"example.com.key\")\n    if err != nil {\n        fmt.Println(\"Error loading certificate. \",err)\n    }\n    trustCert, err := ioutil.ReadFile(\"sub.class1.server.ca.pem\")\n    if err != nil {\n        fmt.Println(\"Error loading trust certificate. \",err)\n    }\n    validationCert, err := ioutil.ReadFile(\"ca.pem\")\n    if err != nil {\n        fmt.Println(\"Error loading validation certificate. \",err)\n    }\n    certs := x509.NewCertPool()\n    if !certs.AppendCertsFromPEM(validationCert) {\n        fmt.Println(\"Error installing validation certificate.\")\n    }\n    if !certs.AppendCertsFromPEM(trustCert) {\n        fmt.Println(\"Error installing trust certificate.\")\n    }\n\n    sslConfig := tls.Config{RootCAs: certs,Certificates: []tls.Certificate{cert}}\n\n    service := \":5555\"\n    tcpAddr, error := net.ResolveTCPAddr(\"tcp\", service)\n    if error != nil {\n        fmt.Println(\"Error: Could not resolve address\")\n    } else {\n        netListen, error := tls.Listen(tcpAddr.Network(), tcpAddr.String(), &amp;sslConfig)\n        if error != nil {\n            fmt.Println(error)\n        } else {\n            defer netListen.Close()\n\n            for {\n                fmt.Println(\"Waiting for clients\")\n                connection, error := netListen.Accept()\n</code></pre>\n\n<p>I've tried switching around the order of the certs, not including some certs, etc. but the output from <code>openssl s_client -CApath /etc/ssl/certs/ -connect localhost:5555</code> remains essentially the same, <code>verify error:num=20:unable to get local issuer certificate</code>. See <a href=\"http://pastebin.com/hALjVZb3\" rel=\"noreferrer\">here</a> for full output. I seem to be doing something wrong with the intermediate certificates, but I have no idea what. I have been working on this for a few days, lots of googling and SO'ing, but nothing seemed to quite fit my situation. I have set up many certificates in Apache and HAProxy, but this really has me stumped.</p>\n"}, {"tags": ["git", "go", "git-submodules"], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 4295403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4aa6b8cf78795ac73ab6658492a295a?s=128&d=identicon&r=PG&f=1", "display_name": "Mag", "link": "https://stackoverflow.com/users/4295403/mag"}, "is_accepted": false, "score": -3, "last_activity_date": 1425636022, "creation_date": 1425636022, "answer_id": 28896360, "question_id": 28895590, "link": "https://stackoverflow.com/questions/28895590/should-i-use-git-submodules-in-go-project/28896360#28896360", "title": "Should I use git submodules in go project?", "body": "<p>Just import directive.\nGit submodules has a bad rep.</p>\n"}, {"tags": [], "owner": {"reputation": 517, "user_id": 4571524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4263217cfc557061c3cbb5d506983022?s=128&d=identicon&r=PG&f=1", "display_name": "gdg", "link": "https://stackoverflow.com/users/4571524/gdg"}, "is_accepted": true, "score": 2, "last_activity_date": 1425639258, "creation_date": 1425639258, "answer_id": 28897269, "question_id": 28895590, "link": "https://stackoverflow.com/questions/28895590/should-i-use-git-submodules-in-go-project/28897269#28897269", "title": "Should I use git submodules in go project?", "body": "<p>You should use <code>import \"github.com/3rd-party/dep\"</code>\nand then run <code>go get</code> in the working directory</p>\n"}], "owner": {"reputation": 680, "user_id": 1592264, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78dbfab1c2716de55b960f00a5c868ce?s=128&d=identicon&r=PG", "display_name": "Ggicci", "link": "https://stackoverflow.com/users/1592264/ggicci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 28897269, "answer_count": 2, "score": 0, "last_activity_date": 1425639258, "creation_date": 1425633416, "question_id": 28895590, "link": "https://stackoverflow.com/questions/28895590/should-i-use-git-submodules-in-go-project", "title": "Should I use git submodules in go project?", "body": "<p>There's a project written in go language. And it's managed using git. Should I use git submodules or just import directives to use a 3rd-party project?</p>\n\n<p>For example:</p>\n\n<pre><code>// Just use import directive.\nimport \"github.com/3rd-party/dep\"\n\n// From a submodule.\n$ cd myown\n$ git add submodule https://github.com/3rd-party/dep dep\n$ ...\nimport \"github.com/myown/dep\"\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1425630377, "post_id": 28893617, "comment_id": 46049591, "body": "The best way would be to use different variables: <code>rows := X{&quot;1&quot;}; rows2 := X{&quot;2&quot;}</code> - much simpler and cleaner. Intent is also clearer that you want to close <code>rows</code> and <code>rows2</code>."}], "tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": false, "score": 2, "last_activity_date": 1425625413, "last_edit_date": 1425625413, "creation_date": 1425624510, "answer_id": 28893617, "question_id": 28893586, "link": "https://stackoverflow.com/questions/28893586/golang-defer-clarification/28893617#28893617", "title": "Golang defer clarification", "body": "<p>Ah I see, the <code>rows</code> always refer to the last one, <a href=\"http://play.golang.org/p/_xzxHnbFSz\" rel=\"nofollow\">http://play.golang.org/p/_xzxHnbFSz</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype X struct {\n   A string\n}\n\nfunc (x *X) Close() {\n  fmt.Println(x.A)\n}\n\nfunc main() {\n  rows := X{`1`}\n  defer rows.Close()\n  rows = X{`2`}\n  defer rows.Close()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2\n2\n</code></pre>\n\n<p>So maybe the best way to preserve the object is to pass it to a function: <a href=\"http://play.golang.org/p/TIMCliUn60\" rel=\"nofollow\">http://play.golang.org/p/TIMCliUn60</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype X struct {\n    A string\n}\n\nfunc (x *X) Close() {\n    fmt.Println(x.A)\n}\n\nfunc main() {\n    rows := X{`1`}\n    defer func(r X) { r.Close() }(rows)\n    rows = X{`2`}\n    defer func(r X) { r.Close() }(rows)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2\n1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1425636179, "post_id": 28893673, "comment_id": 46052483, "body": "Note that in this case the 2 deferred <code>Close()</code> methods will refer to the 2 distinct <code>Rows</code> values and both will be properly closed because <code>rows</code> is a <i>pointer</i>, not a value type. Please see my edited answer which also includes the case when both the variable is a pointer and the method has a pointer receiver."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1425636340, "post_id": 28893673, "comment_id": 46052560, "body": "@icza don&#39;t you worry: I see <i>all</i> your answers. And your edits ;) I have edited the answer accordingly."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1425637786, "post_id": 28893673, "comment_id": 46053323, "body": "@icza thank for your answers by the way. I am learning a ton :)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1425636317, "last_edit_date": 1592644375, "creation_date": 1425624813, "answer_id": 28893673, "question_id": 28893586, "link": "https://stackoverflow.com/questions/28893586/golang-defer-clarification/28893673#28893673", "title": "Golang defer clarification", "body": "<p><a href=\"https://golang.org/doc/effective_go.html#defer\" rel=\"nofollow noreferrer\">Effective Go</a> mentions:</p>\n<blockquote>\n<p><strong>The arguments to the deferred function (which include the receiver if the function is a method) are evaluated when the defer executes, not when the call executes</strong>.</p>\n<p>Besides avoiding worries about variables changing values as the function executes, this means that a single deferred call site can defer multiple function executions</p>\n</blockquote>\n<p>In your case, the defer would reference the second rows instance.<br />\nThe two deferred functions are executed in LIFO order (as mentioned also in &quot;<a href=\"http://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">Defer, Panic, and Recover</a>&quot;).</p>\n<p>As <a href=\"https://stackoverflow.com/users/1705598/icza\">icza</a> mentions in <a href=\"https://stackoverflow.com/a/28894103/6309\">his answer</a> and <a href=\"https://stackoverflow.com/questions/28893586/golang-defer-clarification/28893673?noredirect=1#comment46052483_28893673\">in the comments</a>:</p>\n<blockquote>\n<p>The 2 deferred <code>Close()</code> methods will refer to the <strong>2 distinct Rows values</strong> and both will be properly closed because <code>rows</code> is a <strong>pointer</strong>, not a value type.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1425627497, "post_id": 28894103, "comment_id": 46048432, "body": "I missed that part of the spec. Nice. +1"}, {"owner": {"reputation": 4288, "user_id": 2251785, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7942993142e526d02dd8da4cf0e40aa7?s=128&d=identicon&r=PG", "display_name": "Hunger", "link": "https://stackoverflow.com/users/2251785/hunger"}, "edited": false, "score": 0, "creation_date": 1572925022, "post_id": 28894103, "comment_id": 103703517, "body": "How does defer copy Pointer? Just make a new pointer which has same value as <code>xp</code> and <code>xp2</code>, regradless of <code>Close()</code> or <code>CloseP()</code>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 4288, "user_id": 2251785, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7942993142e526d02dd8da4cf0e40aa7?s=128&d=identicon&r=PG", "display_name": "Hunger", "link": "https://stackoverflow.com/users/2251785/hunger"}, "edited": false, "score": 1, "creation_date": 1572939240, "post_id": 28894103, "comment_id": 103707333, "body": "@Hunger Yes, a pointer is just a memory address. When you copy a pointer like <code>p2 := p</code>, you just copy the memory address which points to the same object. To copy the <i>pointed</i> object, you would have to <i>dereference</i> the pointer, e.g. <code>obj2 := *p</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 21, "last_activity_date": 1470037099, "last_edit_date": 1470037099, "creation_date": 1425627187, "answer_id": 28894103, "question_id": 28893586, "link": "https://stackoverflow.com/questions/28893586/golang-defer-clarification/28894103#28894103", "title": "Golang defer clarification", "body": "<p><em>It depends on the method receiver <strong>and</strong> on the type of the variable.</em></p>\n\n<p>Short answer: if you're using the <a href=\"https://golang.org/pkg/database/sql/\" rel=\"noreferrer\"><code>database/sql</code></a> package, your deferred <a href=\"http://golang.org/pkg/database/sql/#Rows.Close\" rel=\"noreferrer\"><code>Rows.Close()</code></a> methods will properly close both of your <code>Rows</code> instances because <code>Rows.Close()</code> has <em>pointer</em> receiver <strong>and</strong> because <a href=\"http://golang.org/pkg/database/sql/#DB.Query\" rel=\"noreferrer\"><code>DB.Query()</code></a> returns a <em>pointer</em> (and so <code>rows</code> is a pointer). See reasoning and explanation below.</p>\n\n<p>To avoid confusion, I recommend using different variables and it will be clear what you <em>want</em> and what <em>will be</em> closed:</p>\n\n<pre><code>rows := Query(`SELECT FROM whatever`)\ndefer rows.Close()\n// ...\nrows2 := Query(`SELECT FROM whatever`)\ndefer rows2.Close()\n</code></pre>\n\n<hr>\n\n<p>I'd like to point out an important fact that comes from the deferred function and its parameters being evaluated immedately which is stated in the <a href=\"https://golang.org/doc/effective_go.html#defer\" rel=\"noreferrer\">Effective Go</a> blog post and in the <a href=\"http://golang.org/ref/spec#Defer_statements\" rel=\"noreferrer\">Language Spec: Deferred statements</a> too:</p>\n\n<blockquote>\n  <p>Each time a \"defer\" statement executes, the function value and parameters to the call are evaluated as usual and <strong>saved anew</strong> but the actual function is not invoked. Instead, deferred functions are invoked immediately before the surrounding function returns, in the reverse order they were deferred.</p>\n</blockquote>\n\n<p>If variable is not a pointer: <em>You will observe different results when calling a method deferred, depending if the method has a pointer receiver.</em><br>\nIf variable is a pointer, you will see always the \"desired\" result.</p>\n\n<p>See this example:</p>\n\n<pre><code>type X struct {\n    S string\n}\n\nfunc (x X) Close() {\n    fmt.Println(\"Value-Closing\", x.S)\n}\n\nfunc (x *X) CloseP() {\n    fmt.Println(\"Pointer-Closing\", x.S)\n}\n\nfunc main() {\n    x := X{\"Value-X First\"}\n    defer x.Close()\n    x = X{\"Value-X Second\"}\n    defer x.Close()\n\n    x2 := X{\"Value-X2 First\"}\n    defer x2.CloseP()\n    x2 = X{\"Value-X2 Second\"}\n    defer x2.CloseP()\n\n    xp := &amp;X{\"Pointer-X First\"}\n    defer xp.Close()\n    xp = &amp;X{\"Pointer-X Second\"}\n    defer xp.Close()\n\n    xp2 := &amp;X{\"Pointer-X2 First\"}\n    defer xp2.CloseP()\n    xp2 = &amp;X{\"Pointer-X2 Second\"}\n    defer xp2.CloseP()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Pointer-Closing Pointer-X2 Second\nPointer-Closing Pointer-X2 First\nValue-Closing Pointer-X Second\nValue-Closing Pointer-X First\nPointer-Closing Value-X2 Second\nPointer-Closing Value-X2 Second\nValue-Closing Value-X Second\nValue-Closing Value-X First\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/4eI58LBh6i\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>Using a pointer variable the result is always good (as expected).</p>\n\n<p>Using a non-pointer variable and using pointer receiver we see the same printed results (the latest) but if we have value receiver, it prints 2 different results.</p>\n\n<p><strong>Explanation for non-pointer variable:</strong></p>\n\n<p>As stated, deferred function including the receiver is evaluated when the <code>defer</code> executes. In case of a pointer receiver it will be the <strong>address of the local variable</strong>. So when you assign a new value to it and call another <code>defer</code>, the pointer receiver will be again the <strong>same address</strong> of the local variable (just the pointed value is different). So later when the function is executed, both will use the same address twice but the <em>pointed</em> value will be the same, the one assigned later.</p>\n\n<p>In case of value receiver, the receiver is a <strong>copy</strong> which is made when the <code>defer</code> executed, so if you assign a new value to the variable and call another <code>defer</code>, another copy will be made which is different from the previous one.</p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3993, "favorite_count": 7, "accepted_answer_id": 28894103, "answer_count": 3, "score": 19, "last_activity_date": 1470037099, "creation_date": 1425624362, "last_edit_date": 1425630744, "question_id": 28893586, "link": "https://stackoverflow.com/questions/28893586/golang-defer-clarification", "title": "Golang defer clarification", "body": "<p>What happened when defer called twice when the struct of that method has been changed?</p>\n\n<p>For example:</p>\n\n<pre><code>rows := Query(`SELECT FROM whatever`)\ndefer rows.Close()\nfor rows.Next() { \n  // do something\n}\nrows = Query(`SELECT FROM another`) \ndefer rows.Close()\nfor rows.Next() {\n  // do something else\n}\n</code></pre>\n\n<p>which <code>rows</code> when the last <code>rows.Close()</code> called?</p>\n"}, {"tags": ["selenium-webdriver", "go"], "answers": [{"comments": [{"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1545537205, "post_id": 41622433, "comment_id": 94647490, "body": "This post is almost two years old.  While I can see downvoting it based on the question&#39;s current content, I am fairly certain that when I answered the question, there was no language tag (I see now there&#39;s a go tag) and there was definitely no code shown.  Three downvotes for a correct answer with the caveat that the language was not specified is a tad severe in my opinion."}], "tags": [], "owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "is_accepted": false, "score": -2, "last_activity_date": 1484253091, "creation_date": 1484253091, "answer_id": 41622433, "question_id": 28891947, "link": "https://stackoverflow.com/questions/28891947/selenium-webdriver-golang-sendkeys-with-control/41622433#41622433", "title": "selenium webdriver golang sendkeys with control", "body": "<p>You did not tag what language that is, but I'm guessing it's C#</p>\n\n<p>Here's how I accomplish it in java:</p>\n\n<pre><code>driver.findElement(By.cssSelector(\"body\")).sendKeys(Keys.CONTROL + \"t\");\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2280, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1484253091, "creation_date": 1425613033, "last_edit_date": 1495540916, "question_id": 28891947, "link": "https://stackoverflow.com/questions/28891947/selenium-webdriver-golang-sendkeys-with-control", "title": "selenium webdriver golang sendkeys with control", "body": "<p>I am trying to open new tab with <a href=\"https://github.com/fedesog/webdriver\" rel=\"nofollow noreferrer\">selenium webdriver for golang</a> using <kbd>control</kbd>+<kbd>t</kbd> kyes following <a href=\"https://stackoverflow.com/a/17558909/1024794\">example for another languages</a>. But cannot figure out how to send <kbd>control</kbd>. </p>\n\n<p>My attempts with <code>\"ctrl t\"</code>, <code>\"control t\"</code>, <code>\"Control t\"</code> failed.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/fedesog/webdriver\"\n)\n\nfunc main() {\n    chromeDriver := webdriver.NewChromeDriver(\"/Users/maks/Downloads/chromedriver\")\n    err := chromeDriver.Start()\n    if err != nil {\n        panic(err)\n    }\n    desired := webdriver.Capabilities{\"Platform\": \"Mac\"}\n    required := webdriver.Capabilities{}\n    session, err := chromeDriver.NewSession(desired, required)\n    if err != nil {\n        panic(err)\n    }\n\n    session.Url(\"http://stackoverflow.com\")\n    el, err := session.FindElement(\"tag name\", \"body\")\n    if err != nil {\n        panic(err)\n    }\n    err = el.SendKeys(\"ctrl t\")\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "nsq"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 1143169, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/25005d109914a61be3739439073fd17f?s=128&d=identicon&r=PG", "display_name": "uuball", "link": "https://stackoverflow.com/users/1143169/uuball"}, "edited": false, "score": 0, "creation_date": 1425659545, "post_id": 28898493, "comment_id": 46065839, "body": "While I just followed your advise, but there are still some errors in my workspace, the ide cannot resolve some package."}], "tags": [], "owner": {"reputation": 2854, "user_id": 41292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/939e50606775eea4b7589dd7aebbd8b3?s=128&d=identicon&r=PG", "display_name": "LenW", "link": "https://stackoverflow.com/users/41292/lenw"}, "is_accepted": false, "score": 1, "last_activity_date": 1425643794, "creation_date": 1425643794, "answer_id": 28898493, "question_id": 28891590, "link": "https://stackoverflow.com/questions/28891590/how-can-i-review-the-nsq-source-code-in-intellij/28898493#28898493", "title": "How can I review the nsq source code in intellij?", "body": "<p>If you get the code with go get you can create an IntelliJ project with your $GOPATH as the root of the project. Then you can navigate to the $GOPATH/src/github.com/bitly folders to see the code.</p>\n"}, {"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 0, "last_activity_date": 1426720929, "creation_date": 1426720929, "answer_id": 29134519, "question_id": 28891590, "link": "https://stackoverflow.com/questions/28891590/how-can-i-review-the-nsq-source-code-in-intellij/29134519#29134519", "title": "How can I review the nsq source code in intellij?", "body": "<p>While the upcoming version is stable, some things might not work, hence it's currently released under github releases section here: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/releases\" rel=\"nofollow\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin/releases</a> if you have any issues with it, please search for duplicates and if you can't find any, feel free to open one. Also be sure to read the readme :)</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 321, "user_id": 1143169, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/25005d109914a61be3739439073fd17f?s=128&d=identicon&r=PG", "display_name": "uuball", "link": "https://stackoverflow.com/users/1143169/uuball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1426720929, "creation_date": 1425610051, "question_id": 28891590, "link": "https://stackoverflow.com/questions/28891590/how-can-i-review-the-nsq-source-code-in-intellij", "title": "How can I review the nsq source code in intellij?", "body": "<p>I download and build up the nsq src code and i wanna to navigate the src code by intellij 14.0 golang plugin. How can I import the whole nsq project into intellij without errors?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 15, "last_activity_date": 1425610678, "last_edit_date": 1425610678, "creation_date": 1425609746, "answer_id": 28891552, "question_id": 28891531, "link": "https://stackoverflow.com/questions/28891531/piping-http-response-to-http-responsewriter/28891552#28891552", "title": "Piping http.Response to http.ResponseWriter", "body": "<p><a href=\"https://golang.org/pkg/io/#Copy\" rel=\"noreferrer\"><code>io.Copy</code></a> is the way to go for that, something along the lines of:</p>\n\n<pre><code>func pipeReq(rw http.ResponseWriter, req *http.Request) {\n    resp, err := http.Get(\".....\")\n    if err != nil{\n        //handle the error\n        return\n    }\n    rw.Header().Set(\"Content-Type\", resp.Header.Get(\"Content-Type\"))\n    rw.Header().Set(\"Content-Length\", resp.Header.Get(\"Content-Length\"))\n    io.Copy(rw, resp.Body)\n    resp.Body.Close()\n\n}\n</code></pre>\n\n<p>//edit: misread the question, fixed the code now.</p>\n"}], "owner": {"reputation": 2597, "user_id": 1715055, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b29b29364de300edef57e8579ec8780?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1715055/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3420, "favorite_count": 0, "answer_count": 1, "score": 9, "last_activity_date": 1425610678, "creation_date": 1425609576, "last_edit_date": 1425610417, "question_id": 28891531, "link": "https://stackoverflow.com/questions/28891531/piping-http-response-to-http-responsewriter", "title": "Piping http.Response to http.ResponseWriter", "body": "<p>I'm trying to pipe a file that I receive from an API back to the user without having to store it all in memory.</p>\n\n<p>I've come across different concepts/ideas across my search, such as <code>io.Copy</code>, <code>io.Pipe()</code>, etc. I'm not sure which one is the correct solution. </p>\n\n<p>For example, <code>io.Pipe()</code> seems like it's for if someone is creating a new reader and writer on the spot, not ones that already exist.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 52116, "user_id": 197788, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/851acbab08553d1f7aa3eecad17f6aa9?s=128&d=identicon&r=PG", "display_name": "Ken Bloom", "link": "https://stackoverflow.com/users/197788/ken-bloom"}, "edited": false, "score": 1, "creation_date": 1425603486, "post_id": 28889818, "comment_id": 46042278, "body": "Even strftime doesn&#39;t support the suffixes."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "reply_to_user": {"reputation": 52116, "user_id": 197788, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/851acbab08553d1f7aa3eecad17f6aa9?s=128&d=identicon&r=PG", "display_name": "Ken Bloom", "link": "https://stackoverflow.com/users/197788/ken-bloom"}, "edited": false, "score": 0, "creation_date": 1425638019, "post_id": 28889818, "comment_id": 46053443, "body": "Sad. A missed opportunity, perhaps?"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "reply_to_user": {"reputation": 52116, "user_id": 197788, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/851acbab08553d1f7aa3eecad17f6aa9?s=128&d=identicon&r=PG", "display_name": "Ken Bloom", "link": "https://stackoverflow.com/users/197788/ken-bloom"}, "edited": false, "score": 1, "creation_date": 1568911007, "post_id": 28889818, "comment_id": 102434778, "body": "Some years later, I implemented a solution myself <a href=\"https://godoc.org/github.com/rickb777/date/view#VDate.Day2nd\" rel=\"nofollow noreferrer\">godoc.org/github.com/rickb777/date/view#VDate.Day2nd</a>"}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 6, "last_activity_date": 1425603250, "creation_date": 1425603250, "answer_id": 28890625, "question_id": 28889818, "link": "https://stackoverflow.com/questions/28889818/formatting-verbose-dates-in-go/28890625#28890625", "title": "Formatting Verbose Dates in Go", "body": "<p>It doesn't support that kind of formatting, you will have to implement it yourself, something (hacky) like this:</p>\n\n<pre><code>func formatDate(t time.Time) string {\n    suffix := \"th\"\n    switch t.Day() {\n    case 1, 21, 31:\n        suffix = \"st\"\n    case 2, 22:\n        suffix = \"nd\"\n    case 3, 23:\n        suffix = \"rd\"\n    }\n    return t.Format(\"Monday 2\" + suffix + \" January\")\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/9szb7X1mum\" rel=\"noreferrer\">play</a></kbd></p>\n"}], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 1, "accepted_answer_id": 28890625, "answer_count": 1, "score": 3, "last_activity_date": 1425603250, "creation_date": 1425598053, "question_id": 28889818, "link": "https://stackoverflow.com/questions/28889818/formatting-verbose-dates-in-go", "title": "Formatting Verbose Dates in Go", "body": "<p>I would like to produce formatted dates in a human-readable format. Typically in an English locale, suffixes are used for the day of the month, i.e. 1st, 2nd, 3rd, 4th, 5th and so on.</p>\n\n<p>I tried using the format string <code>\"Monday 2nd January\"</code> to format such dates but it doesn't appear to work.</p>\n\n<p>E.g. in <a href=\"http://play.golang.org/p/PnzohanHar\" rel=\"nofollow\">the playground</a>:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"time\"\n)\n\nconst format = \"Monday 2nd January\"\n\nfunc main() {\n    t1 := time.Date(2015, 3, 4, 1, 1, 1, 1, time.UTC)\n    fmt.Println(t1.Format(format))\n\n    t2 := time.Date(2015, 3, 1, 1, 1, 1, 1, time.UTC)\n    fmt.Println(t2.Format(format))\n}\n</code></pre>\n\n<p>This generates the result</p>\n\n<pre><code>Wednesday 4nd March\nSunday 1nd March\n</code></pre>\n\n<p>but I would expect</p>\n\n<pre><code>Wednesday 4th March\nSunday 1st March\n</code></pre>\n\n<p>What have I done wrong?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1425597857, "post_id": 28889698, "comment_id": 46040446, "body": "The arguments for <code>$subract</code> are an &quot;array&quot; of items. So just write an array as you normally would in Go."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 0, "creation_date": 1425602880, "post_id": 28890170, "comment_id": 46042098, "body": "You don&#39;t need to define a type: <code>bson.M{&quot;a&quot;: bson.M{ &quot;$subtract&quot;: []interface{}{date, &quot;$created&quot;}}}</code>"}], "tags": [], "owner": {"reputation": 41, "user_id": 3953860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724ab4e7864fe863904a09cd8aa780ac?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/3953860/luke"}, "is_accepted": true, "score": 1, "last_activity_date": 1506069242, "last_edit_date": 1506069242, "creation_date": 1425600238, "answer_id": 28890170, "question_id": 28889698, "link": "https://stackoverflow.com/questions/28889698/how-to-write-subtract-mongo-query-in-go-using-mgo-package/28890170#28890170", "title": "How to write $subtract mongo query in go using mgo package?", "body": "<p>the problem is that array would contain <code>time.Time</code> structure and <code>string</code>, so it is mixed type array... but i think i found the answer: <a href=\"https://stackoverflow.com/questions/19055037/how-to-represent-an-array-with-mixed-types\">How to represent an array with mixed types</a> </p>\n\n<pre><code>type list []interface{}\ndate := time.Now()\nsub := list{date, \"$created\"}\nbson.M{\n    \"a\":bson.M{\n        \"$subtract\":sub\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3953860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724ab4e7864fe863904a09cd8aa780ac?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/3953860/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 28890170, "answer_count": 1, "score": 2, "last_activity_date": 1506069242, "creation_date": 1425597475, "last_edit_date": 1425597921, "question_id": 28889698, "link": "https://stackoverflow.com/questions/28889698/how-to-write-subtract-mongo-query-in-go-using-mgo-package", "title": "How to write $subtract mongo query in go using mgo package?", "body": "<p>How to write following query in go using mgo package:</p>\n\n<pre><code>a:{$subtract:[variable,'$created']}\n</code></pre>\n\n<p>I tried </p>\n\n<pre><code>date := time.Now()\nbson.M{\n\"a\":bson.M{\n    \"$subtract\":bson.M{date,\"$created\"}\n}\n}\n</code></pre>\n\n<p>but bson.M is a map and asks me for keys ;(</p>\n"}, {"tags": ["google-app-engine", "go", "gcloud"], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 2330325, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36770fc7489816468b0744b7bf66f993?s=128&d=identicon&r=PG", "display_name": "Mark Hayden", "link": "https://stackoverflow.com/users/2330325/mark-hayden"}, "edited": false, "score": 0, "creation_date": 1426145797, "post_id": 28961380, "comment_id": 46254855, "body": "thanks christopher, i no longer see the trimpath error but now i am getting a GOROOT / GOPATH error. Any chance you can fill me in on how I should be setting my GOPATH and or GOROOT for gcloud? Assuming I am running into conflicts somewhere since i have appengine and gcloud all running on the same machine now? updated comment above with output."}, {"owner": {"reputation": 1039, "user_id": 1201422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b52a61797037f989c609529e16c414?s=128&d=identicon&r=PG", "display_name": "Chris Pushbullet", "link": "https://stackoverflow.com/users/1201422/chris-pushbullet"}, "reply_to_user": {"reputation": 475, "user_id": 2330325, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36770fc7489816468b0744b7bf66f993?s=128&d=identicon&r=PG", "display_name": "Mark Hayden", "link": "https://stackoverflow.com/users/2330325/mark-hayden"}, "edited": false, "score": 0, "creation_date": 1426180634, "post_id": 28961380, "comment_id": 46276883, "body": "I don&#39;t think you can use the package &quot;appengine&quot; on managed VM, that&#39;s not a thing.  You might mean &quot;google.golang.org/appengine&quot;"}], "tags": [], "owner": {"reputation": 1039, "user_id": 1201422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b52a61797037f989c609529e16c414?s=128&d=identicon&r=PG", "display_name": "Chris Pushbullet", "link": "https://stackoverflow.com/users/1201422/chris-pushbullet"}, "is_accepted": true, "score": 2, "last_activity_date": 1425983574, "creation_date": 1425983574, "answer_id": 28961380, "question_id": 28889027, "link": "https://stackoverflow.com/questions/28889027/go-appengine-managed-vm-issue-unknown-flag-trimpath/28961380#28961380", "title": "Go Appengine Managed VM issue: unknown flag -trimpath", "body": "<p>I <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/Q0ZYUbEjStc\" rel=\"nofollow\">posted about this</a> on the google-appengine-go list, the solution is to add the following line to your Dockerfile, at least until the base image is updated.</p>\n\n<pre><code>RUN rm -rf /goroot &amp;&amp; mkdir /goroot &amp;&amp; curl https://storage.googleapis.com/golang/go1.4.2.linux-amd64.tar.gz | tar xvzf - -C /goroot --strip-components=1\n</code></pre>\n"}], "owner": {"reputation": 475, "user_id": 2330325, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36770fc7489816468b0744b7bf66f993?s=128&d=identicon&r=PG", "display_name": "Mark Hayden", "link": "https://stackoverflow.com/users/2330325/mark-hayden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 1, "accepted_answer_id": 28961380, "answer_count": 1, "score": 0, "last_activity_date": 1426145975, "creation_date": 1425594463, "last_edit_date": 1592644375, "question_id": 28889027, "link": "https://stackoverflow.com/questions/28889027/go-appengine-managed-vm-issue-unknown-flag-trimpath", "title": "Go Appengine Managed VM issue: unknown flag -trimpath", "body": "<p>I am attempting to get a go app up on appengine using managed vms. As far as I can tell I have docker running locally fine and all the dependencies fulfilled but when I try and serve it locally I run into the following error:</p>\n<pre><code>INFO     2015-03-05 22:21:14,917 containers.py:280] /goroot/pkg/tool/linux_amd64/6g: unknown flag -trimpath\n\nINFO     2015-03-05 22:21:14,922 containers.py:280] 2015/03/05 22:21:14 go-app-builder: build timing: 1\u00d76g (5ms total), 0\u00d7gopack (0 total), 0\u00d76l (0 total)\n\nINFO     2015-03-05 22:21:14,923 containers.py:280] 2015/03/05 22:21:14 go-app-builder: failed running 6g: exit status 1\n</code></pre>\n<p>Running MacOs &amp; boot2docker. Have always been able to run appengine locally without issue so I assume this has something to do with docker / the go version there or something else goofy. Would be super grateful to anyone that can point me in the right direction. Doesn't seem to be much out there on this one.</p>\n<p>Full trace is below:</p>\n<pre><code>\u279c  appengine-try-go  gcloud preview app run ./app.yaml\nModule [default] found in file [/Users/markhayden/google-cloud-sdk/platform/google_appengine/goroot/src/appengine-try-go/app.yaml]\nINFO: Looking for the Dockerfile in /Users/markhayden/google-cloud-sdk/platform/google_appengine/goroot/src/appengine-try-go\nINFO: Using Dockerfile found in /Users/markhayden/google-cloud-sdk/platform/google_appengine/goroot/src/appengine-try-go\nINFO     2015-03-05 22:21:13,424 devappserver2.py:726] Skipping SDK update check.\nINFO     2015-03-05 22:21:13,485 api_server.py:172] Starting API server at: http://localhost:63533\nINFO     2015-03-05 22:21:13,521 vm_runtime_proxy_go.py:107] Starting Go VM Deployment process\nINFO     2015-03-05 22:21:13,521 dispatcher.py:186] Starting module &quot;default&quot; running at: http://localhost:8080\nINFO     2015-03-05 22:21:13,524 admin_server.py:118] Starting admin server at: http://localhost:8000\nINFO     2015-03-05 22:21:13,545 containers.py:259] Building docker image whiskey-tango-foxtrot.default.1 from /var/folders/lv/9hzw2s5d25v17j4wph5pl46c0000gn/T/tmpFreenWgo_deployment_dir/Dockerfile:\nINFO     2015-03-05 22:21:13,545 containers.py:261] --------------------  DOCKER BUILD  --------------------\nINFO     2015-03-05 22:21:14,312 containers.py:280] ---&gt; 3b6b889b2273\nINFO     2015-03-05 22:21:14,312 containers.py:280] Step 1 : ADD . /app\nINFO     2015-03-05 22:21:14,561 containers.py:280] ---&gt; b994e021ab2e\nINFO     2015-03-05 22:21:14,570 containers.py:280] Removing intermediate container 332c78e9be28\nINFO     2015-03-05 22:21:14,571 containers.py:280] Step 2 : RUN /bin/bash /app/_ah/build.sh\nINFO     2015-03-05 22:21:14,676 containers.py:280] ---&gt; Running in 7e4157c8b5b2\nINFO     2015-03-05 22:21:14,905 containers.py:280] b02fde1ce30965d84e52f461de37655580e16956  /app/_ah/gab\nINFO     2015-03-05 22:21:14,917 containers.py:280] /goroot/pkg/tool/linux_amd64/6g: unknown flag -trimpath\n\nINFO     2015-03-05 22:21:14,922 containers.py:280] 2015/03/05 22:21:14 go-app-builder: build timing: 1\u00d76g (5ms total), 0\u00d7gopack (0 total), 0\u00d76l (0 total)\n\nINFO     2015-03-05 22:21:14,923 containers.py:280] 2015/03/05 22:21:14 go-app-builder: failed running 6g: exit status 1\n\nERROR    2015-03-05 22:21:15,097 containers.py:283] The command [/bin/sh -c /bin/bash /app/_ah/build.sh] returned a non-zero code: 1\nINFO     2015-03-05 22:21:15,097 containers.py:292] --------------------------------------------------------\nINFO     2015-03-05 22:21:15,098 vm_runtime_proxy_go.py:133] Go VM Deployment process failed: Docker build aborted: The command [/bin/sh -c /bin/bash /app/_ah/build.sh] returned a non-zero code: 1\nERROR    2015-03-05 22:21:15,098 instance.py:280] Docker build aborted: The command [/bin/sh -c /bin/bash /app/_ah/build.sh] returned a non-zero code: 1\nINFO     2015-03-05 22:21:15,098 health_check_service.py:101] Health checks starting for instance 0.\n</code></pre>\n<p>For anyone looking, more verbose output can be found here: <a href=\"https://gist.github.com/markhayden/1090aa3c232f56788a1f\" rel=\"nofollow noreferrer\">https://gist.github.com/markhayden/1090aa3c232f56788a1f</a></p>\n<h3>Update</h3>\n<p>Now also getting <code>2015/03/12 07:34:09 Can't find package &quot;appengine&quot; in $GOPATH: cannot find package &quot;appengine&quot; in any of:</code> when trying to fire things up. Looks like the comment below might have solved the trimpath issue but now this one is stopping me from confirming. Anyone able to help me confirm how I should be setting my gopath / goroot to get this one resolved? Also, its unclear if its trying to locate the missing packages in the docker container or locally on my machine?</p>\n<pre><code>INFO     2015-03-12 07:34:11,311 containers.py:280] b02fde1ce30965d84e52f461de37655580e16956  /app/_ah/gab\nINFO     2015-03-12 07:34:11,359 containers.py:280] 2015/03/12 07:34:09 Can't find package &quot;appengine&quot; in $GOPATH: cannot find package &quot;appengine&quot; in any of:\n\nINFO     2015-03-12 07:34:11,360 containers.py:280]     /goroot/src/appengine (from $GOROOT)\n\nINFO     2015-03-12 07:34:11,364 containers.py:280]     /gopath/src/appengine (from $GOPATH)\n\nINFO     2015-03-12 07:34:11,720 containers.py:280] /tmp/work/main.go:4: can't find import: &quot;appengine&quot;\nINFO     2015-03-12 07:34:11,721 containers.py:280] 2015/03/12 07:34:09 go-app-builder: build timing: 3\u00d76g (355ms total), 0\u00d7gopack (0 total), 0\u00d76l (0 total)\n\nINFO     2015-03-12 07:34:11,722 containers.py:280] 2015/03/12 07:34:09 go-app-builder: failed running 6g: exit status 1\n\nERROR    2015-03-12 07:34:11,937 containers.py:283] The command [/bin/sh -c /bin/bash /app/_ah/build.sh] returned a non-zero code: 1\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1425587182, "post_id": 28886616, "comment_id": 46035344, "body": "See <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a>"}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 2592207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f7a1e13d654def0e5c086618ec67617?s=128&d=identicon&r=PG", "display_name": "BluBb_mADe", "link": "https://stackoverflow.com/users/2592207/blubb-made"}, "edited": false, "score": 2, "creation_date": 1492871055, "post_id": 28886764, "comment_id": 74171626, "body": "is it possible to get a oneliner like <code>Bar(Foo()[:])</code> working?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 438, "user_id": 2592207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f7a1e13d654def0e5c086618ec67617?s=128&d=identicon&r=PG", "display_name": "BluBb_mADe", "link": "https://stackoverflow.com/users/2592207/blubb-made"}, "edited": false, "score": 3, "creation_date": 1550091064, "post_id": 28886764, "comment_id": 96147312, "body": "@BluBb_mADe no. A slice is basically a struct under the <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">covers</a> with underlying references to: a buffer; its length; and its capacity. To initialize a slice&#39;s buffer - one needs addressable memory from the <i>heap</i> not the <i>stack</i> (where return values are stored) - as stack memory is not persistent outside of its function.  It&#39;s the same reason one can&#39;t do something like <a href=\"https://play.golang.org/p/edY6tPPlqeM\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 438, "user_id": 2592207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f7a1e13d654def0e5c086618ec67617?s=128&d=identicon&r=PG", "display_name": "BluBb_mADe", "link": "https://stackoverflow.com/users/2592207/blubb-made"}, "edited": false, "score": 4, "creation_date": 1550112731, "post_id": 28886764, "comment_id": 96153864, "body": "oh well, why do these things always have to be so logical."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 112, "last_activity_date": 1425586090, "creation_date": 1425586090, "answer_id": 28886764, "question_id": 28886616, "link": "https://stackoverflow.com/questions/28886616/convert-array-to-slice-in-go/28886764#28886764", "title": "Convert array to slice in Go", "body": "<p>This should work:</p>\n\n<pre><code>func Foo() [32]byte {\n    return [32]byte{'0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'}\n}\n\nfunc Bar(b []byte) {\n    fmt.Println(string(b))\n}\n\nfunc main() {\n    x := Foo()\n    Bar(x[:])\n}\n</code></pre>\n\n<p>And it doesn't create a copy of the underlying buffer</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 6, "creation_date": 1443545632, "post_id": 32849323, "comment_id": 53533010, "body": "The default for the lower bound is 0. The default for the upper bound is <code>len(x)</code> so <code>x[0:len(x)]</code> is better written as <code>x[:]</code>. Which is exactly what the existing answer says."}, {"owner": {"reputation": 8461, "user_id": 193982, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/961667038883e6f6832949ba3c98d13e?s=128&d=identicon&r=PG", "display_name": "Mike Gleason jr Couturier", "link": "https://stackoverflow.com/users/193982/mike-gleason-jr-couturier"}, "edited": false, "score": 12, "creation_date": 1467344403, "post_id": 32849323, "comment_id": 63704078, "body": "I find the number of downvotes a little harsh considering the validity of the solution..."}, {"owner": {"reputation": 196, "user_id": 100672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7c9c07e64a6b7b075097831c360d53?s=128&d=identicon&r=PG", "display_name": "Bill Katz", "link": "https://stackoverflow.com/users/100672/bill-katz"}, "edited": false, "score": 1, "creation_date": 1490023810, "post_id": 32849323, "comment_id": 72914716, "body": "Although the OP just wanted a full conversion of the underlying array, it&#39;s useful to know that specifying lower bound and upper bound is identical to slice annotation.  For example, you might want to allocate an array (instead of use make slice) then set portions of the array using lower bound/upper bound notation.  Example: <a href=\"https://play.golang.org/p/BwIvavioBj\" rel=\"nofollow noreferrer\">play.golang.org/p/BwIvavioBj</a>"}], "tags": [], "owner": {"reputation": 227, "user_id": 3850849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aJcEo.jpg?s=128&g=1", "display_name": "bowsky", "link": "https://stackoverflow.com/users/3850849/bowsky"}, "is_accepted": false, "score": 11, "last_activity_date": 1443544525, "creation_date": 1443544525, "answer_id": 32849323, "question_id": 28886616, "link": "https://stackoverflow.com/questions/28886616/convert-array-to-slice-in-go/32849323#32849323", "title": "Convert array to slice in Go", "body": "<p>This will do the trick:</p>\n\n<pre><code>slice := array[0:len(array)]\n</code></pre>\n\n<p>Also avoids copying the underlying buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 26374, "user_id": 229792, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/NIE5f.jpg?s=128&g=1", "display_name": "jameshfisher", "link": "https://stackoverflow.com/users/229792/jameshfisher"}, "is_accepted": false, "score": 62, "last_activity_date": 1483355849, "creation_date": 1483355849, "answer_id": 41425823, "question_id": 28886616, "link": "https://stackoverflow.com/questions/28886616/convert-array-to-slice-in-go/41425823#41425823", "title": "Convert array to slice in Go", "body": "<pre><code>arr[:]  // arr is an array; arr[:] is the slice of all elements\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3250, "user_id": 4801289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/I0puU.jpg?s=128&g=1", "display_name": "Ismail H", "link": "https://stackoverflow.com/users/4801289/ismail-h"}, "is_accepted": false, "score": 4, "last_activity_date": 1517687667, "creation_date": 1517687667, "answer_id": 48601389, "question_id": 28886616, "link": "https://stackoverflow.com/questions/28886616/convert-array-to-slice-in-go/48601389#48601389", "title": "Convert array to slice in Go", "body": "<p>You can generally slice an array by its bounds with <code>:</code> :</p>\n\n<pre><code>var a [32]byte \nslice := a[:]\n</code></pre>\n\n<p>More generally, for the following array :</p>\n\n<pre><code>var my_array [LENGTH]TYPE\n</code></pre>\n\n<p>You can produce the slice of different sizes by writing :</p>\n\n<pre><code>my_array[START_SLICE:END_SLICE]\n</code></pre>\n\n<p>Omitting <code>START_SLICE</code> if it equals to the low bound and <code>END_SLICE</code> if equals to the high bound, in your case :</p>\n\n<pre><code>a[0:32] \n</code></pre>\n\n<p>Produces the slice of the underlying array and is equivalent to :</p>\n\n<pre><code>a[0:]\na[:32]\na[:]\n</code></pre>\n"}], "owner": {"reputation": 3829, "user_id": 1146334, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cL3do.png?s=128&g=1", "display_name": "FuriousGeorge", "link": "https://stackoverflow.com/users/1146334/furiousgeorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42870, "favorite_count": 16, "accepted_answer_id": 28886764, "answer_count": 4, "score": 74, "last_activity_date": 1517687667, "creation_date": 1425585569, "question_id": 28886616, "link": "https://stackoverflow.com/questions/28886616/convert-array-to-slice-in-go", "title": "Convert array to slice in Go", "body": "<p>This seems like it would be a fairly common thing and abundant examples across the interwebs, but I can't seem to find an example of how to convert an <code>[32]byte</code> to <code>[]byte</code>.</p>\n\n<p>I have a function that I call from an external lib that returns an array</p>\n\n<pre><code>func Foo() [32]byte {...}\n</code></pre>\n\n<p>I then need to pass that result to a different function for further processing.</p>\n\n<pre><code>func Bar(b []byte) { ... }\n</code></pre>\n\n<p>Unforunately, if I try to call</p>\n\n<pre><code>d := Foo()\nBar(d)\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>cannot convert d (type [32]byte) to type []byte\n</code></pre>\n\n<p>Doing</p>\n\n<pre><code>[]byte(d)\n</code></pre>\n\n<p>isn't much better.  How do I do this, especially without creating a copy of the data (seems silly to copy this data when all I'm doing is passing it along).</p>\n"}, {"tags": ["unit-testing", "go", "mocking"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425584949, "post_id": 28885705, "comment_id": 46034113, "body": "Like you suggested, an interface would be a proper solution here. Are you just unsure how to define one?"}, {"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "edited": false, "score": 0, "creation_date": 1425595034, "post_id": 28885705, "comment_id": 46039299, "body": "An interface is a good solution. Another one is to use sqlite in memory database. If curious I have done so in this repo <a href=\"https://github.com/michaeljs1990/freetime/blob/master/app/session.go\" rel=\"nofollow noreferrer\">github.com/michaeljs1990/freetime/blob/master/app/session.go</a> ."}], "answers": [{"tags": [], "owner": {"reputation": 593, "user_id": 3380763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8083eb4cd5c69b1b1e9305bf2495d76?s=128&d=identicon&r=PG", "display_name": "yograterol", "link": "https://stackoverflow.com/users/3380763/yograterol"}, "is_accepted": false, "score": 4, "last_activity_date": 1425842385, "creation_date": 1425842385, "answer_id": 28930808, "question_id": 28885705, "link": "https://stackoverflow.com/questions/28885705/golang-mocking-functions-for-http-handler-tests/28930808#28930808", "title": "Golang mocking functions for http handler tests", "body": "<p>I recommend you a pair of links:</p>\n\n<p><a href=\"https://willnorris.com/2013/08/testing-in-go-github\" rel=\"nofollow\">Testing in Go - Github</a>: This link explain how do a mock route with a response using <code>mux</code> package.</p>\n\n<p>Example:</p>\n\n<pre><code>func TestUsersService_Get_specifiedUser(t *testing.T) {\n    setup()\n    defer teardown()\n\n    mux.HandleFunc(\"/users/u\", \n        func(w http.ResponseWriter, r *http.Request) {\n            testMethod(t, r, \"GET\")\n            fmt.Fprint(w, `{\"id\":1}`)\n        }\n    )\n\n    user, _, err := client.Users.Get(\"u\")\n    if err != nil {\n        t.Errorf(\"Users.Get returned error: %v\", err)\n    }\n\n    want := &amp;User{ID: Int(1)}\n    if !reflect.DeepEqual(user, want) {\n       t.Errorf(\"Users.Get returned %+v, want %+v\", \n                user, want)\n    }\n}  \n</code></pre>\n\n<p><a href=\"https://github.com/drewolson/testflight\" rel=\"nofollow\">testflight</a>: A package for make simple http request to a server, using testflight and <code>mux</code> for make mock endpoints you will can do a perfect test.</p>\n\n<p>Example:</p>\n\n<pre><code>func TestPostWithForm(t *testing.T) {\n    testflight.WithServer(Handler(), func(r *testflight.Requester) {\n        response := r.Post(\"/post/form\", testflight.FORM_ENCODED, \"name=Drew\")\n\n        assert.Equal(t, 201, response.StatusCode)\n        assert.Equal(t, \"Drew created\", response.Body)\n    })\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 973859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vS6pl.jpg?s=128&g=1", "display_name": "Phea Duch", "link": "https://stackoverflow.com/users/973859/phea-duch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6450, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1425842385, "creation_date": 1425582432, "question_id": 28885705, "link": "https://stackoverflow.com/questions/28885705/golang-mocking-functions-for-http-handler-tests", "title": "Golang mocking functions for http handler tests", "body": "<p>I am writing a unit test for my PostLoginHandler and need to mock a session middleware function. In my handler it calls session.Update() that I would like to mock to return nil.</p>\n\n<p>My first instinct after reading various answers was to make a SessionManager interface but even then I am unclear how to proceed.</p>\n\n<p>main.go:</p>\n\n<pre><code>func PostLoginHandler(c web.C, w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    user, pass := r.PostFormValue(\"username\"), r.PostFormValue(\"password\")\n    ctx := context.GetContext(c)\n\n    if !authorizeUser(user, pass) {\n        http.Error(w, \"Wrong username or password\", http.StatusBadRequest)\n        return\n    }\n\n    ctx.IsLogin = true\n    err := session.Update(ctx) \\\\ mock this function call.\n    if err != nil {\n        log.Println(err)\n        return\n    }\n    http.Redirect(w, r, \"/admin/\", http.StatusFound)\n}\n</code></pre>\n\n<p>main_test:</p>\n\n<pre><code>var loginTests = []struct {\n    username string\n    password string\n    code     int\n}{\n    {\"admin\", \"admin\", http.StatusFound},\n    {\"\", \"\", http.StatusBadRequest},\n    {\"\", \"admin\", http.StatusBadRequest},\n    {\"admin\", \"\", http.StatusBadRequest},\n    {\"admin\", \"badpassword\", http.StatusBadRequest},\n}\n\nfunc TestPostLoginHandler(t *testing.T) {\n    //  setup()\n    ctx := &amp;context.Context{IsLogin: false, Data: make(map[string]interface{})}\n    c := newC()\n    c.Env[\"context\"] = ctx\n\n    for k, test := range loginTests {\n        v := url.Values{}\n        v.Set(\"username\", test.username)\n        v.Set(\"password\", test.password)\n        r, _ := http.NewRequest(\"POST\", \"/login\", nil)\n        r.PostForm = v\n        resp := httptest.NewRecorder()\n        m.ServeHTTPC(c, resp, r)\n\n        if resp.Code != test.code {\n            t.Fatalf(\"TestPostLoginHandler #%v failed. Expected: %v\\tReceived: %v\", k, test.code, resp.Code)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "rabbitmq", "amqp"], "comments": [{"owner": {"reputation": 2053, "user_id": 342013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3eb24dc767e178a2c7d67f1ee1af11f?s=128&d=identicon&r=PG", "display_name": "old_sound", "link": "https://stackoverflow.com/users/342013/old-sound"}, "edited": false, "score": 0, "creation_date": 1425942571, "post_id": 28885109, "comment_id": 46160424, "body": "if you want to get a confirmation from the server that the message was delivered to a queue (and eventually persisted in case of persistent messages), then you need to use publisher confirms."}], "answers": [{"comments": [{"owner": {"reputation": 11687, "user_id": 158483, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d25c1d21b14f542800094c926c0f505b?s=128&d=identicon&r=PG", "display_name": "Pete", "link": "https://stackoverflow.com/users/158483/pete"}, "edited": false, "score": 0, "creation_date": 1425625730, "post_id": 28885389, "comment_id": 46047826, "body": "If I understand you correctly, that pretty much means that I cannot programatically provoke a publisher nack?"}, {"owner": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "reply_to_user": {"reputation": 11687, "user_id": 158483, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d25c1d21b14f542800094c926c0f505b?s=128&d=identicon&r=PG", "display_name": "Pete", "link": "https://stackoverflow.com/users/158483/pete"}, "edited": false, "score": 0, "creation_date": 1425646898, "post_id": 28885389, "comment_id": 46057797, "body": "You might be able to write some plugin for RabbitMQ which when you publish to a certain virtual host, exchange, and/or routing key would die on purpose in such a way as to force a publisher.nack.  But yes, in general it would not be possible."}], "tags": [], "owner": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "is_accepted": false, "score": 1, "last_activity_date": 1425581158, "creation_date": 1425581158, "answer_id": 28885389, "question_id": 28885109, "link": "https://stackoverflow.com/questions/28885109/how-do-i-verify-publisher-acknowledge-behavior/28885389#28885389", "title": "How do I verify publisher acknowledge behavior", "body": "<p>RabbitMQ will only return a <code>basic.nack</code> if</p>\n\n<blockquote>\n  <p>an internal error occurs in the Erlang process responsible for a queue.</p>\n</blockquote>\n\n<p>So, the <code>basic.ack</code>/<code>basic.nack</code> is only confirming if the RabbitMQ broker received the message, not if a \"final\" consumer did.  See the last sentence of \"Negative Acknowledgement\" on <a href=\"https://www.rabbitmq.com/confirms.html\" rel=\"nofollow\">this</a> page.</p>\n"}], "owner": {"reputation": 11687, "user_id": 158483, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d25c1d21b14f542800094c926c0f505b?s=128&d=identicon&r=PG", "display_name": "Pete", "link": "https://stackoverflow.com/users/158483/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1425581158, "creation_date": 1425580131, "question_id": 28885109, "link": "https://stackoverflow.com/questions/28885109/how-do-i-verify-publisher-acknowledge-behavior", "title": "How do I verify publisher acknowledge behavior", "body": "<p>I am writing a go program with publisher confirms, and I want to verify the behavior when a message can be delivered/not be delivered to the broker.</p>\n\n<p>I am doing this from an integration test that sets up a queue, and asks my system code to send to that queue name. Verifying the behavior for publisher ack is no problem, but I cannot provoke a situation that results in a publisher nack.</p>\n\n<p>I try to send a message to a non-existing queue with the following piece of code:</p>\n\n<pre><code>connection, err := amqp.Dial(\"amqp://localhost\")\nif err != nil {\n    panic(err)\n}\ndefer connection.Close()\nchannel, err := connection.Channel()\nif err != nil {\n    panic(err)\n}\nerr = channel.Confirm(false)\nif err != nil {\n    panic(err)\n}\npubAck, pubNack := channel.NotifyConfirm(make(chan uint64, 1), make(chan uint64, 1))\nfmt.Println(\"Publish to queue: \", queueName)\nmsg := amqp.Publishing{\n    Body: []byte(\"Hello\")}\nerr = channel.Publish(\"\", queueName, true, true, msg)\nif err != nil {\n    panic(err)\n}\nselect {\ncase &lt;-pubAck:\n    fmt.Println(\"Ack\")\ncase &lt;-pubNack:\n    fmt.Println(\"NAck\")\n}\n</code></pre>\n\n<p>The queue name is indeed a non existing queue, and executing <code>sudo rabbitmqctl list_queues</code> shows that the list of queues is empty.</p>\n\n<p>But it still prints \"Ack\"</p>\n\n<p>I have set both <code>mandatory</code> and <code>immediate</code> to true</p>\n\n<blockquote>\n  <p>Publishings can be undeliverable when the mandatory flag is\n  true and no queue is bound that matches the routing key, or when the\n  immediate flag is true and no consumer on the matched queue is ready\n  to accept the delivery</p>\n</blockquote>\n\n<p>Is my approach for sending to a non-existing queue a wrong approach, and is there another way I can send a message that will provoke a publisher nack?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 874, "user_id": 352842, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/dfa1eed6ce2f228613cba4a39e79f093?s=128&d=identicon&r=PG", "display_name": "Lars", "link": "https://stackoverflow.com/users/352842/lars"}, "edited": false, "score": 0, "creation_date": 1425819216, "post_id": 28886477, "comment_id": 46109332, "body": "This worked, but will this also happen if the query itself is very large? I would like to use $nin to make a query that excludes a lot of data. The problem is that if I do this, the $nin field has hundreds of thousands of items in it, causing the same crash."}, {"owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "reply_to_user": {"reputation": 874, "user_id": 352842, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/dfa1eed6ce2f228613cba4a39e79f093?s=128&d=identicon&r=PG", "display_name": "Lars", "link": "https://stackoverflow.com/users/352842/lars"}, "edited": false, "score": 0, "creation_date": 1425919435, "post_id": 28886477, "comment_id": 46148604, "body": "A query with hundreds of thousands of items in an exclusion list is also very bad, on any database. I would consider what the problem at hand is, consider what data structures are at play, what changes, how often, and then organize a more realistic solution."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1501599271, "post_id": 28886477, "comment_id": 77843486, "body": "Actually, even with a few rows error like this happens: <a href=\"https://github.com/go-mgo/mgo/issues/473\" rel=\"nofollow noreferrer\">github.com/go-mgo/mgo/issues/473</a>"}], "tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": true, "score": 6, "last_activity_date": 1425585031, "creation_date": 1425585031, "answer_id": 28886477, "question_id": 28884793, "link": "https://stackoverflow.com/questions/28884793/mgo-query-returns-eof-for-large-datasets/28886477#28886477", "title": "mgo query returns &quot;EOF&quot; for large datasets", "body": "<p>The <a href=\"http://gopkg.in/mgo.v2#Query.All\" rel=\"noreferrer\">All</a> method will load all matching data into memory, which is a very bad way to handle large data sets. With luck you'll get such timeouts before the method is finished, and in the worst case the machine will crash out of memory.</p>\n\n<p>On any sort of non-trivial data set, use normal iteration instead, with the <a href=\"http://gopkg.in/mgo.v2#Query.Iter\" rel=\"noreferrer\">Iter</a> and <a href=\"http://gopkg.in/mgo.v2#Iter.Next\" rel=\"noreferrer\">Next</a> methods.</p>\n"}], "owner": {"reputation": 874, "user_id": 352842, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/dfa1eed6ce2f228613cba4a39e79f093?s=128&d=identicon&r=PG", "display_name": "Lars", "link": "https://stackoverflow.com/users/352842/lars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 0, "accepted_answer_id": 28886477, "answer_count": 1, "score": 0, "last_activity_date": 1425585031, "creation_date": 1425579136, "last_edit_date": 1425581374, "question_id": 28884793, "link": "https://stackoverflow.com/questions/28884793/mgo-query-returns-eof-for-large-datasets", "title": "mgo query returns &quot;EOF&quot; for large datasets", "body": "<p>I want to perform a query that returns some data from my MongoDB server, but when the amount of data becomes big I get an \"EOF\" error from the c.Find().All() query.</p>\n\n<p>Basically I have:</p>\n\n<pre><code>activeData := []DataEntry{}\nactiveDataQuery := bson.M{\"data.active\": true}\nerr := sigdb.Find(activeDataQuery).All(&amp;activeData)\n</code></pre>\n\n<p>Which works fine for a small test with about 50,000 items, but when I try my full dataset, which is more than one million items, it returns \"EOF\", eventhough there is data there to be queried.</p>\n\n<p>What could be causing this? I am running both the Go program nad the MongoDB server on my laptop running Ubuntu 14.04 using Go 1.3.</p>\n\n<p>Edit: Upon further trials, I am also getting: \"write tcp 127.0.0.1:27017: broken pipe\" from the same query.</p>\n"}, {"tags": ["performance", "command-line", "go", "compilation"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1425569851, "post_id": 28881706, "comment_id": 46024743, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/28755916/go-how-does-go-run-file-go-work\">Go: How does go run file.go work</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1425569921, "post_id": 28881706, "comment_id": 46024789, "body": "Pass the <code>-x</code> flag to <code>run</code>, <code>build</code>, <code>get</code> or <code>install</code> to see what exactly is executed."}], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 404696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a63eba720ccd38f4aa1710ef93909458?s=128&d=identicon&r=PG", "display_name": "10 cls", "link": "https://stackoverflow.com/users/404696/10-cls"}, "edited": false, "score": 0, "creation_date": 1511032783, "post_id": 28881839, "comment_id": 81692655, "body": "There must be more to it than that - if I time the println in a helloworld, it runs faster with go run than compiled.  I noticed this on a more substantial program and see it&#39;s true all the way down to helloworld.  I&#39;d be interested to know why and at what point the results invert."}, {"owner": {"reputation": 386, "user_id": 7272253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca369b631d0b215c62ddb251aa671101?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Garnier", "link": "https://stackoverflow.com/users/7272253/nicolas-garnier"}, "reply_to_user": {"reputation": 1030, "user_id": 404696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a63eba720ccd38f4aa1710ef93909458?s=128&d=identicon&r=PG", "display_name": "10 cls", "link": "https://stackoverflow.com/users/404696/10-cls"}, "edited": false, "score": 0, "creation_date": 1552053795, "post_id": 28881839, "comment_id": 96877464, "body": "@10cls I didn&#39;t notice such behavior on my system. <code>go run</code> writes the executable in a temporary directory whereas <code>go build</code> writes it in the current directory. Maybe your temporary directory is a ramdisk?"}], "tags": [], "owner": {"reputation": 2166, "user_id": 3103130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uwRyn.jpg?s=128&g=1", "display_name": "Innominate", "link": "https://stackoverflow.com/users/3103130/innominate"}, "is_accepted": true, "score": 45, "last_activity_date": 1425570057, "creation_date": 1425570057, "answer_id": 28881839, "question_id": 28881706, "link": "https://stackoverflow.com/questions/28881706/golang-difference-between-go-run-main-go-and-compilation/28881839#28881839", "title": "Golang - Difference between &quot;go run main.go&quot; and compilation", "body": "<p><code>go run</code> is just a shortcut for compiling then running in a single step. While it is useful for development you should generally build it and run the binary directly when using it in production.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 6057672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08987bd7137e79161e0db880d230b336?s=128&d=identicon&r=PG&f=1", "display_name": "jagadeesh m", "link": "https://stackoverflow.com/users/6057672/jagadeesh-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1460828132, "creation_date": 1460828132, "answer_id": 36667447, "question_id": 28881706, "link": "https://stackoverflow.com/questions/28881706/golang-difference-between-go-run-main-go-and-compilation/36667447#36667447", "title": "Golang - Difference between &quot;go run main.go&quot; and compilation", "body": "<p>'go install' command will create shared library compiled file as package.a under pkg folder and exec file under bin directory.</p>\n\n<p>go run command is useful while doing development as it just compiles and run it for you but won't produce binaries in pkg folder and src folder</p>\n"}, {"tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 2, "last_activity_date": 1552593887, "last_edit_date": 1552593887, "creation_date": 1552515245, "answer_id": 55151955, "question_id": 28881706, "link": "https://stackoverflow.com/questions/28881706/golang-difference-between-go-run-main-go-and-compilation/55151955#55151955", "title": "Golang - Difference between &quot;go run main.go&quot; and compilation", "body": "<p>For DEV (local) environment - use <code>go run</code>,\n<br>For PROD environment - use <code>go install</code> this one better than <code>go build</code> because it installs packages and dependencies and you'll have Go toolchain.</p>\n"}], "owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15557, "favorite_count": 3, "accepted_answer_id": 28881839, "answer_count": 3, "score": 27, "last_activity_date": 1552593887, "creation_date": 1425569744, "question_id": 28881706, "link": "https://stackoverflow.com/questions/28881706/golang-difference-between-go-run-main-go-and-compilation", "title": "Golang - Difference between &quot;go run main.go&quot; and compilation", "body": "<p>After writing some scripts in Go I asked myself if there is any difference between the compilation of a <code>.go</code>-file and the later execution and the <code>go run FILE.go</code> command in terms of performence etc.</p>\n\n<p>Are there any advantages if I start a webservice with one of these methods?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1425569137, "post_id": 28881072, "comment_id": 46024206, "body": "if it helps, in go1.5 there will be an easier way to use a relative path for linking <a href=\"http://stackoverflow.com/questions/28037827/how-to-use-a-relative-path-for-ldflags-in-golang/28049658#28049658\" title=\"how to use a relative path for ldflags in golang\">stackoverflow.com/questions/28037827/&hellip;</a>"}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1425570058, "post_id": 28881072, "comment_id": 46024889, "body": "@JimB Yes that&#39;s good to know."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1425568714, "creation_date": 1425568714, "answer_id": 28881331, "question_id": 28881072, "link": "https://stackoverflow.com/questions/28881072/how-to-add-c-files-in-a-subdirectory-as-part-of-go-build-by-using-pseudo-cgo-dir/28881331#28881331", "title": "How to add C files in a subdirectory as part of go build by using pseudo CGO directives?", "body": "<p>Not really. The only option you have is to make the subdirectory another Go package, but then you'd have to wrap any functionality you need in exported Go functions, and import it into your project.</p>\n\n<p>The compiling of C/C++ files is a convenience for basic requirements, but anything more complicated will require building your source separately, and providing the proper CGO directives for linking. The Go toolchain isn't meant to be a complete build tool.</p>\n"}], "owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "accepted_answer_id": 28881331, "answer_count": 1, "score": 4, "last_activity_date": 1425568714, "creation_date": 1425567978, "question_id": 28881072, "link": "https://stackoverflow.com/questions/28881072/how-to-add-c-files-in-a-subdirectory-as-part-of-go-build-by-using-pseudo-cgo-dir", "title": "How to add C files in a subdirectory as part of go build by using pseudo CGO directives?", "body": "<p>Per docs, <code>go build</code> with cgo will add any C/C++ files in the root of the package as part of the compilation. Is there a way to make C/C++ files in a given subdirectory to also be part of the compilation as well as the ones in the root by using CGO directives?</p>\n"}, {"tags": ["string", "go", "formatting", "hex"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 3, "last_activity_date": 1425565526, "creation_date": 1425565526, "answer_id": 28880134, "question_id": 28880032, "link": "https://stackoverflow.com/questions/28880032/convert-hex-to-alphabet/28880134#28880134", "title": "Convert hex to alphabet", "body": "<p>You could use a <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow\"><code>fmt.Printf()</code></a> format (<a href=\"http://play.golang.org/p/mZTh7oY1au\" rel=\"nofollow\">example</a>):</p>\n\n<pre><code>func main() {\n    a := []byte{0x61}\n    c := hex.Dump(a)\n    fmt.Printf(\"'%+v' -- '%s'\\n\", c, a)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>'00000000  61                                                |a|\n' -- 'a'\n</code></pre>\n\n<p>The <code>%s</code> format is enough to convert the <code>0x61</code> in '<code>a</code>'.</p>\n"}, {"tags": [], "owner": {"reputation": 1172, "user_id": 504262, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/73f854ddc54795abe5bd0fe1e914ed7e?s=128&d=identicon&r=PG", "display_name": "satran", "link": "https://stackoverflow.com/users/504262/satran"}, "is_accepted": false, "score": 0, "last_activity_date": 1425578478, "creation_date": 1425578478, "answer_id": 28884608, "question_id": 28880032, "link": "https://stackoverflow.com/questions/28880032/convert-hex-to-alphabet/28884608#28884608", "title": "Convert hex to alphabet", "body": "<p>If you just want the string you can you <code>fmt.Sprintf</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    a := []byte{0x61}\n    c := fmt.Sprintf(\"%s\", a)\n    fmt.Println(c)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1425641474, "post_id": 28897571, "comment_id": 46055130, "body": "I picked up on the &quot;misleading&quot; part but tried a straightforward answer first, waiting for the OP to clarify. Yours is much more complete. +1"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1425640273, "last_edit_date": 1495541212, "creation_date": 1425640273, "answer_id": 28897571, "question_id": 28880032, "link": "https://stackoverflow.com/questions/28880032/convert-hex-to-alphabet/28897571#28897571", "title": "Convert hex to alphabet", "body": "<p>Your question is a little misleading.</p>\n\n<p>Based on your question what you really want is convert a <code>byte</code> value or a <code>[]byte</code> (byte slice) to a <code>string</code> or character (which is more or less a <code>rune</code> in Go).</p>\n\n<p>Henceforth I will separate the single <code>byte</code> value from the <code>[]byte</code> using these variables:</p>\n\n<pre><code>b := byte(0x61)\nbs := []byte{b}\n</code></pre>\n\n<p>To convert it to a <code>string</code>, you can simply use a conversion which is the cleanest and most simple:</p>\n\n<pre><code>s := string(bs)\n</code></pre>\n\n<p>If you want it as a \"character\", you can convert it to a <code>rune</code>:</p>\n\n<pre><code>r := rune(b)\n</code></pre>\n\n<p>Another solution is using <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow noreferrer\"><code>fmt.Printf()</code></a> as mentioned in <a href=\"https://stackoverflow.com/a/28884608/1705598\">VonC's answer</a> and using the <code>%s</code> verb which is:</p>\n\n<pre><code>%s  the uninterpreted bytes of the string or slice\n</code></pre>\n\n<p>You might want to take a look at these alternatives:</p>\n\n<pre><code>%c  the character represented by the corresponding Unicode code point\n%q  a single-quoted character literal safely escaped with Go syntax.\n</code></pre>\n\n<p><code>%q</code> accepts both a <code>byte</code>, <code>[]byte</code> and <code>rune</code>.</p>\n\n<p>See this litte example to demonstrate these (try it on the <a href=\"http://play.golang.org/p/GM-ILRIS1t\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>b := byte(0x61)\nbs := []byte{b}\n\nfmt.Printf(\"%s\\n\", bs)\nfmt.Printf(\"%c\\n\", b)\nfmt.Println(string(bs))\n\nfmt.Printf(\"%q\\n\", bs)\nfmt.Printf(\"%q\\n\", b)\nfmt.Printf(\"%q\\n\", rune(b))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>a\na\na\n\"a\"\n'a'\n'a'\n</code></pre>\n\n<p>If you need the result as a <code>string</code>, you can use the <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf()</code></a> variant mentioned in <a href=\"https://stackoverflow.com/a/28884608/1705598\">satran's answer</a> like this:</p>\n\n<pre><code>s := fmt.Sprintf(\"%s\", bs)\n</code></pre>\n\n<p>But it's easier to just use the <code>string</code> conversion (<code>string(bs)</code>).</p>\n"}], "owner": {"reputation": 3424, "user_id": 3918985, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4349dc6a41c144c486e982afb327fca7?s=128&d=identicon&r=PG&f=1", "display_name": "user3918985", "link": "https://stackoverflow.com/users/3918985/user3918985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1561813013, "creation_date": 1425565295, "last_edit_date": 1561813013, "question_id": 28880032, "link": "https://stackoverflow.com/questions/28880032/convert-hex-to-alphabet", "title": "Convert hex to alphabet", "body": "<p>How do I obtain the alphabet value from the hex value in Go?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/hex\"\n    \"fmt\"\n)\n\nfunc main() {\n    a := []byte{0x61}\n    c := hex.Dump(a)\n    fmt.Println(c,a)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/7iAs2kKw5v\" rel=\"nofollow\">http://play.golang.org/p/7iAs2kKw5v</a></p>\n"}, {"tags": ["dictionary", "go", "slice"], "comments": [{"owner": {"reputation": 4447, "user_id": 1294864, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dLaJj.jpg?s=128&g=1", "display_name": "Bono", "link": "https://stackoverflow.com/users/1294864/bono"}, "edited": false, "score": 0, "creation_date": 1425563483, "post_id": 28879323, "comment_id": 46020467, "body": "Could you also post your expected output?"}, {"owner": {"reputation": 43, "user_id": 1859725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbceeea2202a99e3c034327826cb8d56?s=128&d=identicon&r=PG", "display_name": "Ronny Herzog", "link": "https://stackoverflow.com/users/1859725/ronny-herzog"}, "reply_to_user": {"reputation": 4447, "user_id": 1294864, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dLaJj.jpg?s=128&g=1", "display_name": "Bono", "link": "https://stackoverflow.com/users/1294864/bono"}, "edited": false, "score": 0, "creation_date": 1425655120, "post_id": 28879323, "comment_id": 46062970, "body": "The expected output under &quot;Modified Map&quot; should be &quot;xxx&quot; for 1, 2 and 3. Similar to the output under &quot;Modified List&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 1859725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbceeea2202a99e3c034327826cb8d56?s=128&d=identicon&r=PG", "display_name": "Ronny Herzog", "link": "https://stackoverflow.com/users/1859725/ronny-herzog"}, "edited": false, "score": 0, "creation_date": 1425655030, "post_id": 28879823, "comment_id": 46062897, "body": "I see. This makes sense. Thanks a lot for the hint!"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 1, "last_activity_date": 1425565823, "last_edit_date": 1425565823, "creation_date": 1425564723, "answer_id": 28879823, "question_id": 28879323, "link": "https://stackoverflow.com/questions/28879323/modified-slice-elements-not-accessible-with-map-what-am-i-doing-wrong/28879823#28879823", "title": "Modified slice elements not accessible with map. What am I doing wrong?", "body": "<p>I would just consistently use pointers in slices and maps. That simplifies a lot.</p>\n\n<p>As you are using slices of values, it happens that <code>&amp;t[i]</code> after <code>append</code> operation becomes a pointer to an element in the old discarded slice. When you accessing it you are accessing the element of the old slice. Therefore map is referencing an element of a old slice.</p>\n\n<p>Using pointers solves the problem because there is only one copy of each <code>Test</code> structure and multiple pointers to them. It does not matter whether the pointers are in old slice, new slice or map.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Test struct {\n    one int\n    two *string\n}\n\ntype List []*Test\ntype MapToList map[int]*Test\n\nfunc MakeTest() (t List, mt MapToList) {\n\n    t = []*Test{}\n    mt = make(map[int]*Test)\n\n    var one, two, three string\n    one = \"one\"\n    two = \"two\"\n    three = \"three\"\n\n    t = append(t, &amp;Test{1, &amp;one})\n    mt[1] = t[len(t)-1]\n    t = append(t, &amp;Test{2, &amp;two})\n    mt[2] = t[len(t)-1]\n    t = append(t, &amp;Test{3, &amp;three})\n    mt[3] = t[len(t)-1]\n\n    return\n}\n\nfunc (s *List) Modify() {\n    for index := range *s {\n        var str string = \"xxx\"\n        (*s)[index].two = &amp;str\n    }\n}\n\nfunc main() {\n\n    t, mt := MakeTest()\n\n    fmt.Println(\"Orginal\")\n    for index := range t{\n        fmt.Println(index, t[index].one, *t[index].two)\n    }\n\n    t.Modify()  \n\n    fmt.Println(\"Modified List\")\n    for index := range t{\n        fmt.Println(index, t[index].one, *t[index].two)\n    }\n\n    fmt.Println(\"Modified Map\")\n    for key, value := range mt {\n        fmt.Println(key, value.one, *value.two)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KvG3Mj4v1u\" rel=\"nofollow\">https://play.golang.org/p/KvG3Mj4v1u</a></p>\n\n<p>The output is</p>\n\n<pre><code>Orginal\n0 1 one\n1 2 two\n2 3 three\nModified List\n0 1 xxx\n1 2 xxx\n2 3 xxx\nModified Map\n1 1 xxx\n2 2 xxx\n3 3 xxx\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 1859725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbceeea2202a99e3c034327826cb8d56?s=128&d=identicon&r=PG", "display_name": "Ronny Herzog", "link": "https://stackoverflow.com/users/1859725/ronny-herzog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 28879823, "answer_count": 1, "score": 2, "last_activity_date": 1425565823, "creation_date": 1425563211, "last_edit_date": 1425564775, "question_id": 28879323, "link": "https://stackoverflow.com/questions/28879323/modified-slice-elements-not-accessible-with-map-what-am-i-doing-wrong", "title": "Modified slice elements not accessible with map. What am I doing wrong?", "body": "<p>I have a slice of a more or less complex struct and I want all elements of this slice to be accessible with a map. The map contains pointers to the slice elements. My problem is now that when I change the content of a slice element, it is not reflected in the map pointing to this element. I.e. If I access the changed elements from the slice, I see the changes. If I however access the element from my map, I don't see the change. </p>\n\n<p>I made an abstract code example you'll find below. Here it gets even more strange since I see the change in one element although all should be changed.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Test struct {\n    one int\n    two *string\n}\n\ntype List []Test\ntype MapToList map[int]*Test\n\nfunc MakeTest() (t List, mt MapToList) {\n\n    t = []Test{}\n    mt = make(map[int]*Test)\n\n    var one, two, three string\n    one = \"one\"\n    two = \"two\"\n    three = \"three\"\n\n    t = append(t, Test{1, &amp;one})\n    mt[1] = &amp;t[len(t)-1]\n    t = append(t, Test{2, &amp;two})\n    mt[2] = &amp;t[len(t)-1]\n    t = append(t, Test{3, &amp;three})\n    mt[3] = &amp;t[len(t)-1]\n\n    return\n}\n\nfunc (s *List) Modify() {\n    for index := range *s {\n        var str string = \"xxx\"\n        (*s)[index].two = &amp;str\n    }\n}\n\nfunc main() {\n\n    t, mt := MakeTest()\n\n    fmt.Println(\"Orginal\")\n    for index := range t{\n        fmt.Println(index, t[index].one, *t[index].two)\n    }\n\n    t.Modify()  \n\n    fmt.Println(\"Modified List\")\n    for index := range t{\n        fmt.Println(index, t[index].one, *t[index].two)\n    }\n\n    fmt.Println(\"Modified Map\")\n    for key, value := range mt {\n        fmt.Println(key, value.one, *value.two)\n    }\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Orginal\n0 1 one\n1 2 two\n2 3 three\nModified List\n0 1 xxx\n1 2 xxx\n2 3 xxx\nModified Map\n1 1 one\n2 2 two\n3 3 xxx\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3949, "user_id": 1816872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1V08e.jpg?s=128&g=1", "display_name": "Ivan Black", "link": "https://stackoverflow.com/users/1816872/ivan-black"}, "edited": false, "score": 1, "creation_date": 1425565131, "post_id": 28879220, "comment_id": 46021456, "body": "You can to use <code>map[string]*Track</code> <a href=\"https://play.golang.org/p/l8evRcRAme\" rel=\"nofollow noreferrer\">play</a> or see answer of SirDarius"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1425566199, "post_id": 28879220, "comment_id": 46022127, "body": "<a href=\"http://stackoverflow.com/questions/20224478/dereferencing-a-map-index-in-golang\" title=\"dereferencing a map index in golang\">stackoverflow.com/questions/20224478/&hellip;</a> might be relevant, as it explains that you cannot obtain a pointer to a value in a map"}], "answers": [{"tags": [], "owner": {"reputation": 25491, "user_id": 49197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15ebf24a33a29b9efbf9924f530dd736?s=128&d=identicon&r=PG", "display_name": "Hynek -Pichi- Vychodil", "link": "https://stackoverflow.com/users/49197/hynek-pichi-vychodil"}, "is_accepted": false, "score": 0, "last_activity_date": 1425566005, "last_edit_date": 1425566005, "creation_date": 1425563350, "answer_id": 28879367, "question_id": 28879220, "link": "https://stackoverflow.com/questions/28879220/go-language-how-to-change-value-of-object-inside-of-pointer-of-map/28879367#28879367", "title": "GO language how to change value of object inside of pointer of map", "body": "<p>I didn't found how to get pointer to value in map so I think you have to use <code>map[string]*Track</code> instead and then work with pointers to <code>Track</code> structure in your <code>Working</code> function.</p>\n\n<p>See <a href=\"https://play.golang.org/p/2XJTcKn1md\" rel=\"nofollow\">https://play.golang.org/p/2XJTcKn1md</a></p>\n\n<p>If you are trying modify tracks in parallel you are may be looking for something like this <a href=\"https://play.golang.org/p/1GhST34wId\" rel=\"nofollow\">https://play.golang.org/p/1GhST34wId</a></p>\n\n<p>Note missing buffer in chanel and <code>go Working</code> in <code>for range tracks</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 0, "last_activity_date": 1425564487, "creation_date": 1425564487, "answer_id": 28879749, "question_id": 28879220, "link": "https://stackoverflow.com/questions/28879220/go-language-how-to-change-value-of-object-inside-of-pointer-of-map/28879749#28879749", "title": "GO language how to change value of object inside of pointer of map", "body": "<p>In the range loop: </p>\n\n<pre><code>for _, track := range tracks {\n    // send track to channel to change the name\n    Working(&amp;track, &amp;c)\n}\n</code></pre>\n\n<p>the <code>track</code> variable is actually a copy of the value contained in the map, because the assignement here works on the <code>Track</code> value type, and in Go, values are copied when assigned.</p>\n\n<p>What you should do instead is use the key of your map and assign the values from within the loop.</p>\n\n<pre><code>for key := range tracks {\n    t := tracks[key]\n    // send track to channel to change the name\n    Working(&amp;t, &amp;c)\n    tracks[key] = t\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/9naDP3SfNh\" rel=\"nofollow\">https://play.golang.org/p/9naDP3SfNh</a></p>\n"}], "owner": {"reputation": 519, "user_id": 3864828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000203717602/picture?type=large", "display_name": "Rodrigo Oliveira", "link": "https://stackoverflow.com/users/3864828/rodrigo-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 28879749, "answer_count": 2, "score": -2, "last_activity_date": 1425566005, "creation_date": 1425562895, "question_id": 28879220, "link": "https://stackoverflow.com/questions/28879220/go-language-how-to-change-value-of-object-inside-of-pointer-of-map", "title": "GO language how to change value of object inside of pointer of map", "body": "<p>How can I do it?</p>\n\n<p>I have the list of objects, I want list all and change the name of object.\nI have the list and I'm doing a while end send to another function, there I change the name, but the name doesn't save. </p>\n\n<p>Any idea how can I do it?</p>\n\n<p><a href=\"https://play.golang.org/p/el3FtwC-3U\" rel=\"nofollow\">https://play.golang.org/p/el3FtwC-3U</a></p>\n\n<p>And if there is any book that I can read to learn more, please. \nThank for helping me =D</p>\n"}, {"tags": ["user-interface", "go", "qml", "qt-quick", "qtquick2"], "comments": [{"owner": {"reputation": 7002, "user_id": 2538363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a17eb0f935aaff6b21269f57ccdc1bd?s=128&d=identicon&r=PG", "display_name": "BaCaRoZzo", "link": "https://stackoverflow.com/users/2538363/bacarozzo"}, "edited": false, "score": 1, "creation_date": 1425577754, "post_id": 28878533, "comment_id": 46029905, "body": "Native styling is available on Mac OS. I think your question is a sort of duplicate of <a href=\"http://stackoverflow.com/questions/21770426/in-qt-qml-controls-applicationwindow-lacks-the-native-looking-theme-when-run\">this question</a>: the provided answer should apply to your problem."}, {"owner": {"reputation": 165, "user_id": 460872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b30376cec23efdbd3b478fe8984cf31f?s=128&d=identicon&r=PG", "display_name": "Alexandre Van de Sande", "link": "https://stackoverflow.com/users/460872/alexandre-van-de-sande"}, "reply_to_user": {"reputation": 7002, "user_id": 2538363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a17eb0f935aaff6b21269f57ccdc1bd?s=128&d=identicon&r=PG", "display_name": "BaCaRoZzo", "link": "https://stackoverflow.com/users/2538363/bacarozzo"}, "edited": false, "score": 0, "creation_date": 1425590470, "post_id": 28878533, "comment_id": 46037092, "body": "I&#39;m not sure if it applies. The default style has the app title bar AND the colored buttons. I want the coloured buttons without (or with a customised) titlebar."}, {"owner": {"reputation": 7002, "user_id": 2538363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a17eb0f935aaff6b21269f57ccdc1bd?s=128&d=identicon&r=PG", "display_name": "BaCaRoZzo", "link": "https://stackoverflow.com/users/2538363/bacarozzo"}, "edited": false, "score": 0, "creation_date": 1425590596, "post_id": 28878533, "comment_id": 46037157, "body": "Uhm...it does not apply. The default theme is thought to be used &quot;as is&quot;. Applying customization removes the default theme. It&#39;s like that to minimize inconsistencies."}, {"owner": {"reputation": 7796, "user_id": 633267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2039c76871a343a2acd51950fe4c36d6?s=128&d=identicon&r=PG", "display_name": "Tod", "link": "https://stackoverflow.com/users/633267/tod"}, "edited": false, "score": 3, "creation_date": 1425765529, "post_id": 28878533, "comment_id": 46098357, "body": "Not that this helps, but your proposed design would violate the Apple Human Interface Guidelines for Windows. You should have a very good reason (and possibly a degree in design and usability engineering :)  for doing this. Something to think about. <a href=\"https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/OSXHIGuidelines/WindowAppearanceBehavior.html#//apple_ref/doc/uid/20000957-CH33-SW1\" rel=\"nofollow noreferrer\">developer.apple.com/library/mac/documentation/UserExperience&zwnj;&#8203;/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 1309619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177a41e31b4764de050747636b82f2c3?s=128&d=identicon&r=PG", "display_name": "ervinbosenbacher", "link": "https://stackoverflow.com/users/1309619/ervinbosenbacher"}, "edited": false, "score": 0, "creation_date": 1491293554, "post_id": 36247184, "comment_id": 73475123, "body": "It would have been nice if you add &quot;macwindow.h&quot; to your post"}, {"owner": {"reputation": 136, "user_id": 1704192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7412729a1f9038d08430d6a5218db4?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1704192/eduard"}, "reply_to_user": {"reputation": 1481, "user_id": 1309619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177a41e31b4764de050747636b82f2c3?s=128&d=identicon&r=PG", "display_name": "ervinbosenbacher", "link": "https://stackoverflow.com/users/1309619/ervinbosenbacher"}, "edited": false, "score": 1, "creation_date": 1491384806, "post_id": 36247184, "comment_id": 73524356, "body": "I don&#39;t have this example on my PC anymore, but the header is just the default header you get, when you create a class (make sure to change the cpp to mm in the class creation wizard). There is only the constructor, no other methods. The constructor has to take a long as parameter. No special header includes or so, thats handled in the mm file.  By the way, I found some bugs are fixed, if you use:     <code>QQuickWindow::setSceneGraphBackend(QSGRendererInterface::Sof&zwnj;&#8203;tware);</code> at the beginning of your main. This sets it to software rendering in Qt 5.8 and up."}], "tags": [], "owner": {"reputation": 136, "user_id": 1704192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7412729a1f9038d08430d6a5218db4?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1704192/eduard"}, "is_accepted": false, "score": 4, "last_activity_date": 1459080798, "creation_date": 1459080798, "answer_id": 36247184, "question_id": 28878533, "link": "https://stackoverflow.com/questions/28878533/how-to-create-a-window-without-a-title-bar-but-with-the-close-minimize-maximizie/36247184#36247184", "title": "How to create a window without a title bar but with the close/minimize/maximizie buttons in QML?", "body": "<p>You can use objective-c to setup your window correctly. This might be a little buggy, but I got it working through this (create a separate .mm class):</p>\n\n<pre><code>#include \"macwindow.h\"\n#include &lt;Cocoa.h&gt;\n\nMacWindow::MacWindow(long winid)\n{\n   NSView *nativeView = reinterpret_cast&lt;NSView *&gt;(winid);\n   NSWindow* nativeWindow = [nativeView window];\n\n   [nativeWindow setStyleMask:[nativeWindow styleMask] | NSFullSizeContentViewWindowMask | NSWindowTitleHidden];\n   [nativeWindow setTitlebarAppearsTransparent:YES];\n\n   [nativeWindow setMovableByWindowBackground:YES];\n}\n</code></pre>\n\n<p>In your main.cpp you need to pass the window id like this:</p>\n\n<pre><code>#include &lt;QGuiApplication&gt;\n#include &lt;QQmlApplicationEngine&gt;\n#include &lt;QWindow&gt;\n#include \"macwindow.h\"\n\nint main(int argc, char *argv[])\n{\n    QGuiApplication app(argc, argv);\n\n    QQmlApplicationEngine engine;\n    engine.load(QUrl(QStringLiteral(\"qrc:/main.qml\")));\n\n    QWindowList windows = QGuiApplication::allWindows();\n    QWindow* win = windows.first();\n\n    MacWindow* mac = new MacWindow(win-&gt;winId());\n\n    return app.exec();\n}   \n</code></pre>\n\n<p>In your .pro file you'll need to add the Cocoa reference:</p>\n\n<pre><code>macx:LIBS += -framework Foundation -framework Cocoa\nmacx:INCLUDEPATH += /System/Library/Frameworks/Foundation.framework/Versions/C/Headers \\\n/System/Library/Frameworks/AppKit.framework/Headers \\\n/System/Library/Frameworks/Cocoa.framework/Headers\n</code></pre>\n\n<p>Not sure why, but I had to add a TextEdit with the focus attribute to get the window drawn correctly, otherwise it appeared just black (my main.qml):</p>\n\n<pre><code>import QtQuick 2.5\nimport QtQuick.Window 2.2\nimport QtQuick.Controls 1.4\n\nApplicationWindow {\n    visible: true\n    color: \"white\"\n    width: 600\n    height: 400\n    minimumWidth: width\n    minimumHeight: height\n    maximumWidth: width\n    maximumHeight: height\n\n    Rectangle {\n        anchors.fill: parent\n        color: \"white\"\n\n        TextEdit {\n            opacity: 0\n            focus: true\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LYS3G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LYS3G.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 165, "user_id": 460872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b30376cec23efdbd3b478fe8984cf31f?s=128&d=identicon&r=PG", "display_name": "Alexandre Van de Sande", "link": "https://stackoverflow.com/users/460872/alexandre-van-de-sande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4900, "favorite_count": 5, "answer_count": 1, "score": 6, "last_activity_date": 1459080798, "creation_date": 1425560653, "question_id": 28878533, "link": "https://stackoverflow.com/questions/28878533/how-to-create-a-window-without-a-title-bar-but-with-the-close-minimize-maximizie", "title": "How to create a window without a title bar but with the close/minimize/maximizie buttons in QML?", "body": "<p>I want to create an application without the title bar, but with native close, minimize and maximize buttons. This is the intent of the layout:</p>\n\n<p><img src=\"https://i.stack.imgur.com/TZcMa.png\" alt=\"how it would look like on mac\"></p>\n\n<p>The app is built using Go and QML. I was able to remove the title bars by adding:</p>\n\n<pre><code>flags: Qt.FramelessWindowHint | Qt.Window\n</code></pre>\n\n<p>But this means that I'm having to recreate all kinds of native behaviors, like window moving and resizing. I'm also recreating the close/minimize/fullscreen buttons by hand, but it means I lose all kinds of native OS behaviour like the window snapping in windows or the zoom option on mac. </p>\n\n<p>Is there a better way to do this? Is it possible at least to create the native max-min-close buttons instead of building it by scratch?</p>\n\n<p>Thanks for all</p>\n"}, {"tags": ["go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": true, "score": 5, "last_activity_date": 1425574462, "creation_date": 1425574462, "answer_id": 28883348, "question_id": 28877974, "link": "https://stackoverflow.com/questions/28877974/how-to-save-struct-based-type-with-a-map-property-into-mongodb/28883348#28883348", "title": "How to save struct based type with a map property into mongodb", "body": "<p>There's nothing special to be done for inserts. Just insert that session value into the database as usual, and the map type will be properly inserted:</p>\n\n<pre><code>err := collection.Insert(&amp;session)\n</code></pre>\n\n<p>Assuming the structure described, this will insert the following document into the database:</p>\n\n<pre><code>{id: \"555555\", data: {logged: {name: \"foo\", email: \"foo@example.com\"}}}\n</code></pre>\n\n<p>You cannot easily query it back like that, though, because the <code>map[string]interface{}</code> does not give the bson package a good hint about what the value type is (it'll end up as a map, instead of <code>Authen</code>). To workaround this, you'd need to implement the <a href=\"http://gopkg.in/mgo.v2/bson#Setter\" rel=\"noreferrer\">bson.Setter</a> interface in the type used by the <code>Data</code> field.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1812, "favorite_count": 0, "accepted_answer_id": 28883348, "answer_count": 1, "score": 2, "last_activity_date": 1425574462, "creation_date": 1425558780, "last_edit_date": 1425561763, "question_id": 28877974, "link": "https://stackoverflow.com/questions/28877974/how-to-save-struct-based-type-with-a-map-property-into-mongodb", "title": "How to save struct based type with a map property into mongodb", "body": "<p>I want to use mongodb as session storage and save a struct based data type into mongodb.</p>\n\n<pre><code>The struct type looks like:\n\ntype Session struct {\n    Id  string\n    Data map[string]interface{}\n}\n</code></pre>\n\n<p>And create reference to Session struct type and put some data into properties like:</p>\n\n<pre><code>type Authen struct {\n    Name, Email string\n}\na := &amp;Authen{Name: \"Foo\", Email: \"foo@example.com\"}\n\ns := &amp;Session{}\ns.Id = \"555555\"\ns.Data[\"logged\"] = a\n</code></pre>\n\n<p>How to save the session data <code>s</code> into mongodb and how to query those data back and save into a reference again?\nI think the problem can occurs with the data property of type <code>map[string]interface{}</code>.</p>\n\n<p>As driver to mongodb I would use <a href=\"https://godoc.org/labix.org/v2/mgo\" rel=\"nofollow\">mgo</a></p>\n"}, {"tags": ["json", "dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "edited": false, "score": 2, "creation_date": 1514071173, "post_id": 28877962, "comment_id": 82883029, "body": "Alot of times, json has dynamic keys. For example using the date as a key. Doing the same request tomorrow will yield a new structure you can&#39;t map out. For those who come across this answer, note that you cannot do the above."}, {"owner": {"reputation": 5397, "user_id": 1497385, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/480aa1bfbfe38b0baf3a48159b82d726?s=128&d=identicon&r=PG&f=1", "display_name": "Ark-kun", "link": "https://stackoverflow.com/users/1497385/ark-kun"}, "reply_to_user": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "edited": false, "score": 0, "creation_date": 1548997505, "post_id": 28877962, "comment_id": 95753986, "body": "@jacksexton Can&#39;t you say that some property is a map with string key and struct value type?"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1425559065, "last_edit_date": 1425559065, "creation_date": 1425558727, "answer_id": 28877962, "question_id": 28877512, "link": "https://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an/28877962#28877962", "title": "Taking a JSON string, unmarshaling it into a map[string]interface{}, editing, and marshaling it into a []byte seems more complicated then it should be", "body": "<p>No, this is not the most correct way to handle structured JSON data in Go. Instead, it is better to create a \"struct hierarchy\" and unmarshal your JSON into structs. E.g.</p>\n\n<pre><code>type Data struct {\n    Key1 string\n    Key2 struct {\n        C1Key1 string\n    }\n    Key3 []Key3\n}\n\ntype Key3 struct {\n    C2Key1 struct {\n        C3Key1 string\n    }\n}\n</code></pre>\n\n<p>This approach:</p>\n\n<ul>\n<li>gives you more control over how your data will be (un)marshaled (via struct tags and <code>json.Unmarshaler</code> and <code>json.Marshaler</code> interfaces)</li>\n<li>gets you rid of type assertions</li>\n<li>instead, gives you more type safety</li>\n<li>has better performance, since struct access is basically free compared to map access.</li>\n</ul>\n\n<p>Playground: <a href=\"https://play.golang.org/p/9XIh8DX1Ms\" rel=\"nofollow\">https://play.golang.org/p/9XIh8DX1Ms</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427484464, "post_id": 28878037, "comment_id": 46811257, "body": "Personally, I&#39;d write the set more like this: <a href=\"https://play.golang.org/p/ltSkD0rISL\" rel=\"nofollow noreferrer\">play.golang.org/p/ltSkD0rISL</a>  It does all the stuff where <code>!last</code> first and then does the set. Like your version it assumes the path is valid and will panic otherwise (e.g. if len(path)&lt;1)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 16, "last_activity_date": 1516121288, "last_edit_date": 1516121288, "creation_date": 1425559042, "answer_id": 28878037, "question_id": 28877512, "link": "https://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an/28878037#28878037", "title": "Taking a JSON string, unmarshaling it into a map[string]interface{}, editing, and marshaling it into a []byte seems more complicated then it should be", "body": "<p><strong>Foreword:</strong> I optimized and improved the below solution, and released it as a library here: <a href=\"https://github.com/icza/dyno\" rel=\"nofollow noreferrer\"><code>github.com/icza/dyno</code></a>.</p>\n\n<hr>\n\n<p>The cleanest way would be to create predefined types (structures <code>struct</code>) that model your JSON, and unmarshal to a value of that type, and you can simply refer to elements using <a href=\"http://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">Selectors</a> (for <code>struct</code> types) and <a href=\"http://golang.org/ref/spec#Index_expressions\" rel=\"nofollow noreferrer\">Index expressions</a> (for maps and slices).</p>\n\n<p>However if your input is not of a predefined structure, I suggest you the following 2 helper functions: <code>get()</code> and <code>set()</code>. The first one accesses (returns) an arbitrary element specified by an arbitrary path (list of <code>string</code> map keys and/or <code>int</code> slice indices), the second changes (sets) the value specified by an arbitrary path (implementations of these helper functions are at the end of the answer).</p>\n\n<p>You only have to include these 2 functions once in your project/app.</p>\n\n<p>And now using these helpers, the tasks you want to do becomes this simple (just like the python solution):</p>\n\n<pre><code>fmt.Println(get(d, \"key3\", 0, \"c2key1\", \"c3key1\"))\nset(\"NEWVALUE\", d, \"key3\", 0, \"c2key1\", \"c3key1\")\nfmt.Println(get(d, \"key3\", 0, \"c2key1\", \"c3key1\"))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>change1\nNEWVALUE\n</code></pre>\n\n<p>Try your modified app on the <a href=\"https://play.golang.org/p/uejYtZI52w\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Note - Further Simplification:</strong></p>\n\n<p>You can even save the path in a variable and reuse it to simplify the above code further:</p>\n\n<pre><code>path := []interface{}{\"key3\", 0, \"c2key1\", \"c3key1\"}\n\nfmt.Println(get(d, path...))\nset(\"NEWVALUE\", d, path...)\nfmt.Println(get(d, path...))\n</code></pre>\n\n<hr>\n\n<p>And the implementations of <code>get()</code> and <code>set()</code> are below. Note: checks whether the path is valid is omitted. This implementation uses <a href=\"http://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">Type switches</a>:</p>\n\n<pre><code>func get(m interface{}, path ...interface{}) interface{} {\n    for _, p := range path {\n        switch idx := p.(type) {\n        case string:\n            m = m.(map[string]interface{})[idx]\n        case int:\n            m = m.([]interface{})[idx]\n        }\n    }\n    return m\n}\n\nfunc set(v interface{}, m interface{}, path ...interface{}) {\n    for i, p := range path {\n        last := i == len(path)-1\n        switch idx := p.(type) {\n        case string:\n            if last {\n                m.(map[string]interface{})[idx] = v\n            } else {\n                m = m.(map[string]interface{})[idx]\n            }\n        case int:\n            if last {\n                m.([]interface{})[idx] = v\n            } else {\n                m = m.([]interface{})[idx]\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1618950693, "creation_date": 1618950693, "answer_id": 67185933, "question_id": 28877512, "link": "https://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an/67185933#67185933", "title": "Taking a JSON string, unmarshaling it into a map[string]interface{}, editing, and marshaling it into a []byte seems more complicated then it should be", "body": "<p>Here is a full example, using a <code>struct</code> and with editing:</p>\n<pre><code>package main\n\nimport (\n   &quot;encoding/json&quot;\n   &quot;os&quot;\n)\n\nconst s = `\n{\n   &quot;key1&quot;: &quot;val1&quot;,\n   &quot;key2&quot;: {&quot;c1key1&quot;: &quot;c1val1&quot;},\n   &quot;key3&quot;: [{&quot;c2key1&quot;: {&quot;c3key1&quot;: &quot;c3val1&quot;}}]\n}\n`\n\nfunc main() {\n   var d struct {\n      Key1 string\n      Key2 struct { C1Key1 string }\n      Key3 []struct {\n         C2Key1 struct { C3Key1 string }\n      }\n   }\n   json.Unmarshal([]byte(s), &amp;d)\n   d.Key3[0].C2Key1.C3Key1 = &quot;change1&quot;\n   b, e := json.Marshal(d)\n   if e != nil {\n      panic(e)\n   }\n   os.Stdout.Write(b)\n}\n</code></pre>\n"}], "owner": {"reputation": 1897, "user_id": 473368, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e24aa1cfabf417ef8833ea8721a66a8?s=128&d=identicon&r=PG", "display_name": "01AutoMonkey", "link": "https://stackoverflow.com/users/473368/01automonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4576, "favorite_count": 2, "accepted_answer_id": 28878037, "answer_count": 3, "score": 9, "last_activity_date": 1618950693, "creation_date": 1425557154, "last_edit_date": 1526759618, "question_id": 28877512, "link": "https://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an", "title": "Taking a JSON string, unmarshaling it into a map[string]interface{}, editing, and marshaling it into a []byte seems more complicated then it should be", "body": "<p>I'm doing very basic JSON manipulation to learn some Go, and it works, except one thing seems off, I have to write allot of <code>.(map[string]interface{})</code> and <code>.([]interface{})</code> to access entries in the JSON, especially if they are children of children of children, etc.</p>\n\n<p>See here (also on Go Playground: <a href=\"https://play.golang.org/p/Wd-pzHqTsU\" rel=\"noreferrer\">https://play.golang.org/p/Wd-pzHqTsU</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\nfunc main() {\n    JSON := []byte(`{\"key1\":\"val1\",\"key2\":{\"c1key1\":\"c1val1\"},\"key3\":[{\"c2key1\":{\"c3key1\":\"c3val1\"}}]}`)\n    fmt.Printf(\"%s\\n\", JSON)\n    var d map[string]interface{}\n    json.Unmarshal(JSON, &amp;d)\n    fmt.Println(d[\"key3\"].([]interface{})[0].(map[string]interface{})[\"c2key1\"].(map[string]interface{})[\"c3key1\"])\n    d[\"key3\"].([]interface{})[0].(map[string]interface{})[\"c2key1\"].(map[string]interface{})[\"c3key1\"] = \"change1\"\n    fmt.Println(d[\"key3\"].([]interface{})[0].(map[string]interface{})[\"c2key1\"].(map[string]interface{})[\"c3key1\"])\n    JSON, _ = json.Marshal(d)\n    fmt.Printf(\"%s\\n\", JSON)\n}\n</code></pre>\n\n<p>Which returns:</p>\n\n<pre><code>{\"key1\":\"val1\",\"key2\":{\"c1key1\":\"c1val1\"},\"key3\":[{\"c2key1\":{\"c3key1\":\"c3val1\"}}]}\nc3val1\nchange1\n{\"key1\":\"val1\",\"key2\":{\"c1key1\":\"c1val1\"},\"key3\":[{\"c2key1\":{\"c3key1\":\"change1\"}}]}\n</code></pre>\n\n<p>Now in Python I just access key/values directly instead of defining the type of what I'm accessing every time, that is instead of <code>fmt.Println(d[\"key3\"].([]interface{})[0].(map[string]interface{})[\"c2key1\"].(map[string]interface{})[\"c3key1\"])</code> you do <code>print d[\"key3\"][0][\"c2key1\"][\"c3key1\"]</code></p>\n\n<p>Python example:</p>\n\n<pre><code>import json\n\nJSON = '{\"key3\": [{\"c2key1\": {\"c3key1\": \"c3val1\"}}], \"key2\": {\"c1key1\": \"c1val1\"}, \"key1\": \"val1\"}'\nprint JSON\nd = json.loads(JSON)\nprint d[\"key3\"][0][\"c2key1\"][\"c3key1\"]\nd[\"key3\"][0][\"c2key1\"][\"c3key1\"] = \"change1\"\nprint d[\"key3\"][0][\"c2key1\"][\"c3key1\"]\nJSON = json.dumps(d)\nprint JSON\n</code></pre>\n\n<p>So am I doing this right in Go? And if so, what's the reason for this design? Or if not, how should I do it?</p>\n"}, {"tags": ["templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1425547716, "creation_date": 1425547716, "answer_id": 28874262, "question_id": 28874194, "link": "https://stackoverflow.com/questions/28874194/tmpl-execute-and-sub-file-golang/28874262#28874262", "title": "tmpl.Execute and sub-file golang", "body": "<p>In your <code>core.tmpl</code> you have to use </p>\n\n<pre><code>{{template \"article\" .}}\n</code></pre>\n\n<p>If you don't specify the <code>.</code> at the end, the template will be executed with <code>nil</code> data. Specifying the <code>.</code> will pass the value of <code>.</code> to the invoked template.</p>\n\n<p>Quoting from the <a href=\"http://golang.org/pkg/text/template/\" rel=\"nofollow\"><code>text/template</code></a> package documentation, <code>Actions</code> section:</p>\n\n<pre><code>{{template \"name\"}}\n    The template with the specified name is executed with nil data.\n\n{{template \"name\" pipeline}}\n    The template with the specified name is executed with dot set\n    to the value of the pipeline.\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4635969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/685271c4dc8833a16bd303b1a7e1860d?s=128&d=identicon&r=PG&f=1", "display_name": "DDanya", "link": "https://stackoverflow.com/users/4635969/ddanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 28874262, "answer_count": 1, "score": 2, "last_activity_date": 1435764068, "creation_date": 1425547510, "last_edit_date": 1435764068, "question_id": 28874194, "link": "https://stackoverflow.com/questions/28874194/tmpl-execute-and-sub-file-golang", "title": "tmpl.Execute and sub-file golang", "body": "<p>I need help.\nI need to use <code>\"html/template\"</code>'s marking (<code>{{.Title}}</code>, example) in sub-files(<code>\"article.html\"</code>, example in my text):</p>\n\n<pre><code>// ...\ntype Page struct {\n    Test string\n}\n\ntype News struct {\n    Page\n    Title string\n}\n\nfunc main() {\n    t, _ := template.ParseFiles(filepath+\"core.tmpl\", filepath+\"article.tmpl\")\n    p := &amp;News{\n        Title: \"TITLE\",\n        Page: Page{\n            Test: \"TITLE\",\n        },\n    }\n    t.Execute(wr, p)\n}\n</code></pre>\n\n<p>Code in <code>core.tmpl</code>:</p>\n\n<pre><code>{{template \"article\"}}\n</code></pre>\n\n<p>Code in <code>article.tmpl</code>:</p>\n\n<pre><code>{{define \"article\"}}\n{{.Title}}&lt;br&gt;&lt;br&gt;\n{{.Page.Test}}\n{{end}}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "edited": false, "score": 1, "creation_date": 1425551177, "post_id": 28874158, "comment_id": 46013095, "body": "your second code example is working for me."}], "answers": [{"tags": [], "owner": {"reputation": 2854, "user_id": 41292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/939e50606775eea4b7589dd7aebbd8b3?s=128&d=identicon&r=PG", "display_name": "LenW", "link": "https://stackoverflow.com/users/41292/lenw"}, "is_accepted": true, "score": 1, "last_activity_date": 1425569386, "creation_date": 1425569386, "answer_id": 28881579, "question_id": 28874158, "link": "https://stackoverflow.com/questions/28874158/how-do-i-open-file-with-application-like-emacs-vim-textmate-in-golang/28881579#28881579", "title": "how do i open file with application like emacs,vim, TextMate in golang?", "body": "<p>This definitely works - what errors are you getting ? </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"/usr/bin/vim\", \"/var/www/index.php\")\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    if err := cmd.Run(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4286017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kB4Nl5xvk1I/AAAAAAAAAAI/AAAAAAAAABQ/sdXVX9bs0GI/photo.jpg?sz=128", "display_name": "Mican Zhang", "link": "https://stackoverflow.com/users/4286017/mican-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 28881579, "answer_count": 1, "score": 0, "last_activity_date": 1425569386, "creation_date": 1425547404, "last_edit_date": 1425561405, "question_id": 28874158, "link": "https://stackoverflow.com/questions/28874158/how-do-i-open-file-with-application-like-emacs-vim-textmate-in-golang", "title": "how do i open file with application like emacs,vim, TextMate in golang?", "body": "<p>How do I open a file within an application like emacs, vim, TextMate in golang? </p>\n\n<pre><code>cmd := exec.Command(\"open\", \"-a\", \"/usr/bin/vim\", \"/var/www/index.php\")\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\nif err := cmd.Run(); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>cmd := exec.Command(\"/usr/bin/vim\", \"/var/www/index.php\")\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\nif err := cmd.Run(); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>I found both of the above cannot work, is there any good solution?</p>\n"}]