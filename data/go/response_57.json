[{"tags": ["go", "version", "auto-versioning"], "answers": [{"tags": [], "owner": {"reputation": 8642, "user_id": 74198, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/70cd07b211e849cb0010041c1a724d59?s=128&d=identicon&r=PG", "display_name": "Bas Bossink", "link": "https://stackoverflow.com/users/74198/bas-bossink"}, "is_accepted": false, "score": 5, "last_activity_date": 1455151786, "creation_date": 1455151786, "answer_id": 35328903, "question_id": 35328273, "link": "https://stackoverflow.com/questions/35328273/in-a-golang-application-how-to-embed-a-version-in-a-other-package-than-main/35328903#35328903", "title": "In a Golang application, how to embed a version in a other package than main?", "body": "<p>Looking at the <a href=\"https://github.com/spf13/hugo\" rel=\"noreferrer\">Hugo source</a> I've discovered the answer to my question. The trick is to use:</p>\n\n<pre><code>go run -ldflags \"-X github.com/basbossink/psiw/cmd.versionString=0.1.0\" main.go version\n</code></pre>\n\n<p>So I made two mistakes:</p>\n\n<ul>\n<li>I mixed up the notion of package and source file, the <code>version.go</code> file had <code>package cmd</code> as it's package statement.  </li>\n<li>The way to reference the variable is to use the fully qualified name.</li>\n</ul>\n"}], "owner": {"reputation": 8642, "user_id": 74198, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/70cd07b211e849cb0010041c1a724d59?s=128&d=identicon&r=PG", "display_name": "Bas Bossink", "link": "https://stackoverflow.com/users/74198/bas-bossink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1455151786, "creation_date": 1455148194, "last_edit_date": 1495540435, "question_id": 35328273, "link": "https://stackoverflow.com/questions/35328273/in-a-golang-application-how-to-embed-a-version-in-a-other-package-than-main", "title": "In a Golang application, how to embed a version in a other package than main?", "body": "<p>Inspired by <a href=\"https://stackoverflow.com/questions/11354518/golang-application-auto-build-versioning\">this SO question</a> I wanted to use the same mechanism to embed a version number in my golang application. However I'm using the <a href=\"https://github.com/spf13/cobra\" rel=\"nofollow noreferrer\">Cobra</a> command line parser and want to have a <code>version</code> sub-command. This leads to the following directory and package structure:</p>\n\n<pre><code>.\n|-- cmd                                                                   \n`-- version.go                                                    \n|-- main.go                                                           \n</code></pre>\n\n<p>Up to now I have tried the following:</p>\n\n<pre><code>go run -ldflags \"-X cmd/version.versionString=0.1.0\" main.go version\n</code></pre>\n\n<p>-</p>\n\n<pre><code>go run -ldflags \"-X version.versionString=0.1.0\" main.go version\n</code></pre>\n\n<p>-</p>\n\n<pre><code>go run -ldflags \"-X version.VersionString=0.1.0\" main.go version\n</code></pre>\n\n<p>With <code>version.go</code> containing a variable declaration like:</p>\n\n<pre><code>var versionString string\n</code></pre>\n\n<p>and </p>\n\n<pre><code>var VersionString string\n</code></pre>\n\n<p>respectively.</p>\n\n<p>I've also tried to put the variable declarations in <code>main.go</code> but then I'm  not clear how to reference the variables in <code>version.go</code> for this option I tried:</p>\n\n<pre><code>import \"github.com/basbossink/psiw\"\n....\nfmt.Println(psiw.VersionString)\n</code></pre>\n\n<p>-</p>\n\n<pre><code>import \"github.com/basbossink/psiw/main\"\n...\nfmt.Println(main.VersionString)\n</code></pre>\n\n<p>In both cases the compiler complains that <code>psiw</code> and <code>main</code> respectively are unknown.\nNote that using the <code>VersionString</code> in <code>main</code> gives the expected result.</p>\n\n<p>I would prefer a solution where the link flags point to the variable in the <code>version</code> package since they don't require a <em>back-pointer</em>. But any suggestions are welcome.</p>\n"}, {"tags": ["algorithm", "function", "go"], "comments": [{"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 0, "creation_date": 1455149504, "post_id": 35328272, "comment_id": 58365426, "body": "Think about what the value of recipe1 is at the point that code is called; you initialize it <i>after</i> that snippet."}, {"owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "reply_to_user": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "edited": false, "score": 0, "creation_date": 1455149608, "post_id": 35328272, "comment_id": 58365452, "body": "Ah I see, so move the function to the top ?"}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1455152602, "last_edit_date": 1455152602, "creation_date": 1455151425, "answer_id": 35328838, "question_id": 35328272, "link": "https://stackoverflow.com/questions/35328272/go-program-not-displaying-desired-result-of-sliced-int-assigned-to-variable/35328838#35328838", "title": "Go Program Not Displaying Desired Result of Sliced Int assigned to variable", "body": "<p>You have your statements in the wrong order. At the point when you try to print the recipe you've declared it but you've done no initialization so it should be null.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\n//Struct for Recipe below\ntype Recipe struct { //Struct for recipe information\n    name        string\n    prepTime    int\n    cookTime    int\n    Ingredients []string //this is now a slice that will accept multiple elements\n    ID          int\n    Yield       int\n}\n\n//function to print Recipe\nfunc printRecipe(recipe Recipe) {\n    fmt.Printf(\"Recipe Name : %s\\n\", recipe.name)\n    fmt.Printf(\"Prep Time : %d\\n\", recipe.prepTime)\n    fmt.Printf(\"Cook Time : %d\\n\", recipe.cookTime)\n    fmt.Printf(\"Ingredients : %s\\n\", recipe.Ingredients)\n    fmt.Printf(\"Recipe ID : %d\\n\", recipe.ID)\n}\n\n//Returns total time by addings cookTime and prepTime\nfunc totalTime(recipe Recipe) {\n    fmt.Printf(\"The total time for this recipe is %d\\n\", recipe.cookTime+recipe.prepTime)\n}\n\nfunc main() {\n    var recipe1 Recipe //Declare recipe1 of Type Recipe\n    var recipe2 Recipe\n    var recipe3 Recipe\n\n\n        /* recipe1 specifications */\n    recipe1.name = \"BBQ Pulled Chicken\"\n    recipe1.prepTime = 25\n    recipe1.cookTime = 5\n    recipe1.Ingredients = append(\n        recipe1.Ingredients,\n        \"1 8-ounce can reduced-sodium tomato sauce\",\n    )\n    recipe1.Ingredients = append(\n        recipe1.Ingredients,\n        \"1/2 medium onion (grated),\",\n    )\n    recipe1.ID = 1\n    recipe1.Yield = 8\n\n    /* Recipe 2 specifications */\n\n    recipe2.name = \"Steak Tacos with Pineapple\"\n    recipe2.prepTime = 45\n    recipe2.cookTime = 45\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"3 tablespoons soy sauce,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 tablespoon finely grated garlic,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 tablespoon finely grated peeled fresh ginger,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 1/2 pounds skirt steak, cut into 5-inch lengths,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"Salt\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"Pepper\",\n    )\n    recipe2.ID = 2\n    recipe2.Yield = 4\n\n    recipe3.name = \"Simple Lemon Herb Chicken\"\n    recipe3.prepTime = 10\n    recipe3.cookTime = 15\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"2 skinless boneless chicken breast halves,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 Lemon,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"Salt and Pepper to taste,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 tablespoon olive oil,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"2 sprigs fresh parsley (for garnish),\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 pinch dried oregano,\",\n    )\n    recipe3.ID = 3\n    recipe3.Yield = 2\n\n    //choose random number for recipe\n    r := rand.New(rand.NewSource(time.Now().UnixNano()))\n    i := r.Perm(5)\n    fmt.Printf(\"%v\\n\", i)\n    fmt.Printf(\"%d\\n\", i[0])\n\n    //assign slices of int from Perm to variables assigned days of the week\n    var monday = i[0]\n    var tuesday = i[1]\n    var wednesday = i[2]\n    var thursday = i[3]\n    var friday = i[4]\n\n    //testing printing of variables assigned to days\n    fmt.Printf(\"This is for the day Monday %d\\n\", monday)\n    fmt.Printf(\"%d\\n\", tuesday)\n    fmt.Printf(\"%d\\n\", wednesday)\n    fmt.Printf(\"%d\\n\", thursday)\n    fmt.Printf(\"%d\\n\", friday)\n\n    //logic for Mondays Recipe\n    if monday == 0 {\n        fmt.Println(0)\n        printRecipeOfTheDay(recipe1)\n    } else if monday == 1 {\n        fmt.Println(1)\n        printRecipeOfTheDay(recipe2)\n    } else if monday == 2 {\n        fmt.Println(2)\n        printRecipeOfTheDay(recipe3)\n    } else if monday == 3 {\n        fmt.Println(3)\n    }\n\n    //call to printRecipe function below\n    printRecipe(recipe1)\n    totalTime(recipe1)\n    printRecipe(recipe2)\n    totalTime(recipe2)\n    printRecipe(recipe3)\n    totalTime(recipe3)\n}\n\n//function to print the winner for recipe of the day to use\n//for either lunch or dinner\nfunc printRecipeOfTheDay(recipe Recipe) {\n    fmt.Printf(\"The recipe of the day is : %s\\n\", recipe.name)\n}\n</code></pre>\n\n<p>I just did a quick cut and paste there cause I'm rather busy at the moment. I may edit this later, it would just be for style and readability. I recommend making an <code>initRecipes</code> method and having it return a <code>[]Recipe</code> and using composite literal syntax to do your initialization instead of calling append over and over again.</p>\n"}, {"tags": [], "owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "is_accepted": false, "score": 0, "last_activity_date": 1455174239, "creation_date": 1455174239, "answer_id": 35332794, "question_id": 35328272, "link": "https://stackoverflow.com/questions/35328272/go-program-not-displaying-desired-result-of-sliced-int-assigned-to-variable/35332794#35332794", "title": "Go Program Not Displaying Desired Result of Sliced Int assigned to variable", "body": "<p>Thanks to your advice I fixed up my code and it is below. It is working as expected. Now I just have to clean it up more</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\n//Struct for Recipe below\ntype Recipe struct { //Struct for recipe information\n    name        string\n    prepTime    int\n    cookTime    int\n    Ingredients []string //this is now a slice that will accept multiple elements\n    ID          int\n    Yield       int\n}\n\n//main method\nfunc main() {\n    //5 variables below for 5 recipes for Monday-Friday\n    var recipe1 Recipe //Declare recipe1 of Type Recipe\n    var recipe2 Recipe\n    var recipe3 Recipe\n    var recipe4 Recipe\n    var recipe5 Recipe\n\n    //choose random number for recipe\n    r := rand.New(rand.NewSource(time.Now().UnixNano()))\n    i := r.Perm(5)\n    fmt.Printf(\"%v\\n\", i)\n    fmt.Printf(\"%d\\n\", i[0])\n    fmt.Printf(\"%d\\n\", i[1])\n\n    //assign slices of int from Perm to variables assigned days of the week\n    var monday = i[0]\n    var tuesday = i[1]\n    var wednesday = i[2]\n    var thursday = i[3]\n    var friday = i[4]\n\n    //testing printing of variables assigned to days\n    fmt.Printf(\"This is for the day Monday %d\\n\", monday)\n    fmt.Printf(\"This is for the day Tuesday %d\\n\", tuesday)\n    fmt.Printf(\"This is for the day Wednesday %d\\n\", wednesday)\n    fmt.Printf(\"This is for the day Thursday %d\\n\", thursday)\n    fmt.Printf(\"This is for the day Friday %d\\n\", friday)\n\n    /* recipe1 specifications */\n    recipe1.name = \"BBQ Pulled Chicken\"\n    recipe1.prepTime = 25\n    recipe1.cookTime = 5\n    recipe1.Ingredients = append(\n        recipe1.Ingredients,\n        \"1 8-ounce can reduced-sodium tomato sauce\",\n    )\n    recipe1.Ingredients = append(\n        recipe1.Ingredients,\n        \"1/2 medium onion (grated),\",\n    )\n    recipe1.ID = 1\n    recipe1.Yield = 8\n\n    /* Recipe 2 specifications */\n\n    recipe2.name = \"Steak Tacos with Pineapple\"\n    recipe2.prepTime = 45\n    recipe2.cookTime = 45\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"3 tablespoons soy sauce,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 tablespoon finely grated garlic,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 tablespoon finely grated peeled fresh ginger,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 1/2 pounds skirt steak, cut into 5-inch lengths,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"Salt\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"Pepper\",\n    )\n    recipe2.ID = 2\n    recipe2.Yield = 4\n\n    recipe3.name = \"Simple Lemon Herb Chicken\"\n    recipe3.prepTime = 10\n    recipe3.cookTime = 15\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"2 skinless boneless chicken breast halves,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 Lemon,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"Salt and Pepper to taste,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 tablespoon olive oil,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"2 sprigs fresh parsley (for garnish),\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 pinch dried oregano,\",\n    )\n    recipe3.ID = 3\n    recipe3.Yield = 2\n\n    //recipe4 specifications\n    recipe4.name = \"Easy Meatloaf\"\n    recipe4.prepTime = 10\n    recipe4.cookTime = 60\n    recipe4.Ingredients = append(\n        recipe4.Ingredients,\n        \"1 onion (chopped),\",\n    )\n    recipe4.Ingredients = append(\n        recipe4.Ingredients,\n        \"1 cup milk,\",\n    )\n    recipe4.Ingredients = append(\n        recipe4.Ingredients,\n        \"1 cup dried bread crumbs,\",\n    )\n    recipe4.ID = 4\n    recipe4.Yield = 8\n\n    //recipe 5 specifications\n    recipe5.name = \"Fast Salmon with a Ginger Glaze\"\n    recipe5.prepTime = 5\n    recipe5.cookTime = 20\n    recipe5.Ingredients = append(\n        recipe5.Ingredients,\n        \"salt to taste,\",\n    )\n    recipe5.Ingredients = append(\n        recipe5.Ingredients,\n        \"1/3 cup cold water,\",\n    )\n    recipe5.Ingredients = append(\n        recipe5.Ingredients,\n        \"1/4 cup seasoned rice vinegar,\",\n    )\n    recipe5.ID = 5\n    recipe5.Yield = 4\n\n    //call to printRecipe function below\n    printRecipe(recipe1)\n    totalTime(recipe1)\n    printRecipe(recipe2)\n    totalTime(recipe2)\n    printRecipe(recipe3)\n    totalTime(recipe3)\n    printRecipe(recipe4)\n    totalTime(recipe4)\n    printRecipe(recipe5)\n    totalTime(recipe5)\n\n    //logic for Mondays Recipe\n    if monday == 0 {\n        fmt.Println(0)\n        printRecipeOfTheDay(recipe1)\n    } else if monday == 1 {\n        fmt.Println(1)\n        printRecipeOfTheDay(recipe2)\n    } else if monday == 2 {\n        fmt.Println(2)\n        printRecipeOfTheDay(recipe3)\n    } else if monday == 3 {\n        fmt.Println(3)\n        printRecipeOfTheDay(recipe4)\n    } else if monday == 4 {\n        fmt.Println(4)\n        printRecipeOfTheDay(recipe5)\n    }\n\n    //logic for Tuesdays Recipe\n    if tuesday == 0 {\n        fmt.Println(0)\n        printRecipeOfTheDay(recipe1)\n    } else if tuesday == 1 {\n        fmt.Println(1)\n        printRecipeOfTheDay(recipe2)\n    } else if tuesday == 2 {\n        fmt.Println(2)\n        printRecipeOfTheDay(recipe3)\n    } else if tuesday == 3 {\n        fmt.Println(3)\n        printRecipeOfTheDay(recipe4)\n    } else if tuesday == 4 {\n        fmt.Println(4)\n        printRecipeOfTheDay(recipe5)\n    }\n}\n\n//function to print Recipe\nfunc printRecipe(recipe Recipe) {\n    fmt.Printf(\"Recipe Name : %s\\n\", recipe.name)\n    fmt.Printf(\"Prep Time : %d\\n\", recipe.prepTime)\n    fmt.Printf(\"Cook Time : %d\\n\", recipe.cookTime)\n    fmt.Printf(\"Ingredients : %s\\n\", recipe.Ingredients)\n    fmt.Printf(\"Recipe ID : %d\\n\", recipe.ID)\n}\n\n//Returns total time by addings cookTime and prepTime\nfunc totalTime(recipe Recipe) {\n    fmt.Printf(\"The total time for this recipe is %d\\n\", recipe.cookTime+recipe.prepTime)\n}\n\n//function to print the winner for recipe of the day to use\n//for either lunch or dinner\nfunc printRecipeOfTheDay(recipe Recipe) {\n    fmt.Printf(\"The recipe of the day is : %s\\n\", recipe.name)\n}\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 1, "accepted_answer_id": 35328838, "answer_count": 2, "score": 0, "last_activity_date": 1455174239, "creation_date": 1455148188, "question_id": 35328272, "link": "https://stackoverflow.com/questions/35328272/go-program-not-displaying-desired-result-of-sliced-int-assigned-to-variable", "title": "Go Program Not Displaying Desired Result of Sliced Int assigned to variable", "body": "<p>My program is having issues with the printRecipeOfTheDay function. Say for example 0 is randomly selected by the program and gets assigned to the Monday variable I created, when I pass \"recipe1\" to the function \"printRecipeOfTheDay\" I get no output or a null value. Any idea on what I may have messed up?</p>\n\n<pre><code>        if monday == 0 {\n            fmt.Println(0)\n            printRecipeOfTheDay(recipe1)\n        } else if monday == 1 {\n            fmt.Println(1)\n</code></pre>\n\n<p>The entire program is below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\n//Struct for Recipe below\ntype Recipe struct { //Struct for recipe information\n    name        string\n    prepTime    int\n    cookTime    int\n    Ingredients []string //this is now a slice that will accept multiple elements\n    ID          int\n    Yield       int\n}\n\n//function to print Recipe\nfunc printRecipe(recipe Recipe) {\n    fmt.Printf(\"Recipe Name : %s\\n\", recipe.name)\n    fmt.Printf(\"Prep Time : %d\\n\", recipe.prepTime)\n    fmt.Printf(\"Cook Time : %d\\n\", recipe.cookTime)\n    fmt.Printf(\"Ingredients : %s\\n\", recipe.Ingredients)\n    fmt.Printf(\"Recipe ID : %d\\n\", recipe.ID)\n}\n\n//Returns total time by addings cookTime and prepTime\nfunc totalTime(recipe Recipe) {\n    fmt.Printf(\"The total time for this recipe is %d\\n\", recipe.cookTime+recipe.prepTime)\n}\n\nfunc main() {\n    var recipe1 Recipe //Declare recipe1 of Type Recipe\n    var recipe2 Recipe\n    var recipe3 Recipe\n\n    //choose random number for recipe\n    r := rand.New(rand.NewSource(time.Now().UnixNano()))\n    i := r.Perm(5)\n    fmt.Printf(\"%v\\n\", i)\n    fmt.Printf(\"%d\\n\", i[0])\n\n    //assign slices of int from Perm to variables assigned days of the week\n    var monday = i[0]\n    var tuesday = i[1]\n    var wednesday = i[2]\n    var thursday = i[3]\n    var friday = i[4]\n\n    //testing printing of variables assigned to days\n    fmt.Printf(\"This is for the day Monday %d\\n\", monday)\n    fmt.Printf(\"%d\\n\", tuesday)\n    fmt.Printf(\"%d\\n\", wednesday)\n    fmt.Printf(\"%d\\n\", thursday)\n    fmt.Printf(\"%d\\n\", friday)\n\n    //logic for Mondays Recipe\n    if monday == 0 {\n        fmt.Println(0)\n        printRecipeOfTheDay(recipe1)\n    } else if monday == 1 {\n        fmt.Println(1)\n        printRecipeOfTheDay(recipe2)\n    } else if monday == 2 {\n        fmt.Println(2)\n        printRecipeOfTheDay(recipe3)\n    } else if monday == 3 {\n        fmt.Println(3)\n    }\n    /* recipe1 specifications */\n    recipe1.name = \"BBQ Pulled Chicken\"\n    recipe1.prepTime = 25\n    recipe1.cookTime = 5\n    recipe1.Ingredients = append(\n        recipe1.Ingredients,\n        \"1 8-ounce can reduced-sodium tomato sauce\",\n    )\n    recipe1.Ingredients = append(\n        recipe1.Ingredients,\n        \"1/2 medium onion (grated),\",\n    )\n    recipe1.ID = 1\n    recipe1.Yield = 8\n\n    /* Recipe 2 specifications */\n\n    recipe2.name = \"Steak Tacos with Pineapple\"\n    recipe2.prepTime = 45\n    recipe2.cookTime = 45\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"3 tablespoons soy sauce,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 tablespoon finely grated garlic,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 tablespoon finely grated peeled fresh ginger,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 1/2 pounds skirt steak, cut into 5-inch lengths,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"Salt\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"Pepper\",\n    )\n    recipe2.ID = 2\n    recipe2.Yield = 4\n\n    recipe3.name = \"Simple Lemon Herb Chicken\"\n    recipe3.prepTime = 10\n    recipe3.cookTime = 15\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"2 skinless boneless chicken breast halves,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 Lemon,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"Salt and Pepper to taste,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 tablespoon olive oil,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"2 sprigs fresh parsley (for garnish),\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 pinch dried oregano,\",\n    )\n    recipe3.ID = 3\n    recipe3.Yield = 2\n\n    //call to printRecipe function below\n    printRecipe(recipe1)\n    totalTime(recipe1)\n    printRecipe(recipe2)\n    totalTime(recipe2)\n    printRecipe(recipe3)\n    totalTime(recipe3)\n}\n\n//function to print the winner for recipe of the day to use\n//for either lunch or dinner\nfunc printRecipeOfTheDay(recipe Recipe) {\n    fmt.Printf(\"The recipe of the day is : %s\\n\", recipe.name)\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "edited": false, "score": 0, "creation_date": 1455207107, "post_id": 35327609, "comment_id": 58395928, "body": "great read on the topic: <a href=\"http://nesv.github.io/golang/2014/02/25/worker-queues-in-go.html\" rel=\"nofollow noreferrer\">nesv.github.io/golang/2014/02/25/worker-queues-in-go.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1455152713, "post_id": 35327747, "comment_id": 58366447, "body": "Yeah imo this a very good use of the constructs offered by Go."}, {"owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "edited": false, "score": 0, "creation_date": 1455167006, "post_id": 35327747, "comment_id": 58370323, "body": "The one addition I would make to the above is making it a buffered channel, so you&#39;re not writing unlimited new lines to the channel.  <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#channels</a>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "edited": false, "score": 0, "creation_date": 1455177973, "post_id": 35327747, "comment_id": 58375240, "body": "@Sean you won&#39;t be writing unlimited new lines to the channel if it&#39;s not buffered - you simply won&#39;t send lines on it, unless all the workers have consumed everything. A buffered channel will allow you to write N lines more than than have been consume, whichi will result simply in finishing dispatching before the workers finish, it won&#39;t speed or slow down anything"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 10, "last_activity_date": 1582371868, "last_edit_date": 1582371868, "creation_date": 1455145525, "answer_id": 35327747, "question_id": 35327609, "link": "https://stackoverflow.com/questions/35327609/limiting-the-number-of-concurrent-tasks-running/35327747#35327747", "title": "Limiting the number of concurrent tasks running", "body": "<p>I think the best approach for this would be to keep a pool of worker goroutines, dispatch the work for them in channels, and then close the channel so they would exit. </p>\n\n<p>something like this:</p>\n\n<pre><code>// create a channel for work \"tasks\"\nch := make(chan string)\n\nwg := sync.WaitGroup{}\n\n// start the workers\nfor t := 0; t &lt; 100; t++{\n    wg.Add(1)\n    go saveToDB(ch, &amp;wg)\n}\n\n// push the lines to the queue channel for processing\nfor _, line := range fileline {\n    ch &lt;- line\n}\n\n// this will cause the workers to stop and exit their receive loop\nclose(ch)\n\n// make sure they all exit\nwg.Wait()\n</code></pre>\n\n<p>and then the saveFunction looks like this:</p>\n\n<pre><code>func saveToDB(ch chan string, wg *sync.WaitGroup) {\n    // cnosume a line\n    for line := range ch {\n        // do work\n        actuallySaveToDB(line)\n    }\n    // we've exited the loop when the dispatcher closed the channel, \n    // so now we can just signal the workGroup we're done\n    wg.Done()\n}\n</code></pre>\n"}], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2428, "favorite_count": 3, "accepted_answer_id": 35327747, "answer_count": 1, "score": 4, "last_activity_date": 1582371868, "creation_date": 1455144877, "question_id": 35327609, "link": "https://stackoverflow.com/questions/35327609/limiting-the-number-of-concurrent-tasks-running", "title": "Limiting the number of concurrent tasks running", "body": "<p>So I come accross this issue with <code>go</code> a lot. Let's say I have a text file with 100,000 lines of text. Now I wanna save all these lines to a db. So I would do something like this:</p>\n\n<pre><code>file, _ := iotuil.ReadFile(\"file.txt\")\n\nfileLines := strings.Split(string(file), \"\\n\")\n</code></pre>\n\n<p>Now I would loop over all the lines in the file:</p>\n\n<pre><code>for _, l := range fileLines{\n  saveToDB(l)\n}\n</code></pre>\n\n<p>Now I wanna run this <code>saveToDB</code> func concurrently:</p>\n\n<pre><code>var wg sync.WaitGroup\n\nfor _, l := range fileLines{\n  wg.Add(1)\n  go saveToDB(l, &amp;wg)\n}\n\nwg.Wait()\n</code></pre>\n\n<p>I don't know if this is a problem or not but that would run 100,000 concurrent functions. Is there any way of saying hey run 100 concurrent functions wait for all of those to finish then run 100 more. </p>\n\n<pre><code>for i, _ := range fileLine {\n  for t = 0; t &lt; 100; t++{\n    wg.Add(1)\n    go saveToDB(fileLine[i], &amp;wg)\n  }\n  wg.Wait()\n}\n</code></pre>\n\n<p>Do I need to do something like that or is there a cleaner way to go about this? Or is me running the 100,000 concurrent tasks not an issue?</p>\n"}, {"tags": ["bash", "go", "automation", "command-line-interface"], "comments": [{"owner": {"reputation": 4222, "user_id": 2072269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xNPjb.png?s=128&g=1", "display_name": "muru", "link": "https://stackoverflow.com/users/2072269/muru"}, "edited": false, "score": 0, "creation_date": 1455144051, "post_id": 35327373, "comment_id": 58363390, "body": "Write <a href=\"https://www.golang-book.com/books/intro/12\" rel=\"nofollow noreferrer\">tests in Go itself</a>?"}, {"owner": {"reputation": 547, "user_id": 316622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa0468abfed43c541f16addc3b9fd75?s=128&d=identicon&r=PG", "display_name": "Skrat", "link": "https://stackoverflow.com/users/316622/skrat"}, "edited": false, "score": 0, "creation_date": 1455152241, "post_id": 35327373, "comment_id": 58366314, "body": "If you&#39;re wanting to test the AWS side, testing your go code with more go makes the most sense. If you&#39;re trying to test the CLI interface, what&#39;s wrong with bash scripts?"}], "owner": {"reputation": 1, "user_id": 5910906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276353478e4cb57909acc09e5d9b24f6?s=128&d=identicon&r=PG&f=1", "display_name": "mjmustaf", "link": "https://stackoverflow.com/users/5910906/mjmustaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459815314, "creation_date": 1455143797, "last_edit_date": 1459815314, "question_id": 35327373, "link": "https://stackoverflow.com/questions/35327373/go-command-line-application-testing-tool", "title": "Go Command Line Application Testing Tool", "body": "<p>I have a CLI developed in Go that automates the AWS devops platform. This app parses commands from a 'YML' and does build, deploy etc.</p>\n\n<p>I want to test this at a high level through some automation process, other than writing bash scripts.  Is there a Framework or tools that I can use to automate this process? </p>\n"}, {"tags": ["json", "go", "struct", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455143399, "post_id": 35327063, "comment_id": 58363106, "body": "Why are you passing in the method receiver as another argument?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "edited": false, "score": 0, "creation_date": 1455145950, "post_id": 35327245, "comment_id": 58364163, "body": "Thanks for your answer. I have tried this and still didn&#39;t work."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "edited": false, "score": 0, "creation_date": 1455146136, "post_id": 35327245, "comment_id": 58364243, "body": "@Tuts: please show what you tried, what the error was, and what you expect. Something like this works (aside from many other issues) <a href=\"http://play.golang.org/p/UySh4Nbw0Z\" rel=\"nofollow noreferrer\">play.golang.org/p/UySh4Nbw0Z</a>"}, {"owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "edited": false, "score": 0, "creation_date": 1455211070, "post_id": 35327245, "comment_id": 58398844, "body": "Hi JimB, yours changes worked on most cases, but still have some issues sometimes. I&#39;m trying to figure out. Thanks"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "edited": false, "score": 0, "creation_date": 1455211351, "post_id": 35327245, "comment_id": 58399029, "body": "@Tuts: judging by the code, you&#39;re still not clear on some of the primary concepts, like pointers, method receivers, etc. Have you run through the <a href=\"http://tour.golang.org/\" rel=\"nofollow noreferrer\">Tour Of Go</a>?"}, {"owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "edited": false, "score": 0, "creation_date": 1455922898, "post_id": 35327245, "comment_id": 58723879, "body": "Hi JimB, sorry for long time to answer, but I wasn&#39;t able to get back to this tests till now."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1455145554, "last_edit_date": 1455145554, "creation_date": 1455143272, "answer_id": 35327245, "question_id": 35327063, "link": "https://stackoverflow.com/questions/35327063/how-do-i-do-this-get-an-struct-send-to-a-func-as-interface-and-get-it-back-as-s/35327245#35327245", "title": "How do I do this? Get an struct send to a func as interface and get it back as struct?", "body": "<p>You are trying to assert that <code>Config.Data</code> is of type <code>*TestData</code>, but you're assigning it to <code>TestData{\"http\", \"8080\"}</code> above. You can take the address of a composite literal to create a pointer:</p>\n\n<pre><code>Config.Data = &amp;TestData{\"http\", \"8080\"}\n</code></pre>\n\n<p>If your config already exsits, your <code>Read</code> method is going to fill in the <code>Data</code> field with the a default json data type, probably a <code>map[string]interface{}</code>. If you assign a pointer of the correct type to <code>Data</code> first, it will decode into the expected type.</p>\n\n<pre><code>Config.Data = &amp;TestData{}\n</code></pre>\n\n<p>Ans since <code>Data</code> is an <code>interface{}</code>, you do not want to ever use a pointer to that value, so don't use the <code>&amp;</code> operator when marshaling and unmarshaling.</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1455144901, "post_id": 35327438, "comment_id": 58363745, "body": "The problem isn&#39;t decoding into an <code>interface{}</code> type, all json decoding is into an <code>interface{}</code> type. The problem is that it&#39;s a <code>nil</code> <code>interface{}</code> which is where it can return the default type. If a pointer of the proper type is assigned to <code>Data</code>, it will unmarshal correctly."}, {"owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455145295, "post_id": 35327438, "comment_id": 58363898, "body": "yes, like I said, the decoding isn&#39;t the problem, it&#39;s the assertion because you are trying to assert to an entirely different data structure. Thanks for clearing up my language!"}, {"owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "edited": false, "score": 0, "creation_date": 1455145722, "post_id": 35327438, "comment_id": 58364069, "body": "Thanks for your answer. I was doing that until I changed to this code to become a library. Then, as the content on the Configuration.Data will be unknow by the library, I had to use interface instead since the &#39;sample&#39; struct isn&#39;t inside the library, I will not be able to use as you`d suggested."}, {"owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "edited": false, "score": 0, "creation_date": 1455211035, "post_id": 35327438, "comment_id": 58398813, "body": "Hi JimB, yours changes worked on most cases, but still have some issues sometimes. I&#39;m trying to figure out. Thanks"}], "tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 0, "last_activity_date": 1455144057, "creation_date": 1455144057, "answer_id": 35327438, "question_id": 35327063, "link": "https://stackoverflow.com/questions/35327063/how-do-i-do-this-get-an-struct-send-to-a-func-as-interface-and-get-it-back-as-s/35327438#35327438", "title": "How do I do this? Get an struct send to a func as interface and get it back as struct?", "body": "<p>The reason you are running into an error is because you are trying to decode into an <code>interface{}</code> type. When dealing with JSON objects, they are decoded by the encoding/json package into <code>map[string]interface{}</code> types by default. This is causing the type assertion to fail since the memory structure for a map[string]interface{} is much different than that of a struct. </p>\n\n<p>The better way to do this is to make your TestData struct the expected data format for your Configuration struct:</p>\n\n<pre><code>// Base configuration struct\ntype Configuration struct {\n    Filename string\n    Data     *TestData\n}\n</code></pre>\n\n<p>Then when Decoding the file data, the package will unmarshal the data into the fields that match the closest with the data it finds.</p>\n\n<p>If you need more control over the data unmarshaling process, you can dictate which JSON fields get decoded into which struct members by using struct tags. You can read more about the json struct tags available here: <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\">https://golang.org/pkg/encoding/json/#Marshal</a></p>\n"}], "owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1455924320, "creation_date": 1455142715, "last_edit_date": 1495542198, "question_id": 35327063, "link": "https://stackoverflow.com/questions/35327063/how-do-i-do-this-get-an-struct-send-to-a-func-as-interface-and-get-it-back-as-s", "title": "How do I do this? Get an struct send to a func as interface and get it back as struct?", "body": "<p>I'm new in golang development and have some question regarding something related to <a href=\"https://stackoverflow.com/questions/13511203/why-cant-i-assign-a-struct-to-an-interface/\">this question</a>.</p>\n\n<p>As a learning exercise, I'm trying to create a simple library to handle json based configuration file. As a configuration file to be used for more then one app, it should be able to handle different parameters. Then I have created a type struct Configuration that has the filename and a data interface. Each app will have a struct based on its configuration needs.</p>\n\n<p>In the code bellow, I put all together (lib and \"main code\") and the \"TestData struct\" is the \"app parameters\".\nIf it doesn't exists, it will set a default values and create the file, and it is working. But when I try to read the file. I try to decode the json and put it back into the data interface. But it is giving me an error and I couldn't figure out how to solve this. Can someone help on this?</p>\n\n<p>[updated] I didn't put the targeted code before, because I though that it would be easier to read in in all as a single program. Bellow is the 'targeted code' for better view of the issue.\nAs I will not be able to use the TestData struct inside the library, since it will change from program to program, the only way to handle this was using interface. Is there a better way?</p>\n\n<p><strong>library config</strong></p>\n\n<pre><code>package config\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\n// Base configuration struct\ntype Configuration struct {\n    Filename string\n    Data     interface{}\n}\n\nfunc (c *Configuration) Create(cData *Configuration) bool {\n    cFile, err := os.Open(cData.Filename)\n    defer cFile.Close()\n    if err == nil {\n        fmt.Println(\"Error(1) trying to create a configuration file. File '\", cData.Filename, \"' may already exist...\")\n        return false\n    }\n    cFile, err = os.Create(cData.Filename)\n    if err != nil {\n        fmt.Println(\"Error(2) trying to create a configuration file. File '\", cData.Filename, \"' may already exist...\")\n        return false\n    }\n    buffer, _ := json.MarshalIndent(cData.Data, \"\", \"\")\n    cFile.Write(buffer)\n    return true\n}\n\nfunc (c *Configuration) Read(cData *Configuration) bool {\n    cFile, err := os.Open(cData.Filename)\n    defer cFile.Close()\n    if err != nil {\n        fmt.Println(\"Error(1) trying to read a configuration file. File '\", cData.Filename, \"' may not already exist...\")\n        return false\n    }\n    jConfig := json.NewDecoder(cFile)\n    jerr := jConfig.Decode(&amp;cData.Data)\n    if jerr != nil {\n        panic(jerr)\n    }\n    return true\n}\n</code></pre>\n\n<p><strong>program using library config</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"./config\"\n)\n\n// struct basic para configura\u00e7\u00e3o\ntype TestData struct {\n    URL  string\n    Port string\n}\n\nfunc main() {\n    var Config config.Configuration\n    Config.Filename = \"config.json\"\n\n    if !Config.Read(&amp;Config) {\n        Config.Data = TestData{\"http\", \"8080\"}\n        Config.Create(&amp;Config)\n    }\n    fmt.Println(Config.Data)\n    TestData1 := &amp;TestData{}\n    TestData1 = Config.Data.(*TestData) // error, why?\n    fmt.Println(TestData1.URL)\n}\n</code></pre>\n\n<p>NEW UPDATE:\nI have made some changes after JimB comment about I'm not clear about some concepts and I tried to review it. Sure many things aren't clear for me yet unfortunately. The \"big\" understanding I believe I got, but what mess my mind up is the \"ins\" and \"outs\" of values and formats and pointers, mainly when it goes to other libraries. I'm not able yet to follow the \"full path\" of it.</p>\n\n<p>Yet, I believe I had some improvement <a href=\"http://play.golang.org/p/X4Nute42Ll\" rel=\"nofollow noreferrer\">on my code</a>.</p>\n\n<p>I think that I have corrected some points, but still have some big questions:</p>\n\n<ol>\n<li>I stopped sending \"Configuration\" as a parameter as all \"data\" were already there as they are \"thenselfs\" in the instance. Right?</li>\n<li>Why do I have use reference in the line 58 (Config.Data = &amp;TestData{})</li>\n<li>Why to I have to use pointer in the line 64 (tmp := Config.Data.(*TestData)</li>\n<li>Why I CANNOT use reference in line 69 (Config.Data = tmp)</li>\n</ol>\n\n<p>Thanks</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 0, "last_activity_date": 1455146241, "creation_date": 1455146241, "answer_id": 35327913, "question_id": 35325473, "link": "https://stackoverflow.com/questions/35325473/update-mongo-transaction-by-field-name-like-in-given-example/35327913#35327913", "title": "Update mongo transaction by field Name like in given example", "body": "<p>I don't believe this is possible using the Op method based on the documentation. I believe the reasoning behind disallowing this is that if you were to allow transactions based on a set field rather than by the mongo-assigned ID, there is a risk that changes can be made on the wrong document (what if someone else has the name Ben that you don't want to apply this change to?). </p>\n\n<p>Since transactions like this in Mongo are usually done by 2-phase staging it makes sense to me that the limitation for this usage is that you have to make an array of transaction Ops based on IDs you find by running a separate query by the account names.</p>\n"}], "owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455146241, "creation_date": 1455136867, "question_id": 35325473, "link": "https://stackoverflow.com/questions/35325473/update-mongo-transaction-by-field-name-like-in-given-example", "title": "Update mongo transaction by field Name like in given example", "body": "<p>I am using labix as driver and I want to make transactions over couple collections, I found link <a href=\"http://blog.labix.org/2012/08/22/multi-doc-transactions-for-mongodb\" rel=\"nofollow\"><code>http://blog.labix.org/2012/08/22/multi-doc-transactions-for-mongodb</code></a> and I want to update in collection <code>Owner</code> and <code>Employer</code> not by <code>Id</code> but by <code>Name</code> field in collection. How can I achieve this ( simple switching Id with Name does not work ).</p>\n\n<pre><code>runner := txn.NewRunner(tcollection)\nops := []txn.Op{{\n        C:      \"accounts\", \n        Id:     \"aram\",//Name\n        Assert: M{\"balance\": M{\"$gte\": 100}},\n        Update: M{\"$inc\": M{\"balance\": -100}},\n}, {\n        C:      \"accounts\",\n        Id:     \"ben\",//Name\n        Assert: M{\"valid\": true},\n        Update: M{\"$inc\": M{\"balance\": 100}},\n}}\nid := bson.NewObjectId() // Optional\nerr := runner.Run(ops, id, nil)\n</code></pre>\n"}, {"tags": ["go", "reflection", "interface", "slice", "type-assertion"], "answers": [{"comments": [{"owner": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "edited": false, "score": 0, "creation_date": 1455121678, "post_id": 35320463, "comment_id": 58350005, "body": "@izca, in my particular example it&#39;s failing with this error <code>interface conversion: interface {} is *[]util.sample, not *[]interface {}</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "edited": false, "score": 1, "creation_date": 1455121767, "post_id": 35320463, "comment_id": 58350069, "body": "@PabloFernandez <code>*[]util.sample</code> and <code>*[]interface{}</code> are 2 different types. If your <code>val</code> contains a value of type <code>*[]util.sample</code>, you can only get a value of <code>*[]util.sample</code> out of it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1527071563, "last_edit_date": 1527071563, "creation_date": 1455121264, "answer_id": 35320463, "question_id": 35320357, "link": "https://stackoverflow.com/questions/35320357/interface-variable-to-interface/35320463#35320463", "title": "interface{} variable to []interface{}", "body": "<p>You can simply use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> to obtain the value stored in an interface, e.g.</p>\n\n<pre><code>if isPointerToSlice(val) {\n    var result []interface{}\n    result = *val.(*[]interface{})\n    fmt.Println(result)\n} else {\n    fmt.Println(\"Not *[]interface{}\")\n}\n</code></pre>\n\n<p>The type of the value stored in the interface as you claim is pointer to <code>[]interface{}</code>, which is <code>*[]interface{}</code>. The result of the type assertion will be a pointer, just dereference it to get the slice <code>[]interface{}</code>.</p>\n\n<p>Using <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a>:</p>\n\n<pre><code>result := *val.(*[]interface{}) // type of result is []interface{}\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/WnYWFqyQKk\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<hr>\n\n<p>Also your attempt also works:</p>\n\n<pre><code>slice, worked := reflect.ValueOf(val).Elem().Interface().([]interface{})\nfmt.Println(slice, worked)\n</code></pre>\n\n<p>Here's the <a href=\"http://play.golang.org/p/LZekklRqzm\" rel=\"nofollow noreferrer\">edited the Playground example</a> which proves your solution works.</p>\n\n<p>But using reflection is unnecessary (as it can be done with type assertion).</p>\n\n<p>Also note that <code>*[]interface{}</code> and <code>*[]someOtherType</code> are 2 different types and you can't obtain a value of <code>*[]interface{}</code> if there is something else in <code>val</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1455123964, "creation_date": 1455123964, "answer_id": 35321504, "question_id": 35320357, "link": "https://stackoverflow.com/questions/35320357/interface-variable-to-interface/35321504#35321504", "title": "interface{} variable to []interface{}", "body": "<p>If you just want to convert a slice to <code>[]interface{}</code> you can use something like this:</p>\n\n<pre><code>func sliceToIfaceSlice(val interface{}) []interface{} {\n    rf := reflect.Indirect(reflect.ValueOf(val)) // skip the pointer\n    if k := rf.Kind(); k != reflect.Slice &amp;&amp; k != reflect.Array {\n        // panic(\"expected a slice or array\")\n        return nil\n    }\n    out := make([]interface{}, rf.Len())\n    for i := range out {\n        out[i] = rf.Index(i).Interface()\n    }\n    return out\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/OKH2jsFgCN\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}, {"tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 0, "last_activity_date": 1455127158, "last_edit_date": 1455127158, "creation_date": 1455125360, "answer_id": 35321977, "question_id": 35320357, "link": "https://stackoverflow.com/questions/35320357/interface-variable-to-interface/35321977#35321977", "title": "interface{} variable to []interface{}", "body": "<p>Icza's answer is great and will work especially if you can't know for sure you are getting an interface slice, however if you don't want to bother with the reflect package at all and want to keep imported code low, you can use type switching to obtain the same functionality using only built-in methods.</p>\n\n<p>Using this method, you can shorten your code to just:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    s := []interface{}{\"one\", 2}\n    p := &amp;s\n\n    do(p)\n}\n\nfunc do(val interface{}) {\n    switch val.(type){\n    case *[]interface{}:\n        var result []interface{}\n        result = *val.(*[]interface{})\n        fmt.Println(result)\n    }\n}\n</code></pre>\n\n<p>Playground:  <a href=\"http://play.golang.org/p/DT_hb8JcVt\" rel=\"nofollow\">http://play.golang.org/p/DT_hb8JcVt</a></p>\n\n<p>The downside is if you don't know the exact type of slice you are receiving beforehand, then this will not work unless you list all possible types for handling and assertion.</p>\n"}], "owner": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1527071582, "creation_date": 1455120968, "last_edit_date": 1527071582, "question_id": 35320357, "link": "https://stackoverflow.com/questions/35320357/interface-variable-to-interface", "title": "interface{} variable to []interface{}", "body": "<p>I have an <code>interface{}</code> variable and I know it's a pointer to slice:</p>\n\n<pre><code>func isPointerToSlice(val interface{}) bool {\n    value := reflect.ValueOf(val)\n    return value.Kind() == reflect.Ptr &amp;&amp; value.Elem().Kind() == reflect.Slice\n}\n</code></pre>\n\n<p>But I'm finding difficult to type cast it into an <code>[]interface{}</code> variable:</p>\n\n<pre><code>if isPointerToSlice(val) {\n  slice, worked := reflect.ValueOf(val).Elem().Interface().([]interface{})\n  // 'worked' is false :(\n}\n</code></pre>\n\n<p>This doesn't work. Any idea how can I solve this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 816, "user_id": 2877726, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10203852741787593/picture?type=large", "display_name": "Itzdsp", "link": "https://stackoverflow.com/users/2877726/itzdsp"}, "edited": false, "score": 0, "creation_date": 1455122105, "post_id": 35320446, "comment_id": 58350320, "body": "you are right. I just started learning :) i changed it to       val2:=strconv.FormatInt(time.Now().Unix(),10).   Now everything is fine. Actually i want to get the string from int64"}, {"owner": {"reputation": 816, "user_id": 2877726, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10203852741787593/picture?type=large", "display_name": "Itzdsp", "link": "https://stackoverflow.com/users/2877726/itzdsp"}, "edited": false, "score": 0, "creation_date": 1455122315, "post_id": 35320446, "comment_id": 58350478, "body": "am wondering how it was working last week without any changes?"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1455121211, "creation_date": 1455121211, "answer_id": 35320446, "question_id": 35320251, "link": "https://stackoverflow.com/questions/35320251/unix-time-returns-0-or-some-small-value-in-golang/35320446#35320446", "title": "Unix time returns 0 or some small value in GOLANG", "body": "<p>First of all, why are you using <code>strconv</code> if <code>Unix</code> already returns an <code>int64</code>?</p>\n\n<p>Secondly, <code>string(int)</code> conversion <a href=\"http://play.golang.org/p/ERmKxfzXhN\" rel=\"nofollow\">doesn't do what you think it does</a>. It converts between Unicode code points (aka <code>rune</code>s) and strings. You need <code>strconv.Itoa</code> here:</p>\n\n<pre><code>val, _ := strconv.ParseInt(strconv.FormatInt(time.Now().Unix(), 10), 10, 64)\nprintln(\"Time now in openshift :\", val)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/AC7Q84ZIMC\" rel=\"nofollow\">http://play.golang.org/p/AC7Q84ZIMC</a></p>\n"}, {"comments": [{"owner": {"reputation": 816, "user_id": 2877726, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10203852741787593/picture?type=large", "display_name": "Itzdsp", "link": "https://stackoverflow.com/users/2877726/itzdsp"}, "edited": false, "score": 0, "creation_date": 1455122490, "post_id": 35320748, "comment_id": 58350615, "body": "I dint notice the format function in time package itself."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1455137146, "post_id": 35320748, "comment_id": 58359935, "body": "@MarkusWMahlberg: The language hint (<code>&lt;!-- language: lang-go --&gt;</code>) before the code block wasn&#39;t working; it was causing the code not to be highlighted at all."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 5, "last_activity_date": 1455123539, "last_edit_date": 1455123539, "creation_date": 1455121934, "answer_id": 35320748, "question_id": 35320251, "link": "https://stackoverflow.com/questions/35320251/unix-time-returns-0-or-some-small-value-in-golang/35320748#35320748", "title": "Unix time returns 0 or some small value in GOLANG", "body": "<p>There is absolutely no need to convert the time to a string by hand, time.Format does this for you. Or, if you want to print out the seconds since epoch, simply use the <a href=\"https://golang.org/pkg/fmt/#pkg-overview\" rel=\"nofollow\"><code>%d</code> verb, which is explicitly for printing base10 decimal numbers</a> <kbd><a href=\"http://play.golang.org/p/he9SCTQ5Z-\" rel=\"nofollow\">Run on playground</a></kbd></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    fmt.Printf(\"Hello, %s\\n\",time.Now().Format(time.RFC3339))\n    fmt.Printf(\"Seconds since epoch %d\",time.Now().Unix())\n}\n</code></pre>\n"}], "owner": {"reputation": 816, "user_id": 2877726, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10203852741787593/picture?type=large", "display_name": "Itzdsp", "link": "https://stackoverflow.com/users/2877726/itzdsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 35320748, "answer_count": 2, "score": -1, "last_activity_date": 1455126783, "creation_date": 1455120685, "last_edit_date": 1455126783, "question_id": 35320251, "link": "https://stackoverflow.com/questions/35320251/unix-time-returns-0-or-some-small-value-in-golang", "title": "Unix time returns 0 or some small value in GOLANG", "body": "<p>What is wrong with the below GO code? I tried a GO project and deployed in Openshift and everything was fine till yesterday. All of a sudden from today, the time package returns 0</p>\n\n<pre><code>val,_ := strconv.ParseInt(string(time.Now().Unix()),10,64)\nprintln(\"Time now in openshift :\",time.Now().Second())\n</code></pre>\n\n<p>So basically actual time here is \"1969-12-31\". Could be the bug in GO.</p>\n"}, {"tags": ["wcf", "go"], "answers": [{"tags": [], "owner": {"reputation": 2530, "user_id": 317935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3PIEC.jpg?s=128&g=1", "display_name": "NickD", "link": "https://stackoverflow.com/users/317935/nickd"}, "is_accepted": false, "score": 0, "last_activity_date": 1486735142, "creation_date": 1486735142, "answer_id": 42161182, "question_id": 35320183, "link": "https://stackoverflow.com/questions/35320183/consume-wcf-service-from-go-application/42161182#42161182", "title": "Consume WCF service from go application", "body": "<p>I think you should expose a RESTful Service. I myself have the problem with exposing a WCF Service too many clients using PHP, Go, Ruby and all kind of languages. We never ever got it right, to automatically generate a proxy. </p>\n\n<p>The maybe simplest way is to use WCF, like described in this example:\n<a href=\"https://www.codeproject.com/Articles/105273/Create-RESTful-WCF-Service-API-Step-\" rel=\"nofollow noreferrer\">https://www.codeproject.com/Articles/105273/Create-RESTful-WCF-Service-API-Step-</a>\nBy-Step-Guide</p>\n\n<p>But I recommend to switch to ASP.NET Core (Migration is not that hard) or if you have the budget I would consider <a href=\"https://servicestack.net/\" rel=\"nofollow noreferrer\">https://servicestack.net/</a> </p>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 2370297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43fff4244328b0d0a12dcd4a7ffd73b2?s=128&d=identicon&r=PG", "display_name": "Amitabh", "link": "https://stackoverflow.com/users/2370297/amitabh"}, "is_accepted": false, "score": 0, "last_activity_date": 1532790889, "creation_date": 1532790889, "answer_id": 51572659, "question_id": 35320183, "link": "https://stackoverflow.com/questions/35320183/consume-wcf-service-from-go-application/51572659#51572659", "title": "Consume WCF service from go application", "body": "<p>It may be well beyond the wait time for this. However, here is something really interesting that could help. The situation the authors found themselves is relevant even today in some organizations.</p>\n\n<p><a href=\"https://github.com/khoad/msbingo\" rel=\"nofollow noreferrer\">https://github.com/khoad/msbingo</a></p>\n\n<p>Here's the motivation provided by the authors:</p>\n\n<p>Application/soap+msbin1 encoding was a blocking issue for modernizing services from WCF to platform-agnostic technologies such as Go. <em>We needed to be able to make calls to dependency services that spoke msbin1 and were not going to be updated or even reconfigured</em>, but we did not want to introduce unnecessary complexity such as workarounds like .NET-based WCF request translator proxies or deploying Mono with our service instances. Initially we tried the Mono deployment route, which, while it would have worked well enough, significantly complicated our deployment pipeline, thus erasing one of the major advantages of golang.</p>\n\n<p>I found it a useful starting point to begin experimentation.</p>\n"}], "owner": {"reputation": 8132, "user_id": 1047741, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/22b99950c3244125a6de0dfdc2895eeb?s=128&d=identicon&r=PG", "display_name": "shytikov", "link": "https://stackoverflow.com/users/1047741/shytikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 914, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1532790889, "creation_date": 1455120526, "question_id": 35320183, "link": "https://stackoverflow.com/questions/35320183/consume-wcf-service-from-go-application", "title": "Consume WCF service from go application", "body": "<p>Is it even possible more or less natively consume <code>WCF</code> service from Go application?</p>\n\n<p>I can imagine it should be possible to execute <code>SOAP</code> calls in Go, but <code>WCF</code> is a bit more than that only, for example authorization will probably be a problem also...</p>\n\n<p>Have anyone at least approached this area, or maybe someone can give useful me advice in this \"wheel reinvention task\"?</p>\n\n<p>Thank you in advance for all your input, ideas and suggestions.</p>\n"}, {"tags": ["go", "ip-address", "network-interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1455119047, "post_id": 35319515, "comment_id": 58347939, "body": "<code>LookupIP</code> can only look up the IP address via the resolver with the given hostname. It knows nothing about what IPs are bound to what interfaces."}, {"owner": {"reputation": 63, "user_id": 857182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908787661c68287895c5ee60be18dd87?s=128&d=identicon&r=PG", "display_name": "siliconghost", "link": "https://stackoverflow.com/users/857182/siliconghost"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455119194, "post_id": 35319515, "comment_id": 58348064, "body": "Thanks @JimB. Any idea why it would work fine on a system that doesn&#39;t have a DNS suffix defined?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1455119424, "post_id": 35319515, "comment_id": 58348259, "body": "If it doesn&#39;t have a DNS name, that probably means it&#39;s listed in /etc/hosts, or looked up via another mechanism via /etc/nsswitch.conf. If you want all local IP addresses, then you have to enumerate them yourself."}, {"owner": {"reputation": 63, "user_id": 857182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908787661c68287895c5ee60be18dd87?s=128&d=identicon&r=PG", "display_name": "siliconghost", "link": "https://stackoverflow.com/users/857182/siliconghost"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455119621, "post_id": 35319515, "comment_id": 58348408, "body": "@JimB But that doesn&#39;t seem to explain why I don&#39;t have to enumerate them myself when I use the exact same code on another system. The only difference on that system is that a DNS suffix is not defined.  Also, a hostname is defined on the system that it is not working and I have confirmed that Go is detecting it properly through fmt.Println(hostname)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1455120068, "post_id": 35319515, "comment_id": 58348750, "body": "<code>LookupIP</code> is returning what the local resolver responds with. I don&#39;t know exactly what you mean by &quot;DNS suffix&quot;, but check how the names you&#39;re looking up are resolved on a system level first (i.e. is it resolving from /etc/hosts or another nsswitch source). You can also run <code>GODEBUG=netdns=1</code> to see if there is any useful info about what resolver decisions the go net package makes."}], "answers": [{"comments": [{"owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "edited": false, "score": 0, "creation_date": 1455128251, "post_id": 35322468, "comment_id": 58354495, "body": "Also, if you&#39;re curious to learn more about Go DNS resolution you can visit here: <a href=\"https://golang.org/pkg/net/#hdr-Name_Resolution\" rel=\"nofollow noreferrer\">golang.org/pkg/net/#hdr-Name_Resolution</a>"}, {"owner": {"reputation": 63, "user_id": 857182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908787661c68287895c5ee60be18dd87?s=128&d=identicon&r=PG", "display_name": "siliconghost", "link": "https://stackoverflow.com/users/857182/siliconghost"}, "edited": false, "score": 0, "creation_date": 1455129847, "post_id": 35322468, "comment_id": 58355477, "body": "Thanks, that is exactly what I needed!"}], "tags": [], "owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "is_accepted": true, "score": 5, "last_activity_date": 1455157256, "last_edit_date": 1455157256, "creation_date": 1455126756, "answer_id": 35322468, "question_id": 35319515, "link": "https://stackoverflow.com/questions/35319515/how-do-i-get-all-ip-addresses-assigned-to-the-machine/35322468#35322468", "title": "How do I get all IP addresses assigned to the machine?", "body": "<p>If you're trying to get the addresses currently assigned to the machine.  I think you should consider using <code>net.InterfaceAddrs()</code> instead of trying to do a DNS lookup for the hostname.  Here's a short example that will give you all the IPs on the local machine. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nfunc main() {\n    addrs, _ := net.InterfaceAddrs()\n    fmt.Printf(\"%v\\n\", addrs)\n    for _, addr := range addrs {\n        fmt.Println(\"IPv4: \", addr)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 857182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/908787661c68287895c5ee60be18dd87?s=128&d=identicon&r=PG", "display_name": "siliconghost", "link": "https://stackoverflow.com/users/857182/siliconghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 0, "accepted_answer_id": 35322468, "answer_count": 1, "score": 3, "last_activity_date": 1455158866, "creation_date": 1455118802, "last_edit_date": 1455158866, "question_id": 35319515, "link": "https://stackoverflow.com/questions/35319515/how-do-i-get-all-ip-addresses-assigned-to-the-machine", "title": "How do I get all IP addresses assigned to the machine?", "body": "<p>Given the following code:</p>\n\n<pre><code>// iptest\npackage main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"os\"\n)\n\nfunc main() {\n    host, _ := os.Hostname()\n    addrs, _ := net.LookupIP(host)\n    for _, addr := range addrs {\n        if ipv4 := addr.To4(); ipv4 != nil {\n            fmt.Println(\"IPv4: \", ipv4)\n        }   \n    }\n}\n</code></pre>\n\n<p>I'm having a problem where it only returns the first IP address assigned to the adapter.  This appears to be a problem only on systems that have a DNS suffix defined.  If one is not defined, it works fine and reports all IPs that have been assigned.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455113964, "post_id": 35317456, "comment_id": 58344011, "body": "Do you want to pass data between different handlers during the same request?"}, {"owner": {"reputation": 225, "user_id": 4126554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57af07817f7e40be95e79b5af072e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pereverzev", "link": "https://stackoverflow.com/users/4126554/alexander-pereverzev"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455114234, "post_id": 35317456, "comment_id": 58344202, "body": "@JimB, yes I want it)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1455115086, "post_id": 35317456, "comment_id": 58344858, "body": "The most commonly used context package is <a href=\"https://godoc.org/golang.org/x/net/context\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/net/context</a>. You need to change the signature of your handlers and pass that context value through, or you could use a global context handler like <a href=\"http://www.gorillatoolkit.org/pkg/context\" rel=\"nofollow noreferrer\">gorillatoolkit.org/pkg/context</a>"}], "owner": {"reputation": 225, "user_id": 4126554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57af07817f7e40be95e79b5af072e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pereverzev", "link": "https://stackoverflow.com/users/4126554/alexander-pereverzev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455113451, "creation_date": 1455113451, "question_id": 35317456, "link": "https://stackoverflow.com/questions/35317456/have-i-any-opportunity-to-attach-decode-json-struct-to-http-request-variable-in", "title": "Have I any opportunity to attach decode json struct to http.Request variable in go lang", "body": "<p>I have a situation some methods use one link to request *http.Request. In it body it contains json. And I need to get different data from that json. But I don't want to decode json every time in every method again and again. Can I decode once and attach the link of struct or json (in string) to request. I try to find the solution but I didn't found anything. I know that I can create my own functional for this, but I think that such packages like \"*http.Request\" or \"github.com/gorilla/mux\" should have such functionality from the box. Anyone known?</p>\n"}, {"tags": ["javascript", "curl", "go"], "comments": [{"owner": {"reputation": 337, "user_id": 799341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0d2b6382b24d36cda1d30da9b0d8c?s=128&d=identicon&r=PG", "display_name": "Nevio Vesi\u0107", "link": "https://stackoverflow.com/users/799341/nevio-vesi%c4%87"}, "edited": false, "score": 0, "creation_date": 1455113892, "post_id": 35314655, "comment_id": 58343954, "body": "So what&#39;s exactly your problem? Sorry but I am trying to understand your question. Do you wish to validate authorization header within golang ( <a href=\"https://golang.org/pkg/net/http/#Request.BasicAuth\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Request.BasicAuth</a> )?"}, {"owner": {"reputation": 120, "user_id": 5320710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77251aed2e7c2fb4f59bc5d75257c38?s=128&d=identicon&r=PG&f=1", "display_name": "Justinjs", "link": "https://stackoverflow.com/users/5320710/justinjs"}, "reply_to_user": {"reputation": 337, "user_id": 799341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0d2b6382b24d36cda1d30da9b0d8c?s=128&d=identicon&r=PG", "display_name": "Nevio Vesi\u0107", "link": "https://stackoverflow.com/users/799341/nevio-vesi%c4%87"}, "edited": false, "score": 0, "creation_date": 1455188039, "post_id": 35314655, "comment_id": 58381931, "body": "Assume golang is running as a server instance port 9000, i have my website file running in apache server port 6060 separately, when i make a curl request from my website (php) to golang it works. But when i try that same curl post from my website(javascript) to golang im not sure about the syntax . i need some help regarding curl post from javascript to golang server.."}, {"owner": {"reputation": 337, "user_id": 799341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0d2b6382b24d36cda1d30da9b0d8c?s=128&d=identicon&r=PG", "display_name": "Nevio Vesi\u0107", "link": "https://stackoverflow.com/users/799341/nevio-vesi%c4%87"}, "edited": false, "score": 0, "creation_date": 1455189651, "post_id": 35314655, "comment_id": 58383040, "body": "The same thing you have there should work. Tho there&#39;s one thing, you can replace this beforeSend Authorization with just &#39;username&#39; and &#39;password&#39;. You can see settings description about it here: <a href=\"http://api.jquery.com/jquery.ajax/\" rel=\"nofollow noreferrer\">api.jquery.com/jquery.ajax</a>"}], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 5320710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77251aed2e7c2fb4f59bc5d75257c38?s=128&d=identicon&r=PG&f=1", "display_name": "Justinjs", "link": "https://stackoverflow.com/users/5320710/justinjs"}, "edited": false, "score": 0, "creation_date": 1455108966, "post_id": 35314959, "comment_id": 58340413, "body": "but where do i get this key value ? can you post an example ?@ Simo"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1455109915, "last_edit_date": 1455109915, "creation_date": 1455106379, "answer_id": 35314959, "question_id": 35314655, "link": "https://stackoverflow.com/questions/35314655/posting-values-to-golang-via-curl-request-in-javascript-or-jquery/35314959#35314959", "title": "Posting values to golang via curl request in javascript or jquery", "body": "<p>To set the request header you have to use the <a href=\"https://golang.org/pkg/net/http/#Request.Write\" rel=\"nofollow\"><code>Write</code></a> function which provide a <code>Get()</code> function accepting a <code>key</code> and a <code>value</code> as parameter.</p>\n\n<pre><code>func (h Header) Set(key, value string)\n</code></pre>\n\n<p>To setup the request header you should use:</p>\n\n<pre><code>writer.Header().Set(\"Content-Type\", \"application/json\")\n</code></pre>\n\n<p>where <code>writer</code> is of type <a href=\"https://golang.org/pkg/net/http/#HandlerFunc.ServeHTTP\" rel=\"nofollow\"><code>http.ResponseWriter</code></a>.</p>\n"}], "owner": {"reputation": 120, "user_id": 5320710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77251aed2e7c2fb4f59bc5d75257c38?s=128&d=identicon&r=PG&f=1", "display_name": "Justinjs", "link": "https://stackoverflow.com/users/5320710/justinjs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455109915, "creation_date": 1455105584, "question_id": 35314655, "link": "https://stackoverflow.com/questions/35314655/posting-values-to-golang-via-curl-request-in-javascript-or-jquery", "title": "Posting values to golang via curl request in javascript or jquery", "body": "<p>This is my curl post from php.This works perfectly</p>\n\n<pre><code>extract($postFieldsArr);\n$json_id = json_encode($postFieldsArr);\n\n$ch = curl_init();\ncurl_setopt($ch, CURLOPT_URL, 'https://localhost:9000/GoogleSimpleReports');\ncurl_setopt($ch, CURLOPT_PORT, 9000);\ncurl_setopt($ch, CURLOPT_CUSTOMREQUEST, \"POST\");\ncurl_setopt($ch, CURLOPT_POSTFIELDS, $json_id);\ncurl_setopt($ch, CURLOPT_SSLVERSION, 1);\ncurl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);  \ncurl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          \n    'Content-Type: application/json',                                                                                \n    'Content-Length: ' . strlen($json_id))                                                                       \n);                                                                                                                   \n\n$result = curl_exec($ch);\n</code></pre>\n\n<p>Similarly i  am trying to perform a curl post from javascript to golang, is this the correct syntax ? How do i set this setRequestHeader Authorization ?</p>\n\n<pre><code>$.ajax({\n        url: 'https://localhost:9000/GoogleSimpleReports',\n        beforeSend: function(xhr) {\n             xhr.setRequestHeader(\"Authorization\", \"Bearer 6QXNMEMFHNY4FJ5ELNFMP5KRW52WFXN5\")\n        }, success: function(data){\n            alert(data);\n            //process the JSON data etc\n        }\n})\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1455106595, "post_id": 35314649, "comment_id": 58338644, "body": "See also <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a>. And please stop thinking of inheritance and parent-child-relation. Go has absolutely no notion of inheritance and embedding is a) not inheritance and b) not suitable to mimic inheritance."}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1455111533, "post_id": 35314791, "comment_id": 58342285, "body": "nitpick, it&#39;s called a slice not an array."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1455115895, "post_id": 35314791, "comment_id": 58345449, "body": "&quot;an array that backs up a slice&quot; would be even more accurate"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 1, "last_activity_date": 1455106283, "last_edit_date": 1455106283, "creation_date": 1455105928, "answer_id": 35314791, "question_id": 35314649, "link": "https://stackoverflow.com/questions/35314649/cannot-use-children-type-child-as-type-node-in-argument-to-func/35314791#35314791", "title": "cannot use children (type []Child) as type []Node in argument to func", "body": "<p>An array of structs (such as <code>[]Child</code>) has very different memory layout comparing to an array of interfaces (such as <code>[]Node</code>). So Go doesn't do <code>[]Child</code> to <code>[]Node</code> conversion implicitly, you have to do it yourself:</p>\n\n<pre><code>nodes := make([]Node, len(children), len(children))\nfor i := range children {\n    nodes[i] = children[i]\n}\nsayHellos(nodes)\n</code></pre>\n\n<p>BTW in the example you provided it would be more efficient to call <code>sayHello</code> directly:</p>\n\n<pre><code>for _, child := range children {\n    child.sayHello()\n}\n</code></pre>\n\n<p>Probably this is what you should do in your program as well.</p>\n"}], "owner": {"reputation": 13, "user_id": 3013223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5133b17d3f244063f8bd139ab069d5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Franxoois", "link": "https://stackoverflow.com/users/3013223/franxoois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 35314791, "answer_count": 1, "score": 0, "last_activity_date": 1455106283, "creation_date": 1455105564, "question_id": 35314649, "link": "https://stackoverflow.com/questions/35314649/cannot-use-children-type-child-as-type-node-in-argument-to-func", "title": "cannot use children (type []Child) as type []Node in argument to func", "body": "<p>Here is my test code </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Node interface {\n    sayHello()\n}\n\ntype Parent struct {\n    Name string\n}\n\ntype Child struct {\n    Parent\n    Age int\n}\n\ntype Children []Child\n\nfunc (p Parent) sayHello() {\n    fmt.Printf(\"Hello my name is %s\\n\", p.Name)\n}\n\nfunc (p Child) sayHello() {\n    fmt.Printf(\"Hello my name is %s and I'm %d\\n\", p.Name, p.Age)\n}\n\nfunc makeSayHello(n Node) {\n    n.sayHello()\n}\n\nfunc sayHellos(list []Node) {\n    for _, p := range list {\n        makeSayHello(p)\n    }\n}\n\nfunc main() {\n\n    children := []Child{Child{Parent: Parent{Name: \"Bart\"}, Age: 8}, Child{Parent: Parent{Name: \"Lisa\"}, Age: 9}}\n\n    for _, c := range children {\n        c.sayHello()\n    }\n\n    makeSayHello( Parent{\"Homer\"} )\n    sayHellos( []Node{Parent{\"Homer\"}} )\n    sayHellos( []Node{Parent{\"Homer\"},Child{Parent:Parent{\"Maggy\"},Age:3}} )\n\n\n    sayHellos( children )   // error : cannot use children (type []Child) as type []Node in argument to sayHellos\n}\n</code></pre>\n\n<p>link <a href=\"https://play.golang.org/p/7IZLoXjlIK\" rel=\"nofollow\">https://play.golang.org/p/7IZLoXjlIK</a></p>\n\n<p>I don't get it. Let's say I have a []Child I cannot modify and I want use it with un function accepting []Parent. Why do I have an type error ?</p>\n\n<p>If I can't or don't want this solution by changing  </p>\n\n<pre><code>children := []Child{...}\n</code></pre>\n\n<p>to </p>\n\n<pre><code>children := []Node{...}\n</code></pre>\n\n<p>What can I do to transform the []Child to []Node ? It is not already ? Do I have to do another []Node to copy my elements in ?\nI na\u00efvely try children.([]Node) or []Node(children) without success ... </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455098346, "post_id": 35310694, "comment_id": 58333058, "body": "You need to set it to an instance of os.File as returned by <a href=\"https://golang.org/pkg/os/#OpenFile\" rel=\"nofollow noreferrer\">os.OpenFile</a> with the according settings."}], "answers": [{"comments": [{"owner": {"reputation": 254, "user_id": 5907262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f7bbf9ea306da3e322d886f8f7ed19?s=128&d=identicon&r=PG&f=1", "display_name": "Xeph", "link": "https://stackoverflow.com/users/5907262/xeph"}, "edited": false, "score": 0, "creation_date": 1455107605, "post_id": 35313372, "comment_id": 58339415, "body": "Thank you. It is working.Looks like Windows notepad cannot handle UNIX newline character, but anyway :)"}], "tags": [], "owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "is_accepted": false, "score": 2, "last_activity_date": 1455176017, "last_edit_date": 1455176017, "creation_date": 1455102080, "answer_id": 35313372, "question_id": 35310694, "link": "https://stackoverflow.com/questions/35310694/gin-outputs-to-a-file/35313372#35313372", "title": "Gin outputs to a file", "body": "<p>You can use <code>os</code> package to create a file.</p>\n\n<pre><code>file, fileErr := os.Create(\"file\")\nif fileErr != nil {\n    fmt.Println(fileErr)\n    return\n}\ngin.DefaultWriter = file\n</code></pre>\n\n<p>This should create a file and start writing to it.</p>\n"}], "owner": {"reputation": 254, "user_id": 5907262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f7bbf9ea306da3e322d886f8f7ed19?s=128&d=identicon&r=PG&f=1", "display_name": "Xeph", "link": "https://stackoverflow.com/users/5907262/xeph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2348, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1617550145, "creation_date": 1455094909, "last_edit_date": 1617550145, "question_id": 35310694, "link": "https://stackoverflow.com/questions/35310694/gin-outputs-to-a-file", "title": "Gin outputs to a file", "body": "<p>I'm using Gin to make REST API server and Gin shows its output on a console like this: <a href=\"https://i.stack.imgur.com/r0LF5.png\" rel=\"nofollow noreferrer\">Gin console example</a></p>\n<p>I'd like to make gin's output to a file instead of console.</p>\n<p>What I've found is below code from Gin/mode.go</p>\n<pre><code>// DefaultWriter is the default io.Writer used the Gin for debug output and\n// middleware output like Logger() or Recovery().\n// Note that both Logger and Recovery provides custom ways to configure their\n// output io.Writer.\n// To support coloring in Windows use:\n//      import &quot;github.com/mattn/go-colorable&quot;\n//      gin.DefaultWriter = colorable.NewColorableStdout()\nvar DefaultWriter io.Writer = os.Stdout\nvar DefaultErrorWriter io.Writer = os.Stderr\n</code></pre>\n<p>Looks like I can change DefaultWriter and DefaultErrorWriter's behavior by setting like</p>\n<pre><code>gin.DefaultWriter = something\n</code></pre>\n<p>on my code.</p>\n<p>But I have no idea how to write that 'something' code; it must be a function which writes to a file but have no idea how/where to start.</p>\n<p>So, my questions are:</p>\n<ol>\n<li>Am I heading to the right direction?</li>\n<li>How to write that 'something' function? It would be very helpful if you can provide an example.</li>\n</ol>\n<p>Thank you.</p>\n"}, {"tags": ["pdf", "go", "cyrillic"], "comments": [{"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1455090209, "post_id": 35308271, "comment_id": 58328300, "body": "UTF-8 is unicode. Specifically it&#39;s an 8-bit lossless encoding of Unicode. So that&#39;s not your problem."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3961884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ff81139b0177e0eee48638e286f6e1?s=128&d=identicon&r=PG", "display_name": "Timur Shahmuratov", "link": "https://stackoverflow.com/users/3961884/timur-shahmuratov"}, "edited": false, "score": 0, "creation_date": 1455096283, "post_id": 35310264, "comment_id": 58331691, "body": "Thanks for the reply. I&#39;m on Windows 10 and using fonts from <a href=\"https://github.com/jung-kurt/gofpdf/tree/master/font\" rel=\"nofollow noreferrer\">github.com/jung-kurt/gofpdf/tree/master/font</a> which I&#39;ve copied to project directory. json map also comes from there. I receive no error on pdf.OutputFileAndClose. Could it be that fonts are located in separate folder &quot;font&quot;?"}, {"owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "reply_to_user": {"reputation": 33, "user_id": 3961884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ff81139b0177e0eee48638e286f6e1?s=128&d=identicon&r=PG", "display_name": "Timur Shahmuratov", "link": "https://stackoverflow.com/users/3961884/timur-shahmuratov"}, "edited": false, "score": 0, "creation_date": 1455098619, "post_id": 35310264, "comment_id": 58333248, "body": "@TimurShahmuratov Hmm, then I don&#39;t know. Could it be that you need to have the font installed on your system? I&#39;m not sure whether the PDF is generated incorrectly, or whether your system is only unable to display it correctly. You probably don&#39;t have Helvetica on Windows 10. Another thing you could try is to use the makefont tool on a font you know supports Cyrillic text, and then running the code with those generated files. Other than that, I&#39;m out of ideas, sorry!"}, {"owner": {"reputation": 33, "user_id": 3961884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ff81139b0177e0eee48638e286f6e1?s=128&d=identicon&r=PG", "display_name": "Timur Shahmuratov", "link": "https://stackoverflow.com/users/3961884/timur-shahmuratov"}, "edited": false, "score": 1, "creation_date": 1455619071, "post_id": 35310264, "comment_id": 58558723, "body": "Tested code on Mac OSX. Yes it works with the same fonts which used in Windows. Generated pdf files differs. Reported an issue <a href=\"https://github.com/jung-kurt/gofpdf/issues/64\" rel=\"nofollow noreferrer\">github.com/jung-kurt/gofpdf/issues/64</a>"}], "tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": true, "score": 2, "last_activity_date": 1455700590, "last_edit_date": 1455700590, "creation_date": 1455093563, "answer_id": 35310264, "question_id": 35308271, "link": "https://stackoverflow.com/questions/35308271/golang-create-pdf-with-cyrillic/35310264#35310264", "title": "golang create pdf with cyrillic", "body": "<p>First, you are ignoring an error in the final line. <code>pdf.OutputFileAndClose</code> returns an error, so you should check it:</p>\n\n<pre><code>err := pdf.OutputFileAndClose(\"test.pdf\")\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Other than that, your first example works for me. The generated output looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IKWRO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IKWRO.png\" alt=\"PDF Output\"></a></p>\n\n<p>Here is the code I used, you'll see it's very similar to yours:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/jung-kurt/gofpdf\"\n)\n\nfunc main() {\n    pdf := gofpdf.New(\"P\", \"mm\", \"A4\", \"\")\n    pdf.AddFont(\"Helvetica\", \"\", \"helvetica_1251.json\")\n    pdf.AddPage()\n    pdf.SetFont(\"Helvetica\", \"\", 16)\n    tr := pdf.UnicodeTranslatorFromDescriptor(\"cp1251\")\n    pdf.Cell(15, 50, tr(\"\u0440\u0443\u0441\u0441\u043a\u0438\u0439 \u0442\u0435\u043a\u0441\u0442\"))\n    err := pdf.OutputFileAndClose(\"test.pdf\")\n    if err != nil {\n        log.Println(err)\n    }\n}\n</code></pre>\n\n<p>With the above code, the important thing is to make sure <code>helvetica_1251.z</code>, <code>helvetica_1251.json</code> and <code>cp1251.map</code> (from <code>$GOPATH/src/github.com/jung-kurt/gofpdf/font</code>, or generated by the <code>makefont</code> tool) are all in the current directory. If you can confirm that this works for you, you can proceed to move them into the fonts directory and changing the code accordingly. My best guess is that you may be silently ignoring an error warning you about one of these files.</p>\n\n<p>PS I'm running Mac OS X. If you are on another system, make sure you have a version of Helvetica with cyrillic character support installed.</p>\n\n<p><strong>Update</strong></p>\n\n<p>For others facing this problem in the future, I wanted to add the final solution here. From the comments below:</p>\n\n<blockquote>\n  <p>Thanks to jung-kurt I found solution. You can avoid this bug on Windows by adding pdf.SetCompression(true) \u2013 Timur Shahmuratov</p>\n</blockquote>\n"}], "owner": {"reputation": 33, "user_id": 3961884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ff81139b0177e0eee48638e286f6e1?s=128&d=identicon&r=PG", "display_name": "Timur Shahmuratov", "link": "https://stackoverflow.com/users/3961884/timur-shahmuratov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2742, "favorite_count": 2, "accepted_answer_id": 35310264, "answer_count": 1, "score": 3, "last_activity_date": 1455700590, "creation_date": 1455085536, "question_id": 35308271, "link": "https://stackoverflow.com/questions/35308271/golang-create-pdf-with-cyrillic", "title": "golang create pdf with cyrillic", "body": "<p>I need to create pdf file in go with cyrillic symbols. I've started with <a href=\"https://github.com/jung-kurt/gofpdf\" rel=\"nofollow\">https://github.com/jung-kurt/gofpdf</a> but it needs 1251 symbols to produce correct cyrillic. \nI've tried </p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/jung-kurt/gofpdf\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    pwd, err := os.Getwd()\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n    pdf := gofpdf.New(\"P\", \"mm\", \"A4\", \"\")\n    pdf.AddFont(\"Helvetica\", \"\", pwd + \"/font/helvetica_1251.json\")\n    pdf.AddPage()\n    pdf.SetFont(\"Helvetica\", \"\", 16)\n    tr := pdf.UnicodeTranslatorFromDescriptor(\"cp1251\")\n    pdf.Cell(15, 50, tr(\"\u0440\u0443\u0441\u0441\u043a\u0438\u0439 \u0442\u0435\u043a\u0441\u0442\"))\n    pdf.OutputFileAndClose(\"test.pdf\")\n}\n</code></pre>\n\n<p>but it produce only dots instead of text.</p>\n\n<p>Then I've tried to use <a href=\"https://github.com/golang/freetype\" rel=\"nofollow\">https://github.com/golang/freetype</a> to create image with text and then insert it to pdf. So I've tried </p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/jung-kurt/gofpdf\"\n    \"github.com/golang/freetype\"\n    \"image\"\n    \"fmt\"\n    \"os\"\n    \"bytes\"\n    \"image/jpeg\"\n    \"io/ioutil\"\n    \"image/draw\"\n)\n\nfunc main() {\n    pwd, err := os.Getwd()\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n    dataFont, err := ioutil.ReadFile(pwd + \"/font/luxisr.ttf\")\n    if err != nil {\n        fmt.Printf(\"%v\",err)\n    }\n    f, err := freetype.ParseFont(dataFont)\n    if err != nil {\n        fmt.Printf(\"%v\",err)\n    }\n    dst := image.NewRGBA(image.Rect(0, 0, 800, 600))\n    draw.Draw(dst, dst.Bounds(), image.White, image.ZP, draw.Src)\n    c := freetype.NewContext()\n    c.SetDst(dst)\n    c.SetClip(dst.Bounds())\n    c.SetSrc(image.Black)\n    c.SetFont(f)\n    c.DrawString(\"\u0440\u0443\u0441\u0441\u043a\u0438\u0439 \u0442\u0435\u043a\u0441\u0442\", freetype.Pt(0, 16))\n    pdf := gofpdf.New(\"P\", \"mm\", \"A4\", \"\")\n    pdf.AddPage()\n    buf := new(bytes.Buffer)\n    err = jpeg.Encode(buf, dst, nil)\n\n    if err != nil {\n        fmt.Printf(\"%v\",err)\n    }\n\n    reader := bytes.NewReader(buf.Bytes())\n    textName := \"text1\"\n    pdf.RegisterImageReader(textName, \"jpg\", reader)\n    pdf.Image(textName, 15, 15, 0, 0, false, \"jpg\", 0, \"\")\n    pdf.OutputFileAndClose(\"test.pdf\")\n}\n</code></pre>\n\n<p>but as a result I receive squares instead of text because it seems that freetype needs unicode symbols for text.</p>\n\n<p>Is it possible to convert strings which are generally in utf-8 to unicode? How can I create pdf or image with cyrillic text?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["json", "mongodb", "go", "restful-url", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455097989, "post_id": 35306817, "comment_id": 58332826, "body": "You should at least include some key points. If those links become invalid, your answer becomes meaningless."}, {"owner": {"reputation": 1302, "user_id": 4519138, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rA4EN.png?s=128&g=1", "display_name": "CandleCoder", "link": "https://stackoverflow.com/users/4519138/candlecoder"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455268889, "post_id": 35306817, "comment_id": 58423738, "body": "See what he have asked I have answered...He is asking for tutorials and references."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 2, "creation_date": 1455276728, "post_id": 35306817, "comment_id": 58428911, "body": "Which <a href=\"http://stackoverflow.com/help/on-topic\">by definition is off-topic</a>. If you had explained who to do it, it may have become a question useful to others."}], "tags": [], "owner": {"reputation": 1302, "user_id": 4519138, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rA4EN.png?s=128&g=1", "display_name": "CandleCoder", "link": "https://stackoverflow.com/users/4519138/candlecoder"}, "is_accepted": false, "score": 3, "last_activity_date": 1455078548, "last_edit_date": 1455078548, "creation_date": 1455078217, "answer_id": 35306817, "question_id": 35306780, "link": "https://stackoverflow.com/questions/35306780/create-a-simple-restful-api-using-golang-gin-framework-and-mongodb/35306817#35306817", "title": "Create a simple Restful API using golang Gin Framework and MongoDB", "body": "<p>You can have this as a reference </p>\n\n<p><a href=\"https://larry-price.com/blog/2015/06/25/architecture-for-a-golang-web-app\" rel=\"nofollow\">Understanding the Architecture of Gin and its flow of Working</a></p>\n\n<p>Here is the Demo and tutorials of doing things with it.\n<a href=\"https://www.nicolasmerouze.com/how-to-render-json-api-golang-mongodb/\" rel=\"nofollow\">Golang Tutorial and Demo</a>\nAnd here is the <a href=\"https://godoc.org/github.com/gin-gonic/gin\" rel=\"nofollow\">Official Doc for it</a></p>\n\n<p>You may fork them from here <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">GitHub Repo</a> and Start to work on it &amp; can also contribute to the framework.</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 829, "user_id": 3480706, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/HzcVm.jpg?s=128&g=1", "display_name": "Nuwan Indika", "link": "https://stackoverflow.com/users/3480706/nuwan-indika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4771, "favorite_count": 3, "answer_count": 1, "score": 3, "last_activity_date": 1485022501, "creation_date": 1455078002, "last_edit_date": 1455103413, "question_id": 35306780, "link": "https://stackoverflow.com/questions/35306780/create-a-simple-restful-api-using-golang-gin-framework-and-mongodb", "title": "Create a simple Restful API using golang Gin Framework and MongoDB", "body": "<p>I need to create simple restful API using golang Gin framework and using MongoDB i'm new to golang and Gin framework. Is are any tutorial or any sample code i can refer?   </p>\n"}, {"tags": ["pointers", "go", "range"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1455077563, "creation_date": 1455077563, "answer_id": 35306693, "question_id": 35306669, "link": "https://stackoverflow.com/questions/35306669/golang-pointer-in-range-doesnt-work/35306693#35306693", "title": "golang pointer in range doesn&#39;t work", "body": "<p>The variable <code>p</code> is set to point at <code>v</code>, not to the slice element. This code sets <code>p</code> to point at the slice element:</p>\n\n<pre><code>for i, v := range a.Barry[0].Carry {\n    if v.state == \"2\" {\n        p = &amp;a.Barry[0].Carry[i]\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/GipctYDLPz\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 3, "user_id": 5906292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2f2ef6eb5f0743f8ce0c8a02ceded7f?s=128&d=identicon&r=PG&f=1", "display_name": "lucky liang", "link": "https://stackoverflow.com/users/5906292/lucky-liang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 35306693, "answer_count": 1, "score": -2, "last_activity_date": 1455080635, "creation_date": 1455077438, "last_edit_date": 1455080635, "question_id": 35306669, "link": "https://stackoverflow.com/questions/35306669/golang-pointer-in-range-doesnt-work", "title": "golang pointer in range doesn&#39;t work", "body": "<p>Why the result is <strong><code>A:&amp;{[{[{1}]}]}A:&amp;{[{[{2}]}]}A:&amp;{[{[{2}]}]}</code></strong></p>\n\n<p>not: <strong><code>A:&amp;{[{[{1}]}]}A:&amp;{[{[{2}]}]}A:&amp;{[{[{3}]}]}</code></strong></p>\n\n<p>we can't use pointer in range? \nhere is the code, I set a pointer, pointed in the range loop, but it fails.</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n)\n\ntype A struct{\n    Barry []B\n}\nfunc (this *A)init(){\n    b:=&amp;B{}\n    b.init()\n    this.Barry=[]B{*b}\n    return \n}\ntype B struct{\n    Carry []C\n}\nfunc (this *B)init(){\n    c:=&amp;C{}\n    c.init()\n    this.Carry=[]C{*c}\n    return \n}\ntype C struct{\n    state string\n}\nfunc (this *C)init(){\n    this.state=\"1\"\n    return \n}\nfunc main(){\n    a:=&amp;A{}\n    a.init()\n    fmt.Printf(\"A:%v\\n\",a)\n    p:=&amp;a.Barry[0].Carry[0]\n    p.state=\"2\"\n    fmt.Printf(\"A:%v\\n\",a)\n\n\n    for _,v:=range a.Barry[0].Carry{\n        if v.state==\"2\"{\n            p=&amp;v\n        }\n    }\n    p.state=\"3\"\n    fmt.Printf(\"A:%v\\n\",a)\n}\n</code></pre>\n"}, {"tags": ["database", "authentication", "go"], "comments": [{"owner": {"reputation": 1867, "user_id": 780157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8456225507a9cd4fd3abdbf8922a4be2?s=128&d=identicon&r=PG", "display_name": "defectus", "link": "https://stackoverflow.com/users/780157/defectus"}, "edited": false, "score": 1, "creation_date": 1455088327, "post_id": 35305598, "comment_id": 58327369, "body": "Just quickly reading trough the documentation, it look like they support the concept of storers (<a href=\"https://github.com/go-authboss/authboss#storers\" rel=\"nofollow noreferrer\">github.com/go-authboss/authboss#storers</a>). If you find/implement yourself a stored for database (or any other persistent storage) then you should be fine."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455098199, "post_id": 35305598, "comment_id": 58332953, "body": "And it seems to be pretty dormant. So be prepared that you might have to write bug fixes yourself."}, {"owner": {"reputation": 170, "user_id": 1867696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6irqM.jpg?s=128&g=1", "display_name": "Built In Parris", "link": "https://stackoverflow.com/users/1867696/built-in-parris"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455202322, "post_id": 35305598, "comment_id": 58392182, "body": "@MarkusWMahlberg, do you have any other suggestions?"}], "answers": [{"tags": [], "owner": {"reputation": 729, "user_id": 3245480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZMhZS.jpg?s=128&g=1", "display_name": "Chikipowpow", "link": "https://stackoverflow.com/users/3245480/chikipowpow"}, "is_accepted": true, "score": 2, "last_activity_date": 1504882210, "last_edit_date": 1504882210, "creation_date": 1504813074, "answer_id": 46103888, "question_id": 35305598, "link": "https://stackoverflow.com/questions/35305598/authboss-with-database/46103888#46103888", "title": "Authboss with Database", "body": "<ol>\n<li><p>To use authboss authentication with a database backend you need to write a 'storer' implementation. There aren't very many database storers readily available (at least I haven't been able to find them).</p></li>\n<li><p>Example authentication implementations with a database backend:</p>\n\n<ul>\n<li><a href=\"http://www.josephspurrier.com/go-web-app-example/\" rel=\"nofollow noreferrer\">http://www.josephspurrier.com/go-web-app-example/</a> (Uses MySQL or Postgres)</li>\n<li><a href=\"https://blue-jay.github.io/\" rel=\"nofollow noreferrer\">https://blue-jay.github.io/</a> An updated version of the above implementation. Looks very promising.</li>\n<li><a href=\"https://github.com/qor/auth\" rel=\"nofollow noreferrer\">https://github.com/qor/auth</a> (Uses GORM)</li>\n</ul></li>\n</ol>\n\n<p>Based on the number of stars on github, authboss is the most popular.</p>\n\n<p>Of course, there are also commercial options, e.g. <a href=\"https://auth0.com/blog/authentication-in-golang/\" rel=\"nofollow noreferrer\">https://auth0.com/blog/authentication-in-golang/</a></p>\n\n<p>A long list of available authentication libraries and frameworks can be found here: <a href=\"https://github.com/avelino/awesome-go#authentication-and-oauth\" rel=\"nofollow noreferrer\">https://github.com/avelino/awesome-go#authentication-and-oauth</a></p>\n"}], "owner": {"reputation": 170, "user_id": 1867696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6irqM.jpg?s=128&g=1", "display_name": "Built In Parris", "link": "https://stackoverflow.com/users/1867696/built-in-parris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2092, "favorite_count": 0, "accepted_answer_id": 46103888, "answer_count": 1, "score": 4, "last_activity_date": 1504882210, "creation_date": 1455069448, "question_id": 35305598, "link": "https://stackoverflow.com/questions/35305598/authboss-with-database", "title": "Authboss with Database", "body": "<p>I just started learning Go a couple weeks ago, and I want to try and implement a kind of authentication system for a web server. Now, I found <a href=\"https://github.com/go-authboss/authboss\" rel=\"nofollow\">authboss</a> which seems like a perfect solution except I don't understand how to integrate it with a traditional database. It seems like it just stores everything in its own memory which is a nightmare if the server crashes or needs to be restarted. That having been said, does anyone have any ideas, thoughts, or recommendations?</p>\n"}, {"tags": ["git", "go", "libgit2"], "comments": [{"owner": {"reputation": 2379, "user_id": 2341555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/476ecfbcabcf62dc4dcacf98b846ac81?s=128&d=identicon&r=PG", "display_name": "ben schwartz", "link": "https://stackoverflow.com/users/2341555/ben-schwartz"}, "reply_to_user": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "edited": false, "score": 0, "creation_date": 1455057805, "post_id": 35303579, "comment_id": 58317690, "body": "I&#39;ve tried <code>git2go</code> and gotten as far as creating a bare clone. the &quot;push&quot; aspect is throwing me for a loop, I can&#39;t figure out from the godocs how to go about pushing all branches/tags and I can&#39;t find other examples to work from"}, {"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "edited": false, "score": 0, "creation_date": 1455057938, "post_id": 35303579, "comment_id": 58317762, "body": "Then it might be a good idea to show some code that you have tried so far. The question as it currently is looks like you want to find some who writes the code for you."}, {"owner": {"reputation": 2379, "user_id": 2341555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/476ecfbcabcf62dc4dcacf98b846ac81?s=128&d=identicon&r=PG", "display_name": "ben schwartz", "link": "https://stackoverflow.com/users/2341555/ben-schwartz"}, "reply_to_user": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "edited": false, "score": 0, "creation_date": 1455057980, "post_id": 35303579, "comment_id": 58317786, "body": "gotcha, thanks. I&#39;ll try to rope together what I have so far"}], "owner": {"reputation": 2379, "user_id": 2341555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/476ecfbcabcf62dc4dcacf98b846ac81?s=128&d=identicon&r=PG", "display_name": "ben schwartz", "link": "https://stackoverflow.com/users/2341555/ben-schwartz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455059120, "creation_date": 1455057502, "last_edit_date": 1455059120, "question_id": 35303579, "link": "https://stackoverflow.com/questions/35303579/mirror-a-git-repo-in-go-with-git2go", "title": "Mirror a git repo in Go with git2go", "body": "<p>I'm trying to mirror a git repo as a part of some work a go service is doing. I assume I want to be using <code>git2go</code>, but I'm not committed to that; any solution will work.</p>\n\n<p>The workflow I am trying to accomplish (implemented in bash) is:</p>\n\n<pre><code>git clone --bare git:github.com/foo/bar.git ./tmp/\ncd ./tmp/\ngit push --mirror git:another-host/vendor/bar.git\n</code></pre>\n\n<p>Here's what I have so far:</p>\n\n<p><code>main.go</code></p>\n\n<pre><code>package main\n\nimport (\n        \"log\"\n\n        git \"gopkg.in/libgit2/git2go.v22\"\n)\n\nfunc main() {\n        src := \"git://github.com/fliglio/web.git\"\n        dest := \"http://foo:asdf@localhost:7990/scm/phpv/web.git\"\n\n        cloneOptions := &amp;git.CloneOptions{\n                Bare: true,\n        }\n        repo, err := git.Clone(src, \"local\", cloneOptions)\n        if err != nil {\n                log.Panic(err)\n        }\n        log.Print(repo)\n\n        fork, err := repo.CreateRemote(\"upstream\", dest)\n        if err != nil {\n                panic(err)\n        }\n\n        refspecs, err := fork.FetchRefspecs()\n        if err != nil {\n                panic(err)\n        }\n        err = fork.Push(refspecs, &amp;git.PushOptions{}, &amp;git.Signature{Name: \"ben\", Email: \"benschw@gmail.com\"}, \"msg\")\n        if err != nil {\n                panic(err)\n        }\n\n}\n</code></pre>\n\n<p>This is cloning the bare repo fine, but I think I may be headed in the wrong direction for pushing that to the new location</p>\n\n<p>Here is the output when run:</p>\n\n<pre><code>17:02:12 &amp;{0x2655b50}\npanic: Not a valid reference 'refs/heads/*'\n\ngoroutine 1 [running]:\nmain.main()\n        /home/ben/go/src/github.com/benschw/composer-sync/main.go:33  +0x47a\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n        /opt/go1.5.2/src/runtime/asm_amd64.s:1721 +0x1\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 311, "user_id": 505252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b8997e6d5bded75620e32b6e219b37?s=128&d=identicon&r=PG", "display_name": "Nathan Smith", "link": "https://stackoverflow.com/users/505252/nathan-smith"}, "edited": false, "score": 0, "creation_date": 1457479911, "post_id": 35302810, "comment_id": 59423450, "body": "@Speedy, did you ever figure this out? Despite Markus&#39;s dismissive comment, this is useful. The <a href=\"https://docs.mongodb.org/manual/tutorial/create-an-auto-incrementing-field/\" rel=\"nofollow noreferrer\">MongoDB documentation recommends using a similar function to implement an auto-increment field</a>, for example."}, {"owner": {"reputation": 11, "user_id": 5903054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f5790e1b7bbffe270017dbe5f32348?s=128&d=identicon&r=PG&f=1", "display_name": "Speedy", "link": "https://stackoverflow.com/users/5903054/speedy"}, "reply_to_user": {"reputation": 311, "user_id": 505252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b8997e6d5bded75620e32b6e219b37?s=128&d=identicon&r=PG", "display_name": "Nathan Smith", "link": "https://stackoverflow.com/users/505252/nathan-smith"}, "edited": false, "score": 1, "creation_date": 1458472506, "post_id": 35302810, "comment_id": 59866928, "body": "@NathanSmith, I don&#39;t think mgo supports these types of queries which is a shame. Ended up replacing MongoDB with <a href=\"https://github.com/boltdb/bolt\" rel=\"nofollow noreferrer\">Bolt</a>. Its much better as an embedded transactional database. Used disk space is 42 times smaller."}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 505252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b8997e6d5bded75620e32b6e219b37?s=128&d=identicon&r=PG", "display_name": "Nathan Smith", "link": "https://stackoverflow.com/users/505252/nathan-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1457564806, "last_edit_date": 1495541614, "creation_date": 1457564806, "answer_id": 35904469, "question_id": 35302810, "link": "https://stackoverflow.com/questions/35302810/execute-mongodb-functions-from-mgo-golang/35904469#35904469", "title": "execute mongodb functions from mgo golang", "body": "<p>Per <a href=\"https://stackoverflow.com/questions/12008910/how-can-i-ask-mongodb-to-evaluate-some-javascript-in-order-to-obtain-value-for-a\">this similar question</a>, there is no way to evaluate JavaScript during an insert. I think it's a safe assumption that the same goes for updates, upserts, etc.</p>\n\n<p>You can achieve this in two calls by using mgo's db.Run() method: </p>\n\n<pre><code>db.Run(bson.M{\"eval\": fmt.Sprintf(\"getClubName(%s);\", clubID)}, &amp;resp)\n</code></pre>\n\n<p>And then using the result in your update statement. </p>\n\n<p>Unfortunately, there is no way to make things atomic using this technique. If atomicity is a requirement, I would recommend keeping all the business logic in your application and using a local or database-based locking mechanism.</p>\n"}], "owner": {"reputation": 11, "user_id": 5903054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f5790e1b7bbffe270017dbe5f32348?s=128&d=identicon&r=PG&f=1", "display_name": "Speedy", "link": "https://stackoverflow.com/users/5903054/speedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1291, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1457564806, "creation_date": 1455054365, "question_id": 35302810, "link": "https://stackoverflow.com/questions/35302810/execute-mongodb-functions-from-mgo-golang", "title": "execute mongodb functions from mgo golang", "body": "<p>Is it possible to use mgo driver to execute mongodb functions during an update or insert while using a struct object?</p>\n\n<pre><code>err := db.C(collectionName).UpdateId(eventID, Event{\n    Name: eventName,\n    Club: getClubName(clubID), //how to call mongodb getClubName function?\n})\n</code></pre>\n\n<p>I have a mongodb function that returns a club name when given a club id. The following executes OK in the mongodb shell.</p>\n\n<pre><code>db.loadServerScripts();\ndb.Event.update({\"_id\" : \"30fc...\"}, {\"name\": \"foo_bar\" , \"clubName\": getClubName(\"4df32...\")});\n</code></pre>\n\n<p>I can execute an additional database lookup to get the club name, but would prefer this to be atomic if possible.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 1, "creation_date": 1455058423, "post_id": 35302160, "comment_id": 58317968, "body": "FWIW (at least in python) if using the Blobstore API (which can work w/ GCS) it&#39;s possible to limit upload sizes and with the PIL lib is possible to check the image size/format before processing the whole image (to limit processing costs). The GAE Image API can resize the uploaded images (already limited in filesize) to acceptable images sizes/formats which can be stored in GCS for later use while deleting the uploaded images - saving on storage: <a href=\"http://stackoverflow.com/questions/33875366/\">stackoverflow.com/questions/33875366</a>. But I&#39;m not familiar with <code>go</code>, can&#39;t tell if it supports such approach."}, {"owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "reply_to_user": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1455221637, "post_id": 35302160, "comment_id": 58405446, "body": "You should use the blobstore API as @Dan has said.  And when you create an UploadURL you can set a maximum upload size."}], "answers": [{"comments": [{"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "edited": false, "score": 1, "creation_date": 1455055908, "post_id": 35302225, "comment_id": 58316785, "body": "Actually, you can do more than just check the file extension. Have a look at <a href=\"https://golang.org/pkg/net/http/#DetectContentType\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#DetectContentType</a>."}], "tags": [], "owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "is_accepted": true, "score": 0, "last_activity_date": 1455056501, "last_edit_date": 1455056501, "creation_date": 1455052099, "answer_id": 35302225, "question_id": 35302160, "link": "https://stackoverflow.com/questions/35302160/limit-upload-size-for-appengine-interface-to-cloud-store/35302225#35302225", "title": "Limit upload size for appengine interface to cloud store", "body": "<ol>\n<li><p>All App Engine requests are limited to 32MB.</p></li>\n<li><p>You can check the size of the file being uploaded before the upload starts.</p></li>\n<li><p>You can <a href=\"https://golang.org/pkg/net/http/#DetectContentType\" rel=\"nofollow\">verify the file's mime-type</a> and only allow correct files to be uploaded.</p></li>\n</ol>\n"}], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 35302225, "answer_count": 1, "score": 0, "last_activity_date": 1455056501, "creation_date": 1455051866, "question_id": 35302160, "link": "https://stackoverflow.com/questions/35302160/limit-upload-size-for-appengine-interface-to-cloud-store", "title": "Limit upload size for appengine interface to cloud store", "body": "<p>Consider an image (avatar) uploader to Google Cloud Storage which will start from the user's web browser, and then pass through a Go appengine instance which will handle standard compression/cropping etc. and then set the resulting image as an object in Cloud Storage</p>\n\n<p>How can I ensure that the appengine instance isn't overloaded by too much or bad data? In other words, I think I'm asking two questions (or possibly not):</p>\n\n<ol>\n<li><p>How can I limit the amount of data allowed to be sent to an appengine instance in a single request, or is there already a default safe limit?</p></li>\n<li><p>How can I validate the data to make sure it's proper jpg/png/gif before attempting to process it with standard go image libraries?</p></li>\n</ol>\n"}, {"tags": ["algorithm", "go", "persistence"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1455051695, "post_id": 35301543, "comment_id": 58314452, "body": "You are looking for a permutation: Perm from math/Rand"}, {"owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1455052090, "post_id": 35301543, "comment_id": 58314669, "body": "Would you know of an example that I could possibly follow?"}], "answers": [{"comments": [{"owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "edited": false, "score": 0, "creation_date": 1455080357, "post_id": 35307083, "comment_id": 58324135, "body": "Interesting, i noticed the output was as [5 2 3 0 1 4] How would i be able to take one of these numbers and read it into a variable to process seperately? for example, i would like to take the 5 and read it into a variable I call monday."}, {"owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "reply_to_user": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "edited": false, "score": 2, "creation_date": 1455080475, "post_id": 35307083, "comment_id": 58324167, "body": "It&#39;s an int slice, so you can reference any int the slice contains like i[0] or i[5] until i[len(i)-1].  After which you&#39;d get an out of bounds of error."}, {"owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "edited": false, "score": 0, "creation_date": 1455084329, "post_id": 35307083, "comment_id": 58325673, "body": "Wow that is perfect thanks Sean! Exactly what i was looking for!"}], "tags": [], "owner": {"reputation": 978, "user_id": 5843918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ef4d8b41449d85eef88b08fdf9b05f?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/5843918/sean"}, "is_accepted": true, "score": 2, "last_activity_date": 1455079989, "creation_date": 1455079989, "answer_id": 35307083, "question_id": 35301543, "link": "https://stackoverflow.com/questions/35301543/random-function-and-persistence-in-golang-program/35307083#35307083", "title": "Random function and persistence in Golang Program", "body": "<p>As @Volker said Perm is likely what you want to use.  Here's an example that will generate the pseudo random list for you.  You could just save that to a file json encoded.  Then if you had 7 recipes you could use time.Weekday to grab a recipe number from the slice using the day of the week as key to the slice.  Once you hit some pre-determined day just regenerate the slice and save.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math/rand\"\nimport \"time\"\n\nfunc main() {\n\n  r := rand.New(rand.NewSource(time.Now().UnixNano()))\n  i := r.Perm(6)\n  fmt.Printf(\"%v\\n\", i)\n}\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 1, "accepted_answer_id": 35307083, "answer_count": 1, "score": 1, "last_activity_date": 1455079989, "creation_date": 1455049708, "last_edit_date": 1455078667, "question_id": 35301543, "link": "https://stackoverflow.com/questions/35301543/random-function-and-persistence-in-golang-program", "title": "Random function and persistence in Golang Program", "body": "<p>My program is below:</p>\n\n<p>What I'm trying to do is see if there is a way to create a random function or use a built in function that is able to use know what food in this program was selected from the random selection and have it not used again for another week? I currently have foods set from 1-6 but I want to make sure the same food for example 2 isn't selected twice in a row for a week. Also I want the program to be able to possibly write what the last item that was selected so it won't choose it again for atleast a week. Would i be able to accomplish this with a simple text file that can be read from?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\ntype Recipe struct { //Struct for recipe information\n    name        string\n    prepTime    int\n    cookTime    int\n    Ingredients []string //this is now a slice that will accept multiple elements\n    ID          int\n    Yield       int\n}\n\nfunc main() {\n    var recipe1 Recipe //Declare recipe1 of Type Recipe\n    var recipe2 Recipe\n    var recipe3 Recipe\n\n    /* recipe1 specifications */\n    recipe1.name = \"BBQ Pulled Chicken\"\n    recipe1.prepTime = 25\n    recipe1.cookTime = 5\n    recipe1.Ingredients = append(\n        recipe1.Ingredients,\n        \"1 8-ounce can reduced-sodium tomato sauce\",\n    )\n    recipe1.Ingredients = append(\n        recipe1.Ingredients,\n        \"1/2 medium onion (grated),\",\n    )\n    recipe1.ID = 1\n    recipe1.Yield = 8\n\n    /* Recipe 2 specifications */\n\n    recipe2.name = \"Steak Tacos with Pineapple\"\n    recipe2.prepTime = 45\n    recipe2.cookTime = 45\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"3 tablespoons soy sauce,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 tablespoon finely grated garlic,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 tablespoon finely grated peeled fresh ginger,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"1 1/2 pounds skirt steak, cut into 5-inch lengths,\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"Salt\",\n    )\n    recipe2.Ingredients = append(\n        recipe2.Ingredients,\n        \"Pepper\",\n    )\n    recipe2.ID = 2\n    recipe2.Yield = 4\n\n    recipe3.name = \"Simple Lemon Herb Chicken\"\n    recipe3.prepTime = 10\n    recipe3.cookTime = 15\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"2 skinless boneless chicken breast halves,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 Lemon,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"Salt and Pepper to taste,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 tablespoon olive oil,\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"2 sprigs fresh parsley (for garnish),\",\n    )\n    recipe3.Ingredients = append(\n        recipe3.Ingredients,\n        \"1 pinch dried oregano,\",\n    )\n    recipe3.ID = 3\n    recipe3.Yield = 2\n\n    //call to printRecipe function below\n    printRecipe(recipe1)\n    totalTime(recipe1)\n    printRecipe(recipe2)\n    totalTime(recipe2)\n    printRecipe(recipe3)\n    totalTime(recipe3)\n\n    //choose random number for recipe\n    rand.Seed(time.Now().UTC().UnixNano())\n    myrand := random(1, 6)\n    fmt.Println(myrand)\n\n    //logic for recipe to choose\n    if myrand == 1 {\n        fmt.Println(1)\n        printRecipeOfTheDay(recipe1)\n    } else if myrand == 2 {\n        fmt.Println(2)\n        printRecipeOfTheDay(recipe2)\n    } else if myrand == 3 {\n        fmt.Println(3)\n        printRecipeOfTheDay(recipe3)\n    } else if myrand == 4 {\n        fmt.Println(4)\n    }\n}\n\n//function to print Recipe\nfunc printRecipe(recipe Recipe) {\n    fmt.Printf(\"Recipe Name : %s\\n\", recipe.name)\n    fmt.Printf(\"Prep Time : %d\\n\", recipe.prepTime)\n    fmt.Printf(\"Cook Time : %d\\n\", recipe.cookTime)\n    fmt.Printf(\"Ingredients : %s\\n\", recipe.Ingredients)\n    fmt.Printf(\"Recipe ID : %d\\n\", recipe.ID)\n}\n\n//random number function\nfunc random(min, max int) int {\n    return rand.Intn(max-min) + min\n}\n\n//function to print the winner for recipe of the day to use\n//for either lunch or dinner\nfunc printRecipeOfTheDay(recipe Recipe) {\n    fmt.Printf(\"The recipe of the day is : %s\\n\", recipe.name)\n}\n\n//Returns total time by addings cookTime and prepTime\nfunc totalTime(recipe Recipe) {\n    fmt.Printf(\"The total time for this recipe is %d\\n\", recipe.cookTime+recipe.prepTime)\n}\n</code></pre>\n"}, {"tags": ["go", "import", "get"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1455049614, "post_id": 35301459, "comment_id": 58313196, "body": "Just to clarify, Apache is the <i>webserver</i>. You store your code on a <i>server</i>, and access it with the webserver (namely Apache)."}, {"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1455056574, "post_id": 35301459, "comment_id": 58317139, "body": "Yes. The question is how to retreat the code from the private web address."}, {"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1455056640, "post_id": 35301459, "comment_id": 58317168, "body": "By the way, I wasn&#39;t retreat using &quot;go get&quot; from the company&#39;s website. It seems like it requires something else."}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 0, "creation_date": 1455055640, "post_id": 35301658, "comment_id": 58316643, "body": "Thanks, however, the code needs to be in the server which doesn&#39;t have mounted. So, this will not work. I need something that uses a web server."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 0, "creation_date": 1455202936, "post_id": 35301658, "comment_id": 58392653, "body": "@Gon: you just do what go get does, and clone the repo into the correct import path. Other than as a convenience for <code>go get</code>, the actual import path is meaningless. You don&#39;t need a webserver at all."}, {"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 0, "creation_date": 1455807549, "post_id": 35301658, "comment_id": 58663210, "body": "Oh new tip! Thanks @JumB."}], "tags": [], "owner": {"reputation": 1, "user_id": 5903602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44570d9b444c060d964452a9b19a09bd?s=128&d=identicon&r=PG&f=1", "display_name": "lala1", "link": "https://stackoverflow.com/users/5903602/lala1"}, "is_accepted": false, "score": 0, "last_activity_date": 1455050587, "last_edit_date": 1455050587, "creation_date": 1455050102, "answer_id": 35301658, "question_id": 35301459, "link": "https://stackoverflow.com/questions/35301459/golang-import-go-get-mywebsite-com-mylibrary-function/35301658#35301658", "title": "Golang import; go get mywebsite.com/mylibrary/function", "body": "<p>just have the code in <code>$GOPATH/src/mysite.com/project</code></p>\n\n<p>easiest would be an own git server.</p>\n"}, {"comments": [{"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 0, "creation_date": 1455127971, "post_id": 35307672, "comment_id": 58354314, "body": "I guess this maybe the only way.. Thank you Kyle"}], "tags": [], "owner": {"reputation": 36, "user_id": 1710487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4df35ceaa59d2d1e6e4ceb017ecd46f?s=128&d=identicon&r=PG", "display_name": "Kyle J Hunter", "link": "https://stackoverflow.com/users/1710487/kyle-j-hunter"}, "is_accepted": true, "score": 2, "last_activity_date": 1455082799, "creation_date": 1455082799, "answer_id": 35307672, "question_id": 35301459, "link": "https://stackoverflow.com/questions/35301459/golang-import-go-get-mywebsite-com-mylibrary-function/35307672#35307672", "title": "Golang import; go get mywebsite.com/mylibrary/function", "body": "<p>I had the same problem what we did was just spin up our own GitLab server to hold all of the libraries/code.</p>\n"}], "owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 35307672, "answer_count": 2, "score": 2, "last_activity_date": 1455082799, "creation_date": 1455049419, "last_edit_date": 1455056853, "question_id": 35301459, "link": "https://stackoverflow.com/questions/35301459/golang-import-go-get-mywebsite-com-mylibrary-function", "title": "Golang import; go get mywebsite.com/mylibrary/function", "body": "<p>Some of my code written for work is not suitable for public. So, I like to run within company's server. What would be the easiest way to retreat the library using \"go get\" from a private server.\n<strike>What would be easiest way to have library on Apache website? </strike></p>\n\n<p>Below are what I'd like to do.</p>\n\n<p><strong>Get my code</strong></p>\n\n<blockquote>\n  <p>go get mysite.com/libraries/mylib1</p>\n</blockquote>\n\n<p><strong>Source</strong></p>\n\n<pre><code>package main\nimport(\n    \"mysite.com/libraries/mylib1\"\n)\n\nfunc main() {\n    mylib1.Print()\n}\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["sockets", "go", "ip", "multicast"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455049720, "post_id": 35300039, "comment_id": 58313259, "body": "Just to make it christal clear: The task is not to bind to the interface which listens on that IP, but specifically and positively to the IP itself?"}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455050015, "post_id": 35300039, "comment_id": 58313423, "body": "The task is to receive packets addressed to 224.0.0.9, but only on an specific interface. Binding to the IP address is the mechanism I suppose I should use to achieve that goal."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455051369, "post_id": 35300039, "comment_id": 58314242, "body": "Nope. Identify the interface to bind to by its IP, then bind to it and join the multicast group."}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455051739, "post_id": 35300039, "comment_id": 58314472, "body": "Well, I think that&#39;s what the code is doing: ListenPacket() binds to interface&#39;s IP address, then JoinGroup() joins the multicast group. However, it&#39;s not working. Can you tell where the error is?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1455055915, "post_id": 35300039, "comment_id": 58316790, "body": "is IP_MULTICAST_LOOP enabled on the sender?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1455056351, "post_id": 35300039, "comment_id": 58317027, "body": "Will have a look at the code tomorrow."}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "edited": false, "score": 0, "creation_date": 1455058741, "post_id": 35300039, "comment_id": 58318090, "body": "Multicast loop isn&#39;t needed because the datagrams are sent from another host."}], "answers": [{"tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": true, "score": 2, "last_activity_date": 1455299378, "creation_date": 1455299378, "answer_id": 35369092, "question_id": 35300039, "link": "https://stackoverflow.com/questions/35300039/in-golang-how-to-receive-multicast-packets-with-socket-bound-to-specific-addres/35369092#35369092", "title": "In Golang, how to receive multicast packets with socket bound to specific address/port?", "body": "<p>In order to create multiple interface-specific sockets to receive packets addressed to the same multicast address (224.0.0.9:520), my original Go code was missing three major issues:</p>\n\n<ol>\n<li>In order to bind multiple sockets to same UDP port, set syscall.SO_REUSEADDR</li>\n<li>In order to restrict socket to specific interface, set syscall.SO_BINDTODEVICE</li>\n<li>Bind the UDP sockets to 0.0.0.0:520</li>\n</ol>\n\n<p>Find full sample code here: <a href=\"http://play.golang.org/p/NprsZPHQmj\" rel=\"nofollow\">http://play.golang.org/p/NprsZPHQmj</a></p>\n"}], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6381, "favorite_count": 2, "accepted_answer_id": 35369092, "answer_count": 1, "score": 3, "last_activity_date": 1455299378, "creation_date": 1455044228, "question_id": 35300039, "link": "https://stackoverflow.com/questions/35300039/in-golang-how-to-receive-multicast-packets-with-socket-bound-to-specific-addres", "title": "In Golang, how to receive multicast packets with socket bound to specific address/port?", "body": "<p>Task at hand is to bind a socket specifically to address 1.0.0.2:520 (assigned to eth2), then read multicast UDP packets addressed to 224.0.0.9:520.</p>\n\n<p>I am trying the code below, based on <a href=\"https://godoc.org/golang.org/x/net/ipv4\" rel=\"nofollow\">https://godoc.org/golang.org/x/net/ipv4</a></p>\n\n<p>Unfortunately, result is this debbuging message is never reached: <code>log.Printf(\"udpReader: recv %d bytes from %s to %s on %s\", n, cm.Src, cm.Dst, ifname)</code></p>\n\n<p>I know eth2 is receiving the desired packets because I have this packet sniffer running on it:</p>\n\n<pre><code>sudo tcpdump -n -i eth2\n18:40:28.571456 IP 1.0.0.1.520 &gt; 224.0.0.9.520: RIPv2, Request, length: 24\n18:40:29.556503 IP 1.0.0.1.520 &gt; 224.0.0.9.520: RIPv2, Response, length: 64\n</code></pre>\n\n<p>This is the sample code. Can you spot why doesn't it work?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n\n    \"golang.org/x/net/ipv4\"\n)\n\nfunc main() {\n    if err := interfaceAdd(\"eth2\"); err != nil {\n        log.Printf(\"main: error: %v\", err)\n    }\n\n    log.Printf(\"main: waiting forever\")\n    &lt;-make(chan int)\n}\n\nfunc interfaceAdd(s string) error {\n\n    iface, err1 := net.InterfaceByName(s)\n    if err1 != nil {\n        return err1\n    }\n\n    addrList, err2 := iface.Addrs()\n    if err2 != nil {\n        return err2\n    }\n\n    for _, a := range addrList {\n        addr, _, err3 := net.ParseCIDR(a.String())\n        if err3 != nil {\n            log.Printf(\"interfaceAdd: parse CIDR error for '%s' on '%s': %v\", addr, s, err3)\n            continue\n        }\n        if err := join(iface, addr); err != nil {\n            log.Printf(\"interfaceAdd: join error for '%s' on '%s': %v\", addr, s, err)\n        }\n    }\n\n    return nil\n}\n\nfunc join(iface *net.Interface, addr net.IP) error {\n    proto := \"udp\"\n    var a string\n    if addr.To4() == nil {\n        // IPv6\n        a = fmt.Sprintf(\"[%s]\", addr.String())\n    } else {\n        // IPv4\n        a = addr.String()\n    }\n\n    hostPort := fmt.Sprintf(\"%s:520\", a) // rip multicast port\n\n    // open socket (connection)\n    conn, err2 := net.ListenPacket(proto, hostPort)\n    if err2 != nil {\n        return fmt.Errorf(\"join: %s/%s listen error: %v\", proto, hostPort, err2)\n    }\n\n    // join multicast address\n    pc := ipv4.NewPacketConn(conn)\n    if err := pc.JoinGroup(iface, &amp;net.UDPAddr{IP: net.IPv4(224, 0, 0, 9)}); err != nil {\n        conn.Close()\n        return fmt.Errorf(\"join: join error: %v\", err)\n    }\n\n    // request control messages\n    /*\n        if err := pc.SetControlMessage(ipv4.FlagTTL|ipv4.FlagSrc|ipv4.FlagDst|ipv4.FlagInterface, true); err != nil {\n            // warning only\n            log.Printf(\"join: control message flags error: %v\", err)\n        }\n    */\n\n    go udpReader(pc, iface.Name, addr.String())\n\n    return nil\n}\n\nfunc udpReader(c *ipv4.PacketConn, ifname, ifaddr string) {\n\n    log.Printf(\"udpReader: reading from '%s' on '%s'\", ifaddr, ifname)\n\n    defer c.Close()\n\n    buf := make([]byte, 10000)\n\n    for {\n        n, cm, _, err := c.ReadFrom(buf)\n        if err != nil {\n            log.Printf(\"udpReader: ReadFrom: error %v\", err)\n            break\n        }\n\n        // make a copy because we will overwrite buf\n        b := make([]byte, n)\n        copy(b, buf)\n\n        log.Printf(\"udpReader: recv %d bytes from %s to %s on %s\", n, cm.Src, cm.Dst, ifname)\n    }\n\n    log.Printf(\"udpReader: exiting '%s'\", ifname)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2016/02/09 18:44:20 interfaceAdd: join error for 'fe80::a00:27ff:fe52:9575' on 'eth2': join: udp/[fe80::a00:27ff:fe52:9575]:520 listen error: listen udp [fe80::a00:27ff:fe52:9575]:520: bind: invalid argument\n2016/02/09 18:44:20 main: waiting forever\n2016/02/09 18:44:20 udpReader: reading from '1.0.0.2' on 'eth2'\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1455036691, "post_id": 35297426, "comment_id": 58305440, "body": "I guess you could do something like decode to a generic struct full of interfaces and use type assertion to see if all the int fields look like ints."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1455036971, "post_id": 35297426, "comment_id": 58305636, "body": "There&#39;s an open issue to try and get more information from decode errors, but it&#39;s not trivial, and wouldn&#39;t happen until at least go1.7. Can you just implement json.Unmarshaler and validate the fields?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1455037887, "post_id": 35297426, "comment_id": 58306250, "body": "Ultimately: if the client sends a bad request, you should return a 400 Bad Request message and make your API documentation available so they know how it&#39;s wrong."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1455037008, "post_id": 35297663, "comment_id": 58305658, "body": "This fails in the inverse way when the client sends the value as a number"}, {"owner": {"reputation": 22827, "user_id": 205426, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fb24c70ec76f0a28e47fc1df1e70dcdf?s=128&d=identicon&r=PG", "display_name": "Woot4Moo", "link": "https://stackoverflow.com/users/205426/woot4moo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1455037364, "post_id": 35297663, "comment_id": 58305890, "body": "@JimB read the rest of my statement about doing the right thing from an engineering perspective and supplying a client library"}], "tags": [], "owner": {"reputation": 22827, "user_id": 205426, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fb24c70ec76f0a28e47fc1df1e70dcdf?s=128&d=identicon&r=PG", "display_name": "Woot4Moo", "link": "https://stackoverflow.com/users/205426/woot4moo"}, "is_accepted": false, "score": 0, "last_activity_date": 1455036821, "last_edit_date": 1495540228, "creation_date": 1455036821, "answer_id": 35297663, "question_id": 35297426, "link": "https://stackoverflow.com/questions/35297426/how-to-tell-the-client-they-need-to-send-an-integer-instead-of-a-string-from-a/35297663#35297663", "title": "How to tell the client they need to send an integer instead of a string, from a Go server?", "body": "<p>It would seem that <a href=\"https://stackoverflow.com/a/9573928/205426\">here</a> provides an implementation to work around this issue in Go only.  </p>\n\n<pre><code>type account struct {\n    Name    string\n    Balance int `json:\",string\"`\n}\n</code></pre>\n\n<p>In my estimation the more correct and sustainable approach is for you to create a client library in something like JavaScript and publish it into the NPM registry for others to use (private repository would work the same way).  By providing this library you can tailor the API for the consumers in a meaningful way and prevent errors creeping into your main program.</p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 3, "last_activity_date": 1455040928, "last_edit_date": 1455040928, "creation_date": 1455039730, "answer_id": 35298614, "question_id": 35297426, "link": "https://stackoverflow.com/questions/35297426/how-to-tell-the-client-they-need-to-send-an-integer-instead-of-a-string-from-a/35298614#35298614", "title": "How to tell the client they need to send an integer instead of a string, from a Go server?", "body": "<p>You can use a custom type with custom unmarshaling algorythm for your \"Balance\" field.</p>\n\n<p>Now there are two possibilities:</p>\n\n<ul>\n<li><p>Handle both types:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strconv\"\n)\n\ntype Int int\n\ntype account struct {\n    Name    string\n    Balance Int\n}\n\nfunc (i *Int) UnmarshalJSON(b []byte) (err error) {\n    var s string\n    err = json.Unmarshal(b, &amp;s)\n    if err == nil {\n        var n int\n        n, err = strconv.Atoi(s)\n        if err != nil {\n            return\n        }\n        *i = Int(n)\n        return\n    }\n\n    var n int\n    err = json.Unmarshal(b, &amp;n)\n    if err == nil {\n        *i = Int(n)\n    }\n    return\n}\n\nfunc main() {\n    for _, in := range [...]string{\n        `{\"Name\": \"foo\", \"Balance\": 42}`,\n        `{\"Name\": \"foo\", \"Balance\": \"111\"}`,\n    } {\n        var a account\n        err := json.Unmarshal([]byte(in), &amp;a)\n        if err != nil {\n            fmt.Printf(\"Error decoding JSON: %v\\n\", err)\n        } else {\n            fmt.Printf(\"Decoded OK: %v\\n\", a)\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/h1O-JeYVac\" rel=\"nofollow\">Playground link</a>.</p></li>\n<li><p>Handle only a numeric type, and fail anything else with a sensible error:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Int int\n\ntype account struct {\n    Name    string\n    Balance Int\n}\n\ntype FormatError struct {\n    Want   string\n    Got    string\n    Offset int64\n}\n\nfunc (fe *FormatError) Error() string {\n    return fmt.Sprintf(\"Invalid data format at %d: want: %s, got: %s\",\n        fe.Offset, fe.Want, fe.Got)\n}\n\nfunc (i *Int) UnmarshalJSON(b []byte) (err error) {\n    var n int\n    err = json.Unmarshal(b, &amp;n)\n    if err == nil {\n        *i = Int(n)\n        return\n    }\n    if ute, ok := err.(*json.UnmarshalTypeError); ok {\n        err = &amp;FormatError{\n            Want:   \"number\",\n            Got:    ute.Value,\n            Offset: ute.Offset,\n        }\n    }\n    return\n}\n\nfunc main() {\n    for _, in := range [...]string{\n        `{\"Name\": \"foo\", \"Balance\": 42}`,\n        `{\"Name\": \"foo\", \"Balance\": \"111\"}`,\n    } {\n        var a account\n        err := json.Unmarshal([]byte(in), &amp;a)\n        if err != nil {\n            fmt.Printf(\"Error decoding JSON: %#v\\n\", err)\n            fmt.Printf(\"Error decoding JSON: %v\\n\", err)\n        } else {\n            fmt.Printf(\"Decoded OK: %v\\n\", a)\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/ndVx9hbeeg\" rel=\"nofollow\">Playground link</a>.</p></li>\n</ul>\n\n<p>There is a third possibility: write custom unmarshaler for the whole <code>account</code> type, but it requires more involved code because you'd need to actually iterate over the input JSON data using the methods of the\n<a href=\"https://golang.org/pkg/encoding/json/#Decoder\" rel=\"nofollow\"><code>encoding/json.Decoder</code></a> type.</p>\n\n<p>After reading your</p>\n\n<blockquote>\n  <p>What's the best way to take that incoming request, in Go, and return the error message, \"Balance must be a string\", for any arbitrary number of integer fields on a request?</p>\n</blockquote>\n\n<p>more carefully, I admit having a custom parser for the whole type is the only sensible possibility unless you are OK with a <a href=\"https://godoc.org/?q=json+schema\" rel=\"nofollow\">3rd-party package implementing a parser supporting validation via JSON schema</a> (I think I'd look at <a href=\"https://godoc.org/github.com/juju/gojsonschema\" rel=\"nofollow\">this</a> first as <code>juju</code> is a quite established product).</p>\n"}, {"tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": false, "score": 2, "last_activity_date": 1455040571, "creation_date": 1455040571, "answer_id": 35298865, "question_id": 35297426, "link": "https://stackoverflow.com/questions/35297426/how-to-tell-the-client-they-need-to-send-an-integer-instead-of-a-string-from-a/35298865#35298865", "title": "How to tell the client they need to send an integer instead of a string, from a Go server?", "body": "<p>A solution for this could be to use a type assertion by using a map to unmarshal the JSON data into:</p>\n\n<pre><code>type account struct {\n    Name    string\n    Balance int\n}\n\nvar str = `{\n    \"name\": \"test@example.com\", \n    \"balance\": \"3\"\n}`\n\nfunc main() {\n    var testing = map[string]interface{}{}\n    err := json.Unmarshal([]byte(str), &amp;testing)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    val, ok := testing[\"balance\"]\n    if !ok {\n        fmt.Println(\"missing field balance\")\n        return\n    }\n\n    nv, ok := val.(float64)\n    if !ok {\n        fmt.Println(\"balance should be a number\")\n        return\n    }\n\n    fmt.Printf(\"%+v\\n\", nv)\n}\n</code></pre>\n\n<p>See <a href=\"http://play.golang.org/p/iV7Qa1RrQZ\" rel=\"nofollow\">http://play.golang.org/p/iV7Qa1RrQZ</a></p>\n\n<p>The type assertion here is done using <code>float64</code> because it is the default number type supported by Go's JSON decoder.</p>\n\n<p>It should be noted that this use of <code>interface{}</code> is probably not worth the trouble.</p>\n\n<p>The <code>UnmarshalTypeError</code> (<a href=\"https://golang.org/pkg/encoding/json/#UnmarshalFieldError\" rel=\"nofollow\">https://golang.org/pkg/encoding/json/#UnmarshalFieldError</a>) contains an <code>Offset</code> field that could allow retrieving the contents of the JSON data that triggered the error.</p>\n\n<p>You could for example return a message of the sort:</p>\n\n<pre><code>cannot unmarshal string into Go value of type int near `\"balance\": \"3\"`\n</code></pre>\n"}], "owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 3, "score": 6, "last_activity_date": 1455040928, "creation_date": 1455036076, "question_id": 35297426, "link": "https://stackoverflow.com/questions/35297426/how-to-tell-the-client-they-need-to-send-an-integer-instead-of-a-string-from-a", "title": "How to tell the client they need to send an integer instead of a string, from a Go server?", "body": "<p>Let's say I have the following Go struct on the server</p>\n\n<pre><code>type account struct {\n    Name    string\n    Balance int\n}\n</code></pre>\n\n<p>I want to call json.Decode on the incoming request to parse it into an account.</p>\n\n<pre><code>    var ac account\n    err := json.NewDecoder(r.Body).Decode(&amp;ac)\n</code></pre>\n\n<p>If the client sends the following request:</p>\n\n<pre><code>{\n    \"name\": \"test@example.com\", \n    \"balance\": \"3\"\n}\n</code></pre>\n\n<p>Decode() will return the following error:</p>\n\n<pre><code>json: cannot unmarshal string into Go value of type int\n</code></pre>\n\n<p>Now it's <em>possible</em> to parse that back into \"you sent a string for Balance, but you really should have sent an integer\", but it's tricky, because you don't know the field name. It also gets a lot trickier if you have a lot of fields in the request - you don't know which one failed to parse.</p>\n\n<p>What's the best way to take that incoming request, in Go, and return the error message, \"Balance must be a string\", for any arbitrary number of integer fields on a request? </p>\n"}, {"tags": ["json", "forms", "curl", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1455034034, "post_id": 35296534, "comment_id": 58303435, "body": "Why do you think that your <code>&lt;form&gt;</code> in HTML would produce a JSON object which you can parse? You request.Body wont be JSON so there is no need to decode JSON. If you want to use JSON you must POST a JSON body (which is hard using a HTML form. HTML forms work fine with request.{Post,}FormValue."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1455034135, "post_id": 35296534, "comment_id": 58303502, "body": "i am trying to to this with ajax too, I have just included all things I have tried."}], "answers": [{"comments": [{"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1455035623, "post_id": 35297130, "comment_id": 58304648, "body": "http.FormValue is what I needed after all!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1455042094, "last_edit_date": 1455042094, "creation_date": 1455035288, "answer_id": 35297130, "question_id": 35296534, "link": "https://stackoverflow.com/questions/35296534/golang-json-decoder-fails-to-decode-requests-coming-from-the-browser-only/35297130#35297130", "title": "Golang json.decoder fails to decode requests coming from the browser ONLY", "body": "<p>Your curl example is posting a json encoded body with <code>Content-Type: application/json</code>. A browser isn't going to somehow encode an html form into json. As you can see in the logs, you're receiving <code>Content-Type: application/x-www-form-urlencoded</code></p>\n\n<p>If you want to get the values from a form, use <a href=\"https://golang.org/pkg/net/http/#Request.FormValue\" rel=\"nofollow\"><code>Request.FormValue</code></a>, or <a href=\"https://golang.org/pkg/net/http/#Request.PostFormValue\" rel=\"nofollow\"><code>Request.PostFormValue</code></a></p>\n"}], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 35297130, "answer_count": 1, "score": -2, "last_activity_date": 1455042094, "creation_date": 1455033684, "question_id": 35296534, "link": "https://stackoverflow.com/questions/35296534/golang-json-decoder-fails-to-decode-requests-coming-from-the-browser-only", "title": "Golang json.decoder fails to decode requests coming from the browser ONLY", "body": "<p>My golang app fails to decode forms coming from the browsers but succeed when using curl and httpie.</p>\n\n<h1>Given this code:</h1>\n\n<pre><code>    type Member struct {\n    Username string `json:\"username\"`\n    Email string `json:\"email\"`\n    Password string `json:\"password\"`\n    }\n\n\n\n    func Register(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n        var t Member\n        json.NewDecoder(r.Body).Decode(&amp;t)\n        log.Println(t.Username)\n        log.Println(t.Email)\n        log.Println(t.Password)\n        w.WriteHeader(204)\n    }\n</code></pre>\n\n<h1>this prints!</h1>\n\n<p>curl -H \"Content-Type: application/json\" -X POST -d '{\"username\":\"cesco\",\"email\":\"cesco@gmail.com\",\"password\":\"password\"}' <a href=\"http://localhost:5000/register\" rel=\"nofollow\">http://localhost:5000/register</a></p>\n\n<h1>also this!</h1>\n\n<pre><code>http -v -j  --form POST localhost:5000/register username=\"cesco\" email=\"cesco@gmail.com\" password=\"sadsa\"\n</code></pre>\n\n<h1>this does not</h1>\n\n<pre><code>&lt;form id=\"register\" action=\"register\"  method=\"post\"&gt;\n    &lt;input type=\"text\" name=\"username\"&gt;&lt;br&gt;\n    &lt;input type=\"email\" name=\"email\"&gt;&lt;br&gt;\n    &lt;input type=\"password\" name=\"password\"&gt;&lt;br&gt;\n    &lt;input type=\"submit\" value=\"Submit\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<h1>neither this</h1>\n\n<pre><code>var data = $('#register').serialize();\n$.ajax({\n    url: 'register', // php script to retern json encoded string\n    data: data,  // serialized data to send on server\n    beforeSend: function (xhr) {\n        xhr.setRequestHeader(\"Content-type\", \"*/*\");\n    },\n    dataType: 'json', // set recieving type - JSON in case of a question\n    type: 'POST', // set sending HTTP Request type\n    async: false,\n    success: function (data) { // callback method for further manipulations\n\n    },\n    error: function (data) { // if error occured\n\n    }\n});\n</code></pre>\n\n<h1>Logs on the same order as the question</h1>\n\n<pre><code>2016/02/09 13:56:12 cesco\n2016/02/09 13:56:12 cesco@gmail.com\n2016/02/09 13:56:12 password\n2016/02/09 13:56:12 key: Accept value: [*/*]\n2016/02/09 13:56:12 key: Content-Type value: [application/json]\n2016/02/09 13:56:12 key: Content-Length value: [68]\n2016/02/09 13:56:12 key: User-Agent value: [Mozilla/5.0 Gecko]\n[13:56:12] 127.0.0.1 - - [09/Feb/2016:13:56:12 -0200] \"POST /register HTTP/1.1\" 204 0\n2016/02/09 13:56:18 cesco\n2016/02/09 13:56:18 cesco@gmail.com\n2016/02/09 13:56:18 sadsa\n2016/02/09 13:56:18 key: Accept-Encoding value: [gzip, deflate]\n2016/02/09 13:56:18 key: Accept value: [application/json]\n2016/02/09 13:56:18 key: User-Agent value: [HTTPie/0.8.0]\n2016/02/09 13:56:18 key: Connection value: [keep-alive]\n2016/02/09 13:56:18 key: Content-Type value: [application/json; charset=utf-8]\n2016/02/09 13:56:18 key: Content-Length value: [70]\n[13:56:18] 127.0.0.1 - - [09/Feb/2016:13:56:18 -0200] \"POST /register HTTP/1.1\" 204 0\n[13:56:30] 127.0.0.1 - - [09/Feb/2016:13:56:30 -0200] \"GET / HTTP/1.1\" 200 747\n2016/02/09 13:56:40 \n2016/02/09 13:56:40 \n2016/02/09 13:56:40 \n2016/02/09 13:56:40 key: User-Agent value: [Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.103 Safari/537.36]\n2016/02/09 13:56:40 key: Content-Type value: [application/x-www-form-urlencoded]\n2016/02/09 13:56:40 key: Referer value: [http://localhost:5000/]\n2016/02/09 13:56:40 key: Accept-Language value: [en-US,en;q=0.8,pt;q=0.6,es;q=0.4]\n2016/02/09 13:56:40 key: Connection value: [keep-alive]\n2016/02/09 13:56:40 key: Content-Length value: [53]\n2016/02/09 13:56:40 key: Cache-Control value: [max-age=0]\n2016/02/09 13:56:40 key: Accept value: [text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8]\n2016/02/09 13:56:40 key: Origin value: [http://localhost:5000]\n2016/02/09 13:56:40 key: Upgrade-Insecure-Requests value: [1]\n2016/02/09 13:56:40 key: Accept-Encoding value: [gzip, deflate]\n[13:56:40] 127.0.0.1 - - [09/Feb/2016:13:56:40 -0200] \"POST /register HTTP/1.1\" 204 0\n2016/02/09 13:56:59 \n2016/02/09 13:56:59 \n2016/02/09 13:56:59 \n2016/02/09 13:56:59 key: Content-Type value: [*/*]\n2016/02/09 13:56:59 key: Referer value: [http://localhost:5000/]\n2016/02/09 13:56:59 key: Connection value: [keep-alive]\n2016/02/09 13:56:59 key: Content-Length value: [53]\n2016/02/09 13:56:59 key: X-Requested-With value: [XMLHttpRequest]\n2016/02/09 13:56:59 key: User-Agent value: [Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.103 Safari/537.36]\n2016/02/09 13:56:59 key: Accept value: [application/json, text/javascript, */*; q=0.01]\n2016/02/09 13:56:59 key: Origin value: [http://localhost:5000]\n2016/02/09 13:56:59 key: Accept-Encoding value: [gzip, deflate]\n2016/02/09 13:56:59 key: Accept-Language value: [en-US,en;q=0.8,pt;q=0.6,es;q=0.4]\n[13:56:59] 127.0.0.1 - - [09/Feb/2016:13:56:59 -0200] \"POST /register HTTP/1.1\" 204 0\n</code></pre>\n"}, {"tags": ["c", "gcc", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455031293, "post_id": 35295560, "comment_id": 58301197, "body": "You can&#39;t specify a relative path, for <code>.&#47;include</code> because the build happens in a different directory. I haven&#39;t tried it with headers and CFLAGS, but can you see if <code>${SRCDIR}</code> works? (from the <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\"><code>cgo</code> docs</a>)"}, {"owner": {"reputation": 710, "user_id": 1682515, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Ce89Q.jpg?s=128&g=1", "display_name": "coussej", "link": "https://stackoverflow.com/users/1682515/coussej"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455033738, "post_id": 35295560, "comment_id": 58303194, "body": "When I do that I get: <code>malformed #cgo argument: -L${SRCDIR}&#47;include</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455033902, "post_id": 35295560, "comment_id": 58303333, "body": "Are you using an old version of Go?"}, {"owner": {"reputation": 710, "user_id": 1682515, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Ce89Q.jpg?s=128&g=1", "display_name": "coussej", "link": "https://stackoverflow.com/users/1682515/coussej"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455034147, "post_id": 35295560, "comment_id": 58303512, "body": "1.4.2. I&#39;ll try updating first."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455034878, "post_id": 35295560, "comment_id": 58304087, "body": "<code>${SRCDIR}</code> is in go1.5"}, {"owner": {"reputation": 710, "user_id": 1682515, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Ce89Q.jpg?s=128&g=1", "display_name": "coussej", "link": "https://stackoverflow.com/users/1682515/coussej"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455036070, "post_id": 35295560, "comment_id": 58304984, "body": "Same reference error.  <code>#cgo CFLAGS: -std=c99 -I${SRCDIR}&#47;include #cgo LDFLAGS: -L${SRCDIR}&#47;include</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1455041387, "post_id": 35295560, "comment_id": 58308423, "body": "You should use double quotes (<code>&quot;</code>) around includes that are not in the standard system directories, not angle brackets. (some compilers will complain for you). Have you built the shared libs? Go will build C code in the package directory for you, but if you move that code, Go doesn&#39;t see it. You can see the compiler invocations with the <code>-x</code> option. It&#39;s probably best to just keep the code in the package directory if you&#39;re not sure what you&#39;re doing."}, {"owner": {"reputation": 508, "user_id": 222404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474c3bbd4881e8f8ce86782774b5bd70?s=128&d=identicon&r=PG", "display_name": "Tommy Knowlton", "link": "https://stackoverflow.com/users/222404/tommy-knowlton"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455049451, "post_id": 35295560, "comment_id": 58313105, "body": "What @JimB said in his latest comment. In C, <code>#include &quot;rightHere.h&quot;</code> means look for the named path relative to the location of the compilation unit, whereas <code>#include &lt;standardHeaderOverThere.h&gt;</code> means look in an implementation-defined set of locations."}, {"owner": {"reputation": 710, "user_id": 1682515, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Ce89Q.jpg?s=128&g=1", "display_name": "coussej", "link": "https://stackoverflow.com/users/1682515/coussej"}, "edited": false, "score": 0, "creation_date": 1455102058, "post_id": 35295560, "comment_id": 58335582, "body": "I have run the <code>go build -x</code> as you suggested, then I get this output. The subfolder is actually included... <a href=\"http://dumptext.com/AEl35q2p\" rel=\"nofollow noreferrer\">dumptext.com/AEl35q2p</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455113821, "post_id": 35295560, "comment_id": 58343896, "body": "@coussej: I meant run the build command with <code>-x</code> with the files in the same directory so you can see what it does when it works. Have you compiled the libraries in <code>include&#47;</code>? -- This is not going to do that for you. You are either missing the compiled .so files, or you need tell the linker to link them specifically, or both."}, {"owner": {"reputation": 710, "user_id": 1682515, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Ce89Q.jpg?s=128&g=1", "display_name": "coussej", "link": "https://stackoverflow.com/users/1682515/coussej"}, "edited": false, "score": 0, "creation_date": 1455183528, "post_id": 35295560, "comment_id": 58378722, "body": "How do I compile the files in the include folder? <code>ggc -std=c99 gopcua_client.c -o gopcua_client.o</code> ? Sorry for these stupid questions, just no experience with C at all. <code>go build</code> mostly just works :-)"}], "owner": {"reputation": 710, "user_id": 1682515, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Ce89Q.jpg?s=128&g=1", "display_name": "coussej", "link": "https://stackoverflow.com/users/1682515/coussej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1791, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455030918, "creation_date": 1455030918, "question_id": 35295560, "link": "https://stackoverflow.com/questions/35295560/cgo-undefined-reference-to-when-c-files-are-in-subfolder", "title": "CGO - undefined reference to &#39;...&#39; when c files are in subfolder", "body": "<p>I have some C files that I have included in my go project using cgo. When they are in the root folder of my go packages, my import looks like this:</p>\n\n<pre><code>/*\n#cgo CFLAGS: -std=c99 -I .\n#include &lt;stdlib.h&gt;\n#include &lt;gopcua_client.h&gt;\n*/\nimport \"C\"\n</code></pre>\n\n<p>This builds fine, everything works. However, I want to move the .c and .h files into a subfolder <strong>./include</strong>. I tried this, and changed the import to :</p>\n\n<pre><code>/*\n#cgo CFLAGS: -std=c99 -I ./include\n#include &lt;stdlib.h&gt;\n#include &lt;gopcua_client.h&gt;\n*/\nimport \"C\"\n</code></pre>\n\n<p>Now I get an error for every C function I use in the go-file: </p>\n\n<pre><code>/tmp/go-build184824875/github.com/coussej/gopcua/_obj/gopcua.cgo2.o: \nIn function `_cgo_38ec0a5d28b6_Cfunc_gopcua_read_int32':\n./gopcua.go:116: undefined reference to `gopcua_read_int32'\n</code></pre>\n\n<p>I'm not familiar with C, so I'm in the dark here. Thanks in advance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1455030769, "post_id": 35295339, "comment_id": 58300763, "body": "There&#39;s a tool for this called <a href=\"https://godoc.org/golang.org/x/tools/cmd/oracle\" rel=\"nofollow noreferrer\">Oracle</a>. IDE&#39;s also use it for code-completion."}, {"owner": {"reputation": 470, "user_id": 2197289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/82d0ed052f91e879e72caabc3ec0dd6e?s=128&d=identicon&r=PG", "display_name": "plunkets", "link": "https://stackoverflow.com/users/2197289/plunkets"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1455039889, "post_id": 35295339, "comment_id": 58307510, "body": "Saved for later (when i will understand better go lang)"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1455120130, "post_id": 35295339, "comment_id": 58348796, "body": "Depending on which editor you use, visual studio code, sublime text, atom and vim all have excellent code completion plugins for Go. I personally use <a href=\"https://github.com/Microsoft/vscode-go\" rel=\"nofollow noreferrer\">github.com/Microsoft/vscode-go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 470, "user_id": 2197289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/82d0ed052f91e879e72caabc3ec0dd6e?s=128&d=identicon&r=PG", "display_name": "plunkets", "link": "https://stackoverflow.com/users/2197289/plunkets"}, "edited": false, "score": 0, "creation_date": 1455039443, "post_id": 35295419, "comment_id": 58307249, "body": "I forgot to check the source, it helps"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1455030807, "last_edit_date": 1455030807, "creation_date": 1455030495, "answer_id": 35295419, "question_id": 35295339, "link": "https://stackoverflow.com/questions/35295339/how-to-know-the-functions-we-can-use-with-a-go-package/35295419#35295419", "title": "How to know the functions we can use with a go package?", "body": "<p>The hash implementations are all provided through a common <a href=\"https://golang.org/pkg/hash/#Hash\"><code>hash.Hash</code></a> <a href=\"https://golang.org/doc/effective_go.html#interfaces_and_types\">interface</a>.</p>\n\n<p>If you look at the docs for <a href=\"https://golang.org/pkg/crypto/sha512/#New\"><code>sha512.New</code></a>, you'll see that it returns a <a href=\"https://golang.org/pkg/hash/#Hash\"><code>hash.Hash</code></a>, which lists all the <code>Hash</code> specific methods.</p>\n\n<p>The first field in the <code>hash.Hash</code> interface is an <a href=\"https://golang.org/doc/effective_go.html#embedding\">embedded</a> <a href=\"https://golang.org/pkg/io/#Writer\"><code>io.Writer</code></a>, which is what provides the standard <code>Write</code> method. </p>\n\n<p>All these values are links in the documentation, which you can follow the to the required definitions, and even to the source. </p>\n"}, {"tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": false, "score": 0, "last_activity_date": 1455030496, "creation_date": 1455030496, "answer_id": 35295421, "question_id": 35295339, "link": "https://stackoverflow.com/questions/35295339/how-to-know-the-functions-we-can-use-with-a-go-package/35295421#35295421", "title": "How to know the functions we can use with a go package?", "body": "<p>The <code>Sum()</code> and <code>Write()</code> functions are part of the <a href=\"https://golang.org/pkg/hash/#Hash\" rel=\"nofollow\"><code>Hash</code></a> interface, which is implemented by all different kind of hashs.</p>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 0, "last_activity_date": 1455030912, "creation_date": 1455030912, "answer_id": 35295558, "question_id": 35295339, "link": "https://stackoverflow.com/questions/35295339/how-to-know-the-functions-we-can-use-with-a-go-package/35295558#35295558", "title": "How to know the functions we can use with a go package?", "body": "<p><code>hash.Hash</code> returns a <code>Hash</code> interface, which include <code>io.Writer</code>. If you check the <code>io.Writer</code>, you will find a <code>Writer</code> interface, which has a <code>Write()</code> method. Because the <code>sha512</code> package does implement the Write method, you can call the <code>Write</code> as a <code>hasher</code> method. </p>\n\n<p>The only requirement to access an interface is to implemente the method defined in your custom scope.</p>\n"}], "owner": {"reputation": 470, "user_id": 2197289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/82d0ed052f91e879e72caabc3ec0dd6e?s=128&d=identicon&r=PG", "display_name": "plunkets", "link": "https://stackoverflow.com/users/2197289/plunkets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 35295419, "answer_count": 3, "score": 1, "last_activity_date": 1455030912, "creation_date": 1455030256, "last_edit_date": 1455030570, "question_id": 35295339, "link": "https://stackoverflow.com/questions/35295339/how-to-know-the-functions-we-can-use-with-a-go-package", "title": "How to know the functions we can use with a go package?", "body": "<p>I am learning the go language and write my first go program, with the help of some web sources:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"crypto/sha512\"\n    \"encoding/base64\"\n)\n\nfunc main() {\n\n    ba := []byte(\"HelloWorld\")\n    hasher := sha512.New()\n    hasher.Write(ba)\n    sha := base64.StdEncoding.EncodeToString(hasher.Sum(nil))\n\n    fmt.Printf(sha)\n\n}\n</code></pre>\n\n<p>It compiles and works as expected, but I couldn't write this code myself since if i look at the Go package reference for <a href=\"https://golang.org/pkg/crypto/sha256\" rel=\"nofollow\">sha256</a>, I don't see the <code>Write()</code> and the <code>Sum()</code> methods. Where to find this kind of information? Maybe, I'm not reading the good document, or there is a sort of \"inheritance\" I didn't see.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1455082283, "post_id": 35292672, "comment_id": 58324862, "body": "Please stop using <code>map[string]interface{}</code>. It defeats the entire point of the type system. Use appropriate types and you&#39;ll have an easier time of things. More code, but an easier time."}, {"owner": {"reputation": 289, "user_id": 4768715, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/55e2ba38b11b464ad4146a33abbb391d?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Reck", "link": "https://stackoverflow.com/users/4768715/patrick-reck"}, "reply_to_user": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1455102652, "post_id": 35292672, "comment_id": 58335944, "body": "The reason that it&#180;s a type <code>interface{}</code> is that it could be any objects."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1455119362, "post_id": 35292672, "comment_id": 58348204, "body": "It might help to know what you are trying to achieve by unmarshaling arbitrary json objects into interface{}. What&#39;s the next step?"}], "answers": [{"tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": false, "score": 0, "last_activity_date": 1455026550, "creation_date": 1455026550, "answer_id": 35294016, "question_id": 35292672, "link": "https://stackoverflow.com/questions/35292672/get-rid-of-empty-json-values-from-map-of-interface/35294016#35294016", "title": "Get rid of empty JSON values from map of interface{}", "body": "<p>The <code>omitempty</code> is for encoding values, but not for decoding.</p>\n\n<p>You cannot generate a complete empty map in Go. (Empty as in, it does not exists.) If your create a variable / value of a struct it always has its default value.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var m map[string]interface{}\n    fmt.Printf(\"%v %d\\n\", m, len(m))\n    // prints: map[] 0\n    m = nil\n    fmt.Printf(\"%v %d\\n\", m, len(m))\n    // prints: map[] 0\n}\n</code></pre>\n\n<p>Example: <a href=\"https://play.golang.org/p/YTN32d5kLm\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 289, "user_id": 4768715, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/55e2ba38b11b464ad4146a33abbb391d?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Reck", "link": "https://stackoverflow.com/users/4768715/patrick-reck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 837, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455026550, "creation_date": 1455022510, "question_id": 35292672, "link": "https://stackoverflow.com/questions/35292672/get-rid-of-empty-json-values-from-map-of-interface", "title": "Get rid of empty JSON values from map of interface{}", "body": "<p>I have a struct in which I put all excess data into a <code>map[string]interface{}</code>. </p>\n\n<p>If I unmarshal into the <code>Data</code> property with an empty variable, I don't want to keep it when marshalling. I basically need <code>interface{}</code> to have <code>json:\",omitempty\"</code>, How do I get that?</p>\n\n<pre><code>type Event struct {\n    From string                 `json:\"from\"`\n    Data map[string]interface{} `json:\"data,omitempty\"`\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "slice"], "comments": [{"owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 0, "creation_date": 1455020406, "post_id": 35291429, "comment_id": 58293532, "body": "try using <code>reflect</code> package"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "reply_to_user": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 0, "creation_date": 1455020838, "post_id": 35291429, "comment_id": 58293822, "body": "can you give some examples?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1455020971, "post_id": 35291429, "comment_id": 58293915, "body": "Don&#39;t parse into an <code>&#236;nterface{}</code> (which you should not use if new to Go anyway) but into some appropriate struct with a noagg slice and do <code>len</code> on that slice."}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455021117, "post_id": 35291429, "comment_id": 58294016, "body": "I&#39;ll try to use slices for this too, but for this it is nesessary to declare struct type for each slice to the bottom of the tree..."}], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455021827, "post_id": 35292367, "comment_id": 58294500, "body": "I need the name of source to be dynamic, that is why I used interface. I found that <code>map[string]Charts</code> can be used, but now i Get erros that array cannot be parsed into my new structs..  The name of &quot;source&quot; can be x, y, ..., n, and there might be several sources in one moment.."}, {"owner": {"reputation": 806, "user_id": 2547389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f943f94b1bfe169a3291c5b94b7f938a?s=128&d=identicon&r=PG", "display_name": "wlredeye", "link": "https://stackoverflow.com/users/2547389/wlredeye"}, "reply_to_user": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455022438, "post_id": 35292367, "comment_id": 58294913, "body": "Can you send dynamic object name in additional json field? Do you know the structure of this object?"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455022749, "post_id": 35292367, "comment_id": 58295109, "body": "I know the structure. But I can&#39;t send additional &quot;name&quot; attribute. I&#39;ll write the structure of the main array in question. Updated the question body"}, {"owner": {"reputation": 806, "user_id": 2547389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f943f94b1bfe169a3291c5b94b7f938a?s=128&d=identicon&r=PG", "display_name": "wlredeye", "link": "https://stackoverflow.com/users/2547389/wlredeye"}, "reply_to_user": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455023222, "post_id": 35292367, "comment_id": 58295420, "body": "So you don&#39;t know name of object with array of Chats, right? (&#39;noagg&quot; for example)"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455023339, "post_id": 35292367, "comment_id": 58295512, "body": "It can be one of the list, but the list is dynamic. I mean that now there are only 3 source elements. But later there might be 10, or more sources of data, for charts"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455023713, "post_id": 35292367, "comment_id": 58295768, "body": "I wrote the whole test array , that comes to the go app from POST  with the format of JSON..in the body of my question"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455025203, "post_id": 35292367, "comment_id": 58296735, "body": "I got error : <code>JSON decode error: json: cannot unmarshal object into Go value of type string</code>  Here is my json: <code>{ &quot;filters&quot;: { &quot;dayStart&quot;: &quot;oneortwo&quot;, &quot;dayEnd&quot;: &quot;oneorthree&quot;, &quot;timePeriods&quot;: [ [ &quot;qqq&quot;, &quot;www&quot; ] ], &quot;lines&quot;: [ &quot;first&quot;, &quot;avokado&quot;, &quot;drunduki&quot; ] }, &quot;charts&quot;: { &quot;noagg&quot;: [ { &quot;name&quot;: &quot;HOLD&quot;, &quot;type&quot;: &quot;line&quot; }, { &quot;name&quot;: &quot;UKKR&quot;, &quot;type&quot;: &quot;line&quot; }, { &quot;name&quot;: &quot;SVO&quot;, &quot;type&quot;: &quot;line&quot; } ], &quot;oracle&quot;: [ { &quot;name&quot;: &quot;TDD&quot;, &quot;type&quot;: &quot;line&quot; } ] } }</code> May be that would be easier?"}, {"owner": {"reputation": 806, "user_id": 2547389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f943f94b1bfe169a3291c5b94b7f938a?s=128&d=identicon&r=PG", "display_name": "wlredeye", "link": "https://stackoverflow.com/users/2547389/wlredeye"}, "reply_to_user": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455025658, "post_id": 35292367, "comment_id": 58297074, "body": "with your json <a href=\"https://play.golang.org/p/isgxl0qlRv\" rel=\"nofollow noreferrer\">play.golang.org/p/isgxl0qlRv</a> . I just didnt implement Filter structure"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455025877, "post_id": 35292367, "comment_id": 58297230, "body": "works like a charm. I rewrote your struct with mistake firstly. Now all works! Thank You!  Edit your main answer, and I&#39;ll  point it as the solution =)"}], "tags": [], "owner": {"reputation": 806, "user_id": 2547389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f943f94b1bfe169a3291c5b94b7f938a?s=128&d=identicon&r=PG", "display_name": "wlredeye", "link": "https://stackoverflow.com/users/2547389/wlredeye"}, "is_accepted": true, "score": 2, "last_activity_date": 1455026050, "last_edit_date": 1455026050, "creation_date": 1455021660, "answer_id": 35292367, "question_id": 35291429, "link": "https://stackoverflow.com/questions/35291429/golang-how-to-count-elements-in-struct-type-interface/35292367#35292367", "title": "golang , How to count elements in struct type interface{}?", "body": "<p>As i understand you just need define structures for mapping json properly. It can be like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype ChartOptins struct {\n    Filters map[string]interface{} `json:\"filters\"`\n    Charts  map[string][]Chart     `json:\"charts\"`\n}\n\ntype Chart struct {\n    Name string `json:\"name\"`\n    Type string `json:\"type\"`\n}\n\nfunc main() {\n    const jsonStream = `{\n        \"filters\": { \"dayStart\": \"oneortwo\", \"dayEnd\": \"oneorthree\", \"timePeriods\": [ [ \"qqq\", \"www\" ] ], \"lines\": [ \"first\", \"avokado\", \"drunduki\" ] }, \n        \"charts\": { \"noagg\": [ { \"name\": \"HOLD\", \"type\": \"line\" }, { \"name\": \"UKKR\", \"type\": \"line\" }, { \"name\": \"SVO\", \"type\": \"line\" } ], \"oracle\": [ { \"name\": \"TDD\", \"type\": \"line\" } ] } \n    }`\n\n    var co ChartOptins\n    json.NewDecoder(strings.NewReader(jsonStream)).Decode(&amp;co)\n\n    fmt.Println(co)\n\n    for k, v := range co.Charts {\n        fmt.Printf(\"key: %v\\n\", k)\n        for _, ch := range v {\n            fmt.Printf(\"Name: %v, type: %v\\n\", ch.Name, ch.Type)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 3354837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67ad387148b04b6fb0240f4db4fbb6b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3354837", "link": "https://stackoverflow.com/users/3354837/user3354837"}, "is_accepted": false, "score": 5, "last_activity_date": 1455022481, "creation_date": 1455022481, "answer_id": 35292660, "question_id": 35291429, "link": "https://stackoverflow.com/questions/35291429/golang-how-to-count-elements-in-struct-type-interface/35292660#35292660", "title": "golang , How to count elements in struct type interface{}?", "body": "<p>Here is an exemple keeping interface:\n<a href=\"https://play.golang.org/p/Eu6Hj6ddSE\" rel=\"noreferrer\">https://play.golang.org/p/Eu6Hj6ddSE</a></p>\n\n<p>Just change:\n <code>Charts interface{}</code> witch <code>Charts []interface{}</code>\nif v is you ChartOptins then to get your len use .() operator on interface</p>\n\n<pre><code>fmt.Println(len(v.Charts.([]interface{})))\n</code></pre>\n"}], "owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8299, "favorite_count": 1, "accepted_answer_id": 35292367, "answer_count": 2, "score": 5, "last_activity_date": 1455026050, "creation_date": 1455018855, "last_edit_date": 1455024703, "question_id": 35291429, "link": "https://stackoverflow.com/questions/35291429/golang-how-to-count-elements-in-struct-type-interface", "title": "golang , How to count elements in struct type interface{}?", "body": "<p>I'm rather new in Go, but trying hard..</p>\n\n<p>I'm trying to write some logick, that need to check if an attribute of struct consists only of one element, or the first element has only one child. </p>\n\n<p>Main struct is this : </p>\n\n<pre><code>type ChartOptins struct {\n    Filters Filter `json:\"filters\"`\n    Charts interface{} `json:\"charts\"`\n}\n</code></pre>\n\n<p>Charts are born to be a composition of arrays of structure like this :</p>\n\n<pre><code>    $filters = array(\n        \"filters\" =&gt; array(\n            \"DayStart\" =&gt; \"12-01-2015\",\n            \"DayEnd\" =&gt; \"12-05-2015\",\n            \"TimePeriods\"=&gt; array(\n                array(\"qqq\",\"www\"),\n            ),\n            \"lines\" =&gt; array(\n                \"first\",\"avokado\",\"drunduki\"\n            )\n\n        ),\n        \"charts\" =&gt; array(\n            \"noagg\" =&gt; array(\n                array(\n                    \"name\" =&gt; \"HOLD\",\n                    \"type\" =&gt; \"line\"\n                ),\n                array(\n                    \"name\" =&gt; \"UKKR\",\n                    \"type\" =&gt; \"line\"\n                ),\n                array(\n                    \"name\" =&gt; \"SVO\",\n                    \"type\" =&gt; \"line\"\n                ),\n            ),\n            \"oracle\" =&gt; array(\n                array(\n                    \"name\" =&gt; \"TDD\",\n                    \"type\" =&gt; \"line\"\n                ),\n            ) \n        ),\n    );\n</code></pre>\n\n<p>Into the stuct <code>ChartOptions</code> I parse the JSON from POST request. JSON looks like this :</p>\n\n<pre><code>{ \"filters\": { \"dayStart\": \"11-10-2015\", \"dayEnd\": \"21-10-2015\", \"timePeriods\": [ [ \"qqq\", \"www\" ] ], \"lines\": [ \"first\", \"avokado\", \"drunduki\" ] }, \"charts\": { \"noagg\": [ { \"name\": \"HOLD\", \"type\": \"line\" } ] } }\n</code></pre>\n\n<p>So , <code>charts</code> can have only 1 source and 1 element in it, or any amount of elements in any amount of  sources. </p>\n\n<pre><code>\"charts\" : { \"noagg\": [ { \"name\": \"HOLD\", \"type\": \"line\" } ] }\nor\n\"charts\" : { \"noagg\": [ { \"name\": \"HOLD\", \"type\": \"line\" } , { \"name\": \"TDD\", \"type\": \"line\" } , { \"name\": \"SVO\", \"type\": \"line\" } ] }\n</code></pre>\n\n<p>Of cource, this is the JSON elements that comes to go script, and i parse them into interface{}. When I tried to use <code>len()</code>, Go said that I cant use it on interface.. </p>\n\n<p>What is the best practice to work with the amount of elements, and what is the best way to achieve such a check?</p>\n"}, {"tags": ["go", "rethinkdb", "rethinkdb-javascript", "nosql"], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 1108547, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0316db582650c52c8aa85bdf621ae216?s=128&d=identicon&r=PG", "display_name": "Alexander W", "link": "https://stackoverflow.com/users/1108547/alexander-w"}, "edited": false, "score": 0, "creation_date": 1455090949, "post_id": 35299638, "comment_id": 58328667, "body": "Thank you dalanmiller! The merge part did the trick and i can now fully fetch the data :)"}], "tags": [], "owner": {"reputation": 2867, "user_id": 1076057, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/h2k2g.jpg?s=128&g=1", "display_name": "dalanmiller", "link": "https://stackoverflow.com/users/1076057/dalanmiller"}, "is_accepted": true, "score": 1, "last_activity_date": 1455043052, "creation_date": 1455043052, "answer_id": 35299638, "question_id": 35287733, "link": "https://stackoverflow.com/questions/35287733/rethinkdb-filter-using-match-by-value-in-same-dataset-and-table/35299638#35299638", "title": "RethinkDB - Filter using Match() by value in same dataset and table", "body": "<p>You definitely want to use <code>r.expr</code> here and I got this example to work:</p>\n\n<pre><code>r.expr([{\n \"id\": 12345,\n \"policy_subjects\": [\n   {\n     compiled:  \"^(user|max|anonymous)$\",\n     template:  \"&lt;user|max|anonymous&gt;\"\n   },\n   {\n     compiled:  \"^max$\",\n     template:  \"max\"\n   }\n ]\n}]).merge(function(policy_row) {  \n  return {\n    \"policy_subjects\": policy_row(\"policy_subjects\").filter(function(item){\n            return r.expr(\"max\").match(r.expr(\"(?i)\").add(item(\"compiled\"))).ne(null);\n        })\n  }\n})\n</code></pre>\n\n<p>Changing <code>max</code> to something else that does not match, returns the document with no elements inside <code>policy_subjects</code>. </p>\n\n<p>For example, changing <code>max</code> => to <code>wat</code> (my favorite test string of all time) looks like this:</p>\n\n<pre><code>.merge(function(policy_row) {  \n  return {\n    \"policy_subjects\": policy_row(\"policy_subjects\").filter(function(item){\n            return r.expr(\"wat\").match(r.expr(\"(?i)\").add(item(\"compiled\"))).ne(null);\n        })\n  }\n})\n</code></pre>\n\n<p>And results in this:</p>\n\n<pre><code>[\n  {\n    \"id\": 12345 ,\n    \"policy_subjects\": [ ]\n  }\n]\n</code></pre>\n\n<p>I think your logic for reducing to the one <code>policy_subject</code> document you want might be a little subjective to your use case so I'm not sure what the right answer is but you can use <code>.reduce(...)</code> to just return the right-most value.</p>\n"}], "owner": {"reputation": 1030, "user_id": 1108547, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0316db582650c52c8aa85bdf621ae216?s=128&d=identicon&r=PG", "display_name": "Alexander W", "link": "https://stackoverflow.com/users/1108547/alexander-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 35299638, "answer_count": 1, "score": 0, "last_activity_date": 1504677807, "creation_date": 1455008417, "last_edit_date": 1506103282, "question_id": 35287733, "link": "https://stackoverflow.com/questions/35287733/rethinkdb-filter-using-match-by-value-in-same-dataset-and-table", "title": "RethinkDB - Filter using Match() by value in same dataset and table", "body": "<p>So, since I'm too dumb obviously to figure this out myself, I'll ask you better folks here on SO instead.</p>\n\n<p>Basically i have a datastructure that looks like the following:</p>\n\n<pre><code>....,\n{\n \"id\": 12345\n\n ....\n\n \"policy_subjects\": [\n   {\n     \"compiled\":  \"^(user|max|anonymous)$\",\n     \"template\":  \"&lt;user|max|anonymous&gt;\"\n   },\n   {\n     \"compiled\":  \"^max$\",\n     \"template\":  \"max\"\n   }\n ]\n....\n}\n</code></pre>\n\n<p><strong>compiled</strong> is a \"compiled\" regex</p>\n\n<p><strong>template</strong> is the same regex without regex-modifiers</p>\n\n<hr>\n\n<p>What I want is to do a simple query in RethinkDB using the \"compiled\" value and matching that against a string, say \"max\".</p>\n\n<pre><code>Basically \n\nr.table(\"regex_policies\").filter(function(policy_row) {\n  return \"max\".match(\"(?i)\"+policy_row(\"policy_subjects\")(\"compiled\"))\n}\n\nIs what i want to do (+case-insensitive search)\n</code></pre>\n\n<p>There are of course lots of policy_subjects in the database so in this example the result should be the whole dataset (1 result) that matches \"max\". Since \"max\" exists twice in this case and it matches both regexes (once would have been enough).</p>\n\n<p>\"foobar\" would likewise in this example yield 0 results, since any of the compiled regexes does not match \"foobar\". </p>\n\n<p>Does anyone know how to do this relatively simple query?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1455008219, "post_id": 35287175, "comment_id": 58285488, "body": "<code>$sum</code> is not a stage. That&#39;s correct. How would your aggregation look on the shell?"}], "owner": {"reputation": 21, "user_id": 5902152, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J4F09K8fVsQ/AAAAAAAAAAI/AAAAAAAAAB0/366lWZC9Aps/photo.jpg?sz=128", "display_name": "Cem K\u0131y", "link": "https://stackoverflow.com/users/5902152/cem-k%c4%b1y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1455006574, "creation_date": 1455006574, "question_id": 35287175, "link": "https://stackoverflow.com/questions/35287175/how-to-use-mgo-sum-operator", "title": "How to use mgo $sum operator", "body": "<p>My code:</p>\n\n<pre><code>func (db *MongoConn) Sum(collection string, query Query, field string) (float64, error) {\nqueryResult := db.Session.\n    DB(db.DialInfo.Database).\n    C(collection).\n    Pipe([]bson.M{{\"$sum\": field}})}\n</code></pre>\n\n<p>Error: exception: Unrecognized pipeline stage name: '$sum'ERROR</p>\n"}, {"tags": ["sockets", "go", "zeromq"], "answers": [{"comments": [{"owner": {"reputation": 1783, "user_id": 4569273, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a57a59c27de3760066076765f8dacc2c?s=128&d=identicon&r=PG&f=1", "display_name": "auxdx", "link": "https://stackoverflow.com/users/4569273/auxdx"}, "edited": false, "score": 0, "creation_date": 1455023835, "post_id": 35288745, "comment_id": 58295845, "body": "Hi, in my real application, I have an UDP listener which read UDP packages from multiple high-load producers. For now, as soon as UDP packages arrive, I publish them via zeromq and have multiple subscribers/worker process which process the data. The traffic is not constant but can be &quot;peak&quot; at some points. If the buffer size is small and consumers are slow at that time, packages might be dropped silently. I am thinking of having buffer size of around 100Mb, not sure if it&#39;s too much?"}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 1, "last_activity_date": 1455011412, "creation_date": 1455011412, "answer_id": 35288745, "question_id": 35286317, "link": "https://stackoverflow.com/questions/35286317/no-buffer-space-available-tcp-cpp69-when-setting-sndbuf-and-rcvbuf-zeromq-go/35288745#35288745", "title": "No buffer space available (tcp.cpp:69) when setting SNDBUF and RCVBUF ZeroMQ, golang, MacOSX", "body": "<p>A buffer size of > 5MB is pointless. Anything beyond the bandwidth-delay product of the link concerned is wasted space.</p>\n\n<p>Moderate your requirements.</p>\n"}], "owner": {"reputation": 1783, "user_id": 4569273, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a57a59c27de3760066076765f8dacc2c?s=128&d=identicon&r=PG&f=1", "display_name": "auxdx", "link": "https://stackoverflow.com/users/4569273/auxdx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455011412, "creation_date": 1455003330, "question_id": 35286317, "link": "https://stackoverflow.com/questions/35286317/no-buffer-space-available-tcp-cpp69-when-setting-sndbuf-and-rcvbuf-zeromq-go", "title": "No buffer space available (tcp.cpp:69) when setting SNDBUF and RCVBUF ZeroMQ, golang, MacOSX", "body": "<p>I have zeromq: stable 4.1.4 installed using brew on MacOSX and have written a simple PUB/SUB program to test zeromq.  But when I run the sample program using flags --bufsize > 5 (to use a buffer of size > 5MB) (go run go_zmq_pubsub.go --bufsize=6); it throws the following exception:</p>\n\n<p>No buffer space available (tcp.cpp:69)\nSIGABRT: abort\nPC=0x7fff9911c286 m=0\nsignal arrived during cgo execution</p>\n\n<p>Below is the program I used to test the zeromq4.x</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"flag\"\n    \"strconv\"\n    \"sync\"\n    log \"github.com/Sirupsen/logrus\"\n    zmq \"github.com/pebbe/zmq4\"\n    \"time\"\n)\n\nvar _ = fmt.Println\n\nfunc main(){\n    var port int\n    var bufsize int\n    flag.IntVar(&amp;port, \"port\", 7676, \"server's zmq tcp port\")\n    flag.IntVar(&amp;bufsize, \"bufsize\", 0, \"socket kernel buffer size\")\n\n    flag.Parse();\n\n    publisher, err := zmq.NewSocket(zmq.PUB)\n    if(err != nil) {\n        log.Fatal(err)\n    }\n\n    //set publisher kernel transmit buffer size\n    //convert into bytes\n    if err := publisher.SetSndbuf(bufsize * 1000000); err != nil {\n        log.Fatal(err)\n    }\n\n    defer publisher.Close()\n    publisher.Bind(\"tcp://*:\" + strconv.Itoa(port))\n\n    //SETUP subscriber\n    subscriber, err := zmq.NewSocket(zmq.SUB)\n    if(err != nil) {\n        log.Fatal(err)\n    }\n\n    //set subscriber kernel receive buffer size\n    if err := subscriber.SetRcvbuf(bufsize * 1000000); err != nil {\n        log.Fatal(err)\n    }\n\n    defer subscriber.Close()\n    subscriber.Connect(\"tcp://127.0.0.1:\" + strconv.Itoa(port))\n    subscriber.SetSubscribe(\"\")\n\n    var wg sync.WaitGroup\n    wg.Add(2)\n\n    idx := 0\n\n    go func(wg *sync.WaitGroup) {\n        //start streaming messages\n        ticker := time.NewTicker(1 * time.Second)\n        go func() {\n            for {\n                select {\n                case &lt;-ticker.C:\n                    _, err = publisher.Send(\"PKG:\"+strconv.Itoa(idx), 0)\n\n                    idx++;\n\n                    if(err != nil) {\n                        log.Error(err)\n                    }\n                }\n            }\n        }()\n    }(&amp;wg)\n\n\n    //receiver\n    go func(wg *sync.WaitGroup) {\n        go func(){\n            for {\n                payload, err := subscriber.Recv(0)\n                _ = payload\n\n                if err != nil {\n                    log.Error(err)\n                    break\n                }\n\n                //now sending into worker pool\n                log.Info(\"RECEIVE:\" + payload)\n            }\n        }()\n    }(&amp;wg)\n\n    wg.Wait()\n}\n</code></pre>\n\n<p>On Centos7 with lib-zeromq built from source, the above code works without problem.</p>\n\n<p>Not sure if it's due to libzeromq or the OS itself.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "oauth-2.0", "google-api", "gmail", "gmail-api"], "comments": [{"owner": {"reputation": 1416, "user_id": 5653411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33328e4cbdd36cc8273e9875fd3085e?s=128&d=identicon&r=PG&f=1", "display_name": "gerardnimo", "link": "https://stackoverflow.com/users/5653411/gerardnimo"}, "edited": false, "score": 0, "creation_date": 1455017837, "post_id": 35285509, "comment_id": 58291735, "body": "I think <a href=\"http://stackoverflow.com/questions/10576386/invalid-grant-trying-to-get-oauth-token-from-google\">SO-10576386</a> might help."}, {"owner": {"reputation": 61, "user_id": 3126615, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be903d642b5e741cc6a60fec6994211d?s=128&d=identicon&r=PG&f=1", "display_name": "Clerk", "link": "https://stackoverflow.com/users/3126615/clerk"}, "reply_to_user": {"reputation": 1416, "user_id": 5653411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33328e4cbdd36cc8273e9875fd3085e?s=128&d=identicon&r=PG&f=1", "display_name": "gerardnimo", "link": "https://stackoverflow.com/users/5653411/gerardnimo"}, "edited": false, "score": 0, "creation_date": 1455080244, "post_id": 35285509, "comment_id": 58324103, "body": "@gerardnimo The assess type is already &quot;Offline&quot; in quickstart.go.  I think I need to prompt a page to let the gmail user to grant permission again. But I just have no idea how to do that."}, {"owner": {"reputation": 61, "user_id": 3126615, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be903d642b5e741cc6a60fec6994211d?s=128&d=identicon&r=PG&f=1", "display_name": "Clerk", "link": "https://stackoverflow.com/users/3126615/clerk"}, "reply_to_user": {"reputation": 1416, "user_id": 5653411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33328e4cbdd36cc8273e9875fd3085e?s=128&d=identicon&r=PG&f=1", "display_name": "gerardnimo", "link": "https://stackoverflow.com/users/5653411/gerardnimo"}, "edited": false, "score": 0, "creation_date": 1455080788, "post_id": 35285509, "comment_id": 58324276, "body": "<a href=\"http://stackoverflow.com/questions/10576386/invalid-grant-trying-to-get-oauth-token-from-google\">SO-10576386</a> seems not work to me."}, {"owner": {"reputation": 61, "user_id": 3126615, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be903d642b5e741cc6a60fec6994211d?s=128&d=identicon&r=PG&f=1", "display_name": "Clerk", "link": "https://stackoverflow.com/users/3126615/clerk"}, "reply_to_user": {"reputation": 1416, "user_id": 5653411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33328e4cbdd36cc8273e9875fd3085e?s=128&d=identicon&r=PG&f=1", "display_name": "gerardnimo", "link": "https://stackoverflow.com/users/5653411/gerardnimo"}, "edited": false, "score": 0, "creation_date": 1455082843, "post_id": 35285509, "comment_id": 58325075, "body": "I checked the code and found the solution: Delete the CacheFile &quot;.credentials&quot; in HomeDir. I search .credentials and delete it and it works."}, {"owner": {"reputation": 4218, "user_id": 298539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3b05247da11662644fc23205a779e94a?s=128&d=identicon&r=PG", "display_name": "png", "link": "https://stackoverflow.com/users/298539/png"}, "edited": false, "score": 0, "creation_date": 1462969181, "post_id": 35285509, "comment_id": 61860248, "body": "where is this file"}], "owner": {"reputation": 61, "user_id": 3126615, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be903d642b5e741cc6a60fec6994211d?s=128&d=identicon&r=PG&f=1", "display_name": "Clerk", "link": "https://stackoverflow.com/users/3126615/clerk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 899, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455000141, "creation_date": 1455000141, "question_id": 35285509, "link": "https://stackoverflow.com/questions/35285509/gmail-api-invalid-granttoken-has-been-revoked", "title": "Gmail API: (invalid_grant)Token has been revoked", "body": "<p>I use golang, following the quickstart.go at <a href=\"https://developers.google.com/gmail/api/quickstart/go\" rel=\"nofollow\">https://developers.google.com/gmail/api/quickstart/go</a>.</p>\n\n<p>Firstly, it worked fine to list lables. But I found it no ways to grant permission for sending emails, so I revoke the token and try to keep everything reset. After revoking the token, I cannot grant permissions again. It always results in the following error:</p>\n\n<p>Get <a href=\"https://www.googleapis.com/gmail/v1/users/me/labels?alt=json\" rel=\"nofollow\">https://www.googleapis.com/gmail/v1/users/me/labels?alt=json</a>: oauth2: cannot fetch token: 400 Bad Request\nResponse: {\n  \"error\" : \"invalid_grant\",\n  \"error_description\" : \"Token has been revoked.\"\n}</p>\n\n<p>How can I fix this. Please help me. Thank you.</p>\n"}, {"tags": ["go", "viper-go"], "comments": [{"owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "edited": false, "score": 0, "creation_date": 1454965243, "post_id": 35278329, "comment_id": 58270032, "body": "It seems that your environment variable name is not the same as the key name that you are using to retrieve its value, try with that: <code>fmt.Print(viper.GetString(&quot;options.values.root&quot;))</code>"}, {"owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "reply_to_user": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "edited": false, "score": 0, "creation_date": 1454967269, "post_id": 35278329, "comment_id": 58271164, "body": "That works, but I that is not the effect I&#39;m looking for. In that case I need to know the keys  of the values map in advance. I want to process all the values as a map. I will add to the question to make the use case more clear."}, {"owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "edited": false, "score": 0, "creation_date": 1454972347, "post_id": 35278329, "comment_id": 58273422, "body": "I added an answer, maybe it could help you."}], "answers": [{"comments": [{"owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "edited": false, "score": 0, "creation_date": 1454972534, "post_id": 35280829, "comment_id": 58273482, "body": "Thanks! that works, but the only caveat with that is that I&#39;m already using a yaml configuration file, and the env variable will be an alternative way to pass the values, so I cannot switch to a JSON config type in viper."}, {"owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "reply_to_user": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "edited": false, "score": 1, "creation_date": 1454972822, "post_id": 35280829, "comment_id": 58273598, "body": "You can add a condition that checks if the environment variable is set, if so change the config type to JSON, do whatever you want, and once it is finished change again the config type to YML."}, {"owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "edited": false, "score": 0, "creation_date": 1454973738, "post_id": 35280829, "comment_id": 58273918, "body": "Great, I will give it a try and let you know, thanks!"}], "tags": [], "owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "is_accepted": false, "score": 2, "last_activity_date": 1454971602, "creation_date": 1454971602, "answer_id": 35280829, "question_id": 35278329, "link": "https://stackoverflow.com/questions/35278329/passing-a-string-map-as-an-environment-variable-in-go-using-viper/35280829#35280829", "title": "Passing a string map as an environment variable in Go using Viper", "body": "<p>I have been investigating a bit and it seems that you are not set the value of your environment variable properly, as well as how you are calling it with viper. Find below an example of that and feel free to comment any thought that you have:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"github.com/spf13/viper\"\n    \"strings\"\n)\n\nfunc main() {\n    //Configure the type of the configuration as JSON\n    viper.SetConfigType(\"json\")\n    //Set the environment prefix as CONFIG\n    viper.SetEnvPrefix(\"CONFIG\")\n    viper.AutomaticEnv()\n    //Substitute the _ to .\n    replacer := strings.NewReplacer(\".\", \"_\")\n    viper.SetEnvKeyReplacer(replacer)\n\n    //Get the string that is set in the CONFIG_OPTIONS_VALUES environment variable\n    var jsonExample = []byte(viper.GetString(\"options.values\"))\n    viper.ReadConfig(bytes.NewBuffer(jsonExample))\n\n    //Convert the sub-json string of the options field in map[string]string\n    fmt.Println(viper.GetStringMapString(\"options\"))\n}\n</code></pre>\n\n<p>And how it would be call:</p>\n\n<pre><code>CONFIG_OPTIONS_VALUES=\"{\\\"options\\\": {\\\"root\\\": \\\".\\\", \\\"cmd\\\": \\\"exec\\\", \\\"logging\\\": \\\"on\\\"}}\" go run main.go\n</code></pre>\n"}], "owner": {"reputation": 1501, "user_id": 505752, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2a6326c140b4a5484010a4a9473da90?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/505752/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6468, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1454971602, "creation_date": 1454961959, "last_edit_date": 1454967466, "question_id": 35278329, "link": "https://stackoverflow.com/questions/35278329/passing-a-string-map-as-an-environment-variable-in-go-using-viper", "title": "Passing a string map as an environment variable in Go using Viper", "body": "<p>For a project I'm working on I'm trying to pass a map of stings as an environment variable using Viper. I tried several approaches to achieve this but with no success. When I read the env variable from code it is empty. This is the code I'm using:</p>\n\n<pre><code>// To configure viper\nviper.SetEnvPrefix(\"CONFIG\")\nviper.AutomaticEnv()\nreplacer := strings.NewReplacer(\".\", \"_\")\nviper.SetEnvKeyReplacer(replacer)\n\n// To read the configuration value I tried all this variants:\nfmt.Print(viper.GetString(\"options.values\"))\nfmt.Print(viper.GetStringMapString(\"options.values\"))\nfmt.Print(viper.GetStringMap(\"options.values\"))\n</code></pre>\n\n<p>And this is how I'm passing the value:</p>\n\n<p>CONFIG_OPTIONS_VALUES_ROOT=\".\"</p>\n\n<p>I've also tried:</p>\n\n<p>CONFIG_OPTIONS_VALUES=\"{\\\"root\\\": \\\".\\\",\\\"cmd\\\": \\\"exec\\\", \\\"logging\\\": \\\"on\\\"}\"</p>\n\n<p>The way I want to process the value passes in the env variable is:</p>\n\n<pre><code>values := viper.GetStringMapString(\"options.values\")\nfor key, val := range values {\n    fmt.Printf(\"Key: %s, Value: %s\", key, val)\n}\n</code></pre>\n\n<p>Which I can perfectly do if I write this configuration in a config file and I read it using viper:</p>\n\n<pre><code>options:\n        values:\n                root: .\n                cmd: exec\n                logging: on\n                #more values can be added here \n</code></pre>\n\n<p>Hope someone can point me in the right direction here.</p>\n"}, {"tags": ["java", "windows", "go", "jar"], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 5811999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5625a02354e06e7a96b29b484e9f3a7?s=128&d=identicon&r=PG&f=1", "display_name": "Melis", "link": "https://stackoverflow.com/users/5811999/melis"}, "is_accepted": false, "score": 0, "last_activity_date": 1454960095, "creation_date": 1454960095, "answer_id": 35277802, "question_id": 35277558, "link": "https://stackoverflow.com/questions/35277558/executing-jar-from-golanguage-program-in-windows/35277802#35277802", "title": "executing jar from golanguage program in windows", "body": "<p>Well, depending on which version you have of windows there is slightly different methods of setting your PATH and ENVIROMENT variables.</p>\n\n<p><a href=\"http://www.computerhope.com/issues/ch000549.htm\" rel=\"nofollow\">Here</a> you will find guides for most windows versions.</p>\n"}], "owner": {"reputation": 3, "user_id": 1778203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a861dc74c8bf05456f9662cc1e25f6?s=128&d=identicon&r=PG", "display_name": "user1778203", "link": "https://stackoverflow.com/users/1778203/user1778203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454960095, "creation_date": 1454959147, "question_id": 35277558, "link": "https://stackoverflow.com/questions/35277558/executing-jar-from-golanguage-program-in-windows", "title": "executing jar from golanguage program in windows", "body": "<pre><code>'package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n    \"strings\"\n)\n\nfunc main() {\n    //var java = \"\\\\jrex64\\\\bin\\\\java.exe\"\n    var java =\"jre/lib/java.exe\"\n\n    var path = []string{\n        \"jrex64\\\\lib\\\\rt.jar\",\n        \"jrex64\\\\lib\\\\jfxrt.jar\",\n        \"jrex64\\\\lib\\\\resources.jar\",\n        \"jrex64\\\\lib\\\\ext\\\\sunjce_provider.jar\",\n        \"jrex64\\\\lib\\\\ext\\\\zipfs.jar\",\n        \"jrex64\\\\lib\\\\ext\\\\sunmscapi.jar\",\n        \"jrex64\\\\lib\\\\ext\\\\sunec.jar\",\n        \"jrex64\\\\lib\\\\ext\\\\dnsns.jar\",\n        \"jrex64\\\\lib\\\\ext\\\\access-bridge-64.jar\",\n        \"jrex64\\\\lib\\\\security\\\\local_policy.jar\",\n        \"jrex64\\\\lib\\\\jce.jar\",\n        \"jrex64\\\\lib\\\\jfr.jar\",\n        \"jrex64\\\\lib\\\\jsse.jar\",\n        \"jrex64\\\\lib\\\\charsets.jar\",\n        \"jrex64\\\\lib\\\\\",\n    }\n\n    var pathflag  string = \"-Xbootclasspath:\" + strings.Join(path, \";\")\n    cmd := exec.Command(java, \"-verbose\", pathflag, \"-cp Ganesha_lib\\\\*\", \"-jar Ganesha.jar\")\n    err := cmd.Run()\n\n    if err != nil {\n        fmt.Println(\"an error occurred.\\n\")\n        log.Fatal(err)\n    }\n\n}\n</code></pre>\n\n<p>I want to call a jar file from go lang program in windows on window my java is installed in programfiles how do i set up the path for java variable and path variable in windows </p>\n"}, {"tags": ["string", "go", "comparison"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1454957594, "post_id": 35277022, "comment_id": 58265650, "body": "Strings are compared lexically. Do you want to compare the decimal numbers in the strings?"}, {"owner": {"reputation": 21, "user_id": 5899909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4209c4a8f6258b662f79cacb0650926c?s=128&d=identicon&r=PG&f=1", "display_name": "sina", "link": "https://stackoverflow.com/users/5899909/sina"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1454959412, "post_id": 35277022, "comment_id": 58266663, "body": "Yes, that&#39;s what I want"}, {"owner": {"reputation": 1698, "user_id": 3778742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad62c6ebfd4440c951edde151cb76714?s=128&d=identicon&r=PG&f=1", "display_name": "alexsmn", "link": "https://stackoverflow.com/users/3778742/alexsmn"}, "edited": false, "score": 0, "creation_date": 1455014978, "post_id": 35277022, "comment_id": 58289901, "body": "the length of two strings can be compared by getting the length of each string: <code>len(&quot;string&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1454958072, "post_id": 35277089, "comment_id": 58265872, "body": "And don&#39;t forget to check the errors if you want to avoid accidentally comparing a non-number as 0."}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1454960147, "post_id": 35277089, "comment_id": 58267068, "body": "Also this will fail if the number is to large to hold in an int64"}], "tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": true, "score": 4, "last_activity_date": 1454958282, "last_edit_date": 1454958282, "creation_date": 1454957593, "answer_id": 35277089, "question_id": 35277022, "link": "https://stackoverflow.com/questions/35277022/comparing-not-equal-length-strings-in-go/35277089#35277089", "title": "Comparing not equal length strings in Go", "body": "<blockquote>\n  <p>The reason is probably because Go does char by char comparison starting with the most significant char.</p>\n</blockquote>\n\n<p>This is correct.</p>\n\n<p>If they represent numbers, then you should compare as them as numbers. Parse / convert them to <code>int</code> before comparing:</p>\n\n<pre><code>ii, _ := strconv.Atoi(i)\nij, _ := strconv.Atoi(j)\n</code></pre>\n\n<p><strong>Edit:</strong> And yes, @JimB is totally right. If you are not 100% sure that the conversion will succeed, please do not ignore the errors.</p>\n"}], "owner": {"reputation": 21, "user_id": 5899909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4209c4a8f6258b662f79cacb0650926c?s=128&d=identicon&r=PG&f=1", "display_name": "sina", "link": "https://stackoverflow.com/users/5899909/sina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 35277089, "answer_count": 1, "score": 1, "last_activity_date": 1454984021, "creation_date": 1454957329, "last_edit_date": 1454984021, "question_id": 35277022, "link": "https://stackoverflow.com/questions/35277022/comparing-not-equal-length-strings-in-go", "title": "Comparing not equal length strings in Go", "body": "<p>When I compare the following not equal length strings in Go, the result of comparison is not right. Can someone help?</p>\n\n<pre><code>i := \"1206410694\"\nj := \"128000000\"\nfmt.Println(\"result is\", i &gt;= j, i, j )\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>result is false 1206410694 128000000\n</code></pre>\n\n<p>The reason is probably because Go does char by char comparison starting with the most significant char. In my case these strings represent numbers so i is larger than j. So just wonder if someone can help with explaining how not equal length strings are compared in go.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 0, "creation_date": 1479601796, "post_id": 35276391, "comment_id": 68627826, "body": "On a side note, you&#39;re parsing all your templates inside your handlers. That can be a drag on performance. <a href=\"http://stackoverflow.com/questions/28451675/it-takes-too-much-time-when-using-template-package-to-generate-a-dynamic-web-p\" title=\"it takes too much time when using template package to generate a dynamic web p\">stackoverflow.com/questions/28451675/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1454956435, "post_id": 35276455, "comment_id": 58265012, "body": "Possible to jump to another page without using redirect and still carrying user identifications? If no then are there any response codes I can use to redirect? thx"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1454957119, "post_id": 35276455, "comment_id": 58265409, "body": "@Kyle: Headers will be preserved with a redirect; is that what you mean by &quot;carrying user identifications&quot;.  A redirect <i>is</i> a response code, plus the <code>Location</code> header, so I don&#39;t know what you mean by the second question at all."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1454955369, "creation_date": 1454955369, "answer_id": 35276455, "question_id": 35276391, "link": "https://stackoverflow.com/questions/35276391/golang-redirect-twice-and-cause-http-multiple-response-writeheader-calls/35276455#35276455", "title": "Golang: redirect twice and cause http: multiple response.WriteHeader calls", "body": "<p>In your <code>manage</code> handler, you're executing the template which will write to the <code>http.ResponseWriter</code> and trigger an <code>http.StatusOK</code> (200) status code. You can't redirect after that, since that requires sending a different response code.</p>\n\n<p>If you need to redirect, do it before executing the template.</p>\n"}, {"tags": [], "owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "is_accepted": true, "score": 1, "last_activity_date": 1454974067, "last_edit_date": 1495540415, "creation_date": 1454974067, "answer_id": 35281266, "question_id": 35276391, "link": "https://stackoverflow.com/questions/35276391/golang-redirect-twice-and-cause-http-multiple-response-writeheader-calls/35281266#35281266", "title": "Golang: redirect twice and cause http: multiple response.WriteHeader calls", "body": "<p>As JimB already pointed out: your server gets confused because there are different status codes associated with both writing to <code>http.ResponseWriter</code> and the <code>redirect</code>. You can't do both at the same time.</p>\n\n<p>I would actually like to expand more on how you can carry data over to the next page (assuming you are redirecting).</p>\n\n<p><strong>Headers</strong>\nYou can write some information to the request object and receive it on the destination page. Example:</p>\n\n<pre><code>func myHandler(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"My-Awesome-Header\", \"Rocks\")\n    ...\n}\n</code></pre>\n\n<p><strong>Session:</strong>\nYou are talking about access control as far as I can see, and I think persisting user data is better done through a session. Example: you can use a database or a session handler like <a href=\"https://github.com/gorilla/sessions\" rel=\"nofollow noreferrer\">https://github.com/gorilla/sessions</a>. Check out this thread: <a href=\"https://stackoverflow.com/questions/26106363/best-practice-with-sessions-gorilla-sessions\">Best practice with sessions (gorilla/sessions)</a>.</p>\n\n<p><strong>Cookies:</strong>\nI'm not sure what kind of front-end you are using, but storing non-sensitive data on the cookie could be an option? Nothing beats this one (it has real choc-chip cookies in the examples ;-) ): <a href=\"https://astaxie.gitbooks.io/build-web-application-with-golang/content/en/06.1.html\" rel=\"nofollow noreferrer\">https://astaxie.gitbooks.io/build-web-application-with-golang/content/en/06.1.html</a>.</p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2595, "favorite_count": 0, "accepted_answer_id": 35281266, "answer_count": 2, "score": 0, "last_activity_date": 1454974067, "creation_date": 1454955132, "last_edit_date": 1454955748, "question_id": 35276391, "link": "https://stackoverflow.com/questions/35276391/golang-redirect-twice-and-cause-http-multiple-response-writeheader-calls", "title": "Golang: redirect twice and cause http: multiple response.WriteHeader calls", "body": "<p>I have a very weird output ... let me post my code first then I will explain: </p>\n\n<p>Under main function I declared</p>\n\n<pre><code>manageMux.HandleFunc(\"/info\", info)\n</code></pre>\n\n<p>first I log in and redirect from \"/login\" to page \"/\":</p>\n\n<pre><code>func login(w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"GET\" {\n        t, err := template.ParseFiles(\"manage/login.html\")\n        checkError(err)\n        t.Execute(w, nil)\n    } else { //POST\n        r.ParseForm()\n        //do some authentications here\n        http.Redirect(w, r, \"/\", http.StatusFound)\n    }\n}\n</code></pre>\n\n<p>Then I redirect to another page \"/info\" from current page \"/\" (which has only buttons):</p>\n\n<pre><code>func manage(w http.ResponseWriter, r *http.Request) {\n    t, err := template.ParseFiles(\"manage/manage.html\")\n    checkError(err)\n    t.Execute(w, nil)\n    r.ParseForm()\n    if r.Form[\"Button\"] != nil { //to get only POST actions from buttons\n        if r.Form[\"Button\"][0] == \"Log\" {\n            http.Redirect(w, r, \"/info\", http.StatusFound)\n        } \n    }\n}\n</code></pre>\n\n<p>At last, I made a template and would like to show on client side:</p>\n\n<pre><code>const tpl=`stuff inside`\n\ntype InfoDefault struct {\n    //stuff inside\n}\n\nfunc info(w http.ResponseWriter, r *http.Request) {\n    info := InfoDefault{\n        //stuff inside\n    }\n\n    t, err := template.New(\"info\").Parse(tpl)\n    checkError(err)\n    err = t.Execute(os.Stdout, info)\n    checkError(err)\n}\n</code></pre>\n\n<p>Now, the weird thing is, when I click the button on page \"/\", I got the error \"http: multiple response.WriteHeader calls\". At the same time a link called \"found\" shows up on the bottom of my page (weird!), and when I click the link \"found\", I got all my parsed template printed on the server side instead of webpage. </p>\n\n<p>Does anyone know why...? And how to fix the error and print stuff on client webpage? Thank you!!!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1454963545, "last_edit_date": 1454963545, "creation_date": 1454954644, "answer_id": 35276264, "question_id": 35276022, "link": "https://stackoverflow.com/questions/35276022/unexpected-slice-append-behaviour/35276264#35276264", "title": "unexpected slice append behaviour", "body": "<p>If you need a copy of a slice, there's no other way to do it other than, copying the slice. You should almost never assign the result of <code>append</code> to a variable other than the first argument of <code>append</code>. It leads to hard to find bugs, and will behave differently depending on whether the slice has the required capacity or not. </p>\n\n<p>This isn't a commonly needed pattern, but as with all things of this nature if you need to repeate a few lines of code multiple times, then you can use a small helper function:</p>\n\n<pre><code>func copyAndAppend(i []int, vals ...int) []int {\n    j := make([]int, len(i), len(i)+len(vals))\n    copy(j, i)\n    return append(j, vals...)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/J99_xEbaWo\" rel=\"nofollow\">https://play.golang.org/p/J99_xEbaWo</a></p>\n"}, {"comments": [{"owner": {"reputation": 2347, "user_id": 1895600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQ5Kg.png?s=128&g=1", "display_name": "mayankcpdixit", "link": "https://stackoverflow.com/users/1895600/mayankcpdixit"}, "edited": false, "score": 0, "creation_date": 1596463820, "post_id": 35276346, "comment_id": 111811409, "body": "This official blog on slices is worth a read in the same conext: <a href=\"https://blog.golang.org/slices-intro#TOC_5\" rel=\"nofollow noreferrer\">blog.golang.org/slices-intro#TOC_5</a>."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 14, "last_activity_date": 1454959927, "last_edit_date": 1454959927, "creation_date": 1454954939, "answer_id": 35276346, "question_id": 35276022, "link": "https://stackoverflow.com/questions/35276022/unexpected-slice-append-behaviour/35276346#35276346", "title": "unexpected slice append behaviour", "body": "<p>Don't assign <code>append</code> to anything other than itself.</p>\n\n<p>As you mention in the question, the confusion is due to the fact that <code>append</code> both changes the underlying array and returns a new slice (since the length might be changed). You'd imagine that it copies that backing array, but it doesn't, it just allocates a new <code>slice</code> object that points at it. Since <code>i</code> never changes, all those appends keep changing the value of <code>backingArray[12]</code> to a different number.</p>\n\n<p>Contrast this to <code>append</code>ing to an array, which allocates a new literal array every time.</p>\n\n<p>So yes, you need to copy the slice before you can work on it.</p>\n\n<pre><code>func makeFromSlice(sl []int) []int {\n    result := make([]int, len(sl))\n    copy(result, sl)\n    return result\n}\n\nfunc main() {\n    i := make([]int, 0)\n    for ii:=0; ii&lt;11; ii++ {\n        i = append(i, ii)\n    }\n    j := append(makeFromSlice(i), 100)  // works fine\n}\n</code></pre>\n\n<hr>\n\n<p>The slice literal behavior is explained because a new array <strong><em>is</em></strong> allocated if the append would exceed the <code>cap</code> of the backing array. This has nothing to do with slice literals and everything to do with the internals of how exceeding the cap works.</p>\n\n<pre><code>a := []int{1,2,3,4,5,6,7}\nfmt.Printf(\"len(a) %d, cap(a) %d\\n\", a, len(a), cap(a))\n// len(a) 7, cap(a) 7\n\nb := make([]int, 0)\nfor i:=1; i&lt;8, i++ {\n    b = append(b, i)\n}  // b := []int{1,2,3,4,5,6,7}\n// len(b) 7, cap(b) 8\n\nb = append(b, 1)  // any number, just so it hits cap\n\ni := append(b, 100)\nj := append(b, 101)\nk := append(b, 102)  // these work as expected now\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2925035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6d36cf5408dddb6ea5dad38464838e2?s=128&d=identicon&r=PG", "display_name": "Max Manuylov", "link": "https://stackoverflow.com/users/2925035/max-manuylov"}, "is_accepted": false, "score": 0, "last_activity_date": 1508842115, "creation_date": 1508842115, "answer_id": 46908534, "question_id": 35276022, "link": "https://stackoverflow.com/questions/35276022/unexpected-slice-append-behaviour/46908534#46908534", "title": "unexpected slice append behaviour", "body": "<p>There is also a little bit simpler way to implement <code>copyAndAppend</code> function:</p>\n\n<pre><code>func copyAndAppend(source []string, items ...string) []string {\n    l := len(source)\n    return append(source[:l:l], items...)\n}\n</code></pre>\n\n<p>Here we just make sure that source has no available capacity and so copying is forced.</p>\n"}], "owner": {"reputation": 2854, "user_id": 3536963, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a445f4755284f3ec92ee748b43419523?s=128&d=identicon&r=PG&f=1", "display_name": "Jarema", "link": "https://stackoverflow.com/users/3536963/jarema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2800, "favorite_count": 5, "accepted_answer_id": 35276346, "answer_count": 3, "score": 7, "last_activity_date": 1508842115, "creation_date": 1454953708, "question_id": 35276022, "link": "https://stackoverflow.com/questions/35276022/unexpected-slice-append-behaviour", "title": "unexpected slice append behaviour", "body": "<p>I encountered weird behaviour in go code today: when I append <code>elements</code> to <code>slice</code> in loop and then try to create new <code>slices</code> based on the result of the loop, last <code>append</code> overrides <code>slices</code> from previous <code>appends</code>.</p>\n\n<p>In this particular example it means that <code>sliceFromLoop</code> <code>j</code>,<code>g</code> and <code>h</code> slice's last element are not <code>100</code>,<code>101</code> and <code>102</code> respectively, but...always <code>102</code>!</p>\n\n<p>Second example - <code>sliceFromLiteral</code> behaves as expected.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc create(iterations int) []int {\n    a := make([]int, 0)\n    for i := 0; i &lt; iterations; i++ {\n        a = append(a, i)\n    }\n    return a\n}\n\nfunc main() {\n    sliceFromLoop()\n    sliceFromLiteral()\n\n}\n\nfunc sliceFromLoop() {\n    fmt.Printf(\"** NOT working as expected: **\\n\\n\")\n    i := create(11)\n    fmt.Println(\"initial slice: \", i)\n    j := append(i, 100)\n    g := append(i, 101)\n    h := append(i, 102)\n    fmt.Printf(\"i: %v\\nj: %v\\ng: %v\\nh:%v\\n\", i, j, g, h)\n}\n\nfunc sliceFromLiteral() {\n    fmt.Printf(\"\\n\\n** working as expected: **\\n\")\n    i := []int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n    fmt.Println(\"initial slice: \", i)\n    j := append(i, 100)\n    g := append(i, 101)\n    h := append(i, 102)\n    fmt.Printf(\"i: %v\\nj: %v\\ng: %v\\nh:%v\\n\", i, j, g, h)\n}\n</code></pre>\n\n<p>link to play.golang:\n<a href=\"https://play.golang.org/p/INADVS3Ats\" rel=\"noreferrer\">https://play.golang.org/p/INADVS3Ats</a></p>\n\n<p>After some reading, digging and experimenting I found that this problem is originated in <code>slices</code> referencing the same underlaying <code>array</code>  values and can be solved by copying <code>slice</code> to new one before appending anything, however it looks quite... hesitantly.</p>\n\n<p><strong>What's the idomatic way for creating many new slices based on old ones and not worrying about changing values of old slices?</strong></p>\n"}, {"tags": ["go", "parameter-passing"], "comments": [{"owner": {"reputation": 2991, "user_id": 1160051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/00a3da01cf3eef469d5880bd7ef680ed?s=128&d=identicon&r=PG", "display_name": "thewhitetulip", "link": "https://stackoverflow.com/users/1160051/thewhitetulip"}, "edited": false, "score": 0, "creation_date": 1454949339, "post_id": 35274528, "comment_id": 58260735, "body": "It&#39;d be helpful if you posted the rest of the code"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 14, "last_activity_date": 1454953153, "last_edit_date": 1454953153, "creation_date": 1454949379, "answer_id": 35274608, "question_id": 35274528, "link": "https://stackoverflow.com/questions/35274528/return-values-of-function-as-input-arguments-to-another/35274608#35274608", "title": "Return values of function as input arguments to another", "body": "<p>It's described <a href=\"https://golang.org/ref/spec#Calls\" rel=\"noreferrer\">here in the spec</a>. It requires the inner function to return the correct types for all arguments. There is no allowance for extra parameters along with a function that returns multiple values. </p>\n\n<blockquote>\n  <p>As a special case, if the return values of a function or method g are\n  equal in number and individually assignable to the parameters of\n  another function or method f, then the call f(g(parameters_of_g)) will\n  invoke f after binding the return values of g to the parameters of f\n  in order. The call of f must contain no parameters other than the call\n  of g, and g must have at least one return value. If f has a final ...\n  parameter, it is assigned the return values of g that remain after\n  assignment of regular parameters.</p>\n\n<pre><code>func Split(s string, pos int) (string, string) {\n  return s[0:pos], s[pos:]\n}\n\nfunc Join(s, t string) string {\n  return s + t\n}\n\nif Join(Split(value, len(value)/2)) != value {\n  log.Panic(\"test fails\")\n}\n</code></pre>\n</blockquote>\n\n<p>If those specific conditions are not met, then you need to assign the return values and call the function separately.  </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8033910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FjBJWXLBjeg/AAAAAAAAAAI/AAAAAAAAADk/SkarMgh2_pU/photo.jpg?sz=128", "display_name": "Theron", "link": "https://stackoverflow.com/users/8033910/theron"}, "is_accepted": false, "score": 0, "last_activity_date": 1616888272, "last_edit_date": 1616888272, "creation_date": 1616887370, "answer_id": 66837038, "question_id": 35274528, "link": "https://stackoverflow.com/questions/35274528/return-values-of-function-as-input-arguments-to-another/66837038#66837038", "title": "Return values of function as input arguments to another", "body": "<p>I had the same question.  The best solution I could come up with is creating types or structs for my desired extra parameters and writing methods for them like this:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\ntype Message string\n\ntype MessageNumber struct {\n    Message string\n    Number int\n}\n\nfunc testfunc() (foo int, bar int) {\n    foo = 4\n    bar = 2\n    return\n}\n\nfunc (baz Message) testfunc2(foo int, bar int) {\n    fmt.Println(foo, bar, baz)\n}\n\nfunc (baz MessageNumber) testfunc3(foo int, bar int) {\n    fmt.Println(foo, bar, baz.Number, baz.Message)\n}\n\nfunc main() {\n    Message(&quot;the answer&quot;).testfunc2(testfunc())\n    MessageNumber{&quot;what were we talking about again?&quot;, 0}.testfunc3(testfunc())\n    fmt.Println(&quot;Done.  Have a day.&quot;)\n}\n</code></pre>\n<p>The output looks like this:</p>\n<pre><code>user@Frodos-Atari-MEGA-STE:~/go/test$ go run main.go\n4 2 the answer\n4 2 0 what were we talking about again?\nDone.  Have a day.\n</code></pre>\n"}], "owner": {"reputation": 926, "user_id": 2379703, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c95691ed554de6809abeb2a542a0e1e1?s=128&d=identicon&r=PG", "display_name": "jshort", "link": "https://stackoverflow.com/users/2379703/jshort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5737, "favorite_count": 1, "accepted_answer_id": 35274608, "answer_count": 2, "score": 12, "last_activity_date": 1616888272, "creation_date": 1454949090, "last_edit_date": 1601561891, "question_id": 35274528, "link": "https://stackoverflow.com/questions/35274528/return-values-of-function-as-input-arguments-to-another", "title": "Return values of function as input arguments to another", "body": "<p>If I have</p>\n\n<pre><code>func returnIntAndString() (i int, s string) {...}\n</code></pre>\n\n<p>And I have:</p>\n\n<pre><code>func doSomething(i int, s string) {...}\n</code></pre>\n\n<p>Then I can do the following successfully:</p>\n\n<pre><code>doSomething(returnIntAndString())\n</code></pre>\n\n<p>However, let's say I want to add another argument to doSomething like:</p>\n\n<pre><code>func doSomething(msg string, i int, s string) {...}\n</code></pre>\n\n<p>Go complains when compiling if I call it like:</p>\n\n<pre><code>doSomething(\"message\", returnIntAndString())\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>main.go:45: multiple-value returnIntAndString() in single-value context\nmain.go:45: not enough arguments in call to doSomething()\n</code></pre>\n\n<p>Is there a way to do this or should I just give up and assign the return values from <code>returnIntAndString</code> to some references and pass msg and these values like <code>doSomething(msg, code, str)</code> ?</p>\n"}, {"tags": ["php", "json", "curl", "go", "revel"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1454944609, "post_id": 35272392, "comment_id": 58257516, "body": "First: check and handle your errors. Second: what is the code you used with json.Unmarshal?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1454945764, "post_id": 35272392, "comment_id": 58258329, "body": "What does <code>log.Printf(&quot;%q&quot;, content)</code> show? The only thing that encodes to JSON as base64 string is <code>[]byte</code>. Did you forget to decode it first?"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1454946210, "post_id": 35272392, "comment_id": 58258662, "body": "I tryied to use json.Unmarshal([]byte(c.Request.Body), &amp;myStruct) , but it said that go can not convert ..io.Reader to []byte...."}], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1455000750, "post_id": 35273517, "comment_id": 58281837, "body": "Tested your answer, works like a charm. Thank you, guru Gopher =)."}], "tags": [], "owner": {"reputation": 806, "user_id": 2547389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f943f94b1bfe169a3291c5b94b7f938a?s=128&d=identicon&r=PG", "display_name": "wlredeye", "link": "https://stackoverflow.com/users/2547389/wlredeye"}, "is_accepted": true, "score": 4, "last_activity_date": 1454946192, "creation_date": 1454946192, "answer_id": 35273517, "question_id": 35272392, "link": "https://stackoverflow.com/questions/35272392/golang-revel-how-to-parse-post-json/35273517#35273517", "title": "golang, revel, How to parse post json?", "body": "<p>Just use standart <a href=\"https://golang.org/pkg/encoding/json\" rel=\"nofollow\">json</a> Decoder:</p>\n\n<pre><code>   var content []string\n   err := json.NewDecoder(c.Request.Body).Decode(&amp;content)\n   if err != nil {\n       log.Fatal(\"JSON decode error: \", err)\n   }\n   defer c.Request.Body.Close()\n   fmt.Println(content)\n</code></pre>\n"}], "owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 0, "accepted_answer_id": 35273517, "answer_count": 1, "score": 0, "last_activity_date": 1454946192, "creation_date": 1454942781, "question_id": 35272392, "link": "https://stackoverflow.com/questions/35272392/golang-revel-how-to-parse-post-json", "title": "golang, revel, How to parse post json?", "body": "<p>I'm rather new in golang, but I'm trying hard..</p>\n\n<p>I'm trying to send json by post request to the revel controller, and parse it on the revel side. </p>\n\n<p>But while getting the result I cannot Unmarshal it... I'm sending an array </p>\n\n<pre><code>json_encode(array(\"one\",\"two\",\"three\"))\n</code></pre>\n\n<p>But I can't find the correct way to work with such a data. I'm not sure do I need to make json before sending it or not..</p>\n\n<pre><code>func (c KpiCtrl) GetData() revel.Result {\n    content, _ := ioutil.ReadAll(c.Request.Body)\n    ...\n    return c.RenderJson(content)\n    }\n</code></pre>\n\n<p>returns </p>\n\n<pre><code>\"WyJvbmUiLCJ0d28iLCJ0aHJlZSJd\"\n</code></pre>\n\n<p>I tried to use json.Unmarshal but it returns errors.. What is the best practice to work with post data sent by curl to revel controller? </p>\n"}, {"tags": ["mongodb", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "edited": false, "score": 0, "creation_date": 1455093106, "post_id": 35274363, "comment_id": 58329711, "body": "I tried it... But it is not stored in database ... I think the problem is <code>[]users</code>"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "edited": false, "score": 0, "creation_date": 1455139080, "post_id": 35274363, "comment_id": 58361001, "body": "yeah, maybe the type must be upper case, I didn&#39;t think that was true though"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1454948562, "creation_date": 1454948562, "answer_id": 35274363, "question_id": 35269074, "link": "https://stackoverflow.com/questions/35269074/how-to-insert-multiple-values-of-nested-struct-in-mongodb-with-go/35274363#35274363", "title": "How to insert multiple values of nested struct in mongodb with go", "body": "<p>You need to export your sub structs to make this work.</p>\n\n<p>Like this:</p>\n\n<pre><code>type deadLine struct {\n    Start_time  time.Time `bson:\"start_time\"`\n    End_time    time.Time `bson:\"end_time\"`\n}\ntype users struct {\n    Status  string `bson:\"u_status\"`\n    User_name  string `bson:\"u_name\"`\n}\ntype taskData struct {\n    Id bson.ObjectId  `bson:\"_id\"`\n    Task_content string  `bson:\"task_content\"`\n    Priority string  `bson:\"priority\"`\n    DeadLine deadline `bson:\"deadline\"`\n    Users     []users `bson:\"users\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454948562, "creation_date": 1454932536, "question_id": 35269074, "link": "https://stackoverflow.com/questions/35269074/how-to-insert-multiple-values-of-nested-struct-in-mongodb-with-go", "title": "How to insert multiple values of nested struct in mongodb with go", "body": "<p>I am trying to insert multiple values with nested struct in mongodb with golang ... Like this </p>\n\n<pre><code>{  \"_id\" : ObjectId(\"56b879528d04effa4ae2de2c\"), \n   \"task_content\" : \"Some text\",\n   \"priority\" : \"2\", \n   \"deadline\" : { \n      \"start_time\" : ISODate(\"2009-04-04T00:00:00Z\"), \n      \"end_time\" : ISODate(\"2009-05-04T00:00:00Z\") \n   },\n   \"users\" : {\n      \"u_status\" : \"Completed\",\n      \"u_name\" : john_smith,\n      \"u_status\" : \"Completed\",\n      \"u_name\" : harry_potter\n   },\n }\n</code></pre>\n\n<p>Is this possible to do in mongo. i.e. there are same name of keys but the values are different.. Here is Sample code which i tried </p>\n\n<pre><code>type deadLine struct {\n    Start_time  time.Time `bson:\"start_time\"`\n    End_time    time.Time `bson:\"end_time\"`\n  }\n  type users struct {\n    Status  string `bson:\"u_status\"`\n    User_name  string `bson:\"u_name\"`\n  }\n  type taskData struct {\n    Id bson.ObjectId  `bson:\"_id\"`\n    Task_content string  `bson:\"task_content\"`\n    Priority string  `bson:\"priority\"`\n    deadLine\n    users     []users\n\n  }\n\nfunc TaskToDo(w http.ResponseWriter, r *http.Request) {\n    var doc taskData\n    retMap := make(map[string]map[string]string)\n    retMap[\"user\"][\"1\"] = \"john_smith\"\n    retMap[\"user\"][\"2\"] = \"harry_potter\"\n\n    stime, _ := time.Parse(\"2006/01/02\",\"2009-04-04\")\n    etime, _ := time.Parse(\"2006/01/02\",\"2009-05-04\")\n\n\n    doc = taskData{Id: bson.NewObjectId(),\n      Task_content:\"Some text\", Priority:\"2\",\n      deadLine:deadLine{\n        Start_time:stime,\n        End_time:etime,\n      }}\n\n    for i := 1; i &lt;= len(retMap[\"user\"]);i++ {\n      doc.users = append(doc.users, users{\n        User_name : retMap[\"user\"][strconv.Itoa(i)],\n        Status : \"Completed\",\n\n      })\n    }\n    fmt.Println(doc)\n    err := collection.Insert(doc)\n    if err != nil {\n      fmt.Printf(\"Can't insert document: %v\\n\", err)\n      fmt.Fprintf(w,\"%s\",\"Can't insert document:%v\\n\", err)\n      os.Exit(1)\n      }else{\n        fmt.Println(\"Task Inserted Successfully ... \")\n      }\n}\n</code></pre>\n\n<p>Ignore Some basic mistakes in sample code. Kindly help me Thanks in advance </p>\n"}, {"tags": ["go", "channel", "type-assertion"], "answers": [{"comments": [{"owner": {"reputation": 3405, "user_id": 1544576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53b0aece83dac053a4f753f4890ff0e2?s=128&d=identicon&r=PG", "display_name": "ilpaijin", "link": "https://stackoverflow.com/users/1544576/ilpaijin"}, "edited": false, "score": 0, "creation_date": 1454927693, "post_id": 35267384, "comment_id": 58246282, "body": "Oh man! you, right...ahahaha tx! I should always take some fresh air after hours spent on learning something..otherwise I end up making stupid questions like this one."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 3405, "user_id": 1544576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53b0aece83dac053a4f753f4890ff0e2?s=128&d=identicon&r=PG", "display_name": "ilpaijin", "link": "https://stackoverflow.com/users/1544576/ilpaijin"}, "edited": false, "score": 0, "creation_date": 1454932467, "post_id": 35267384, "comment_id": 58249231, "body": "@ilpaijin Whatever you use for development, you might want to change to an IDE to help you spot stuff like that earlier."}, {"owner": {"reputation": 3405, "user_id": 1544576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53b0aece83dac053a4f753f4890ff0e2?s=128&d=identicon&r=PG", "display_name": "ilpaijin", "link": "https://stackoverflow.com/users/1544576/ilpaijin"}, "edited": false, "score": 0, "creation_date": 1454941482, "post_id": 35267384, "comment_id": 58255335, "body": "yep, you&#39;re right. Using Sublime Text, not the appropriate one in these moments. However it&#39;s really a stupid mistake, but I quit smoking 4 days ago, after 24 years of cigarrettes...it&#39;s my excuse..eheh"}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 2, "last_activity_date": 1454927334, "creation_date": 1454927334, "answer_id": 35267384, "question_id": 35267271, "link": "https://stackoverflow.com/questions/35267271/range-over-an-interfaces-and-get-the-channel-field-of-each-type/35267384#35267384", "title": "range over an []interfaces{} and get the channel field of each type", "body": "<blockquote>\n  <p>What I'm trying to understand is why I can get the value of size\n  .GetSize() from both the child structs, but I don't have the same\n  success with the channel field .GetChannel()</p>\n</blockquote>\n\n<pre><code>type Measurable interface {\n    GetSize() int\n}\n\n...\n\nthings := []Measurable{}\nfor _, t := range things {\n    fmt.Printf(\"%+v \\n\", t.GetChannel())\n}\n</code></pre>\n\n<p>I may be missing the point but this seems to be caused strictly by the fact that your <code>Measurable</code> interface doesn't have a <code>GetChannel</code> method.</p>\n"}], "owner": {"reputation": 3405, "user_id": 1544576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53b0aece83dac053a4f753f4890ff0e2?s=128&d=identicon&r=PG", "display_name": "ilpaijin", "link": "https://stackoverflow.com/users/1544576/ilpaijin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 35267384, "answer_count": 1, "score": -1, "last_activity_date": 1454927334, "creation_date": 1454926992, "question_id": 35267271, "link": "https://stackoverflow.com/questions/35267271/range-over-an-interfaces-and-get-the-channel-field-of-each-type", "title": "range over an []interfaces{} and get the channel field of each type", "body": "<p>I'll try to make it as clear as possible, in my head first.</p>\n\n<p>I have an interface and a couple of Types that inherit it by declaring a method. Pretty nice and clever way of inheritance.</p>\n\n<p>I have then a \"super\" Type <code>Thing</code>, which all the other Types embed.</p>\n\n<p>The <code>Thing</code> struct has a Size int and an Out chan properties</p>\n\n<p>What I'm trying to understand is why I can get the value of size <code>.GetSize()</code> from both the child structs, but I don't have the same success with the channel field <code>.GetChannel()</code> (*ndr which I'm using to communicate among goroutines and their caller)</p>\n\n<p>...here I get <code>t.GetChannel undefined (type Measurable has no field or method GetChannel)</code></p>\n\n<p>It might help a demo of the logic:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Measurable interface {\n    GetSize() int\n}\n\ntype Thing struct {\n    Size int\n    Out  chan int\n}\ntype Something struct{ *Thing }\ntype Otherthing struct{ *Thing }\n\nfunc newThing(size int) *Thing {\n    return &amp;Thing{\n        Size: size,\n        Out:  make(chan int),\n    }\n}\nfunc NewSomething(size int) *Something   { return &amp;Something{Thing: newThing(size)} }\nfunc NewOtherthing(size int) *Otherthing { return &amp;Otherthing{Thing: newThing(size)} }\n\nfunc (s *Thing) GetSize() int         { return s.Size }\nfunc (s *Thing) GetChannel() chan int { return s.Out }\n\nfunc main() {\n\n    things := []Measurable{}\n\n    pen := NewSomething(7)\n    paper := NewOtherthing(5)\n\n    things = append(things, pen, paper)\n\n    for _, t := range things {\n        fmt.Printf(\"%T %d \\n\", t, t.GetSize())\n    }\n\n    for _, t := range things {\n        fmt.Printf(\"%+v \\n\", t.GetChannel())\n    }\n\n    // for _, t := range things {\n    // fmt.Printf(\"%+v\", t.Thing.Size)\n    // }\n}\n</code></pre>\n\n<p>The commented code is another thing I'm trying to learn. I can get a value by using a method declared on the super Type, but not by accessing directly from the child one. Sure, I could resolve the type with <code>t.(*bothTheThingTypes).Size</code> but I lose the dinamicity, I'm not fully getting this...</p>\n"}, {"tags": ["google-app-engine", "go", "sendgrid"], "comments": [{"owner": {"reputation": 1165, "user_id": 1379627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HIUPb.jpg?s=128&g=1", "display_name": "Jenny D", "link": "https://stackoverflow.com/users/1379627/jenny-d"}, "edited": false, "score": 0, "creation_date": 1454941529, "post_id": 35267085, "comment_id": 58255371, "body": "It looks as if you&#39;re getting a timeout. Do you get a timeout if you try telneting to port 25 on the mailserver too?"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "reply_to_user": {"reputation": 1165, "user_id": 1379627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HIUPb.jpg?s=128&g=1", "display_name": "Jenny D", "link": "https://stackoverflow.com/users/1379627/jenny-d"}, "edited": false, "score": 0, "creation_date": 1454941997, "post_id": 35267085, "comment_id": 58255717, "body": "I cannot telnet to smtp.sendgrid.net with port 25. But I can telnet if im using another port, 587.. Maybe thats the problem?"}, {"owner": {"reputation": 1165, "user_id": 1379627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HIUPb.jpg?s=128&g=1", "display_name": "Jenny D", "link": "https://stackoverflow.com/users/1379627/jenny-d"}, "edited": false, "score": 0, "creation_date": 1454942219, "post_id": 35267085, "comment_id": 58255871, "body": "Let me rephrase it: if you&#39;re getting a timeout error, start by verifying the connection, not the code. I don&#39;t know this particular service, so I can&#39;t tell you exactly how you should test it - but if you are using SMTP, it&#39;s likely that you&#39;ll have to tell your application to use 587 instead of 25. If you&#39;re using a HTTP/HTTPS API, again, start by verifying connectivity to that port."}, {"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 0, "creation_date": 1454945100, "post_id": 35267085, "comment_id": 58257853, "body": "Just to be annoying: It&#39;s called <i>Go</i> not <i>golang</i>."}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 1, "creation_date": 1454945964, "post_id": 35267085, "comment_id": 58258473, "body": "Golang for browser friendliness, and yes. It&#39;s annoying."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1454949243, "post_id": 35267085, "comment_id": 58260658, "body": "The go library uses https to talk to sendgrid.  Try to telnet to api.sendgrid.com port 443 to see if you can even connect"}, {"owner": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "edited": false, "score": 0, "creation_date": 1454949969, "post_id": 35267085, "comment_id": 58261144, "body": "Which Go version are you using ?"}], "answers": [{"comments": [{"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1458213736, "post_id": 36000129, "comment_id": 59764781, "body": "I haven&#39;t had time to test it. The code is deployed with another solution than sendgrid. I will get back to this whenever I change that solution, and I will do in the future. Many thanks for understanding my problem and offering your solution."}, {"owner": {"reputation": 7084, "user_id": 640277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f57fec5c9a807c0eeff896afb5ad86?s=128&d=identicon&r=PG", "display_name": "Ezra", "link": "https://stackoverflow.com/users/640277/ezra"}, "reply_to_user": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1458229887, "post_id": 36000129, "comment_id": 59777424, "body": "May I ask who your alternate provider is?"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1458232900, "post_id": 36000129, "comment_id": 59779660, "body": "Absolutely. I&#39;m using Google app engines own mail system. The drawback is that I have to create a separate email user to send from &quot;noreply&quot;. But it is even simpler than sendgrid."}, {"owner": {"reputation": 7084, "user_id": 640277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f57fec5c9a807c0eeff896afb5ad86?s=128&d=identicon&r=PG", "display_name": "Ezra", "link": "https://stackoverflow.com/users/640277/ezra"}, "reply_to_user": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1458233307, "post_id": 36000129, "comment_id": 59779943, "body": "Interesting. Thanks! I assume you&#39;re 100% transactional, so it&#39;s not as big a deal, but I&#39;ve found that the &quot;dash&quot; and stats that most dedicated mail providers suppliers is something that I never want to be without. Good luck with your app! Cheers,"}], "tags": [], "owner": {"reputation": 7084, "user_id": 640277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f57fec5c9a807c0eeff896afb5ad86?s=128&d=identicon&r=PG", "display_name": "Ezra", "link": "https://stackoverflow.com/users/640277/ezra"}, "is_accepted": false, "score": 0, "last_activity_date": 1460044261, "last_edit_date": 1460044261, "creation_date": 1457998852, "answer_id": 36000129, "question_id": 35267085, "link": "https://stackoverflow.com/questions/35267085/go-sendgrid-failing/36000129#36000129", "title": "Go sendgrid failing", "body": "<h1>Normal Sendgrid API Usage in Go</h1>\n\n<p>The minimal program to use the Sendgrid API in Go is something like the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/sendgrid/sendgrid-go\"\n)\n\nfunc main() {\n    key := \"SENDGRID_API_KEY\"\n    sg := sendgrid.NewSendGridClientWithApiKey(key)\n\n    message := sendgrid.NewMail()\n    message.AddTo(\"ezra@usefultiftrue.com\")\n    message.SetFrom(\"test@example.org\")\n    message.SetSubject(\"SUBJECT HERE\")\n    message.SetHTML(\"BODY OF THE EMAIL\")\n\n    if r := sg.Send(message); r == nil {\n        fmt.Println(\"Sent!\")\n    } else {\n        fmt.Println(r)\n    }\n}\n</code></pre>\n\n<p>You can see the <a href=\"https://github.com/sendgrid/sendgrid-go\" rel=\"nofollow\">Sendgrid Go Documentation on Github</a>.</p>\n\n<h1>Quirks on App Engine</h1>\n\n<p>The issue is that you're attempting to fetch a Url using the default <code>net/http</code> client, which is not allowed by App Engine. <a href=\"https://cloud.google.com/appengine/docs/go/urlfetch/\" rel=\"nofollow\">You must use <code>urlfetch</code> to make <code>HTTP</code> requests on App Engine.</a></p>\n\n<p>You can solve this by specifying your <code>*http.Client</code> to use <code>urlfetch</code>, since Sendgrid uses a client that uses the disallowed <code>http.DefaultTransport</code> by default. <code>init.failingTransport</code> is a dummy transport method that basically just throws an error.</p>\n\n<p>This is ultimately a simple change. Simply import <code>\"appengine/urlfetch\"</code> and add</p>\n\n<pre><code>client := urlfetch.Client(ctx)\n</code></pre>\n\n<h1>A Complete Example of the SendGrid Go API on App Engine</h1>\n\n<pre><code>package ezralalonde\n\nimport (\n    \"appengine\"\n    \"appengine/urlfetch\"\n    \"fmt\"\n    \"github.com/sendgrid/sendgrid-go\"\n    \"net/http\"\n)\n\nfunc send(w http.ResponseWriter, r *http.Request) {\n    key := \"SENDGRID_API_KEY\"\n    sg := sendgrid.NewSendGridClientWithApiKey(key)\n\n    // must change the net/http client to not use default transport\n    ctx := appengine.NewContext(r)\n    client := urlfetch.Client(ctx)\n    sg.Client = client // &lt;-- now using urlfetch, \"overriding\" default\n\n    message := sendgrid.NewMail()\n    message.AddTo(\"ezra@usefultiftrue.com\")\n    message.SetFrom(\"test@example.org\")\n    message.SetSubject(\"SUBJECT HERE\")\n    message.SetHTML(\"BODY OF THE EMAIL\")\n\n    if e := sg.Send(message); e == nil {\n        fmt.Fprintln(w, \"Sent!\")\n    } else {\n        fmt.Fprintln(w, e)\n    }\n}\n\nfunc init() {\n    http.HandleFunc(\"/\", send)\n}\n</code></pre>\n\n<p>Now each visit to <code>/</code> will cause an email to be sent by SendGrid to <code>test@example.org</code>.</p>\n\n<pre><code>To: test@example.org\nFrom: ezra@usefuliftrue.com\nSubject: SUBJECT HERE\n\nBODY OF THE EMAIL\n</code></pre>\n\n<h1>Please Note</h1>\n\n<p>Do not include your API keys in source code, or commit them to your source control. The above method is not advisable.</p>\n"}], "owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460044261, "creation_date": 1454926478, "last_edit_date": 1457999268, "question_id": 35267085, "link": "https://stackoverflow.com/questions/35267085/go-sendgrid-failing", "title": "Go sendgrid failing", "body": "<p>Im trying to send a mail with sendgrid and golang. \nIm using <code>\"github.com/sendgrid/sendgrid-go\"</code></p>\n\n<p>Whenever I run the part sending email in my code, I get this error:</p>\n\n<pre><code>sendgrid.go: error:net/http: Client Transport of type init.failingTransport doesn't support CancelRequest; Timeout not supported; response:&lt;nil&gt;\n</code></pre>\n\n<p>I cant figure out what it is..</p>\n\n<p>This is my code:</p>\n\n<pre><code>sg := sendgrid.NewSendGridClientWithApiKey(\"string\")\n    email := sendgrid.NewMail()\n    email.AddTo(req.Email)\n    email.SetSubject(\"Confirm your registration at domain\")\n    email.SetFrom(\"noreply@domain.com\")\n    email.SetFromName(\"domain\")\n    email.SetText(url)\n    if r := sg.Send(email); r == nil {\n        log.Infof(ctx, \"email sent\")\n    } else {\n        log.Errorf(ctx, \"email not sent %v\", r)\n        w.WriteHeader(http.StatusInternalServerError)\n        return\n    }\n</code></pre>\n"}, {"tags": ["xml", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 3215282, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5bbeb6d52a2768a4e90d4628a808769?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Polishuk", "link": "https://stackoverflow.com/users/3215282/dmitry-polishuk"}, "edited": false, "score": 0, "creation_date": 1454929361, "post_id": 35266866, "comment_id": 58247363, "body": "Ok, I figured out with headers. However I can&#39;t compare XML. I&#39;m reading body via ioutil.ReadAll or xml.Unmarshal. But how do I know that the body contains any certain element?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 174, "user_id": 3215282, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5bbeb6d52a2768a4e90d4628a808769?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Polishuk", "link": "https://stackoverflow.com/users/3215282/dmitry-polishuk"}, "edited": false, "score": 0, "creation_date": 1454960852, "post_id": 35266866, "comment_id": 58267489, "body": "If you know it actually <b>is</b> wellformed xml than a simple <code>bytes.Contains(&quot;&lt;person&gt;&quot;)</code> could be enough."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1454925919, "creation_date": 1454925919, "answer_id": 35266866, "question_id": 35266687, "link": "https://stackoverflow.com/questions/35266687/golang-compare-xml-structures/35266866#35266866", "title": "Golang: Compare XML structures", "body": "<p>The headers are accessible through <code>http.Response.Header</code> and the body can be read from <code>http.Request.Body</code> e.g. via <code>ioutil.ReadAll</code>. Then you can compare the expected to the actual data via standard means.</p>\n\n<p>But maybe you should explain more where the actual problem is and what you tried and why it failed.</p>\n"}], "owner": {"reputation": 174, "user_id": 3215282, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d5bbeb6d52a2768a4e90d4628a808769?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Polishuk", "link": "https://stackoverflow.com/users/3215282/dmitry-polishuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1079, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1454925919, "creation_date": 1454925437, "question_id": 35266687, "link": "https://stackoverflow.com/questions/35266687/golang-compare-xml-structures", "title": "Golang: Compare XML structures", "body": "<p>I need to write a test to verify server response. Response must contain certain headers and xml body.\nFirst, How can I check that the required headers are present in the response.\n And how can I compare received XML and required XML.</p>\n\n<p>For example. Response must contain header \"Serv\". And body must me contain xml with object \"person\"</p>\n\n<pre><code>HTTP/1.1 200 OK\nConnection: Keep-Alive\nServ: \"any-string\"\nContent-Length: 0\nContent-Type: text/xml; charset=UTF-8\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n\n&lt;person&gt;\n  &lt;name&gt;string-value&lt;/name&gt;\n&lt;/person&gt;\n</code></pre>\n\n<p>How can I check that response contain header \"Serv\" and contain body xml with element person and name</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1454929938, "post_id": 35264892, "comment_id": 58247740, "body": "Why V3? Please provide a citation from the S3 documentation  indicating that &quot;V3&quot; is supported by S3 itself.  To my knowledge, only V2 and V4 are supported by S3."}, {"owner": {"reputation": 31, "user_id": 1442641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770ead6a8022e6689a97f206bd6eda44?s=128&d=identicon&r=PG", "display_name": "Raunak Agarwal", "link": "https://stackoverflow.com/users/1442641/raunak-agarwal"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1455181793, "post_id": 35264892, "comment_id": 58377556, "body": "Thanks Michael. In my use case, I was using v4 and got an error but needed authentication version used prior to that. I thought v3 would be the natural choice for that, didn&#39;t knew that v3 doesn&#39;t exist. Can you help me with the v2 version of Go SDK now? Also let me know where this authentication info has been described."}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1455190192, "post_id": 35264892, "comment_id": 58383398, "body": "<i>In my use case, I was using v4 and got an error but needed authentication version used prior to that.</i> ...I&#39;m not sure the best solution is going to be to use the older version -- S3 regions deployed in 2014 or later only support V4.  Please consider expanding the question to describe the underlying problem rather than how you are trying to solve it.  See <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">xyproblem.info</a>."}], "owner": {"reputation": 31, "user_id": 1442641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770ead6a8022e6689a97f206bd6eda44?s=128&d=identicon&r=PG", "display_name": "Raunak Agarwal", "link": "https://stackoverflow.com/users/1442641/raunak-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455181984, "creation_date": 1454918841, "last_edit_date": 1455181984, "question_id": 35264892, "link": "https://stackoverflow.com/questions/35264892/s3-v3-authentication-go-sdk", "title": "S3 v3 authentication Go SDK", "body": "<p>I want to access S3 using v2 authentication compliant Go SDK(authentication version used prior to v4). While going through the S3 releases, I didn't get any particular release with v3/v2 authentication mentioned in the release documents. \nCan somebody point towards the required Go SDK from amazon or other provider. Also need the relevant client for the same.</p>\n"}, {"tags": ["excel", "google-app-engine", "go", "xlsx"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1454941624, "last_edit_date": 1454941624, "creation_date": 1454918381, "answer_id": 35264787, "question_id": 35264596, "link": "https://stackoverflow.com/questions/35264596/error-when-opening-xlsx-file-made-by-tealeg-xlsx-in-go-language-on-google-app-en/35264787#35264787", "title": "Error when opening XLSX file made by tealeg xlsx in Go language on Google App Engine", "body": "<p>Your last line is completely unnecessary, and it corrupts the Excel file (XLSX is a zip archive):</p>\n\n<pre><code>fmt.Fprint(w, nil)\n</code></pre>\n\n<p>This will print the bytes of the <code>\"&lt;nil&gt;\"</code> string to the web response after you already wrote the content of the Excel file, which I believe you just left there as an accident. Remove that.</p>\n\n<p>Also <a href=\"https://godoc.org/github.com/tealeg/xlsx#File.Write\" rel=\"nofollow\"><code>File.Write()</code></a> returns an <code>error</code>, also check that, for example:</p>\n\n<pre><code>if err = file.Write(w); err != nil {\n    // Handle error, e.g. log it and send back an error response\n}\n</code></pre>\n\n<p>If the error still persists, it's not AppEngine related. I suggest first try the Excel generation locally, saving it to a file using <a href=\"https://godoc.org/github.com/tealeg/xlsx#File.Save\" rel=\"nofollow\"><code>File.Save()</code></a>, e.g.:</p>\n\n<pre><code>if err = file.Save(\"MyXLSXFile.xlsx\"); err != nil {\n    fmt.Println(\"Failed to save file:\", err)\n}\n// If no error, try opening \"MyXLSXFile.xlsx\" on you computer.\n</code></pre>\n\n<p>Also note the comment from the home page of the library:</p>\n\n<blockquote>\n  <p>The support for writing XLSX files is currently extremely minimal. It will expand slowly, but in the meantime patches are welcome!</p>\n</blockquote>\n"}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 0, "accepted_answer_id": 35264787, "answer_count": 1, "score": 1, "last_activity_date": 1454941624, "creation_date": 1454917515, "question_id": 35264596, "link": "https://stackoverflow.com/questions/35264596/error-when-opening-xlsx-file-made-by-tealeg-xlsx-in-go-language-on-google-app-en", "title": "Error when opening XLSX file made by tealeg xlsx in Go language on Google App Engine", "body": "<p>I'm using <a href=\"https://github.com/tealeg/xlsx\" rel=\"nofollow\">https://github.com/tealeg/xlsx</a> to generate xlsx file in Go language. The application is running on Google App Engine.</p>\n\n<pre><code>var file *xlsx.File\nvar sheet *xlsx.Sheet\nvar row *xlsx.Row\nvar cell *xlsx.Cell\nvar err error\n\nfile = xlsx.NewFile()\nsheet, err = file.AddSheet(\"TEST\")\nif err != nil {\n  fmt.Printf(err.Error())\n}\nrow = sheet.AddRow()\ncell = row.AddCell()\ncell.Value = \"I am a cell!\"\n\nw.Header().Set(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\")\nw.Header().Add(\"Content-Disposition\", \"attachment; filename=Test.xlsx\")\nfile.Write(w)\nfmt.Fprint(w, nil)\n</code></pre>\n\n<p>The variable w is http.ResponseWriter.</p>\n\n<p>I have tested this code and the browser downloaded the xlsx file successfully and I can open it with LibreOffice on Linux 64 bit. However when I tried to open the file with Microsoft Excel 2010 on Windows 7 32 bit, it gave me the following error message:-</p>\n\n<blockquote>\n  <p>Excel found unreadable content in 'Test.xlsx'. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.</p>\n</blockquote>\n\n<p>Once I clicked yes, it showed the content \"I am a cell!\" correctly then I clicked on Enable Editing button and it gave me a message:-</p>\n\n<blockquote>\n  <p>Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.</p>\n</blockquote>\n\n<p>How to fix this problem by making Microsoft Excel opens xlsx files generated by tealeg/xlsx without any error message?</p>\n"}, {"tags": ["c", "go", "ldap", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "edited": false, "score": 0, "creation_date": 1454949210, "post_id": 35273693, "comment_id": 58260644, "body": "Thank you @JimB. Appreciate the pointers on where to learn this."}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1455007071, "post_id": 35273693, "comment_id": 58284831, "body": "I wonder if this is 100% safe. From what I could understand in <a href=\"https://github.com/golang/go/issues/12416\" rel=\"nofollow noreferrer\">#12416</a> and <a href=\"https://github.com/golang/go/issues/8310\" rel=\"nofollow noreferrer\">#8310</a>, it is incorrect to pass Go pointer to C function when you don&#39;t know if the Go pointer will be kept by C side.  I don&#39;t expect ldap to do this, but would it not be more safe to C.malloc that pointer (*LDAP, not LDAP)?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1455025945, "post_id": 35273693, "comment_id": 58297278, "body": "@TomaszK\u0142ak: This is fine. #8310 is irrelevant, and was superseded by  #12416. The memory for <code>ldap</code> here is allocated in C when passing a <code>**C.LDAP</code>, where the pointer itself is filled in by the C code, pointing to C memory. The go1.6 cgo checks are enabled by default, and will crash the program rather than allow potentially unsafe behavior."}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1455026117, "post_id": 35273693, "comment_id": 58297425, "body": "Oh, you did check this under 1.6. I know that memory allocated by <code>ldap_initialize</code> was not a problem here. What I was worried about is that <code>ldap_initialize</code> might store adress of Go variable <code>ldap</code> somewhere in some global C value. That would lead to C having pointer to Go value after C call ended."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1455026701, "post_id": 35273693, "comment_id": 58297789, "body": "@TomaszK\u0142ak: My local go build is only a couple days old from master. Even if the value of <code>ldap</code> is stored in C, it&#39;s not a pointer to Go memory. It starts off as <code>nil</code>, and is filled in by the initialize function. So what you have is a pointer value on the Go heap, pointing to C memory, which we&#39;ve deemed safe. It&#39;s just as if <code>ldap_initialize</code> returned an <code>*LDAP</code> which we assign to <code>ldap</code>, but since C doesn&#39;t have multiple return values or exceptions, it&#39;s common to pass a <code>**</code> as a parameter instead."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1454950614, "last_edit_date": 1454950614, "creation_date": 1454946682, "answer_id": 35273693, "question_id": 35263506, "link": "https://stackoverflow.com/questions/35263506/go-cgo-ldap-init-could-not-determine-kind-of-name-for-c-ldap-init/35273693#35273693", "title": "Go cgo ldap_init could not determine kind of name for C.ldap_init", "body": "<p>I would start by getting the basics of Go and cgo working before adding the individual peculiarities of a library like ldap. Some good starting points, especially the official cgo doc page.</p>\n\n<ul>\n<li><a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">https://golang.org/cmd/cgo/</a></li>\n<li><a href=\"http://blog.golang.org/c-go-cgo\" rel=\"nofollow\">http://blog.golang.org/c-go-cgo</a></li>\n<li><a href=\"https://github.com/golang/go/wiki/cgo\" rel=\"nofollow\">https://github.com/golang/go/wiki/cgo</a></li>\n</ul>\n\n<p>Starting from the top:</p>\n\n<p>You don't need the <code>CFLAGS</code> here, but you will need <code>LDFLAGS</code> for the linker, and <code>liblber</code> for this to run. </p>\n\n<pre><code>#cgo LDFLAGS: -lldap -llber\n</code></pre>\n\n<p>You can't pass a pointer to a Go string as a C <code>*char</code>, they are different types. Strings in Go actually aren't addressable at all, so this would be a compile error if the build process got that far. Use <code>C.CString</code>, and <code>C.free</code> if you need to create C strings. You will also need to include <code>stdlib.h</code> for <code>C.free</code>. </p>\n\n<pre><code>    url := C.CString(os.Args[1])\n    defer C.free(unsafe.Pointer(url))\n</code></pre>\n\n<p>Go's <code>int</code> size varies by architecture, and is not C's <code>int</code> type. <code>ldap_port</code> in your example is converted to the default type of <code>int</code>, where you would have needed <code>C.int</code>.</p>\n\n<p>Finally, the original error in your question has nothing to do with Go or cgo. The <code>ldap_init</code> function is deprecated, and does not exist without setting <code>LDAP_DEPRECATED</code>. You should use the <code>ldap_initialize</code> function. Here is a minimal example that compiles:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"unsafe\"\n)\n\n/*\n#include &lt;stdlib.h&gt;\n#include &lt;ldap.h&gt;\n\n#cgo LDFLAGS: -lldap -llber\n*/\nimport \"C\"\n\nfunc main() {\n    url := C.CString(\"ldap://127.0.0.1:389/\")\n    defer C.free(unsafe.Pointer(url))\n\n    var ldap *C.LDAP\n\n    rv := C.ldap_initialize(&amp;ldap, url)\n    if rv != 0 {\n        log.Fatalf(\"ldap_initialize() error %d\", rv)\n    }\n    log.Println(\"initialized\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3978, "favorite_count": 0, "accepted_answer_id": 35273693, "answer_count": 1, "score": 0, "last_activity_date": 1454950614, "creation_date": 1454912537, "last_edit_date": 1454946826, "question_id": 35263506, "link": "https://stackoverflow.com/questions/35263506/go-cgo-ldap-init-could-not-determine-kind-of-name-for-c-ldap-init", "title": "Go cgo ldap_init could not determine kind of name for C.ldap_init", "body": "<p>I was trying to learn and understand cgo. \nI am writing a program in Go where I connect to AD and parse the output. I tested the code in C, which is working fine as expected. The relevant part in <code>C</code> is</p>\n\n<pre><code>char *ldap_host = \"x.x.x.x\";\nint   ldap_port     = 389;\nldap = ldap_init(ldap_host, ldap_port)) \n</code></pre>\n\n<p>Now I am trying to get the same working in go as</p>\n\n<pre><code>//#cgo CFLAGS: -lldap \n//#include &lt;ldap.h&gt;\nimport \"C\"\nfunc main() {\n    var hostname *string\n    hostname = &amp;os.Args[1]\n    ldap_port := 389\n    ldap := C.ldap_init(*hostname, ldap_port)\n}\n</code></pre>\n\n<p>But I am getting the following error</p>\n\n<pre><code>could not determine kind of name for C.ldap_init\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1454914555, "creation_date": 1454914555, "answer_id": 35263907, "question_id": 35262837, "link": "https://stackoverflow.com/questions/35262837/go-goroutine-with-channel-strange-result/35263907#35263907", "title": "Go goroutine with channel strange result", "body": "<blockquote>\n  <p>The Go Programming Language</p>\n  \n  <p><a href=\"https://golang.org/doc/faq\">Frequently Asked Questions (FAQ)</a></p>\n  \n  <p><a href=\"https://golang.org/doc/faq#closures_and_goroutines\">What happens with closures running as goroutines?</a></p>\n  \n  <p>Some confusion may arise when using closures with concurrency.\n  Consider the following program:</p>\n\n<pre><code>func main() {\n    done := make(chan bool)\n\n    values := []string{\"a\", \"b\", \"c\"}\n    for _, v := range values {\n        go func() {\n            fmt.Println(v)\n            done &lt;- true\n        }()\n    }\n\n    // wait for all goroutines to complete before exiting\n    for _ = range values {\n        &lt;-done\n    }\n}\n</code></pre>\n  \n  <p>One might mistakenly expect to see a, b, c as the output. What you'll\n  probably see instead is c, c, c. This is because each iteration of the\n  loop uses the same instance of the variable v, so each closure shares\n  that single variable. When the closure runs, it prints the value of v\n  at the time fmt.Println is executed, but v may have been modified\n  since the goroutine was launched. To help detect this and other\n  problems before they happen, run go vet.</p>\n  \n  <p>To bind the current value of v to each closure as it is launched, one\n  must modify the inner loop to create a new variable each iteration.\n  One way is to pass the variable as an argument to the closure:</p>\n\n<pre><code>for _, v := range values {\n    go func(u string) {\n        fmt.Println(u)\n        done &lt;- true\n    }(v)\n}\n</code></pre>\n  \n  <p>In this example, the value of v is passed as an argument to the\n  anonymous function. That value is then accessible inside the function\n  as the variable u.</p>\n  \n  <p>Even easier is just to create a new variable, using a declaration\n  style that may seem odd but works fine in Go:</p>\n\n<pre><code>for _, v := range values {\n    v := v // create a new 'v'.\n    go func() {\n        fmt.Println(v)\n        done &lt;- true\n    }()\n}\n</code></pre>\n</blockquote>\n\n<p>Therefore, in your case, create a new variable by adding the statement <code>j := j</code>, </p>\n\n<pre><code>for j := 0; j &lt; MAX_TH; j++ {\n    j := j\n    go func() { getWebPageContent(\"http://www.example.com\", messages, j) }()\n}\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc getWebPageContent(url string, c chan int, val int) interface{} {\n    if r, err := http.Get(url); err == nil {\n        defer r.Body.Close()\n        if body, err := ioutil.ReadAll(r.Body); err == nil {\n            c &lt;- val\n            return string(body)\n        }\n    } else {\n        fmt.Println(err)\n    }\n    return \"XoX\"\n}\n\nconst MAX_TH = 40\n\nfunc main() {\n\n    // pln := fmt.Println\n    messages := make(chan int)\n    for j := 0; j &lt; MAX_TH; j++ {\n        j := j\n        go func() { getWebPageContent(\"http://www.example.com\", messages, j) }()\n    }\n\n    routine_count := 0\n    var page_number int\n    for {\n        page_number = &lt;-messages\n        routine_count++\n        fmt.Println(\"Page number: \", page_number)\n        if routine_count == MAX_TH {\n            break\n        }\n    }\n    close(messages)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Page number:  23\nPage number:  6\nPage number:  1\nPage number:  3\nPage number:  28\nPage number:  32\nPage number:  18\nPage number:  22\nPage number:  0\nPage number:  36\nPage number:  7\nPage number:  21\nPage number:  12\nPage number:  2\nPage number:  5\nPage number:  4\nPage number:  33\nPage number:  13\nPage number:  20\nPage number:  27\nPage number:  29\nPage number:  8\nPage number:  31\nPage number:  10\nPage number:  17\nPage number:  25\nPage number:  19\nPage number:  35\nPage number:  14\nPage number:  38\nPage number:  15\nPage number:  30\nPage number:  37\nPage number:  39\nPage number:  26\nPage number:  9\nPage number:  16\nPage number:  11\nPage number:  24\nPage number:  34\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1454934147, "post_id": 35264758, "comment_id": 58250282, "body": "You should have read my answer. The answer you posted is in the FAQ that I posted: &quot;To bind the current value of v to each closure as it is launched, one must modify the inner loop to create a new variable each iteration. One way is to pass the variable as an argument to the closure.&quot; The example is the second code fragment in the FAQ."}, {"owner": {"reputation": 1867, "user_id": 780157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8456225507a9cd4fd3abdbf8922a4be2?s=128&d=identicon&r=PG", "display_name": "defectus", "link": "https://stackoverflow.com/users/780157/defectus"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1454935010, "post_id": 35264758, "comment_id": 58250798, "body": "So your answer needs a &#39;tl;dr&#39; section then :-)"}], "tags": [], "owner": {"reputation": 1867, "user_id": 780157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8456225507a9cd4fd3abdbf8922a4be2?s=128&d=identicon&r=PG", "display_name": "defectus", "link": "https://stackoverflow.com/users/780157/defectus"}, "is_accepted": false, "score": 1, "last_activity_date": 1454918232, "creation_date": 1454918232, "answer_id": 35264758, "question_id": 35262837, "link": "https://stackoverflow.com/questions/35262837/go-goroutine-with-channel-strange-result/35264758#35264758", "title": "Go goroutine with channel strange result", "body": "<p>My first golang reply, may be completely off :-)</p>\n\n<p>The loop could probably look like this:</p>\n\n<pre><code>...\nfor j := 0; j &lt; MAX_TH; j++ {\n    go func(x) { getWebPageContent(\"http://www.example.com\", messages, x) }(j)\n}\n...\n</code></pre>\n\n<p>Basically, you define an anonymous function and call it with a parameter. You could do it differently but this solution looks very functional and sleek :-)</p>\n"}], "owner": {"reputation": 96, "user_id": 5835030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262a32b19a5ce77da319a2f3991c4e5c?s=128&d=identicon&r=PG&f=1", "display_name": "WinterCoder", "link": "https://stackoverflow.com/users/5835030/wintercoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 35263907, "answer_count": 2, "score": 0, "last_activity_date": 1454918232, "creation_date": 1454909117, "last_edit_date": 1454915344, "question_id": 35262837, "link": "https://stackoverflow.com/questions/35262837/go-goroutine-with-channel-strange-result", "title": "Go goroutine with channel strange result", "body": "<p>When i run the goroutines, i generally get 40 as value, i know its about the concurrency but why is the last number coming? I suppose the output must be:</p>\n\n<pre><code>Page number:  34  \nPage number:  12  \nPage number:  8  \nPage number:  2  \nPage number:  29\n</code></pre>\n\n<p><strong>example source code</strong>: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc getWebPageContent(url string, c chan int, val int) interface{} {\n\n    if r, err := http.Get(url); err == nil {\n        defer r.Body.Close()\n        if body, err := ioutil.ReadAll(r.Body); err == nil {\n            c &lt;- val\n            return string(body)\n        }\n    } else {\n        fmt.Println(err)\n    }\n    return \"XoX\"\n\n}\n\nconst MAX_TH = 40\n\nfunc main() {\n\n    // pln := fmt.Println\n    messages := make(chan int)\n    for j := 0; j &lt; MAX_TH; j++ {\n        go func() { getWebPageContent(\"http://www.example.com\", messages, j) }()\n    }\n\n    routine_count := 0\n    var page_number int\n    for {\n        page_number = &lt;-messages\n        routine_count++\n        fmt.Println(\"Page number: \", page_number)\n        if routine_count == MAX_TH {\n            break\n        }\n    }\n    close(messages)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "edited": false, "score": 0, "creation_date": 1454905650, "post_id": 35262320, "comment_id": 58236568, "body": "Interesting, is there an example I can follow?"}, {"owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "edited": false, "score": 0, "creation_date": 1454965891, "post_id": 35262320, "comment_id": 58270439, "body": "Would you know how I can choose one particular value from the list and read it into a variable to be processed? For example can I put the value 1 into a variable called &quot;value1&quot; and then run a if else statement on &quot;value1&quot;?"}], "tags": [], "owner": {"reputation": 64, "user_id": 5895901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7178ce8f8878864a9daf3171a5973c98?s=128&d=identicon&r=PG&f=1", "display_name": "lk81", "link": "https://stackoverflow.com/users/5895901/lk81"}, "is_accepted": true, "score": 3, "last_activity_date": 1454905859, "last_edit_date": 1454905859, "creation_date": 1454905433, "answer_id": 35262320, "question_id": 35262274, "link": "https://stackoverflow.com/questions/35262274/want-to-choose-a-random-number-and-not-have-it-picked-again-until-all-numbers-ha/35262320#35262320", "title": "Want to choose a random number and not have it picked again until all numbers have gone through", "body": "<p>You can use <code>rand.Perm(6)</code> and then loop through the result.</p>\n\n<p>For example, here is code to print the numbers 1-6 in a random order, with no repeats:</p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"math/rand\"\n\nfunc main(){\n    list := rand.Perm(6);\n    for i, _ := range list {\n        fmt.Printf(\"%d\\n\", list[i]+1);\n    }\n}\n</code></pre>\n\n<p>Note that we've added 1 to everything, since <code>Perm(6)</code> returns 0-5 and you want 1-6. After you've used all six, call <code>rand.Perm(6)</code> again for six new numbers.</p>\n"}], "owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 35262320, "answer_count": 1, "score": 1, "last_activity_date": 1454908039, "creation_date": 1454905109, "last_edit_date": 1454908039, "question_id": 35262274, "link": "https://stackoverflow.com/questions/35262274/want-to-choose-a-random-number-and-not-have-it-picked-again-until-all-numbers-ha", "title": "Want to choose a random number and not have it picked again until all numbers have gone through", "body": "<p>I'm looking to pick a random number from 1-6 but if for example 1 is picked by the program I want to make sure it is not again used until 2-6 has been picked. I want to do this in order to have a chance to go through all options instead of having the same option 2 or maybe 3 times in a row since there are only 6 options. Any ideas please?</p>\n\n<pre><code>//choose random number for recipe\nrand.Seed(time.Now().UTC().UnixNano())\nmyrand := random(1, 6)\nfmt.Println(myrand)\n</code></pre>\n\n<p>...</p>\n\n<p>function that processes it</p>\n\n<pre><code>//random number function\nfunc random(min, max int) int {\n    return rand.Intn(max-min) + min\n</code></pre>\n\n<p>}</p>\n\n<p>The part of my program that uses myrand from each run is used in a if statement and is tied to the recipe that will be picked for the day</p>\n\n<pre><code>//choose random number for recipe\nrand.Seed(time.Now().UTC().UnixNano())\nmyrand := random(1, 6)\nfmt.Println(myrand)\n\n//test below of random replacement\nlist := rand.Perm(6)\nfor i, _ := range list {\n    fmt.Printf(\"%d\\n\", list[i]+1)\n}\n\n//logic for recipe to choose\nif myrand == 1 {\n    fmt.Println(1)\n    printRecipeOfTheDay(recipe1)\n} else if myrand == 2 {\n    fmt.Println(2)\n    printRecipeOfTheDay(recipe2)\n} else if myrand == 3 {\n    fmt.Println(3)\n    printRecipeOfTheDay(recipe3)\n} else if myrand == 4 {\n    fmt.Println(4)\n}\n</code></pre>\n\n<p>}</p>\n\n<p>I'm wondering if I'm doing something incorrectly ? I'm not sure how I can use the list on every run to generate a new number (myrand) and the program will be able to remember what the last number (myrand) was when it ran the previous time?</p>\n"}, {"tags": ["optimization", "memory-management", "go", "garbage-collection"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 2, "creation_date": 1454892591, "post_id": 35260745, "comment_id": 58234292, "body": "Have you actually ran into a problem with the GC? profile first. check <a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">blog.golang.org/profiling-go-programs</a>"}, {"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 1, "creation_date": 1454905592, "post_id": 35260745, "comment_id": 58236554, "body": "The reason this topic isn&#39;t discussed more is that it really isn&#39;t that important. Sane programming practices avoid the vast majority of GC problems, and if problems arise, they&#39;re easily detected by profiling your code. Using unsafe for pointer casting is... excessive."}, {"owner": {"reputation": 5900, "user_id": 698632, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/iCuMO.jpg?s=128&g=1", "display_name": "Dakusan", "link": "https://stackoverflow.com/users/698632/dakusan"}, "edited": false, "score": 0, "creation_date": 1454908317, "post_id": 35260745, "comment_id": 58237247, "body": "I understand profiling first before spending a lot of time optimizing. It bugs me though to not understand exactly how something I am coding is working in the background. I know I could go look in the go source, but that is a bit daunting. And it&#39;s not that excessive IMO to write MyFile.Write(S2B(&quot;Example&quot;)) as opposed to MyFile.Write([]byte(&quot;Example&quot;)) - in which S2B does the pointer cast, and there is not an extra allocation for the string to write it to the file. For small strings, it&#39;s NBD. But when you have a 10MB utf8 string you just want to write to the file, it makes more sense."}], "answers": [{"comments": [{"owner": {"reputation": 5900, "user_id": 698632, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/iCuMO.jpg?s=128&g=1", "display_name": "Dakusan", "link": "https://stackoverflow.com/users/698632/dakusan"}, "edited": false, "score": 0, "creation_date": 1454894529, "post_id": 35261184, "comment_id": 58234644, "body": "I don&#39;t spend large amounts of time optimizing. I just adhere to best practices while coding, so it doesn&#39;t take me any extra time. I just like to get things right the first time, so it doesn&#39;t have to be rewritten later.  And while I am not writing code on a google/facebook level, properly optimizing a software process could cut the amount of servers needed to run something by magnitudes. Just a 10% optimization when you have millions of servers means you have 100,000 servers you can now use to expand or use elsewhere."}, {"owner": {"reputation": 5900, "user_id": 698632, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/iCuMO.jpg?s=128&g=1", "display_name": "Dakusan", "link": "https://stackoverflow.com/users/698632/dakusan"}, "edited": false, "score": 0, "creation_date": 1454894735, "post_id": 35261184, "comment_id": 58234681, "body": "And I can tell you already know all this stuff with your reputation level, but a real world example happened to me just last month. I had a client spend ~$2,000 on server costs when he could have spent just $20 if his programmer had optimized right."}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 0, "creation_date": 1454962542, "post_id": 35261184, "comment_id": 58268510, "body": "I have to disagree with buying a bigger computer being &quot;often&quot; the best optimization. Take any algoritms course and one of the first things you&#39;ll hear is &quot;often a well designed algorithm makes the difference between solving a problem and not being able to solve it in a reasonable amount of time, rather than more computing power&quot;."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 6, "last_activity_date": 1454894395, "last_edit_date": 1454894395, "creation_date": 1454894022, "answer_id": 35261184, "question_id": 35260745, "link": "https://stackoverflow.com/questions/35260745/how-do-i-efficiently-structure-a-golang-program-for-optimum-garbage-collector-ru/35261184#35261184", "title": "How do I efficiently structure a golang program for optimum garbage collector runs?", "body": "<p>If it were a simple matter of a list of do's and don'ts we could simply write a program to optimize memory usage.</p>\n\n<p>The first step is to write correct, well-designed, maintainable, and easy-to-read code.</p>\n\n<p>Next, using Go's testing package, benchmark critical functions. For example. a real case,</p>\n\n<pre><code>BenchmarkOriginal      30000     44349 ns/op       52792 B/op      569 allocs/op\n</code></pre>\n\n<p>Use Go's profile tool. Read the source and executable code to see what is going on. </p>\n\n<p>Implement strategies, such a single underlying array and full slice expressions, to reduce GC memory allocations and CPU time. Run a final benchmark.</p>\n\n<pre><code>BenchmarkOptimized    100000     13198 ns/op       32992 B/op        3 allocs/op\n</code></pre>\n\n<p>In this case, 569 allocations of the elements of a triangular array were reduced to 3 allocations, a 99% reduction in allocations with a corresponding 70% reduction in CPU time. There's a lot less for the garbage collector (GC) to do too.</p>\n\n<p>Of course, this made the code harder to read (more complex and more obscure) and thus harder to maintain. </p>\n\n<p>Don't over optimize. Do you really have nothing better to do? The best optimization is often buying a bigger computer.</p>\n"}], "owner": {"reputation": 5900, "user_id": 698632, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/iCuMO.jpg?s=128&g=1", "display_name": "Dakusan", "link": "https://stackoverflow.com/users/698632/dakusan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 3, "answer_count": 1, "score": 5, "last_activity_date": 1454894395, "creation_date": 1454889681, "question_id": 35260745, "link": "https://stackoverflow.com/questions/35260745/how-do-i-efficiently-structure-a-golang-program-for-optimum-garbage-collector-ru", "title": "How do I efficiently structure a golang program for optimum garbage collector runs?", "body": "<p>Optimizing code for better results in the golang GC seems to be more of a rather important thing recently with the strongly time-optimized GC runs. I was recently told how much it accomplishes in a run \"depends on your pattern of heap memory usage.\", but I'm not really sure exactly what that means/entails from the perspective of a programmer in the language. Or is that not something that can easily be controlled?</p>\n\n<p>I have read through the recent book \"The Go Programming Language\" by Brian W. Kernighan, but there is nothing about this topic in it. And all information on this topic on the internet are from years ago, so don't really apply.</p>\n\n<p>Some things I currently do include:</p>\n\n<ul>\n<li>Making sure pointers/objects are only ever stored/remembered where they need to be</li>\n<li>Allocating objects with capacities of what are expected or are sane</li>\n<li>Not duplicating data</li>\n<li>When able, using streaming data through functions instead of putting all data into a big heap up front.</li>\n</ul>\n\n<p>I am also a bit annoyed by the fact that strings and byte arrays are always recreated when converting between one or the other (due to strings being immutable). So when I am going from one to the other, and its a safe operation, I just recast their pointers to the other type using unsafe.</p>\n\n<p>Are all of these practices worth it to help the GC run faster and clear more? Is there anything else I could do?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1454889399, "post_id": 35260122, "comment_id": 58233613, "body": "<code>Don&#39;t use generic names such as &quot;me&quot;, &quot;this&quot; or &quot;self&quot;, identifiers typical of object-oriented languages that place more emphasis on methods as opposed to functions.</code>   - <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#receiver-names\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/CodeReviewComments#receiver-names</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": false, "score": 0, "last_activity_date": 1454887000, "last_edit_date": 1495535304, "creation_date": 1454887000, "answer_id": 35260407, "question_id": 35260122, "link": "https://stackoverflow.com/questions/35260122/how-can-i-make-this-object-mapping-more-dry-and-reusable-in-go/35260407#35260407", "title": "How can I make this object mapping more dry and reusable in Go?", "body": "<p>You probably want to use an ORM.\nThey eliminate a lot of the boilerplate code you're describing.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/1152299/what-is-an-object-relational-mapping-framework\">this question</a> for \"What is an ORM?\"</p>\n\n<p>Here is a list of ORMs for go: <a href=\"https://github.com/avelino/awesome-go#orm\" rel=\"nofollow noreferrer\">https://github.com/avelino/awesome-go#orm</a></p>\n\n<p>I have never used one myself, so I can't recommend any. The main reason is that an ORM takes a lot of control from the developer and introduces a non-negligible performance overhead. You need to see for yourself if they fit your use-case and/or if you are comfortable with the \"magic\" that's going on in those libraries.</p>\n"}, {"comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1454934920, "post_id": 35260513, "comment_id": 58250744, "body": "I don&#39;t quite understand the Identifiable interface. How would you use it in practice with the Save() function? Thanks by the way!"}], "tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1454888170, "last_edit_date": 1454888170, "creation_date": 1454887753, "answer_id": 35260513, "question_id": 35260122, "link": "https://stackoverflow.com/questions/35260122/how-can-i-make-this-object-mapping-more-dry-and-reusable-in-go/35260513#35260513", "title": "How can I make this object mapping more dry and reusable in Go?", "body": "<p><strong>I don't recommend doing this, i personally would prefer being explicit about scanning into structs and creating queries.</strong> </p>\n\n<p>But if you really want to stick to reflection you could do:</p>\n\n<pre><code>func ByUnique(obj interface{}, column string, value interface{}) error {\n    // ...\n    return sql.DB.QueryRowx(query, value).StructScan(obj)\n}\n\n// Call with\nmessage := &amp;Message{}\nByUnique(message, ...)\n</code></pre>\n\n<p>And for your save:</p>\n\n<pre><code>type Identifiable interface {\n    Id() int64\n}\n\n// Implement Identifiable for message, etc.\n\nfunc Save(obj Identifiable) error {\n    // ...\n}\n\n// Call with\nSave(message)\n</code></pre>\n\n<p><strong>The approach i use and would recommend to you:</strong></p>\n\n<pre><code>type Redirect struct {\n    ID        string\n    URL       string\n    CreatedAt time.Time\n}\n\nfunc FindByID(db *sql.DB, id string) (*Redirect, error) {\n    var redirect Redirect\n\n    err := db.QueryRow(\n        `SELECT \"id\", \"url\", \"created_at\" FROM \"redirect\" WHERE \"id\" = $1`, id).\n        Scan(&amp;redirect.ID, &amp;redirect.URL, &amp;redirect.CreatedAt)\n\n    switch {\n    case err == sql.ErrNoRows:\n        return nil, nil\n    case err != nil:\n        return nil, err\n    }\n\n    return &amp;redirect, nil\n}\n\nfunc Save(db *sql.DB, redirect *Redirect) error {\n    redirect.CreatedAt = time.Now()\n\n    _, err := db.Exec(\n        `INSERT INTO \"redirect\" (\"id\", \"url\", \"created_at\") VALUES ($1, $2, $3)`,\n        redirect.ID, redirect.URL, redirect.CreatedAt)\n\n    return err\n}\n</code></pre>\n\n<p>This has the advantage of using the type system and mapping only things it should actually map.</p>\n"}, {"comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1454929971, "post_id": 35261159, "comment_id": 58247758, "body": "I didn&#39;t quite understand the last Save function. How come you pass in an identifier argument in the function? is it not possible to extract the id from the source? Like source.id. Or would the syntax be different since it is an interface?"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1454930434, "post_id": 35261159, "comment_id": 58248046, "body": "@Alex sure, you could easily create an Identifier protocol. I originally wrote it that way, but it added another layer and I didn&#39;t know if all your items had an Id field. Either way would be fine."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1454935098, "post_id": 35261159, "comment_id": 58250856, "body": "I still do not understand how I would use it inside the Save() function. Sorry, but it takes some extra explanation for me to fully understand how you would use the identifier inside the Save function, and how you would use an Identifier protocol. Thanks for the help I really appreciate the help!"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1454939882, "post_id": 35261159, "comment_id": 58254222, "body": "I am using &quot;github.com/jmoiron/sqlx&quot;. But in the code above you first do: if source.Id == 0, and then later on you do if source.Id() == 0. Why do you use two different ways of checking the id? I also do not understand why you have a setId method when you do: source.Id = lastId, in the code."}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1454940102, "post_id": 35261159, "comment_id": 58254368, "body": "Sorry; that should have been <code>source.Id()</code> and <code>source.SetId(lastId)</code>. Fixed."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1454940352, "post_id": 35261159, "comment_id": 58254541, "body": "Thank you! This is awesome!"}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 0, "last_activity_date": 1454940057, "last_edit_date": 1454940057, "creation_date": 1454893848, "answer_id": 35261159, "question_id": 35260122, "link": "https://stackoverflow.com/questions/35260122/how-can-i-make-this-object-mapping-more-dry-and-reusable-in-go/35261159#35261159", "title": "How can I make this object mapping more dry and reusable in Go?", "body": "<p>Your <code>ByUnique</code> is almost generic already. Just pull out the piece that varies (the table and destination):</p>\n\n<pre><code>func ByUnique(table string, column string, value interface{}, dest interface{}) error {\n    query := fmt.Sprintf(`\n            SELECT *\n            FROM %s\n            WHERE %s = ?\n            LIMIT 1;\n        `, table, column)\n\n    return sql.DB.QueryRowx(query, value).StructScan(dest)\n}\n\nfunc ByUniqueMessage(column string, value interface{}) (*Message, error) {\n    message := &amp;Message{}\n    if err := ByUnique(\"message\", column, value, &amp;message); err != nil {\n        return nil, err\n    }\n    return message, error\n}\n</code></pre>\n\n<p>Your <code>save</code> is very similar. You just need to make a generic save function along the lines of:</p>\n\n<pre><code>func Save(table string, identifier int64, source interface{}) { ... }\n</code></pre>\n\n<p>Then inside of <code>(*Message)save</code>, you'd just call the general <code>Save()</code> function. Looks pretty straightforward.</p>\n\n<p>Side notes: do not use <code>this</code> as the name of the object inside a method. See the link from @OneOfOne for more on that. And do not get obsessed about DRY. It is not a goal in itself. Go focuses on code being simple, clear, and reliable. Do not create something complicated and fragile just to avoid typing a simple line of error handling. This doesn't mean that you shouldn't extract duplicated code. It just means that in Go it is usually better to repeat simple code a little bit rather than create complicated code to avoid it.</p>\n\n<hr>\n\n<p>EDIT: If you want to implement <code>Save</code> using an interface, that's no problem. Just create an <code>Identifier</code> interface.</p>\n\n<pre><code>type Ider interface {\n    Id() int64\n    SetId(newId int64)\n}\n\nfunc (msg *Message) Id() int64 {\n    return msg.Id\n}\n\nfunc (msg *Message) SetId(newId int64) {\n    msg.Id = newId\n}\n\nfunc Save(table string, source Ider) error {\n    s := \"\"\n    if source.Id() == 0 {\n        s = fmt.Sprintf(\"INSERT INTO %s SET %%s;\", table)\n    } else {\n        s = fmt.Sprintf(\"UPDATE %s SET %%s WHERE id=:id;\", table)\n    }\n    query := fmt.Sprintf(s, sql.PlaceholderPairs(source))\n\n    nstmt, err := sql.DB.PrepareNamed(query)\n    if err != nil {\n        return err\n    }\n\n    res, err := nstmt.Exec(source)\n    if err != nil {\n        return err\n    }\n\n    if source.Id() == 0 {\n        lastId, err := res.LastInsertId()\n        if err != nil {\n            return err\n        }\n        source.SetId(lastId)\n    }\n\n    return nil\n}\n\nfunc (msg *Message) save() error {\n    return Save(\"message\", msg)\n}\n</code></pre>\n\n<p>The one piece that might blow up with this is the call to <code>Exec</code>. I don't know what package you're using, and it's possible that <code>Exec</code> won't work correctly if you pass it an interface rather than the actual struct, but it probably will work. That said, I'd probably just pass the identifier rather than adding this overhead.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 35261159, "answer_count": 3, "score": 0, "last_activity_date": 1454940057, "creation_date": 1454885240, "question_id": 35260122, "link": "https://stackoverflow.com/questions/35260122/how-can-i-make-this-object-mapping-more-dry-and-reusable-in-go", "title": "How can I make this object mapping more dry and reusable in Go?", "body": "<p>I have created an object mapping in Go that is not relational, it is very simple.</p>\n\n<p>I have several structs that looks like this:</p>\n\n<pre><code>type Message struct {\n    Id       int64\n    Message  string\n    ReplyTo  sql.NullInt64 `db:\"reply_to\"`\n    FromId   int64         `db:\"from_id\"`\n    ToId     int64         `db:\"to_id\"`\n    IsActive bool          `db:\"is_active\"`\n    SentTime int64         `db:\"sent_time\"`\n    IsViewed bool          `db:\"is_viewed\"`\n\n    Method   string `db:\"-\"`\n    AppendTo int64  `db:\"-\"`\n}\n</code></pre>\n\n<p>To create a new message I just run this function:</p>\n\n<pre><code>func New() *Message {\n    return &amp;Message{\n        IsActive: true,\n        SentTime: time.Now().Unix(),\n        Method:   \"new\",\n    }\n}\n</code></pre>\n\n<p>And then I have a message_crud.go file for this struct that looks like this:</p>\n\n<p>To find a message by a unique column (for example by id) I run this function:</p>\n\n<pre><code>func ByUnique(column string, value interface{}) (*Message, error) {\n\n    query := fmt.Sprintf(`\n        SELECT *\n        FROM message\n        WHERE %s = ?\n        LIMIT 1;\n    `, column)\n\n    message := &amp;Message{}\n    err := sql.DB.QueryRowx(query, value).StructScan(message)\n    if err != nil {\n        return nil, err\n    }\n    return message, nil\n}\n</code></pre>\n\n<p>And to save a message (insert or update in the database) I run this method:</p>\n\n<pre><code>func (this *Message) save() error {\n    s := \"\"\n    if this.Id == 0 {\n        s = \"INSERT INTO message SET %s;\"\n    } else {\n        s = \"UPDATE message SET %s WHERE id=:id;\"\n    }\n    query := fmt.Sprintf(s, sql.PlaceholderPairs(this))\n\n    nstmt, err := sql.DB.PrepareNamed(query)\n    if err != nil {\n        return err\n    }\n\n    res, err := nstmt.Exec(*this)\n    if err != nil {\n        return err\n    }\n\n    if this.Id == 0 {\n        lastId, err := res.LastInsertId()\n        if err != nil {\n            return err\n        }\n        this.Id = lastId\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>The sql.PlaceholderPairs() function looks like this:</p>\n\n<pre><code>func PlaceholderPairs(i interface{}) string {\n\n    s := \"\"\n    val := reflect.ValueOf(i).Elem()\n    count := val.NumField()\n\n    for i := 0; i &lt; count; i++ {\n        typeField := val.Type().Field(i)\n        tag := typeField.Tag\n\n        fname := strings.ToLower(typeField.Name)\n\n        if fname == \"id\" {\n            continue\n        }\n\n        if t := tag.Get(\"db\"); t == \"-\" {\n            continue\n        } else if t != \"\" {\n            s += t + \"=:\" + t\n        } else {\n            s += fname + \"=:\" + fname\n        }\n        s += \", \"\n    }\n    s = s[:len(s)-2]\n    return s\n}\n</code></pre>\n\n<p>But every time I create a new struct, for example a User struct I have to copy paste the \"crud section\" above and create a user_crud.go file and replace the words \"Message\" with \"User\", and the words \"message\" with \"user\". I repeat alot of code and it is not very dry. Is there something I could do to not repeat this code for things I would reuse? I always have a save() method, and always have a function ByUnique() where I can return a struct and search by a unique column.</p>\n\n<p>In PHP this was easy because PHP is not statically typed.</p>\n\n<p>Is this possible to do in Go?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1454884495, "post_id": 35259808, "comment_id": 58232299, "body": "Is this just <a href=\"http://stackoverflow.com/q/29887094/479863\"><b>\u201cOperator does not exist: integer =?\u201d when using Postgres with Golang</b></a> in disguise? AFAIK the PostgreSQL interface for Go wants to use numbered placeholders (i.e. <code>$1</code>, <code>$2</code>, ...) instead of <code>?</code>."}, {"owner": {"reputation": 889, "user_id": 1477118, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ziXaw.jpg?s=128&g=1", "display_name": "nickbusted", "link": "https://stackoverflow.com/users/1477118/nickbusted"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1454884836, "post_id": 35259808, "comment_id": 58232404, "body": "@muistooshort Thank you:)"}], "owner": {"reputation": 889, "user_id": 1477118, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ziXaw.jpg?s=128&g=1", "display_name": "nickbusted", "link": "https://stackoverflow.com/users/1477118/nickbusted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1454884794, "answer_count": 0, "score": 0, "last_activity_date": 1454883242, "creation_date": 1454883242, "last_edit_date": 1495540754, "question_id": 35259808, "link": "https://stackoverflow.com/questions/35259808/batch-insert-postgresql-go", "closed_reason": "Duplicate", "title": "Batch insert PostgreSQL/Go", "body": "<p>I need to save multiple tags in the single query:</p>\n\n<pre><code>valueStrings := make([]string, 0, len(tags))\nvalueArgs := make([]interface{}, 0, len(tags) * 3)\nfor _, tag := range tags {\n    valueStrings = append(valueStrings, \"(?, ?, ?)\")\n    valueArgs = append(valueArgs, tag)\n    valueArgs = append(valueArgs, \"NOW()\")\n    valueArgs = append(valueArgs, \"NOW()\")\n}\nstmt := fmt.Sprintf(\"INSERT INTO tags (name, created_at, updated_at) VALUES %s ON CONFLICT DO NOTHING;\", strings.Join(valueStrings, \", \"))\nc.DB.Exec(stmt, valueArgs...)\n</code></pre>\n\n<p>Checking PostgreSQL logs:</p>\n\n<pre><code>ERROR:  syntax error at or near \",\" at character 58\nSTATEMENT:  INSERT INTO tags (name, created_at, updated_at) VALUES (?, ?, ?), (?, ?, ?) ON CONFLICT DO NOTHING;\n</code></pre>\n\n<p>I believe that <code>Exec</code> does not replace question marks with corresponding values.</p>\n\n<blockquote>\n  <p><a href=\"https://stackoverflow.com/a/25192138/1477118\">Golang how do I batch sql statements with package database.sql</a></p>\n</blockquote>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 490, "user_id": 3310759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409b69c3ae7b431fc16129ccdadae9cd?s=128&d=identicon&r=PG", "display_name": "driusan", "link": "https://stackoverflow.com/users/3310759/driusan"}, "is_accepted": true, "score": 3, "last_activity_date": 1454884101, "creation_date": 1454884101, "answer_id": 35259933, "question_id": 35259530, "link": "https://stackoverflow.com/questions/35259530/go-add-writers-to-io-writer-using-multiwriter/35259933#35259933", "title": "go: Add writers to io.writer using multiWriter", "body": "<p>You don't seem to have a map of writers, you have a map of ints to bools. Presumably, the ints represent the file descriptor.</p>\n\n<p>The easiest way to do it would probably to change it from map[int]bool to map[io.Writer]bool, then you can iterate through them and add them to a slice with append.</p>\n\n<pre><code>ws := make([]io.Writer, 0)\nfor k, v : = range(writers) {\n    if v != true {\n        continue\n    }\n    ws = append(ws, k)\n}\n</code></pre>\n\n<p>After that, you can just create a multiwriter directly by giving the slice to your MultiWriter call.</p>\n\n<pre><code>w := io.MultiWriter(ws...)\nlog.SetOutput(w)\n</code></pre>\n\n<p>(The <code>...</code> in a function parameter after a slice means to expand the slice into arguments to the function call)</p>\n\n<p>You can do the same thing while keeping it map[int]bool, but you'll need a switch similar to what you already have to convert your int into an io.Writer</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1454884594, "creation_date": 1454884594, "answer_id": 35260016, "question_id": 35259530, "link": "https://stackoverflow.com/questions/35259530/go-add-writers-to-io-writer-using-multiwriter/35260016#35260016", "title": "go: Add writers to io.writer using multiWriter", "body": "<p>For example,</p>\n\n<pre><code>var writers map[int]bool\n\nvar writer0, writer2 io.Writer\n\nfunc setupMultiLoggers() {\n    var mw []io.Writer\n    for k, v := range writers {\n        if v == false {\n            continue\n        }\n        switch k {\n        case 0:\n            mw = append(mw, writer0)\n        case 1:\n            mw = append(mw, os.Stdout)\n        case 2:\n            mw = append(mw, writer2)\n        }\n    }\n    log.SetOutput(io.MultiWriter(mw...))\n}\n</code></pre>\n"}], "owner": {"reputation": 289, "user_id": 3606470, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0a52f58dfce3bf1bc93823006d796d83?s=128&d=identicon&r=PG&f=1", "display_name": "Yan4321", "link": "https://stackoverflow.com/users/3606470/yan4321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 1, "accepted_answer_id": 35259933, "answer_count": 2, "score": 0, "last_activity_date": 1454884594, "creation_date": 1454881703, "last_edit_date": 1454882605, "question_id": 35259530, "link": "https://stackoverflow.com/questions/35259530/go-add-writers-to-io-writer-using-multiwriter", "title": "go: Add writers to io.writer using multiWriter", "body": "<p>I'm new to Go.\nI have a map which indicates which writers are active:</p>\n\n<pre><code>var writers map[int]bool\n</code></pre>\n\n<p>I want to iterate over the map, and create a writer which represents all active writers using multiWriter()</p>\n\n<p>I am using the following code snippet:</p>\n\n<pre><code>func setupMultiLoggers() {\nvar mw io.Writer\nfor k, v := range writers {\n    if v != true {\n        continue\n    }\n    switch k {\n    case 0:\n        if mw == nil {\n            mw = writer0\n        } else {\n            mw = io.MultiWriter(mw, writer0)\n        }\n    case 1:\n        if mw == nil {\n            mw = os.Stdout\n        } else {\n            mw = io.MultiWriter(mw, os.Stdout)\n        }\n    case 2:\n        if mw == nil {\n            mw = writer2\n        } else {\n            io.MultiWriter(mw, writer2)\n        }\n    default:\n    }\n}\nlog.SetOutput(mw)\n</code></pre>\n\n<p>}</p>\n\n<p>When initializing the all 3 values of the map to true and then testing writer2, it sometimes works and sometimes doesn't (code in case 2 always executes)</p>\n\n<p>If I just use </p>\n\n<pre><code>log.SetOutput(io.MultiWriter(writer0, os.Stdout, writer2))\n</code></pre>\n\n<p>It always works as expected.</p>\n\n<p>I cannot seem to understand why my original code doesn't reliably work. I have a feeling there is a more clean way to \"concatenate\" writers</p>\n\n<p>EDIT: I've found my (stupid) bug. assignment to mw was missing in the third case.\nStill looking for a more clean way to \"concatenate\" writers.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 1, "creation_date": 1454880035, "post_id": 35259186, "comment_id": 58230926, "body": "You want a <b>slice</b>, not a <b>slice array</b> and not an <b>array</b>. :)"}, {"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 1, "creation_date": 1454880174, "post_id": 35259186, "comment_id": 58230967, "body": "Another off-topic comment/opinion: the <i>recipe</i> prefix in the fields of type <code>Recipes</code> seems redundant. And <code>Recipes</code> should be called <code>Recipe</code> IMHO."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1454914797, "post_id": 35259186, "comment_id": 58239506, "body": "Have a look at the Tour of Go. And do all exercises."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1454884911, "last_edit_date": 1454884911, "creation_date": 1454879925, "answer_id": 35259240, "question_id": 35259186, "link": "https://stackoverflow.com/questions/35259186/how-to-add-a-slice-array-inside-of-a-struct/35259240#35259240", "title": "How to Add a Slice Array inside of a Struct", "body": "<p>Use a slice of <code>string</code>. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Recipe struct {\n    Name        string\n    PrepTime    int\n    CookTime    int\n    Ingredients []string\n    ID          int\n    Yield       int\n}\n\nfunc main() {\n    var recipe Recipe\n    recipe.Name = \"BBQ Pulled Chicken\"\n    recipe.PrepTime = 25\n    recipe.CookTime = 5\n    recipe.Ingredients = append(recipe.Ingredients,\n        \"1 8-ounce can reduced-sodium tomato sauce\",\n    )\n    recipe.Ingredients = append(recipe.Ingredients,\n        \"1/2 medium onion, grated \",\n    )\n    recipe.ID = 1\n    recipe.Yield = 8\n    fmt.Println(recipe)\n    fmt.Printf(\"Ingredients: %q\\n\", recipe.Ingredients)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{BBQ Pulled Chicken 25 5 [1 8-ounce can reduced-sodium tomato sauce 1/2 medium onion, grated ] 1 8}\nIngredients: [\"1 8-ounce can reduced-sodium tomato sauce\" \"1/2 medium onion, grated \"]\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 5896062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73b2c04c398d1678bba28f0ef427fac9?s=128&d=identicon&r=PG&f=1", "display_name": "Tbalz", "link": "https://stackoverflow.com/users/5896062/tbalz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 2, "accepted_answer_id": 35259240, "answer_count": 1, "score": 2, "last_activity_date": 1454884911, "creation_date": 1454879652, "last_edit_date": 1454880032, "question_id": 35259186, "link": "https://stackoverflow.com/questions/35259186/how-to-add-a-slice-array-inside-of-a-struct", "title": "How to Add a Slice Array inside of a Struct", "body": "<p>I'm looking to add an array for a string variable inside of a struct I have created in Go.</p>\n\n<pre><code>type Recipes struct { //Struct for recipe information\n    name             string\n    prepTime         int\n    cookTime         int\n    recipeIngredient string\n    recipeID         int\n    recipeYield      int\n}\n</code></pre>\n\n<p>It is called by</p>\n\n<pre><code>Recipe1.name = \"BBQ Pulled Chicken\"\nRecipe1.prepTime = 25\nRecipe1.cookTime = 5\nRecipe1.recipeIngredient = \"1 8-ounce can reduced-sodium tomato sauce, two\"\nRecipe1.recipeID = 1\nRecipe1.recipeYield = 8\n</code></pre>\n\n<p>recipeIngredient will have multiple ingredients so it just can't be one string. I would like to have multiple array/slice elements inside recipeIngredient. Anyone have an idea on how i would be able to do this please?</p>\n"}, {"tags": ["git", "go", "zlib"], "answers": [{"tags": [], "owner": {"reputation": 490, "user_id": 3310759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409b69c3ae7b431fc16129ccdadae9cd?s=128&d=identicon&r=PG", "display_name": "driusan", "link": "https://stackoverflow.com/users/3310759/driusan"}, "is_accepted": false, "score": 0, "last_activity_date": 1455038298, "creation_date": 1455038298, "answer_id": 35298163, "question_id": 35258001, "link": "https://stackoverflow.com/questions/35258001/git-packfile-entry-offset-calculations/35298163#35298163", "title": "Git Packfile Entry Offset Calculations", "body": "<p>I've solved my problem in a different way: I modified compress/zlib to expose the digest from the zlib reader. After decompressing, I seek backwards in the original io.ReadSeeker to find the 4 byte digest that was used as a checksum for the compressed data so that I know where the end of the compressed data stream was.</p>\n\n<p>I still don't have an answer for why git and Go's zlib algorithm would produce different results with the same compression level, though.</p>\n"}], "owner": {"reputation": 490, "user_id": 3310759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409b69c3ae7b431fc16129ccdadae9cd?s=128&d=identicon&r=PG", "display_name": "driusan", "link": "https://stackoverflow.com/users/3310759/driusan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1455038298, "creation_date": 1454873110, "question_id": 35258001, "link": "https://stackoverflow.com/questions/35258001/git-packfile-entry-offset-calculations", "title": "Git Packfile Entry Offset Calculations", "body": "<p>I'm trying to interpret a packfile received from git-upload-pack. git-upload-pack doesn't send the accompanying index, because supposedly you can derive it from the original packfile, but I can't figure out how that's possible with the packfile's format. </p>\n\n<p>The git technical documentation says it has a variable number of bytes indicating the entry size, but this is the <em>uncompressed</em> size of the entry, and the entry data itself is compressed in the pack file with zlib. Go's zlib implementation is greedy and seeks past the end of the data with the io.Reader I give it, meaning I can't trust it to leave the io.Reader pointer at the right place after decompressing the block.</p>\n\n<p>My first thought was to take a bookmark before reading the compressed block from the packfile with compress/zlib, reset to the bookmark after reading, recompress the uncompressed data with the same algorithm/compression level so that I know the length of the compressed data, and then seek forward that far to get to the right offset for the next block.</p>\n\n<p>However, the recompressed data doesn't seem to be identical to the original compressed data. Why would the same data compressed with the same algorithm produce different results? And is there a better way to calculate the indexes of entries into a git packfile?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1454872727, "post_id": 35257888, "comment_id": 58228178, "body": "This might not be a great question for the format of Stack Overflow: your question is very broad. Try asking on <a href=\"https://forum.golangbridge.org/\" rel=\"nofollow noreferrer\">forum.golangbridge.org</a> and be clear about what parts of the code you don&#39;t understand (add comments to those sections stating what is unclear)."}, {"owner": {"reputation": 37, "user_id": 5895067, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/432c26e117b9272658291dfab8b09d74?s=128&d=identicon&r=PG&f=1", "display_name": "ADF programmer", "link": "https://stackoverflow.com/users/5895067/adf-programmer"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1454873036, "post_id": 35257888, "comment_id": 58228300, "body": "good what is * meaning ??"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5895067, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/432c26e117b9272658291dfab8b09d74?s=128&d=identicon&r=PG&f=1", "display_name": "ADF programmer", "link": "https://stackoverflow.com/users/5895067/adf-programmer"}, "edited": false, "score": 0, "creation_date": 1454873472, "post_id": 35257941, "comment_id": 58228464, "body": "thanks i am now there"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1454872807, "creation_date": 1454872807, "answer_id": 35257941, "question_id": 35257888, "link": "https://stackoverflow.com/questions/35257888/i-want-to-know-the-pattern-and-logic-in-this-code/35257941#35257941", "title": "I want to know the pattern and logic in this code", "body": "<p><code>*</code> is a pointer.</p>\n\n<p>Please stop everything that you are doing and take the Go <a href=\"https://tour.golang.org/\" rel=\"nofollow\">tour</a>.</p>\n"}], "owner": {"reputation": 37, "user_id": 5895067, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/432c26e117b9272658291dfab8b09d74?s=128&d=identicon&r=PG&f=1", "display_name": "ADF programmer", "link": "https://stackoverflow.com/users/5895067/adf-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1456027357, "answer_count": 1, "score": -3, "last_activity_date": 1454879536, "creation_date": 1454872532, "last_edit_date": 1454879536, "question_id": 35257888, "link": "https://stackoverflow.com/questions/35257888/i-want-to-know-the-pattern-and-logic-in-this-code", "closed_reason": "Needs more focus", "title": "I want to know the pattern and logic in this code", "body": "<p>i am new to Go so i need to know the pattern and understand the logic in this code</p>\n\n<p>first :\nin the car model folder lying a .go file name car.go but its struct was</p>\n\n<p>and in controller folder there a cars.go file as following</p>\n\n<pre><code>type Car struct {\n    Id        bson.ObjectId `bson:\"_id\"`\n    Model     string        `bson:\"model\" form:\"\" json:\"model\" binding:\"required\"`\n    Brand     string        `bson:\"brand\" form:\"brand\" json:\"brand\" binding:\"required\"`\n    CreatedAt bson.MongoTimestamp\n}\n\ntype CarController struct {\n    carService *services.CarService\n}\n\nfunc (controller CarController) New() *CarController {\n    controller.carService = services.CarService{}.New()\n\n    return &amp;controller\n}\n\nfunc (controller CarController) GetIndex(c *gin.Context) {\n    carList := controller.carService.Find(&amp;bson.M{})\n    c.JSON(http.StatusOK, &amp;carList)\n    //fmt.Println(carList) }\n}\n</code></pre>\n\n<p>and in service folder was a carService.go file as following </p>\n\n<pre><code>type CarService struct {\n    dbName         string\n    uri            string\n    collectionName string\n}\n\nfunc (r CarService) New() *CarService {\n    configManger := viperconfing.Config{}\n    r.uri = configManger.GetConfig(\"dbUri\")\n    r.dbName = configManger.GetConfig(\"dbName\")\n    r.collectionName = \"car\"\n    return &amp;r\n}\n\nfunc (r CarService) Find(query *bson.M) (cars []models.Car) {\n    session, _ := mgo.Dial(r.uri)\n    defer session.Close()\n    session.SetSafe(&amp;mgo.Safe{})\n    collection := session.DB(r.dbName).C(r.collectionName)\n\n    collection.Find(query).All(&amp;cars)\n\n    fmt.Println(cars)\n    return cars\n}\n</code></pre>\n\n<p>I want to know the pattern used in this code i to understand the full logic and what is * meaning ??</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1454872575, "post_id": 35257784, "comment_id": 58228112, "body": "The simplest approach is to just <code>string(p)</code>, which will convert the <code>[]byte</code> into a <code>string</code> - with the caveat that not all bytes are guaranteed to be valid UTF-8 characters (runes). Also note that <code>http.ResponseWriter</code> exists as well, which also satisfies <code>io.Writer</code>."}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 2, "creation_date": 1454876118, "post_id": 35257894, "comment_id": 58229471, "body": "<code>string(p)</code> is not needed, <code>fmt.Printf(&quot;%s\\n&quot;, p)</code> should work as intended."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 5, "last_activity_date": 1454878044, "last_edit_date": 1454878044, "creation_date": 1454872575, "answer_id": 35257894, "question_id": 35257784, "link": "https://stackoverflow.com/questions/35257784/golang-getting-string-from-byte/35257894#35257894", "title": "golang: Getting string from []byte", "body": "<p>Ok, two things:</p>\n\n<ol>\n<li><p>You haven't \"inherited\" <code>io.Writer</code> (you simply stated that your struct contains a writer). In go, interfaces are implicit. If your struct implements <code>Write(p []byte) (n int, err, error)</code>, it is an <code>io.Writer</code> and can be used with any function accepting it. Period. No need to declare anything.</p></li>\n<li><p>As for your problem: <code>fmt.Printf(\"%s\\n\", string(p))</code></p></li>\n</ol>\n"}], "owner": {"reputation": 289, "user_id": 3606470, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0a52f58dfce3bf1bc93823006d796d83?s=128&d=identicon&r=PG&f=1", "display_name": "Yan4321", "link": "https://stackoverflow.com/users/3606470/yan4321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "accepted_answer_id": 35257894, "answer_count": 1, "score": 2, "last_activity_date": 1454878044, "creation_date": 1454872048, "last_edit_date": 1454872452, "question_id": 35257784, "link": "https://stackoverflow.com/questions/35257784/golang-getting-string-from-byte", "title": "golang: Getting string from []byte", "body": "<p>I'm new to go (coming from the C++ world)</p>\n\n<p>I've created a new writer, which \"inherits\" from io.writer:</p>\n\n<pre><code>type httpWriter struct {\n  io.Writer\n}\n</code></pre>\n\n<p>Next I've implemented the Write() function of the io.Writer interface:</p>\n\n<pre><code>func (w *httpWriter) Write(p []byte) (n int, err, error){...}\n</code></pre>\n\n<p>Then, I've redirected all output to that writer.</p>\n\n<p>I'm having truble to print the actual string in the Write() implementation.\nI've tried all string formatting I could find in the documentation, but none of them give me the original string as an output.</p>\n\n<pre><code>fmt.Printf(\"%s\\n\",p) \\\\etc..\n</code></pre>\n\n<p>Would appreciate assistance</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1165, "user_id": 869271, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ae486e9ebb18f0cd4dd3f512abc3a3e1?s=128&d=identicon&r=PG", "display_name": "Siscia", "link": "https://stackoverflow.com/users/869271/siscia"}, "edited": false, "score": 0, "creation_date": 1454871977, "post_id": 35257642, "comment_id": 58227872, "body": "You were exactly right ! What you mean with &quot;Try to get your build working in the standard build mode before experimenting with more complicated build and execution modes. &quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1165, "user_id": 869271, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ae486e9ebb18f0cd4dd3f512abc3a3e1?s=128&d=identicon&r=PG", "display_name": "Siscia", "link": "https://stackoverflow.com/users/869271/siscia"}, "edited": false, "score": 0, "creation_date": 1454872420, "post_id": 35257642, "comment_id": 58228035, "body": "@Siscia: the question had nothing to do with <code>-buildmode=shared</code>, or your shared lib. Simply building using the standard mode of <code>go build</code> or <code>go install</code> would have shown the problem."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1454871211, "creation_date": 1454871211, "answer_id": 35257642, "question_id": 35257574, "link": "https://stackoverflow.com/questions/35257574/cannot-find-package-for-shared-library/35257642#35257642", "title": "Cannot find package for shared library", "body": "<p>The import path for \"libmath\" is \"effe/libmath\".</p>\n\n<p>Try to get your build working in the standard build mode before experimenting with more complicated build and execution modes. </p>\n"}], "owner": {"reputation": 1165, "user_id": 869271, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ae486e9ebb18f0cd4dd3f512abc3a3e1?s=128&d=identicon&r=PG", "display_name": "Siscia", "link": "https://stackoverflow.com/users/869271/siscia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 35257642, "answer_count": 1, "score": 0, "last_activity_date": 1454871211, "creation_date": 1454870837, "question_id": 35257574, "link": "https://stackoverflow.com/questions/35257574/cannot-find-package-for-shared-library", "title": "Cannot find package for shared library", "body": "<p>I am trying to use a shared library in go-lang, I am following this blog post: <a href=\"http://blog.ralch.com/tutorial/golang-sharing-libraries/\" rel=\"nofollow\">http://blog.ralch.com/tutorial/golang-sharing-libraries/</a></p>\n\n<p>But when I hit build I get back an error:</p>\n\n<pre><code>simo@simo:~/gopath$ go build -linkshared -o app effe/prova\nsrc/effe/prova/prova.go:3:8: cannot find package \"libmath\" in any of:\n/usr/local/go/src/libmath (from $GOROOT)\n/home/simo/gopath/src/libmath (from $GOPATH)\n</code></pre>\n\n<p>I am pretty new to go, so I will show also my environment...</p>\n\n<pre><code>simo@simo:~/gopath$ pwd\n/home/simo/gopath\nsimo@simo:~/gopath$ echo $GOPATH\n/home/simo/gopath\nsimo@simo:~/gopath$ tree\n.\n\u251c\u2500\u2500 pkg\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 linux_amd64_dynlink\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 effe\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 libmath.a\n\u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 libmath.shlibname\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 libeffe-libmath.so\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 effe\n        \u251c\u2500\u2500 libmath\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 libmath.go\n        \u2514\u2500\u2500 prova\n            \u2514\u2500\u2500 prova.go\n\n7 directories, 5 files\nsimo@simo:~/gopath$ cat src/effe/libmath/libmath.go \n// filename: libmath.go\npackage libmath\n\nfunc Sum(x, y int) int {\n    return x + y\n}\nsimo@simo:~/gopath$ cat src/effe/prova/prova.go \npackage main\n\nimport \"libmath\"\nimport \"fmt\"\n\nfunc main() {\n    fmt.Printf(\"5 op 10 =&gt; %d\", libmath.Sum(5, 10))\n}\nsimo@simo:~/gopath$ go install -buildmode=shared -linkshared effe/libmath\nsimo@simo:~/gopath$ go build -linkshared -o app effe/prova\nsrc/effe/prova/prova.go:3:8: cannot find package \"libmath\" in any of:\n    /usr/local/go/src/libmath (from $GOROOT)\n    /home/simo/gopath/src/libmath (from $GOPATH)\n</code></pre>\n\n<p>What am I doing wrong ?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1454858058, "post_id": 35254979, "comment_id": 58222820, "body": "the question is <i>why</i> do you need separate channels per work type? Is it just because of type definition? In this case you can make it <code>chan interface{}</code>. Is it because you want separate consumers?"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1454858947, "post_id": 35254979, "comment_id": 58223089, "body": "I want to send the output of  different types of Work to different chanels, because I need to work with each WorkType in different ways, and might need different output structures... Now out chan is of  Work type, but i want to have the ability to make chans like workTypeOne, WorkTypeThree..."}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1454859797, "post_id": 35254979, "comment_id": 58223346, "body": "is this possible? ..or how can I achive this using one <b>Out</b> channel?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1454859829, "post_id": 35254979, "comment_id": 58223361, "body": "You could have the consumer of ready work items do a <code>type switch</code> on the items and handle them accordingly. I can give you an example."}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1454859868, "post_id": 35254979, "comment_id": 58223373, "body": "The example would be great."}], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1454860159, "post_id": 35255524, "comment_id": 58223471, "body": "It would be enough, thank you! I would do it in your way. Thanks a lot again!"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 1, "creation_date": 1454860267, "post_id": 35255524, "comment_id": 58223508, "body": "@Altenrion cool. I would just add a default case in case of a wrong send, to panic or something. Adding to my answer."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 1, "last_activity_date": 1454860324, "last_edit_date": 1454860324, "creation_date": 1454860016, "answer_id": 35255524, "question_id": 35254979, "link": "https://stackoverflow.com/questions/35254979/golang-gouroutines-how-to-set-up-chanel-in-another-chanel-and-than-read-it-af/35255524#35255524", "title": "golang, gouroutines, How to set up chanel in another chanel, and than read it after closing mother chanel", "body": "<p>You can have the output channel be generic, and handle different work items using a type switch. </p>\n\n<p>Say your output channel is just <code>chan interface{}</code>.</p>\n\n<p>The consumer of ready work items will look something like:</p>\n\n<pre><code>for item := range output {\n   // in each case statement x will have the appropriate type\n   switch x := item.(type) {\n       case workTypeOne:\n          handleTypeOne(x)\n       case workTypeTwo:\n          handleTypeTwo(x)\n       // and so on...\n\n       // and in case someone sent a non-work-item down the chan\n       default: \n          panic(\"Invalid type for work item!\")\n   }\n}\n</code></pre>\n\n<p>and the handlers handle a specific type, i.e.</p>\n\n<pre><code>func handleTypeOne(w workTypeOne) { \n    ....\n}\n</code></pre>\n"}], "owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 35255524, "answer_count": 1, "score": 0, "last_activity_date": 1454860324, "creation_date": 1454856846, "question_id": 35254979, "link": "https://stackoverflow.com/questions/35254979/golang-gouroutines-how-to-set-up-chanel-in-another-chanel-and-than-read-it-af", "title": "golang, gouroutines, How to set up chanel in another chanel, and than read it after closing mother chanel", "body": "<p>I'm rather new in Golang, but working hard on understanding this great language! Please, help me in this..</p>\n\n<p>I have 2 chanels. \"In\" and \"Out\"  chanels</p>\n\n<pre><code>    in, out := make(chan Work), make(chan Work)\n</code></pre>\n\n<p>I set up goroutines workers that are listening for in chanel, grab work and do it. I have some work, that i would send into In chanel.  </p>\n\n<p>When Work is done by worker, it writes to the Out chanel.</p>\n\n<pre><code>func worker(in &lt;-chan Work, out chan&lt;- Work, wg *sync.WaitGroup) {\n    for w := range in {\n\n        // do some work with the Work\n\n        time.Sleep(time.Duration(w.Z))\n        out &lt;- w\n    }\n    wg.Done()\n}\n</code></pre>\n\n<p>When all work is done I close both chanels at the write time of the program.</p>\n\n<p>Now I want to write the results of done work in OUT chanel, but to separate all in some parts, for example, if work type would be like this :</p>\n\n<pre><code>type Work struct {\n    Date string\n    WorkType string\n    Filters []Filter\n}\n</code></pre>\n\n<p>if WorkType is \"firstType\" I would like to send the done work to one chanel, and if WorkType  is \"secondType\" to second chan... But there might be over 20 types of work .. How to resolve this case in a better way?</p>\n\n<p>Can I set up chanels in chanel OUT, and grab data from this sub chanels? </p>\n\n<p>p.s.: Forgive me my noob questions, please..</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1454857224, "post_id": 35254595, "comment_id": 58222496, "body": "@Not_a_Golfer The net/http client does not expose an io.Writer to the request body."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1454855074, "last_edit_date": 1454855074, "creation_date": 1454854740, "answer_id": 35254595, "question_id": 35254527, "link": "https://stackoverflow.com/questions/35254527/how-to-bridge-writer-and-reader-in-go/35254595#35254595", "title": "how to &quot;bridge&quot; writer and reader in go", "body": "<p>A simple approach is to use a <a href=\"http://godoc.org/bytes#Buffer\" rel=\"nofollow\">bytes.Buffer</a>:</p>\n\n<pre><code>var buf bytes.Buffer\nerr := html.Render(&amp;buf, msg)\n...\nreq, err := http.NewRequest(\"POST\", url, &amp;buf)\n</code></pre>\n\n<p>This buffers the entire request in memory. An alternate approach that does not buffer everything in memory is to use <a href=\"http://godoc.org/io#Pipe\" rel=\"nofollow\">io.Pipe</a>. This approach is more complicated because it introduces concurrency in the program. Also, the http client starts to write the request to the wire before possible errors are detected in Render.</p>\n\n<pre><code>r, w := io.Pipe()\ngo func() {\n    w.CloseWithError(html.Render(w, msg))\n}()\nreq, err := http.NewRequest(\"POST\", url, r)\n</code></pre>\n"}], "owner": {"reputation": 1753, "user_id": 570293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/DuOBG.png?s=128&g=1", "display_name": "moin moin", "link": "https://stackoverflow.com/users/570293/moin-moin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1054, "favorite_count": 2, "accepted_answer_id": 35254595, "answer_count": 1, "score": 1, "last_activity_date": 1454855074, "creation_date": 1454854306, "question_id": 35254527, "link": "https://stackoverflow.com/questions/35254527/how-to-bridge-writer-and-reader-in-go", "title": "how to &quot;bridge&quot; writer and reader in go", "body": "<p>I usually find my way with Reader and Writer in Golang but I came to a situation new to me.</p>\n\n<p>I am using \"golang.org/x/net/html\" Render. It outputs to a Writer w. I want to use that output and create a new request from that. NewRequest uses a Reader r.</p>\n\n<pre><code>err := html.Render(w, msg)\n...\nreq, err := http.NewRequest(\"Post\", url, r)\nio.Copy(w, r)\n</code></pre>\n\n<p>My question is \"what is the best/ideomatic solution for binding the two calls using w and r?\". I could not find an example for a similar situation on the web. I am thinking about creating both Reader and Writer and using io.Copy(w, r) on them. I am not sure since this appears a little complicated  for something that apparently is used often.</p>\n"}, {"tags": ["angularjs", "node.js", "go"], "comments": [{"owner": {"reputation": 52062, "user_id": 256793, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f3066138ea3d8e6b0c7a3764b5021e78?s=128&d=identicon&r=PG", "display_name": "Nix", "link": "https://stackoverflow.com/users/256793/nix"}, "edited": false, "score": 2, "creation_date": 1454853780, "post_id": 35254401, "comment_id": 58221226, "body": "What is the problem (assuming its an <code>async</code> problem)?"}], "answers": [{"tags": [], "owner": {"reputation": 8433, "user_id": 2667536, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/UfmAF.png?s=128&g=1", "display_name": "Derlin", "link": "https://stackoverflow.com/users/2667536/derlin"}, "is_accepted": false, "score": 1, "last_activity_date": 1454867225, "last_edit_date": 1454867225, "creation_date": 1454854043, "answer_id": 35254474, "question_id": 35254401, "link": "https://stackoverflow.com/questions/35254401/repeating-records-with-golang/35254474#35254474", "title": "repeating records with golang", "body": "<p>Not sure to understand, so I assume the problem is that multiple lines have the same data.</p>\n\n<p>If you look at the <code>id</code> of your records, they are all different, meaning that they actually are different records. I guess you inserted the same object multiple times in MongoDB without specifying an <code>ObjectId</code>. As a result, Mongo couldn't detect the duplicates and accepted the record as new.</p>\n\n<blockquote>\n  <p>In MongoDB, documents stored in a collection require a unique _id field that acts as a primary key. MongoDB uses ObjectIds as the default value for the _id field if the _id field is not specified; </p>\n</blockquote>\n\n<p>Clean up your db, create a meaningful document id in your mongo collection (<a href=\"https://docs.mongodb.org/manual/reference/object-id/\" rel=\"nofollow\">more info here</a>) and you should be fine.</p>\n"}], "owner": {"reputation": 37, "user_id": 5895067, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/432c26e117b9272658291dfab8b09d74?s=128&d=identicon&r=PG&f=1", "display_name": "ADF programmer", "link": "https://stackoverflow.com/users/5895067/adf-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1454867225, "creation_date": 1454853607, "last_edit_date": 1454853921, "question_id": 35254401, "link": "https://stackoverflow.com/questions/35254401/repeating-records-with-golang", "title": "repeating records with golang", "body": "<p>i am new in Golang i want to read car record in mongodb so i have up to 29 record\ni create a cars.go act as a controller and fill it with that code</p>\n\n<pre><code>func (controller CarController) GetIndex(c *gin.Context) {\n   carList:=controller.carService.Find(&amp;bson.M{})\n   c.JSON(http.StatusOK, &amp;carList)\n   //fmt.Println(carList)\n}\n</code></pre>\n\n<p>and in my carService.go i coded</p>\n\n<pre><code>func (r CarService) Find(query *bson.M) (cars []models.Car) {\n   session, _ := mgo.Dial(r.uri)\n   defer session.Close()\n   session.SetSafe(&amp;mgo.Safe{})\n   collection := session.DB(r.dbName).C(r.collectionName)\n\n    collection.Find(query).All(&amp;cars)\n\n    fmt.Println(cars)\n    return cars\n\n}\n</code></pre>\n\n<p>in my main.go router was</p>\n\n<pre><code>router.GET(\"/car\",carBaseController.GetIndex)\n</code></pre>\n\n<p>when i test the fir-fox console with fmt.Println(carList) i see the repeate records like that</p>\n\n<pre><code> [\n   {\n      \"Id\":\"56b636688a47a60aa8601f57\",\n      \"model\":\"ayman\",\n      \"brand\":\"islamic\",\n      \"CreatedAt\":6248241353327640577\n   },\n   {\n      \"Id\":\"56b63b658a47a605dc9e8e38\",\n      \"model\":\"ayman\",\n      \"brand\":\"islamic\",\n      \"CreatedAt\":6248246838000877569\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e0\",\n      \"model\":\"ayman 0\",\n      \"brand\":\"islamic 0\",\n      \"CreatedAt\":6248254590416846849\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e1\",\n      \"model\":\"ayman 1\",\n      \"brand\":\"islamic 1\",\n      \"CreatedAt\":6248254590416846850\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e2\",\n      \"model\":\"ayman 2\",\n      \"brand\":\"islamic 2\",\n      \"CreatedAt\":6248254590416846851\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e3\",\n      \"model\":\"ayman 3\",\n      \"brand\":\"islamic 3\",\n      \"CreatedAt\":6248254590416846852\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e4\",\n      \"model\":\"ayman 4\",\n      \"brand\":\"islamic 4\",\n      \"CreatedAt\":6248254590416846853\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e5\",\n      \"model\":\"ayman 5\",\n      \"brand\":\"islamic 5\",\n      \"CreatedAt\":6248254590416846854\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e6\",\n      \"model\":\"ayman 6\",\n      \"brand\":\"islamic 6\",\n      \"CreatedAt\":6248254590416846855\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e7\",\n      \"model\":\"ayman 7\",\n      \"brand\":\"islamic 7\",\n      \"CreatedAt\":6248254590416846856\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e8\",\n      \"model\":\"ayman 8\",\n      \"brand\":\"islamic 8\",\n      \"CreatedAt\":6248254590416846857\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0e9\",\n      \"model\":\"ayman 9\",\n      \"brand\":\"islamic 9\",\n      \"CreatedAt\":6248254590416846858\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0ea\",\n      \"model\":\"ayman 10\",\n      \"brand\":\"islamic 10\",\n      \"CreatedAt\":6248254590416846859\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0eb\",\n      \"model\":\"ayman 11\",\n      \"brand\":\"islamic 11\",\n      \"CreatedAt\":6248254590416846860\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0ec\",\n      \"model\":\"ayman 12\",\n      \"brand\":\"islamic 12\",\n      \"CreatedAt\":6248254590416846861\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0ed\",\n      \"model\":\"ayman 13\",\n      \"brand\":\"islamic 13\",\n      \"CreatedAt\":6248254590416846862\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0ee\",\n      \"model\":\"ayman 14\",\n      \"brand\":\"islamic 14\",\n      \"CreatedAt\":6248254590416846863\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0ef\",\n      \"model\":\"ayman 15\",\n      \"brand\":\"islamic 15\",\n      \"CreatedAt\":6248254590416846864\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f0\",\n      \"model\":\"ayman 16\",\n      \"brand\":\"islamic 16\",\n      \"CreatedAt\":6248254590416846865\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f1\",\n      \"model\":\"ayman 17\",\n      \"brand\":\"islamic 17\",\n      \"CreatedAt\":6248254590416846866\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f2\",\n      \"model\":\"ayman 18\",\n      \"brand\":\"islamic 18\",\n      \"CreatedAt\":6248254590416846867\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f3\",\n      \"model\":\"ayman 19\",\n      \"brand\":\"islamic 19\",\n      \"CreatedAt\":6248254590416846868\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f4\",\n      \"model\":\"ayman 20\",\n      \"brand\":\"islamic 20\",\n      \"CreatedAt\":6248254590416846869\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f5\",\n      \"model\":\"ayman 21\",\n      \"brand\":\"islamic 21\",\n      \"CreatedAt\":6248254590416846870\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f6\",\n      \"model\":\"ayman 22\",\n      \"brand\":\"islamic 22\",\n      \"CreatedAt\":6248254590416846871\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f7\",\n      \"model\":\"ayman 23\",\n      \"brand\":\"islamic 23\",\n      \"CreatedAt\":6248254590416846872\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f8\",\n      \"model\":\"ayman 24\",\n      \"brand\":\"islamic 24\",\n      \"CreatedAt\":6248254590416846873\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0f9\",\n      \"model\":\"ayman 25\",\n      \"brand\":\"islamic 25\",\n      \"CreatedAt\":6248254590416846874\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0fa\",\n      \"model\":\"ayman 26\",\n      \"brand\":\"islamic 26\",\n      \"CreatedAt\":6248254590416846875\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0fb\",\n      \"model\":\"ayman 27\",\n      \"brand\":\"islamic 27\",\n      \"CreatedAt\":6248254590416846876\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0fc\",\n      \"model\":\"ayman 28\",\n      \"brand\":\"islamic 28\",\n      \"CreatedAt\":6248254590416846877\n   },\n   {\n      \"Id\":\"56b642728a47a62364f3e0fd\",\n      \"model\":\"ayman 29\",\n      \"brand\":\"islamic 29\",\n      \"CreatedAt\":6248254590416846878\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13ef9\",\n      \"model\":\"ayman 0\",\n      \"brand\":\"islamic 0\",\n      \"CreatedAt\":6248431092097875969\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13efa\",\n      \"model\":\"ayman 1\",\n      \"brand\":\"islamic 1\",\n      \"CreatedAt\":6248431092097875970\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13efb\",\n      \"model\":\"ayman 2\",\n      \"brand\":\"islamic 2\",\n      \"CreatedAt\":6248431092097875971\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13efc\",\n      \"model\":\"ayman 3\",\n      \"brand\":\"islamic 3\",\n      \"CreatedAt\":6248431092097875972\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13efd\",\n      \"model\":\"ayman 4\",\n      \"brand\":\"islamic 4\",\n      \"CreatedAt\":6248431092097875973\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13efe\",\n      \"model\":\"ayman 5\",\n      \"brand\":\"islamic 5\",\n      \"CreatedAt\":6248431092097875974\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13eff\",\n      \"model\":\"ayman 6\",\n      \"brand\":\"islamic 6\",\n      \"CreatedAt\":6248431092097875975\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f00\",\n      \"model\":\"ayman 7\",\n      \"brand\":\"islamic 7\",\n      \"CreatedAt\":6248431092097875976\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f01\",\n      \"model\":\"ayman 8\",\n      \"brand\":\"islamic 8\",\n      \"CreatedAt\":6248431092097875977\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f02\",\n      \"model\":\"ayman 9\",\n      \"brand\":\"islamic 9\",\n      \"CreatedAt\":6248431092097875978\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f03\",\n      \"model\":\"ayman 10\",\n      \"brand\":\"islamic 10\",\n      \"CreatedAt\":6248431092097875979\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f04\",\n      \"model\":\"ayman 11\",\n      \"brand\":\"islamic 11\",\n      \"CreatedAt\":6248431092097875980\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f05\",\n      \"model\":\"ayman 12\",\n      \"brand\":\"islamic 12\",\n      \"CreatedAt\":6248431092097875981\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f06\",\n      \"model\":\"ayman 13\",\n      \"brand\":\"islamic 13\",\n      \"CreatedAt\":6248431092097875982\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f07\",\n      \"model\":\"ayman 14\",\n      \"brand\":\"islamic 14\",\n      \"CreatedAt\":6248431092097875983\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f08\",\n      \"model\":\"ayman 15\",\n      \"brand\":\"islamic 15\",\n      \"CreatedAt\":6248431092097875984\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f09\",\n      \"model\":\"ayman 16\",\n      \"brand\":\"islamic 16\",\n      \"CreatedAt\":6248431092097875985\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f0a\",\n      \"model\":\"ayman 17\",\n      \"brand\":\"islamic 17\",\n      \"CreatedAt\":6248431092097875986\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f0b\",\n      \"model\":\"ayman 18\",\n      \"brand\":\"islamic 18\",\n      \"CreatedAt\":6248431092097875987\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f0c\",\n      \"model\":\"ayman 19\",\n      \"brand\":\"islamic 19\",\n      \"CreatedAt\":6248431092097875988\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f0d\",\n      \"model\":\"ayman 20\",\n      \"brand\":\"islamic 20\",\n      \"CreatedAt\":6248431092097875989\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f0e\",\n      \"model\":\"ayman 21\",\n      \"brand\":\"islamic 21\",\n      \"CreatedAt\":6248431092097875990\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f0f\",\n      \"model\":\"ayman 22\",\n      \"brand\":\"islamic 22\",\n      \"CreatedAt\":6248431092097875991\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f10\",\n      \"model\":\"ayman 23\",\n      \"brand\":\"islamic 23\",\n      \"CreatedAt\":6248431092097875992\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f11\",\n      \"model\":\"ayman 24\",\n      \"brand\":\"islamic 24\",\n      \"CreatedAt\":6248431092097875993\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f12\",\n      \"model\":\"ayman 25\",\n      \"brand\":\"islamic 25\",\n      \"CreatedAt\":6248431092097875994\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f13\",\n      \"model\":\"ayman 26\",\n      \"brand\":\"islamic 26\",\n      \"CreatedAt\":6248431092097875995\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f14\",\n      \"model\":\"ayman 27\",\n      \"brand\":\"islamic 27\",\n      \"CreatedAt\":6248431092097875996\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f15\",\n      \"model\":\"ayman 28\",\n      \"brand\":\"islamic 28\",\n      \"CreatedAt\":6248431092097875997\n   },\n   {\n      \"Id\":\"56b6e2f98a47a60d50c13f16\",\n      \"model\":\"ayman 29\",\n      \"brand\":\"islamic 29\",\n      \"CreatedAt\":6248431092097875998\n   }\n]\n</code></pre>\n\n<p>how i can solve this problem ???</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 6, "last_activity_date": 1454847608, "creation_date": 1454847608, "answer_id": 35253386, "question_id": 35252880, "link": "https://stackoverflow.com/questions/35252880/go-sort-slice-of-pointers/35253386#35253386", "title": "Go sort slice of pointers", "body": "<p>Just make <code>Items</code> a list of item pointers:</p>\n\n<pre><code>type Items []*Item\n</code></pre>\n\n<p>and it can be sorted with the methods you've already described. that's it.</p>\n"}], "owner": {"reputation": 889, "user_id": 1477118, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ziXaw.jpg?s=128&g=1", "display_name": "nickbusted", "link": "https://stackoverflow.com/users/1477118/nickbusted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1749, "favorite_count": 0, "accepted_answer_id": 35253386, "answer_count": 1, "score": 4, "last_activity_date": 1454847608, "creation_date": 1454844410, "question_id": 35252880, "link": "https://stackoverflow.com/questions/35252880/go-sort-slice-of-pointers", "title": "Go sort slice of pointers", "body": "<p>Consider the following:</p>\n\n<pre><code>type Item struct {\n    Title      string\n    Date       time.Time\n}  \n\ntype Items []Item\n\nfunc (slice Items) Len() int {\n    return len(slice)\n}\n\nfunc (slice Items) Less(i, j int) bool {\n    return slice[i].Date.After(slice[j].Date)\n}\n\nfunc (slice Items) Swap(i, j int) {\n    slice[i], slice[j] = slice[j], slice[i]\n}\n</code></pre>\n\n<p>In the main method, I have a slice of pointers to <code>Item</code>, that must be sorted. My attempt is:</p>\n\n<pre><code>items := make(Items, len(in.Items)) //in.Items is of type []*Item\nfor i, value := range in.Items {\n    items[i] = *value\n}\n\nsort.Sort(items)\n\nin.Items = make([]*Item, len(items))\nfor i, value := range items {\n    in.Items[i] = &amp;value\n}\n</code></pre>\n\n<p>While it does what I need, is there another way to do this?</p>\n"}, {"tags": ["cookies", "go", "session-cookies"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1454864890, "post_id": 35252253, "comment_id": 58225137, "body": "Two tips: you should <i>absolutely</i> check the error from bcrypt. And you should set the <code>Path</code> value of <code>cookie</code> to <code>&#47;</code> - otherwise it will default to the path where the cookie was first created."}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1454911915, "post_id": 35252253, "comment_id": 58238417, "body": "Take a look to <a href=\"https://github.com/go-authboss/authboss\" rel=\"nofollow noreferrer\">github.com/go-authboss/authboss</a>"}, {"owner": {"reputation": 2991, "user_id": 1160051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/00a3da01cf3eef469d5880bd7ef680ed?s=128&d=identicon&r=PG", "display_name": "thewhitetulip", "link": "https://stackoverflow.com/users/1160051/thewhitetulip"}, "edited": false, "score": 0, "creation_date": 1454948818, "post_id": 35252253, "comment_id": 58260386, "body": "Also please avoid doing this  <code>if r.Form[&quot;emailLogin&quot;][0] == result.Email</code>, always it is a good habit to form a variable called email = r.Form.Get(&#39;emailLogin&#39;) rather than using it directly in the if statement"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3212497"}, "edited": false, "score": 1, "creation_date": 1454960439, "post_id": 35252253, "comment_id": 58267258, "body": "Guys I removed error checking before hand because I wanted to make it more readable and letting you focus on the relevant part of the question. Anyway thanks for the suggestions."}], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 4, "last_activity_date": 1454872048, "last_edit_date": 1454872048, "creation_date": 1454865422, "answer_id": 35256530, "question_id": 35252253, "link": "https://stackoverflow.com/questions/35252253/golang-session-based-authentication/35256530#35256530", "title": "Golang session based authentication", "body": "<p>Importantly, you should check all of your errors - e.g.:</p>\n\n<pre><code>- hashedPassword, _ := bcrypt.GenerateFromPassword([]byte(r.Form[\"passwordSignup\"][0]), bcrypt.DefaultCost)\n# Check our error, especially for something as important as password hashing\n+ hashedPassword, err := bcrypt.GenerateFromPassword([]byte(r.Form[\"passwordSignup\"][0]), bcrypt.DefaultCost)\nif err != nil {\n    http.Error(w, http.StatusText(http.StatusBadRequest), http.StatusBadRequest)\n    return\n}\n</code></pre>\n\n<hr>\n\n<p>A lot of your relevant cookie code is missing, but here's what it <em>should</em> look like:</p>\n\n<pre><code>cookie := &amp;http.Cookie{\n        Name: \"my_app\",\n        Value: val, // Some encoded value\n        Path: \"/\", // Otherwise it defaults to the /login if you create this on /login (standard cookie behaviour)\n        MaxAge: 86400, // One day\n}\n\nhttp.SetCookie(w, cookie)\n</code></pre>\n\n<p>Alternatively, if you use <a href=\"http://www.gorillatoolkit.org/pkg/sessions\" rel=\"nofollow\">gorilla/sessions</a> (which I recommend because it correctly authenticates cookies), you would do the following:</p>\n\n<pre><code>session, err := store.Get(r, \"session-name\")\nif err != nil {\n    http.Error(w, err.Error(), 500)\n    return\n}\n\nsession.Options.Path = \"/\"\nsession.Values[\"user\"] = user\n\nerr := session.Save(r, w)\nif err != nil {\n    http.Error(w, err.Error(), 500)\n    return\n}\n\nhttp.Redirect(w, r, \"/\", 301)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 413, "user_id": 1998564, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fca1e48319b39e4708f38ee2e0a5866c?s=128&d=identicon&r=PG", "display_name": "Caustic", "link": "https://stackoverflow.com/users/1998564/caustic"}, "is_accepted": false, "score": 0, "last_activity_date": 1551932143, "creation_date": 1551932143, "answer_id": 55035982, "question_id": 35252253, "link": "https://stackoverflow.com/questions/35252253/golang-session-based-authentication/55035982#55035982", "title": "Golang session based authentication", "body": "<p>If you're looking for a simple session management solution which uses Redis or Memcache as your session store, I suggest using <a href=\"https://github.com/abraithwaite/jeff\" rel=\"nofollow noreferrer\">Jeff</a> (disclaimer: I wrote it).</p>\n\n<p>After authenticating a user, you simply add their session like so:</p>\n\n<pre><code>func (s Server) Login(w http.ResponseWriter, r *http.Request) {\n    user = Authenticate(r)\n    if user != nil {\n        // Key must be unique to one user among all users\n        err := s.jeff.Set(r.Context(), w, user.Email)\n        // handle error\n    }\n    // finish login\n}\n</code></pre>\n\n<p>Subsequent requests will automatically be authenticated once wrapped with the Jeff middleware.  The library was built with simplicity in mind and was built as an alternative to the existing libraries out there.</p>\n\n<p>See the readme for more details on usage and features:</p>\n\n<p><a href=\"https://github.com/abraithwaite/jeff#usage\" rel=\"nofollow noreferrer\">https://github.com/abraithwaite/jeff#usage</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3212497"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7739, "favorite_count": 3, "accepted_answer_id": 35256530, "answer_count": 2, "score": 0, "last_activity_date": 1551932143, "creation_date": 1454840574, "question_id": 35252253, "link": "https://stackoverflow.com/questions/35252253/golang-session-based-authentication", "title": "Golang session based authentication", "body": "<p>I am trying to authenticate a user (using email and password) in golang but I am having some problems with sessions. It seems like I cant retrieve the session value from <strong>/login/</strong> to <strong>/</strong> (home) page. </p>\n\n<p><strong>User Registration</strong></p>\n\n<pre><code>hashedPassword, _ := bcrypt.GenerateFromPassword([]byte(r.Form[\"passwordSignup\"][0]), bcrypt.DefaultCost)\n\nerr = c.Insert(&amp;model.UserModel{\n  Email:     r.Form[\"emailSignup\"][0],\n  Password:  string(hashedPassword),\n  CreatedAt: time.Now(),\n})\n\n// TODO : should session management be made in here ???\n// you can use gorilla sessions if you want as far it works\n\nhttp.SetCookie(w, cookie)\nhttp.Redirect(w, r, \"/\", 301) // goes to the homepage(only accessed by authenticated users)\n</code></pre>\n\n<p><strong>Login</strong></p>\n\n<pre><code>if r.Form[\"emailLogin\"][0] == result.Email \n&amp;&amp; bcrypt.CompareHashAndPassword([]byte(result.Password), []byte(r.Form[\"passwordLogin\"][0])) == nil {\n\n  // TODO : Handling the session in here\n\n  http.Redirect(w, r, \"/\", 301) // goes to the home page\n} else {\n  http.Redirect(w, r, \"/login/\", 301)\n}\n</code></pre>\n\n<p>I checked this links too :\n<a href=\"http://shadynasty.biz/blog/2012/09/05/auth-and-sessions/\" rel=\"nofollow\">http://shadynasty.biz/blog/2012/09/05/auth-and-sessions/</a>\n<a href=\"https://www.youtube.com/watch?v=p0tGnjW_xxI\" rel=\"nofollow\">https://www.youtube.com/watch?v=p0tGnjW_xxI</a></p>\n"}, {"tags": ["go", "nested-map"], "answers": [{"comments": [{"owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "reply_to_user": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "edited": false, "score": 0, "creation_date": 1454848540, "post_id": 35253006, "comment_id": 58219578, "body": "@SohailShaikh I updated the answer to provide you with another code solution of what you want to achieve."}], "tags": [], "owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "is_accepted": true, "score": 0, "last_activity_date": 1454847778, "last_edit_date": 1454847778, "creation_date": 1454845331, "answer_id": 35253006, "question_id": 35250981, "link": "https://stackoverflow.com/questions/35250981/cant-get-appropriate-output-while-concating-string-with-nested-map/35253006#35253006", "title": "Can&#39;t get appropriate output while concating string with nested map", "body": "<p>The issue is that you are initializing the nested map of \"key\" in each called, so it always overrides the previous data.</p>\n\n<p>So just changing your line</p>\n\n<pre><code>retMap[key] = make(map[string]string) // If not assign here then it gives runtime error \"panic: assignment to entry in nil map\"\n</code></pre>\n\n<p>to the below should make your code work:</p>\n\n<pre><code>=_, ok := retMap[key]\nif !ok {\n    retMap[key] = make(map[string]string)\n}\n</code></pre>\n\n<p>I'm just checking the existence of a value stored for \"key\", and initialize a new map if it doesn't exist.</p>\n\n<hr>\n\n<p><strong>Updated</strong>:</p>\n\n<p>I also rewrote your code to use some built-in functions that Go provide with, as <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\">strings.Split</a> or <a href=\"https://golang.org/pkg/strings/#Trim\" rel=\"nofollow\">strings.Trim*</a> functions. It could be helpful.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\nconst str = \"Hello @John martin #sosos &amp;Hi @William \"\n\nfunc main() {\n    retMap := make(map[string]map[string]string)\n    retMap[\"group\"] = make(map[string]string)\n    retMap[\"user\"] = make(map[string]string)\n    retMap[\"hashTag\"] = make(map[string]string)\n    list := strings.Split(strings.TrimSpace(str), \" \")\n\n    for _, value := range list {\n        firstCharacter := string(value[0])\n        if firstCharacter == \"@\" {\n            retMap[\"user\"][strconv.Itoa(len(retMap[\"user\"])+1)] = strings.TrimLeft(value, \"@\")\n        } else if firstCharacter == \"&amp;\" {\n            retMap[\"group\"][strconv.Itoa(len(retMap[\"group\"])+1)] = strings.TrimLeft(value, \"&amp;\")\n        } else if firstCharacter == \"#\" {\n            retMap[\"hashTag\"][strconv.Itoa(len(retMap[\"hashTag\"])+1)] = strings.TrimLeft(value, \"#\")\n        }\n    }\n\n    fmt.Println(\"Final String \", retMap)\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 35253006, "answer_count": 1, "score": 0, "last_activity_date": 1454847778, "creation_date": 1454830671, "last_edit_date": 1495540346, "question_id": 35250981, "link": "https://stackoverflow.com/questions/35250981/cant-get-appropriate-output-while-concating-string-with-nested-map", "title": "Can&#39;t get appropriate output while concating string with nested map", "body": "<p>I'm new with galang and I want to concat string with nested map. Below is the dummy code given, point out my mistake. Thanks in advance</p>\n\n<pre><code>    import (\n    \"fmt\"\n    \"strconv\"\n    )\n\n    func main() {\n    str := \"Hello @John martin #sosos &amp;Hi @William \"\n    var key string = \"\"\n    var ku int = 0\n    var kh int = 0\n    var kg int = 0\n    var id string\n    var col string \n    var retMap = make(map[string]map[string]string)\n    retMap[key] = make(map[string]string)    \n    for i := 0; i &lt; len(str); i++ {\n      //fmt.Println(string(str[i]), \" &gt;&gt; \", str[i])\n      if str[i] == 64 || str[i] == 35 || str[i] == 38 {\n        if str[i] == 64 {\n          ku++\n          key = \"user\"\n          id = strconv.Itoa(ku)\n      } else if str[i] == 35 {\n        kh++\n        key = \"hashTag\"\n        id = strconv.Itoa(kh)\n      } else {\n        kg++\n        key = \"group\"\n        id = strconv.Itoa(kg)\n      }\n      retMap[key] = make(map[string]string) // If not assign here then it gives runtime error \"panic: assignment to entry in nil map\"\n      for j := i + 1; j &lt; len(str); j++ {\n        col = col + string(str[j])\n        if str[j] == 32 {\n          j = len(str) - 1\n          retMap[key][id] = retMap[key][id] + col\n          col = \" \"\n        }\n      }\n    }\n }\n fmt.Println(\"Final String \",retMap)\n}\n</code></pre>\n\n<p>Output : \nFinal String  map[group:map[1: Hi ] user:map[2: William ] hashTag:map[1: sosos ]]</p>\n\n<p>Expected Output : </p>\n\n<p>Final String  map[group:map[1: Hi ] user:map[1: John, 2: William ] hashTag:map[1: sosos ]] </p>\n\n<p>It might be duplicate of </p>\n\n<p><a href=\"https://stackoverflow.com/questions/15117513/runtime-error-assignment-to-entry-in-nil-map\">Runtime error: &quot;assignment to entry in nil map&quot;</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/27267900/runtime-error-assignment-to-entry-in-nil-map\">Runtime error: assignment to entry in nil map</a></p>\n\n<p>but not understand kindly provide me a solution. Thanks</p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1454829855, "post_id": 35250846, "comment_id": 58214681, "body": "I get no output. What is your output from <code>go version</code> and <code>go env</code>."}, {"owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1454830017, "post_id": 35250846, "comment_id": 58214709, "body": "I just updated the question with the info you requested"}], "answers": [{"comments": [{"owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "edited": false, "score": 0, "creation_date": 1454831011, "post_id": 35250991, "comment_id": 58214900, "body": "So i guess my program was running with 1 CPU and 2 consumers do nothing rather than increase the counter, it&#39;s too fast so the consumer 1 would likely to complete its task before consumer 2 to take part in? What do you think @peterSO?"}, {"owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "edited": false, "score": 0, "creation_date": 1454869301, "post_id": 35250991, "comment_id": 58226845, "body": "I see, but I still can&#39;t figure out why my consumer&#39;s are always 667 and 333. Even with 1 CPU, there&#39;s must be a clear explanation about this."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "edited": false, "score": 0, "creation_date": 1454876799, "post_id": 35250991, "comment_id": 58229717, "body": "@vutran: See my revised answer."}, {"owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "edited": false, "score": 0, "creation_date": 1454876969, "post_id": 35250991, "comment_id": 58229787, "body": "Thank you @peterSO, your answer is really informative."}, {"owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "edited": false, "score": 0, "creation_date": 1455015285, "post_id": 35250991, "comment_id": 58290079, "body": "how can i reach you in private?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1454876771, "last_edit_date": 1454876771, "creation_date": 1454830734, "answer_id": 35250991, "question_id": 35250846, "link": "https://stackoverflow.com/questions/35250846/why-goroutines-executive-order-is-the-same-between-runs/35250991#35250991", "title": "why goroutines executive order is the same between runs", "body": "<p>The Go goroutine scheduling algorithm is not defined in The Go Programming Language Specification. It's undefined and, therefore, it's implementation and version dependent. Current implementations of Go use a cooperative scheduling scheme. The cooperative scheduling scheme relies on the goroutines to perform operations which yield to the scheduler from time to time. The scheduler code is in package runtime. </p>\n\n<p>The program is dependent on Go channel operations.</p>\n\n<p>The program is also dependent on the hardware (for example, number of CPUs), the operating system, and other running programs.</p>\n\n<p>Your code should not expect a particular distribution from goroutine scheduling.</p>\n\n<p>Go 1.4 defaults to GOMAXPROCS(1); for Go 1.5 and later, it defaults to NumCPU().</p>\n\n<p>I've modified your program to fix bugs (additional wait statements), display diagnostic information, and yield to the scheduler (Gosched()) at certain points. Now, the program closely reproduces your results on Go 1.6 (devel tip), NumCPU() == 8, GOMAXPROCS(8) and  on Go Playround, Go 1.5.1,  NumCPU() == 1, GOMAXPROCS(1). Yielding to the goroutine scheduler at certain points in tight loops, and not at other points, was the key to reproducing your results.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc main() {\n    fmt.Println(runtime.Version())\n    fmt.Println(runtime.NumCPU())\n    fmt.Println(runtime.GOMAXPROCS(0))\n    producer := make(chan int, 100)\n    wait := make(chan int, 100)\n    go func() {\n        for i := 0; i &lt; 1000; i++ {\n            producer &lt;- i\n            runtime.Gosched()\n        }\n        close(producer)\n        wait &lt;- 1\n    }()\n    go func() {\n        count := 0\n        for _ = range producer {\n            count++\n        }\n        fmt.Printf(\"Consumer 1: %d\\n\", count)\n        wait &lt;- 1\n    }()\n    go func() {\n        count := 0\n        for _ = range producer {\n            count++\n            runtime.Gosched()\n        }\n        fmt.Printf(\"Consumer 2: %d\\n\", count)\n        wait &lt;- 1\n    }()\n    &lt;-wait\n    &lt;-wait\n    &lt;-wait\n}\n</code></pre>\n\n<p>With yielding (Gosched()):</p>\n\n<pre><code>&gt; go run yield.go\n8\n8\nConsumer 1: 668\nConsumer 2: 332\n&gt; go run yield.go\ndevel +54b4b94 Sat Feb 6 23:33:23 2016 +0000\n8\n8\nConsumer 2: 336\nConsumer 1: 664\n&gt; go run yield.go\ndevel +54b4b94 Sat Feb 6 23:33:23 2016 +0000\n8\n8\nConsumer 2: 333\nConsumer 1: 667\n&gt;\n</code></pre>\n\n<p>playground: <a href=\"https://play.golang.org/p/griwLmsPDf\" rel=\"nofollow\">https://play.golang.org/p/griwLmsPDf</a></p>\n\n<pre><code>go1.5.1\n1\n1\nConsumer 1: 674\nConsumer 2: 326\ngo1.5.1\n1\n1\nConsumer 1: 674\nConsumer 2: 326\ngo1.5.1\n1\n1\nConsumer 1: 674\nConsumer 2: 326\n</code></pre>\n\n<p>For comparison, without yielding:</p>\n\n<pre><code>&gt; go run noyield.go\ndevel +54b4b94 Sat Feb 6 23:33:23 2016 +0000\n8\n8\nConsumer 1: 81\nConsumer 2: 919\n&gt; go run noyield.go\ndevel +54b4b94 Sat Feb 6 23:33:23 2016 +0000\n8\n8\nConsumer 1: 123\nConsumer 2: 877\n&gt; go run noyield.go\ndevel +54b4b94 Sat Feb 6 23:33:23 2016 +0000\n8\n8\nConsumer 1: 81\nConsumer 2: 919\n&gt; go run noyield.go\ndevel +54b4b94 Sat Feb 6 23:33:23 2016 +0000\n8\n8\nConsumer 2: 673\nConsumer 1: 327\n</code></pre>\n\n<p>playground: <a href=\"https://play.golang.org/p/2KV1B04VUJ\" rel=\"nofollow\">https://play.golang.org/p/2KV1B04VUJ</a></p>\n\n<pre><code>go1.5.1\n1\n1\nConsumer 1: 100\nConsumer 2: 900\ngo1.5.1\n1\n1\nConsumer 1: 100\nConsumer 2: 900\ngo1.5.1\n1\n1\nConsumer 1: 100\nConsumer 2: 900\n</code></pre>\n"}], "owner": {"reputation": 1895, "user_id": 702772, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f52d6eda1d907af7b1a7b477eeed8fd8?s=128&d=identicon&r=PG", "display_name": "vutran", "link": "https://stackoverflow.com/users/702772/vutran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 1, "accepted_answer_id": 35250991, "answer_count": 1, "score": 2, "last_activity_date": 1454876771, "creation_date": 1454829474, "last_edit_date": 1454829995, "question_id": 35250846, "link": "https://stackoverflow.com/questions/35250846/why-goroutines-executive-order-is-the-same-between-runs", "title": "why goroutines executive order is the same between runs", "body": "<p>I have a simple go program which has 2 consumer channels reading from one producer at the same time like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    producer := make(chan int)\n    wait := make(chan int)\n    go func() {\n        for i := 0; i &lt; 1000; i++ {\n            producer &lt;- i\n        }\n        close(producer)\n        wait &lt;- 1\n    }()\n\n    go func() {\n        count := 0\n        for _ = range producer {\n            count++\n        }\n        fmt.Printf(\"Consumer 1: %i\\n\", count)\n    }()\n\n    go func() {\n        count := 0\n        for _ = range producer {\n            count++\n        }\n        fmt.Printf(\"Consumer 2: %i\\n\", count)\n    }()\n    &lt;-wait\n}\n</code></pre>\n\n<p>I was expecting two consumers get the same number of data or at least nearly equal. However the result is always:</p>\n\n<pre><code>Consumer 1: %!i(int=667)\nConsumer 2: %!i(int=333)\n</code></pre>\n\n<p>It stays the same between multiple runs. Can anyone explain this behavior for me?</p>\n\n<p><strong>Environment</strong>:</p>\n\n<pre><code>go version go1.4.2 darwin/amd64\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/usr/local/go/:/Users/victor/Dropbox/projects/go/\"\nGORACE=\"\"\nGOROOT=\"/usr/local/Cellar/go/1.4.2/libexec\"\nGOTOOLDIR=\"/usr/local/Cellar/go/1.4.2/libexec/pkg/tool/darwin_amd64\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n"}, {"tags": ["memory-management", "go", "garbage-collection"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1454827076, "last_edit_date": 1454827076, "creation_date": 1454826465, "answer_id": 35250462, "question_id": 35249583, "link": "https://stackoverflow.com/questions/35249583/do-golang-garbage-collector-improvements-in-1-5-affect-the-amount-of-memory-dea/35250462#35250462", "title": "Do Golang garbage collector improvements in 1.5+ affect the amount of memory deallocated?", "body": "<p>It depends on your pattern of heap memory usage. The primary goals were efficient use of memory with more predictable and shorter pauses by the garbage collector (GC). To achieve this, there is some increase in CPU usage and, unless necessary, some garbage collection may be postponed to the next run of the GC. The GC will run more often and make better use of available cores. Generally, people report much shorter and more even pauses. Generally, it's a big win. Go 1.6 improves on Go 1.5, which was the first release of the new GC. Go 1.7 will be even better.</p>\n\n<p>Careful programming to reduce unneccessary GC usage makes a big difference to performance.</p>\n"}], "owner": {"reputation": 5900, "user_id": 698632, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/iCuMO.jpg?s=128&g=1", "display_name": "Dakusan", "link": "https://stackoverflow.com/users/698632/dakusan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 1, "accepted_answer_id": 35250462, "answer_count": 1, "score": 2, "last_activity_date": 1454827076, "creation_date": 1454817850, "question_id": 35249583, "link": "https://stackoverflow.com/questions/35249583/do-golang-garbage-collector-improvements-in-1-5-affect-the-amount-of-memory-dea", "title": "Do Golang garbage collector improvements in 1.5+ affect the amount of memory deallocated?", "body": "<p>Google's go has been making massive strides in the last 2 major versions to their garbage collector. The amount of time time the garbage collector is running is in near negligible amounts compared to what it was previously. I'm wondering if these improvements are at the sacrifice of anything else.</p>\n\n<p>Does go 1.6 still deallocate just as much on a garbage collection run as go 1.4?</p>\n\n<p>Does the garbage collection actually deallocate everything it possibly could at the point that it runs, or does it make concessions to speed things up?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "edited": false, "score": 0, "creation_date": 1454798759, "post_id": 35247418, "comment_id": 58208548, "body": "Thanks, that did work. Not sure why though. I understand why I can do <code>t.AppId</code>, but <code>t.Temperature</code> is not nested, <code>t</code> is a <code>Temperature</code>, or am I not getting that correctly?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "edited": false, "score": 0, "creation_date": 1454800380, "post_id": 35247418, "comment_id": 58209038, "body": "@Cimm: See my revised answer for an explanation."}, {"owner": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "edited": false, "score": 0, "creation_date": 1454877425, "post_id": 35247418, "comment_id": 58229978, "body": "Perfect answer! Thank as ton!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1454803484, "last_edit_date": 1454803484, "creation_date": 1454798569, "answer_id": 35247418, "question_id": 35247287, "link": "https://stackoverflow.com/questions/35247287/how-to-pass-a-nested-struct-in-go/35247418#35247418", "title": "How to pass a nested struct in Go", "body": "<pre><code>type Config struct {\n    Temperatures []struct {\n        Temperature\n    }\n}\n</code></pre>\n\n<p><code>t</code> is <code>Config.Temperatures[i]</code>. For <code>Temperature</code> from anonymous <code>struct { Temperature }</code>, write <code>t.Temperature</code> to select the field from the struct.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"configuration\"\n\nvar c configuration.Config = configuration.Load()\n\nfunc main() {\n    for _, t := range c.Temperatures {\n        fetchTemperature(t.Temperature)\n    }\n}\n\nfunc fetchTemperature(t configuration.Temperature) {\n    //  -- 8&lt; -- snip -- 8&lt; --\n}\n</code></pre>\n\n<p>I suspect that your confusion arose because you wrote</p>\n\n<pre><code>type Config struct {\n    Temperatures []struct {\n        Temperature\n    }\n}\n</code></pre>\n\n<p><code>Temperatures</code> is a slice of type anonymous <code>struct { configuration.Temperature }</code>.</p>\n\n<p>What you probably wanted was</p>\n\n<pre><code>type Config struct {\n    Temperatures []Temperature\n}\n</code></pre>\n\n<p><code>Temperatures</code> is a slice of type <code>configuration.Temperature</code>.</p>\n"}], "owner": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 795, "favorite_count": 2, "accepted_answer_id": 35247418, "answer_count": 1, "score": 2, "last_activity_date": 1454803484, "creation_date": 1454797748, "last_edit_date": 1454798818, "question_id": 35247287, "link": "https://stackoverflow.com/questions/35247287/how-to-pass-a-nested-struct-in-go", "title": "How to pass a nested struct in Go", "body": "<p>A little 2 file application that reads a config file and stores it in a <code>struct</code>. How do pass <strong>part of the config <code>struct</code></strong> to the <code>fetchTemperature</code> function?</p>\n\n<p><strong>Configuration</strong></p>\n\n<pre><code>package configuration\n\ntype Config struct {\n    Temperatures []struct {\n        Temperature\n    }\n}\n\ntype Temperature struct {\n    AppId string\n}\n\nfunc Load() Config {\n    var c Config\n    // -- 8&lt; -- snip -- 8&lt; --\n    return c\n}\n</code></pre>\n\n<p><strong>Main</strong></p>\n\n<pre><code>package main\n\nimport \"configuration\"\n\nvar c configuration.Config = configuration.Load()\n\nfunc main() {\n    for _, t := range c.Temperatures {\n        fetchTemperature(t)\n    }\n}\n\nfunc fetchTemperature(t configuration.Temperature) {\n    // -- 8&lt; -- snip -- 8&lt; --\n}\n</code></pre>\n\n<p>Gives me:</p>\n\n<p><code>cannot use t (type struct { configuration.Temperature }) as type configuration.Temperature in argument to fetchTemperature</code></p>\n\n<p>Isn't <code>t</code> of <code>configuration.Temperature</code> and if not, how do I pass the <code>struct</code> around?</p>\n"}, {"tags": ["mongodb", "go", "mongodb-query", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "edited": false, "score": 0, "creation_date": 1454798970, "post_id": 35247336, "comment_id": 58208608, "body": "Perfect! Thank you so much!"}], "tags": [], "owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "is_accepted": true, "score": 4, "last_activity_date": 1454798144, "creation_date": 1454798144, "answer_id": 35247336, "question_id": 35247241, "link": "https://stackoverflow.com/questions/35247241/how-do-i-remove-an-array-item-in-mongodb-golang/35247336#35247336", "title": "How do I remove an array item in Mongodb / Golang?", "body": "<p>The <a href=\"https://docs.mongodb.org/manual/reference/operator/update/pull/\" rel=\"nofollow\"><code>$pull</code></a> operator is a \"top level\" operator in update statements, so you simply have this the wrong way around:</p>\n\n<pre><code>    change := bson.M{\"$pull\": bson.M{\"artists\": bson.ObjectIdHex(artistId)}}\n</code></pre>\n\n<p>The order of update operators is always operator first, action second.</p>\n\n<p>If there is no operator at the \"top level\" keys, MongoDB interprets this as just a \"plain object\" to update and \"replace\" the matched document. Hence the error about the <code>$</code> in the key name.</p>\n"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2374, "favorite_count": 0, "accepted_answer_id": 35247336, "answer_count": 1, "score": 2, "last_activity_date": 1454798353, "creation_date": 1454797473, "last_edit_date": 1454798137, "question_id": 35247241, "link": "https://stackoverflow.com/questions/35247241/how-do-i-remove-an-array-item-in-mongodb-golang", "title": "How do I remove an array item in Mongodb / Golang?", "body": "<p>I have the following data structure, and I'm attempting to remove an item from the 'artists' array.</p>\n\n<pre><code>[\n    {\n        \"id\": \"56b26eeb4a876400011369e9\",\n        \"name\": \"Ewan Valentine\",\n        \"email\": \"ewan@test.com\",\n        \"artists\": [\n            \"56b26f334a876400011369ea\",\n            \"56b2702881318d0001dd1441\",\n            \"56b2746fdf1d7e0001faaa92\",\n        ],\n        \"user_location\": \"Manchester, UK\"\n    }\n]\n</code></pre>\n\n<p>Here's my function...</p>\n\n<pre><code>// Remove artist from user\nfunc (repo *UserRepo) RemoveArtist(userId string, artistId string) error {\n    change := bson.M{\"artists\": bson.M{\"$pull\": bson.ObjectIdHex(artistId)}}\n    fmt.Println(userId)\n    err := repo.collection.UpdateId(bson.ObjectIdHex(userId), change)\n    return err\n}\n</code></pre>\n\n<p>I'm getting the following error:</p>\n\n<pre><code>{\n  \"_message\": {\n    \"Err\": \"The dollar ($) prefixed field '$pull' in 'artists.$pull' is not valid for storage.\",\n    \"Code\": 52,\n    \"N\": 0,\n    \"Waited\": 0,\n    \"FSyncFiles\": 0,\n    \"WTimeout\": false,\n    \"UpdatedExisting\": false,\n    \"UpsertedId\": null\n  }\n}\n</code></pre>\n"}, {"tags": ["go", "go-html-template"], "answers": [{"tags": [], "owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "is_accepted": true, "score": 0, "last_activity_date": 1454792102, "creation_date": 1454792102, "answer_id": 35246349, "question_id": 35246270, "link": "https://stackoverflow.com/questions/35246270/render-data-into-a-template-in-golang/35246349#35246349", "title": "Render data into a template in golang", "body": "<p>You can create a struct and pass to <code>Execute</code> function</p>\n\n<pre><code>...\nresult := struct {\n        StartupData []model.StartupModel\n        EventData []model.EventModel\n    }{\n        StartupData : startupData,\n        EventData : eventData,\n    }\nt.Execute(w, result)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3212497"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "closed_date": 1454792369, "accepted_answer_id": 35246349, "answer_count": 1, "score": 0, "last_activity_date": 1454792102, "creation_date": 1454791583, "question_id": 35246270, "link": "https://stackoverflow.com/questions/35246270/render-data-into-a-template-in-golang", "closed_reason": "Duplicate", "title": "Render data into a template in golang", "body": "<p>I want to render 2 different data(startup, event in this case) at the same time into html using golangs' html/template.</p>\n\n<pre><code>var startupData []model.StartupModel\nerr = startupCollection.Find(nil).Sort(\"-timestamp\").All(&amp;startupData )\n\nvar eventData []model.EventModel\nerr = eventCollection.Find(nil).Sort(\"-timestamp\").All(&amp;eventData )\n</code></pre>\n\n<p>How can I combine both startupData and EventData into a variable so that I can render as the following ?</p>\n\n<pre><code>    t.Execute(w, result) // result is eventData + startupData\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1454791754, "post_id": 35245649, "comment_id": 58206369, "body": "I think what happens is that it uses parallel connections to download the file, which is why you need a WriterAt interface (much like in a torrent file). This shouldn&#39;t be that hard to implement.  If you need sequential read/write, try this other library for s3: <a href=\"https://github.com/mitchellh/goamz/blob/master/s3/s3.go#L188\" rel=\"nofollow noreferrer\">github.com/mitchellh/goamz/blob/master/s3/s3.go#L188</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1454794983, "post_id": 35245649, "comment_id": 58207427, "body": "The s3manager.Downloader is specially for downloading to a file with parallel connections. If you want to stream the file without buffering it locally, don&#39;t use the s3manager."}], "answers": [{"comments": [{"owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "edited": false, "score": 0, "creation_date": 1454832374, "post_id": 35248479, "comment_id": 58215134, "body": "This is exactly what I was looking for. It&#39;s my first time working with the s3 service. I didn&#39;t know they provided such functionality. Thank you :-)"}, {"owner": {"reputation": 453, "user_id": 280548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704a932e80905fab4aef95920f20e85e?s=128&d=identicon&r=PG", "display_name": "Jason D.", "link": "https://stackoverflow.com/users/280548/jason-d"}, "edited": false, "score": 0, "creation_date": 1464284877, "post_id": 35248479, "comment_id": 62434154, "body": "Suggest not adding the &quot;Endpoint&quot; parameter to the config unless you really need to. The Endpoint will automatically be built by the SDK as needed based on the &quot;Region&quot; and service."}], "tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": true, "score": 7, "last_activity_date": 1454806486, "creation_date": 1454806486, "answer_id": 35248479, "question_id": 35245649, "link": "https://stackoverflow.com/questions/35245649/aws-s3-large-file-reverse-proxying-with-golangs-http-responsewriter/35248479#35248479", "title": "AWS S3 large file reverse proxying with golang&#39;s http.ResponseWriter", "body": "<p>If the file is potentially large, you don't want it to go trough your own server.\nThe best approach (in my opinion) is to have the user download it directly from S3.</p>\n\n<p>You can do this by generating a <strong><em>presigned url</em></strong>:</p>\n\n<pre><code>func Download(w http.ResponseWriter, r *http.Request) {\n\n    ...\n\n    sess := session.New(&amp;aws.Config{\n        Region:             aws.String(\"eu-west-1\"),\n        Endpoint:           aws.String(\"s3-eu-west-1.amazonaws.com\"),\n        S3ForcePathStyle:   aws.Bool(true),\n        Credentials:        cred,\n    })\n\n    s3svc := s3.New(sess)\n    req, _ := s3svc.GetObjectRequest(&amp;s3.GetObjectInput{\n        Bucket: aws.String(BUCKET),\n        Key: aws.String(filename),\n    })\n\n    url, err := req.Presign(5 * time.Minute)\n    if err != nil {\n        //handle error\n    }\n\n    http.Redirect(w, r, url, http.StatusTemporaryRedirect)\n}\n</code></pre>\n\n<p>The presigned url is only valid for a limited time (5 minutes in this example, adjust to your needs) and takes the user directly to S3. No need to worry about downloads anymore!</p>\n"}, {"tags": [], "owner": {"reputation": 11594, "user_id": 795896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SEIkR.jpg?s=128&g=1", "display_name": "Aidan Ewen", "link": "https://stackoverflow.com/users/795896/aidan-ewen"}, "is_accepted": false, "score": 6, "last_activity_date": 1556113113, "last_edit_date": 1556113113, "creation_date": 1556112650, "answer_id": 55831292, "question_id": 35245649, "link": "https://stackoverflow.com/questions/35245649/aws-s3-large-file-reverse-proxying-with-golangs-http-responsewriter/55831292#55831292", "title": "AWS S3 large file reverse proxying with golang&#39;s http.ResponseWriter", "body": "<p>If you <strong><em>do</em></strong> want to stream the file through your service (rather than download directly as recommended in the accepted answer) - </p>\n\n<pre><code>import (\n    ...\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/service/s3\"\n)\n\nfunc StreamDownloadHandler(w http.ResponseWriter, r *http.Request) {\n\n    sess, awsSessErr := session.NewSession(&amp;aws.Config{\n        Region:      aws.String(\"eu-west-1\"),\n        Credentials: credentials.NewStaticCredentials(\"my-aws-id\", \"my-aws-secret\", \"\"),\n    })\n    if awsSessErr != nil {\n        http.Error(w, fmt.Sprintf(\"Error creating aws session %s\", awsSessErr.Error()), http.StatusInternalServerError)\n        return\n    }\n\n    result, err := s3.New(sess).GetObject(&amp;s3.GetObjectInput{\n        Bucket: aws.String(\"my-bucket\"),\n        Key:    aws.String(\"my-file-id\"),\n    })\n    if err != nil {\n        http.Error(w, fmt.Sprintf(\"Error getting file from s3 %s\", err.Error()), http.StatusInternalServerError)\n        return\n    }\n\n    w.Header().Set(\"Content-Disposition\", fmt.Sprintf(\"attachment; filename=\\\"%s\\\"\", \"my-file.csv\"))\n    w.Header().Set(\"Cache-Control\", \"no-store\")\n\n    bytesWritten, copyErr := io.Copy(w, result.Body)\n    if copyErr != nil {\n        http.Error(w, fmt.Sprintf(\"Error copying file to the http response %s\", copyErr.Error()), http.StatusInternalServerError)\n        return\n    }\n    log.Printf(\"Download of \\\"%s\\\" complete. Wrote %s bytes\", \"my-file.csv\", strconv.FormatInt(bytesWritten, 10))\n}\n</code></pre>\n"}], "owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2185, "favorite_count": 1, "accepted_answer_id": 35248479, "answer_count": 2, "score": 3, "last_activity_date": 1556113113, "creation_date": 1454788098, "question_id": 35245649, "link": "https://stackoverflow.com/questions/35245649/aws-s3-large-file-reverse-proxying-with-golangs-http-responsewriter", "title": "AWS S3 large file reverse proxying with golang&#39;s http.ResponseWriter", "body": "<p>I have a request handler named <code>Download</code> which I want to access a large file from Amazon S3 and push it to the user's browser. My goals are:</p>\n\n<ul>\n<li>To record some request information before granting the user access to the file</li>\n<li>To not buffer the file into memory too much. Files may become too large.</li>\n</ul>\n\n<p>Here is what I've explored so far:</p>\n\n<pre><code>func Download(w http.ResponseWriter, r *http.Request) {\n\n    sess := session.New(&amp;aws.Config{\n        Region:             aws.String(\"eu-west-1\"),\n        Endpoint:           aws.String(\"s3-eu-west-1.amazonaws.com\"),\n        S3ForcePathStyle:   aws.Bool(true),\n        Credentials:        cred,\n    })\n\n    downloader := s3manager.NewDownloader(sess)\n    // I can't write directly into the ResponseWriter. It doesn't implement WriteAt. \n    // Besides, it doesn't seem like the right thing to do.\n    _, err := downloader.Download(w, &amp;s3.GetObjectInput{\n        Bucket: aws.String(BUCKET),\n        Key: aws.String(filename),\n    })\n    if err != nil {\n        log.Error(4, err.Error())\n        return\n    }\n\n}\n</code></pre>\n\n<p>I'm wondering if there isn't a better approach (given the goals I'm trying to achieve).</p>\n\n<p>Any suggestions are welcome. Thank you in advance :-)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 0, "creation_date": 1454788506, "post_id": 35245664, "comment_id": 58205338, "body": "So the <code>rand.Seed(234)</code> stored in memory and then convereted into a int when you call the <code>int()</code> on the rand function again?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "edited": false, "score": 1, "creation_date": 1454788902, "post_id": 35245664, "comment_id": 58205449, "body": "@nadermx: Not totally. <a href=\"http://www.math.utah.edu/~pa/Random/Random.html\" rel=\"nofollow noreferrer\">This article</a> might explain a little more about what is going on."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1454788176, "creation_date": 1454788176, "answer_id": 35245664, "question_id": 35245642, "link": "https://stackoverflow.com/questions/35245642/change-hex-to-string/35245664#35245664", "title": "Change hex to string", "body": "<p><a href=\"https://golang.org/pkg/math/rand/#Seed\" rel=\"nofollow\"><code>math/rand.Seed</code></a> is a function; you are printing the function's location in memory. You probably meant to do something like the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n)\n\nfunc main() {\n    rand.Seed(234) // replace with your seed value, or set the seed based off\n                   // of the current time\n    fmt.Println(\"My favorite number is\", rand.Int())\n}\n</code></pre>\n"}], "owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 35245664, "answer_count": 1, "score": 1, "last_activity_date": 1454788176, "creation_date": 1454788074, "question_id": 35245642, "link": "https://stackoverflow.com/questions/35245642/change-hex-to-string", "title": "Change hex to string", "body": "<p>I'm going through the Golang tutorial, and I am on this part</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n)\n\nfunc main() {\n    fmt.Println(\"My favorite number is\", rand.Seed)\n}\n</code></pre>\n\n<p>This returns <code>My favorite number is 0xb1c20</code> </p>\n\n<p>I have been reading on <a href=\"https://golang.org/pkg/math/rand/#Seed\" rel=\"nofollow\">https://golang.org/pkg/math/rand/#Seed</a> but I'm still a bit confused as to how have it instead of show the hex show a string</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1454788935, "post_id": 35245599, "comment_id": 58205460, "body": "Can you give an example of the type switch you plan on using?"}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 2, "last_activity_date": 1454789142, "creation_date": 1454789142, "answer_id": 35245852, "question_id": 35245599, "link": "https://stackoverflow.com/questions/35245599/golang-insist-that-package-scoped-function-has-a-particular-type/35245852#35245852", "title": "Golang insist that package-scoped function has a particular type", "body": "<p>You can assign <code>Foo</code> to an anonymous variable of type <code>FooType</code> which will the compiler will complain about if the type doesn't match, e.g.:</p>\n\n<pre><code>package main\n\ntype FooType func(a int, b float64) float32\n\nfunc Foo(a int, b float64) float32 {\n    return 2.4\n}\n\nfunc NotAFoo(a string, b bool) float32 {\n    return 2.4\n}\n\nvar _ FooType = Foo\nvar _ FooType = NotAFoo\n\nfunc main() {\n}\n</code></pre>\n\n<p>Note that the <code>var _ FooType = NotAFoo</code> blows up.  If you comment it out, the program runs fine. <a href=\"http://play.golang.org/p/OmToFwJ2p5\" rel=\"nofollow\">Playground link</a></p>\n"}], "owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 35245852, "answer_count": 1, "score": 0, "last_activity_date": 1454789557, "creation_date": 1454787785, "last_edit_date": 1454789557, "question_id": 35245599, "link": "https://stackoverflow.com/questions/35245599/golang-insist-that-package-scoped-function-has-a-particular-type", "title": "Golang insist that package-scoped function has a particular type", "body": "<p>If I have a type synonym <code>FooType</code> and a function <code>Foo</code> is there a way to insist that <code>Foo</code> is an instance of <code>FooType</code>. I'd like an explicit <code>FooType</code> so I can use it in a type switch.</p>\n\n<p>I don't want to use a <code>var</code> and function literal if I can avoid it because then I don't get an error when I attempt to redefine a function.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype FooType func(a int, b float64) float32\n\n// foo happens to be of FooType, but this relationship isn't\n// enforced by the compiler.\nfunc Foo(a int, b float64) float32 {\n    return 2.4\n}\n\nfunc main () {\n    fmt.Printf(\"type of foo: %v\\n\", reflect.TypeOf(foo))\n}\n</code></pre>\n\n<p>The motivation for this is I have two types of filters that can process streams of text or structured objects.</p>\n\n<pre><code>// process items from channel\nfunction filter1(in &lt;-chan interface{}, out chan&lt;- chan interface{}) {\n    for item := range in {\n        out &lt;- doStuff(item)\n    }\n}\n\n// process items from Scanner\nfunction filter2(scanner *Scanner, out chan&lt;- chan interface{}) {\n    for scanner.Scan() {\n        out &lt;- doStuff(scanner.Text())\n    }\n}\n</code></pre>\n\n<p>I'd like to be able to write a function that takes an <code>*exec.Cmd</code> and an array of filters and combines them.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1454780956, "post_id": 35243865, "comment_id": 58202534, "body": "You reference symbols (functions, variables, types) from other packages by name spacing with that package name - e.g. <code>middlewares.AcceptHandler</code>. This is why they are seemingly undefined and middlewares is &#39;unused&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 226, "user_id": 6245355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/371ae.jpg?s=128&g=1", "display_name": "drlff", "link": "https://stackoverflow.com/users/6245355/drlff"}, "edited": false, "score": 3, "creation_date": 1522564729, "post_id": 35246459, "comment_id": 86198225, "body": "very helpful, in-depth explanation to someone new to the language."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 18, "last_activity_date": 1454793620, "last_edit_date": 1454793620, "creation_date": 1454792785, "answer_id": 35246459, "question_id": 35243865, "link": "https://stackoverflow.com/questions/35243865/how-to-properly-import-a-package-from-sub-directory-in-golang/35246459#35246459", "title": "How to properly import a package from sub-directory in Golang?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Qualified_identifiers\" rel=\"noreferrer\">Qualified identifiers</a></p>\n  \n  <p>A qualified identifier is an identifier qualified with a package name\n  prefix. Both the package name and the identifier must not be blank.</p>\n\n<pre><code>QualifiedIdent = PackageName \".\" identifier .\n</code></pre>\n  \n  <p>A qualified identifier accesses an identifier in a different package,\n  which must be imported. The identifier must be exported and declared\n  in the package block of that package.</p>\n\n<pre><code>math.Sin  // denotes the Sin function in package math\n</code></pre>\n  \n  <p><a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"noreferrer\">Import declarations</a></p>\n  \n  <p>An import declaration states that the source file containing the declaration depends on functionality of the imported package (\u00a7Program\n  initialization and execution) and enables access to exported\n  identifiers of that package. The import names an identifier\n  (PackageName) to be used for access and an ImportPath that specifies\n  the package to be imported.</p>\n\n<pre><code>    ImportDecl       = \"import\" ( ImportSpec | \"(\" { ImportSpec \";\" } \")\" ) .\n    ImportSpec       = [ \".\" | PackageName ] ImportPath .\n    ImportPath       = string_lit .\n</code></pre>\n  \n  <p>The PackageName is used in qualified identifiers to access exported identifiers of the package within the importing source file.\n  It is declared in the file block. If the PackageName is omitted, it\n  defaults to the identifier specified in the package clause of the\n  imported package. If an explicit period (.) appears instead of a name,\n  all the package's exported identifiers declared in that package's\n  package block will be declared in the importing source file's file\n  block and must be accessed without a qualifier.</p>\n  \n  <p>The interpretation of the ImportPath is implementation-dependent but it is typically a substring of the full file name of the compiled\n  package and may be relative to a repository of installed packages.</p>\n  \n  <p>Implementation restriction: A compiler may restrict ImportPaths to non-empty strings using only characters belonging to Unicode's L, M,\n  N, P, and S general categories (the Graphic characters without spaces)\n  and may also exclude the characters !\"#$%&amp;'()*,:;&lt;=>?[]^`{|} and the\n  Unicode replacement character U+FFFD.</p>\n  \n  <p>Assume we have compiled a package containing the package clause package math, which exports function Sin, and installed the compiled\n  package in the file identified by \"lib/math\". This table illustrates\n  how Sin is accessed in files that import the package after the various\n  types of import declaration.</p>\n\n<pre><code>    Import declaration          Local name of Sin\n\n    import   \"lib/math\"         math.Sin\n    import m \"lib/math\"         m.Sin\n    import . \"lib/math\"         Sin\n</code></pre>\n  \n  <p>An import declaration declares a dependency relation between the importing and imported package. It is illegal for a package to import\n  itself, directly or indirectly, or to directly import a package\n  without referring to any of its exported identifiers. To import a\n  package solely for its side-effects (initialization), use the blank\n  identifier as explicit package name:</p>\n\n<pre><code>    import _ \"lib/math\"\n</code></pre>\n</blockquote>\n\n<p>The error</p>\n\n<pre><code>./main.go:11: imported and not used: \"gitlab.com/myapp/api-auth/middlewares\"\n</code></pre>\n\n<p>says that you have no uses of package <code>middlewares</code> in package <code>main</code>, which is true.</p>\n\n<p>The error </p>\n\n<pre><code>./main.go:42: undefined: AcceptHandler\n</code></pre>\n\n<p>says that you haven't defined <code>AcceptHandler</code> in package <code>main</code>, which is true.</p>\n\n<p>\"A qualified identifier is an identifier qualified with a package name prefix. A qualified identifier accesses an identifier in a different package, which must be imported.\"</p>\n\n<p>For example, in package <code>main</code>, use the qualified identifier <code>middlewares.AcceptHandler</code>, which is a use of import <code>\"gitlab.com/myapp/api-auth/middlewares\"</code>.</p>\n"}], "owner": {"reputation": 27333, "user_id": 309343, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0af367dc4d144a1580cac9500a29f16f?s=128&d=identicon&r=PG", "display_name": "Moon", "link": "https://stackoverflow.com/users/309343/moon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20252, "favorite_count": 6, "accepted_answer_id": 35246459, "answer_count": 1, "score": 17, "last_activity_date": 1508712569, "creation_date": 1454778545, "last_edit_date": 1508712569, "question_id": 35243865, "link": "https://stackoverflow.com/questions/35243865/how-to-properly-import-a-package-from-sub-directory-in-golang", "title": "How to properly import a package from sub-directory in Golang?", "body": "<p>I am pretty new to Golang and trying to make a simple REST api app work.</p>\n\n<p>Initially, everything was all fine since I had all code in the same directory under the <code>main</code> package.</p>\n\n<p>But, now I am at a stage where I need to start refactoring code into sub-directories and packages. Unfortunately, I have not been able to compile the app successfully.</p>\n\n<p>My <code>GOPATH</code> is set to: <code>~/.workspace</code>\nThe current app is at: <code>~/.workspace/src/gitlab.com/myapp/api-auth</code></p>\n\n<p>This is how my current code organization is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/atiDJ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/atiDJ.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Here is my <code>main.go</code></p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"os\"\n    \"strings\"\n\n    \"github.com/gorilla/context\"\n    \"github.com/justinas/alice\"\n    \"gopkg.in/mgo.v2\"\n\n    \"gitlab.com/myapp/api-auth/middlewares\"\n)\n\nfunc main() {\n    privateKey := []byte(strings.Replace(os.Getenv(\"JWT_KEY\"), \"\\\\n\", \"\\n\", -1))\n\n    conn, err := mgo.Dial(os.Getenv(\"MONGO_CONN\"))\n\n    if err != nil {\n        panic(err)\n    }\n\n    defer conn.Close()\n    conn.SetMode(mgo.Monotonic, true)\n\n    ctx := appContext{\n        conn.DB(os.Getenv(\"MONGO_DB\")),\n        privateKey,\n    }\n\n    err = ctx.db.C(\"users\").EnsureIndex(mgo.Index{\n        Key:        []string{\"username\"},\n        Unique:     true,\n        Background: true,\n        Sparse:     false,\n    })\n\n    if err != nil {\n        panic(err)\n    }\n\n    commonHandlers := alice.New(LoggingHandler, context.ClearHandler, RecoveryHandler, AcceptHandler, ContentTypeHandler)\n\n    router := NewRouter()\n    router.Post(\"/users\", commonHandlers.Append(BodyParserHandler(UserResource{})).ThenFunc(ctx.userCreationHandler))\n    router.Post(\"/sessions\", commonHandlers.Append(BodyParserHandler(UserResource{})).ThenFunc(ctx.sessionCreationHandler))\n\n    http.ListenAndServe(\":8080\", router)\n}\n\ntype appContext struct {\n    db         *mgo.Database\n    privateKey []byte\n}\n</code></pre>\n\n<p>Here is one of the middleware <code>accept.go</code> (Rest of the middleware are constructed similarly)</p>\n\n<pre><code>package middlewares\n\nimport \"net/http\"\n\n// AcceptHandler ensures proper accept headers in requests\nfunc AcceptHandler(next http.Handler) http.Handler {\n    fn := func(w http.ResponseWriter, r *http.Request) {\n        if r.Header.Get(\"Accept\") != \"application/vnd.api+json\" {\n            writeError(w, errNotAcceptable)\n            return\n        }\n\n        next.ServeHTTP(w, r)\n    }\n\n    return http.HandlerFunc(fn)\n}\n</code></pre>\n\n<p>This is the error I get when I run <code>go build</code> from root of my app.</p>\n\n<pre><code># gitlab.com/utiliti.es/api-auth\n./main.go:11: imported and not used: \"gitlab.com/myapp/api-auth/middlewares\"\n./main.go:42: undefined: LoggingHandler\n./main.go:42: undefined: RecoveryHandler\n./main.go:42: undefined: AcceptHandler\n./main.go:42: undefined: ContentTypeHandler\n./main.go:45: undefined: BodyParserHandler\n./main.go:46: undefined: BodyParserHandler\n</code></pre>\n"}, {"tags": ["html", "http", "templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5817950, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fbb5004f4b388ecaf9f4c4d00f6f4ce?s=128&d=identicon&r=PG&f=1", "display_name": "utkillr", "link": "https://stackoverflow.com/users/5817950/utkillr"}, "edited": false, "score": 0, "creation_date": 1454793528, "post_id": 35246075, "comment_id": 58206987, "body": "it seems easier and really works, thank you. But is there any way to make stuff like I wished? My goal was to include two different variables. Maybe I&#39;ve just misunderstood such thing as &quot;define&quot; and &quot;templates&quot; As I thought, &quot;define&quot; - defines template, &quot;template&quot; executes this. (both are in HTML) Also, Golang ExecuteTemplate connects template names and variables. I may be wrong because I could translate documentation not in a right way :) Thank you"}, {"owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "reply_to_user": {"reputation": 45, "user_id": 5817950, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fbb5004f4b388ecaf9f4c4d00f6f4ce?s=128&d=identicon&r=PG&f=1", "display_name": "utkillr", "link": "https://stackoverflow.com/users/5817950/utkillr"}, "edited": false, "score": 0, "creation_date": 1454869088, "post_id": 35246075, "comment_id": 58226759, "body": "@utkillr I updated my answer to explain you why your approach was not working properly. I hope it will be helpful."}, {"owner": {"reputation": 45, "user_id": 5817950, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fbb5004f4b388ecaf9f4c4d00f6f4ce?s=128&d=identicon&r=PG&f=1", "display_name": "utkillr", "link": "https://stackoverflow.com/users/5817950/utkillr"}, "edited": false, "score": 1, "creation_date": 1454960782, "post_id": 35246075, "comment_id": 58267443, "body": "it looks nice when templated info is quite common (like Name and City can be aggregated in structure called, something like, Info.  But what to do if I want to template User info (name, city, age for instance) and error info (like when password is wrong so I want to make template for error message) And both (user info and error message) should be executed to one file. I don&#39;t know, but I guess it&#39;s not nice way to create structure like &quot;InfoToShow&quot; containing fields &quot;Error&quot; and &quot;Info&quot; Or is it proper way to make smth like your item struct?"}], "tags": [], "owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "is_accepted": false, "score": 3, "last_activity_date": 1454868992, "last_edit_date": 1454868992, "creation_date": 1454790376, "answer_id": 35246075, "question_id": 35243493, "link": "https://stackoverflow.com/questions/35243493/cant-execute-template-well-in-golang/35246075#35246075", "title": "Cant execute template well in golang", "body": "<p><strong>Update (07/02/2016)</strong></p>\n\n<p>I'm gonna to try to explain as best I can why your code was not been executed properly and a proper solution using <strong>nested templates</strong>.</p>\n\n<p>In your test.html file you were importing two templates: <code>T1</code> and <code>T2</code>,</p>\n\n<pre><code>&lt;p&gt; Name is {{ template \"T1\" . }} &lt;/p&gt;\n&lt;p&gt; City is {{ template \"T2\" . }} &lt;/p&gt;\n</code></pre>\n\n<p>those templates should be defined and write in somewhere to be used (a good place to be written could be in separate files). Here is the first issue that I found, this is how you defined them:</p>\n\n<pre><code>{{ define \"T1\" }} {{ . }} {{ end }}\n{{ define \"T2\" }} {{ . }} {{ end }}\n</code></pre>\n\n<p>Note that the <code>{{.}}</code> is a shorthand for the current object, so it will render whatever the data you pass when calling the <code>ExecuteTemplate</code> function. So, to solve this issue, you should specify which object you want to render in each template:</p>\n\n<pre><code>{{ define \"T1\" }} {{ .Name }} {{ end }}\n{{ define \"T2\" }} {{ .City }} {{ end }}\n</code></pre>\n\n<p>Now, here is the second issue that I found. In your <code>TestHandler</code> function, you are just rendering the sub-templates, firstly the <code>T1</code> template, and secondly the <code>T2</code> template:</p>\n\n<pre><code>t.ExecuteTemplate(w, \"T1\", Name)\nt.ExecuteTemplate(w, \"T2\", City)\n</code></pre>\n\n<p>so at no time, you are calling to the parent template.</p>\n\n<p>Below you can find how it will look like using nested templates. I hope it will solve your doubt about how to use the templates.</p>\n\n<p><strong>test.go</strong> file</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/test.html\", TestHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc TestHandler(w http.ResponseWriter, r *http.Request) {\n    //Parsing HTML\n    t, err := template.ParseFiles(\"test2.html\", \"t1.tmpl\", \"t2.tmpl\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    items := struct {\n        Name string\n        City string\n    }{\n        Name: \"MyName\",\n        City: \"MyCity\",\n    }\n    t.Execute(w, items)\n}\n</code></pre>\n\n<p><strong>test.html</strong> file</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Templates&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;h1&gt;Testing some templates&lt;/h1&gt;\n        &lt;p&gt; Empty template: {{ `\"Some text\"` }} &lt;/p&gt;\n        &lt;p&gt; Name is {{ template \"T1\" . }} &lt;/p&gt;\n        &lt;p&gt; City is {{ template \"T2\" . }} &lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>t1.tmpl</strong> file</p>\n\n<pre><code>{{ define \"T1\" }} {{ .Name }} {{ end }}\n</code></pre>\n\n<p><strong>t2.tmpl</strong> file</p>\n\n<pre><code>{{ define \"T2\" }} {{ .City }} {{ end }}\n</code></pre>\n\n<hr>\n\n<p><strong>Without using sub-templates</strong>:</p>\n\n<p>I did some changes in your code that made it work. I just send the 'Name' and 'City' variable in a struct collection to the <a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow\">Execute</a> method. Check below:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/test.html\", TestHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc TestHandler(w http.ResponseWriter, r *http.Request) {\n    //Parsing HTML\n    t, err := template.ParseFiles(\"test.html\")\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    items := struct {\n        Name string\n        City string\n    }{\n        Name: \"MyName\",\n        City: \"MyCity\",\n    }\n\n    t.Execute(w, items)\n}\n</code></pre>\n\n<p>And using <code>{{.Name}}</code> and <code>{{.City}}</code> to access to those exported fields.</p>\n\n<pre><code>&lt;html&gt; \n    &lt;head&gt;\n        &lt;title&gt;Tamplates&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;h1&gt;Testing some templates&lt;/h1&gt;\n        &lt;p&gt; Name is {{.Name}} &lt;/p&gt;\n        &lt;p&gt; City is {{.City}} &lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5817950, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fbb5004f4b388ecaf9f4c4d00f6f4ce?s=128&d=identicon&r=PG&f=1", "display_name": "utkillr", "link": "https://stackoverflow.com/users/5817950/utkillr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3394, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454868992, "creation_date": 1454776670, "question_id": 35243493, "link": "https://stackoverflow.com/questions/35243493/cant-execute-template-well-in-golang", "title": "Cant execute template well in golang", "body": "<p>I'm trying to create some templates and I just can't understand the next thing:\nWhy doesn't such construction work?\nI've got test.go file:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"html/template\"\n    \"fmt\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/test.html\", TestHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc TestHandler(w http.ResponseWriter, r *http.Request) {\n    //Parsing HTML\n    t, err := template.ParseFiles(\"test.html\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    Name := \"MyName\"\n    City := \"MyCity\"\n    t.ExecuteTemplate(w, \"T1\", Name)\n    t.ExecuteTemplate(w, \"T2\", City)\n}\n</code></pre>\n\n<p>And I also have test.html:</p>\n\n<pre><code>&lt;html&gt;\n\n&lt;head&gt;\n    &lt;title&gt;Tamplates&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;Testing some templates&lt;/h1&gt;\n    &lt;p&gt; Empty template: {{ `\"Some text\"` }} &lt;/p&gt;\n    &lt;p&gt; Name is {{ template \"T1\" . }} &lt;/p&gt;\n    &lt;p&gt; City is {{ template \"T2\" . }} &lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>It's easy example, but somewhy it doesnt work.\nI tried adding strings <code>{{ define \"T1\" }} {{ . }} {{ end }}</code> and <code>{{ define \"T2\" }} {{ . }} {{ end }}</code>before h1 header, but it has resulted web page containing just string <code>MyName MyCity</code></p>\n"}, {"tags": ["reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1454787273, "last_edit_date": 1454787273, "creation_date": 1454771255, "answer_id": 35242532, "question_id": 35242401, "link": "https://stackoverflow.com/questions/35242401/golang-function-to-determine-the-arity-of-functions/35242532#35242532", "title": "Golang: Function to determine the arity of functions?", "body": "<p>You can write such a function using the <a href=\"https://godoc.org/reflect\" rel=\"nofollow\"><code>reflect</code></a> package:</p>\n\n<pre><code>import (\n    \"reflect\"\n)\n\nfunc arity(value interface{}) int {\n    ref := reflect.ValueOf(value)\n    tpye := ref.Type()\n    if tpye.Kind() != reflect.Func {\n        // You could define your own logic here\n        panic(\"value is not a function\")\n    }\n    return tpye.NumIn()\n}\n</code></pre>\n"}], "owner": {"reputation": 1174, "user_id": 3014291, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1ebc9b73d6687361cb5b1acd79b7d977?s=128&d=identicon&r=PG&f=1", "display_name": "frmsaul", "link": "https://stackoverflow.com/users/3014291/frmsaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 35242532, "answer_count": 1, "score": 4, "last_activity_date": 1454787273, "creation_date": 1454770533, "question_id": 35242401, "link": "https://stackoverflow.com/questions/35242401/golang-function-to-determine-the-arity-of-functions", "title": "Golang: Function to determine the arity of functions?", "body": "<p>Is it possible to write a function to determine the arity of arbitrary functions, such that:</p>\n\n<p>1.</p>\n\n<pre><code>func mult_by_2(x int) int {\n      return 2 * x\n}\nfmt.Println(arity(mult_by_2)) //Prints 1\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>func add(x int, y int) int {\n      return x + y\n}\nfmt.Println(arity(add)) //Prints 2\n</code></pre>\n\n<p>3.</p>\n\n<pre><code>func add_3_ints(a, b, c int) int {\n      return b + a + c\n}\nfmt.Println(arity(add_3_ints)) //Prints 3\n</code></pre>\n"}, {"tags": ["javascript", "go", "redux", "fetch-api"], "comments": [{"owner": {"reputation": 5499, "user_id": 1142901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sX1Wm.png?s=128&g=1", "display_name": "Salva", "link": "https://stackoverflow.com/users/1142901/salva"}, "edited": false, "score": 1, "creation_date": 1455110123, "post_id": 35240520, "comment_id": 58341226, "body": "Are you aware you are returning from your then() handler after the logs?"}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "edited": false, "score": 0, "creation_date": 1461920318, "post_id": 36545771, "comment_id": 61427276, "body": "In my solution I just changed the lib. I will have an opportunity to do it again I will try yours."}, {"owner": {"reputation": 481, "user_id": 1379089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/776f28e9038b909bf51ab473e3f96058?s=128&d=identicon&r=PG", "display_name": "Aukhan", "link": "https://stackoverflow.com/users/1379089/aukhan"}, "edited": false, "score": 0, "creation_date": 1497977008, "post_id": 36545771, "comment_id": 76302695, "body": "Thanks Iris! some of us rely on SO more than going through the docs :P"}], "tags": [], "owner": {"reputation": 684, "user_id": 3340229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2992ac2aa954919e8c701d3969ad9a4a?s=128&d=identicon&r=PG", "display_name": "Iris Schaffer", "link": "https://stackoverflow.com/users/3340229/iris-schaffer"}, "is_accepted": false, "score": 10, "last_activity_date": 1486236228, "last_edit_date": 1495540900, "creation_date": 1460369523, "answer_id": 36545771, "question_id": 35240520, "link": "https://stackoverflow.com/questions/35240520/fetch-answer-empty-due-to-the-preflight/36545771#36545771", "title": "Fetch answer empty due to the preflight?", "body": "<p>I had the problem that my headers were sent, correctly received (chrome's network tab correctly shows me all the sent headers), but I couldn't access them in js (<code>response.headers</code> was empty). As described in <a href=\"https://stackoverflow.com/questions/32127369/fetch-get-request-returns-empty-headers\">Fetch get request returns empty headers</a>, this happened because the server did not set the <code>Access-Control-Expose-Headers</code> header, resulting in the needed headers not to be exposed to js.\nSo the solution is to add this header on the server and voil\u00e0, now the headers are accessible in js:</p>\n\n<pre><code>Access-Control-Expose-Headers: &lt;header-name&gt;, &lt;header-name&gt;, ...\n</code></pre>\n\n<p>The header takes a comma-separated list of header-names to be exposed to the browser.</p>\n\n<p>For additional info on why this header is needed, see <a href=\"https://stackoverflow.com/questions/25673089/why-is-access-control-expose-headers-needed\">Why is Access-Control-Expose-Headers needed?</a></p>\n"}], "owner": {"reputation": 322, "user_id": 3581778, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/98948b56841bc5ded022c5c1f9288da2?s=128&d=identicon&r=PG", "display_name": "Manawasp", "link": "https://stackoverflow.com/users/3581778/manawasp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3572, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1486236228, "creation_date": 1454758398, "last_edit_date": 1495542263, "question_id": 35240520, "link": "https://stackoverflow.com/questions/35240520/fetch-answer-empty-due-to-the-preflight", "title": "Fetch answer empty due to the preflight?", "body": "<p>I have an webapp react.js / redux / webpackt / es6... and an api in go with mux from gorilla.<br>\nWhen I make call with the function below my header is empty and content too.    </p>\n\n<p>I'm using this package in my webapp to make calls</p>\n\n<pre><code>\"isomorphic-fetch\": \"^2.2.1\",\n</code></pre>\n\n<p>My call example</p>\n\n<pre><code>export function Login(userData) {\n  return dispatch =&gt; {\n    fetch(API + '/login', {\n      method: 'post',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        email: userData.email,\n        password: userData.password,\n      }),\n    })\n    .then(response =&gt; {\n      console.log(response);\n      console.log(response.statusText);\n      console.log(response.status);\n      console.log(response.headers);\n      console.log(response.headers.get(\"Authorization\"));\n      console.log(response.json());\n      return response.json()\n      if (response.status &gt;= 200 &amp;&amp; response.status &lt; 300) {\n        console.log(response);\n        dispatch(LoginSuccess(response));\n      } else {\n        const error = new Error(response.statusText);\n        error.response = response;\n        dispatch(LoginError(error));\n        throw error;\n      }\n    }).then(function(json) {\n      console.log('parsed json' + json)\n    })\n    .catch(error =&gt; { console.log('request failed', error); });\n  }\n</code></pre>\n\n<p>In the beginning I had a problem with cors <a href=\"https://stackoverflow.com/questions/22972066/how-to-handle-preflight-cors-requests-on-a-go-server\">How to handle preflight CORS requests on a Go server</a> I used this solution    </p>\n\n<p>We can look the call inside of the console :</p>\n\n<pre><code>login   OPTIONS   200   fetch   auths.actions.js:38 352\u2009B   1\u2009ms    \nlogin   POST      200   json    Other   567\u2009B   82\u2009ms\n</code></pre>\n\n<p>When I look inside of my POST Header response I have :</p>\n\n<pre><code>HTTP/1.1 200 OK\nAccess-Control-Allow-Headers: Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization\nAccess-Control-Allow-Methods: POST, GET, OPTIONS, PUT, PATCH, DELETE\nAccess-Control-Allow-Origin: http://localhost:3000\nAuthorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE0NTQ3NTcxNjEsInVzZXJfaWQiOiI1NmI1YjZlOTFhZTMzYjAwMDFhYmE1MTQifQ.WGoTMxm6OuN24Olwr93J3pND9dFLCtG5MyiRbqLWeD244JtDzq0bGgQMixeZxyuxwGK3u8KhyWD7Rr6iZAGNpA\nContent-Type: application/json\nDate: Sat, 06 Feb 2016 11:12:41 GMT\nContent-Length: 2\n</code></pre>\n\n<p>So the response handle my preflight information not my POST ? Because there is nothing inside of the <code>response.headers</code> and <code>response.headers.get(\"Authorization\")</code>\nThere is something wrong ?</p>\n"}, {"tags": ["winapi", "go"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1454753939, "post_id": 35238933, "comment_id": 58193835, "body": "You can&#39;t pass a <code>*string</code> to the Windows API functions and expect Go to magically fill everything in; you need to allocate a buffer of <code>uint16</code>s and pass that in instead."}, {"owner": {"reputation": 43, "user_id": 5846905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47536c50f6c57b5b61e3f2e7f1cd3569?s=128&d=identicon&r=PG&f=1", "display_name": "Khoz", "link": "https://stackoverflow.com/users/5846905/khoz"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1454759302, "post_id": 35238933, "comment_id": 58195251, "body": "You are right. Thank you. I changed type of &#39;lpVolumeNameBuffer&#39; from string to uint16. And change in print to &#39;string(lpVolumeNameBuffer)&#39;. It returns only one byte, but not the string."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1454778014, "post_id": 35238933, "comment_id": 58201393, "body": "Of course, because now you&#39;re only asking for one byte. Typically you would make a slice and pass a pointer to its first element."}], "answers": [{"tags": [], "owner": {"reputation": 1261, "user_id": 22079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a07336bf2b6ecaca5e87cda7b99b9253?s=128&d=identicon&r=PG", "display_name": "Jeff Allen", "link": "https://stackoverflow.com/users/22079/jeff-allen"}, "is_accepted": false, "score": 0, "last_activity_date": 1454750146, "creation_date": 1454750146, "answer_id": 35239317, "question_id": 35238933, "link": "https://stackoverflow.com/questions/35238933/golang-call-getvolumeinformation-winapi-function/35239317#35239317", "title": "golang, call GetVolumeInformation winapi function", "body": "<p>I don't know the exact problem you are having but I think it is likely because you are not using the functions in <a href=\"https://github.com/golang/go/blob/master/src/syscall/syscall_windows.go\" rel=\"nofollow\">https://github.com/golang/go/blob/master/src/syscall/syscall_windows.go</a> related to converting from the format that comes out of the kernel to what Go needs. Look at other callers to UTF16ToString, like in env_windows.go, to see how they are used. </p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5846905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47536c50f6c57b5b61e3f2e7f1cd3569?s=128&d=identicon&r=PG&f=1", "display_name": "Khoz", "link": "https://stackoverflow.com/users/5846905/khoz"}, "edited": false, "score": 0, "creation_date": 1454768424, "post_id": 35241861, "comment_id": 58197982, "body": "Thank you for answer and example of good practice. It works. Small correct in source. Rootname should be with double slash: var RootPathName = `C:\\`"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 43, "user_id": 5846905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47536c50f6c57b5b61e3f2e7f1cd3569?s=128&d=identicon&r=PG&f=1", "display_name": "Khoz", "link": "https://stackoverflow.com/users/5846905/khoz"}, "edited": false, "score": 0, "creation_date": 1454768598, "post_id": 35241861, "comment_id": 58198046, "body": "@Khoz: Not true. It&#39;s a raw string literal. <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">String literals</a>: &quot;Raw string literals are character sequences between back quotes, as in <code>foo</code>. Within the quotes, any character may appear except back quote. The value of a raw string literal is the string composed of the uninterpreted (implicitly UTF-8-encoded) characters between the quotes; in particular, backslashes have no special meaning and the string may contain newlines.&quot;"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1454821943, "post_id": 35241861, "comment_id": 58213365, "body": "Using <code>unsafe.Pointer</code> is the only way to use syscalls/winapi and for certain performance aspects, he obviously didn&#39;t miss the warning."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1454825207, "post_id": 35241861, "comment_id": 58213918, "body": "@OneOfOne: Neither I nor the documentation said don&#39;t use package <code>unsafe</code>. As you can see, I used package <code>unsafe</code> in my answer. Therefore your comment and downvote are clearly erroneous. As the documentation clearly explains, &quot;Package <code>unsafe</code> contains operations that step around the type safety of Go programs.  <code>unsafe.Pointer</code> should be used with extreme care.&quot; The package is named <code>unsafe</code> for  reason. I didn&#39;t say don&#39;t use it."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1454827488, "last_edit_date": 1454827488, "creation_date": 1454767059, "answer_id": 35241861, "question_id": 35238933, "link": "https://stackoverflow.com/questions/35238933/golang-call-getvolumeinformation-winapi-function/35241861#35241861", "title": "golang, call GetVolumeInformation winapi function", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/unsafe/\" rel=\"nofollow\">Package unsafe</a></p>\n  \n  <p>Package unsafe contains operations that step around the type safety of\n  Go programs.</p>\n  \n  <p><a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow\">type Pointer</a></p>\n\n<pre><code>type Pointer *ArbitraryType\n</code></pre>\n  \n  <p>Pointer represents a pointer to an arbitrary type. There are four\n  special operations available for type Pointer that are not available\n  for other types.</p>\n  \n  <p>1) A pointer value of any type can be converted to a Pointer.</p>\n  \n  <p>2) A Pointer can be converted to a pointer value of any type.</p>\n  \n  <p>3) A uintptr can be converted to a Pointer.</p>\n  \n  <p>4) A Pointer can be converted to a uintptr.</p>\n  \n  <p>Pointer therefore allows a program to defeat the type system and read\n  and write arbitrary memory. It should be used with extreme care.</p>\n</blockquote>\n\n<p>You failed to heed the warning that <code>unsafe.Pointer</code> \"should be used with extreme care.\"</p>\n\n<p>Try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nfunc main() {\n    var RootPathName = `C:\\`\n    var VolumeNameBuffer = make([]uint16, syscall.MAX_PATH+1)\n    var nVolumeNameSize = uint32(len(VolumeNameBuffer))\n    var VolumeSerialNumber uint32\n    var MaximumComponentLength uint32\n    var FileSystemFlags uint32\n    var FileSystemNameBuffer = make([]uint16, 255)\n    var nFileSystemNameSize uint32 = syscall.MAX_PATH + 1\n\n    kernel32, _ := syscall.LoadLibrary(\"kernel32.dll\")\n    getVolume, _ := syscall.GetProcAddress(kernel32, \"GetVolumeInformationW\")\n\n    var nargs uintptr = 8\n    ret, _, callErr := syscall.Syscall9(uintptr(getVolume),\n        nargs,\n        uintptr(unsafe.Pointer(syscall.StringToUTF16Ptr(RootPathName))),\n        uintptr(unsafe.Pointer(&amp;VolumeNameBuffer[0])),\n        uintptr(nVolumeNameSize),\n        uintptr(unsafe.Pointer(&amp;VolumeSerialNumber)),\n        uintptr(unsafe.Pointer(&amp;MaximumComponentLength)),\n        uintptr(unsafe.Pointer(&amp;FileSystemFlags)),\n        uintptr(unsafe.Pointer(&amp;FileSystemNameBuffer[0])),\n        uintptr(nFileSystemNameSize),\n        0)\n    fmt.Println(ret, callErr, syscall.UTF16ToString(VolumeNameBuffer))\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5846905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47536c50f6c57b5b61e3f2e7f1cd3569?s=128&d=identicon&r=PG&f=1", "display_name": "Khoz", "link": "https://stackoverflow.com/users/5846905/khoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 2, "accepted_answer_id": 35241861, "answer_count": 2, "score": 3, "last_activity_date": 1454827488, "creation_date": 1454746982, "last_edit_date": 1454794072, "question_id": 35238933, "link": "https://stackoverflow.com/questions/35238933/golang-call-getvolumeinformation-winapi-function", "title": "golang, call GetVolumeInformation winapi function", "body": "<p>Tries to call GetVolumeInformation function from golang. Want to get volume name.</p>\n\n<p>Use spec's of api:</p>\n\n<pre><code>BOOL WINAPI GetVolumeInformation(\n  _In_opt_  LPCTSTR lpRootPathName,\n  _Out_opt_ LPTSTR  lpVolumeNameBuffer,\n  _In_      DWORD   nVolumeNameSize,\n  _Out_opt_ LPDWORD lpVolumeSerialNumber,\n  _Out_opt_ LPDWORD lpMaximumComponentLength,\n  _Out_opt_ LPDWORD lpFileSystemFlags,\n  _Out_opt_ LPTSTR  lpFileSystemNameBuffer,\n  _In_      DWORD   nFileSystemNameSize\n);\n</code></pre>\n\n<p>Use code:</p>\n\n<pre><code>// test\npackage main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nfunc main() {\n    var lpRootPathName = \"C:\\\\\"\n    var lpVolumeNameBuffer string\n    var nVolumeNameSize uint64\n    var lpVolumeSerialNumber uint64\n    var lpMaximumComponentLength uint64\n    var lpFileSystemFlags uint64\n    var lpFileSystemNameBuffer string\n    var nFileSystemNameSize uint32\n\n    kernel32, _ := syscall.LoadLibrary(\"kernel32.dll\")\n    getVolume, _ := syscall.GetProcAddress(kernel32, \"GetVolumeInformationW\")\n\n    var nargs uintptr = 8\n    ret, _, callErr := syscall.Syscall9(uintptr(getVolume),\n        nargs,\n        uintptr(unsafe.Pointer(syscall.StringToUTF16Ptr(lpRootPathName))),\n        uintptr(unsafe.Pointer(&amp;lpVolumeNameBuffer)),\n        uintptr(unsafe.Pointer(&amp;nVolumeNameSize)),\n        uintptr(unsafe.Pointer(&amp;lpVolumeSerialNumber)),\n        uintptr(unsafe.Pointer(&amp;lpMaximumComponentLength)),\n        uintptr(unsafe.Pointer(&amp;lpFileSystemFlags)),\n        uintptr(unsafe.Pointer(&amp;lpFileSystemNameBuffer)),\n        uintptr(unsafe.Pointer(&amp;nFileSystemNameSize)),\n        0)\n    fmt.Println(ret, callErr, lpVolumeNameBuffer)\n}\n</code></pre>\n\n<p>... and finally have error :(</p>\n\n<pre><code>unexpected fault address 0xffffffffffffffff\nfatal error: fault\n[signal 0xc0000005 code=0x0 addr=0xffffffffffffffff pc=0x456b11]\n</code></pre>\n\n<p>Don't understand and google cant'd help with calling winapi functions and returng string as result.</p>\n\n<p>Thank's.</p>\n"}, {"tags": ["regex", "go"], "answers": [{"tags": [], "owner": {"reputation": 2169, "user_id": 974936, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/92bf3deb0a4fa650b44e7706b0736adb?s=128&d=identicon&r=PG", "display_name": "watzon", "link": "https://stackoverflow.com/users/974936/watzon"}, "is_accepted": false, "score": 2, "last_activity_date": 1454726958, "creation_date": 1454726958, "answer_id": 35236780, "question_id": 35236743, "link": "https://stackoverflow.com/questions/35236743/regex-to-match-everything-between/35236780#35236780", "title": "Regex to match everything between", "body": "<p>Never mind I figured it out!</p>\n\n<p><code>(?:&lt;&lt;&lt; .*\\r?\\n)([\\s\\S]*?)(?:[*]{5})</code></p>\n\n<p>It seems like the big thing was making the match group in the middle lazy so that it would match as little as possible.</p>\n"}, {"tags": [], "owner": {"reputation": 362892, "user_id": 256196, "user_type": "moderator", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d84b558fd67be10d5a718fb94231909d?s=128&d=identicon&r=PG", "display_name": "Bohemian", "link": "https://stackoverflow.com/users/256196/bohemian"}, "is_accepted": false, "score": 0, "last_activity_date": 1454728924, "last_edit_date": 1454728924, "creation_date": 1454728596, "answer_id": 35236950, "question_id": 35236743, "link": "https://stackoverflow.com/questions/35236743/regex-to-match-everything-between/35236950#35236950", "title": "Regex to match everything between", "body": "<p>This captures the target in group 1, but you must use the \"dot matches newline\" switch \"s\":</p>\n\n<pre><code>&lt;&lt;&lt;[^\\r\\n]+[\\r\\n]*(.*?)[*]{5}\n</code></pre>\n\n<p>See <a href=\"http://rubular.com/r/oNhoeFziff\" rel=\"nofollow\">live demo</a>.</p>\n"}], "owner": {"reputation": 2169, "user_id": 974936, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/92bf3deb0a4fa650b44e7706b0736adb?s=128&d=identicon&r=PG", "display_name": "watzon", "link": "https://stackoverflow.com/users/974936/watzon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454728924, "creation_date": 1454726593, "question_id": 35236743, "link": "https://stackoverflow.com/questions/35236743/regex-to-match-everything-between", "title": "Regex to match everything between", "body": "<p>I've been trying at this for an hour, but I'm no regexpert. What I want to do seems fairly simple, but it's turning out a lot more difficult than I would have thought.</p>\n\n<p>Basically I have this:</p>\n\n<pre><code>&lt;&lt;&lt; Some code\n\n    def prnt(string)\n        print(string)\n    end\n\n=====\n\n    def println(string)\n        puts(string)\n    end\n\n*****\n&lt;&lt;&lt; Some more code\n...\n</code></pre>\n\n<p>What I want to do is capture everything between the first line <code>&lt;&lt;&lt; Some code</code> and the <code>*****</code>. There will be lots of blocks like this in a file.</p>\n\n<p>The regex that I have so far is this <code>(?:&lt;&lt;&lt; .*\\r?\\n)([\\s\\S]+)(?:[*]{5})</code>, but it doesn't really work. Any ideas? The language I'm using it in is Go.</p>\n"}, {"tags": ["arrays", "go"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5566190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6437821f7290d61d6349c3c5dd637fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Courtney", "link": "https://stackoverflow.com/users/5566190/courtney"}, "edited": false, "score": 0, "creation_date": 1454727986, "post_id": 35236760, "comment_id": 58188177, "body": "That actually did not work I got more errors. saying tree is undefined. and not enough arguments in call to insert"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 19, "user_id": 5566190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6437821f7290d61d6349c3c5dd637fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Courtney", "link": "https://stackoverflow.com/users/5566190/courtney"}, "edited": false, "score": 0, "creation_date": 1454728401, "post_id": 35236760, "comment_id": 58188275, "body": "@Courtney: That was an earlier version of my answer. Use the current version of my answer."}, {"owner": {"reputation": 19, "user_id": 5566190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6437821f7290d61d6349c3c5dd637fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Courtney", "link": "https://stackoverflow.com/users/5566190/courtney"}, "edited": false, "score": 0, "creation_date": 1454728683, "post_id": 35236760, "comment_id": 58188338, "body": "I did, that is when I got undefined tree. I need to pass the list of ints into the BST, and the func insertList(elementList []int) was given to me to use..."}, {"owner": {"reputation": 19, "user_id": 5566190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6437821f7290d61d6349c3c5dd637fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Courtney", "link": "https://stackoverflow.com/users/5566190/courtney"}, "edited": false, "score": 0, "creation_date": 1454730117, "post_id": 35236760, "comment_id": 58188583, "body": "hey you were right except for func insertList(elementList[]ints) because in the main method the only argument was the array... thanks"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1454727496, "last_edit_date": 1454727496, "creation_date": 1454726765, "answer_id": 35236760, "question_id": 35236670, "link": "https://stackoverflow.com/questions/35236670/syntax-error-unexpected-name-expecting/35236760#35236760", "title": "syntax error: unexpected name, expecting )", "body": "<p>This should get you past the syntax errors:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype node struct {\n    left  *node\n    right *node\n    val   int\n}\n\nfunc insert(tree *node, element int) *node {\n    if tree == nil {\n        tree = &amp;node{nil, nil, element}\n    } else if element &gt; tree.val {\n        tree.right = insert(tree.right, element)\n    } else if element &lt; tree.val {\n        tree.left = insert(tree.left, element)\n    }\n    return tree\n}\n\nfunc insertList(tree *node, elementList []int) *node {\n    if tree == nil {\n        for i := 0; i &lt; len(elementList); i++ {\n            tree = insert(tree, elementList[i])\n        }\n    }\n    return tree\n}\n\nfunc displayBST(tree *node) {\n    if tree != nil {\n        displayBST(tree.left)\n        fmt.Println(tree.val)\n        displayBST(tree.right)\n    }\n}\n\nfunc main() {\n\n    l := [10]int{100, 3, 3, 200, 5, 8, 5, 200, 0, -4}\n\n    s := l[:]\n\n    var t *node\n\n    insertList(t, s)\n\n    displayBST(insertList(t, s))\n\n    fmt.Println()\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5566190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6437821f7290d61d6349c3c5dd637fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Courtney", "link": "https://stackoverflow.com/users/5566190/courtney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 664, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1454727496, "creation_date": 1454725831, "last_edit_date": 1454726808, "question_id": 35236670, "link": "https://stackoverflow.com/questions/35236670/syntax-error-unexpected-name-expecting", "title": "syntax error: unexpected name, expecting )", "body": "<p>I have my code for my BST in GO. I keep getting this error message. I am using noted pad and I am a beginner. \nthe error is in my for loop. under the insertList func.</p>\n\n<pre><code>type node struct{\n    left *node\n    right *node\n    val int\n    }\n\n\nfunc insert(tree *node, element int) *node{\n    if tree == nil{\n        tree = &amp;node{nil, nil, element}\n        } else if element &gt; tree.val{\n        tree.right = insert( tree.right, element)\n        } else if element &lt; tree.val{\n        tree.left = insert( tree.left, element)\n        }\n    return tree\n    }\nfunc insertList(elementList []int) *node{\n    if tree == nil{\n        for i:=0; i&lt;[]int.len; i++{ \n            tree = insert([i]int)}\n        return tree}}\n\nfunc displayBST(tree *node){\n    if ( tree != nil) {\n        displayBST( tree.left)\n        fmt.Println(tree.val)\n        displayBST(tree.right)}}\n\n\nfunc main(){\n\n     l := [10]int{100, 3, 3, 200, 5, 8, 5, 200, 0, -4}\n\n     s := l[:]\n\n     insertList(s)\n\n     displayBST(insertList(s))\n\n     fmt.Println()}\n</code></pre>\n"}, {"tags": ["templates", "generics", "go", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "edited": false, "score": 0, "creation_date": 1454784828, "post_id": 35240963, "comment_id": 58204045, "body": "I don&#39;t have any flexibility on changing the messages unfortunately :(  If I did I think this would solve everything though."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "edited": false, "score": 0, "creation_date": 1454786284, "post_id": 35240963, "comment_id": 58204571, "body": "@CharlesL. Then simply add a handler for each request type."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1454762179, "last_edit_date": 1454762179, "creation_date": 1454761600, "answer_id": 35240963, "question_id": 35236079, "link": "https://stackoverflow.com/questions/35236079/go-reflect-for-metaprogramming-templates/35240963#35240963", "title": "go reflect for metaprogramming/templates", "body": "<p>From my point of view, your Protobuf definition is too specific. I cleaned it down a great deal. For example: There is no need to have a different request and response header per type when all they differ in is the content. The most obvious is that I eliminated the specific request and reponse types, because again, all they differed in was their semantic meaning, which on the other hand is rather obvious from the surrounding code. This way, we have eliminated a lot of redundancy. In sum, different types of requests con be identified by the headers, be it either the presence or absence of a <code>user_id</code> field or the evaluation of the <code>content</code> field. Of course, you can expand the headers <code>value</code> selection by what you need.</p>\n\n<pre><code>// exchange.proto\nsyntax = \"proto2\";\npackage main;\n\nenum Status {\n    DONE_OK = 0;\n    DONE_ERROR = 1;\n}\n\nmessage Header {\n    required string name = 1;\n    oneof value {\n        int32 user_id = 2;\n        Status status = 3;\n        string content= 4;\n    }\n}\n\nmessage Exchange {\n    repeated Header header = 1;\n    optional bytes content = 2;\n}\n</code></pre>\n\n<p>Then, I see your <code>miniservice</code> as rather odd. You'd usually set up a service with things like DAOs, maybe other services and have them handle individual requests taking in a request object and returning a response object. For <a href=\"http://www.grpc.io/docs/\" rel=\"nofollow\">gRPC</a> services are defined with a <code>.proto</code> file like this (staying within your example)</p>\n\n<pre><code>service Miniservice {\n  rpc UserInfo(Exchange) returns (Exchange)\n}\n</code></pre>\n\n<p>Which after compiling your <code>.proto</code> basically defines the following interface</p>\n\n<pre><code>type Miniservice interface {\n    UserInfo(ctx context.Context, in *Exchange) (*Exchange, error)\n}\n</code></pre>\n\n<p>You don't have to use grpc, but it shows how to deal with services, because everything else, like DAOs, loggers and such needs to be a field in the struct implementing said interface. A small example without grpc</p>\n\n<pre><code>//go:generate protoc --go_out=. exchange.proto\n\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\nvar (\n    statusName = \"Status\"\n    userIdName = \"uid\"\n)\n\nfunc main() {\n\n    logger := log.New(os.Stderr, \"SRVC \", log.Ltime|log.Lshortfile)\n\n    logger.Println(\"Main: Setting up dao\u2026\")\n    dao := &amp;daoMock{\n        Users:  []string{\"Alice\", \"Bob\", \"Mallory\"},\n        Logger: logger,\n    }\n\n    logger.Println(\"Main: Setting up service\u2026\")\n\n    service := &amp;Miniservice{\n        DAO:    dao,\n        Logger: logger,\n    }\n\n    // First, we do a valid request\n    req1 := &amp;Exchange{\n        Header: []*Header{\n            &amp;Header{\n                Value: &amp;Header_UserId{UserId: 0},\n            },\n        },\n    }\n\n    if resp1, err := service.UserInfo(req1); err != nil {\n        logger.Printf(\"Main: error was returned on request: %s\\n\", err.Error())\n    } else {\n        fmt.Println(\"&gt;\", string(resp1.GetContent()))\n    }\n\n\n    // A missing UserIdHeader causes an error to be returned\n    // Header creation compacted for brevity\n    noUserIdHeader := &amp;Exchange{Header: []*Header{&amp;Header{Value: &amp;Header_Content{Content: \"foo\"}}}}\n\n    if resp2, err := service.UserInfo(noUserIdHeader); err != nil {\n        logger.Printf(\"Main: error was returned by service: %s\\n\", err.Error())\n    } else {\n        fmt.Println(\"&gt;\", string(resp2.GetContent()))\n    }\n\n    // Self explanatory\n    outOfBounds := &amp;Exchange{Header: []*Header{&amp;Header{Value: &amp;Header_UserId{UserId: 42}}}}\n\n    if resp3, err := service.UserInfo(outOfBounds); err != nil {\n        logger.Printf(\"Main: error was returned by service: %s\\n\", err.Error())\n\n    } else {\n        fmt.Println(\"&gt;\", string(resp3.GetContent()))\n    }\n}\n\n\ntype daoMock struct {\n    Users  []string\n    Logger *log.Logger\n}\n\nfunc (d *daoMock) Get(id int) (*string, error) {\n\n    d.Logger.Println(\"DAO: Retrieving data\u2026\")\n    if id &gt; len(d.Users) {\n        d.Logger.Println(\"DAO: User not in 'database'...\")\n        return nil, fmt.Errorf(\"id %d not in users\", id)\n    }\n\n    d.Logger.Println(\"DAO: Returning data\u2026\")\n    return &amp;d.Users[id], nil\n}\n\ntype Miniservice struct {\n    Logger *log.Logger\n    DAO    *daoMock\n}\n\nfunc (s *Miniservice) UserInfo(in *Exchange) (out *Exchange, err error) {\n\n    var idHdr *Header_UserId\n\n    s.Logger.Println(\"UserInfo: retrieving ID header\")\n\n    // Here is where the magic happens:\n    // You Identify different types of requests by the presence or absence\n    // of certain headers\n    for _, hdr := range in.GetHeader() {\n        v := hdr.GetValue()\n        if i, ok := v.(*Header_UserId); ok {\n            idHdr = i\n        }\n    }\n\n    if idHdr == nil {\n        s.Logger.Println(\"UserInfo: invalid request\")\n        return nil, fmt.Errorf(\"invalid request\")\n    }\n\n    u, err := s.DAO.Get(int(idHdr.UserId))\n\n    if err != nil {\n        s.Logger.Printf(\"UserInfo: accessing user data: %s\", err.Error())\n        return nil, fmt.Errorf(\"error accessing user data: %s\", err.Error())\n    }\n\n    /* ----------------- create the response ----------------- */\n    statusHeader := &amp;Header{\n        Name:  &amp;statusName,\n        Value: &amp;Header_Status{Status: Status_DONE_OK},\n    }\n    userHeader := &amp;Header{\n        Name:  &amp;userIdName,\n        Value: &amp;Header_UserId{UserId: idHdr.UserId},\n    }\n\n    s.Logger.Println(\"UserInfo: sending response\")\n\n    return &amp;Exchange{\n        Header:  []*Header{statusHeader, userHeader},\n        Content: []byte(*u),\n    }, nil\n}\n</code></pre>\n\n<p>Now, your Requests and Responses are more generic and are suitable for being used in various types of requests, without changing the format and without the need for reflection. I am not saying that this is the golden bullet, however. Others might come up with solutions which better fit your needs. But I hth.</p>\n"}, {"tags": [], "owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1455919672, "creation_date": 1455919672, "answer_id": 35515969, "question_id": 35236079, "link": "https://stackoverflow.com/questions/35236079/go-reflect-for-metaprogramming-templates/35515969#35515969", "title": "go reflect for metaprogramming/templates", "body": "<p>I ended up completely abandoning reflect.  I could work on generic objects, but I could not pass them on to handlers.  Not being able to do this made it not worth using a library, so it seemed like a bad approach.</p>\n\n<p>I created a simple \"template\" that I could copy and drop in the protobuf message names into.  I then used <code>go generate</code> to build the messages that I needed.  This let me put special go generate comments in my code that specified the types - so even though there is templating, filling it in and using it is done in a single go file.</p>\n\n<p>So I put the base template in <code>src/mylibs/req-handlers/base.tmp.go</code>.  I wanted to keep <code>.go</code> as the extension for syntax highlighting.  In that file, I had generic things like <code>{{RequestProto}}</code> that would get replaced.</p>\n\n<p>This script defined a <code>ReqHandler</code> type using some template variables:</p>\n\n<pre><code>type ReqHandlerFunc func(req *testmsg.{{RequestProto}}, resp *testmsg.{{ResponseProto}}) error\n</code></pre>\n\n<p>And I created an object that reference the handler function:</p>\n\n<pre><code>func NewReqHandler(name string, handler ReqHandlerFunc) *ReqHandler {\n    ...\n    rh.handler = handler\n    return rh\n}\n</code></pre>\n\n<p>and later in the code I called the handler function where it was needed:</p>\n\n<pre><code>err = rh.handler(req, resp)\n</code></pre>\n\n<p>In the bin directory, I added this script, which copies the template, and uses sed to replace some keywords with words I can specify in go code:</p>\n\n<pre><code>#!/bin/bash\n\nif [ \"$#\" -ne 3 ] &amp;&amp; [ \"$#\" -ne 4 ]; then\n    echo \"Usage: build_handler (Package Name) (Request Proto Name) (Response Proto Name) [Logger Name]\"\n    exit 1\nfi\n\nLIB=$1\nREQ=$2\nREP=$3\nPKG=\"${LIB//-/}\"\nif [ \"$#\" -ne 4 ]; then\n    LOG=${PKG}\nelse\n    LOG=$4\nfi\n\nHANDLERS_DIR=$(dirname \"$0\")/../src/mylibs/req-handlers\n\n#Generate go code\nmkdir -p ${HANDLERS_DIR}/${LIB}/\nGEN_FILE=${HANDLERS_DIR}/${LIB}/${LIB}_handler.go\ncp ${HANDLERS_DIR}/base.tmpl.go ${GEN_FILE}\nsed -i\"\" -e \"s/{{PackageName}}/${PKG}/g\" ${GEN_FILE}\nsed -i\"\" -e \"s/{{LoggerName}}/${LOG}/g\" ${GEN_FILE}\nsed -i\"\" -e \"s/{{RequestProto}}/${REQ}/g\" ${GEN_FILE}\nsed -i\"\" -e \"s/{{ResponseProto}}/${REP}/g\" ${GEN_FILE}\n</code></pre>\n\n<p>Finally to make use of it, <code>testservice.go</code> would then have something like:</p>\n\n<pre><code>//go:generate build_handler testservicelib PostReq PostResp\nimport \"mylibs/req-handlers/testservicelib\"\n</code></pre>\n\n<p>When I run <code>go generate</code>, <code>build_handler</code> is called, which creates the <code>mylibs/req-handlers/testservicelib</code> library, which has a request handler with the <code>PostReq</code> and <code>PostResp</code> types.  So I create a handler function that will have those as inputs:</p>\n\n<pre><code>func handleRequest(req *testmsg.PostReq, resp *testmsg.PostResp) error {\n    ...\n}\n</code></pre>\n\n<p>and pass that to my generated library:</p>\n\n<pre><code>reqHandler := testservicelib.NewReqHandler(\"test\", handleRequest)\n</code></pre>\n\n<p>And life is good.</p>\n\n<p>To build, the Makefile needed an extra step.  Both go generate and go build/install steps are needed:</p>\n\n<pre><code>go generate testservice\ngo install testservice\n</code></pre>\n\n<p>Note that the generate call will run all the <code>//go:generate</code> comments in <code>testservice.go</code>, so in some cases I have more than 1 handler created.</p>\n"}], "owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "accepted_answer_id": 35515969, "answer_count": 2, "score": 1, "last_activity_date": 1455919672, "creation_date": 1454720618, "last_edit_date": 1454784682, "question_id": 35236079, "link": "https://stackoverflow.com/questions/35236079/go-reflect-for-metaprogramming-templates", "title": "go reflect for metaprogramming/templates", "body": "<p>I have some code that receives protobuf messages that is basically duplicated in a couple places so I want to put it into a library.  The problem is that the exact protobuf message that's used is different for each set of code.</p>\n\n<p>EDIT: And I don't have the flexiblity of restructuring them.</p>\n\n<p>I'm not entirely sure this is possible to solve without duplicate code in go, but I did make an attempt (below).  Am I doing something wrong, or is this not something that's not possible?  (Note: This is stripped down code, in the real code the objects have lots of additional fields)</p>\n\n<p>Example.proto:</p>\n\n<pre><code>package testmsg;\n\nenum RepStatus {\n    DONE_OK = 0;\n    DONE_ERROR = 1;\n}\n\nmessage ReqHeader {\n    optional int64 user_id = 1;\n}\n\nmessage RespHeader {\n    optional RepStatus status = 1;\n    optional string error_msg = 2;\n}\n\nmessage PostReq {\n    optional ReqHeader header = 1;\n    optional bytes post_data = 2;\n}\n\nmessage PostResp {\n    optional RespHeader header = 1;\n}\n\nmessage StatusReq {\n    optional ReqHeader header = 1;\n    optional string id = 2;\n}\n\nmessage StatusRep {\n    optional RespHeader header = 1;\n    optional string status = 2;\n}\n</code></pre>\n\n<p>mini-service/service.go:</p>\n\n<pre><code>package miniservice\n\nimport \"reflect\"\nimport \"github.com/golang/protobuf/proto\"\nimport \"testmsg\"\n\ntype MiniService struct {\n    name string\n    reqType reflect.Type\n    repType reflect.Type\n}\n\nfunc NewService(name string, reqPort int, reqType proto.Message, repType proto.Message) *MiniService {\n    ms := new(MiniService)\n    ms.name = name\n    ms.reqType = reflect.TypeOf(reqType)\n    ms.repType = reflect.TypeOf(repType)\n    return ms\n}\n\nfunc (ms *MiniService) Handler(msgs []string) (string) {\n    resp := reflect.New(ms.repType.Elem())\n\n    msg := msgs[0]\n    req := reflect.New(ms.reqType.Elem())\n    err := proto.Unmarshal([]byte(msg), req)\n    //add some error handling, or just get set _\n\n    resp.Header = &amp;testmsg.RespHeader{}\n    //Call handler function that is unique per service\n    //the signature will be something like:\n    //handleRequest(reqType, respType) &amp; called like:\n    //handleRequest(req, resp)\n    resp.Header.Status = testmsg.RepStatus_DONE_OK.Enum()\n\n    respMsg, _ := proto.Marshal(resp)\n    return string(respMsg)\n}\n</code></pre>\n\n<p>testservice.go:</p>\n\n<pre><code>package main\nimport \"github.com/golang/protobuf/proto\"\nimport \"testmsg\"\nimport \"mylibs/mini-service\"\n\nfunc main() {\n    //fake out a zmq message\n    req := &amp;testmsg.PostReq{}\n    req.Header = &amp;testmsg.ReqHeader{}\n    req.Header.MessageId = proto.Int64(10)\n    reqMsg, _ := proto.Marshal(req)\n    reqMsgs := []string{string(reqMsg)}\n\n    ms := miniservice.NewService(\"tester\", 5555, testmsg.PostReq, testmsg.PostResp)\n    //What will be called when receiving a zmq request\n    resp := ms.Handler(reqMsgs)\n    log.Info(resp)\n}\n</code></pre>\n\n<p>When I try to compile I get errors like:</p>\n\n<pre><code>resp.Header undefined (type reflect.Value has no field or method Header)\n\ncannot use resp (type reflect.Value) as type proto.Message in argument to proto.Marshal:\nreflect.Value does not implement proto.Message (missing ProtoMessage method)\n</code></pre>\n\n<p>Which make complete sense since the resp isn't connected to ms.respType.</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1454711969, "post_id": 35234745, "comment_id": 58184223, "body": "First, you don&#39;t need to copy a struct between packages if it&#39;s exported. I think you mean to use <code>configuration.Config</code>? Also, don&#39;t use relative imports for anything but a quick test. <i>Always</i> use the full import path."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1454712752, "post_id": 35234745, "comment_id": 58184527, "body": "See &quot;How to Write Go Code&quot; for a tutorial on <a href=\"https://golang.org/doc/code.html#Library\" rel=\"nofollow noreferrer\">how to write a library and use it from the main program</a>."}, {"owner": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1454746035, "post_id": 35234745, "comment_id": 58191800, "body": "@MuffinTop Thanks, that&#39;s a great resource!"}], "answers": [{"tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": true, "score": 4, "last_activity_date": 1454712799, "creation_date": 1454712799, "answer_id": 35234911, "question_id": 35234745, "link": "https://stackoverflow.com/questions/35234745/passing-around-structs/35234911#35234911", "title": "Passing around structs", "body": "<p>In your main package you should specify</p>\n\n<pre><code>var conf configuration.Config = configuration.Load()\n</code></pre>\n\n<p><code>configuration</code> refers to your imported package and <code>Config</code> is the exported struct (uppercase name) from that package. But you can also omit this, as the type can be inferred </p>\n\n<pre><code>var conf = configuration.Load()\n</code></pre>\n\n<p>As a side note: please don't use relative imports</p>\n"}, {"tags": [], "owner": {"reputation": 182, "user_id": 5622186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69af54f6a46bce1f6c539f86841ed8ef?s=128&d=identicon&r=PG", "display_name": "Kiramishima", "link": "https://stackoverflow.com/users/5622186/kiramishima"}, "is_accepted": false, "score": 1, "last_activity_date": 1454713518, "creation_date": 1454713518, "answer_id": 35235047, "question_id": 35234745, "link": "https://stackoverflow.com/questions/35234745/passing-around-structs/35235047#35235047", "title": "Passing around structs", "body": "<p>in Go imports you always declare the full path of you package, dont use relative paths in imports, best example is that toml import <code>import \"github.com/BurntSushi/toml\"</code> that exist in: \nGOPATH/src/github.com/BurntSushi/toml \nGOPATH/pkg/_/github.com/BurntSushi/toml </p>\n\n<p>Then build you package and <code>main.go</code></p>\n\n<pre><code>package main\n\nimport \"mypackage/configuration\"\n\nfunc main() {\n   // configuration contain all funcs &amp; structs \n   var conf configuration.Config = configuration.Load()\n}\n</code></pre>\n\n<p>Go it is not ruby.</p>\n\n<p>Ref Packages: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">https://golang.org/doc/code.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "edited": false, "score": 0, "creation_date": 1454745140, "post_id": 35236263, "comment_id": 58191566, "body": "The shortcut doesn&#39;t work for me as I would like to use my <code>conf</code> var in all the different functions so I declare it outside of the main function. But I see what you are explaining. Thanks."}], "tags": [], "owner": {"reputation": 61, "user_id": 2529177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9c9756375f4160a861bd10d7f5f1d11?s=128&d=identicon&r=PG", "display_name": "user2529177", "link": "https://stackoverflow.com/users/2529177/user2529177"}, "is_accepted": false, "score": 1, "last_activity_date": 1454722204, "creation_date": 1454722204, "answer_id": 35236263, "question_id": 35234745, "link": "https://stackoverflow.com/questions/35234745/passing-around-structs/35236263#35236263", "title": "Passing around structs", "body": "<p>why don't you just import the configuration package and then do Go's variable declaration/instatiation shortcut? Maybe I'm missing something.</p>\n\n<pre><code>package main\n\nimport \"mypackage/configuration\"\n\nfunc main() {\n   conf := configuration.Load()\n}\n</code></pre>\n"}], "owner": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 35234911, "answer_count": 3, "score": 1, "last_activity_date": 1454722204, "creation_date": 1454711804, "question_id": 35234745, "link": "https://stackoverflow.com/questions/35234745/passing-around-structs", "title": "Passing around structs", "body": "<p>I am new to go and coming from a Ruby background. I am trying to understand code structuring in a world without classes and am probably making the mistake wanting to do it \"the Ruby way\" in Go.</p>\n\n<p>I am trying to refactor my code to make it more modular / readable so I moved the loading of the configuration file to its own package. Good idea?</p>\n\n<pre><code>package configuration\n\nimport \"github.com/BurntSushi/toml\"\n\ntype Config struct {\n    Temperatures []struct {\n        Degrees int\n        Units string\n    }\n}\n\nfunc Load() Config {\n    var cnf Config\n    _, err := toml.DecodeFile(\"config\", &amp;cnf)\n    if err != nil {\n        panic(err)\n    }\n    return cnf\n}\n</code></pre>\n\n<p>Now, in my main package:</p>\n\n<pre><code>package main\n\nimport \"./configuration\"\n\nvar conf Configuration = configuration.Load()\n</code></pre>\n\n<p>Gives <code>undefined: Config</code>. I understand why. I could copy the struct definition in the main package but that's not very DRY.</p>\n\n<p>It's my understanding passing around structs like this is a bad practice as it makes your code harder to understand (now everyone needs to know about my Config struct).</p>\n\n<p>Is hiding logic in a package like I am trying to do here a good idea in Go? If so, what's the \"Go\" way to pass this Config struct around?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5890092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9ygXBeqWfTc/AAAAAAAAAAI/AAAAAAAAAEk/AURY1hEGUtw/photo.jpg?sz=128", "display_name": "Rmartinez", "link": "https://stackoverflow.com/users/5890092/rmartinez"}, "edited": false, "score": 0, "creation_date": 1454711187, "post_id": 35234531, "comment_id": 58183927, "body": "Thanks for the fast response. Also thanks for the explanation."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 11, "last_activity_date": 1454710791, "creation_date": 1454710791, "answer_id": 35234531, "question_id": 35234503, "link": "https://stackoverflow.com/questions/35234503/running-multiple-go-routines-at-the-same-time/35234531#35234531", "title": "Running multiple go routines at the same time", "body": "<p>You can have all goroutines block on a channel, and close that channel once they are all dispatched:</p>\n\n<pre><code>start := make(chan struct{})\n\nfor i := 0; i &lt; *routines; i++ {\n    go func() {\n        &lt;-start\n        defer wg.Done()\n        t := time.Now()\n        fmt.Printf(\"%s\\n\", t)\n    }()\n}\nfmt.Println(\"starting\")\nclose(start)\n</code></pre>\n\n<p>This will get you as close to \"exactly the same time\" as possible. You can't really guarantee that they always run at precisely the same time, and if there are  more goroutines than GOMAXPROCS or CPU cores, they can't possibly run at exactly the same time. </p>\n"}], "owner": {"reputation": 21, "user_id": 5890092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9ygXBeqWfTc/AAAAAAAAAAI/AAAAAAAAAEk/AURY1hEGUtw/photo.jpg?sz=128", "display_name": "Rmartinez", "link": "https://stackoverflow.com/users/5890092/rmartinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2716, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1454710791, "creation_date": 1454710617, "question_id": 35234503, "link": "https://stackoverflow.com/questions/35234503/running-multiple-go-routines-at-the-same-time", "title": "Running multiple go routines at the same time", "body": "<p>I want to run multiple Go routines. I want them to all start up the same time. I added another sync waitGroup and added a wait inside the start of the go routine. This however did not work to have all the go routine start at the same time. What should I do in order to have a number of go routines to start exactly at the same time?</p>\n\n<pre><code>package main\n\nimport (\n        \"flag\"\n        \"fmt\"\n        \"sync\"\n        \"time\"\n)\n\nfunc main() {\n     var wg sync.WaitGroup\n      routines := flag.Int(\"runs\", 100, \"routines running\")\n      flag.Parse()\n\n      wg.Add(*routines)\n\n      for i := 0; i &lt; *routines; i++ {\n              go func() {\n                      defer wg.Done()\n                      t := time.Now()\n                      fmt.Printf(\"%s\\n\", t)\n              }()\n      }\n      fmt.Println(\"Waiting To Finish\")\n      wg.Wait()\n</code></pre>\n"}, {"tags": ["go", "cgo", "gccgo"], "answers": [{"comments": [{"owner": {"reputation": 1579, "user_id": 1354514, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e83e6f559891e7489995dfa43e010fa3?s=128&d=identicon&r=PG", "display_name": "steve landiss", "link": "https://stackoverflow.com/users/1354514/steve-landiss"}, "edited": false, "score": 0, "creation_date": 1454710287, "post_id": 35234015, "comment_id": 58183578, "body": "Actually I need to add this to my go code: signal.Ignore(syscall.SIGABRT).  This allows me to see the stack trace of the C code that crashed."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1579, "user_id": 1354514, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e83e6f559891e7489995dfa43e010fa3?s=128&d=identicon&r=PG", "display_name": "steve landiss", "link": "https://stackoverflow.com/users/1354514/steve-landiss"}, "edited": false, "score": 0, "creation_date": 1454710477, "post_id": 35234015, "comment_id": 58183650, "body": "@stevelandiss: but doesn&#39;t <code>GOTRACEBACK=crash</code> let you do that without altering your code at all?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1454708974, "last_edit_date": 1454708974, "creation_date": 1454708400, "answer_id": 35234015, "question_id": 35233871, "link": "https://stackoverflow.com/questions/35233871/unable-to-get-the-stack-trace-with-a-corefile-from-a-cgo-routine-when-using-gola/35234015#35234015", "title": "Unable to get the stack trace with a corefile from a cgo routine when using golang", "body": "<p>Besides the obvious check of <code>ulimit -c</code>, run the go program with <code>GOTRACEBACK=crash</code>. This will print out more information, and allow the program to exit with <code>SIGABRT</code> to trigger a core dump. </p>\n"}, {"tags": [], "owner": {"reputation": 1579, "user_id": 1354514, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e83e6f559891e7489995dfa43e010fa3?s=128&d=identicon&r=PG", "display_name": "steve landiss", "link": "https://stackoverflow.com/users/1354514/steve-landiss"}, "is_accepted": true, "score": 0, "last_activity_date": 1454710331, "creation_date": 1454710331, "answer_id": 35234443, "question_id": 35233871, "link": "https://stackoverflow.com/questions/35233871/unable-to-get-the-stack-trace-with-a-corefile-from-a-cgo-routine-when-using-gola/35234443#35234443", "title": "Unable to get the stack trace with a corefile from a cgo routine when using golang", "body": "<p>Actually I need to add this to my go code: signal.Ignore(syscall.SIGABRT).  This allows me to see the stack trace of the C code that crashed. </p>\n"}], "owner": {"reputation": 1579, "user_id": 1354514, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e83e6f559891e7489995dfa43e010fa3?s=128&d=identicon&r=PG", "display_name": "steve landiss", "link": "https://stackoverflow.com/users/1354514/steve-landiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 1, "accepted_answer_id": 35234443, "answer_count": 2, "score": 1, "last_activity_date": 1454710331, "creation_date": 1454707792, "question_id": 35233871, "link": "https://stackoverflow.com/questions/35233871/unable-to-get-the-stack-trace-with-a-corefile-from-a-cgo-routine-when-using-gola", "title": "Unable to get the stack trace with a corefile from a cgo routine when using golang", "body": "<p>I am using Golang and cgo.  When my C code raises an <code>assert()</code>, I am unable to see the stack trace of the C code when using <code>cgo</code>.</p>\n\n<p>Instead, I see the stack trace of the golang runtime that caught the assert.</p>\n\n<p>Here is an example of my C code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n\nvoid fn2(char *arg)\n{\n    int stackvar2 = 256;\n\n    printf(\"Argument %s\\n\", arg);\n\n    assert(1 == 2);\n}\n\nvoid fn1(int arg)\n{\n    int stackvar3 = 512;\n    char var[256];\n\n    strcpy(var, \"deadbeef\");\n\n    fn2(var);\n}\n\n\nvoid *thread(void *arg)\n{\n    printf(\"Hello from the thread... going in for an assert\\n\");\n\n    fn1(1092);\n\n    return NULL;\n}\n\nvoid hello_world(char *str)\n{\n    pthread_t tid;\n\n    printf(\"Hello World from C and here the str is from Go: %s\\n\", str);\n\n    pthread_create(&amp;tid, NULL, thread, NULL);\n\n    sleep(100000);\n}\n\n\nHere is my Go code\n\n\n\npackage main\n\n/*\nextern void hello_world(char *str);\n#cgo LDFLAGS: -L. -lhello\n#cgo CFLAGS: -g3\n*/\nimport \"C\"\n\nimport (\n    _ \"fmt\"\n)\n\nfunc main() {\n    str := \"From Golang\"\n\n    cStr := C.CString(str)\n    C.hello_world(cStr)\n\n    select {}\n}\n</code></pre>\n\n<p>And here is my Makefile</p>\n\n<pre><code>all:\n    gcc -g3 -O0 -c hello.c\n    ar cru libhello.a hello.o\n    go build hello.go\n\nclean:\n    rm -f *.o hello\n</code></pre>\n"}, {"tags": ["api", "go", "error-handling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1454707954, "post_id": 35233749, "comment_id": 58182521, "body": "The actual errors don&#39;t matter in that case, because the action failed, and there&#39;s nothing else you can do with the result. If the error type does matter, it should be documented as such (like <code>io.EOF</code>). What you would do if <code>NewRequest</code> provided different error types (it&#39;s <code>url.Error</code> btw)?"}, {"owner": {"reputation": 6511, "user_id": 188108, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b091399da83212608f7ce92128d73030?s=128&d=identicon&r=PG", "display_name": "Torsten Bronger", "link": "https://stackoverflow.com/users/188108/torsten-bronger"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1454750867, "post_id": 35233749, "comment_id": 58193035, "body": "<code>NewRequest</code> was only an example.  Currently, I clutter my source code with &quot;if err != nil return err or panic&quot; blocks, which is a bit unsatisfactory.  Coming from an exceptions-centric language, I could as well just let the exception abort the process, and keeping the source code clean.  Thus, if I have all those &quot;if&quot;s, I thought I could at least do something useful with them.  ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": true, "score": 0, "last_activity_date": 1454732396, "last_edit_date": 1454732396, "creation_date": 1454731093, "answer_id": 35237166, "question_id": 35233749, "link": "https://stackoverflow.com/questions/35233749/how-do-i-find-out-about-possible-error-values-of-go-standard-library-functions/35237166#35237166", "title": "How do I find out about possible error values of Go standard library functions?", "body": "<p>First off, if you haven't read it yet, I recommend reading <a href=\"http://blog.golang.org/error-handling-and-go\" rel=\"nofollow\">this blog article about error handling in Go</a>, it might clarify some things for you.</p>\n\n<p>As for finding out the possible error values of Go stdlib functions, if it's not explicitly documented, one option is to go read the code. For example, on the <a href=\"https://golang.org/pkg/net/http/#NewRequest\" rel=\"nofollow\">http.NewRequest</a> function, you can click on the header, which takes you to <a href=\"https://golang.org/src/net/http/request.go?s=17718:17790#L536\" rel=\"nofollow\">the source code</a>. There you can see that right now, it only returns an error in one case, when the URL parsing fails. Exploring the <a href=\"https://golang.org/pkg/net/url/#Parse\" rel=\"nofollow\"><code>url.Parse</code></a> function, you'll see that it may return <code>url.Error</code>, which you can check for with a type assertion:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc main() {\n    r, err := http.NewRequest(\"GET\", \"http://[fe80::%31%25en0]:8080/\", nil)\n    if perr, ok := err.(*url.Error); ok &amp;&amp; perr != nil {\n        log.Fatal(\"Parse error, check URL formatting: \", perr)\n    } else if err != nil {\n        log.Fatal(\"Error creating HTTP request\")\n    }\n\n    // ... success case\n    log.Println(r)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/9hW7UNIPPk\" rel=\"nofollow\">Running this</a> gives you the parse error, which you may or may not want to handle differently in your application:</p>\n\n<pre><code>2009/11/10 23:00:00 Parse error, check URL formatting: parse http://[fe80::%31%25en0]:8080/: percent-encoded characters in host\n</code></pre>\n\n<p>I agree with JimB's comment however, specifically checking the type of error in this case is probably not a useful thing to do. In 99.99% of cases all you need to know is that creating the request failed (<code>err != nil</code>) and handle that eventuality in an appropriate way (logging, returning, etc).</p>\n"}], "owner": {"reputation": 6511, "user_id": 188108, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b091399da83212608f7ce92128d73030?s=128&d=identicon&r=PG", "display_name": "Torsten Bronger", "link": "https://stackoverflow.com/users/188108/torsten-bronger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 35237166, "answer_count": 1, "score": 0, "last_activity_date": 1520108140, "creation_date": 1454707300, "last_edit_date": 1520108140, "question_id": 35233749, "link": "https://stackoverflow.com/questions/35233749/how-do-i-find-out-about-possible-error-values-of-go-standard-library-functions", "title": "How do I find out about possible error values of Go standard library functions?", "body": "<p>When calling a Go function that returns an error, I wonder how to deal with a non-nil error value.  I can just abort, log it, or pass it to the caller.  Or a combination thereof.  But it would be better if I found out what went wrong and reacted in a more fine-grained manner.</p>\n\n<p>Thus, how can I find out about possible error values and their meanings?  For example, I want to use the <code>http.NewRequest</code> function.  Look it up <a href=\"https://golang.org/pkg/net/http/#NewRequest\" rel=\"nofollow\">in the docs</a>.  There, it only says that there <em>are</em> possible error conditions but not which ones.  How can I find out about these? </p>\n"}, {"tags": ["recursion", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1454707727, "post_id": 35233717, "comment_id": 58182409, "body": "do by analogy with this: <a href=\"http://stackoverflow.com/questions/19249588/go-programming-generating-combinations\" title=\"go programming generating combinations\">stackoverflow.com/questions/19249588/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 955, "user_id": 4134847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/513b1d7f1e558bd8b063bfcb508a9e5b?s=128&d=identicon&r=PG", "display_name": "Daniel Huckson", "link": "https://stackoverflow.com/users/4134847/daniel-huckson"}, "edited": false, "score": 0, "creation_date": 1454719100, "post_id": 35234599, "comment_id": 58186431, "body": "What about if you only wanted the 1 pool of digits returned, say the 3 digit pool, instead of all three pools?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 955, "user_id": 4134847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/513b1d7f1e558bd8b063bfcb508a9e5b?s=128&d=identicon&r=PG", "display_name": "Daniel Huckson", "link": "https://stackoverflow.com/users/4134847/daniel-huckson"}, "edited": false, "score": 0, "creation_date": 1454725332, "post_id": 35234599, "comment_id": 58187694, "body": "@DanielHuckson: The 3 digit pool is slice <code>c[3-1]</code> of the combinations. For example, <code>pools := 3;</code> <code>numbers := []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10};</code> <code>c := Combinations(pools, numbers);</code> <code>digits := 3;</code> <code>pool3digit := c[digits-1];</code> <code>fmt.Println(pool3digit);</code>"}, {"owner": {"reputation": 955, "user_id": 4134847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/513b1d7f1e558bd8b063bfcb508a9e5b?s=128&d=identicon&r=PG", "display_name": "Daniel Huckson", "link": "https://stackoverflow.com/users/4134847/daniel-huckson"}, "edited": false, "score": 0, "creation_date": 1454728989, "post_id": 35234599, "comment_id": 58188390, "body": "Yes I realize that you can do that but, is it possible to pass a value, say 3 to rCombinations() function and rCombinations() only generates and returns the 3 digit set? Only one set or &quot;pool&quot; is needed."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 955, "user_id": 4134847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/513b1d7f1e558bd8b063bfcb508a9e5b?s=128&d=identicon&r=PG", "display_name": "Daniel Huckson", "link": "https://stackoverflow.com/users/4134847/daniel-huckson"}, "edited": false, "score": 0, "creation_date": 1454796757, "post_id": 35234599, "comment_id": 58207911, "body": "@DanielHuckson: Yes. Everything is just a simple variation of the original recursive alogorithm for combinations, See my revised answer."}, {"owner": {"reputation": 955, "user_id": 4134847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/513b1d7f1e558bd8b063bfcb508a9e5b?s=128&d=identicon&r=PG", "display_name": "Daniel Huckson", "link": "https://stackoverflow.com/users/4134847/daniel-huckson"}, "edited": false, "score": 0, "creation_date": 1454832877, "post_id": 35234599, "comment_id": 58215232, "body": "Thank you, that is perfect, I wish I could understand  what is going on in the  rPool() function tho."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1454796678, "last_edit_date": 1454796678, "creation_date": 1454711136, "answer_id": 35234599, "question_id": 35233717, "link": "https://stackoverflow.com/questions/35233717/recursive-function-to-create-number-combinations-in-golang/35234599#35234599", "title": "Recursive function to create number combinations in golang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc rCombinations(p int, n []int, c []int, ccc [][][]int) [][][]int {\n    if len(n) == 0 || p &lt;= 0 {\n        return ccc\n    }\n    if len(ccc) == 0 {\n        ccc = make([][][]int, p)\n    }\n    p--\n    for i := range n {\n        cc := make([]int, len(c)+1)\n        copy(cc, c)\n        cc[len(cc)-1] = n[i]\n        ccc[len(cc)-1] = append(ccc[len(cc)-1], cc)\n        ccc = rCombinations(p, n[i+1:], cc, ccc)\n    }\n    return ccc\n}\n\nfunc Combinations(p int, n []int) [][][]int {\n    return rCombinations(p, n, nil, nil)\n}\n\nfunc main() {\n    pools := 3\n    numbers := []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n    fmt.Println(pools, \"pools\", \"for\", \"numbers\", numbers)\n    fmt.Println()\n    nc := 0\n    c := Combinations(pools, numbers)\n    fmt.Println(\"pools:\")\n    d := \" digit : \"\n    for i := range c {\n        fmt.Println(i+1, d)\n        d = \" digits: \"\n        for j := range c[i] {\n            nc++\n            fmt.Println(c[i][j], \" \")\n        }\n    }\n    fmt.Println()\n    fmt.Println(nc, \"combinations\")\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>3 pools for numbers [1 2 3 4 5 6 7 8 9 10]\n\npools:\n1  digit : \n[1]  \n[2]  \n[3]  \n[4]  \n[5]  \n[6]  \n[7]  \n[8]  \n[9]  \n[10]  \n2  digits: \n[1 2]  \n[1 3]  \n[1 4]  \n[1 5]  \n[1 6]  \n[1 7]  \n[1 8]  \n[1 9]  \n[1 10]  \n[2 3]  \n[2 4]  \n[2 5]  \n[2 6]  \n[2 7]  \n[2 8]  \n[2 9]  \n[2 10]  \n[3 4]  \n[3 5]  \n[3 6]  \n[3 7]  \n[3 8]  \n[3 9]  \n[3 10]  \n[4 5]  \n[4 6]  \n[4 7]  \n[4 8]  \n[4 9]  \n[4 10]  \n[5 6]  \n[5 7]  \n[5 8]  \n[5 9]  \n[5 10]  \n[6 7]  \n[6 8]  \n[6 9]  \n[6 10]  \n[7 8]  \n[7 9]  \n[7 10]  \n[8 9]  \n[8 10]  \n[9 10]  \n3  digits: \n[1 2 3]  \n[1 2 4]  \n[1 2 5]  \n[1 2 6]  \n[1 2 7]  \n[1 2 8]  \n[1 2 9]  \n[1 2 10]  \n[1 3 4]  \n[1 3 5]  \n[1 3 6]  \n[1 3 7]  \n[1 3 8]  \n[1 3 9]  \n[1 3 10]  \n[1 4 5]  \n[1 4 6]  \n[1 4 7]  \n[1 4 8]  \n[1 4 9]  \n[1 4 10]  \n[1 5 6]  \n[1 5 7]  \n[1 5 8]  \n[1 5 9]  \n[1 5 10]  \n[1 6 7]  \n[1 6 8]  \n[1 6 9]  \n[1 6 10]  \n[1 7 8]  \n[1 7 9]  \n[1 7 10]  \n[1 8 9]  \n[1 8 10]  \n[1 9 10]  \n[2 3 4]  \n[2 3 5]  \n[2 3 6]  \n[2 3 7]  \n[2 3 8]  \n[2 3 9]  \n[2 3 10]  \n[2 4 5]  \n[2 4 6]  \n[2 4 7]  \n[2 4 8]  \n[2 4 9]  \n[2 4 10]  \n[2 5 6]  \n[2 5 7]  \n[2 5 8]  \n[2 5 9]  \n[2 5 10]  \n[2 6 7]  \n[2 6 8]  \n[2 6 9]  \n[2 6 10]  \n[2 7 8]  \n[2 7 9]  \n[2 7 10]  \n[2 8 9]  \n[2 8 10]  \n[2 9 10]  \n[3 4 5]  \n[3 4 6]  \n[3 4 7]  \n[3 4 8]  \n[3 4 9]  \n[3 4 10]  \n[3 5 6]  \n[3 5 7]  \n[3 5 8]  \n[3 5 9]  \n[3 5 10]  \n[3 6 7]  \n[3 6 8]  \n[3 6 9]  \n[3 6 10]  \n[3 7 8]  \n[3 7 9]  \n[3 7 10]  \n[3 8 9]  \n[3 8 10]  \n[3 9 10]  \n[4 5 6]  \n[4 5 7]  \n[4 5 8]  \n[4 5 9]  \n[4 5 10]  \n[4 6 7]  \n[4 6 8]  \n[4 6 9]  \n[4 6 10]  \n[4 7 8]  \n[4 7 9]  \n[4 7 10]  \n[4 8 9]  \n[4 8 10]  \n[4 9 10]  \n[5 6 7]  \n[5 6 8]  \n[5 6 9]  \n[5 6 10]  \n[5 7 8]  \n[5 7 9]  \n[5 7 10]  \n[5 8 9]  \n[5 8 10]  \n[5 9 10]  \n[6 7 8]  \n[6 7 9]  \n[6 7 10]  \n[6 8 9]  \n[6 8 10]  \n[6 9 10]  \n[7 8 9]  \n[7 8 10]  \n[7 9 10]  \n[8 9 10]  \n\n175 combinations\n</code></pre>\n\n<p>The variation for a single pool is:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc rPool(p int, n []int, c []int, cc [][]int) [][]int {\n    if len(n) == 0 || p &lt;= 0 {\n        return cc\n    }\n    p--\n    for i := range n {\n        r := make([]int, len(c)+1)\n        copy(r, c)\n        r[len(r)-1] = n[i]\n        if p == 0 {\n            cc = append(cc, r)\n        }\n        cc = rPool(p, n[i+1:], r, cc)\n    }\n    return cc\n}\n\nfunc Pool(p int, n []int) [][]int {\n    return rPool(p, n, nil, nil)\n}\n\nfunc main() {\n    pool := 9\n    numbers := []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n    p := Pool(pool, numbers)\n    fmt.Println(pool, \"digit pool\", \"for\", \"numbers\", numbers)\n    for i := range p {\n        fmt.Println(p[i])\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>9 digit pool for numbers [1 2 3 4 5 6 7 8 9 10]\n[1 2 3 4 5 6 7 8 9]\n[1 2 3 4 5 6 7 8 10]\n[1 2 3 4 5 6 7 9 10]\n[1 2 3 4 5 6 8 9 10]\n[1 2 3 4 5 7 8 9 10]\n[1 2 3 4 6 7 8 9 10]\n[1 2 3 5 6 7 8 9 10]\n[1 2 4 5 6 7 8 9 10]\n[1 3 4 5 6 7 8 9 10]\n[2 3 4 5 6 7 8 9 10]\n</code></pre>\n"}], "owner": {"reputation": 955, "user_id": 4134847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/513b1d7f1e558bd8b063bfcb508a9e5b?s=128&d=identicon&r=PG", "display_name": "Daniel Huckson", "link": "https://stackoverflow.com/users/4134847/daniel-huckson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 944, "favorite_count": 1, "accepted_answer_id": 35234599, "answer_count": 1, "score": 1, "last_activity_date": 1454796678, "creation_date": 1454707177, "question_id": 35233717, "link": "https://stackoverflow.com/questions/35233717/recursive-function-to-create-number-combinations-in-golang", "title": "Recursive function to create number combinations in golang", "body": "<p>I'm trying to figure out this recursive function thing. I have a <a href=\"https://play.golang.org/p/GYizR_0qdc\" rel=\"nofollow\">non-recursive demo that works</a> but it uses static methods not recursive. The functions prints out all the combinations of the \"number sets\" from the \"pool_size\". If someone could, please help me make this function recursive that would be great. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc combos_of1(pool_size int) {\n    for i := 1; i &lt; pool_size+1; i++ {\n        fmt.Println(i)\n    }\n    fmt.Println(\"\\n\")\n}\n\nfunc combos_of2(pool_size int) {\n    for i := 1; i &lt; pool_size+1; i++ {\n        for j := i + 1; j &lt; pool_size+1; j++ {\n            fmt.Println(i, j)\n        }\n    }\n    fmt.Println(\"\\n\")\n}\n\nfunc combos_of3(pool_size int) {\n    for i := 1; i &lt; pool_size+1; i++ {\n        for j := i + 1; j &lt; pool_size+1; j++ {\n            for k := j + 1; k &lt; pool_size+1; k++ {\n                fmt.Println(i, j, k)\n            }\n        }\n    }\n    fmt.Println(\"\\n\")\n}\n\nfunc main() {\n    combos_of1(10)\n    combos_of2(10)\n    combos_of3(10)\n}\n</code></pre>\n"}, {"tags": ["mysql", "algorithm", "go"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1454707427, "post_id": 35233626, "comment_id": 58182266, "body": "Not  familiar with golang, but in any sensible language one would use a mutex to serialize logins, i.e. only allow one login at a time."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1454707577, "post_id": 35233626, "comment_id": 58182349, "body": "There&#39;s a race around the map. You need to provide a mutex in some way."}], "answers": [{"comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1454707736, "post_id": 35233807, "comment_id": 58182413, "body": "Uhmmm, makes sense, I know how a mutex works. But I&#39;ve never tried using it. I&#39;ll do some research, will come back with results. New to mutexes."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1454708409, "post_id": 35233807, "comment_id": 58182742, "body": "Also, simultaneous writes to a map, or writes at the same time as reads, can outright crash."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1454709242, "post_id": 35233807, "comment_id": 58183118, "body": "@majidarif I added a very simple example to get you started."}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1454709265, "post_id": 35233807, "comment_id": 58183135, "body": "Hello, I saw <code>streamrail&#47;concurrent-map</code> on github and I&#39;m using it now. Will still have to test if it improved anything. Thanks."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 3, "last_activity_date": 1454709147, "last_edit_date": 1454709147, "creation_date": 1454707570, "answer_id": 35233807, "question_id": 35233626, "link": "https://stackoverflow.com/questions/35233626/online-game-login-design/35233807#35233807", "title": "Online Game Login Design", "body": "<p>Your <code>onLogin</code> needs a mutex, if you run your code with <code>-race</code> it will tell you there's a race.</p>\n\n<p><a href=\"http://blog.golang.org/race-detector\" rel=\"nofollow\">Race Detector</a> is a must read.</p>\n\n<p>// edit example:</p>\n\n<pre><code>var onLogin = struct {\n    sync.Mutex\n    m map[string]bool\n}{m: map[string]bool{}}\n\nfunc login(data []byte) []byte {\n    username := cstring(data[8:23])\n    password := cstring(data[24:39])\n    onLogin.Lock()\n    defer onLogin.Unlock()\n\n    if _, loggingIn := onLogin.m[username]; loggingIn {\n        fmt.Println(\"Possible double connect attempt\", username)\n        return nil\n    }\n    ///....\n}\n</code></pre>\n"}], "owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 35233807, "answer_count": 1, "score": 0, "last_activity_date": 1454709147, "creation_date": 1454706838, "last_edit_date": 1454707148, "question_id": 35233626, "link": "https://stackoverflow.com/questions/35233626/online-game-login-design", "title": "Online Game Login Design", "body": "<p>I am currently working on an online game and I have a design problem with the <code>login server</code>. Each player must only be logged-in from one client, if he tries to open another client and tries to login it should tell that the account is already logged in from another client. </p>\n\n<p>That works, but the problem is when someone tries to login from 2 clients at the exact same time both clients go through, causing the account to be logged-in in 2 different places. Which is something I do not wan't.</p>\n\n<p>My current approach is like (I'm using GoLang):</p>\n\n<pre><code>var onLogin map[string]uint16 = make(map[string]uint16)\n\nfunc login(data []byte) []byte {\n    username := cstring(data[8:23])\n    password := cstring(data[24:39])\n\n    // check if already trying to login\n    _, loggingIn := onLogin[username]\n    if loggingIn {\n        fmt.Println(\"Possible double connect attempt\", username)\n        return nil\n    }\n\n    (...check if correct login info...)\n    (...check if user is already logged in...)\n\n    // remove from list before returning\n    delete(onLogin, username)\n\n    (...build and send back packet to client if login success or fail...)\n</code></pre>\n\n<p>It helps (A BIT) but when someone is able to press the LOGIN button on 2 clients at inhumanly exact same time it still goes through. Maybe my design is flawed? Any advice? Cheers!</p>\n"}, {"tags": ["go", "benchmarking", "goroutine"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1454703373, "post_id": 35231859, "comment_id": 58180115, "body": "Any decent compiler for any language is going to throw out almost all the code in your loop since your float_result value is never used. You need to write it to output or a file."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1454703412, "post_id": 35231859, "comment_id": 58180144, "body": "And even if you did use float_result at the end, only the final line would run because all the others are being overwritten."}, {"owner": {"reputation": 1956, "user_id": 1516072, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yVU2W.jpg?s=128&g=1", "display_name": "nlassaux", "link": "https://stackoverflow.com/users/1516072/nlassaux"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1454903956, "post_id": 35231859, "comment_id": 58236214, "body": "I would like to do many operations, how can I do it without using the same variable many times ? If I do var = f1 + f2 + f3 + f4, it will write the  f1 + f2 + f3 + f4 value directly after compiling, no ?"}], "answers": [{"comments": [{"owner": {"reputation": 1956, "user_id": 1516072, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yVU2W.jpg?s=128&g=1", "display_name": "nlassaux", "link": "https://stackoverflow.com/users/1516072/nlassaux"}, "edited": false, "score": 0, "creation_date": 1454701129, "post_id": 35231972, "comment_id": 58178942, "body": "Even if I have 10 billion loops in the <code>test()</code> function, I have the same result. Moreover, with <code>runtime.GOMAXPROCS(1)</code>, the difference should not be that big than without goroutine, isn&#39;t it ?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1956, "user_id": 1516072, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yVU2W.jpg?s=128&g=1", "display_name": "nlassaux", "link": "https://stackoverflow.com/users/1516072/nlassaux"}, "edited": false, "score": 0, "creation_date": 1454701644, "post_id": 35231972, "comment_id": 58179228, "body": "@Nico401: Show us your test function: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>."}, {"owner": {"reputation": 1956, "user_id": 1516072, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yVU2W.jpg?s=128&g=1", "display_name": "nlassaux", "link": "https://stackoverflow.com/users/1516072/nlassaux"}, "edited": false, "score": 0, "creation_date": 1454702165, "post_id": 35231972, "comment_id": 58179485, "body": "I did it, I&#39;m sure you will recognize it :)"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1956, "user_id": 1516072, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yVU2W.jpg?s=128&g=1", "display_name": "nlassaux", "link": "https://stackoverflow.com/users/1516072/nlassaux"}, "edited": false, "score": 4, "creation_date": 1454702751, "post_id": 35231972, "comment_id": 58179783, "body": "@Nico401: &quot;unlike with a regular call, program execution does not wait for the invoked function to complete.&quot; <a href=\"https://golang.org/ref/spec#Go_statements\" rel=\"nofollow noreferrer\">Go statements</a>. So you gave the goroutine to the scheduler, got the time, and ended the program. It didn&#39;t take long!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1454700426, "creation_date": 1454700426, "answer_id": 35231972, "question_id": 35231859, "link": "https://stackoverflow.com/questions/35231859/benchmark-go-code-and-goroutines/35231972#35231972", "title": "Benchmark Go code and goroutines", "body": "<p>You are tring to benchmark something so small that measurement error dominates. Your benchmark iterations should be adjusted until the benchmark function lasts long enough to be timed reliably.Your benchmark should run for about one second to be meaningful. </p>\n"}, {"tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": false, "score": 7, "last_activity_date": 1454702289, "creation_date": 1454702289, "answer_id": 35232470, "question_id": 35231859, "link": "https://stackoverflow.com/questions/35231859/benchmark-go-code-and-goroutines/35232470#35232470", "title": "Benchmark Go code and goroutines", "body": "<p>You are not measuring the time that <code>test()</code> runs, but the time it takes to call/create a new goroutine with <code>go test()</code>. </p>\n\n<p>You need to wait for your goroutine(s) to finish, for example by using a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\">sync.Waitgroup</a>.</p>\n\n<pre><code>// somewhere in your main package\nvar wg sync.WaitGroup\n\nfunc test() {\n   // first lines in test() should be\n   wg.Add(1)\n   defer wg.Done()\n   ...\n}\n\n\n// benchmark\nruntime.GOMAXPROCS(1)\nvar t1 = time.Now()\ngo test()\nwg.Wait()\nvar elapsed1 = time.Since(t1)\n</code></pre>\n"}], "owner": {"reputation": 1956, "user_id": 1516072, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yVU2W.jpg?s=128&g=1", "display_name": "nlassaux", "link": "https://stackoverflow.com/users/1516072/nlassaux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1680, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1454702289, "creation_date": 1454700057, "last_edit_date": 1454702139, "question_id": 35231859, "link": "https://stackoverflow.com/questions/35231859/benchmark-go-code-and-goroutines", "title": "Benchmark Go code and goroutines", "body": "<p>I would like to benchmark a function: <code>test()</code>, with different numbers of threads working on it.</p>\n\n<h2>Without goroutines:</h2>\n\n<pre><code>var t1 = time.Now()\ntest()\nvar elapsed1 = time.Since(t1)\n</code></pre>\n\n<blockquote>\n  <p>1 ns / operation</p>\n</blockquote>\n\n<h2>With goroutines:</h2>\n\n<pre><code>runtime.GOMAXPROCS(1)\nvar t1 = time.Now()\ngo test()\nvar elapsed1 = time.Since(t1)\n</code></pre>\n\n<blockquote>\n  <p>1.10^-6 ns / operation</p>\n</blockquote>\n\n<h2>My test function:</h2>\n\n<pre><code>func test() {\n    for i := 0; i &lt; 1000000000; i++ {\n        float_result = f1 + f2\n        float_result = f1 - f2\n        float_result = f1 * f2\n        float_result = f1 / f2\n        float_result = f1 + f2\n        float_result = f1 - f2\n        float_result = f1 * f2\n        float_result = f1 / f2\n        float_result = f1 + f2\n        float_result = f1 - f2\n        float_result = f1 * f2\n        float_result = f1 / f2\n        float_result = f1 + f2\n        float_result = f1 - f2\n        float_result = f1 * f2\n        float_result = f1 / f2\n        float_result = f1 + f2\n        float_result = f1 - f2\n        float_result = f1 * f2\n        float_result = f1 / f2\n    }\n}\n</code></pre>\n\n<ul>\n<li>Is the test() function well benchmarked when I use goroutines in this case?</li>\n<li>How is it possible to reach 0.001ns / operation? It looks to be way too fast. (2.5GHz Intel Core i7)</li>\n<li>Is the use of goroutines with <code>runtime.GOMAXPROCS(n)</code> equivalent to use n threads ?</li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 3, "creation_date": 1454705489, "post_id": 35231846, "comment_id": 58181182, "body": "AFAIK, on Unix systems anything that doesn&#39;t include the null character can be a valid path. Not sure about Windows though."}, {"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1454706868, "post_id": 35231846, "comment_id": 58182009, "body": "@Ainar-G ... It seems like Windows at the very least would have restrictions related to the drive letter."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1454719145, "post_id": 35231846, "comment_id": 58186446, "body": "windows also has restrictions on file names; for example, you cannot name a file <code>aux</code> or <code>aux.ext</code> where <code>ext</code> is any extension you like since <code>aux</code> was a reserved keyword for accessing the aux port in msdos or something like that"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1454739665, "post_id": 35231846, "comment_id": 58190405, "body": "&quot;Valid path&quot; is highly system dependent. Most systems don&#39;t allow the <code>:</code> character. On Windows all these are disallowed: <code>?*:|\\&quot;</code>. Ext3 filesystem for Unix only disallows <code>&#47;</code> and the null char, but linux also handles NTFS and FAT file systems too (which is transparent to your app), so I would only allow path names that are allowed on all systems... I would disallow the NULL char and all of these: <code>?%*:|\\&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": true, "score": 15, "last_activity_date": 1454756960, "creation_date": 1454756960, "answer_id": 35240286, "question_id": 35231846, "link": "https://stackoverflow.com/questions/35231846/golang-check-if-string-is-valid-path/35240286#35240286", "title": "Golang check if string is valid path", "body": "<p>This problem sounds very simple, but it is actually not. Here is two possible solutions that I found :</p>\n\n<h1>Solution 1 - Academic</h1>\n\n<p>The idea here is to check a given filepath based on rules.</p>\n\n<h2>Problems</h2>\n\n<ol>\n<li>Operating system (UNIX / Windows)</li>\n<li>Filesystem</li>\n<li>Reserved keywords</li>\n</ol>\n\n<p><strong>Operating system</strong></p>\n\n<p>The first one is the easiest. Go provides various tools for OS-specific filenames/separators/...</p>\n\n<p>Example in the <a href=\"https://golang.org/pkg/os/#PathSeparator\">os</a> package:</p>\n\n<pre><code>const (\n    PathSeparator     = '/' // OS-specific path separator\n    PathListSeparator = ':' // OS-specific path list separator\n)\n</code></pre>\n\n<p>Another one in the <a href=\"https://golang.org/pkg/path/filepath/#VolumeName\">filepath</a> package:</p>\n\n<pre><code>// VolumeName returns leading volume name.\n// Given \"C:\\foo\\bar\" it returns \"C:\" on Windows.\n// Given \"\\\\host\\share\\foo\" it returns \"\\\\host\\share\".\n// On other platforms it returns \"\".\nfunc VolumeName(path string) string {\n    return path[:volumeNameLen(path)]\n}\n</code></pre>\n\n<p><strong>Filesystem</strong></p>\n\n<p>Filesystems have different restrictions. The maximum length or the charset allowed may vary. Unfortunately, there is no way you can tell (not as far as I know at least) which filesystem(s) your path will traverse.</p>\n\n<p><strong>Reserved keywords</strong></p>\n\n<p>Have a blacklist of all reserved keywords for a given OS.</p>\n\n<h2>Implementation</h2>\n\n<p>For this solution, I would build a <a href=\"https://en.wikipedia.org/wiki/Lexical_analysis\">lexer</a>/<a href=\"https://en.wikipedia.org/wiki/Parsing\">parser</a>. </p>\n\n<p>The tradeoff is that it would not guarantee 100% that a filepath is valid.</p>\n\n<h1>Solution 2 - Empirical</h1>\n\n<p>Attempt to create the file and delete it right after.</p>\n\n<pre><code>func IsValid(fp string) bool {\n  // Check if file already exists\n  if _, err := os.Stat(fp); err == nil {\n    return true\n  }\n\n  // Attempt to create it\n  var d []byte\n  if err := ioutil.WriteFile(fp, d, 0644); err == nil {\n    os.Remove(fp) // And delete it\n    return true\n  }\n\n  return false\n}\n</code></pre>\n\n<p>The main benefit of this solution is that it is straightforward and more accurate. If a file already exists or can be created at a given path, it means it is valid. However, this solution can also invalidate valid paths because of restricted access.</p>\n\n<h1>Summary</h1>\n\n<p>The first solution will be less accurate than the second one, even though more correct from a puristic point of view. The solution you should pick up depends on your need. Do you prefer false positives or false negatives? The first solution can give you false positives, while the second one false negatives.</p>\n"}], "owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10054, "favorite_count": 1, "accepted_answer_id": 35240286, "answer_count": 1, "score": 13, "last_activity_date": 1602228342, "creation_date": 1454700002, "question_id": 35231846, "link": "https://stackoverflow.com/questions/35231846/golang-check-if-string-is-valid-path", "title": "Golang check if string is valid path", "body": "<p>The Golang filepath module (<a href=\"https://golang.org/pkg/path/filepath/\">https://golang.org/pkg/path/filepath/</a>) contains a few functions for manipulating paths and <code>os.Stat</code> can be used to check if a file exists. Is there a way to check if a string actually forms a valid path at all (regardless of whether there's a file at that path or not)?</p>\n"}, {"tags": ["google-app-engine", "go", "app.yaml"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1454707145, "post_id": 35230998, "comment_id": 58182147, "body": "I&#39;m not sure you can do that, but even if you could, why complicate things unnecessarily? I mean why do this if everyone else does otherwise? Just put <code>app.yaml</code> in the root of your webapp..."}, {"owner": {"reputation": 744, "user_id": 4988608, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4zZPe.gif?s=128&g=1", "display_name": "fxlemire", "link": "https://stackoverflow.com/users/4988608/fxlemire"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1454707825, "post_id": 35230998, "comment_id": 58182463, "body": "Yeah, this is what I did in order to upload my website, but I really liked the idea of bundling GAE files together in a folder since my root folder is starting to get messy (bower, npm, tsd, etc.). I did not think going up a folder would be that complicated :/"}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1454711095, "post_id": 35230998, "comment_id": 58183887, "body": "symlink the files/directories you want inside your <code>appengine</code> dir. They&#39;ll be uploaded, but I&#39;m not sure the app will still work, tho..."}, {"owner": {"reputation": 744, "user_id": 4988608, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4zZPe.gif?s=128&g=1", "display_name": "fxlemire", "link": "https://stackoverflow.com/users/4988608/fxlemire"}, "reply_to_user": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1454867071, "post_id": 35230998, "comment_id": 58225945, "body": "@DanCornilescu It worked!! For both the <code>serve</code> and <code>deploy</code>. You&#39;re a genius, hadn&#39;t thought of symlinks at all. Thanks so much!!! Awesome solution :D"}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1454899763, "post_id": 35230998, "comment_id": 58235501, "body": "Glad to hear. I made it an answer (and added some other symlink-related pointers that may be of interest)"}, {"owner": {"reputation": 744, "user_id": 4988608, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4zZPe.gif?s=128&g=1", "display_name": "fxlemire", "link": "https://stackoverflow.com/users/4988608/fxlemire"}, "edited": false, "score": 0, "creation_date": 1454966404, "post_id": 35230998, "comment_id": 58270737, "body": "Sure! I wish I could upvote your answer, but unfortunately I don&#39;t have enough rep points yet :( Thanks again for your solution!"}], "answers": [{"tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": true, "score": 2, "last_activity_date": 1454899568, "last_edit_date": 1495542630, "creation_date": 1454899029, "answer_id": 35261641, "question_id": 35230998, "link": "https://stackoverflow.com/questions/35230998/how-to-upload-a-google-app-engine-go-project-in-a-different-folder-than-the-ap/35261641#35261641", "title": "How to upload a Google App Engine (Go) project in a different folder than the app.yaml", "body": "<p>You can preserve your desired app structure with 3rd party code residing outside your GAE app code directory yet still be able to upload the 3rd party code together with your GAE app code by just symlinking the 3rd party code files/dirs inside the GAE app dir in the desired locations.</p>\n\n<p>The GAE upload/deploy utilities know to replace the symlinks and upload the actual files/dirs the symlinks point to instead, in the respective locations.</p>\n\n<p>Some other GAE-related scenarios in which the symlink technique can be applied:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/34291075/sharing-entities-between-app-engine-modules/34291789#34291789\">Sharing entities between App Engine modules</a></li>\n<li><a href=\"https://stackoverflow.com/questions/33088104/how-can-i-share-files-html-templates-between-app-engine-modules/33091084#33091084\">How can I share files (HTML templates) between App Engine modules?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/33307128/do-i-need-to-copy-skip-files-across-multiple-yaml-files/33308640#33308640\">Do I need to copy `skip_files` across multiple YAML files?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/34973058/how-do-i-access-a-vendored-library-from-a-module-in-python-google-app-engine/34985211#34985211\">How do I access a vendored library from a module in Python Google App Engine?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/34110178/can-a-default-module-in-a-google-app-engine-app-be-a-sibling-of-a-non-default-mo/34111170#34111170\">Can a default service/module in a Google App Engine app be a sibling of a non-default one in terms of folder structure?</a></li>\n</ul>\n"}], "owner": {"reputation": 744, "user_id": 4988608, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4zZPe.gif?s=128&g=1", "display_name": "fxlemire", "link": "https://stackoverflow.com/users/4988608/fxlemire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 35261641, "answer_count": 1, "score": 0, "last_activity_date": 1454899568, "creation_date": 1454696744, "last_edit_date": 1454704873, "question_id": 35230998, "link": "https://stackoverflow.com/questions/35230998/how-to-upload-a-google-app-engine-go-project-in-a-different-folder-than-the-ap", "title": "How to upload a Google App Engine (Go) project in a different folder than the app.yaml", "body": "<p>My project has the following structure:</p>\n\n<pre><code>| appengine\n|---- app.yaml\n|---- myScript.go\n| bower_components\n|----|...\n| build\n|----|images\n|----|----|branding\n|----|----|---- favicon.ico\n|----|styles\n|----|----|*.css\n|----|index.html\n| src\n| ...\n</code></pre>\n\n<p>I would like to upload the entire content of the build folder when running <code>goapp deploy appengine</code>.</p>\n\n<p>My app.yaml looks like this:</p>\n\n<pre><code>application: myProject\nversion: 0-1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /(.*\\.(gif|png|jpg|ico|js|css))\n  static_files: ../build/\\1\n  upload: ../build/(.*\\.(gif|png|jpg|ico|js|css))\n\n- url: /.*\n  script: _go_app\n</code></pre>\n\n<p>and myScript.go looks like this:</p>\n\n<pre><code>package myProject\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    site, err := ioutil.ReadFile(\"../build/index.html\")\n\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Fprint(w, string(site))\n}\n</code></pre>\n\n<p>When I run <code>goapp serve appengine</code>, the website displays properly. However, when I try to deploy it, it only clones two files, i.e. the ones inside the appengine folder.</p>\n"}, {"tags": ["go", "types"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1454696760, "post_id": 35230857, "comment_id": 58176464, "body": "Username is a string, not a struct, so you can&#39;t do u :=&amp;Username{returnedString}. Is there a reason you can&#39;t do var u string?"}, {"owner": {"reputation": 549, "user_id": 618352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348d2acd843f6a6f8486fa54cf67c350?s=128&d=identicon&r=PG", "display_name": "Jacques Supcik", "link": "https://stackoverflow.com/users/618352/jacques-supcik"}, "edited": false, "score": 0, "creation_date": 1454697293, "post_id": 35230857, "comment_id": 58176783, "body": "Can you give more detail about the error?"}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1454700986, "post_id": 35230857, "comment_id": 58178868, "body": "@william.taylor.09 Username is not a string but a custom type built on a underlying type string."}], "answers": [{"tags": [], "owner": {"reputation": 549, "user_id": 618352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348d2acd843f6a6f8486fa54cf67c350?s=128&d=identicon&r=PG", "display_name": "Jacques Supcik", "link": "https://stackoverflow.com/users/618352/jacques-supcik"}, "is_accepted": false, "score": 1, "last_activity_date": 1454697270, "creation_date": 1454697270, "answer_id": 35231146, "question_id": 35230857, "link": "https://stackoverflow.com/questions/35230857/assign-a-string-type-golang/35231146#35231146", "title": "assign a string type golang", "body": "<p>Type casting in go is explained <a href=\"https://tour.golang.org/basics/13\" rel=\"nofollow\">in the tutorial \"A Tour of Go\"</a></p>\n\n<p>See <a href=\"https://play.golang.org/p/GFj3im1UFD\" rel=\"nofollow\">here for an example</a> using your types.</p>\n"}, {"comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 1, "creation_date": 1454701237, "post_id": 35231670, "comment_id": 58179010, "body": "I wouldn&#39;t have posted my answer if I&#39;d seen this one first."}], "tags": [], "owner": {"reputation": 373, "user_id": 745933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356a3a553d3d1a5a3f5b4f9cbce48f83?s=128&d=identicon&r=PG", "display_name": "GerritS", "link": "https://stackoverflow.com/users/745933/gerrits"}, "is_accepted": false, "score": 13, "last_activity_date": 1454699241, "creation_date": 1454699241, "answer_id": 35231670, "question_id": 35230857, "link": "https://stackoverflow.com/questions/35230857/assign-a-string-type-golang/35231670#35231670", "title": "assign a string type golang", "body": "<p>As others have pointed out, you'll need to do an explicit type conversion:</p>\n\n<pre><code>someString := funcThatReturnsString()\nu := Username(someString)\n</code></pre>\n\n<p>I'd recommend reading <a href=\"http://dominik.honnef.co/posts/2012/12/go__on_implicit_type_conversions__type_identity_and_a_little_gotcha/\" rel=\"noreferrer\">this article</a> on implicit type conversion. Specifically, Honnef references Go's specifications on <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"noreferrer\">assignability</a>:</p>\n\n<blockquote>\n  <p>A value x is assignable to a variable of type T (\"x is assignable to T\") in any of these cases:</p>\n  \n  <ul>\n  <li>x's type V and T have identical underlying types and at least one of V or T is not a named type.</li>\n  </ul>\n</blockquote>\n\n<p>So in your example, the <code>returnedString</code> is already a \"named type\": it has type <code>string.</code> If you had instead done something like</p>\n\n<pre><code>var u Username\nu = \"some string\"\n</code></pre>\n\n<p>you would have been ok, as the <code>\"some string\"</code> would be implicitly converted into type <code>Username</code> and both <code>string</code> and <code>Username</code> have the underlying type of <code>string</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": 7, "last_activity_date": 1454700544, "creation_date": 1454700544, "answer_id": 35232001, "question_id": 35230857, "link": "https://stackoverflow.com/questions/35230857/assign-a-string-type-golang/35232001#35232001", "title": "assign a string type golang", "body": "<p>You've made a user-defined type \"Username\". You cannot assign a value of one type to another type (in this case a string to Username) without converting. Incidentally you can assign a string literal to it.</p>\n\n<pre><code>var u Username\nu = \"test\"\n</code></pre>\n\n<p>Will work.</p>\n\n<pre><code>var u Username\n    var s string\n\n    s = \"test\"\n    u = s\n</code></pre>\n\n<p>Will give you the error:</p>\n\n<blockquote>\n  <p>cannot use s (type string) as type Username in assignment</p>\n</blockquote>\n\n<p>You can <em>convert</em> from one type to another, so...:</p>\n\n<pre><code>var u Username\n    var s string\n    s = \"test\"\n    u = Username(s)\n</code></pre>\n\n<p>...will also work. \"u\" will be of type Username with the value \"test\".</p>\n\n<p>For the record these are not meant as idiomatic examples. I am simply trying to clearly illustrate what's going on with the types here.</p>\n"}], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23314, "favorite_count": 1, "answer_count": 3, "score": 10, "last_activity_date": 1454700544, "creation_date": 1454696196, "question_id": 35230857, "link": "https://stackoverflow.com/questions/35230857/assign-a-string-type-golang", "title": "assign a string type golang", "body": "<p>I'm having a hard time assigned a string to a type string. So I have this type:</p>\n\n<pre><code>type Username string\n</code></pre>\n\n<p>I then have a function that returns a string</p>\n\n<p>What I'm trying to do is set username to that returned string:</p>\n\n<pre><code>u := &amp;Username{returnedString}\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>var u Username\nu = returnedString\n</code></pre>\n\n<p>But I always get an error. </p>\n"}, {"tags": ["go", "cassandra", "pagination", "gocql"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7081201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3faea29895abe06eef7dbd2df163133f?s=128&d=identicon&r=PG&f=1", "display_name": "user7081201", "link": "https://stackoverflow.com/users/7081201/user7081201"}, "is_accepted": false, "score": 1, "last_activity_date": 1477582755, "last_edit_date": 1477582755, "creation_date": 1477582540, "answer_id": 40288772, "question_id": 35224740, "link": "https://stackoverflow.com/questions/35224740/slicemap-when-using-pagesize/40288772#40288772", "title": "SliceMap when using PageSize", "body": "<pre><code>iter := session.Query(\"SELECT * FROM paging\").PageState(nil).PageSize(10).Iter()\n</code></pre>\n\n<p>please use like this</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545242255, "creation_date": 1454676704, "last_edit_date": 1545242255, "question_id": 35224740, "link": "https://stackoverflow.com/questions/35224740/slicemap-when-using-pagesize", "title": "SliceMap when using PageSize", "body": "<p>I am trying to implement paging but when I use SliceMap with PageSize I get all the rows - do you know why and what to do? <br>\nNote: I need the row maps keyed by CQL column mames.</p>\n\n<pre><code>iter := session.Query(\"SELECT * FROM paging\").PageSize(10).Iter()\nslicemap, err := iter.SliceMap()\nsaveState := iter.PageState()\nfmt.Println(slicemap)\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 19, "last_activity_date": 1572439997, "last_edit_date": 1572439997, "creation_date": 1454675211, "answer_id": 35224244, "question_id": 35224066, "link": "https://stackoverflow.com/questions/35224066/how-to-pass-multiple-data-to-go-template/35224244#35224244", "title": "How to pass multiple data to Go template?", "body": "<p>You may only pass a single value, but that value may be a <em>composed</em> value of multiple values, e.g. a struct, map or slice. So simply wrap your multiple data intended for the template in a <code>struct</code> or in a <code>map</code>.</p>\n\n<h3>Example with a <code>struct</code>:</h3>\n\n<pre><code>type Data struct {\n    Results []User // Must be exported!\n    Other   []int  // Must be exported!\n}\n\ndata := &amp;Data{results, []int{1, 2, 3}}\nif err := GetTemplate(\"list\").Execute(w, data); err != nil {\n    // Handle error\n}\n</code></pre>\n\n<p>Also note that a new, named type is not required, you could also use an anonymous struct literal, which could look like this:</p>\n\n<pre><code>data := struct {\n    Results []User // Must be exported!\n    Other   []int  // Must be exported!\n}{results, []int{1, 2, 3}}\n</code></pre>\n\n<h3>Example with a <code>map</code>:</h3>\n\n<pre><code>m := map[string]interface{}{\n    \"Results\": results,\n    \"Other\":   []int{1, 2, 3},\n}\n\nif err := GetTemplate(\"list\").Execute(w, m); err != nil {\n    // Handle error\n}\n</code></pre>\n\n<p>Note that using a map, it is not required to use capitalized <code>string</code>s as keys, e.g. you could've used <code>\"results\"</code> and <code>\"other\"</code> too (but in my opinion it's better to use keys with capital starting letters, should you move to <code>struct</code> sometimes in the future, you would have less corrections to make).</p>\n\n<p>In both cases you may refer to the <code>[]User</code> results with <code>{{.Results}}</code> and to the additional int slice with <code>{{.Other}}</code>.</p>\n\n<p>So for example to range over the users:</p>\n\n<pre><code>{{range .Results}}\n    User name:{{.Name}}\n{{end}}\n</code></pre>\n\n<h3>Example with a <code>slice</code>:</h3>\n\n<pre><code>s := []interface{}{\n    results,\n    []int{1, 2, 3},\n}\n\nif err := GetTemplate(\"list\").Execute(w, s); err != nil {\n    // Handle error\n}\n</code></pre>\n\n<p>This is less readable, but a viable solution. In the template you have to index the template data to get the \"individual\" values, e.g.:</p>\n\n<pre><code>{{range index . 0}}\n    User name:{{.Name}}\n{{end}}\n\nOther: {{index . 1}}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/GLKPf0i5-o1\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<h3>Other ways...</h3>\n\n<p>There are other \"theoretical\" ways too, but I wouldn't use them just because it works.</p>\n\n<p>For example, you could also pass in a channel from which receives would provide the values.</p>\n\n<p>Yet another solution could be to <a href=\"https://stackoverflow.com/questions/35550326/golang-templates-and-passing-funcs-to-template/35550730#35550730\">register custom functions</a> which when called would return the values.</p>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1454675470, "creation_date": 1454675470, "answer_id": 35224322, "question_id": 35224066, "link": "https://stackoverflow.com/questions/35224066/how-to-pass-multiple-data-to-go-template/35224322#35224322", "title": "How to pass multiple data to Go template?", "body": "<p>You should define a struct populated with the database results query, then assign that struct to the <code>Execute</code> method.</p>\n\n<p><code>tmpl.Execute</code> require a <code>Writer</code> interface and a <code>struct</code></p>\n\n<pre><code>type Inventory struct {\n    Material string\n    Count    uint\n}\n\nitems := Inventory{\"trouser\", 1}    \nif err := GetTemplate(\"list\").Execute(w, items); err != nil {\n    // ... do your work\n}\n</code></pre>\n"}], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8728, "favorite_count": 3, "accepted_answer_id": 35224244, "answer_count": 2, "score": 10, "last_activity_date": 1572439997, "creation_date": 1454674683, "question_id": 35224066, "link": "https://stackoverflow.com/questions/35224066/how-to-pass-multiple-data-to-go-template", "title": "How to pass multiple data to Go template?", "body": "<p>I want to pass two data objects to Go Template. One is a MongoDB query result and other is an integer array.</p>\n\n<p>MongoDB Query:-</p>\n\n<pre><code>var results []User\nsess, db := GetDatabase()\ndefer sess.Close()\nc := db.C(\"user\")\nerr := c.Find(nil).All(&amp;results)\n</code></pre>\n\n<p>I want to sent 'result' and an int array through following code</p>\n\n<pre><code>GetTemplate(\"list\").Execute(w,???????)\n</code></pre>\n\n<p>If there is only db result, we could use it as</p>\n\n<pre><code>GetTemplate(\"list\").Execute(w,results)\n</code></pre>\n\n<p>and in template we could access it {{.Name}} etc. (where Name is a struct field of []User)</p>\n\n<p>Please tell me how to pass these data and how to access them in template.</p>\n"}, {"tags": ["web", "go", "channel", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "is_accepted": true, "score": 6, "last_activity_date": 1454675323, "last_edit_date": 1454675323, "creation_date": 1454672891, "answer_id": 35223466, "question_id": 35223285, "link": "https://stackoverflow.com/questions/35223285/golang-goroutines-panic-runtime-error-invalid-memory-address/35223466#35223466", "title": "Golang, goroutines : panic: runtime error: invalid memory address", "body": "<p><strong>The nil dereference:</strong><br>\nYou are trying to access a struct referenced by a pointer, but that pointer has not been set to an instance of that struct. You have to declare a struct that you can point the pointer to.</p>\n\n<p>The error first appears here:</p>\n\n<pre><code>wo.x, wo.y, wo.z = 1,2,3\n</code></pre>\n\n<p>where you try to write to the object pointed to by <code>wo</code>. But the pointer is nil here; it's not actually pointing to an instance of <code>Work</code>. We have to create that instance, so we can point to it.</p>\n\n<p>The nil value for a pointer to a struct is <code>nil</code>. If you don't declare a struct instance for it to point to, it points to nil.</p>\n\n<pre><code>var wo *Work\n</code></pre>\n\n<p>declares <code>wo</code> as a pointer of type <code>Work</code> to <code>nil</code>.</p>\n\n<pre><code> var wo = &amp;Work{}\n</code></pre>\n\n<p>declares <code>wo</code> as a pointer of type <code>Work</code> to a new instance of <code>Work</code>.</p>\n\n<p>Or you can use the shorter syntax:</p>\n\n<pre><code>wo := &amp;Work{}\n</code></pre>\n\n<p><strong>As for the deadlock:</strong>  </p>\n\n<p>When we close a channel, range loops over that channel will exit. In <code>func worker</code> we range over a channel. When this channel is closed, the worker(s) will exit.</p>\n\n<p>In order to wait for all the workers to finish processing, we use a <code>sync.WaitGroup</code>. This is an easy way to wait for a group of goroutines to finish running before continuing. </p>\n\n<p>First you tell the waitgroup how many goroutines it should wait for.</p>\n\n<pre><code>wg.Add(3)\n</code></pre>\n\n<p>Then you wait:</p>\n\n<pre><code>wg.Wait()\n</code></pre>\n\n<p>until all of the goroutines have called</p>\n\n<pre><code>wg.Done()\n</code></pre>\n\n<p>which they do when they are done executing.</p>\n\n<p>In this case, we need to close the output channel when all workers are done executing, so that the <code>func receiveWork</code> can exit its for range loop. We can do this by starting a new goroutine for this task:</p>\n\n<pre><code>go func() {\n    wg.Wait()\n    close(out)\n}()\n</code></pre>\n\n<p>This is the whole file, after these edits:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\ntype Work struct {\n    x, y, z int\n}\n\nfunc worker(in &lt;-chan *Work, out chan&lt;- *Work, wg *sync.WaitGroup) {\n    for w := range in {\n        w.z = w.x + w.y\n        time.Sleep(time.Duration(w.z))\n        out &lt;- w\n    }\n    wg.Done() // this worker is now done; let the WaitGroup know.\n}\n\nfunc sendWork(in chan&lt;- *Work) {\n    wo := &amp;Work{x: 1, y: 2, z: 3} // more compact way of initializing the struct\n    in &lt;- wo\n    in &lt;- wo\n    in &lt;- wo\n    in &lt;- wo\n    in &lt;- wo\n    close(in) // we are done sending to this channel; close it\n}\n\nfunc receiveWork(out &lt;-chan *Work) []*Work {\n    var slice []*Work\n    for el := range out {\n        slice = append(slice, el)\n    }\n    return slice\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n    in, out := make(chan *Work), make(chan *Work)\n    wg.Add(3) // number of workers\n    for i := 0; i &lt; 3; i++ {\n        go worker(in, out, &amp;wg)\n    }\n\n    go sendWork(in)\n\n    go func() {\n        wg.Wait()\n        close(out)\n    }()\n\n    data := receiveWork(out)\n\n    fmt.Printf(\"%v\", data)\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>[0x104382f0 0x104382f0 0x104382f0 0x104382f0 0x104382f0]\n</code></pre>\n\n<p>which is probably not what you expected. It does however highlight one problem with this code. More on that later.</p>\n\n<p>If you want to print the contents of the structs, you could either stop using pointers to <code>Work</code>, or loop over the elements of the slice and print them one-by-one, like this:</p>\n\n<pre><code>for _, w := range data {\n    fmt.Printf(\"%v\", w)\n}\n</code></pre>\n\n<p>which outputs:</p>\n\n<pre><code>&amp;{1 2 3}&amp;{1 2 3}&amp;{1 2 3}&amp;{1 2 3}&amp;{1 2 3}\n</code></pre>\n\n<p>Go doesn't follow pointers more than one step down when printing, to avoid infinite recursion, so you have to do this manually.</p>\n\n<p><strong>Race condition:</strong></p>\n\n<p>Since you are sending pointers to the same instance of <code>*Work</code> multiple times down the channel, that same instance is being accessed by multiple goroutines at the same time without synchronization. What you probably want is to stop using pointers, and use values. <code>Work</code> instead of <code>*Work</code>. </p>\n\n<p>If you want to use pointers, maybe because <code>Work</code> is actually really big, you probably want to make multiple instances of <code>*Work</code> so you only ever send it to one goroutine. </p>\n\n<p>Here's what the <a href=\"https://blog.golang.org/race-detector\" rel=\"noreferrer\">go race detector</a> has to say about the code:</p>\n\n<pre><code>C:/Go\\bin\\go.exe run -race C:/gopath/src/github.com/drathier/scratchpad/go/main/main.go\n[0xc0820403c0 0xc0820403c0 0xc0820403c0 0xc0820403c0 0xc0820403c0]==================\nWARNING: DATA RACE\nWrite by goroutine 6:\n  main.worker()\n      C:/gopath/src/github.com/drathier/scratchpad/go/main/main.go:15 +0x8a\n\nPrevious write by goroutine 8:\n  main.worker()\n      C:/gopath/src/github.com/drathier/scratchpad/go/main/main.go:15 +0x8a\n\nGoroutine 6 (running) created at:\n  main.main()\n      C:/gopath/src/github.com/drathier/scratchpad/go/main/main.go:45 +0x10c\n\nGoroutine 8 (running) created at:\n  main.main()\n      C:/gopath/src/github.com/drathier/scratchpad/go/main/main.go:45 +0x10c\n==================\nFound 1 data race(s)\nexit status 66\n</code></pre>\n\n<p>At this row:</p>\n\n<pre><code>w.z = w.x + w.y\n</code></pre>\n\n<p>all goroutines are modifying <code>w.z</code> concurrently, so if they try to write different values to <code>w.z</code>, there's no telling what value actually end up in there. Once again, this is easily fixed by creating multiple instances of <code>*Work</code>, or by using values instead of pointers: <code>Work</code>.</p>\n"}], "owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2871, "favorite_count": 0, "accepted_answer_id": 35223466, "answer_count": 1, "score": 4, "last_activity_date": 1454675323, "creation_date": 1454672364, "question_id": 35223285, "link": "https://stackoverflow.com/questions/35223285/golang-goroutines-panic-runtime-error-invalid-memory-address", "title": "Golang, goroutines : panic: runtime error: invalid memory address", "body": "<p>I'm rather new in golang, and trying to understand main principles and write gouroutines based code, using chanels. </p>\n\n<p>In others langs that i was using there were no such instruments, and i wonder getting such an errors like panic...</p>\n\n<p>my code: </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport (\n    \"time\"\n)\ntype Work struct {\n    x,y,z int\n}\n\nfunc worker(in &lt;-chan *Work, out chan&lt;- *Work){\n    for w := range in {\n        w.z = w.x + w.y\n        time.Sleep(time.Duration(w.z))\n        out &lt;-w\n    }\n}\n\nfunc sendWork(in chan &lt;- *Work){\n    var wo *Work\n    wo.x, wo.y, wo.z = 1,2,3\n    in &lt;- wo\n    in &lt;- wo\n    in &lt;- wo\n    in &lt;- wo\n    in &lt;- wo\n}\n\nfunc receiveWork(out &lt;-chan *Work ) []*Work{\n    var  slice []*Work\n    for el := range out {\n        slice = append(slice, el)\n    }\n    return slice\n}\n\nfunc main() {\n    in, out := make(chan *Work), make(chan *Work)\n    for i := 0; i&lt;3; i++{\n        go worker(in, out)\n    }\n\n    go sendWork(in)\n\n    data := receiveWork(out)\n\n    fmt.Printf(\"%v\", data)\n}\n</code></pre>\n\n<p>But at the terminal i got this : </p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x1 addr=0x0 pc=0x401130]\n\ngoroutine 8 [running]:\nmain.sendWork(0xc0820101e0)\n        C:/temp/gocode/src/helloA/helloA.go:21 +0x20\ncreated by main.main\n        C:/temp/gocode/src/helloA/helloA.go:43 +0xe4\n\ngoroutine 1 [chan receive]:\nmain.receiveWork(0xc082010240, 0x0, 0x0, 0x0)\n        C:/temp/gocode/src/helloA/helloA.go:31 +0x80\nmain.main()\n        C:/temp/gocode/src/helloA/helloA.go:45 +0xf2\n\ngoroutine 5 [chan receive]:\nmain.worker(0xc0820101e0, 0xc082010240)\n        C:/temp/gocode/src/helloA/helloA.go:12 +0x55\ncreated by main.main\n        C:/temp/gocode/src/helloA/helloA.go:40 +0xaf\n\ngoroutine 6 [runnable]:\nmain.worker(0xc0820101e0, 0xc082010240)\n        C:/temp/gocode/src/helloA/helloA.go:11\ncreated by main.main\n        C:/temp/gocode/src/helloA/helloA.go:40 +0xaf\n\ngoroutine 7 [runnable]:\nmain.worker(0xc0820101e0, 0xc082010240)\n        C:/temp/gocode/src/helloA/helloA.go:11\ncreated by main.main\n        C:/temp/gocode/src/helloA/helloA.go:40 +0xaf\n</code></pre>\n\n<p>How can i determine where is the problem, and how can i close the gouroutines nicely, not to left them as processes...</p>\n\n<p>p.s. Forgive me my noob questions. please</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1454672734, "post_id": 35222853, "comment_id": 58160684, "body": "If you ever want to scale to more than one instance, you will run into consistency problems: which instance will handle which notification, etc. Maybe a better approach could be using a message queue that was designed for problems like this like RabbitMQ."}, {"owner": {"reputation": 2741, "user_id": 842077, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9b1f84f21accf057a5683c53ac0f8b59?s=128&d=identicon&r=PG", "display_name": "olif", "link": "https://stackoverflow.com/users/842077/olif"}, "reply_to_user": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1454673127, "post_id": 35222853, "comment_id": 58160968, "body": "That is very true, I was not aware of the delayed_message plugin. However, I&#39;m still interested in an answer for the case when one instance is enough."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1454673178, "post_id": 35222853, "comment_id": 58161002, "body": "Keep in mind that RabbitMQ doesn&#39;t handle consistency properly, just like many other datastores. <a href=\"https://www.youtube.com/watch?v=QdkS6ZjeR7Q\" rel=\"nofollow noreferrer\">youtube.com/watch?v=QdkS6ZjeR7Q</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": true, "score": 2, "last_activity_date": 1454675874, "creation_date": 1454675874, "answer_id": 35224471, "question_id": 35222853, "link": "https://stackoverflow.com/questions/35222853/persistent-scheduling-in-golang/35224471#35224471", "title": "Persistent scheduling in Golang", "body": "<p>If you don't want to use external tools and one instance is enough, you could: </p>\n\n<ol>\n<li>Read the DB on service start and put all pending notifications in a list</li>\n<li>Sort the list by <code>delayUntil</code> and get the time <code>t</code> of the next (earliest) notification. </li>\n<li>Sleep until <code>t</code>, wake up, send all notifications where <code>delayUntil &gt;= t</code> in their own goroutine, delete them from the list and the DB.</li>\n<li>Repeat with step 2. </li>\n</ol>\n\n<p>That's very roughly how cron works. Of course you have to handle insertions and other special cases. Have a look at <a href=\"https://github.com/robfig/cron/blob/master/cron.go\" rel=\"nofollow\">https://github.com/robfig/cron/blob/master/cron.go</a> to get started.</p>\n"}], "owner": {"reputation": 2741, "user_id": 842077, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/9b1f84f21accf057a5683c53ac0f8b59?s=128&d=identicon&r=PG", "display_name": "olif", "link": "https://stackoverflow.com/users/842077/olif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1032, "favorite_count": 0, "accepted_answer_id": 35224471, "answer_count": 1, "score": 0, "last_activity_date": 1454675874, "creation_date": 1454671192, "last_edit_date": 1454673200, "question_id": 35222853, "link": "https://stackoverflow.com/questions/35222853/persistent-scheduling-in-golang", "title": "Persistent scheduling in Golang", "body": "<p>I'm writing a simple notification service i Go. The service provides a REST api where one can put notifications, for instance</p>\n\n<pre><code>{\n   delayUntil: '2016-02-05T18:00:00'\n   user: 'username',\n   msg: 'Hello World',\n   isSent: false\n}\n</code></pre>\n\n<p>Now I would like to send a notification to the user at time delayUntil with the requirement that the service should work even if it restarted which means I have to persist the notification. Right now I'm using BoltDB (key/value store).</p>\n\n<p>One way to solve this is to continuously read the DB and send a notification where the delayUntil has passed.</p>\n\n<p>Another way could be to read the DB on service start, and put each notification in a goroutine which fires at the delayUntil time. After the message has been sent, it is marked as Sent in the DB. New entries coming in to the API are inserted into the DB and scheduled.</p>\n\n<p>Is there a preferred/better/simpler way to achieve this?</p>\n\n<p><strong>Edit:</strong> Only one instance is required.</p>\n"}, {"tags": ["unix", "go", "command-line"], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "edited": false, "score": 0, "creation_date": 1454680023, "post_id": 35223239, "comment_id": 58165792, "body": "Thanks for the feedback. It led to my eventual solution"}], "tags": [], "owner": {"reputation": 806, "user_id": 2547389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f943f94b1bfe169a3291c5b94b7f938a?s=128&d=identicon&r=PG", "display_name": "wlredeye", "link": "https://stackoverflow.com/users/2547389/wlredeye"}, "is_accepted": false, "score": 1, "last_activity_date": 1454672255, "creation_date": 1454672255, "answer_id": 35223239, "question_id": 35222195, "link": "https://stackoverflow.com/questions/35222195/running-go-from-the-command-line-nested-json/35223239#35223239", "title": "Running Go from the command line nested JSON", "body": "<p>Why don't you just put your json config to the file and provide config file name to your application using <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow\">flag</a> package</p>\n"}, {"tags": [], "owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "is_accepted": true, "score": 0, "last_activity_date": 1454680263, "creation_date": 1454680263, "answer_id": 35225864, "question_id": 35222195, "link": "https://stackoverflow.com/questions/35222195/running-go-from-the-command-line-nested-json/35225864#35225864", "title": "Running Go from the command line nested JSON", "body": "<p>Based on the feedback from wiredeye I went down the argument route instead. I've modified the program to run on:</p>\n\n<pre><code>go run main.go field:value field2:value json-string:\"{\\\"nestedfield\\\":nestedvalue}\"\n</code></pre>\n\n<p>I can then iterate over the os.Args and get the nested json within my program. I'm not using flags directly as I don't know the amount of inputs into the program which would have required me to use duplicate flags (not supported) or parse the flag to a collection (doesn't seem to be supported).</p>\n\n<p>Thanks wiredeye</p>\n"}], "owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 35225864, "answer_count": 2, "score": 0, "last_activity_date": 1454680263, "creation_date": 1454669293, "question_id": 35222195, "link": "https://stackoverflow.com/questions/35222195/running-go-from-the-command-line-nested-json", "title": "Running Go from the command line nested JSON", "body": "<p>I can think of workarounds on how to get this working however I'm interested in finding out if there's a solution to this specific problem.</p>\n\n<p>I've got a go program which requires a json string arguement: </p>\n\n<pre><code>go run main.go \"{ \\\"field\\\" : \\\"value\\\" }\"\n</code></pre>\n\n<p>No problems so far. However, am I able to run from the command line if one of the json values is another json string?</p>\n\n<pre><code>go run main.go \"{ \\\"json-string\\\" : \\\"{\\\"nestedfield\\\" : \\\"nestedvalue\\\"}\\\" }\"\n</code></pre>\n\n<p>It would seem that adding escape characters incorrectly matches up the opening and closing quotes. Am I minuderstanding how this is done or is it (and this is the side I'm coming down on) simply not possible?</p>\n\n<p>To reiterate, this is a question that has piqued my curiosity - I'm aware of alternative approaches - I'm hoping for input related to this specific problem. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1454670113, "post_id": 35221537, "comment_id": 58158899, "body": "You have a single result. How many lines you should obtain? For me the code looks good."}, {"owner": {"reputation": 2253, "user_id": 1630586, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/902ef27763348c8d6d6aba56ffdf7304?s=128&d=identicon&r=PG", "display_name": "Julio", "link": "https://stackoverflow.com/users/1630586/julio"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1454670295, "post_id": 35221537, "comment_id": 58159038, "body": "@SimoEndre: I should obtain 5 lines. I have edited the post with the output from shell command."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1454673006, "creation_date": 1454673006, "answer_id": 35223491, "question_id": 35221537, "link": "https://stackoverflow.com/questions/35221537/goland-reading-liner-per-line-output-of-a-command/35223491#35223491", "title": "Goland reading liner per line output of a command", "body": "<p><code>{1..5}</code> is expanded to <code>1 2 3 4 5</code> by the shell, so you must do it yourself:</p>\n\n<pre><code>cmd := exec.Command(\"printf\", `{\"Name\": \"Bob\", \"Age\": %s}\\n`, `1`, `2`) // etc.\n</code></pre>\n\n<p>Also note the use of raw strings, its much more convenient than constantly escaping everything. And on a related note, instead of <code>[]byte(scanner.Text())</code> you should really use <code>scanner.Bytes()</code>.</p>\n"}], "owner": {"reputation": 2253, "user_id": 1630586, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/902ef27763348c8d6d6aba56ffdf7304?s=128&d=identicon&r=PG", "display_name": "Julio", "link": "https://stackoverflow.com/users/1630586/julio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 35223491, "answer_count": 1, "score": 1, "last_activity_date": 1454673006, "creation_date": 1454667418, "last_edit_date": 1454670229, "question_id": 35221537, "link": "https://stackoverflow.com/questions/35221537/goland-reading-liner-per-line-output-of-a-command", "title": "Goland reading liner per line output of a command", "body": "<p>I would like to read an output command line per line. For this I use the <code>StdoutPipe</code> method and the <code>bufio</code> library: </p>\n\n<pre><code>package main\n\nimport (\n        \"encoding/json\"\n        \"fmt\"\n        \"log\"\n        \"os/exec\"\n        \"bufio\"\n)\n\n\nfunc main() {\n        cmd := exec.Command(\"printf\", \"{\\\"Name\\\": \\\"Bob\\\", \\\"Age\\\": 1}\\n%.0s\", \"{1..5}\")\n        stdout, err := cmd.StdoutPipe()\n        if err != nil {\n                log.Fatal(err)\n        }\n        scanner := bufio.NewScanner(stdout)\n        if err := cmd.Start(); err != nil {\n                log.Fatal(err)\n        }\n        var person struct {\n                Name string\n                Age  int\n        }\n        for scanner.Scan() {\n                if err := json.Unmarshal([]byte(scanner.Text()), &amp;person); err != nil {\n                        log.Fatal(err)\n                } else {\n                        fmt.Printf(\"%s is %d years old\\n\", person.Name, person.Age)\n                }\n        }\n        if err := cmd.Wait(); err != nil {\n                log.Fatal(err)\n        }\n}\n</code></pre>\n\n<p>I should obtain 5 lines:</p>\n\n<pre><code>$ printf \"{\\\"Name\\\": \\\"Bob\\\", \\\"Age\\\": 1}\\n%.0s\" {1..5}\n{\"Name\": \"Bob\", \"Age\": 1}\n{\"Name\": \"Bob\", \"Age\": 1}\n{\"Name\": \"Bob\", \"Age\": 1}\n{\"Name\": \"Bob\", \"Age\": 1}\n{\"Name\": \"Bob\", \"Age\": 1}\n</code></pre>\n\n<p>The point is that I only get the first line. I am quite new on <code>Go</code>and I guess the usage of the StdoutPipe is incorrect.</p>\n"}, {"tags": ["go", "interface", "tcpserver"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1454680837, "post_id": 35219826, "comment_id": 58166373, "body": "Are you certain <code>ENQ</code> and <code>ACK</code> in this context refer to types of TCP packets?  (there don&#39;t seem to be any open specifications for ASTM E-1394). That summary makes it look as if it&#39;s a text protocol over tcp, and you simply write those ascii codes on the line, but there&#39;s no description of what the physical or transport layer are supposed to be."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1454681215, "post_id": 35219826, "comment_id": 58166651, "body": "Actually, looking at the example order on that page, the codes like <code>&lt;ENQ&gt;</code>, <code>&lt;STX&gt;</code>, <code>&lt;ETX&gt;</code>, <code>&lt;EOT&gt;</code>, etc. are all ASCII characters. Do you just need to know how to write those to a network connection?"}, {"owner": {"reputation": 338, "user_id": 301590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4ea24d9dd5a81e49d1141aff2cbcd61b?s=128&d=identicon&r=PG", "display_name": "Vijendra", "link": "https://stackoverflow.com/users/301590/vijendra"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1454848299, "post_id": 35219826, "comment_id": 58219508, "body": "Thank you. That should be write. Yet to check it with actual machine integration. But I found a ruby test code client.putc(0x06.chr), we have written long back, which shows it is just ASCII chars."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1454943719, "post_id": 35219826, "comment_id": 58256913, "body": "OK, so do you still have a question? If so please edit this with an example showing where you&#39;re having a problem."}, {"owner": {"reputation": 338, "user_id": 301590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4ea24d9dd5a81e49d1141aff2cbcd61b?s=128&d=identicon&r=PG", "display_name": "Vijendra", "link": "https://stackoverflow.com/users/301590/vijendra"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1476867141, "post_id": 35219826, "comment_id": 67523053, "body": "Sorry for the delayed response. Sending HEX ACK like this works fine.  c := &amp;serial.Config{Name: &quot;/dev/ttyUSB0&quot;, Baud: 9600, Size: 8}  conn, err := serial.OpenPort(c)  conn.Write([]byte{0x06})"}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 3782299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a9f74eaa9e78675a676e67db5b1b46?s=128&d=identicon&r=PG&f=1", "display_name": "user3782299", "link": "https://stackoverflow.com/users/3782299/user3782299"}, "is_accepted": false, "score": 0, "last_activity_date": 1467558796, "last_edit_date": 1467558796, "creation_date": 1467447646, "answer_id": 38158068, "question_id": 35219826, "link": "https://stackoverflow.com/questions/35219826/how-to-send-data-packets-like-ack-and-enq-using-golang/38158068#38158068", "title": "How to send data packets like ACK and ENQ using golang", "body": "<p>The protocol in the link you supplied is for RS232.  When sending data over TCPIP it is a stream (the receiver has to know when the data ends). Normally when changing an RS232 protocol to TCPIP, a header is added to each message which is the length of the message (often two bytes), so if you want to send ASCII ACK you send three bytes a two byte length and one byte data.  When writing this you must flush the buffer, as for such a small packet it will not be transmitted until you do.</p>\n"}], "owner": {"reputation": 338, "user_id": 301590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4ea24d9dd5a81e49d1141aff2cbcd61b?s=128&d=identicon&r=PG", "display_name": "Vijendra", "link": "https://stackoverflow.com/users/301590/vijendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1005, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1548288257, "creation_date": 1454662268, "question_id": 35219826, "link": "https://stackoverflow.com/questions/35219826/how-to-send-data-packets-like-ack-and-enq-using-golang", "title": "How to send data packets like ACK and ENQ using golang", "body": "<p>I am writing an interface to a clinical lab machine, which uses ASTM protocol for communication (<a href=\"http://makecircuits.com/blog/2010-06-25-astm-protocol.html\" rel=\"nofollow\">http://makecircuits.com/blog/2010-06-25-astm-protocol.html</a>). </p>\n\n<p>To start with, I am trying to use golang's TCP Server to receive data. But not able to figure how to send ACK back to lab machine. I am a newbie in golang. Can any one suggest how I can proceed?        </p>\n"}, {"tags": ["javascript", "jquery", "go"], "comments": [{"owner": {"reputation": 6828, "user_id": 2118955, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002675596432/picture?type=large", "display_name": "hindmost", "link": "https://stackoverflow.com/users/2118955/hindmost"}, "edited": false, "score": 0, "creation_date": 1454658960, "post_id": 35218732, "comment_id": 58152317, "body": "Perhaps the issue is related to <code>Content-Type</code> header which is set to <code>application&#47;x-www-form-urlencoded</code> by default. Try change it to <code>application&#47;octet-stream</code>."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1454662579, "post_id": 35218732, "comment_id": 58154154, "body": "Never done that in Go, but should you be decoding the <code>image</code> field of the request data ? The body probably doesn&#39;t contain a valid image\u2026 more something like <code>image=YourImageEncodingData</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1454663902, "post_id": 35218732, "comment_id": 58154928, "body": "You only examine if <code>err != nil</code>, but <i>what is</i> the error? <code>error</code> is not just a <code>bool</code>-like type (being <code>nil</code> or non-<code>nil</code>)..."}], "answers": [{"tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": false, "score": 0, "last_activity_date": 1454669866, "last_edit_date": 1454669866, "creation_date": 1454669509, "answer_id": 35222274, "question_id": 35218732, "link": "https://stackoverflow.com/questions/35218732/attach-image-as-body-in-post-request-to-golang-server/35222274#35222274", "title": "attach image as body in POST request to golang server", "body": "<p>FormData is very different from sending the image as raw bytes.\nHere is an example on how to get the files from a multipart/form-data request:</p>\n\n<pre><code>func (h *ItemHandler) PostImage(resp http.ResponseWriter, req *http.Request) {\n  vars := mux.Vars(req)\n  itemID := vars[\"id\"]\n  assetID := newAssetID()\n\n  file, _, err := req.FormFile(\"image\")\n  if err != nil{\n    log.Print(err)\n    resp.WriteHeader(http.StatusBadRequest)\n    return\n  }\n\n  // verify image\n  img, _, err := image.Decode(file)\n  if err != nil {\n    log.Printf(\"could not decode body into an image\")\n    resp.Header().Add(\"Access-Control-Allow-Origin\", \"*\")\n    resp.WriteHeader(http.StatusBadRequest)\n    resp.Write([]byte(\"could not decode body image\"))\n    return\n  }\n  ...\n}\n</code></pre>\n\n<p>See <a href=\"https://golang.org/pkg/net/http/#Request.FormFile\" rel=\"nofollow\">https://golang.org/pkg/net/http/#Request.FormFile</a></p>\n"}], "owner": {"reputation": 61, "user_id": 2529177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9c9756375f4160a861bd10d7f5f1d11?s=128&d=identicon&r=PG", "display_name": "user2529177", "link": "https://stackoverflow.com/users/2529177/user2529177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1702, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1454669866, "creation_date": 1454658160, "question_id": 35218732, "link": "https://stackoverflow.com/questions/35218732/attach-image-as-body-in-post-request-to-golang-server", "title": "attach image as body in POST request to golang server", "body": "<p>I have a local golang server with an endpoint that listens to POST requests, decodes the body of the request, and persists it. This works when I manually curl the endpoint like </p>\n\n<pre><code>    curl -X POST localhost:8080/newimage --data-binary \"PATH\"\n</code></pre>\n\n<p>However, I'm having trouble successfully uploading a file in a POST request through a gui I'm working on. I'm using <a href=\"https://github.com/okonet/react-dropzone\" rel=\"nofollow\">https://github.com/okonet/react-dropzone</a> to drop a <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/File\" rel=\"nofollow\">File</a> and appending it to a FormData object, but the golang server does not seem to be receiving a populated body. </p>\n\n<p>This is how I'm creating the AJAX query:</p>\n\n<pre><code>    formData = new FormData();\n    formData.append(\"image\", file)\n    $.ajax({\n        url: \"http://localhost:8080/items/81d648b0-25f9-434e-9129-fe52575865dd/newimage\",\n        type: \"POST\",\n        data: formData,\n        processData: false\n    }).done(function(res) {\n        console.log(res);\n    });\n</code></pre>\n\n<p>And the backend server:</p>\n\n<pre><code>func (h *ItemHandler) PostImage(resp http.ResponseWriter, req *http.Request) {\nvars := mux.Vars(req)\nitemID := vars[\"id\"]\nassetID := newAssetID()\n\n// verify image\nimg, _, err := image.Decode(req.Body)\nif err != nil {\n    log.Printf(\"could not decode body into an image\")\n    resp.Header().Add(\"Access-Control-Allow-Origin\", \"*\")\n    resp.WriteHeader(http.StatusBadRequest)\n    resp.Write([]byte(\"could not decode body image\"))\n    return\n}\n</code></pre>\n\n<p>Would appreciate any suggestions.</p>\n"}, {"tags": ["json", "parsing", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1454651471, "creation_date": 1454651471, "answer_id": 35217163, "question_id": 35216612, "link": "https://stackoverflow.com/questions/35216612/how-to-get-the-particular-value-from-parsed-json-array-by-using-golang/35217163#35217163", "title": "How to get the particular value from parsed json array by using golang?", "body": "<p>If the goal is to print the identifier of the second array element, then use this code:</p>\n\n<pre><code>myId := keys[1].ID  // l changed 1, Id changed to ID\nfmt.Println(myId)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/TV7VDrcpEb\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 4758, "user_id": 3589983, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YKLr1.jpg?s=128&g=1", "display_name": "cfprabhu", "link": "https://stackoverflow.com/users/3589983/cfprabhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 35217163, "answer_count": 1, "score": 0, "last_activity_date": 1454651471, "creation_date": 1454648666, "question_id": 35216612, "link": "https://stackoverflow.com/questions/35216612/how-to-get-the-particular-value-from-parsed-json-array-by-using-golang", "title": "How to get the particular value from parsed json array by using golang?", "body": "<p>I am trying to get direct message from twitter using twitter api. I got the api json array respose like</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>[{\r\n\t\"id\": 694476444991229955,\r\n\t\"id_str\": \"694476444991229955\",\r\n\t\"text\": \"Got it\",\r\n\t\"sender\": {\r\n\t\t\"id\": 1690262984,\r\n\t\t\"id_str\": \"1690262984\",\r\n\t\t\"name\": \"Ashok Kumar T\",\r\n\t\t\"screen_name\": \"Ashok_kumar_T\",\r\n\t\t\"location\": \"Trivandrum\",\r\n\t\t\"description\": \"\",\r\n\t\t\"url\": null\r\n\t\t},\r\n\t\t\"protected\": false,\r\n\t\t\"followers_count\": 68,\r\n\t\t\"friends_count\": 32,\r\n\t\t\"listed_count\": 0,\r\n\t\t\"created_at\": \"Thu Aug 22 06:52:53 +0000 2013\",\r\n\t\t\"favourites_count\": 5,\r\n\t\t\"utc_offset\": 19800,\r\n\t\t\"time_zone\": \"Chennai\",\r\n\t\t\"geo_enabled\": true,\r\n\t\t\"verified\": false,\r\n\t\t\"statuses_count\": 124,\r\n\t\t\"lang\": \"en\",\r\n\t\t\"contributors_enabled\": false,\r\n\t\t\"is_translator\": false,\r\n\t\t\"is_translation_enabled\": false,\r\n\t\t\"profile_background_color\": \"131516\",\r\n\t\t\"profile_background_image_url\": \"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme14\\/bg.gif\",\r\n\t\t\"profile_background_image_url_https\": \"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme14\\/bg.gif\",\r\n\t\t\"profile_background_tile\": true,\r\n\t\t\"profile_image_url\": \"http:\\/\\/pbs.twimg.com\\/profile_images\\/378800000337984382\\/5eded5a0c6fda4a85511aff15e5befd9_normal.jpeg\",\r\n\t\t\"profile_image_url_https\": \"https:\\/\\/pbs.twimg.com\\/profile_images\\/378800000337984382\\/5eded5a0c6fda4a85511aff15e5befd9_normal.jpeg\",\r\n\t\t\"profile_banner_url\": \"https:\\/\\/pbs.twimg.com\\/profile_banners\\/1690262984\\/1429709252\",\r\n\t\t\"profile_link_color\": \"009999\",\r\n\t\t\"profile_sidebar_border_color\": \"EEEEEE\",\r\n\t\t\"profile_sidebar_fill_color\": \"EFEFEF\",\r\n\t\t\"profile_text_color\": \"333333\",\r\n\t\t\"profile_use_background_image\": true,\r\n\t\t\"has_extended_profile\": false,\r\n\t\t\"default_profile\": false,\r\n\t\t\"default_profile_image\": false,\r\n\t\t\"following\": true,\r\n\t\t\"follow_request_sent\": false,\r\n\t\t\"notifications\": false\r\n\t}]</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have successfully parsed the json.But I cant get the particular data from parsed json. Here my play golang link <a href=\"http://play.golang.org/p/zS42Qws2Di\" rel=\"nofollow\">http://play.golang.org/p/zS42Qws2Di</a></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>package main\r\n\r\nimport (\r\n\t\"encoding/json\"\r\n\t\"fmt\"\r\n\t\r\n\t\r\n)\r\n\r\ntype PublicKey struct {\r\n\tID int64\r\n\tID_STR string\r\n\tText string\r\n\tSENDER struct {\r\n         ID int64\r\n         ID_STR string\r\n\t NAME string\r\n   \t}\r\n\tPROTECTED bool\r\n\tFOLLOWERS_COUNT int\r\n\tFRIENDS_COUNT int\r\n\tLISTED_COUNT int\r\n\t\r\n}\r\n\r\ntype KeysResponse struct {\r\n\tCollection []PublicKey\r\n}\r\n\r\nfunc main() {\r\n\ts := `[{\r\n\t\"id\": 694476444991229955,\r\n\t\"id_str\": \"694476444991229955\",\r\n\t\"text\": \"Got it\",\r\n\t\"sender\": {\r\n\t\t\"id\": 1690262984,\r\n\t\t\"id_str\": \"1690262984\",\r\n\t\t\"name\": \"Ashok Kumar T\",\r\n\t\t\"screen_name\": \"Ashok_kumar_T\",\r\n\t\t\"location\": \"Trivandrum\",\r\n\t\t\"description\": \"\",\r\n\t\t\"url\": null\r\n\t\t},\r\n\t\t\"protected\": false,\r\n\t\t\"followers_count\": 68,\r\n\t\t\"friends_count\": 32,\r\n\t\t\"listed_count\": 0,\r\n\t\t\"created_at\": \"Thu Aug 22 06:52:53 +0000 2013\",\r\n\t\t\"favourites_count\": 5,\r\n\t\t\"utc_offset\": 19800,\r\n\t\t\"time_zone\": \"Chennai\",\r\n\t\t\"geo_enabled\": true,\r\n\t\t\"verified\": false,\r\n\t\t\"statuses_count\": 124,\r\n\t\t\"lang\": \"en\",\r\n\t\t\"contributors_enabled\": false,\r\n\t\t\"is_translator\": false,\r\n\t\t\"is_translation_enabled\": false,\r\n\t\t\"profile_background_color\": \"131516\",\r\n\t\t\"profile_background_image_url\": \"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme14\\/bg.gif\",\r\n\t\t\"profile_background_image_url_https\": \"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme14\\/bg.gif\",\r\n\t\t\"profile_background_tile\": true,\r\n\t\t\"profile_image_url\": \"http:\\/\\/pbs.twimg.com\\/profile_images\\/378800000337984382\\/5eded5a0c6fda4a85511aff15e5befd9_normal.jpeg\",\r\n\t\t\"profile_image_url_https\": \"https:\\/\\/pbs.twimg.com\\/profile_images\\/378800000337984382\\/5eded5a0c6fda4a85511aff15e5befd9_normal.jpeg\",\r\n\t\t\"profile_banner_url\": \"https:\\/\\/pbs.twimg.com\\/profile_banners\\/1690262984\\/1429709252\",\r\n\t\t\"profile_link_color\": \"009999\",\r\n\t\t\"profile_sidebar_border_color\": \"EEEEEE\",\r\n\t\t\"profile_sidebar_fill_color\": \"EFEFEF\",\r\n\t\t\"profile_text_color\": \"333333\",\r\n\t\t\"profile_use_background_image\": true,\r\n\t\t\"has_extended_profile\": false,\r\n\t\t\"default_profile\": false,\r\n\t\t\"default_profile_image\": false,\r\n\t\t\"following\": true,\r\n\t\t\"follow_request_sent\": false,\r\n\t\t\"notifications\": false\r\n\t},{\r\n\t\"id\": 694476444991229955,\r\n\t\"id_str\": \"694476444991229955\",\r\n\t\"text\": \"Got it\",\r\n\t\"sender\": {\r\n\t\t\"id\": 1690262984,\r\n\t\t\"id_str\": \"1690262984\",\r\n\t\t\"name\": \"Ashok Kumar T\",\r\n\t\t\"screen_name\": \"Ashok_kumar_T\",\r\n\t\t\"location\": \"Trivandrum\",\r\n\t\t\"description\": \"\",\r\n\t\t\"url\": null\r\n\t\t},\r\n\t\t\"protected\": false,\r\n\t\t\"followers_count\": 68,\r\n\t\t\"friends_count\": 32,\r\n\t\t\"listed_count\": 0,\r\n\t\t\"created_at\": \"Thu Aug 22 06:52:53 +0000 2013\",\r\n\t\t\"favourites_count\": 5,\r\n\t\t\"utc_offset\": 19800,\r\n\t\t\"time_zone\": \"Chennai\",\r\n\t\t\"geo_enabled\": true,\r\n\t\t\"verified\": false,\r\n\t\t\"statuses_count\": 124,\r\n\t\t\"lang\": \"en\",\r\n\t\t\"contributors_enabled\": false,\r\n\t\t\"is_translator\": false,\r\n\t\t\"is_translation_enabled\": false,\r\n\t\t\"profile_background_color\": \"131516\",\r\n\t\t\"profile_background_image_url\": \"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme14\\/bg.gif\",\r\n\t\t\"profile_background_image_url_https\": \"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme14\\/bg.gif\",\r\n\t\t\"profile_background_tile\": true,\r\n\t\t\"profile_image_url\": \"http:\\/\\/pbs.twimg.com\\/profile_images\\/378800000337984382\\/5eded5a0c6fda4a85511aff15e5befd9_normal.jpeg\",\r\n\t\t\"profile_image_url_https\": \"https:\\/\\/pbs.twimg.com\\/profile_images\\/378800000337984382\\/5eded5a0c6fda4a85511aff15e5befd9_normal.jpeg\",\r\n\t\t\"profile_banner_url\": \"https:\\/\\/pbs.twimg.com\\/profile_banners\\/1690262984\\/1429709252\",\r\n\t\t\"profile_link_color\": \"009999\",\r\n\t\t\"profile_sidebar_border_color\": \"EEEEEE\",\r\n\t\t\"profile_sidebar_fill_color\": \"EFEFEF\",\r\n\t\t\"profile_text_color\": \"333333\",\r\n\t\t\"profile_use_background_image\": true,\r\n\t\t\"has_extended_profile\": false,\r\n\t\t\"default_profile\": false,\r\n\t\t\"default_profile_image\": false,\r\n\t\t\"following\": true,\r\n\t\t\"follow_request_sent\": false,\r\n\t\t\"notifications\": false\r\n\t}]`\r\n\r\n\tkeys := make([]PublicKey,0)\r\n\terr := json.Unmarshal([]byte(s), &amp;keys)\r\n\tif err == nil {\r\n\t\tfmt.Printf(\"%+v\\n\", keys)\r\n\t} else {\r\n\t\tfmt.Println(err)\r\n\t\tfmt.Printf(\"%+v\\n\", keys)\r\n\t}\r\n\tmyId := keys[l].Id\r\n\tfmt.Printf(myId)\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}]