[{"tags": ["algorithm", "go", "artificial-intelligence"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1444259670, "post_id": 33003974, "comment_id": 53832813, "body": "Can you please clarify what you&#39;re trying to do? I don&#39;t personally see how your code emulates a roulette wheel at all... A roulette wheel contains 34 discrete values. For some reason you&#39;re doing a sum and using real numbers, I don&#39;t see how either apply to the game of roulette? As I understand it you should just be doing <code>rand.Int31n(33)</code> to produce a number between 0-33, adding 1 to get the value of the roulette wheel since it&#39;s not zero indexed and reserving indexes 32 and 33 to represent the 0 and 00 values."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 2, "creation_date": 1444260156, "post_id": 33003974, "comment_id": 53832941, "body": "I don&#39;t see how this could compile. <code>rand.sum</code> would be unexported from rand; it may exist, but code in package main couldn&#39;t get at it. Also <code>for i := 0; i &lt; len(fitnessScore); i++</code> seems less idiomatic than <code>for i, _ := range fitnessScore</code> or <code>for _, v := range fitnessScore { sum += v }</code>. I agree with evanmcdonnal; it doesn&#39;t look like a simulation of a roulette wheel. However, if you explain the requirements, it may not matter what you call it."}, {"owner": {"reputation": 21, "user_id": 1409767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da53cd91915c34c8d316a3045daa3c1?s=128&d=identicon&r=PG", "display_name": "zuma89", "link": "https://stackoverflow.com/users/1409767/zuma89"}, "edited": false, "score": 0, "creation_date": 1444260357, "post_id": 33003974, "comment_id": 53833011, "body": "This is not the ordinary roulette wheel method. Its part of the genetic algorithm provided by <a href=\"https://www.youtube.com/watch?v=9JzFcGdpT8E\" rel=\"nofollow noreferrer\">link</a>. The author of the video uses Java and I&#39;m porting it into Golang. And yes I realize rand.sum issue, this is why I&#39;m requesting assistance to fix it. Any idea guys?"}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444260633, "post_id": 33003974, "comment_id": 53833073, "body": "Please explain what your problem is. Please don&#39;t expect us to go and watch that video. If all you want to achieve is setting a random seed for rand, do that once in init(), and it&#39;s done. I would suggest you don&#39;t do that initially, as a repeatable sequence of random numbers may make testing and debugging easier."}, {"owner": {"reputation": 21, "user_id": 1409767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da53cd91915c34c8d316a3045daa3c1?s=128&d=identicon&r=PG", "display_name": "zuma89", "link": "https://stackoverflow.com/users/1409767/zuma89"}, "reply_to_user": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444261374, "post_id": 33003974, "comment_id": 53833259, "body": "@gbulmer If you look at the line before <code>spin_wheel := rand.sum</code> I did add a random seed. The problem is I do not know how to generate a random value from the <code>sum</code> after adding up all the <code>fitnessScore</code>. In Python usually I will just do <code>spin_wheel = random() * sum</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1444261597, "post_id": 33003974, "comment_id": 53833312, "body": "My guess is that your intention is <code>urand(sum)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 1409767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da53cd91915c34c8d316a3045daa3c1?s=128&d=identicon&r=PG", "display_name": "zuma89", "link": "https://stackoverflow.com/users/1409767/zuma89"}, "edited": false, "score": 0, "creation_date": 1444270120, "post_id": 33005357, "comment_id": 53835588, "body": "Current solution return a round number. What if I want to return decimal number?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 21, "user_id": 1409767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da53cd91915c34c8d316a3045daa3c1?s=128&d=identicon&r=PG", "display_name": "zuma89", "link": "https://stackoverflow.com/users/1409767/zuma89"}, "edited": false, "score": 0, "creation_date": 1444270465, "post_id": 33005357, "comment_id": 53835674, "body": "@zuma89: Do you want this revised solution?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1444273852, "last_edit_date": 1444273852, "creation_date": 1444269520, "answer_id": 33005357, "question_id": 33003974, "link": "https://stackoverflow.com/questions/33003974/roulette-wheel-selection-in-genetic-algorithm-using-golang/33005357#33005357", "title": "Roulette Wheel Selection in Genetic Algorithm using Golang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\n// Returns the selected weight based on the weights(probabilities)\n// Fitness proportionate selection:\n// https://en.wikipedia.org/wiki/Fitness_proportionate_selection\nfunc rouletteSelect(weights []float64) float64 {\n    // calculate the total weights\n    sum := 0.0\n    for _, weight := range weights {\n        sum += weight\n    }\n    // get a random value\n    value := rand.Float64() * sum\n    // locate the random value based on the weights\n    for _, weight := range weights {\n        value -= weight\n        if value &lt;= 0 {\n            return weight\n        }\n    }\n    // only when rounding errors occur\n    return weights[len(weights)-1]\n}\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    weights := []float64{0.1, 0.2, 0.3, 0.4}\n    fmt.Println(rouletteSelect(weights))\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 1409767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da53cd91915c34c8d316a3045daa3c1?s=128&d=identicon&r=PG", "display_name": "zuma89", "link": "https://stackoverflow.com/users/1409767/zuma89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 1, "accepted_answer_id": 33005357, "answer_count": 1, "score": 0, "last_activity_date": 1444273852, "creation_date": 1444259518, "last_edit_date": 1444261073, "question_id": 33003974, "link": "https://stackoverflow.com/questions/33003974/roulette-wheel-selection-in-genetic-algorithm-using-golang", "title": "Roulette Wheel Selection in Genetic Algorithm using Golang", "body": "<p>I'm building a mock roulette wheel selection function for genetic algorithm. First of, I would want to add up the <code>sum</code> of the <code>fitnessScore</code> in the main function. After adding up the <code>fitnessScore</code> I wanted to randomize a value out of that <code>sum</code> using the <code>math/rand</code> package in Go. How should I use the rand package in this scenario how do I fix <code>spin_wheel := rand.sum</code> in order to random a value?</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"time\"\n    \"math/rand\"\n)\n\nfunc rouletteWheel(fitnessScore []float64) []float64{\n    sum := 0.0\n    for i := 0; i &lt; len(fitnessScore); i++ {\n        sum += fitnessScore[i]\n    }\n\n    rand.Seed(time.Now().UnixNano())\n    spin_wheel := rand.sum\n    partial_sum := 0.0\n    for i := 0; i &lt; len(fitnessScore); i++{\n        partial_sum += fitnessScore[i]\n        if(partial_sum &gt;= spin_wheel){\n            return fitnessScore\n        }\n    }\n    return fitnessScore\n}\n\nfunc main(){\n    fitnessScore := []float64{0.1, 0.2, 0.3, 0.4}\n    fmt.Println(rouletteWheel(fitnessScore))\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444255023, "post_id": 33002892, "comment_id": 53831159, "body": "@RhytmicFistman Thanks. But I don&#39;t want to redefine the function definition. I just want be able to debug. (I edited my question to clarify)"}, {"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "reply_to_user": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444258005, "post_id": 33002892, "comment_id": 53832241, "body": "Sorry, there&#39;s reflection, but I can only see the types of the arguments, not their values. You also need to specify the function&#39;s name..."}], "tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": false, "score": 0, "last_activity_date": 1444257979, "last_edit_date": 1444257979, "creation_date": 1444254073, "answer_id": 33002892, "question_id": 33002720, "link": "https://stackoverflow.com/questions/33002720/is-there-an-equivalent-of-os-args-for-functions/33002892#33002892", "title": "Is there an equivalent of os.Args() for functions?", "body": "<p>To generically print your functions' arguments, you can do this:</p>\n\n<pre><code>func printInputParameters(input ...interface{}) {\n    fmt.Printf(\"Args: %v\", input)\n}\n</code></pre>\n\n<p><code>printInputParameters</code> is <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow\">a variadic function</a>, and <code>input</code> is of type <code>[]interface{}</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444705966, "post_id": 33006366, "comment_id": 54002834, "body": "Thank you so much. I tried this version and one on the github. It works fine except for the string arguments.   Note:  I had to upgrade my go to 1.5.1 from 1.4.2 because reflect.ArraOf() was not supported in go1.4.2"}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "reply_to_user": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444766510, "post_id": 33006366, "comment_id": 54037354, "body": "@JosephSwaminathan Please post an issue on github or fix it and open a pull request. Thanks."}, {"owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444791716, "post_id": 33006366, "comment_id": 54045840, "body": "Posted an issue. The code seems OK unable to find a fix so far."}, {"owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "edited": false, "score": 0, "creation_date": 1444860132, "post_id": 33006366, "comment_id": 54084283, "body": "@nimo  Opened a pull request"}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 3, "last_activity_date": 1444709059, "last_edit_date": 1495535227, "creation_date": 1444276832, "answer_id": 33006366, "question_id": 33002720, "link": "https://stackoverflow.com/questions/33002720/is-there-an-equivalent-of-os-args-for-functions/33006366#33006366", "title": "Is there an equivalent of os.Args() for functions?", "body": "<p>You cannot do this in Go since there is no way you can get the stack frame of the currently active function in the current goroutine. It is not impossible to do this as I'll show further below but the problem is that there is no public API to get this done reliably. That it can be done can be seen in the stack traces printed when a <code>panic</code> is raised: all values on the stack are dumped in that case.</p>\n\n<p>Should you be interested in how the stack trace is actually generated then have a look at <a href=\"https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/runtime/traceback.go#L120\" rel=\"nofollow noreferrer\"><code>genstacktrace</code></a> in the runtime package.</p>\n\n<p>As for a solution to your problem, you can the source code parsing route as <a href=\"https://stackoverflow.com/a/33003479/1643939\">already suggested</a>. If you feel adventurous, you can parse the stack trace provided by <a href=\"https://golang.org/pkg/runtime/#Stack\" rel=\"nofollow noreferrer\"><code>runtime.Stack</code></a>. But beware, there are so many drawbacks that you will quickly realize that any solution is better than this one.</p>\n\n<p>To parse the stack trace, just get the line of the previously called function (from the viewpoint of <code>printInputParameters</code>), get the name of that function and parse the parameter values according to the parameter types provided by reflection. Some examples of stack trace outputs of various function invocations:</p>\n\n<pre><code>main.Test1(0x2) // Test1(int64(2))\nmain.Test1(0xc820043ed5, 0x3, 0x3) // Test1([]byte{'A','B','C'})\nmain.Test1(0x513350, 0x4) // Test1(\"AAAA\")\n</code></pre>\n\n<p>You can see that complex types (those which do not fit into a register) may use more than one 'parameter'. A string for example is a pointer to the data and the length. So you have to use the <code>unsafe</code> package to access these pointers and reflection to create values from this data.</p>\n\n<p>If you want to try yourself, here's some example code:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"math\"\n    \"reflect\"\n    \"runtime\"\n    \"strconv\"\n    \"strings\"\n    \"unsafe\"\n)\n\n// Parses the second call's parameters in a stack trace of the form:\n//\n// goroutine 1 [running]:\n// main.printInputs(0x4c4c60, 0x539038)\n//  /.../go/src/debug/main.go:16 +0xe0\n// main.Test1(0x2)\n//  /.../go/src/debug/main.go:23\n//\nfunc parseParams(st string) (string, []uintptr) {\n\n    line := 1\n    start, stop := 0, 0\n    for i, c := range st {\n        if c == '\\n' {\n            line++\n        }\n        if line == 4 &amp;&amp; c == '\\n' {\n            start = i + 1\n        }\n        if line == 5 &amp;&amp; c == '\\n' {\n            stop = i\n        }\n    }\n\n    call := st[start:stop]\n    fname := call[0:strings.IndexByte(call, '(')]\n    param := call[strings.IndexByte(call, '(')+1 : strings.IndexByte(call, ')')]\n    params := strings.Split(param, \", \")\n    parsedParams := make([]uintptr, len(params))\n\n    for i := range params {\n        iv, err := strconv.ParseInt(params[i], 0, 64)\n\n        if err != nil {\n            panic(err.Error())\n        }\n\n        parsedParams[i] = uintptr(iv)\n    }\n\n    return fname, parsedParams\n}\n\nfunc fromAddress(t reflect.Type, addr uintptr) reflect.Value {\n    return reflect.NewAt(t, unsafe.Pointer(&amp;addr)).Elem()\n}\n\nfunc printInputs(fn interface{}) {\n    v := reflect.ValueOf(fn)\n    vt := v.Type()\n    b := make([]byte, 500)\n\n    if v.Kind() != reflect.Func {\n        return\n    }\n\n    runtime.Stack(b, false)\n\n    name, params := parseParams(string(b))\n    pidx := 0\n\n    fmt.Print(name + \"(\")\n    for i := 0; i &lt; vt.NumIn(); i++ {\n        t := vt.In(i)\n        switch t.Kind() {\n        case reflect.Int64:\n        case reflect.Int:\n            // Just use the value from the stack\n            fmt.Print(params[pidx], \",\")\n            pidx++\n        case reflect.Float64:\n            fmt.Print(math.Float64frombits(uint64(params[pidx])), \",\")\n            pidx++\n        case reflect.Slice:\n            // create []T pointing to slice content\n            data := reflect.ArrayOf(int(params[pidx+2]), t.Elem())\n            svp := reflect.NewAt(data, unsafe.Pointer(params[pidx]))\n            fmt.Printf(\"%v,\", svp.Elem())\n            pidx += 3\n        case reflect.String:\n            sv := fromAddress(t, params[pidx])\n            fmt.Printf(\"%v,\", sv)\n            pidx += 2\n        case reflect.Map:\n            // points to hmap struct\n            mv := fromAddress(t,params[pidx])\n            fmt.Printf(\"%v,\", mv)\n            pidx++\n        } /* switch */\n    }\n    fmt.Println(\")\")\n}\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>func Test1(in int, b []byte, in2 int, m string) {\n    printInputs(Test1)\n}\n\nfunc main() {\n    b := []byte{'A', 'B', 'C'}\n    s := \"AAAA\"\n    Test1(2, b, 9, s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>main.Test1(2,[65 66 67],9,\"AAAA\",)\n</code></pre>\n\n<p>A slightly advanced version of this can be found <a href=\"https://github.com/githubnemo/pdump\" rel=\"nofollow noreferrer\">on github</a>:</p>\n\n<pre><code>go get github.com/githubnemo/pdump\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4139166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/079a22c9c08d2b54e915c602db8f69d5?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Swaminathan", "link": "https://stackoverflow.com/users/4139166/joseph-swaminathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 33006366, "answer_count": 2, "score": 3, "last_activity_date": 1444709059, "creation_date": 1444253311, "last_edit_date": 1444316577, "question_id": 33002720, "link": "https://stackoverflow.com/questions/33002720/is-there-an-equivalent-of-os-args-for-functions", "title": "Is there an equivalent of os.Args() for functions?", "body": "<p>To help debug GO programs, I want to write two generic functions that will be called on entry and exit, which will print the values of input and output parameters respectively:</p>\n\n<pre><code>printInputParameters(input ...interface{})\nprintOutputParameters(output ...interface{})\n</code></pre>\n\n<p>Is there an equivalent of <code>os.Args()</code> for functions? I looked at runtime package and didn't find such functions.</p>\n\n<p>For example lets say I have two functions with different input parameters and output parameters</p>\n\n<pre><code>func f1(int i, float f) (e error) {\n    ... some code here\n}\n\nfunc f2(s string, b []byte) (u uint64, e error) {\n     .. some code here\n}\n</code></pre>\n\n<p>I want to be able to do the following </p>\n\n<pre><code>func f1(int i, float f) (e error) {\n     printInputparameters( ? )\n     defer func() {\n          printOutputParameters( ? )\n     }()\n\n     ... some code here\n}\n\nfunc f2(s string, b []byte) (u uint64, e error) {\n     printInputparameters( ? )\n     defer func() {\n          printOutputParameters( ? )\n     }()\n\n     ... some code here\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1444248148, "post_id": 33001411, "comment_id": 53827711, "body": "The working directory is a property of the process. There&#39;s no way for a goroutine to change directories."}, {"owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "edited": false, "score": 3, "creation_date": 1444248458, "post_id": 33001411, "comment_id": 53827902, "body": "It&#39;s even slightly worse than that: it&#39;s a property of the <i>thread</i> on unix systems, and since goroutines can be run on multiple different threads you can find the CWD changed out from under you if your goroutine gets moved."}, {"owner": {"reputation": 61, "user_id": 2102024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8ef29d92aa4c04d546dae0fbea8cac?s=128&d=identicon&r=PG", "display_name": "Rohan Nahata", "link": "https://stackoverflow.com/users/2102024/rohan-nahata"}, "edited": false, "score": 0, "creation_date": 1444249507, "post_id": 33001411, "comment_id": 53828458, "body": "That&#39;s what I thought, so the only option then, would be to fork, I presume?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444250430, "post_id": 33001411, "comment_id": 53828941, "body": "You can&#39;t fork a Go process. The only way to sanely manage this is to use absolute paths, or possibly chdir one at a time."}], "answers": [{"comments": [{"owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "edited": false, "score": 0, "creation_date": 1444251185, "post_id": 33001924, "comment_id": 53829332, "body": "As per my comment, you can&#39;t depend on the CWD staying the same between one line and the next, because your goroutine could be rescheduled at any time on a different thread with a different working directory. So there is no way I know of in Go to do anything reliable with the CWD at all."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "edited": false, "score": 0, "creation_date": 1444253069, "post_id": 33001924, "comment_id": 53830254, "body": "@Evan: That&#39;s not correct. Go provides <code>os.Chdir</code> which is implemented if the OS supports it (and I believe all supported OSs do). You can use it if it&#39;s there."}], "tags": [], "owner": {"reputation": 4011, "user_id": 29703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/32e50f8f8e17d63c49bf03d54a48282a?s=128&d=identicon&r=PG", "display_name": "Jeffrey Martinez", "link": "https://stackoverflow.com/users/29703/jeffrey-martinez"}, "is_accepted": true, "score": 3, "last_activity_date": 1444251584, "last_edit_date": 1444251584, "creation_date": 1444249888, "answer_id": 33001924, "question_id": 33001411, "link": "https://stackoverflow.com/questions/33001411/changing-directories-in-go-routines/33001924#33001924", "title": "Changing directories in go routines", "body": "<p>Like mentioned in the comments, keeping track of the current working directory in each goroutine will cause problems.</p>\n\n<p>Try using <a href=\"https://golang.org/pkg/path/filepath/#Abs\" rel=\"nofollow\">filepath.Abs</a> to capture the absolute directory and store that instead. Then each goroutine can operate on it's own directory without worrying about it being \"switched\" under the hood. Just be sure you're not modifying the same file accidentally by multiple goroutines.</p>\n\n<p>Edit: Removing a chunk of text per @Evan's comment. Use absolute paths :p</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444252081, "post_id": 33002267, "comment_id": 53829763, "body": "FYI, Go provides <code>os.Chdir</code>, which is implemented for any platforms which can supported changing the process working directory. If it&#39;s there, using it is not problem."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444253227, "post_id": 33002267, "comment_id": 53830326, "body": "@JimB - I&#39;ve had a look at the documentation, and their appears to be no guarantee about how Chdir() will be implemented. I can strongly agree that changing only the processes current working directory, and not the threads current working directory is a good/sane choice. However that choice is not made explicit, which would make me nervous about using it, especially if one wanted to rely on it across releases and platforms."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444253646, "post_id": 33002267, "comment_id": 53830516, "body": "I think my concern is valid, and <i>not</i> addressed by Go&#39;s os package documentation. That may be simply an oversight by the package documenters. However it is <i>not defined</i>, could be implemented in several ways, and without explicit documentation could change across platforms and releases. So a downvote seems unhelpful to me. Sorry to whine, but without evidence that it is incorrect, in which case I would delete the answer as unhelpful, I think it is a valid concern."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444253784, "post_id": 33002267, "comment_id": 53830563, "body": "There is no guarantee about <i>how</i> most things are implemented, and the documentation doesn&#39;t have to say when things <i>aren&#39;t</i> broken. If os.Chdir doesn&#39;t work in some case, then it needs to be documented as such. If you have a test case that demonstrates the problem, feel free to file an issue."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444254189, "post_id": 33002267, "comment_id": 53830783, "body": "BTW, posix threads guarantee that all threads share the same current directory, and the directory is a process attribute in the kernel. If and when this isn&#39;t the case in some new environment, os.Chdir and syscall.Chdir won&#39;t be there."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444254285, "post_id": 33002267, "comment_id": 53830813, "body": "@JimB - AFAICT, the specific behaviour of Chdir() is undefined. I am willing to raise an issue about the lack of specificity in the documentation, and get this flushed out, as it seems to me unhelpful to be that vague. Further, it would seem on the face of it difficult to create a test case if my platform only implements change-processes-working-directory. Its implementing Chdir() that way doesn&#39;t provide any proof for other OS&#39;s or future releases. If you have some deeper insight than the documentation, please share."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444254633, "post_id": 33002267, "comment_id": 53830984, "body": "os.Chdir <i>is</i> well defined, and it&#39;s implemented in a way that&#39;s compatible with supporting multiple OS&#39;s and architectures. If an OS doesn&#39;t support it, just like the many other system specific syscalls, it simply won&#39;t be implemented (or it will return an error)."}], "tags": [], "owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1444254614, "last_edit_date": 1444254614, "creation_date": 1444251375, "answer_id": 33002267, "question_id": 33001411, "link": "https://stackoverflow.com/questions/33001411/changing-directories-in-go-routines/33002267#33002267", "title": "Changing directories in go routines", "body": "<p>@Evan has identified a fundamental flaw in attempting to use the 'change working directory' (CWD) system call.</p>\n\n<p>I believe that @Evan is correct, and that the CWD is a <em>thread</em> property on some OS's.</p>\n\n<p>As @Evan pointed out, a goroutine could be resheduled (for example at a function call, channel access, or system call) onto a different thread. </p>\n\n<p>The implications are, it may be <strong>impossible</strong> to change the CWD (if Chdir() could change the threads CWD) because Go's runtime chooses to reschedule the goroutine on a different thread; its CWD could change invisibly and unpredictably.</p>\n\n<p>Edit: I would <em>not</em> expect Chdir() to do anything other than change the CWD for the process. However, the documentation for the package has no mention of 'process'.</p>\n\n<p>Worse, the runtime may change how things work with releases.</p>\n\n<p>Even worse, it would be very hard to debug. It may be a 'Heisenberg problem', where any attempt to debug it (for example by calling a function, which the runtime may use as a reschedule point) may actually changes the behaviour in an unpredictable way.</p>\n\n<p>Keep track of absolute path names. This is explicit, clear, and would even work across goroutines without any need for synchronisation. Hence it is simpler, and easier to test and debug.</p>\n"}], "owner": {"reputation": 61, "user_id": 2102024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8ef29d92aa4c04d546dae0fbea8cac?s=128&d=identicon&r=PG", "display_name": "Rohan Nahata", "link": "https://stackoverflow.com/users/2102024/rohan-nahata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 0, "accepted_answer_id": 33001924, "answer_count": 2, "score": 2, "last_activity_date": 1444254614, "creation_date": 1444248043, "question_id": 33001411, "link": "https://stackoverflow.com/questions/33001411/changing-directories-in-go-routines", "title": "Changing directories in go routines", "body": "<p>I am trying to change directories in a go routine to directory x. I now want to use a different go routine that changes the directory to directory y. Will the execution of my first go routine be affected by this change to the current working directory in the second go routine? The purpose of wanting to do this is to introduce parallelism while doing similar tasks. If it does end up changing the CWD, what should be an alternative approach (forking...)?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1444254595, "post_id": 33000904, "comment_id": 53830967, "body": "Can you post your code that shows your ancestor query?  My hunch is that you probably don&#39;t want to use ancestors in this way as they will affect your write rate for all Musical Instruments. Do you need strong consistency for your entire group of Musical Instrument entities?"}, {"owner": {"reputation": 873, "user_id": 307862, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/722274c13fd9a66e3d1fc70dca23c0a7?s=128&d=identicon&r=PG", "display_name": "anthony", "link": "https://stackoverflow.com/users/307862/anthony"}, "reply_to_user": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1444265979, "post_id": 33000904, "comment_id": 53834513, "body": "Added the method for getting categories. I do not need strong consistency for this particular part of the application."}], "answers": [{"comments": [{"owner": {"reputation": 873, "user_id": 307862, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/722274c13fd9a66e3d1fc70dca23c0a7?s=128&d=identicon&r=PG", "display_name": "anthony", "link": "https://stackoverflow.com/users/307862/anthony"}, "edited": false, "score": 0, "creation_date": 1444315357, "post_id": 33010769, "comment_id": 53861019, "body": "Ok, this makes sense now. The docs don&#39;t really advise against using it this way, but it&#39;s apparent that it&#39;s not designed for product categories. +1 for Minimoog."}], "tags": [], "owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "is_accepted": true, "score": 0, "last_activity_date": 1444293732, "creation_date": 1444293732, "answer_id": 33010769, "question_id": 33000904, "link": "https://stackoverflow.com/questions/33000904/ancestor-query-direct-descendants-google-datastore/33010769#33010769", "title": "Ancestor Query Direct Descendants - Google Datastore", "body": "<p>You will need to think about any parts of your application that do need strong consistency and then consider what entities &amp; entity groups will need to participate in the corresponding queries and transactions (you can now have up to 25 in a cross-group transaction), but your use of ancestors in this way rings alarm bells for me.</p>\n\n<p>It's easy to get caught out (I have!) with entity groups by thinking of them as a way to logically structure your data model, but this can cause problems down the line where you end up with write contention on an unnecessarily large entity group.  </p>\n\n<p>Instead, it's best to think about the points in your application where you need strong consistency and design your entity groups around that.</p>\n\n<p>In this scenario I would probably just have a <code>parentCategory</code> property (of type <code>datastore.Key</code>).  You can then query for subcategories of <em>Musical Instruments</em> like this:</p>\n\n<pre><code>k := datastore.NewKey(c, \"Category\", \"Musical Instruments\", 0, nil)\nq := datastore.NewQuery(\"Category\").Filter(\"parentCategory =\", k)\n</code></pre>\n\n<p><em>(I'm quite new to Go so the above might be an approximation)</em></p>\n\n<p>Assuming within each category you have some kind of <code>Product</code> and you want to query for all <code>Product</code>s within a given <code>Category</code> at any level in the tree (e.g., <em>Telecaster</em> in <em>Guitars</em>, or <em>Minimoog</em> in <em>Musical Instruments</em> then you will probably need a multi-value property (in Go I guess this would probably be a <code>[]datastore.Key</code> slice) representing the branch of the Category tree.</p>\n"}], "owner": {"reputation": 873, "user_id": 307862, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/722274c13fd9a66e3d1fc70dca23c0a7?s=128&d=identicon&r=PG", "display_name": "anthony", "link": "https://stackoverflow.com/users/307862/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 33010769, "answer_count": 1, "score": 0, "last_activity_date": 1471627938, "creation_date": 1444246394, "last_edit_date": 1495535319, "question_id": 33000904, "link": "https://stackoverflow.com/questions/33000904/ancestor-query-direct-descendants-google-datastore", "title": "Ancestor Query Direct Descendants - Google Datastore", "body": "<p>I'm building a catalog application in Google App Engine, using Go, and Google Datastore. I'm using the <code>Ancestor</code> features of the datatore to manage different product categories. Here's an example of some data:</p>\n\n<p><code>Musical Instruments -&gt; Guitars -&gt; Gibson -&gt; Les Paul</code></p>\n\n<p><code>Musical Instruments -&gt; Guitars -&gt; Fender -&gt; Stratocaster</code></p>\n\n<p><code>Musical Instruments -&gt; Bass Guitars -&gt; Music Man -&gt; Stingray</code></p>\n\n<p>Musical Instruments is the root entity. When I click it, I expect to see <code>Guitars</code> and <code>Bass Guitars</code>, but instead I see everything that is a descendant of <code>Musical Instruments</code> all the way to the last entity. Which is not what I'm looking for. I'm only interested in the direct descendants of Musical instruments at this point.</p>\n\n<p>Some posts, <a href=\"https://stackoverflow.com/questions/10219137/how-can-i-query-for-direct-descendants-only\">like this one</a>, suggest creating a field in the datastore to track direct parents. But, if I'm going to track parent entities manually, why use the <code>Ancestor</code> features at all? Would it be faster than filtering queries who match a direct parent field?</p>\n\n<p>Here's the method for getting categories:</p>\n\n<pre><code>func (cat *Category) GetCategories(r *http.Request, pk string) ([]CategoryReturn, error) {\n//get context\nc := appengine.NewContext(r)\n\nvar q *datastore.Query\nvar err error\n\n//get parent key\nk, err := datastore.DecodeKey(pk)\n\nif err != nil {\n    //handle error\n    return []CategoryReturn{}, err\n}\n\nq = datastore.NewQuery(\"Category\").Ancestor(k)\n\n//populate category slices\nvar categories []CategoryReturn\nkeys, err := q.GetAll(c, &amp;categories)\n\nif err != nil {\n    //handle error\n    return []CategoryReturn{}, err\n}\n\n//create return object\nresults := make([]CategoryReturn, 0, 20)\n\nfor i, r := range categories {\n    k := keys[i]\n    y := CategoryReturn {\n        Name: r.Name,\n        Id: k.IntID(),\n        Key: k.Encode(),\n    }\n\n    results = append(results, y)\n}\n\nreturn results, nil\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444243098, "post_id": 32999850, "comment_id": 53824514, "body": "Do you specifically need to read and entry in <code>&#47;etc&#47;hosts</code>, or just resolve an address that might be in <code>&#47;etc&#47;hosts</code>? Does <code>net.LookupIP</code> not do what you want?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444243278, "post_id": 32999850, "comment_id": 53824617, "body": "net.LookupIP(&quot;AAA&quot;) gives me: no such host. I can see the entry if I call &quot;getent hosts&quot; from the terminal."}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444243901, "post_id": 32999850, "comment_id": 53825010, "body": "Sorry, yes I just need to read the ip address?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444244296, "post_id": 32999850, "comment_id": 53825253, "body": "What version of Go are you using? Are the values actually in the /etc/hosts file, or are they being pulled from somewhere else via nsswitch?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444244506, "post_id": 32999850, "comment_id": 53825396, "body": "go version go1.5.1 linux/amd64. Hmm, good question I am running within a docker container."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444244596, "post_id": 32999850, "comment_id": 53825448, "body": "Look at the <code>&#47;etc&#47;hosts</code> in your docker container, not the system <code>&#47;etc&#47;hosts</code>. If this didn&#39;t work, you wouldn&#39;t ever be able to use <code>localhost</code> as a hostname."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444244676, "post_id": 32999850, "comment_id": 53825509, "body": "BTW, you should read the relevant docs: <a href=\"https://docs.docker.com/reference/run/#managing-etc-hosts\" rel=\"nofollow noreferrer\">docs.docker.com/reference/run/#managing-etc-hosts</a>"}, {"owner": {"reputation": 159, "user_id": 3165492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c8fc2de8372c43759a4bc2acf0fc8e4?s=128&d=identicon&r=PG&f=1", "display_name": "MaineCoder", "link": "https://stackoverflow.com/users/3165492/mainecoder"}, "edited": false, "score": 0, "creation_date": 1444244718, "post_id": 32999850, "comment_id": 53825529, "body": "Try using --net=host when running your docker container - might resolve the issue by allowing access to the host network"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 0, "creation_date": 1444244994, "post_id": 32999850, "comment_id": 53825715, "body": "I can read it from a shell script but not from go?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 0, "creation_date": 1444245680, "post_id": 32999850, "comment_id": 53826163, "body": "<code>LookupHost</code> does indeed work. Thanks and sorry for using your time. I will close this."}], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 4673137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-twZ90CQFg6I/AAAAAAAAAAI/AAAAAAAATsg/8ZYakDCzVv8/photo.jpg?sz=128", "display_name": "Sebas", "link": "https://stackoverflow.com/users/4673137/sebas"}, "is_accepted": false, "score": 0, "last_activity_date": 1444305690, "creation_date": 1444305690, "answer_id": 33015217, "question_id": 32999850, "link": "https://stackoverflow.com/questions/32999850/golang-read-hosts-entry-or-just-read-it-in-as-a-file/33015217#33015217", "title": "golang read hosts entry or just read it in as a file", "body": "<p>If you want to just read the file...</p>\n\n<p>import (\n    \"fmt\"\n    \"io/ioutil\"\n)</p>\n\n<p>and then</p>\n\n<pre><code>dat, err := ioutil.ReadFile(\"/windows/system32/drivers/etc/hosts\")\nfmt.Print(string(dat))\n</code></pre>\n\n<p>you can parse the result of course</p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 981, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1444305690, "creation_date": 1444242648, "last_edit_date": 1444245325, "question_id": 32999850, "link": "https://stackoverflow.com/questions/32999850/golang-read-hosts-entry-or-just-read-it-in-as-a-file", "title": "golang read hosts entry or just read it in as a file", "body": "<p>I need to read an entry from the host file on Linux.</p>\n\n<p>I have looked at <code>\"net\"</code></p>\n\n<pre><code>fmt.Println(\"net host file entry:\")\nfmt.Println(net.LookupIP(\"AAA\"))\nfmt.Println(net.LookupAddr(\"BBB\"))\nfmt.Println(net.LookupHost(\"CCC\"))\n</code></pre>\n\n<p>net.LookupIP(\"AAA\") gives me: <code>no such host</code>. \n<br>\n<br>\nThough I can see the entry if I do <code>getent hosts</code> from the terminal.</p>\n\n<p>I just need to read the ip address?</p>\n\n<p>Note: I am running this within a docker container and the etc/hosts file do contain the entry - I can read it from a shell script but not from go.\nIn docker you can link containers and this will give you an entry in the hosts file.</p>\n\n<p>Or should I just read it in as a file?</p>\n"}, {"tags": ["mongodb", "go", "bson", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "is_accepted": false, "score": 3, "last_activity_date": 1444260449, "creation_date": 1444260449, "answer_id": 33004109, "question_id": 32998684, "link": "https://stackoverflow.com/questions/32998684/forming-structure-to-read-bson-object-with-composite-key/33004109#33004109", "title": "forming structure to read bson object with composite key", "body": "<p>Figured it out, answering to help if someone runs into the same. </p>\n\n<p>You can created another struct for composite key. </p>\n\n<pre><code>type key struct {\n    a string \n    b string \n    c int \n}\n\ntype test struct {\nId key `bson:\"_id\"` &lt;---- how to define composite key that I want to use as key in new collection\nX string `bson:x`\nY string `bson:y`\n}\n</code></pre>\n"}], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1617020533, "creation_date": 1444238776, "last_edit_date": 1617020533, "question_id": 32998684, "link": "https://stackoverflow.com/questions/32998684/forming-structure-to-read-bson-object-with-composite-key", "title": "forming structure to read bson object with composite key", "body": "<p>I have an aggregation query (MongoDB, using mgo library), which groups the documents by a composite key. I want to add the result of this aggregation to another collection (I have use out stage of aggregation The result of this aggregation, which shows correct results but I cannot use out since it overwrites records every time the query is run).</p>\n<p>snippet of group stage: basically I am grouping by a key which is composite, of a,b and c.</p>\n<pre><code>    &quot;$group&quot;: bson.M{\n        &quot;_id&quot;: bson.M{\n            &quot;a&quot;: &quot;$a&quot;,\n            &quot;b&quot;: &quot;$b&quot;,\n            &quot;c&quot;: &quot;$c&quot;,\n        },\n     x: &quot;x&quot;,\n     y: &quot;y&quot; ..etc\n</code></pre>\n<p>I have tested the aggregation / grouping etc with out stage and it gives expected result.</p>\n<p>To add to another collection, I want to read each bson object as a struct and then insert into another collection. The problem is  how to define the object for the composite key.</p>\n<p>For example:</p>\n<pre><code>type test struct {\nId string `bson:&quot;_id&quot;` &lt;---- how to define composite key that I want to use as key in new collection\nX string `bson:x`\nY string `bson:y`\n}\n</code></pre>\n<p>I hope my question is clear, I can add more information if required to answer this.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user849425"}, "edited": false, "score": 2, "creation_date": 1444237528, "post_id": 32998231, "comment_id": 53821297, "body": "Time.Add does not operate in-place."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 1, "creation_date": 1444237567, "post_id": 32998231, "comment_id": 53821314, "body": "Well it&#39;s true, and I have fixed the example, but that&#39;s besides the point here."}, {"owner": {"reputation": 1700, "user_id": 1098668, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/tgKKf.jpg?s=128&g=1", "display_name": "Ben Walker", "link": "https://stackoverflow.com/users/1098668/ben-walker"}, "edited": false, "score": 0, "creation_date": 1444238159, "post_id": 32998231, "comment_id": 53821646, "body": "thanks for the edit to explain why I can use 24 and 7. That was about to be my follow-up question."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 5, "creation_date": 1444272811, "post_id": 32998231, "comment_id": 53836209, "body": "You should use <code>AddDate</code> as suggested by @kostix. Using <code>Add</code> for days or weeks will not work correctly with DST and leap seconds. This is the reason why there are no <code>time.Duration</code> defined for a day or a week."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1444294489, "post_id": 32998231, "comment_id": 53845691, "body": "@kostya Good point. I did not really pay attention to this problem since I focused on the type conversion issue, but it&#39;s worth mentioning."}, {"owner": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "edited": false, "score": 0, "creation_date": 1525366927, "post_id": 32998231, "comment_id": 87338520, "body": "how subtract the date?"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "edited": false, "score": 1, "creation_date": 1525390314, "post_id": 32998231, "comment_id": 87348135, "body": "@DarlanDieterich use Time.Sub, it&#39;s right there in the doc."}, {"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "reply_to_user": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "edited": false, "score": 1, "creation_date": 1526924962, "post_id": 32998231, "comment_id": 87921506, "body": "@DarlanDieterich you could write <code>myDate.Add(-time.Hour * 24)</code>"}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": false, "score": 25, "last_activity_date": 1444295021, "last_edit_date": 1444295021, "creation_date": 1444237240, "answer_id": 32998231, "question_id": 32998110, "link": "https://stackoverflow.com/questions/32998110/add-days-to-date-in-go/32998231#32998231", "title": "Add days to date in Go", "body": "<p>You need to convert <code>weeksToAdd</code> into a <code>time.Duration</code>:</p>\n\n<pre><code>myDate.Add(time.Hour * 24 * 7 * time.Duration(weeksToAdd))\n</code></pre>\n\n<p>In Go, type aliases cannot be used interchangeably even though <code>time.Duration</code> is technically an <code>int64</code>.</p>\n\n<p>Also, here, even though the numeric constants 24 and 7 are not explicitly typed, they can still be used as-is, see <a href=\"https://blog.golang.org/constants\" rel=\"noreferrer\">https://blog.golang.org/constants</a> for an in-depth explanation.</p>\n\n<p>See <a href=\"http://play.golang.org/p/86TFFlixWj\" rel=\"noreferrer\">http://play.golang.org/p/86TFFlixWj</a> for a running example.</p>\n\n<p>As mentioned in comments and another answer, the use of <code>time.AddDate()</code> is preferable to <code>time.Add()</code> when working on duration superior to 24 hours, since <code>time.Duration</code> basically represents nanoseconds. When working with days, weeks, months and years, a lot of care has to be taken because of things such as daylight saving times, leap years, and maybe potentially leap seconds.</p>\n\n<p>The documentation for <code>time.Duration</code> type and the associated constants representing units emphasize this issue (<a href=\"https://golang.org/pkg/time/#Duration\" rel=\"noreferrer\">https://golang.org/pkg/time/#Duration</a>):</p>\n\n<blockquote>\n  <p>There is no definition for units of Day or larger to avoid confusion across daylight savings time zone transitions. </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 74, "last_activity_date": 1444239674, "creation_date": 1444239674, "answer_id": 32998966, "question_id": 32998110, "link": "https://stackoverflow.com/questions/32998110/add-days-to-date-in-go/32998966#32998966", "title": "Add days to date in Go", "body": "<p>Use <a href=\"https://golang.org/pkg/time/#Time.AddDate\"><code>Time.AddDate()</code></a>:</p>\n\n<pre><code>myDate.AddDate(0, 0, 7 * weeksToAdd)\n</code></pre>\n"}], "owner": {"reputation": 1700, "user_id": 1098668, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/tgKKf.jpg?s=128&g=1", "display_name": "Ben Walker", "link": "https://stackoverflow.com/users/1098668/ben-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40858, "favorite_count": 7, "accepted_answer_id": 32998966, "answer_count": 2, "score": 39, "last_activity_date": 1537328932, "creation_date": 1444236877, "question_id": 32998110, "link": "https://stackoverflow.com/questions/32998110/add-days-to-date-in-go", "title": "Add days to date in Go", "body": "<p>I'm trying to add a number of days (actually a number of weeks) to an existing date in Go. I have tried \n<code>myDate.Add(time.Hour * 24 * 7 * weeksToAdd)</code></p>\n\n<p>But I get an error when I try to build: <code>invalid operation: time.Hour * startAdd (mismatched types time.Duration and float64)</code></p>\n\n<p>So <code>weeksToAdd</code> is currently a <code>float64</code>, but I can change it to an int or whatever. Changing it to an int only changed my error to say that <code>int</code> and <code>Duration</code> can't be multiplied.</p>\n\n<p>How do I add days to a date?</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1444231233, "post_id": 32995623, "comment_id": 53817000, "body": "It can&#39;t be a bug since no where in the spec or documentation does it make any mention whatsoever what the new capacity will be. Any specific Go implementation/runtime is free to allocate as small or as large of a new underlying array as it wants to."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 2, "creation_date": 1444231840, "post_id": 32995623, "comment_id": 53817544, "body": "Exactly, <a href=\"https://github.com/golang/go/blob/32fddadd98f938018485fba6253d30273db4e5e9/src/runtime/slice.go#L51\" rel=\"nofollow noreferrer\"><code>runtime.growslice</code></a> grows the slice&#39;s underlying array to be <i>at least</i> as big as the capacity parameter. Still, the question is interesting."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1444231995, "post_id": 32995623, "comment_id": 53817653, "body": "There is no proof it&#39;s always like this. Did you check for 29?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1444232961, "post_id": 32995623, "comment_id": 53818372, "body": "This &quot;double-ing&quot; theory doesn&#39;t stand if capacity is &quot;big&quot;. Try with initial <code>2800</code> instead of <code>28</code>, new capacity will be <code>3520</code> instead of <code>5600</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 18, "last_activity_date": 1444235485, "last_edit_date": 1444235485, "creation_date": 1444232316, "answer_id": 32996582, "question_id": 32995623, "link": "https://stackoverflow.com/questions/32995623/why-does-slice-capacity-with-odd-numbers-differ-from-behavior-with-even-numbers/32996582#32996582", "title": "Why does slice capacity with odd numbers differ from behavior with even numbers", "body": "<h2>Short answer</h2>\n\n<p>It is rounding up the slice capacity to fill the allocated memory blocks.</p>\n\n<h2>Long answer</h2>\n\n<p>Let's have a look into the Go1.5.1 source code  :</p>\n\n<p><a href=\"https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/cmd/compile/internal/gc/walk.go#L2895\">https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/cmd/compile/internal/gc/walk.go#L2895</a> tells us that <code>append(l1, l2...)</code> is expanded to </p>\n\n<pre><code>s := l1\nif n := len(l1) + len(l2) - cap(s); n &gt; 0 {\n    s = growslice_n(s, n)\n}\ns = s[:len(l1)+len(l2)]\nmemmove(&amp;s[len(l1)], &amp;l2[0], len(l2)*sizeof(T))\n</code></pre>\n\n<p>The part we are interested in, <code>growslice_n</code>, is defined there : <a href=\"https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/runtime/slice.go#L36\">https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/runtime/slice.go#L36</a></p>\n\n<p>Going a bit deeper, we find this :</p>\n\n<pre><code>newcap := old.cap\nif newcap+newcap &lt; cap {\n    newcap = cap\n} else {\n    for {\n        if old.len &lt; 1024 {\n            newcap += newcap\n        } else {\n            newcap += newcap / 4\n        }\n        if newcap &gt;= cap {\n            break\n        }\n    }\n}\n\n/* [...] */\n\ncapmem := roundupsize(uintptr(newcap) * uintptr(et.size))\nnewcap = int(capmem / uintptr(et.size))\n</code></pre>\n\n<p><code>roundupsize</code> is defined there : <a href=\"https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/runtime/msize.go#L178\">https://github.com/golang/go/blob/f2e4c8b5fb3660d793b2c545ef207153db0a34b1/src/runtime/msize.go#L178</a></p>\n\n<pre><code>// Returns size of the memory block that mallocgc will allocate if you ask for the size.\nfunc roundupsize(size uintptr) uintptr {\n    if size &lt; _MaxSmallSize {\n        if size &lt;= 1024-8 {\n            return uintptr(class_to_size[size_to_class8[(size+7)&gt;&gt;3]])\n        } else {\n            return uintptr(class_to_size[size_to_class128[(size-1024+127)&gt;&gt;7]])\n        }\n    }\n    if size+_PageSize &lt; size {\n        return size\n    }\n    return round(size, _PageSize)\n}\n</code></pre>\n\n<p>And it was introduced there : <a href=\"https://groups.google.com/forum/#!topic/golang-codereviews/bFGtI4Cpb_M\">https://groups.google.com/forum/#!topic/golang-codereviews/bFGtI4Cpb_M</a></p>\n\n<blockquote>\n  <p>When growing slice take into account size of the allocated memory block.</p>\n</blockquote>\n"}], "owner": {"reputation": 1509, "user_id": 457044, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8144bacbb3bdd352b16f5c6f7d3ac0a5?s=128&d=identicon&r=PG", "display_name": "Jan Wy", "link": "https://stackoverflow.com/users/457044/jan-wy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 4, "accepted_answer_id": 32996582, "answer_count": 1, "score": 7, "last_activity_date": 1444235485, "creation_date": 1444229785, "last_edit_date": 1444231067, "question_id": 32995623, "link": "https://stackoverflow.com/questions/32995623/why-does-slice-capacity-with-odd-numbers-differ-from-behavior-with-even-numbers", "title": "Why does slice capacity with odd numbers differ from behavior with even numbers", "body": "<p>I noticed that the capacity of slices behaves in a different way, when the capacity is an odd number. More specifically: When an element is added to a slice, the capacity of the slice is <em>doubled</em> when the original capacity was an even number. But when the original capacity was an odd number, the capacity is <em>incremented by one and then doubled</em>. Example:</p>\n\n<pre><code>s := make([]int, 28, 28)\ns = append(s, 1) \nfmt.Println(\"len=\", len(s), \" cap=\", cap(s)) // len = len + 1, cap = 2 * cap\n\n\npri := make([]int, 27, 27)\npri = append(pri, 1)\nfmt.Println(\"len=\", len(pri), \" cap=\", cap(pri)) // len = len + 1, cap = 2 * (cap + 1)  \n</code></pre>\n\n<p>Assuming this is not a bug, what's the reason for this behavior?</p>\n\n<p>Link to playground: <a href=\"http://play.golang.org/p/wfmdobgCUF\" rel=\"noreferrer\">http://play.golang.org/p/wfmdobgCUF</a></p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 5492, "user_id": 1720344, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TYlxm.png?s=128&g=1", "display_name": "damoiser", "link": "https://stackoverflow.com/users/1720344/damoiser"}, "edited": false, "score": 0, "creation_date": 1475823512, "post_id": 32992661, "comment_id": 67106979, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/39783780/how-to-find-the-rows-count-returned-from-db-query-postgres\">How to find the rows count returned from db.Query postgres</a>"}], "answers": [{"comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1444226369, "post_id": 32993052, "comment_id": 53813155, "body": "Please only post answers in English"}, {"owner": {"reputation": 394, "user_id": 3129584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5be1b6e8c405c795c6a0fecb08563e?s=128&d=identicon&r=PG&f=1", "display_name": "Kulix", "link": "https://stackoverflow.com/users/3129584/kulix"}, "edited": false, "score": 0, "creation_date": 1559753256, "post_id": 32993052, "comment_id": 99521187, "body": "You should NOT be constructing SQL queries like this. This is prone to SQL injection, you should use prepared statements."}, {"owner": {"reputation": 286, "user_id": 5417974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRpLF.jpg?s=128&g=1", "display_name": "Luis Carlos", "link": "https://stackoverflow.com/users/5417974/luis-carlos"}, "edited": false, "score": 0, "creation_date": 1561414264, "post_id": 32993052, "comment_id": 100047868, "body": "Kulix, I&#39;m not totally agree with you in this case. Certainly this type of query is prone to SQL injection, but if you validate that the email var is a valid email you avoid that problem. There&#39;s different ways to solve problems, as a commentary is good your point but I don&#39;t think this is a wrong answer at all."}, {"owner": {"reputation": 394, "user_id": 3129584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5be1b6e8c405c795c6a0fecb08563e?s=128&d=identicon&r=PG&f=1", "display_name": "Kulix", "link": "https://stackoverflow.com/users/3129584/kulix"}, "edited": false, "score": 0, "creation_date": 1561657524, "post_id": 32993052, "comment_id": 100147034, "body": "What happens when your validation is bugged? SQL injection. This is absolutely the wrong way to construct a SQL query in all cases."}], "tags": [], "owner": {"reputation": 286, "user_id": 5417974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRpLF.jpg?s=128&g=1", "display_name": "Luis Carlos", "link": "https://stackoverflow.com/users/5417974/luis-carlos"}, "is_accepted": false, "score": 0, "last_activity_date": 1444315945, "last_edit_date": 1444315945, "creation_date": 1444223236, "answer_id": 32993052, "question_id": 32992661, "link": "https://stackoverflow.com/questions/32992661/go-postgresql-how-to-obtain-number-of-rows-from-a-db-query/32993052#32993052", "title": "Go PostgreSQL: How to obtain number of rows from a db.Query?", "body": "<p>Use the <a href=\"http://www.postgresql.org/docs/9.4/static/functions-aggregate.html\" rel=\"nofollow\"><code>COUNT</code></a> function:</p>\n\n<pre><code>\"SELECT count(*) FROM applications WHERE email='\" + email + \"'\"\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5409985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7811f1bd27f365080b38e16612b0cda?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid Coder", "link": "https://stackoverflow.com/users/5409985/stupid-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1515, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1459829214, "creation_date": 1444222156, "last_edit_date": 1459829214, "question_id": 32992661, "link": "https://stackoverflow.com/questions/32992661/go-postgresql-how-to-obtain-number-of-rows-from-a-db-query", "title": "Go PostgreSQL: How to obtain number of rows from a db.Query?", "body": "<p>As PostgreSQL connector I import following package: </p>\n\n<pre><code>_ \"github.com/lib/pq\"\n</code></pre>\n\n<p>The query I run is:</p>\n\n<pre><code>res, err := db.Query(\"SELECT id FROM applications WHERE email='\" + email + \"'\")\n</code></pre>\n\n<p>where email is naturally a string. One way to count the number of rows in res is by following snippet</p>\n\n<pre><code>count:=0\nfor res.Next() {\n  count++\n  //some other code\n}\n</code></pre>\n\n<p>but there should be some simpler (and quicker) way. It seems RowsAffected() is not the way to go. So, what is your suggestion?</p>\n"}, {"tags": ["windows", "file", "go"], "comments": [{"owner": {"reputation": 614, "user_id": 4876536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36757ceb0bbec00338926fc2ab6cda58?s=128&d=identicon&r=PG&f=1", "display_name": "fassl", "link": "https://stackoverflow.com/users/4876536/fassl"}, "edited": false, "score": 1, "creation_date": 1444342924, "post_id": 32987303, "comment_id": 53876087, "body": "You could unzip in the %TEMP% and move the unzipped files to target."}, {"owner": {"reputation": 614, "user_id": 4876536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36757ceb0bbec00338926fc2ab6cda58?s=128&d=identicon&r=PG&f=1", "display_name": "fassl", "link": "https://stackoverflow.com/users/4876536/fassl"}, "edited": false, "score": 0, "creation_date": 1444343020, "post_id": 32987303, "comment_id": 53876117, "body": "But actually, just use IExpress, it does what you want and can compress content."}], "owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1459815519, "creation_date": 1444206364, "last_edit_date": 1459815519, "question_id": 32987303, "link": "https://stackoverflow.com/questions/32987303/go-program-that-deletes-itself-after-executing", "title": "Go Program that Deletes Itself after executing", "body": "<p>I wrote a .wxs source that creates a msi installer. The installer extracts two file in the target location one is a zip file and the other is an unzip.exe. I will trigger the unzip.exe so that it unzips the zip file and delets the zipped folder.</p>\n\n<pre><code>&lt;File Id=\"ApplicationFile2\" Source=\"unzip.exe\"  Vital=\"no\" DiskId=\"1\" Hidden=\"yes\"/&gt;\n&lt;!-- custom action for unzip and start services --&gt;\n&lt;Binary Id=\"unzipExeId\" SourceFile=\"unzip.exe\"/&gt;\n&lt;CustomAction Id=\"unzipAction\" BinaryKey=\"unzipExeId\" ExeCommand=\"\" Execute='deferred' Return   ='asyncWait' Impersonate='no'/&gt;\n&lt;InstallExecuteSequence&gt;\n    &lt;Custom Action='unzipAction' Before='InstallFinalize'/&gt;\n&lt;/InstallExecuteSequence&gt;  \n</code></pre>\n\n<p>My problem is that i must delete the unzip.exe once it is executed. Can someone give me a solution to make the unzip.exe to delete itself after executing. I wrote the unzip.exe in Go.</p>\n"}, {"tags": ["regex", "go"], "answers": [{"comments": [{"owner": {"reputation": 22340, "user_id": 664108, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cbc8378de58e66705678686057cffac9?s=128&d=identicon&r=PG", "display_name": "Fabian Schmengler", "link": "https://stackoverflow.com/users/664108/fabian-schmengler"}, "edited": false, "score": 0, "creation_date": 1444207718, "post_id": 32987402, "comment_id": 53800163, "body": "Wow, I was sure that I had tried it at least with <code>1</code> but looks like I had another error then, cannot reproduce it anymore. <code>-1</code> works great, thanks"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 36, "last_activity_date": 1471848384, "last_edit_date": 1471848384, "creation_date": 1444206674, "answer_id": 32987402, "question_id": 32987215, "link": "https://stackoverflow.com/questions/32987215/find-numbers-in-string-using-golang-regexp/32987402#32987402", "title": "Find numbers in string using Golang regexp", "body": "<p>The problem is with your second integer argument. Quoting from the package doc of <a href=\"https://golang.org/pkg/regexp/\" rel=\"noreferrer\"><code>regex</code></a>:</p>\n\n<blockquote>\n  <p>These routines take an extra integer argument, n; if n >= 0, the function returns at most n matches/submatches.</p>\n</blockquote>\n\n<p>You pass <code>0</code> so at most 0 matches will be returned; that is: <em>none</em> (not really useful).</p>\n\n<p>Try passing <code>-1</code> to indicate you want all.</p>\n\n<p>Example:</p>\n\n<pre><code>re := regexp.MustCompile(\"[0-9]+\")\nfmt.Println(re.FindAllString(\"abc123def987asdf\", -1))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[123 987]\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/LWn1vahhok\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 22340, "user_id": 664108, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cbc8378de58e66705678686057cffac9?s=128&d=identicon&r=PG", "display_name": "Fabian Schmengler", "link": "https://stackoverflow.com/users/664108/fabian-schmengler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25468, "favorite_count": 1, "accepted_answer_id": 32987402, "answer_count": 1, "score": 17, "last_activity_date": 1471848384, "creation_date": 1444206108, "question_id": 32987215, "link": "https://stackoverflow.com/questions/32987215/find-numbers-in-string-using-golang-regexp", "title": "Find numbers in string using Golang regexp", "body": "<p>I want to find all numbers in a string with the following code:</p>\n\n<pre><code>re:=regexp.MustCompile(\"[0-9]+\")\nfmt.Println(re.FindAllString(\"abc123def\", 0))\n</code></pre>\n\n<p>I also tried adding delimiters to the regex, using a positive number as second parameter for <code>FindAllString</code>, using a numbers only string like \"123\" as first parameter...</p>\n\n<p>But the output is always <code>[]</code></p>\n\n<p>I seem to miss something about how regular expressions work in Go, but cannot wrap my head around it. Is <code>[0-9]+</code> not a valid expression?</p>\n"}, {"tags": ["function", "go", "export", "godoc"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444199451, "post_id": 32985137, "comment_id": 53795412, "body": "Source files of the same package can refer to identifiers defined in any of the source files without any effort. If they are in the same folder and if they have the same package declaration, you can refer all package-level exported and unexported identifiers as if all would have been defined in one file."}], "answers": [{"comments": [{"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1444199833, "post_id": 32985270, "comment_id": 53795603, "body": "Yeah. You are right. In this case the folder name is gddo-server but all the files has <code>package main</code> declaration. Any suggestion how to run this in local?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1444213131, "last_edit_date": 1444213131, "creation_date": 1444199693, "answer_id": 32985270, "question_id": 32985137, "link": "https://stackoverflow.com/questions/32985137/how-to-access-unexported-functions-in-the-same-package-but-from-different-file/32985270#32985270", "title": "How to access unexported functions in the same package but from different file", "body": "<p>Source files of the same package can refer to identifiers defined in any of the source files without any effort. If they are in the same folder and if they have the same package declaration, you can refer all package-level exported and unexported identifiers as if all would have been defined in one file.</p>\n\n<p>See <a href=\"https://golang.org/ref/spec#Packages\" rel=\"nofollow\">Spec: Packages</a>:</p>\n\n<blockquote>\n  <p>A package in turn is constructed from one or more source files that together declare constants, types, variables and functions belonging to the package and which are accessible in all files of the same package.</p>\n</blockquote>\n\n<p>And <a href=\"http://Package%20clause\" rel=\"nofollow\">Spec: Package clause</a>:</p>\n\n<blockquote>\n  <p>A set of files sharing the same PackageName form the implementation of a package. An implementation may require that all source files for a package inhabit the same directory.</p>\n</blockquote>\n\n<p>One thing to note: your example seems to be the special <code>main</code> package. If you want to run it with <code>go run</code>, you have to enumerate all the source files.</p>\n\n<p>To run your example with <code>go run</code>, navigate to the <code>gddo-server</code> folder and type:</p>\n\n<pre><code>go run background.go browse.go client.go crawl.go graph.go main.go play.go template.go \n</code></pre>\n\n<p>Or simpler if you first build it. Navigate to the <code>gddo-server</code> folder and type:</p>\n\n<pre><code>go build\n</code></pre>\n\n<p>This will generate a native executable binary in the same folder. To run it type: <code>gddo-server</code> (on Windows) or <code>./gddo-server</code> (on Linux).</p>\n\n<p>Or you can install it with <code>go install</code> which will place the result executable binary in your <code>$GOPATH/bin</code> folder.</p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2707, "favorite_count": 0, "accepted_answer_id": 32985270, "answer_count": 1, "score": 0, "last_activity_date": 1573640571, "creation_date": 1444199084, "last_edit_date": 1573640571, "question_id": 32985137, "link": "https://stackoverflow.com/questions/32985137/how-to-access-unexported-functions-in-the-same-package-but-from-different-file", "title": "How to access unexported functions in the same package but from different file", "body": "<p>I am trying to build <a href=\"https://github.com/golang/gddo\" rel=\"nofollow noreferrer\">godoc.org</a> source code in my local to make some changes. My working directory is <code>/Users/Dany/go/src/github.com/golang/gddo</code>. In gddo-server package there several files. One of the go file uses a function from another file which is in the same package but unexported. It is throwing <code>Undefined: &lt;function-name&gt;</code> exception.</p>\n\n<p>Folder is structure is,</p>\n\n<pre><code>golang/gddo/\n              gddo-server\n                        main.go\n                        crawl.go\n</code></pre>\n\n<p>How do we use unexported function from the same package in a different file? Could anyone help me with this. Also if anyone has any idea about how to build godoc.org code?</p>\n"}, {"tags": ["types", "go", "type-systems"], "comments": [{"owner": {"reputation": 118092, "user_id": 4952130, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kKQZw.png?s=128&g=1", "display_name": "Dimitris Fasarakis Hilliard", "link": "https://stackoverflow.com/users/4952130/dimitris-fasarakis-hilliard"}, "edited": false, "score": 1, "creation_date": 1444193797, "post_id": 32983546, "comment_id": 53793266, "body": "I don&#39;t understand the <b>unclear what you&#39;re asking</b> close vote since I <i>highlighted</i> that what I&#39;m looking for is <b><i>a concise, clear example illustrating the differences between the concepts of named and unnamed types</i></b>."}], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 1, "creation_date": 1444195621, "post_id": 32984197, "comment_id": 53793869, "body": "Go point about []Foo and unnamed types being composed into named types. It&#39;s interesting to me, looking at the spec, that there are some type literals typically left unnamed (arrays, slices, maps, chans, pointers) and some type literals typically named (structs, funcs, and interfaces). With the caveat that empty structs and interfaces are common, and that depending on code style, unnamed funcs might show up a good bit too."}, {"owner": {"reputation": 118092, "user_id": 4952130, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kKQZw.png?s=128&g=1", "display_name": "Dimitris Fasarakis Hilliard", "link": "https://stackoverflow.com/users/4952130/dimitris-fasarakis-hilliard"}, "edited": false, "score": 0, "creation_date": 1444277125, "post_id": 32984197, "comment_id": 53837265, "body": "Thanks for the great answer, James."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1603994225, "post_id": 32984197, "comment_id": 114219006, "body": "<code>x = y; y=x;</code>  is not allowed   <a href=\"https://golang.org/ref/spec#Type_identity\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Type_identity</a>"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1604118506, "post_id": 32984197, "comment_id": 114256359, "body": "@overexchange: The second assignability rule in the spec would seem to allow it, and the compiler doesn&#39;t complain: <a href=\"https://play.golang.org/p/IzCCgBOvW6f\" rel=\"nofollow noreferrer\">play.golang.org/p/IzCCgBOvW6f</a>"}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 30, "last_activity_date": 1444194448, "creation_date": 1444194448, "answer_id": 32984197, "question_id": 32983546, "link": "https://stackoverflow.com/questions/32983546/named-and-unnamed-types/32984197#32984197", "title": "Named and Unnamed Types", "body": "<p>A simple way of thinking about it is that named types are those you define with the <code>type</code> statement, and unnamed types are composite types defined by a type literal.</p>\n\n<p>For example, the type of the variable <code>x</code> is unnamed:</p>\n\n<pre><code>var x struct{ I int }\n</code></pre>\n\n<p>And the type of the variable <code>y</code> is named:</p>\n\n<pre><code>type Foo struct{ I int }\nvar y Foo\n</code></pre>\n\n<p>Each of these variables is considered to have a distinct type, even though the underlying type of each is the same (a structure containing a single integer member named <code>I</code>).</p>\n\n<p>One property of unnamed types is that all variables declared using the same unnamed type are considered to have the same type, while two named types with the same underlying representation are distinct.  For example:</p>\n\n<pre><code>var x2 struct{ I int }\ntype Bar struct{ I int }\nvar z Bar\n</code></pre>\n\n<p>Here <code>x</code> and <code>x2</code> have the same type, while <code>y</code> and <code>z</code> do not.</p>\n\n<p>These distinctions come into play in a few places in the language:</p>\n\n<ol>\n<li><p>Assigning a value of one named type to variable of a different named type is forbidden, even if the underlying type is the same.  Assignment between related named and unamed types is allowed though.  That is, the following are okay:</p>\n\n<pre><code>x = y    // named type assigned to unnamed type\ny = x    // unnamed type assigned to named type\n</code></pre>\n\n<p>But the following is an error:</p>\n\n<pre><code>y = z    // assignment between different named types\n</code></pre></li>\n<li><p>You can define methods for a type you've named.  So adding methods to <code>Foo</code> is possible but there is no way you can attach methods to the variable <code>x</code>.</p></li>\n</ol>\n\n<p>Note also that named types can be used in type literals to define new unnamed types.  For example, the slice type <code>[]Foo</code> is unnamed despite using <code>Foo</code>.  If we wanted to attach methods to this slice type (e.g. for use with the <code>sort</code> package), we'd have to name it:</p>\n\n<pre><code>type Baz []Foo\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 6, "creation_date": 1444196460, "post_id": 32984322, "comment_id": 53794154, "body": "The lang spec is good to learn about the language. I&#39;ve read it multiple times. Might not be the same with other languages (e.g. Java), but Go&#39;s spec is good. But it&#39;s easier to understand it if you already know the language a little and if you already know other languages. The Effective Go is not the #1 source to learn the language, it is to understand it deeper (as it presumes you already know Go and doesn&#39;t mention lot of important details). Quoting from Effective Go: <i>&quot;It augments the language specification, the Tour of Go, and How to Write Go Code, all of which you should read first.&quot;</i>"}], "tags": [], "owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "is_accepted": false, "score": 1, "last_activity_date": 1444195044, "creation_date": 1444195044, "answer_id": 32984322, "question_id": 32983546, "link": "https://stackoverflow.com/questions/32983546/named-and-unnamed-types/32984322#32984322", "title": "Named and Unnamed Types", "body": "<p>For starters, the Language Specification is what it sounds like -- a reference document. It's a great tool to use for reference, but not for learning about the language. you're better off <em>learning</em> about Go through the <a href=\"http://tour.golang.org/\" rel=\"nofollow\">Go Tour</a>, an interactive introduction to various aspects of the language or through <a href=\"http://golang.org/doc/effective_go.html\" rel=\"nofollow\">Effective Go</a>, which details how to use the language.</p>\n\n<p>An unnamed type, is just a type declared without a name by using a <strong>type literal</strong>, in other words, the primitive type followed by a list of other types that make it inside {}. Or to quote the spec again, a type literal \"composes a new type from existing types\" An <a href=\"http://play.golang.org/p/rpSCKFBS-G\" rel=\"nofollow\">example</a> with structs follows, but while unnamed struct might be rare, channels and maps (which again, do little on their own must be <em>composed</em> from other types) are rarely named. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Named struct {\n    x int\n    y int\n}\n\nfunc main() {\n    a := Named{1, 2}\n    fmt.Println(a)\n\n    b := struct{ x, y int }{1, 2}\n    fmt.Println(b)\n}\n</code></pre>\n"}], "owner": {"reputation": 118092, "user_id": 4952130, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kKQZw.png?s=128&g=1", "display_name": "Dimitris Fasarakis Hilliard", "link": "https://stackoverflow.com/users/4952130/dimitris-fasarakis-hilliard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6267, "favorite_count": 9, "accepted_answer_id": 32984197, "answer_count": 2, "score": 17, "last_activity_date": 1444277073, "creation_date": 1444190162, "last_edit_date": 1495541892, "question_id": 32983546, "link": "https://stackoverflow.com/questions/32983546/named-and-unnamed-types", "title": "Named and Unnamed Types", "body": "<h3>The problem:</h3>\n\n<p>I recently started reading the Golang <a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">Specification Manual</a> and got stuck trying to understand the <strong><em>named and unnamed</em></strong> types in the <a href=\"https://golang.org/ref/spec#Types\" rel=\"noreferrer\">relevant section</a>. I come from a dynamic language and this has given me a bit of a headache.</p>\n\n<p><strong>The manual states</strong>:</p>\n\n<blockquote>\n  <p>A type determines the set of values and operations specific to values of that type. Types may be <em>named</em> or\n  <em>unnamed</em>. Named types are specified by a (possibly <strong><em><a href=\"https://golang.org/ref/spec#Qualified_identifiers\" rel=\"noreferrer\">qualified</a></em></strong>) <strong><em><a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"noreferrer\">type name</a></em></strong>; unnamed types are specified\n  using a type literal, which composes a new type from existing types.</p>\n</blockquote>\n\n<p><strong>And continues</strong>:</p>\n\n<blockquote>\n  <p>Named instances of the boolean, numeric, and string types are <strong><em><a href=\"https://golang.org/ref/spec#Predeclared_identifiers\" rel=\"noreferrer\">predeclared</a></em></strong>. Composite types\u2014array,\n  struct, pointer, function, interface, slice, map, and channel types\u2014may be constructed using type literals.</p>\n</blockquote>\n\n<p>The problem here is that with the specification, the links make me jump around the pages and lose track of what is what with so many concepts thrown at me too fast.</p>\n\n<hr>\n\n<h3>Other Resources:</h3>\n\n<p>I have searched around for clarification on this and, other than the specification manual, resources are scarce. The only relevant material I could locate was:</p>\n\n<ul>\n<li><p><a href=\"http://www.laktek.com/2012/01/27/learning-go-types/\" rel=\"noreferrer\">Learning Go - Types</a> - blog-post explaining nuances of the Type System in Go.</p></li>\n<li><p><a href=\"https://code.google.com/p/go/issues/detail?id=5682\" rel=\"noreferrer\">An issue here</a> about <em>pretty much the same thing I'm asking</em>.</p></li>\n</ul>\n\n<p>Unfortunately, I couldn't find any <strong><em><a href=\"https://stackoverflow.com/search?q=%5Bgo%5D%20named%20unnamed\">relevant questions</a></em></strong> on Stack Overflow regarding this. (and if they exist, I need to revise my search methods!). I'm asking because understanding the type system of a new language is one of the <strong><em>basic concepts</em></strong> in order to efficiently learn it. </p>\n\n<hr>\n\n<h3>So, the question:</h3>\n\n<p>Can somebody present a <strong><em>concise, clear example illustrating the differences between the concepts of named and unnamed types?</em></strong>* </p>\n\n<p><sub>*Additionally, explaining the concepts of <strong>qualified</strong> and <strong>pre-declared</strong> would be good for completeness but obviously not necessary.</sub> </p>\n"}, {"tags": ["go", "compiler-errors"], "answers": [{"tags": [], "owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "is_accepted": false, "score": 2, "last_activity_date": 1444181032, "creation_date": 1444181032, "answer_id": 32982296, "question_id": 32982279, "link": "https://stackoverflow.com/questions/32982279/go-compiler-undefined-method/32982296#32982296", "title": "Go compiler undefined method", "body": "<p><code>Write</code> is defined on <code>responseWriter</code>. Note the lowercase <code>r</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4554, "user_id": 192221, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/38504ff52422b72b239a7b05ef0ccaae?s=128&d=identicon&r=PG", "display_name": "kristianp", "link": "https://stackoverflow.com/users/192221/kristianp"}, "is_accepted": true, "score": 6, "last_activity_date": 1444204197, "last_edit_date": 1444204197, "creation_date": 1444192151, "answer_id": 32983840, "question_id": 32982279, "link": "https://stackoverflow.com/questions/32982279/go-compiler-undefined-method/32983840#32983840", "title": "Go compiler undefined method", "body": "<p>The rest.ReponseWriter type has no Write, it has the following methods:</p>\n\n<pre><code>Header\nWriteJson\nEncodeJson\nWriteHeader\n</code></pre>\n\n<p>However, it says <a href=\"https://github.com/ant0ine/go-json-rest/blob/master/rest/response.go\" rel=\"noreferrer\" title=\"in the comments\">in the comments</a> that http.ResponseWriter methods are available by type assertion.  So you should be able to write the following:</p>\n\n<pre><code>package server\n\nimport (\n        \"github.com/ant0ine/go-json-rest/rest\"\n        \"net/http\"\n)\n\nfunc WriteTest(w rest.ResponseWriter) {\n        var bs []byte\n        w.(http.ResponseWriter).Write(bs)\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5416275, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WvpAkm7xU9w/AAAAAAAAAAI/AAAAAAAAB4U/9pzRM6KPb74/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/5416275/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1271, "favorite_count": 0, "accepted_answer_id": 32983840, "answer_count": 2, "score": 0, "last_activity_date": 1444204197, "creation_date": 1444180860, "question_id": 32982279, "link": "https://stackoverflow.com/questions/32982279/go-compiler-undefined-method", "title": "Go compiler undefined method", "body": "<p>I am getting a compiler error \"w.Write undefined (type rest.ResponseWriter has no field or method Write)\" </p>\n\n<p>I created a bare bones test file and have the same problem:</p>\n\n<pre><code>package server\n\nimport (\n        \"github.com/ant0ine/go-json-rest/rest\"\n)\n\nfunc WriteTest(w rest.ResponseWriter) {\n        var bs []byte\n        w.Write(bs)\n}\n</code></pre>\n\n<p>The method that the compiler says is not defined is definitely in the <a href=\"https://github.com/ant0ine/go-json-rest/blob/master/rest/response.go#L92\" rel=\"nofollow\">rest package</a>.</p>\n"}, {"tags": ["encryption", "go", "openssl", "cryptography"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1444207168, "post_id": 32981821, "comment_id": 53799823, "body": "How do you load <code>key</code> and <code>password</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444249125, "post_id": 32981821, "comment_id": 53828267, "body": "It&#39;s not supported <a href=\"https://golang.org/issue/8860\" rel=\"nofollow noreferrer\">golang.org/issue/8860</a>"}], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 5221361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ed56bd4393f501d4b691424cc689a75?s=128&d=identicon&r=PG&f=1", "display_name": "Gakho", "link": "https://stackoverflow.com/users/5221361/gakho"}, "edited": false, "score": 1, "creation_date": 1444244385, "post_id": 32994842, "comment_id": 53825304, "body": "Looking at that source code. It seems to only handle if it was encrypted in AES-256-CBC mode. However, the openssl default is pbeWITHMD5ndDES-CBC. It seems like this library can&#39;t handle that. Am I wrong?"}], "tags": [], "owner": {"reputation": 56, "user_id": 5331511, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153170441971818/picture?type=large", "display_name": "Gregory Man", "link": "https://stackoverflow.com/users/5331511/gregory-man"}, "is_accepted": true, "score": 4, "last_activity_date": 1444227802, "creation_date": 1444227802, "answer_id": 32994842, "question_id": 32981821, "link": "https://stackoverflow.com/questions/32981821/no-dek-info-header-in-block-when-attempting-to-read-encrypted-private-key/32994842#32994842", "title": "&quot;No DEK-Info header in block&quot; when attempting to read encrypted private key", "body": "<p>Go don't have function to decrypt PKCS8 keys in standard library.</p>\n\n<p>You can this package:\n<a href=\"https://github.com/youmark/pkcs8/blob/master/pkcs8.go#L103\" rel=\"nofollow\">https://github.com/youmark/pkcs8/blob/master/pkcs8.go#L103</a></p>\n"}, {"tags": [], "owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "is_accepted": false, "score": 1, "last_activity_date": 1601455924, "last_edit_date": 1601455924, "creation_date": 1601455222, "answer_id": 64133927, "question_id": 32981821, "link": "https://stackoverflow.com/questions/32981821/no-dek-info-header-in-block-when-attempting-to-read-encrypted-private-key/64133927#64133927", "title": "&quot;No DEK-Info header in block&quot; when attempting to read encrypted private key", "body": "<p>A longer explaination for anyone with the same problem.</p>\n<h2>What would work</h2>\n<p>Your first command</p>\n<pre><code>openssl genrsa -out file.pem -passout pass:file -aes256 1024\n</code></pre>\n<p>generates a PKCS#1 private key file (file.pem):</p>\n<pre><code>-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: AES-256-CBC,1DA219DB746F88C6DDA0D852A0FD3232\n\nAEf09rGkgGEJ79GgO4dEVsArwv4IbbODlxy95uHhfkdGYmuk6OlTpiCUE0GT68wn\nKFJfBcHr8Z3VqiHGsXxM5QlKhgnfptxfbrdKErgBD5LQcrvnqmf43KeD4lGQcpiy\n...\n...\nmAKMCwiU/GKZz8ZwQ4qGkBlVVCOFfgwmfbqguJF2l8yzM8lYI9MZ9NEwKkvEbc\n-----END RSA PRIVATE KEY-----\n</code></pre>\n<p>This private key file can be parsed and decrypted by <a href=\"https://golang.org/pkg/crypto/x509/#DecryptPEMBlock\" rel=\"nofollow noreferrer\">x509.DecryptPEMBlock()</a> alright.</p>\n<h2>What would not work and why</h2>\n<p>Your second command</p>\n<pre><code>openssl pkcs8 -topk8 -inform pem -in file.pem -outform pem -out filePKCS8.pem\n</code></pre>\n<p>converts that file into PKCS#8 format (filePKCS8.pem).</p>\n<p>The subcommmand <code>genpkey</code> would directly produce a similar result:</p>\n<pre><code>openssl genpkey -algorithm RSA -aes256 \\\n  -pkeyopt rsa_keygen_bits:1024 -out filePKCS8.pem\n</code></pre>\n<p>The generated filePKCS8.pem (either way) would look similar to this:</p>\n<pre><code>-----BEGIN ENCRYPTED PRIVATE KEY-----\nMIISrTBXBgkqhkiG9w0BBQ0wSjKpBgkqhkiG9w0BBQwwHAQIKL+ordsVfqsCAggB\nMAwGCCqGSIb3DQIJCQAwHQYJYIZIWAUDBAEqBBCipOAAxWkC0/zkNLNYTSMgBIIS\n...\n...\nzfdxjZ0XmPiwED2azsLMnRrWnRj2UqMtnv9zO/ucik9za\n-----END ENCRYPTED PRIVATE KEY-----\n</code></pre>\n<p><a href=\"https://golang.org/pkg/crypto/x509/#DecryptPEMBlock\" rel=\"nofollow noreferrer\">x509.DecryptPEMBlock()</a> does not support this format. And as specified in <a href=\"https://github.com/golang/go/issues/8860\" rel=\"nofollow noreferrer\">#8860</a>, the Go's core library has no real plan to support pkcs#8 in the near future.</p>\n<p>As mentioned by <a href=\"https://stackoverflow.com/users/5331511/gregory-man\">Gregory</a>, if you want to work with it, you'll have better luck with 3rd party library like <a href=\"https://github.com/youmark/pkcs8\" rel=\"nofollow noreferrer\">github.com/youmark/pkcs8</a> (<a href=\"https://godoc.org/github.com/youmark/pkcs8\" rel=\"nofollow noreferrer\">Documentation</a>).</p>\n"}], "owner": {"reputation": 485, "user_id": 5221361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ed56bd4393f501d4b691424cc689a75?s=128&d=identicon&r=PG&f=1", "display_name": "Gakho", "link": "https://stackoverflow.com/users/5221361/gakho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3218, "favorite_count": 0, "accepted_answer_id": 32994842, "answer_count": 2, "score": 8, "last_activity_date": 1601455924, "creation_date": 1444177338, "last_edit_date": 1444436411, "question_id": 32981821, "link": "https://stackoverflow.com/questions/32981821/no-dek-info-header-in-block-when-attempting-to-read-encrypted-private-key", "title": "&quot;No DEK-Info header in block&quot; when attempting to read encrypted private key", "body": "<p>I'm trying to read an encrypted PKCS8 private key file. I generated the keys like this:</p>\n\n<pre><code>openssl genrsa -out file.pem -passout pass:file -aes256 1024\nopenssl pkcs8 -topk8 -inform pem -in file.pem -outform pem -out filePKCS8.pem\n</code></pre>\n\n<p>And I try reading it in Go this way:</p>\n\n<pre><code>block, _ := pem.Decode(key)\nreturn x509.DecryptPEMBlock(block, password)\n</code></pre>\n\n<p>But I get an error saying:</p>\n\n<pre><code>x509: no DEK-Info header in block\n</code></pre>\n\n<p>However, I can't figure out what's going wrong. Am I generating the key wrong or am I using the wrong library? I see libraries specifically for reading unencrypted PKCS8 files but none for encrypted PKCS8 files specifically.</p>\n\n<p>Does anyone have any idea?</p>\n"}, {"tags": ["struct", "go", "polymorphism"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 5416282, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003104631153/picture?type=large", "display_name": "Yusuke  Hatanaka", "link": "https://stackoverflow.com/users/5416282/yusuke-hatanaka"}, "is_accepted": false, "score": 4, "last_activity_date": 1444179881, "creation_date": 1444179881, "answer_id": 32982154, "question_id": 32981576, "link": "https://stackoverflow.com/questions/32981576/embedded-types-and-polymorphism-with-structs/32982154#32982154", "title": "Embedded types and polymorphism with structs", "body": "<p>Model struct is not a type User struct.<br>\nUser can't behave Model even if embedded it.  </p>\n\n<p>This case, you can use interface like below.<br>\n<a href=\"http://play.golang.org/p/Hh0zIT9yFC\" rel=\"nofollow\">http://play.golang.org/p/Hh0zIT9yFC</a></p>\n\n<pre>\n    package main\n\n    import \"fmt\"\n\n    type Model interface {\n        GetID() uint\n    }\n\n    type BaseModel struct {\n        Id uint\n    }\n\n    func (m BaseModel) GetID() uint {\n        return m.Id\n    }\n\n    type Collection struct {\n        Records []Model\n    }\n\n    type User struct {\n        *BaseModel\n        Name string\n    }\n\n    func (u User) GetName() string {\n        return u.Name\n    }\n\n    func main() {\n        user := User{&BaseModel{1}, \"Jon\"}\n        uc := &Collection{[]Model{user}}\n        u := uc.Records[0].(User)\n        fmt.Println(u.GetID())\n        fmt.Println(u.GetName())\n    }\n</pre>\n"}, {"comments": [{"owner": {"reputation": 3031, "user_id": 1315900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/81ac598abb24d160c87a6f9a72e250d2?s=128&d=identicon&r=PG", "display_name": "Fermin Silva", "link": "https://stackoverflow.com/users/1315900/fermin-silva"}, "edited": false, "score": 0, "creation_date": 1481907263, "post_id": 32982168, "comment_id": 69577866, "body": "But in your example, while I can store BaseModel into Records, how can I get back those BaseModels again? If I get collection[0] that would be a Model, not a BaseModel, so how could I access the Id field?"}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "reply_to_user": {"reputation": 3031, "user_id": 1315900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/81ac598abb24d160c87a6f9a72e250d2?s=128&d=identicon&r=PG", "display_name": "Fermin Silva", "link": "https://stackoverflow.com/users/1315900/fermin-silva"}, "edited": false, "score": 0, "creation_date": 1481907531, "post_id": 32982168, "comment_id": 69578006, "body": "You check the record type by using type assertion and then access the field. For example, <code>m := Records[0].(*User); println(m.Id);</code>."}, {"owner": {"reputation": 3031, "user_id": 1315900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/81ac598abb24d160c87a6f9a72e250d2?s=128&d=identicon&r=PG", "display_name": "Fermin Silva", "link": "https://stackoverflow.com/users/1315900/fermin-silva"}, "edited": false, "score": 0, "creation_date": 1481908632, "post_id": 32982168, "comment_id": 69578575, "body": "The thing is that you need to know the exact type inserted in the <code>Records</code> array. If you do type assertion with <code>BaseModel</code>, but what is stored is actually an <code>User</code>, the assertion fails. <code>User</code> is-not-a <code>BaseModel</code>. Example: <a href=\"https://play.golang.org/p/cnLnVpKTNk\" rel=\"nofollow noreferrer\">play.golang.org/p/cnLnVpKTNk</a>"}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "reply_to_user": {"reputation": 3031, "user_id": 1315900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/81ac598abb24d160c87a6f9a72e250d2?s=128&d=identicon&r=PG", "display_name": "Fermin Silva", "link": "https://stackoverflow.com/users/1315900/fermin-silva"}, "edited": false, "score": 0, "creation_date": 1481991374, "post_id": 32982168, "comment_id": 69600403, "body": "Yes. If you want that all records have an identifier, you would implement it using the <code>Model</code> interface, for example."}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 6, "last_activity_date": 1444180017, "creation_date": 1444180017, "answer_id": 32982168, "question_id": 32981576, "link": "https://stackoverflow.com/questions/32981576/embedded-types-and-polymorphism-with-structs/32982168#32982168", "title": "Embedded types and polymorphism with structs", "body": "<p>You have two options:</p>\n\n<ul>\n<li>Make another collection type</li>\n<li>Use interfaces instead</li>\n</ul>\n\n<p>Implementing separate collections like <code>UserCollection</code>, <code>BarCollection</code>, <code>FooCollection</code> is an option if you do not have too many foos and bars.</p>\n\n<p>The other way is to use either the generic empty interface type <code>interface{}</code> which will hold values of any type (since every instance of every type satisfies the empty interface):</p>\n\n<pre><code>type Collection struct {\n    Records []interface{}\n}\n</code></pre>\n\n<p>This has a number of drawbacks such as that you have to do a type assertion every time you access the <code>Records</code> field, that you can put everything in there by mistake and that you have to use reflection to do most manipulations.</p>\n\n<p>The better way to use interfaces would be to implement a model interface and let every type that is a model implement the interface:</p>\n\n<pre><code>type Model interface {\n    ImplementsModel()\n}\n\ntype BaseModel struct {\n    Id uint\n}\n\nfunc (b *BaseModel) ImplementsModel() {}\n\ntype User struct {\n    *BaseModel\n    Name string\n}\n\ntype Collection struct {\n    Records []Model\n}\n</code></pre>\n\n<p>Of course you can remove the <code>ImplementsModel</code> dummy method once you have meaningful methods. This dummy method is just there to distinguish the interface from the empty interface so that you cannot put integer values or strings in place of actual models into the collection.</p>\n"}], "owner": {"reputation": 185, "user_id": 4561046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cee9525289160a182909f8b05e80fde?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/4561046/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3492, "favorite_count": 1, "accepted_answer_id": 32982168, "answer_count": 2, "score": 4, "last_activity_date": 1444180017, "creation_date": 1444175364, "question_id": 32981576, "link": "https://stackoverflow.com/questions/32981576/embedded-types-and-polymorphism-with-structs", "title": "Embedded types and polymorphism with structs", "body": "<p>I'm creating an API, and I have two different structs for JSON responses; one for single records and one for collection of records:</p>\n\n<pre><code>type Model struct {\n  Id uint\n}\n\ntype Collection struct {\n  Records []Model\n}\n</code></pre>\n\n<p>A <code>Model</code> is just a struct representation of database data (for say, a User), and a <code>Collection</code> is a collection of models. </p>\n\n<p>The issue is that there will be separate structs that embed the <code>Model</code> type, like so:</p>\n\n<pre><code>type User struct {\n    *Model\n    Name string\n}\n</code></pre>\n\n<p>And since a <code>User</code> doesn't satisfy the <code>Model</code> type, I can't append it to the <code>Collection</code> struct like this:</p>\n\n<pre><code>user := User{&amp;Model{1}, \"Jon\"}\nuc := &amp;Collection{[]User{user}}\n</code></pre>\n\n<p>How can I make the Records struct accept struct types that implement <code>Model</code>?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444172388, "post_id": 32980935, "comment_id": 53787769, "body": "You don&#39;t see <i>immediately</i> the inserted entity because the AppEngine SDK simulates the <b>eventual consistency</b> that applies to the High Replication Datastore."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444172620, "post_id": 32980935, "comment_id": 53787846, "body": "Also note that you can force strong consistency and thus you will see your inserted entity immediately if you create a context like this: <code>c, err := aetest.NewContext(&amp;aetest.Options{StronglyConsistentDatastor&zwnj;&#8203;e: true})</code>"}], "owner": {"reputation": 3572, "user_id": 436792, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ddfe7b21b49d7deaf7b79c03632a9e4?s=128&d=identicon&r=PG", "display_name": "olivieradam666", "link": "https://stackoverflow.com/users/436792/olivieradam666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1444172348, "answer_count": 0, "score": 0, "last_activity_date": 1475211175, "creation_date": 1444171042, "last_edit_date": 1475211175, "question_id": 32980935, "link": "https://stackoverflow.com/questions/32980935/simple-appengine-go-datastore-query-returns-no-result", "closed_reason": "Duplicate", "title": "simple appengine go datastore query returns no result", "body": "<p>I'm new to the go appengine datastore API and I'm having difficulties with my first datastore query.</p>\n\n<p>I cannot retrieve any entry, even if I remove all my filtering code.</p>\n\n<p>I've tried to create a simple test snippet that demonstrates the issue :</p>\n\n<pre><code>package mypackage\n\nimport (\n    \"appengine/aetest\"\n    \"appengine/datastore\"\n    \"testing\"\n)\n\ntype Toto struct {\n    Name string\n}\n\n\nfunc TestGetAll(t *testing.T) {\n    c, err := aetest.NewContext(nil)\n    if err != nil {\n        t.Fatal(err)\n    }\n    defer c.Close()\n\n    // insert a test object\n    _, _ = datastore.Put(c, datastore.NewIncompleteKey(c, \"entitykind\", nil), &amp;Toto{\"totoname\"})\n    // fetch all objects\n    var result []Toto\n    datastore.NewQuery(\"entitykind\").GetAll(c, &amp;result)\n    if len(result) != 1 {\n        t.Fatalf(\"wrong length of result :%v\", result)\n    }\n}\n</code></pre>\n\n<p>If I pause the program after the insertion and check the admin server, I see that the entity is properly inserted.</p>\n\n<p>I cannot understand why my query fails to retrieve it.</p>\n\n<p>I also tried to initialize my <code>result</code> slice to a length of 1, but the <code>Name</code> property is not overwritten by <code>GetAll</code>.</p>\n"}, {"tags": ["tcp", "go"], "comments": [{"owner": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444171053, "post_id": 32980653, "comment_id": 53787310, "body": "Maybe I need to go ahead and write to the connection, then trap and analyze the error to see if redialing and writing again is advised?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444224058, "post_id": 32980653, "comment_id": 53811347, "body": "You detect a closed tcp connection by reading from it, not writing. This is the same in any language, because it&#39;s how the underlying Berkeley sockets api works."}], "answers": [{"comments": [{"owner": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444230960, "post_id": 32981123, "comment_id": 53816798, "body": "thank you for your response.  How is it that netstat, for instance, can show me connection state such as ESTABLISHED or CLOSE_WAIT if there&#39;s no way at all of querying connection state?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444233628, "post_id": 32981123, "comment_id": 53818852, "body": "@KentRancourt: you can get that info from the kernel. On linux netstat parses <code>&#47;proc&#47;net&#47;tcp[6]</code>. That does you no good in your program though, because that state can change as soon as you try to use the socket. You <code>recv</code> if you want to see if there&#39;s data or it&#39;s closed, you <code>send</code> if you want to see if the network responds, and you use a timeout if you don&#39;t want either of those to take an undetermined amount of time."}, {"owner": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444268992, "post_id": 32981123, "comment_id": 53835278, "body": "@JimB thank you for the pointers.  I&#39;m a little confused on one point here.  My client is ONLY sending data.  Apart from acking the packets, the server sends nothing back.  Reading doesn&#39;t seem an appropriate way to determine connection status, as there&#39;s noting TO read.  So am I supposed to just send and act on whatever errors occur?  If so, that&#39;s a problem because I&#39;m observing that I typically do not get any errors at all when attempting to send over a broken pipe-- which seems totally wrong."}, {"owner": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444270361, "post_id": 32981123, "comment_id": 53835641, "body": "To clarify... I can dial, unplug an ethernet cable, and STILL send without error.  The messages don&#39;t get through, obviously, but I receive no error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444315744, "post_id": 32981123, "comment_id": 53861297, "body": "@KentRancourt: I made a full answer, since it was too much to describe in the comments."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 1, "creation_date": 1444334328, "post_id": 32981123, "comment_id": 53872234, "body": "@KentRancourt Remember that a connection state is momentary/transient. You could query the connection state, and in the nano seconds later when you want to send a message on the connection, the connection could been broken. There are a lot of cases where the connection can be broken, but your application(or the TCP stack of your OS) will not know that fact until you send a message and wait until TCP times it out because of a lack of ACKs from the other side. Sending a message on a broken connection and not getting an error(until later) is normal. The error manifests itself later on."}, {"owner": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1444339788, "post_id": 32981123, "comment_id": 53874840, "body": "@nos that helps a bit.  This is the farthest I&#39;ve ever dived into TCP.  Clearly, I need to read up more when time permits.  In most languages (go included), when you write over a TCP connection, you immediately get back a count of how many bytes were written and if there was an error it&#39;s either returned or an exception is thrown/raised.  I guess I have allowed that to mislead me into thinking that any packet sent this way with all signs pointing to success <i>was</i> actually successful.  I see now that is not the case.  I&#39;m going to look farther into JimB&#39;s answer below."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 1, "creation_date": 1444369638, "post_id": 32981123, "comment_id": 53883516, "body": "@KentRancourt Sending on TCP is not done synchronously. You hand off a buffer of data to the TCP stack. The count you get back says how many bytes were copied into that buffer. The TCP stack then takes over and asynchronously tries to deliver the data. e.g. if you unplug the network cable, obviously data cannot be delivered. But TCP will try for a while, until its timers expire. if you plug the cable back in, TCP might deliver the data just fine. This means send() could succeed even if the other end was just nuked, since TCP will try for a while to deliver the data you handed over to TCP."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 1, "creation_date": 1444376319, "post_id": 32981123, "comment_id": 53886847, "body": "@KentRancourt ESTABLISHED, CLOSE_WAIT etc are <i>port</i> states, not connection states, and they are looked up in the kernel, or via SNMP. For example, a local port in CLOSE_WAIT would be in FIN_WAIT_1 at the other end =&gt; not a connection state. Re sending, once you have enough pending send data that is unacknowledged due to the cable pull <i>and</i> TCP has been trying long enough to send it that it has timed out, <i>then</i> you will get a connection reset."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1444172167, "creation_date": 1444172167, "answer_id": 32981123, "question_id": 32980653, "link": "https://stackoverflow.com/questions/32980653/how-to-query-tcp-connection-state-in-go/32981123#32981123", "title": "How to query TCP connection state in go?", "body": "<ul>\n<li><p>There is no such thing as 'TCP connection state', by design. There is only what happens when you send something. There is no TCP API, at any level down to the silicon, that will tell you the current state of a TCP connection. You have to try to use it.</p></li>\n<li><p>If you're sending keepalive probes, the server doesn't have any choice but to respond appropriately. The server doesn't even know that they are keepalives. They aren't. They are just duplicate ACKs. Supporting keepalive just means supporting <em>sending</em> keepalives.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444341617, "post_id": 33019150, "comment_id": 53875601, "body": "I really want to say thank you for all your help.  You&#39;ve done a lot to improve my understanding of how all of this works.  I really do think you&#39;re steering me in the right direction.  With all of that being said, the code snippet you gave only seems to detect the case where the other end has hung up.  That hasn&#39;t been my concern so much as the case where it is a network problem interfering with the connection.  Unplugging a network cable, for instance, doesn&#39;t cause the code above to detect that the connection is no longer viable.  Any thoughts?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444395614, "post_id": 33019150, "comment_id": 53898554, "body": "@KentRancourt: I&#39;m not sure what else I can add; <b>this is how tcp works</b>.  If there&#39;s a network problem, tcp is designed to accept you data, and keep trying to get it to it&#39;s destination. If you want to send data to a server, and be assured that it was processed, you <i>must</i> have an application-level acknowledgment. If you have that, then you can specify a time limit to wait before declaring the connection broken. Short of changing your protocol, you can only make a best effort to send the packets and hope they arrive."}, {"owner": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444413836, "post_id": 33019150, "comment_id": 53909857, "body": "thanks again. I&#39;m accepting your answer. You&#39;ve been incredibly helpful. fwiw, I&#39;m not in control of the remote end of the connection, so sending an app-level ack isn&#39;t possible. One final question: if it all works as you describe (and I have no doubt it does), and a broken connection really isn&#39;t detectable for many minutes of retries and acks not being received, that means the sender can be barfing packets into the ether for several minutes. Doesn&#39;t that, in some respect, contradict the notion of guaranteed delivery? Is there some way to know sooner if a packet can&#39;t be delivered?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "edited": false, "score": 0, "creation_date": 1444416074, "post_id": 33019150, "comment_id": 53911036, "body": "@KentRancourt: &quot;guaranteed delivery&quot; is at a lower layer than your application logic, and doesn&#39;t even mean that the payload reaches the remote application, just that the tcp stack ACK&#39;ed it. Like I said before, you can&#39;t distinguish between delayed packets or lost packets (due to error or congestion), so all TCP can do to &quot;guarantee delivery&quot; is continue to retry and wait for some extended period of time. If you send enough to fill your window size, sending will block, and that&#39;s where setting a write deadline will help break the connection."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1444332399, "last_edit_date": 1444332399, "creation_date": 1444315719, "answer_id": 33019150, "question_id": 32980653, "link": "https://stackoverflow.com/questions/32980653/how-to-query-tcp-connection-state-in-go/33019150#33019150", "title": "How to query TCP connection state in go?", "body": "<p>The socket api doesn't give you access to the state of the connection. You can query the current state it in various ways from the kernel (<code>/proc/net/tcp[6]</code> on linux for example), but that doesn't make any guarantee that further sends will succeed. </p>\n\n<blockquote>\n  <p>I'm a little confused on one point here. My client is ONLY sending data. Apart from acking the packets, the server sends nothing back. Reading doesn't seem an appropriate way to determine connection status, as there's noting TO read. </p>\n</blockquote>\n\n<p>The socket API is defined such that that you detect a closed connection by a read returning 0 bytes. That's the way it works. In Go, this is translated to a Read returning <code>io.EOF</code>. This will usually be the fastest way to detect a broken connection.</p>\n\n<blockquote>\n  <p>So am I supposed to just send and act on whatever errors occur? If so, that's a problem because I'm observing that I typically do not get any errors at all when attempting to send over a broken pipe-- which seems totally wrong</p>\n</blockquote>\n\n<p>If you look closely at how TCP works, this is the expected behavior. If the connection is closed on the remote side, then your first send will trigger an RST from the server, fully closing the local connection. You either need to read from the connection to detect the close, or if you try to send again you will get an error (assuming you've waited long enough for the packets to make a round trip), like \"broken pipe\" on linux.</p>\n\n<blockquote>\n  <p>To clarify... I can dial, unplug an ethernet cable, and STILL send without error. The messages don't get through, obviously, but I receive no error</p>\n</blockquote>\n\n<p>If the connection is actually broken, or the server is totally unresponsive, then you're sending packets off to nowhere. The TCP stack  can't tell the difference between packets that are <em>really</em> slow, packet loss, congestion, or a broken connection. The system needs to wait for the retransmission timeout, and retry the packet a number of times before failing. The standard configuration for retries alone can take between 13 and 30 minutes to trigger an error. </p>\n\n<p>What you can do in your code is</p>\n\n<ul>\n<li>Turn on keepalive. This will notify you of a broken connection more quickly, because the idle connection is always being tested.</li>\n<li>Read from the socket. Either have a concurrent Read in progress, or check for something to read first with select/poll/epoll (Go usually uses the first)</li>\n<li>Set timeouts (deadlines in Go) for everything.</li>\n</ul>\n\n<p>If you're not expecting any data from the connection, checking for a closed connection is very easy in Go; dispatch a goroutine to read from the connection until there's an error.</p>\n\n<pre><code>notify := make(chan error)\n\ngo func() {\n    buf := make([]byte, 1024)\n    for {\n        n, err := conn.Read(buf)\n        if err != nil {\n            notify &lt;- err\n            return\n        }\n        if n &gt; 0 {\n            fmt.Println(\"unexpected data: %s\", buf[:n])\n        }\n    }\n}()\n</code></pre>\n"}], "owner": {"reputation": 1626, "user_id": 1397099, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab4d68f0ef6233809b73ebdc92062ba7?s=128&d=identicon&r=PG", "display_name": "Kent Rancourt", "link": "https://stackoverflow.com/users/1397099/kent-rancourt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2818, "favorite_count": 1, "accepted_answer_id": 33019150, "answer_count": 2, "score": 1, "last_activity_date": 1444332399, "creation_date": 1444169403, "last_edit_date": 1444169875, "question_id": 32980653, "link": "https://stackoverflow.com/questions/32980653/how-to-query-tcp-connection-state-in-go", "title": "How to query TCP connection state in go?", "body": "<p>On the client side of a TCP connection, I am attempting to to reuse established connections as much as possible to avoid the overhead of dialing every time I need a connection.  Fundamentally, it's connection pooling, although technically, my pool size just happens to be one.</p>\n\n<p>I'm running into a problem in that if a connection sits idle for long enough, the other end disconnects.  I've tried using something like the following to keep connections alive:</p>\n\n<pre><code>err = conn.(*net.TCPConn).SetKeepAlive(true)\nif err != nil {\n    fmt.Println(err)\n    return\n}\nerr = conn.(*net.TCPConn).SetKeepAlivePeriod(30*time.Second)\nif err != nil {\n    fmt.Println(err)\n    return\n}\n</code></pre>\n\n<p>But this isn't helping.  In fact, it's causing my connections to close sooner.  I'm pretty sure this is because (on a Mac) this means the connection health starts being probed after 30 seconds and then is probed at 8 times at 30 second intervals.  <em>The server side must not be supporting keepalive</em>, so after 4 minutes and 30 seconds, the client is disconnecting.</p>\n\n<p>There might be nothing I can do to keep an idle connection alive indefinitely, and that would be absolutely ok if there were some way for me to at least <em>detect</em> that a connection has been closed so that I can seamlessly replace it with a new one.  Alas, even after reading all the docs and scouring the blogosphere for help, I can't find any way at all in go to query the state of a TCP connection.</p>\n\n<p>There must be a way.  Does anyone have any insight into how that can be accomplished?  Many thanks in advance to anyone who does!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Ideally, I'd like to learn how to handle this, low-level with pure go-- without using third-party libraries to accomplish this.  Of course if there is some library that does this, I don't mind being pointed in its direction so I can see how they do it.</p>\n"}, {"tags": ["github", "go"], "comments": [{"owner": {"reputation": 15162, "user_id": 1040371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b7fb38ae0407a97f5a342ebbcc288f7?s=128&d=identicon&r=PG", "display_name": "rjz", "link": "https://stackoverflow.com/users/1040371/rjz"}, "edited": false, "score": 1, "creation_date": 1444163473, "post_id": 32979138, "comment_id": 53783688, "body": "If you send an <code>Accept</code> header to the API (also with <code>application&#47;json</code>), you should receive a JSON response that can be unmarshaled."}], "answers": [{"tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": false, "score": 3, "last_activity_date": 1444164766, "creation_date": 1444164766, "answer_id": 32979531, "question_id": 32979138, "link": "https://stackoverflow.com/questions/32979138/parsing-github-response-for-access-token/32979531#32979531", "title": "Parsing Github response for access_token", "body": "<p>This is a URL query string.  You can use the <code>url</code> package to parse it and get a <code>url.Values</code> (which is just a map) out.</p>\n\n<pre><code>resp := \"access_token=e72e16c7e42f292c6912e7710c838347ae178b4a&amp;scope=user%2Cgist&amp;token_type=bearer\"\nvalues, err := url.ParseQuery(resp)\nif err != nil {\n    panic(err)\n}\n\nfmt.Println(\"access_token:\", values[\"access_token\"])\nfmt.Println(\"token_type:\", values[\"token_type\"])\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Dk66znSWu-\" rel=\"nofollow\">Play link</a></p>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1444164766, "creation_date": 1444163324, "question_id": 32979138, "link": "https://stackoverflow.com/questions/32979138/parsing-github-response-for-access-token", "title": "Parsing Github response for access_token", "body": "<p>Just messing around with Github API and oauth. I have got to the point where I receive the <code>access_token</code> back from GH.</p>\n\n<p>I have so far:</p>\n\n<pre><code>url := \"https://github.com/login/oauth/access_token\"\n\nparams := map[string]string{\"client_id\": client_id, \"client_secret\": client_secret, \"code\": code}\ndata, _ := json.Marshal(params)\nresp, _ := http.Post(url, \"application/json\", bytes.NewBuffer(data))\n\ndefer resp.Body.Close()\n\nbody, _ := ioutil.ReadAll(resp.Body)\n</code></pre>\n\n<p>but I would now like to access the response parts. According to the GH docs, they are in the form \n<code>access_token=e72e16c7e42f292c6912e7710c838347ae178b4a&amp;scope=user%2Cgist&amp;token_type=bearer</code></p>\n\n<p>Do I need to parse the string or is there a \"better\" way?</p>\n"}, {"tags": ["go", "gccgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1444142975, "post_id": 32972898, "comment_id": 53770989, "body": "gccgo isn&#39;t up to date with the official go implementation. Is there any particular reason you&#39;re trying to use gccgo?"}, {"owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444143305, "post_id": 32972898, "comment_id": 53771244, "body": "Yeah, the arch I am working on isn&#39;t supported by go. Has the rsa package been added recently? Is there anywhere where I can find that information?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444143736, "post_id": 32972898, "comment_id": 53771561, "body": "It looks like gcc 5 should be up to date with go1.4, which has that field. If PSSOptions is missing Hash, it means that package was built from something before go1.4."}], "owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444142663, "creation_date": 1444142663, "question_id": 32972898, "link": "https://stackoverflow.com/questions/32972898/error-unknown-field-hash-in-rsa-pssoptions", "title": "error: unknown field \u2018Hash\u2019 in \u2018rsa.PSSOptions\u2019", "body": "<p>So, I am building docker that uses rsa module of golang. I am using golang by building gcc, which has gccgo.</p>\n\n<pre><code>linux-l853:~/docker # go version\ngo version gccgo (GCC) 5.0.0 20141113 (experimental) linux/ppc64\n</code></pre>\n\n<p>Now, when I am building it, I get the following error:</p>\n\n<pre><code>github.com/endophage/gotuf/signed\nvendor/src/github.com/endophage/gotuf/signed/verifiers.go:102:50: error: unknown field \u2018Hash\u2019 in \u2018rsa.PSSOptions\u2019\n  opts := rsa.PSSOptions{SaltLength: sha256.Size, Hash: crypto.SHA256}\n                                                  ^\n</code></pre>\n\n<p>Wherein I know that Hash field is defined in rsa.PSSOptions. Any idea why am I getting this error?</p>\n\n<p>TIA.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1444139157, "post_id": 32970957, "comment_id": 53768078, "body": "Choose a package which doesn&#39;t import your other packages, so all your packages can import it. And place shared variables into it. And the <code>main</code> package can also access it to store parameters read on startup."}, {"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 0, "creation_date": 1444139600, "post_id": 32970957, "comment_id": 53768421, "body": "You probably shouldn&#39;t have that many separate packages for a single go application. There&#39;s been a lot of chatter in the go community about this over the years, but you&#39;re probably better off, for a binary, with a dominant package main, only seperating out other packages that you clearly expect to reuse in a different project. Here&#39;s some further <a href=\"https://forum.golangbridge.org/t/organizing-go-code/1110/6\" rel=\"nofollow noreferrer\">discussion</a> on this point."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444165092, "post_id": 32970957, "comment_id": 53784660, "body": "Assuming you follow AndrewN&#39;s advice (KISS), and avoid extra package structure for now, can you just read the parameters from the command line using the flag package? That would seem to solve the problem as described. AFAIK, the flag package can be called from any package (isn&#39;t Go lovely?), not just main, so if it is critical that parameters are in a shared package, but not main, do the work from there."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444168102, "post_id": 32970957, "comment_id": 53786172, "body": "... Or, can you read the parameters from the environment <code>os.Environ()</code>? Again, they can be read from any package."}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1444175815, "post_id": 32970957, "comment_id": 53788719, "body": "Reading parameters from flag or os.Environ() would not be scalable once  we have many configurations. What I&#39;m using now is a config.yaml and use viper to read them."}], "answers": [{"comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444165129, "post_id": 32972010, "comment_id": 53784684, "body": "Is revel solving a different, more sophisticated problem? Just because there is a &#39;sledge hammer&#39;, we don&#39;t need to use it :-)"}], "tags": [], "owner": {"reputation": 170, "user_id": 1596720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99fd986abc96ebc01af0322b7a3beaf9?s=128&d=identicon&r=PG", "display_name": "Iver", "link": "https://stackoverflow.com/users/1596720/iver"}, "is_accepted": false, "score": 1, "last_activity_date": 1444140668, "last_edit_date": 1444140668, "creation_date": 1444140153, "answer_id": 32972010, "question_id": 32970957, "link": "https://stackoverflow.com/questions/32970957/how-to-share-variables-across-packages-in-go-lang/32972010#32972010", "title": "How to share variables across packages in go-lang", "body": "<p>You can use a config package and when you need to use a config variable then you can send to another struct into different package.</p>\n\n<pre><code>main() {\n    config := config{}\n    user = NewUser(config)\n    ...\n}\n</code></pre>\n\n<p>I recommend to you check the config revel package (<a href=\"https://github.com/revel/config\" rel=\"nofollow\">https://github.com/revel/config</a>). It's used into revel framework <a href=\"https://sourcegraph.com/github.com/revel/revel@master/.tree/config.go\" rel=\"nofollow\">https://github.com/revel/revel</a>.</p>\n"}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2488, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1444140668, "creation_date": 1444137217, "question_id": 32970957, "link": "https://stackoverflow.com/questions/32970957/how-to-share-variables-across-packages-in-go-lang", "title": "How to share variables across packages in go-lang", "body": "<p>I have written a simple go application and formatted it in to several packages.</p>\n\n<pre><code>+main\n+controllers\n+handlers\n+commons\n+utils\n</code></pre>\n\n<p>I'm starting the server in main package and reading server specific parameters at the startup.</p>\n\n<p>I won't to use those parameters, such as DB properties from commons package. I cannot import main package in to commons 'cause commons is a dependency to controllers, handlers which is a dependency to main. So this causes cyclic import.</p>\n\n<p>How should we handle this kind of situation?. Is it possible to read the configuration once and refer to it inside commons package whenever needed? Example would be helpful.</p>\n"}, {"tags": ["go", "slice", "channel"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 11, "creation_date": 1444135500, "post_id": 32970224, "comment_id": 53765386, "body": "No. (nothing else to add, just to meet min length)"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 3, "creation_date": 1444137025, "post_id": 32970224, "comment_id": 53766556, "body": "I have something to add - if you wanted to write a utility function to do that, you&#39;d have to repeat it for any type of channel and data type you have, or use reflection tricks which might make your code cleaner if you&#39;re repeating this often, but will be slow and make your program less predictable."}, {"owner": {"reputation": 2686, "user_id": 1027359, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ede1422479af17fd0456fb376383272f?s=128&d=identicon&r=PG", "display_name": "dotvav", "link": "https://stackoverflow.com/users/1027359/dotvav"}, "edited": false, "score": 2, "creation_date": 1444142976, "post_id": 32970224, "comment_id": 53770991, "body": "OK, thanks for the comments. I don&#39;t understand why the question was downvoted but I&#39;ll deal with it =)"}], "answers": [{"tags": [], "owner": {"reputation": 1280, "user_id": 4932403, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uLzID.jpg?s=128&g=1", "display_name": "KeylorSanchez", "link": "https://stackoverflow.com/users/4932403/keylorsanchez"}, "is_accepted": false, "score": 0, "last_activity_date": 1444403519, "last_edit_date": 1444403519, "creation_date": 1444401928, "answer_id": 33041176, "question_id": 32970224, "link": "https://stackoverflow.com/questions/32970224/add-all-the-items-of-a-slice-into-a-channel/33041176#33041176", "title": "Add all the items of a slice into a channel", "body": "<p>You can declare a chan of string arrays, unless you absolutely want to keep a chan of strings : </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    ch := make(chan []string)\n    values := []string{\"lol\", \"cat\", \"lolcat\"}\n\n    go func() {\n            ch &lt;- values\n    }()\n\n    fmt.Printf(\"Values : %+v\\n\", &lt;-ch)\n}\n</code></pre>\n"}], "owner": {"reputation": 2686, "user_id": 1027359, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ede1422479af17fd0456fb376383272f?s=128&d=identicon&r=PG", "display_name": "dotvav", "link": "https://stackoverflow.com/users/1027359/dotvav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 704, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1444403519, "creation_date": 1444135207, "question_id": 32970224, "link": "https://stackoverflow.com/questions/32970224/add-all-the-items-of-a-slice-into-a-channel", "title": "Add all the items of a slice into a channel", "body": "<p>Is there, in Go, a more idiomatic way to add all the elements of an array/slice into a channel than the following?</p>\n\n<pre><code>ch := make(chan string)\nvalues := []string {\"lol\", \"cat\", \"lolcat\"}\n\ngo func() {\n    for _,v := range values {\n        ch &lt;- v\n    }\n}()\n</code></pre>\n\n<p>I was looking for something like <code>ch &lt;- values...</code>  (which is rejected by the compiler)</p>\n"}, {"tags": ["dictionary", "go", "hashmap"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1444124145, "post_id": 32966514, "comment_id": 53757722, "body": "Do you by any chance test it on the Go Playground? If so, output on the playground is cached!"}, {"owner": {"reputation": 241, "user_id": 3992906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PA0G5.jpg?s=128&g=1", "display_name": "Aditya Sanghi", "link": "https://stackoverflow.com/users/3992906/aditya-sanghi"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444124319, "post_id": 32966514, "comment_id": 53757840, "body": "This is from golang tour. Nothing in this code is using any of the existing code of the tour."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444124515, "post_id": 32966514, "comment_id": 53757994, "body": "I&#39;m not talking about the origin of the code but about where you run it/test it."}, {"owner": {"reputation": 241, "user_id": 3992906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PA0G5.jpg?s=128&g=1", "display_name": "Aditya Sanghi", "link": "https://stackoverflow.com/users/3992906/aditya-sanghi"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444124585, "post_id": 32966514, "comment_id": 53758053, "body": "I ran it on the golang tour"}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 3992906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PA0G5.jpg?s=128&g=1", "display_name": "Aditya Sanghi", "link": "https://stackoverflow.com/users/3992906/aditya-sanghi"}, "edited": false, "score": 0, "creation_date": 1444126829, "post_id": 32966784, "comment_id": 53759539, "body": "yes that seems to be the case. I ran it on a local compiler and it gives randomised output in all the cases whether I use count = count + 1 or count ++. Thanks a ton!"}, {"owner": {"reputation": 389, "user_id": 3385070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pU0nE.jpg?s=128&g=1", "display_name": "tez", "link": "https://stackoverflow.com/users/3385070/tez"}, "edited": false, "score": 0, "creation_date": 1444229427, "post_id": 32966784, "comment_id": 53815602, "body": "<i>OT</i> Your code looks non-go ideomatic. It could be simplified (e.g. <a href=\"http://play.golang.org/p/E4k2BxQWMV\" rel=\"nofollow noreferrer\">play.golang.org/p/E4k2BxQWMV</a>)"}, {"owner": {"reputation": 991, "user_id": 1061927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc0ad4a66f66d793ea39a35ddacbcb45?s=128&d=identicon&r=PG", "display_name": "Dynom", "link": "https://stackoverflow.com/users/1061927/dynom"}, "edited": false, "score": 0, "creation_date": 1554800095, "post_id": 32966784, "comment_id": 97874542, "body": "As of 1.12, maps are sorted when <i>printed</i> using fmt&#39;s printing functions. They remain (deliberately) unsorted when accessed otherwise -- <a href=\"https://tip.golang.org/doc/go1.12#fmt\" rel=\"nofollow noreferrer\">tip.golang.org/doc/go1.12#fmt</a> and <a href=\"https://github.com/golang/go/issues/21095\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/21095</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1554802469, "last_edit_date": 1554802469, "creation_date": 1444124744, "answer_id": 32966784, "question_id": 32966514, "link": "https://stackoverflow.com/questions/32966514/why-does-count-instead-of-count-count-1-change-the-way-the-map-is-return/32966784#32966784", "title": "Why does count++ (instead of count = count + 1) change the way the map is returned in Golang", "body": "<p>The way how you change the value of the <code>count</code> variable has nothing to do with the iteration order of the map elements.</p>\n\n<p>There is no \"correct\" iteration order, the iteration order can be thought of as random (and in current implementation it <em>is</em> random). Quoting from the <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">language spec: For statements</a>:</p>\n\n<blockquote>\n  <p>The iteration order over maps is not specified and is not guaranteed to be the same from one iteration to the next.</p>\n</blockquote>\n\n<p>For more on the topic, check out this answer: <a href=\"https://stackoverflow.com/a/28931555/1705598\">Why can't Go iterate maps in insertion order?</a></p>\n\n<p><a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">The Go Tour</a> uses the <a href=\"http://play.golang.org/\" rel=\"nofollow noreferrer\">Go Playground</a> to provide a code editor and runner. The Go Playground caches the output of the codes you run on it. Running twice the exact same code will just show you the cached output.</p>\n\n<p>If you change your code however, that is \"treated\" as new code and it will be compiled and ran (and its output will be cached after). And since it is run anew, you may observe a new random order - which you do.</p>\n\n<p>If you change again something in the code, even as insignificant as adding or changing some comment, the output will (may) change again, try it.</p>\n\n<p>For more information on how the Playground is implemented, see blog post <strong><a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">Inside the Go Playground</a></strong>.</p>\n\n<p>Quoting the relevant part:</p>\n\n<blockquote>\n  <p>When the front end receives a compilation request it first checks <a href=\"https://developers.google.com/appengine/docs/memcache/\" rel=\"nofollow noreferrer\">memcache</a> to see if it has cached the results of a previous compilation of that source. <strong>If found, it returns the cached response.</strong> The cache prevents popular programs such as those on the <a href=\"http://golang.org/\" rel=\"nofollow noreferrer\">Go home page</a> from overloading the back ends. If there is no cached response, the front end makes an RPC request to the back end, stores the response in memcache, parses the playback events, and returns a JSON object to the client as the HTTP response (as described above).</p>\n</blockquote>\n\n<p>Also note that starting with <a href=\"https://golang.org/doc/go1.12#fmt\" rel=\"nofollow noreferrer\">Go 1.12</a>, maps are sorted when printed using the <code>fmt</code> package (to ease testing), so printing the same map now will always list elements in the same order. The iteration order still remains non-deterministic deliberately.</p>\n"}], "owner": {"reputation": 241, "user_id": 3992906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PA0G5.jpg?s=128&g=1", "display_name": "Aditya Sanghi", "link": "https://stackoverflow.com/users/3992906/aditya-sanghi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 1, "accepted_answer_id": 32966784, "answer_count": 1, "score": 3, "last_activity_date": 1554802514, "creation_date": 1444124052, "last_edit_date": 1554802514, "question_id": 32966514, "link": "https://stackoverflow.com/questions/32966514/why-does-count-instead-of-count-count-1-change-the-way-the-map-is-return", "title": "Why does count++ (instead of count = count + 1) change the way the map is returned in Golang", "body": "<p>I used a map that uses words from a sentence as its keys and integers as the values. </p>\n\n<pre><code>func WordCount(s string) map[string]int {\n    var m map[string]int\n    m = make(map[string]int)\n    var substrings[]string\n    count := 0\n    substrings = strings.Split(s, \" \")\n    for i := range substrings {\n        count = count + 1\n        m[substrings[i]] = count\n    }\n\n    return m\n}\n\nfunc main() {   \n    fmt.Println(WordCount(\"I am learning GO since some days\"))\n}\n</code></pre>\n\n<p>The above code <strong>ALWAYS</strong> displays the map in the correct order, i.e. </p>\n\n<pre><code>map[I:1 am:2 learning:3 GO:4 since:5 some:6 days:7]\n</code></pre>\n\n<p>But if I change </p>\n\n<pre><code>count = count + 1\n</code></pre>\n\n<p>to</p>\n\n<pre><code>count++\n</code></pre>\n\n<p>The Output changes to:</p>\n\n<pre><code>map[learning:3 GO:4 since:5 some:6 days:7 I:1 am:2]\n</code></pre>\n\n<p>I know that map iteration is random in Golang but why does <code>count = count + 1</code> always cause the map iteration to be returned in an ordered fashion contrary to <code>count++</code>?</p>\n"}, {"tags": ["go", "docker", "virtual-machine", "boot2docker", "fig"], "comments": [{"owner": {"reputation": 125, "user_id": 8428347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e018ea51c8cdc66d808216df41b722?s=128&d=identicon&r=PG&f=1", "display_name": "volkoshkursk", "link": "https://stackoverflow.com/users/8428347/volkoshkursk"}, "edited": false, "score": 0, "creation_date": 1588687097, "post_id": 32963846, "comment_id": 108989704, "body": "I&#39;ve the same error on <code>docker run hello-world</code>. <code>docker -v</code> shows <code>Docker version 18.09.7, build 2d0083d</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 1506990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55791a24f0ab5f5815c4db25d76c56?s=128&d=identicon&r=PG", "display_name": "Vovochka", "link": "https://stackoverflow.com/users/1506990/vovochka"}, "edited": false, "score": 1, "creation_date": 1444116813, "post_id": 32964066, "comment_id": 53753104, "body": "hi. (1) I tried with the latest version of docker, but I get the same error."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 23, "user_id": 1506990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55791a24f0ab5f5815c4db25d76c56?s=128&d=identicon&r=PG", "display_name": "Vovochka", "link": "https://stackoverflow.com/users/1506990/vovochka"}, "edited": false, "score": 2, "creation_date": 1444117093, "post_id": 32964066, "comment_id": 53753232, "body": "@Vovochka with <code>fig</code> or <code>docker compose</code>? And what is your <code>docker-compose.yml</code> content?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1444116966, "last_edit_date": 1444116966, "creation_date": 1444116250, "answer_id": 32964066, "question_id": 32963846, "link": "https://stackoverflow.com/questions/32963846/docker-returns-json-cannot-unmarshal-string-into-go-value-of-type-string/32964066#32964066", "title": "Docker returns &quot;json: cannot unmarshal string into Go value of type []string&quot;", "body": "<p>First, <a href=\"http://www.fig.sh/\" rel=\"nofollow\"><code>fig</code></a> has long been migrated to <strong><a href=\"https://github.com/docker/compose\" rel=\"nofollow\"><code>docker compose</code></a></strong>.<br>\nSecond, docker 1.6.2 is not the newest release of docker.</p>\n\n<p>So before chasing that bug too much (in light of issues like <a href=\"https://github.com/docker/compose/issues/1638\" rel=\"nofollow\">1638</a>):</p>\n\n<ul>\n<li>update to <code>docker compose</code> and docker 1.8.2</li>\n<li>check your entrypoint in your <code>docker-compose.yml</code>: <a href=\"https://github.com/andreagrandi/postgresql-docker/pull/2\" rel=\"nofollow\"><code>true</code> should be <code>/bin/true</code></a> for instance.</li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 1506990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55791a24f0ab5f5815c4db25d76c56?s=128&d=identicon&r=PG", "display_name": "Vovochka", "link": "https://stackoverflow.com/users/1506990/vovochka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3851, "favorite_count": 1, "accepted_answer_id": 32964066, "answer_count": 1, "score": 2, "last_activity_date": 1444116966, "creation_date": 1444115479, "last_edit_date": 1444115667, "question_id": 32963846, "link": "https://stackoverflow.com/questions/32963846/docker-returns-json-cannot-unmarshal-string-into-go-value-of-type-string", "title": "Docker returns &quot;json: cannot unmarshal string into Go value of type []string&quot;", "body": "<p>I'm new to docker. I tried to launch an image with:</p>\n\n<pre><code>fig up -d --allow-insecure-ssl\n</code></pre>\n\n<p>But I get the following error message:</p>\n\n<pre><code>json: cannot unmarshal string into Go value of type []string\n</code></pre>\n\n<p>And I can't figure out how to fix it.</p>\n\n<p>My <code>fig.yml</code>:</p>\n\n<pre><code>configrepo:\n  image: docker-registry.backbasecloud.com/backbase/engage-configuration:latest\n  environment:\n    - SERVICE_NAME=configuration\n  ports:\n      - \"8788:8080\"\n\nconfigserver:\n  image: docker-registry.backbasecloud.com/backbase/engage-configserver:latest\n  environment:\n    SERVICE_NAME: configserver\n  ports:\n    - \"8888:8888\"\n  links:\n    - configrepo:configrepo\n  dns: 172.17.42.1\n</code></pre>\n\n<p>docker version</p>\n\n<pre><code>Client version: 1.6.2\nClient API version: 1.18\nGo version (client): go1.4.2\nGit commit (client): 7c8fca2\nOS/Arch (client): darwin/amd64\nServer version: 1.8.2\nServer API version: 1.20\nGo version (server): go1.4.2\nGit commit (server): 0a8c2e3\nOS/Arch (server): linux/amd64\n</code></pre>\n\n<p>fig --version</p>\n\n<pre><code>fig 1.0.1\n</code></pre>\n\n<p>Any ideas why I'm getting this error?</p>\n"}, {"tags": ["algorithm", "graph", "go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1444113780, "post_id": 32962987, "comment_id": 53751449, "body": "Your definition for <code>areConnected</code> will possibly change every time you call it.  How can you determine the cliques of a graph if the edges of your graph randomly appear and disappear every time you try to check if an edge exists?  You should use randomness to generate a graph up front for your test case, but then your algorithm, and determining whether two vertices are connected, should be deterministic."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1444114757, "post_id": 32962987, "comment_id": 53751967, "body": "@AmitKumarGupta I fixed <code>areConnected</code> function above, thank you"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1444115111, "post_id": 32962987, "comment_id": 53752178, "body": "What is the point of the <code>maximumNumberOfVerticesForSubGraph</code> argument?  In your problem description, you don&#39;t say anything about this, you simply say &quot;each clique in the result must be as large as possible&quot;."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1444115337, "post_id": 32962987, "comment_id": 53752316, "body": "@AmitKumarGupta resulting cliques must be not bigger than <code>maximumNumberOfVerticesForSubGraph int</code> value"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1444115354, "post_id": 32962987, "comment_id": 53752324, "body": "Actually, what does it mean when you say &quot;each clique in the result must be as large as possible&quot; but also &quot;each input vertex must be only in one resulting Clique.&quot;  Suppose you have a graph that&#39;s a chain of three vertices: ` X----X----X`.  There are two maximal cliques, but they are overlapping (both share the middle vertex)."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1444115647, "post_id": 32962987, "comment_id": 53752449, "body": "@AmitKumarGupta in this case the algorithm must return 2 cliques: X----X, X. The first has 2 vertecies. The second is only one vertex. Each clique in the result must be as large as possible as long as each input vertex is only in one resulting Clique."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1444118690, "post_id": 32962987, "comment_id": 53754175, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/91455/discussion-between-amit-kumar-gupta-and-maxim-yefremov\">continue this discussion in chat</a>."}, {"owner": {"reputation": 51837, "user_id": 2144669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7393f439028063515255b63ed94cfd?s=128&d=identicon&r=PG", "display_name": "David Eisenstat", "link": "https://stackoverflow.com/users/2144669/david-eisenstat"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1444133843, "post_id": 32962987, "comment_id": 53764165, "body": "@AmitKumarGupta It&#39;s most likely a homework assignment. <code>O(n^2)</code> isn&#39;t really enough time to do anything but greedily grab a maximal clique and repeat."}], "answers": [{"tags": [], "owner": {"reputation": 47344, "user_id": 47984, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d3149cf105b708746f1c4eb0a63a5c24?s=128&d=identicon&r=PG", "display_name": "j_random_hacker", "link": "https://stackoverflow.com/users/47984/j-random-hacker"}, "is_accepted": false, "score": 1, "last_activity_date": 1444169448, "creation_date": 1444169448, "answer_id": 32980665, "question_id": 32962987, "link": "https://stackoverflow.com/questions/32962987/find-cliques-in-a-graph-using-golang/32980665#32980665", "title": "find Cliques in a graph using golang", "body": "<p>O(n^2) isn't enough time to enumerate all possible cliques in a graph, even if we (incredibly optimistically) assume O(1) processing time per clique.  Consider an n-vertex graph consisting of n/3 disjoint triangles -- that is, n/3 sets of 3 vertices, with each vertex having edges to the other 2 vertices in its group and to no other vertices.  Notice that you can independently choose a single vertex from each of the n/3 triangles to get an independent set (a set of n/3 vertices, no two of which are connected by an edge).  Now invert all edges in this graph: this gives a graph in which the same choice of vertices now gives a clique of size n/3.  There are 3^(n/3) cliques of this size, all of which are maximal (cannot have any vertices added to them and remain cliques).  3^(n/3) is <em>much</em> larger than n^2, so you cannot hope to even list all these cliques in O(n^2) time.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444169448, "creation_date": 1444112276, "last_edit_date": 1592644375, "question_id": 32962987, "link": "https://stackoverflow.com/questions/32962987/find-cliques-in-a-graph-using-golang", "title": "find Cliques in a graph using golang", "body": "<p>I am trying to write an algorithm which will find all <a href=\"https://en.wikipedia.org/wiki/Clique_(graph_theory)\" rel=\"nofollow noreferrer\">Cliques (complete subgraphs)</a> in a graph. Each input vertex must be only in one resulting Clique. The algorithm must have <code>O(N^2)</code> time complexity. Each clique in the result must be as big as possible.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\ntype Vertex struct {\n    Value int\n}\n\ntype CompleteSubGraph struct {\n    vertecies []Vertex\n}\n\nfunc areConnected(vertex1, vertex2 Vertex) bool {\n    // 2 verteces are connected if their value sum is even\n    return (vertex1.Value+vertex2.Value)%2 == 0\n}\n\nfunc (vertex1 Vertex) getConnectedVertices(vertices []Vertex, maxVertices int) (verticesConnectedWithVertex1 []Vertex) {\n    for _, vertex2 := range vertices {\n        if areConnected(vertex1, vertex2) {\n            verticesConnectedWithVertex1 = append(verticesConnectedWithVertex1, vertex2)\n        }\n        if len(verticesConnectedWithVertex1) &gt;= maxVertices {\n            break\n        }\n    }\n    return\n}\n\nfunc findAllCompleteSubGraphs(\n    vertices []Vertex,\n    maximumNumberOfVerticesForSubGraph int,\n) (allCompleteSubgraphs []*CompleteSubGraph) {\n    /*\n       every vertex from input vertices\n       must be only in one CompleteSubGraph\n\n       the Algorithm must work not slower than O(N^2)\n       where N is len(vertices)\n\n       each vertex from input vertices must be only in one\n       resulting CompleteSubGraph\n\n       each CompleteSubGraph must be as big as possible\n    */\n    for _, vertex1 := range vertices {\n        connectedToVertex1 := vertex1.getConnectedVertices(vertices,\n            maximumNumberOfVerticesForSubGraph)\n        fmt.Println(&quot;vertex&quot;, vertex1)\n        fmt.Println(&quot;is connected to&quot;, connectedToVertex1)\n    }\n    return\n}\n\nfunc main() {\n    vertices := []Vertex{\n        Vertex{Value: 1}, Vertex{Value: 2}, Vertex{Value: 3},\n        Vertex{Value: 4}, Vertex{Value: 5}, Vertex{Value: 6},\n        Vertex{Value: 7}, Vertex{Value: 8}, Vertex{Value: 9},\n        Vertex{Value: 10}, Vertex{Value: 11}, Vertex{Value: 12},\n    }\n    fmt.Println(&quot;result&quot;, findAllCompleteSubGraphs(vertices, 3))\n}\n</code></pre>\n<p>I am checking if 2 vertecies are connected by an edge using <code>areConnected</code> function. It's simple just for example but will be more complicated in real life.</p>\n<p>I have to use <code>func (vertex1 Vertex) getConnectedVertices</code> as it is defined now.\nI stuck on the cycle</p>\n<pre><code>        for _, vertex1 := range vertices {\n            connectedToVertex1 := vertex1.getConnectedVertices(vertices,\n                maximumNumberOfVerticesForSubGraph)\n            fmt.Println(&quot;vertex&quot;, vertex1)\n            fmt.Println(&quot;is connected to&quot;, connectedToVertex1)\n        }\n</code></pre>\n<p>Can hardly imagine how to finish the algorithm. Will appriciate any advise.</p>\n<p><a href=\"http://play.golang.org/p/oDLQAxQFbI\" rel=\"nofollow noreferrer\">Playground</a></p>\n<h1>Update</h1>\n<p>The original problem which I am trying to solve:\nFind groups of people who fit each other by some characteristics. <code>AreConnected</code> is true when <code>person1</code> likes <code>person2</code> and <code>person2</code> likes <code>person1</code>. The task is to create groups of people with maximum size by a list of people. It is believed that big groups are better than small groups.</p>\n"}, {"tags": ["go", "tree", "iteration", "directory-structure"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1444112378, "last_edit_date": 1444112378, "creation_date": 1444110357, "answer_id": 32962550, "question_id": 32962128, "link": "https://stackoverflow.com/questions/32962128/create-iterative-json-directory-tree-golang/32962550#32962550", "title": "Create iterative JSON directory tree - Golang", "body": "<p>The main problem is that structs are not descriptor values like slices or maps, that is if you assign a struct value to a variable, it will be copied. If you assign a struct value to an element of a slice or array, the slice will be copied. They will not be linked!</p>\n\n<p>So when you add your <code>rootFile</code> to <code>stack</code>, and then you pop an element from the <code>stack</code> (which will be equal to <code>rootFile</code>) and you modify the popped element, you will not observe the changes in your local variable <code>rootFile</code>.</p>\n\n<p>Solution is simple: use pointers to structs.</p>\n\n<p>You also have a mistake in your code:</p>\n\n<pre><code>child = (toFile(children[i], path+\"/\"+children[i].Name())) //turn it into a File object\n</code></pre>\n\n<p>It should be:</p>\n\n<pre><code>child = (toFile(children[i], file.Path+\"/\"+children[i].Name())) // ...\n</code></pre>\n\n<h3>Tips to improve your code:</h3>\n\n<p>I would rather use <a href=\"https://golang.org/pkg/path/#Join\" rel=\"nofollow\"><code>path.Join()</code></a> or <a href=\"https://golang.org/pkg/path/filepath/#Join\" rel=\"nofollow\"><code>filepath.Join()</code></a> to join path elements:</p>\n\n<pre><code>child = toFile(children[i], filepath.Join(file.Path, children[i].Name()))\n</code></pre>\n\n<p>Your code might not even work if the initial path ends with a slash or backslash and you explicitly concatenate it with another slash. <code>Join()</code> will take care of these so you don't have to.</p>\n\n<p>Don't declare all local variables ahead in the beginning of your function, only when you need them, and in the most inner block you need them. This will ensure you don't accidentally assign to the wrong variable, and you will know it is not modified outside of the innermost block (because outside of it it is not in scope) - this helps understanding your code much easier. You may also use <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">short variable declaration</a>.</p>\n\n<p>Make use of the <code>for ... range</code> construct, much cleaner. For example:</p>\n\n<pre><code>for _, chld := range children {\n    child := toFile(chld, filepath.Join(file.Path, chld.Name()))\n    file.Children = append(file.Children, child)\n    stack = append(stack, child)\n}\n</code></pre>\n\n<p>Also make use of <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow\">zero values</a>, for example if a file is not a link, you don't need to set the <code>IsLink</code> and <code>LinksTo</code> fields as the zero values are <code>false</code> and <code>\"\"</code> which is what you would end up with.</p>\n\n<p>And although it may not be important here, but always handle errors, print or log them as a minimum so you won't end up wasting time figuring out what is wrong if something is not what you expect (you will end up searching bugs in your code, and hours later you finally add print errors and see the bug wasn't in your code but somewhere else).</p>\n\n<h3>Working variant using pointers and tips mentioned above</h3>\n\n<pre><code>type File struct {\n    ModifiedTime time.Time `json:\"ModifiedTime\"`\n    IsLink       bool      `json:\"IsLink\"`\n    IsDir        bool      `json:\"IsDir\"`\n    LinksTo      string    `json:\"LinksTo\"`\n    Size         int64     `json:\"Size\"`\n    Name         string    `json:\"Name\"`\n    Path         string    `json:\"Path\"`\n    Children     []*File   `json:\"Children\"`\n}\n\nfunc iterateJSON(path string) {\n    rootOSFile, _ := os.Stat(path)\n    rootFile := toFile(rootOSFile, path) //start with root file\n    stack := []*File{rootFile}\n\n    for len(stack) &gt; 0 { //until stack is empty,\n        file := stack[len(stack)-1] //pop entry from stack\n        stack = stack[:len(stack)-1]\n        children, _ := ioutil.ReadDir(file.Path) //get the children of entry\n        for _, chld := range children {          //for each child\n            child := toFile(chld, filepath.Join(file.Path, chld.Name())) //turn it into a File object\n            file.Children = append(file.Children, child)                 //append it to the children of the current file popped\n            stack = append(stack, child)                                 //append the child to the stack, so the same process can be run again\n        }\n    }\n\n    output, _ := json.MarshalIndent(rootFile, \"\", \"     \")\n    fmt.Println(string(output))\n}\n\nfunc toFile(file os.FileInfo, path string) *File {\n    JSONFile := File{ModifiedTime: file.ModTime(),\n        IsDir:    file.IsDir(),\n        Size:     file.Size(),\n        Name:     file.Name(),\n        Path:     path,\n        Children: []*File{},\n    }\n    if file.Mode()&amp;os.ModeSymlink == os.ModeSymlink {\n        JSONFile.IsLink = true\n        JSONFile.LinksTo, _ = filepath.EvalSymlinks(filepath.Join(path, file.Name()))\n    } // Else case is the zero values of the fields\n    return &amp;JSONFile\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5412450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c6a47a9fd73e946f72a445d2e8cc91?s=128&d=identicon&r=PG&f=1", "display_name": "andy murray", "link": "https://stackoverflow.com/users/5412450/andy-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1583, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1444112378, "creation_date": 1444108130, "question_id": 32962128, "link": "https://stackoverflow.com/questions/32962128/create-iterative-json-directory-tree-golang", "title": "Create iterative JSON directory tree - Golang", "body": "<p>I'm having trouble creating an iterative version of a program I wrote recursively in GoLang. The goal is to take a directory path and return a JSON tree that contains file information from that directory and preserves the directory structure. Here is what I have so far:</p>\n\n<p>I've created a File struct that will contain the information of each entry in the directory tree:</p>\n\n<pre><code>type File struct {\n    ModifiedTime time.Time `json:\"ModifiedTime\"`\n    IsLink       bool      `json:\"IsLink\"`\n    IsDir        bool      `json:\"IsDir\"`\n    LinksTo      string    `json:\"LinksTo\"`\n    Size         int64     `json:\"Size\"`\n    Name         string    `json:\"Name\"`\n    Path         string    `json:\"Path\"`\n    Children     []File    `json:\"Children\"`\n}\n</code></pre>\n\n<p>In my iterative program, I create a stack to simulate the recursive calls.</p>\n\n<pre><code>func iterateJSON(path string) {\n    var stack []File\n    var child File\n    var file File\n    rootOSFile, _ := os.Stat(path)\n    rootFile := toFile(rootOSFile, path) //start with root file\n    stack = append(stack, rootFile) //append root to stack \n    for len(stack) &gt; 0 { //until stack is empty,\n        file = stack[len(stack)-1] //pop entry from stack\n        stack = stack[:len(stack)-1] \n        children, _ := ioutil.ReadDir(file.Path) //get the children of entry \n        for i := 0; i &lt; len(children); i++ { //for each child\n            child = (toFile(children[i], path+\"/\"+children[i].Name())) //turn it into a File object\n            file.Children = append(file.Children, child) //append it to the children of the current file popped\n            stack = append(stack, child) //append the child to the stack, so the same process can be run again\n        }\n    }\n    rootFile.Children\n    output, _ := json.MarshalIndent(rootFile, \"\", \"     \")\n    fmt.Println(string(output))\n}\n\nfunc toFile(file os.FileInfo, path string) File {\n    var isLink bool\n    var linksTo string\n    if file.Mode()&amp;os.ModeSymlink == os.ModeSymlink {\n        isLink = true\n        linksTo, _ = filepath.EvalSymlinks(path + \"/\" + file.Name())\n    } else {\n        isLink = false\n        linksTo = \"\"\n    }\n    JSONFile := File{ModifiedTime: file.ModTime(),\n        IsDir:    file.IsDir(),\n        IsLink:   isLink,\n        LinksTo:  linksTo,\n        Size:     file.Size(),\n        Name:     file.Name(),\n        Path:     path,\n        Children: []File{}}\n    return JSONFile\n}\n</code></pre>\n\n<p>Theoretically, the child files should be appended to the root file as we move through the stack. However, the only thing that is returned is the root file (without any children appended). Any idea as to why this is happening?</p>\n"}, {"tags": ["macos", "bash", "go", "grafana"], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 563436, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5cdd622fbbd01cdd762adb2091a483bc?s=128&d=identicon&r=PG", "display_name": "karthik339", "link": "https://stackoverflow.com/users/563436/karthik339"}, "edited": false, "score": 0, "creation_date": 1444111347, "post_id": 32962144, "comment_id": 53750302, "body": "Thanks a TwilightSun and Daniel. You were right. It should be the directory name and not the executable. This resolved my issue."}], "tags": [], "owner": {"reputation": 2103, "user_id": 1579514, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2923ce20502cd5542c02d5534e959457?s=128&d=identicon&r=PG&f=1", "display_name": "TwilightSun", "link": "https://stackoverflow.com/users/1579514/twilightsun"}, "is_accepted": false, "score": 2, "last_activity_date": 1444108652, "last_edit_date": 1444108652, "creation_date": 1444108170, "answer_id": 32962144, "question_id": 32962085, "link": "https://stackoverflow.com/questions/32962085/executable-not-searching-from-path-variable/32962144#32962144", "title": "Executable not searching from PATH variable", "body": "<p>Shouldn't <code>/usr/local/go/bin/go</code> be <code>/usr/local/go/bin</code>?\nThe items in the PATH variable should be directories containing executables, not the executables themselves.</p>\n"}], "owner": {"reputation": 169, "user_id": 563436, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5cdd622fbbd01cdd762adb2091a483bc?s=128&d=identicon&r=PG", "display_name": "karthik339", "link": "https://stackoverflow.com/users/563436/karthik339"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1444108652, "creation_date": 1444107842, "question_id": 32962085, "link": "https://stackoverflow.com/questions/32962085/executable-not-searching-from-path-variable", "title": "Executable not searching from PATH variable", "body": "<p>I am trying to build grafana on my MAC. I installed the go binary and updated the PATH variable.Below is the output of bash</p>\n\n<p><code>bash-3.2$ echo $PATH\n/Users/kartl/Projects/mongodb/bin/:/usr/local/go/bin/go:/usr/local/sbin:/Users/kartl/.npm-packages/bin:/Users/kartl/Projects/mongodb/bin/:/usr/local/sbin:/Users/kartl/.npm-packages/bin:/Users/kartl/Projects/mongodb/bin/:/usr/local/sbin:/Users/kartl/.npm-packages/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/usr/local/git/bin:/usr/local/bin/jamf</code></p>\n\n<p>But when I am trying to run some go command for installation, I get below errors.</p>\n\n<pre><code>/Users/kartl/Projects/grafana/bin/godep  restore \ngodep: restore: exec: \"go\": executable file not found in $PATH\ngodep: restore: exec: \"go\": executable file not found in $PATH\ngodep: restore: exec: \"go\": executable file not found in $PATH\n</code></pre>\n\n<p>Can someone help me as why is this happening ? </p>\n"}, {"tags": ["c++", "c", "go", "cgo"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2475269"}, "edited": false, "score": 0, "creation_date": 1444100482, "post_id": 32961017, "comment_id": 53747040, "body": "Hm, ok even if i <code>export &quot;C&quot; ... bool SteamCAPI_Init ... }</code> ? Because that&#39;s what I&#39;m doing, figured it wouldnt mangle names. If yes, any way to not mangle them so the go compiler can retreive the name by just <code>SteamCAPI_Init</code> ?"}, {"owner": {"reputation": 3280, "user_id": 950983, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g9v2I.jpg?s=128&g=1", "display_name": "Krypton", "link": "https://stackoverflow.com/users/950983/krypton"}, "edited": false, "score": 0, "creation_date": 1444100894, "post_id": 32961017, "comment_id": 53747140, "body": "export &quot;C&quot; is meant for C to know that the function is C++, it does not affect the compilation."}, {"owner": {"reputation": 3280, "user_id": 950983, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g9v2I.jpg?s=128&g=1", "display_name": "Krypton", "link": "https://stackoverflow.com/users/950983/krypton"}, "edited": false, "score": 0, "creation_date": 1444100981, "post_id": 32961017, "comment_id": 53747161, "body": "if you want the symbol to be <code>SteamCAPI_Init</code>, you need to create a C wrapper for <code>__Z14SteamCAPI_Initv</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2475269"}, "edited": false, "score": 0, "creation_date": 1444101065, "post_id": 32961017, "comment_id": 53747178, "body": "So <code>SteamAPI_Init</code> is a C++ function, then i need to make <code>SteamCAPI_Init</code>, a wrapper around <code>SteamCAPI_Init</code> and then another C wrapper around <code>SteamCAPI_init</code>,. surelly im missing something :\\ My goal was that <code>SteamCAPI_Init</code> was the wrapper"}, {"owner": {"reputation": 3280, "user_id": 950983, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g9v2I.jpg?s=128&g=1", "display_name": "Krypton", "link": "https://stackoverflow.com/users/950983/krypton"}, "edited": false, "score": 0, "creation_date": 1444101259, "post_id": 32961017, "comment_id": 53747226, "body": "I just say a possible way if you insist to have non-mangled symbol name. Normally we don&#39;t need to care about the that. As long as the function is declared with export &quot;C&quot; in the header, it should be able to be called by both C and C++. Not sure why you want the symbol name not to be mangled though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2475269"}, "edited": false, "score": 0, "creation_date": 1444101343, "post_id": 32961017, "comment_id": 53747239, "body": "Well I&#39;m trying to have it be called by a Golang program and it doesnt seem to like mangled names, so I&#39;m trying to see my alternatives."}, {"owner": {"reputation": 3280, "user_id": 950983, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g9v2I.jpg?s=128&g=1", "display_name": "Krypton", "link": "https://stackoverflow.com/users/950983/krypton"}, "edited": false, "score": 0, "creation_date": 1444101399, "post_id": 32961017, "comment_id": 53747254, "body": "I see, so probably you need to create a C wrapper then."}], "tags": [], "owner": {"reputation": 3280, "user_id": 950983, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g9v2I.jpg?s=128&g=1", "display_name": "Krypton", "link": "https://stackoverflow.com/users/950983/krypton"}, "is_accepted": true, "score": 1, "last_activity_date": 1444102418, "last_edit_date": 1444102418, "creation_date": 1444100388, "answer_id": 32961017, "question_id": 32960554, "link": "https://stackoverflow.com/questions/32960554/missing-symbols-from-a-dylib/32961017#32961017", "title": "Missing symbols from a dylib", "body": "<p>Firstly, <code>dyld_stub_binder</code> is the default generated symbol when you compile C++. You don't need to care about it.</p>\n\n<p>Secondly, <code>__Z14SteamCAPI_Initv</code> is actually the right symbol. Since C++ supports overloading, C++ functions are compiled with mangled symbol names, so that the functions name won't clash with each other. For example, you got two functions <code>void do_something(int a)</code> and <code>void do_something(int a, int b)</code>, if the function names are not mangled, how would the linker resolve symbol names.</p>\n\n<p>Info about C++ name mangling can be found <a href=\"https://en.wikipedia.org/wiki/Name_mangling\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2475269"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 32961017, "answer_count": 1, "score": 1, "last_activity_date": 1444102418, "creation_date": 1444096733, "last_edit_date": 1444101621, "question_id": 32960554, "link": "https://stackoverflow.com/questions/32960554/missing-symbols-from-a-dylib", "title": "Missing symbols from a dylib", "body": "<p>I'm trying to make a C api around a C++ library, so that I can later wrap it in Golang. I started by simply generating a dylib with one function so that I have a reference to look at. Then I made a wrapper around the actual library I wanted to use. When I generated all the symbols from the simple dylib i got this:</p>\n\n<pre><code>MacbookMainframe:c hydroflame$ nm -a clib/libxyz.dylib \n0000000000000f90 T _Hello\n                 U dyld_stub_binder\n</code></pre>\n\n<p>and I only declared a single function named <code>Hello</code>, so far so good</p>\n\n<p>When I did what i thought was equivalent for the actual library, the go wrapper wouldn't compile and the symbols generated where</p>\n\n<pre><code>MacbookMainframe:c hydroflame$ nm -a ../luxengine.net/steamc/libsteam.dylib \n                 U _SteamAPI_Init\n0000000000000f60 T __Z14SteamCAPI_Initv\n                 U dyld_stub_binder\n</code></pre>\n\n<p>The symbol I was expecting was <code>_SteamCAPI_Init</code> (with the underscore because apparently <code>Hello</code> generated <code>_Hello</code> but instead i get something weirdish. </p>\n\n<p>Is my compilation wrong, or is that the normal symbol that should be generated ?</p>\n\n<p>The source files are available here (theres only like 30 important lines):<br>\n<a href=\"https://github.com/luxengine/steam\" rel=\"nofollow\">https://github.com/luxengine/steam</a><br>\n<a href=\"https://github.com/luxengine/steamc\" rel=\"nofollow\">https://github.com/luxengine/steamc</a>  </p>\n\n<p>EDIT (for future readers):</p>\n\n<p>my problem at the time of writing was that my header file declaration had the <code>extern \"C\" {</code> but my source file did not, so gcc would mangle the names anyway and cgo wouldn't find it.</p>\n\n<pre><code>MacbookMainframe:steamc hydroflame$ nm -a libsteam.dylib \n                 U _SteamAPI_Init\n0000000000000f60 T _SteamCAPI_Init\n                 U dyld_stub_binder\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 1, "creation_date": 1444096326, "post_id": 32960461, "comment_id": 53746046, "body": "If you add or change slice2 but slice3 doesn&#39;t change, you have a copy."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1444136568, "post_id": 32960461, "comment_id": 53766258, "body": "I think you&#39;ve made this a lot more complicated than it needs to be. If you know how slices work, this all seems very straightforward: <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 1, "creation_date": 1444142619, "post_id": 32960461, "comment_id": 53770732, "body": "Oh, I think I finally get what you&#39;re asking. How do you know if <code>append</code> simply appended into a slice that had the capacity or returned a new slice when the original didn&#39;t have the space. For that, I&#39;d simply say don&#39;t put yourself in a place where it&#39;d matter."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444167911, "post_id": 32960461, "comment_id": 53786090, "body": "I find this question confusing. Are you 1. trying to ensure that several slice variables (slice1, slice2) refer to the same, common, underlying storage, so updates through one, update the other, or are you 2. trying to ensure that slice2 who&#39;s values were copied from slice1, <i>never</i> refers to the same underlying storage as slice1, or something else?"}, {"owner": {"reputation": 642, "user_id": 678007, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fe2b8596546a9fb573c49aed3ad3de9?s=128&d=identicon&r=PG", "display_name": "StrayObject", "link": "https://stackoverflow.com/users/678007/strayobject"}, "reply_to_user": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444170990, "post_id": 32960461, "comment_id": 53787286, "body": "@gbulmer Sorry about that, I wrote an answer which I hope clarifies that."}, {"owner": {"reputation": 642, "user_id": 678007, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fe2b8596546a9fb573c49aed3ad3de9?s=128&d=identicon&r=PG", "display_name": "StrayObject", "link": "https://stackoverflow.com/users/678007/strayobject"}, "reply_to_user": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1444171007, "post_id": 32960461, "comment_id": 53787297, "body": "@CoreyOgburn  Yes, that&#39;s it. I found it inconsistent and thought that I&#39;m doing something wrong."}, {"owner": {"reputation": 642, "user_id": 678007, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fe2b8596546a9fb573c49aed3ad3de9?s=128&d=identicon&r=PG", "display_name": "StrayObject", "link": "https://stackoverflow.com/users/678007/strayobject"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1444171014, "post_id": 32960461, "comment_id": 53787302, "body": "@JimB Thank you for that post I&#39;ve found it informative and it actually explained the issue, I still find the inconsistency weird, but I guess it is not &#39;seen&#39; in real code."}], "answers": [{"comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 1, "creation_date": 1444206716, "post_id": 32980864, "comment_id": 53799540, "body": "Ah! So you were puzzled because it looks like their is inconsistent behaviour (two very different behaviours, almost bug-like), purely depending on the initial <i>capacity</i> of a slice. That is a good blog, I&#39;d also recommend <a href=\"http://blog.golang.org/strings\" rel=\"nofollow noreferrer\">Strings, bytes, runes and characters in Go</a>. It isn&#39;t quite as profound as the slices blog, however I was very curious about the relationship between byte slices and strings. Specifically, is a string just a read-only []byte. I&#39;m glad I asked, and you answered, because I thought your question was asking something slightly different."}], "tags": [], "owner": {"reputation": 642, "user_id": 678007, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fe2b8596546a9fb573c49aed3ad3de9?s=128&d=identicon&r=PG", "display_name": "StrayObject", "link": "https://stackoverflow.com/users/678007/strayobject"}, "is_accepted": false, "score": 0, "last_activity_date": 1444170546, "creation_date": 1444170546, "answer_id": 32980864, "question_id": 32960461, "link": "https://stackoverflow.com/questions/32960461/how-to-make-sure-slice-is-using-a-copy-of-another-slice-and-not-a-reference-to-i/32980864#32980864", "title": "How to make sure slice is using a copy of another slice and not a reference to it?", "body": "<p>A few people commented that I was not clear enough last night. So I would like to clarify and provide an answer that I arrived at with the help of  @CoreyOgburn and @JimB</p>\n\n<p>I was learning about slices in GO and I found an inconsistency, that led me to believe I'm doing something wrong. While hardly a real life example I found the following a good example of the copy and append functionality.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"s3 references an array of s1\")\n// we pass a slice of length 2 and capacity 5\n    worker(make([]int, 2, 5))\n    fmt.Println(\"\\ns3 copies an array of s1\")\n// we pass a slice of lenght 2 and capacity 2\n    worker(make([]int, 2))\n}\n\nfunc worker(s1 []int) {\n// create new slice for future use\n    s2 := []int{1, 2, 3}\n    fmt.Println(s1)\n// create a new slice by appending a value to a slice passed into this function \n    s3 := append(s1, 4)\n// s3 holds whatever was passed into this function + int 4, that we just appended\n    fmt.Println(s3)\n// copy contents of s2 onto s1\n    copy(s1, s2)\n// if s1 had spare capacity when it was passed i.e. make([]int, 2, 5) s3 will be referencing the same array as s1, hence s3 will now hold the same values as s1\n// if s1 capacity was the same as its length i.e. make([]int, 2) s3 will be referencing a new array after append(), hence copy has no effect on the values of s3\n    fmt.Println(s3)\n} \n</code></pre>\n\n<p>@JimB posted a comment with a link to a <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">blog post explaining how slices work</a>, which is a great read if you are learning the language.\nWhat is most important in the section <code>A possible \"gotcha\"</code> there is an explanation of a 'fix' to a real life scenario, that can be extrapolated as a fix the inconsistency in my example. (create a copy of a passed slice and use that instead)<br>\n<a href=\"https://play.golang.org/p/_97XT0mDdd\" rel=\"nofollow\">Playground</a></p>\n"}], "owner": {"reputation": 642, "user_id": 678007, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0fe2b8596546a9fb573c49aed3ad3de9?s=128&d=identicon&r=PG", "display_name": "StrayObject", "link": "https://stackoverflow.com/users/678007/strayobject"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444170546, "creation_date": 1444096077, "last_edit_date": 1444131748, "question_id": 32960461, "link": "https://stackoverflow.com/questions/32960461/how-to-make-sure-slice-is-using-a-copy-of-another-slice-and-not-a-reference-to-i", "title": "How to make sure slice is using a copy of another slice and not a reference to it?", "body": "<p>I'm learning GO and I have a theoretical problem.</p>\n\n<p>How do I use a copy of slice rather than a reference to it?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    // slice containing 3 items\n    slice1 := []int{1, 2, 3}\n    // make an empty slice\n    slice2 := make([]int, 2, 5)\n    // create slice3 by appending int 4 to slice2\n    slice3 := append(slice2, 4)\n    // print [0 0 4]\n    fmt.Println(slice3)\n    // copy elements of slice1 onto slice2\n    copy(slice2, slice1)\n    // print [1 2 3] [1 2] [1 2 4]; how to make sure slice3 is using a copy [0 0 4]?\n    fmt.Println(slice1, slice2, slice3)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/oIrmq5vpdK\" rel=\"nofollow\">problem playground link</a></p>\n\n<p>I have came up with a potential solution, but it is pointless as it relies on slice3 being created empty and slice2 being copied via <code>copy()</code> onto slice3. Is there no shortcut?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    // slice containing 3 items\n    slice1 := []int{1, 2, 3}\n    // make an empty slice\n    slice2 := make([]int, 2, 5)\n    // create slice3, copy slice2 and append int 4 to slice3\n    slice3 := make([]int, 2)\n    copy(slice3, slice2)\n    slice3 = append(slice3, 4)\n    // print [0 0 4]\n    fmt.Println(slice3)\n    // copy elements of slice1 onto slice2\n    copy(slice2, slice1)\n    // print [1 2 3] [1 2] [0 0 4];\n    fmt.Println(slice1, slice2, slice3)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/5zKokhchii\" rel=\"nofollow\">solution playground link</a></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I've <a href=\"http://openmymind.net/Controlling-Array-Growth-In-Golang/\" rel=\"nofollow\">read</a> that there is a peculiar behaviour that in this naive example would work as a solution (see below). However, in any other case it would not work.\nBasically, if the empty slice is created without the size of an underlying array being specified, GO's append function provides a copy of that array, otherwise, if there is room to grow, append will return a slice that references the original array.</p>\n\n<p>Note: the only change is <code>slice2 := make([]int, 2, 5)</code> into <code>slice2 := make([]int, 2)</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    // slice containing 3 items\n    slice1 := []int{1, 2, 3}\n    // make an empty slice\n    slice2 := make([]int, 2)\n    // create slice3 by appending int 4 to slice2\n    slice3 := append(slice2, 4)\n    // print [0 0 4]\n    fmt.Println(slice3)\n    // copy elements of slice1 onto slice2\n    copy(slice2, slice1)\n    // print [1 2 3] [1 2] [1 2 4]; how to make sure slice3 is using a copy [0 0 4]?\n    fmt.Println(slice1, slice2, slice3)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/UQ4_JsoG4O\" rel=\"nofollow\">playground with a wanted behaviour</a></p>\n\n<p>So the question becomes: Is it possible to replicate the behaviour of the above, when the slice we are appending to points to an array with specified size and room to grow?</p>\n\n<p><strong>EDIT 2:</strong>\nI think there is some confusion as to what I want to achieve.\nHow to get the result of the second call while passing a slice in the format used in the first call?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"s3 references an array of s1\")\n    worker(make([]int, 2, 5))\n    fmt.Println(\"\\ns3 copies an array of s1\")\n    worker(make([]int, 2))\n}\n\nfunc worker(s1 []int) {\n    s2 := []int{1, 2, 3}\n    fmt.Println(s1)\n    s3 := append(s1, 4)\n    fmt.Println(s3)\n    copy(s1, s2)\n    fmt.Println(s3)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KHpG52qln8\" rel=\"nofollow\">playground</a></p>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1444088770, "post_id": 32959146, "comment_id": 53744168, "body": "&quot;but I know regexp in Go are quite slow&quot; ? <a href=\"https://swtch.com/~rsc/regexp/regexp1.html\" rel=\"nofollow noreferrer\">Not true</a>."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444091130, "post_id": 32959146, "comment_id": 53744774, "body": "&quot;I know regexp in Go are quite slow), I&#39;m avoiding doing more regexp to extract the remaining values&quot; - avoid premature optimisation. 1: it isn&#39;t true, and 2: it may be much quicker to write the program using them. It is much easier to speed-up a slow, correct, program than it is to get a program working correctly. So use the easiest path available to get the program working correctly, then worry about speed. Unless your dump files are humungous <i>and</i> complex, it is likely using regular expressions will not be the bottleneck; I/O may be <i>much</i> slower, and regex will be blazing fast."}, {"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1444092623, "post_id": 32959146, "comment_id": 53745146, "body": "Are all lines of input exactly that format, i.e. is every field the same width, and so the whole line is fixed format, or so some fields vary in width? If it is pretty much fixed, then obviously a regex will work, but maybe a fmt.Fscanf or fmt.Scanf (after reading the line) will be enough."}], "answers": [{"comments": [{"owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1444090653, "post_id": 32959558, "comment_id": 53744644, "body": "Worth pointing out that is that: {&#39;a50&#39;: 15.5, &#39;a95&#39;: 14.5, &#39;a99&#39;: 21.5} is invalid JSON, I would need the strings to be enclosed in double quotes, otherwise the json.UnMarshal throws an invalid character error."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "edited": false, "score": 0, "creation_date": 1444148486, "post_id": 32959558, "comment_id": 53774765, "body": "@jwesonga yeah overlooked that. Gotta run a string replace on that substring before passing it into unmarshal."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1444088968, "last_edit_date": 1444088968, "creation_date": 1444088429, "answer_id": 32959558, "question_id": 32959146, "link": "https://stackoverflow.com/questions/32959146/golang-convert-text-dump-to-csv/32959558#32959558", "title": "Golang: convert text dump to CSV", "body": "<p>I may follow up to this with a code sample as needed and my time allows but here is a basic rundown of how I would approach the problem.</p>\n\n<p>1) create a type like the one below to hold your data;</p>\n\n<pre><code>type line struct {\n     A50 float64 `json:\"a50\"`\n     A95 float64 `json:\"a95\"`\n     A99 float64 `json:\"a99\"`\n}\n</code></pre>\n\n<p>2) read the input line by line</p>\n\n<p>3) for each line use <code>strings.Index</code> to get the index of the first comma</p>\n\n<p>4) pass the second half of the string into json.Unmarshal by subslicing like;</p>\n\n<pre><code>   err := json.Unmarshal([]byte(line[20:]), &amp;MyInstance)\n</code></pre>\n\n<p>5) write the desired output to disk or a buffer using Sprintf like so;</p>\n\n<pre><code>  output := fmt.Sprintf(\"%s, %f, %f, %f\\n\", line[0:20], MyInstance.A50, MyInstance.A95, MyInstance.A99)\n</code></pre>\n\n<p>EDIT: Noticed a small mistake. You're trimming the time part out of the datetime, you can get that by using <code>strings.Index</code> and subslicing again or <code>strings.Split</code> on the <code>-</code> which separates the two tokens.</p>\n\n<p>One other thing I should point out is I didn't include any file processing code. The way you deal with that depends on your needs. For example, if it were a small amount of data I would probably hold all the output in memory and then write it to disk at the end where as, if the data source is large you'll have to do all this in a streaming fashion (meaning each line is processed independent of the rest).</p>\n"}], "owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 568, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1444088968, "creation_date": 1444085546, "question_id": 32959146, "link": "https://stackoverflow.com/questions/32959146/golang-convert-text-dump-to-csv", "title": "Golang: convert text dump to CSV", "body": "<p>I have a txt file dump with data in the following row format:</p>\n\n<pre><code>2015/01/01-01:00:00, {'a50': 15.5, 'a95': 14.5, 'a99': 21.5}\n</code></pre>\n\n<p>I'd like to extract the values and turn it into a CSV in the format of:</p>\n\n<pre><code>2015/01/01, 15.5, 14.5, 21.5\n</code></pre>\n\n<p>So far I can read the file and extract data, I can also get the timestamp values using a regular expression (but I know regexp in Go are quite slow), I'm avoiding doing more regexp to extract the remaining values. Any pointers?</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 745, "user_id": 1823636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dc271a930773cc7ce95dfceedcd83e?s=128&d=identicon&r=PG", "display_name": "sisoft", "link": "https://stackoverflow.com/users/1823636/sisoft"}, "edited": false, "score": 0, "creation_date": 1444051336, "post_id": 32947898, "comment_id": 53724125, "body": "I&#39;m already have almost the same code as noted in question, but place C wrappers in separate *.c file to eliminate double compilation. Thanks anyway.   Will wait for any other solution, I hope that it exists."}, {"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "reply_to_user": {"reputation": 745, "user_id": 1823636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dc271a930773cc7ce95dfceedcd83e?s=128&d=identicon&r=PG", "display_name": "sisoft", "link": "https://stackoverflow.com/users/1823636/sisoft"}, "edited": false, "score": 0, "creation_date": 1445305308, "post_id": 32947898, "comment_id": 54257822, "body": "Were there any other solutions?"}], "tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": false, "score": 3, "last_activity_date": 1444046063, "last_edit_date": 1444046063, "creation_date": 1444045713, "answer_id": 32947898, "question_id": 32947511, "link": "https://stackoverflow.com/questions/32947511/cgo-cant-set-callback-in-c-struct-from-go/32947898#32947898", "title": "Cgo: can&#39;t set callback in C-struct from Go", "body": "<p>That's exactly how you do it, and yes, it is ugly. Don't forget to add the <code>extern void cb_func(void);</code> to your c code.</p>\n\n<p>I ended up with this:</p>\n\n<pre><code>/*\n typedef struct {\n     void (*cb_f)();\n } cb_s;\n\n extern void cb_func(void);\n\n static void cb_set(cb_s *s) {\n     s-&gt;cb_f = &amp;cb_func;\n }\n */\nimport \"C\"\n\n//export cb_func\nfunc cb_func() {}\n\nfunc main() {\n    var x C.cb_s\n    // here I want to set callback cb_f to pointer of cb_func().\n    C.cb_set(&amp;x)\n}\n</code></pre>\n"}], "owner": {"reputation": 745, "user_id": 1823636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dc271a930773cc7ce95dfceedcd83e?s=128&d=identicon&r=PG", "display_name": "sisoft", "link": "https://stackoverflow.com/users/1823636/sisoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1444046063, "creation_date": 1444044553, "question_id": 32947511, "link": "https://stackoverflow.com/questions/32947511/cgo-cant-set-callback-in-c-struct-from-go", "title": "Cgo: can&#39;t set callback in C-struct from Go", "body": "<p>I have a struct in C lib with some callbacks defined inside it. Problem that Go treat this fields as <code>*[0]byte</code> array type and I can't set it to pointer:</p>\n\n<pre><code>./test.go:16: cannot use _Cgo_ptr(_Cfpvar_fp_cb_func) (type unsafe.Pointer) as type *[0]byte in assignment\n</code></pre>\n\n<p>Sample of problem code:</p>\n\n<pre><code>package main\n\n/*\nvoid cb_func();\ntypedef struct cb_s {\n    void (*cb_f)();\n} cb_s;\n*/\nimport \"C\"\n\n//export cb_func\nfunc cb_func() {}\n\nfunc main() {\n        var x C.struct_cb_s\n        // here I want to set callback cb_f to pointer of cb_func().\n        x.cb_f = C.cb_func\n}\n</code></pre>\n\n<p>One possible solution - write a C setter, something like this:</p>\n\n<pre><code>void cb_set(cb_s *s) {\n        s-&gt;cb_f = &amp;cb_func;\n}\n</code></pre>\n\n<p>but it looks ugly: I can't pass cb_func as argument to setter (already tried <code>cb_set(cb_s *s, void(*func)())</code>, but got the same error about *[0]byte) and have many similar callbacks, so need to write setter for each pair of callback - callback function.</p>\n\n<p>Any other solutions?</p>\n"}, {"tags": ["xml", "web-services", "soap", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1444049217, "post_id": 32946927, "comment_id": 53722552, "body": "The <code>encoding&#47;xml</code> standard package supports namespaces natively -- the encoding and decoding rules are explained <a href=\"https://golang.org/pkg/encoding/xml/#Marshal\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow noreferrer\">there</a> in the doc, respectively. The reference manual is a bit dry, so did you try <a href=\"http://stackoverflow.com/search?q=%5Bgo%5D+xml+namespace\">searching</a>? In particular, <a href=\"http://stackoverflow.com/q/10812294/720999\">this</a> might be quite illustrative of the approach."}, {"owner": {"reputation": 185, "user_id": 482501, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1992205d1fcadd6c351506daa896c12f?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/482501/greg"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1444059799, "post_id": 32946927, "comment_id": 53729869, "body": "Hi kostix and thank you for great piece of advice. I think that the link you provided (<a href=\"http://stackoverflow.com/q/10812294/720999\">stackoverflow.com/q/10812294/720999</a>) answers all my dilemas, it seems like i missed the functionality of &quot;attr&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 482501, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1992205d1fcadd6c351506daa896c12f?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/482501/greg"}, "edited": false, "score": 1, "creation_date": 1444059738, "post_id": 32950112, "comment_id": 53729839, "body": "Hi basgys, this is the approach i tried at first but it produced the following message:  expected element type &lt;SOAP-ENV:Envelope&gt; but have &lt;Envelope&gt;  that&#39;s why i started diggind further, thanks anyway!"}], "tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": false, "score": 1, "last_activity_date": 1444052494, "creation_date": 1444052494, "answer_id": 32950112, "question_id": 32946927, "link": "https://stackoverflow.com/questions/32946927/consuming-soap-with-namespaces-in-golang/32950112#32950112", "title": "Consuming SOAP with namespaces in GOLANG", "body": "<p>You can a structure that matches your SOAP data and then unmarshal it with the \"encoding/xml\" package</p>\n\n<p>Structs :</p>\n\n<pre><code>type Envelope struct {\n    XMLName  xml.Name `xml:\"SOAP-ENV:Envelope\"`\n    Body     Body     `xml:\"SOAP-ENV:Body\"`\n}\n\ntype Body struct {\n    StatusRes *DoQueryAllSysStatusResponse `xml:\"ns1:doQueryAllSysStatusResponse\"`\n}\n\ntype DoQueryAllSysStatusResponse struct {\n    CountryStatus *SysCountryStatus `xml:\"ns1:sysCountryStatus\"`\n}\n\n// ...\n</code></pre>\n\n<p>Unmarshal:</p>\n\n<pre><code>data := []byte{} // SOAP data\nenv := &amp;Envelope{}\nerr := xml.Unmarshal(data, env)\nif err != nil {\n    // do something\n}\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 482501, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1992205d1fcadd6c351506daa896c12f?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/482501/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1059, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444052494, "creation_date": 1444042664, "question_id": 32946927, "link": "https://stackoverflow.com/questions/32946927/consuming-soap-with-namespaces-in-golang", "title": "Consuming SOAP with namespaces in GOLANG", "body": "<p>i'm a GO newbie, starting to learn how to process SOAP requests. I have a difficulty here with the namespaces: i don't know how to contruct the structs to reflect such kind of data coming in from the webservice in order to unmarshall it. Could you give me a few hints here? I'm using GO 1.5.1</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns1=\"https://webapi.allegro.pl/service.php\"&gt;\n&lt;SOAP-ENV:Body&gt;\n    &lt;ns1:doQueryAllSysStatusResponse&gt;\n        &lt;ns1:sysCountryStatus&gt;\n\n            &lt;ns1:item&gt;\n                &lt;ns1:countryId&gt;1&lt;/ns1:countryId&gt;\n                &lt;ns1:programVersion&gt;1.0&lt;/ns1:programVersion&gt;\n                &lt;ns1:catsVersion&gt;1.1.87&lt;/ns1:catsVersion&gt;\n                &lt;ns1:apiVersion&gt;1.0&lt;/ns1:apiVersion&gt;\n                &lt;ns1:attribVersion&gt;1.0&lt;/ns1:attribVersion&gt;\n                &lt;ns1:formSellVersion&gt;1.4.46&lt;/ns1:formSellVersion&gt;\n                &lt;ns1:siteVersion&gt;1.0&lt;/ns1:siteVersion&gt;\n                &lt;ns1:verKey&gt;123131231&lt;/ns1:verKey&gt;\n            &lt;/ns1:item&gt;\n\n            &lt;ns1:item&gt;\n                &lt;ns1:countryId&gt;56&lt;/ns1:countryId&gt;\n                &lt;ns1:programVersion&gt;1.0&lt;/ns1:programVersion&gt;   \n                &lt;ns1:catsVersion&gt;1.0.43&lt;/ns1:catsVersion&gt;\n                &lt;ns1:apiVersion&gt;1.0&lt;/ns1:apiVersion&gt; \n                &lt;ns1:attribVersion&gt;1.0&lt;/ns1:attribVersion&gt;\n                &lt;ns1:formSellVersion&gt;1.0.69&lt;/ns1:formSellVersion&gt;\n                &lt;ns1:siteVersion&gt;1.0&lt;/ns1:siteVersion&gt;\n                &lt;ns1:verKey&gt;00000101&lt;/ns1:verKey&gt;\n            &lt;/ns1:item&gt;\n        &lt;/ns1:sysCountryStatus&gt;\n    &lt;/ns1:doQueryAllSysStatusResponse&gt;\n&lt;/SOAP-ENV:Body&gt;\n&lt;/SOAP-ENV:Envelope&gt;\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "is_accepted": false, "score": 1, "last_activity_date": 1444041088, "creation_date": 1444041088, "answer_id": 32946405, "question_id": 32945999, "link": "https://stackoverflow.com/questions/32945999/very-long-latence-only-for-one-of-my-module/32946405#32946405", "title": "Very long latence only for one of my module", "body": "<p>It's very likely there is an issue with Google infrastructure that serve the problematic module.</p>\n\n<p>Probably it calculate some hash code for a module and try to instantiate an instance of the same module on the same machine if possible so app code is cached on the (virtual) machine level if possible. If that machine has issues (<em>for example with hardware</em>) it translates to increased latency for your app.</p>\n\n<p>I would advise:</p>\n\n<ol>\n<li>Deploy code to new module and use it (<em>if possible</em>) while keeping old for troubleshooting.</li>\n<li>Narrow use cases (basic functionality like ping) &amp; raise an issue with Google.</li>\n</ol>\n"}], "owner": {"reputation": 143, "user_id": 5000077, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Q7Vb_ZkSRA/AAAAAAAAAAI/AAAAAAAAADA/jczbRX12lDo/photo.jpg?sz=128", "display_name": "Xin", "link": "https://stackoverflow.com/users/5000077/xin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444041088, "creation_date": 1444039749, "question_id": 32945999, "link": "https://stackoverflow.com/questions/32945999/very-long-latence-only-for-one-of-my-module", "title": "Very long latence only for one of my module", "body": "<p>Our problem began 02/Sep/2015 17:46 (Paris time), and there is still issus  at present.\nWe have 2 applications: one for test and development and the other one for the production. The problem is in the production application.  </p>\n\n<ol>\n<li><p>There had been 5 days that we didn't modify the code in production application, but suddenly the latence became very very long the last friday afternoon. The latence was 100~300ms before, but became 30s from from that moment on, and for all requests!</p></li>\n<li><p>We use the same code for the test application, but all work well for this application.   </p></li>\n<li><p>We have several modules in the production application, and there is only one module has this problem, all others mudules work well.</p></li>\n<li><p>During the weekend, we make some tests, but still can not find why.\nFor exemple, the code here:</p>\n\n<pre><code>package app\n\nimport (\n    \"net/http\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", HandlerHeartBeat)\n}\n\nfunc HandlerHeartBeat(w http.ResponseWriter, r *http.Request) {\n    w.WriteHeader(202)\n}\n</code></pre></li>\n</ol>\n\n<p>When I deploy this code to the problematic module in the production application, the latence is 2s. Then I try to deploy it to another version in the problematic module, the latence is always very long.\nBut if deploy this code to other module in the production application (or just create a new module), I get the normal latence(~50ms).  </p>\n\n<ol start=\"5\">\n<li><p>Our configuration file is very simple:</p>\n\n<pre><code>application: APP_NAME\nmodule: MODULE_NAME\nversion: 1\nruntime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n</code></pre></li>\n</ol>\n\n<p>I don't know if there is other people meet the same problem like me. Thank you</p>\n"}, {"tags": ["time", "go"], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1444034732, "post_id": 32944208, "comment_id": 53713971, "body": "How to trim it? I mean without to break other layouts."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1444034950, "post_id": 32944208, "comment_id": 53714085, "body": "The space doesn&#39;t seem to fix the issue. Am I wrong? <a href=\"http://play.golang.org/p/baYxSuFdse\" rel=\"nofollow noreferrer\">play.golang.org/p/baYxSuFdse</a>"}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1444035963, "post_id": 32944208, "comment_id": 53714685, "body": "@AnthonyHunt Having a space between MST and - (for both the layout and the data) fixes the issue. Hence my comment that it does not solve your problem :)"}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1444036290, "post_id": 32944208, "comment_id": 53714876, "body": "@AnthonyHunt My guess is that there is a problem with the golang time parser, because the layout looks correct. That&#39;s why I said you should simply cut off the (MST -07:00)/(GMT +08:00) that are redundant."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1444036888, "post_id": 32944208, "comment_id": 53715217, "body": "that, that&#39;s the case. There seems to be an issue on github though it was closed due backward compat."}], "tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": false, "score": -1, "last_activity_date": 1444033845, "creation_date": 1444033845, "answer_id": 32944208, "question_id": 32943398, "link": "https://stackoverflow.com/questions/32943398/how-to-parse-mon-5-oct-2015-002408-0800-gmt0800/32944208#32944208", "title": "How to parse Mon, 5 Oct 2015 00:24:08 +0800 (GMT+08:00)", "body": "<p>Having a space between MST and - solves the panic.</p>\n\n<pre><code>layout := \"Mon, _2 Jan 2006 15:04:05 -0700 (MST -07:00)\"\ndata := \"Mon, 5 Oct 2015 00:24:08 +0800 (GMT +08:00)\"\n</code></pre>\n\n<p>This works, however it does not really solve your problem.</p>\n\n<p>Why not trimming the redundant timezone part? You already have +0800 defined.</p>\n\n<pre><code>layout := \"Mon, _2 Jan 2006 15:04:05 -0700\"\ndata := \"Mon, 5 Oct 2015 00:24:08 +0800\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1471850221, "last_edit_date": 1471850221, "creation_date": 1444035262, "answer_id": 32944610, "question_id": 32943398, "link": "https://stackoverflow.com/questions/32943398/how-to-parse-mon-5-oct-2015-002408-0800-gmt0800/32944610#32944610", "title": "How to parse Mon, 5 Oct 2015 00:24:08 +0800 (GMT+08:00)", "body": "<p>Please read the <strong>Important note!</strong> section to get a full picture as the last part including <code>GMT</code> is not what it seems (that is, it is not the zone abbreviation).</p>\n\n<hr>\n\n<p>Your input time string is not parsable as-is with the <code>time</code> package because in the last part <code>(GMT+08:00)</code> the zone abbreviation and the zone offset are not separated with any extra characters. And since the zone abbreviation is not limited to 3 characters, the <code>\"+08\"</code> is also treated as part of the zone abbreviation, which will only leave the rest <code>\":00)\"</code> to match the zone offset <code>\"-07:00\"</code> hence the error message:</p>\n\n<pre><code>cannot parse \":00)\" as \"-07:00\"\n</code></pre>\n\n<p>Possible workaround:</p>\n\n<p>Simply cut off the extra zone offset as it is redundant (duplicate because zone offset is included twice):</p>\n\n<pre><code>func Parse(s string) (time.Time, error) {\n    if len(s) &lt; 7 {\n        return time.Time{}, errors.New(\"Too short!\")\n    }\n    s = s[:len(s)-7]\n    layout := \"Mon, _2 Jan 2006 15:04:05 -0700 (MST\"\n    return time.Parse(layout, s)\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>data := \"Mon, 5 Oct 2015 00:24:08 +0800 (GMT+08:00)\"\nt, err := Parse(data)\nif err != nil {\n    panic(err)\n}\nfmt.Println(t)\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/W60xqB69qW\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<h3>Important note!</h3>\n\n<p>Although logically analyzing your input time string:</p>\n\n<pre><code>Mon, 5 Oct 2015 00:24:08 +0800 (GMT+08:00)\n</code></pre>\n\n<p>The last part <code>\"(GMT+08:00)\"</code> <strong>does not denote the zone abbreviation</strong> (GMT is not +0800 but +0000)! It is just a helper text to the reader explaining that the <code>+0800</code> is a zone offset to be added to the <code>GMT</code> timezone, so most likely it will always be <code>GMT</code> but not because the time is specified in the GMT timezone but because it explains that the zone offset means an offset to be added to the GMT time. And as such, it is not part of the time specification and should not be parsed.</p>\n\n<p>So instead cut off all the last part and parse it like this:</p>\n\n<pre><code>func Parse(s string) (time.Time, error) {\n    if len(s) &lt; 12 {\n        return time.Time{}, errors.New(\"Too short!\")\n    }\n    s = s[:len(s)-12]\n    layout := \"Mon, 2 Jan 2006 15:04:05 -0700\"\n    return time.Parse(layout, s)\n}\n</code></pre>\n\n<p>Also note that if this is really the case (that it is not the zone abbreviation but it will always be <code>\"GMT\"</code>), you can parse the input string without truncating it by changing your layout to include the static text <code>\"GMT\"</code> instead of the zone abbreviation specifier <code>\"MST\"</code>:</p>\n\n<pre><code>layout := \"Mon, 2 Jan 2006 15:04:05 -0700 (GMT-07:00)\"\ndata := \"Mon, 5 Oct 2015 00:24:08 +0800 (GMT+08:00)\"\nt, err := time.Parse(layout, data)\n</code></pre>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 32944610, "answer_count": 2, "score": 3, "last_activity_date": 1471850221, "creation_date": 1444030475, "last_edit_date": 1444031741, "question_id": 32943398, "link": "https://stackoverflow.com/questions/32943398/how-to-parse-mon-5-oct-2015-002408-0800-gmt0800", "title": "How to parse Mon, 5 Oct 2015 00:24:08 +0800 (GMT+08:00)", "body": "<p>I'm trying to parse a time value (received via email) but I can't find what layout I should use.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    layout := \"Mon, _2 Jan 2006 15:04:05 -0700 (MST-07:00)\"\n    data := \"Mon, 5 Oct 2015 00:24:08 +0800 (GMT+08:00)\"\n    t, err := time.Parse(layout, data)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(t)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/IUXSEG9Rr_\" rel=\"nofollow\">Check</a></p>\n\n<p><code>panic: parsing time \"Mon, 5 Oct 2015 00:24:08 +0800 (GMT+08:00)\" as \"Mon, _2 Jan 2006 15:04:05 -0700 (MST-07:00)\": cannot parse \":00)\" as \"-07:00\"</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 0, "creation_date": 1444055272, "post_id": 32940693, "comment_id": 53726861, "body": "Tough one to help with remotely. My first thought, since I own a chromebook and run go on it fine (natively, kinda, as well as dual-booted in Arch), is to wonder about the architecture. I know different models vary, but my architecture is amd64 rather than arm. Is it possible you&#39;ve got the wrong bootstrap architecture?"}, {"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 0, "creation_date": 1444055392, "post_id": 32940693, "comment_id": 53726950, "body": "Alternatively: I don&#39;t the details of the ChrUbuntu project and if the packages are restricted, but can you not install go through apt-get?"}], "owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1290, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444014202, "creation_date": 1444014202, "question_id": 32940693, "link": "https://stackoverflow.com/questions/32940693/cannot-execute-binary-file-of-golang-bootstrap-installer", "title": "cannot execute binary file of golang bootstrap installer", "body": "<p>I'm using the instructions in <a href=\"http://dave.cheney.net/2015/09/04/building-go-1-5-on-the-raspberry-pi\" rel=\"nofollow\">this blog post</a>, which is intended for installing go 1.5 on the Raspberry Pi, to install golang on my Chromebook (which has ChrUbuntu not Chromium installed). The technique recommended in the blog post is to install a Golang 1.4 bootstrap compiler <a href=\"http://dave.cheney.net/paste/go-linux-arm-bootstrap-c788a8e.tbz%20%7C%20tar%20xj\" rel=\"nofollow\">available here</a> and then use that to build golang 1.5 (as you need a version of go installed to build 1.5). I tried this on the Raspberry pi and it worked, but when I ran this command from /go/src on ChrUbuntu</p>\n\n<pre><code> env GO_TEST_TIMEOUT_SCALE=10 GOROOT_BOOTSTRAP=$HOME/go-linux-arm-bootstrap ./all.bash\n</code></pre>\n\n<p>It gave me this output</p>\n\n<pre><code> env GO_TEST_TIMEOUT_SCALE=10 GOROOT_BOOTSTRAP=$HOME/go-linux-arm-bootstrap ./all.bash\n# Building C bootstrap tool.\ncmd/dist\n./make.bash: line 121: /home/user/go-linux-arm/bootstrap/bin/go cannot execute binary file\n</code></pre>\n\n<p>Why am I getting this error message (is it because it's not compatible with ChrUbuntu) and how to do what I am trying to do. Thank you in advance.</p>\n"}, {"tags": ["linux", "ubuntu", "go", "wget", "snapcraft"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1444012671, "post_id": 32940489, "comment_id": 53706370, "body": "You can use browser to download the archive."}, {"owner": {"reputation": 187, "user_id": 1850621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78730c53ebd0c7514031ed7a556509c?s=128&d=identicon&r=PG", "display_name": "nnm", "link": "https://stackoverflow.com/users/1850621/nnm"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1444012827, "post_id": 32940489, "comment_id": 53706393, "body": "No, I mean from command line."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1444013056, "post_id": 32940489, "comment_id": 53706446, "body": "Maybe <code>curl</code> is installed, you can use it instead of <code>wget</code>. Or just install <code>wget</code>."}, {"owner": {"reputation": 187, "user_id": 1850621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78730c53ebd0c7514031ed7a556509c?s=128&d=identicon&r=PG", "display_name": "nnm", "link": "https://stackoverflow.com/users/1850621/nnm"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1444013523, "post_id": 32940489, "comment_id": 53706531, "body": "curl isn&#39;t installed too.. I tried to search &quot;wget&quot; package on snappy (snappy search wget) but no results"}, {"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 1, "creation_date": 1444025399, "post_id": 32940489, "comment_id": 53709553, "body": "It&#39;s hard to tell exactly what your use case is, but if you&#39;re trying to deploy a go webserver to your Ubuntu server it&#39;s worth noting that you don&#39;t need &quot;go&quot; installed to run go binaries. If your issue is literally just: you don&#39;t know how to move any file to the server... ftp? links?"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 1850621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78730c53ebd0c7514031ed7a556509c?s=128&d=identicon&r=PG", "display_name": "nnm", "link": "https://stackoverflow.com/users/1850621/nnm"}, "edited": false, "score": 0, "creation_date": 1444029340, "post_id": 32942477, "comment_id": 53711299, "body": "Thanks! I&#39;ve decided to use Docker as a container on Snappy, then I install nginx on it as a web server. Basically, I want to make an environment that uses Ubuntu-core as OS. And that environment act as a web server. Did I do the right thing?"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 187, "user_id": 1850621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78730c53ebd0c7514031ed7a556509c?s=128&d=identicon&r=PG", "display_name": "nnm", "link": "https://stackoverflow.com/users/1850621/nnm"}, "edited": false, "score": 0, "creation_date": 1444182103, "post_id": 32942477, "comment_id": 53790193, "body": "That is certainly one way you can run a web application on top of Snappy.  In your question you asked about running Go apps on Snappy, so I answered how you could deploy directly to the platform."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 4, "last_activity_date": 1444026475, "creation_date": 1444026475, "answer_id": 32942477, "question_id": 32940489, "link": "https://stackoverflow.com/questions/32940489/install-go-programming-language-on-ubuntu-core-snappy/32942477#32942477", "title": "Install Go Programming Language on Ubuntu core (snappy)", "body": "<p>In general, Snappy should be viewed as a deployment target rather than a development system.  It is similar to Android or iOS in this way, depending on a second system for development.</p>\n\n<p>So the usual way to deploy a Go application on Snappy would be something like:</p>\n\n<ol>\n<li>build the application on your development system.</li>\n<li>package the binaries as a <code>.snap</code> package</li>\n<li>deploy the package on Snappy (either by releasing it through the store, or copying it to the target system manually).</li>\n</ol>\n\n<p>Steps (1) and (2) are probably best done using the <a href=\"https://developer.ubuntu.com/en/snappy/snapcraft/\" rel=\"nofollow\">Snapcraft</a> tool, which has built-in support for building Go applications.  The last can be done using the <code>snappy install</code> command on the target system.</p>\n\n<p>One thing to note is that Snapcraft doesn't do anything to help you with cross-compiling yet, so if your chosen development system has a different architecture you may run into problems (e.g. if you are developing on x86 and want to deploy to a Raspberry Pi).</p>\n\n<p>If this is the case, one option here is to use LXC containers to create a traditional Ubuntu system in a container on the target system.  You should be able to set it up with commands like the following (based on <a href=\"https://plus.google.com/+St%C3%A9phaneGraber/posts/aX6vogzEQ1X\" rel=\"nofollow\">this post</a>):</p>\n\n<pre><code>sudo snappy install lxd\nlxc remote add images images.linuxcontainers.org\nlxc launch images:ubuntu/vivid/armhf dev\n</code></pre>\n\n<p>You can then get a shell within the container using:</p>\n\n<pre><code>lxc exec dev bash\n</code></pre>\n\n<p>From there you can install Go and Snapcraft, and build an ARM version of your package ready to be installed outside of the container (or onto other ARM devices).</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 5476315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd88a590e2bd76d00c4f5413635b32c?s=128&d=identicon&r=PG", "display_name": "dholbach", "link": "https://stackoverflow.com/users/5476315/dholbach"}, "is_accepted": false, "score": 1, "last_activity_date": 1475053272, "creation_date": 1475053272, "answer_id": 39742657, "question_id": 32940489, "link": "https://stackoverflow.com/questions/32940489/install-go-programming-language-on-ubuntu-core-snappy/39742657#39742657", "title": "Install Go Programming Language on Ubuntu core (snappy)", "body": "<p>Another option is to use classic mode:</p>\n\n<pre><code>$ sudo snap install classic --edge --devmode\n$ classic\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 1850621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b78730c53ebd0c7514031ed7a556509c?s=128&d=identicon&r=PG", "display_name": "nnm", "link": "https://stackoverflow.com/users/1850621/nnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1475053272, "creation_date": 1444012375, "last_edit_date": 1474111601, "question_id": 32940489, "link": "https://stackoverflow.com/questions/32940489/install-go-programming-language-on-ubuntu-core-snappy", "title": "Install Go Programming Language on Ubuntu core (snappy)", "body": "<p>I tried to install Go language on Ubuntu Core (snappy) for creating a web server. How to do it? I have problem downloading go-lang archive because there is no 'wget' in ubuntu core. Any solutions?</p>\n"}, {"tags": ["go", "callback", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 745, "user_id": 1823636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dc271a930773cc7ce95dfceedcd83e?s=128&d=identicon&r=PG", "display_name": "sisoft", "link": "https://stackoverflow.com/users/1823636/sisoft"}, "edited": false, "score": 0, "creation_date": 1444033132, "post_id": 32940436, "comment_id": 53713169, "body": "Ok, wrapper is a solution. However, for now I redefined callback prototypes without const&#39;s directly in go file (as in my example above). It looks a bit hacky but works too."}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 7, "last_activity_date": 1444011772, "creation_date": 1444011772, "answer_id": 32940436, "question_id": 32938558, "link": "https://stackoverflow.com/questions/32938558/cgo-cant-find-way-to-use-callbacks-with-const-char-argument/32940436#32940436", "title": "Cgo: can&#39;t find way to use callbacks with const char* argument", "body": "<p>Since Go does not have <code>const</code> modifiers for pointers there is no way to translate this behaviour from inside Go code. cgo will always generate headers that do not have the <code>const</code> modifier. This is also the reason why your code does not build correctly: <code>cgo</code> creates <code>myFunc</code> only based on what it knows: <code>buf</code> should be <code>char*</code>, not <code>const char*</code>.</p>\n\n<p>The best way to handle this is to use wrapper on the C side that casts that parameter to <code>const char*</code>. In your case it is enough to change the definition of <code>myFunc</code> to <code>void myFunc(char*, int)</code>. Passing the function to <code>cb_func</code> will work regardless since casting <code>myFunc</code> to <code>(*cb_func)(const char*,int)</code> only adds type information but does not change the memory layout.</p>\n"}, {"tags": [], "owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "is_accepted": false, "score": 3, "last_activity_date": 1595236639, "creation_date": 1595236639, "answer_id": 62992264, "question_id": 32938558, "link": "https://stackoverflow.com/questions/32938558/cgo-cant-find-way-to-use-callbacks-with-const-char-argument/62992264#62992264", "title": "Cgo: can&#39;t find way to use callbacks with const char* argument", "body": "<p>I had the same issue. One solution for the still-needee is to something like:</p>\n<pre class=\"lang-c prettyprint-override\"><code>typedef const char cchar_t\nvoid myNewFunction(cchar_t* data);\n</code></pre>\n<p>then use it in go as <code>data* C.char_t</code></p>\n"}], "owner": {"reputation": 745, "user_id": 1823636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dc271a930773cc7ce95dfceedcd83e?s=128&d=identicon&r=PG", "display_name": "sisoft", "link": "https://stackoverflow.com/users/1823636/sisoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3319, "favorite_count": 0, "accepted_answer_id": 32940436, "answer_count": 2, "score": 3, "last_activity_date": 1595236639, "creation_date": 1443993812, "question_id": 32938558, "link": "https://stackoverflow.com/questions/32938558/cgo-cant-find-way-to-use-callbacks-with-const-char-argument", "title": "Cgo: can&#39;t find way to use callbacks with const char* argument", "body": "<p>I'm use C library from Go using Cgo and all good except callbacks. Library have callback setter, which takes pointer to callback func. Callback func itself written in go and exported using Cgo syntax.<br>\nProblem: I can make and export function with <code>char *</code> argument, but can't with <code>const char *</code>.</p>\n\n<p>Code to illustrate:<br>\n<strong>test.go</strong>:</p>\n\n<pre><code>package main\n\n/*\ntypedef void (*cb_func)(const char *, int);\nvoid callback(cb_func);\nvoid myFunc(const char *, int);\n*/\nimport \"C\"\nimport (\n        \"fmt\"\n        \"unsafe\"\n)\n\n//export myFunc\nfunc myFunc(buf *C.char, ln C.int) {\n        fmt.Printf(\"Got: %s\\n\", C.GoStringN(buf, ln))\n}\n\nfunc main() {\n        C.callback((C.cb_func)(unsafe.Pointer(C.myFunc)))\n}\n</code></pre>\n\n<p><strong>test.c</strong>:</p>\n\n<pre><code>typedef void (*cb_func)(const char *, int);\n\nvoid callback(cb_func cb) {\n        cb(\"test\", 4);\n}\n</code></pre>\n\n<p>Output from <code>go build</code>:</p>\n\n<pre><code>In file included from $WORK/test/_obj/_cgo_export.c:2:0:\n./test.go:54:13: error: conflicting types for 'myFunc'\n./test.go:7:6: note: previous declaration of 'myFunc' was here\n void myFunc(const char *, int);\n      ^\n/tmp/go-build994908053/test/_obj/_cgo_export.c:9:6: error: conflicting types for 'myFunc'\n void myFunc(char* p0, int p1)\n      ^\nIn file included from $WORK/test/_obj/_cgo_export.c:2:0:\n./test.go:7:6: note: previous declaration of 'myFunc' was here\n void myFunc(const char *, int);\n      ^\n</code></pre>\n\n<p>Without <code>const</code> qualifiers code compiles and works as expected.</p>\n\n<p>What can be used insted of <code>*C.char</code> to get const string in C?</p>\n"}, {"tags": ["time", "go", "sleep", "channel"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1443989779, "post_id": 32937883, "comment_id": 53701168, "body": "Related: <a href=\"http://stackoverflow.com/questions/31942163/how-to-write-my-own-sleep-function-using-just-time-after\">How to write my own Sleep function using just time.After?</a>"}, {"owner": {"reputation": 109, "user_id": 5223245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a83268575cb2f4afd42e5924a2dfc42?s=128&d=identicon&r=PG&f=1", "display_name": "pardonmemiss", "link": "https://stackoverflow.com/users/5223245/pardonmemiss"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1443990094, "post_id": 32937883, "comment_id": 53701285, "body": "Yes, I was trying to comment there with question about my version of the code but didn&#39;t have enough rep :)"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 5223245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a83268575cb2f4afd42e5924a2dfc42?s=128&d=identicon&r=PG&f=1", "display_name": "pardonmemiss", "link": "https://stackoverflow.com/users/5223245/pardonmemiss"}, "edited": false, "score": 0, "creation_date": 1443990304, "post_id": 32937957, "comment_id": 53701368, "body": "Thanks for the inputs! I just tried with removing the <code>for</code> loop (<a href=\"http://play.golang.org/p/BU3qGK8hLJ\" rel=\"nofollow noreferrer\">play.golang.org/p/BU3qGK8hLJ</a>), could you explain why it still gets stuck at <code>Waiting</code> and does not move onto the channel completion case? How do I make it &quot;listen to the event&quot; of channel talking?"}, {"owner": {"reputation": 109, "user_id": 5223245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a83268575cb2f4afd42e5924a2dfc42?s=128&d=identicon&r=PG&f=1", "display_name": "pardonmemiss", "link": "https://stackoverflow.com/users/5223245/pardonmemiss"}, "edited": false, "score": 0, "creation_date": 1443990394, "post_id": 32937957, "comment_id": 53701400, "body": "Ah, in the other answer you had linked to, this line really helps clarify it: &quot;So just receive a value from the returned channel, and the receive will block until the value is sent:&quot; (I still wouldn&#39;t mind my question in the comment above being answered)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 109, "user_id": 5223245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a83268575cb2f4afd42e5924a2dfc42?s=128&d=identicon&r=PG&f=1", "display_name": "pardonmemiss", "link": "https://stackoverflow.com/users/5223245/pardonmemiss"}, "edited": false, "score": 0, "creation_date": 1443990646, "post_id": 32937957, "comment_id": 53701473, "body": "@pardonmemiss See edited answer. I included how to fix your function."}, {"owner": {"reputation": 109, "user_id": 5223245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a83268575cb2f4afd42e5924a2dfc42?s=128&d=identicon&r=PG&f=1", "display_name": "pardonmemiss", "link": "https://stackoverflow.com/users/5223245/pardonmemiss"}, "edited": false, "score": 0, "creation_date": 1443991525, "post_id": 32937957, "comment_id": 53701788, "body": "Yep! That return made all the difference. Thanks for the caution about the Single threaded machines; I&#39;ll be careful before I run code like this on VMs!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1444050047, "last_edit_date": 1495540335, "creation_date": 1443989995, "answer_id": 32937957, "question_id": 32937883, "link": "https://stackoverflow.com/questions/32937883/writing-sleep-function-based-on-time-after/32937957#32937957", "title": "Writing Sleep function based on time.After", "body": "<p>In each iteration of your <code>for</code> loop the <code>select</code> statement is executed which involves evaluating the channel operands.</p>\n\n<p>In each iteration <code>time.After()</code> will be called and a new channel will be created!</p>\n\n<p>And if duration is more than <code>0</code>, this channel is not ready to receive from, so the default case will be executed. This channel will not be tested/checked again, the next iteration creates a new channel which will again not be ready to receive from, so the <code>default</code> case is chosen again - as always.</p>\n\n<p>The solution is really simple though as can be seen in <a href=\"https://stackoverflow.com/a/31942303/1705598\">this answer</a>:</p>\n\n<pre><code>func Sleep(sec int) {\n    &lt;-time.After(time.Second* time.Duration(sec))\n}\n</code></pre>\n\n<p><strong>Fixing your variant:</strong></p>\n\n<p>If you want to make your variant work, you have to create one channel only (using <code>time.After()</code>), store the returned channel value, and always check this channel. And if the channel \"kicks in\" (a value is received from it), you must return from your function because more values will not be received from it and so your loop will remain endless!</p>\n\n<pre><code>func myOwnSleep(duration int) {\n    ch := time.After(time.Second * time.Duration(duration))\n    for {\n        select {\n        case &lt;-ch:\n            fmt.Println(\"slept!\")\n            return // MUST RETURN, else endless loop!\n        default:\n            fmt.Println(\"Waiting\")\n        }\n    }\n}\n</code></pre>\n\n<p>Note that though until a value is received from the channel, this function will not \"rest\" and just execute code relentlessly - loading one CPU core. This might even give you trouble if only 1 CPU core is available (<a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\"><code>runtime.GOMAXPROCS()</code></a>), other goroutines (including the one that will (or would) send the value on the channel) might get blocked and never executed. A sleep (e.g. <code>time.Sleep(time.Millisecond)</code>) could release the CPU core from doing endless work (and allow other goroutines to run).</p>\n"}], "owner": {"reputation": 109, "user_id": 5223245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a83268575cb2f4afd42e5924a2dfc42?s=128&d=identicon&r=PG&f=1", "display_name": "pardonmemiss", "link": "https://stackoverflow.com/users/5223245/pardonmemiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 32937957, "answer_count": 1, "score": 2, "last_activity_date": 1444050047, "creation_date": 1443989495, "last_edit_date": 1495535219, "question_id": 32937883, "link": "https://stackoverflow.com/questions/32937883/writing-sleep-function-based-on-time-after", "title": "Writing Sleep function based on time.After", "body": "<p><strong>EDIT</strong>: My question is different from <a href=\"https://stackoverflow.com/questions/31942163/how-to-write-my-own-sleep-function-using-just-time-after\">How to write my own Sleep function using just time.After?</a> It has a different variant of the code that's not working for a separate reason and I needed explanation as to why.</p>\n\n<p>I'm trying to solve the homework problem here: <a href=\"https://www.golang-book.com/books/intro/10\" rel=\"nofollow noreferrer\">https://www.golang-book.com/books/intro/10</a> (<em>Write your own Sleep function using <code>time.After</code></em>).</p>\n\n<p>Here's my attempt so far based on the examples discussed in that chapter:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"time\"\n)\n\nfunc myOwnSleep(duration int) {\n        for {\n                select {\n                case &lt;-time.After(time.Second * time.Duration(duration)):\n                        fmt.Println(\"slept!\")\n                default:\n                        fmt.Println(\"Waiting\")\n                }\n        }\n}\n\nfunc main() {\n        go myOwnSleep(3)\n\n        var input string\n        fmt.Scanln(&amp;input)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/fb3i9KY3DD\" rel=\"nofollow noreferrer\">http://play.golang.org/p/fb3i9KY3DD</a></p>\n\n<p>My thought process is that the infinite <code>for</code> will keep executing the <code>select</code> statement's <code>default</code> until the <code>time.After</code> function's returned channel talks. Problem with the current code being, the latter does not happen, while the <code>default</code> statement is called infinitely.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["cookies", "go", "safari"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1443991937, "post_id": 32936475, "comment_id": 53701927, "body": "Whether cookies can be used is a browser setting. Browsers can disallow the use of cookies in which case any cookie that is sent from server using the <code>&quot;Set-cookie&quot;</code> header will not get stored, and you won&#39;t see any cookie back from such a browser."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1443992612, "post_id": 32936475, "comment_id": 53702143, "body": "The <code>Secure: https</code> field is invalid: it should be either true or false."}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444012799, "post_id": 32936475, "comment_id": 53706388, "body": "@elithrar sorry https should be a bool variable which should be evaluate true in this case."}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1444012900, "post_id": 32936475, "comment_id": 53706406, "body": "@icza, I saw the cookie being sent back in Chrome console, but in Safari, it   is not sent. I have the feeling this might be a browser specific problem. But I&#39;m not quite sure."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1444014512, "post_id": 32936475, "comment_id": 53706724, "body": "What happens if you set <code>Secure: false</code> - further, can you confirm that this is all served/visited via localhost?"}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444018378, "post_id": 32936475, "comment_id": 53707568, "body": "@elithrar, I checked again. When Secure is false, it doesn&#39;t work, when Secure is true, it works. This happens only with Safari. I apologize previously I said https evaluated to true, which was incorrect. Chrome and Firefox work well. It&#39;s not via localhost. It&#39;s via a domain name."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444018583, "post_id": 32936475, "comment_id": 53707608, "body": "You&#39;ll need to share more of your program or disclose your domain. It&#39;s unlikely to be a bug in Safari but instead in the cookie. The value may be too large, the Path not set and/or failing cross-origin. Chrome &amp; Safari still share a lot of cookie related code."}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444019579, "post_id": 32936475, "comment_id": 53707838, "body": "@elithrar They are actually <a href=\"http://solidtunnel.com\" rel=\"nofollow noreferrer\">solidtunnel.com</a> and <a href=\"https://solidtunnel.com\" rel=\"nofollow noreferrer\">solidtunnel.com</a>. The one with https works well, but the one with http doesn&#39;t work with Safari."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1444022581, "post_id": 32936475, "comment_id": 53708622, "body": "OK, after creating an account in Chrome (v47 dev) I can replicate the issue in Safari v9.0 if I visit the website over HTTPS first, log in, and then try to visit after over vanilla HTTP. The <code>user</code> cookie with <code>Secure: true</code> will not be issued back over vanilla HTTP. Chrome v47 also acts in the same manner, which is to be expected: you don&#39;t want a subsequent visit over HTTP to send sensitive cookies that may be MITM&#39;ed. For a VPN service you should be setting HSTS headers and forcing HTTPS anyway."}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444024466, "post_id": 32936475, "comment_id": 53709201, "body": "@elithrar thanks. I think you made things start to be clear now. I&#39;m using Chrome Version 45.0.2454.101 (64-bit). It issues back the user cookie over vanilla HTTP. Does it mean lower version Chrome&#39;s behavior is incorrect, it actually should not issue back?"}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1444025534, "post_id": 32936475, "comment_id": 53709602, "body": "Thank you @elithrar. I have redirected all http requests to https. Would you post your last comment as an answer so that I can mark it as answered?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1444058207, "post_id": 32936475, "comment_id": 53728958, "body": "&quot;Secure&quot; cookies must not and are not sent back over plain http by any browser. That&#39;s the whole idea behind &quot;secure&quot;. I&#39;d bet you are doing something wrong if this does not work."}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1444063778, "post_id": 32936475, "comment_id": 53732194, "body": "@Volker, thanks. I have completely redirected all http request to https."}], "owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2458, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1444012814, "creation_date": 1443980961, "last_edit_date": 1444012814, "question_id": 32936475, "link": "https://stackoverflow.com/questions/32936475/safari-failed-send-cookie-http-named-cookie-not-present", "title": "Safari failed send cookie - http: named cookie not present", "body": "<p>My backend is Golang. I use the following code to to set an http cookie to the browser, like so:</p>\n\n<pre><code>cookie := http.Cookie{Name: \"user\", Value: strCookie, MaxAge: 86400, Secure: true, HttpOnly: true}\nhttp.SetCookie(w, &amp;cookie)\n</code></pre>\n\n<p>In the next http session, I use the following code to try to read the cookie:</p>\n\n<pre><code>cookieUser, err := r.Cookie(\"user\")\n</code></pre>\n\n<p>It works with Chrome, Firefox, but Safari failed to send the cookie back to the backend, therefore the Golang tried to read the cookie, it shows the error message:</p>\n\n<pre><code>http: named cookie not present\n</code></pre>\n\n<p>So I'm wondering whether this is a Safari specific bug or there's any problem in my program.</p>\n"}, {"tags": ["go", "casting", "type-conversion"], "answers": [{"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 8, "last_activity_date": 1443965853, "creation_date": 1443965853, "answer_id": 32934083, "question_id": 32933980, "link": "https://stackoverflow.com/questions/32933980/golang-converting-uint-to-os-filemode/32934083#32934083", "title": "Golang - Converting uint to os.FileMode", "body": "<pre><code>tempval, err2 = strconv.ParseUint(data[\"Perm\"], 10, 32)\n</code></pre>\n\n<p>You're explicitly asking for base 10 here. If you want base 8 (which is the traditional base for unix file modes), then you need to use <code>8</code> in the second parameter. Or better, use base <code>0</code>, and it'll automatically choose base 8 due to the leading 0. See the docs on <code>strconv.ParseInt</code> for how \"base 0\" works.</p>\n"}], "owner": {"reputation": 373, "user_id": 3414989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497106b8161a35b4e7b5e87f7dd9a48b?s=128&d=identicon&r=PG&f=1", "display_name": "GokulSrinivas", "link": "https://stackoverflow.com/users/3414989/gokulsrinivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1799, "favorite_count": 1, "accepted_answer_id": 32934083, "answer_count": 1, "score": 4, "last_activity_date": 1443965912, "creation_date": 1443965146, "question_id": 32933980, "link": "https://stackoverflow.com/questions/32933980/golang-converting-uint-to-os-filemode", "title": "Golang - Converting uint to os.FileMode", "body": "<p>I'm trying to get user permissions for a file from the user as a string and convert it into type <code>os.FileMode</code>.</p>\n\n<p>So, after I get the permission <code>\"0644\"</code> and convert it, it becomes <code>644</code>. I am using this as a parameter to <code>ioutil.WriteFile</code>.</p>\n\n<p>This is what I'm doing.</p>\n\n<pre><code>data[\"perm\"] = \"0644\"\ntempval, err2 = strconv.ParseUint(data[\"Perm\"], 10, 32)\n// tempval is 644\n</code></pre>\n\n<p>I'm not getting the right permissions. </p>\n\n<p>I get <code>--w----r--</code> instead of <code>-rw-r--r--</code>\nI've been trying to find a workaround.</p>\n\n<p>So, how exactly do I achieve this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1443973782, "post_id": 32933423, "comment_id": 53695995, "body": "you mean beyond the built in profiler?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1443982228, "post_id": 32933423, "comment_id": 53698632, "body": "<a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">blog.golang.org/profiling-go-programs</a>"}, {"owner": {"reputation": 3827, "user_id": 743716, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Okvki.png?s=128&g=1", "display_name": "Rafal G.", "link": "https://stackoverflow.com/users/743716/rafal-g"}, "edited": false, "score": 0, "creation_date": 1443991204, "post_id": 32933423, "comment_id": 53701678, "body": "Yes. So that it could be run on production and provide business metrics that could be exported to let&#39;s say: Graphite. I have seen a few &quot;metrics&quot; projects in Go, but they all require you to mix business logic with metering logic and this sucks (from my pov)."}], "answers": [{"comments": [{"owner": {"reputation": 3827, "user_id": 743716, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Okvki.png?s=128&g=1", "display_name": "Rafal G.", "link": "https://stackoverflow.com/users/743716/rafal-g"}, "edited": false, "score": 0, "creation_date": 1444154327, "post_id": 32969830, "comment_id": 53778166, "body": "Thanks for your reply and hints. I have no idea where did you read that I want to measure everything :) I just want to be able, in a declarative way, to define functions that should be measured (not only HTTP requests but also my own requests to external systems). What I don&#39;t like in the code you have pasted is that performance logic is interleaved with business logic but I suppose that is all that Golang has for the time being. Thanks!"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1444376678, "post_id": 32969830, "comment_id": 53887036, "body": "Sure, the Go approach isn&#39;t perfect. But AOP has its downsides too."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 1, "last_activity_date": 1444134042, "creation_date": 1444134042, "answer_id": 32969830, "question_id": 32933423, "link": "https://stackoverflow.com/questions/32933423/method-level-execution-time-metrics-in-golang/32969830#32969830", "title": "Method-level execution time metrics in Golang?", "body": "<p>You could rewrite source code using the go parser and add the instructions. This is how <code>godebug</code> and the coverage tool work: <a href=\"https://github.com/mailgun/godebug\" rel=\"nofollow\">https://github.com/mailgun/godebug</a>.</p>\n\n<p>Obviously that would be a lot of work, but I think your methodology is flawed anyway. Measuring everything means your program will spend far more time measuring than actually doing work. This is why profiling only samples.</p>\n\n<p>It sounds like perhaps you're working on an HTTP project? You could easily instrument your code by wrapping all your <code>http.Handler</code>s or using a framework like <a href=\"https://github.com/codegangsta/negroni\" rel=\"nofollow\">Negroni</a>. Here's an <a href=\"https://github.com/thoas/stats\" rel=\"nofollow\">example</a> of someone doing something similar. Go also has the <a href=\"https://golang.org/pkg/expvar/\" rel=\"nofollow\">expvar</a> package which is sometimes useful for counters and the like.</p>\n\n<p>Also worth considering is using a statsd client (which can get your data into Graphite). Here's one package which can do that: <a href=\"https://github.com/PagerDuty/godspeed\" rel=\"nofollow\">godspeed</a>*. Calls are pretty easy:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/PagerDuty/godspeed\"\n    \"github.com/codegangsta/negroni\"\n)\n\nfunc statsdMiddleware(w http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n    start := time.Now()\n    next(w, r)\n    elapsed := float64(time.Now().Sub(start)) / float64(time.Millisecond)\n\n    g, err := godspeed.NewDefault()\n    if err != nil {\n        return\n    }\n    defer g.Conn.Close()\n\n    g.Histogram(\"http.response.time_ms\", elapsed, []string{\"path:\" + r.URL.Path})\n}\n\nfunc main() {\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/\", func(w http.ResponseWriter, req *http.Request) {\n        fmt.Fprintf(w, \"Welcome to the home page!\")\n    })\n\n    n := negroni.Classic()\n    n.Use(negroni.HandlerFunc(statsdMiddleware))\n    n.UseHandler(mux)\n    n.Run(\":3000\")\n}\n</code></pre>\n\n<p>This approach works for standard TCP servers as well. For pipelines reading / writing queues I usually measure how fast I'm reading in data and writing it out the other end and then use back-pressure gauges for the intermediate steps. (which helps me find out which step is causing the problem)</p>\n\n<p><em>Disclaimer: I work at DataDog</em></p>\n"}], "owner": {"reputation": 3827, "user_id": 743716, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Okvki.png?s=128&g=1", "display_name": "Rafal G.", "link": "https://stackoverflow.com/users/743716/rafal-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1486, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1444134042, "creation_date": 1443961445, "last_edit_date": 1443991309, "question_id": 32933423, "link": "https://stackoverflow.com/questions/32933423/method-level-execution-time-metrics-in-golang", "title": "Method-level execution time metrics in Golang?", "body": "<p>I am quite new to Go and I was wondering if there are any nice (like AOP in Java) ways to gather method-level execution time metrics in Go?</p>\n\n<p>It would be best if such code would not be placed inside regular business logic code.</p>\n\n<p>I don't want to profile an app. I mean real production ready metrics that could be exported to Graphite etc. so I could monitor response time histograms and such.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36371, "user_id": 1180785, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/UjU0z.png?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/1180785/dave"}, "edited": false, "score": 2, "creation_date": 1443961131, "post_id": 32933333, "comment_id": 53692240, "body": "<code>i &gt;&gt;= 1</code> = <code>i = i &gt;&gt; 1</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 2, "creation_date": 1443961368, "post_id": 32933333, "comment_id": 53692308, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5801008/go-and-operators\">Go &lt;&lt; and &gt;&gt; operators</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1855, "user_id": 3964066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0fVmL.png?s=128&g=1", "display_name": "belford", "link": "https://stackoverflow.com/users/3964066/belford"}, "is_accepted": false, "score": 4, "last_activity_date": 1443961089, "last_edit_date": 1495541209, "creation_date": 1443961089, "answer_id": 32933362, "question_id": 32933333, "link": "https://stackoverflow.com/questions/32933333/what-does-the-operator-do/32933362#32933362", "title": "What does the &gt;&gt;= operator do", "body": "<p>Check:\n<a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec</a></p>\n\n<pre><code>left shift             integer &lt;&lt; unsigned integer\n\nright shift            integer &gt;&gt; unsigned integer\n</code></pre>\n\n<blockquote>\n  <p>The shift operators shift the left operand by the shift count\n  specified by the right operand. They implement arithmetic shifts if\n  the left operand is a signed integer and logical shifts if it is an\n  unsigned integer. There is no upper limit on the shift count. Shifts\n  behave as if the left operand is shifted n times by 1 for a shift\n  count of n. As a result, x &lt;&lt; 1 is the same as x*2 and x >> 1 is the\n  same as x/2 but truncated towards negative infinity.</p>\n</blockquote>\n\n<p>Similar questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5801008/go-and-operators\">Go &lt;&lt; and &gt;&gt; operators</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/26294372/double-less-operator-in-go-tour-37?lq=1\">double less operator in Go Tour 37</a></p>\n"}, {"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": true, "score": 4, "last_activity_date": 1587200595, "last_edit_date": 1587200595, "creation_date": 1443961141, "answer_id": 32933369, "question_id": 32933333, "link": "https://stackoverflow.com/questions/32933333/what-does-the-operator-do/32933369#32933369", "title": "What does the &gt;&gt;= operator do", "body": "<p>The <code>&gt;&gt;</code> operator is the right shift operator.</p>\n\n<p><code>&gt;&gt;=</code> is a contracted form of the right shift operator <em>and</em> assignment:</p>\n\n<pre><code>i &gt;&gt;= 1\n</code></pre>\n\n<p>It is the same as:</p>\n\n<pre><code>tmp := i &gt;&gt; 1\ni = tmp\n</code></pre>\n\n<p>And that is the same thing as (without the need to create a new variable):</p>\n\n<pre><code>i := i &gt;&gt; 1\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4717639, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UGy-JjRUGag/AAAAAAAAAAI/AAAAAAAAAFo/Pxy9o1VWEp4/photo.jpg?sz=128", "display_name": "HenriTel", "link": "https://stackoverflow.com/users/4717639/henritel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1210, "favorite_count": 0, "accepted_answer_id": 32933369, "answer_count": 2, "score": 2, "last_activity_date": 1613379588, "creation_date": 1443960888, "last_edit_date": 1613379588, "question_id": 32933333, "link": "https://stackoverflow.com/questions/32933333/what-does-the-operator-do", "title": "What does the &gt;&gt;= operator do", "body": "<p>I was reading the implementation of sort in go, and there is this particular loop in the implementation of <code>func Sort(data Interface)</code>:</p>\n\n<pre><code>for i := n; i &gt; 0; i &gt;&gt;= 1 {\n    maxDepth++\n}\n</code></pre>\n\n<p>Sort implementation : <a href=\"https://golang.org/src/sort/sort.go\" rel=\"nofollow\">https://golang.org/src/sort/sort.go</a></p>\n\n<p>Can someone explain to me what does the >>= operator do ?</p>\n\n<p><strong>Edit:</strong> It's simply a shift followed by an affectation. I think the fact it was in a loop bugged my mind.</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 5, "last_activity_date": 1443970121, "creation_date": 1443970121, "answer_id": 32934757, "question_id": 32933060, "link": "https://stackoverflow.com/questions/32933060/unable-to-include-required-c-header-files-for-go-program/32934757#32934757", "title": "Unable to include required C header files for go program", "body": "<p>Did a quick test on my local : you need to remove the blank line between your cgo flags and your C code.</p>\n\n<p>Try this :</p>\n\n<pre><code>// #cgo CFLAGS: -I/usr/local/WordNet-3.0/include\n// #cgo LDFLAGS: /usr/local/WordNet-3.0/lib/libWN.3.dylib\n/*\n #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n #include \"wn.h\"\n\nstatic void printlicense() {\n    printf(\"WordNet License %s\\n\\n%s\", dblicense, license);\n}\n*/\nimport \"C\"\nimport \"unsafe\"\nimport (\n        \"os\"\n)\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 728538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d75c6d39623d30b5d162544757d401c?s=128&d=identicon&r=PG&f=1", "display_name": "Sachin Anand", "link": "https://stackoverflow.com/users/728538/sachin-anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4319, "favorite_count": 0, "accepted_answer_id": 32934757, "answer_count": 1, "score": 4, "last_activity_date": 1443970598, "creation_date": 1443958922, "last_edit_date": 1443970598, "question_id": 32933060, "link": "https://stackoverflow.com/questions/32933060/unable-to-include-required-c-header-files-for-go-program", "title": "Unable to include required C header files for go program", "body": "<p>I am trying to include a header file which exists in /usr/local/WordNet-3.0/include/ in my go program</p>\n\n<p>using these flags</p>\n\n<pre><code>// #cgo CFLAGS: -I/usr/local/WordNet-3.0/include\n// #cgo LDFLAGS: /usr/local/WordNet-3.0/lib/libWN.3.dylib\n\n/*\n #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n #include \"wn.h\"\n\nstatic void printlicense() {\n    printf(\"WordNet License %s\\n\\n%s\", dblicense, license);\n}\n*/\nimport \"C\"\nimport \"unsafe\"\nimport (\n        \"os\"\n)\n</code></pre>\n\n<p>but when I run my program using go run, it gives me following error:</p>\n\n<p>\"fatal error: 'wn.h' file not found.\" I am on go 1.5.1.</p>\n\n<p>Any help on what I am doing wrong would be appreciated.</p>\n\n<p>EDIT : I have got this to work by copying the file over in my working directory, but I would still like to know, what I was doing wrong.</p>\n"}, {"tags": ["go", "importerror"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1506585255, "last_edit_date": 1506585255, "creation_date": 1443952802, "answer_id": 32932233, "question_id": 32932199, "link": "https://stackoverflow.com/questions/32932199/golang-import-packages/32932233#32932233", "title": "Golang import packages", "body": "<p>Outside of a package only the exported identifiers can be reached and referred to, that is identifiers that start with an uppercase letter.</p>\n\n<p>So the easiest fix is to export your <code>math.add()</code> function by changing its name to <code>Add()</code> in <code>math.go</code>:</p>\n\n<pre><code>func Add(x, y int) int {\n    return x + y\n}\n</code></pre>\n\n<p>And, of course, when you refer to it from the <code>main.go</code>:</p>\n\n<pre><code>x := math.Add(6, 5)\n</code></pre>\n\n<p>And as a side note, note that when importing your <code>hello_world/math</code> package you don't have to specify a new name to refer to its exported identifiers: by default it will be the last part of its import path, so this is equivalent to your imports:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"hello_world/math\"\n)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 391, "user_id": 2349872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79ca62ad8d8e26c9b541c1f236c373c1?s=128&d=identicon&r=PG", "display_name": "saniales", "link": "https://stackoverflow.com/users/2349872/saniales"}, "edited": false, "score": 0, "creation_date": 1507014941, "post_id": 36659185, "comment_id": 80032350, "body": "You can edit answers from other users instead to post a new answer correcting another one"}], "tags": [], "owner": {"reputation": 26, "user_id": 6216326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d52e25cc66cde1967e82632daff997?s=128&d=identicon&r=PG&f=1", "display_name": "Liberalist D", "link": "https://stackoverflow.com/users/6216326/liberalist-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1460769947, "creation_date": 1460769947, "answer_id": 36659185, "question_id": 32932199, "link": "https://stackoverflow.com/questions/32932199/golang-import-packages/36659185#36659185", "title": "Golang import packages", "body": "<p>And when calling Add in your main function, dont use this </p>\n\n<pre><code>x := math.Add(6 + 5)\n</code></pre>\n\n<p>Instead use this </p>\n\n<pre><code>x := math.Add(6, 5)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 6001349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PTE_eA98cOE/AAAAAAAAAAI/AAAAAAAAACI/GhBOo8gJQbU/photo.jpg?sz=128", "display_name": "harold ramos", "link": "https://stackoverflow.com/users/6001349/harold-ramos"}, "is_accepted": false, "score": 0, "last_activity_date": 1462053543, "last_edit_date": 1462053543, "creation_date": 1462053390, "answer_id": 36960703, "question_id": 32932199, "link": "https://stackoverflow.com/questions/32932199/golang-import-packages/36960703#36960703", "title": "Golang import packages", "body": "<p>Functions, variables , anything coming from  a different package have to start with a capital letter to make it visible for when importing into the main package.</p>\n\n<p>example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"other/out\"\n\nfunc main(){\n\nfmt.Println(out.X)\n\n// hello\n\n}\n</code></pre>\n\n\n\n<pre><code>package other\n\nvar X string = \"hi\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "is_accepted": false, "score": 2, "last_activity_date": 1507016946, "last_edit_date": 1507016946, "creation_date": 1470872251, "answer_id": 38885186, "question_id": 32932199, "link": "https://stackoverflow.com/questions/32932199/golang-import-packages/38885186#38885186", "title": "Golang import packages", "body": "<p>Capitalize the function within your package that you want other functions to read:</p>\n\n<pre><code>func Add(x, y int) int {\n      return x + y\n}\n</code></pre>\n\n<p>then call it in <strong>hello.go</strong> like this:</p>\n\n<pre><code>x := math.Add(6, 5)\n</code></pre>\n\n<p>Keeping them lower case does have its purpose, particularly if you want to protect it from inadvertent use outside the package.</p>\n"}], "owner": {"reputation": 129, "user_id": 4752631, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ba9f8d2642382d88938cfc10731f31e?s=128&d=identicon&r=PG&f=1", "display_name": "John Smit", "link": "https://stackoverflow.com/users/4752631/john-smit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 0, "accepted_answer_id": 32932233, "answer_count": 4, "score": 3, "last_activity_date": 1507016946, "creation_date": 1443952523, "last_edit_date": 1506585290, "question_id": 32932199, "link": "https://stackoverflow.com/questions/32932199/golang-import-packages", "title": "Golang import packages", "body": "<p>I have some problem with Golang and include package. I have that scructure</p>\n\n<pre><code>src/\n\u251c\u2500\u2500 hello_world\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 hello.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 math\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 add.go\n</code></pre>\n\n<p><strong>hello.go</strong> file contains this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    math \"hello_world/math\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello World\")\n    x := math.add(6, 5)\n}\n</code></pre>\n\n<p>and <strong>add.go</strong></p>\n\n<pre><code>package math\n\nfunc add(x, y int) int {\n    return x + y\n}\n</code></pre>\n\n<p>and when I do <code>go run hello go</code> I see:</p>\n\n<pre><code>evgen@laptop:~/go/src/hello_world$ go run hello.go \n# command-line-arguments\n./hello.go:10: cannot refer to unexported name math.add\n./hello.go:10: undefined: \"hello_world/math\".add\n</code></pre>\n\n<p><strong>GOPATH</strong>: </p>\n\n<pre><code>evgen@laptop:~/go/src/hello_world$ echo $GOPATH\n/home/evgen/go\n</code></pre>\n\n<p>How fix it? Thanks you!</p>\n"}, {"tags": ["go", "rethinkdb"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1443950387, "post_id": 32931825, "comment_id": 53689584, "body": "You might be better off asking this on <a href=\"https://github.com/dancannon/gorethink\" rel=\"nofollow noreferrer\">github.com/dancannon/gorethink</a> - in lieu of any code to help fix."}], "answers": [{"tags": [], "owner": {"reputation": 2234, "user_id": 316183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/659d0c8387cefd176347beef316688cd?s=128&d=identicon&r=PG", "display_name": "kureikain", "link": "https://stackoverflow.com/users/316183/kureikain"}, "is_accepted": true, "score": 3, "last_activity_date": 1444015902, "last_edit_date": 1444015902, "creation_date": 1444015808, "answer_id": 32940876, "question_id": 32931825, "link": "https://stackoverflow.com/questions/32931825/how-to-use-r-do-and-r-branch-in-gorethink/32940876#32940876", "title": "How to use r.Do and r.Branch in gorethink?", "body": "<p>The author of Go RethinkDB driver is very active on Github and you may get quicker answer if asking over there. </p>\n\n<p>Here is an example of <code>Do</code>.</p>\n\n<pre><code>    res, _ := r.DB(\"test\").Table(\"table\").Get(\"ID\").Do(func(issue r.Term) r.Term {\n        return issue.Merge(map[string]string{\n            \"new_field\": \"new_value\",\n        })\n    }).Run(session)\n    var b []interface{}\n    a.All(&amp;b)\n    fmt.Println(b)\n</code></pre>\n\n<p>I think the most important thing is to ensure we declare correct type <code>Term</code>. I import RethinkDB driver as <code>r</code> so I used <code>r.Term</code>. Then inside <code>Do</code> function, you can use any command from Term: <a href=\"https://godoc.org/github.com/dancannon/gorethink#Term\" rel=\"nofollow\">https://godoc.org/github.com/dancannon/gorethink#Term</a></p>\n\n<p>An example of <code>Do</code> and <code>Branch</code> at same time:</p>\n\n<pre><code>    r.DB(\"test\").Table(\"issues\").Insert(map[string]interface{}{\n        \"id\": 1111,\n    }).Do(func(result r.Term) r.Term {\n        return r.Branch(result.Field(\"inserted\").Gt(0),\n            r.DB(\"test\").Table(\"log\").Insert(map[string]interface{}{\n                \"time\":   r.Now(),\n                \"result\": \"ok\",\n            }),\n            r.DB(\"test\").Table(\"log\").Insert(map[string]interface{}{\n                \"time\":   r.Now(),\n                \"result\": \"failed\",\n            }))\n    }).Run(session)\n</code></pre>\n\n<p>Basically, inside <code>Do</code>, we have access to return value of previous funciton call of RethinkDB, and we can continue to call ReQL command on that return value as in a <code>Map</code> function. </p>\n\n<p>Inside <code>Branch</code>, we pass 3 arguments, all are <code>Term</code> type in Go RethinkDB driver. You can also refer to the official example: <a href=\"https://godoc.org/github.com/dancannon/gorethink#Branch\" rel=\"nofollow\">https://godoc.org/github.com/dancannon/gorethink#Branch</a></p>\n\n<p>It's bit hard to get familiar with Go driver because of the nature of language and cannot fit in same dynamic style of official driver(Ruby, Python, JS). It's even more confusing in Language that we cannot chain command. </p>\n"}], "owner": {"reputation": 625, "user_id": 446253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acd27089af8a4e908c753247951d1aeb?s=128&d=identicon&r=PG", "display_name": "gshilin", "link": "https://stackoverflow.com/users/446253/gshilin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 1, "closed_date": 1444619884, "accepted_answer_id": 32940876, "answer_count": 1, "score": 0, "last_activity_date": 1444015902, "creation_date": 1443949648, "question_id": 32931825, "link": "https://stackoverflow.com/questions/32931825/how-to-use-r-do-and-r-branch-in-gorethink", "closed_reason": "Not suitable for this site", "title": "How to use r.Do and r.Branch in gorethink?", "body": "<p>I'm looking for clear example of r.Do() and r.Branch() functions in gorethink.</p>\n"}, {"tags": ["unit-testing", "testing", "go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443924909, "post_id": 32929319, "comment_id": 53684848, "body": "Or just remove that close statement altogether, since it doesn&#39;t do anything after that loop exits."}, {"owner": {"reputation": 11, "user_id": 1988954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a66673f19d1e67e7d5e3254927f690?s=128&d=identicon&r=PG", "display_name": "Jacob", "link": "https://stackoverflow.com/users/1988954/jacob"}, "edited": false, "score": 0, "creation_date": 1443998310, "post_id": 32929319, "comment_id": 53703640, "body": "Moving the close after I did <code>close(closeCh)</code> worked."}], "tags": [], "owner": {"reputation": 5392, "user_id": 361836, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f426a26f03d7d4d61d354a3b2fc5337d?s=128&d=identicon&r=PG", "display_name": "lucidquiet", "link": "https://stackoverflow.com/users/361836/lucidquiet"}, "is_accepted": true, "score": 2, "last_activity_date": 1443924111, "creation_date": 1443924111, "answer_id": 32929319, "question_id": 32928843, "link": "https://stackoverflow.com/questions/32928843/golang-string-channel-send-receive-inconsistency/32929319#32929319", "title": "golang string channel send/receive inconsistency", "body": "<p>Check out this article about <a href=\"http://dave.cheney.net/2014/03/19/channel-axioms\" rel=\"nofollow\">channel-axioms</a>.  Looks like there's a race between closing <code>wdCh</code> and sending true on the <code>closeCh</code> channel.</p>\n\n<p>So the outcome depends on what gets scheduled first between <code>pushWords</code> returning and <code>Accumulate</code>.</p>\n\n<p>If <code>TestAccumulate</code> runs first, sending true on <code>closeCh</code>, then when <code>Accumulate</code> runs it picks either of the two channels since they can both be run because <code>pushWords</code> closed <code>wdCh</code>.</p>\n\n<blockquote>\n  <p>A receive from a closed channel returns the zero value immediately.</p>\n</blockquote>\n\n<p>Until <code>closedCh</code> is signaled, <code>Accumulate</code> will randomly put one or more empty \"\" words in the map.</p>\n\n<p>If <code>Accumulate</code> runs first then it's likely to put many empty strings in the word map as it loops until <code>TestAccumulate</code> runs and finally it sends a signal on <code>closeCh</code>.</p>\n\n<p>An easy fix would be to move</p>\n\n<p><code>close(wdCh)</code></p>\n\n<p>after sending <code>true</code> on the <code>closeCh</code>.  That way <code>wdCh</code> can't return the zero value until after you've signaled on the <code>closeCh</code>.  Additionally, <code>closeCh &lt;- true</code> blocks because <code>closeCh</code> doesn't have a buffer size, so <code>wdCh</code> won't get closed until after you've guaranteed that <code>Accumulate</code> has finished looping forever.</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1446989831, "post_id": 32931028, "comment_id": 54964012, "body": "This causes the closed channel to turn the loop into a busy wait, which in turn can cause more problems"}], "tags": [], "owner": {"reputation": 1, "user_id": 5387277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c0a1ebd31b23adef288dfacb2419b1?s=128&d=identicon&r=PG&f=1", "display_name": "linuxr", "link": "https://stackoverflow.com/users/5387277/linuxr"}, "is_accepted": false, "score": -2, "last_activity_date": 1443943272, "creation_date": 1443943272, "answer_id": 32931028, "question_id": 32928843, "link": "https://stackoverflow.com/questions/32928843/golang-string-channel-send-receive-inconsistency/32931028#32931028", "title": "golang string channel send/receive inconsistency", "body": "<p>I think the reason is when you close the channle, \"select\" will although receive the signal.</p>\n\n<p>So when you close \"wdCh\" in \"func pushWords\", the loop in Accumulate will receive signal from \"&lt;-wdCh\".\nMay be you should add some code to test the action after channel is closed!</p>\n\n<pre><code>for {\n    select {\n    case word, ok := &lt;-wdCh:\n        if !ok {\n            fmt.Println(\"channel wdCh is closed!\")\n            continue\n        }\n        fmt.Printf(\"word = %s\\n\", word)\n        words[word]++\n    case &lt;-closeCh:\n        return\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 1988954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a66673f19d1e67e7d5e3254927f690?s=128&d=identicon&r=PG", "display_name": "Jacob", "link": "https://stackoverflow.com/users/1988954/jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 32929319, "answer_count": 2, "score": 0, "last_activity_date": 1483256006, "creation_date": 1443918379, "last_edit_date": 1483256006, "question_id": 32928843, "link": "https://stackoverflow.com/questions/32928843/golang-string-channel-send-receive-inconsistency", "title": "golang string channel send/receive inconsistency", "body": "<p>New to go. I'm using 1.5.1. I'm trying to accumulate a word list based on an incoming channel. However, my input channel (wdCh) is sometimes getting the empty string (\"\") during testing. I'm perplexed. I'd rather not have a test for the empty string before I add its accumulated count in my map. Feels like a hack to me.</p>\n\n<pre><code>package accumulator\n\nimport (\n    \"fmt\"\n    \"github.com/stretchr/testify/assert\"\n    \"testing\"\n)\n\nvar words map[string]int\n\nfunc Accumulate(wdCh chan string, closeCh chan bool) {\n    words = make(map[string]int)\n    for {\n        select {\n        case word := &lt;-wdCh:\n            fmt.Printf(\"word = %s\\n\", word)\n            words[word]++\n        case &lt;-closeCh:\n            return\n        }\n    }\n}\n\nfunc pushWords(w []string, wdCh chan string) {\n    for _, value := range w {\n        fmt.Printf(\"sending word = %s\\n\", value)\n        wdCh &lt;- value\n    }\n    close(wdCh)\n}\n\nfunc TestAccumulate(t *testing.T) {\n    sendWords := []string{\"one\", \"two\", \"three\", \"two\"}\n    wMap := make(map[string]int)\n    wMap[\"one\"] = 1\n    wMap[\"two\"] = 2\n    wMap[\"three\"] = 1\n\n    wdCh := make(chan string)\n    closeCh := make(chan bool)\n\n    go Accumulate(wdCh, closeCh)\n    pushWords(sendWords, wdCh)\n\n    closeCh &lt;- true\n    close(closeCh)\n\n    assert.Equal(t, wMap, words)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4662, "user_id": 140377, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d421e9a5c4254129b7159ec2717da5ac?s=128&d=identicon&r=PG", "display_name": "Swoogan", "link": "https://stackoverflow.com/users/140377/swoogan"}, "edited": false, "score": 1, "creation_date": 1443917745, "post_id": 32928516, "comment_id": 53683624, "body": "I can run your code without issue in my environment. I don&#39;t think this is a programming problem. Can you create a log.txt file in the logs directory outside of your program?"}, {"owner": {"reputation": 221, "user_id": 5263606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a1d28142c5d031127016fe1b4e49fe4?s=128&d=identicon&r=PG&f=1", "display_name": "eTomate", "link": "https://stackoverflow.com/users/5263606/etomate"}, "reply_to_user": {"reputation": 4662, "user_id": 140377, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d421e9a5c4254129b7159ec2717da5ac?s=128&d=identicon&r=PG", "display_name": "Swoogan", "link": "https://stackoverflow.com/users/140377/swoogan"}, "edited": false, "score": 0, "creation_date": 1443946160, "post_id": 32928516, "comment_id": 53688466, "body": "The problem was in ChDir, which was called everytime and changed the directory over and over again, much further in the tree than only <code>..</code>"}], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 5263606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a1d28142c5d031127016fe1b4e49fe4?s=128&d=identicon&r=PG&f=1", "display_name": "eTomate", "link": "https://stackoverflow.com/users/5263606/etomate"}, "is_accepted": true, "score": 1, "last_activity_date": 1443946598, "creation_date": 1443946598, "answer_id": 32931431, "question_id": 32928516, "link": "https://stackoverflow.com/questions/32928516/os-openfile-permission-problems-in-test/32931431#32931431", "title": "os.OpenFile permission problems in test", "body": "<p>So I was able to solve this problem.</p>\n\n<pre><code>os.Chdir(\"..\")\n</code></pre>\n\n<p>was called over and over again. And obviously the current working directory is stored and doesn't change back to what it was after the func was done.</p>\n\n<p>After removing it, everything worked perfectly normal. I just added the <code>../</code> to the <code>os.Mkdir</code> and to <code>os.OpenFile</code>.</p>\n\n<p>I'm looking to work with environment variables to makes this work better I think.</p>\n"}], "owner": {"reputation": 221, "user_id": 5263606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a1d28142c5d031127016fe1b4e49fe4?s=128&d=identicon&r=PG&f=1", "display_name": "eTomate", "link": "https://stackoverflow.com/users/5263606/etomate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1626, "favorite_count": 0, "accepted_answer_id": 32931431, "answer_count": 1, "score": 0, "last_activity_date": 1443946598, "creation_date": 1443914903, "last_edit_date": 1443915856, "question_id": 32928516, "link": "https://stackoverflow.com/questions/32928516/os-openfile-permission-problems-in-test", "title": "os.OpenFile permission problems in test", "body": "<p>I'm currently having a problem with os.OpenFile. It just gives me \"permission denied\" when i run my go test.</p>\n\n<pre><code>type log struct {\n    Message   string\n    Source    string\n    Timestamp time.Time\n    ErrorCode ErrorCode\n}\n\ntype ErrorCode int\n\nconst (\n    Info ErrorCode = 1 + iota\n    Warning\n    Error\n)\n\nfunc (errorCode ErrorCode) String() string {\n    switch errorCode {\n    case Info:\n            return \"Info\"\n    case Warning:\n            return \"Warning\"\n    case Error:\n            return \"Error\"\n    }\n    return \"Type not found\"\n}\n\nfunc writeToLog(logItem log) {\n    err := os.Chdir(\"..\")\n    if err != nil {\n            fmt.Println(\"Can't change working directory\")\n    }\n    err = os.Mkdir(\"logs\", os.FileMode(0777))\n    if err != nil &amp;&amp; os.IsNotExist(err) {\n            fmt.Println(\"Can't create log directory\")\n    }\n    f, err := os.OpenFile(\"logs/log.txt\",\n            os.O_WRONLY|os.O_CREATE|os.O_APPEND, os.FileMode(0666))\n    if err != nil {\n            fmt.Println(\"Can't find logfile\")\n            fmt.Println(err)\n    }\n    defer f.Sync()\n    defer f.Close()\n\n    f.WriteString(logItem.ErrorCode.String() + logItem.Source +\n            logItem.Message + logItem.Timestamp.String())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Can't find logfile\nopen logs/log.txt: permission denied\nCan't find logfile\nopen logs/log.txt: permission denied\n</code></pre>\n\n<p>What am I doint wrong? It seems like OpenFile doesn't set my permissions correctly (-rw-r--r--).</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go", "debian"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1443908902, "post_id": 32927645, "comment_id": 53681791, "body": "The go tools work on packages, not files. <code>go install test</code>"}, {"owner": {"reputation": 2269, "user_id": 3016716, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wCaTR.jpg?s=128&g=1", "display_name": "shivams", "link": "https://stackoverflow.com/users/3016716/shivams"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443913192, "post_id": 32927645, "comment_id": 53682830, "body": "@JimB Yeah i understand this the hard way. :P"}, {"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 0, "creation_date": 1443930505, "post_id": 32927645, "comment_id": 53685668, "body": "Alternatively, <code>go install</code> when inside the package directory."}], "answers": [{"comments": [{"owner": {"reputation": 2269, "user_id": 3016716, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wCaTR.jpg?s=128&g=1", "display_name": "shivams", "link": "https://stackoverflow.com/users/3016716/shivams"}, "edited": false, "score": 1, "creation_date": 1444077978, "post_id": 32932925, "comment_id": 53740118, "body": "Thanks a lot. I understand that from @JimB comment but your answer explained it very clearly."}], "tags": [], "owner": {"reputation": 70819, "user_id": 1624921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/keNmm.jpg?s=128&g=1", "display_name": "Games Brainiac", "link": "https://stackoverflow.com/users/1624921/games-brainiac"}, "is_accepted": true, "score": 6, "last_activity_date": 1443957919, "creation_date": 1443957919, "answer_id": 32932925, "question_id": 32927645, "link": "https://stackoverflow.com/questions/32927645/go-install-not-working/32932925#32932925", "title": "go install not working", "body": "<p>As @JimB states, <code>install</code> is a command designed for packages. Just to give you a clear example, here is what I get when I run the <code>go env</code> command.</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"/Users/quazinafiulislam/Code/go/ogolang/bin\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/quazinafiulislam/Code/go/ogolang\"\nGORACE=\"\"\nGOROOT=\"/usr/local/Cellar/go/1.5.1/libexec\"\nGOTOOLDIR=\"/usr/local/Cellar/go/1.5.1/libexec/pkg/tool/darwin_amd64\"\nGO15VENDOREXPERIMENT=\"\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>You will see that the <code>GOPATH</code> is set to my project root, <code>~/Code/go/ogolang</code>. Now, lets see whats inside my project root.</p>\n\n<pre><code>.\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 pkg\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 darwin_amd64\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 bitbucket.org\n    \u251c\u2500\u2500 github.com\n    \u251c\u2500\u2500 golang.org\n    \u251c\u2500\u2500 words\n    \u2514\u2500\u2500 wordtest\n</code></pre>\n\n<p>As you can see I have a couple of packages. One of them is <code>wordtest</code>. I can use a <code>go install</code> on the <code>words</code> or <code>wordtest</code> packages. So, lets run <code>go install words</code> and see what happens to the directory.</p>\n\n<pre><code>.\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 words\n\u251c\u2500\u2500 pkg\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 darwin_amd64\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 bitbucket.org\n    \u251c\u2500\u2500 github.com\n    \u251c\u2500\u2500 golang.org\n    \u251c\u2500\u2500 words\n    \u2514\u2500\u2500 wordtest\n</code></pre>\n\n<p>Now, we can see that we have a <code>words</code> binary created for us(inside the <code>bin</code> directory), and we can run it by invoking <code>./bin/words</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1530068663, "last_edit_date": 1530068663, "creation_date": 1498008917, "answer_id": 44665492, "question_id": 32927645, "link": "https://stackoverflow.com/questions/32927645/go-install-not-working/44665492#44665492", "title": "go install not working", "body": "<p>According to <code>Games Brainiac</code> go install work on packages is correct. But let me add some details into it regarding creating packages using go install in main directory.</p>\n\n<pre><code>  .\n  \u251c\u2500\u2500 bin\n  \u2502   \u2514\u2500\u2500 app\n  \u251c\u2500\u2500 pkg\n  \u2502   \u2514\u2500\u2500 linux_amd64\n  |         \u2514\u2500\u2500 user\n  |              \u2514\u2500\u2500 handlers.a\n  \u2514\u2500\u2500 src\n    \u251c\u2500\u2500 bitbucket.org\n    \u251c\u2500\u2500 github.com\n         \u2514\u2500\u2500 user\n              \u2514\u2500\u2500 app\n                   \u251c\u2500\u2500 main.go\n                   \u2514\u2500\u2500 handlers\n                         \u2514\u2500\u2500handlers.go\n</code></pre>\n\n<p>Have a look at above directory structure, I have created a package in a folder handlers having source file <code>handlers.go</code> .And I wants to build that package, I will run <code>go build</code> inside handlers folder which just show our file has no compilation errors and returns nothing in that case.</p>\n\n<p>To build a package with main file we need to run <code>go install</code> inside app folder. This will create handlers.a package object inside <code>$GOPATH/pkg</code> and executable file inside <code>$GOPATH/bin</code> with name of folder <code>(app in this case)</code> in which we have main.go file using package main.</p>\n"}], "owner": {"reputation": 2269, "user_id": 3016716, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wCaTR.jpg?s=128&g=1", "display_name": "shivams", "link": "https://stackoverflow.com/users/3016716/shivams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11198, "favorite_count": 0, "accepted_answer_id": 32932925, "answer_count": 2, "score": 2, "last_activity_date": 1563213086, "creation_date": 1443907514, "question_id": 32927645, "link": "https://stackoverflow.com/questions/32927645/go-install-not-working", "title": "go install not working", "body": "<p>I am using <code>go version go1.5.1 linux/amd64</code> on <code>debian 8.2 3.16.0-4-amd64</code>. I installed <code>golang</code> using <a href=\"https://golang.org/doc/install\" rel=\"nofollow\">https://golang.org/doc/install</a>.</p>\n\n<p>This is what i put in my <code>~/.profile</code> file</p>\n\n<pre><code>export GOPATH=$HOME/go\nexport PATH=$PATH:/usr/local/go/bin:/home/shivams/go/bin\n</code></pre>\n\n<p>Running <code>go env</code> on my machine is giving this output</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/shivams/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Directory structure inside <code>/home/shivams/go</code> is <code>{pkg,src,bin}</code>. Inside src directory it is like <code>test/hello.go</code>.</p>\n\n<p>If i am in <code>src</code> dir and run <code>go run test/hello.go</code> it is running perfectly. Also if i run <code>go build test/hello.go</code> it will create one executable <code>hello</code> file in same directory.</p>\n\n<p>But if i try to run <code>go install test/hello.go</code> then i get this error\n<code>go install: no install location for .go files listed on command line (GOBIN not set)</code>. If i set <code>GOBIN</code> explicitly then i am not able to see this error. </p>\n\n<p>From what i read my understanding is that if GOPATH is set there is no need to set GOBIN variable. </p>\n\n<p>Am i missing anything here? This is the first time i am trying go and not able to get this working.</p>\n"}, {"tags": ["c++", "go", "swig", "istream", "cgo"], "comments": [{"owner": {"reputation": 1095, "user_id": 1030873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81783d79b9967bf327cdafdcc0f4cd46?s=128&d=identicon&r=PG", "display_name": "Sly", "link": "https://stackoverflow.com/users/1030873/sly"}, "edited": false, "score": 0, "creation_date": 1449137217, "post_id": 32927452, "comment_id": 55879238, "body": "Did you ever find a solution for this?"}, {"owner": {"reputation": 32492, "user_id": 31516, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/SOucS.jpg?s=128&g=1", "display_name": "David Brown", "link": "https://stackoverflow.com/users/31516/david-brown"}, "reply_to_user": {"reputation": 1095, "user_id": 1030873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81783d79b9967bf327cdafdcc0f4cd46?s=128&d=identicon&r=PG", "display_name": "Sly", "link": "https://stackoverflow.com/users/1030873/sly"}, "edited": false, "score": 0, "creation_date": 1449156028, "post_id": 32927452, "comment_id": 55892285, "body": "Nope, not yet. Sorry!"}], "answers": [{"comments": [{"owner": {"reputation": 32492, "user_id": 31516, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/SOucS.jpg?s=128&g=1", "display_name": "David Brown", "link": "https://stackoverflow.com/users/31516/david-brown"}, "edited": false, "score": 0, "creation_date": 1463949184, "post_id": 37379009, "comment_id": 62269743, "body": "<code>std::istream</code> is just an abstraction over a stream of bytes like <code>io.Reader</code>. Only the <code>std::ifstream</code> implementation actually deals with files."}, {"owner": {"reputation": 3305, "user_id": 439189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37ac47f749d07e74b36ecb1866a8265?s=128&d=identicon&r=PG", "display_name": "Ash Berlin-Taylor", "link": "https://stackoverflow.com/users/439189/ash-berlin-taylor"}, "reply_to_user": {"reputation": 32492, "user_id": 31516, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/SOucS.jpg?s=128&g=1", "display_name": "David Brown", "link": "https://stackoverflow.com/users/31516/david-brown"}, "edited": false, "score": 0, "creation_date": 1463956788, "post_id": 37379009, "comment_id": 62271710, "body": "True,true. It&#39;s more work but probably possible then to write an adapter  that calls back into go to read from the io.Reader. Getting the GC right so that the reader doesn&#39;t get destroyed under you is where most of the work might be then."}, {"owner": {"reputation": 32492, "user_id": 31516, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/SOucS.jpg?s=128&g=1", "display_name": "David Brown", "link": "https://stackoverflow.com/users/31516/david-brown"}, "edited": false, "score": 0, "creation_date": 1464015080, "post_id": 37379009, "comment_id": 62297162, "body": "Well, since Go doesn&#39;t allow Go pointers to be passed to C code, the usual solution is to store the object in a map and pass the key back and forth. The object won&#39;t be GC&#39;d until it&#39;s remove from the map. My question isn&#39;t so much about how to make the <code>std::streambuf</code>, but instead how to get SWIG to use that implementation whenever it encounters a C++ API that takes a <code>std::istream</code>."}], "tags": [], "owner": {"reputation": 3305, "user_id": 439189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37ac47f749d07e74b36ecb1866a8265?s=128&d=identicon&r=PG", "display_name": "Ash Berlin-Taylor", "link": "https://stackoverflow.com/users/439189/ash-berlin-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1463946978, "last_edit_date": 1495541767, "creation_date": 1463946978, "answer_id": 37379009, "question_id": 32927452, "link": "https://stackoverflow.com/questions/32927452/how-do-i-convert-an-io-reader-to-a-stdistream-with-swig-cgo/37379009#37379009", "title": "How do I convert an io.Reader to a std::istream with SWIG &amp; CGO?", "body": "<p><code>io.Reader</code> is too general to be passed to C functions -- it might not be backed on a real file at all (it's just a class that implements a Read(...) function)</p>\n\n<p>What you could do (so long as you aren't on windows) is use <code>os.Pipe()</code> to give you a ture FH object, but sadly the stock std::*stream doesn't have any way of creating a stream from an open file handle. </p>\n\n<p>The pipe bit looks something like this:</p>\n\n<pre><code>func wrapReader(r io.Reader) uintptr {\n    pr, pw, err := os.Pipe()\n    if err != nil {\n        panic(err)\n    }\n\n    go func () {\n        _, _ io.Copy(pw, r)\n        _ = pw.Close()\n    }()\n\n    return pr\n}\n</code></pre>\n\n<p>If you combine that some of the code in this answer <a href=\"https://stackoverflow.com/questions/2746168/how-to-construct-a-c-fstream-from-a-posix-file-descriptor#5253726\">How to construct a c++ fstream from a POSIX file descriptor?</a> you might get what you need</p>\n"}], "owner": {"reputation": 32492, "user_id": 31516, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/SOucS.jpg?s=128&g=1", "display_name": "David Brown", "link": "https://stackoverflow.com/users/31516/david-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463946978, "creation_date": 1443906046, "last_edit_date": 1443907459, "question_id": 32927452, "link": "https://stackoverflow.com/questions/32927452/how-do-i-convert-an-io-reader-to-a-stdistream-with-swig-cgo", "title": "How do I convert an io.Reader to a std::istream with SWIG &amp; CGO?", "body": "<p>I'm trying to use SWIG to create a Go wrapper for a C++ API that uses <code>std::istream</code> to read binary data. I'd like to be able to pass an <code>io.Reader</code> to these APIs, but I'm not sure how to create a mapping between it and <code>std::istream</code>. I know I need to implement a <code>std::streambuf</code> subclass and I assume the rest will involve directors and typemaps, but I'm not familiar enough with SWIG to figure out the right combination.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 3178, "user_id": 1112407, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/rmH5U.jpg?s=128&g=1", "display_name": "nucleartide", "link": "https://stackoverflow.com/users/1112407/nucleartide"}, "is_accepted": true, "score": 8, "last_activity_date": 1443893509, "last_edit_date": 1443893509, "creation_date": 1443892826, "answer_id": 32925345, "question_id": 32925344, "link": "https://stackoverflow.com/questions/32925344/why-is-there-a-fm-suffix-when-getting-a-functions-name-in-go/32925345#32925345", "title": "Why is there a &quot;-fm&quot; suffix when getting a function&#39;s name in Go?", "body": "<p>Turns out <code>u.DummyHandler</code> is a method value and the compiler implements methods by creating a function closure and modifying the function name. To quote Ian <a href=\"http://grokbase.com/t/gg/golang-nuts/153jyb5b7p/go-nuts-fm-suffix-in-function-name-what-does-it-mean#20150318ssinqqzrmhx2ep45wjkxsa4rua\" rel=\"noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p>This seems to have become -fm on tip, by the way.</p>\n  \n  <p>Your code is getting a method value. p.beHappy is the beHappy method\n  bound to the specific value of p. That is implemented by creating a\n  function closure, and the code for that closure needs a name. The\n  compiler happens to make that name by sticking fm on the end, but it\n  could be anything that won't conflict with any other function name.\n  There isn't any way to name that function in Go, so the name is\n  irrelevant for anything other than the debugger or, as you see,\n  FuncForPC.</p>\n</blockquote>\n\n<p>It seems like a better way to get a method's name is to reference the method directly, like so:</p>\n\n<pre><code>func main() {\n  funcName((User).DummyHandler)\n}\n</code></pre>\n\n<p>This will output <code>main.User.DummyHandler</code>.</p>\n"}], "owner": {"reputation": 3178, "user_id": 1112407, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/rmH5U.jpg?s=128&g=1", "display_name": "nucleartide", "link": "https://stackoverflow.com/users/1112407/nucleartide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 2, "accepted_answer_id": 32925345, "answer_count": 1, "score": 6, "last_activity_date": 1443893509, "creation_date": 1443892826, "question_id": 32925344, "link": "https://stackoverflow.com/questions/32925344/why-is-there-a-fm-suffix-when-getting-a-functions-name-in-go", "title": "Why is there a &quot;-fm&quot; suffix when getting a function&#39;s name in Go?", "body": "<p>For the snippet below (<a href=\"http://play.golang.org/p/mmIE8jfPY0\" rel=\"noreferrer\">runnable via the Go Playground</a>),</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net/http\"\n  \"reflect\"\n  \"runtime\"\n)\n\ntype User struct{}\n\nvar u = &amp;User{}\n\nfunc (_ User) DummyHandler(w http.ResponseWriter, r *http.Request) {}\n\nfunc funcName(i interface{}) {\n  p := reflect.ValueOf(i).Pointer()\n  n := runtime.FuncForPC(p).Name()\n  fmt.Println(n)\n}\n\nfunc main() {\n  funcName(u.DummyHandler)\n}\n</code></pre>\n\n<p>The output is <code>main.(User).DummyHandler-fm</code>.</p>\n\n<p>Why is there a <code>-fm</code> at the end of the function name?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1443890728, "post_id": 32922581, "comment_id": 53676439, "body": "why do you do that?What not satisfied with the way Gin?"}, {"owner": {"reputation": 2701, "user_id": 3834274, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/181df7f83907b7bc00bbaa66622068c3?s=128&d=identicon&r=PG&f=1", "display_name": "FireGM", "link": "https://stackoverflow.com/users/3834274/firegm"}, "edited": false, "score": 0, "creation_date": 1443907554, "post_id": 32922581, "comment_id": 53681383, "body": "I dont know Gin-way. I  want DRY. I have pkg auth and i want it use as route.Include(path, route_from_auth_pkg)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1443907809, "post_id": 32922581, "comment_id": 53681461, "body": "Unfortunately I do not understand what you need."}, {"owner": {"reputation": 2701, "user_id": 3834274, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/181df7f83907b7bc00bbaa66622068c3?s=128&d=identicon&r=PG&f=1", "display_name": "FireGM", "link": "https://stackoverflow.com/users/3834274/firegm"}, "edited": false, "score": 0, "creation_date": 1443912074, "post_id": 32922581, "comment_id": 53682602, "body": "I wrote example, mb it help. <a href=\"https://github.com/FireGM/gin-example\" rel=\"nofollow noreferrer\">github.com/FireGM/gin-example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2701, "user_id": 3834274, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/181df7f83907b7bc00bbaa66622068c3?s=128&d=identicon&r=PG&f=1", "display_name": "FireGM", "link": "https://stackoverflow.com/users/3834274/firegm"}, "edited": false, "score": 0, "creation_date": 1443876917, "post_id": 32922709, "comment_id": 53672297, "body": "No. I&#39;m talk about portability. For write router in package and then do main route from package&#39;s route. Sorry for my bad english."}], "tags": [], "owner": {"reputation": 14588, "user_id": 3166303, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/877b076ec96e4ab48f7f4567c1ea2741?s=128&d=identicon&r=PG", "display_name": "leeor", "link": "https://stackoverflow.com/users/3166303/leeor"}, "is_accepted": false, "score": 1, "last_activity_date": 1443876197, "creation_date": 1443876197, "answer_id": 32922709, "question_id": 32922581, "link": "https://stackoverflow.com/questions/32922581/golang-gin-router-like-django/32922709#32922709", "title": "golang gin: router like django?", "body": "<p>If I understand your question correctly, I think you can accomplish this with route grouping. So you would have something like this:</p>\n\n<pre><code>r := gin.New()\nmain := r.Group(\"/main\")\n{\n  main.GET(\"/test\", hello)\n}\n</code></pre>\n\n<p>See more details <a href=\"https://github.com/gin-gonic/gin#grouping-routes\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2701, "user_id": 3834274, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/181df7f83907b7bc00bbaa66622068c3?s=128&d=identicon&r=PG&f=1", "display_name": "FireGM", "link": "https://stackoverflow.com/users/3834274/firegm"}, "is_accepted": true, "score": 2, "last_activity_date": 1444049828, "creation_date": 1444049828, "answer_id": 32949245, "question_id": 32922581, "link": "https://stackoverflow.com/questions/32922581/golang-gin-router-like-django/32949245#32949245", "title": "golang gin: router like django?", "body": "<p>in main route like here</p>\n\n<pre><code>package main\n\nimport (\n  \"path_to_pkg/pkg\"\n\n  \"github.com/gin-gonic/gin\"\n)\n\nvar r *gin.Engine\n\nfunc init() {\n  r = gin.New()\n  pkg.Concon(r.Group(\"/pkg\"))\n\n}\n\nfunc main() {\n  r.Run(\":8080\")\n}\n</code></pre>\n\n<p>in imported package create concatenation func</p>\n\n<p>pkg.go</p>\n\n<pre><code>package pkg\n\nimport \"github.com/gin-gonic/gin\"\n\nfunc Concon(g *gin.RouterGroup) {\n  g.GET(\"/ping\", func(c *gin.Context) {\n    c.String(200, \"pong\")\n  })\n}\n</code></pre>\n\n<p>open 127.0.0.1:8080/pkg/ping and get \"pong\" </p>\n"}], "owner": {"reputation": 2701, "user_id": 3834274, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/181df7f83907b7bc00bbaa66622068c3?s=128&d=identicon&r=PG&f=1", "display_name": "FireGM", "link": "https://stackoverflow.com/users/3834274/firegm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "accepted_answer_id": 32949245, "answer_count": 2, "score": 1, "last_activity_date": 1444049828, "creation_date": 1443875448, "last_edit_date": 1443877652, "question_id": 32922581, "link": "https://stackoverflow.com/questions/32922581/golang-gin-router-like-django", "title": "golang gin: router like django?", "body": "<p>Can <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">gin</a> describe route like django?</p>\n\n<p>In all examples, the routers are in one place, never found about attachment.</p>\n\n<p>I would like to describe the routes in the package, and in the main file is simply to write something like.\nexample:</p>\n\n<pre><code>r := gin.New()\nr.Include(\"/main\", here_imported_route.Route)\n</code></pre>\n\n<h1>here_imported_route.go</h1>\n\n<pre><code>package here_imported_route\n\nRouter := gin.New()\nRouter.Use(midl())\nRouter.Get(\"/test\", hello)\n</code></pre>\n\n<p>and then on \"/main/test\" we get \"hello\".</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1443877046, "post_id": 32922572, "comment_id": 53672335, "body": "What is the error you get?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1443877155, "post_id": 32922572, "comment_id": 53672366, "body": "Further: your <code>dbType.DbConnect()</code> method returns a <code>DatabaseType</code> with an initialized connection, but you&#39;re ignoring the return value entirely."}, {"owner": {"reputation": 6166, "user_id": 1370370, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fb671a9cb0df8a662328d87de693e0ae?s=128&d=identicon&r=PG", "display_name": "iWizard", "link": "https://stackoverflow.com/users/1370370/iwizard"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1443877531, "post_id": 32922572, "comment_id": 53672502, "body": "@elithrar - you are correct. Typical start mistake"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1443877573, "post_id": 32922572, "comment_id": 53672514, "body": "PS: Have a read of <a href=\"http://www.alexedwards.net/blog/organising-database-access#using-an-interface\" rel=\"nofollow noreferrer\">alexedwards.net/blog/&hellip;</a> and <a href=\"https://robots.thoughtbot.com/interface-with-your-database-in-go\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/interface-with-your-database-in-go</a> - it may help simplify the code you have. Could be simpler!"}, {"owner": {"reputation": 6166, "user_id": 1370370, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fb671a9cb0df8a662328d87de693e0ae?s=128&d=identicon&r=PG", "display_name": "iWizard", "link": "https://stackoverflow.com/users/1370370/iwizard"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1443877823, "post_id": 32922572, "comment_id": 53672587, "body": "@elithrar - can you point me what certain of code can I simplify?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1443878294, "post_id": 32922572, "comment_id": 53672722, "body": "See my answer below."}, {"owner": {"reputation": 6166, "user_id": 1370370, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fb671a9cb0df8a662328d87de693e0ae?s=128&d=identicon&r=PG", "display_name": "iWizard", "link": "https://stackoverflow.com/users/1370370/iwizard"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1443894675, "post_id": 32922572, "comment_id": 53677735, "body": "it would be great that who gave mi &quot;vote down&quot; gives an explanation for that"}], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 1, "last_activity_date": 1443878282, "creation_date": 1443878282, "answer_id": 32923040, "question_id": 32922572, "link": "https://stackoverflow.com/questions/32922572/share-database-connection-with-packages/32923040#32923040", "title": "Share database connection with packages", "body": "<p>Your <code>dbType.DbConnect()</code> method returns a <code>DatabaseType</code> with an initialized connection, but you're ignoring the return value entirely.</p>\n\n<p>Further - to simplify your code - look at having <code>New(host string) *DB</code> instead of <em>three</em> different functions (New/DbConnect/GetDb) that do the same thing.</p>\n\n<p>e.g.</p>\n\n<pre><code>package datastore\n\ntype DB struct {\n    // Directly embed this\n    *sql.DB\n}\n\nfunc NewDB(host string) (*DB, error) {\n    db, err := sql.Open(...)\n    if err != nil {\n        return nil, err\n    }\n\n    return &amp;DB{db}, nil\n}\n</code></pre>\n\n<hr>\n\n<pre><code>package main\n\nvar db *datastore.DB\n\nfunc main() {\n    var err error\n    db, err = datastore.NewDB(host)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err := someFunc()\n}\n\nfunc someFunc() error {\n    rows, err := db.Exec(\"DELETE FROM ...\")\n    // Handle the error, parse the result, etc.\n}\n</code></pre>\n\n<p>This reduces the juggling you have to do, and you can still call close on your DB type because it embeds <code>*sql.DB</code> - there's no need to implement your own <code>Close()</code> method.</p>\n"}], "owner": {"reputation": 6166, "user_id": 1370370, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fb671a9cb0df8a662328d87de693e0ae?s=128&d=identicon&r=PG", "display_name": "iWizard", "link": "https://stackoverflow.com/users/1370370/iwizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 32923040, "answer_count": 1, "score": 0, "last_activity_date": 1443878282, "creation_date": 1443875380, "question_id": 32922572, "link": "https://stackoverflow.com/questions/32922572/share-database-connection-with-packages", "title": "Share database connection with packages", "body": "<p>I'm new with golang. I'm trying to share mysql database connection in my package, latter maybe in several packages. To skip defining database connection in every package I've created Database package and now I'm trying to get that package, connect to db and use that object in whole package.</p>\n\n<p>I'm using this mysql plugin: github.com/go-sql-driver/mysql</p>\n\n<p>here is my code:</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"./packages/db\" // this is my custom database package\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nvar dbType Database.DatabaseType\nvar db *sql.DB\n\nfunc main() {\n    log.Printf(\"-- entering main...\")\n    dbType := Database.New()\n    db = dbType.GetDb()\n\n    dbType.DbConnect()\n\n    delete_test_data()\n\n    dbType.DbClose()\n}\n\nfunc delete_test_data(){\n    log.Printf(\"-- entering delete_test_data...\")\n\n    //db.Exec(\"DELETE FROM test;\")\n}\n</code></pre>\n\n<p>packages/db/db.go</p>\n\n<pre><code>package Database\n\nimport (\n    \"log\"\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\ntype DatabaseType struct {\n   DatabaseObject *sql.DB\n}\n\nfunc New()(d *DatabaseType) {\n    d = new(DatabaseType)\n    //db.DatabaseObject = db.DbConnect()\n    return d\n}\n\n\nfunc (d *DatabaseType) DbConnect() *DatabaseType{\n    log.Printf(\"-- entering DbConnect...\")\n    var err error\n\n    if d.DatabaseObject == nil {\n        log.Printf(\"--------- &gt; Database IS NIL...\")\n        d.DatabaseObject, err = sql.Open(\"mysql\", \"...\")\n        if err != nil {\n            panic(err.Error())\n        }\n\n        err = d.DatabaseObject.Ping()\n        if err != nil {\n            panic(err.Error())\n        }\n    }\n\n    return d\n}\n\nfunc (d *DatabaseType) DbClose(){\n    log.Printf(\"-- entering DbClose...\")\n    defer d.DatabaseObject.Close()\n}\n\nfunc (d *DatabaseType) GetDb() *sql.DB{\n   return d.DatabaseObject\n}\n</code></pre>\n\n<p>Everything is ok and without error until I uncomment this line:</p>\n\n<pre><code>db.Exec(\"DELETE FROM test;\")\n</code></pre>\n\n<p>Can someone tell me what is correct way to share db connection?</p>\n"}, {"tags": ["go", "process"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1443886212, "post_id": 32921792, "comment_id": 53675012, "body": "Side note: it&#39;s bad practice to wrap an underlying error by discarding everything but its string representation. E.g. your returned error gives the caller no sane way of testing for a <code>syscall.Error</code> value (one of the possible reasons the kill may fail). If you really need to wrap errors, see <code>os.PathError</code> and <code>strconv.NumError</code> as examples of a better way."}, {"owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1444070593, "post_id": 32921792, "comment_id": 53736141, "body": "This can be solved by creating a process group for command and then killing the process group instead of the process itself."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1444148299, "post_id": 32960666, "comment_id": 53774632, "body": "Minor note, the <code>Setpgid</code> field and the <code>syscall.Getpgid</code> call are OS specific. In particular they don&#39;t exist on Microsoft Windows so you may want to put such things in a file with <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\"><code>&#47;&#47; +build !windows</code></a> near the top."}], "tags": [], "owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "is_accepted": false, "score": 3, "last_activity_date": 1444097614, "creation_date": 1444097614, "answer_id": 32960666, "question_id": 32921792, "link": "https://stackoverflow.com/questions/32921792/how-do-you-kill-a-process-and-its-children-on-a-timeout-in-go-code/32960666#32960666", "title": "How do you kill a process and its children on a timeout in Go code?", "body": "<p>I think this is what you need:</p>\n\n<pre><code>cmd := exec.Command(command, arguments...)\n\n// This sets up a process group which we kill later.\ncmd.SysProcAttr = &amp;syscall.SysProcAttr{Setpgid: true}\n\nif err := cmd.Start(); err != nil {\n    return err\n}\n\n// buffered chan is important so the goroutine does't\n// get blocked and stick around if the function returns\n// after the timeout\ndone := make(chan error, 1)\n\ngo func() {\n    done &lt;- cmd.Wait()\n}()\n\nselect {\ncase err := &lt;-done:\n    // this will be nil if no error\n    return err\ncase &lt;-time.After(time.Second):\n    // We created a process group above which we kill here.\n    pgid, err := syscall.Getpgid(cmd.Process.Pid)\n    if err != nil {\n        return err\n    }\n    // note the minus sign\n    if err := syscall.Kill(-pgid, 15); err != nil {\n        return err\n    }\n    return fmt.Errorf(\"Timeout\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "is_accepted": false, "score": 0, "last_activity_date": 1591069001, "creation_date": 1591069001, "answer_id": 62144386, "question_id": 32921792, "link": "https://stackoverflow.com/questions/32921792/how-do-you-kill-a-process-and-its-children-on-a-timeout-in-go-code/62144386#62144386", "title": "How do you kill a process and its children on a timeout in Go code?", "body": "<p>It is not clear whether you have control of those child processes. If so, you could consider using the following Linux feature (you also don't say whether it's specific to an OS).</p>\n\n<p>This line of code asks the kernel to send a SIGHUP to the children when the parent's die. That way your Go process can just kill the parent and it will automatically kill all the children. Not only that, it never fails! The kernel is really good on that one.</p>\n\n<pre><code>prctl(PR_SET_PDEATHSIG, SIGHUP);\n</code></pre>\n\n<p>Of course, there is a race condition if you do just that. That is, by the time the child calls this <code>prctl()</code> function, the parent may have died already in which case the child needs to exit immediately.</p>\n\n<pre><code>if(getppid() != parent_pid)\n{\n    exit(1);\n}\n</code></pre>\n\n<p>So the complete code to avoid the race condition is:</p>\n\n<pre><code>// must happen before the fork() call\nconst pid_t parent_pid = getpid();\n\nconst pid_t child_pid = fork();\n\nif(child_pid != 0)\n{\n    // fork() failed (child_pid == -1) or worked (an actual PID)\n    ...\n    return;\n}\n\nprctl(PR_SET_PDEATHSIG, SIGHUP);\n\nif(getppid() != parent_pid)\n{\n    exit(1);\n}\n</code></pre>\n\n<p><em>Note: it is customary to use <code>SIGHUP</code> for this situation. You may want to consider other signals too, especially if the children deal with pipes/sockets (in which case you are likely to ignore <code>SIGHUP</code>!) or need to handle <code>SIGHUP</code> for other reasons.</em></p>\n\n<p>Now if you do not have any control over the code of the children processes... you could try to kill each one from your Go application by searching all the children, killing them one by one, and then kill the parent process. However, you always have a race condition that you can't avoid unless you can prevent that whole tree of children from creating new processes. If you can do that, then it's just a matter of registering the PID of all those children and killing them one by one.</p>\n\n<p>Of course, if you can create a group, much better. Like the SIGHUP above, killing all the members of a group is done by the kernel and it won't miss any processes.</p>\n"}], "owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1110, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1591069001, "creation_date": 1443870184, "last_edit_date": 1591067606, "question_id": 32921792, "link": "https://stackoverflow.com/questions/32921792/how-do-you-kill-a-process-and-its-children-on-a-timeout-in-go-code", "title": "How do you kill a process and its children on a timeout in Go code?", "body": "<p>I have a situation where I need to kill a process after some time. I start the process and then:</p>\n\n<pre><code>case &lt;-time.After(timeout):\n        if err := cmd.Process.Kill(); err != nil {\n            return 0, fmt.Errorf(\"Failed to kill process: %v\", err)\n        }\n</code></pre>\n\n<p>kills the process. But it only kills the parent process not the 5-10 child processes that main process starts. I also tried creating a process group and then doing:</p>\n\n<pre><code>syscall.Kill(-cmd.Process.Pid, syscall.SIGKILL)\n</code></pre>\n\n<p>to kill main and grandchild processes, but not working. Is there any other way I can kill the processes.</p>\n"}, {"tags": ["go", "fqdn"], "comments": [{"owner": {"reputation": 29, "user_id": 5403685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b407a06be7bf0c38b5808a885653be8?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Bailey", "link": "https://stackoverflow.com/users/5403685/kevin-bailey"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1443862364, "post_id": 32919572, "comment_id": 53668461, "body": "Nope.  That will not return the DNS suffix."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443870787, "post_id": 32919572, "comment_id": 53670594, "body": "How would you get the information from the OS? There&#39;s nothing specific to Go in this sense. Is the &#39;USERDNSDOMAIN&#39; environment variable set?"}, {"owner": {"reputation": 29, "user_id": 5403685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b407a06be7bf0c38b5808a885653be8?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Bailey", "link": "https://stackoverflow.com/users/5403685/kevin-bailey"}, "edited": false, "score": 0, "creation_date": 1443909017, "post_id": 32919572, "comment_id": 53681823, "body": "That will not work.  It is not commonly set.  Where to retrieve the connection DNS suffix depends on the OS.   There are api calls or an /etc file.  I found that Go does not provide a common way across OSs to get it and you will have to write the function yourself for each OS.  For Window I need to call the <code>IpAdapterAddresses</code> system call; on linux I will have to figure it out when I port the app to CentOS."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443970831, "post_id": 32919572, "comment_id": 53695084, "body": "That&#39;s what I&#39;m saying. IIRC <code>USERDNSDOMAIN</code> is set when the host is logged into an AD domain, which might not be there, but is it what you really want if it is? Go has no way of knowing what else you might want besides what&#39;s configured in the kernel. On linux do you want a PTR record for the first network interface, or do you want the hostname plus a &quot;domain&quot; entry from <code>resolv.conf</code>, or do you want the first fqdn listed in <code>&#47;etc&#47;hosts</code> for a local address, or do you want to use <code>nswitch.conf</code> to lookup the host from some other directory?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1533332816, "post_id": 32919572, "comment_id": 90324101, "body": "It doesn&#39;t make sense. The computer often does not know its own FQDN or may not have any way to access the information. There are so many ways for this to fail."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 4605530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59be45f33d85057c366fd91bde18dd10?s=128&d=identicon&r=PG", "display_name": "Medhi Bechina", "link": "https://stackoverflow.com/users/4605530/medhi-bechina"}, "is_accepted": false, "score": 3, "last_activity_date": 1542742044, "last_edit_date": 1542742044, "creation_date": 1450346442, "answer_id": 34331660, "question_id": 32919572, "link": "https://stackoverflow.com/questions/32919572/how-do-you-find-the-fqdn-of-the-local-host/34331660#34331660", "title": "How do you find the FQDN of the local host?", "body": "<p>By default there is no short way.</p>\n\n<p><a href=\"https://golang.org/pkg/os/#Hostname\" rel=\"nofollow noreferrer\">os.Hostname()</a> doesn't provide the Fully Qualified Domain Name by default.</p>\n\n<pre><code>cmd := exec.Command(\"/bin/hostname\", \"-f\")\nvar out bytes.Buffer\ncmd.Stdout = &amp;out\nerr := cmd.Run()\nif err != nil {\n    log.Errorf(err)\n}\nfqdn := out.String()\nfqdn = fqdn[:len(fqdn)-1] // removing EOL\n</code></pre>\n\n<hr>\n"}, {"tags": [], "owner": {"reputation": 555, "user_id": 26551, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c6dac87cb53a50c68c11366a41cadde?s=128&d=identicon&r=PG", "display_name": "quikchange", "link": "https://stackoverflow.com/users/26551/quikchange"}, "is_accepted": false, "score": 1, "last_activity_date": 1479347590, "creation_date": 1479347590, "answer_id": 40645454, "question_id": 32919572, "link": "https://stackoverflow.com/questions/32919572/how-do-you-find-the-fqdn-of-the-local-host/40645454#40645454", "title": "How do you find the FQDN of the local host?", "body": "<p>You can perform some gymnastics using the net lib as demonstrated <a href=\"https://github.com/ShowMax/go-fqdn/blob/master/fqdn.go\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1376, "user_id": 5695585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NZbcz-W6JS8/AAAAAAAAAAI/AAAAAAAAAIs/CMNazCoQxTE/photo.jpg?sz=128", "display_name": "Enrico Bianchi", "link": "https://stackoverflow.com/users/5695585/enrico-bianchi"}, "is_accepted": false, "score": 2, "last_activity_date": 1533328945, "last_edit_date": 1533328945, "creation_date": 1533297309, "answer_id": 51672069, "question_id": 32919572, "link": "https://stackoverflow.com/questions/32919572/how-do-you-find-the-fqdn-of-the-local-host/51672069#51672069", "title": "How do you find the FQDN of the local host?", "body": "<p>According to the documentation, function <code>os.Hostname()</code> returns the system host name reported by kernel. So, if your computer is named <code>computer1</code>, <code>os.Hostname()</code> returns <code>computer1</code>. If your computer is named <code>computer1.my.office</code>, <code>os.Hostname()</code> returns <code>computer1.my.office</code>. On Windows, is the same. If you want the domain name (as referred to the Active Directory domain) you have four ways:</p>\n\n<ol>\n<li>Parse the result of this command: <code>wmic computersystem get domain</code></li>\n<li>Parse the result of this command: <code>systeminfo | findstr /B /C:\"Domain\"</code></li>\n<li>Assume the existence of the environment variable <code>USERDNSDOMAIN</code> and evaluate his value (note that: the value of this variable is referred at the domain which user is stored)</li>\n<li>Check if one of the ip's assigned to the workstation can be resolved via DNS (for this point, you can view this: <a href=\"https://github.com/Showmax/go-fqdn\" rel=\"nofollow noreferrer\">https://github.com/Showmax/go-fqdn</a>)</li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 5403685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b407a06be7bf0c38b5808a885653be8?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Bailey", "link": "https://stackoverflow.com/users/5403685/kevin-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8044, "favorite_count": 2, "answer_count": 3, "score": 1, "last_activity_date": 1571299737, "creation_date": 1443853175, "last_edit_date": 1571299737, "question_id": 32919572, "link": "https://stackoverflow.com/questions/32919572/how-do-you-find-the-fqdn-of-the-local-host", "title": "How do you find the FQDN of the local host?", "body": "<p>How do you find the FQDN of the local host in Go?</p>\n\n<p>BTW: net.LookupAddr() doesn't work on Windows.  So that's not an option.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 5, "creation_date": 1443836043, "post_id": 32917990, "comment_id": 53663573, "body": "Please expand on your problem.  What have you tried?  What errors are you getting?  Include the portion of the code that you&#39;re working with"}, {"owner": {"reputation": 11, "user_id": 5341703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bujLC30sG4o/AAAAAAAAAAI/AAAAAAAAAFM/uc7FFtlEPwE/photo.jpg?sz=128", "display_name": "Aditya Budi Utomo", "link": "https://stackoverflow.com/users/5341703/aditya-budi-utomo"}, "reply_to_user": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "edited": false, "score": 0, "creation_date": 1443836537, "post_id": 32917990, "comment_id": 53663665, "body": "I learn jwt in golang, ex: I want to get <code>title</code> so when I run code I get <code>stack</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "is_accepted": true, "score": 1, "last_activity_date": 1443844012, "creation_date": 1443844012, "answer_id": 32918711, "question_id": 32917990, "link": "https://stackoverflow.com/questions/32917990/how-to-decode-map-golang/32918711#32918711", "title": "How to Decode map golang", "body": "<p>Once you have your map constructed, you can access a value of the map by providing the key.  The syntax is:</p>\n\n<pre><code>value := myMap[myKey]\n</code></pre>\n\n<p>The key's type can be any type that can be evaluated by a comparison operator ( <code>&gt;=</code>, <code>==</code>, <code>&lt;=</code>, etc...).  For your example it looks like you are using strings for keys.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>m := map[string]interface{}{\n    \"from\": 0,\n    \"key\": nil,\n    \"price\": \"Desc\",\n    \"title\": \"task\",\n}\n\n// Get the value of price\nprice := m[\"price\"]\nfmt.Println(price)\n\n// Get the title\ntitle := m[\"title\"]\nfmt.Println(title)\n\n// Loop through all of the map's key-value pairs\nfor key, value := range m {\n    fmt.Println(key, \":\", value)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/8a4u9AS2pq\" rel=\"nofollow\">Example in Go Playground</a></p>\n"}], "owner": {"reputation": 11, "user_id": 5341703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bujLC30sG4o/AAAAAAAAAAI/AAAAAAAAAFM/uc7FFtlEPwE/photo.jpg?sz=128", "display_name": "Aditya Budi Utomo", "link": "https://stackoverflow.com/users/5341703/aditya-budi-utomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1520591454, "accepted_answer_id": 32918711, "answer_count": 1, "score": -7, "last_activity_date": 1443856591, "creation_date": 1443835337, "last_edit_date": 1443856591, "question_id": 32917990, "link": "https://stackoverflow.com/questions/32917990/how-to-decode-map-golang", "closed_reason": "Not suitable for this site", "title": "How to Decode map golang", "body": "<p>I run my code and I get map like that:<br>\n<code>map[from:0 key:&lt;nil&gt; price:Desc title:stack]</code><br>\nI want to get value <code>from</code>,<code>price</code>,<code>title</code></p>\n\n<p>please help me</p>\n"}, {"tags": ["go", "interface", "new-operator", "typeof"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1443824769, "post_id": 32916619, "comment_id": 53661361, "body": "If you &quot;don&#39;t know what object ... [you are] dealing with&quot; then your&#39;re lost. That&#39;s something you need to know: Transmit, Take a look at how <code>gob</code> does it."}, {"owner": {"reputation": 1041, "user_id": 7730968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kCdXw.png?s=128&g=1", "display_name": "kenfire", "link": "https://stackoverflow.com/users/7730968/kenfire"}, "edited": false, "score": 1, "creation_date": 1512723031, "post_id": 32916619, "comment_id": 82381095, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33469177/new-instance-of-struct-from-the-type-at-runtime-in-go\">New instance of struct from the type at runtime in GO</a>"}, {"owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "reply_to_user": {"reputation": 1041, "user_id": 7730968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kCdXw.png?s=128&g=1", "display_name": "kenfire", "link": "https://stackoverflow.com/users/7730968/kenfire"}, "edited": false, "score": 0, "creation_date": 1512938415, "post_id": 32916619, "comment_id": 82446571, "body": "@kenfire this question was asked a month before the other one ;)"}, {"owner": {"reputation": 1041, "user_id": 7730968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kCdXw.png?s=128&g=1", "display_name": "kenfire", "link": "https://stackoverflow.com/users/7730968/kenfire"}, "edited": false, "score": 0, "creation_date": 1512980694, "post_id": 32916619, "comment_id": 82457781, "body": "@ThePiachu Yes but you did not accept your answer so I couldn&#39;t do the other way :)"}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1444066331, "last_edit_date": 1444066331, "creation_date": 1443825287, "answer_id": 32916828, "question_id": 32916619, "link": "https://stackoverflow.com/questions/32916619/how-to-initialize-a-list-of-objects-given-only-an-interface-sample/32916828#32916828", "title": "How to initialize a list of objects given only an interface sample?", "body": "<p>You would have to use <code>reflect.New</code> along with <code>reflect.TypeOf</code>:</p>\n\n<pre><code>tmp := reflect.New(reflect.TypeOf(sample))\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/-ujqWtRzaP\" rel=\"nofollow\">http://play.golang.org/p/-ujqWtRzaP</a></p>\n"}], "owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 32916828, "answer_count": 1, "score": 0, "last_activity_date": 1512903509, "creation_date": 1443824066, "last_edit_date": 1512903509, "question_id": 32916619, "link": "https://stackoverflow.com/questions/32916619/how-to-initialize-a-list-of-objects-given-only-an-interface-sample", "title": "How to initialize a list of objects given only an interface sample?", "body": "<p>I'm writing a database interface in Google Go. It takes <code>encoding.BinaryMarshaler</code> objects to save and saves them as []byte slices, and it loads data into <code>encoding.BinaryUnmarshaler</code> to return it:</p>\n\n<pre><code>func (db *DB) Get(bucket []byte, key []byte, destination encoding.BinaryUnmarshaler) (encoding.BinaryUnmarshaler, error) {\n</code></pre>\n\n<p>I want to implement being able to load an arbitrary length slice of <code>encoding.BinaryUnmarshaler</code>s in one go (for example \"load all data from a bucket X\"). I want the function to be able to load any number of data objects without knowing beforehand how many objects are to be loaded, so I don't expect the final user to pass me a slice to be filled. Instead, I take a <code>encoding.BinaryUnmarshaler</code> sample object to know what structures I'm dealing with:</p>\n\n<pre><code>func (db *DB) GetAll(bucket []byte, sample encoding.BinaryUnmarshaler) ([]encoding.BinaryUnmarshaler, error) {\n</code></pre>\n\n<p>The problem I ran into while coding this, is that I'm not sure how to initialize new instances of a given object, since I don't know what object I am dealing with, only what interface it conforms to. What I tried doing was:</p>\n\n<pre><code>tmp:=new(reflect.TypeOf(sample))\n</code></pre>\n\n<p>but that just caused an error.</p>\n\n<p>How can I create a new object in go without knowing what structure it is, having an example object instead?</p>\n"}, {"tags": ["nginx", "go", "docker", "docker-compose"], "answers": [{"comments": [{"owner": {"reputation": 2218, "user_id": 641562, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1aa522f2f6c31f19d872055ade493598?s=128&d=identicon&r=PG", "display_name": "jrock2004", "link": "https://stackoverflow.com/users/641562/jrock2004"}, "edited": false, "score": 0, "creation_date": 1506365390, "post_id": 32914138, "comment_id": 79782048, "body": "I know this is old but what did you return?"}], "tags": [], "owner": {"reputation": 53, "user_id": 3271784, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5fae7a2ac6a31e69108f410b6632e536?s=128&d=identicon&r=PG&f=1", "display_name": "user3271784", "link": "https://stackoverflow.com/users/3271784/user3271784"}, "is_accepted": false, "score": 1, "last_activity_date": 1443812700, "creation_date": 1443812700, "answer_id": 32914138, "question_id": 32913192, "link": "https://stackoverflow.com/questions/32913192/docker-nginx-and-go-golang-separate-containers-nginx-configuration/32914138#32914138", "title": "Docker nginx and Go (Golang) separate containers. Nginx configuration", "body": "<p>My fault, guys. My Go program returns nothing. So <code>nginx</code> interpreted <code>empty</code> response as bad request and return 502.</p>\n"}], "owner": {"reputation": 53, "user_id": 3271784, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5fae7a2ac6a31e69108f410b6632e536?s=128&d=identicon&r=PG&f=1", "display_name": "user3271784", "link": "https://stackoverflow.com/users/3271784/user3271784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443812700, "creation_date": 1443809071, "question_id": 32913192, "link": "https://stackoverflow.com/questions/32913192/docker-nginx-and-go-golang-separate-containers-nginx-configuration", "title": "Docker nginx and Go (Golang) separate containers. Nginx configuration", "body": "<p>On my localhost I've got Docker with 2 containers: Nginx and Golang. I want to do request from my local machine and get response from Go (localhost -> Nginx -> Go).  </p>\n\n<p>Containers work. I can go into Nginx container and run \n<code>curl -v 'test:8080/path' -d \"param1=value1&amp;param2=value2\"</code> and I've got correct response. </p>\n\n<p>But If I try to run the same request from host machine I've got an error - 502 Bad Gateway. If I change request and run <code>curl -v -X POST 'test:8080/path'</code> (same request without data) - It's ok. </p>\n\n<p>My Nginx config:</p>\n\n<pre><code>server {\n    listen 80;\n    server_name test;\n\n    client_max_body_size 20M;\n\n    charset utf8;\n\n    location / {\n        proxy_pass http://go:8000;  // there go - docker compose link\n    }\n}\n</code></pre>\n\n<p>I think, problem in Nginx configuration. But I'm newbie with nginx. Plz, help me :)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3315, "user_id": 2261909, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3e2a6a4bb5a88ce2b4805c4a3ca2e4ce?s=128&d=identicon&r=PG", "display_name": "brandonhilkert", "link": "https://stackoverflow.com/users/2261909/brandonhilkert"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1443793618, "post_id": 32908277, "comment_id": 53645075, "body": "Ah...just used <code>f.Mode().String()</code> to print it out and it&#39;s <code>Lrwxr-xr-x</code>. Is there a good way to also exclude links that are directories?"}, {"owner": {"reputation": 3315, "user_id": 2261909, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3e2a6a4bb5a88ce2b4805c4a3ca2e4ce?s=128&d=identicon&r=PG", "display_name": "brandonhilkert", "link": "https://stackoverflow.com/users/2261909/brandonhilkert"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1443793988, "post_id": 32908277, "comment_id": 53645340, "body": "Turns out it is a symlink. I was looking at the wrong dir :/"}], "answers": [{"tags": [], "owner": {"reputation": 3315, "user_id": 2261909, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3e2a6a4bb5a88ce2b4805c4a3ca2e4ce?s=128&d=identicon&r=PG", "display_name": "brandonhilkert", "link": "https://stackoverflow.com/users/2261909/brandonhilkert"}, "is_accepted": true, "score": 1, "last_activity_date": 1443795272, "creation_date": 1443795272, "answer_id": 32909181, "question_id": 32908277, "link": "https://stackoverflow.com/questions/32908277/fileinfo-isdir-isnt-detecting-directory/32909181#32909181", "title": "FileInfo.IsDir() isn&#39;t detecting directory", "body": "<p>I was looking at the wrong dir (confusing names). It was a symlink, which makes sense.</p>\n"}, {"tags": [], "owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "is_accepted": false, "score": 1, "last_activity_date": 1443806893, "creation_date": 1443806893, "answer_id": 32912648, "question_id": 32908277, "link": "https://stackoverflow.com/questions/32908277/fileinfo-isdir-isnt-detecting-directory/32912648#32912648", "title": "FileInfo.IsDir() isn&#39;t detecting directory", "body": "<p>It looks like that file is a directory and also a symlink. In order to exclude files which match both conditions, you can use:</p>\n\n<pre><code>if !f.IsDir() &amp;&amp; (f.Mode()&amp;os.ModeSymlink) != os.ModeSymlink {\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 3315, "user_id": 2261909, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3e2a6a4bb5a88ce2b4805c4a3ca2e4ce?s=128&d=identicon&r=PG", "display_name": "brandonhilkert", "link": "https://stackoverflow.com/users/2261909/brandonhilkert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1264, "favorite_count": 0, "accepted_answer_id": 32909181, "answer_count": 2, "score": 0, "last_activity_date": 1443806893, "creation_date": 1443792562, "question_id": 32908277, "link": "https://stackoverflow.com/questions/32908277/fileinfo-isdir-isnt-detecting-directory", "title": "FileInfo.IsDir() isn&#39;t detecting directory", "body": "<p>I have some code that walks through a directory to get the files, to operate on them and it uses <code>IsDir()</code> to skip directories. However, a directory isn't properly being detected:</p>\n\n<pre><code>err = filepath.Walk(dir, func(path string, f os.FileInfo, err error) error {\n    if !f.IsDir() {\n        fileList = append(fileList, path)\n    }\n    return nil\n})\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Put app/javascripts: read public/app/javascripts: is a directory\n</code></pre>\n\n<p>I'm on OSX. Here's the directory listing:</p>\n\n<pre><code>drwxr-xr-x@   6 me  staff     204 Sep 25 11:28 javascripts\n</code></pre>\n\n<p>Is there a better way to detect directories?</p>\n"}, {"tags": ["sorting", "go", "bson", "mgo"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1443796616, "post_id": 32908186, "comment_id": 53647246, "body": "@icza I swear I didn&#39;t copy your comment, I just saw it now."}], "answers": [{"comments": [{"owner": {"reputation": 246, "user_id": 5320998, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MQh5HjQOiBo/AAAAAAAAAAI/AAAAAAAAACA/JHtjM1Lbkvc/photo.jpg?sz=128", "display_name": "Glenn Walker", "link": "https://stackoverflow.com/users/5320998/glenn-walker"}, "edited": false, "score": 1, "creation_date": 1443794287, "post_id": 32908223, "comment_id": 53645572, "body": "Thanks guys - 2 hours ahead of new product launch - couldn&#39;t work out wood for the trees!"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 10, "last_activity_date": 1443792359, "creation_date": 1443792359, "answer_id": 32908223, "question_id": 32908186, "link": "https://stackoverflow.com/questions/32908186/golang-bson-sort-parameters-in-mgo/32908223#32908223", "title": "Golang Bson sort parameters in mgo", "body": "<p>Like this:</p>\n\n<pre><code>db.C(Collection).Find(Query).Limit(limit).Sort(sortBy...).Iter()\n</code></pre>\n"}], "owner": {"reputation": 246, "user_id": 5320998, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MQh5HjQOiBo/AAAAAAAAAAI/AAAAAAAAACA/JHtjM1Lbkvc/photo.jpg?sz=128", "display_name": "Glenn Walker", "link": "https://stackoverflow.com/users/5320998/glenn-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7752, "favorite_count": 0, "accepted_answer_id": 32908223, "answer_count": 1, "score": 6, "last_activity_date": 1443792359, "creation_date": 1443792227, "question_id": 32908186, "link": "https://stackoverflow.com/questions/32908186/golang-bson-sort-parameters-in-mgo", "title": "Golang Bson sort parameters in mgo", "body": "<p>I am trying to pass a multiple sort query to the \"Sort\" parameter of the mgo package (see <a href=\"https://godoc.org/labix.org/v2/mgo#Query.Sort\" rel=\"noreferrer\">https://godoc.org/labix.org/v2/mgo#Query.Sort</a>).</p>\n\n<p>If the parameters are dynamic (currently held in a slice), how can I translate that into a valid sort string.</p>\n\n<p>A working example would be:</p>\n\n<pre><code>db.C(Collection).Find(Query).Limit(limit).Sort(\"-created_when\", \"-title\").Iter()\n</code></pre>\n\n<p>But if \"-created_when\" and \"-title\" are held in a slice, and I try using a slice join like:</p>\n\n<pre><code>sortBy := []string{\"-created_when\", \"title\"}\ndb.C(Collection).Find(Query).Limit(limit).Sort(strings.Join(sortBy, \",\")).Iter()\n</code></pre>\n\n<p>The query doesn't work correctly.</p>\n\n<p>How can I translate the arbitrary fields in the slice into the .Sort([string1], [string2], ...) format required??</p>\n"}, {"tags": ["go", "embedding"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1443798988, "post_id": 32906086, "comment_id": 53648865, "body": "Stop using terms like <code>Base</code> and <code>Derived</code> with Go. Go doesn&#39;t have inheritance and you&#39;ll just cause yourself grief by trying to think in terms of inheritance in a language which instead embraces composition."}], "answers": [{"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": false, "score": 1, "last_activity_date": 1443785702, "creation_date": 1443785702, "answer_id": 32906298, "question_id": 32906086, "link": "https://stackoverflow.com/questions/32906086/go-embedded-types-field-initialization-in-derived-type/32906298#32906298", "title": "Go: embedded type&#39;s field initialization in derived type", "body": "<p>To initialize composed objects you have to initialize the embedded field, like any other object:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Base struct {\n    Field int\n}\n\ntype Derived struct {\n    Base\n}\n\nfunc main() {\n    d := &amp;Derived{\n        Base{10},\n    }\n    fmt.Println(d.Field)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "is_accepted": true, "score": 5, "last_activity_date": 1443785712, "creation_date": 1443785712, "answer_id": 32906300, "question_id": 32906086, "link": "https://stackoverflow.com/questions/32906086/go-embedded-types-field-initialization-in-derived-type/32906300#32906300", "title": "Go: embedded type&#39;s field initialization in derived type", "body": "<p>From the language <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"noreferrer\">specification</a>:</p>\n\n<blockquote>\n  <p>Promoted fields act like ordinary fields of a struct except that they cannot be used as field names in composite literals of the struct.</p>\n</blockquote>\n\n<p>So that's why it <em>doesn't</em> work.</p>\n\n<p>Here are two possible ways to work around that limitation, each illustrated in the following function:</p>\n\n<pre><code>func main() {\n    d := &amp;Derived{\n        Base{Field: 10},\n    }\n\n    e := new(Derived)\n    e.Field = 20\n\n    fmt.Println(d.Field)\n    fmt.Println(e.Field)\n}\n</code></pre>\n"}], "owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 32906300, "answer_count": 2, "score": 1, "last_activity_date": 1443785712, "creation_date": 1443784940, "last_edit_date": 1443785371, "question_id": 32906086, "link": "https://stackoverflow.com/questions/32906086/go-embedded-types-field-initialization-in-derived-type", "title": "Go: embedded type&#39;s field initialization in derived type", "body": "<p>Here is the code that works:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Base struct {\n    Field  int\n}\n\ntype Derived struct {\n    Base\n}\n\nfunc main() {\n    d := &amp;Derived{}\n    d.Field = 10\n    fmt.Println(d.Field)\n}\n</code></pre>\n\n<p>And here's the code that fails to compile with <code>./main.go:17: unknown Derived field 'Field' in struct literal</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Base struct {\n    Field  int\n}\n\ntype Derived struct {\n    Base\n}\n\nfunc main() {\n    d := &amp;Derived{\n        Field: 10,\n    }\n    fmt.Println(d.Field)\n}\n</code></pre>\n\n<p>What exactly is going on here? Sorry if it's obvious, but I just don't understand.</p>\n"}, {"tags": ["go", "command-line-interface", "readline", "libreadline"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1443777762, "post_id": 32903396, "comment_id": 53636658, "body": "have you tried opening a text scanner on <code>os.Stdin</code>? for simple cases it&#39;s enough. ."}], "answers": [{"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 0, "last_activity_date": 1443782498, "last_edit_date": 1443782498, "creation_date": 1443779155, "answer_id": 32904587, "question_id": 32903396, "link": "https://stackoverflow.com/questions/32903396/the-best-practice-of-cli-solution-in-go/32904587#32904587", "title": "The best practice of CLI solution in go", "body": "<p>I've used the liner library from <a href=\"https://github.com/peterh/liner\" rel=\"nofollow\">github.com/peterh/liner</a> with some success for this.</p>\n\n<p>It is a pure Go package with no dependencies on readline and works on windows/linux/os x.</p>\n\n<p>See the <a href=\"https://godoc.org/github.com/peterh/liner\" rel=\"nofollow\">docs</a> for more info.</p>\n\n<hr>\n\n<p>There is also <a href=\"https://github.com/chzyer/readline\" rel=\"nofollow\">github.com/chzyer/readline</a> which looks very competent too - but I haven't tried that one. <a href=\"https://godoc.org/github.com/chzyer/readline\" rel=\"nofollow\">Docs are here</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 5399866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abecf73da403752a6e1257bc357b5027?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5399866/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 32904587, "answer_count": 1, "score": 1, "last_activity_date": 1443782498, "creation_date": 1443775028, "last_edit_date": 1443775250, "question_id": 32903396, "link": "https://stackoverflow.com/questions/32903396/the-best-practice-of-cli-solution-in-go", "title": "The best practice of CLI solution in go", "body": "<p>I want to implement a program that provides interactive-shell like experience with CLI.<br>\nI have been trying <a href=\"https://github.com/bobappleyard/readline\" rel=\"nofollow\">https://github.com/bobappleyard/readline</a> but it needs users to install <code>GNU readline</code> and it causes some bugs in OSX.  </p>\n\n<p>Is there any other solution implemented in go without <code>cgo</code> so users do not need to install <code>GNU readline</code> additionally?</p>\n"}, {"tags": ["go", "interop", "ffi", "unsafe", "kernel32"], "answers": [{"comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1443788458, "post_id": 32906050, "comment_id": 53641883, "body": "Small bug: <code>a := &amp;data[2]</code> is not a valid offset of <code>data</code>, which has length 2. Otherwise great answer, +1."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1443830094, "post_id": 32906050, "comment_id": 53662600, "body": "Looks like the last argument should also be a pointer to an <code>int32</code> (given the <code>LPDWORD</code> type) -- it looks like an out parameter to say how many bytes were actually read into the buffer."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 6, "last_activity_date": 1444034205, "last_edit_date": 1444034205, "creation_date": 1443784813, "answer_id": 32906050, "question_id": 32901078, "link": "https://stackoverflow.com/questions/32901078/calling-kernel32s-readprocessmemory-in-go/32906050#32906050", "title": "Calling kernel32&#39;s ReadProcessMemory in Go", "body": "<p><code>uintptr(data)</code> is incorrect: it takes the value from <code>data</code> (0 of type <code>uint</code>) and converts that to <code>unitptr</code> type &mdash; yielding the same value converted to another type &mdash; producing, on x86, a null pointer.</p>\n\n<p>Note that Go is not C, and you can't really play dirty games with pointers in it, or, rather, you can, but only through using the <code>unsafe</code> built-in package and its <code>Pointer</code> type which is like <code>void*</code> (pointing somewhere in a data memory block) in C.</p>\n\n<p>What you need is something like</p>\n\n<pre><code>import \"unsafe\"\n\nvar (\n    data   [2]byte\n    length uint32\n)\nret, _, e := procReadProcessMemory.Call(uintptr(handle), uintptr(i),\n    uintptr(unsafe.Pointer(&amp;data[0])),\n    2, uintptr(unsafe.Pointer(&amp;length))) // read 2 bytes\n</code></pre>\n\n<p>Observe what was done here:</p>\n\n<ol>\n<li>A variable of type \"array of two bytes\" is declared;</li>\n<li>The address of the first element of this array is taken;</li>\n<li>That address is type-converted to the type <code>unsafe.Pointer</code>;</li>\n<li>The obtained value is then type-converted to <code>uintptr</code>.</li>\n</ol>\n\n<p>The last two steps are needed because Go features garbage collection:</p>\n\n<ul>\n<li>In Go, when you take an address of a value in memory and store it in a variable, the GC knows about this \"implicit\" pointer and the value which address was taken won't be garbage-collected even if it becomes unreachable with that value holding its address being the only reference left.</li>\n<li>Even if you make that address value lose the type information it maintains &mdash; through type-converting it to <code>unsafe.Pointer</code>, the new value is still considered by GC and behaves like \"normal\" values containing addresses &mdash; as explained above.</li>\n<li><p>By type-converting such value to <code>uintptr</code> you make GC stop considering it as a pointer.  Hence this type is there only for FFI/interop.</p>\n\n<p>In other words, in</p>\n\n<pre><code>var data [2]byte\na := &amp;data[0]\np := unsafe.Pointer(a)\ni := uintptr(p)\n</code></pre>\n\n<p>there are only three references to the value in <code>data</code>: that variable itself, <code>a</code> and <code>p</code>, but not <code>i</code>.</p></li>\n</ul>\n\n<p>You should consider these rules when dealing with calling outside code because you should never ever pass around <code>unitptr</code>-typed values: they're only for marshaling data to the called functions and unmarshaling it back, and have to be used \"on the spot\" &mdash; in the same scope as the values they are type-converted from/to.</p>\n\n<p>Also observe that in Go, you can't just take the address of a variable of an integer type and supply that address to a function which expects a pointer to a memory block of an appropriate size.  You have to deal with byte arrays and after the data has been written by the called function, you need to explicitly convert it to a value of the type you need.  That's why there's no \"type casts\" in Go but only \"type conversions\": you can't <em>reinterpret</em> the data type of a value through type-conversion, with the <code>uintptr(unsafe.Pointer)</code> (and back) being a notable exception for the purpose of FFI/interop, and even in this case you basically convert a pointer to a pointer, just transfer it through the GC boundary.</p>\n\n<p>To \"serialize\" and \"deserialize\" a value of an integer type you might use the <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow\"><code>encoding/binary</code></a> standard package or hand-roll no-brainer simple functions which do bitwise shifts and <code>or</code>-s and so on ;-)</p>\n\n<hr>\n\n<p>2015-10-05, updated as per the suggestion of James Henstridge.</p>\n\n<p>Note that after the function returns, and <code>ret</code> signalizes there's no error\nyou have to check the value of the <code>length</code> variable.</p>\n"}], "owner": {"reputation": 129, "user_id": 988242, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16d47100878c1a7f6c29baf1f44b544d?s=128&d=identicon&r=PG", "display_name": "Hongweng", "link": "https://stackoverflow.com/users/988242/hongweng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3816, "favorite_count": 3, "accepted_answer_id": 32906050, "answer_count": 1, "score": 5, "last_activity_date": 1444034205, "creation_date": 1443763935, "last_edit_date": 1443784891, "question_id": 32901078, "link": "https://stackoverflow.com/questions/32901078/calling-kernel32s-readprocessmemory-in-go", "title": "Calling kernel32&#39;s ReadProcessMemory in Go", "body": "<p>I'm trying to manipulate processes on Windows using Go language,\nand I'm starting off by reading other process' memory by using <code>ReadProcessMemory</code>.</p>\n\n<p>However, for most of the addresses I get <code>Error: Only part of a ReadProcessMemory or WriteProcessMemory request was completed.</code> error. Maybe my list of arguments is wrong, but I can't find out why.</p>\n\n<p>Can anyone point out what I am doing wrong here?</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\nimport (\n  windows \"golang.org/x/sys/windows\"\n)\n\nfunc main() {\n  handle, _ := windows.OpenProcess(0x0010, false, 6100) // 0x0010 PROCESS_VM_READ, PID 6100\n  procReadProcessMemory := windows.MustLoadDLL(\"kernel32.dll\").MustFindProc(\"ReadProcessMemory\")\n\n  var data uint   = 0\n  var length uint = 0\n\n  for i := 0; i &lt; 0xffffffff; i += 2 {\n    fmt.Printf(\"0x%x\\n\", i)\n\n    // BOOL ReadProcessMemory(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, DWORD nSize, LPDWORD lpNumberOfBytesRead)\n    ret, _, e := procReadProcessMemory.Call(uintptr(handle), uintptr(i), uintptr(data), 2, uintptr(length)) // read 2 bytes\n    if (ret == 0) {\n        fmt.Println(\"  Error:\", e)          \n    } else {\n        fmt.Println(\"  Length:\", length)\n        fmt.Println(\"  Data:\", data)                        \n    }\n  }\n\n  windows.CloseHandle(handle)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1443763662, "post_id": 32900985, "comment_id": 53630611, "body": "I don&#39;t have this package handy, but I am guessing your syntax next to Env is incorrect."}], "answers": [{"comments": [{"owner": {"reputation": 2308, "user_id": 1120799, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/IRCQ4.jpg?s=128&g=1", "display_name": "Abhishek Chanda", "link": "https://stackoverflow.com/users/1120799/abhishek-chanda"}, "edited": false, "score": 0, "creation_date": 1443763877, "post_id": 32901053, "comment_id": 53630659, "body": "Dang, noob mistake. Thanks!"}, {"owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "reply_to_user": {"reputation": 2308, "user_id": 1120799, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/IRCQ4.jpg?s=128&g=1", "display_name": "Abhishek Chanda", "link": "https://stackoverflow.com/users/1120799/abhishek-chanda"}, "edited": false, "score": 1, "creation_date": 1443763985, "post_id": 32901053, "comment_id": 53630683, "body": "Admittedly, I have made this mistake a few times too :D"}, {"owner": {"reputation": 2308, "user_id": 1120799, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/IRCQ4.jpg?s=128&g=1", "display_name": "Abhishek Chanda", "link": "https://stackoverflow.com/users/1120799/abhishek-chanda"}, "edited": false, "score": 0, "creation_date": 1443764043, "post_id": 32901053, "comment_id": 53630702, "body": "I have to say, this breaks my intuition about arrays"}], "tags": [], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "is_accepted": true, "score": 2, "last_activity_date": 1443763949, "last_edit_date": 1443763949, "creation_date": 1443763780, "answer_id": 32901053, "question_id": 32900985, "link": "https://stackoverflow.com/questions/32900985/cannot-build-simple-golang-code-slice-literal-syntax/32901053#32901053", "title": "Cannot build simple golang code - Slice literal syntax", "body": "<p>Slice literals should look like this:</p>\n\n<pre><code>[]string{\"a\", \"b\", \"c\"}\n</code></pre>\n\n<p>Not like this:</p>\n\n<pre><code>[\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>So change this:</p>\n\n<pre><code>Env: [\"FOO=foo\"],\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>Env: []string{\"FOO=foo\"},\n</code></pre>\n"}], "owner": {"reputation": 2308, "user_id": 1120799, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/IRCQ4.jpg?s=128&g=1", "display_name": "Abhishek Chanda", "link": "https://stackoverflow.com/users/1120799/abhishek-chanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 32901053, "answer_count": 1, "score": -1, "last_activity_date": 1443768438, "creation_date": 1443763257, "last_edit_date": 1443768438, "question_id": 32900985, "link": "https://stackoverflow.com/questions/32900985/cannot-build-simple-golang-code-slice-literal-syntax", "title": "Cannot build simple golang code - Slice literal syntax", "body": "<p>I am trying to build a simple golang program using <code>go-dockerclient</code></p>\n\n<pre><code>package main\n\nimport (\n        docker \"github.com/fsouza/go-dockerclient\"\n)\n\nfunc main () {\n        h := &amp;docker.HostConfig {\n                Memory: 4194304,\n                MemorySwap: -1,\n                CPUShares: 5,\n                NetworkMode: \"host\",\n        }\n        client, err := docker.NewClient(\"unix:///var/run/docker.sock\")\n        config := &amp;docker.Config {\n                Env: [\"FOO=foo\"],\n                Image: \"redis\",\n        }\n        opts := docker.CreateContainerOptions {\n                Config: config,\n                HostConfig: hostConfig,\n        }\n        container, _ := client.CreateContainer(opts)\n        err = client.StartContainer(container.ID)\n}\n</code></pre>\n\n<p>This gives me:</p>\n\n<pre><code>:~/gosrc/src/github.com/achanda$ go build\n# github.com/achanda\n./main.go:16: syntax error: unexpected comma\n./main.go:22: non-declaration statement outside function body\n./main.go:23: non-declaration statement outside function body\n./main.go:24: non-declaration statement outside function body\n./main.go:25: syntax error: unexpected }\n</code></pre>\n\n<p>I don't seem to find anything wrong with the syntax (admittedly a noob though). What is the problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1443797849, "post_id": 32900726, "comment_id": 53648090, "body": "It&#39;s because you mistaken use a pointer to a slice where that is unnecessary. As written you&#39;d just need to do <code>*myTypes = append(*myTypes, &#47;*whatever*&#47;)</code>. Better is not use pointers to slices unless you know what you&#39;re doing: <a href=\"https://play.golang.org/p/FxsUo1vu6L\" rel=\"nofollow noreferrer\">play.golang.org/p/FxsUo1vu6L</a>"}, {"owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1443920707, "post_id": 32900726, "comment_id": 53684169, "body": "Thanks Dave, I feel a little silly not seeing that now. Makes complete sense.. Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "edited": false, "score": 0, "creation_date": 1443763316, "post_id": 32900823, "comment_id": 53630499, "body": "Yup that also would be acceptable.. Great thanks! (Gah keep forgetting channels and slices are ref types :P )"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1443797869, "post_id": 32900823, "comment_id": 53648111, "body": "There is no need whatsoever to make an <code>Append</code> method and to cast anything."}], "tags": [], "owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "is_accepted": true, "score": 2, "last_activity_date": 1472702438, "last_edit_date": 1495535412, "creation_date": 1443762086, "answer_id": 32900823, "question_id": 32900726, "link": "https://stackoverflow.com/questions/32900726/adding-to-an-anonymous-slice-in-a-type-in-golang/32900823#32900823", "title": "Adding to an anonymous slice in a type in golang", "body": "<p>Update: This answer once contained two ways to solve the problem: my somewhat clunky way, the <a href=\"https://stackoverflow.com/users/55504/dave-c\">DaveC</a>'s more elegant way. Here's his more elegant way:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\ntype MyType struct {\n    Name      string\n    Something string\n}\n\ntype MyTypes []*MyType\n\nfunc NewMyTypes(myTypes ...*MyType) MyTypes {\n    return myTypes\n}\n\n//example of a method I want to be able to add to a slice\nfunc (m MyTypes) Names() []string {\n    names := make([]string, 0, len(m))\n    for _, v := range m {\n        names = append(names, v.Name)\n    }\n    return names\n}\n\nfunc main() {\n    mytype1, mytype2 := MyType{Name: \"Joe\", Something: \"Foo\"}, MyType{Name: \"PeggySue\", Something: \"Bar\"}\n    myTypes := NewMyTypes(&amp;mytype1, &amp;mytype2)\n    myTypes = append(myTypes, &amp;MyType{Name: \"Random\", Something: \"asdhf\"})\n    fmt.Println(strings.Join(myTypes.Names(), \":\"))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/FxsUo1vu6L\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FxsUo1vu6L</a></p>\n"}], "owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2729, "favorite_count": 0, "accepted_answer_id": 32900823, "answer_count": 1, "score": 3, "last_activity_date": 1472702438, "creation_date": 1443761388, "last_edit_date": 1443761730, "question_id": 32900726, "link": "https://stackoverflow.com/questions/32900726/adding-to-an-anonymous-slice-in-a-type-in-golang", "title": "Adding to an anonymous slice in a type in golang", "body": "<p>I want to add a few helper methods attached onto a slice.\nSo I created a type which is of []*MyType\nIs there any way to add to that slice of MyTypes? append will not recognise the slice.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n\ntype MyType struct{\n    Name string\n    Something string\n}\n\n\ntype MyTypes []*MyType \n\nfunc NewMyTypes(myTypes ...*MyType)*MyTypes{\n    var s MyTypes = myTypes\n    return &amp;s\n}\n\n//example of a method I want to be able to add to a slice\nfunc(m MyTypes) Key() string{\n    var result string\n\n    for _,i := range m{\n        result += i.Name + \":\" \n    }\n\n    return result\n}\n\n\nfunc main() {\n    mytype1 ,mytype2 := MyType{Name:\"Joe\", Something: \"Foo\"},  MyType{Name:\"PeggySue\", Something: \"Bar\"}\n\n    myTypes:= NewMyTypes(&amp;mytype1,&amp;mytype2) \n\n    //cant use it as a slice sadface\n    //myTypes = append(myTypes,&amp;MyType{Name:\"Random\", Something: \"asdhf\"})\n\n    fmt.Println(myTypes.Key())\n}\n</code></pre>\n\n<p>I don't want to wrap it in another type and name the param even though I'm sorta doing it.. Because of json marshalling will probably be different</p>\n\n<p>What would be the way to add to the MyTypes slice?</p>\n\n<p>I really want to just be able to add a method to a slice so it can implement a specific interface and not effect the marshalling.. Is there a different better way?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["rest", "intellij-idea", "go", "path"], "comments": [{"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1443755298, "post_id": 32897711, "comment_id": 53628640, "body": "Are you using the version out of the IntelliJ plugin repository or the nightly/alpha builds from <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin\" rel=\"nofollow noreferrer\">here</a>? The latest builds should autodetect <code>$GOPATH</code>."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 1422516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7c8e3c49354dfde5b740d97c893ed5?s=128&d=identicon&r=PG", "display_name": "Chris Jacobs", "link": "https://stackoverflow.com/users/1422516/chris-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1443767938, "creation_date": 1443767938, "answer_id": 32901745, "question_id": 32897711, "link": "https://stackoverflow.com/questions/32897711/i-having-trouble-with-gopath-and-intellij-idea/32901745#32901745", "title": "i having trouble with GOPATH and Intellij idea", "body": "<p><a href=\"https://plugins.jetbrains.com/plugin/5047\" rel=\"nofollow\">Here</a> you can see the menu path:</p>\n\n<p>Languages &amp; Frameworks > Go > Go SDK</p>\n\n<p>I'm using brew, so it's /usr/local/Cellar/go/1.5.1/libexec currently.</p>\n"}, {"tags": [], "owner": {"reputation": 509, "user_id": 5462132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bf54b25a6c3789897fc4b008aeaac1?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Zolotov", "link": "https://stackoverflow.com/users/5462132/alexander-zolotov"}, "is_accepted": false, "score": 1, "last_activity_date": 1447759090, "last_edit_date": 1495542289, "creation_date": 1447759090, "answer_id": 33755585, "question_id": 32897711, "link": "https://stackoverflow.com/questions/32897711/i-having-trouble-with-gopath-and-intellij-idea/33755585#33755585", "title": "i having trouble with GOPATH and Intellij idea", "body": "<p><a href=\"https://stackoverflow.com/questions/17771091/i-use-intellij-idea-as-golang-ide-and-system-environment-have-already-set-gopat\">The question</a> you mentioned is about old version of plugin. For the new version GOPATH is defined in <code>Settings | Languages &amp; Frameworks | Go | Go Libraries</code>. There you also can see whether GOPATH system environment variable was found or not and add your custom GOPATHs.</p>\n\n<p>See also <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/wiki/Documentation#changing-the-go-libraries-gopath-libraries\" rel=\"nofollow noreferrer\">documentation</a></p>\n"}], "owner": {"reputation": 23, "user_id": 2584864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YEJPx.jpg?s=128&g=1", "display_name": "B5I5", "link": "https://stackoverflow.com/users/2584864/b5i5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1447759090, "creation_date": 1443737868, "last_edit_date": 1495540800, "question_id": 32897711, "link": "https://stackoverflow.com/questions/32897711/i-having-trouble-with-gopath-and-intellij-idea", "title": "i having trouble with GOPATH and Intellij idea", "body": "<p>I use MACOSX 10.10.5 and use Intellij IDEA as IDE.</p>\n\n<p>I already install GO SDK (by download SDK from website and not from Macports)and try simple program, it work correctly.</p>\n\n<p>I try to use gorilla library (<a href=\"http://www.gorillatoolkit.org/pkg/mux#overview\" rel=\"nofollow noreferrer\">http://www.gorillatoolkit.org/pkg/mux#overview</a>), So I set GOPATH like this</p>\n\n<ul>\n<li>GOPATH=$HOME/work</li>\n<li>PATH=$PATH:$GOPATH/bin</li>\n<li>go get github.com/gorilla/mux</li>\n</ul>\n\n<p>and Add PATH to intellij, see figure below. <a href=\"https://i.stack.imgur.com/wAAa3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wAAa3.png\" alt=\"Set gorilla library\"></a></p>\n\n<p>When i import this library IDE throw error like this.<a href=\"https://i.stack.imgur.com/KT60K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KT60K.png\" alt=\"enter image description here\"></a></p>\n\n<p>So i try to fixit like this <a href=\"https://stackoverflow.com/questions/17771091/i-use-intellij-idea-as-golang-ide-and-system-environment-have-already-set-gopat\">I use IntelliJ IDEA as golang IDE, and system environment have already set GOPATH\uff0cBut IDEA can&#39;t load it</a></p>\n\n<p>But it do not work for me. how can I set GOPATH in idea?</p>\n"}, {"tags": ["windows", "go", "cmd"], "answers": [{"tags": [], "owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "is_accepted": false, "score": -1, "last_activity_date": 1443756178, "last_edit_date": 1495535219, "creation_date": 1443756178, "answer_id": 32900094, "question_id": 32895591, "link": "https://stackoverflow.com/questions/32895591/how-to-tell-if-a-folder-is-shared-with-golang-or-cmd/32900094#32900094", "title": "How to tell if a folder is shared with GoLang or CMD?", "body": "<p>The <a href=\"https://stackoverflow.com/questions/136539/determining-if-a-folder-is-shared-in-net\">C#</a> solution to this problem is to use WMI. Since this is very Windows-specific, I don't believe anything out of the Go standard library will help you here.</p>\n\n<p>We can see in <a href=\"https://stackoverflow.com/questions/20365286/query-wmi-from-go\">this answer</a> that a third-party package does exist for using WMI, as well as <a href=\"https://github.com/StackExchange/wmi/blob/master/wmi.go\" rel=\"nofollow noreferrer\">another package</a> from Stack Exchange. You can try to make something out of the combination of the C# solution and the API available with those WMI packages.</p>\n"}, {"tags": [], "owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "is_accepted": false, "score": 0, "last_activity_date": 1443787664, "creation_date": 1443787664, "answer_id": 32906859, "question_id": 32895591, "link": "https://stackoverflow.com/questions/32895591/how-to-tell-if-a-folder-is-shared-with-golang-or-cmd/32906859#32906859", "title": "How to tell if a folder is shared with GoLang or CMD?", "body": "<p>Disclaimer: I'm far from a windows cli expert.</p>\n\n<p>You're on the right path in terms of os/exec.Cmd to execute OS specific commands on your target system.</p>\n\n<p>You should be able to use the <code>net share</code> <a href=\"http://www.computerhope.com/nethlp.htm\" rel=\"nofollow\">command</a> to display all current local shares. Unfortunately while you can check a sharename with that command too, there doesn't appear to be any reverse lookup, so you'll probably have to write some code that can poke through the results of <code>net share</code> and look for the relevant path.</p>\n\n<p>The output is formatted nicely enough, so it shouldn't be that difficult to write a function that uses <code>net share</code> to create a map of all windows shares for easy look up.</p>\n"}], "owner": {"reputation": 1139, "user_id": 675283, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/447f06617d5f30dbbcdd6d1b47d402fe?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/675283/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1443787664, "creation_date": 1443728471, "last_edit_date": 1443732269, "question_id": 32895591, "link": "https://stackoverflow.com/questions/32895591/how-to-tell-if-a-folder-is-shared-with-golang-or-cmd", "title": "How to tell if a folder is shared with GoLang or CMD?", "body": "<p>Is there a way to tell if a folder is shared For example I have folder D:/data1 I would like to know if it is shared or if is not.<br /> Is this possible to do with golang or CMD commands? Is there a example on how to do this?<br />\nMy goal is to be able to pass in a root folder D:/data2 and tell if is a shared folder. <br />\nExample of what i would like to do. </p>\n\n<pre><code>if shared(\"D:/data2\") {\n //handle if it is shared\n} else {\n //handle not shared folder\n}\n</code></pre>\n\n<p>I just have not bin able to find a way to detect if the folder is shared.\nThank you for your help!</p>\n"}, {"tags": ["arrays", "go", "global-variables"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 1, "creation_date": 1443727061, "post_id": 32895042, "comment_id": 53619690, "body": "Use a slice instead."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1443728201, "post_id": 32895042, "comment_id": 53620269, "body": "Also, for simple initialization it&#39;s more common to just do it in the global <code>var</code> statement rather than use an <code>init</code> function. E.g. <code>var testStrings = []string{&quot;apple&quot;, &quot;banana&quot;, &quot;kiwi&quot;}</code>."}, {"owner": {"reputation": 269, "user_id": 2105489, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f2de1fca3cddc2162f295dcf528f431?s=128&d=identicon&r=PG", "display_name": "nullgraph", "link": "https://stackoverflow.com/users/2105489/nullgraph"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1443728419, "post_id": 32895042, "comment_id": 53620394, "body": "@DaveC, I agree. I didn&#39;t mention it but actually, this is a stripped down version for a go test fixture with lazy init."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 6, "last_activity_date": 1443726890, "last_edit_date": 1443726890, "creation_date": 1443726545, "answer_id": 32895055, "question_id": 32895042, "link": "https://stackoverflow.com/questions/32895042/global-array-in-golang/32895055#32895055", "title": "Global array in golang", "body": "<p>From the <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">Go specification</a>:</p>\n\n<blockquote>\n  <p>The notation <code>...</code> specifies an array length equal to the maximum element index plus one.</p>\n</blockquote>\n\n<p>This does not work for your code because <code>testStrings</code> is a <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"noreferrer\">slice</a>, not an <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"noreferrer\">array</a> (read about <a href=\"https://blog.golang.org/slices\" rel=\"noreferrer\">the difference between arrays and slices</a>).  Dropping the <code>...</code> will fix your program:</p>\n\n<pre><code>testStrings = []string{\"apple\",\"banana\",\"kiwi\"}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "is_accepted": false, "score": 6, "last_activity_date": 1443735057, "last_edit_date": 1443735057, "creation_date": 1443726728, "answer_id": 32895115, "question_id": 32895042, "link": "https://stackoverflow.com/questions/32895042/global-array-in-golang/32895115#32895115", "title": "Global array in golang", "body": "<p><code>[...]</code> means an <a href=\"https://golang.org/doc/effective_go.html#arrays\" rel=\"noreferrer\">array</a>.</p>\n\n<p><code>[]</code> means a <a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"noreferrer\">slice</a>.</p>\n\n<p>Change one. For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar arrtestStrings [3]string\nvar slicetestStrings []string\n\nfunc main() {\n    arrtestStrings = [...]string{\"apple\", \"banana\", \"kiwi\"}\n    slicetestStrings = []string{\"apple\", \"banana\", \"kiwi\"}\n    fmt.Println(arrtestStrings)\n    fmt.Println(slicetestStrings)\n}\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 2105489, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f2de1fca3cddc2162f295dcf528f431?s=128&d=identicon&r=PG", "display_name": "nullgraph", "link": "https://stackoverflow.com/users/2105489/nullgraph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15909, "favorite_count": 0, "accepted_answer_id": 32895055, "answer_count": 2, "score": 1, "last_activity_date": 1443735057, "creation_date": 1443726498, "question_id": 32895042, "link": "https://stackoverflow.com/questions/32895042/global-array-in-golang", "title": "Global array in golang", "body": "<p>I'm trying to declare a global array and then init it later like so:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\nvar testStrings []string\n\nfunc main() {\n  testStrings = [...]string{\"apple\",\"banana\",\"kiwi\"}\n  fmt.Println(testStrings)\n}\n</code></pre>\n\n<p>But I'm getting error: \"cannot use [3]string literal (type [3]string) as type []string in assignment\"</p>\n\n<p>How do I declare global array without specifying size?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2617, "user_id": 5119090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/965fcf1032f06744e4452531fcddd607?s=128&d=identicon&r=PG", "display_name": "Fernando Matsumoto", "link": "https://stackoverflow.com/users/5119090/fernando-matsumoto"}, "edited": false, "score": 0, "creation_date": 1443724027, "post_id": 32894299, "comment_id": 53618114, "body": "Which operations does <code>test2</code> do? Does it access any fields?"}, {"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "reply_to_user": {"reputation": 2617, "user_id": 5119090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/965fcf1032f06744e4452531fcddd607?s=128&d=identicon&r=PG", "display_name": "Fernando Matsumoto", "link": "https://stackoverflow.com/users/5119090/fernando-matsumoto"}, "edited": false, "score": 0, "creation_date": 1443724280, "post_id": 32894299, "comment_id": 53618250, "body": "Nope, just a function doing plain operations and won&#39;t call any other functions."}], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1443726026, "post_id": 32894736, "comment_id": 53619115, "body": "Thanks! Is the second code runs faster than the first one, or they should spend more or less the same time? In other words, in the first case do other goroutines need to wait for previous goroutine finish copying function &quot;test2&quot; to their own thread?"}, {"owner": {"reputation": 2617, "user_id": 5119090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/965fcf1032f06744e4452531fcddd607?s=128&d=identicon&r=PG", "display_name": "Fernando Matsumoto", "link": "https://stackoverflow.com/users/5119090/fernando-matsumoto"}, "reply_to_user": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "edited": false, "score": 0, "creation_date": 1443726693, "post_id": 32894736, "comment_id": 53619492, "body": "@Kyle No. In the first case, the function is not copied to its own thread. It is defined once and, every time it is called in a new <a href=\"https://golang.org/doc/effective_go.html#goroutines\" rel=\"nofollow noreferrer\">goroutine</a> that same code is executed with a new stack."}], "tags": [], "owner": {"reputation": 2617, "user_id": 5119090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/965fcf1032f06744e4452531fcddd607?s=128&d=identicon&r=PG", "display_name": "Fernando Matsumoto", "link": "https://stackoverflow.com/users/5119090/fernando-matsumoto"}, "is_accepted": true, "score": 2, "last_activity_date": 1443726343, "last_edit_date": 1495542574, "creation_date": 1443725268, "answer_id": 32894736, "question_id": 32894299, "link": "https://stackoverflow.com/questions/32894299/calling-non-goroutine-function-with-goroutines/32894736#32894736", "title": "Calling non-goroutine function with goroutines", "body": "<p>No, your function will not crash, unless there is something wrong in your code (i.e. division by zero) or you explicitly call <code>panic()</code>. If it doesn't access any fields (or methods whose documentation doesn't specify they may be called concurrently), then your function is <a href=\"https://stackoverflow.com/questions/261683/what-is-meant-by-thread-safe-code\">thread-safe</a>.</p>\n\n<p>EDIT: The first code is better. Although both should have very similar performance, since they are running the same code, the first is easier to read. There may be a small performance penalty in your second code block, since you are defining a function multiple times, but that is probably optimized away by the compiler.</p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1518, "favorite_count": 0, "accepted_answer_id": 32894736, "answer_count": 1, "score": 1, "last_activity_date": 1443726343, "creation_date": 1443723599, "question_id": 32894299, "link": "https://stackoverflow.com/questions/32894299/calling-non-goroutine-function-with-goroutines", "title": "Calling non-goroutine function with goroutines", "body": "<p>I have part of a script with the following format:</p>\n\n<pre><code>func main() {\n  for i=0;i&lt;1000000;i++ {\n    go test()\n  }\n}\nfunc test() {\n    a := test2()\n}\nfunc test2()(var int) {\n    //a bunch of operations\n    return var\n}\n</code></pre>\n\n<p>I run a lot of iterations and it always work. I'm wondering is there any chance that two or more goroutines calling function \"test2()\" at the same time and cause a crash? Is the following format anyway better then the previous one?</p>\n\n<pre><code>func main() {\n    for i=0;i&lt;1000000;i++ {\n        go test()\n    }\n}\nfunc test() {\n    test2 := func()(var int){\n        //a bunch of operations\n        return var\n    }\n    a := test2()\n}\n</code></pre>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["java", "android", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1443716358, "post_id": 32892296, "comment_id": 53614219, "body": "Do you have gcc installed?"}, {"owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1443716641, "post_id": 32892296, "comment_id": 53614368, "body": "I read that is installed with Go 1.5 ? I build working Hello World before on my phone, so probably yes. I can have a bad info too idk."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1443716972, "post_id": 32892296, "comment_id": 53614550, "body": "No, gcc is not installed with Go. The program complains that it can&#39;t find gcc. Make sure that you have it, it&#39;s in your PATH, and it&#39;s for the right platform."}, {"owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1443717277, "post_id": 32892296, "comment_id": 53614724, "body": "Gcc is maybe in NDK ? I no install it, i just installed Git Bash which solve some problems on few days, I was added to path any before &quot;C:\\Go&quot;."}, {"owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1443730620, "post_id": 32892296, "comment_id": 53621563, "body": "I install NDK and i used command: ./make-standalone-toolchain.sh --system=windows --toolchain=arm-linux-androideabi-4.9 --platform=android-9 --install-dir=E:/Code/Android/android-toolchain --ndk-dir=E:/Code/Android/android-ndk-r10e, after that all i was added to PATH: E:\\Code\\Android\\android-toolchain\\bin, and is that same error"}, {"owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1443809460, "post_id": 32892296, "comment_id": 53654434, "body": "I was installed mingw and that was helped"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1443813073, "post_id": 32892296, "comment_id": 53656288, "body": "Have you solved it? If you solved your own problem, <a href=\"http://stackoverflow.com/help/self-answer\">you should post an answer</a> so that other users could find it and upvote you."}, {"owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1443823659, "post_id": 32892296, "comment_id": 53661025, "body": "I solved any that line with <b>exec: &quot;gcc&quot;: executable file not found in %PATH%</b> was dissapear and rest error stay."}, {"owner": {"reputation": 5182, "user_id": 550967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1NTf.jpg?s=128&g=1", "display_name": "DallaRosa", "link": "https://stackoverflow.com/users/550967/dallarosa"}, "edited": false, "score": 1, "creation_date": 1443960924, "post_id": 32892296, "comment_id": 53692172, "body": "So, you still have an error? Show us the new error. I cannot be the same."}, {"owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "edited": false, "score": 0, "creation_date": 1443966602, "post_id": 32892296, "comment_id": 53693820, "body": "Here is the error: <a href=\"http://pastebin.com/Cguaebny\" rel=\"nofollow noreferrer\">pastebin.com/Cguaebny</a> I Added too gradle of hello module to the mai post."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "is_accepted": true, "score": 0, "last_activity_date": 1444072931, "creation_date": 1444072931, "answer_id": 32956270, "question_id": 32892296, "link": "https://stackoverflow.com/questions/32892296/golang-gomobile-basic-script-compile-error/32956270#32956270", "title": "Golang - gomobile basic script compile error", "body": "<p>Ok, my fault if somebody will have same problem in feature there somebody explained me:\n<a href=\"https://github.com/golang/go/issues/12842\" rel=\"nofollow\">https://github.com/golang/go/issues/12842</a></p>\n\n<p>In short I tried to build native Go app.</p>\n"}], "owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 871, "favorite_count": 0, "accepted_answer_id": 32956270, "answer_count": 1, "score": 2, "last_activity_date": 1444072931, "creation_date": 1443716240, "last_edit_date": 1443960379, "question_id": 32892296, "link": "https://stackoverflow.com/questions/32892296/golang-gomobile-basic-script-compile-error", "title": "Golang - gomobile basic script compile error", "body": "<p>Probably that is newbie question, but that takes me 2 days with 0 progress.\nI build before Hello Gopher World on my mobile with Android Studio, but when I tried to do that same with 'basic' mobile script from <a href=\"https://godoc.org/golang.org/x/mobile/example/basic\" rel=\"nofollow\">https://godoc.org/golang.org/x/mobile/example/basic</a>\nI get that error:</p>\n\n<pre><code>Information:Gradle tasks [:app:compileDebugSources, :app:compileDebugAndroidTestSources]\n:app:preBuild UP-TO-DATE\n:app:preDebugBuild UP-TO-DATE\n:app:checkDebugManifest\n:app:preReleaseBuild UP-TO-DATE\n:hello:gobind\nexec: \"gcc\": executable file not found in %PATH%\nC:\\gowork\\bin\\gomobile.exe: go build -p=4 -pkgdir=C:\\gowork\\pkg\\gomobile/pkg_android_arm -tags=\"\" -i -buildmode=c-shared -o=C:\\Users\\Pablo\\AppData\\Local\\Temp\\gomobile-work-627382299\\android\\src\\main\\jniLibs\\armeabi-v7a\\libgojni.so C:\\Users\\Pablo\\AppData\\Local\\Temp\\gomobile-work-627382299\\androidlib\\main.go failed: exit status 2\n# _/C_/Users/Pablo/AppData/Local/Temp/gomobile-work-627382299/go_hello\nC:\\Users\\Pablo\\AppData\\Local\\Temp\\gomobile-work-627382299\\go_hello\\go_hellomain.go:8: imported and not used: \"golang.org/x/mobile/bind/seq\"\nC:\\Users\\Pablo\\AppData\\Local\\Temp\\gomobile-work-627382299\\go_hello\\go_hellomain.go:9: imported and not used: \"golang.org/x/mobile/example/bind/hello\"\nError:Execution failed for task ':hello:gobind'.\n&gt; Process 'command 'C:/gowork/bin\\gomobile.exe'' finished with non-zero exit value 1\nInformation:BUILD FAILED\nInformation:Total time: 8.174 secs\nInformation:1 error\nInformation:0 warnings\nInformation:See complete output in console\n</code></pre>\n\n<p>That is build.gradle of hello module:</p>\n\n<pre><code>plugins {\n    id \"org.golang.mobile.bind\" version \"0.2.2\"\n}\n\ngobind {\n    pkg = \"golang.org/x/mobile/example/bind/hello\"\n\n    GOPATH = \"C:/gowork\"\n\n    GO = \"C:/Go\"\n}\n</code></pre>\n\n<p>There is go file: (C:\\gowork\\src\\golang.org\\x\\mobile\\example\\bind\\hello\\hello.go)</p>\n\n<p><a href=\"http://pastebin.com/PPCn6sPE\" rel=\"nofollow\">http://pastebin.com/PPCn6sPE</a></p>\n\n<p>And (MainActivity)java file from I try to use function main():</p>\n\n<p><a href=\"http://pastebin.com/61f8pSSb\" rel=\"nofollow\">http://pastebin.com/61f8pSSb</a></p>\n"}, {"tags": ["go", "polymer"], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 1958634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e790e47ca050425d0d24a59fa280d16?s=128&d=identicon&r=PG", "display_name": "Devappended", "link": "https://stackoverflow.com/users/1958634/devappended"}, "is_accepted": false, "score": 0, "last_activity_date": 1443724220, "creation_date": 1443724220, "answer_id": 32894473, "question_id": 32891637, "link": "https://stackoverflow.com/questions/32891637/polymer-iron-form-or-iron-ajax-error-response-content/32894473#32894473", "title": "Polymer iron-form or iron-ajax error response content", "body": "<p>Try this...</p>\n\n<pre><code>_ironFormErrorHandler: function(e, detail) {\n    console.log(detail)\n},\n</code></pre>\n"}], "owner": {"reputation": 86, "user_id": 1350666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d9f6781a8e10a0b054e909c392c632?s=128&d=identicon&r=PG", "display_name": "Alex Ghiu", "link": "https://stackoverflow.com/users/1350666/alex-ghiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 821, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1443724220, "creation_date": 1443714022, "last_edit_date": 1443714338, "question_id": 32891637, "link": "https://stackoverflow.com/questions/32891637/polymer-iron-form-or-iron-ajax-error-response-content", "title": "Polymer iron-form or iron-ajax error response content", "body": "<p>I'm using Polymer 1.0 with Golang 1.5.</p>\n\n<p>From Go I'm sending a json response with a 400 Bad Request and some content as follows:</p>\n\n<pre><code>d := struct{\n    Message string\n}{\n    Message: \"details should go in here\"\n}\nj, _ := json.Marshal(d)\nw.WriteHeader(http.StatusBadRequest)\nw.Write(j)\n</code></pre>\n\n<p>In polymer I've tried to get the contents of this error both with iron-form and iron-ajax and I keep on getting the following in e.detail:</p>\n\n<p>\"Error: The request failed with status code: 400 at iron-request.\"</p>\n\n<p>Here is my Polymer code:</p>\n\n<pre><code>&lt;form is=\"iron-form\" method=\"post\" action=\"golang-handler-above\"&gt;\n    &lt;paper-button on-tap=\"_submitHandler\"&gt;Send&lt;/paper-button&gt;\n&lt;/form&gt;\n\nPolymer({\n    ...\n    listeners: {\n        \"iron-form-error\": \"_ironFormErrorHandler\",\n    },\n\n    _ironFormErrorHandler: function(e) {\n         console.log(e.detail)\n    },\n    ....\n})\n</code></pre>\n\n<p>Now I'm looking for some way of accessing the contents of the response. Some property of e that will allow me to access the \"Message\" field that is being returned with the response, or even the raw response body as text.</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1443710529, "post_id": 32890331, "comment_id": 53610463, "body": "Why do you have to split the string? You should be able to accept a valid Content-Type header."}], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 0, "creation_date": 1592664264, "post_id": 32890468, "comment_id": 110508444, "body": "I needed to add an <code>Access-Control-Allow-Origin</code> header, and this solution worked flawlessly to me (I&#39;m using <code>c.XML()</code>, but the concept is pretty much the same). Thanks!"}, {"owner": {"reputation": 297, "user_id": 6642154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAIDB.jpg?s=128&g=1", "display_name": "Zhwt", "link": "https://stackoverflow.com/users/6642154/zhwt"}, "reply_to_user": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 1, "creation_date": 1596704944, "post_id": 32890468, "comment_id": 111898585, "body": "@GwynethLlewelyn You can try this out: <a href=\"https://github.com/gin-contrib/cors\" rel=\"nofollow noreferrer\">https://github.com/gin-contrib/cors</a>, a middleware which can add some basic cors headers."}, {"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "reply_to_user": {"reputation": 297, "user_id": 6642154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lAIDB.jpg?s=128&g=1", "display_name": "Zhwt", "link": "https://stackoverflow.com/users/6642154/zhwt"}, "edited": false, "score": 0, "creation_date": 1596810923, "post_id": 32890468, "comment_id": 111939358, "body": "@Zhwt oh that&#39;s even better... thanks so much! I&#39;ve filed it as a <code>TODO()</code> on my code, it&#39;s far better to use a much neater library to accomplish the same thing with middleware..."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 3, "last_activity_date": 1443711055, "last_edit_date": 1443711055, "creation_date": 1443710698, "answer_id": 32890468, "question_id": 32890331, "link": "https://stackoverflow.com/questions/32890331/changing-default-header-for-json-data-in-gin/32890468#32890468", "title": "Changing default header for JSON data in Gin", "body": "<ol>\n<li><p>Modify the source code to <a href=\"https://github.com/gin-gonic/gin/blob/master/render/json.go#L22\" rel=\"nofollow\">remove the <code>; charset=utf-8</code> string</a>, or</p></li>\n<li><p>Have a wrapper function which manually sets <code>Content-Type</code> before the <code>gin.Context.JSON</code> call:</p>\n\n<pre><code>func JSON(c *gin.Context, code int, obj interface{}) {\n    c.Header(\"Content-Type\", \"application/json\")\n    c.JSON(code, obj)\n}\n\n// ...\n\nJSON(c, http.StatusOK, jsonData)\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4794, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1489487476, "creation_date": 1443710278, "last_edit_date": 1489487476, "question_id": 32890331, "link": "https://stackoverflow.com/questions/32890331/changing-default-header-for-json-data-in-gin", "title": "Changing default header for JSON data in Gin", "body": "<p>I've noticed that using Gin to return a response like this:</p>\n\n<pre><code>c.JSON(http.StatusOK, jsonData)\n</code></pre>\n\n<p>automatically creates the following header:</p>\n\n<pre><code>application/json; charset=utf-8\n</code></pre>\n\n<p>Is it possible to modify the header somehow to just return</p>\n\n<pre><code>application/json\n</code></pre>\n\n<p>I'd rather take this approach than splitting the string at the <code>;</code></p>\n"}, {"tags": ["reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1541770594, "post_id": 32890188, "comment_id": 93340246, "body": "@mh-cbon: OP was looking for a Slice method that returns a slice of the underlying type, sort of like <code>Bytes() []bytes</code>. The <code>Slice</code> method on <code>reflect.Value</code> returns <code>Value</code>, something that isn&#39;t of the original type. I&#39;ve clarified that in my answer."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1541791506, "post_id": 32890188, "comment_id": 93351104, "body": "I think this answer is misleading and that it should clarify that reflect provides the capabilities do deal with the slice, but that for reasons related to the type system there is no shortcut function such <code>Slice() []&lt;my type&gt;</code> but a fully functional api. imho."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 10, "last_activity_date": 1541770449, "last_edit_date": 1541770449, "creation_date": 1443709873, "answer_id": 32890188, "question_id": 32890137, "link": "https://stackoverflow.com/questions/32890137/how-to-get-slice-underlying-value-via-reflect-value/32890188#32890188", "title": "How to get slice underlying value via reflect.Value", "body": "<p>There is no <code>Slice() []T</code> method on <code>reflect.Value</code> because there is no return value that would be valid for all slice types. For example, <code>Slice() []int</code> would only work for int slices, <code>Slice() []string</code> for string slices, etc. <code>Slice() []interface{}</code> would also not work, <a href=\"https://stackoverflow.com/questions/12990338/cannot-convert-string-to-interface\">due to how the slice is stored in memory</a>.</p>\n\n<p>Instead, you can get the underlying slice value by using the <a href=\"https://godoc.org/reflect#Value.Interface\" rel=\"nofollow noreferrer\"><code>reflect.Value.Interface()</code></a> method along with a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>:</p>\n\n<p>Example usage:</p>\n\n<pre><code>slice, ok := value.Interface().([]SliceElemType)\nif !ok {\n    panic(\"value not a []MySliceType\")\n}\n</code></pre>\n"}], "owner": {"reputation": 985, "user_id": 3453896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/X93JO.jpg?s=128&g=1", "display_name": "Chenglu", "link": "https://stackoverflow.com/users/3453896/chenglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6040, "favorite_count": 0, "accepted_answer_id": 32890188, "answer_count": 1, "score": 3, "last_activity_date": 1541770449, "creation_date": 1443709727, "question_id": 32890137, "link": "https://stackoverflow.com/questions/32890137/how-to-get-slice-underlying-value-via-reflect-value", "title": "How to get slice underlying value via reflect.Value", "body": "<p>I read the <a href=\"https://golang.org/pkg/reflect/#Value.Slice\" rel=\"nofollow\">reflect document</a> and I'm a little confused about why it doesn't have a <code>func (v Value) Slice() slice</code> function, which to get the underlying value from a reflect.Value which holds a slice in.</p>\n\n<p>Is there a convenient way to get the underlying slice from a reflect.Value ? </p>\n"}, {"tags": ["http", "caching", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1443690990, "post_id": 32882790, "comment_id": 53597806, "body": "Did you try some programming here? Or do you expect to find some package with magical <code>func DumpResponse(filename string) error</code> and <code>func Loadesponse(filename string) (*http.Response, error)</code>?"}, {"owner": {"reputation": 217, "user_id": 4443249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100000487150108/picture?type=large", "display_name": "nanolab", "link": "https://stackoverflow.com/users/4443249/nanolab"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1443691514, "post_id": 32882790, "comment_id": 53598130, "body": "@Volker I&#39;m asking for ideas, not ready made package."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1443691666, "post_id": 32882790, "comment_id": 53598227, "body": "convert <code>resp</code> to a <code>byte</code> array and write to a file. <a href=\"http://stackoverflow.com/questions/26372227/go-conversion-between-struct-and-byte-array\" title=\"go conversion between struct and byte array\">stackoverflow.com/questions/26372227/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1443692231, "post_id": 32882790, "comment_id": 53598604, "body": "Don&#39;t forget the headers."}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 4443249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100000487150108/picture?type=large", "display_name": "nanolab", "link": "https://stackoverflow.com/users/4443249/nanolab"}, "edited": false, "score": 0, "creation_date": 1443697358, "post_id": 32885209, "comment_id": 53601630, "body": "Works great! Thank you!"}], "tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 16, "last_activity_date": 1578342938, "last_edit_date": 1578342938, "creation_date": 1443695183, "answer_id": 32885209, "question_id": 32882790, "link": "https://stackoverflow.com/questions/32882790/how-to-cache-http-response-in-golang/32885209#32885209", "title": "How to cache http.Response in golang?", "body": "<p>The easiest way is to use <a href=\"https://golang.org/pkg/net/http/httputil/#DumpResponse\" rel=\"nofollow noreferrer\">httputil.DumpResponse</a> and <a href=\"https://golang.org/pkg/net/http/#ReadResponse\" rel=\"nofollow noreferrer\">http.ReadResponse</a>.</p>\n\n<p><a href=\"http://play.golang.org/p/y6qIPwNVon\" rel=\"nofollow noreferrer\">See here for an example</a>. (You have to copy the code onto your local machine and run it there, because the Playground doesn't allow I/O)</p>\n\n<p>The first dumps your request as-received, optionally also dumping the body, to an in-memory []byte that you can then write to disk. Later you can read the response back from disk (or where ever you stored it) and wrap it in an bufio.Reader, which you pass to http.ReadResponse.</p>\n\n<p>ReadResponse takes a *http.Request as second parameter that is used as the value for the Request field of the response. If nil is given, the returned Response will have GET request in it's Request field.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5396965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6vjgR.jpg?s=128&g=1", "display_name": "Artem Tyrnov", "link": "https://stackoverflow.com/users/5396965/artem-tyrnov"}, "is_accepted": false, "score": 7, "last_activity_date": 1443700590, "creation_date": 1443700590, "answer_id": 32887037, "question_id": 32882790, "link": "https://stackoverflow.com/questions/32882790/how-to-cache-http-response-in-golang/32887037#32887037", "title": "How to cache http.Response in golang?", "body": "<p>... Or use <a href=\"https://github.com/lox/httpcache\" rel=\"noreferrer\">https://github.com/lox/httpcache</a>. An RFC7234 compliant golang http.Handler for caching HTTP responses</p>\n"}], "owner": {"reputation": 217, "user_id": 4443249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100000487150108/picture?type=large", "display_name": "nanolab", "link": "https://stackoverflow.com/users/4443249/nanolab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9905, "favorite_count": 1, "accepted_answer_id": 32885209, "answer_count": 2, "score": 11, "last_activity_date": 1578342938, "creation_date": 1443687857, "last_edit_date": 1443688836, "question_id": 32882790, "link": "https://stackoverflow.com/questions/32882790/how-to-cache-http-response-in-golang", "title": "How to cache http.Response in golang?", "body": "<pre><code>req, err := http.NewRequest(\"GET\", \"http://example.com\", nil)\nreq.AddCookie(&amp;http.Cookie{Name: \"c\", Value: \"ccc\"})\nresp, err := client.Do(req)\n</code></pre>\n\n<p>I need to cache resp on disk and keep its type as http.Response after restoring from cache.\nAny ideas?</p>\n"}, {"tags": ["go", "web-crawler", "relative-path", "absolute-path"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1443683594, "post_id": 32880467, "comment_id": 53593516, "body": "No there is not. You cannot know if <code>href=&quot;example&#47;example.php&quot;</code> is a new, deeper page or a bug in the website. Depending on the server you might be able to tell from the headers (E-Tag?) if you got the same page again."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1443685419, "post_id": 32880467, "comment_id": 53594571, "body": "You need to compare the content, but it will probably not be identical. You can use a technique such as MinHash (<a href=\"https://en.wikipedia.org/wiki/MinHash\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/MinHash</a>) or SimHash (<a href=\"http://matpalm.com/resemblance/simhash/\" rel=\"nofollow noreferrer\">matpalm.com/resemblance/simhash</a>) to estimate if it&#39;s similar enough to be the same page. That&#39;s how most web crawlers work"}, {"owner": {"reputation": 421, "user_id": 2873262, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f8b8419c1469cda8acef2c3a8546d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/2873262/sunil"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1443685976, "post_id": 32880467, "comment_id": 53594904, "body": "Thanks @Not_a_Golfer, I was expecting some other workaround to get this done like  Volker suggested.(Yes, I was unaware about E-tag). Hashing was on my mind. I am thinking of doing hashing only if certain link starts to repeat. I&#39;ll look into it"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1443686495, "post_id": 32880467, "comment_id": 53595188, "body": "@Sunil don&#39;t count on ETAGS, and anyway, you should use similarity hashing for pages that are the same and have different URLs (think mobile vs. desktop versions of the same page)"}], "owner": {"reputation": 421, "user_id": 2873262, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f8b8419c1469cda8acef2c3a8546d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/2873262/sunil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 718, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1443679592, "creation_date": 1443679592, "question_id": 32880467, "link": "https://stackoverflow.com/questions/32880467/relative-url-crawling-issue", "title": "Relative URl crawling issue", "body": "<p>I'm making a crawler that fetches all relative and absolute links. But if there is a relative url that is incorrect, then the crawler continues to prepare new absolute url in the website that handles incorrect urls with 200 response code. </p>\n\n<p>Let's say, there is a relative link : \"example/example.php\", when I try to crawl <a href=\"http://example.com/example.com\" rel=\"nofollow\">http://example.com/example.com</a>. When I find that page, I'll append and create a new link to crawl i.e. <a href=\"http://example.com/example/example.php\" rel=\"nofollow\">http://example.com/example/example.php</a>. The problem is the page will again contain example/example.php which then appends to <a href=\"http://example.com/example/example/example.php\" rel=\"nofollow\">http://example.com/example/example/example.php</a>. </p>\n\n<p>Is there a better way of getting rid of this other than content comparison?</p>\n"}, {"tags": ["http", "go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 0, "creation_date": 1443711189, "post_id": 32879642, "comment_id": 53610969, "body": "Done. However, there are no errors, and it&#39;s only returning one file length, even though the rest are written to disk. That&#39;s strange."}], "tags": [], "owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "is_accepted": true, "score": 3, "last_activity_date": 1443674874, "creation_date": 1443674874, "answer_id": 32879642, "question_id": 32879472, "link": "https://stackoverflow.com/questions/32879472/downloading-files-with-goroutines/32879642#32879642", "title": "downloading files with goroutines?", "body": "<p>While I'm not sure exactly what's causing your issue, here's two options for how to get it back into working order.</p>\n\n<p>First, looking to the <a href=\"https://golang.org/pkg/sync/#example_WaitGroup\" rel=\"nofollow\">example of how to use waitgroups</a> from the sync library, try calling <code>defer wg.Done()</code> at the beginning of your function to ensure that even if the goroutine ends unexpectedly, that the waitgroup is properly decremented.</p>\n\n<p>Second, <code>io.Copy</code> returns an error that you're not checking. That's not great practice anyway, but in your particular case it's preventing you from seeing if there is indeed an error in the copying routine. Check it and deal with it appropriately. It also returns the number of bytes written, which might help you as well.</p>\n"}, {"comments": [{"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 0, "creation_date": 1443711131, "post_id": 32879662, "comment_id": 53610919, "body": "I changed to <code>defer wg.Done()</code> at the start, and removed <code>os.Exit()</code> and <code>panic()</code>. However, it&#39;s still truncating the images. The current dataset had 41 separate goroutines, do you think it&#39;s a limitation of my filesystem trying to write 41 separate files all at once?"}], "tags": [], "owner": {"reputation": 1889, "user_id": 1036501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z8PwP.png?s=128&g=1", "display_name": "zstewart", "link": "https://stackoverflow.com/users/1036501/zstewart"}, "is_accepted": false, "score": 3, "last_activity_date": 1443675004, "creation_date": 1443675004, "answer_id": 32879662, "question_id": 32879472, "link": "https://stackoverflow.com/questions/32879472/downloading-files-with-goroutines/32879662#32879662", "title": "downloading files with goroutines?", "body": "<p>Your example doesn't have anything obviously wrong with its use of WaitGroups. As long as you are calling <code>wg.Add()</code> with the same number as the number of goroutines you launch, or incrementing it by 1 every time you start a new goroutine, that should be correct.</p>\n\n<p>However you call <code>os.Exit</code> and <code>panic</code> for certain errors conditions in the goroutine, so if you have more than one of these running, a failure in any one of them will terminate all of them, regardless of the use of WaitGroups. If it's failing without a panic message, I would take a look at the <code>os.Exit(1)</code> line.</p>\n\n<p>It would also, be good practice in go to use <code>defer wg.Done()</code> at the start of your function, so that even if an error occurs, the goroutine still decrements its counter. That way your main thread won't hang on completion if one of the goroutines returns an error.</p>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 8109026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jomoj.jpg?s=128&g=1", "display_name": "Raed Shomali", "link": "https://stackoverflow.com/users/8109026/raed-shomali"}, "is_accepted": false, "score": 0, "last_activity_date": 1496973047, "creation_date": 1496973047, "answer_id": 44448077, "question_id": 32879472, "link": "https://stackoverflow.com/questions/32879472/downloading-files-with-goroutines/44448077#44448077", "title": "downloading files with goroutines?", "body": "<p>One change I would make in your example is leverage <code>defer</code> when you are <code>Done</code>. I think this <code>defer ws.Done()</code> should be the first statement in your function.</p>\n\n<p>I like <code>WaitGroup</code>'s simplicity. However, I do not like that we need to pass the reference to the goroutine because that would mean that the concurrency logic would be mixed with your business logic.</p>\n\n<p>So I came up with this generic function to solve this problem for me:</p>\n\n<pre><code>// Parallelize parallelizes the function calls\nfunc Parallelize(functions ...func()) {\n    var waitGroup sync.WaitGroup\n    waitGroup.Add(len(functions))\n\n    defer waitGroup.Wait()\n\n    for _, function := range functions {\n        go func(copy func()) {\n            defer waitGroup.Done()\n            copy()\n        }(function)\n    }\n}\n</code></pre>\n\n<p>So your example could be solved this way:</p>\n\n<pre><code>func imageDownloader(uri string, filename string) {\n    ...\n    io.Copy(outFile, rd)\n}\n\nfunc main() {\n    functions := []func(){}\n    list := make([]Object, 5)\n    for _, object := range list {\n        function := func(obj Object){ \n            imageDownloader(object.uri, object.filename) \n        }(object)\n        functions = append(functions, function)\n    }\n\n    Parallelize(functions...)        \n\n    fmt.Println(\"Done\")\n}\n</code></pre>\n\n<p>If you would like to use it, you can find it here <a href=\"https://github.com/shomali11/util\" rel=\"nofollow noreferrer\">https://github.com/shomali11/util</a></p>\n"}], "owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 1, "accepted_answer_id": 32879642, "answer_count": 3, "score": 0, "last_activity_date": 1496973047, "creation_date": 1443673703, "last_edit_date": 1443714318, "question_id": 32879472, "link": "https://stackoverflow.com/questions/32879472/downloading-files-with-goroutines", "title": "downloading files with goroutines?", "body": "<p>I'm new to Go and I'm learning how to work with goroutines.</p>\n\n<p>I have a function that downloads images:</p>\n\n<pre><code>func imageDownloader(uri string, filename string) {\n    fmt.Println(\"starting download for \", uri)\n\n    outFile, err := os.Create(filename)\n    defer outFile.Close()\n    if err != nil {\n        os.Exit(1)\n    }\n\n    client := &amp;http.Client{}\n\n    req, err := http.NewRequest(\"GET\", uri, nil)\n\n    resp, err := client.Do(req)\n    defer resp.Body.Close()\n\n    if err != nil {\n        panic(err)\n    }\n\n    header := resp.ContentLength\n    bar := pb.New(int(header))\n    rd := bar.NewProxyReader(resp.Body)\n    // and copy from reader\n    io.Copy(outFile, rd)\n}\n</code></pre>\n\n<p>When I call by itself as part of another function, it downloads images completely and there is no truncated data.</p>\n\n<p>However, when I try to modify it to make it a goroutine, images are often truncated or zero length files.</p>\n\n<pre><code>func imageDownloader(uri string, filename string, wg *sync.WaitGroup) {\n    ...\n    io.Copy(outFile, rd)\n    wg.Done()\n}\n\nfunc main() {\nvar wg sync.WaitGroup\nwg.Add(1)\ngo imageDownloader(url, file, &amp;wg)\nwg.Wait()\n}\n</code></pre>\n\n<p>Am I using WaitGroups incorrectly? What could cause this and how can I fix it?</p>\n\n<p>Update:</p>\n\n<p>Solved it. I had placed the <code>wg.add()</code> function outside of a loop. :(</p>\n"}, {"tags": ["go", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443705380, "post_id": 32877999, "comment_id": 53606849, "body": "No, there is not currently a way to do that"}, {"owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "edited": false, "score": 0, "creation_date": 1471695761, "post_id": 32877999, "comment_id": 65457261, "body": "this would be awesome to compile directly from AST... heh"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1494408023, "post_id": 32877999, "comment_id": 74810652, "body": "yes, or at least support generating source from AST."}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 3029676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qTCxh.png?s=128&g=1", "display_name": "wgoodall01", "link": "https://stackoverflow.com/users/3029676/wgoodall01"}, "is_accepted": false, "score": 1, "last_activity_date": 1542068300, "creation_date": 1542068300, "answer_id": 53272001, "question_id": 32877999, "link": "https://stackoverflow.com/questions/32877999/golang-compile-to-binary-from-ast/53272001#53272001", "title": "Golang compile to binary from AST", "body": "<p>Not at the moment, no. Right now, although Go's compiler is written in Go, it's <a href=\"https://golang.org/pkg/go/\" rel=\"nofollow noreferrer\">not exposed in the standard library</a>.</p>\n\n<p>The Gisp method, of printing the source and using <code>go build</code>, is probably your best option.</p>\n"}, {"comments": [{"owner": {"reputation": 945, "user_id": 382458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a1abc11b3d1e432758d39dfd7c69a20?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/382458/mark"}, "edited": false, "score": 0, "creation_date": 1570339303, "post_id": 57892276, "comment_id": 102878614, "body": "I was under the impression that the AST used by the compiler was quite different from the one in <code>go&#47;ast</code>. If so, it may not preserve comments and formatting, and any examples/blogs/SO answers dealing with <code>go&#47;ast</code> will be of little help."}], "tags": [], "owner": {"reputation": 2725, "user_id": 303114, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/kBVST.jpg?s=128&g=1", "display_name": "danfromisrael", "link": "https://stackoverflow.com/users/303114/danfromisrael"}, "is_accepted": false, "score": 1, "last_activity_date": 1568215238, "creation_date": 1568215238, "answer_id": 57892276, "question_id": 32877999, "link": "https://stackoverflow.com/questions/32877999/golang-compile-to-binary-from-ast/57892276#57892276", "title": "Golang compile to binary from AST", "body": "<p>well, gisp is really cool but theres a trick to use the original go parser to create that ast:</p>\n\n<p>you can create a local symlink to the compiler/internal/syntax folder:</p>\n\n<pre><code>ln -s $GOROOT/src/cmd/compile/internal/syntax\n</code></pre>\n\n<p>now your code can read a file and create an ast out of it like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/me/gocomp/syntax\"\n    \"os\"\n)\n\nfunc main() {\n    filename := \"./main.go\"\n    errh := syntax.ErrorHandler(\n        func(err error) {\n            fmt.Println(err)\n        })\n    ast, _ := syntax.ParseFile(\n        filename,\n        errh,\n        nil,\n        0)\n    f, _ := os.Create(\"./main.go.ast\")\n    defer f.Close()\n    syntax.Fdump(f, ast) //&lt;--this prints out your AST nicely\n}\n</code></pre>\n\n<p>now i have no idea how you can compile it.. but hey, at least you got your AST ;-)</p>\n"}], "owner": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 0, "answer_count": 2, "score": 10, "last_activity_date": 1568215238, "creation_date": 1443662122, "question_id": 32877999, "link": "https://stackoverflow.com/questions/32877999/golang-compile-to-binary-from-ast", "title": "Golang compile to binary from AST", "body": "<p>Is it possible to compile an AST to a binary in Golang? Or does the API not expose that feature. The way libraries currently do this, such as <a href=\"http://github.com/jcla1/gisp\" rel=\"noreferrer\">Gisp</a>, is to print out the AST using the go/printer package. Is there a way to skip this process and compile the AST directly to a binary?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "is_accepted": false, "score": 1, "last_activity_date": 1443665131, "creation_date": 1443665131, "answer_id": 32878367, "question_id": 32877813, "link": "https://stackoverflow.com/questions/32877813/unable-to-create-associations-via-golang-orm-library/32878367#32878367", "title": "Unable to create Associations via golang orm library", "body": "<p>You're missing your primary/foreign key references for each of your models, here's the updated code:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n    \"github.com/mattn/go-sqlite3\"\n)\n\nvar db gorm.DB\n\ntype User struct {\n    ID     uint `gorm:\"primary_key\"`\n    Name   string\n    Mail   Email\n    MailID sql.NullInt64\n}\n\ntype Email struct {\n    ID      uint `gorm:\"primary_key\"`\n    Address string\n}\n\n//Initialize DB .\nfunc InitDB() {\n    var DB_DRIVER string\n    sql.Register(DB_DRIVER, &amp;sqlite3.SQLiteDriver{})\n    log.Printf(\"Initializing Database with \", DB_DRIVER)\n    dbSql, _ := sql.Open(DB_DRIVER, \"simple-sqlite\")\n\n    var err error\n    db, err = gorm.Open(\"sqlite3\", dbSql)\n\n    if err != nil {\n        log.Fatalf(\"Got error when connecting to the database, the error is '%v'\", err)\n    }\n\n    db.LogMode(true)\n    // Then you could invoke `*sql.DB`'s functions with it\n    db.DB().Ping()\n    db.DB().SetMaxIdleConns(10)\n    db.DB().SetMaxOpenConns(100)\n\n    // Disable table name's pluralization\n    db.SingularTable(true)\n}\n\nfunc InitSchema() {\n    db.CreateTable(&amp;User{}, &amp;Email{})\n}\n\nfunc DoStuff() {\n    user := User{Name: \"Jinzhu\", Mail: Email{Address: \"hello@hello.com\"}}\n    db.Create(&amp;user)\n}\n\nfunc main() {\n    InitDB()\n    InitSchema()\n    DoStuff()\n}\n</code></pre>\n\n<p>notice the primary keys on the <code>User</code> and <code>Email</code> structs as well as the foreign key reference on <code>User</code></p>\n"}], "owner": {"reputation": 66, "user_id": 2217453, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4290b15aebda995d4e9308442732feaa?s=128&d=identicon&r=PG", "display_name": "n915", "link": "https://stackoverflow.com/users/2217453/n915"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 840, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1443665131, "creation_date": 1443660381, "question_id": 32877813, "link": "https://stackoverflow.com/questions/32877813/unable-to-create-associations-via-golang-orm-library", "title": "Unable to create Associations via golang orm library", "body": "<p>I've been trying to use the Associations feature in golang orm (<a href=\"https://github.com/jinzhu/gorm/\" rel=\"nofollow\">https://github.com/jinzhu/gorm/</a>), and am unable to create a pretty simple association. \nIn the example below, the user table contains data, but email table does not. \nI've tried a bunch of things and I'm probably missing something basic, but have been unable to find the right answer in github/stackoverflow.</p>\n\n<p>Code :</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n    \"github.com/mattn/go-sqlite3\"\n)\n\nvar db gorm.DB\n\ntype User struct {\n    Name   string\n    Mail   Email\n}\n\ntype Email struct {\n    Address string\n}\n\n//Initialize DB .\nfunc InitDB() {\n    var DB_DRIVER string\n    sql.Register(DB_DRIVER, &amp;sqlite3.SQLiteDriver{})\n    log.Printf(\"Initializing Database with \", DB_DRIVER)\n    dbSql, _ := sql.Open(DB_DRIVER, \"simple-sqlite\")\n\n    var err error\n    db, err = gorm.Open(\"sqlite3\", dbSql)\n\n    if err != nil {\n        log.Fatalf(\"Got error when connecting to the database, the error is '%v'\", err)\n    }\n\n    db.LogMode(true)\n    // Then you could invoke `*sql.DB`'s functions with it\n    db.DB().Ping()\n    db.DB().SetMaxIdleConns(10)\n    db.DB().SetMaxOpenConns(100)\n\n    // Disable table name's pluralization\n    db.SingularTable(true)\n}\n\nfunc InitSchema() {\n    db.CreateTable(&amp;User{}, &amp;Email{})\n}\n\nfunc DoStuff() {\n    user := User{Name: \"Jinzhu\", Mail: Email{Address: \"hello@hello.com\"}}\n    db.Create(&amp;user)\n}\n\nfunc main() {\n    InitDB()\n    InitSchema()\n    DoStuff()\n}\n</code></pre>\n\n<p>go run main.go prints the following output\n2015/09/30 17:25:04 Initializing Database with %!(EXTRA string=)</p>\n\n<p>[2015-09-30 17:25:04]  [3.21ms]  CREATE TABLE \"user\" (\"name\" varchar(255)) </p>\n\n<p>[2015-09-30 17:25:04]  [4.01ms]  CREATE TABLE \"email\" (\"address\" varchar(255) ) </p>\n\n<p>[2015-09-30 17:25:04]  [0.54ms]  INSERT INTO \"user\" (\"name\") VALUES ('Jinzhu') </p>\n\n<p>Not sure what I'm missing here - appreciate any response!</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1443661519, "post_id": 32877525, "comment_id": 53586841, "body": "Logically they both serve the purpose. Think about it like this: When you pass &amp;n into the function you are passing a copy of the memory address of n--equivalent to a pointer. If you pass *n in to the function the function gets a copy of its values, which is the memory address of n. So in that case they aren&#39;t all that different... except maybe asterisks look nicer :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 4, "creation_date": 1443708448, "post_id": 32877525, "comment_id": 53608916, "body": "@Snowman: your comment is very confusing. You can&#39;t say they &quot;aren&#39;t all that different&quot; when they do functionally opposite things. The <code>&amp;</code> operator <i>references</i> (takes the address of a value) and the  <code>*</code> operator <i>dereferences</i> (takes the value at an address)."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443791406, "post_id": 32877525, "comment_id": 53643655, "body": "@JimB I am simply pointing out that in the context of satisfying the arguments in the function call they aren&#39;t that different. In other contexts they are two opposite ends of the spectrum. Is any of what I said incorrect?"}], "answers": [{"comments": [{"owner": {"reputation": 386, "user_id": 5856677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5669cac9f20180c9f9b2474325d32c24?s=128&d=identicon&r=PG&f=1", "display_name": "mikias", "link": "https://stackoverflow.com/users/5856677/mikias"}, "edited": false, "score": 1, "creation_date": 1501136509, "post_id": 32878005, "comment_id": 77646927, "body": "Great example, although it would make it better if you included labels in the println statments."}], "tags": [], "owner": {"reputation": 706, "user_id": 5112803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c6e9987c82c45ca24a96f29b7989eba?s=128&d=identicon&r=PG&f=1", "display_name": "wueb", "link": "https://stackoverflow.com/users/5112803/wueb"}, "is_accepted": true, "score": 51, "last_activity_date": 1559736496, "last_edit_date": 1559736496, "creation_date": 1443662198, "answer_id": 32878005, "question_id": 32877525, "link": "https://stackoverflow.com/questions/32877525/please-explain-and-pointers/32878005#32878005", "title": "Please explain &amp;, and * pointers", "body": "<p>In your example above you defined u as type User, but not a pointer to a User. So you need the &amp;u because the Decode function in the json package is expecting an address or pointer. </p>\n\n<p>If you created the instance of User like this: u := new(User) it would be a pointer since the new function returns a pointer. You could also create a pointer to a user like this: var u *User. If you did either of those, you would have to take out the <code>&amp;</code> in the call to Decode for it to work.</p>\n\n<p>Pointers are basically variables that hold addresses. When you put the &amp; in front of a variable it returns the address. The * could be read as 'redirect of'. So when you create a pointer like this:</p>\n\n<p>var x *int</p>\n\n<p>This can be read as x will redirect to an int. And when you assign a value to x you would give it an address like this:\ny := 10\nx = &amp;y</p>\n\n<p>Where y is some int. So if you were to print out x, you would get the address of y, but if you printed out *x you would redirect to the what x points to which is y's value which is 10. If you were to print out &amp;x, you would get the address of the pointer, x, itself.</p>\n\n<p>If you tried to print out *y, which is just an int, not a pointer, it would throw an error because you would be redirecting with some value that is not an address to redirect to.</p>\n\n<p>Run the below for some pointer fun:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var y int\n    var pointerToY *int\n    var pointerToPointerToInt **int\n\n    y = 10\n    pointerToY = &amp;y\n    pointerToPointerToInt = &amp;pointerToY\n\n    fmt.Println(\"y: \", y)\n    fmt.Println(\"pointerToY: \", pointerToY)\n    fmt.Println(\"pointerToPointerToInt: \", pointerToPointerToInt)\n\n    fmt.Println(\"&amp;y: \", &amp;y)     // address of y\n    fmt.Println(\"&amp;pointerToY: \", &amp;pointerToY)// address of pointerToY\n    fmt.Println(\"&amp;pointerToPointerToInt: \", &amp;pointerToPointerToInt) // address of pointerToPointerToInt\n\n    // fmt.Println(*y) throws an error because \n    // you can't redirect without an address.. \n    // y only has int value of 10\n    fmt.Println(\"*pointerToY: \", *pointerToY) // gives the value of y\n    fmt.Println(\"*pointerToPointerToInt: \", *pointerToPointerToInt)     // gives the value of pointerToY which is the address of y\n\n    fmt.Println(\"**pointerToPointerToInt: \", **pointerToPointerToInt)    // this gives 10, because we are redirecting twice to get y\n\n    if pointerToY == *pointerToPointerToInt {\n        fmt.Println(\"'pointerToY == *pointerToPointerToInt' are the same!\")\n    }\n\n    if pointerToY == &amp;y {\n        fmt.Println(\"'pointerToY == &amp;y' are the same!\")\n    }\n\n    if &amp;pointerToY == pointerToPointerToInt {\n        fmt.Println(\"'&amp;pointerToY == pointerToPointerToInt' are the same!\")\n    }\n\n    if y == **pointerToPointerToInt {\n        fmt.Println(\"'y == **pointerToPointerToInt' are the same!\")\n    }\n\n    if pointerToY == *pointerToPointerToInt {\n        fmt.Println(\"'pointerToY == *pointerToPointerToInt' are the same!\")\n    }\n\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 777, "user_id": 1660210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aK1ic.png?s=128&g=1", "display_name": "user1660210", "link": "https://stackoverflow.com/users/1660210/user1660210"}, "is_accepted": false, "score": 13, "last_activity_date": 1504299997, "creation_date": 1504299997, "answer_id": 46007951, "question_id": 32877525, "link": "https://stackoverflow.com/questions/32877525/please-explain-and-pointers/46007951#46007951", "title": "Please explain &amp;, and * pointers", "body": "<p>I will quote one smart dude:</p>\n\n<blockquote>\n  <p>&amp; in front of variable name is used to retrieve the address of where\n  this variable\u2019s value is stored. That address is what the pointer is\n  going to store.</p>\n  \n  <p>* in front of a type name, means that the declared variable will store an address of another variable of that type (not a value of that\n  type).</p>\n  \n  <p>* in front of a variable of pointer type is used to retrieve a value stored at given address. In Go speak this is called dereferencing.</p>\n</blockquote>\n\n<p>source: <a href=\"http://piotrzurek.net/2013/09/20/pointers-in-go.html\" rel=\"noreferrer\">http://piotrzurek.net/2013/09/20/pointers-in-go.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 13470, "user_id": 3092377, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/8lUZ9.jpg?s=128&g=1", "display_name": "Shashank Vivek", "link": "https://stackoverflow.com/users/3092377/shashank-vivek"}, "is_accepted": false, "score": 2, "last_activity_date": 1559736557, "last_edit_date": 1559736557, "creation_date": 1558794235, "answer_id": 56305683, "question_id": 32877525, "link": "https://stackoverflow.com/questions/32877525/please-explain-and-pointers/56305683#56305683", "title": "Please explain &amp;, and * pointers", "body": "<p><code>pointer</code> is used to <strong>point</strong> towards <code>address</code> and it stores the memory address</p>\n\n<p>Adding one example to help understand <code>pointer</code> vs <code>address</code>:</p>\n\n<p><a href=\"https://play.golang.org/p/L1gqOl-LnD6\" rel=\"nofollow noreferrer\">Demo code</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var y int\n    var pointerToY *int\n    var x int\n    //var willThrowErrorVariable int\n\n    y = 10\n    pointerToY = &amp;y\n    //willThrowErrorVariable = &amp;y \n    x = *pointerToY\n\n    fmt.Println(\"y: \",y)\n    fmt.Println(\"y's address using pointerToY: \",pointerToY)\n\n    y = 4\n    fmt.Println(\"====================================================\")\n    fmt.Println(\"Address of y after its value is changed: \",pointerToY)\n    fmt.Println(\"value of y using pointer after its value is changed: \",*pointerToY)\n    fmt.Println(\"Value of x after y value is changed: \",x)\n}\n</code></pre>\n\n<blockquote>\n  <p>output</p>\n</blockquote>\n\n<pre><code>y:  10\ny's address using pointerToY:  0x414020\n====================================================\nAddress of y after its value is changed:  0x414020\nvalue of y using pointer after its value is changed:  4\nValue of x after y value is changed:  10\n</code></pre>\n\n<p>As we can see, the value might change but the <code>address</code>(<code>&amp;</code>) remains same and so the <code>pointer</code>(<code>*</code>) points to the value of <code>address</code>.</p>\n\n<p>In above example, </p>\n\n<ol>\n<li><code>pointerToY</code> holds the pointer to refer <code>address</code> of <code>y</code>.</li>\n<li><code>x</code> holds the value which we pass to it using <code>pointer</code> to <code>address</code> of <code>y</code>.</li>\n<li>After changing the value of <code>y</code> , the <code>x</code> still has <code>10</code> but if we try to access the value using <code>pointer</code> to <code>address</code> (<strong>pointerToY</strong>) , we get <code>4</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 690, "user_id": 7298873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/038j2.jpg?s=128&g=1", "display_name": "monkrus", "link": "https://stackoverflow.com/users/7298873/monkrus"}, "is_accepted": false, "score": 2, "last_activity_date": 1586045066, "creation_date": 1586045066, "answer_id": 61036399, "question_id": 32877525, "link": "https://stackoverflow.com/questions/32877525/please-explain-and-pointers/61036399#61036399", "title": "Please explain &amp;, and * pointers", "body": "<p>A simple example showing the code execution sequence.</p>\n\n<pre><code>   import (\n        \"fmt\"\n    )\n\n    func main() {\n        x := 0\n        fmt.Println(\"Step 1\", x)\n        foo(&amp;x)\n        fmt.Println(\"Step 4\", x)\n    }\n\n    func foo(y *int) {\n\n        fmt.Println(\"Step 2\", *y)\n        *y = 100\n        fmt.Println(\"Step 3\", *y)\n    }\n/*\n Steps  Result\n   1      0\n   2      0\n   3      100\n   4      100\n */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5029, "user_id": 7199922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ih0Gk.jpg?s=128&g=1", "display_name": "Tadej", "link": "https://stackoverflow.com/users/7199922/tadej"}, "is_accepted": false, "score": 1, "last_activity_date": 1589232842, "creation_date": 1589232842, "answer_id": 61739793, "question_id": 32877525, "link": "https://stackoverflow.com/questions/32877525/please-explain-and-pointers/61739793#61739793", "title": "Please explain &amp;, and * pointers", "body": "<p>For this answer I will try to explain it with a variable value. A pointer can point also to a struct value.</p>\n\n<p><code>&amp;</code> returns a pointer, which points to a variable value.</p>\n\n<p><code>*</code> reads the variable value to which the pointer is pointing.</p>\n\n<p>Example:</p>\n\n<pre><code>func zero(xPointer *int) {\n  *xPointer = 0\n  fmt.Println(*xPointer)\n}\n\nfunc main() {\n  x := 1\n  zero(&amp;x)\n  fmt.Println(x) // x is 0\n}\n</code></pre>\n"}], "owner": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12710, "favorite_count": 1, "accepted_answer_id": 32878005, "answer_count": 5, "score": 27, "last_activity_date": 1603349265, "creation_date": 1443658132, "last_edit_date": 1603349265, "question_id": 32877525, "link": "https://stackoverflow.com/questions/32877525/please-explain-and-pointers", "title": "Please explain &amp;, and * pointers", "body": "<p>There have been multiple instances where the compiler throws an error when I try to pass variables as arguments inside Go functions. I've been able to debug this sometimes by using a pointer in front of the variable. Both &amp;, and * pointers seem to clear the error. Though, I'd like to understand why. I'm wondering what the difference between &amp;, and * is, and when each should be used. Thank you!</p>\n<pre><code>func (ctx *NewContext) SendNotification(rw http.ResponseWriter, req *http.Request, p httprouter.Params) {\n\n    decoder := json.NewDecoder(req.Body)\n\n    var u User\n\n    if err := decoder.Decode(&amp;u); err != nil {\n        http.Error(rw, &quot;could not decode request&quot;, http.StatusBadRequest)\n        return\n    }\n}\n</code></pre>\n"}]