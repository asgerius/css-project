[{"tags": ["eclipse", "git", "go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1443651100, "post_id": 32876283, "comment_id": 53584216, "body": "does <code>go get github.com&#47;nsf&#47;gocode</code> not work?"}, {"owner": {"reputation": 1525, "user_id": 4529681, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/10202982404234891/picture?type=large", "display_name": "Gustavo Mendon&#231;a", "link": "https://stackoverflow.com/users/4529681/gustavo-mendon%c3%a7a"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1443653612, "post_id": 32876283, "comment_id": 53584975, "body": "It works! But where should I use this? In exactly what folder should I download it? And how do I import to my .go file?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1443676135, "post_id": 32876283, "comment_id": 53590313, "body": "Setting GOROOT is cargo cult from the past. Don&#39;t do it."}], "answers": [{"tags": [], "owner": {"reputation": 1525, "user_id": 4529681, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/10202982404234891/picture?type=large", "display_name": "Gustavo Mendon&#231;a", "link": "https://stackoverflow.com/users/4529681/gustavo-mendon%c3%a7a"}, "is_accepted": true, "score": 1, "last_activity_date": 1443656932, "creation_date": 1443656932, "answer_id": 32877344, "question_id": 32876283, "link": "https://stackoverflow.com/questions/32876283/go-language-configuring/32877344#32877344", "title": "Go language configuring", "body": "<p>I solved my problem doing this steps:</p>\n\n<ul>\n<li>Downloaded the <code>gocode</code> to the <code>src</code> folder. (The path: <code>C:\\Users\\Gustavo\\goprojects\\src\\github.com\\nsf\\gocode</code>)</li>\n<li>In the Eclipse, do this: Window -> Preferences.</li>\n<li>Open Go option in the left menu then click Tools.</li>\n<li>In the gocode path I set <code>C:\\Users\\Gustavo\\goprojects\\bin\\gocode.exe</code></li>\n</ul>\n\n<p>And thats it! It works now.</p>\n"}], "owner": {"reputation": 1525, "user_id": 4529681, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/10202982404234891/picture?type=large", "display_name": "Gustavo Mendon&#231;a", "link": "https://stackoverflow.com/users/4529681/gustavo-mendon%c3%a7a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 32877344, "answer_count": 1, "score": 0, "last_activity_date": 1443656932, "creation_date": 1443650238, "question_id": 32876283, "link": "https://stackoverflow.com/questions/32876283/go-language-configuring", "title": "Go language configuring", "body": "<p>I need to do a work for my university and I choose to do it using the Go language. Yesterday I installed the .msi and setted the variables to:</p>\n\n<ul>\n<li>GOPATH = <code>C:\\Users\\Gustavo\\goprojects</code> (this is the folder that I want to place all my Go projects)</li>\n<li>GOROOT = <code>C:\\Go\\</code></li>\n<li>PATH = <code>C:\\Users\\Gustavo\\goprojects\\bin</code></li>\n</ul>\n\n<p>After this, I installed the GoClipse plugin on my Eclipse and created a new project into the <code>goprojects</code> folder. Then, I created another folder in the <code>src</code> folder, and a .go file into this folder.</p>\n\n<p>Now is my problem. When I started to write some code, everytime that I try to auto complete my code, Eclipse shows me an error and I was searching on google and found that I need to install one project from GitHub called <code>gocode</code>. </p>\n\n<p>So I want to know where do I need to install it and how can I import it to my project.</p>\n\n<p>P.S.: I am using Windows 8.1, I have git installed and the link of <code>gocode</code> project is: <a href=\"https://github.com/nsf/gocode\" rel=\"nofollow\">https://github.com/nsf/gocode</a></p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1443648025, "last_edit_date": 1443648025, "creation_date": 1443647330, "answer_id": 32875677, "question_id": 32875605, "link": "https://stackoverflow.com/questions/32875605/how-to-modify-type-slice-inside-method/32875677#32875677", "title": "How to modify type slice inside method?", "body": "<p>You need to use a pointer receiver, which you've tried in your second example, but you then overwrite the pointer value which defeats the purpose.</p>\n\n<p>You could use </p>\n\n<pre><code>func (test *Test) Add(str string) {\n    v := append(*test, str)\n    *test = v\n}\n</code></pre>\n\n<p>Or more clearly:</p>\n\n<pre><code>func (test *Test) Add(str string) {\n    *test = append(*test, str)\n}\n</code></pre>\n"}], "owner": {"reputation": 1089, "user_id": 2407325, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8bac1f584404bf17e4a0eb1953c72aad?s=128&d=identicon&r=PG&f=1", "display_name": "monkey", "link": "https://stackoverflow.com/users/2407325/monkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 32875677, "answer_count": 1, "score": 0, "last_activity_date": 1443648025, "creation_date": 1443647069, "question_id": 32875605, "link": "https://stackoverflow.com/questions/32875605/how-to-modify-type-slice-inside-method", "title": "How to modify type slice inside method?", "body": "<p>How to modify type slice inside method? I tried \n<a href=\"http://play.golang.org/p/ul2n8mk6ye\" rel=\"nofollow\">http://play.golang.org/p/ul2n8mk6ye</a></p>\n\n<pre><code>type Test []string\n\nfunc (test Test) Add(str string) {\n    test = append(test, str)\n}\n\nfunc main() {\n    test := Test{}\n    test.Add(\"value\")\n    fmt.Println(len(test))//0\n}\n</code></pre>\n\n<p>And <a href=\"http://play.golang.org/p/nV9IO7E5sp\" rel=\"nofollow\">http://play.golang.org/p/nV9IO7E5sp</a></p>\n\n<pre><code>type Test []string\n\nfunc (test *Test) Add(str string) {\n    v := append(*test, str)\n    test = &amp;v\n}\n\nfunc main() {\n        test := Test{}\n    test.Add(\"value\")\n    fmt.Println(len(test))//0\n}\n</code></pre>\n\n<p>But it does not work.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 3, "creation_date": 1443632328, "post_id": 32871719, "comment_id": 53575226, "body": "you can do that using pointers. <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/1</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443632421, "post_id": 32871719, "comment_id": 53575270, "body": "This seems like it would be well covered in the basic docs. You should probably start here first: <a href=\"https://golang.org/doc/\" rel=\"nofollow noreferrer\">golang.org/doc</a>"}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1443632647, "post_id": 32871719, "comment_id": 53575385, "body": "As the docs can be a bit steep for a newbie this is a pretty simple and comprehensive text about the basics of using Go: <a href=\"https://www.golang-book.com/books/intro/8\" rel=\"nofollow noreferrer\">golang-book.com/books/intro/8</a>"}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 1, "creation_date": 1443636196, "post_id": 32871719, "comment_id": 53577253, "body": "@Snowman: Please be careful when editing questions, that you don&#39;t change the meaning of the question. (This includes question titles.)"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1443637286, "post_id": 32871719, "comment_id": 53577828, "body": "In a real Go program I&#39;d prefer returning values from functions. Especially since Go can return multiple return values. Then this would look like <code>color = changeColor(color)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1443638251, "post_id": 32872371, "comment_id": 53578318, "body": "Sorry to get into semantics on a beginner question like this, but since &quot;passing by reference&quot; isn&#39;t well defined (except in languages like C++ with  something called &quot;references&quot;), most of us prefer to avoid that term for Go. Everything in go is pass by value, including pointers, where the pointer <i>value</i> is copied into the argument variable."}, {"owner": {"reputation": 4011, "user_id": 29703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/32e50f8f8e17d63c49bf03d54a48282a?s=128&d=identicon&r=PG", "display_name": "Jeffrey Martinez", "link": "https://stackoverflow.com/users/29703/jeffrey-martinez"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443639897, "post_id": 32872371, "comment_id": 53579206, "body": "Thanks for the reminder @JimB. I&#39;ve updated my answer to have more correct language. To my knowledge though, &quot;pass by reference&quot; is well defined in traditional comp-sci text books, though I I did indeed use it incorrectly here. If the answer still look off, feel free to edit, I won&#39;t be offended :p"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443641741, "post_id": 32872371, "comment_id": 53580061, "body": "Yes, maybe the term is well defined in the academic sense, but colloquially it&#39;s often incorrectly used (for example, just look at the wiki article you linked under &quot;call by sharing&quot; which lists ruby counter to the community claims of it being &quot;pass-by-reference&quot;)."}], "tags": [], "owner": {"reputation": 4011, "user_id": 29703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/32e50f8f8e17d63c49bf03d54a48282a?s=128&d=identicon&r=PG", "display_name": "Jeffrey Martinez", "link": "https://stackoverflow.com/users/29703/jeffrey-martinez"}, "is_accepted": true, "score": 3, "last_activity_date": 1443639822, "last_edit_date": 1443639822, "creation_date": 1443634418, "answer_id": 32872371, "question_id": 32871719, "link": "https://stackoverflow.com/questions/32871719/inputting-variable-name-into-functions/32872371#32872371", "title": "Inputting variable name into functions", "body": "<p>You can learn about the concept in general by reading up on different <a href=\"https://en.wikipedia.org/wiki/Evaluation_strategy\" rel=\"nofollow\">Evaluation Strategies</a> that programming languages employ. In Go you can achieve the behavior you are looking for with pointers.</p>\n\n<p>Without pointers you are usually passing around copies of your variable. With pointers, you are passing a copy of the <em>location</em> of the value in memory. This means the function can then modify the actual value at the location is has learned about.</p>\n\n<p>Here is an example that does what you explained:</p>\n\n<p><a href=\"http://play.golang.org/p/ufrEjmXwmB\" rel=\"nofollow\">http://play.golang.org/p/ufrEjmXwmB</a></p>\n\n<p>Keep in mind this is probably not the best way to do this in a real program. If the point is to just learn though, then go for it. Try playing around with passing pointers to pointers and so on :p</p>\n"}], "owner": {"reputation": 11, "user_id": 4547184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f869fc3090c1a8fe6de24fca51b8bea5?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Adler", "link": "https://stackoverflow.com/users/4547184/colin-adler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 32872371, "answer_count": 1, "score": -3, "last_activity_date": 1443639822, "creation_date": 1443632131, "last_edit_date": 1443635416, "question_id": 32871719, "link": "https://stackoverflow.com/questions/32871719/inputting-variable-name-into-functions", "title": "Inputting variable name into functions", "body": "<p>I'm pretty new to Go, and I'd like to make this snippet into a function. </p>\n\n<p>Basically, I would like to know if there is a possible way to pass a variable name into a function call so if I called:  </p>\n\n<p><code>changeColor(varName)\n</code></p>\n\n<p>It would run, and then assign a new value to the original variable, which was inputted into the function call.  </p>\n\n<p>Hopefully this makes sense, and thanks in advance</p>\n\n<pre><code>if varName == yellow {\n    varName = black\n} else {\n    varName = yellow\n}\n</code></pre>\n"}, {"tags": ["linux", "ubuntu", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1443631891, "post_id": 32871590, "comment_id": 53575006, "body": "I recommend inspecting the permissions at that location with <code>ls -la</code>. Just a random guess, but I would say that <code>~&#47;gopath&#47;bin</code> is likely from the root and not your user account so, yes there is in fact no folder <code>gopath</code> under your user folder because the root user owns it."}, {"owner": {"reputation": 101, "user_id": 4883680, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/527f0508267c202ea51338752a27c908?s=128&d=identicon&r=PG&f=1", "display_name": "SPiCaRia", "link": "https://stackoverflow.com/users/4883680/spicaria"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1443632519, "post_id": 32871590, "comment_id": 53575324, "body": "@evanmcdonnal <code>drwxrwxr-x  4 myusrname myusrname  4096  Sep 25 12:29 gopath</code> gopath locates at <code>~&#47;gopath</code>, so i suppose that can&#39;t be the problem with permission"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1443632573, "post_id": 32871590, "comment_id": 53575351, "body": "Well so much for that theory."}, {"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 0, "creation_date": 1443675528, "post_id": 32871590, "comment_id": 53590125, "body": "I&#39;m curious what the results of <code>go env</code> are. That should print out the relevant environmental variables."}, {"owner": {"reputation": 101, "user_id": 4883680, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/527f0508267c202ea51338752a27c908?s=128&d=identicon&r=PG&f=1", "display_name": "SPiCaRia", "link": "https://stackoverflow.com/users/4883680/spicaria"}, "reply_to_user": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 0, "creation_date": 1443686951, "post_id": 32871590, "comment_id": 53595430, "body": "@AndrewN the go env prints <code>GOPATH=&quot;&#47;home&#47;myusrname&#47;gopath&quot;</code> <code>GOBIN=&quot;&quot;</code> It&#39;s weird that <code>$GOBIN</code> is empty"}, {"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 0, "creation_date": 1443688440, "post_id": 32871590, "comment_id": 53596185, "body": "<i>checks</i> My GOBIN isn&#39;t set, and from what I remember reading it isn&#39;t usually necessary to set it, since it should default to GOPATH/bin anyway. Of course, I don&#39;t suppose it would hurt to try setting it manually. I assume ~/gopath/bin does actually exist as a directory? That shouldn&#39;t matter either...  To <i>really</i> ensure that there&#39;s not permissions issue, why not try setting up a go environment for user root?"}, {"owner": {"reputation": 101, "user_id": 4883680, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/527f0508267c202ea51338752a27c908?s=128&d=identicon&r=PG&f=1", "display_name": "SPiCaRia", "link": "https://stackoverflow.com/users/4883680/spicaria"}, "reply_to_user": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "edited": false, "score": 0, "creation_date": 1443690341, "post_id": 32871590, "comment_id": 53597374, "body": "@AndrewN I&#39;m really sure there&#39;s no permission issue, I create the folder manually through GUI file manager with the normal user"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4883680, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/527f0508267c202ea51338752a27c908?s=128&d=identicon&r=PG&f=1", "display_name": "SPiCaRia", "link": "https://stackoverflow.com/users/4883680/spicaria"}, "edited": false, "score": 0, "creation_date": 1443687204, "post_id": 32874491, "comment_id": 53595556, "body": "however the problem is, my sublime plugins as well as vim plugins cannot detect my <code>$GOPATH</code> also, <code>go env</code> shows <code>GOPATH=&quot;&#47;home&#47;myusrname&#47;gopath&quot;</code> <code>GOBIN=&quot;&quot;</code>"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 101, "user_id": 4883680, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/527f0508267c202ea51338752a27c908?s=128&d=identicon&r=PG&f=1", "display_name": "SPiCaRia", "link": "https://stackoverflow.com/users/4883680/spicaria"}, "edited": false, "score": 0, "creation_date": 1443688386, "post_id": 32874491, "comment_id": 53596157, "body": "Have you restarted after editing your .bashrc? Also, In some distros that file seems to only get loaded in some cases. Maybe try /etc/environment."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1444332089, "post_id": 32874491, "comment_id": 53870914, "body": "While this is correct, it does not attempt to solve the OP&#39;s actual problem."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1443643181, "last_edit_date": 1443643181, "creation_date": 1443642764, "answer_id": 32874491, "question_id": 32871590, "link": "https://stackoverflow.com/questions/32871590/why-still-says-no-gopath-though-ive-set-it/32874491#32874491", "title": "Why still says no GOPATH though i&#39;ve set it?", "body": "<pre><code>~$ $PATH\n</code></pre>\n\n<p>is trying to execute your <code>$PATH</code> string, i.e. it's equivalent to writing the contents of the <code>$PATH</code> variable into the console and pressing enter. That results in the error you're seeing.</p>\n\n<p>What you want is</p>\n\n<pre><code>~$ echo $PATH\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 4883680, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/527f0508267c202ea51338752a27c908?s=128&d=identicon&r=PG&f=1", "display_name": "SPiCaRia", "link": "https://stackoverflow.com/users/4883680/spicaria"}, "is_accepted": false, "score": 0, "last_activity_date": 1444189390, "creation_date": 1444189390, "answer_id": 32983435, "question_id": 32871590, "link": "https://stackoverflow.com/questions/32871590/why-still-says-no-gopath-though-ive-set-it/32983435#32983435", "title": "Why still says no GOPATH though i&#39;ve set it?", "body": "<p>finally i got it: i have to open gvim through shell with $GOPATH set - -!</p>\n"}, {"tags": [], "owner": {"reputation": 1475, "user_id": 2707671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142f15811338c5c642a5c4c47fe7b393?s=128&d=identicon&r=PG&f=1", "display_name": "user2707671", "link": "https://stackoverflow.com/users/2707671/user2707671"}, "is_accepted": false, "score": 0, "last_activity_date": 1452179858, "creation_date": 1452179858, "answer_id": 34658747, "question_id": 32871590, "link": "https://stackoverflow.com/questions/32871590/why-still-says-no-gopath-though-ive-set-it/34658747#34658747", "title": "Why still says no GOPATH though i&#39;ve set it?", "body": "<p>You can try to start gvim with the command:\n<code>\nbash -lc gvim\n</code></p>\n\n<p>It then starts gvim with the settings in your .bashrc file.</p>\n\n<p>This is from <a href=\"https://github.com/fatih/vim-go/issues/468\" rel=\"nofollow\">https://github.com/fatih/vim-go/issues/468</a></p>\n"}, {"tags": [], "owner": {"reputation": 1950, "user_id": 1101112, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EqIkO.jpg?s=128&g=1", "display_name": "Supawat Pusavanno", "link": "https://stackoverflow.com/users/1101112/supawat-pusavanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1465131362, "creation_date": 1465131362, "answer_id": 37642163, "question_id": 32871590, "link": "https://stackoverflow.com/questions/32871590/why-still-says-no-gopath-though-ive-set-it/37642163#37642163", "title": "Why still says no GOPATH though i&#39;ve set it?", "body": "<p>In my case, I added GOPATH in my .profile</p>\n\n<pre><code>export GOPATH=$HOME/go\nexport PATH=$PATH:$GOPATH/bin\n</code></pre>\n\n<p>And restart my Unbuntu 16.04</p>\n\n<p>Then for my vim-go, I installed the vim-go by the following command in gvim</p>\n\n<pre><code>:GoInstallBinaries\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4883680, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/527f0508267c202ea51338752a27c908?s=128&d=identicon&r=PG&f=1", "display_name": "SPiCaRia", "link": "https://stackoverflow.com/users/4883680/spicaria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1465131362, "creation_date": 1443631682, "last_edit_date": 1443633397, "question_id": 32871590, "link": "https://stackoverflow.com/questions/32871590/why-still-says-no-gopath-though-ive-set-it", "title": "Why still says no GOPATH though i&#39;ve set it?", "body": "<p>Both <code>GoSublime</code> and <code>vim-go</code> tells me that <code>GOPATH</code> isn't set, however I've already done this.</p>\n\n<p>my <code>~/.bashrc</code>: </p>\n\n<pre><code>export GOPATH=$HOME/gopath\nexport PATH=\"$PATH:$GOPATH/bin\"\n</code></pre>\n\n<p>and I can use <code>go get</code> to install gocode to my <code>~/gopath/bin</code>\nbut it prints that: <code>...:/home/myusrname/gopath/bin: No such file or directory</code>\nfor\n<code>~$ $PATH</code></p>\n"}, {"tags": ["c", "utf-8", "go"], "comments": [{"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "edited": false, "score": 0, "creation_date": 1443629163, "post_id": 32870736, "comment_id": 53573314, "body": "Are you encountering a problem when reading the string?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443630587, "post_id": 32870736, "comment_id": 53574232, "body": "Strings are just a sequence of bytes, and Go doesn&#39;t care what&#39;s in there."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1443632006, "post_id": 32870736, "comment_id": 53575072, "body": "@udo: Depends entirely on what&#39;s in s2in. It could point to a PNG file. Or UTF-16 text, or some ISO encoded text. Each case is different."}], "answers": [{"tags": [], "owner": {"reputation": 3818, "user_id": 1247113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRMFj.png?s=128&g=1", "display_name": "rob74", "link": "https://stackoverflow.com/users/1247113/rob74"}, "is_accepted": true, "score": 5, "last_activity_date": 1443641826, "last_edit_date": 1443641826, "creation_date": 1443630072, "answer_id": 32871093, "question_id": 32870736, "link": "https://stackoverflow.com/questions/32870736/golang-how-to-correctly-parse-utf-8-string-from-c/32871093#32871093", "title": "Golang: How to correctly parse UTF-8 string from C", "body": "<p>You don't need to do anything special. UTF-8 is Go's \"native\" character encoding, so you can use the functions from the <code>utf8</code> package you mentioned, e.g. <code>utf8.RuneCountInString</code> to get the number of Unicode runes in a string. Keep in mind that <code>len(s)</code> will still return the number of bytes in the string.</p>\n\n<p>See <a href=\"https://blog.golang.org/strings\" rel=\"noreferrer\">this post in the official blog</a> or <a href=\"http://dominik.honnef.co/posts/2012/04/dealing_with_encodings_in_go/\" rel=\"noreferrer\">this article</a> for some details.</p>\n"}], "owner": {"reputation": 1259, "user_id": 526426, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/b1w0f.jpg?s=128&g=1", "display_name": "udo", "link": "https://stackoverflow.com/users/526426/udo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1267, "favorite_count": 0, "accepted_answer_id": 32871093, "answer_count": 1, "score": 1, "last_activity_date": 1443641826, "creation_date": 1443628932, "question_id": 32870736, "link": "https://stackoverflow.com/questions/32870736/golang-how-to-correctly-parse-utf-8-string-from-c", "title": "Golang: How to correctly parse UTF-8 string from C", "body": "<p>I'm a newbie to the go world, so maybe this is obvious.</p>\n\n<p>I have a Go function which I'm exposing to C with the <code>go build -buildmode=c-shared</code> and corresponding <code>//export funcName</code> comment.\n(You can see it here: <a href=\"https://github.com/udl/bmatch/blob/master/ext/levenshtein.go#L42\" rel=\"nofollow\">https://github.com/udl/bmatch/blob/master/ext/levenshtein.go#L42</a>)</p>\n\n<p>My conversion currently works like this:</p>\n\n<pre><code>func distance(s1in, s2in *C.char) int {\n    s1 := C.GoString(s1in)\n    s2 := C.GoString(s2in)\n</code></pre>\n\n<p>How would I handle UTF-8 input here?\nI've seen there is a UTF-8 package but I don't quite get how it works. <a href=\"https://golang.org/pkg/unicode/utf8/\" rel=\"nofollow\">https://golang.org/pkg/unicode/utf8/</a></p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go", "cassandra", "gocql"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 2800390, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7ebc5454c0b6f2a0a3d4fb854c68be85?s=128&d=identicon&r=PG&f=1", "display_name": "user2800390", "link": "https://stackoverflow.com/users/2800390/user2800390"}, "edited": false, "score": 0, "creation_date": 1444018386, "post_id": 32900980, "comment_id": 53707574, "body": "Well that is very disappointing news. Thank you though for that useful bit of information."}], "tags": [], "owner": {"reputation": 4113, "user_id": 4774369, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100458317764454/picture?type=large", "display_name": "Jeff Jirsa", "link": "https://stackoverflow.com/users/4774369/jeff-jirsa"}, "is_accepted": true, "score": 2, "last_activity_date": 1443763213, "creation_date": 1443763213, "answer_id": 32900980, "question_id": 32868977, "link": "https://stackoverflow.com/questions/32868977/how-do-you-execute-a-cql-file-using-gocql/32900980#32900980", "title": "How do you execute a cql file using gocql?", "body": "<p><code>SOURCE</code> is a shortcut in cqlsh, not valid CQL command in general.</p>\n\n<p>You'll need to read the file contents into strings and execute them. </p>\n"}], "owner": {"reputation": 83, "user_id": 2800390, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7ebc5454c0b6f2a0a3d4fb854c68be85?s=128&d=identicon&r=PG&f=1", "display_name": "user2800390", "link": "https://stackoverflow.com/users/2800390/user2800390"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 32900980, "answer_count": 1, "score": 0, "last_activity_date": 1443763213, "creation_date": 1443623953, "question_id": 32868977, "link": "https://stackoverflow.com/questions/32868977/how-do-you-execute-a-cql-file-using-gocql", "title": "How do you execute a cql file using gocql?", "body": "<p>If you were to interface directly with Cassandra using cqlsh you could do the following:</p>\n\n<pre><code>$ cqlsh\ncqlsh:test&gt; SOURCE '/home/me/reset_db.cql'\n</code></pre>\n\n<p>I've tried to do this using gocql several times but I always get an error. For example, running this:</p>\n\n<pre><code>filePath := \"/home/me/reset_db.cql\"\nSOURCE_FILE := \"SOURCE (?)\"\nresetErr := session.Query(SOURCE_FILE, filePath).Exec()\n</code></pre>\n\n<p>Produces the following error:</p>\n\n<pre><code>line 1:0 no viable alternative at input 'SOURCE' ([SOURCE]...)\n</code></pre>\n\n<p>So what am I doing wrong here?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1218, "user_id": 749836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HjVtW.jpg?s=128&g=1", "display_name": "coquin", "link": "https://stackoverflow.com/users/749836/coquin"}, "edited": false, "score": 0, "creation_date": 1443628808, "post_id": 32867892, "comment_id": 53573108, "body": "By the way, you can save some bytes using map of bools:  ```     f := make(map[string]bool, len(su))     // Later, inside loop:     f[u.UserName] = true ```"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 1218, "user_id": 749836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HjVtW.jpg?s=128&g=1", "display_name": "coquin", "link": "https://stackoverflow.com/users/749836/coquin"}, "edited": false, "score": 2, "creation_date": 1443628853, "post_id": 32867892, "comment_id": 53573132, "body": "@coquin <code>struct{}</code> uses 0 bytes, where bools uses at least 1."}, {"owner": {"reputation": 109, "user_id": 5223245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a83268575cb2f4afd42e5924a2dfc42?s=128&d=identicon&r=PG&f=1", "display_name": "pardonmemiss", "link": "https://stackoverflow.com/users/5223245/pardonmemiss"}, "edited": false, "score": 0, "creation_date": 1443959216, "post_id": 32867892, "comment_id": 53691701, "body": "Thanks! I could directly unmarshal into a <code>map[string]struct{}</code> because the &quot;filtering&quot; JSON&#39;s format is in my control.  I also needed to do the <i>reverse</i> of what you had written, so I just used <code>!ok</code> and it worked. Thanks again!"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 8, "last_activity_date": 1443621096, "creation_date": 1443621096, "answer_id": 32867892, "question_id": 32867780, "link": "https://stackoverflow.com/questions/32867780/filtering-a-slice-of-structs-based-on-a-different-slice-in-golang/32867892#32867892", "title": "Filtering a slice of structs based on a different slice in Golang", "body": "<p>Create a map then use it to filter.</p>\n\n<pre><code>func filterByUserName(fu []FullUser, su []SimpleUser) (out []FullUser) {\n    f := make(map[string]struct{}, len(su))\n    for _, u := range su {\n        f[u.UserName] = struct{}{}\n    }\n    for _, u := range fu {\n        if _, ok := f[u.UserName]; ok {\n            out = append(out, u)\n        }\n    }\n    return\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/zSXq91WzE6\" rel=\"noreferrer\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 109, "user_id": 5223245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a83268575cb2f4afd42e5924a2dfc42?s=128&d=identicon&r=PG&f=1", "display_name": "pardonmemiss", "link": "https://stackoverflow.com/users/5223245/pardonmemiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9026, "favorite_count": 0, "accepted_answer_id": 32867892, "answer_count": 1, "score": 4, "last_activity_date": 1443621096, "creation_date": 1443620804, "question_id": 32867780, "link": "https://stackoverflow.com/questions/32867780/filtering-a-slice-of-structs-based-on-a-different-slice-in-golang", "title": "Filtering a slice of structs based on a different slice in Golang", "body": "<p>In the example code below, I have a few users in <code>manySimpleUsers</code> that I would like to remove from <code>manyFullUsers</code> based on the Username.</p>\n\n<p>If I do it with a nested couple of <code>for... range</code> loops, there will be many cycles required to filter all of the elements, especially when there are large numbers of elements in both Slices.</p>\n\n<p>What is the best way to achieve this in Go? </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n\n    type FullUser struct {\n        UserName  string\n        UserEmail string\n    }\n\n    manyFullUsers := []FullUser{{\"foo\", \"foo@jawohl.com\"},\n        {\"bar\", \"bar@jawohl.com\"},\n        {\"baz\", \"baz@jawohl.com\"}}\n\n    type SimpleUser struct {\n        UserName string\n    }\n\n    manySimpleUsers := []SimpleUser{{\"foo\"}, {\"bar\"}}\n\n    fmt.Println(manyFullUsers)\n    fmt.Println(manySimpleUsers)\n}\n</code></pre>\n"}, {"tags": ["go", "int"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1443616274, "post_id": 32864071, "comment_id": 53564350, "body": "Go version 1.2.1 is an obsolete, unsupported version. The <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">current version</a> is Go 1.5.1."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1443622363, "post_id": 32864071, "comment_id": 53568654, "body": "@peterSO So is the behaviour different in Go 1.5?"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1443624595, "post_id": 32864071, "comment_id": 53570240, "body": "Whether it is different or not (it isn&#39;t) doesn&#39;t matter, and answers should target Go 1.2.1."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1443693215, "post_id": 32864071, "comment_id": 53599189, "body": "My point is: this is IMO a very valid question and it doesn not deservere 5 down votes."}], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": false, "score": 8, "last_activity_date": 1443609968, "creation_date": 1443609968, "answer_id": 32864124, "question_id": 32864071, "link": "https://stackoverflow.com/questions/32864071/cannot-assign-int-to-a-variable-in-go/32864124#32864124", "title": "Cannot assign int to a variable in Go", "body": "<p><code>type</code> creates a new type, so this will obviously fail. You have to explicitly convert the values from <code>int</code> to <code>INTEGER</code>:</p>\n\n<pre><code>aaInt, bbInt := F(100, 50)\naa, bb = INTEGER(aaInt), INTEGER(bbInt)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5392681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da6d685bf335aa7724f13cbca34fe045?s=128&d=identicon&r=PG&f=1", "display_name": "Michael G", "link": "https://stackoverflow.com/users/5392681/michael-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2219, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1443609968, "creation_date": 1443609794, "question_id": 32864071, "link": "https://stackoverflow.com/questions/32864071/cannot-assign-int-to-a-variable-in-go", "title": "Cannot assign int to a variable in Go", "body": "<p>Go version - 1.2.1</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\n    type INTEGER int\n    var aa INTEGER\n    var bb INTEGER\n    aa, bb = F(100,50)\n    fmt.Println(aa,bb)\n}\n\nfunc F(a int, b int) (sum int, difference int){\n    return a+b, a-b\n}\n</code></pre>\n\n<h2>Output:</h2>\n\n<p>/g.go:9: cannot assign int to aa (type INTEGER) in multiple assignment<br>\n./g.go:9: cannot assign int to bb (type INTEGER) in multiple assignment</p>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1443594360, "post_id": 32858611, "comment_id": 53551504, "body": "What does <code>value(map1)</code> mean?  <code>map1</code> has two different values, should <code>value(map1)</code> be 300 or 400?  Do you know how to access the value of a map for a given key?"}, {"owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1443595777, "post_id": 32858611, "comment_id": 53552101, "body": "Hi Amit,   i want to run a loop and compare the values associated amongst each keys.  So basically what I want to do is : 300/30;400/40 and so on... Hope you got my query.  Thanks :)"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1443595862, "post_id": 32858611, "comment_id": 53552143, "body": "Will you know for sure that the two maps have the same keys?  Could it be possible that <code>map1</code> has some key that <code>map2</code> does not have, or vice versa?"}, {"owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1443596020, "post_id": 32858611, "comment_id": 53552212, "body": "Nope, they both have same keys and both have exactly same datatype as I have shown.  Please go through my code as I have just edited in my question."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1443596553, "post_id": 32858611, "comment_id": 53552485, "body": "The question is still very unclear.  You say something like, &quot;if value(map1)/value(map2) &gt;= 1 ... then do something&quot; but in the code you showed, there is no <code>if</code>.  Do you want to &quot;do something&quot; <b>for each key</b> where the condition holds?  Or do you only want to &quot;do something&quot; once, if the condition holds <b>for all keys</b>?  Maybe you can provide a couple different examples of input, and what the expected output is.  In other words, be explicit about the desired behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1443616976, "post_id": 32866248, "comment_id": 53564851, "body": "You don&#39;t test for division by zero: <code>value1&#47;value2 &gt; 1</code>"}, {"owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1443617682, "post_id": 32866248, "comment_id": 53565310, "body": "True, easily fixed and done. Interesting that the above code wasn&#39;t panicing, but worse: <code>value1&#47;value2 &gt; 1</code> was resolving as true when value2 was zero."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1443619712, "post_id": 32866248, "comment_id": 53566749, "body": "Due to the peculiar behavior of IEEE 754: <code>zero := float64(0); fmt.Println(42.0 &#47; zero)</code> is <code>+Inf</code>."}], "tags": [], "owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "is_accepted": false, "score": 2, "last_activity_date": 1443617443, "last_edit_date": 1443617443, "creation_date": 1443616458, "answer_id": 32866248, "question_id": 32858611, "link": "https://stackoverflow.com/questions/32858611/comparing-the-values-of-maps-in-go/32866248#32866248", "title": "Comparing the values of maps in GO", "body": "<p><a href=\"http://play.golang.org/p/3IfXHig8EB\" rel=\"nofollow\">Playground working example</a></p>\n\n<p>Breaking down the main for loop:</p>\n\n<pre><code>for key, value1 := range m1 {\n    if value2, ok := m2[key]; ok {\n        fmt.Printf(\"%f / %f = %f\\n\", value1, value2, value1/value2)\n        if value2 != 0 &amp;&amp; value1/value2 &gt; 1 {\n            fmt.Println(\"Greater than 1!\")\n        } else {\n            fmt.Println(\"Not greater than 1!\")\n        }\n    }\n}\n</code></pre>\n\n<p>First I use <code>range</code> to pull out both a value and a key for every entry in m1, since we need both.</p>\n\n<p>Second, using the <strong>comma ok</strong> syntax of <code>value2, ok := m2[key]</code>, I'm both finding out what the associated value of the second map is for the given key, and also ensuring that that map entry exists when the surrounding <code>if ... ; ok</code>. From your description of the problem, it isn't necessary to check every element of the second map, only those that share keys with the first. It's important we make this check, since go doesn't throw errors when checking a map for a non-existent key, it just silently returns the zero-value of the variable--in this scenario that could mean dividing by zero later on.</p>\n\n<p>Third, well, just some formatted printlines to help see what's happening, the real juice is the very simple <code>if value1/value2 &gt; 1</code> statement. Note that I also added in my playground link some map entries that don't fulfill the requirement to help demonstrate that the behavior is correct.</p>\n\n<p>The \"go maps in action\" blog article linked in the other answer is indeed a great source for working with maps in go.</p>\n"}], "owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1443617443, "creation_date": 1443591794, "last_edit_date": 1443595859, "question_id": 32858611, "link": "https://stackoverflow.com/questions/32858611/comparing-the-values-of-maps-in-go", "title": "Comparing the values of maps in GO", "body": "<p>I have to compare the values (not keys) of two maps of type '<code>map[string]float64</code>'.</p>\n\n<p>The contents of the maps are : <code>map1[ABCD:300 PQRS:400]</code> and <code>map2[ABCD:30 PQRS:40]</code>\nNo I do a check like if value(map1)/value(map2) > = 1 (like 300/30=10>1), then do something. </p>\n\n<p>How can I achieve this in GO ?\nTIA.</p>\n\n<p>i tried something like this : </p>\n\n<pre><code>for key := range m2{\n            for k := range m1{\n                temp := m1[k] / m2[key]\n                fmt.Println(\"temp*******\", temp)\n            }\n        }\n</code></pre>\n"}, {"tags": ["dictionary", "go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1443608609, "last_edit_date": 1443608609, "creation_date": 1443575625, "answer_id": 32856223, "question_id": 32856154, "link": "https://stackoverflow.com/questions/32856154/convert-the-dataype-of-values-in-maps-go-language/32856223#32856223", "title": "Convert the dataype of VALUES in Maps Go language", "body": "<p>You cannot do this by simple typecasting; the two maps have different representations in memory.</p>\n\n<p>To solve this, you will have to iterate over every entry of the first map, convert the string representation of the float to a <code>float64</code>, then store the new value in the other map:</p>\n\n<pre><code>import \"strconv\"\n\nvar output = make(map[string]float64)\nfor key, value := range userinputmap {\n    if converted, err := strconv.ParseFloat(value, 64); err == nil {\n        output[key] = converted\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 32856223, "answer_count": 1, "score": -1, "last_activity_date": 1443608609, "creation_date": 1443575066, "question_id": 32856154, "link": "https://stackoverflow.com/questions/32856154/convert-the-dataype-of-values-in-maps-go-language", "title": "Convert the dataype of VALUES in Maps Go language", "body": "<p>I have a map in GO as : </p>\n\n<pre><code>var userinputmap = make(map[string]string)\n</code></pre>\n\n<p>and the values in it are of type :</p>\n\n<pre><code>[ABCD:30 EFGH:50 PORS:60]\n</code></pre>\n\n<p>Not that the 30,50,60 are strings over here. </p>\n\n<p>I wish to have a same map but the numeric values should have float64 type instead of string type. </p>\n\n<p>Desired output :</p>\n\n<pre><code>var output = make(map[string]float64)\n</code></pre>\n\n<p>I tried to do it but I get an error : <code>cannot use &lt;placeholder_name&gt; (type string) as type float64 in assignment</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "edited": false, "score": 3, "creation_date": 1443574687, "post_id": 32855960, "comment_id": 53545754, "body": "This is more of a generic problem than a go problem, it&#39;s a generic issue of maintaining order in a multithreaded app. Some of the queueing strategies discussed here should help: <a href=\"http://stackoverflow.com/questions/3227042/maintaining-order-in-a-multi-threaded-pipeline#answer-3228846\" title=\"maintaining order in a multi threaded pipeline%23answer 3228846\">stackoverflow.com/questions/3227042/&hellip;</a>"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 2, "creation_date": 1443579184, "post_id": 32855960, "comment_id": 53546902, "body": "The results you get are in exactly the same order they were calculated and sent to the channel. what is the actual problem you are trying to solve? Maybe the easiest solution would be to not use goroutines?"}], "answers": [{"tags": [], "owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "is_accepted": true, "score": 6, "last_activity_date": 1443581523, "last_edit_date": 1495535220, "creation_date": 1443581523, "answer_id": 32856955, "question_id": 32855960, "link": "https://stackoverflow.com/questions/32855960/how-to-run-multiple-goroutines-and-collect-results-in-the-same-order-it-runs/32856955#32856955", "title": "How to run multiple goroutines and collect results in the same order it runs", "body": "<p>To give you a better idea. The issue is that you're reading a single channel where the values that are pushed onto the channel are in an arbitrary order due to your <code>time.Sleep</code> calls. If you want to issue the <code>time.Sleep</code> calls concurrently to simulate concurrent long-running processes, what you'll want to do is make each goroutine write to a channel with the results.</p>\n\n<p>This way you can iterate across an in-order list of the results channels blocking until the next channel can be read from (the same idea as the output queue in this answer <a href=\"https://stackoverflow.com/questions/3227042/maintaining-order-in-a-multi-threaded-pipeline#answer-3228846\">Maintaining Order in a Multi-Threaded Pipeline</a>) Here's your reworked code with some name changes to make things easier to track:</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n    \"strconv\"\n)\n\nfunc main(){\n    var jobs []chan string\n    for i := 0; i&lt;10; i++{\n        job := make(chan string)\n        jobs = append(jobs, job)\n        go testfun(i, job)\n    }\n    for _, result := range jobs {\n      fmt.Println(&lt;-result)\n    }\n}\n\nfunc testfun(i int, job chan&lt;- string){\n    var innerJobs []chan int\n    time.Sleep(time.Millisecond*time.Duration(int64(rand.Intn(10))))\n    for j := 0; j&lt;10; j++ {\n        innerJob := make(chan int)\n        innerJobs = append(innerJobs, innerJob)\n        go testfun2(j, innerJob)\n    }\n    tempStr := strconv.FormatInt(int64(i),10)+\" - \"\n    for _, result := range innerJobs {\n      tempStr = tempStr + strconv.FormatInt(int64(&lt;-result),10)\n    }\n    job &lt;- tempStr\n}\n\nfunc testfun2(j int, innerJob chan&lt;- int){\n    time.Sleep(time.Millisecond*time.Duration(int64(rand.Intn(10))))\n    innerJob &lt;- j\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 3, "last_activity_date": 1443633476, "last_edit_date": 1443633476, "creation_date": 1443621638, "answer_id": 32868094, "question_id": 32855960, "link": "https://stackoverflow.com/questions/32855960/how-to-run-multiple-goroutines-and-collect-results-in-the-same-order-it-runs/32868094#32868094", "title": "How to run multiple goroutines and collect results in the same order it runs", "body": "<p>A different / more efficient approach is using a slice (or an array) and using a <code>sync.WaitGroup</code>:</p>\n\n<pre><code>func main() {\n    var wg sync.WaitGroup\n    out := make([]string, 10)\n    for i := 0; i &lt; len(out); i++ {\n        wg.Add(1)\n        go testfun(i, &amp;out[i], &amp;wg)\n    }\n    wg.Wait()\n    for i := 0; i &lt; len(out); i++ {\n        a := out[i]\n        fmt.Println(a)\n    }\n}\n\nfunc testfun(i int, outVal *string, wg *sync.WaitGroup) {\n    //........\n    *outVal = tempStr\n    wg.Done()\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/4C1hl64Xzw\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n\n<p><em>edit</em>: updated the example for testfun2 as well, forgot about that.</p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3037, "favorite_count": 1, "accepted_answer_id": 32856955, "answer_count": 2, "score": 4, "last_activity_date": 1618730011, "creation_date": 1443573617, "last_edit_date": 1443575686, "question_id": 32855960, "link": "https://stackoverflow.com/questions/32855960/how-to-run-multiple-goroutines-and-collect-results-in-the-same-order-it-runs", "title": "How to run multiple goroutines and collect results in the same order it runs", "body": "<p>I have the following code which has a double-go routine structure:</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n    \"strconv\"\n)\n\nfunc main(){\n    outchan := make(chan string)\n    for i:=0;i&lt;10;i++{\n        go testfun(i, outchan)\n    }\n    for i:=0;i&lt;10;i++{\n        a := &lt;-outchan\n        fmt.Println(a)\n    }\n}\n\nfunc testfun(i int, outchan chan&lt;- string){\n    outchan2 := make(chan int)\n    time.Sleep(time.Millisecond*time.Duration(int64(rand.Intn(10))))\n    for j:=0;j&lt;10;j++ {\n        go testfun2(j, outchan2)\n    }\n    tempStr := strconv.FormatInt(int64(i),10)+\" - \"\n    for j:=0;j&lt;10;j++ {\n        tempStr = tempStr + strconv.FormatInt(int64(&lt;-outchan2),10)\n    }\n    outchan &lt;- tempStr\n}\n\nfunc testfun2(j int, outchan2 chan&lt;- int){\n    time.Sleep(time.Millisecond*time.Duration(int64(rand.Intn(10))))\n    outchan2 &lt;- j\n}\n</code></pre>\n\n<p>The output I was expecting is </p>\n\n<pre><code>0 - 0123456789\n1 - 0123456789\n2 - 0123456789\n3 - 0123456789\n4 - 0123456789\n5 - 0123456789\n6 - 0123456789\n7 - 0123456789\n8 - 0123456789\n9 - 0123456789\n</code></pre>\n\n<p>But instead I got this:</p>\n\n<pre><code>7 - 7980345261\n6 - 4035897621\n3 - 9047526831\n9 - 4032861975\n8 - 9570831624\n5 - 3798021546\n1 - 0985362471\n0 - 1849276035\n2 - 9572806143\n4 - 5768032419\n</code></pre>\n\n<p>Could anyone show me how to achieve the output I was expecting? I'm a newbie and please forgive me if the solution is obvious. I've been looking for it for days.</p>\n"}, {"tags": ["string", "dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "edited": false, "score": 0, "creation_date": 1443571687, "post_id": 32855481, "comment_id": 53545012, "body": "Thanks :)  That works.  By the way, what is the significance of :  output = output[:len(output)-1] ?"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "edited": false, "score": 0, "creation_date": 1443582923, "post_id": 32855481, "comment_id": 53547792, "body": "@pronessssssssssss, it gets rid of the trailing comma, without it, the output would&#39;ve been: <code>key2,key3,key1,</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "is_accepted": true, "score": 5, "last_activity_date": 1443570223, "creation_date": 1443570223, "answer_id": 32855481, "question_id": 32855393, "link": "https://stackoverflow.com/questions/32855393/append-key-data-from-the-go-map/32855481#32855481", "title": "Append key data from the GO MAP", "body": "<p>iterate in a loop and append key to string:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var userinputmap = make(map[string]string)\n\n    userinputmap[\"key1\"] = \"value1\"\n    userinputmap[\"key2\"] = \"value2\"\n    userinputmap[\"key3\"] = \"value3\"\n    output :=\"\"\n    for key,_ := range userinputmap {\n    output +=(key+\",\")\n    }\n    output = output[:len(output)-1]\n    fmt.Println(output)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "edited": false, "score": 0, "creation_date": 1444697141, "post_id": 32857136, "comment_id": 54000727, "body": "Instead of appending keys, one simple optimization is <code>keys := make([]string, len(userinputmap))</code> and just iterate over it with an index and assigning values to a position. This avoids having to reallocate new memory spaces with a dynamically growing slice each time."}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "edited": false, "score": 0, "creation_date": 1444700599, "post_id": 32857136, "comment_id": 54001547, "body": "@WillC, yes, pre-allocating memory, is a little bit faster, but I don&#39;t think there is a big difference. Amortized time for both approaches is still <code>O(n)</code>. Also, note that the accepted answer is making a copy a string each time it adds a new element, thus leading to <code>O(n*n)</code> time complexity. I don&#39;t think OP is concerned with performance."}], "tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 1, "last_activity_date": 1443583146, "last_edit_date": 1443583146, "creation_date": 1443582747, "answer_id": 32857136, "question_id": 32855393, "link": "https://stackoverflow.com/questions/32855393/append-key-data-from-the-go-map/32857136#32857136", "title": "Append key data from the GO MAP", "body": "<p>Another option is to collect all your keys into a slice and then use <code>strings.Join</code> method to join them. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    var userinputmap = make(map[string]string)\n\n    userinputmap[\"key1\"] = \"value1\"\n    userinputmap[\"key2\"] = \"value2\"\n    userinputmap[\"key3\"] = \"value3\"\n\n    keys := []string {}\n\n    for k, _ := range userinputmap {\n        keys = append(keys, k)\n    }\n\n    keys_string := strings.Join(keys, \",\")\n\n    fmt.Println(keys_string)\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2750176, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9c1d01bdd9953ba7d28d344a040c5db?s=128&d=identicon&r=PG&f=1", "display_name": "pronessssssssssss", "link": "https://stackoverflow.com/users/2750176/pronessssssssssss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2972, "favorite_count": 0, "accepted_answer_id": 32855481, "answer_count": 2, "score": 0, "last_activity_date": 1443583146, "creation_date": 1443569606, "last_edit_date": 1443570095, "question_id": 32855393, "link": "https://stackoverflow.com/questions/32855393/append-key-data-from-the-go-map", "title": "Append key data from the GO MAP", "body": "<p>I have a map in GO of the type : </p>\n\n<pre><code>var userinputmap = make(map[string]string)\n</code></pre>\n\n<p>The values in it are like : </p>\n\n<pre><code>userinputmap[\"key1\"] = value1\nuserinputmap[\"key2\"] = value2\nuserinputmap[\"key3\"] = value3\n</code></pre>\n\n<p>Now, How can I generate a string that contains al the above keys in comma seprated format?</p>\n\n<pre><code>output:= \"key1,key2,key3\"\n</code></pre>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 4, "creation_date": 1443566679, "post_id": 32854050, "comment_id": 53543596, "body": "Also dupes: <a href=\"http://stackoverflow.com/questions/8046725/get-mac-address-of-remote-pc\" title=\"get mac address of remote pc\">stackoverflow.com/questions/8046725/&hellip;</a>, <a href=\"http://stackoverflow.com/questions/3385/mac-addresses-in-javascript\" title=\"mac addresses in javascript\">stackoverflow.com/questions/3385/mac-addresses-in-javascript</a>&zwnj;&#8203;, and I&#39;m sure several other versions in lots of languages. The answer is no (it doesn&#39;t matter the language)."}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1443594837, "post_id": 32854050, "comment_id": 53551689, "body": "@RobNapier you should maybe first clarify why he needs the MAC before closing it blindly from dupes of other languages."}, {"owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "edited": false, "score": 0, "creation_date": 1443595787, "post_id": 32854050, "comment_id": 53552108, "body": "Easy. Probalby this is will not happend, because as I suspected socket <code>TCP is in diffrent layer network</code>. He have information about: port, IP source, IP destynation, Flags and etc, but doesn&#39;t have information about MAC. <a href=\"https://en.wikipedia.org/wiki/Transmission_Control_Protocol\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Transmission_Control_Protocol</a>  MAC is in Data Link Layer , But I not be sured to end it is possible in golang... BTW thank You for answer"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 2, "creation_date": 1443618551, "post_id": 32854050, "comment_id": 53565931, "body": "Just to make it clear for later readers, this answer has nothing to do with Go. There is no language, OS, or hardware combination that can solve this on a routed IP network (and not even on some &quot;switched&quot; networks). The originating MAC is not in the packet. It&#39;s not part of the protocol. That&#39;s why it&#39;s best to dupe these questions (2nd time this week I&#39;ve seen it) and point to the established answers, even if they were originally framed in some other language. Hopefully that will help future questioners find their answer quickly."}, {"owner": {"reputation": 387, "user_id": 3189203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce0c575af9cc91c1cbd528ca3bd72ec8?s=128&d=identicon&r=PG", "display_name": "rohitpaulk", "link": "https://stackoverflow.com/users/3189203/rohitpaulk"}, "edited": false, "score": 0, "creation_date": 1443706583, "post_id": 32854050, "comment_id": 53607700, "body": "MAC addresses aren&#39;t included in the TCP/IP headers, so there&#39;s no way to know the MAC address (You <i>could</i> if you were on the same subnet, but doesn&#39;t look like that&#39;s what you&#39;re asking for)."}], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1527, "favorite_count": 0, "closed_date": 1443568517, "answer_count": 0, "score": 0, "last_activity_date": 1443564393, "creation_date": 1443562074, "last_edit_date": 1443564393, "question_id": 32854050, "link": "https://stackoverflow.com/questions/32854050/golang-how-to-get-mac-address-from-tcp-connection", "closed_reason": "Duplicate", "title": "Golang. How to get MAC address from TCP connection", "body": "<p>I wrote a simple <strong>tcp server</strong> in <strong>go</strong>. I'm wondering if it is possible to get the <strong>MAC (Hardware address)</strong> from particular client ?</p>\n\n<p>Example to better understanding me, can be below piece of code:</p>\n\n<pre><code>func main() {\n\n    l, err := net.Listen(\"tcp4\", \"0.0.0.0:1234\")\n    if err != nil {\n        fmt.Println(\"Error listening:\", err.Error())\n        os.Exit(1)\n    }\n    defer l.Close()\n    fmt.Println(\"Listening....\")\n    for {\n        conn, err := l.Accept()\n        if err != nil {\n            fmt.Println(\"Error accepting: \", err.Error())\n            os.Exit(1)\n        }\n\n       // How do I get the Hardware Adres (MAC) from particular client from here?\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "dns", "nameservers", "authority"], "comments": [{"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1443552730, "post_id": 32849344, "comment_id": 53536917, "body": "Are you wanting to store the data in a human readable/editable file or are you okay just serializing them however is convenient? If the latter is true, this answer may be a step in the right direction <a href=\"http://stackoverflow.com/a/19763256/3570747\">stackoverflow.com/a/19763256/3570747</a> (I know it doesn&#39;t completely answer your question). I&#39;m assuming you also want to know how to trigger file writes when a resource record is updated?"}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "reply_to_user": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1443554372, "post_id": 32849344, "comment_id": 53537682, "body": "@vastlysuperiorman the question is more about how miekg/dns package works(i.e how am I supposed to hook a database and keep it in sync with the server) rather than how to serialize data in go."}], "answers": [{"tags": [], "owner": {"reputation": 1076, "user_id": 891354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b18738b8aecafab41c96b1f5d0bfee?s=128&d=identicon&r=PG", "display_name": "icuken", "link": "https://stackoverflow.com/users/891354/icuken"}, "is_accepted": false, "score": 2, "last_activity_date": 1443561948, "creation_date": 1443561948, "answer_id": 32854027, "question_id": 32849344, "link": "https://stackoverflow.com/questions/32849344/how-to-store-dns-records-go-authoritative-name-server/32854027#32854027", "title": "How to store DNS records (Go authoritative name server)", "body": "<p>miekg/dns is a library, not a fully functional DNS-server. It has built in support of RFC 1035 zone files (originally used by bind): zscan.go to parse zone file and zgenerate.go to generate zone string.</p>\n\n<p>If you're looking for a complete DNS-server based on this library check <a href=\"https://github.com/miekg/dns#Users\" rel=\"nofollow\">Users</a> section in README or take a look to <a href=\"https://github.com/duedil-ltd/discodns\" rel=\"nofollow\">discodns</a> server based on the library that reads zones from etcd.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 1422516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7c8e3c49354dfde5b740d97c893ed5?s=128&d=identicon&r=PG", "display_name": "Chris Jacobs", "link": "https://stackoverflow.com/users/1422516/chris-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1443769130, "creation_date": 1443769130, "answer_id": 32902006, "question_id": 32849344, "link": "https://stackoverflow.com/questions/32849344/how-to-store-dns-records-go-authoritative-name-server/32902006#32902006", "title": "How to store DNS records (Go authoritative name server)", "body": "<p>Easiest solution, IMO, is <a href=\"http://redis.io/clients#go\" rel=\"nofollow\">Redis</a>, which has a few libs available.  Even if this isn't your long term solution, it works well for prototyping.  From there you just need to serialize/deserialize your data into/from a <code>string</code>/<code>[]byte</code> and write a simple caching layer that loads a saved state and pushes changes when they happen.</p>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1443769130, "creation_date": 1443544585, "last_edit_date": 1443549160, "question_id": 32849344, "link": "https://stackoverflow.com/questions/32849344/how-to-store-dns-records-go-authoritative-name-server", "title": "How to store DNS records (Go authoritative name server)", "body": "<p>I'm need to deploy an authoritative name server using and I've found <a href=\"https://github.com/miekg/dns\" rel=\"nofollow\"><code>miekg/dns</code></a> package to almost fit the bill  but I can't find how to store/persist records (i.e. on disk ). Currently it seems to store everything in a map but I guess it's all gone when the server is shut down. Is there anything I'm missing or an easy way to plugin a persistent storage engine ?</p>\n"}, {"tags": ["curl", "go", "rpc"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443540899, "post_id": 32847561, "comment_id": 53530078, "body": "The default path is <code>&#47;_goRPC_</code>."}, {"owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443541181, "post_id": 32847561, "comment_id": 53530250, "body": "@jimB yeah I was trying to connect using the _goRPC path. Not sure if my curl request is malformed or not however. Thanks!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1443541641, "post_id": 32847561, "comment_id": 53530559, "body": "your curl request <i>is</i> malformed; you&#39;re missing the trailing underscore. The go client request looks like: <code>CONNECT &#47;_goRPC_ HTTP&#47;1.0</code>"}, {"owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443541825, "post_id": 32847561, "comment_id": 53530686, "body": "@JimB Thank you! can&#39;t believe that&#39;s what I missed. As part of this, is there any resources on how to pass the full RPC request in the body? the method and args etc ..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443543572, "post_id": 32847561, "comment_id": 53531768, "body": "The request uses CONNECT, so there is no body or arguments. The best resource is to read the rpc package source. The format is defined by the implementation of rpc.ServerCodec, which takes rpc.Requests and an optional body, and returns rpc.Responses."}, {"owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443545524, "post_id": 32847561, "comment_id": 53532944, "body": "@JimB Sorry I think I didn&#39;t pose my question properly. I am looking to essentially create the dialHTTP that a client generally creates as a curl request. Which boils down to how the method and arguments to the method for the RPC call get serialized by the gobEncoder and how that can be represented as a curl request"}, {"owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443546864, "post_id": 32847561, "comment_id": 53533724, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/90919/discussion-between-jamil-seaidoun-and-jimb\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "is_accepted": true, "score": 0, "last_activity_date": 1443741363, "creation_date": 1443741363, "answer_id": 32898233, "question_id": 32847561, "link": "https://stackoverflow.com/questions/32847561/connecting-to-go-rpc-using-curl/32898233#32898233", "title": "Connecting to Go RPC using curl", "body": "<p>For anyone wondering, it is easier to use JSONRPC from the rpc/jsonrpc library and the curl request looks like: </p>\n\n<pre><code>curl -X CONNECT --url &lt;url&gt;/_goRPC_ -d '{\"method\":\"your rpc method\",\"params\":[\"args\"],\"id\":&lt;some number to represent your request&gt;}'\n</code></pre>\n"}], "owner": {"reputation": 879, "user_id": 2260362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5152ad032e9e8b4f461aca8516954ff2?s=128&d=identicon&r=PG", "display_name": "Jamil Seaidoun", "link": "https://stackoverflow.com/users/2260362/jamil-seaidoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 32898233, "answer_count": 1, "score": 3, "last_activity_date": 1443741363, "creation_date": 1443539252, "last_edit_date": 1443545632, "question_id": 32847561, "link": "https://stackoverflow.com/questions/32847561/connecting-to-go-rpc-using-curl", "title": "Connecting to Go RPC using curl", "body": "<p>I created a RPC server using the basic instructions listed here: <a href=\"https://golang.org/pkg/net/rpc/\" rel=\"nofollow\">https://golang.org/pkg/net/rpc/</a>.  I am building a application that might not be in Go to communicate with a RPC server and was curious how to manually connect to the server using curl or anything else. </p>\n\n<p>I have tried:</p>\n\n<pre><code>curl -v -X CONNECT --url localhost:1234/_goRPC\n</code></pre>\n\n<p>but the output I get is: </p>\n\n<pre><code>* Hostname was NOT found in DNS cache\n*   Trying ::1...\n* Connected to localhost (::1) port 1234 (#0)\n&gt; CONNECT /_goRPC HTTP/1.1\n&gt; User-Agent: curl/7.37.1\n&gt; Host: localhost:1234\n&gt; Accept: */*\n&gt;\n&lt; HTTP/1.1 404 Not Found\n&lt; Content-Type: text/plain; charset=utf-8\n&lt; Date: Tue, 29 Sep 2015 15:04:29 GMT\n&lt; Content-Length: 19\n&lt;\n404 page not found\n* Connection #0 to host localhost left intact\n</code></pre>\n\n<p>This is mainly more to understand how to connect to it language agnostically, in the future I will most likely be using libraries from whatever language to communicate to the server. </p>\n\n<p>Edit: for the above error, the url is actually localhost:1234/<em>goRPC</em></p>\n\n<p>But the question still remains to how to create a curl request that performs the same functionality as in the link <a href=\"https://golang.org/pkg/net/rpc/\" rel=\"nofollow\">https://golang.org/pkg/net/rpc/</a> that the client performs. How does the method call and arguments get serialized and placed in the CONNECT request</p>\n"}, {"tags": ["go", "client", "server-sent-events"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443533449, "post_id": 32844142, "comment_id": 53524621, "body": "There shouldn&#39;t be a delay because of the client&#39;s transport. Have you verified the timing by watching the data on the wire? (also, if you have newline delimited json, you can use <code>json.Decoder</code> directly)"}, {"owner": {"reputation": 190, "user_id": 2868357, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/uHw0F.png?s=128&g=1", "display_name": "hjortron", "link": "https://stackoverflow.com/users/2868357/hjortron"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443534416, "post_id": 32844142, "comment_id": 53525299, "body": "Thx, @JimB. Yes, I verified that data is sent real time with curl."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443535810, "post_id": 32844142, "comment_id": 53526363, "body": "This method works correctly, provided the server flushed a complete json object <i>and</i> newline. (I&#39;m seeing less then 1&#181;s delay). You do need to fix problems like sending on a closed channel, and Println where you wanted Fprintf, but that shouldn&#39;t add any delay. Make sure the server is sending <i>exactly</i> the data you expect, when you expect it to."}], "answers": [{"tags": [], "owner": {"reputation": 190, "user_id": 2868357, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/uHw0F.png?s=128&g=1", "display_name": "hjortron", "link": "https://stackoverflow.com/users/2868357/hjortron"}, "is_accepted": true, "score": 1, "last_activity_date": 1443610993, "creation_date": 1443610993, "answer_id": 32864469, "question_id": 32844142, "link": "https://stackoverflow.com/questions/32844142/read-not-buffered-server-sent-event-on-client/32864469#32864469", "title": "Read not buffered Server-Sent Event on client", "body": "<p>I figured out, data was buffered by nginx, because of transparent compression. So, to get data without delay we must disable compression like this:</p>\n\n<pre><code>client := &amp;http.Client{}\ntransport := &amp;http.Transport{}\ntransport.DisableCompression = true\nclient.Transport = transport\nreq, err := http.NewRequest(\"GET\", essURL, nil)\nif err != nil {\n    log.Fatal(err);\n}\nresp, _ := client.Do(req)\n\nreader := bufio.NewReader(resp.Body)\nfor {\n    line,_:=reader.ReadSlice('\\n')\n    log.Println(string(line))       \n}\n</code></pre>\n"}], "owner": {"reputation": 190, "user_id": 2868357, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/uHw0F.png?s=128&g=1", "display_name": "hjortron", "link": "https://stackoverflow.com/users/2868357/hjortron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 32864469, "answer_count": 1, "score": 2, "last_activity_date": 1443610993, "creation_date": 1443529986, "last_edit_date": 1443534768, "question_id": 32844142, "link": "https://stackoverflow.com/questions/32844142/read-not-buffered-server-sent-event-on-client", "title": "Read not buffered Server-Sent Event on client", "body": "<p>I need to read sse in my golang app, but instead of real-time, events return buffered. As I can see, this is because of standard golang transport. How can I fix this, without implementing my own transport?\nThis code is inspired by <a href=\"https://github.com/cryptix/goSSEClient/blob/master/sse.go\" rel=\"nofollow\">cryptix</a> solution:</p>\n\n<pre><code>resp, _ := http.Get(sseURL)\nevents := make(chan Event)\nwg:= sync.WaitGroup{}\nwg.Add(1)\ngo func() {\n    event:= Event{}\n    reader := bufio.NewReader(resp.Body)\n\n    for {\n        line, err := reader.ReadBytes('\\n')\n\n        if err != nil {\n            log.Println(os.Stderr, \"error during resp.Body read:%s\\n\", err)\n            close(events)\n        }\n\n        json.Unmarshal(line,&amp;event)\n\n        events&lt;-event\n    }\n    wg.Done()\n}()\n\ngo func(){\n    for ev:= range events {\n        log.Println(ev)\n    }\n}()\nwg.Wait()\n</code></pre>\n"}, {"tags": ["go", "orm", "beego"], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 4074586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b8eaeb188788da55f046402d6e9277?s=128&d=identicon&r=PG&f=1", "display_name": "Diablojoe", "link": "https://stackoverflow.com/users/4074586/diablojoe"}, "is_accepted": true, "score": 3, "last_activity_date": 1444732545, "creation_date": 1444732545, "answer_id": 33100464, "question_id": 32843160, "link": "https://stackoverflow.com/questions/32843160/beego-creating-a-new-orm-before-every-request/33100464#33100464", "title": "Beego: Creating a new orm before every request?", "body": "<p>You are doing it correctly already. If you are using the default named database you can even omit the second statement. orm.NewOrm sets up a new relationship, not necessarily a new database connection. This relationship is necessary in the controller so that your data can be mapped to the correct database calls eventually when another command is issued. As far as I have seen this does not pose any security issues. </p>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 33100464, "answer_count": 1, "score": 6, "last_activity_date": 1444732545, "creation_date": 1443527243, "question_id": 32843160, "link": "https://stackoverflow.com/questions/32843160/beego-creating-a-new-orm-before-every-request", "title": "Beego: Creating a new orm before every request?", "body": "<p>Currently I'm using following commands at the beginning of each function that accesses the database. </p>\n\n<pre><code>o := orm.NewOrm()\no.Using(\"default\") // Using default, you can use other database\n</code></pre>\n\n<p>It feels like I should do that only once at router initialization. Can that be a security issue?</p>\n"}, {"tags": ["go", "concurrency", "timeout"], "answers": [{"tags": [], "owner": {"reputation": 8064, "user_id": 303698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b80995efd7fa90c4899cfcb401ab7534?s=128&d=identicon&r=PG", "display_name": "laher", "link": "https://stackoverflow.com/users/303698/laher"}, "is_accepted": false, "score": 6, "last_activity_date": 1443519585, "creation_date": 1443519585, "answer_id": 32840688, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait/32840688#32840688", "title": "Timeout for WaitGroup.Wait()", "body": "<p>I did it like this: <a href=\"http://play.golang.org/p/eWv0fRlLEC\" rel=\"noreferrer\">http://play.golang.org/p/eWv0fRlLEC</a></p>\n\n<pre><code>go func() {\n    wg.Wait()\n    c &lt;- struct{}{}\n}()\ntimeout := time.Duration(1) * time.Second\nfmt.Printf(\"Wait for waitgroup (up to %s)\\n\", timeout)\nselect {\ncase &lt;-c:\n    fmt.Printf(\"Wait group finished\\n\")\ncase &lt;-time.After(timeout):\n    fmt.Printf(\"Timed out waiting for wait group\\n\")\n}\nfmt.Printf(\"Free at last\\n\")\n</code></pre>\n\n<p>It works fine, but is it <em>the best way to do it</em>?</p>\n"}, {"comments": [{"owner": {"reputation": 8064, "user_id": 303698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b80995efd7fa90c4899cfcb401ab7534?s=128&d=identicon&r=PG", "display_name": "laher", "link": "https://stackoverflow.com/users/303698/laher"}, "edited": false, "score": 0, "creation_date": 1444703690, "post_id": 32843750, "comment_id": 54002285, "body": "thanks, very thorough answer. I eventually stopped using a WaitGroup altogether, and used a single channel instead. My code ended up simpler, clearer and &#39;less problematic&#39;. My code could count the number of iterations, so I could use the select statement a fixed number of times, then use a single NewTimer for the timeout. For completeness I&#39;ll add another answer in due course."}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "edited": false, "score": 1, "creation_date": 1457922096, "post_id": 32843750, "comment_id": 59611188, "body": "So, a little FYI since this just popped up in #go-nuts: This will <i>not</i> work if the <code>wg.Add</code> calls are <i>inside a goroutine</i>. Just commenting in case somebody uses this code in a similar fashion to the issue #go-nuts just resolved!"}, {"owner": {"reputation": 3232, "user_id": 342348, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d087287d971a900fb9772b65d6d93e2e?s=128&d=identicon&r=PG", "display_name": "coanor", "link": "https://stackoverflow.com/users/342348/coanor"}, "edited": false, "score": 6, "creation_date": 1512005964, "post_id": 32843750, "comment_id": 82087208, "body": "if <code>wg.Wait()</code> never return, does it leaked a goroutine?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3232, "user_id": 342348, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d087287d971a900fb9772b65d6d93e2e?s=128&d=identicon&r=PG", "display_name": "coanor", "link": "https://stackoverflow.com/users/342348/coanor"}, "edited": false, "score": 1, "creation_date": 1512046485, "post_id": 32843750, "comment_id": 82104694, "body": "@coanor If <code>wg.Wait()</code> never returns, then obviously the goroutine calling it is blocked forever. Whether it&#39;s a leak depends on the context. E.g. <code>http.ListenAndServe()</code> also never returns if there is no error, you still don&#39;t consider it as a goroutine leak."}, {"owner": {"reputation": 1162, "user_id": 1586797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e19c16130bbfb34d0f8cdb414780e50?s=128&d=identicon&r=PG", "display_name": "bronze man", "link": "https://stackoverflow.com/users/1586797/bronze-man"}, "edited": false, "score": 1, "creation_date": 1555298255, "post_id": 32843750, "comment_id": 98048430, "body": "If the Wait() blocked forever, It will leak a goroutine when waitTimeout has been called. But no other better solution has been find."}, {"owner": {"reputation": 179, "user_id": 4818860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20373e0b1118eb0f251857f2b6bf2f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/4818860/sergey"}, "reply_to_user": {"reputation": 3232, "user_id": 342348, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d087287d971a900fb9772b65d6d93e2e?s=128&d=identicon&r=PG", "display_name": "coanor", "link": "https://stackoverflow.com/users/342348/coanor"}, "edited": false, "score": 0, "creation_date": 1573043646, "post_id": 32843750, "comment_id": 103751109, "body": "@coanor At least you could <code>panic</code> your <code>main</code> and/or notify user/system, instead of waiting indefinately."}, {"owner": {"reputation": 2531, "user_id": 721616, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/5990dc71908d05dc416b75d9fac6bb6a?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/721616/david"}, "edited": false, "score": 3, "creation_date": 1573207224, "post_id": 32843750, "comment_id": 103814647, "body": "Why is this accepted as an answer as there is a potential goroutine leak if  wg.Wait() could never return."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 50, "last_activity_date": 1479440306, "last_edit_date": 1495541900, "creation_date": 1443528773, "answer_id": 32843750, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait/32843750#32843750", "title": "Timeout for WaitGroup.Wait()", "body": "<p>Mostly your solution you posted <a href=\"https://stackoverflow.com/a/32840688/1705598\">below</a> is as good as it can get. Couple of tips to improve it:</p>\n\n<ul>\n<li>Alternatively you may close the channel to signal completion instead of sending a value on it, a receive operation on a closed channel <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"noreferrer\">can always proceed immediately</a>.</li>\n<li>And it's better to use <code>defer</code> statement to signal completion, it is executed even if a function terminates abruptly.</li>\n<li>Also if there is only one \"job\" to wait for, you can completely omit the <code>WaitGroup</code> and just send a value or close the channel when job is complete (the same channel you use in your <code>select</code> statement).</li>\n<li>Specifying 1 second duration is as simple as: <code>timeout := time.Second</code>. Specifying 2 seconds for example is: <code>timeout := 2 * time.Second</code>. You don't need the conversion, <code>time.Second</code> is already of type <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"noreferrer\"><code>time.Duration</code></a>, multiplying it with an untyped constant like <code>2</code> will also yield a value of type <code>time.Duration</code>.</li>\n</ul>\n\n<p>I would also create a helper / utility function wrapping this functionality. Note that <code>WaitGroup</code> must be passed as a pointer else the copy will not get \"notified\" of the <code>WaitGroup.Done()</code> calls. Something like:</p>\n\n<pre><code>// waitTimeout waits for the waitgroup for the specified max timeout.\n// Returns true if waiting timed out.\nfunc waitTimeout(wg *sync.WaitGroup, timeout time.Duration) bool {\n    c := make(chan struct{})\n    go func() {\n        defer close(c)\n        wg.Wait()\n    }()\n    select {\n    case &lt;-c:\n        return false // completed normally\n    case &lt;-time.After(timeout):\n        return true // timed out\n    }\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>if waitTimeout(&amp;wg, time.Second) {\n    fmt.Println(\"Timed out waiting for wait group\")\n} else {\n    fmt.Println(\"Wait group finished\")\n}\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/1TdOU_PquM\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 8109026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jomoj.jpg?s=128&g=1", "display_name": "Raed Shomali", "link": "https://stackoverflow.com/users/8109026/raed-shomali"}, "is_accepted": false, "score": 0, "last_activity_date": 1498538989, "last_edit_date": 1498538989, "creation_date": 1498405212, "answer_id": 44747918, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait/44747918#44747918", "title": "Timeout for WaitGroup.Wait()", "body": "<p>I wrote a library that encapsulates the concurrency logic <a href=\"https://github.com/shomali11/parallelizer\" rel=\"nofollow noreferrer\">https://github.com/shomali11/parallelizer</a> which you can also pass a timeout.</p>\n\n<p>Here is an example without a timeout:</p>\n\n<pre><code>func main() {\n    group := parallelizer.DefaultGroup()\n\n    group.Add(func() {\n        for char := 'a'; char &lt; 'a'+3; char++ {\n            fmt.Printf(\"%c \", char)\n        }\n    })\n\n    group.Add(func() {\n        for number := 1; number &lt; 4; number++ {\n            fmt.Printf(\"%d \", number)\n        }\n    })\n\n    err := group.Run()\n\n    fmt.Println()\n    fmt.Println(\"Done\")\n    fmt.Printf(\"Error: %v\", err)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>a 1 b 2 c 3 \nDone\nError: &lt;nil&gt;\n</code></pre>\n\n<p>Here is an example with a timeout:</p>\n\n<pre><code>func main() {\n    options := &amp;parallelizer.Options{Timeout: time.Second}\n    group := parallelizer.NewGroup(options)\n\n    group.Add(func() {\n        time.Sleep(time.Minute)\n\n        for char := 'a'; char &lt; 'a'+3; char++ {\n            fmt.Printf(\"%c \", char)\n        }\n    })\n\n    group.Add(func() {\n        time.Sleep(time.Minute)\n\n        for number := 1; number &lt; 4; number++ {\n            fmt.Printf(\"%d \", number)\n        }\n    })\n\n    err := group.Run()\n\n    fmt.Println()\n    fmt.Println(\"Done\")\n    fmt.Printf(\"Error: %v\", err)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Done\nError: timeout\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 447, "user_id": 1159513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7abb9fe36c2ffd374780a5be831385d4?s=128&d=identicon&r=PG", "display_name": "JtotheR", "link": "https://stackoverflow.com/users/1159513/jtother"}, "is_accepted": false, "score": 1, "last_activity_date": 1518776023, "creation_date": 1518776023, "answer_id": 48824452, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait/48824452#48824452", "title": "Timeout for WaitGroup.Wait()", "body": "<p>This is not an actual answer to this question but was the (much simpler) solution to my little problem when I had this question.</p>\n\n<p>My 'workers' were doing http.Get() requests so I just set the timeout on the http client.</p>\n\n<pre><code>urls := []string{\"http://1.jpg\", \"http://2.jpg\"}\nwg := &amp;sync.WaitGroup{}\nfor _, url := range urls {\n    wg.Add(1)\n    go func(url string) {\n        client := http.Client{\n            Timeout: time.Duration(3 * time.Second), // only want very fast responses\n        }\n        resp, err := client.Get(url)\n        //... check for errors\n        //... do something with the image when there are no errors\n        //...\n\n        wg.Done()\n    }(url)\n\n}\nwg.Wait()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 2, "last_activity_date": 1570639012, "creation_date": 1570639012, "answer_id": 58308642, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait/58308642#58308642", "title": "Timeout for WaitGroup.Wait()", "body": "<p>This is a bad idea. <strong>Do not abandon goroutines</strong>, doing so may introduce races, resource leaks and unexpected conditions, ultimately impacting the stability of your application.</p>\n\n<p>Instead use timeouts throughout your code consistently in order to make sure no goroutine is blocked forever or takes too long to run.</p>\n\n<p>The idiomatic way for achieving that is via <a href=\"https://golang.org/pkg/context/#WithTimeout\" rel=\"nofollow noreferrer\"><code>context.WithTimeout()</code></a>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>ctx, cancel := context.WithTimeout(context.Background(), 5 * time.Second)\ndefer cancel()\n\n// Now perform any I/O using the given ctx:\ngo func() {\n  err = example.Connect(ctx)\n  if err != nil { /* handle err and exit goroutine */ }\n  . . .\n}()\n</code></pre>\n\n<p>Now you can safely use <code>WaitGroup.Wait()</code>, knowing it will always finish in a timely manner.</p>\n"}, {"tags": [], "owner": {"reputation": 5383, "user_id": 961092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b2d47d99e6af64b89e6a0721e3485eb?s=128&d=identicon&r=PG", "display_name": "Dmitry Verhoturov", "link": "https://stackoverflow.com/users/961092/dmitry-verhoturov"}, "is_accepted": false, "score": 3, "last_activity_date": 1596098492, "last_edit_date": 1596098492, "creation_date": 1586777100, "answer_id": 61186832, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait/61186832#61186832", "title": "Timeout for WaitGroup.Wait()", "body": "<p>Most existing answers suggest leaking goroutines. The idiomatic way to assign a timeout to <a href=\"https://golang.org/pkg/sync/#WaitGroup.Wait\" rel=\"nofollow noreferrer\">WaitGroup.Wait</a> is to use underlying <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"nofollow noreferrer\">sync/atomic</a> package primitives. I took code from @icza answer and rewrote it using the <code>atomic</code> package, and added context cancelation as that's an idiomatic way to notify of a timeout.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;context&quot;\n    &quot;fmt&quot;\n    &quot;sync/atomic&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    var submitCount int32\n    // run this instead of wg.Add(1)\n    atomic.AddInt32(&amp;submitCount, 1)\n\n    // run this instead of wg.Done()\n    // atomic.AddInt32(&amp;submitCount, -1)\n\n    timeout := time.Second\n    ctx, cancel := context.WithTimeout(context.Background(), timeout)\n    defer cancel()\n    fmt.Printf(&quot;Wait for waitgroup (up to %s)\\n&quot;, timeout)\n\n    waitWithCtx(ctx, &amp;submitCount)\n\n    fmt.Println(&quot;Free at last&quot;)\n}\n\n// waitWithCtx returns when passed counter drops to zero\n// or when context is cancelled\nfunc waitWithCtx(ctx context.Context, counter *int32) {\n    ticker := time.NewTicker(10 * time.Millisecond)\n    for {\n        select {\n        case &lt;-ctx.Done():\n            return\n        case &lt;-ticker.C:\n            if atomic.LoadInt32(counter) == 0 {\n                return\n            }\n        }\n    }\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/_FHOnHSExtD\" rel=\"nofollow noreferrer\">Same code in Go Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8384167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be54fa1b32340c02bdacda85b702e35?s=128&d=identicon&r=PG&f=1", "display_name": "derlafff", "link": "https://stackoverflow.com/users/8384167/derlafff"}, "is_accepted": false, "score": 0, "last_activity_date": 1611752027, "last_edit_date": 1611752027, "creation_date": 1611751566, "answer_id": 65919489, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait/65919489#65919489", "title": "Timeout for WaitGroup.Wait()", "body": "<p>Another solution without leaking <code>wg.Wait()</code> routine: just use (well-suported and widely-used) <a href=\"https://godoc.org/golang.org/x/sync/semaphore\" rel=\"nofollow noreferrer\"><code>golang.org/x/sync/semaphore</code></a>:</p>\n<ul>\n<li>Instead of <code>sync.WaitGroup{}</code> use <code>sem.NewWeighted(N)</code> (you have to know <code>N</code> in advance)</li>\n<li>Instead of <code>wg.Add(1)</code> use <code>err := sem.Acquire(ctx, 1)</code></li>\n<li>Instead of <code>defer wg.Done()</code> use <code>defer sem.Release(1)</code></li>\n<li>Instead of <code>wg.Wait()</code> you can use <code>sem.Acquire(ctx, N)</code> with context with timeout.</li>\n<li>Watch out, this is only equivalent to <code>sync.WaitGroup</code> in this specific use-case (when you only call <code>Add(1)</code> and <code>Release(1)</code> <code>N</code> times). Read the documentation carefully.</li>\n</ul>\n<p><a href=\"https://play.golang.org/p/Bs74BYTeHbz\" rel=\"nofollow noreferrer\">Example</a>:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;context&quot;\n    &quot;log&quot;\n    &quot;time&quot;\n\n    &quot;golang.org/x/sync/semaphore&quot;\n)\n\nfunc worker(n int) {\n    time.Sleep(time.Duration(n) * time.Second)\n    log.Printf(&quot;Worker %v finished&quot;, n)\n}\n\nfunc main() {\n\n    const N = 5\n    sem := semaphore.NewWeighted(N)\n\n    for i := 0; i &lt; N; i++ {\n\n        err := sem.Acquire(context.Background(), 1)\n        if err != nil {\n            log.Fatal(&quot;sem.Acquire err&quot;, err)\n        }\n        go func(n int) {\n            defer sem.Release(1)\n            worker(n)\n        }(i)\n    }\n\n    ctx, cancel := context.WithTimeout(context.Background(), time.Second*2)\n    defer cancel()\n\n    err := sem.Acquire(ctx, N)\n    if err != nil {\n        log.Println(&quot;sem.Acquire err:&quot;, err)\n        return\n    }\n\n    log.Println(&quot;sem.Acquire ok&quot;)\n}\n</code></pre>\n<p>Which results in:</p>\n<pre><code>2009/11/10 23:00:00 Worker 0 finished\n2009/11/10 23:00:01 Worker 1 finished\n2009/11/10 23:00:02 Worker 2 finished\n2009/11/10 23:00:02 sem.Acquire err: context deadline exceeded\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4316, "user_id": 486035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1654e9816b6e407e1daced17ac4fcf3b?s=128&d=identicon&r=PG", "display_name": "phemmer", "link": "https://stackoverflow.com/users/486035/phemmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1618708715, "creation_date": 1618708715, "answer_id": 67144407, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait/67144407#67144407", "title": "Timeout for WaitGroup.Wait()", "body": "<p>Throwing in a solution which does not leak a goroutine, or rely on polling (sleeps):</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import &quot;atomic&quot;\n\ntype WaitGroup struct {\n    count int32\n    done chan struct{}\n}\n\nfunc NewWaitGroup() *WaitGroup {\n    return &amp;WaitGroup{\n        done: make(chan struct{}),\n    }\n}\n\nfunc (wg *WaitGroup) Add(i int32) {\n    select {\n    case &lt;-wg.done:\n        panic(&quot;use of an already closed WaitGroup&quot;)\n    default:\n    }\n    atomic.AddInt32(&amp;wg.count, i)\n}\n\nfunc (wg *WaitGroup) Done() {\n    i := atomic.AddInt32(&amp;wg.count, -1)\n    if i == 0 {\n        close(wg.done)\n    }\n    if i &lt; 0 {\n        panic(&quot;too many Done() calls&quot;)\n    }\n}\n\nfunc (wg *WaitGroup) C() &lt;-chan struct{} {\n    return wg.done\n}\n</code></pre>\n<p>Usage:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>wg := NewWaitGroup()\nwg.Add(1)\ngo func() {\n  // do stuff\n  wg.Done()\n}\n\nselect {\ncase &lt;-wg.C():\n  fmt.Printf(&quot;Completed!\\n&quot;)\ncase &lt;-time.NewTimer(time.Second):\n  fmt.Printf(&quot;Timed out!\\n&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 8064, "user_id": 303698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b80995efd7fa90c4899cfcb401ab7534?s=128&d=identicon&r=PG", "display_name": "laher", "link": "https://stackoverflow.com/users/303698/laher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19432, "favorite_count": 9, "accepted_answer_id": 32843750, "answer_count": 8, "score": 28, "last_activity_date": 1618708715, "creation_date": 1443519585, "question_id": 32840687, "link": "https://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait", "title": "Timeout for WaitGroup.Wait()", "body": "<p>What is an idiomatic way to assign a timeout to <a href=\"https://golang.org/pkg/sync/#WaitGroup.Wait\" rel=\"noreferrer\">WaitGroup.Wait()</a> ?</p>\n\n<p>The reason I want to do this, is to safeguard my 'scheduler' from potentially awaiting an errant 'worker' for ever. This leads to some philosophical questions (i.e. how can the system reliably continue once it has errant workers?), but I think that's out of scope for this question.</p>\n\n<p>I have an answer which I'll provide. Now that I've written it down, it doesn't seem so bad but it still feels more convoluted than it ought to. I'd like to know if there's something available which is simpler, more idiomatic, or even an alternative approach which doesn't use WaitGroups. </p>\n\n<p>Ta.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 1, "creation_date": 1515118679, "post_id": 32834661, "comment_id": 83188355, "body": "Please return to this question and change your accepted answer. The answer you accepted is great for your specific case, but your question is very general, and there is an answer that is much better for the general question you asked. This should be the accepted answer: <a href=\"https://stackoverflow.com/a/32844744/167958\">stackoverflow.com/a/32844744/167958</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 0, "creation_date": 1443493828, "post_id": 32834707, "comment_id": 53505114, "body": "this only keeps on printing &quot;hi&quot;. Even if we give command line input as 2, it prints &quot;hi&quot; instead of exiting the program."}, {"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "reply_to_user": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 0, "creation_date": 1443493930, "post_id": 32834707, "comment_id": 53505145, "body": "My mistake. The switch case needs to be modified."}, {"owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "reply_to_user": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 1, "creation_date": 1443494077, "post_id": 32834707, "comment_id": 53505184, "body": "So the mistake with the original input was that the return value from Scanln was being used. The <a href=\"https://golang.org/pkg/fmt/#Scanln\" rel=\"nofollow noreferrer\">documentation</a> states that the return is an error/number of arguments parsed, which is not how you want to use it. This should get you started."}], "tags": [], "owner": {"reputation": 3111, "user_id": 455678, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ec6689b267447cdcd58fbe5d89332b25?s=128&d=identicon&r=PG", "display_name": "Lander", "link": "https://stackoverflow.com/users/455678/lander"}, "is_accepted": true, "score": 15, "last_activity_date": 1512763145, "last_edit_date": 1512763145, "creation_date": 1443493609, "answer_id": 32834707, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go/32834707#32834707", "title": "How to replicate do while in go?", "body": "<p>When this question was asked this was a better answer <em>for this specific scenario</em> (little did I know this would be the #1 result when searching Google for \"do while loop golang\"). For answering this question generically please see <a href=\"https://stackoverflow.com/a/32844744/455678\">@LinearZoetrope's answer below</a>.</p>\n\n<p>Wrap your function in a for loop:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    fmt.Println(\"Press 1 to run\")\n    fmt.Println(\"Press 2 to exit\")\n    for {\n        sample()\n    }\n}\n\nfunc sample() {\n    var input int\n    n, err := fmt.Scanln(&amp;input)\n    if n &lt; 1 || err != nil {\n         fmt.Println(\"invalid input\")\n         return\n    }\n    switch input {\n    case 1:\n        fmt.Println(\"hi\")\n    case 2:\n        os.Exit(2)\n    default:\n        fmt.Println(\"def\")\n    }\n}\n</code></pre>\n\n<p>A <code>for</code> loop without any declarations is equivalent to a <code>while</code> loop in other C-like languages. Check out the <a href=\"https://golang.org/doc/effective_go.html#for\" rel=\"noreferrer\">Effective Go documentation</a> which covers the <code>for</code> loop.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 1283658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc0d9019c71a5620e823caaee1edbb0?s=128&d=identicon&r=PG", "display_name": "P.An", "link": "https://stackoverflow.com/users/1283658/p-an"}, "edited": false, "score": 1, "creation_date": 1509709301, "post_id": 32844744, "comment_id": 81139136, "body": "This should be accepted answer as it is idiomatic and exactly replicates <code>do while</code> whilst current accepted answer just replicates <code>while</code> statement"}, {"owner": {"reputation": 3196, "user_id": 1541397, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/991c4e6d0872e18880e3e0ff51cdf5a2?s=128&d=identicon&r=PG", "display_name": "David Callanan", "link": "https://stackoverflow.com/users/1541397/david-callanan"}, "edited": false, "score": 0, "creation_date": 1566337250, "post_id": 32844744, "comment_id": 101623139, "body": "This is a great simple answer, however it doesn&#39;t allow you to access variables inside the for scope in the condition. <a href=\"https://stackoverflow.com/a/43643668/1541397\">This answer solves this problem.</a>"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 3196, "user_id": 1541397, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/991c4e6d0872e18880e3e0ff51cdf5a2?s=128&d=identicon&r=PG", "display_name": "David Callanan", "link": "https://stackoverflow.com/users/1541397/david-callanan"}, "edited": false, "score": 0, "creation_date": 1566341654, "post_id": 32844744, "comment_id": 101624076, "body": "@David Callanan I mean, it&#39;s not that hard to fix. Just do <code>ok = ok</code> for the expression and set <code>ok</code> manually at the end of the loop."}, {"owner": {"reputation": 3196, "user_id": 1541397, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/991c4e6d0872e18880e3e0ff51cdf5a2?s=128&d=identicon&r=PG", "display_name": "David Callanan", "link": "https://stackoverflow.com/users/1541397/david-callanan"}, "edited": false, "score": 0, "creation_date": 1566377289, "post_id": 32844744, "comment_id": 101633039, "body": "@LinearZoetrope Nice that works too! The condition is full of oks then :) <code>for ok := true; ok; ok = ok { ... }</code>"}], "tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": false, "score": 71, "last_activity_date": 1443532578, "last_edit_date": 1443532578, "creation_date": 1443531754, "answer_id": 32844744, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go/32844744#32844744", "title": "How to replicate do while in go?", "body": "<p>A <code>do..while</code> can more directly be emulated in Go with a for loop using a <code>bool</code> loop variable seeded with <code>true</code>.</p>\n\n<pre><code>for ok := true; ok; ok = EXPR { }\n</code></pre>\n\n<p>is more or less directly equivalent to</p>\n\n<pre><code>do { } while(EXPR)\n</code></pre>\n\n<p>So in your case:</p>\n\n<pre><code>var input int\nfor ok := true; ok; ok = (input != 2) {\n    n, err := fmt.Scanln(&amp;input)\n    if n &lt; 1 || err != nil {\n        fmt.Println(\"invalid input\")\n        break\n    }\n\n    switch input {\n    case 1:\n        fmt.Println(\"hi\")\n    case 2:\n        // Do nothing (we want to exit the loop)\n        // In a real program this could be cleanup\n    default:\n        fmt.Println(\"def\")\n    }\n}\n</code></pre>\n\n<p>Edit: <a href=\"http://play.golang.org/p/MxNlCpeyOH\">Playground</a> (with a dummied-out Stdin)</p>\n\n<p>Though, admittedly, in this case it's probably overall clearer to just explicitly call (labelled) <code>break</code>, <code>return</code>, or <code>os.Exit</code> in the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "edited": false, "score": 2, "creation_date": 1478682577, "post_id": 37409286, "comment_id": 68249511, "body": "Go does have regular &quot;while loops&quot; though: <code>for a &gt; b { ... }</code>. What OP is asking for is a <code>do { ... } while (a &gt; b);</code> loop"}], "tags": [], "owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "is_accepted": false, "score": 2, "last_activity_date": 1464081576, "creation_date": 1464081576, "answer_id": 37409286, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go/37409286#37409286", "title": "How to replicate do while in go?", "body": "<p>Maybe not what you're looking for, but if you're trying to do something like this:</p>\n\n<pre><code>int i = 0;\nwhile (i &lt; 10) {\n    cout &lt;&lt; \"incrementing i now\" &lt;&lt; endl;\n    i++\n}\ncout &lt;&lt; \"done\"\n</code></pre>\n\n<p>You'll have to do something like this in go:</p>\n\n<pre><code>    var i = 0 \n    fmt.Println(i)\n    for {\n            if i &lt; 10 {\n                    fmt.Println(\"incrementing i now\")\n                    i++ \n            } else {\n                    break\n            }   \n    }   \n    fmt.Println(\"done\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2851, "user_id": 243089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c504339686fb2092eba997ee8899131?s=128&d=identicon&r=PG", "display_name": "Victor Zamanian", "link": "https://stackoverflow.com/users/243089/victor-zamanian"}, "edited": false, "score": 0, "creation_date": 1488895752, "post_id": 37897593, "comment_id": 72426866, "body": "This is an <i>infinite</i> loop declaration, rather than a while loop. A while loop would have a condition."}, {"owner": {"reputation": 1823, "user_id": 4060711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aH6Ue.jpg?s=128&g=1", "display_name": "3ocene", "link": "https://stackoverflow.com/users/4060711/3ocene"}, "reply_to_user": {"reputation": 2851, "user_id": 243089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c504339686fb2092eba997ee8899131?s=128&d=identicon&r=PG", "display_name": "Victor Zamanian", "link": "https://stackoverflow.com/users/243089/victor-zamanian"}, "edited": false, "score": 0, "creation_date": 1500071277, "post_id": 37897593, "comment_id": 77196463, "body": "@VictorZamanian there is a condition: <code>if number &gt;= 10 { break }</code>. For all intents and purposes, an infinite loop with a conditional break at the end is the same as a <code>do..while</code> loop which is exactly what OP was asking for."}, {"owner": {"reputation": 1823, "user_id": 4060711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aH6Ue.jpg?s=128&g=1", "display_name": "3ocene", "link": "https://stackoverflow.com/users/4060711/3ocene"}, "reply_to_user": {"reputation": 2851, "user_id": 243089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c504339686fb2092eba997ee8899131?s=128&d=identicon&r=PG", "display_name": "Victor Zamanian", "link": "https://stackoverflow.com/users/243089/victor-zamanian"}, "edited": false, "score": 0, "creation_date": 1500085981, "post_id": 37897593, "comment_id": 77199143, "body": "@VictorZamanian perhaps I&#39;m missing the point of your comment then. It sounds like you&#39;re trying to say that the answer is incorrect or that he&#39;s wrong to say that it&#39;s emulating a while loop."}, {"owner": {"reputation": 2851, "user_id": 243089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c504339686fb2092eba997ee8899131?s=128&d=identicon&r=PG", "display_name": "Victor Zamanian", "link": "https://stackoverflow.com/users/243089/victor-zamanian"}, "reply_to_user": {"reputation": 1823, "user_id": 4060711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aH6Ue.jpg?s=128&g=1", "display_name": "3ocene", "link": "https://stackoverflow.com/users/4060711/3ocene"}, "edited": false, "score": 1, "creation_date": 1500086282, "post_id": 37897593, "comment_id": 77199182, "body": "@3ocene No, no. Your reasoning is correct. I probably just missed the condition at the end there when I made my first comment on this answer a while back. My mistake"}], "tags": [], "owner": {"reputation": 111, "user_id": 3165213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b753ad6ace48f2987eb54e992327e82?s=128&d=identicon&r=PG&f=1", "display_name": "user3165213", "link": "https://stackoverflow.com/users/3165213/user3165213"}, "is_accepted": false, "score": 11, "last_activity_date": 1466257026, "creation_date": 1466257026, "answer_id": 37897593, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go/37897593#37897593", "title": "How to replicate do while in go?", "body": "<p>a <code>while</code> loop in Go can be as easy as this:</p>\n\n<pre><code>  package main\n\n  import `fmt`\n\n      func main() {\n        for {\n          var number float64\n          fmt.Print(`insert an Integer eq or gr than 10!!!`)\n          fmt.Scanf(`%f`, &amp;number)\n          if number &gt;= 10 { break }\n          fmt.Println(`sorry the number is lower than 10....type again!!!`)\n        }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1823, "user_id": 4060711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aH6Ue.jpg?s=128&g=1", "display_name": "3ocene", "link": "https://stackoverflow.com/users/4060711/3ocene"}, "edited": false, "score": 0, "creation_date": 1500071462, "post_id": 42085121, "comment_id": 77196509, "body": "This is the same as <code>for i := 0; i &lt; 10; i++ { fmt.Printf(&quot;%v &quot;, i) }</code>. Perhaps you meant to put the print statement at the top of the loop?"}], "tags": [], "owner": {"reputation": 7684, "user_id": 5465237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WVMgAubpy6M/AAAAAAAAAAI/AAAAAAAAABc/a5sawMlsGYs/photo.jpg?sz=128", "display_name": "ROY", "link": "https://stackoverflow.com/users/5465237/roy"}, "is_accepted": false, "score": 3, "last_activity_date": 1486456504, "creation_date": 1486456504, "answer_id": 42085121, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go/42085121#42085121", "title": "How to replicate do while in go?", "body": "<p>Conside to use \"for-break\" as \"do-while\".</p>\n\n<p><em>foo.go</em></p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n)\n\nfunc main() {\n        i := 0\n        for {\n                i++\n                if i &gt; 10 {\n                        break\n                }\n                fmt.Printf(\"%v \", i)\n        }\n        fmt.Println()\n}\n</code></pre>\n\n<p><em>shell</em></p>\n\n<pre><code>$ go run foo.go\n1 2 3 4 5 6 7 8 9 10\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3196, "user_id": 1541397, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/991c4e6d0872e18880e3e0ff51cdf5a2?s=128&d=identicon&r=PG", "display_name": "David Callanan", "link": "https://stackoverflow.com/users/1541397/david-callanan"}, "edited": false, "score": 0, "creation_date": 1566337344, "post_id": 43643668, "comment_id": 101623164, "body": "This solution allows you to access variables inside the for scope in the condition, which is necessary in some situations."}], "tags": [], "owner": {"reputation": 131, "user_id": 7927743, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/11740e74c30de84cbdec811abc335bcc?s=128&d=identicon&r=PG", "display_name": "lolita", "link": "https://stackoverflow.com/users/7927743/lolita"}, "is_accepted": false, "score": 13, "last_activity_date": 1493239111, "last_edit_date": 1493239111, "creation_date": 1493237408, "answer_id": 43643668, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go/43643668#43643668", "title": "How to replicate do while in go?", "body": "<p>The do...while in go can be this:</p>\n\n<pre><code>func main() {\n    var value int\n    for {\n        value++\n        fmt.Println(value)\n        if value%6 != 0 {\n            break\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 6150881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a42d9d73c727b1b482f4e215ac1b663?s=128&d=identicon&r=PG&f=1", "display_name": "Rabhi salim", "link": "https://stackoverflow.com/users/6150881/rabhi-salim"}, "is_accepted": false, "score": 1, "last_activity_date": 1572605151, "last_edit_date": 1572605151, "creation_date": 1572604271, "answer_id": 58657695, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go/58657695#58657695", "title": "How to replicate do while in go?", "body": "<pre><code>sum := 1\n    for sum &lt; 1000 {\n        sum += sum\n    }\n</code></pre>\n\n<p>Explanation :</p>\n\n<p>The basic for loop has three components separated by semicolons:</p>\n\n<p>-the init statement: executed before the first iteration.</p>\n\n<p>-the condition expression: evaluated before every iteration</p>\n\n<p>-the post statement: executed at the end of every iteration</p>\n\n<p>The init and post statements are optional.</p>\n\n<p>So you can just put in the condition expression.</p>\n\n<pre><code>// While (CONDITION = true){\n//code to execute ....}\n\n//In go : \nfor CONDITION = true {\n//code to execute}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4324, "user_id": 288564, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bba6803193806848603193f45d383bfa?s=128&d=identicon&r=PG", "display_name": "Emmanuel", "link": "https://stackoverflow.com/users/288564/emmanuel"}, "is_accepted": false, "score": 0, "last_activity_date": 1601418890, "creation_date": 1601418890, "answer_id": 64128567, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go/64128567#64128567", "title": "How to replicate do while in go?", "body": "<p>This is one of the cleanest ways:</p>\n<pre><code>num := 10\nfor num &gt; 0 {\n    // do stuff here\n    num--\n}\n</code></pre>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51879, "favorite_count": 10, "accepted_answer_id": 32834707, "answer_count": 8, "score": 38, "last_activity_date": 1601418890, "creation_date": 1443493254, "last_edit_date": 1466257196, "question_id": 32834661, "link": "https://stackoverflow.com/questions/32834661/how-to-replicate-do-while-in-go", "title": "How to replicate do while in go?", "body": "<p>I want a set of code to be executed until user explicitly wants to exit the function. For eg: when a user runs the program, he will see 2 options:</p>\n\n<ol>\n<li>Run again   </li>\n<li>Exit</li>\n</ol>\n\n<p>this will be achieved using switch case structure. Here if user presses 1, set of functions associated with 1 will execute and if user presses 2, the program will exit. How should i achieve this scenario in golang ? In java, i believe this could be done using do while structure but go doesn't support do while loop. Following is my code which i tried but this goes in a infinite loop:</p>\n\n<pre><code>func sample() {\n    var i = 1\n    for i &gt; 0 {\n        fmt.Println(\"Press 1 to run\")\n        fmt.Println(\"Press 2 to exit\")\n        var input string\n        inpt, _ := fmt.Scanln(&amp;input)\n        switch inpt {\n        case 1:\n            fmt.Println(\"hi\")\n        case 2:\n            os.Exit(2)\n        default:\n            fmt.Println(\"def\")\n        }\n    }\n}\n</code></pre>\n\n<p>The program irrespective of the input, prints only \"hi\". Could someone please correct me what wrong i am doing here ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ssh", "go", "runtime-error"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1443486697, "post_id": 32833672, "comment_id": 53503427, "body": "Why not get the output of the shell command and see what the error was?"}, {"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443488255, "post_id": 32833672, "comment_id": 53503746, "body": "Well observed, i forgot about that.   The output is:   &quot;# On branch master nothing to commit, working directory clean&quot;  Exactly what should be. But the error is still there =/"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1443488770, "post_id": 32833672, "comment_id": 53503879, "body": "Then this the expected result, since git is returning with an exit code of 1. The same things happens in your terminal, you&#39;re just not checking the exit code."}, {"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443489098, "post_id": 32833672, "comment_id": 53503940, "body": "I got your point and it seems correct. But doesn&#39;t that sound a bit strange? Exit 1 is an unsuccessful exit, right? Should I ignore this particular error message when i check the error?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1443489303, "post_id": 32833672, "comment_id": 53503985, "body": "This has nothing to do with Go, or ssh, it&#39;s simply that git exits with 1 when you try to commit when there&#39;s nothing to commit. You either need to check for something to commit first (maybe something like <code>git status --porcelain</code>), or check for this particular error and exit code."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1443496088, "post_id": 32833672, "comment_id": 53505640, "body": "Git returns 1 because you tried to commit and it didn&#39;t succeed do to no files being staged. You should expect that status in this case. If the commit were something that worked like <code>git commit -a -m &quot;A message&quot;</code> with one or more files changed then the commit would succeed and you&#39;d get a 0."}], "answers": [{"tags": [], "owner": {"reputation": 1031, "user_id": 1107514, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/36ef13d2c481eec643c6298213d70f21?s=128&d=identicon&r=PG", "display_name": "Leonid Shagabutdinov", "link": "https://stackoverflow.com/users/1107514/leonid-shagabutdinov"}, "is_accepted": false, "score": 0, "last_activity_date": 1454295740, "last_edit_date": 1454295740, "creation_date": 1454146200, "answer_id": 35100111, "question_id": 32833672, "link": "https://stackoverflow.com/questions/32833672/go-unknown-error-on-executing-a-command-via-ssh-connection/35100111#35100111", "title": "GO - Unknown error on executing a command via ssh connection", "body": "<p>Maybe my library will helps in your case: <a href=\"https://github.com/shagabutdinov/shell\" rel=\"nofollow\">https://github.com/shagabutdinov/shell</a>; it covers basic cases of running ssh commands in one session.</p>\n\n<p>Try following:</p>\n\n<pre><code>handler := func(outputType int, message string) {\n    if(outputType == shell.Stdout) {\n        log.Println(\"stdout: \", message)\n    } else if(outputType == shell.Stdout) {\n        log.Println(\"stderr: \", message)\n    }\n}\n\nkey, err := ssh.ParsePrivateKey([]byte(YOUR_PRIVATE_KEY))\nif(err != nil) {\n    panic(err)\n}\n\nauth := []ssh.AuthMethod{ssh.PublicKeys(key)}\nshell = shell.NewRemote(shell.RemoteConfig{\n    Host: \"root@example.com:22\",\n    Auth: auth,\n})\n\nif(err != nil) {\n    panic(err)\n}\n\nstatus, err := shell.Run(\"cd ~/www/www/\", handler)\nif(err != nil) {\n    panic(err)\n}\n\nstatus, err := shell.Run(\"git commit -m 'on the beginning was the commit'\", handler)\nif(err != nil) {\n    panic(err)\n}\n\nif(status == 0) {\n    console.log(\"command executed successfully\")\n} else {\n    console.log(\"command execution failed\")\n}\n</code></pre>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1572, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1454295740, "creation_date": 1443485335, "last_edit_date": 1443488574, "question_id": 32833672, "link": "https://stackoverflow.com/questions/32833672/go-unknown-error-on-executing-a-command-via-ssh-connection", "title": "GO - Unknown error on executing a command via ssh connection", "body": "<p>I'm trying to execute a command via <strong>session.Run()</strong> function over a ssh connection. So far I can successfully execute some commands but on others I keep getting the following error: <strong>\"Process exited with: 1. Reason was:  () exit status 1\"</strong></p>\n\n<pre><code>func (p *project) connect(config *ssh.ClientConfig) {\n\n    log.Printf(\"Trying connection...\\n\")\n\n    conn, err := ssh.Dial(\"tcp\", fmt.Sprintf(\"%s:%s\", p.hostname.name, p.port.name), config)\n    checkError(\"Failed to dial: \", err)\n    log.Printf(\"Connection established.\\n\")\n\n    for step := range p.typ.program.setup {\n        p.install(step, conn)\n    }\n}\n\nfunc (p *project) install(step int, conn *ssh.Client) {\n    session, err := conn.NewSession()\n    checkError(\"Failed to build session: \", err)\n    defer session.Close()\n\n    var stdoutBuf bytes.Buffer\n    session.Stdout = &amp;stdoutBuf\n\n    log.Printf(\"Executing command: %s\", p.typ.program.setup[step])\n\n    if err := session.Run(p.typ.program.setup[step]); err != nil {\n        log.Println(session.Stdout)\n        log.Fatal(\"Error on command execution\", err.Error())\n    }\n}\n\n\n// That would be an example of a command which returns me an error\n// \"cd ~/www/www/ &amp;&amp; git commit -m 'on the beginning was the commit'\"\n// That comes inside a slice on p.typ.program.setup accessed by the step(index).\n</code></pre>\n\n<p>The command output (session.Stdout) is the one i expect:</p>\n\n<pre><code> \"# On branch master nothing to commit, working directory clean\"\n</code></pre>\n\n<p>And just to note I already tried to execute the command directly on the console and it works just fine.</p>\n\n<p>So, the code seems to be okay, the command ran on the remote but I still have an error no matter what.</p>\n\n<p>Does anyone have a clue about why is that happening?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4156, "user_id": 3072896, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WWVXA.png?s=128&g=1", "display_name": "Joe Thomas", "link": "https://stackoverflow.com/users/3072896/joe-thomas"}, "edited": false, "score": 3, "creation_date": 1484517916, "post_id": 32833297, "comment_id": 70531811, "body": "What&#39;s with all the downvotes?"}], "answers": [{"comments": [{"owner": {"reputation": 9474, "user_id": 1220089, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/nljYa.jpg?s=128&g=1", "display_name": "ffledgling", "link": "https://stackoverflow.com/users/1220089/ffledgling"}, "edited": false, "score": 0, "creation_date": 1498564028, "post_id": 32833370, "comment_id": 76539384, "body": "Is there an explanation for why <code>:=</code> is restricted to function bodies only? Or why globals must use <code>var</code> ?"}, {"owner": {"reputation": 807, "user_id": 449131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6165aecb1a97c3ee6df433e38b49ca37?s=128&d=identicon&r=PG", "display_name": "Blake Miller", "link": "https://stackoverflow.com/users/449131/blake-miller"}, "reply_to_user": {"reputation": 9474, "user_id": 1220089, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/nljYa.jpg?s=128&g=1", "display_name": "ffledgling", "link": "https://stackoverflow.com/users/1220089/ffledgling"}, "edited": false, "score": 0, "creation_date": 1502174543, "post_id": 32833370, "comment_id": 78081307, "body": "@ffledgling it&#39;s to simplify parsing, which may make the compiler faster"}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 21, "last_activity_date": 1443483077, "creation_date": 1443483077, "answer_id": 32833370, "question_id": 32833297, "link": "https://stackoverflow.com/questions/32833297/is-it-possible-to-declare-a-map-at-package-level-in-golang/32833370#32833370", "title": "Is it possible to declare a map at package level in golang?", "body": "<p>You can\u2019t use the <code>:=</code> syntax outside a function body, but you can use the normal variable declaration syntax:</p>\n\n<pre><code>var globalMap = make(map[string]string)\n</code></pre>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3832, "favorite_count": 1, "accepted_answer_id": 32833370, "answer_count": 1, "score": 8, "last_activity_date": 1556339674, "creation_date": 1443482671, "last_edit_date": 1556339674, "question_id": 32833297, "link": "https://stackoverflow.com/questions/32833297/is-it-possible-to-declare-a-map-at-package-level-in-golang", "title": "Is it possible to declare a map at package level in golang?", "body": "<p>I want a make global map. I am trying the following </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nglobalMap := make(map[string]string)\n\nfunc main() {\n    globalMap[\"a\"] = \"A\"\n    fmt.Println(globalMap)\n}\n</code></pre>\n\n<p>It gives me following compilation error on line <code>globalMap := make(map[string]string)</code>:</p>\n\n<pre><code>expected declaration, found 'IDENT' mas\nnon-declaration statement outside function body\n</code></pre>\n\n<p>Looking at the error i understand it won't allow me to create a global map. what could the best way to create a global map ? </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "goroutine", "channels"], "answers": [{"tags": [], "owner": {"reputation": 385, "user_id": 5386963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57a66c301b782f4630f4e45200cc2a5?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewN", "link": "https://stackoverflow.com/users/5386963/andrewn"}, "is_accepted": false, "score": 4, "last_activity_date": 1443498374, "last_edit_date": 1443498374, "creation_date": 1443496531, "answer_id": 32835116, "question_id": 32832565, "link": "https://stackoverflow.com/questions/32832565/goroutines-channels-and-deadlock/32835116#32835116", "title": "Goroutines, Channels and Deadlock", "body": "<p>Channels in go are unbuffered by <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"nofollow\">default</a>, which means that none of the anonymous goroutines you spawn can send to the <strong>results</strong> channel until you start trying to receive from that channel. That doesn't start executing in the main program until <strong>scanner.Scan()</strong> is done filling up the <strong>line</strong> channel...which it's blocked from doing until your anonymous functions can send to the <strong>results</strong> channel and restart their loops. Deadlock.</p>\n\n<p>The other problem in your code, even when trivially fixing the above by buffering the channels, is that <strong>for i := range results</strong> will also deadlock once there are no more results being fed into it, since the channel hasn't been closed.</p>\n\n<p>Edit: Here's one potential <a href=\"http://play.golang.org/p/UAH5aW_4hQ\" rel=\"nofollow\">solution</a>, if you want to <em>avoid</em> buffered channels. Basically, the first issue is avoided by performing the send to the <strong>results</strong> channel via a new goroutine, allowing the lines loop to complete. The second issue (not knowing when to stop reading a channel) is avoided by counting the goroutines as they are created and explicitly closing down the channel when every goroutine is accounted for. It's probably better to do something similar with waitgroups, but this is just a very fast way to show how to do this unbuffered.</p>\n"}, {"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 6, "last_activity_date": 1572426805, "last_edit_date": 1572426805, "creation_date": 1443503457, "answer_id": 32836094, "question_id": 32832565, "link": "https://stackoverflow.com/questions/32832565/goroutines-channels-and-deadlock/32836094#32836094", "title": "Goroutines, Channels and Deadlock", "body": "<p>As @AndrewN has pointed out, the problem is each goroutine gets to the point where it's trying to send to the <code>results</code> channel, but those sends will block because the <code>results</code> channel is unbuffered and nothing reads from them until the <code>for i := range results</code> loop.  You never get to that loop, because you first need to finish the <code>for scanner.Scan()</code> loop, which is trying to send all the <code>line</code>s down the <code>lines</code> channel, which is blocked because the goroutines are never looping back to the <code>range lines</code> because they're stuck sending to <code>results</code>.</p>\n\n<p>The first thing you might try to do to fix this is to put the <code>scanner.Scan()</code> stuff in a goroutine, so that something can start reading off the <code>results</code> channel right away.  However, the next problem you'll have is knowing when to end the <code>for i := range results</code> loop.  You want to have something close the <code>results</code> channel, but only after the original goroutines are done reading off the <code>lines</code> channel.  You could close the <code>results</code> channel right after closing the <code>lines</code> channel, however I think that might introduce a potential race, so the safest thing to do is also wait for the original two goroutines to be done before closing the <code>results</code> channel: (<a href=\"https://play.golang.org/p/OnQRT9ie5U\" rel=\"nofollow noreferrer\">playground link</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"runtime\"\nimport \"bufio\"\nimport \"strings\"\nimport \"sync\"\n\nfunc main() {\n    runtime.GOMAXPROCS(2)\n\n    scanner := bufio.NewScanner(strings.NewReader(`\nhi mom\nhi dad\nhi sister\ngoodbye`))\n    lines := make(chan string)\n    results := make(chan int)\n\n    wg := sync.WaitGroup{}\n    for i := 0; i &lt; 2; i++ {\n        wg.Add(1)\n        go func() {\n            for line := range lines {\n                fmt.Printf(\"%s\\n\", line)\n                results &lt;- len(strings.Split(line, \" \"))\n            }\n            wg.Done()\n        }()\n    }\n\n    go func() {\n        for scanner.Scan() {\n            lines &lt;- scanner.Text()\n        }\n        close(lines)\n        wg.Wait()\n        close(results)\n    }()\n\n    acc := 0\n    for i := range results {\n        acc += i\n    }\n\n    fmt.Printf(\"%d\\n\", acc)\n}\n</code></pre>\n"}], "owner": {"reputation": 2925, "user_id": 660675, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8qJ6x.jpg?s=128&g=1", "display_name": "resilva87", "link": "https://stackoverflow.com/users/660675/resilva87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2374, "favorite_count": 1, "accepted_answer_id": 32836094, "answer_count": 2, "score": 2, "last_activity_date": 1572426805, "creation_date": 1443477952, "question_id": 32832565, "link": "https://stackoverflow.com/questions/32832565/goroutines-channels-and-deadlock", "title": "Goroutines, Channels and Deadlock", "body": "<p>I'm trying to understand more about go's channels and goroutines, so I decided to make a little program that count words from a file, read by a <code>bufio.NewScanner</code> object:</p>\n\n<pre><code>nCPUs := flag.Int(\"cpu\", 2, \"number of CPUs to use\")\nflag.Parse()\nruntime.GOMAXPROCS(*nCPUs)    \n\nscanner := bufio.NewScanner(file)\nlines := make(chan string)\nresults := make(chan int)\n\nfor i := 0; i &lt; *nCPUs; i++ {\n    go func() {\n        for line := range lines {\n            fmt.Printf(\"%s\\n\", line)\n            results &lt;- len(strings.Split(line, \" \"))\n        }\n    }()\n}\n\nfor scanner.Scan(){\n    lines &lt;- scanner.Text()\n}\nclose(lines)\n\n\nacc := 0\nfor i := range results {\n      acc += i\n }\n\nfmt.Printf(\"%d\\n\", acc)\n</code></pre>\n\n<p>Now, in most examples I've found so far both the <code>lines</code> and <code>results</code> channels would be buffered, such as <code>make(chan int, NUMBER_OF_LINES_IN_FILE)</code>. Still, after running this code, my program exists with a <code>fatal error: all goroutines are asleep - deadlock!</code> error message.</p>\n\n<p>Basically my thought it's that I need two channels: one to communicate to the goroutine the lines from the file (as it can be of any size, I don't like to think that I need to inform the size in the <code>make(chan)</code> function call. The other channel would collect the results from the goroutine and in the main function I would use it to e.g. calculate an accumulated result. </p>\n\n<p>What should be the best option to program in this manner with goroutines and channels? Any help is much appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1443474430, "post_id": 32831774, "comment_id": 53499463, "body": "These are implementation details of the GC and runtime, which aren&#39;t accessible in the language itself. If you&#39;re asking our of curiosity about how this specific version of the runtime works, that&#39;s one thing, but it&#39;s of no consequence to any user written code."}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443474574, "post_id": 32831774, "comment_id": 53499540, "body": "@JimB, I am trying to understand the threading library implementation in Go (that is, the details of how goroutines are implemented and scheduled), and this appears to be at least tangentially related to the GC behavior and safe points. You are correct, this has nothing to do with usage of the language."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1443475328, "post_id": 32831774, "comment_id": 53499897, "body": "I&#39;m not up to date on the current runtime, but this being closely tied to the GC, <a href=\"http://talks.golang.org/2015/go-gc.pdf\" rel=\"nofollow noreferrer\">this talk</a> may be of interest to you, with <a href=\"https://www.youtube.com/watch?v=aiv1JOfMjm0\" rel=\"nofollow noreferrer\">video</a>."}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443475627, "post_id": 32831774, "comment_id": 53500014, "body": "@JimB, Thanks! Will take a look."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1443481123, "post_id": 32831774, "comment_id": 53501983, "body": "If you <a href=\"https://github.com/golang/go/search?utf8=%E2%9C%93&amp;q=runSafePointFn&amp;type=Code\" rel=\"nofollow noreferrer\">search for runSafePointFn</a>, you&#39;ll find this key comment: &quot;Any P entering _Pidle or _Psyscall from now on will observe p.runSafePointFn == 1 and will call runSafePointFn when changing its status to _Pidle/_Psyscall.&quot;. You&#39;ll see that <code>reentersyscall</code>, called by <code>entersyscall</code>, sets the P&#39;s status to <code>_Psyscall</code> after checking <code>runSafePointFn</code>."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1443481380, "post_id": 32831774, "comment_id": 53502054, "body": "So, following the breadcrumbs, system calls and other things that leave goroutines idle (sync/channel operations) can lead to a GC safepoint. Also heard the function prelude responsible for growing the stack as needed (<code>morestack</code>) can sometimes lead to switching goroutines in recent versions of Go; I don&#39;t know, but maybe that can lead to a safepoint as well."}], "answers": [{"tags": [], "owner": {"reputation": 924, "user_id": 4199833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9tBnh.png?s=128&g=1", "display_name": "rudolph1024", "link": "https://stackoverflow.com/users/4199833/rudolph1024"}, "is_accepted": false, "score": 3, "last_activity_date": 1488668043, "last_edit_date": 1495542313, "creation_date": 1488667295, "answer_id": 42602236, "question_id": 32831774, "link": "https://stackoverflow.com/questions/32831774/what-are-safe-point-functions-as-alluded-to-in-the-go-source-code/42602236#42602236", "title": "What are &quot;safe point functions&quot; as alluded to in the Go source code?", "body": "<p>Here is everything I could dig up on this topic. </p>\n\n<p>I found some discussion about Go's GC safepoints <a href=\"https://news.ycombinator.com/item?id=12822071\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>It looks like safe points (as used in the Go implementation) are effectively the same as the traditional definition of a safe point:  </p>\n\n<blockquote>\n  <p>key points where the GC can track what all variables and registers\n  hold</p>\n</blockquote>\n\n<p>Another user on the same thread mentions that the GC </p>\n\n<blockquote>\n  <p>folds the preemption points into the stack checks during function\n  prologs</p>\n</blockquote>\n\n<p>and that the source for this claim is the following: <a href=\"https://github.com/golang/go/issues/10958\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/10958</a></p>\n\n<p>According to <a href=\"https://groups.google.com/d/msg/golang-dev/L8Iap9EuW9A/GLHA-NnUn0QJ\" rel=\"nofollow noreferrer\">this post</a> on the golang-dev mailing list, safepoints are also called \"call sites\".</p>\n\n<p>To gain some insight into the nature of Go's safepoints, I think it's important to look at the evolution of its GC. <a href=\"https://stackoverflow.com/a/29087165/4199833\">This post</a>  mentions the following: </p>\n\n<blockquote>\n  <p>Prior to Go 1.5, Go has used a parallel stop-the-world (STW)\n  collector.</p>\n  \n  <p>Go 1.5 introduces a concurrent collector.</p>\n</blockquote>\n\n<p>Another answer to that question mentions: </p>\n\n<blockquote>\n  <p>As of Go 1.7, the one remaining source of unbounded and potentially\n  non-trivial stop-the-world (STW) time is stack re-scanning.</p>\n</blockquote>\n\n<p>As of 1.8, it looks like <a href=\"https://groups.google.com/forum/#!topic/golang-dev/Ab1sFeoZg_8\" rel=\"nofollow noreferrer\">worst-case stop-the-world times have been improved</a>.</p>\n\n<p>Also, <a href=\"https://github.com/golang/go/blob/master/src/runtime/mgc.go\" rel=\"nofollow noreferrer\">here</a> is the current implementation of Go's garbage collector. If you read through the comments, you'll see that it is a non-generational mark-sweep collector. You can read more about this here: <a href=\"https://blog.plan99.net/modern-garbage-collection-911ef4f8bd8e#.udz1kjk3b\" rel=\"nofollow noreferrer\">https://blog.plan99.net/modern-garbage-collection-911ef4f8bd8e#.udz1kjk3b</a></p>\n\n<p>Finally, <a href=\"https://groups.google.com/forum/#!searchin/golang-dev/safepoint%7Csort:relevance/golang-dev/GvA0DaCI2BU/SmEelQsFybkJ\" rel=\"nofollow noreferrer\">here</a> is an old post by Gil Tene on the golang-dev mailing list which motivates the use of a moving garbage collector. He claimed (at the time in 2012) that Go was using a \"conservative, non-relocating collector\" and he discussed the characteristics of safepoints which would permit a long-running garbage collector.</p>\n\n<p>While Go's garbage collector has been <a href=\"https://blog.golang.org/go15gc\" rel=\"nofollow noreferrer\">moving away from long pauses</a> and is now a \"concurrent, tri-color, mark-sweep collector\", it's still a non-generational GC. It also looks like Go's GC is building on GC ideas from the 70s rather than modern, enterprise approaches.</p>\n\n<p>It looks like Go's notion of a safepoint is more in line with the traditional notion of a safepoint rather than a safepoint with modern qualities which permit generational garbage collection.</p>\n"}], "owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 3, "answer_count": 1, "score": 12, "last_activity_date": 1502356246, "creation_date": 1443474113, "last_edit_date": 1502356246, "question_id": 32831774, "link": "https://stackoverflow.com/questions/32831774/what-are-safe-point-functions-as-alluded-to-in-the-go-source-code", "title": "What are &quot;safe point functions&quot; as alluded to in the Go source code?", "body": "<p>In the file <a href=\"https://golang.org/src/runtime/proc.go#L1286\" rel=\"nofollow noreferrer\"><code>runtime/proc.go</code></a> of the <a href=\"https://golang.org/src/\" rel=\"nofollow noreferrer\">Go source code</a>, there are many comments referring to <strong>safe point functions</strong>, which appear to be related to points in time where it is safe to garbage collect. However, I could not find any definitions of these functions.</p>\n\n<p>What are <strong>safe point functions</strong>, what are they used for, and what are some examples of such functions?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1443466164, "post_id": 32829538, "comment_id": 53495375, "body": "Related: <a href=\"http://stackoverflow.com/questions/31650965/what-does-lexical-file-name-order-mean\">What does lexical file name order mean?</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443466644, "post_id": 32829538, "comment_id": 53495612, "body": "Though the spec says the build system is &quot;encouraged&quot; to provide filenames in lexical order, it&#39;s not mandatory. If your files are in a single package, it seems fairly easy to enforce an absolute order to ensure consistent behavior."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 8, "creation_date": 1443467501, "post_id": 32829593, "comment_id": 53496014, "body": "I&#39;d say for that safe bet to be really safe, each file should provide a function named like <code>initA()</code>, <code>initB()</code> etc and one of those files should call them all in a well-defined sequence in its <code>init()</code>.  As an added bonus, and an important one, that would provide a clear hint to the reader."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1443472507, "post_id": 32829593, "comment_id": 53498516, "body": "Or better, if you have initialization that is order dependant, make those dependencies explicit. E.g. if you have <code>var a = fn()</code> in one file and <code>var fn = func() int { return 42 }</code> in another then the <code>fn</code> will always be initialized first; <a href=\"https://play.golang.org/p/W6UdA_6gSa\" rel=\"nofollow noreferrer\">play.golang.org/p/W6UdA_6gSa</a> (in other words it may make sense to rename one of the <code>init</code> functions and call it from another where needed)."}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1588388925, "post_id": 32829593, "comment_id": 108882955, "body": "It might be worth saying that the order of the <code>var</code> lines in <a href=\"https://play.golang.org/p/W6UdA_6gSa\" rel=\"nofollow noreferrer\">play.golang.org/p/W6UdA_6gSa</a> does matter if they were located within the <code>function main()</code> block"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 9, "last_activity_date": 1443465263, "creation_date": 1443465263, "answer_id": 32829593, "question_id": 32829538, "link": "https://stackoverflow.com/questions/32829538/init-order-within-a-package/32829593#32829593", "title": "Init order within a package", "body": "<p>The order that the respective filenames were passed to the Go compiler.</p>\n\n<p>The <a href=\"https://golang.org/ref/spec#Package_initialization\" rel=\"noreferrer\">Go spec</a> says \"build systems are encouraged to present multiple files belonging to the same package in lexical file name order to a compiler\" so it's a safe bet that <code>go build</code> does exactly that, and the inits will run in A-B-C order.</p>\n"}], "owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3435, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1562051366, "creation_date": 1443465035, "last_edit_date": 1562051366, "question_id": 32829538, "link": "https://stackoverflow.com/questions/32829538/init-order-within-a-package", "title": "Init order within a package", "body": "<p>I have files:</p>\n\n<pre><code>main/\n    a.go\n    b.go\n    c.go\n</code></pre>\n\n<p>a.go:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc init(){\n    fmt.Println(\"a\")\n}\n\nfunc main(){}\n</code></pre>\n\n<p>b.go:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc init(){\n    fmt.Println(\"b\")\n}\n</code></pre>\n\n<p>c.go:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc init(){\n    fmt.Println(\"c\")\n}\n</code></pre>\n\n<p>In what order will the strings be outputted?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1443458164, "post_id": 32825640, "comment_id": 53491201, "body": "From <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>: &quot;If it is possible to create a live example of the problem that you can link to (for example, on <a href=\"http://play.golang.org/\" rel=\"nofollow noreferrer\">play.golang.org</a>) then do so - but <b>also include the code in your question itself</b>. Not everyone can access external sites, and the links may break over time.&quot; In this case if the gist goes away this question becomes useless/meaningless. The help center also describes creating a <a href=\"http://stackoverflow.com/help/mcve\"><b>Minimal</b>, Complete, and Verifiable Example</a>, here I emphasis minimal."}], "answers": [{"comments": [{"owner": {"reputation": 283, "user_id": 1346779, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Q2FaG.jpg?s=128&g=1", "display_name": "Douglas Fils", "link": "https://stackoverflow.com/users/1346779/douglas-fils"}, "edited": false, "score": 0, "creation_date": 1443452662, "post_id": 32826026, "comment_id": 53487899, "body": "Thanks..  I see the github issue response I got was correct all the time, I just didn&#39;t follow it properly.   I appreciate your help.  I ran it and it&#39;s all working well now!"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1443452130, "creation_date": 1443452130, "answer_id": 32826026, "question_id": 32825640, "link": "https://stackoverflow.com/questions/32825640/custom-marshaltext-for-golang-sql-null-types/32826026#32826026", "title": "custom MarshalText() for golang sql.NULL* types", "body": "<p>Your <code>NullFloat64</code> is not an <code>encoding.TextMarshaler</code>. See <a href=\"http://play.golang.org/p/AepGgQkOd7\" rel=\"nofollow\">http://play.golang.org/p/AepGgQkOd7</a>:</p>\n\n<pre><code>prog.go:25: cannot use NullFloat64 literal (type NullFloat64) as type encoding.TextMarshaler in assignment:\n    NullFloat64 does not implement encoding.TextMarshaler (wrong type for MarshalText method)\n        have MarshalText() []byte\n        want MarshalText() ([]byte, error)\n</code></pre>\n\n<p>Change your method to</p>\n\n<pre><code>func (nf NullFloat64) MarshalText() ([]byte, error) {\n    if nf.Valid {\n        nfv := nf.Float64\n        return []byte(strconv.FormatFloat(nfv, 'f', -1, 64)), nil\n    } else {\n        return []byte(\"null\"), nil\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 283, "user_id": 1346779, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Q2FaG.jpg?s=128&g=1", "display_name": "Douglas Fils", "link": "https://stackoverflow.com/users/1346779/douglas-fils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 32826026, "answer_count": 1, "score": -1, "last_activity_date": 1443452130, "creation_date": 1443450877, "question_id": 32825640, "link": "https://stackoverflow.com/questions/32825640/custom-marshaltext-for-golang-sql-null-types", "title": "custom MarshalText() for golang sql.NULL* types", "body": "<p>I am trying to marshal SQL results into JSON in code that is using SQL.NullFloat64 and the <a href=\"https://github.com/kisielk/sqlstruct\" rel=\"nofollow\">https://github.com/kisielk/sqlstruct</a> package.  </p>\n\n<p>Ref: <a href=\"https://github.com/kisielk/sqlstruct/issues/11#issuecomment-143400458\" rel=\"nofollow\">https://github.com/kisielk/sqlstruct/issues/11#issuecomment-143400458</a></p>\n\n<p>This issue is I am getting the </p>\n\n<pre><code>{\n    \"Float64\": 141,\n    \"Valid\": true\n}\n</code></pre>\n\n<p>result in the JSON not just the value.   Following the advice in the github issue above I tried to make a custom MarshalText() but it never gets called.  </p>\n\n<p>The code is at: <a href=\"https://gist.github.com/fils/3f557941d71f1a7165ca\" rel=\"nofollow\">https://gist.github.com/fils/3f557941d71f1a7165ca</a> </p>\n\n<p>The JSON produced is at: <a href=\"https://gist.github.com/fils/a01cadcbb5dc7c797c3e\" rel=\"nofollow\">https://gist.github.com/fils/a01cadcbb5dc7c797c3e</a></p>\n\n<p>The CSV dump function is obtaining and outputting the value only ok, but not sure how to get that effect for the JSON one too.</p>\n\n<p>Using either sql.NullFloat64 or the custom type NullFloat64 give the same results.  </p>\n"}, {"tags": ["selenium", "selenium-webdriver", "go"], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 3, "last_activity_date": 1444917749, "creation_date": 1444917749, "answer_id": 33150619, "question_id": 32823643, "link": "https://stackoverflow.com/questions/32823643/selenium-golang-binding-without-server/33150619#33150619", "title": "Selenium Golang binding without server", "body": "<p>You can try <a href=\"https://github.com/fedesog/webdriver\" rel=\"nofollow\">github.com/fedesog/webdriver</a> which says in its documentation:</p>\n\n<blockquote>\n  <p>This is a pure go library and doesn't require a running Selenium driver.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5830126, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AH6Dgx-_NSk/AAAAAAAAAAI/AAAAAAAABwU/Y2oh2BV3ZVY/photo.jpg?sz=128", "display_name": "Keith Stiern", "link": "https://stackoverflow.com/users/5830126/keith-stiern"}, "is_accepted": false, "score": 0, "last_activity_date": 1538915555, "creation_date": 1538915555, "answer_id": 52688515, "question_id": 32823643, "link": "https://stackoverflow.com/questions/32823643/selenium-golang-binding-without-server/52688515#52688515", "title": "Selenium Golang binding without server", "body": "<p>I would characterize the Selenium webdriver as a client rather than a server. Caveat: I have used the Selenium webdriver (Chrome version) from .Net and I am assuming it is similar for Go.</p>\n\n<p>The way Selenium works is that you will launch an instance of it from within code, and it creates a live version of the selected browser (i.e. Chrome) and your program retains control over it. Then you write code to tell the browser to navigate to a page, inspect the response, and interact with the browser by filling out form data, clicking on buttons, etc. You can see what is happening on the browser as the code runs, so it is easy to troubleshoot when the interaction doesn't go as planned.</p>\n\n<p>I have used Selenium to upload tens of thousands of records to a website that has no API and only a graphical user interface. Give it a chance.</p>\n"}], "owner": {"reputation": 2634, "user_id": 5138909, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/qBvCy.png?s=128&g=1", "display_name": "KiYugadgeter", "link": "https://stackoverflow.com/users/5138909/kiyugadgeter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1898, "favorite_count": 0, "accepted_answer_id": 33150619, "answer_count": 2, "score": 7, "last_activity_date": 1538915555, "creation_date": 1443445237, "question_id": 32823643, "link": "https://stackoverflow.com/questions/32823643/selenium-golang-binding-without-server", "title": "Selenium Golang binding without server", "body": "<p>There are many selenium webdriver binding package of Golang.\nHowever, I don't want to control browser throught server.</p>\n\n<p>How can I control browser with Golang and selenium without selenium server?</p>\n"}, {"tags": ["variables", "go", "return-value", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1443432638, "last_edit_date": 1443432638, "creation_date": 1443430501, "answer_id": 32819086, "question_id": 32818994, "link": "https://stackoverflow.com/questions/32818994/different-behavior-of-variable-and-return-value-of-function/32819086#32819086", "title": "Different behavior of variable and return value of function", "body": "<p>You get an error message in the 2nd case because you try to slice the return value of a function call (that of <code>sha1.Sum()</code>):</p>\n\n<pre><code>sha1.Sum(([]byte)(uf.Pwd))[:]\n</code></pre>\n\n<p>The return values of function calls are not addressable. As a reminder, (only) the following are addressable (taken from <a href=\"https://golang.org/ref/spec#Address_operators\">Spec: Address operators</a>):</p>\n\n<blockquote>\n  <p>...a variable, pointer indirection, or slice indexing operation; or a field selector of an addressable struct operand; or an array indexing operation of an addressable array. As an exception to the addressability requirement, <code>x</code> may also be a (possibly parenthesized) <a href=\"https://golang.org/ref/spec#Composite_literals\">composite literal</a>.</p>\n</blockquote>\n\n<p>And slicing an array requires the array to be addressable. <a href=\"https://golang.org/ref/spec#Slice_expressions\">Spec: Slice expressions:</a></p>\n\n<blockquote>\n  <p>If the sliced operand is an array, it must be <a href=\"https://golang.org/ref/spec#Address_operators\">addressable</a> and the result of the slice operation is a slice with the same element type as the array.</p>\n</blockquote>\n\n<p>Your first case works because you first store the returned array in a local variable which is addressable.</p>\n\n<p>Slicing an array requires the array to be addressable because slicing results in a slice which will not copy the data of the array but create a slice which shares the backing array and will only point/refer to it.</p>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 32819086, "answer_count": 1, "score": 4, "last_activity_date": 1443435057, "creation_date": 1443430176, "last_edit_date": 1443435057, "question_id": 32818994, "link": "https://stackoverflow.com/questions/32818994/different-behavior-of-variable-and-return-value-of-function", "title": "Different behavior of variable and return value of function", "body": "<p>I want to join two lines, but I get an error message.</p>\n\n<p>Original:</p>\n\n<pre><code>hash := sha1.Sum([]byte(uf.Pwd))\nu.Pwhash = hex.EncodeToString(hash[:])\n</code></pre>\n\n<p>Joint:</p>\n\n<pre><code>u.Pwhash = hex.EncodeToString(sha1.Sum([]byte(uf.Pwd))[:])\n</code></pre>\n\n<p>The first one works fine, the second produces the error message:</p>\n\n<pre><code>models/models.go:104: invalid operation sha1.Sum(([]byte)(uf.Pwd))[:] (slice of unaddressable value)\n</code></pre>\n\n<p>Why is that?</p>\n"}, {"tags": ["python", "go"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5383797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0a34a9ab20714f5e315cfb58ce1c96?s=128&d=identicon&r=PG&f=1", "display_name": "Sagheer", "link": "https://stackoverflow.com/users/5383797/sagheer"}, "edited": false, "score": 0, "creation_date": 1443503848, "post_id": 32818864, "comment_id": 53507712, "body": "to run the command with root privileges, in python we give run_as_root=True. Is it same in golang as well?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 41, "user_id": 5383797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0a34a9ab20714f5e315cfb58ce1c96?s=128&d=identicon&r=PG&f=1", "display_name": "Sagheer", "link": "https://stackoverflow.com/users/5383797/sagheer"}, "edited": false, "score": 0, "creation_date": 1443504193, "post_id": 32818864, "comment_id": 53507821, "body": "@Sagheer you would need for instance a process supervisor (<a href=\"http://stackoverflow.com/a/30950683/6309\">stackoverflow.com/a/30950683/6309</a>) or use <code>su root -c &quot;...&quot;</code> (<a href=\"http://stackoverflow.com/a/30942527/6309\">stackoverflow.com/a/30942527/6309</a>)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1443429664, "creation_date": 1443429664, "answer_id": 32818864, "question_id": 32818593, "link": "https://stackoverflow.com/questions/32818593/equivalent-of-pythons-utils-execute-in-golang/32818864#32818864", "title": "Equivalent of python&#39;s utils.execute() in golang", "body": "<p>You can check golang <a href=\"https://golang.org/pkg/os/exec/#Command\" rel=\"nofollow\"><code>exec.Command</code></a>, as in <a href=\"https://github.com/golang/go/blob/master/src/os/exec/example_test.go#L24-L34\" rel=\"nofollow\"><code>os/exec/example_test.go</code></a></p>\n\n<pre><code>func ExampleCommand() {\n    cmd := exec.Command(\"tr\", \"a-z\", \"A-Z\")\n    cmd.Stdin = strings.NewReader(\"some input\")\n    var out bytes.Buffer\n    cmd.Stdout = &amp;out\n    err := cmd.Run()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"in all caps: %q\\n\", out.String())\n}\n</code></pre>\n\n<p>First parameter is the command you want to execute, the rest are the parameters.</p>\n\n<pre><code>func Command(name string, arg ...string) *Cmd\n</code></pre>\n\n<p>In that same <a href=\"https://github.com/golang/go/blob/master/src/os/exec/example_test.go\" rel=\"nofollow\"><code>os/exec/example_test.go</code></a>, you will find examples on how to read the output, start a command or even do a pipe.</p>\n"}], "owner": {"reputation": 41, "user_id": 5383797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b0a34a9ab20714f5e315cfb58ce1c96?s=128&d=identicon&r=PG&f=1", "display_name": "Sagheer", "link": "https://stackoverflow.com/users/5383797/sagheer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 1, "accepted_answer_id": 32818864, "answer_count": 1, "score": 3, "last_activity_date": 1443429702, "creation_date": 1443428623, "last_edit_date": 1443429702, "question_id": 32818593, "link": "https://stackoverflow.com/questions/32818593/equivalent-of-pythons-utils-execute-in-golang", "title": "Equivalent of python&#39;s utils.execute() in golang", "body": "<p>I am newbie to golang and am currently working with binaries in python with utils.execute(). I have to convert the code to golang, what's the equivalent to it in go?</p>\n"}, {"tags": ["http", "go", "error-handling", "deferred"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1443437490, "post_id": 32819910, "comment_id": 53477908, "body": "If you ever get a response body that requires closing on an error, that&#39;s a bug that needs to be filed. In this case you should have an empty noop closer for the body that is only there to make closing not panic."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443437845, "post_id": 32819910, "comment_id": 53478113, "body": "@JimB That&#39;s what I thought too. Thanks for confirmation. Will edit the answer."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1443450701, "post_id": 32819910, "comment_id": 53486642, "body": "I went and double checked the client code, and in the single case where a redirect error returns a Response, the Body has already been closed, and the connection released. Though it doesn&#39;t hurt, there should never be a need to <code>defer resp.Body.Close()</code> after a client error."}, {"owner": {"reputation": 16513, "user_id": 95642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/36cf75fa7751ef674df65ab65cecd255?s=128&d=identicon&r=PG", "display_name": "Drew LeSueur", "link": "https://stackoverflow.com/users/95642/drew-lesueur"}, "edited": false, "score": 0, "creation_date": 1463672163, "post_id": 32819910, "comment_id": 62174921, "body": "It&#39;s kind of sad that there is that one special case."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 16513, "user_id": 95642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/36cf75fa7751ef674df65ab65cecd255?s=128&d=identicon&r=PG", "display_name": "Drew LeSueur", "link": "https://stackoverflow.com/users/95642/drew-lesueur"}, "edited": false, "score": 1, "creation_date": 1463673235, "post_id": 32819910, "comment_id": 62175731, "body": "@DrewLeSueur I wouldn&#39;t say it&#39;s sad: you are not required to close the response in that one special case either (if <code>err</code> is non-<code>nil</code>)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 19, "last_activity_date": 1522291431, "last_edit_date": 1522291431, "creation_date": 1443433246, "answer_id": 32819910, "question_id": 32818472, "link": "https://stackoverflow.com/questions/32818472/do-we-need-to-close-the-response-object-if-an-error-occurs-while-calling-http-ge/32819910#32819910", "title": "Do we need to close the response object if an error occurs while calling http.Get(url)?", "body": "<p>General concept is that when a function (or method) has multi return values one being an <code>error</code>, error should be checked first and only proceed if the error is <code>nil</code>. Functions should return zero values for other (non-error) values if there is an <code>error</code>. If the function behaves differently, it should be documented. <a href=\"https://golang.org/pkg/net/http/#Get\" rel=\"noreferrer\"><code>http.Get()</code></a> does not document such deviation.</p>\n\n<p>So it should be handled like this:</p>\n\n<pre><code>res, err := http.Get(url)\nif err != nil {\n    log.Printf(\"Error: %s\\n\", err)\n    return\n}\n\ndefer res.Body.Close()\n// Read/work with body\n</code></pre>\n\n<hr>\n\n<p><strong>Notes:</strong></p>\n\n<p>As JimB confirms too, if a non-<code>nil</code> error is returned, even if the response is non-<code>nil</code>, we don't have to close it. In case of a redirection error the non-<code>nil</code> response may hold context and further information about where following the redirect failed. See details below:</p>\n\n<p><code>http.Get()</code> honors the general concept \"most of the time\": it returns <code>nil</code> response if there is an error:</p>\n\n<pre><code>return nil, someError\n</code></pre>\n\n<p>However checking <a href=\"https://golang.org/src/net/http/client.go\" rel=\"noreferrer\"><code>client.go</code></a>, unexported method <code>Client.doFollowingRedirects()</code>, currently line #427:</p>\n\n<pre><code>if redirectFailed {\n    // Special case for Go 1 compatibility: return both the response\n    // and an error if the CheckRedirect function failed.\n    // See https://golang.org/issue/3795\n    return resp, urlErr\n}\n</code></pre>\n\n<p>So due to a backward compatibility issue it may return a non-<code>nil</code> response and a non-<code>nil</code> error at the same time, if redirection fails.</p>\n\n<p>On the other hand trying to call <code>resp.Body.Close()</code> if <code>resp</code> is <code>nil</code> will cause a run-time panic.</p>\n\n<p>So if we want to close response body in this case, it could look like this (can only be closed if <code>resp</code> is not <code>nil</code>):</p>\n\n<pre><code>res, err := http.Get(url)\nif err != nil {\n    log.Printf(\"Error: %s\\n\", err)\n}\nif res != nil {\n    defer res.Body.Close()\n    // Read/work with body\n}\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>res, err := http.Get(url)\nif err != nil {\n    log.Printf(\"Error: %s\\n\", err)\n}\nif res == nil {\n    return\n}\n\ndefer res.Body.Close()\n// Read/work with body\n</code></pre>\n\n<p>The doc of <a href=\"https://golang.org/pkg/net/http/#Response\" rel=\"noreferrer\"><code>http.Response</code></a> guarantees that <code>Response.Body</code> will not be <code>nil</code> even if there is no response data:</p>\n\n<pre><code>// The http Client and Transport guarantee that Body is always\n// non-nil, even on responses without a body or responses with\n// a zero-length body.\n</code></pre>\n\n<p><strong>But</strong> if the error is not <code>nil</code>, you don't have to close the non-<code>nil</code> response body.</p>\n"}], "owner": {"reputation": 2803, "user_id": 3186914, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/kkIb4.jpg?s=128&g=1", "display_name": "Prashant", "link": "https://stackoverflow.com/users/3186914/prashant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2799, "favorite_count": 4, "accepted_answer_id": 32819910, "answer_count": 1, "score": 14, "last_activity_date": 1522291431, "creation_date": 1443428242, "last_edit_date": 1472807316, "question_id": 32818472, "link": "https://stackoverflow.com/questions/32818472/do-we-need-to-close-the-response-object-if-an-error-occurs-while-calling-http-ge", "title": "Do we need to close the response object if an error occurs while calling http.Get(url)?", "body": "<p>In the following code is it also necessary to close the response body in the error case:</p>\n\n<pre><code>res, err := http.Get(url)\n\nif err != nil {\n    log.Printf(\"Error: %s\\n\", err)\n}\n\ndefer res.Body.Close()\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 993, "user_id": 1238748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5c0360a6c4fbf91bd6d7ef647e5cbc?s=128&d=identicon&r=PG", "display_name": "martinhans", "link": "https://stackoverflow.com/users/1238748/martinhans"}, "is_accepted": false, "score": 2, "last_activity_date": 1443429159, "creation_date": 1443429159, "answer_id": 32818741, "question_id": 32818116, "link": "https://stackoverflow.com/questions/32818116/how-to-get-executing-codes-files-name-in-go/32818741#32818741", "title": "How to get executing code&#39;s file&#39;s name in go?", "body": "<p>The name of the command can be found in <code>os.Args[0]</code> as states in the documentation for <a href=\"https://golang.org/pkg/os/#pkg-variables\" rel=\"nofollow\">the os package</a>:</p>\n\n<blockquote>\n  <p><code>var Args []string</code></p>\n  \n  <p>Args hold the command-line arguments, starting with the program name.</p>\n</blockquote>\n\n<p>To use it, do the following:</p>\n\n<pre><code>package main\n\nimport \"os\"\n\nfunc main(){\n    filename := os.Args[0]\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 5384158, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f58f8847de921800f97bb057175bc3cb?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/5384158/plusmid"}, "edited": false, "score": 0, "creation_date": 1443433849, "post_id": 32820072, "comment_id": 53475834, "body": "<a href=\"http://play.golang.org/p/3T8fr_Hist\" rel=\"nofollow noreferrer\">play.golang.org/p/3T8fr_Hist</a>"}], "tags": [], "owner": {"reputation": 151, "user_id": 5384158, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f58f8847de921800f97bb057175bc3cb?s=128&d=identicon&r=PG", "display_name": "plusmid", "link": "https://stackoverflow.com/users/5384158/plusmid"}, "is_accepted": false, "score": 2, "last_activity_date": 1443433776, "creation_date": 1443433776, "answer_id": 32820072, "question_id": 32818116, "link": "https://stackoverflow.com/questions/32818116/how-to-get-executing-codes-files-name-in-go/32820072#32820072", "title": "How to get executing code&#39;s file&#39;s name in go?", "body": "<p>This should work for you:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"runtime\"\n)\n\nfunc main() {\n  _, fileName, lineNum, _ := runtime.Caller(0)\n  fmt.Printf(\"%s: %d\\n\", fileName, lineNum)\n}\n</code></pre>\n"}], "owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "closed_date": 1443444757, "answer_count": 2, "score": 4, "last_activity_date": 1443433776, "creation_date": 1443426806, "question_id": 32818116, "link": "https://stackoverflow.com/questions/32818116/how-to-get-executing-codes-files-name-in-go", "closed_reason": "Duplicate", "title": "How to get executing code&#39;s file&#39;s name in go?", "body": "<p>Say I have a file:</p>\n\n<p>i_want_this_name.go:</p>\n\n<pre><code>package main\n\nfunc main(){\n    filename := some_func() // should be \"i_want_this_name\"\n}\n</code></pre>\n\n<p>How do I get the executing code's file's name in go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 0, "creation_date": 1443425968, "post_id": 32817327, "comment_id": 53471732, "body": "I don&#39;t know why this is behaving like this but when i changed the type of nested map from m[string]map[int]float64 to map[string]map[string]string it worked for me. Could someone please explain me why ?"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1443434269, "post_id": 32817327, "comment_id": 53476061, "body": "Unrelated, you should return <code>nestedMap</code> from <code>GetStockValue()</code> than changing the value of of <code>reply</code> which is a global variable (bad practice)."}], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 1, "last_activity_date": 1443489682, "creation_date": 1443489682, "answer_id": 32834195, "question_id": 32817327, "link": "https://stackoverflow.com/questions/32817327/how-to-send-a-nested-map-from-server-to-client-using-jsonrpc-package-in-golang/32834195#32834195", "title": "How to send a nested map from server to client using jsonrpc package in golang?", "body": "<p><code>jsonrpc</code> is <code>json rpc</code> because it use <code>json</code> for serialization. to Marshal a map to <code>json</code>, you need <code>string</code> key type. refer to <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\">encoding/json</a></p>\n"}, {"tags": [], "owner": {"reputation": 436, "user_id": 478309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e42cd135cba45a460dbad590bf110a8?s=128&d=identicon&r=PG", "display_name": "Lei Cao", "link": "https://stackoverflow.com/users/478309/lei-cao"}, "is_accepted": false, "score": 0, "last_activity_date": 1443547308, "creation_date": 1443547308, "answer_id": 32850095, "question_id": 32817327, "link": "https://stackoverflow.com/questions/32817327/how-to-send-a-nested-map-from-server-to-client-using-jsonrpc-package-in-golang/32850095#32850095", "title": "How to send a nested map from server to client using jsonrpc package in golang?", "body": "<p>If you print out your <code>err</code> here <code>err = c.Call(\"JSONResponse.GetStockValue\", args, &amp;reply)</code> you should see the reason <code>invalid character '' looking for beginning of object key string.</code></p>\n\n<p>The <a href=\"http://json.org/\" rel=\"nofollow\">JSON spec</a> says the object's key needs to be <code>string</code>.</p>\n\n<p>Or if you JSON is using <code>string</code>, then <code>json: cannot unmarshal object into Go value of type map[int]float64</code></p>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1443547308, "creation_date": 1443423692, "last_edit_date": 1443424200, "question_id": 32817327, "link": "https://stackoverflow.com/questions/32817327/how-to-send-a-nested-map-from-server-to-client-using-jsonrpc-package-in-golang", "title": "How to send a nested map from server to client using jsonrpc package in golang?", "body": "<p>I am writing a client server go application which uses yahoo finance api to fetch the real time stock price. I am using jsonrpc package to connect client and server.\nI am unable to pass a nested map response from server to client. Here is my small snippet from the client file.  client.go file</p>\n\n<pre><code>var (\n        reply map[string]map[int]float64\n    )\n\n    c := jsonrpc.NewClient(client)\n    err = c.Call(\"JSONResponse.GetStockValue\", args, &amp;reply)\n    fmt.Println(reply)\n</code></pre>\n\n<p>Server file looks like this:</p>\n\n<pre><code>func (j *JSONResponse) GetStockValue(args *ClientRequest, reply *map[string]map[int]float64) error {\n some piece of code......\n nestedMap := make(map[string]map[int]float64)\n add some values in nested map .....\n fmt.Println(nestedMap)\n *reply = nestedMap\n  return nil\n}\n</code></pre>\n\n<p>This does not send any response to the client. When i change the nested map to simple map like map[string]int, it correctly works. The nested map is correctly displayed at server but does not get displayed on the client side. The client simply keeps on waiting for the response from the server. It would be very helpful if someone could guide me on why it is not accepting a nested map and working fine for a simple map ?</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["algorithm", "go", "binary-tree", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 11, "user_id": 3423120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xAN97.gif?s=128&g=1", "display_name": "Khiem", "link": "https://stackoverflow.com/users/3423120/khiem"}, "reply_to_user": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 0, "creation_date": 1443423311, "post_id": 32817106, "comment_id": 53470436, "body": "@Henry Sorry my bad, edited"}, {"owner": {"reputation": 12311, "user_id": 2095090, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3vmqn.jpg?s=128&g=1", "display_name": "Vincent van der Weele", "link": "https://stackoverflow.com/users/2095090/vincent-van-der-weele"}, "edited": false, "score": 3, "creation_date": 1443423474, "post_id": 32817106, "comment_id": 53470514, "body": "Have a look at the <a href=\"https://en.wikipedia.org/wiki/Shunting-yard_algorithm\" rel=\"nofollow noreferrer\">Shunting-yard algorithm</a>"}, {"owner": {"reputation": 47294, "user_id": 3885376, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XgeJ5.png?s=128&g=1", "display_name": "ROMANIA_engineer", "link": "https://stackoverflow.com/users/3885376/romania-engineer"}, "edited": false, "score": 1, "creation_date": 1443423516, "post_id": 32817106, "comment_id": 53470534, "body": "See <a href=\"http://www.cs.nyu.edu/courses/fall09/V22.0102-002/lectures/InfixToPostfixExamples.pdf\" rel=\"nofollow noreferrer\">cs.nyu.edu/courses/fall09/V22.0102-002/lectures/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 3423120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xAN97.gif?s=128&g=1", "display_name": "Khiem", "link": "https://stackoverflow.com/users/3423120/khiem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1443457118, "creation_date": 1443422804, "last_edit_date": 1443423285, "question_id": 32817106, "link": "https://stackoverflow.com/questions/32817106/generate-postfix-without-binary-tree", "title": "Generate postfix without binary tree", "body": "<p>Can we generate a postfix format string from an expression without creating a binary tree or AST tree</p>\n\n<p>For example, I have an expression <code>exp = \"1 + 2 * 3 * ( 4 - 2 ) + A / B \"</code><br>\nand I want to generate a postfix string = <code>\"1 2 3 * 4 2 - * + A B / +\"</code></p>\n"}, {"tags": ["forms", "parsing", "go", "binding"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 1, "creation_date": 1443441456, "post_id": 32815561, "comment_id": 53480193, "body": "provide MCVE <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> . Now you code not correct."}, {"owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "edited": false, "score": 0, "creation_date": 1443461563, "post_id": 32815561, "comment_id": 53493011, "body": "Thank you for the feedback. I have corrected it now."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1443484856, "post_id": 32815561, "comment_id": 53502989, "body": "I will try to answer. Why do you use so many libraries for this simple example?"}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "edited": false, "score": 0, "creation_date": 1443493538, "post_id": 32833605, "comment_id": 53505033, "body": "What should the form look like if I have to scan into an array? Meaning, I do not want to change the structure of FormInfo, what do I change in template?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "is_accepted": true, "score": 1, "last_activity_date": 1443527952, "last_edit_date": 1443527952, "creation_date": 1443484782, "answer_id": 32833605, "question_id": 32815561, "link": "https://stackoverflow.com/questions/32815561/parsing-array-form-elements-with-bindings/32833605#32833605", "title": "Parsing array form elements with bindings", "body": "<p>Binding so not work. The fields of your form - name = \"fields [1]\" and\nname = \"fields [0]\" are independent from each other, so for each of them your structure should contain its own field:</p>\n\n<pre><code>type FormInfo struct {\n    Fields1   string\n    Fields2   string\n    Action    string\n    PageTitle string\n    Id        string\n}\n</code></pre>\n\n<p>respectively, in the handler:</p>\n\n<pre><code>...\n&amp;f.Fields1: \"fields[0]\",\n&amp;f.Fields2: \"fields[1]\",\n&amp;f.Action:  \"action\",\n...\n</code></pre>\n\n<p>As a result, the output will be:</p>\n\n<pre><code>(*main.FormInfo)(0xc08200aa50)({\n Fields1: (string) (len=7) \"value 1\",\n Fields2: (string) (len=7) \"value 2\",\n Action: (string) (len=4) \"save\",\n PageTitle: (string) \"\",\n Id: (string) \"\"\n})\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If you change the code in the form on the</p>\n\n<pre><code>...\n&lt;input type=\"text\" name=\"fields\"...\n&lt;input type=\"text\" name=\"fields\"...\n</code></pre>\n\n<p>you can get</p>\n\n<pre><code>info.Fields = [value 1 value 2]\n</code></pre>\n\n<p>without changing its original code.</p>\n"}], "owner": {"reputation": 597, "user_id": 1460991, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a8c1a4a881ddda8411db0c59c6678cf9?s=128&d=identicon&r=PG", "display_name": "FlowRaja", "link": "https://stackoverflow.com/users/1460991/flowraja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 32833605, "answer_count": 1, "score": 1, "last_activity_date": 1443527952, "creation_date": 1443413378, "last_edit_date": 1443461542, "question_id": 32815561, "link": "https://stackoverflow.com/questions/32815561/parsing-array-form-elements-with-bindings", "title": "Parsing array form elements with bindings", "body": "<p>I am trying to submit and parse a form in go and I am failing to parse the form fields properly. \nHere is an excerpt of the code I am trying.</p>\n\n<p><strong>formtest.go :</strong>\n    package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/codegangsta/negroni\"\n    \"github.com/davecgh/go-spew/spew\"\n    \"github.com/julienschmidt/httprouter\"\n    \"github.com/mholt/binding\"\n    \"gopkg.in/unrolled/render.v1\"\n)\n\ntype FormInfo struct {\n    Fields    []string\n    Action    string\n    PageTitle string\n    Id        string\n}\n\nfunc (f *FormInfo) FieldMap(*http.Request) binding.FieldMap {\n    return binding.FieldMap{\n        &amp;f.Fields: \"fields\",\n        &amp;f.Action: \"action\",\n    }\n}\n\nfunc formtest(\n    resp http.ResponseWriter,\n    req *http.Request,\n    p httprouter.Params) {\n\n    // var ticket Ticket\n    info := new(FormInfo)\n    tkt := p.ByName(\"tkt\")\n    info.PageTitle = tkt\n    info.Id = tkt\n\n    if req.Method == \"POST\" {\n        bind_err := binding.Bind(req, info)\n        if bind_err.Handle(resp) {\n            log.Println(\"Error decoding form contents\")\n            return\n        }\n        spew.Dump(info)\n    }\n\n    Render.HTML(resp, http.StatusOK, \"formtest\", info)\n    return\n}\n\nvar Render *render.Render\n\nfunc main() {\n\n    router := httprouter.New()\n\n    router.GET(\"/formtest\", formtest)\n    router.POST(\"/formtest\", formtest)\n\n    Render = render.New(render.Options{\n        Layout:          \"layout\",\n        IndentJSON:      true,\n        IndentXML:       true,\n        HTMLContentType: \"text/html\",\n        IsDevelopment:   true,\n    })\n\n    n := negroni.New(\n        negroni.NewRecovery(),\n        negroni.NewLogger(),\n        negroni.NewStatic(http.Dir(\"static\")),\n    )\n    n.UseHandler(router)\n    n.Run(fmt.Sprintf(\":%d\", 3000))\n\n}\n</code></pre>\n\n<p><strong>templates/layout.tmpl :</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;title&gt;{{ .PageTitle }}&lt;/title&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html;\" charset=\"utf-8\"&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;link rel=\"shortcut icon\" type=\"image/x-icon\" href=\"/favicon.ico\" /&gt;\n    &lt;link rel=\"apple-touch-icon\" href=\"/mobile.png\" /&gt;\n    &lt;meta name=\"viewport\" \n          content=\"initial-scale=1.0,width=device-width,user-scalable=no\"&gt;\n    &lt;meta name=\"generator\" content=\"Go\"&gt;\n    &lt;link rel=\"stylesheet\" href=\"/base.css\" type=\"text/css\"&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n\n      &lt;div class=\"mainbody\"&gt;\n        {{ yield }}\n      &lt;/div&gt;\n\n  &lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>templates/formtest.tmpl :</strong></p>\n\n<pre><code>&lt;h1&gt;{{ .PageTitle }}&lt;/h1&gt;\n\n&lt;form action=\"/formtest/{{ .Id }}\" method=\"POST\"&gt;\n\n    &lt;div class=\"details\"&gt;\n      &lt;label&gt;Question 1&lt;/label&gt;\n      &lt;input type=\"text\" name=\"fields[0]\" value=\"value 1\" /&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"details\"&gt;\n      &lt;label&gt;Question 2&lt;/label&gt;\n      &lt;input type=\"text\" name=\"fields[1]\" value=\"value 2\" /&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"details\"&gt;\n      &lt;input type=\"submit\" name=\"action\" value=\"save\" /&gt;\n    &lt;/div&gt;\n\n&lt;/form&gt;\n</code></pre>\n\n<p><strong>Procedure:</strong></p>\n\n<ol>\n<li>go run formtest.go</li>\n<li>Open browser and go to <a href=\"http://127.0.0.1:3000/formtest\" rel=\"nofollow\">http://127.0.0.1:3000/formtest</a></li>\n<li>Submit the form</li>\n<li>Check console for the logs.</li>\n</ol>\n\n<p><strong>Observation :</strong></p>\n\n<pre><code>(*main.FormInfo)(0xc820066c30)({\n Fields: ([]string) &lt;nil&gt;,\n Action: (string) (len=4) \"save\",\n PageTitle: (string) \"\",\n Id: (string) \"\"\n})\n</code></pre>\n\n<p><strong>Expectation :</strong></p>\n\n<pre><code>Fields: ([]string) &lt;contains two values submitted&gt;,\n</code></pre>\n\n<p>But when I try to print the contents of Fields, it is nil.\nWhat am I doing wrong?</p>\n"}, {"tags": ["math", "go", "floating-point", "integer-division"], "answers": [{"comments": [{"owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 0, "creation_date": 1443413288, "post_id": 32815507, "comment_id": 53467506, "body": "i am taking input assuming it is percentage. For eg If the user gives 30, i have to perform 30/100 * somenumber. The input will always be an integer. How to perform division in this scenario ?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 0, "creation_date": 1443414093, "post_id": 32815507, "comment_id": 53467673, "body": "<a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">Convert</a> the integers to floating point numbers."}, {"owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 0, "creation_date": 1443414627, "post_id": 32815507, "comment_id": 53467779, "body": "i tried fmt.Println(float64(3/10)) but it gives me 0"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "edited": false, "score": 8, "creation_date": 1443421051, "post_id": 32815507, "comment_id": 53469536, "body": "@VrushankDoshi: <code>fmt.Println(float64(3) &#47; float64(10))</code> gives <code>0.3</code>."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 100, "last_activity_date": 1515691705, "last_edit_date": 1515691705, "creation_date": 1443412889, "answer_id": 32815507, "question_id": 32815400, "link": "https://stackoverflow.com/questions/32815400/how-to-perform-division-in-go/32815507#32815507", "title": "How to perform division in Go", "body": "<p>The expression <code>3 / 10</code> is an untyped constant expression.  The specification  <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"noreferrer\">says this about constant expressions</a></p>\n\n<blockquote>\n  <p>if the operands of a binary operation are different kinds of untyped constants, the operation and, for non-boolean operations, the result use the kind that appears later in this list: integer, rune, floating-point, complex.</p>\n</blockquote>\n\n<p>Because <code>3</code> and <code>10</code> are untyped integer constants, the value of the expression is an untyped integer (<code>0</code> in this case). </p>\n\n<p>One of the operands must be a floating-point constant for the result to a floating-point constant.  The following expressions evaluate to the untyped floating-point constant <code>0.3</code>:</p>\n\n<pre><code>3.0 / 10.0\n3.0 / 10\n3 / 10.0\n</code></pre>\n\n<p>It's also possible to use typed constants. The following expressions evaluate to the <code>float64</code> constant <code>0.3</code>:</p>\n\n<pre><code>float64(3) / float64(10)\nfloat64(3) / 10\n3 / float64(10)\n</code></pre>\n\n<p>Printing any of the above expressions will print <code>0.3</code>. For example, <code>fmt.Println(3.0 / 10)</code> prints <code>0.3</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4259, "user_id": 1074799, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/840606377197bd43b839d0b62f6d6d9a?s=128&d=identicon&r=PG", "display_name": "S.M.Mousavi", "link": "https://stackoverflow.com/users/1074799/s-m-mousavi"}, "edited": false, "score": 0, "creation_date": 1585233878, "post_id": 47998862, "comment_id": 107694594, "body": "Yes! just first operand"}, {"owner": {"reputation": 1461, "user_id": 785673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27f9d81844087be81b3155dabcd049e2?s=128&d=identicon&r=PG&f=1", "display_name": "Feras", "link": "https://stackoverflow.com/users/785673/feras"}, "edited": false, "score": 0, "creation_date": 1609815753, "post_id": 47998862, "comment_id": 115934424, "body": "Not always succeed, in case &quot;10 &quot; detected as int then this will raise the following error: invalid operation:   (mismatched types float64 and int)"}, {"owner": {"reputation": 27359, "user_id": 1516286, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/36f74e0d3318a630af9ce0e356182040?s=128&d=identicon&r=PG", "display_name": "Vor", "link": "https://stackoverflow.com/users/1516286/vor"}, "edited": false, "score": 1, "creation_date": 1612739638, "post_id": 47998862, "comment_id": 116854229, "body": "Can you please point me, to what am I missing? Basically, I copied your code in Example section, changed  <code>fmt.Println(3.0&#47;10)</code> to <code>fmt.Println(3&#47;10.0)</code>, and got the same result as you have with changing the first operand? Maybe something changed in golang :) <a href=\"https://play.golang.org/p/5xqlAtNb8So\" rel=\"nofollow noreferrer\">play.golang.org/p/5xqlAtNb8So</a>"}, {"owner": {"reputation": 3621, "user_id": 999248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G9pId.jpg?s=128&g=1", "display_name": "robstarbuck", "link": "https://stackoverflow.com/users/999248/robstarbuck"}, "edited": false, "score": 0, "creation_date": 1612745038, "post_id": 47998862, "comment_id": 116855091, "body": "I have to say I don&#39;t have an answer, it seems the 3 in the second example doesn&#39;t get cast to an int for some reason: <a href=\"https://play.golang.org/p/5nT0rDEueWt\" rel=\"nofollow noreferrer\">play.golang.org/p/5nT0rDEueWt</a>"}], "tags": [], "owner": {"reputation": 3621, "user_id": 999248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G9pId.jpg?s=128&g=1", "display_name": "robstarbuck", "link": "https://stackoverflow.com/users/999248/robstarbuck"}, "is_accepted": false, "score": 24, "last_activity_date": 1517330933, "last_edit_date": 1517330933, "creation_date": 1514410119, "answer_id": 47998862, "question_id": 32815400, "link": "https://stackoverflow.com/questions/32815400/how-to-perform-division-in-go/47998862#47998862", "title": "How to perform division in Go", "body": "<p>As mentioned by <a href=\"https://stackoverflow.com/questions/32815400/how-to-perform-division-in-golang#answer-32815507\">@Cerise</a> and per the spec</p>\n\n<blockquote>\n  <p>Arithmetic operators apply to numeric values and yield a result of the <strong>same type as the first operand.</strong></p>\n</blockquote>\n\n<p>In this case only the <strong>first operand</strong> needs to be a floating point.</p>\n\n<pre><code>fmt.Println(3.0/10)\nfmt.Println(float64(3)/10)\n// 0.3 0.3\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/abYeqzjoV3z\" rel=\"noreferrer\">Example</a></p>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75681, "favorite_count": 6, "answer_count": 2, "score": 92, "last_activity_date": 1520883898, "creation_date": 1443411960, "last_edit_date": 1520883898, "question_id": 32815400, "link": "https://stackoverflow.com/questions/32815400/how-to-perform-division-in-go", "title": "How to perform division in Go", "body": "<p>I am trying to perform a simple division in Go.</p>\n\n<pre><code>fmt.Println(3/10)\n</code></pre>\n\n<p>This prints 0 instead of 0.3. This is kind of weird. Could someone please share what is the reason behind this? i want to perform different arithmetic operations in Go.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["performance", "go", "mmap"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1443383159, "post_id": 32811859, "comment_id": 53460781, "body": "see <a href=\"http://stackoverflow.com/questions/24562942/golang-how-do-i-determine-the-number-of-lines-in-a-file-efficiently/24563853#24563853\" title=\"golang how do i determine the number of lines in a file efficiently\">stackoverflow.com/questions/24562942/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 1805349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4d77d012be1df2052ddfba98b4fe8d3?s=128&d=identicon&r=PG", "display_name": "Denis Cheremisov", "link": "https://stackoverflow.com/users/1805349/denis-cheremisov"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443385420, "post_id": 32811859, "comment_id": 53461527, "body": "Thank you @JimB This works indeed: execution time dropped to the wc&#39;s speed, down to .9-1s."}], "owner": {"reputation": 1, "user_id": 1805349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4d77d012be1df2052ddfba98b4fe8d3?s=128&d=identicon&r=PG", "display_name": "Denis Cheremisov", "link": "https://stackoverflow.com/users/1805349/denis-cheremisov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "closed_date": 1443387793, "answer_count": 0, "score": 0, "last_activity_date": 1443418019, "creation_date": 1443381440, "last_edit_date": 1443418019, "question_id": 32811859, "link": "https://stackoverflow.com/questions/32811859/how-to-approach-gnus-wc-l-speed-with-go-golang", "closed_reason": "Duplicate", "title": "How to approach GNU&#39;s &quot;wc -l&quot; speed with Go (golang)?", "body": "<p>I am trying to catch GNU's wc -l speed at counting lines. I would be satisfied being 1.5-2 times slower. The best I could do is 4 times slower. The code using syscall.Mmap:</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"runtime/pprof\"\n    \"syscall\"\n)\n\nconst (\n    DATA_READ int64 = 4096 * 4096\n)\n\nvar cpuprofile = flag.String(\"cpuprofile\", \"\", \"write cpu profile to file\")\n\nfunc main() {\n    flag.Usage = func() {\n        fmt.Printf(\"Usage: %s [options] &lt;file&gt;\\n\\n\", os.Args[0])\n        flag.PrintDefaults()\n    }\n    flag.Parse()\n    if len(flag.Args()) != 1 {\n        flag.Usage()\n        os.Exit(1)\n    }\n    file_path := flag.Args()[0]\n\n    if *cpuprofile != \"\" {\n        profile, err := os.Create(*cpuprofile)\n        if err != nil {\n            log.Fatal(err)\n        }\n        pprof.StartCPUProfile(profile)\n        defer pprof.StopCPUProfile()\n    }\n\n    // Open file for reading\n    file, err := os.OpenFile(file_path, os.O_RDONLY, 0)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fi, err := file.Stat()\n    if err != nil {\n        log.Fatal(err)\n    }\n    file_size := fi.Size()\n    fd := int(file.Fd())\n    defer file.Close()\n\n    line_counter := 0\n    read_from := int64(0)\n    for {\n        read_size := DATA_READ\n        if (file_size - read_from) &lt; read_size {\n            read_size = file_size - read_from\n        }\n        if read_size == 0 {\n            break\n        }\n        data, err := syscall.Mmap(\n            fd, read_from, int(read_size),\n            syscall.PROT_READ, syscall.MAP_PRIVATE)\n        if err != nil {\n            log.Fatal(err)\n        }\n        for _, char := range data {\n            if char == '\\n' {\n                line_counter += 1\n            }\n        }\n        err = syscall.Munmap(data)\n        if err != nil {\n            log.Fatal(err)\n        }\n        read_from += int64(len(data))\n    }\n    fmt.Println(line_counter)\n}\n</code></pre>\n\n<p>Straightforward approach, read large chunks into buffer, straight.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"os\"\n)\n\nconst BUF_SIZE = 4096 * 4096\n\nfunc main() {\n    if len(os.Args) != 2 {\n        fmt.Printf(\"Usage: %s &lt;file&gt;\\n\\n\", os.Args[0])\n        os.Exit(-1)\n    }\n\n    file, err := os.Open(os.Args[1])\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer file.Close()\n\n    buf := make([]byte, BUF_SIZE)\n    line_counter := 0\n\n    for {\n        bytes_read, err := file.Read(buf)\n        if err != nil {\n            if err == io.EOF {\n                break\n            } else {\n                log.Fatal(err)\n            }\n        }\n\n        for i := 0; i &lt; bytes_read; i++ {\n            if buf[i] == '\\n' {\n                line_counter += 1\n            }\n        }\n    }\n\n    fmt.Println(line_counter)\n}\n</code></pre>\n\n<p>The test file was generated with the python script:</p>\n\n<pre class=\"lang-python prettyprint-override\"><code>import os\ndata = ' '*80 + '\\n'\ndata *= 1000000\nwith open(os.environ['HOME'] + '/data', 'w') as dest:\n    for i in range(70):\n        dest.write(data)\n        dest.flush()\n</code></pre>\n\n<p>Timings:</p>\n\n<pre><code>$ time ./main ~/data\n70000000\n\nreal    0m3.965s\nuser    0m3.768s\nsys     0m0.196s\n\n\n$ time ./straight ~/data\n\n70000000\n\nreal    0m5.180s\nuser    0m4.432s\nsys     0m0.748s\n\n\n$ time wc -l ~/data\n70000000 /home/&lt;user&gt;/data\n\nreal    0m0.947s\nuser    0m0.440s\nsys     0m0.504s\n</code></pre>\n\n<p>I tried to profile my main.go program:</p>\n\n<pre><code>./main -cpuprofile main.prof ~/data\ngo tool pprof ./main main.prof\n</code></pre>\n\n<p>Results weren't helpful for me. It is also interesting main.go is faster than straight.go in both user and sys departments. Looks like index, value := range doesn't make range checking (user) and mmap is indeed faster than a plain Read (sys and user). Still, the fastest program I did is 4 times slower than a \"wc -l\", which only does getc(fp). </p>\n\n<p>I wonder is there anything else I could do to approach the speed of old good wc?</p>\n\n<p>upd: was wrong about getc, the real wc from coreutils uses safe_read, which is essentialy a wrapper over the plain read.</p>\n"}, {"tags": ["algorithm", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4065610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c3b63f9d699aeed5348254f58464cf?s=128&d=identicon&r=PG&f=1", "display_name": "wangzun", "link": "https://stackoverflow.com/users/4065610/wangzun"}, "edited": false, "score": 0, "creation_date": 1443354706, "post_id": 32807516, "comment_id": 53451960, "body": "type SortList []interface{}"}, {"owner": {"reputation": 3, "user_id": 4065610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c3b63f9d699aeed5348254f58464cf?s=128&d=identicon&r=PG&f=1", "display_name": "wangzun", "link": "https://stackoverflow.com/users/4065610/wangzun"}, "edited": false, "score": 0, "creation_date": 1443354763, "post_id": 32807516, "comment_id": 53451977, "body": "[]interface{} cannot be function parameter?"}], "tags": [], "owner": {"reputation": 14588, "user_id": 3166303, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/877b076ec96e4ab48f7f4567c1ea2741?s=128&d=identicon&r=PG", "display_name": "leeor", "link": "https://stackoverflow.com/users/3166303/leeor"}, "is_accepted": false, "score": 0, "last_activity_date": 1443355278, "last_edit_date": 1443355278, "creation_date": 1443354101, "answer_id": 32807516, "question_id": 32807383, "link": "https://stackoverflow.com/questions/32807383/is-golang-interface-cannot-be-function-parameter/32807516#32807516", "title": "Is golang []interface{} cannot be function parameter?", "body": "<p>The errors are telling you that you are trying to pass an int array (the <code>slice</code> variable) to the function <code>Do</code>, which is expecting it's first argument as type <code>SortList</code>.</p>\n\n<p>Also, your interface definition does not look right. You have array syntax in there. It should look like this:</p>\n\n<pre><code>type SortList interface{}\n</code></pre>\n\n<p>I suggest you take a look at the <a href=\"https://gobyexample.com/interfaces\" rel=\"nofollow\">gobyexample</a> page on interfaces.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4065610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c3b63f9d699aeed5348254f58464cf?s=128&d=identicon&r=PG&f=1", "display_name": "wangzun", "link": "https://stackoverflow.com/users/4065610/wangzun"}, "edited": false, "score": 0, "creation_date": 1443362550, "post_id": 32807963, "comment_id": 53454140, "body": "thanks !  I do not really understand the &quot;interface&quot; before"}], "tags": [], "owner": {"reputation": 134, "user_id": 5381497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ec30c29bb0dc509db82fc21cc83060?s=128&d=identicon&r=PG", "display_name": "Seonggi Yang", "link": "https://stackoverflow.com/users/5381497/seonggi-yang"}, "is_accepted": true, "score": 3, "last_activity_date": 1443359421, "last_edit_date": 1443359421, "creation_date": 1443357381, "answer_id": 32807963, "question_id": 32807383, "link": "https://stackoverflow.com/questions/32807383/is-golang-interface-cannot-be-function-parameter/32807963#32807963", "title": "Is golang []interface{} cannot be function parameter?", "body": "<p>Cannot. Interface is interface.</p>\n\n<p>interface{} is not some kind of \"any\" type.\nBut, any type implements interface{}. Interface is just a set of methods which should be implemented.</p>\n\n<p>If you want to check whether the interface{} is slice or not, you can write it like this:</p>\n\n<pre><code>import \"reflect\"\n\nt := reflect.TypeOf(list)\nif t.Kind() == reflect.Slice {\n    ...\n}\n</code></pre>\n\n<p>I recommend you read this very helpful article: <a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\">http://blog.golang.org/laws-of-reflection</a>.</p>\n\n<p>Additionally, it will be nice to read the code of sort package: <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow\">https://golang.org/pkg/sort/</a>. It is an example of golang-way implementation of sorting.</p>\n\n<p><strong>Edit</strong>: If you really really want use []interface{} as a parameter, actually you can do it like this:</p>\n\n<pre><code>vs := make([]interface{}, len(list))\nfor i, e := range list {\n    vs[i] = e\n}\nDo(vs, f)\n</code></pre>\n\n<p>In fact, []interface{} is not an empty interface. It's a slice type whose elements are interface{}; []int is not []interface{}, but just implements interface{}.</p>\n\n<p>I guess you want to write some kind of a general sorting method, like you write it by using generics in Java. I think it is a bad code.</p>\n"}], "owner": {"reputation": 3, "user_id": 4065610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c3b63f9d699aeed5348254f58464cf?s=128&d=identicon&r=PG&f=1", "display_name": "wangzun", "link": "https://stackoverflow.com/users/4065610/wangzun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "closed_date": 1443416761, "accepted_answer_id": 32807963, "answer_count": 2, "score": -2, "last_activity_date": 1443359421, "creation_date": 1443353074, "last_edit_date": 1443354382, "question_id": 32807383, "link": "https://stackoverflow.com/questions/32807383/is-golang-interface-cannot-be-function-parameter", "closed_reason": "Duplicate", "title": "Is golang []interface{} cannot be function parameter?", "body": "<p>My code :</p>\n\n<hr>\n\n<pre><code>package sort_test\n\ntype SortList []interface{}\n\ntype SortFunc func(interface{}, interface{}) bool\n\n\nfunc Do(list SortList, function SortFunc)\n</code></pre>\n\n<hr>\n\n<p>main package</p>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n        \"sort_test\"\n)\n\nfunc main() {\n\n    list := []int{3, 4, 5, 6, 6, 77, 4, 4, 5, 6, 8, 345, 45, 424, 2, 67, 7, 830}\n\nslice := list[:]\n\nsort_test.Do(slice, function)\n}\n</code></pre>\n\n<hr>\n\n<h2>compile error</h2>\n\n<pre><code>src/algorithm/algorithm.go:32: cannot use slice (type []int) as type sort_test.SortList in argument to sort_test.Do\nsrc/algorithm/algorithm.go:32: cannot use function (type func(int, int) bool) as type sort_test.SortFunc in argument to sort_test.Do\nmake: *** [algorithm] Error 2\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 447, "user_id": 776896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f590ff1e6f4dab2937b0d27a59be828a?s=128&d=identicon&r=PG", "display_name": "the_real_one", "link": "https://stackoverflow.com/users/776896/the-real-one"}, "edited": false, "score": 0, "creation_date": 1545533809, "post_id": 32805478, "comment_id": 94647146, "body": "to anyone here later on also make sure you use mgo.ErrNotFound instead of == &quot;not found&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "edited": false, "score": 2, "creation_date": 1443348447, "post_id": 32805924, "comment_id": 53450353, "body": "I need to check that object with FIELD value X already exists; $exists will find objects with FIELD no matter what its value. And again, I only need to know that object already is in db, I dont need itself"}, {"owner": {"reputation": 1675, "user_id": 5278172, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jTAWbrXhfEc/AAAAAAAAAAI/AAAAAAAANIg/GIP3ITSgasc/photo.jpg?sz=128", "display_name": "Rohit Jain", "link": "https://stackoverflow.com/users/5278172/rohit-jain"}, "reply_to_user": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "edited": false, "score": 0, "creation_date": 1443350018, "post_id": 32805924, "comment_id": 53450807, "body": "Do you mean you want to check if the field with certain value exist in a collection ?"}, {"owner": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "edited": false, "score": 0, "creation_date": 1443369184, "post_id": 32805924, "comment_id": 53456306, "body": "yes, you have formulated it way better than I did :)"}, {"owner": {"reputation": 1675, "user_id": 5278172, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jTAWbrXhfEc/AAAAAAAAAAI/AAAAAAAANIg/GIP3ITSgasc/photo.jpg?sz=128", "display_name": "Rohit Jain", "link": "https://stackoverflow.com/users/5278172/rohit-jain"}, "reply_to_user": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "edited": false, "score": 0, "creation_date": 1443374035, "post_id": 32805924, "comment_id": 53457815, "body": "you can simply use count greater than 0 here is the code  db.colleaction.count({filed:value})&gt;0"}, {"owner": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "edited": false, "score": 2, "creation_date": 1475429539, "post_id": 32805924, "comment_id": 66929598, "body": "db.colleaction.count({filed:value})&gt;0  how we do this in golang using gopkg.in/mgo.v2 ?"}], "tags": [], "owner": {"reputation": 1675, "user_id": 5278172, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jTAWbrXhfEc/AAAAAAAAAAI/AAAAAAAANIg/GIP3ITSgasc/photo.jpg?sz=128", "display_name": "Rohit Jain", "link": "https://stackoverflow.com/users/5278172/rohit-jain"}, "is_accepted": true, "score": 6, "last_activity_date": 1527297983, "last_edit_date": 1527297983, "creation_date": 1443341774, "answer_id": 32805924, "question_id": 32805478, "link": "https://stackoverflow.com/questions/32805478/check-object-existence-in-mongo-using-gopkg-in-mgo-v2/32805924#32805924", "title": "Check object existence in mongo using gopkg.in/mgo.v2", "body": "<p>you have to use $exists </p>\n\n<p>Syntax: { field: { $exists:  } }</p>\n\n<p>For more details </p>\n\n<p><a href=\"http://docs.mongodb.org/manual/reference/operator/query/exists/\" rel=\"nofollow noreferrer\">http://docs.mongodb.org/manual/reference/operator/query/exists/</a></p>\n"}, {"comments": [{"owner": {"reputation": 1351, "user_id": 169854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ODxtl.png?s=128&g=1", "display_name": "dza", "link": "https://stackoverflow.com/users/169854/dza"}, "edited": false, "score": 0, "creation_date": 1513175328, "post_id": 43519251, "comment_id": 82551629, "body": "NOTE: You have to set <code>db.SetSafe(&amp;mgo.Safe{})</code> first for this to work - otherwise it will always return 0 and nil!"}, {"owner": {"reputation": 651, "user_id": 2520523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce15de4a421225aaf7eae3ad8b44d7e?s=128&d=identicon&r=PG", "display_name": "Thiago Lunardi", "link": "https://stackoverflow.com/users/2520523/thiago-lunardi"}, "edited": false, "score": 2, "creation_date": 1574611181, "post_id": 43519251, "comment_id": 104284925, "body": "This is not a good way, if you have millions of documents, it will take a high cost and too much time to count the whole collection, and in the end, you really don&#39;t care about how many documents is there, but just if any document exists."}], "tags": [], "owner": {"reputation": 129, "user_id": 6642977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2c127a779dd184672c8a543167db81?s=128&d=identicon&r=PG&f=1", "display_name": "Activecat", "link": "https://stackoverflow.com/users/6642977/activecat"}, "is_accepted": false, "score": 11, "last_activity_date": 1499026301, "last_edit_date": 1499026301, "creation_date": 1492690503, "answer_id": 43519251, "question_id": 32805478, "link": "https://stackoverflow.com/questions/32805478/check-object-existence-in-mongo-using-gopkg-in-mgo-v2/43519251#43519251", "title": "Check object existence in mongo using gopkg.in/mgo.v2", "body": "<pre><code>count, err = collection.Find(bson.M{field: value}).Count()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2471, "user_id": 4261333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSMoY.jpg?s=128&g=1", "display_name": "Mawardy", "link": "https://stackoverflow.com/users/4261333/mawardy"}, "is_accepted": false, "score": 1, "last_activity_date": 1613327941, "last_edit_date": 1613327941, "creation_date": 1587343156, "answer_id": 61313530, "question_id": 32805478, "link": "https://stackoverflow.com/questions/32805478/check-object-existence-in-mongo-using-gopkg-in-mgo-v2/61313530#61313530", "title": "Check object existence in mongo using gopkg.in/mgo.v2", "body": "<p>in the <a href=\"https://github.com/mongodb/mongo-go-driver\" rel=\"nofollow noreferrer\">Official Mongo Driver</a> you can get count of documents with specific key using <strong>CountDocuments</strong> function :</p>\n<pre class=\"lang-golang prettyprint-override\"><code>count, err := collection.CountDocuments(context.TODO(), bson.D{{&quot;key&quot;, &quot;value&quot;}})\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5250918, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a241b785773d58ae2cd8be649f9b97a?s=128&d=identicon&r=PG&f=1", "display_name": "Kaign", "link": "https://stackoverflow.com/users/5250918/kaign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7634, "favorite_count": 1, "accepted_answer_id": 32805924, "answer_count": 3, "score": 8, "last_activity_date": 1613327941, "creation_date": 1443337947, "last_edit_date": 1511855774, "question_id": 32805478, "link": "https://stackoverflow.com/questions/32805478/check-object-existence-in-mongo-using-gopkg-in-mgo-v2", "title": "Check object existence in mongo using gopkg.in/mgo.v2", "body": "<p>I am looking for convinient way to check if object already exists in collection. For now the only way that i have found is</p>\n\n<pre><code>type result interface{}\nvar res result\n\nerr := col.Find(bson.M{\"title\": \"title1\"}).One(&amp;res)\nif err != nil {\n    if err.Error() == \"not found\" {\n        log.Println(\"No such document\")\n    } else {\n        log.Println(\"err occured\", err)\n    }\n}\n</code></pre>\n\n<p>I dont want to create variable res, in case if object exists, it can be very heavy document with a lot of fields.\nI wish there would be another way, some Check() function which will just return bool value.. \nBasically I only need to know that object already stored in collection, I dont need itself</p>\n"}, {"tags": ["json", "parsing", "go"], "comments": [{"owner": {"reputation": 1784, "user_id": 2754507, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4k0D3.jpg?s=128&g=1", "display_name": "Mario Trucco", "link": "https://stackoverflow.com/users/2754507/mario-trucco"}, "edited": false, "score": 0, "creation_date": 1443338371, "post_id": 32805461, "comment_id": 53447958, "body": "Could you edit your question explaining the point of the unique keys? It is only mentioned in the title"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1443341976, "post_id": 32805461, "comment_id": 53448778, "body": "It will be easier if you say that, and in what form you need to get."}], "answers": [{"tags": [], "owner": {"reputation": 4011, "user_id": 29703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/32e50f8f8e17d63c49bf03d54a48282a?s=128&d=identicon&r=PG", "display_name": "Jeffrey Martinez", "link": "https://stackoverflow.com/users/29703/jeffrey-martinez"}, "is_accepted": true, "score": 3, "last_activity_date": 1443348505, "last_edit_date": 1443348505, "creation_date": 1443343494, "answer_id": 32806121, "question_id": 32805461, "link": "https://stackoverflow.com/questions/32805461/how-can-i-parse-json-in-golang-if-nested-content-uses-dynamic-keys/32806121#32806121", "title": "How can I parse JSON in GoLang if nested content uses dynamic keys?", "body": "<p>Try this instead, looks like you just have your structure set up incorrectly:</p>\n\n<p><a href=\"http://play.golang.org/p/VRKbv-GVQB\" rel=\"nofollow\">http://play.golang.org/p/VRKbv-GVQB</a></p>\n\n<p>You need to parse the entire json string, which is an object that contains a single element named <code>items</code>. <code>items</code> then contains a map of <code>string</code> -> <code>Person</code> objects.</p>\n\n<p>If you only want to extract <code>name</code> and <code>age</code> from each person, you do it by grabbing <code>data.Items[\"bvu62fu6dq\"].Name</code>.</p>\n\n<p>If you want dynamic keys inside the <code>Person</code>, you'll need to do <code>map[string]interface{}</code> instead of <code>Person</code> in order to capture the dynamic keys again. It would look something like:</p>\n\n<pre><code>type Data struct {\n    Items map[string]map[string]interface{} `json:\"items\"`\n}\n...\nfmt.Printf(\"%v\\n\", data.Items[\"bvu62fu6dq\"][\"name\"]\nfmt.Printf(\"%v\\n\", data.Items[\"bvu62fu6dq\"][\"age\"]\nfmt.Printf(\"%v\\n\", data.Items[\"bvu62fu6dq\"][\"xyz\"]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 1726562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09982ed9acd0436f255412eec950c07e?s=128&d=identicon&r=PG", "display_name": "user1726562", "link": "https://stackoverflow.com/users/1726562/user1726562"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 32806121, "answer_count": 1, "score": 0, "last_activity_date": 1443348505, "creation_date": 1443337797, "last_edit_date": 1443346835, "question_id": 32805461, "link": "https://stackoverflow.com/questions/32805461/how-can-i-parse-json-in-golang-if-nested-content-uses-dynamic-keys", "title": "How can I parse JSON in GoLang if nested content uses dynamic keys?", "body": "<p>I received JSON below from a client API but i am struggling to get nested JSON content. How can I parse it if the inner keys are dynamic?</p>\n\n<pre><code>const jsonStream = `\n{\n    \"items\": {\n        \"bvu62fu6dq\": {\n            \"name\": \"john\",\n            \"age\": 23,\n            \"xyz\": \"weu33s\"\n        },\n        \"iaxdw23fq\": {\n            \"name\": \"kelly\",\n            \"age\": 21,\n            \"xyz\": \"weu33s\"\n        }\n    }\n}`\n</code></pre>\n\n<p>This is what i have tried below by looping the map to extract the value of name and age from above JSON string; but it returns map with nil value as a result.\n<a href=\"http://play.golang.org/p/Y5-2cwsRhE\" rel=\"nofollow\">goplaygound</a></p>\n\n<pre><code>type Person struct {\n    Name string `json:\"name\"`\n    Age  int    `json:\"age\"`\n}\ntype Item struct {\n    Contact struct {\n        Info map[string]Person\n    } `json:\"items\"`\n}\n\nfunc main() {\n    dec := json.NewDecoder(strings.NewReader(jsonStream))\n    for {\n        var item Item\n        if err := dec.Decode(&amp;item); err == io.EOF {\n            break\n        } else if err != nil {\n            log.Fatal(err)\n        }\n        fmt.Printf(\"%s\\n\", item.Contact.Info[\"bvu62fu6dq\"].Name)\n    }\n}\n</code></pre>\n"}, {"tags": ["rest", "go"], "comments": [{"owner": {"reputation": 21358, "user_id": 1977620, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/lvWfj.jpg?s=128&g=1", "display_name": "Max Malysh", "link": "https://stackoverflow.com/users/1977620/max-malysh"}, "edited": false, "score": 0, "creation_date": 1443317080, "post_id": 32803642, "comment_id": 53444598, "body": "Well, have you tried to concatenate the strings?"}, {"owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "reply_to_user": {"reputation": 21358, "user_id": 1977620, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/lvWfj.jpg?s=128&g=1", "display_name": "Max Malysh", "link": "https://stackoverflow.com/users/1977620/max-malysh"}, "edited": false, "score": 0, "creation_date": 1443317363, "post_id": 32803642, "comment_id": 53444650, "body": "No i haven&#39;t..i am not sure how should i go ahead with this."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1443368537, "post_id": 32805154, "comment_id": 53456038, "body": "Alternatively you could put all the query parts into a <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\"><code>url.Values</code></a> and then use <a href=\"https://golang.org/pkg/net/url/#Values.Encode\" rel=\"nofollow noreferrer\"><code>Values.Encode</code></a> to get the entire URL part after the <code>?</code>."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 0, "last_activity_date": 1443334586, "last_edit_date": 1495539865, "creation_date": 1443334586, "answer_id": 32805154, "question_id": 32803642, "link": "https://stackoverflow.com/questions/32803642/how-to-add-a-string-to-an-url-in-golang/32805154#32805154", "title": "How to add a string to an URL in golang?", "body": "<p>If you have the symbols (provided by the users) as a string array parameter (like: \"<code>symbols</code>\", being <code>string[\"\\\"AAPL\\\"\", \"\\\"FB\\\"\", \"\\\"GOOG\\\"\"]</code>), you can use <a href=\"https://golang.org/pkg/strings/#Join\" rel=\"nofollow noreferrer\"><code>strings/#Join</code></a> to produce the right string:</p>\n\n<pre><code>s := strings.Joins(symbols, \",\")\n</code></pre>\n\n<p>Then (as detailed in \"<a href=\"https://stackoverflow.com/q/13820280/6309\">Encode / decode URLs</a>\"), use <a href=\"https://golang.org/pkg/net/url/#QueryEscape\" rel=\"nofollow noreferrer\"><code>net/url/#QueryEscape</code></a> to get the final url string for symbols:</p>\n\n<pre><code>url := \"http://query.yahooapis.com/v1/public/yql?q=select%20LastTradePriceOnly%20from%20yahoo.finance.quote%20where%20symbol%20in%20(\" + \nurl.QueryEscape(s) + \n\")&amp;format=json&amp;env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys\"\n</code></pre>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 1, "accepted_answer_id": 32805154, "answer_count": 1, "score": -5, "last_activity_date": 1504368930, "creation_date": 1443316729, "last_edit_date": 1504368930, "question_id": 32803642, "link": "https://stackoverflow.com/questions/32803642/how-to-add-a-string-to-an-url-in-golang", "title": "How to add a string to an URL in golang?", "body": "<p>I am new to golang and trying this for the first time. I have to call yahoo finance api(YQL) to get the stock price of the symbol in json format.\nHere is the api:</p>\n\n<pre><code>http://query.yahooapis.com/v1/public/yql?q=select%20LastTradePriceOnly%20from%20yahoo.finance.quote%20where%20symbol%20in%20(%22AAPL%22,%22FB%22,%22GOOG%22)&amp;format=json&amp;env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys\n</code></pre>\n\n<p>For now i have hard coded the symbol(AAPL,FB, GOOG) in the above select query but these symbols will be coming from the user, it should be dynamic. How should i add the input(symbol) to the above query in golang? </p>\n\n<p>Thanks for the help in advance.</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1443310412, "last_edit_date": 1443310412, "creation_date": 1443310019, "answer_id": 32803047, "question_id": 32803018, "link": "https://stackoverflow.com/questions/32803018/sync-waitgroup-not-behaving-as-i-expect-what-am-i-missing-here/32803047#32803047", "title": "sync.WaitGroup not behaving as I expect, what am I missing here?", "body": "<p>There's a race on <code>x</code>.  One fix is to protect <code>x</code> with a mutex:</p>\n\n<pre><code>var mu sync.Mutex\nvar wg sync.WaitGroup\nwg.Add(n)\n\nx := 0\nfor i := 0; i &lt; n; i++ {\n    go func() {\n        defer wg.Done()\n        mu.Lock()\n        x++\n        mu.Unlock()\n    }()\n}\n\nwg.Wait()\nfmt.Println(n, x)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/H5gaUNK2AM\" rel=\"noreferrer\">playground example</a></p>\n\n<p>I suggest running the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"noreferrer\">race detector</a> whenever one finds something puzzling in a Go program with more than one goroutine.</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 207003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7eec3cf5803a4346d44b12e046ec5a?s=128&d=identicon&r=PG", "display_name": "Tony Bai", "link": "https://stackoverflow.com/users/207003/tony-bai"}, "is_accepted": false, "score": 1, "last_activity_date": 1443311007, "creation_date": 1443311007, "answer_id": 32803159, "question_id": 32803018, "link": "https://stackoverflow.com/questions/32803018/sync-waitgroup-not-behaving-as-i-expect-what-am-i-missing-here/32803159#32803159", "title": "sync.WaitGroup not behaving as I expect, what am I missing here?", "body": "<p>use sync.atomic method to access x atomically. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"sync/atomic\"\n)\n\nfunc main() {\n    n := 100\n\n    var wg sync.WaitGroup\n    wg.Add(n)\n\n    var x int32\n    for i := 0; i &lt; n; i++ {\n        go func() {\n            defer wg.Done()\n            atomic.AddInt32(&amp;x, 1)\n        }()\n    }\n\n    wg.Wait()\n    fmt.Println(n, x)\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 2389440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aff95c24828ce7a62ebc665fead657b2?s=128&d=identicon&r=PG", "display_name": "Knucklehead", "link": "https://stackoverflow.com/users/2389440/knucklehead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 32803047, "answer_count": 2, "score": 1, "last_activity_date": 1443311007, "creation_date": 1443309733, "question_id": 32803018, "link": "https://stackoverflow.com/questions/32803018/sync-waitgroup-not-behaving-as-i-expect-what-am-i-missing-here", "title": "sync.WaitGroup not behaving as I expect, what am I missing here?", "body": "<p>Given the following:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    n := 100\n\n    var wg sync.WaitGroup\n    wg.Add(n)\n\n    x := 0\n    for i := 0; i &lt; n; i++ {\n        go func() {\n            defer wg.Done()\n            x++\n        }()\n    }\n\n    wg.Wait()\n    fmt.Println(n, x)\n}\n</code></pre>\n\n<p>I would expect <code>x</code> to always reach <code>100</code> by the time it prints at the end, but it sometimes prints as low as <code>95</code>. What am I missing here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 11, "creation_date": 1443297858, "post_id": 32800952, "comment_id": 53440156, "body": "Go does not immediately release memory back to the OS \u2014 because a program that uses large chunks of memory will typically use them again. Only after ~7 - 10 minutes will unused memory be released - see here <a href=\"http://stackoverflow.com/questions/24376817/go-1-3-garbage-collector-not-releasing-server-memory-back-to-system\" title=\"go 1 3 garbage collector not releasing server memory back to system\">stackoverflow.com/questions/24376817/&hellip;</a>"}, {"owner": {"reputation": 47, "user_id": 5282464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b499bff72fe45c45a0f747e1723952c?s=128&d=identicon&r=PG&f=1", "display_name": "Gen Shani", "link": "https://stackoverflow.com/users/5282464/gen-shani"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1443298481, "post_id": 32800952, "comment_id": 53440349, "body": "I see, thanks very much."}, {"owner": {"reputation": 1652, "user_id": 918176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2bdb37b11c35de00bb68359342a82f38?s=128&d=identicon&r=PG", "display_name": "user918176", "link": "https://stackoverflow.com/users/918176/user918176"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1448054067, "post_id": 32800952, "comment_id": 55437637, "body": "@elithrar That is a good explanation! Mind providing an answer for Gen&#39;s question, too?"}], "answers": [{"tags": [], "owner": {"reputation": 752, "user_id": 7496656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMGuk.jpg?s=128&g=1", "display_name": "Jan Zerebecki", "link": "https://stackoverflow.com/users/7496656/jan-zerebecki"}, "is_accepted": false, "score": 1, "last_activity_date": 1496403102, "creation_date": 1496403102, "answer_id": 44327876, "question_id": 32800952, "link": "https://stackoverflow.com/questions/32800952/why-is-the-memory-block-not-cleaned-by-the-garbage-collector/44327876#44327876", "title": "Why is the memory block not cleaned by the garbage collector?", "body": "<p>Go does not release memory back to the OS immediately, even if it is reclaimed via garbage collection (GC). This is a performance improvement as it may need the memory again. You are not doing anything wrong. Without limited knowledge of the future demand and considering the overhead of compacting, freeing and allocating memory from the OS, every GC needs to make this performance trade-off. There was research into making the API the OS provides for this more effective in the context of the JVM and Linux kernel. User space OOM handling is a more recent, less ambitious Linux kernel development that could be used by a GC to more early release memory when it is most needed. </p>\n\n<p>As far as I know there is no official upper limit for how long Go keeps memory. However in <a href=\"https://stackoverflow.com/q/24376817/7496656\">Go 1.3 Garbage collector not releasing server memory back to system</a> it was experimentally verified to be 9 minutes (a GC which occurs at least after 2 minutes + 7 minutes holding memory in reserve).</p>\n\n<p>You can manually trigger this by calling <a href=\"https://golang.org/pkg/runtime/debug/#FreeOSMemory\" rel=\"nofollow noreferrer\">runtime.debug.FreeOSMemory()</a>, however this is usually not a good idea except for debugging purposes.</p>\n"}], "owner": {"reputation": 47, "user_id": 5282464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b499bff72fe45c45a0f747e1723952c?s=128&d=identicon&r=PG&f=1", "display_name": "Gen Shani", "link": "https://stackoverflow.com/users/5282464/gen-shani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1496403102, "creation_date": 1443294546, "last_edit_date": 1443294861, "question_id": 32800952, "link": "https://stackoverflow.com/questions/32800952/why-is-the-memory-block-not-cleaned-by-the-garbage-collector", "title": "Why is the memory block not cleaned by the garbage collector?", "body": "<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"net/http\"\n        \"runtime\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n       largeMemAlloc := make([]int, 100000000)\n       largeMemAlloc[1] = 100//lol\n       fmt.Fprintf(w, \"hi from handler\")\n       runtime.GC()\n}\n\nfunc main() {\n       http.HandleFunc(\"/\", handler)\n       http.ListenAndServe(\":7777\", nil)\n}\n</code></pre>\n\n<p>Once I visit <a href=\"http://127.0.0.1:7777\" rel=\"nofollow\">http://127.0.0.1:7777</a> 4-5 times the memory used goes in to GBs. </p>\n\n<p>Its been around 4-5 mins and the memory is still unclaimed by the OS. Why is this happening?</p>\n\n<p>What am I doing wrong? </p>\n\n<p>I am compiling this in go 1.5 </p>\n\n<blockquote>\n  <p>Edit : After 10 mins, the memory usage has gone down to just 50mb. But I dont understand why it takes so long to reclaim this block of memory. I feel like I am doing something horribly wrong.</p>\n</blockquote>\n"}, {"tags": ["sockets", "google-app-engine", "go", "network-programming", "cherrypy"], "answers": [{"tags": [], "owner": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "is_accepted": false, "score": 1, "last_activity_date": 1443480219, "creation_date": 1443480219, "answer_id": 32832951, "question_id": 32800754, "link": "https://stackoverflow.com/questions/32800754/app-engine-dev-server-protocol-wrong-type-for-socket/32832951#32832951", "title": "App Engine dev server - Protocol wrong type for socket", "body": "<p>This appears to be an error bubbling-up from <code>wsgiserver2.py</code>'s use of python sockets, since many other references to \"error 41\" and \"Protocol wrong type for socket\" show up on the net as python <code>sockets</code> -module-related. </p>\n\n<p>I think given the intermittent nature of this problem that it's likely an issue on the platform. In such a case, you should <a href=\"https://code.google.com/p/google-appengine/issues/list\" rel=\"nofollow\">file an issue report in the public issue tracker</a> containing enough code to reproduce the issue, or an attached app which can reproduced the issue. </p>\n\n<p>Best of luck in filing that issue report!</p>\n"}], "owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2305, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1443480219, "creation_date": 1443293208, "last_edit_date": 1443414874, "question_id": 32800754, "link": "https://stackoverflow.com/questions/32800754/app-engine-dev-server-protocol-wrong-type-for-socket", "title": "App Engine dev server - Protocol wrong type for socket", "body": "<p>I'm running an App Engine app written in Go locally with the development server and hitting the API with requests 1/s with roughly 100k-1MB JSON data.</p>\n\n<p>From time to time the server prints an error trace but still continues to serve requests:</p>\n\n<pre><code>socket.error 41\nTraceback (most recent call last):\n  File \"/Users/foo/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 1302, in communicate\n    req.respond()\n  File \"/Users/foo/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 831, in respond\n    self.server.gateway(self).respond()\n  File \"/Users/foo/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 2127, in respond\n    self.write(chunk)\n  File \"/Users/foo/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 2188, in write\n    self.req.write(chunk)\n  File \"/Users/foo/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 879, in write\n    self.conn.wfile.sendall(chunk)\n  File \"/Users/foo/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 970, in sendall\n    bytes_sent = self.send(data)\n  File \"/Users/foo/go_appengine/lib/cherrypy/cherrypy/wsgiserver/wsgiserver2.py\", line 977, in send\n    bytes_sent = self._sock.send(data)\nerror: [Errno 41] Protocol wrong type for socket\n</code></pre>\n\n<p>The client is in a loop doing:</p>\n\n<pre><code>func call(url string, data []byte) error {\n    r, err := http.Post(url, \"application/json\", bytes.NewReader(data))\n    if err != nil {\n        return err\n    }\n    defer r.Body.Close()\n    if r.StatusCode != http.StatusCreated {\n        return fmt.Errorf(\"unexpected status code %d\", r.StatusCode)\n    }\n    return nil\n}\n</code></pre>\n\n<p>Golang App Engine SDK is now 1.9.26 and I had 1.9.25 before with the same issue.</p>\n\n<p>I have unsuccessfully found anything online that would help me understand the issue.</p>\n\n<p>Does anyone have an idea what this might be caused by? </p>\n"}, {"tags": ["go", "reference", "tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1443291930, "post_id": 32799562, "comment_id": 53438364, "body": "Please do not ask for tutorials or off-site references on Stack Overflow. This will invariably lead to your question being closed."}], "answers": [{"tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": true, "score": 2, "last_activity_date": 1443291519, "creation_date": 1443291519, "answer_id": 32800463, "question_id": 32799562, "link": "https://stackoverflow.com/questions/32799562/golang-binary-search-tree-algorithm-translation/32800463#32800463", "title": "Golang Binary Search Tree Algorithm Translation", "body": "<p>Go always passes parameters by value. You should rather write:</p>\n\n<pre><code>func insert(root *Node,v int) *Node {\n    if root == nil{\n        root = &amp;Node{v,nil,nil}\n    } else if v&lt;root.value{\n        root.left = insert(root.left,v)\n    } else{\n        root.right = insert(root.right,v)\n    }\n    return root\n}\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>for i:=0;i&lt;n;i++{\n    treeRoot = insert(treeRoot,a[i])\n}\n</code></pre>\n\n<p>See the result at: <a href=\"http://play.golang.org/p/94H_l3rfSH\" rel=\"nofollow\">http://play.golang.org/p/94H_l3rfSH</a></p>\n"}], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 1, "accepted_answer_id": 32800463, "answer_count": 1, "score": 1, "last_activity_date": 1516700123, "creation_date": 1443286222, "last_edit_date": 1516700123, "question_id": 32799562, "link": "https://stackoverflow.com/questions/32799562/golang-binary-search-tree-algorithm-translation", "title": "Golang Binary Search Tree Algorithm Translation", "body": "<p>I'm beginner to Golang and trying to build a Binary Search Tree. My source code to do it:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\ntype Node struct{\n    value int\n    left *Node\n    right *Node\n}\n\nfunc insert(root *Node,v int){\n    if root==nil{\n        root=&amp;Node{v,nil,nil}\n    } else if v&lt;root.value{\n        insert(root.left,v)\n    } else{\n        insert(root.right,v)\n    }\n}\n\nfunc inTraverse(root *Node){\n    if (root==nil){\n        return\n    }\n    inTraverse(root.left)\n    fmt.Printf(\"%d\",root.value)\n    inTraverse(root.right)\n}\n\nfunc main() {\n    var treeRoot *Node\n    rand.Seed(time.Now().UnixNano())\n    n:=6\n    var a[6]int\n    for i:=0;i&lt;n;i++{\n        a[i]=rand.Intn(20)+1\n    }\n    fmt.Println(\"Array of integer: \")\n    for i:=0;i&lt;n;i++{\n        fmt.Printf(\"%d \",a[i])\n    }\n    fmt.Println()\n    for i:=0;i&lt;n;i++{\n        insert(treeRoot,a[i])\n    }\n    inTraverse(treeRoot)\n    fmt.Println()\n}\n</code></pre>\n\n<p>The result shows an empty tree. What's wrong with my code? Does Golang have pass-by-value or pass-by-reference? Please help me solve this.</p>\n"}, {"tags": ["regex", "go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": false, "score": 1, "last_activity_date": 1443286769, "last_edit_date": 1443286769, "creation_date": 1443285581, "answer_id": 32799459, "question_id": 32799402, "link": "https://stackoverflow.com/questions/32799402/my-valid-regex-doesnt-work-in-gorilla-mux/32799459#32799459", "title": "My (valid?) regex doesn&#39;t work in gorilla/mux", "body": "<p>If you want to detect positive integers excluding 0, you should use this characters class: <code>[1-9]\\d*</code></p>\n\n<p>That means, the first digit must be between 1 and 9. The other digits (if present, look at the <code>*</code>) can be any integer, 0 included.</p>\n"}, {"comments": [{"owner": {"reputation": 3440, "user_id": 1407735, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7c273f8bbfe205223d4f785dd5e8b830?s=128&d=identicon&r=PG", "display_name": "Marc-Fran&#231;ois", "link": "https://stackoverflow.com/users/1407735/marc-fran%c3%a7ois"}, "edited": false, "score": 1, "creation_date": 1443373217, "post_id": 32799526, "comment_id": 53457571, "body": "Thanks, it worked. In mux&#39;s source code I found <code>pattern.WriteByte(&#39;^&#39;)</code> and <code>pattern.WriteByte(&#39;$&#39;)</code>. So these are probably added by default."}], "tags": [], "owner": {"reputation": 65435, "user_id": 2206004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCB1e.png?s=128&g=1", "display_name": "hwnd", "link": "https://stackoverflow.com/users/2206004/hwnd"}, "is_accepted": true, "score": 3, "last_activity_date": 1443286818, "last_edit_date": 1443286818, "creation_date": 1443286017, "answer_id": 32799526, "question_id": 32799402, "link": "https://stackoverflow.com/questions/32799402/my-valid-regex-doesnt-work-in-gorilla-mux/32799526#32799526", "title": "My (valid?) regex doesn&#39;t work in gorilla/mux", "body": "<p>The <a href=\"http://www.rexegg.com/regex-anchors.html\" rel=\"nofollow\"><strong>anchors</strong></a> are most likely the issue here, you're trying to assert at start/end of string positions.</p>\n\n<p>I would simply try modifying the older (working) regular expression as follows:</p>\n\n<pre><code>get.HandleFunc(\"/my/api/user/{userID:[1-9][0-9]*}\", app.Handle(\"user\"))\n</code></pre>\n"}], "owner": {"reputation": 3440, "user_id": 1407735, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7c273f8bbfe205223d4f785dd5e8b830?s=128&d=identicon&r=PG", "display_name": "Marc-Fran&#231;ois", "link": "https://stackoverflow.com/users/1407735/marc-fran%c3%a7ois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 32799526, "answer_count": 2, "score": 1, "last_activity_date": 1443286818, "creation_date": 1443285292, "question_id": 32799402, "link": "https://stackoverflow.com/questions/32799402/my-valid-regex-doesnt-work-in-gorilla-mux", "title": "My (valid?) regex doesn&#39;t work in gorilla/mux", "body": "<p>I have this regex in my code:</p>\n\n<pre><code>get.HandleFunc(\"/my/api/user/{userID:^([1-9][0-9]*)$}\", app.Handle(\"user\"))\n</code></pre>\n\n<p>But when I run the tests, only 404s are returned. I also tried this:</p>\n\n<pre><code>get.HandleFunc(\"/my/api/user/{userID:\\\\A([1-9][0-9]*)\\\\z}\", app.Handle(\"user\"))\n</code></pre>\n\n<p>It worked perfectly with my older (but incorrect) regex:</p>\n\n<pre><code>get.HandleFunc(\"/my/api/user/{userID:[0-9]{1,}}\", app.Handle(\"user\"))\n</code></pre>\n\n<p>I wonder what is wrong with my new regex. I tried to test it on some websites and also by using the <code>regexp</code> package in Go, and it always worked. As far as I know, <code>gorilla/mux</code> uses Go's <code>regexp</code> package. Any idea?</p>\n\n<p>What I want is to detect positive integers excluding zero.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443282373, "post_id": 32798898, "comment_id": 53435473, "body": "This seems more appropriate for the mailing list or filing an issue."}, {"owner": {"reputation": 4106, "user_id": 3634032, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PDCW3.jpg?s=128&g=1", "display_name": "Sam Herrmann", "link": "https://stackoverflow.com/users/3634032/sam-herrmann"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443307962, "post_id": 32798898, "comment_id": 53442877, "body": "Ah yes I think you&#39;re right. For anyone interested in this, see the filed issue <a href=\"https://github.com/golang/go/issues/12764\" rel=\"nofollow noreferrer\">here</a>."}], "owner": {"reputation": 4106, "user_id": 3634032, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PDCW3.jpg?s=128&g=1", "display_name": "Sam Herrmann", "link": "https://stackoverflow.com/users/3634032/sam-herrmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1443282129, "creation_date": 1443282129, "question_id": 32798898, "link": "https://stackoverflow.com/questions/32798898/nosplit-stack-overflow-when-cross-compiling-in-go-1-5-1", "title": "nosplit stack overflow when cross compiling in Go 1.5.1", "body": "<p>I'm trying to cross compile my Go project on windows/amd64 for linux/386, but get a \"nosplit stack overflow\" error. I followed the instructions that are outlined <a href=\"http://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5\" rel=\"nofollow\">here</a>. With <code>GOOS=linux</code> and <code>GOARCH=386</code>, my <code>go env</code> looks as follows:</p>\n\n<pre><code>set GOARCH=386\nset GOBIN=\nset GOEXE=\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=linux\nset GOPATH=C:\\dev\\gopath\nset GORACE=\nset GOROOT=C:\\Go\nset GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_amd64\nset GO15VENDOREXPERIMENT=0\nset CC=gcc\nset GOGCCFLAGS=-fPIC -m32 -fmessage-length=0\nset CXX=g++\nset CGO_ENABLED=0\n</code></pre>\n\n<p>The complete error I get when running <code>go build</code> is:</p>\n\n<pre><code>runtime.cgocall: nosplit stack overflow\n508     assumed on entry to runtime.cgocall (nosplit)\n464     after runtime.cgocall (nosplit) uses 44\n460     on entry to runtime.exitsyscall (nosplit)\n272     after runtime.exitsyscall (nosplit) uses 188\n268     on entry to runtime.exitsyscallfast (nosplit)\n108     after runtime.exitsyscallfast (nosplit) uses 160\n104     on entry to runtime.writebarrierptr (nosplit)\n64      after runtime.writebarrierptr (nosplit) uses 40\n60      on entry to runtime.writebarrierptr_nostore1 (nosplit)\n8       after runtime.writebarrierptr_nostore1 (nosplit) uses 52\n4       on entry to runtime.acquirem (nosplit)\n-12     after runtime.acquirem (nosplit) uses 16 runtime.cgocallbackg: nosplit stack overflow\n508     assumed on entry to runtime.cgocallbackg (nosplit)\n460     after runtime.cgocallbackg (nosplit) uses 48\n456     on entry to runtime.exitsyscall (nosplit)\n268     after runtime.exitsyscall (nosplit) uses 188\n264     on entry to runtime.exitsyscallfast (nosplit)\n104     after runtime.exitsyscallfast (nosplit) uses 160\n100     on entry to runtime.writebarrierptr (nosplit)\n60      after runtime.writebarrierptr (nosplit) uses 40\n56      on entry to runtime.writebarrierptr_nostore1 (nosplit)\n4       after runtime.writebarrierptr_nostore1 (nosplit) uses 52\n0       on entry to runtime.acquirem (nosplit)\n-16     after runtime.acquirem (nosplit) uses 16 runtime.cgocallback_gofunc: nosplit stack overflow\n508     assumed on entry to runtime.cgocallback_gofunc (nosplit)\n496     after runtime.cgocallback_gofunc (nosplit) uses 12\n492     on entry to runtime.cgocallbackg (nosplit)\n444     after runtime.cgocallbackg (nosplit) uses 48\n440     on entry to runtime.exitsyscall (nosplit)\n252     after runtime.exitsyscall (nosplit) uses 188\n248     on entry to runtime.exitsyscallfast (nosplit)\n88      after runtime.exitsyscallfast (nosplit) uses 160\n84      on entry to runtime.writebarrierptr (nosplit)\n44      after runtime.writebarrierptr (nosplit) uses 40\n40      on entry to runtime.writebarrierptr_nostore1 (nosplit)\n-12     after runtime.writebarrierptr_nostore1 (nosplit) uses 52\n</code></pre>\n\n<p>Other target configurations that do work are <code>GOOS=windows GOARCH=386</code> and <code>GOOS=linux GOARCH=amd64</code>, but <code>GOOS=linux GOARCH=386</code> does not work. Any ideas?</p>\n"}, {"tags": ["windows", "unix", "go", "file-locking", "flock"], "comments": [{"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443280110, "post_id": 32798354, "comment_id": 53434809, "body": "I am not asking for mandatory file locking"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443280707, "post_id": 32798354, "comment_id": 53434995, "body": "OK, you just need LockFile[Ex] on windows. I think you&#39;re going to have to hook into that win cgo (maybe there&#39;s a way to get it from a system dll via syscall; sorry, not a windows guy)"}, {"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443281126, "post_id": 32798354, "comment_id": 53435110, "body": "@JimB but is there another way without having to invoke system specific calls and using unsafe?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1443281307, "post_id": 32798354, "comment_id": 53435162, "body": "Perhaps you can do that indirectly using sockets or something, separate from the file itself?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443281874, "post_id": 32798354, "comment_id": 53435302, "body": "You need to use a system specific call of some sort, because you want system specific behavior. Even if you use a proxy for the lock of some sort, like programs often do with a symlink on unix, it&#39;s still going to be specific for windows."}, {"owner": {"reputation": 741, "user_id": 116973, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58f3dd702b0b3beb1274a25326ab2069?s=128&d=identicon&r=PG", "display_name": "Martin M.", "link": "https://stackoverflow.com/users/116973/martin-m"}, "edited": false, "score": 0, "creation_date": 1501493935, "post_id": 32798354, "comment_id": 77784983, "body": "If you do not want to rely on the actual platform handling this why is a Mutex or a channel that simply serializes the access not enough?"}, {"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "edited": false, "score": 0, "creation_date": 1508303811, "post_id": 32798354, "comment_id": 80553074, "body": "because I wanted the record to survive server crashes, hence use file"}], "answers": [{"tags": [], "owner": {"reputation": 741, "user_id": 116973, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58f3dd702b0b3beb1274a25326ab2069?s=128&d=identicon&r=PG", "display_name": "Martin M.", "link": "https://stackoverflow.com/users/116973/martin-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1501493838, "creation_date": 1501493838, "answer_id": 45412256, "question_id": 32798354, "link": "https://stackoverflow.com/questions/32798354/how-to-implement-cross-platform-file-lock-in-go/45412256#45412256", "title": "How to implement cross platform file lock in GO", "body": "<p>Use compiler flags.</p>\n\n<p>Flags for windows:</p>\n\n<pre><code>// +build windows,!linux\n...\n</code></pre>\n\n<p>Flags for linux:</p>\n\n<pre><code>// +build linux,!windows\n...\n</code></pre>\n\n<p>If you want to use platform native locking functions.</p>\n\n<p>A workaround might be to allocate resources which are (supposedly) singletons across platforms like binding to a port and relying on that being possible only once. The error condition of the bind operation will be the deciding factor.</p>\n\n<p>Personally I'd go with the option to use platform native options and just make an interface so that one can add tests easily and thereby make sure that things won't break.</p>\n"}], "owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 0, "accepted_answer_id": 45412256, "answer_count": 1, "score": 3, "last_activity_date": 1501493838, "creation_date": 1443278405, "last_edit_date": 1443281660, "question_id": 32798354, "link": "https://stackoverflow.com/questions/32798354/how-to-implement-cross-platform-file-lock-in-go", "title": "How to implement cross platform file lock in GO", "body": "<p>I need to implement the following behavior in GO:</p>\n\n<ol>\n<li>A process should be able to read a file irrespective if any other process has locked the file for writing</li>\n<li>A process should obtain a write lock, before it can write to the file. This is to ensure that multiple processes cannot write to the same file </li>\n<li>A process should not wait to obtain the write lock, if it cannot obtain a lock it should move on</li>\n</ol>\n\n<p>For UNIX based systems, syscall package in GO defines flock function, which could be used to implement the above behaviour in the following manner:</p>\n\n<ol>\n<li>Use syscall.flock function with LOCK_EX | LOCK_NB to try and obtain a lock before writing to the file</li>\n<li>Do  not check for any locks before reading from the file</li>\n</ol>\n\n<p>syscall package for Windows in GO, does not include flock. Given this, how best can I write code that can execute cross-platform and has the behavior described above? </p>\n\n<p>I want to try and achieve this without making OS specific calls or using unsafe. </p>\n\n<p>PS: I do not want mandatory file locking, the processes will check for file lock before performing file operations</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1443277664, "post_id": 32798061, "comment_id": 53434075, "body": "To remove the first value <code>v</code> from slice <code>s</code> you could do: <code>for i := range s { if s[i] == v { s = append(s[:i], s[i+1:]...); break}</code> (or <a href=\"https://play.golang.org/p/t1KsxF6B3g\" rel=\"nofollow noreferrer\">play.golang.org/p/t1KsxF6B3g</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1443284968, "post_id": 32798269, "comment_id": 53436218, "body": "Thanks. But what if someStruct has another struct embedded, or a pointer to a struct, can I still compare them with the equality sign &quot;==&quot; ?"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1443285059, "post_id": 32798269, "comment_id": 53436254, "body": "What is it that is beeing compared? Is the the values inside the struct, or the memory location of the struct?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1443304181, "post_id": 32798269, "comment_id": 53441944, "body": "the value is being compared.  if you have an embedded pointer, i believe that the pointer&#39;s value is what is compared."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1443304502, "post_id": 32798269, "comment_id": 53442023, "body": "Thank you that was very helpful."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 1, "last_activity_date": 1443277857, "creation_date": 1443277857, "answer_id": 32798269, "question_id": 32798061, "link": "https://stackoverflow.com/questions/32798061/how-can-i-remove-a-struct-from-a-slice-of-structs-in-go/32798269#32798269", "title": "How can I remove a struct from a slice of structs in Go?", "body": "<p>You find the element and make a new slice minus that index.</p>\n\n<p>Example on <a href=\"http://play.golang.org/p/99Pl3d-mY5\" rel=\"nofollow\">Playground</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype someStruct struct {\n    someInt    int\n    someString string\n}\n\nfunc removeIt(ss someStruct, ssSlice []someStruct) []someStruct {\n    for idx, v := range ssSlice {\n        if v == ss {\n            return append(ssSlice[0:idx], ssSlice[idx+1:]...)\n        }\n    }\n    return ssSlice\n}\nfunc main() {\n    someStructs := []someStruct{\n        {1, \"one\"},\n        {2, \"two\"},\n        {3, \"three\"},\n    }\n    fmt.Println(\"Before:\", someStructs)\n    someStructs = removeIt(someStruct{2, \"two\"}, someStructs)\n    fmt.Println(\"After:\", someStructs)\n}\n</code></pre>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 1, "accepted_answer_id": 32798269, "answer_count": 1, "score": -2, "last_activity_date": 1443277857, "creation_date": 1443276524, "question_id": 32798061, "link": "https://stackoverflow.com/questions/32798061/how-can-i-remove-a-struct-from-a-slice-of-structs-in-go", "title": "How can I remove a struct from a slice of structs in Go?", "body": "<p>How can I remove a user defined struct from a user defined slice of user defined structs?</p>\n\n<p>Something like this:</p>\n\n<pre><code>type someStruct struct {\n    someOtherStruct *typeOfOtherStruct\n    someInt         int\n    someString      string\n}\n\nvar someStructs []someStruct\n\nfunc someFunc(ss someStruct, ssSlice someStructs) {\n    // ..  want to remove ss from ssSlice\n}\n</code></pre>\n\n<p>I probably should loop til I find the index, and then remove it. But how do I compare the structs?</p>\n"}, {"tags": ["file", "go", "checksum"], "answers": [{"tags": [], "owner": {"reputation": 2025, "user_id": 1359137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1da62381332ae241f4a28acf7c2f5f52?s=128&d=identicon&r=PG", "display_name": "Animesh Kumar Paul", "link": "https://stackoverflow.com/users/1359137/animesh-kumar-paul"}, "is_accepted": true, "score": 3, "last_activity_date": 1443271976, "creation_date": 1443271976, "answer_id": 32797402, "question_id": 32797394, "link": "https://stackoverflow.com/questions/32797394/how-to-calculate-checksum-of-a-file-in-go/32797402#32797402", "title": "How to calculate checksum of a file in GO", "body": "<p>You can do that by :</p>\n\n<pre><code>f, err := os.Open(path)\nif err != nil {\n    glog.Fatal(err)\n}\ndefer f.Close()\n\nhasher := sha256.New()\nif _, err := io.Copy(hasher, f); err != nil {\n    glog.Fatal(err)\n}\nvalue:= hex.EncodeToString(hasher.Sum(nil))\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5379250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30415a7d60fe419fd766e14606accd6?s=128&d=identicon&r=PG&f=1", "display_name": "Alvina", "link": "https://stackoverflow.com/users/5379250/alvina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 2, "accepted_answer_id": 32797402, "answer_count": 1, "score": 2, "last_activity_date": 1443272615, "creation_date": 1443271918, "question_id": 32797394, "link": "https://stackoverflow.com/questions/32797394/how-to-calculate-checksum-of-a-file-in-go", "title": "How to calculate checksum of a file in GO", "body": "<p>I need calculate checksum of a file to determine the integrity of data of existing file. I need it for large files to avoid the download. Can you give me any idea?</p>\n"}, {"tags": ["go", "udp", "multicast"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1443289769, "post_id": 32797164, "comment_id": 53437674, "body": "Have you called <code>socket.JoinGroup</code> ?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1443333592, "post_id": 32797164, "comment_id": 53447144, "body": "@nos You don&#39;t have join a multicast group to send to it."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 3, "last_activity_date": 1443332492, "last_edit_date": 1443332492, "creation_date": 1443278596, "answer_id": 32798381, "question_id": 32797164, "link": "https://stackoverflow.com/questions/32797164/golang-doesnt-send-udp-packet-to-multicast-group/32798381#32798381", "title": "Golang doesn&#39;t send UDP packet to multicast group", "body": "<p>Did you try to listen for it on another host?  </p>\n\n<p>Go (at least in 1.4) had a hard coded disable of loopback on multicast.  Which means that, you can't see your own packets.</p>\n\n<p>You can override this by calling setsockopt on the socket FD itself, or:</p>\n\n<p>The <a href=\"https://godoc.org/golang.org/x/net/ipv6#PacketConn.SetMulticastLoopback\" rel=\"nofollow\">golang.org/x/net/ipv6</a> library can do this for you.</p>\n\n<p>Or you can take the code from <a href=\"https://github.com/golang/net/blob/master/ipv6/dgramopt_posix.go#L85\" rel=\"nofollow\">Here</a> (have to poke around to find it)</p>\n"}], "owner": {"reputation": 328, "user_id": 1273597, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/201dd4f8328425cc445ac098d2d20f22?s=128&d=identicon&r=PG", "display_name": "Till Klocke", "link": "https://stackoverflow.com/users/1273597/till-klocke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1498, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1443332492, "creation_date": 1443270451, "question_id": 32797164, "link": "https://stackoverflow.com/questions/32797164/golang-doesnt-send-udp-packet-to-multicast-group", "title": "Golang doesn&#39;t send UDP packet to multicast group", "body": "<p>currently I try to reimplement a C application in go. Part of the C application is to send a string to a multicast group. This produces the following packet captured via tcpdump:</p>\n\n<pre><code>00000000  d4 c3 b2 a1 02 00 04 00  00 00 00 00 00 00 00 00  |................|\n00000010  ff ff 00 00 01 00 00 00  14 81 06 56 47 2c 01 00  |...........VG,..|\n00000020  46 00 00 00 46 00 00 00  33 33 00 02 10 01 04 ce  |F...F...33......|\n00000030  ef ca fe 1a 86 dd 60 00  00 00 00 10 11 01 fe 80  |......`.........|\n00000040  00 00 00 00 00 00 06 ce  ef ff fe ca fe 1a ff 02  |................|\n00000050  00 00 00 00 00 00 00 00  00 00 00 02 10 01 be 8f  |................|\n00000060  03 e9 00 10 99 68 6e 6f  64 65 69 6e 66 6f        |.....hnodeinfo|\n</code></pre>\n\n<p>I tried to replicate the behavior with the following code:</p>\n\n<pre><code>const MultiCastGroup string = \"ff02:0:0:0:0:0:2:1001\"\nconst Port int = 1001\nconst Proto string = \"udp6\"\nconst MaxDataGramSize int = 8192\n\nvar announcedAddr = &amp;net.UDPAddr{IP: net.ParseIP(MultiCastGroup), Port: Port}\n\nbuf := []byte(\"nodeinfo\")\nunicastConn, _ := net.ListenUDP(Proto, &amp;net.UDPAddr{IP: net.IPv6zero, Port: 0})\nunicastConn.WriteToUDP(buf, announcedAddr)\n</code></pre>\n\n<p>But the I don't think that it is working, because all I can capture from this via tcpdump is:</p>\n\n<pre><code>00000000  d4 c3 b2 a1 02 00 04 00  00 00 00 00 00 00 00 00  |................|\n00000010  ff ff 00 00 01 00 00 00                           |........|\n00000018\n</code></pre>\n\n<p>It doesn't seem that the packet is even send. I tried this on a Debian Wheezy machine. Did anyone if you encounter a similar problem with golang and UDP?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "edited": false, "score": 0, "creation_date": 1443271775, "post_id": 32796959, "comment_id": 53432390, "body": "Why would you want an explicit cast to float32?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "edited": false, "score": 0, "creation_date": 1443274038, "post_id": 32796959, "comment_id": 53433003, "body": "@favoretti: <code>strconv.ParseFloat</code> returns type <code>float64</code>. not type <code>float32</code>: <code>func ParseFloat(s string, bitSize int) (f float64, err error)</code>. Go requires explicit conversions."}, {"owner": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1443274254, "post_id": 32796959, "comment_id": 53433071, "body": "@peterSO I know, but why just not to keep coordinates in <code>float64</code>, that&#39;s what I mean."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "edited": false, "score": 0, "creation_date": 1443275364, "post_id": 32796959, "comment_id": 53433387, "body": "@favoretti Perhaps <code>float32</code> is an API requirement?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "edited": false, "score": 0, "creation_date": 1443275547, "post_id": 32796959, "comment_id": 53433435, "body": "@favoretti: <code>float32</code> is sufficiently accurate for GPS coordinate precision: <a href=\"http://wiki.xkcd.com/geohashing/GPS_accuracy\" rel=\"nofollow noreferrer\">Coordinate precision: GPS accuracy</a>."}], "answers": [{"comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1443295741, "post_id": 32797673, "comment_id": 53439502, "body": "Would it be appropriate to define a global empty <code>Coordinate{}</code> and return it in case of errors or is it generally not desirable (or useless)?"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1443523485, "post_id": 32797673, "comment_id": 53518160, "body": "@coredump, it will not be faster/more memory efficient as the value is returned via stack."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1443274879, "last_edit_date": 1443274879, "creation_date": 1443273761, "answer_id": 32797673, "question_id": 32796959, "link": "https://stackoverflow.com/questions/32796959/how-do-i-write-this-verbose-golang-code-more-efficient-compact/32797673#32797673", "title": "How do I write this (verbose) Golang code more efficient/compact?", "body": "<p>The most important thing is that you write code that produces correct results with useful error messages. Check for errors. For example,</p>\n\n<pre><code>type Coordinate struct {\n    Latitude  float32\n    Longitude float32\n}\n\n// GetSegments Retrieve segments near given coordinate.\n// http://localhost:8080/segments?near=14.52872,52.21244\nfunc GetSegments(w http.ResponseWriter, r *http.Request) (Coordinate, error) {\n    const fnc = \"GetSegments\"\n    near := r.FormValue(\"near\")\n    if len(near) == 0 {\n        return Coordinate{}, fmt.Errorf(\"%s: near coordinates missing\", fnc)\n    }\n    latlon := strings.Split(near, \",\")\n    if len(latlon) != 2 {\n        return Coordinate{}, fmt.Errorf(\"%s: near coordinates error: %s\", fnc, near)\n    }\n    lat, err := strconv.ParseFloat(latlon[0], 32)\n    if err != nil {\n        return Coordinate{}, fmt.Errorf(\"%s: near latitude: %s: %s\", fnc, latlon[0], err)\n    }\n    lon, err := strconv.ParseFloat(latlon[1], 32)\n    if err != nil {\n        return Coordinate{}, fmt.Errorf(\"%s: near longitude: %s: %s\", fnc, latlon[1], err)\n    }\n    coord := Coordinate{\n        Latitude:  float32(lat),\n        Longitude: float32(lon),\n    }\n    fmt.Println(coord)\n    return coord, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 592, "user_id": 787190, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f16e13307dcb73c915d265c2757bfa5?s=128&d=identicon&r=PG", "display_name": "Ophidian", "link": "https://stackoverflow.com/users/787190/ophidian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1443274879, "creation_date": 1443268995, "question_id": 32796959, "link": "https://stackoverflow.com/questions/32796959/how-do-i-write-this-verbose-golang-code-more-efficient-compact", "title": "How do I write this (verbose) Golang code more efficient/compact?", "body": "<p>How can I write this block more compact? I think it's a lot of lines of code to write something so simple.</p>\n\n<pre><code>// GetSegments Retrieve segments near given coordinate.\nfunc GetSegments(w http.ResponseWriter, r *http.Request) {\n  near := r.FormValue(\"near\")\n  givenCoordinate := strings.Split(near, \",\")\n\n  lat, _ := strconv.ParseFloat(givenCoordinate[0], 32)\n  lon, _ := strconv.ParseFloat(givenCoordinate[1], 32)\n\n  lat32 := float32(lat)\n  lon32 := float32(lon)\n\n  coord := Coordinate{\n      Latitude:  lat32,\n      Longitude: lon32}\n\n  fmt.Println(coord)\n}\n</code></pre>\n\n<p>This block of code is called via a web API: \n<a href=\"http://localhost:8080/segments?near=14.52872,52.21244\" rel=\"nofollow\">http://localhost:8080/segments?near=14.52872,52.21244</a></p>\n\n<p>I really like Go, but this is one of the things where I'm wondering if I'm using it right..</p>\n"}, {"tags": ["android", "intellij-idea", "go"], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 3, "last_activity_date": 1443604409, "creation_date": 1443604409, "answer_id": 32862251, "question_id": 32796464, "link": "https://stackoverflow.com/questions/32796464/google-go-language-plugin-with-androidstudio/32862251#32862251", "title": "Google Go language plugin with AndroidStudio", "body": "<p>If you haven't installed already, install one of the latest version from here: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin#pre-release-builds\" rel=\"nofollow\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin#pre-release-builds</a> (either alpha or nightly).\nThen you can simply point the SDK to C:\\Go (if that's where the Go SDK is installed).</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 85, "user_id": 4831437, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d169cb0be235fd128d1b1aadeb406f34?s=128&d=identicon&r=PG&f=1", "display_name": "TheTonsOfCode", "link": "https://stackoverflow.com/users/4831437/thetonsofcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 32862251, "answer_count": 1, "score": 0, "last_activity_date": 1443604409, "creation_date": 1443265430, "question_id": 32796464, "link": "https://stackoverflow.com/questions/32796464/google-go-language-plugin-with-androidstudio", "title": "Google Go language plugin with AndroidStudio", "body": "<p>I am using AndroidStudio 1.2.2 and I have installed Google Go language plugin for IntelliJ Idea. I configure GOPATH and I compile and run first HelloWorld go in cmd, but i want to start learning make Android Go applications in AndroidStudio.</p>\n\n<p>But when i want to run file test1.go i get error:</p>\n\n<pre><code>Error running test1.go: No Go Sdk defined for this project\n</code></pre>\n\n<p>I found on other forum to do this by:</p>\n\n<pre><code>File &gt; Project Structure\n</code></pre>\n\n<p>but there I can only to add android/java library module and etc., (I add other java library modules, and google-play-services before).</p>\n\n<p>I don't know too about Go SDK must to be:<code>C:\\Go or C:\\Go\\bin</code></p>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1443261601, "post_id": 32795811, "comment_id": 53429787, "body": "You can bring the complete code for the reproducing comparison?"}, {"owner": {"reputation": 697, "user_id": 962019, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f2871326f312acbaa39d9d0dda4d3aa0?s=128&d=identicon&r=PG", "display_name": "ewhitt", "link": "https://stackoverflow.com/users/962019/ewhitt"}, "edited": false, "score": 0, "creation_date": 1443261918, "post_id": 32795811, "comment_id": 53429863, "body": "Last function: <a href=\"https://github.com/hedberg/django-mailgun-incoming/blob/master/mailgun_incoming/views.py\" rel=\"nofollow noreferrer\">github.com/hedberg/django-mailgun-incoming/blob/master/&hellip;</a>"}, {"owner": {"reputation": 150862, "user_id": 790387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/450fd2737dd0355700a574bd12842509?s=128&d=identicon&r=PG", "display_name": "Burhan Khalid", "link": "https://stackoverflow.com/users/790387/burhan-khalid"}, "edited": false, "score": 1, "creation_date": 1443262312, "post_id": 32795811, "comment_id": 53429970, "body": "Is there a reason you aren&#39;t using the <a href=\"https://github.com/mailgun/mailgun-go\" rel=\"nofollow noreferrer\"><code>mailgun-go</code> library</a>?"}, {"owner": {"reputation": 697, "user_id": 962019, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f2871326f312acbaa39d9d0dda4d3aa0?s=128&d=identicon&r=PG", "display_name": "ewhitt", "link": "https://stackoverflow.com/users/962019/ewhitt"}, "reply_to_user": {"reputation": 150862, "user_id": 790387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/450fd2737dd0355700a574bd12842509?s=128&d=identicon&r=PG", "display_name": "Burhan Khalid", "link": "https://stackoverflow.com/users/790387/burhan-khalid"}, "edited": false, "score": 0, "creation_date": 1443303634, "post_id": 32795811, "comment_id": 53441814, "body": "@BurhanKhalid, no inbound parsing support"}], "answers": [{"tags": [], "owner": {"reputation": 296564, "user_id": 34088, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8a4d6f03a8879432d8563aefbf48e787?s=128&d=identicon&r=PG", "display_name": "Aaron Digulla", "link": "https://stackoverflow.com/users/34088/aaron-digulla"}, "is_accepted": false, "score": 1, "last_activity_date": 1443262932, "last_edit_date": 1443262932, "creation_date": 1443262580, "answer_id": 32796068, "question_id": 32795811, "link": "https://stackoverflow.com/questions/32795811/creating-hash-in-go/32796068#32796068", "title": "Creating hash in Go", "body": "<p>The code is a bit easier to understand when you format it differently:</p>\n\n<pre><code>def verify_signature(self, token, timestamp, signature):\n    mac = hmac.new(\n        key=self.api_key,\n        msg='{0}{1}'.format(timestamp, token),\n        digestmod=hashlib.sha256\n    )\n    actual = mac.hexdigest()\n    return signature == actual\n</code></pre>\n\n<p>To answer your question: <code>hexdigest()</code> will convert the 64 byte array (= the result of applying SHA256 to the message) into a 128 character hex dump which is easier to handle (print/compare).</p>\n\n<p>Your Go code doesn't do the same thing. It's just the \"create <code>actual</code>\" part. You're missing the \"compare with expected <code>signature</code>\" part. If the expected <code>signature</code> is already a <code>[]byte</code> array in Go, you can use <code>hmac.Equal()</code> to check them.</p>\n\n<p>Note: You get the value of the hash with <code>mac.Sum(nil)</code>. See <a href=\"https://golang.org/src/crypto/hmac/hmac.go\" rel=\"nofollow\">https://golang.org/src/crypto/hmac/hmac.go</a></p>\n\n<p>If it's not, then you should try to convert the hex dump in <code>signature</code> into a <code>[]byte</code> array so you can compare the two.</p>\n"}], "owner": {"reputation": 697, "user_id": 962019, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f2871326f312acbaa39d9d0dda4d3aa0?s=128&d=identicon&r=PG", "display_name": "ewhitt", "link": "https://stackoverflow.com/users/962019/ewhitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1443262932, "creation_date": 1443260887, "question_id": 32795811, "link": "https://stackoverflow.com/questions/32795811/creating-hash-in-go", "title": "Creating hash in Go", "body": "<p>Disclaimer: I am new to Go </p>\n\n<p>I am trying to convert a Python function to Go:</p>\n\n<pre><code>def verify_signature(self, token, timestamp, signature):\n    return signature == hmac.new(key=self.api_key,\n        msg='{0}{1}'.format(timestamp, token),\n        digestmod=hashlib.sha256).hexdigest()\n</code></pre>\n\n<p>I think my Go function below is close to correct, but I do not understand the last line of the Python function \"digestmod=hashlib.sha256).hexdigest()\" to say for certain:</p>\n\n<pre><code>func verify_signature (api_key, token, timestamp) {\n    msg := fmt.Sprintf(\"%s%s\", timestamp, token)\n    mac := hmac.New(sha256.New, api_key)\n    mac.Write(msg) \n    return mac\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "edited": false, "score": 0, "creation_date": 1443273386, "post_id": 32795785, "comment_id": 53432828, "body": "Use <code>atomic.Value</code> from <code>sync&#47;atomic</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "edited": false, "score": 0, "creation_date": 1443293026, "post_id": 32796394, "comment_id": 53438665, "body": "You answer to &quot;Going mutex-less&quot; is &quot;use a mutex&quot;? I&#39;m sorry, that&#39;s not the right answer. I know I could have done it that way, but I&#39;m looking for the &quot;correct&quot; way, aka message-passing with channels."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "edited": false, "score": 0, "creation_date": 1443293500, "post_id": 32796394, "comment_id": 53438811, "body": "@BrianMalehorn: That is a correct way, and the most common. You asked for the advice of a &quot;go expert&quot;, and this is the way we would do it (for one, check how often this pattern is used throughout the std library)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "edited": false, "score": 0, "creation_date": 1443294073, "post_id": 32796394, "comment_id": 53439005, "body": "@BrianMalehorn: added an example with channels and a goroutine for synchronizing access"}, {"owner": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "edited": false, "score": 0, "creation_date": 1443295140, "post_id": 32796394, "comment_id": 53439325, "body": "Eh, I&#39;ll use a mutex if you say it&#39;s the right way.  However, the above code has a race. Thread 1 executes <code>send &lt;- p</code>, thread 2 executes <code>send &lt;- q</code>, thread 2 executes <code>&lt;-recv</code> and thread 1 executes <code>&lt;-recv</code>. Now they get each other&#39;s responses.  This would be an issue if you changed the above code a little: <a href=\"http://play.golang.org/p/ruNsFSgJau\" rel=\"nofollow noreferrer\">play.golang.org/p/ruNsFSgJau</a>"}, {"owner": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "edited": false, "score": 0, "creation_date": 1443295986, "post_id": 32796394, "comment_id": 53439579, "body": "Nevermind, I was thinking that the channels were buffered. The above code is correct."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1443293808, "last_edit_date": 1443293808, "creation_date": 1443264940, "answer_id": 32796394, "question_id": 32795785, "link": "https://stackoverflow.com/questions/32795785/going-mutex-less/32796394#32796394", "title": "Going mutex-less", "body": "<p>You would use an actual sync.Mutex:</p>\n\n<pre><code>var mutex sync.Mutex\n\nfunc next(p *int) int {\n    mutex.Lock()\n    defer mutex.Unlock()\n    x := *p\n    *p++\n    return x\n}\n</code></pre>\n\n<p>Though you would probably also group the <code>next</code> functionality, state and sync.Mutex into a single struct.</p>\n\n<p>Though there's no reason to do so in this case, since a Mutex is better suited for mutual exclusion around a single resource, you can use goroutines and channels to achieve the same effect</p>\n\n<p><a href=\"http://play.golang.org/p/RR4TQXf2ct\" rel=\"nofollow\">http://play.golang.org/p/RR4TQXf2ct</a></p>\n\n<pre><code>x := 0\n\nvar wg sync.WaitGroup\nsend := make(chan *int)\nrecv := make(chan int)\n\ngo func() {\n    for i := range send {\n        x := *i\n        *i++\n        recv &lt;- x\n    }\n}()\n\nfor i := 0; i &lt; 10; i++ {\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        send &lt;- &amp;x\n        fmt.Println(&lt;-recv)\n    }()\n}\nwg.Wait()\nfmt.Println(x)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "edited": false, "score": 0, "creation_date": 1443292776, "post_id": 32798500, "comment_id": 53438613, "body": "Ok, that&#39;s not really what I meant. What would you do if it was <code>*p = (*p + 1) * 5</code>? Or really anything that doesn&#39;t have an <code>atomic</code> version."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "edited": false, "score": 1, "creation_date": 1443306083, "post_id": 32798500, "comment_id": 53442421, "body": "as was already said, I&#39;d use sync.Mutex in your example.  Channels are too heavy of a construct to be used as a pure mutex.  It somewhat depends on the complexity of the critical section as to what to do, but in general, I wouldn&#39;t use a channel unless I can cary on with other actions asynchronously."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1443279444, "creation_date": 1443279444, "answer_id": 32798500, "question_id": 32795785, "link": "https://stackoverflow.com/questions/32795785/going-mutex-less/32798500#32798500", "title": "Going mutex-less", "body": "<p>As @favoretti mentioned, sync/atomic is a way to do it.</p>\n\n<p>But, you have to use int32 or int64 rather than int (since int can be different sizes on different platforms).</p>\n\n<p>Here's an example on <a href=\"http://play.golang.org/p/_QgkKfGoUj\" rel=\"nofollow\">Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync/atomic\"\n)\n\nfunc main() {\n    done := make(chan int)\n    x := int64(0)\n    for i := 0; i &lt; 10; i++ {\n        go func() {\n            y := next(&amp;x)\n            fmt.Println(y)\n            done &lt;- 0\n        }()\n    }\n    for i := 0; i &lt; 10; i++ {\n        &lt;-done\n    }\n    fmt.Println(x)\n\n}\n\nfunc next(p *int64) int64 {\n    return atomic.AddInt64(p, 1) - 1\n}\n</code></pre>\n"}], "owner": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1443293808, "creation_date": 1443260771, "question_id": 32795785, "link": "https://stackoverflow.com/questions/32795785/going-mutex-less", "title": "Going mutex-less", "body": "<p>Alright, Go \"experts\". How would you write this code in idiomatic Go, aka without a mutex in <code>next</code>?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    done := make(chan int)\n    x := 0\n    for i := 0; i &lt; 10; i++ {\n        go func() {\n            y := next(&amp;x)\n            fmt.Println(y)\n            done &lt;- 0\n        }()\n    }\n    for i := 0; i &lt; 10; i++ {\n        &lt;-done\n    }\n    fmt.Println(x)\n\n}\n\nvar mutex = make(chan int, 1)\n\nfunc next(p *int) int {\n    mutex &lt;- 0\n    // critical section BEGIN\n    x := *p\n    *p++\n    // critical section END\n    &lt;-mutex\n    return x\n\n}\n</code></pre>\n\n<p>Assume you can't have two goroutines in the critical section at the same time, or else bad things will happen.</p>\n\n<p>My first guess is to have a separate goroutine to handle the state, but I can't figure out a way to match up inputs / outputs.</p>\n"}, {"tags": ["opengl", "go"], "comments": [{"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1443262836, "post_id": 32795470, "comment_id": 53430090, "body": "<code>len(s.vertexData) * 12</code> looks wrong for me. Since there are two floats per vertex, shouldn&#39;t you multiply with 8 instead of 12?"}, {"owner": {"reputation": 438, "user_id": 5378868, "user_type": "registered", "profile_image": "https://graph.facebook.com/135713123447192/picture?type=large", "display_name": "Ozzadar", "link": "https://stackoverflow.com/users/5378868/ozzadar"}, "reply_to_user": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1443267219, "post_id": 32795470, "comment_id": 53431190, "body": "yeah, I had already fixed that after taking the screenshot.   I&#39;ve been messing around and I think it may be a limitation to how golang handles structs.   Keeping the buffer as a basic array without structs works flawlessly though changing it to structs gives me issues =x"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "edited": false, "score": 0, "creation_date": 1443293064, "post_id": 32795470, "comment_id": 53438678, "body": "What happens if you change line 70 to <code>&amp;s.vertexData[0]</code>? That changed from your original"}], "owner": {"reputation": 438, "user_id": 5378868, "user_type": "registered", "profile_image": "https://graph.facebook.com/135713123447192/picture?type=large", "display_name": "Ozzadar", "link": "https://stackoverflow.com/users/5378868/ozzadar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443258510, "creation_date": 1443258510, "question_id": 32795470, "link": "https://stackoverflow.com/questions/32795470/golang-opengl-vertex-struct", "title": "Golang OpenGL Vertex Struct", "body": "<p>I'm working on an OpenGL application in Golang and am having some odd issues with getting Vertices to render properly after converting them to a struct instead of an array of point positions.</p>\n\n<p>As an array of points, it works well though after changing it to a struct the behaviour is quite odd. It either flickers and then disappears or doesn't appear at all on launch.</p>\n\n<p>I imagine I'm just doing something wrong somewhere in the OpenGL calls, though I can't imagine what it is. I'm fairly certain that doing it in this manner would work well in C++.</p>\n\n<p>I've attached the before and after code of what I changed.</p>\n\n<p>Thanks for any and all help =)</p>\n\n<p>EDIT:: Oh, this behaviour happens when I change the *12 in the buffer length to *8, I was originally trying to do 3D coord, but that has the same effect.</p>\n\n<p><a href=\"http://i.stack.imgur.com/yGCiP.png\" rel=\"nofollow\">Before</a> |||  <a href=\"http://i.stack.imgur.com/yBKOU.png\" rel=\"nofollow\">After</a></p>\n"}, {"tags": ["go", "gorp"], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 2, "last_activity_date": 1443279572, "creation_date": 1443279572, "answer_id": 32798515, "question_id": 32795407, "link": "https://stackoverflow.com/questions/32795407/how-to-handle-null-values-in-gorp-select/32798515#32798515", "title": "How to handle null values in gorp Select", "body": "<p>Make whatever acctstarttime maps to a pointer to the type instead of a value of the type.</p>\n\n<p>if the col is null, the pointer will be nil.</p>\n\n<p>that or you can use the sql.NullXXX types, but I usually don't like those since they make everything else weird.</p>\n"}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 32798515, "answer_count": 1, "score": 0, "last_activity_date": 1443279572, "creation_date": 1443258086, "question_id": 32795407, "link": "https://stackoverflow.com/questions/32795407/how-to-handle-null-values-in-gorp-select", "title": "How to handle null values in gorp Select", "body": "<p>I'm trying to get the users from a DB as follow,</p>\n\n<pre><code>var users []User\n_, err := dbMap.Select(&amp;users, \"select id,username,acctstarttime,acctlastupdatedtime,acctstoptime from accounting order by id\")\n</code></pre>\n\n<p>Here I'm using <a href=\"https://github.com/go-gorp/gorp\" rel=\"nofollow\">gorp</a>. When there are null values present, this throws exception</p>\n\n<pre><code> Select failed sql: Scan error on column index 3: unsupported driver -&gt; Scan pair: &lt;nil&gt; -&gt; *string \n</code></pre>\n\n<p>How can I solve this issue?. Here I used gorp because of the ease of mapping the output to a struct array.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 27181, "user_id": 1070354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ca246e6d24b9a09114ff4542bcc2b1?s=128&d=identicon&r=PG", "display_name": "favoretti", "link": "https://stackoverflow.com/users/1070354/favoretti"}, "edited": false, "score": 2, "creation_date": 1443273241, "post_id": 32794549, "comment_id": 53432781, "body": "Well, a more technical explanation could mention that <code>go</code> keyword actually starts a method in a separate thread :)"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1443280131, "post_id": 32794549, "comment_id": 53434816, "body": "it MAY start a method in a separate thread.  Or it could do it in the same thread but switch between the main goroutine and the newly spawned fibonacci goroutine.  It is a minor point, but just wanted to make sure it is not confused with actual OS level threads."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 2, "last_activity_date": 1443250871, "creation_date": 1443250871, "answer_id": 32794549, "question_id": 32794466, "link": "https://stackoverflow.com/questions/32794466/the-go-keyword-in-go/32794549#32794549", "title": "The &quot;go&quot; keyword in Go", "body": "<p>You can think of it like this:</p>\n\n<p>With the <code>go</code> keyword, the <code>fibonacci</code> function is adding numbers onto the channel and the <code>for i := range c</code> loop is printing each number out <em>as soon</em> as it is added to the channel.</p>\n\n<p>Without the <code>go</code> keyword, the <code>fibonacci</code> function is called, adds <em>all</em> the numbers to the channel, and then returns, and <em>then</em> the <code>for</code> loop prints the numbers off the <code>channel</code>.</p>\n\n<p>One good way to see this is to put in a sleep (<a href=\"https://play.golang.org/p/0oNDy65N5t\" rel=\"nofollow\">playground link</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc fibonacci(n int, c chan int) {\n    x, y := 0, 1\n    for i := 0; i &lt; n; i++ {\n        time.Sleep(time.Second) // ADDED THIS SLEEP\n        c &lt;- x\n        x, y = y, x+y\n    }\n    close(c)\n}\n\nfunc main() {\n    c := make(chan int, 10)\n    go fibonacci(cap(c), c) // TOGGLE BETWEEN THIS\n    // fibonacci(cap(c), c) // AND THIS\n    for i := range c {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 977, "user_id": 1419809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Plto.jpg?s=128&g=1", "display_name": "Pauli", "link": "https://stackoverflow.com/users/1419809/pauli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 1, "accepted_answer_id": 32794549, "answer_count": 1, "score": 4, "last_activity_date": 1443268363, "creation_date": 1443250182, "last_edit_date": 1443268363, "question_id": 32794466, "link": "https://stackoverflow.com/questions/32794466/the-go-keyword-in-go", "title": "The &quot;go&quot; keyword in Go", "body": "<p>Here is the code example in \"A Tour of Go\" <a href=\"https://tour.golang.org/concurrency/4\" rel=\"nofollow\">Range and Close</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc fibonacci(n int, c chan int) {\n    x, y := 0, 1\n    for i := 0; i &lt; n; i++ {\n        c &lt;- x\n        x, y = y, x+y\n    }\n    close(c)\n}\n\nfunc main() {\n    c := make(chan int, 10)\n    go fibonacci(cap(c), c)\n    for i := range c {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p>On the fifth line from the bottom, when the <code>go</code> keyword was omitted, the result did not change. Did that mean the main goroutine sent values in the buffered channel and then took them out?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 4, "last_activity_date": 1443239103, "creation_date": 1443239103, "answer_id": 32793405, "question_id": 32793391, "link": "https://stackoverflow.com/questions/32793391/how-can-i-initialize-a-nested-map-inside-a-struct-in-go/32793405#32793405", "title": "How can I initialize a nested map inside a struct in Go?", "body": "<p>You have to make the child maps as well.</p>\n\n<pre><code>func (s *someStruct) Set(i int, k, v string) {\n    child, ok := s.nestedMap[i]\n    if !ok {\n        child = map[string]string{}\n        s.nestedMap[i] = child\n    }\n    child[k] = v\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/7K8aCQdAQs\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}, {"tags": [], "owner": {"reputation": 2025, "user_id": 1359137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1da62381332ae241f4a28acf7c2f5f52?s=128&d=identicon&r=PG", "display_name": "Animesh Kumar Paul", "link": "https://stackoverflow.com/users/1359137/animesh-kumar-paul"}, "is_accepted": false, "score": 1, "last_activity_date": 1443240230, "creation_date": 1443240230, "answer_id": 32793497, "question_id": 32793391, "link": "https://stackoverflow.com/questions/32793391/how-can-i-initialize-a-nested-map-inside-a-struct-in-go/32793497#32793497", "title": "How can I initialize a nested map inside a struct in Go?", "body": "<p>Initilize nested map like this:</p>\n\n<pre><code>temp := make(map[string]string,1)\ntemp [\"name\"]=\"Kube\"\nss.nestedMap [2] = temp\nfmt.Println(ss)\n</code></pre>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5767, "favorite_count": 0, "accepted_answer_id": 32793405, "answer_count": 2, "score": 5, "last_activity_date": 1443240230, "creation_date": 1443238876, "question_id": 32793391, "link": "https://stackoverflow.com/questions/32793391/how-can-i-initialize-a-nested-map-inside-a-struct-in-go", "title": "How can I initialize a nested map inside a struct in Go?", "body": "<p>If I have a nested map variable like this inside a struct:</p>\n\n<pre><code>type someStruct struct {\n    nestedMap map[int]map[string]string\n}\n\nvar ss = someStruct {\n    nestedMap: make(map[int]map[string]string),\n}\n</code></pre>\n\n<p>This does not work and does a runtime error.</p>\n\n<p>How do I initialize it?</p>\n"}, {"tags": ["go", "google-compute-engine"], "answers": [{"tags": [], "owner": {"reputation": 2025, "user_id": 1359137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1da62381332ae241f4a28acf7c2f5f52?s=128&d=identicon&r=PG", "display_name": "Animesh Kumar Paul", "link": "https://stackoverflow.com/users/1359137/animesh-kumar-paul"}, "is_accepted": true, "score": 3, "last_activity_date": 1443232637, "creation_date": 1443232637, "answer_id": 32792869, "question_id": 32792856, "link": "https://stackoverflow.com/questions/32792856/how-to-connect-to-client-in-gce-in-go/32792869#32792869", "title": "How to connect to client in GCE in GO", "body": "<p>Firstly, Need to create a credential for service account in GCE and it will download a json file and it will use for authorize the client.</p>\n\n<pre><code>Sample Code :\n\ndata, err := ioutil.ReadFile(\"downloadedfile.json\")\nif err != nil {\n   log.Fatal(err)\n}\nconf, err := google.JWTConfigFromJSON(data, compute.ComputeScope) // give the specific permission for this client.\nif err != nil {\n  log.Fatal(err)\n}\nclient = conf.Client(oauth2.NoContext)\n\ncomputeService, err := compute.New(client)\nif err != nil {\n        //...\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5370520"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 32792869, "answer_count": 1, "score": 0, "last_activity_date": 1443232637, "creation_date": 1443232534, "question_id": 32792856, "link": "https://stackoverflow.com/questions/32792856/how-to-connect-to-client-in-gce-in-go", "title": "How to connect to client in GCE in GO", "body": "<p>I can't able to connect to client. Is there any way to pass <code>private key id</code> and <code>private key</code> to client for get authorized?</p>\n\n<p>So, far i see:</p>\n\n<pre><code>ctx := context.Background()\n\nclient, err := google.DefaultClient(ctx, compute.ComputeScope)\n    if err != nil {\n            //...\n    }\ncomputeService, err := compute.New(client)\n    if err != nil {\n            //...\n    }\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1443280936, "post_id": 32791905, "comment_id": 53435061, "body": "you mentioned you were new, so note sure if you know this, but you can use: for _, q := range s.Query.Results.Quote { q.LastTradePriceOnly }  (as an easy iteration).  also, if you make LastTradePriceOnly a type float64 (or float32) it will parse in to numeric form.  don&#39;t do this if it sometimes is non-numeric"}, {"owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1443317267, "post_id": 32791905, "comment_id": 53444633, "body": "Thanks for the response David. I&#39;ll consider it :)"}], "tags": [], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "is_accepted": false, "score": 1, "last_activity_date": 1443222678, "creation_date": 1443222678, "answer_id": 32791905, "question_id": 32791864, "link": "https://stackoverflow.com/questions/32791864/how-to-fetch-values-from-json-in-golang/32791905#32791905", "title": "How to fetch values from JSON in golang", "body": "<p>I am new to golang and not aware of many data structures. But i figured out how to get the single value out of array of structure.</p>\n\n<pre><code>fmt.Println(s.Query.Results.Quote[0].LastTradePriceOnly)\n</code></pre>\n\n<p>this worked for me..I only have to iterate this in a loop to fetch all values.</p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 1920, "user_id": 4980029, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5fxH7.png?s=128&g=1", "display_name": "Vrushank Doshi", "link": "https://stackoverflow.com/users/4980029/vrushank-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1443280655, "creation_date": 1443222369, "last_edit_date": 1443280655, "question_id": 32791864, "link": "https://stackoverflow.com/questions/32791864/how-to-fetch-values-from-json-in-golang", "title": "How to fetch values from JSON in golang", "body": "<p>i have following piece of code which calls the yahoo finance api to get the stock values for given stock symbol.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n)\n\n//Response structure\ntype Response struct {\n    Query struct {\n        Count   int    `json:\"count\"`\n        Created string `json:\"created\"`\n        Lang    string `json:\"lang\"`\n        Results struct {\n            Quote []struct {\n                LastTradePriceOnly string `json:\"LastTradePriceOnly\"`\n            } `json:\"quote\"`\n        } `json:\"results\"`\n    } `json:\"query\"`\n}\n\nfunc main() {\n    var s Response\n    response, err := http.Get(\"http://query.yahooapis.com/v1/public/yql?q=select%20LastTradePriceOnly%20from%20yahoo.finance.quote%20where%20symbol%20in%20(%22AAPL%22,%22FB%22)&amp;format=json&amp;env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys\")\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    } else {\n        defer response.Body.Close()\n\n        contents, err := ioutil.ReadAll(response.Body)\n        json.Unmarshal([]byte(contents), &amp;s)\n        fmt.Println(s.Query.Results.Quote)\n\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(1)\n        }\n        fmt.Printf(\"%s\\n\", string(contents))\n    }\n}\n</code></pre>\n\n<p>fmt.Println(s.Query.Results.Quote) is giving me a multi value array since Quote is a array of structure. For eg: [{52.05},{114.25}]\nHow should i split it in a single value in golang ? \nFor eg: 52.05\n114.25</p>\n\n<p>Help is highly appreciated.\nThanks</p>\n"}, {"tags": ["indexing", "go", "slice"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1443215548, "post_id": 32790681, "comment_id": 53420435, "body": "why not use string? <a href=\"https://play.golang.org/p/72Zs58FbJd\" rel=\"nofollow noreferrer\">play.golang.org/p/72Zs58FbJd</a>"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6632, "user_id": 210547, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70ebc83b42f07ad8e3363085e722500e?s=128&d=identicon&r=PG", "display_name": "MDrollette", "link": "https://stackoverflow.com/users/210547/mdrollette"}, "edited": false, "score": 2, "creation_date": 1443216445, "post_id": 32790816, "comment_id": 53420763, "body": "@MDrollette: ranging over a string returns runes <a href=\"http://play.golang.org/p/hiqax-cmh8\" rel=\"nofollow noreferrer\">play.golang.org/p/hiqax-cmh8</a>"}, {"owner": {"reputation": 6632, "user_id": 210547, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70ebc83b42f07ad8e3363085e722500e?s=128&d=identicon&r=PG", "display_name": "MDrollette", "link": "https://stackoverflow.com/users/210547/mdrollette"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443217247, "post_id": 32790816, "comment_id": 53421045, "body": "@JimB I assume you would need to convert to <code>[]rune</code> if you wanted to index into the string directly and not via a <code>range</code>? <a href=\"https://play.golang.org/p/kFhQXUD4Ay\" rel=\"nofollow noreferrer\">play.golang.org/p/kFhQXUD4Ay</a>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 6632, "user_id": 210547, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70ebc83b42f07ad8e3363085e722500e?s=128&d=identicon&r=PG", "display_name": "MDrollette", "link": "https://stackoverflow.com/users/210547/mdrollette"}, "edited": false, "score": 1, "creation_date": 1443220458, "post_id": 32790816, "comment_id": 53422013, "body": "@MDrollette in general yes (if you want to index by rune/characters rather than by bytes). However, coming from <code>strconv.Itoa</code> you know each rune will be a single byte and so directly indexing the string will give the exact same values (i.e. in this example <code>rune(str[3]) == []rune(str)[3]</code>)"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1443215975, "creation_date": 1443215975, "answer_id": 32790816, "question_id": 32790681, "link": "https://stackoverflow.com/questions/32790681/golang-int-to-slice-conversion/32790816#32790816", "title": "Golang: int to slice conversion", "body": "<p>This is a two step process, first converting int to string, then iterating the string or converting to a slice. Because the built in range function lets you iterate each character in a string, I recommend keeping it as a string. Something like this;</p>\n\n<pre><code> import \"strconv\"\n str := strconv.Itoa(123456)\n for i, v := range str {\n      fmt.Println(v) //prints each char's ASCII value on a newline\n      fmt.Printf(\"%c\\n\", v) // prints the character value\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15871, "user_id": 2123530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a7fba006184897e8d74f1795e2835b?s=128&d=identicon&r=PG", "display_name": "\u03b2.\u03b5\u03b7\u03bf\u03b9\u03c4.\u03b2\u03b5", "link": "https://stackoverflow.com/users/2123530/%ce%b2-%ce%b5%ce%b7%ce%bf%ce%b9%cf%84-%ce%b2%ce%b5"}, "edited": false, "score": 1, "creation_date": 1570285941, "post_id": 58231817, "comment_id": 102869114, "body": "Please add at least some explanation as though why this answer the question"}, {"owner": {"reputation": 59, "user_id": 10571019, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z7JifMgOaGI/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAy_1Y6ujhUP1eJ_x3UWq5HhXGXFw/mo/photo.jpg?sz=128", "display_name": "MBB", "link": "https://stackoverflow.com/users/10571019/mbb"}, "reply_to_user": {"reputation": 15871, "user_id": 2123530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37a7fba006184897e8d74f1795e2835b?s=128&d=identicon&r=PG", "display_name": "\u03b2.\u03b5\u03b7\u03bf\u03b9\u03c4.\u03b2\u03b5", "link": "https://stackoverflow.com/users/2123530/%ce%b2-%ce%b5%ce%b7%ce%bf%ce%b9%cf%84-%ce%b2%ce%b5"}, "edited": false, "score": 0, "creation_date": 1570402913, "post_id": 58231817, "comment_id": 102892173, "body": "If I understand you correctly you want to convert <code>12345</code> to <code>[1, 2, 3, 4, 5]</code>. Am I not right?"}, {"owner": {"reputation": 407, "user_id": 1261057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/456e2da0d8fa5f2d68c6e0f3e0f24e22?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/1261057/ivan"}, "edited": false, "score": 0, "creation_date": 1571509624, "post_id": 58231817, "comment_id": 103268045, "body": "This is a good answer - but it reverses the order. To preserve the initial order, use <code>sequence = append([]int{i}, s...)</code> , instead."}], "tags": [], "owner": {"reputation": 59, "user_id": 10571019, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z7JifMgOaGI/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAy_1Y6ujhUP1eJ_x3UWq5HhXGXFw/mo/photo.jpg?sz=128", "display_name": "MBB", "link": "https://stackoverflow.com/users/10571019/mbb"}, "is_accepted": false, "score": 6, "last_activity_date": 1571602093, "last_edit_date": 1571602093, "creation_date": 1570174286, "answer_id": 58231817, "question_id": 32790681, "link": "https://stackoverflow.com/questions/32790681/golang-int-to-slice-conversion/58231817#58231817", "title": "Golang: int to slice conversion", "body": "<pre class=\"lang-golang prettyprint-override\"><code>func IntToSlice(n int64, sequence []int64) []int64 {\n    if n != 0 {\n        i := n % 10\n        // sequence = append(sequence, i) // reverse order output\n        sequence = append([]int64{i}, sequence...)\n        return IntToSlice(n/10, sequence)\n    }\n    return sequence\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10811142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5492e66ad39fc8283fd2123d5844dcf6?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 B.", "link": "https://stackoverflow.com/users/10811142/micha%c5%82-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1607861622, "creation_date": 1607861622, "answer_id": 65275470, "question_id": 32790681, "link": "https://stackoverflow.com/questions/32790681/golang-int-to-slice-conversion/65275470#65275470", "title": "Golang: int to slice conversion", "body": "<p>The above answers are correct. Here comes another version of MBB's answer.\nAvoiding recursion and efficient reverting may increase performance and reduce RAM consumption.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\nfunc reverseInt(s []int) {\n    for i, j := 0, len(s)-1; i &lt; j; i, j = i+1, j-1 {\n            s[i], s[j] = s[j], s[i]\n    }\n}\n\nfunc splitToDigits(n int) []int{\n    var ret []int\n    \n    for n !=0 {\n        ret = append(ret, n % 10)\n        n /= 10\n    }\n    \n    reverseInt(ret)\n    \n    return ret\n}\n\nfunc main() {\n    for _, n := range splitToDigits(12345) {\n        fmt.Println(n)\n    }\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/M3aOUnNIbdv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/M3aOUnNIbdv</a></p>\n"}], "owner": {"reputation": 25, "user_id": 5375798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e8163e62a1f3e2e603cae4565cf3b6?s=128&d=identicon&r=PG&f=1", "display_name": "DoctorJoy", "link": "https://stackoverflow.com/users/5375798/doctorjoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4180, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1607861622, "creation_date": 1443215230, "question_id": 32790681, "link": "https://stackoverflow.com/questions/32790681/golang-int-to-slice-conversion", "title": "Golang: int to slice conversion", "body": "<p>Total golang (and programming) noob!</p>\n\n<p>Given any six digit number, how could one output a slice where each character of that number is assigned an individual location within the slice?</p>\n\n<p>For instance, a slice (let's call it s) containing all of these characters, would have s[0]=first digit, s[1]=second digit, s[2]=third digit and so on. </p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["mongodb", "go", "concurrency", "mgo"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1443204823, "post_id": 32787999, "comment_id": 53415300, "body": "When using the code in the first example, do you close the returned session when you are done with it?"}, {"owner": {"reputation": 1691, "user_id": 4803192, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/2dd1e87601f8ded02fcb4e3e142c671c?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeAccents", "link": "https://stackoverflow.com/users/4803192/threeaccents"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1443209899, "post_id": 32787999, "comment_id": 53417704, "body": "@BravadaZadada yeah I&#39;m sending the session over a channel and then closing it"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1443209921, "post_id": 32787999, "comment_id": 53417719, "body": "You have a <a href=\"https://blog.golang.org/race-detector\" rel=\"nofollow noreferrer\">race</a> on your global pointer (assuming you ever call your <code>getSession</code> concurrently). You can&#39;t have <code>var x *T</code> and then safely do <code>if x == nil { x = \u2026 }</code> concurrently. One solution to that is to use <a href=\"https://golang.org/pkg/sync/#Once\" rel=\"nofollow noreferrer\"><code>sync.Once</code></a>. Another is to just initialize the global once at program start (in <code>init</code>, via <code>var x = getSession()</code>, in <code>main</code>, etc)."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1504860553, "post_id": 32787999, "comment_id": 79187028, "body": "What I usually do is to hand over a session, copy it and defer a close of the copied session."}], "answers": [{"tags": [], "owner": {"reputation": 11594, "user_id": 795896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SEIkR.jpg?s=128&g=1", "display_name": "Aidan Ewen", "link": "https://stackoverflow.com/users/795896/aidan-ewen"}, "is_accepted": false, "score": 1, "last_activity_date": 1522832051, "last_edit_date": 1522832051, "creation_date": 1522780653, "answer_id": 49637012, "question_id": 32787999, "link": "https://stackoverflow.com/questions/32787999/concurrently-using-the-same-mgo-session-in-go/49637012#49637012", "title": "Concurrently using the same mgo session in go", "body": "<p>The key is to duplicate the session and then close it when you've finished with it.</p>\n\n<pre><code>func GetMyData() []myMongoDoc {\n\n    sessionCopy, _ := getSession() // from the question above\n    defer sessionCopy.Close() // this is the important bit\n\n    results := make([]myMongoDoc, 0)\n    sessionCopy.DB(\"myDB\").C(\"myCollection\").Find(nil).All(&amp;results)\n    return results\n}\n</code></pre>\n\n<p>Having said that it looks like mgo doesn't actually expose control over the underlying connections (see the comment from <a href=\"https://github.com/go-mgo/mgo/issues/342#issuecomment-251764788\" rel=\"nofollow noreferrer\">Gustavo Niemeyer</a> who maintains the library). A session pretty much equates to a connection, but even if you call <code>Close()</code> on a session mgo keeps the connection alive. From reading around it seems that <code>Clone()</code> might be the way to go, as it reuses the underlying socket, this will avoid the 3 way handshake of creating a new socket (see <a href=\"https://github.com/go-mgo/mgo/issues/287\" rel=\"nofollow noreferrer\">here</a> for more discussion on the difference).</p>\n\n<p>Also see this <a href=\"https://stackoverflow.com/questions/26574594/best-practice-to-maintain-a-mgo-session#answer-26576589\">SO answer</a> describing a standard pattern to handle sessions.</p>\n"}], "owner": {"reputation": 1691, "user_id": 4803192, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/2dd1e87601f8ded02fcb4e3e142c671c?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeAccents", "link": "https://stackoverflow.com/users/4803192/threeaccents"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1522832051, "creation_date": 1443203770, "question_id": 32787999, "link": "https://stackoverflow.com/questions/32787999/concurrently-using-the-same-mgo-session-in-go", "title": "Concurrently using the same mgo session in go", "body": "<p>So I'm having some trouble figuring out best practices for using concurrency with a MongoDB in go. My first implementation of getting a session looked like this:</p>\n\n<pre><code>var globalSession *mgo.Session\n\nfunc getSession() (*mgo.Session, error) {\n    //Establish our database connection\n    if globalSession == nil {\n        var err error\n        globalSession, err = mgo.Dial(\":27017\")\n        if err != nil {\n            return nil, err\n        }\n\n        //Optional. Switch the session to a monotonic behavior.\n        globalSession.SetMode(mgo.Monotonic, true)\n    }\n\n    return globalSession.Copy(), nil\n}\n</code></pre>\n\n<p>This works great the trouble I'm running into is that mongo has a limit of 204 connections then it starts refusing connections <code>connection refused because too many open connections: 204</code>;however, the issue is since I'm calling <code>session.Copy()</code> it only returns a session and not an error. So event though the connection refused my program never thrown an error.</p>\n\n<p>Now what I though about doing is just having one session and using that instead of copy so I can have access to a connection error like so:</p>\n\n<pre><code>var session *mgo.Session = nil\n\nfunc NewSession() (*mgo.Session, error) {\n    if session == nil {\n        session, err = mgo.Dial(url)\n        if err != nil {\n            return nil, err\n        }\n    }\n\n    return session, nil\n}\n</code></pre>\n\n<p>Now the problem I have with this is that I don't know what would happen if I try to make concurrent usage of that same session. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 67712, "user_id": 155077, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MaCKR.jpg?s=128&g=1", "display_name": "Stefan Steiger", "link": "https://stackoverflow.com/users/155077/stefan-steiger"}, "edited": false, "score": 0, "creation_date": 1443199763, "post_id": 32786604, "comment_id": 53412783, "body": "That indeed explains why nobody does it. Cleaner syntax would declare the types, however. This is merely less verbose syntax, which achieves its goal by hiding relevant, non-redundant information, which is not the same IMHO."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 67712, "user_id": 155077, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MaCKR.jpg?s=128&g=1", "display_name": "Stefan Steiger", "link": "https://stackoverflow.com/users/155077/stefan-steiger"}, "edited": false, "score": 0, "creation_date": 1443199887, "post_id": 32786604, "comment_id": 53412863, "body": "@StefanSteiger yeah that&#39;s true. That last comment is entirely subjective. It&#39;s what&#39;s most common in Go though. I agree that it can be annoying because you have to look at docs/go to implementation to see what types are being assigned. I prefer slightly more verbose syntax though I don&#39;t know if it would work well with Go&#39;s multiple return types. In say C# I am strongly against declaring with <code>var</code> instead of providing the type on the LHS."}, {"owner": {"reputation": 67712, "user_id": 155077, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MaCKR.jpg?s=128&g=1", "display_name": "Stefan Steiger", "link": "https://stackoverflow.com/users/155077/stefan-steiger"}, "edited": false, "score": 1, "creation_date": 1443525766, "post_id": 32786604, "comment_id": 53519555, "body": "So true for C#. For example in a codereview, you&#39;d see immediately when you have IDatareader something = GetSomething(), but when you only have var something =  GetSomething(), you&#39;ll never notice it lacks a dispose or using."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 4, "last_activity_date": 1443198218, "creation_date": 1443198218, "answer_id": 32786604, "question_id": 32786496, "link": "https://stackoverflow.com/questions/32786496/golang-how-to-declare-returned-variables-with-type/32786604#32786604", "title": "Golang: How to declare returned variables WITH TYPE?", "body": "<p>That's because you're using <code>:=</code> in your assignment there and that is a convenience syntax to declare and assign. It makes it so you don't have to provide the type, I assume the compiler just implies it by what is returned/whatever types come from the right hand side. Instead you need to do this;</p>\n\n<pre><code>var dat []byte\nvar err error\n\ndat, err = ioutil.ReadFile(\"/tmp/dat\")\n</code></pre>\n\n<p>But no one does this because <code>dat, err := ioutil.ReadFile(\"/tmp/dat\")</code> is such a cleaner syntax.</p>\n"}], "owner": {"reputation": 67712, "user_id": 155077, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MaCKR.jpg?s=128&g=1", "display_name": "Stefan Steiger", "link": "https://stackoverflow.com/users/155077/stefan-steiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 32786604, "answer_count": 1, "score": -1, "last_activity_date": 1443198218, "creation_date": 1443197799, "question_id": 32786496, "link": "https://stackoverflow.com/questions/32786496/golang-how-to-declare-returned-variables-with-type", "title": "Golang: How to declare returned variables WITH TYPE?", "body": "<p>In GO, how do I declare the returned variables of a function WITH TYPE ? </p>\n\n<p>e.g. I have this code </p>\n\n<pre><code>dat, err := ioutil.ReadFile(\"/tmp/dat\")\ncheck(err)\nfmt.Print(string(dat))\n</code></pre>\n\n<p>but what I want is this:</p>\n\n<pre><code>var dat []byte, err error := ioutil.ReadFile(\"/tmp/dat\")\ncheck(err)\nfmt.Print(string(dat))\n</code></pre>\n\n<p>However, no matter how I try, I only get this output </p>\n\n<blockquote>\n  <p>syntax error: unexpected comma, expecting semicolon or newline or }</p>\n</blockquote>\n\n<p>I'm working without IDE, and as the number of variables increases, it's really idiotic to have to keep all the return values's types in short-term memory... let alone if somebody else has to read the code.</p>\n\n<p>How can I declare the returned tuple WITH type ? </p>\n"}, {"tags": ["arrays", "go", "initialization", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1443198795, "post_id": 32785319, "comment_id": 53412267, "body": "Just out of curiosity: Why would you want to avoid a for loop?"}, {"owner": {"reputation": 534, "user_id": 3199992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6bUFv.jpg?s=128&g=1", "display_name": "abadojack", "link": "https://stackoverflow.com/users/3199992/abadojack"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1443200836, "post_id": 32785319, "comment_id": 53413340, "body": "To reduce execution time."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 14, "last_activity_date": 1443199871, "last_edit_date": 1495539853, "creation_date": 1443194331, "answer_id": 32785452, "question_id": 32785319, "link": "https://stackoverflow.com/questions/32785319/how-do-i-initialize-an-array-without-using-a-for-loop-in-go/32785452#32785452", "title": "How do I initialize an array without using a for loop in Go?", "body": "<p>Using a <code>for</code> loop is the simplest solution. Creating an array or slice will always return you a zeroed value. Which in case of <code>bool</code> means all values will be <code>false</code> (the zero value of type <code>bool</code>).</p>\n\n<p>Note that using a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">Composite literal</a> you can create and initialize a slice or array, but that won't be any shorter:</p>\n\n<pre><code>b1 := []bool{true, true, true}\nb2 := [3]bool{true, true, true}\n</code></pre>\n\n<p>If you don't want to use a <code>for</code> loop, you can make it a little shorter by introducing a constant for the value <code>true</code>:</p>\n\n<pre><code>const T = true\nb3 := []bool{T, T, T}\n</code></pre>\n\n<p>If <code>n</code> is big, <code>for</code> is the simplest solution.</p>\n\n<p>Or you could switch the logic of your application, and use the array or slice to store the negated values in the slice, and that way the <em>\"all-false\"</em> zero value would be a good initial value. What I mean is that if your slice is to store if files are <em>present</em>, you could change the logic so the slice stores whether files are <em>missing</em>:</p>\n\n<pre><code>presents := []bool{true, true, true, true, true, true}\n\n// Is equivalent to:\n\nmissings := make([]bool, 6) // All false\n// missing=false means not missing, means present)\n</code></pre>\n\n<p>Also note that filling an array or slice with a specific value is known as a \"memset\" operation. Go does not have a builtin function for that, but for an efficient solution see this question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30614165/is-there-analog-of-memset-in-go\">Is there analog of memset in go?</a></p>\n"}, {"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1443199912, "post_id": 32786668, "comment_id": 53412875, "body": "for i := range A [ A[i] = true }"}], "tags": [], "owner": {"reputation": 2025, "user_id": 1359137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1da62381332ae241f4a28acf7c2f5f52?s=128&d=identicon&r=PG", "display_name": "Animesh Kumar Paul", "link": "https://stackoverflow.com/users/1359137/animesh-kumar-paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1443198403, "creation_date": 1443198403, "answer_id": 32786668, "question_id": 32785319, "link": "https://stackoverflow.com/questions/32785319/how-do-i-initialize-an-array-without-using-a-for-loop-in-go/32786668#32786668", "title": "How do I initialize an array without using a for loop in Go?", "body": "<p>Make initilization using range function without knowing the number of elements in the array.</p>\n\n<pre><code>for i,_:=range(A){A[i] = true}\n</code></pre>\n"}], "owner": {"reputation": 534, "user_id": 3199992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6bUFv.jpg?s=128&g=1", "display_name": "abadojack", "link": "https://stackoverflow.com/users/3199992/abadojack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5922, "favorite_count": 2, "answer_count": 2, "score": 6, "last_activity_date": 1443253101, "creation_date": 1443193909, "last_edit_date": 1443253101, "question_id": 32785319, "link": "https://stackoverflow.com/questions/32785319/how-do-i-initialize-an-array-without-using-a-for-loop-in-go", "title": "How do I initialize an array without using a for loop in Go?", "body": "<p>I have an array <code>A</code> of boolean values, indexed by integers <code>0</code> to <code>n</code>, all initially set to <code>true</code>.</p>\n\n<p>My current implementation is :</p>\n\n<pre><code>for i := 0; i &lt; n; i++ {\n    A[i] = true\n}\n</code></pre>\n"}, {"tags": ["arrays", "regex", "string", "go", "split"], "answers": [{"comments": [{"owner": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "reply_to_user": {"reputation": 217, "user_id": 4443249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100000487150108/picture?type=large", "display_name": "nanolab", "link": "https://stackoverflow.com/users/4443249/nanolab"}, "edited": false, "score": 0, "creation_date": 1443193001, "post_id": 32784653, "comment_id": 53408719, "body": "@nanolab true. I&#39;ve found a solution with lookahead but it&#39;s not supported by go..."}], "tags": [], "owner": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "is_accepted": false, "score": 0, "last_activity_date": 1443193071, "last_edit_date": 1495540702, "creation_date": 1443191873, "answer_id": 32784653, "question_id": 32784549, "link": "https://stackoverflow.com/questions/32784549/how-to-split-the-string-in-such-way/32784653#32784653", "title": "How to split the string in such way?", "body": "<p><strike>\nYou forget to say that it's a repeating pattern:</p>\n\n<pre><code>([a-z]+\\\\s+[a-z]+)*\n</code></pre>\n\n<p></strike></p>\n\n<hr>\n\n<p>The solution (<code>(?=([a-z]{2}\\s+[a-z]{2})*)</code>) needs lookahead which is <a href=\"https://stackoverflow.com/a/26792316/2307070\">not available in go</a></p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1443202790, "last_edit_date": 1443202790, "creation_date": 1443193544, "answer_id": 32785218, "question_id": 32784549, "link": "https://stackoverflow.com/questions/32784549/how-to-split-the-string-in-such-way/32785218#32785218", "title": "How to split the string in such way?", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc pairs(s string) []string {\n    var p []string\n    fs := strings.Fields(s)\n    if len(fs) &gt;= 2 {\n        p = make([]string, 0, len(fs)-1)\n        for i, f := range fs[1:len(fs)] {\n            p = append(p, fs[i]+\" \"+f)\n        }\n    }\n    return p\n}\n\nfunc main() {\n    s := \"aa bb cc dd ee ff\"\n    fmt.Printf(\"%q\\n\", s)\n    p := pairs(s)\n    fmt.Printf(\"%q\\n\", p)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\"aa bb cc dd ee ff\"\n[\"aa bb\" \"bb cc\" \"cc dd\" \"dd ee\" \"ee ff\"]\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 4443249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100000487150108/picture?type=large", "display_name": "nanolab", "link": "https://stackoverflow.com/users/4443249/nanolab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 32785218, "answer_count": 2, "score": 2, "last_activity_date": 1443221171, "creation_date": 1443191574, "last_edit_date": 1443193290, "question_id": 32784549, "link": "https://stackoverflow.com/questions/32784549/how-to-split-the-string-in-such-way", "title": "How to split the string in such way?", "body": "<p>I need to split a string like \"aa bb cc dd ee ff\" in golang to</p>\n\n<pre><code>[\"aa bb\" \"bb cc\" \"cc dd\" \"dd ee\" \"ee ff\"]\n</code></pre>\n\n<p>I'm trying this:</p>\n\n<pre><code>re := regexp.MustCompile(\"[a-z]+\\\\s+[a-z]+\")\nfmt.Printf(\"%q\\n\", re.FindAllString(\"aa bb cc dd ee ff\", -1))\n</code></pre>\n\n<p>But it returns:</p>\n\n<pre><code>[\"aa bb\" \"cc dd\" \"ee ff\"]\n</code></pre>\n"}, {"tags": ["go", "udp", "epoll"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1443194787, "post_id": 32784367, "comment_id": 53409891, "body": "The &quot;common&quot; pattern is to have a goroutine for each network connection. However, listening on a UDP port is connectionless, so what are you trying to do?"}, {"owner": {"reputation": 2596, "user_id": 438039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16dc9a9ba1826f5e89204a7df84cfde0?s=128&d=identicon&r=PG", "display_name": "kagali-san", "link": "https://stackoverflow.com/users/438039/kagali-san"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443194922, "post_id": 32784367, "comment_id": 53409989, "body": "@JimB ok, 1 goroutine per 1 listening port, that&#39;s still a lot of goroutines (65k * n interfaces)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1443195308, "post_id": 32784367, "comment_id": 53410272, "body": "You need some sort of state for each connection, and that&#39;s your goroutine. I still don&#39;t understand what you mean by &quot;500K concurrent connections&quot; on a udp port, since udp doesn&#39;t have connections. If you want to use multiple ports, that&#39;s fine, but it doesn&#39;t need to be a 1:1 mapping."}], "owner": {"reputation": 2596, "user_id": 438039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16dc9a9ba1826f5e89204a7df84cfde0?s=128&d=identicon&r=PG", "display_name": "kagali-san", "link": "https://stackoverflow.com/users/438039/kagali-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1993, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1579686711, "creation_date": 1443191031, "last_edit_date": 1579686711, "question_id": 32784367, "link": "https://stackoverflow.com/questions/32784367/working-with-multiple-client-server-udp-sockets-in-epoll-poll-select-manner", "title": "Working with multiple client/server UDP sockets in epoll/poll/select manner", "body": "<p>So I want to do some experiments with c500K (\"problem of having 500K concurrent connections\") in Golang, and <code>net.ListenUDP</code> (and its equivalent client connection part) started in 500K goroutines in a single process is not looking like a way to achieve it.</p>\n\n<p>What is the \"common\" pattern on writing multiple socket listeners/clients in Golang using poll/select-like model?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1443186824, "post_id": 32782664, "comment_id": 53404671, "body": "Why don&#39;t you make <code>myHandler</code> take an argument to create so you can customize the returned http.Handler?"}, {"owner": {"reputation": 55, "user_id": 2160933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20dde6b7651172e64a3457a42cf40c6?s=128&d=identicon&r=PG", "display_name": "bingehacking", "link": "https://stackoverflow.com/users/2160933/bingehacking"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443187153, "post_id": 32782664, "comment_id": 53404851, "body": "So you are suggesting to pass a func to myHandler as a parameter? Jep, that might work, good idea. I&#39;ll give it a try."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1443189463, "post_id": 32782664, "comment_id": 53406431, "body": "you have a <code>myObject</code> interface, why not <code>myHandler(o myObject) http.Handler</code>? Isn&#39;t that why you made it an interface, so it can be swapped out?"}, {"owner": {"reputation": 55, "user_id": 2160933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20dde6b7651172e64a3457a42cf40c6?s=128&d=identicon&r=PG", "display_name": "bingehacking", "link": "https://stackoverflow.com/users/2160933/bingehacking"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443190529, "post_id": 32782664, "comment_id": 53407158, "body": "Not sure if I understood that right: If I used the interface in the myHandler call, it would look something like this: <code>mux := mux.NewRouter()  mux.Handle(&quot;&#47;&quot;, myHandler(???)).Methods(&quot;GET&quot;)</code> What am I supposed to put in the parenthesis when setting up the handler? I could do something like this:  <code>mux := mux.NewRouter()  o := Object{} mux.Handle(&quot;&#47;&quot;, myHandler(o)).Methods(&quot;GET&quot;)</code> But then I am creating the Object which is supposed to be created in the handler function."}, {"owner": {"reputation": 55, "user_id": 2160933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20dde6b7651172e64a3457a42cf40c6?s=128&d=identicon&r=PG", "display_name": "bingehacking", "link": "https://stackoverflow.com/users/2160933/bingehacking"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443191066, "post_id": 32782664, "comment_id": 53407507, "body": "Oh I think I understand now - you are absolutely right, I think I was overcomplicating things. Thanks again for your suggestions!"}], "owner": {"reputation": 55, "user_id": 2160933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20dde6b7651172e64a3457a42cf40c6?s=128&d=identicon&r=PG", "display_name": "bingehacking", "link": "https://stackoverflow.com/users/2160933/bingehacking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1483, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443185546, "creation_date": 1443185546, "question_id": 32782664, "link": "https://stackoverflow.com/questions/32782664/dependency-injection-with-http-handler-in-go", "title": "Dependency injection with http Handler in Go", "body": "<p>I am trying to wrap my head around dependency injection in Go, but really stuck here. Here's a (drastically simplified) app which should serve as an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n    mux := mux.NewRouter()\n    mux.Handle(\"/\", myHandler()).Methods(\"GET\")\n    http.ListenAndServe(\":9000\", mux)\n}\n\ntype myObject interface {\n    Start()\n}\n\ntype Object struct {\n}\n\nfunc (o *Object) Start() {\n    // Something wild here, for example sending out an email,\n    // query an external DB or something similar..\n}\n\nfunc myHandler() http.Handler {\n    // Inject myObject-like struct somewhere here?\n    o := Object{}\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        o.Start()\n        w.Write([]byte(\"Started Object\"))\n    })\n}\n</code></pre>\n\n<p>I have a problem with testing the Object struct. What I usually do is create an interface which can be used in testing by setting up a test struct. For instance, if I had a DB connection handler, in testing I can create a mock which satisfies the handler interface and pass this to the \"myHandler\" call as a parmeter. </p>\n\n<p>Unfortunately this only works if the struct is already instantiated when the \"mux.Handle\" call is made. I simply don't see any simple way to test the myHandler function with an Object struct which can be injected in tests, since it will be created <em>after</em> the handler gets called. </p>\n\n<p>Any hints or ideas on how to get this done? Maybe I have to rethink my testing approach, but I would really like to unit-test the Object struct, but also test the http handler separately (as this handler may perform more tasks than just creating the Object).</p>\n"}, {"tags": ["unicode", "go"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5376110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8403a91bef8ed095ec4e3ef994440e9d?s=128&d=identicon&r=PG&f=1", "display_name": "ivhome", "link": "https://stackoverflow.com/users/5376110/ivhome"}, "edited": false, "score": 0, "creation_date": 1443186879, "post_id": 32782331, "comment_id": 53404702, "body": "Table: CHARSET=utf8. Connection string: user:pass@tcp(:3306)/dbtest?charset=utf8.   Probably database unescapes backslashes and after selecting \\u0435 -&gt; \\\\u0435."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1443185094, "last_edit_date": 1443185094, "creation_date": 1443184424, "answer_id": 32782331, "question_id": 32782239, "link": "https://stackoverflow.com/questions/32782239/how-convert-unicode-string-from-database-to-utf-string-in-go/32782331#32782331", "title": "How convert unicode string from database to utf-string in Go?", "body": "<p>To decode the string you have, you can do:</p>\n\n<pre><code>import \"net/url\"\n\n...\n\nurl.QueryUnescape(\"\\u0435\\u043e\")\n</code></pre>\n\n<p>But I think there's a misconfiguration of your database or connection parameters, as this should be handled automatically. This is not utf-8 BTW.</p>\n"}], "owner": {"reputation": 23, "user_id": 5376110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8403a91bef8ed095ec4e3ef994440e9d?s=128&d=identicon&r=PG&f=1", "display_name": "ivhome", "link": "https://stackoverflow.com/users/5376110/ivhome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 32782331, "answer_count": 1, "score": 0, "last_activity_date": 1443185094, "creation_date": 1443184142, "last_edit_date": 1443184455, "question_id": 32782239, "link": "https://stackoverflow.com/questions/32782239/how-convert-unicode-string-from-database-to-utf-string-in-go", "title": "How convert unicode string from database to utf-string in Go?", "body": "<p>String is stored in database as unicode \"\\u0435\\u043e ...\" (table's encoding is UTF-8).</p>\n\n<p>After selecting from database and printing:</p>\n\n<p>log.Println(str)</p>\n\n<p>OUT: \\u0435\\u043e...</p>\n\n<p>How can I transform this string to utf presentation?</p>\n"}, {"tags": ["go", "timing", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443185161, "post_id": 32780612, "comment_id": 53403563, "body": "If you&#39;re trying to create a benchmark, adding another layer over the http package with &quot;goreq&quot; seems counterproductive. Try with the standard http package first, then profile if there&#39;s still time unaccounted for. A number of http load generators have been written in Go with good results."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443189797, "post_id": 32780612, "comment_id": 53406656, "body": "Does the server return <i>any</i> content at all in the response body?"}, {"owner": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443189907, "post_id": 32780612, "comment_id": 53406732, "body": "@JimB, yes the server may return content. And this load generator can actually make use of returned data for subsequent requests."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443190548, "post_id": 32780612, "comment_id": 53407174, "body": "I&#39;m not seeing where you&#39;re reading the Body, but if you don&#39;t read that content and close the body as soon as possible, that connection is blocked from making more requests, requiring you to create new connections. (this is obscured somewhat by the extra goreq package too)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443190776, "post_id": 32780612, "comment_id": 53407305, "body": "To be clear, reading the body is part of the response time (unless you&#39;re defining response time to only be the receipt of headers)."}, {"owner": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443192035, "post_id": 32780612, "comment_id": 53408094, "body": "Okay, that makes sense, I had no idea. I&#39;ll definitely have to look at that. Right now, the code will assign the responses to a list of responses, and for the subsequent request, it will grab the last body value and read that. Now that you mention that more connections are needed, I understand why the number of open file handlers available for the program exhaust so quickly."}, {"owner": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443200352, "post_id": 32780612, "comment_id": 53413085, "body": "@JimB, if I understand correctly, I should not close the body but instead somehow discard it (if I&#39;m not reading anything from it), is that correct? If so, should I store all the data I need from the response prior to moving onto the next one, and let the GC discard the actual goreq response?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443210314, "post_id": 32780612, "comment_id": 53417906, "body": "You need to read the full response <i>and</i> close the body as quickly as possible. The request isn&#39;t complete until you read the entire response. I&#39;m not sure to answer the second part, if you want the body later you need to store it somewhere."}], "answers": [{"comments": [{"owner": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "edited": false, "score": 0, "creation_date": 1443182886, "post_id": 32781312, "comment_id": 53402007, "body": "Thanks for your quick answer. I can&#39;t find much doc on <code>&#47;&#47;go:nosplit</code>, where should I put that? I get a link time stack overflow error if I put it above the <code>go func</code> instructions and even above the <code>func (r *Request) Spawn</code> function. Any thoughts?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "edited": false, "score": 1, "creation_date": 1443183897, "post_id": 32781312, "comment_id": 53402675, "body": "It&#39;s documented <a href=\"https://golang.org/cmd/compile/\" rel=\"nofollow noreferrer\">here</a>. I think it only works for named functions. I&#39;ve requested a peer-review for this answer on golang-nuts. Maybe someone comes up with something smarter."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443185474, "post_id": 32781312, "comment_id": 53403777, "body": "What do you intend to use RawSyscall for? Rewriting all the network IO, which is an area where a lot of performance tuning has already been done? This is trying to make http requests, which is a fairly complex process, not a single syscall."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443187442, "post_id": 32781312, "comment_id": 53405015, "body": "@JimB  based on <a href=\"http://stackoverflow.com/questions/16977988/details-of-syscall-rawsyscall-syscall-syscall-in-go\">this question</a> it seems to make sense."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443188008, "post_id": 32781312, "comment_id": 53405379, "body": "I still don&#39;t see how that applies. If you rewrite the net package to somehow only use RawSyscall, the runtime won&#39;t be able to schedule concurrent IO in the same thread. Your timing may be more deterministic, but you would have to pin every request to it&#39;s own thread to prevent blocking. You might as well just use <code>runtime.LockOSThread</code> and and use blocking IO directly on your own custom net.Conn."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443188258, "post_id": 32781312, "comment_id": 53405555, "body": "@JimB: Doing blocking IO can still preempt the goroutine, unless you use RawSyscall, AFAIK. Locking on to a thread makes sense."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1443188673, "post_id": 32781312, "comment_id": 53405846, "body": "I think this is still jumping the gun, since there&#39;s no indication that the original problem has anything to do with the runtime. It&#39;s more likely something like unnecessary tcp dialing, request rate spikes at the server, pressure on the keepalive pool, not reading a response body, etc. I&#39;ve had no problem timing sub millisecond events in highly concurrent Go network systems."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1443180961, "creation_date": 1443180961, "answer_id": 32781312, "question_id": 32780612, "link": "https://stackoverflow.com/questions/32780612/timing-of-requests-in-goroutines/32781312#32781312", "title": "Timing of requests in goroutines", "body": "<p>As your goroutines enter syscall (writing to a socket), they are preempted. This means that they are interrupted and another goroutine will run in their place. Eventually, your preempted goroutine will be scheduled again and it will continue running where it left off. This doesn't necessarily happen exactly after the syscall is done, though.</p>\n\n<p>Timing in a goroutine is difficult, because even if you did everything serially, Go 1.5's garbage collector will run occasionally, interrupting your theoretical serial loop.</p>\n\n<p>The only real solution is a bit complex:</p>\n\n<ol>\n<li>Use <a href=\"https://golang.org/pkg/syscall/#RawSyscall\" rel=\"nofollow\">RawSyscall</a> directly.</li>\n<li>Annotate your function with <code>//go:nosplit</code> to prevent it from being preempted.</li>\n<li>Disable garbage collector.</li>\n</ol>\n\n<p>Even then, I might be forgetting something.</p>\n"}], "owner": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1443180961, "creation_date": 1443178524, "last_edit_date": 1495540336, "question_id": 32780612, "link": "https://stackoverflow.com/questions/32780612/timing-of-requests-in-goroutines", "title": "Timing of requests in goroutines", "body": "<p>I am trying to time how long it takes to make concurrent requests. My timing results are about four times slower than what <a href=\"http://httpd.apache.org/docs/2.2/programs/ab.html\" rel=\"nofollow noreferrer\">ab2</a> reports.</p>\n\n<p>I've tried timing requests in two different ways, both of which lead to similar results (which are far off ab2's results). To give an example, ab2 will report the longest request to last 2 milliseconds on a local server, whereas this code will report up to 4.5 milliseconds. By the way, the whole codebase is available <a href=\"https://github.com/ChristopherRabotin/sg\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>How do I properly time a request in go?</p>\n\n<h1>Method 1: timing includes more than just the request</h1>\n\n<p>From <a href=\"https://github.com/ChristopherRabotin/sg/blob/e156fdb/qurbine.go#L99\" rel=\"nofollow noreferrer\">this commit</a>.</p>\n\n<pre><code>// Let's spawn all the requests, with their respective concurrency.\nwg.Add(r.Repeat)\nr.doneWg.Add(r.Repeat)\nfor rno := 1; rno &lt;= r.Repeat; rno++ {\n    go func(no int, greq goreq.Request) {\n        r.ongoingReqs &lt;- struct{}{} // Adding sentinel value to limit concurrency.\n        startTime := time.Now()\n        greq.Uri = r.URL.Generate()\n        gresp, err := greq.Do()\n        if err != nil {\n            log.Critical(\"could not send request to #%d %s: %s\", no, r.URL, err)\n        } else if no &lt; r.Repeat {\n            // We're always using the last response for the next batch of requests.\n            gresp.Body.Close()\n        }\n        &lt;-r.ongoingReqs // We're done, let's make room for the next request.\n        resp := Response{Response: gresp, duration: time.Now().Sub(startTime)}\n        // Let's add that request to the list of completed requests.\n        r.doneChan &lt;- &amp;resp\n        runtime.Gosched()\n    }(rno, greq)\n}\n</code></pre>\n\n<h1>Method 2: using an internal function with a defer statement</h1>\n\n<p>From <a href=\"https://github.com/ChristopherRabotin/sg/blob/91e9c59/qurbine.go#L99\" rel=\"nofollow noreferrer\">this commit</a>.</p>\n\n<pre><code>// Let's spawn all the requests, with their respective concurrency.\nwg.Add(r.Repeat)\nr.doneWg.Add(r.Repeat)\nfor rno := 1; rno &lt;= r.Repeat; rno++ {\n    go func(no int, greq goreq.Request) {\n        r.ongoingReqs &lt;- struct{}{} // Adding sentinel value to limit concurrency.\n        greq.Uri = r.URL.Generate()\n        var duration time.Duration\n        gresp, err := func(dur *time.Duration) (gresp *goreq.Response, err error) {\n            defer func(startTime time.Time) { *dur = time.Now().Sub(startTime) }(time.Now())\n            return greq.Do()\n        }(&amp;duration)\n\n        if err != nil {\n            log.Critical(\"could not send request to #%d %s: %s\", no, r.URL, err)\n        } else if no &lt; r.Repeat {\n            // We're always using the last response for the next batch of requests.\n            gresp.Body.Close()\n        }\n        &lt;-r.ongoingReqs // We're done, let's make room for the next request.\n        resp := Response{Response: gresp, duration: duration}\n        // Let's add that request to the list of completed requests.\n        r.doneChan &lt;- &amp;resp\n        runtime.Gosched()\n    }(rno, greq)\n}\n</code></pre>\n\n<p>I had a look at <a href=\"https://stackoverflow.com/questions/23583471/time-response-for-http-get-request-when-using-goroutines\">this question</a>, which did not help.</p>\n"}, {"tags": ["go", "ide"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1443174772, "post_id": 32779430, "comment_id": 53397294, "body": "use LiteIDE: <a href=\"https://github.com/visualfc/liteide\" rel=\"nofollow noreferrer\">github.com/visualfc/liteide</a>                                                    Btw, not an interpreted language and has no interactive shell."}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 1, "creation_date": 1443177404, "post_id": 32779430, "comment_id": 53398828, "body": "Intellij IDEA go plugin <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin\" rel=\"nofollow noreferrer\">github.com/go-lang-plugin-org/go-lang-idea-plugin</a> is rather good!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1443178275, "post_id": 32779430, "comment_id": 53399332, "body": "See also <a href=\"http://stackoverflow.com/a/28664334/6309\">stackoverflow.com/a/28664334/6309</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1443179229, "post_id": 32779430, "comment_id": 53399917, "body": "<a href=\"https://github.com/golang/go/wiki/IDEsAndTextEditorPlugins\" rel=\"nofollow noreferrer\">IDEs and Plugins for Go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1187, "user_id": 1110444, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/uWeLX.jpg?s=128&g=1", "display_name": "Hosack", "link": "https://stackoverflow.com/users/1110444/hosack"}, "is_accepted": false, "score": -1, "last_activity_date": 1443198079, "last_edit_date": 1443198079, "creation_date": 1443197728, "answer_id": 32786471, "question_id": 32779430, "link": "https://stackoverflow.com/questions/32779430/how-to-run-go-language-in-windows/32786471#32786471", "title": "How to run Go language in windows?", "body": "<p>There are some Go REPL implementations out there. A quick google search returned:</p>\n\n<p><a href=\"https://github.com/motemen/gore\" rel=\"nofollow\">https://github.com/motemen/gore</a></p>\n\n<p><a href=\"https://github.com/vito/go-repl\" rel=\"nofollow\">https://github.com/vito/go-repl</a></p>\n\n<p>I haven't used them, but I assume they work similarly to Python's REPL.</p>\n"}], "owner": {"reputation": 7, "user_id": 5203028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c12d7f89061346debaa170991890ae5?s=128&d=identicon&r=PG&f=1", "display_name": "RUPAK BHATTACHARJEE", "link": "https://stackoverflow.com/users/5203028/rupak-bhattacharjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1443198079, "creation_date": 1443174468, "question_id": 32779430, "link": "https://stackoverflow.com/questions/32779430/how-to-run-go-language-in-windows", "title": "How to run Go language in windows?", "body": "<p>I have downloaded windows installer for GO language and installed it. But there seems to have no option to run it interactively like Python etc. How can I run Go interactively? Are there any IDE for the Go Language? Someone please explain me how can I do that.</p>\n"}, {"tags": ["variables", "for-loop", "go", "var", "variable-declaration"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1443170540, "post_id": 32778088, "comment_id": 53394766, "body": "New scope, new game. Basically like in every other language."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1443171622, "creation_date": 1443171622, "answer_id": 32778500, "question_id": 32778088, "link": "https://stackoverflow.com/questions/32778088/why-is-it-possible-to-declare-the-same-var-two-times-using-for-loop/32778500#32778500", "title": "Why is it possible to declare the same var two times using for-loop?", "body": "<p>The <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">short variable declaration</a> <code>i :=  ...</code> will overshadow the same variable declared outside of the scope of the <code>for</code> loop <strong><a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow\">block</a></strong>.</p>\n\n<blockquote>\n  <p>Each \"<a href=\"https://golang.org/ref/spec#If_statements\" rel=\"nofollow\"><code>if</code></a>\", \"<a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow\"><code>for</code></a>\", and \"<a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow\"><code>switch</code></a>\" statement is considered to be in its own implicit block</p>\n</blockquote>\n\n<p>You can see more at \"<a href=\"https://developmentality.wordpress.com/2014/03/03/go-gotcha-1-variable-shadowing-within-inner-scope-due-to-use-of-operator/\" rel=\"nofollow\">Go gotcha #1: variable shadowing within inner scope due to use of <code>:=</code> operator</a>\"</p>\n\n<p>It refers to this <a href=\"http://grokbase.com/t/gg/golang-nuts/132kx1r460/go-nuts-shadowing-a-proposal-to-improve-visibility-usage-analysis\" rel=\"nofollow\">goNuts discussion</a>.</p>\n\n<p>A short variable declaration can redeclare the same variable within a block, but since <code>i</code> is also declared <em>outside</em> the for block, it keeps its value outside said block (<a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">different scope</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 3002, "user_id": 559085, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/siXyu.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/559085/martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1443171957, "creation_date": 1443171957, "answer_id": 32778615, "question_id": 32778088, "link": "https://stackoverflow.com/questions/32778088/why-is-it-possible-to-declare-the-same-var-two-times-using-for-loop/32778615#32778615", "title": "Why is it possible to declare the same var two times using for-loop?", "body": "<p>The first i has been defined inside the braces ({}) of main function wheras the second i is declared within the scope of the for loop. The name is same but the scope is different.</p>\n"}], "owner": {"reputation": 571, "user_id": 4245210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mcrWI.jpg?s=128&g=1", "display_name": "Elie Teyssedou", "link": "https://stackoverflow.com/users/4245210/elie-teyssedou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 2, "accepted_answer_id": 32778500, "answer_count": 2, "score": 1, "last_activity_date": 1443171957, "creation_date": 1443170180, "last_edit_date": 1592644375, "question_id": 32778088, "link": "https://stackoverflow.com/questions/32778088/why-is-it-possible-to-declare-the-same-var-two-times-using-for-loop", "title": "Why is it possible to declare the same var two times using for-loop?", "body": "<p>I was trying Go on <a href=\"http://tour.golang.org/\" rel=\"nofollow noreferrer\">http://tour.golang.org/</a>, and I saw that it was possible to declarate two times the same var using := in for loop.\nThe output is the same with the Go compiler.</p>\n<p><strong>Here is my test :</strong> (see the var i, it was declared two times)</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc main() {\n    i := &quot;Hello&quot;\n    a := 0\n    for a &lt; 2 {\n        fmt.Println(i)\n        i := &quot;World !&quot;\n        fmt.Println(i)\n        a++\n    }       \n}\n</code></pre>\n<p><strong>Output :</strong></p>\n<blockquote>\n<p>Hello</p>\n<p>World !</p>\n<p>Hello</p>\n<p>World !</p>\n</blockquote>\n<p>Can someone explain that ?</p>\n"}, {"tags": ["http", "go", "io", "request"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1443159771, "post_id": 32775539, "comment_id": 53389583, "body": "Check returned errors (those underscores <code>&#39;_&#39;</code> in your code which you <i>gracefully</i> omit). And post what they are if you can&#39;t figure out based on that. Also post how you acquire the <code>http.Request</code> that you pass to the functions above (e.g. post the context that calls the <code>readBody()</code> function)."}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1443161616, "post_id": 32775539, "comment_id": 53390327, "body": "oh i forgot to say i put _ for all errors is just for simplicity. I handled them properly in my code and no errors are found."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1443161956, "post_id": 32775539, "comment_id": 53390462, "body": "Are you sure there actually <i>is</i> a non-empty body? If yes: why are you sure?"}, {"owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "edited": false, "score": 0, "creation_date": 1443162808, "post_id": 32775539, "comment_id": 53390821, "body": "i&#39;ve added what i got in the question, it&#39;s something like <code>ContentLength=413 with Body length 0</code>. Is it the supposed content I should get in the body? And is it because it&#39;s a POST request so that the Body is supposed to hold no content?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1443169496, "post_id": 32775539, "comment_id": 53394170, "body": "So there is no body. Content-Length can be wrong. Lot&#39;s of request do not have a body."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1443179243, "post_id": 32775539, "comment_id": 53399926, "body": "@nevets <code>Content-Length</code> is just an HTTP request header and it&#39;s value can be set to anything."}, {"owner": {"reputation": 1044, "user_id": 1949322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b49c06625a28488b90d2b7f960163f?s=128&d=identicon&r=PG", "display_name": "WaltPurvis", "link": "https://stackoverflow.com/users/1949322/waltpurvis"}, "edited": false, "score": 0, "creation_date": 1443190673, "post_id": 32775539, "comment_id": 53407240, "body": "&quot;And is it because it&#39;s a POST request so that the Body is supposed to hold no content?&quot;  That part confuses me. Why would a POST request body not be supposed to have content? Is this request one you&#39;re receiving as a server or one you&#39;re sending as a client?"}], "answers": [{"comments": [{"owner": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 0, "creation_date": 1468468044, "post_id": 38364204, "comment_id": 64142196, "body": "This does not provide an answer to the question. To critique or request clarification from an author, leave a comment below their post. - <a href=\"/review/low-quality-posts/13000234\">From Review</a>"}, {"owner": {"reputation": 754, "user_id": 1986530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MHH45.png?s=128&g=1", "display_name": "safety", "link": "https://stackoverflow.com/users/1986530/safety"}, "reply_to_user": {"reputation": 17516, "user_id": 1345455, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DrBTs.jpg?s=128&g=1", "display_name": "coatless", "link": "https://stackoverflow.com/users/1345455/coatless"}, "edited": false, "score": 1, "creation_date": 1468470002, "post_id": 38364204, "comment_id": 64142699, "body": "Not sure what you mean? The question is asking why a 0 length body is being read and I&#39;ve supplied a possible reason."}, {"owner": {"reputation": 6680, "user_id": 3884852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wJUbN.png?s=128&g=1", "display_name": "Gytis TG", "link": "https://stackoverflow.com/users/3884852/gytis-tg"}, "edited": false, "score": 0, "creation_date": 1468482166, "post_id": 38364204, "comment_id": 64147757, "body": "While it might be true, your answer sounds as it&#39;s not 100% accurate due to question you have provided. Also, it looks somewhat incomplete. :)"}, {"owner": {"reputation": 754, "user_id": 1986530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MHH45.png?s=128&g=1", "display_name": "safety", "link": "https://stackoverflow.com/users/1986530/safety"}, "edited": false, "score": 0, "creation_date": 1468484685, "post_id": 38364204, "comment_id": 64149191, "body": "Ok, I&#39;ve taken out the question."}], "tags": [], "owner": {"reputation": 754, "user_id": 1986530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MHH45.png?s=128&g=1", "display_name": "safety", "link": "https://stackoverflow.com/users/1986530/safety"}, "is_accepted": false, "score": 0, "last_activity_date": 1468484653, "last_edit_date": 1468484653, "creation_date": 1468460361, "answer_id": 38364204, "question_id": 32775539, "link": "https://stackoverflow.com/questions/32775539/no-content-in-http-request-body-when-read-using-golang/38364204#38364204", "title": "No content in http.Request.Body when read using Golang", "body": "<p>If the request does not include an appropriate \"Content-Type\" header you may see a 0 length body when you try to read it.</p>\n"}, {"tags": [], "owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "is_accepted": false, "score": 0, "last_activity_date": 1529529378, "creation_date": 1529529378, "answer_id": 50957142, "question_id": 32775539, "link": "https://stackoverflow.com/questions/32775539/no-content-in-http-request-body-when-read-using-golang/50957142#50957142", "title": "No content in http.Request.Body when read using Golang", "body": "<p>This is happening because you call <code>httputils.DumpRequestOut(req, true)</code> after the http client has performed the request and the body is drained.</p>\n\n<p>Make sure you do the following step in order:</p>\n\n<ol>\n<li><code>httputils.DumpRequestOut(req, true)</code></li>\n<li><code>resp, err :=http.DefaultClient.Do(req)</code></li>\n<li><code>httputil.DumpResponse(res, true)</code></li>\n</ol>\n"}], "owner": {"reputation": 4124, "user_id": 2629095, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/680dfd61e8b392153c85cf93498b8100?s=128&d=identicon&r=PG", "display_name": "nevets", "link": "https://stackoverflow.com/users/2629095/nevets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3353, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1529529378, "creation_date": 1443159602, "last_edit_date": 1443162715, "question_id": 32775539, "link": "https://stackoverflow.com/questions/32775539/no-content-in-http-request-body-when-read-using-golang", "title": "No content in http.Request.Body when read using Golang", "body": "<p>Note: All error handling code is omitted for simplicity. I handled them locally, and no errors were produced.</p>\n\n<p>In Golang, I tried to use the code below to read from a <code>http.Request.Body</code> from a POST request:</p>\n\n<pre><code>func readBody(req *http.Request) string {\n    bytes, _ := httputils.DumpRequestOut(req, true)\n    return string(bytes)\n}\n</code></pre>\n\n<p>It shows a non-zero Content-Length, but no content returned: </p>\n\n<pre><code>ContentLength=413 with Body length 0\n</code></pre>\n\n<p>. I tried with the code below, also no luck:</p>\n\n<pre><code>func readBody(req *http.Request) string {\n    bytes, _ := ioutil.ReadAll(req.Body)\n    return string(bytes)\n}\n</code></pre>\n\n<p>It returns an empty string. After googling, I found a blog about this problem: <a href=\"https://medium.com/@xoen/golang-read-from-an-io-readwriter-without-loosing-its-content-2c6911805361\" rel=\"nofollow\">Golang: Read from an io.ReadWriter without losing its content</a>. I tried to follow the pattern, still no luck:</p>\n\n<pre><code>func readBody(req *http.Request) string {\n    bodyBytes, _ := ioutil.ReadAll(req.Body)\n    // Restore the io.ReadCloser to its original state\n    req.Body = ioutil.NopCloser(bytes.NewBuffer(bodyBytes))\n    // Use the content\n    return string(bodyBytes)\n}\n</code></pre>\n\n<p>Any suggestions? Thanks in advance :)</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "edited": false, "score": 0, "creation_date": 1443159402, "post_id": 32775203, "comment_id": 53389440, "body": "Thanks, Bravada. One related question: is it possible to check the existence of a <code>defined template</code>. If I have partials defined in each template (say &quot;title&quot;) and I want to check the existence of it, there is no way to do that I presume? i.e., the pipeline can only come from the go handler?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "edited": false, "score": 0, "creation_date": 1443160561, "post_id": 32775203, "comment_id": 53389894, "body": "There&#39;s no point in checking for the existence of the template. If you have {{template &quot;title&quot;}} in a template, then Execute will return an error if {{define &quot;title&quot;}}{{end}} is missing from the set of templates."}, {"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "edited": false, "score": 0, "creation_date": 1443165164, "post_id": 32775203, "comment_id": 53391990, "body": "Got it. I was trying to do some default html insertions in case a template was not defined (like each partial may have an additional footer). If it is not defined, I wanted to skip it and if it is there, include it.  I ended up just making every page provide the same template definitions but blank values where appropriate."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 17, "last_activity_date": 1443158042, "last_edit_date": 1443158042, "creation_date": 1443157696, "answer_id": 32775203, "question_id": 32774234, "link": "https://stackoverflow.com/questions/32774234/show-default-content-in-a-template-if-an-object-is-nil-otherwise-show-based-on-t/32775203#32775203", "title": "Show default content in a template if an object is nil otherwise show based on the set property", "body": "<pre><code>{{if not .}}\n   output when . is nil or otherwise empty including\n     false, 0, and any array, slice, map, or string of length zero\n{{else if eq .MetaValue \"some-x\"}}\n       // some-x case\n{{else}} \n       // other case\n{{end}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 206, "user_id": 370800, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bf38a68dbf67cc7887fd0dd814bfeed?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/370800/matt"}, "edited": false, "score": 1, "creation_date": 1527911400, "post_id": 50032009, "comment_id": 88317138, "body": "I didn&#39;t see quote function in golang templates, so with your idea, I checked for <code>if html .Page.Thing.Stationary | eq &quot;&amp;lt;nil&amp;gt;&quot;</code> and that worked!"}, {"owner": {"reputation": 41, "user_id": 8549558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9398690b2cc1677bec19a447c5e1c834?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8549558/dan"}, "reply_to_user": {"reputation": 206, "user_id": 370800, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bf38a68dbf67cc7887fd0dd814bfeed?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/370800/matt"}, "edited": false, "score": 0, "creation_date": 1528146900, "post_id": 50032009, "comment_id": 88387430, "body": "Yeah that works too. The quote function exists in the <a href=\"https://github.com/Masterminds/sprig\" rel=\"nofollow noreferrer\">sprig</a> template library."}, {"owner": {"reputation": 156, "user_id": 284266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4203b4b42c905f0c8b755cbfe53f2296?s=128&d=identicon&r=PG", "display_name": "Jan Dubois", "link": "https://stackoverflow.com/users/284266/jan-dubois"}, "edited": false, "score": 0, "creation_date": 1564705627, "post_id": 50032009, "comment_id": 101128194, "body": "This no longer works in later versions of tiller (verified against 2.14.0). It now renders <code>(quote nil)</code> as an empty string (without quotes!).  What still works is <code>(typeOf nil)</code>, which renders as <code>&lt;nil&gt;</code> (without quotes), and works back at least in tiller 2.8.2, and continues to work up to 2.14.0."}], "tags": [], "owner": {"reputation": 41, "user_id": 8549558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9398690b2cc1677bec19a447c5e1c834?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8549558/dan"}, "is_accepted": false, "score": 4, "last_activity_date": 1524694023, "creation_date": 1524694023, "answer_id": 50032009, "question_id": 32774234, "link": "https://stackoverflow.com/questions/32774234/show-default-content-in-a-template-if-an-object-is-nil-otherwise-show-based-on-t/50032009#50032009", "title": "Show default content in a template if an object is nil otherwise show based on the set property", "body": "<p>I've been recently facing an issue with identifying nil vs 0 values in a Helm Chart (which uses Go templates, including <a href=\"https://github.com/Masterminds/sprig\" rel=\"nofollow noreferrer\" title=\"sprig\">sprig</a>) and haven't found any solutions posted, so I thought I'd add mine here.</p>\n\n<p>I came up with a kind of ugly solution which is to quote the value and then check for a string that matches \"&lt;nil&gt;\" (with quotes, so you'd actually be checking (quote .Values.thing | eq \"\\\"&lt;nil&gt;\\\"\")). This allows differentiating tests against empty values vs defined 0 values. In my case, I was trying to build a config file where some default options were non-0, so when 0 was explicitly set, I wanted to know that 0 was set instead of just omitted.</p>\n\n<p>Hopefully this can be a help to someone else.</p>\n\n<p>It would be nice to have a better way to do this, but so far I haven't found anything that doesn't require creating and adding my own template functions.</p>\n"}, {"comments": [{"owner": {"reputation": 108, "user_id": 1415972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c6cd5dec6d1f55091ee1c86521c42c2?s=128&d=identicon&r=PG", "display_name": "Carson Anderson", "link": "https://stackoverflow.com/users/1415972/carson-anderson"}, "edited": false, "score": 1, "creation_date": 1618350368, "post_id": 62705174, "comment_id": 118574816, "body": "Be warned that <code>kindIs</code> is only available if you are pulling in the <a href=\"https://github.com/Masterminds/sprig\" rel=\"nofollow noreferrer\">sprig functions</a>"}], "tags": [], "owner": {"reputation": 4687, "user_id": 735679, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3323766d9446b4541cdcbc02d7da5c81?s=128&d=identicon&r=PG", "display_name": "Technetium", "link": "https://stackoverflow.com/users/735679/technetium"}, "is_accepted": false, "score": 4, "last_activity_date": 1593724649, "creation_date": 1593724649, "answer_id": 62705174, "question_id": 32774234, "link": "https://stackoverflow.com/questions/32774234/show-default-content-in-a-template-if-an-object-is-nil-otherwise-show-based-on-t/62705174#62705174", "title": "Show default content in a template if an object is nil otherwise show based on the set property", "body": "<p>If you want to ensure you're only checking against <code>nil</code> and not <code>0</code>, <code>false</code>, the empty string, or any other falsey type, you can use <a href=\"http://masterminds.github.io/sprig/reflection.html#kind-functions\" rel=\"nofollow noreferrer\">the <code>kindIs</code> function</a> to accomplish this.</p>\n<pre><code>{{ if kindIs &quot;invalid&quot; . }} \n   // only if variable is literally nil. falsey values will fallthrough.\n{{ else if eq .MetaValue &quot;some-x&quot; }} \n   // other\n{{ else }}\n   // final case, if any\n{{ end }}\n</code></pre>\n"}], "owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14642, "favorite_count": 2, "accepted_answer_id": 32775203, "answer_count": 3, "score": 12, "last_activity_date": 1593724649, "creation_date": 1443151037, "last_edit_date": 1475953414, "question_id": 32774234, "link": "https://stackoverflow.com/questions/32774234/show-default-content-in-a-template-if-an-object-is-nil-otherwise-show-based-on-t", "title": "Show default content in a template if an object is nil otherwise show based on the set property", "body": "<p>In my template, I would like to include some default <code>meta</code> tags (90% of the time). However, when a specific property is set, I would like to show a different set of text.</p>\n\n<p>I know I can set an anonymous <code>struct</code> and set a property with either <code>\"default\"</code> or <code>\"some-x\"</code>. However, this means, I need to add an anonymous struct to 90% of my handlers that just currently pass <code>nil</code>. </p>\n\n<p>Is there way to do something like</p>\n\n<pre><code>{{if eq . nil}} \n   // default meta tag\n{{else if eq .MetaValue \"some-x\"}} \n   //other\n{{end}}\n</code></pre>\n\n<p>If I try something like my above code, it compiles but doesn't do what I want. Appreciate any suggestions on how to handle  it properly without adding a lot of boiler plate. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "iterator", "cgo"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1443140448, "post_id": 32772798, "comment_id": 53384893, "body": "Opinions will differ, but yeah, I think this is fine--it&#39;s essentially how you move through an input stream with <code>io.Reader</code>, except that you check for <code>n &lt;= 0</code> instead of <code>err == io.EOF</code>. <a href=\"https://golang.org/pkg/bufio/#example_Scanner_lines\" rel=\"nofollow noreferrer\"><code>buffer.Scan</code> uses another approach</a> that you might find interesting to compare to as well."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1443141162, "post_id": 32772798, "comment_id": 53385072, "body": "I read the blog post you link to when it came out and I&#39;d only use the callback/closure/channels approaches if something specific to the situation made them useful (e.g., if you want multiple consumers on a channel). Also, doesn&#39;t apply to your situation, but Go idiom is less strict than, say, C++ or Java&#39;s about exposing your object&#39;s data, so you might just expose a slice or map member on a struct."}, {"owner": {"reputation": 33, "user_id": 2727329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2136cdd78f70c2b1e50c4c38fec6e06d?s=128&d=identicon&r=PG&f=1", "display_name": "jjellis", "link": "https://stackoverflow.com/users/2727329/jjellis"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1443265070, "post_id": 32772798, "comment_id": 53430670, "body": "@twotwotwo thanks, I found the link to buffer.Scan very useful."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1443377571, "post_id": 32772798, "comment_id": 53458955, "body": "Since there&#39;s been no other activity here, I&#39;ll expand and answer-ify the comments."}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 0, "last_activity_date": 1443387629, "last_edit_date": 1443387629, "creation_date": 1443384779, "answer_id": 32812374, "question_id": 32772798, "link": "https://stackoverflow.com/questions/32772798/idiomatic-way-to-use-c-style-iterator-with-go/32812374#32812374", "title": "idiomatic way to use c style iterator with Go", "body": "<p>What you're doing isn't that different from moving through a file with an <code>io.Reader</code>:</p>\n\n<pre><code>err, n := error(nil), 0\nfor err == nil {\n    err, n = f.Read(in)\n    // ...do stuff with in[:n]...\n}\n</code></pre>\n\n<p>Or using <code>(*bufio.Scanner).Scan()</code> (see <a href=\"http://godoc.org/bufio#Scanner\" rel=\"nofollow\">the docs</a>):</p>\n\n<pre><code>for scanner.Scan() {\n    // ...do something with scanner.Text()...\n}\nif err := scanner.Err(); err != nil {\n    log.Fatalln(err)\n}\n</code></pre>\n\n<p>I think you rarely want the more exotic iterator options in the blog post you linked to, the ones with closures or channels. Channels in particular invoke a lot of machinery meant for coordinating real threaded workloads, and in terms of convention, it's just typical in Go for loops to look a little different depending on what they're iterating. (In that respect, it's like iteration in C, but different from (say) Python, C++, or Java.)</p>\n"}], "owner": {"reputation": 33, "user_id": 2727329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2136cdd78f70c2b1e50c4c38fec6e06d?s=128&d=identicon&r=PG&f=1", "display_name": "jjellis", "link": "https://stackoverflow.com/users/2727329/jjellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 32812374, "answer_count": 1, "score": 0, "last_activity_date": 1443387629, "creation_date": 1443139333, "question_id": 32772798, "link": "https://stackoverflow.com/questions/32772798/idiomatic-way-to-use-c-style-iterator-with-go", "title": "idiomatic way to use c style iterator with Go", "body": "<p>I'm very new to Go programming (3-4 days), and I'm trying to write some code that reads a binary file using an existing third-party C library using cgo.  The C library's way of doing this seems fairly standard (for C). Slightly simplified it looks like:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n    file_t *file = file_open(filename);\n    index_t *index = index_load(file, filename);\n    iterator_t *iter = query(idx, header, region);\n    record_t *record = record_init();\n\n    while (iterator_next(file, iter, record) &gt;= 0) {\n        /* Do stuff with record */\n    }\n\n    iterator_destroy(iter);\n    record_destroy(record);\n    file_close(file);\n\n    return 0;\n}\n</code></pre>\n\n<p>I have written the following Go code:</p>\n\n<pre><code>func main() {\n    file := Open(filename)\n    record := NewRecord()\n    iter := file.Query(region)\n    for {\n        n, err := file.Next(iter, record)\n        if err != nil {\n            log.Fatal(err)\n        }\n        if n &lt;= 0 {\n            // No more records to read.\n            break\n        }\n    }\n}\n</code></pre>\n\n<p>This works, in the sense that it will allow me to access the records in a particular query region.</p>\n\n<p>My question is whether this is an idiomatic way to approach this task in Go, or are there better alternatives? I've seen sites such as <a href=\"http://ewencp.org/blog/golang-iterators\" rel=\"nofollow\">http://ewencp.org/blog/golang-iterators</a>, but seem unable to get these examples to work with the C library (I was thinking it may be because the C library is reusing the record_t variable on each iteration rather than creating a new variable, but maybe it's just my lack of experience with Go).</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1443134980, "post_id": 32772137, "comment_id": 53383356, "body": "Thanks! If you had to lock, how would you lock the last case?"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1443145004, "post_id": 32772137, "comment_id": 53385859, "body": "Thank you so much. This was very helpful!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1443137242, "last_edit_date": 1443137242, "creation_date": 1443134655, "answer_id": 32772137, "question_id": 32772057, "link": "https://stackoverflow.com/questions/32772057/why-does-gorilla-websocket-chat-example-not-finding-it-neccessary-to-use-sync-rw/32772137#32772137", "title": "Why does gorilla websocket chat example not finding it neccessary to use sync.RWMutex to access and edit maps?", "body": "<p>A mutex is not required because the <a href=\"https://github.com/gorilla/websocket/blob/13e4d0621caa4d77fd9aa470ef6d7ab63d1a5e41/examples/chat/main.go#L32\" rel=\"nofollow\">single hub goroutine</a> is the only goroutine that accesses the map.</p>\n\n<p>An alternate approach is to eliminate the Go routine and channels and replace them with functions that use a mutex.</p>\n\n<pre><code>type hub struct {\n  connections map[*connection]bool\n  mu sync.Mutex\n}\n\nvar h = hub{\n   connections: make(map[*connection]bool),\n}\n\nfunc (h * hub) register(c *connection) {\n  h.mu.Lock()\n  h.connections[c] = true\n}\n\nfunc (h *hub) unregister(c *connection) {\n  h.mu.Lock()\n  if _, ok := h.connections[c]; ok {\n     delete(h.connections, c)\n     close(c.send)\n  }\n  h.mu.Unlock()\n}\n\nfunc (h * hub) broadcast(message []byte) {\n  h.mu.Lock()\n  for c := range h.connections {\n    select {\n    case c.send &lt;- m:\n    default:\n      close(c.send)\n      delete(h.connections, c)\n    }\n  }\n  h.mu.Unlock()\n}\n</code></pre>\n\n<p>It's important to protect <code>close(c.send)</code> and <code>c.send &lt;- m</code> with a mutex. This prevents send on a closed channel.</p>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 32772137, "answer_count": 1, "score": 0, "last_activity_date": 1443137242, "creation_date": 1443134205, "question_id": 32772057, "link": "https://stackoverflow.com/questions/32772057/why-does-gorilla-websocket-chat-example-not-finding-it-neccessary-to-use-sync-rw", "title": "Why does gorilla websocket chat example not finding it neccessary to use sync.RWMutex to access and edit maps?", "body": "<p>In the chat example there is a file called hub.go.</p>\n\n<p><a href=\"https://github.com/gorilla/websocket/blob/master/examples/chat/hub.go\" rel=\"nofollow\">https://github.com/gorilla/websocket/blob/master/examples/chat/hub.go</a></p>\n\n<p>I have made some changes to that file and it looks like this:</p>\n\n<pre><code>type hub struct {\n    // Registered connections.\n    connections map[int64]*connection\n\n    sync.RWMutex\n\n    // Inbound messages from the connections.\n    broadcast chan []byte\n\n    // Register requests from the connections.\n    register chan *connection\n\n    // Unregister requests from connections.\n    unregister chan *connection\n}\n\nvar wsHub = hub{\n    connections: make(map[int64]*connection),\n    broadcast:   make(chan []byte),\n    register:    make(chan *connection),\n    unregister:  make(chan *connection),\n}\n\nfunc (h *hub) init() {\n    for {\n        select {\n        case c := &lt;-h.register:\n            h.Lock()\n            h.connections[c.userId] = c\n            h.Unlock()\n        case c := &lt;-h.unregister:\n            h.RLock()\n            _, ok := h.connections[c.userId]\n            h.RUnlock()\n            if ok {\n                h.Lock()\n                delete(h.connections, c.userId)\n                h.Unlock()\n                close(c.send)\n            }\n        case m := &lt;-h.broadcast:\n            for _, c := range h.connections {\n                select {\n                case c.send &lt;- m:\n                default:\n                    close(c.send)\n                    delete(h.connections, c.userId)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I have added sync.RWMutex to the hub struct but I am not sure if this is necessary. Why is it not included in the example? Maybe I am missing something? Is it overkill to lock and unlock?</p>\n\n<p>And also the last case in the init() method I'm not sure how to lock and unlock because it reads and writes at the same time. Should I use both the Rlock() and Lock()? How would that look like?</p>\n"}, {"tags": ["pointers", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "edited": false, "score": 0, "creation_date": 1443196569, "post_id": 32770835, "comment_id": 53411046, "body": "Thanks! Can you give an example where a pointer to a slice would be required?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "edited": false, "score": 0, "creation_date": 1443196954, "post_id": 32770835, "comment_id": 53411270, "body": "@jayunit100: you need a pointer if you want a function to be able to modify the length or capacity of a slice. You can look at the <a href=\"https://golang.org/pkg/container/heap/#example__intHeap\" rel=\"nofollow noreferrer\">IntHeap example</a> in the container/heap package. The Push and Pop methods require a pointer receiver."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1443128475, "creation_date": 1443128475, "answer_id": 32770835, "question_id": 32770650, "link": "https://stackoverflow.com/questions/32770650/fixing-improperly-referenced-slices-in-an-array-replacement/32770835#32770835", "title": "Fixing improperly referenced slices in an array replacement", "body": "<p>You're not using an array here, you're using a slice. Generally, you don't want to handle a pointer to a slice since it can get awkward, and the pointer is needed in very few cases.</p>\n\n<p>To fix your error, dereference <code>x</code>:</p>\n\n<pre><code>*x = append((*x)[:remove], (*x)[remove+1:]...)\n</code></pre>\n\n<p>But you should probably be using the slice value directly, so that no dereferences are required:</p>\n\n<pre><code>x := []int{11, 22, 33, 44, 55, 66, 77, 88, 99}\n</code></pre>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 32770835, "answer_count": 1, "score": 0, "last_activity_date": 1443128475, "creation_date": 1443127716, "question_id": 32770650, "link": "https://stackoverflow.com/questions/32770650/fixing-improperly-referenced-slices-in-an-array-replacement", "title": "Fixing improperly referenced slices in an array replacement", "body": "<p>The following go code doesn't compile, because (I believe) there is a mistake around the way pointers are being referenced.  </p>\n\n<p>In particular, The error message is </p>\n\n<pre><code>prog.go:13: cannot use append((*x)[:remove], (*x)[remove + 1:]...) (type []int) as type *[]int in assignment\n</code></pre>\n\n<p>Here is an abstracted and simplified version of the code which results in this error message.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    x := &amp;[]int{11, 22, 33, 44, 55, 66, 77, 88, 99}\n\n    for i, addr := range *x {\n        if addr == 22 {\n            for len(*x) &gt; 5 {\n                remove := (i + 1) % len(*x)\n                x = append((*x)[:remove], (*x)[remove+1:]...)\n            }\n            break\n        }\n    }\n\n    fmt.Println(x)\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "edited": false, "score": 0, "creation_date": 1443136049, "post_id": 32770895, "comment_id": 53383707, "body": "In the parameters for the function should i take the  eg: authentication in this case should be a json obejct,so should i take it as a string"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "edited": false, "score": 0, "creation_date": 1443136554, "post_id": 32770895, "comment_id": 53383856, "body": "@asj177 if you have your json stored in a string then you would pass into <code>NewBufferString</code> I used the term <code>MyJsonAsString</code> to represent this json you want to use as the request body. If you have an object, then you would use <code>json.Marshal(&amp;MyObject)</code> to create a string representation of it."}, {"owner": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "edited": false, "score": 0, "creation_date": 1443211172, "post_id": 32770895, "comment_id": 53418380, "body": "Ok I have a json such as lets say  {&quot;namespaceadmins&quot;:&quot;asj&quot;,   &quot;datalist&quot;:[&quot;avx&quot;,&quot;bdx&quot;,&quot;xnf&quot;],    &quot;attributes&quot;:{ &quot;name&quot;:&quot;aj&quot;, &quot;listedvalues&quot;:[&quot;12&quot;,&quot;14&quot;,&quot;13&quot;], }, &quot;id&quot;:12, &quot;groups&quot;:[&quot;ab&quot;,&quot;kl&quot;] }  now how can i create this json as I want to send this data in a post request"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "edited": false, "score": 0, "creation_date": 1443212005, "post_id": 32770895, "comment_id": 53418783, "body": "@asj177 well if that is exactly what you want you could use a string literal like; <code>req.Body = bytes.NewBufferString({&quot;namespaceadmins&quot;:&quot;asj&quot;, &quot;datalist&quot;:[&quot;avx&quot;,&quot;bdx&quot;,&quot;xnf&quot;], &quot;attributes&quot;:{ &quot;name&quot;:&quot;aj&quot;, &quot;listedvalues&quot;:[&quot;12&quot;,&quot;14&quot;,&quot;13&quot;], }, &quot;id&quot;:12, &quot;groups&quot;:[&quot;ab&quot;,&quot;kl&quot;] })</code> but I don&#39;t really understand how your json data is being stored/read ect in your program. put the string in ` for quotes, I can&#39;t type it in the comment because it&#39;s what designates a code snippet."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1443128699, "creation_date": 1443128699, "answer_id": 32770895, "question_id": 32770411, "link": "https://stackoverflow.com/questions/32770411/passing-json-parameter-to-function-in-golang/32770895#32770895", "title": "Passing JSON parameter to function in GOLANG", "body": "<p>I'm assuming you're trying to put the JSON as the body of your <code>PUT</code> request. In this case you'll just want to use assignment. The request object has a field of type <code>io.ReadCloser</code> for it.</p>\n\n<pre><code>  req.Header.Add(\"Accept\",\"application/json\")\n  req.Body = bytes.NewBufferString(MyJsonAsAString)\n  res,err:=client.Do(req)\n</code></pre>\n\n<p>There are some other methods like <code>http.Post</code> which take the body as an argument but in this case, the <code>Do</code> method takes a <code>Request</code> object as an argument and that has a property for the <code>Body</code>.</p>\n"}], "owner": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2159, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1443128699, "creation_date": 1443126822, "question_id": 32770411, "link": "https://stackoverflow.com/questions/32770411/passing-json-parameter-to-function-in-golang", "title": "Passing JSON parameter to function in GOLANG", "body": "<p>I want to pass a JSON object to a function in GOLANG ,so how would I define my parameters,would it be fine if I can define my params as string .below is a sample </p>\n\n<pre><code>    func getDetailedNameSpace(authentication string,id string) string{\n var jsonStr = []byte(string);\ntr := &amp;http.Transport{\n        TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n    }\n\n    client := &amp;http.Client{Transport: tr}\n\n    req, _ := http.NewRequest(\"PUT\", \"https://\"+authentication.endPoint+\"/object/namespaces/\"+id, bytes.NewBuffer(jsonStr))\n    req.Header.Add(\"X-Sds-Auth-Token\",authentication.authtoken)\n    req.Header.Add(\"Accept\",\"application/json\")\n    res,err:=client.Do(req)\n\n    body, err := ioutil.ReadAll(res.Body)\n\n    if err!=nil{\n    fmt.Printf(\"%s\",err)\n\n    }\n    return string(body);\n\n\n}\n</code></pre>\n\n<p>Also i have to validate the params ,as in python we can have like below </p>\n\n<pre><code> def getDetailedNameSpace(authentication,id=None):\n       assert authentication!=None,\"Authentication Required\"\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1443126102, "post_id": 32769420, "comment_id": 53379457, "body": "You give no context as to why you want to do this. One option is to use <code>golang.org&#47;x&#47;text&#47;transform</code> to filter white space from any <code>io.Reader</code> (e.g. <a href=\"https://play.golang.org/p/eeo0F0Bn5S\" rel=\"nofollow noreferrer\">play.golang.org/p/eeo0F0Bn5S</a>)"}, {"owner": {"reputation": 1941, "user_id": 903214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6312d756a4a6079dee5bfd876165535c?s=128&d=identicon&r=PG", "display_name": "kdgwill", "link": "https://stackoverflow.com/users/903214/kdgwill"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1443126301, "post_id": 32769420, "comment_id": 53379548, "body": "I am just reading a attempting to create a scanner for a file reading a character at a time"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443126584, "post_id": 32769420, "comment_id": 53379702, "body": "There&#39;s already a much better way to read 1 byte at a time, <a href=\"https://golang.org/pkg/bufio/#Reader\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#Reader</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1941, "user_id": 903214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6312d756a4a6079dee5bfd876165535c?s=128&d=identicon&r=PG", "display_name": "kdgwill", "link": "https://stackoverflow.com/users/903214/kdgwill"}, "edited": false, "score": 0, "creation_date": 1443125758, "post_id": 32769682, "comment_id": 53379278, "body": "I switched it to 1 after I started receiving errors after skimming through another article. What is the correct count. When I try the above I get the error messages bellow ./scanner.go:107: cannot convert c (type []byte) to type int ./scanner.go:107: cannot use int(c) (type int) as type rune in argument to unicode.IsSpace"}, {"owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "reply_to_user": {"reputation": 1941, "user_id": 903214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6312d756a4a6079dee5bfd876165535c?s=128&d=identicon&r=PG", "display_name": "kdgwill", "link": "https://stackoverflow.com/users/903214/kdgwill"}, "edited": false, "score": 0, "creation_date": 1443128995, "post_id": 32769682, "comment_id": 53380880, "body": "@kdgwill: Sorry, I pulled the byte out in the <code>Println</code> but not the <code>IsSpace()</code>. Fixed. There is no correct count but typically I&#39;d take bytes in batches larger than <code>1</code>. Depends on how much memory you want to use. If memory isn&#39;t a concern, you can use <code>ioutil.ReadFile</code> to get all the data at once. It&#39;s in the <code>&quot;io&#47;ioutil&quot;</code> package."}, {"owner": {"reputation": 1941, "user_id": 903214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6312d756a4a6079dee5bfd876165535c?s=128&d=identicon&r=PG", "display_name": "kdgwill", "link": "https://stackoverflow.com/users/903214/kdgwill"}, "edited": false, "score": 0, "creation_date": 1443129177, "post_id": 32769682, "comment_id": 53380966, "body": "Yeah I wanted prevent loading the full file into memory, generally I am attempting to read a character to determine if it is a whitespace or if it is a specific letter/symbol."}, {"owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "reply_to_user": {"reputation": 1941, "user_id": 903214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6312d756a4a6079dee5bfd876165535c?s=128&d=identicon&r=PG", "display_name": "kdgwill", "link": "https://stackoverflow.com/users/903214/kdgwill"}, "edited": false, "score": 0, "creation_date": 1443129235, "post_id": 32769682, "comment_id": 53380995, "body": "If you only care about ASCII characters, then you could do it in batches of whatever size, say 100, and have a nested loop that reads the batch. I&#39;ll update."}], "tags": [], "owner": {"reputation": 2258, "user_id": 3352025, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RpFHA.jpg?s=128&g=1", "display_name": "Lye Fish", "link": "https://stackoverflow.com/users/3352025/lye-fish"}, "is_accepted": true, "score": 2, "last_activity_date": 1443129470, "last_edit_date": 1443129470, "creation_date": 1443123933, "answer_id": 32769682, "question_id": 32769420, "link": "https://stackoverflow.com/questions/32769420/golang-skipping-whitespace-in-a-file/32769682#32769682", "title": "Golang: Skipping Whitespace in a file", "body": "<p>Unless I'm misunderstanding your question, it would seem that you'd want a <code>continue</code> statement when encountering a space.</p>\n\n<pre><code>c := make([]byte, 100)\n\nn, err := this.file.Read(c)\n\n//skip white space\nfor {\n    //catch unintended errors\n    if err != nil &amp;&amp; err != io.EOF {\n        panic(err)\n    }\n    if err == io.EOF {\n        break\n    }\n\n    for i := 0; i &lt; n; i++ {\n        ch := c[i]\n\n        switch ch {\n        case '{': // Do something\n        case '}': // Do something else\n        default:\n            if unicode.IsSpace(int(ch)) {\n                continue\n            }\n            // Do whatever\n        }\n    }\n\n        //get next\n    n, err = this.file.Read(c)\n}\n</code></pre>\n\n<p>I don't know why you're reading one byte at a time, but I left it that way in case it's intentional. At the very least, I'd think you'd want to read full unicode characters instead of individual bytes.</p>\n"}], "owner": {"reputation": 1941, "user_id": 903214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6312d756a4a6079dee5bfd876165535c?s=128&d=identicon&r=PG", "display_name": "kdgwill", "link": "https://stackoverflow.com/users/903214/kdgwill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1876, "favorite_count": 0, "accepted_answer_id": 32769682, "answer_count": 1, "score": 0, "last_activity_date": 1443129470, "creation_date": 1443122924, "last_edit_date": 1443128997, "question_id": 32769420, "link": "https://stackoverflow.com/questions/32769420/golang-skipping-whitespace-in-a-file", "title": "Golang: Skipping Whitespace in a file", "body": "<p>In reading a file in Go I am attempting to skip all of the white spaces; however, I am having issues finding the correct method to do this. Any assistance would be appreciated</p>\n\n<pre><code>file, err := os.Open(filename) // For read access.\n        this.file = file\n        if err != nil {\n                log.Fatal(err)\n        }\n//skip white space\n\n  c := make([]byte, 1)\n\n    char, err := this.file.Read(c)\n\n    //skip white space\n    for {\n            //catch unintended errors\n            if err != nil &amp;&amp; err != io.EOF {\n                    panic(err)\n            }\n            if err == io.EOF || !unicode.IsSpace(int(c)) {\n                    break\n            }\n            //get next\n            char, err := this.file.Read(c)\n    }\n</code></pre>\n\n<p>I am just simply attempting to create a scanner for a file to read a single character at a time and ignore whitespace</p>\n\n<p><strong>EDIT</strong> </p>\n\n<p>I changed a few things around to make use of bufio.Reader; however I have still fallen into issue What is the correct way to read a file character by character so that it might be compared to a specific symbol such as 'A' but also can ignore whitespace i.e unicode.isSpace(rune)</p>\n\n<pre><code>char, size, err := this.reader.ReadRune()\n    //skip white space and comments\n    for {\n            //catch unintended errors\n            if err != nil &amp;&amp; err != io.EOF {\n                    panic(err)\n            }\n            if err == io.EOF {\n                    break\n            }\n\n            //skip it when their is no data or a space\n            if size != 0 &amp;&amp; char == '{' {\n                    //Ignore Comments\n                    //Documentation specifies no nested comments\n                    for char != '}' {\n                            char, size, err = this.reader.ReadRune()\n                    }\n            } else if !unicode.IsSpace(char) {\n                    break\n            }\n\n            // Do something with the byte\n            fmt.Print(char)\n\n            //get next\n            char, size, err = this.reader.ReadRune()\n    }\n</code></pre>\n"}, {"tags": ["linux", "serialization", "go", "usb", "microcontroller"], "comments": [{"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1443121645, "post_id": 32769006, "comment_id": 53377197, "body": "Other than using one of the several Go libraries out there for talking with serial ports?"}, {"owner": {"reputation": 88, "user_id": 2284725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/54e5fd566a921ff37094a18dd54e4e9d?s=128&d=identicon&r=PG", "display_name": "maxbart", "link": "https://stackoverflow.com/users/2284725/maxbart"}, "reply_to_user": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1443121762, "post_id": 32769006, "comment_id": 53377268, "body": "I&#39;m specifically looking to send data over the USB port. Maybe a mention of at least one of these Go libraries would be useful?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1443121826, "post_id": 32769006, "comment_id": 53377306, "body": "<a href=\"http://godoc.org/?q=usb\" rel=\"nofollow noreferrer\">godoc</a>"}, {"owner": {"reputation": 88, "user_id": 2284725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/54e5fd566a921ff37094a18dd54e4e9d?s=128&d=identicon&r=PG", "display_name": "maxbart", "link": "https://stackoverflow.com/users/2284725/maxbart"}, "edited": false, "score": 0, "creation_date": 1443121911, "post_id": 32769006, "comment_id": 53377340, "body": "Thanks I wasn&#39;t aware of that site."}, {"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1443121913, "post_id": 32769006, "comment_id": 53377341, "body": "If you have a USB-UART bridge you talk over serial, not USB. The OS handles the USB side of things."}, {"owner": {"reputation": 88, "user_id": 2284725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/54e5fd566a921ff37094a18dd54e4e9d?s=128&d=identicon&r=PG", "display_name": "maxbart", "link": "https://stackoverflow.com/users/2284725/maxbart"}, "edited": false, "score": 0, "creation_date": 1443122319, "post_id": 32769006, "comment_id": 53377556, "body": "Yeah the cable I have has a UART converter built in. I&#39;ll try to use one of the many packages in the search provided by thwd"}, {"owner": {"reputation": 88, "user_id": 2284725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/54e5fd566a921ff37094a18dd54e4e9d?s=128&d=identicon&r=PG", "display_name": "maxbart", "link": "https://stackoverflow.com/users/2284725/maxbart"}, "reply_to_user": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1443123204, "post_id": 32769006, "comment_id": 53378041, "body": "If I&#39;m using a USB-UART bridge, I would still need to use one of these packages to send data over the USB port, right? Sorry, I&#39;m not familiar with all of this. @IgnacioVazquez-Abrams"}, {"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1443123708, "post_id": 32769006, "comment_id": 53378303, "body": "No. The OS handles the USB part, and presents a serial port."}], "owner": {"reputation": 88, "user_id": 2284725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/54e5fd566a921ff37094a18dd54e4e9d?s=128&d=identicon&r=PG", "display_name": "maxbart", "link": "https://stackoverflow.com/users/2284725/maxbart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443122488, "creation_date": 1443121455, "question_id": 32769006, "link": "https://stackoverflow.com/questions/32769006/how-can-serial-data-be-sent-over-a-usb-port-to-a-microcontroller", "title": "How can serial data be sent over a USB port to a microcontroller?", "body": "<p>I'm designing a system that has a linux machine communicating serially with a microcontroller over a USB to RS-485 interface. I'd like to do this in Go if possible.</p>\n\n<p>How can I programmatically send data over the linux machine's USB port?</p>\n"}, {"tags": ["go", "constructor"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1443118999, "creation_date": 1443118999, "answer_id": 32768336, "question_id": 32768261, "link": "https://stackoverflow.com/questions/32768261/is-there-a-constructor-interface-for-a-struct-type/32768336#32768336", "title": "Is there a constructor interface for a struct type?", "body": "<p>There is not. But the common, and I would say idiomatic, thing to do is to put a <code>func NewDice() dice</code> in your package and then you can just call it to get an instance. Do your set up there. It serves the same purpose as a constructor. It's pretty common to have package level methods like <code>NewMyType</code> that do initilization and return and instance.</p>\n"}, {"comments": [{"owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "edited": false, "score": 2, "creation_date": 1443119620, "post_id": 32768350, "comment_id": 53376116, "body": "@RyanM Thank you. By the way if I get it right, you will call <code>rand.Seed()</code> each time a <code>dice</code> is created. This could lead to some unexpected behavior, <a href=\"http://stackoverflow.com/questions/12321133/golang-random-number-generator-how-to-seed-properly\">this question about seeding properly the random generator in Golang</a> could be worth reading."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "edited": false, "score": 0, "creation_date": 1443120011, "post_id": 32768350, "comment_id": 53376322, "body": "Yeah I have a stackoverflow code review page where they brought up the same thing (though the person there didn&#39;t actually explain why it was a bad idea so thanks for that). I&#39;m looking at using crypto/rand instead, the docs for that just aren&#39;t as good so I&#39;m having to dig."}], "tags": [], "owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "is_accepted": false, "score": 1, "last_activity_date": 1443119049, "creation_date": 1443119049, "answer_id": 32768350, "question_id": 32768261, "link": "https://stackoverflow.com/questions/32768261/is-there-a-constructor-interface-for-a-struct-type/32768350#32768350", "title": "Is there a constructor interface for a struct type?", "body": "<p>No, Go doesn't provide this kind of interface. You just can't use a constructor like you would do in C++ by example.</p>\n\n<p>The current idiom is to create a function</p>\n\n<pre><code>NewX(args...) X // or *X\n</code></pre>\n\n<p>in which you can setup your struct as you want. In your case, it could look like this:</p>\n\n<pre><code>func NewDice() dice {\n  var d dice\n  d.Roll()\n  return d\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443119049, "creation_date": 1443118680, "question_id": 32768261, "link": "https://stackoverflow.com/questions/32768261/is-there-a-constructor-interface-for-a-struct-type", "title": "Is there a constructor interface for a struct type?", "body": "<p>In golang, say I have a type that needs some setup done on it before use beyond just setting default values. ex:</p>\n\n<pre><code>type dice struct {\n    input   string\n    count   int\n    sides   int\n    result  int\n}\n\nfunc (d *dice) Roll() {\n    //initialize random seed\n    rand.Seed(time.Now().UnixNano())\n    for i := 0; i &lt; d.count; i++ {\n        d.result = d.result + rand.Intn(d.sides)+1)\n    }\n}\n</code></pre>\n\n<p>Simple example but say if I wanted to have d.Roll() called automatically when creating an instance of the 'dice' type is there a way to do that? More in line with the issue I'm trying to solve, say I wanted the rand.Seed(time.Now().UnixNano()) bits to be called automatically before I call Roll() is there an idiomatic golang way to do this?</p>\n\n<p>Basically \"How do you handle constructor functionality in golang?\" is my question. Is there an interface for this I can add?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1443525760, "post_id": 32768243, "comment_id": 53519546, "body": "A minor heads-up: having the word &quot;class&quot; in the name of a &quot;constructor&quot; and &quot;destructor&quot; functions is confusing and might indicate that you maintain a somewhat wrong mental model about this stuff: such functions initialize/deinitialize <i>instances</i> of a type (well, Go has no classes, but classes in C++-like PLs are types), that is, concrete variables which have a particular type. They don&#39;t initialize/deinitialize a type itself. Basically that&#39;s why &quot;constructor&quot; functions are typically called <code>New()</code> or <code>NewWhatever()</code> in Go: they give you a new initialized <i>value.</i>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1443525889, "post_id": 32768243, "comment_id": 53519609, "body": "You might find <a href=\"https://blog.golang.org/package-names\" rel=\"nofollow noreferrer\">this</a> to be of particular interest with regard to naming packages, types and functions in well-written Go code. Be sure to also check out the section titled &quot;Further reading&quot; there."}, {"owner": {"reputation": 1941, "user_id": 903214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6312d756a4a6079dee5bfd876165535c?s=128&d=identicon&r=PG", "display_name": "kdgwill", "link": "https://stackoverflow.com/users/903214/kdgwill"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1443531415, "post_id": 32768243, "comment_id": 53523215, "body": "@kostix the use of initClass and deinitClass were just generic I was just using the names to show what I was doing. I created a struct then called initStructName to do some fancy things then under that I added defer deinitStructName, to close files, and properly clean up etc."}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 4, "creation_date": 1443121551, "post_id": 32768512, "comment_id": 53377141, "body": "If you&#39;re acquiring some limited resource that doesn&#39;t already have a finalizer, and the program would eventually be unable to continue if it kept leaking, you should consider setting a finalizer. At the same time, since they don&#39;t run until GC does, it&#39;s better to <code>defer</code> and free the resources immediately than rely on finalizers. In other words, finalizers might be a useful insurance policy against otherwise-hard-to-plug leaks, but they aren&#39;t good as your main resource-management mechanism."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1443122380, "post_id": 32768512, "comment_id": 53377586, "body": "@twotwotwo please make a proper answer out of it. The comment might not be noticed, and stating loud and clear that finalizers should never ever be used and an explicit way for the user to signal &quot;I&#39;m done with this object&quot; must be implemented and documented instead."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1443123881, "post_id": 32768512, "comment_id": 53378390, "body": "Good call @kostix, fleshed that out and added it as an answer."}], "tags": [], "owner": {"reputation": 114, "user_id": 1080568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76a8f4849829643862f7c5dd89cb11e?s=128&d=identicon&r=PG", "display_name": "LK4D4", "link": "https://stackoverflow.com/users/1080568/lk4d4"}, "is_accepted": false, "score": 6, "last_activity_date": 1592883148, "last_edit_date": 1592883148, "creation_date": 1443119606, "answer_id": 32768512, "question_id": 32768243, "link": "https://stackoverflow.com/questions/32768243/go-destructors/32768512#32768512", "title": "Go destructors?", "body": "<p>There are Finalizers in Go. I wrote a little <a href=\"http://lk4d4.darth.io/posts/finalizers/\" rel=\"nofollow noreferrer\">blog post</a> about it. They are even used for closing files in the standard library as you can see <a href=\"https://golang.org/src/os/file_unix.go#L55\" rel=\"nofollow noreferrer\">here</a>.\nHowever, I think using defer is more preferable because it's more readable and less magical.</p>\n"}, {"comments": [{"owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "edited": false, "score": 2, "creation_date": 1504814823, "post_id": 32769509, "comment_id": 79171446, "body": "<code>SetFinalizer</code> is the only method available to free cgo resources in line with when their golang dependancies are garbage collected - its very useful for c wrappers, especially when the C objects have restrictions on when they can be freed relative to one another.  This should be the accepted answer."}, {"owner": {"reputation": 9300, "user_id": 409102, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/060588f22d2a4c5e049156f23fcf1405?s=128&d=identicon&r=PG", "display_name": "kravemir", "link": "https://stackoverflow.com/users/409102/kravemir"}, "edited": false, "score": 0, "creation_date": 1573138016, "post_id": 32769509, "comment_id": 103790558, "body": "Actually, this is the most helpful answer. I&#39;m planning to use it in order to protect files from being cleaned-up, while they are still referenced/reachable from code (using stored filename, not opened file). And, references to those files (filenames) have unpredictable life-cycle."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 9300, "user_id": 409102, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/060588f22d2a4c5e049156f23fcf1405?s=128&d=identicon&r=PG", "display_name": "kravemir", "link": "https://stackoverflow.com/users/409102/kravemir"}, "edited": false, "score": 0, "creation_date": 1573670596, "post_id": 32769509, "comment_id": 103961021, "body": "@kravemir Thanks for the appreciation! This may be inapplicable to your situation or too late to be useful, but wanted to note that at least on Linux, you can keep an open filehandle pointing at a deleted file. Then after all the filehandles are closed (explicitly or by finalizers or shutdown of the program), the OS will actually free the space on disk. Depending on the details of what you&#39;re doing, that might allow you to have automatic file cleanup without much implementation work on the Go side."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 19, "last_activity_date": 1506534983, "last_edit_date": 1506534983, "creation_date": 1443123236, "answer_id": 32769509, "question_id": 32768243, "link": "https://stackoverflow.com/questions/32768243/go-destructors/32769509#32769509", "title": "Go destructors?", "body": "<p><a href=\"https://golang.org/pkg/runtime/#SetFinalizer\" rel=\"noreferrer\"><code>runtime.SetFinalizer(ptr, finalizerFunc)</code></a> sets a finalizer--not a destructor but another mechanism to maybe eventually free up resources. Read the documentation there for details, including downsides. They might not run until long after the object is actually unreachable, and they might not run at all if the program exits first. They also postpone freeing memory for another GC cycle. </p>\n\n<p>If you're acquiring some limited resource that doesn't already have a finalizer, and the program would eventually be unable to continue if it kept leaking, you should consider setting a finalizer. It can mitigate leaks. Unreachable files and network connections are already cleaned up by finalizers in the stdlib, so it's only other sorts of resources where custom ones can be useful. The most obvious class is system resources you acquire through <code>syscall</code> or <code>cgo</code>, but I can imagine others. </p>\n\n<p>While they can patch over some mistakes, you shouldn't <em>rely</em> on finalizers. They don't run until GC does. Because the program could exit before next GC, you can't rely on them for things that must be done, like flushing buffered output to the filesystem. Assuming GC <em>does</em> happen, it might not happen soon enough: if a finalizer is responsible for closing network connections, maybe a remote host hits its limit on open connections to you before GC, or your process hits its file-descriptor limit, or you run out of <a href=\"https://en.wikipedia.org/wiki/Ephemeral_port\" rel=\"noreferrer\">ephemeral ports</a>, or something else. So it's much better to <code>defer</code> and do cleanup <em>right when it's necessary</em> than to use a finalizer and hope it's done soon enough.</p>\n\n<p>You don't see many <code>SetFinalizer</code> calls in everyday Go programming, partly because the most important ones are in the standard library and mostly because of their limited range of applicability in general.</p>\n\n<p>In short, finalizers can help by freeing forgotten resources in long-running programs, but because not much about their behavior is guaranteed, they aren't fit to be your main resource-management mechanism.</p>\n"}, {"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 4, "creation_date": 1443506042, "post_id": 32781054, "comment_id": 53508449, "body": "Great answer, for explaining what you should do instead. The ZeroMQ link is cool too--personally found that error returns are great when you need to fully understand what happens down every error path."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 50, "last_activity_date": 1617702691, "last_edit_date": 1617702691, "creation_date": 1443180128, "answer_id": 32781054, "question_id": 32768243, "link": "https://stackoverflow.com/questions/32768243/go-destructors/32781054#32781054", "title": "Go destructors?", "body": "<p>In the Go ecosystem, there exists a ubiquitous idiom for dealing with objects which wrap precious (and/or external) resources: a special method designated for freeing that resource, called <em>explicitly</em> \u2014 typically via the <code>defer</code> mechanism.</p>\n<p>This special method is typically named <code>Close()</code>, and the user of the object has to call it explicitly when they're done with the resource the object represents. The <code>io</code> standard package does even have a special interface, <a href=\"https://golang.org/pkg/io/#Closer\" rel=\"nofollow noreferrer\"><code>io.Closer</code></a>, declaring that single method.  Objects implementing I/O on various resources such as TCP sockets, UDP endpoints and files all satisfy <code>io.Closer</code>, and are expected to be explicitly <code>Close</code>d after use.</p>\n<p>Calling such a cleanup method is typically done via the <code>defer</code> mechanism which guarantees the method will run no matter if some code which executes after resource acquisition will <code>panic()</code> or not.</p>\n<p>You might also notice that not having implicit &quot;destructors&quot; quite balances not having implicit &quot;constructors&quot; in Go.  This actually has nothing to do with not having &quot;classes&quot; in Go: the language designers just avoid <em>magic</em> as much as practically possible.</p>\n<hr />\n<p>Note that Go's approach to this problem might <em>appear</em> to be somewhat low-tech but in fact it's the only workable solution for the runtime featuring garbage-collection.  In a language with objects but without GC, say C++, destructing an object is a well-defined operation because an object is destroyed either when it goes out of scope or when <code>delete</code> is called on its memory block.  In a runtime with GC, the object will be destroyed at some mostly indeterminate point in the future by the GC scan, and <em>may not be destroyed at all.</em>  So if the object wraps some precious resource, that resource might get reclaimed way past the moment in time the last live reference to the enclosing object was lost, and it might even not get reclaimed at all\u2014as has been well explained by @twotwotwo in their respective answer.</p>\n<p>Another interesting aspect to consider is that the Go's GC is fully concurrent (with the regular program execution). This means a GC thread which is about to collect a dead object might (and usually will) be not the thread(s) which executed that object's code when it was alive. In turn, this means that if the Go types could have destructors then the programmer would need to make sure whatever code the destructor executes is properly synchronized with the rest of the program\u2014if the object's state affects some data structures external to it. This actually might force the programmer to add such synchronization even if the object does not need it for its normal operation (and most objects fall into such category). And think about what happens of those exernal data strucrures happened to be destroyed before the object's destructor was called (the GC collects dead objects in a non-deterministic way). In other words, it's much easier to control \u2014 and to reason about \u2014 object destruction when it is explicitly coded into the program's flow: both for specifying when the object has to be destroyed, and for guaranteeing proper ordering of its destruction with regard to destroying of the data structures external to it.</p>\n<p>If you're familiar with .NET, it deals with resource cleanup in a way which resembles that of Go quite closely: your objects which wrap some precious resource have to implement the <code>IDisposable</code> interface, and a method, <code>Dispose()</code>, exported by that interface, must be called explicitly when you're done with such an object.  C# provides some syntactic sugar for this use case via the <code>using</code> statement which makes the compiler arrange for calling <code>Dispose()</code> on the object when it goes out of the scope declared by the said statement.  In Go, you'll typically <code>defer</code> calls to cleanup methods.</p>\n<hr />\n<p>One more note of caution.  Go wants you to treat errors very seriously (unlike most mainstream programming language with their <a href=\"http://250bpm.com/blog:4\" rel=\"nofollow noreferrer\">&quot;just throw an exception and don't give a fsck about what happens due to it elsewhere and what state the program will be in&quot; attitude</a>) and so you might consider checking error returns of at least <em>some</em> calls to cleanup methods.</p>\n<p>A good example is instances of the <code>os.File</code> type representing files on a filesystem.  The fun stuff is that calling <code>Close()</code> on an open file <em>might</em> fail due to legitimate reasons, and if you were <em>writing</em> to that file this might indicate that not all the data you wrote to that file had actually landed in it <em>on the file system.</em>  For an explanation, please read the &quot;Notes&quot; section in the <a href=\"http://linux.die.net/man/2/close\" rel=\"nofollow noreferrer\"><code>close(2)</code> manual</a>.</p>\n<p>In other words, just doing something like</p>\n<pre><code>fd, err := os.Open(&quot;foo.txt&quot;)\ndefer fd.Close()\n</code></pre>\n<p>is okay for read-only files in the 99.9% of cases, but for files opening for writing, you might want to implement more involved error checking and some strategy for dealing with them (mere reporting, wait-then-retry, ask-then-maybe-retry or whatever).</p>\n"}], "owner": {"reputation": 1941, "user_id": 903214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6312d756a4a6079dee5bfd876165535c?s=128&d=identicon&r=PG", "display_name": "kdgwill", "link": "https://stackoverflow.com/users/903214/kdgwill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29630, "favorite_count": 7, "accepted_answer_id": 32781054, "answer_count": 3, "score": 35, "last_activity_date": 1617702691, "creation_date": 1443118604, "last_edit_date": 1459894867, "question_id": 32768243, "link": "https://stackoverflow.com/questions/32768243/go-destructors", "title": "Go destructors?", "body": "<p>I know there are no destructors in Go since technically there are no classes. As such, I use <code>initClass</code> to perform the same functions as a constructor. However, is there any way to create something to mimic a destructor in the event of a termination, for the use of, say, closing files? Right now I just call <code>defer deinitClass</code>, but this is rather hackish and I think a poor design. What would be the proper way?</p>\n"}, {"tags": ["go", "scheduler"], "answers": [{"comments": [{"owner": {"reputation": 7731, "user_id": 1614378, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lOzxR.png?s=128&g=1", "display_name": "dieter", "link": "https://stackoverflow.com/users/1614378/dieter"}, "edited": false, "score": 0, "creation_date": 1443114341, "post_id": 32766795, "comment_id": 53373344, "body": "ok it means that every M do it, but it didn&#39;t fill the local runqueue, It takes just one and execute it. So local runqueue will never filled again after it get empty. And if we have 32 CPU and therefore 32 M&#39;s they will be synchronized by a mutex (lock). right?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 7731, "user_id": 1614378, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lOzxR.png?s=128&g=1", "display_name": "dieter", "link": "https://stackoverflow.com/users/1614378/dieter"}, "edited": false, "score": 1, "creation_date": 1443119385, "post_id": 32766795, "comment_id": 53375984, "body": "The code is a bit hard to read (because it&#39;s auto-translated C) but yes, that&#39;s how it seems to work."}, {"owner": {"reputation": 712, "user_id": 8868419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a530d27369c9d4f6ecf421fe83d2b4?s=128&d=identicon&r=PG&f=1", "display_name": "Madeo", "link": "https://stackoverflow.com/users/8868419/madeo"}, "edited": false, "score": 0, "creation_date": 1597921075, "post_id": 32766795, "comment_id": 112292813, "body": "the link is dead"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 5, "last_activity_date": 1597929692, "last_edit_date": 1597929692, "creation_date": 1443113221, "answer_id": 32766795, "question_id": 32766160, "link": "https://stackoverflow.com/questions/32766160/go-scheduler-who-fills-the-local-runqueue-of-p/32766795#32766795", "title": "Go Scheduler who fills the local runqueue of P?", "body": "<p>All of this is taken from <a href=\"https://golang.org/src/runtime/proc.go\" rel=\"nofollow noreferrer\">golang.org/src/runtime/proc.go</a>:</p>\n<p>Function <code>schedule</code> (the scheduler) calls <code>findrunnable</code> which attempts to steal a <code>G</code> from another <code>P</code>. If that fails, it'll return a <code>G</code> from the global run queue. That <code>G</code> is then executed on the &quot;current&quot; <code>M</code>.</p>\n<p>In addition, <code>schedule</code> checks the global run queue occasionally &quot;for fairness&quot;:</p>\n<pre><code>// Check the global runnable queue once in a while to ensure fairness.\n// Otherwise two goroutines can completely occupy the local runqueue\n// by constantly respawning each other.\n</code></pre>\n<p>In all of that, only one lock is involved, which is <code>lock(&amp;sched.lock)</code>.</p>\n"}], "owner": {"reputation": 7731, "user_id": 1614378, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lOzxR.png?s=128&g=1", "display_name": "dieter", "link": "https://stackoverflow.com/users/1614378/dieter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 1, "accepted_answer_id": 32766795, "answer_count": 1, "score": 5, "last_activity_date": 1597929692, "creation_date": 1443111088, "last_edit_date": 1443125228, "question_id": 32766160, "link": "https://stackoverflow.com/questions/32766160/go-scheduler-who-fills-the-local-runqueue-of-p", "title": "Go Scheduler who fills the local runqueue of P?", "body": "<p>Look at this well known image taken from <a href=\"http://morsmachine.dk/go-scheduler\" rel=\"nofollow noreferrer\">morsmachine.dk/go-scheduler</a> </p>\n\n<p><a href=\"https://i.stack.imgur.com/kZlGr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kZlGr.png\" alt=\"enter image description here\"></a></p>\n\n<p>The gray lists are <em>local runqueues</em> of P. If this queue get empty they will be filled with go routines from the <em>global runqueue</em>.</p>\n\n<p>The Question is, who fills the <em>local runqueue</em> of P? </p>\n\n<p>Scheduler, without synchronisation or every <strong>P</strong> do it for himself (mutex)? </p>\n\n<p>P.S. The article omits this information.</p>\n"}, {"tags": ["shell", "go", "command"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1443108258, "post_id": 32764670, "comment_id": 53369394, "body": "If you are trying to find files with specific file extensions, consider using <a href=\"http://godoc.org/path/filepath#Walk\" rel=\"nofollow noreferrer\">Walk</a> instead of executing a command."}, {"owner": {"reputation": 1206, "user_id": 783116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZOv9Y.jpg?s=128&g=1", "display_name": "josiah", "link": "https://stackoverflow.com/users/783116/josiah"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1443118681, "post_id": 32764670, "comment_id": 53375625, "body": "What&#39;s wrong with this question?  Why have I received a downvote?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1443197946, "post_id": 32764670, "comment_id": 53411820, "body": "Basic questions sometimes get downvoted around here. This is also a common mistake, but it&#39;s hard to search for. Don&#39;t worry about it, have an upvote!"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1443110516, "last_edit_date": 1443110516, "creation_date": 1443107485, "answer_id": 32764930, "question_id": 32764670, "link": "https://stackoverflow.com/questions/32764670/how-do-i-execute-a-find-command-with-multiple-iname-matchers-in-go/32764930#32764930", "title": "How do I execute a find command with multiple iname matchers in Go?", "body": "<p><code>exec.Command</code> isn't a shell, so you don't need to escape special characters in your command. Pass each argument in exactly how you want it processed by the command.</p>\n\n<pre><code>exec.Command(\"find\", dir, \"-type\", \"f\", \"(\", \"-iname\", \"*.zip\", \"-o\", \"-iname\", \"*.tar\", \"-o\", \"-iname\", \"*.rar\", \")\")\n</code></pre>\n"}], "owner": {"reputation": 1206, "user_id": 783116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZOv9Y.jpg?s=128&g=1", "display_name": "josiah", "link": "https://stackoverflow.com/users/783116/josiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 32764930, "answer_count": 1, "score": 0, "last_activity_date": 1443110516, "creation_date": 1443106785, "question_id": 32764670, "link": "https://stackoverflow.com/questions/32764670/how-do-i-execute-a-find-command-with-multiple-iname-matchers-in-go", "title": "How do I execute a find command with multiple iname matchers in Go?", "body": "<p>I need to execute this sort of command through the Go programming language:</p>\n\n<p><code>find /some/dir/path -type f \\( -iname \\*.zip -o -iname \\*.tar -o -iname \\*.rar \\)</code></p>\n\n<p>I discovered exec.Command and tried various ways of executing the <code>find</code> command,\ne.g.</p>\n\n<pre><code>exec.Command(\"find\", dir, \"-type\", \"f\", \"\\\\( -iname \\\\*.zip -o -iname \\\\*.tar -o -iname \\\\*.rar \\\\)\")\nexec.Command(\"find\", dir, \"-type\", \"f\", \"-iname\", \"*.zip\", \"-o\", \"-iname\", \"*.tar\", \"-o\", \"-iname\", \"*.rar\")\nexec.Command(\"find\", dir, \"-type\", \"f\", \"\\\\(\", \"-iname\", \"\\\\*.zip\", \"-o\", \"-iname\", \"\\\\*.tar\", \"-o\", \"-iname\", \"\\\\*.rar\", \"\\\\)\")\n</code></pre>\n\n<p>None of the above have worked for me.  Is there a way to do this, or am I just going to have to issue 3 separate find commands in Go?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 4932, "user_id": 1037753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/16171e0d57d12b30006d90dfb4e43909?s=128&d=identicon&r=PG", "display_name": "konqi", "link": "https://stackoverflow.com/users/1037753/konqi"}, "edited": false, "score": 0, "creation_date": 1443170052, "post_id": 32764351, "comment_id": 53394467, "body": "I&#39;m not sure what an incomplete key is nor how you can have entitites without an id, but are you aware that you can allocate an id for your entity before storing it in datastore (<a href=\"https://cloud.google.com/appengine/docs/python/datastore/functions#allocate_ids\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/python/datastore/&hellip;</a>)? Could this help?"}, {"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "reply_to_user": {"reputation": 4932, "user_id": 1037753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/16171e0d57d12b30006d90dfb4e43909?s=128&d=identicon&r=PG", "display_name": "konqi", "link": "https://stackoverflow.com/users/1037753/konqi"}, "edited": false, "score": 0, "creation_date": 1443170806, "post_id": 32764351, "comment_id": 53394950, "body": "thanks, but that&#39;s a bit different. Incomplete key is specifically a way to have datastore generate an unused key right then and there"}], "answers": [{"comments": [{"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1443173125, "post_id": 32778880, "comment_id": 53396275, "body": "Aren&#39;t you simply suggesting to run a query twice (once to get the keys, another for the data), rather than inserting it twice at creation?"}, {"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1443173229, "post_id": 32778880, "comment_id": 53396335, "body": "oh nm, didn&#39;t realize return was keys and it populates the pointer provided, thanks :)"}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1443174166, "post_id": 32778880, "comment_id": 53396893, "body": "Yes, it would be very strange if they would force us to put or read twice to have a reference to an ID :)"}], "tags": [], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "is_accepted": true, "score": 1, "last_activity_date": 1443173943, "last_edit_date": 1443173943, "creation_date": 1443172847, "answer_id": 32778880, "question_id": 32764351, "link": "https://stackoverflow.com/questions/32764351/best-practice-to-add-the-id-to-a-datastore-entity/32778880#32778880", "title": "Best practice to add the ID to a datastore entity?", "body": "<p>You don't need to put the MyStruct into DB twice - it's unnecessary overhead. The key stored as a part of the entity and can be retrieved when needed.</p>\n\n<p>There is a good example in docs on how to store an entity and used it ID as a reference: <a href=\"https://cloud.google.com/appengine/docs/go/datastore/entities#Go_Ancestor_paths\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/datastore/entities#Go_Ancestor_paths</a></p>\n\n<p>When you want to get keys for entities you can do this using this approach:\n<a href=\"https://cloud.google.com/appengine/docs/go/datastore/queries#Go_Retrieving_results\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/datastore/queries#Go_Retrieving_results</a> - (<em>edited</em>) notice in the example that keys and structs are populated in 1 operation.</p>\n\n<p>If you query the an entity by key you already know it ID.</p>\n\n<p>So there is no need to have an ID as a separate property. If you want to pass it around with the entity for your business logic you can create a wrapper - either generalized using interface() for the entity struct or a strongly typed (1 per each entity struct).</p>\n"}], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 32778880, "answer_count": 1, "score": 1, "last_activity_date": 1475211361, "creation_date": 1443105898, "last_edit_date": 1475211361, "question_id": 32764351, "link": "https://stackoverflow.com/questions/32764351/best-practice-to-add-the-id-to-a-datastore-entity", "title": "Best practice to add the ID to a datastore entity?", "body": "<p>When creating an entity using an IncompleteKey so that each record is inherently unique, what is the best way to add the key back into the record so it can be passed around in the structure- at the time of creation?</p>\n\n<p>For example, is something like this (untested code) a good idea, using Transactions?</p>\n\n<pre><code> err = datastore.RunInTransaction(c, func(c appengine.Context) error {\n        incompleteKey := datastore.NewIncompleteKey(c, ENTITY_TYPE, nil)\n        entityKey, err := datastore.Put(c, incompleteKey, &amp;MyStruct)\n        if(err != nil) {\n            return err\n        }\n\n        MyStruct.SelfID = entityKey.IntID()\n        _, err = datastore.Put(c, entityKey, &amp;MyStruct)\n\n        return err\n    }, nil)\n</code></pre>\n\n<p>As a followup- I'm guessing this should almost never fail since it will almost never operate over the same incompleteKey?</p>\n"}, {"tags": ["go", "core.async"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1443102182, "post_id": 32762648, "comment_id": 53365007, "body": "Just in case: <a href=\"http://blog.joshsoftware.com/2015/09/24/rails-elasticsearch-go-merry-go-round/\" rel=\"nofollow noreferrer\">blog.joshsoftware.com/2015/09/24/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 1080568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76a8f4849829643862f7c5dd89cb11e?s=128&d=identicon&r=PG", "display_name": "LK4D4", "link": "https://stackoverflow.com/users/1080568/lk4d4"}, "is_accepted": false, "score": 0, "last_activity_date": 1443116203, "creation_date": 1443116203, "answer_id": 32767593, "question_id": 32762648, "link": "https://stackoverflow.com/questions/32762648/batch-processing-items-from-a-output-channel-in-golang-or-core-async/32767593#32767593", "title": "batch processing items from a output channel in golang or core.async", "body": "<p>Blocking queue need to be written and it requires proper synchronization, which already done for channels in runtime.\nIn you case I'd go with make(chan []*Message, buffer), so you synchronously in loop collecting messages to slice until it reaches necessary length or when timeout is reached and then send it to process in channel. That will be pretty simple and doesn't require any complicated datastructures.</p>\n"}], "owner": {"reputation": 21, "user_id": 1721878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd50f3b3d866674199c26622f29d219e?s=128&d=identicon&r=PG", "display_name": "Yunfeng", "link": "https://stackoverflow.com/users/1721878/yunfeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1504, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443116203, "creation_date": 1443101302, "question_id": 32762648, "link": "https://stackoverflow.com/questions/32762648/batch-processing-items-from-a-output-channel-in-golang-or-core-async", "title": "batch processing items from a output channel in golang or core.async", "body": "<p>I have a use case to indexing data from kafka into elasticsearch. Elasticsearch has a bulk API, which bundles multiple messages together in one API call for indexing. It is much more efficient than doing indexing one by one on each message. </p>\n\n<p>I am using Clojure to do this. naturally, I would like to use core.async, consuming messages from kafka and input into a channel, buffered for some time or when the channel has enough messages before indexing them in one elasticsearch bulk API call.</p>\n\n<p>The problem is the output of the channel will be signaled as long as there is one message coming in. </p>\n\n<p>One simple solution is buffering the incoming messages from the output of the channel in a blocking queue, but that sounds like to defeat the purpose of using channel. why not just using a blocking queue without channel?</p>\n\n<p>Any suggestion to use channel for batch processing ? thanks. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5370520"}, "edited": false, "score": 1, "creation_date": 1443088152, "post_id": 32758274, "comment_id": 53355832, "body": "If i need to run/ modify the code then it doesn&#39;t find packages."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5370520"}, "edited": false, "score": 1, "creation_date": 1443088296, "post_id": 32758274, "comment_id": 53355924, "body": "I know i can get packages by go get &lt;package&gt; but it is so much time consuming and difficult when the program uses many packages."}, {"owner": {"reputation": 1734, "user_id": 271996, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MuIHF.jpg?s=128&g=1", "display_name": "honzajde", "link": "https://stackoverflow.com/users/271996/honzajde"}, "edited": false, "score": 4, "creation_date": 1492606060, "post_id": 32758274, "comment_id": 74046620, "body": "-t will install also test dependencies"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "reply_to_user": {"reputation": 926, "user_id": 6174476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rnHQ.jpg?s=128&g=1", "display_name": "Alberto Schiabel", "link": "https://stackoverflow.com/users/6174476/alberto-schiabel"}, "edited": false, "score": 3, "creation_date": 1494508910, "post_id": 32758274, "comment_id": 74866486, "body": "@AlbertoSchiabel <code>...</code> is a special pattern. It tells to go down recursively. I&#39;ve updated an answer"}, {"owner": {"reputation": 926, "user_id": 6174476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rnHQ.jpg?s=128&g=1", "display_name": "Alberto Schiabel", "link": "https://stackoverflow.com/users/6174476/alberto-schiabel"}, "edited": false, "score": 0, "creation_date": 1494509350, "post_id": 32758274, "comment_id": 74866841, "body": "Thanks @RoninDev! At first I was going to edit your answer to <code>.&#47;.</code>, because after having tried you command on my pc it kind of stuck (and now I know why, since recursive search of go files can be quite expensive), but then I realized it was better to ask first. Thanks!"}, {"owner": {"reputation": 981, "user_id": 4637358, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/sIfTB.jpg?s=128&g=1", "display_name": "1a1a11a", "link": "https://stackoverflow.com/users/4637358/1a1a11a"}, "edited": false, "score": 0, "creation_date": 1551464257, "post_id": 32758274, "comment_id": 96663192, "body": "It does not download the dependency of dependency? So me depends on A, but A depends on B, it seems B will not be downloaded automatically."}], "tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": false, "score": 226, "last_activity_date": 1494509022, "last_edit_date": 1494509022, "creation_date": 1443088079, "answer_id": 32758274, "question_id": 32758235, "link": "https://stackoverflow.com/questions/32758235/how-to-get-all-dependency-files-for-a-program/32758274#32758274", "title": "How to get all dependency files for a program", "body": "<p>You can run <code>go get -d ./...</code> from a directory of your project to download all go-gettable dependencies.<br>\nOr copy all <code>src</code> subdirectory from your GOPATH to the destination machine.<br>\n<code>...</code> is a special pattern, tells to go down recursively.</p>\n"}, {"comments": [{"owner": {"reputation": 1408, "user_id": 179037, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/76cf60c6bf25b05552b28ac82a53d9be?s=128&d=identicon&r=PG", "display_name": "Patratacus", "link": "https://stackoverflow.com/users/179037/patratacus"}, "edited": false, "score": 8, "creation_date": 1543117314, "post_id": 32758318, "comment_id": 93799932, "body": "Maybe it&#39;s obvious to some people, but I had to go dig this up.  Turns out you need to install the godep or dep package to Go.  The Github stie for this is here: <a href=\"https://github.com/tools/godep\" rel=\"nofollow noreferrer\">github.com/tools/godep</a>"}], "tags": [], "owner": {"reputation": 2025, "user_id": 1359137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1da62381332ae241f4a28acf7c2f5f52?s=128&d=identicon&r=PG", "display_name": "Animesh Kumar Paul", "link": "https://stackoverflow.com/users/1359137/animesh-kumar-paul"}, "is_accepted": true, "score": 9, "last_activity_date": 1443088225, "creation_date": 1443088225, "answer_id": 32758318, "question_id": 32758235, "link": "https://stackoverflow.com/questions/32758235/how-to-get-all-dependency-files-for-a-program/32758318#32758318", "title": "How to get all dependency files for a program", "body": "<p>You can use <code>godep save</code> in your local pc where you complete your program. godep save collect all the dependency files for you. When you move to other pc, just copy the Godep folder with your code and it will solve your problems.</p>\n"}, {"tags": [], "owner": {"reputation": 9858, "user_id": 973380, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b760f503c84d1bf47322f401066c753f?s=128&d=identicon&r=PG", "display_name": "fiatjaf", "link": "https://stackoverflow.com/users/973380/fiatjaf"}, "is_accepted": false, "score": 55, "last_activity_date": 1490844206, "creation_date": 1490844206, "answer_id": 43107943, "question_id": 32758235, "link": "https://stackoverflow.com/questions/32758235/how-to-get-all-dependency-files-for-a-program/43107943#43107943", "title": "How to get all dependency files for a program", "body": "<p>Try</p>\n\n<pre><code>go list -f '{{ join .Imports \"\\n\" }}'\n</code></pre>\n\n<p>or </p>\n\n<pre><code>go list -f '{{ join .Deps \"\\n\" }}'\n</code></pre>\n\n<p>The second will list all subdependencies, the first only the directly imported packages.</p>\n"}, {"comments": [{"owner": {"reputation": 5550, "user_id": 1381737, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CvRNl.jpg?s=128&g=1", "display_name": "Yuseferi", "link": "https://stackoverflow.com/users/1381737/yuseferi"}, "edited": false, "score": 0, "creation_date": 1601826524, "post_id": 58705828, "comment_id": 113520142, "body": "it takes a long time !!! it downloads packages that I never used in the project!"}], "tags": [], "owner": {"reputation": 908, "user_id": 3649496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c95010d46812ccabe7eea947a090ab?s=128&d=identicon&r=PG&f=1", "display_name": "infiniteLearner", "link": "https://stackoverflow.com/users/3649496/infinitelearner"}, "is_accepted": false, "score": 31, "last_activity_date": 1572936293, "creation_date": 1572936293, "answer_id": 58705828, "question_id": 32758235, "link": "https://stackoverflow.com/questions/32758235/how-to-get-all-dependency-files-for-a-program/58705828#58705828", "title": "How to get all dependency files for a program", "body": "<p>Below command works for me it downloads all the dependencies.</p>\n\n<pre><code>go get -u -v -f all\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1611231649, "creation_date": 1611231649, "answer_id": 65827321, "question_id": 32758235, "link": "https://stackoverflow.com/questions/32758235/how-to-get-all-dependency-files-for-a-program/65827321#65827321", "title": "How to get all dependency files for a program", "body": "<p>Best way ever is get the list and iterate installing the packages, this works so fine:</p>\n<pre><code>while read l; do go get -v &quot;$l&quot;; done &lt; &lt;(go list -f '{{ join .Imports &quot;\\n&quot; }}')\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5370520"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95021, "favorite_count": 37, "accepted_answer_id": 32758318, "answer_count": 5, "score": 101, "last_activity_date": 1613030183, "creation_date": 1443087943, "last_edit_date": 1613030183, "question_id": 32758235, "link": "https://stackoverflow.com/questions/32758235/how-to-get-all-dependency-files-for-a-program", "title": "How to get all dependency files for a program", "body": "<p>I make a program in Go and after completing the code, if I want to run this code on other pc or VM, then it does not get all the dependency package files. How can I get all dependency files?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 84157, "user_id": 238978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a633afaf19e6d4bb53ee50b62e3b5397?s=128&d=identicon&r=PG", "display_name": "Emil Vikstr&#246;m", "link": "https://stackoverflow.com/users/238978/emil-vikstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1443082707, "post_id": 32756524, "comment_id": 53352496, "body": "Where do you believe it should deadlock?"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "reply_to_user": {"reputation": 84157, "user_id": 238978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a633afaf19e6d4bb53ee50b62e3b5397?s=128&d=identicon&r=PG", "display_name": "Emil Vikstr&#246;m", "link": "https://stackoverflow.com/users/238978/emil-vikstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1443082775, "post_id": 32756524, "comment_id": 53352541, "body": "@EmilVikstr&#246;m at <code>log.Println(&lt;-test_channel)</code> after 10 iterations"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1443082928, "post_id": 32756524, "comment_id": 53352630, "body": "I have deadlock on windows amd64 go 1.5.1 as expected"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1443083209, "post_id": 32756524, "comment_id": 53352788, "body": "What did you mean saying &quot;it would perform well&quot;? What do you expect?"}, {"owner": {"reputation": 123, "user_id": 5332240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-zgQXo-_vYps/AAAAAAAAAAI/AAAAAAAAAgs/dHE1BP-zZGo/photo.jpg?sz=128", "display_name": "Wei Jian Guo", "link": "https://stackoverflow.com/users/5332240/wei-jian-guo"}, "edited": false, "score": 0, "creation_date": 1443083348, "post_id": 32756524, "comment_id": 53352878, "body": "i mean it would raise a deadlock error as expected.@RoninDev"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1443083930, "post_id": 32756524, "comment_id": 53353199, "body": "I got deadlock at windows amd64 go1.5.1, and on linux 3.13 go1.4.2 amd64. With and without <code>useless_func</code>"}, {"owner": {"reputation": 123, "user_id": 5332240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-zgQXo-_vYps/AAAAAAAAAAI/AAAAAAAAAgs/dHE1BP-zZGo/photo.jpg?sz=128", "display_name": "Wei Jian Guo", "link": "https://stackoverflow.com/users/5332240/wei-jian-guo"}, "edited": false, "score": 0, "creation_date": 1443085048, "post_id": 32756524, "comment_id": 53353825, "body": "could you try go 1.5.1 on linux? i got deadlock when i use go 1.4@RoniDev"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1443087652, "post_id": 32756524, "comment_id": 53355534, "body": "Done! I confirm, that go1.5.1 on linux amd64 doesn&#39;t detect deadlock properly. And also confirm that removing of <code>useless_func</code> helps. Interesting!"}], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 5332240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-zgQXo-_vYps/AAAAAAAAAAI/AAAAAAAAAgs/dHE1BP-zZGo/photo.jpg?sz=128", "display_name": "Wei Jian Guo", "link": "https://stackoverflow.com/users/5332240/wei-jian-guo"}, "is_accepted": true, "score": 5, "last_activity_date": 1503915990, "last_edit_date": 1503915990, "creation_date": 1443147789, "answer_id": 32773802, "question_id": 32756524, "link": "https://stackoverflow.com/questions/32756524/golang-have-weird-behavior-in-deadlock-detection/32773802#32773802", "title": "golang have weird behavior in deadlock detection", "body": "<p><a href=\"https://github.com/dominikh\" rel=\"nofollow noreferrer\">Dominik Honnef</a> provides the answer in response to <a href=\"https://github.com/golang/go/issues/12734\" rel=\"nofollow noreferrer\">issue ##12734 for Go 1.5.1</a>:</p>\n\n<blockquote>\n  <p><strong>dominikh</strong>: The issue really lies with using cgo (which net uses, ignoring the details). When using cgo, the Go deadlock detection cannot function properly, because C world might call Go functions at any time, so in theory no deadlock exists; we might just be waiting for an external function call indefinitely.</p>\n</blockquote>\n"}], "owner": {"reputation": 123, "user_id": 5332240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-zgQXo-_vYps/AAAAAAAAAAI/AAAAAAAAAgs/dHE1BP-zZGo/photo.jpg?sz=128", "display_name": "Wei Jian Guo", "link": "https://stackoverflow.com/users/5332240/wei-jian-guo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 32773802, "answer_count": 1, "score": 2, "last_activity_date": 1503915990, "creation_date": 1443082518, "question_id": 32756524, "link": "https://stackoverflow.com/questions/32756524/golang-have-weird-behavior-in-deadlock-detection", "title": "golang have weird behavior in deadlock detection", "body": "<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc useless_func(address string) []byte {\n    http.Get(\"https://www.google.com\")\n    return nil\n}\nfunc test_a(test_channel chan int) {\n    test_channel &lt;- 1\n    return\n}\n\nfunc test() {\n    test_channel := make(chan int)\n    for i := 0; i &lt; 10; i++ {\n        go test_a(test_channel)\n    }\n    for {\n        log.Println(&lt;-test_channel)\n    }\n}\nfunc main() {\n    test()\n}\n</code></pre>\n\n<p>this code would not break because of deadlock, I try this code under Linux 4.1.6-1 and 3.16.0-4 with go 1.5.1 amd64 and got same result. but if i delete useless_func or use go 1.4.3 or run this under windows,it would perform well. this is really weird, if anyone could explain this?</p>\n"}, {"tags": ["struct", "go", "initialization"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1443078403, "post_id": 32755068, "comment_id": 53350317, "body": "Better would be to use <a href=\"https://golang.org/pkg/time/#Time.IsZero\" rel=\"nofollow noreferrer\"><code>Time.IsZero()</code></a>. For example <code>fmt.Println(time.Time{}.IsZero())</code> prints <code>true</code>."}, {"owner": {"reputation": 201, "user_id": 1703151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20G3b.jpg?s=128&g=1", "display_name": "Anders Olsson", "link": "https://stackoverflow.com/users/1703151/anders-olsson"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1443082810, "post_id": 32755068, "comment_id": 53352561, "body": "Thanks for that remark @icza, I&#39;ll put it to use."}], "answers": [{"comments": [{"owner": {"reputation": 4011, "user_id": 29703, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/32e50f8f8e17d63c49bf03d54a48282a?s=128&d=identicon&r=PG", "display_name": "Jeffrey Martinez", "link": "https://stackoverflow.com/users/29703/jeffrey-martinez"}, "edited": false, "score": 5, "creation_date": 1443079141, "post_id": 32755159, "comment_id": 53350655, "body": "This info is found in the Go spec in the last few paragraphs of the Composite Literals section (<a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Composite_literals</a>). Do a find for &quot;A parsing ambiguity arises when&quot; to skip to the right paragraph."}, {"owner": {"reputation": 201, "user_id": 1703151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20G3b.jpg?s=128&g=1", "display_name": "Anders Olsson", "link": "https://stackoverflow.com/users/1703151/anders-olsson"}, "edited": false, "score": 0, "creation_date": 1443083074, "post_id": 32755159, "comment_id": 53352699, "body": "OK, so technically, this is a bug/shortcoming in the go lexer? Good to see it&#39;s documented (although I failed to find it). Wrapping looks like a passable alternative for when new cannot be used (for the cases where fields need to be set). Thanks!"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 10, "last_activity_date": 1443078060, "last_edit_date": 1443078060, "creation_date": 1443077693, "answer_id": 32755159, "question_id": 32755068, "link": "https://stackoverflow.com/questions/32755068/cannot-init-struct-in-if-construct-in-go/32755159#32755159", "title": "Cannot init struct in if construct in Go", "body": "<p>The <code>{</code> is recognized as the beginning of a <code>Block</code>, terminating the parsing of the <code>SimpleStmt</code>. After committing to that decision, the compiler decides that, as a <code>SimpleStmt</code>, <code>aTime := time.Time</code> isn't valid because <code>time.Time</code> isn't a value that can be assigned. However, it's presumably too late for the parser to try another interpretation of the <code>{</code>.</p>\n\n<p>The version with <code>new</code> works because it doesn't contain a <code>{</code> character, and so avoids confusing the parser in this way.</p>\n\n<p>You can also use the literal format by wrapping it in parentheses, because a block can't legally begin in the middle of an expression, so this also works:</p>\n\n<pre><code>if defaultTime := (time.Time{}); aTime != defaultTime {\n    // ...\n}\n</code></pre>\n\n<p><code>gofmt</code> gives the helpful message \"expected boolean expression, found simple statement (missing parentheses around composite literal?)\", but oddly, the go compiler itself does not.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 207502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2681b590c1e41f59f3455463a99baef?s=128&d=identicon&r=PG&f=1", "display_name": "razorsniper", "link": "https://stackoverflow.com/users/207502/razorsniper"}, "is_accepted": false, "score": 0, "last_activity_date": 1605186181, "creation_date": 1605186181, "answer_id": 64804444, "question_id": 32755068, "link": "https://stackoverflow.com/questions/32755068/cannot-init-struct-in-if-construct-in-go/64804444#64804444", "title": "Cannot init struct in if construct in Go", "body": "<p>I don't think what I am going to suggest is necessarily a better solution. But for your use case, you can try this to be concise</p>\n<pre><code>if !aTime.IsZero() {\n    // ...\n}\n</code></pre>\n<p>Ymmv</p>\n"}], "owner": {"reputation": 201, "user_id": 1703151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/20G3b.jpg?s=128&g=1", "display_name": "Anders Olsson", "link": "https://stackoverflow.com/users/1703151/anders-olsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1372, "favorite_count": 1, "accepted_answer_id": 32755159, "answer_count": 2, "score": 2, "last_activity_date": 1605186181, "creation_date": 1443077355, "last_edit_date": 1592644375, "question_id": 32755068, "link": "https://stackoverflow.com/questions/32755068/cannot-init-struct-in-if-construct-in-go", "title": "Cannot init struct in if construct in Go", "body": "<p>I got a great surprise when I noticed the following snippet not compiling:</p>\n<pre><code>aTime := time.Time{}\nif defaultTime := time.Time{} ; aTime != defaultTime {}\n</code></pre>\n<p>The compiler returns:</p>\n<blockquote>\n<p>type time.Time is not an expression</p>\n<p>defaultTime := time.Time used as</p>\n<p>value undefined: defaultTime</p>\n</blockquote>\n<p>The intent here is to test the <em>aTime</em> variable if it's set to it's default value.</p>\n<p>It also does not compile if I get the pointer of the struct (<em>defaultTime := &amp;time.Time{}</em>).</p>\n<p>However, it does compile if I init defaultTime outside of the if construct, or do the init using the new() builtin:</p>\n<pre><code>aTime := time.Time{}\nif defaultTime := new(time.Time) ; aTime != *defaultTime {}\n</code></pre>\n<p>From what I've read everywhere, <em>new(myStruct)</em> it supposed to be completely equivalent to <em>&amp;myStruct{}</em>.</p>\n<p>As I interprate it, <em>defaultValue := time.Time{}</em> qualifies as a <a href=\"https://golang.org/ref/spec#SimpleStmt\" rel=\"nofollow noreferrer\">SimpleStmt</a> (specifically an <a href=\"https://golang.org/ref/spec#Assignment\" rel=\"nofollow noreferrer\">Assignment</a>), as detailed in the <a href=\"https://golang.org/ref/spec#If_statements\" rel=\"nofollow noreferrer\">If statement spec</a>.</p>\n<p>I've come up with no explanation for this behavior, despite my best googling efforts. Would be grateful if someone could make my head stop spinning.</p>\n"}, {"tags": ["windows", "go", "symlink"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1443078715, "last_edit_date": 1443078715, "creation_date": 1443074501, "answer_id": 32754391, "question_id": 32753907, "link": "https://stackoverflow.com/questions/32753907/difference-between-windows-symbolic-links-and-directories/32754391#32754391", "title": "Difference between windows symbolic links and directories", "body": "<p>The only test I see (and I just tested it with go 1.5.1 on Windows) is in <a href=\"https://github.com/golang/go/blob/c2025c4131a62bc034c663d2e8c22e37b09fce04/src/os/os_test.go#L600-L602\" rel=\"nofollow\"><code>os/os_test.go</code></a>:</p>\n\n<pre><code>fromstat, err = Lstat(from)\nif err != nil {\n    t.Fatalf(\"lstat %q failed: %v\", from, err)\n}\nif fromstat.Mode()&amp;ModeSymlink == 0 {\n    t.Fatalf(\"symlink %q, %q did not create symlink\", to, from)\n}\n</code></pre>\n\n<p>It uses <a href=\"https://golang.org/pkg/os/#Lstat\" rel=\"nofollow\"><code>os/#Lstat</code></a>:</p>\n\n<blockquote>\n  <p><code>Lstat</code> returns a <a href=\"https://golang.org/pkg/os/#FileInfo\" rel=\"nofollow\"><code>FileInfo</code></a> describing the named file.<br>\n  If the file is a symbolic link, the returned <code>FileInfo</code> describes the symbolic link. <code>Lstat</code> makes no attempt to follow the link.<br>\n  If there is an error, it will be of type <a href=\"https://golang.org/pkg/os/#PathError\" rel=\"nofollow\"><code>*PathError</code></a>. </p>\n</blockquote>\n\n<p>You can also get <a href=\"https://golang.org/pkg/os/#File.Stat\" rel=\"nofollow\"><code>os.Stat()</code></a> of the same folder, and then call <a href=\"https://golang.org/pkg/os/#SameFile\" rel=\"nofollow\"><code>os.Samefile()</code></a> (as <a href=\"https://github.com/golang/go/blob/c2025c4131a62bc034c663d2e8c22e37b09fce04/src/os/os_test.go#L545-L555\" rel=\"nofollow\">in this test</a>):</p>\n\n<pre><code>if !SameFile(tostat, fromstat) {\n    t.Errorf(\"symlink %q, %q did not create symlink\", to, from)\n}\n</code></pre>\n"}], "owner": {"reputation": 495, "user_id": 1950663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nBJeA.png?s=128&g=1", "display_name": "CoppolaEmilio", "link": "https://stackoverflow.com/users/1950663/coppolaemilio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 2, "accepted_answer_id": 32754391, "answer_count": 1, "score": 2, "last_activity_date": 1443078715, "creation_date": 1443072110, "question_id": 32753907, "link": "https://stackoverflow.com/questions/32753907/difference-between-windows-symbolic-links-and-directories", "title": "Difference between windows symbolic links and directories", "body": "<p>I run into a problem with Go when trying to tell difference between windows symbolic links and directories.\nI've googled and all I could find was this:\n<a href=\"https://github.com/golang/go/issues/3498#issuecomment-142810957\" rel=\"nofollow\">https://github.com/golang/go/issues/3498#issuecomment-142810957</a></p>\n\n<p>Which is unfortunately closed and not being worked on. </p>\n\n<p>So my question is, is there any workaround? I tried to listdir the path with the symlinks but it is returning the same that it would return on an empty directory.</p>\n\n<p>With python I was able to do something like this:</p>\n\n<pre><code>def test(dir):\n    try:\n        os.chdir(dir)\n    except Exception as e:\n        if \"[Error 2]\" in str(e):\n            return False\n        else:\n            return True\n</code></pre>\n\n<p>Is there any bash command I could use to call from go to detect it? </p>\n\n<p>I'm running out of ideas :(</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 6, "creation_date": 1443061726, "post_id": 32752356, "comment_id": 53345231, "body": "<a href=\"http://programmers.stackexchange.com/questions/222642/are-go-langs-goroutine-pools-just-green-threads\" title=\"are go langs goroutine pools just green threads\">programmers.stackexchange.com/questions/222642/&hellip;</a> ,<a href=\"http://stackoverflow.com/questions/18058164/is-golang-goroutine-a-coroutine\" title=\"is golang goroutine a coroutine\">stackoverflow.com/questions/18058164/&hellip;</a> - more insteresting reading, search for &#39;green threads&#39;, as the term commonly fits in the talk"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1443078518, "post_id": 32752356, "comment_id": 53350373, "body": "Without an extra careful reading of the spec: I think this is an implementation &quot;detail&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 2774002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntpn9.gif?s=128&g=1", "display_name": "Ian Lance Taylor", "link": "https://stackoverflow.com/users/2774002/ian-lance-taylor"}, "is_accepted": true, "score": 4, "last_activity_date": 1443114968, "creation_date": 1443114968, "answer_id": 32767283, "question_id": 32752356, "link": "https://stackoverflow.com/questions/32752356/what-is-the-architecture-behind-golangs-go-routine/32767283#32767283", "title": "What is the architecture behind Golang&#39;s Go Routine?", "body": "<p>There have been Go implementations in the past that did in fact create a new thread for each goroutine.</p>\n\n<p>In the main Go implementation, a Go routine is basically just a stack (usually small) with some additional context (in 1.5, see <code>type g</code> in runtime/runtime2.go).  Changing from goroutine to another means changing the stack pointer and the thread-local variable that points to the currently running goroutine.</p>\n"}], "owner": {"reputation": 1016, "user_id": 927687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1be4ac81206ec06500f79d1b9972f25d?s=128&d=identicon&r=PG", "display_name": "Bhoomtawath Plinsut", "link": "https://stackoverflow.com/users/927687/bhoomtawath-plinsut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 32767283, "answer_count": 1, "score": 1, "last_activity_date": 1443114968, "creation_date": 1443061556, "last_edit_date": 1443061680, "question_id": 32752356, "link": "https://stackoverflow.com/questions/32752356/what-is-the-architecture-behind-golangs-go-routine", "title": "What is the architecture behind Golang&#39;s Go Routine?", "body": "<p>What is the architecture behind Golang's Go Routine?</p>\n\n<p>I believe that Go doesn't just fork a new thread for each routine.</p>\n"}, {"tags": ["string", "go"], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 5075147, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1cc012826cd46b0fee58b7757dcea8d4?s=128&d=identicon&r=PG", "display_name": "btald1331", "link": "https://stackoverflow.com/users/5075147/btald1331"}, "edited": false, "score": 0, "creation_date": 1443057934, "post_id": 32751773, "comment_id": 53344360, "body": "Thank you, this worked great, and is very similar to tokenizer."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": false, "score": 14, "last_activity_date": 1443056425, "creation_date": 1443056425, "answer_id": 32751773, "question_id": 32751653, "link": "https://stackoverflow.com/questions/32751653/go-language-a-way-to-tokenize-a-string/32751773#32751773", "title": "Go Language: A way to tokenize a string", "body": "<p>You can just split on spaces and take the middle one:</p>\n\n<pre><code>s := \"Destination: 149.164.31.169 (149.164.31.169)\"\nparts := strings.Split(s, \" \")\nif len(parts) != 3 {\n    panic(\"Should have had three parts\")\n}\nprintln(parts[1])\n</code></pre>\n\n<p>There are lots of other approaches. The <code>strings</code> package is the place to look. Of course if you need something much more complex, you can look at <code>regex</code> for regular expressions, but that'd be overkill here. If you really need a tokenizer, look at <code>text/scanner</code>, but again, that's way too much for this.</p>\n"}], "owner": {"reputation": 337, "user_id": 5075147, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1cc012826cd46b0fee58b7757dcea8d4?s=128&d=identicon&r=PG", "display_name": "btald1331", "link": "https://stackoverflow.com/users/5075147/btald1331"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3823, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1443056425, "creation_date": 1443055516, "question_id": 32751653, "link": "https://stackoverflow.com/questions/32751653/go-language-a-way-to-tokenize-a-string", "title": "Go Language: A way to tokenize a string", "body": "<p>I have a Go Program where I need to search through multiple strings for a specific pattern. The Strings all look like this:</p>\n\n<pre><code> Destination: 149.164.31.169 (149.164.31.169) \n</code></pre>\n\n<p>I'd like to just extract the IP <code>149.164.31.169</code>, either the middle one or the one in parenthesis, they will always be the same. In Java I would do something along the lines of using a string tokenizer to gather the part of the string I need, but I didnn't find a function similar in go. </p>\n\n<p>Does anyone know how I can achieve this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1443055485, "post_id": 32751537, "comment_id": 53343868, "body": "<code>p[&quot;HM&quot;]</code> isn&#39;t quite a regular pointer value, because the values in a map get moved around in memory, and the old locations become invalid, when the map grows. So you can&#39;t do all the operations on it that you could do on a regular pointer. Besides your solution (change it to an assignment, one of the allowed operations, which seems good here), another approach (maybe good for large objects?) is to make the map value a regular old pointer that you <i>can</i> modify the underlying object through: <a href=\"http://play.golang.org/p/n5C4CsKOAV\" rel=\"nofollow noreferrer\">play.golang.org/p/n5C4CsKOAV</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1443055748, "post_id": 32751537, "comment_id": 53343926, "body": "The specific things you can do with <code>p[&quot;HM&quot;]</code> are scattered around <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">the spec</a> if you search for &quot;index expression&quot;: you can read the value, assign a new whole value, delete, increment/decrement numeric values."}, {"owner": {"reputation": 3774, "user_id": 125875, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbe0f15c8f3c695d86d9ff3a1a4d5cfd?s=128&d=identicon&r=PG", "display_name": "sbeam", "link": "https://stackoverflow.com/users/125875/sbeam"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1443056023, "post_id": 32751537, "comment_id": 53343980, "body": "ah that makes sense - I did try making a pointer <code>*Person</code> at one point but I think I forgot to create the reference with <code>&amp;</code> - still getting used to this. thanks, make it an answer and I&#39;d accept..."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1443059041, "post_id": 32751537, "comment_id": 53344604, "body": "^^ that (and other answers) was found with a trivial and obvious <code>[go] map cannot assign</code> search."}, {"owner": {"reputation": 3774, "user_id": 125875, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbe0f15c8f3c695d86d9ff3a1a4d5cfd?s=128&d=identicon&r=PG", "display_name": "sbeam", "link": "https://stackoverflow.com/users/125875/sbeam"}, "edited": false, "score": 1, "creation_date": 1443063445, "post_id": 32751537, "comment_id": 53345611, "body": "you are right, I did a search but not the right one. I am ashamed :( but I think the takeaway is also that the &quot;cannot assign&quot; error means &quot;the left side of the assignment is not an addressable value&quot; (which imo would be a better and more searchable message)"}], "answers": [{"comments": [{"owner": {"reputation": 910, "user_id": 426853, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7fbf02bd4eb6fa180937d44a6afdcd0?s=128&d=identicon&r=PG", "display_name": "Mike Ellis", "link": "https://stackoverflow.com/users/426853/mike-ellis"}, "edited": false, "score": 7, "creation_date": 1536019739, "post_id": 32751792, "comment_id": 91264852, "body": "The suggestion to use a map of pointers, e.g. <code>map[string]*MyStruct</code> solved a similar problem for me."}, {"owner": {"reputation": 63, "user_id": 1853733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95fa0e937eaadf84f06a427a5b2d8655?s=128&d=identicon&r=PG", "display_name": "hunter_tech", "link": "https://stackoverflow.com/users/1853733/hunter-tech"}, "edited": false, "score": 0, "creation_date": 1606827207, "post_id": 32751792, "comment_id": 115074548, "body": "Then why unordered_map in stl C++ can support addressing, which faces the same reallocation problem?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 63, "user_id": 1853733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95fa0e937eaadf84f06a427a5b2d8655?s=128&d=identicon&r=PG", "display_name": "hunter_tech", "link": "https://stackoverflow.com/users/1853733/hunter-tech"}, "edited": false, "score": 0, "creation_date": 1606846516, "post_id": 32751792, "comment_id": 115084124, "body": "@hunter_tech Just different hash map designs. I&#39;m not an STL expert, but could be, for example, that the underlying array that&#39;s resized only stores <i>pointers</i> to values (or to some larger piece--key/val pair, bucket, etc.). So growing that array means shuffling around the pointers but not the values. That&#39;d be a little like when you store pointers to values in a Go hashmap, but done implicitly. Other C++ hashmaps, like <a href=\"https://abseil.io/docs/cpp/guides/container\" rel=\"nofollow noreferrer\">Abseil&#39;s <code>flat_hash_map</code></a>, do store values in the main array and invalidate iterators when it&#39;s grown."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 63, "user_id": 1853733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95fa0e937eaadf84f06a427a5b2d8655?s=128&d=identicon&r=PG", "display_name": "hunter_tech", "link": "https://stackoverflow.com/users/1853733/hunter-tech"}, "edited": false, "score": 0, "creation_date": 1606848261, "post_id": 32751792, "comment_id": 115084946, "body": "@hunter_tech You might prefer the Go/flat_hash_map approach to avoid having to follow a pointer (and perhaps wait for a cache miss) when reading items, if you don&#39;t care about the items moving. You might prefer the unordered_map approach if you need values to not move. Note that Go&#39;s approach where items move but that can&#39;t create dangling pointers (because the language bans taking the address of an item) wasn&#39;t an option in C++ (where you can take the address of most anything). So the designers might have thought stable item addresses would make unordered_map easier to use safely."}, {"owner": {"reputation": 63, "user_id": 1853733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95fa0e937eaadf84f06a427a5b2d8655?s=128&d=identicon&r=PG", "display_name": "hunter_tech", "link": "https://stackoverflow.com/users/1853733/hunter-tech"}, "edited": false, "score": 0, "creation_date": 1606889867, "post_id": 32751792, "comment_id": 115096572, "body": "@twotwotwo. 3ks.  When we are referring the map, the value returned is returned &quot;returned by value&quot;, that&#39;s the key difference of golang map design compared to stl."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 139, "last_activity_date": 1585337499, "last_edit_date": 1585337499, "creation_date": 1443056557, "answer_id": 32751792, "question_id": 32751537, "link": "https://stackoverflow.com/questions/32751537/why-do-i-get-a-cannot-assign-error-when-setting-value-to-a-struct-as-a-value-i/32751792#32751792", "title": "Why do I get a &quot;cannot assign&quot; error when setting value to a struct as a value in a map?", "body": "<p><code>p[\"HM\"]</code> isn't quite a regular <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"noreferrer\">addressable</a> value: <a href=\"https://en.wikipedia.org/wiki/Hash_table#Dynamic_resizing\" rel=\"noreferrer\">hashmaps can grow at runtime</a>, and then their values get moved around in memory, and the old locations become outdated. If values in maps were treated as regular addressable values, those internals of the <code>map</code> implementation would get exposed. </p>\n\n<p>So, instead, <code>p[\"HM\"]</code> is a slightly different thing called a \"map <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">index expression</a>\" in the spec; if you search the spec for the phrase \"index expression\" you'll see you can do certain things with them, like read them, assign to them, and use them in increment/decrement expressions (for numeric types). But you can't do everything. They could have chosen to implement <em>more</em> special cases than they did, but I'm guessing they didn't just to keep things simple.</p>\n\n<p>Your approach seems good here--you change it to a regular assignment, one of the specifically-allowed operations. Another approach (maybe good for larger structs you want to avoid copying around?) is to <a href=\"https://play.golang.org/p/xlCTZrV0PTs\" rel=\"noreferrer\">make the map value a regular old pointer</a> that you can modify the underlying object through: </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    name string\n    age  int\n}\n\ntype People map[string]*Person\n\nfunc main() {\n    p := make(People)\n    p[\"HM\"] = &amp;Person{\"Hank McNamara\", 39}\n    p[\"HM\"].age += 1\n    fmt.Printf(\"age: %d\\n\", p[\"HM\"].age)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 3, "last_activity_date": 1596339830, "last_edit_date": 1596339830, "creation_date": 1443058507, "answer_id": 32752013, "question_id": 32751537, "link": "https://stackoverflow.com/questions/32751537/why-do-i-get-a-cannot-assign-error-when-setting-value-to-a-struct-as-a-value-i/32752013#32752013", "title": "Why do I get a &quot;cannot assign&quot; error when setting value to a struct as a value in a map?", "body": "<p>The left side of the assignment must b &quot;addressable&quot;.</p>\n<p><a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Assignments</a></p>\n<blockquote>\n<p>Each left-hand side operand must be addressable, a map index expression, or (for = assignments only) the blank identifier.</p>\n</blockquote>\n<p>and <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Address_operators</a></p>\n<blockquote>\n<p>The operand must be addressable, that is, either a variable, pointer indirection, or slice indexing operation; or a field selector of an addressable struct operand; or an array indexing operation of an addressable array.</p>\n</blockquote>\n<p>as @twotwotwo's comment, <code>p[&quot;HM&quot;]</code> is not addressable.\nbut, there is no such definition show what is &quot;addressable struct operand&quot; in the spec. I think they should add some description for it.</p>\n"}], "owner": {"reputation": 3774, "user_id": 125875, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbe0f15c8f3c695d86d9ff3a1a4d5cfd?s=128&d=identicon&r=PG", "display_name": "sbeam", "link": "https://stackoverflow.com/users/125875/sbeam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59454, "favorite_count": 37, "closed_date": 1443059112, "accepted_answer_id": 32751792, "answer_count": 2, "score": 89, "last_activity_date": 1596339830, "creation_date": 1443054592, "last_edit_date": 1443055316, "question_id": 32751537, "link": "https://stackoverflow.com/questions/32751537/why-do-i-get-a-cannot-assign-error-when-setting-value-to-a-struct-as-a-value-i", "closed_reason": "Duplicate", "title": "Why do I get a &quot;cannot assign&quot; error when setting value to a struct as a value in a map?", "body": "<p>New to Go. Encountered this error and have had no luck finding the cause or the rationale for it:</p>\n\n<p>If I create a struct, I can obviously assign and re-assign the values no problem:</p>\n\n<pre><code>type Person struct {\n name string\n age int\n}\n\nfunc main() {\n  x := Person{\"Andy Capp\", 98}\n  x.age = 99\n  fmt.Printf(\"age: %d\\n\", x.age)\n}\n</code></pre>\n\n<p>but if the struct is one value in a map:</p>\n\n<pre><code>type Person struct {\n     name string\n     age int\n }\n\ntype People map[string]Person\n\nfunc main() {\n  p := make(People)\n  p[\"HM\"] = Person{\"Hank McNamara\", 39}\n  p[\"HM\"].age = p[\"HM\"].age + 1\n  fmt.Printf(\"age: %d\\n\", p[\"HM\"].age)\n}\n</code></pre>\n\n<p>I get <code>cannot assign to p[\"HM\"].age</code>. That's it, no other info. <a href=\"http://play.golang.org/p/VRlSItd4eP\" rel=\"noreferrer\">http://play.golang.org/p/VRlSItd4eP</a></p>\n\n<p>I found a way around this - creating an <code>incrementAge</code> func on Person, which can be called and the result assigned to the map key, eg <code>p[\"HM\"] = p[\"HM\"].incrementAge()</code>.</p>\n\n<p>But, my question is, what is the reason for this \"cannot assign\" error, and why shouldn't I be allowed to assign the struct value directly?</p>\n"}]