[{"tags": ["windows", "vim", "go"], "comments": [{"owner": {"reputation": 865, "user_id": 40495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6542b6531e55a40f5bf5311c7a97ca65?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/40495/dave"}, "edited": false, "score": 0, "creation_date": 1484778952, "post_id": 41730544, "comment_id": 70655792, "body": "This isn&#39;t even a question..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7430298"}, "reply_to_user": {"reputation": 865, "user_id": 40495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6542b6531e55a40f5bf5311c7a97ca65?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/40495/dave"}, "edited": false, "score": 1, "creation_date": 1484779183, "post_id": 41730544, "comment_id": 70655891, "body": "Dave - what part of &quot;All I am after is a step by step guide...&quot; do you not understand?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484780207, "post_id": 41730544, "comment_id": 70656260, "body": "Well, technically Dave was right, it was a statement not a question. What have you tried and how didn&#39;t it work? Is <code>vim-go</code> not working, or are you missing some of the go tooling? There&#39;s not much use is people listing things that you&#39;ve already done, but last time I installed it I used <code>vim-plug</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1484803749, "last_edit_date": 1495535399, "creation_date": 1484803749, "answer_id": 41734404, "question_id": 41730544, "link": "https://stackoverflow.com/questions/41730544/getting-vim-to-work-with-go-under-windows/41734404#41734404", "title": "Getting Vim to work with Go under Windows", "body": "<p>The <a href=\"https://stackoverflow.com/questions/39186373/how-can-i-use-tilde-in-the-powershell-prompt\"><code>~</code> in powershell</a> refers to <code>$HOME</code> wnich by default <a href=\"https://superuser.com/a/332873/141\">means <code>%USERPROFILE%</code></a></p>\n\n<p>So <code>~\\vimfiles\\autoload</code> are user settings used by <code>vim80/autoload</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1153, "user_id": 5399585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcJS6.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/5399585/antony"}, "is_accepted": false, "score": 0, "last_activity_date": 1484925373, "creation_date": 1484925373, "answer_id": 41766869, "question_id": 41730544, "link": "https://stackoverflow.com/questions/41730544/getting-vim-to-work-with-go-under-windows/41766869#41766869", "title": "Getting Vim to work with Go under Windows", "body": "<p>The ~ characters is your Userprofile as said by VonC. </p>\n\n<p>You can therefore create the vimfiles folder under your user directories:<br>\n    <code>C:\\Users\\username\\vimfiles</code></p>\n\n<p>These will be loaded after the core files under the vim installation location <code>Program files(x86)\\Vim\\vim80</code> but both folders same a similar purpose.<br>\nUsing the user directory is recommended if multiple users are using the same vim installation while having different plugins and a different vimrc.</p>\n\n<p>Note that this also works with the vimrc file:<br>\n    You can place your <code>_vimrc</code> or <code>.vimrc</code>in <code>C:\\Users\\username\\</code> and it will be loaded by vim. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7430298"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1484925373, "creation_date": 1484778216, "last_edit_date": 1484803855, "question_id": 41730544, "link": "https://stackoverflow.com/questions/41730544/getting-vim-to-work-with-go-under-windows", "title": "Getting Vim to work with Go under Windows", "body": "<p>How do I configure Vim running under Windows to be able to edit Golang code? I have spent 3 hours trawling through incomplete, self referential guides on this subject and I grow weary with the resultant frustration.</p>\n\n<p>Ok more details. I have Vim installed. The folder structure is:\n<code>\nProgram Files (x86) -&gt; Vim \n                           vim80\n                               autoload\n                               colors\n                               ...\n                           vimfiles\n</code>\nAn example of my confusion is the fact that the installation guide to vim-plug, in the sections about Powershell, simply says to issue the line: </p>\n\n<pre><code>md ~\\vimfiles\\autoload\n</code></pre>\n\n<p>What are these folders relative to?<br>\nI have an existing <code>autoload</code> folder but it is under the <code>vim80</code> folder, hence my confusion. The aforementioned folder structure  is the default one created by the Vim installer.</p>\n"}, {"tags": ["c", "linux", "networking", "go", "system-calls"], "answers": [{"comments": [{"owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "edited": false, "score": 0, "creation_date": 1484783433, "post_id": 41731291, "comment_id": 70657269, "body": "Thank you for your answer. But, it doesn&#39;t seem to work. Go is telling me <code>cannot use cStruct (type *sockaddr.C.struct_sockaddr_any) as type *C.struct_sockaddr in argument to _Cfunc_printPointer</code>. I would like to avoid unsafe.Pointer if possible. Do you have another idea to help me? Thank you very much"}, {"owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "reply_to_user": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "edited": false, "score": 0, "creation_date": 1484788702, "post_id": 41731291, "comment_id": 70658682, "body": "Well, then keep the original function signature void printPointer(struct sockaddr_any*), declare struct sockadr_any in four C code as shown and then access .addr."}, {"owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "edited": false, "score": 0, "creation_date": 1484810818, "post_id": 41731291, "comment_id": 70665570, "body": "In fact this is impossible to use the addr field as sockaddr_any has incomplete type (I&#39;m not able to locate the header); but as typecast works, the problem is solved :)"}], "tags": [], "owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "is_accepted": false, "score": 1, "last_activity_date": 1484788802, "last_edit_date": 1484788802, "creation_date": 1484782149, "answer_id": 41731291, "question_id": 41728874, "link": "https://stackoverflow.com/questions/41728874/go-language-use-internal-structures-from-c/41731291#41731291", "title": "Go language use internal structures from C", "body": "<p>You can use struct sockaddr*:</p>\n\n<pre><code>void printPointer(struct sockaddr_any *pp) {\n    struct sockaddr *p = pp-&gt;addr;\n    printf(\":: %p :: \", p); \n}\n</code></pre>\n\n<p>since sockaddr_any is defined as:</p>\n\n<pre><code>struct sockaddr_any {\n   struct sockaddr addr;\n   char pad[sizeof(union sockaddr_all) - sizeof(struct sockaddr)];\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 644, "user_id": 7333037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab3a4873895bfc709cb4c1725bafc87a?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/7333037/laszlo"}, "edited": false, "score": 0, "creation_date": 1484789152, "post_id": 41731636, "comment_id": 70658778, "body": "You&#39;re welcome. That was my first idea too, but wanted to avoid a type cast."}], "tags": [], "owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1484784434, "creation_date": 1484784434, "answer_id": 41731636, "question_id": 41728874, "link": "https://stackoverflow.com/questions/41728874/go-language-use-internal-structures-from-c/41731636#41731636", "title": "Go language use internal structures from C", "body": "<p>Using Laszlo answer, there is a simple solution for my problem. It isn't because the definition of the structure <code>sockaddr_any</code> isn't accessible in my context (there's no simple way to access the <code>addr</code> field) that we can't cast the pointer. So, I can simply do: </p>\n\n<pre><code>// #include &lt;stdio.h&gt;\n// void printPointer(struct sockaddr_any *p){\n//     struct sockaddr *usable_pointer = (struct sockaddr *) p; \n// }\nimport \"C\"\n</code></pre>\n\n<p>Then, I can use <code>usable_pointer</code> as any other <code>sockaddr</code> variable. </p>\n\n<p>Thank you very much</p>\n"}], "owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484788802, "creation_date": 1484771414, "last_edit_date": 1484784512, "question_id": 41728874, "link": "https://stackoverflow.com/questions/41728874/go-language-use-internal-structures-from-c", "title": "Go language use internal structures from C", "body": "<p>I would like to be able, in Go, to translate one host address (let's use 'www.google.be') to a sockaddr structure and then use it from a C code. </p>\n\n<p>Translating the host address to a sockaddr_any structure isn't too hard using the <a href=\"http://github.com/jbenet/go-sockaddr\" rel=\"nofollow noreferrer\">http://github.com/jbenet/go-sockaddr</a> module. My code works and is the following: </p>\n\n<pre><code>ipAddr, _ := net.ResolveIPAddr(\"ip\", \"www.google.be\")\nsockAddr := sockaddrnet.IPAddrToSockaddr(ipAddr)\nrawSockaddr, socklen, _ := sockaddr.SockaddrToAny(sockAddr)\ncStruct := sockaddr.AnyToCAny(rawSockaddr)\nC.printPointer(cStruct)\n</code></pre>\n\n<p>But, I'm not able to use this <code>*sockaddr.C.struct_sockaddr_any</code> variable: <code>cStruct</code>, from my C code (it has incomplete definition, so I can't use any of its fields), which is the following: </p>\n\n<pre><code>// #include &lt;stdio.h&gt;\n// void printPointer(struct sockaddr_any *p){\n//     printf(\":: %p :: \", p); \n//     // How to use P as a sockaddr? \n// }\nimport \"C\"\n</code></pre>\n\n<p><code>sockaddr_any</code> is defined in the core of the Go language (from <a href=\"https://golang.org/src/syscall/types_linux.go\" rel=\"nofollow noreferrer\">https://golang.org/src/syscall/types_linux.go</a>). So, I believe it should be linked by default with my C code. But, it seems not to be true. Does someone know what line could I use to include headers from the go language itself (here the syscall structures). </p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": true, "score": 6, "last_activity_date": 1484766432, "creation_date": 1484766432, "answer_id": 41727491, "question_id": 41727326, "link": "https://stackoverflow.com/questions/41727326/understand-this-code-golang-double-parantheses/41727491#41727491", "title": "Understand this code (golang), double parantheses ()()", "body": "<p><code>WithHTTPClient</code> returns a function, ie:</p>\n\n<pre><code>func WithHTTPClient(c *http.Client) ClientOption {\n    return func(client *Client) error {\n        ....\n        return nil\n    }\n}\n</code></pre>\n\n<p><code>WithHTTPClient(&amp;http.Client{})(c)</code> is just calling that function with <code>c</code> (a pointer to a Client) as parameter. It could be written as:</p>\n\n<pre><code>f := WithHTTPClient(&amp;http.Client{})\nf(c)\n</code></pre>\n"}], "owner": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 41727491, "answer_count": 1, "score": 0, "last_activity_date": 1484766432, "creation_date": 1484765895, "question_id": 41727326, "link": "https://stackoverflow.com/questions/41727326/understand-this-code-golang-double-parantheses", "title": "Understand this code (golang), double parantheses ()()", "body": "<p>I was wondering if someone can explain this syntax to me.  In the google maps go api, they have </p>\n\n<pre><code>type Client struct {\n    httpClient        *http.Client\n    apiKey            string\n    baseURL           string\n    clientID          string\n    signature         []byte\n    requestsPerSecond int\n    rateLimiter       chan int\n}\n\n// NewClient constructs a new Client which can make requests to the Google Maps WebService APIs.\nfunc NewClient(options ...ClientOption) (*Client, error) {\n    c := &amp;Client{requestsPerSecond: defaultRequestsPerSecond}\n    WithHTTPClient(&amp;http.Client{})(c)       //???????????\n    for _, option := range options {\n        err := option(c)\n        if err != nil {\n            return nil, err\n        }\n    }\n    if c.apiKey == \"\" &amp;&amp; (c.clientID == \"\" || len(c.signature) == 0) {\n        return nil, errors.New(\"maps: API Key or Maps for Work credentials missing\")\n    }\n\n    // Implement a bursty rate limiter.\n    // Allow up to 1 second worth of requests to be made at once.\n    c.rateLimiter = make(chan int, c.requestsPerSecond)\n    // Prefill rateLimiter with 1 seconds worth of requests.\n    for i := 0; i &lt; c.requestsPerSecond; i++ {\n        c.rateLimiter &lt;- 1\n    }\n    go func() {\n        // Wait a second for pre-filled quota to drain\n        time.Sleep(time.Second)\n        // Then, refill rateLimiter continuously\n        for _ = range time.Tick(time.Second / time.Duration(c.requestsPerSecond)) {\n            c.rateLimiter &lt;- 1\n        }\n    }()\n\n    return c, nil\n}\n\n// WithHTTPClient configures a Maps API client with a http.Client to make requests over.\nfunc WithHTTPClient(c *http.Client) ClientOption {\n    return func(client *Client) error {\n        if _, ok := c.Transport.(*transport); !ok {\n            t := c.Transport\n            if t != nil {\n                c.Transport = &amp;transport{Base: t}\n            } else {\n                c.Transport = &amp;transport{Base: http.DefaultTransport}\n            }\n        }\n        client.httpClient = c\n        return nil\n    }\n}\n</code></pre>\n\n<p>And this is the line I don't understand in NewClient</p>\n\n<pre><code>WithHTTPClient(&amp;http.Client{})(c)\n</code></pre>\n\n<p>Why are there two ()()?\nI see that WithHTTPClient takes in a *http.Client which that line does, but then it also passes in a pointer to the client struct declared above it?</p>\n"}, {"tags": ["go", "libvirt", "virsh"], "comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1484772833, "post_id": 41727179, "comment_id": 70652904, "body": "Does the virsh command rely on any kind of environment variables? When you run a command like that it&#39;s not ran in your shell environment"}, {"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1484775147, "post_id": 41727179, "comment_id": 70654097, "body": "I don&#39;t think that is the reason. Because if I run &quot;virsh dumpxml&quot; command from my code, it runs correctly and says &quot;error: command <code>dumpxml</code> requires &lt;domain&gt; option&quot;. I get same output if I run it from shell environment."}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1484775521, "post_id": 41727179, "comment_id": 70654299, "body": "It&#39;s just a hunch but that still might be the problem depending on how it knows where to look for those domains. Just to try it maybe do <code>virshCmd := exec.Command(&quot;sh&quot;, &quot;-c&quot;, &quot;virsh dumpxml Ubuntu14&quot;)</code>"}, {"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1484777565, "post_id": 41727179, "comment_id": 70655234, "body": "Tried it. The result is same."}], "answers": [{"comments": [{"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "edited": false, "score": 0, "creation_date": 1484842727, "post_id": 41740519, "comment_id": 70686046, "body": "yes, you are right. Eventually I found it out and modified my function accordingly."}], "tags": [], "owner": {"reputation": 1792, "user_id": 7126113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffadd47897c7708095d65a6813375dfa?s=128&d=identicon&r=PG&f=1", "display_name": "DanielB", "link": "https://stackoverflow.com/users/7126113/danielb"}, "is_accepted": true, "score": 0, "last_activity_date": 1484824755, "creation_date": 1484824755, "answer_id": 41740519, "question_id": 41727179, "link": "https://stackoverflow.com/questions/41727179/golang-exec-incorrect-behavior/41740519#41740519", "title": "golang exec incorrect behavior", "body": "<p>I expect you are running virsh as a different user in these two scenarios, and since you don't provide any URI, it is connecting to a different libvirtd instance. If you run virsh as non-root, then it'll usually connect to qemu:///session, but if you run virsh as root, then it'll usually connect to qemu:///system.  VMs registered against one URI, will not be visible when connecting to the other URI.</p>\n\n<p>BTW, if you're using go, you'd be much better off using the native Go library bindings for libvirt instead of exec'ing virsh. Your \"virsh dumpxml\" invokation is pretty much equivalent to this:</p>\n\n<pre><code>   import (\n      \"github.com/libvirt/libvirt-go\"\n   )\n\n   conn, err := libvirt.NewConnect(\"qemu:///system\")\n\n   dom, err := conn.LookupDomainByName(\"Ubuntu14\")\n\n   xml, err := dom.GetXMLDesc(0)\n</code></pre>\n\n<p>(obviously do error handling too)</p>\n"}], "owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 41740519, "answer_count": 1, "score": 0, "last_activity_date": 1484824755, "creation_date": 1484765295, "question_id": 41727179, "link": "https://stackoverflow.com/questions/41727179/golang-exec-incorrect-behavior", "title": "golang exec incorrect behavior", "body": "<p>I'm using following code segment to get the <code>XML</code> definition of a virtual machine running on <code>XEN Hypervisor</code>. The code is trying to execute the command <code>virsh dumpxml Ubutnu14</code> which will give the <code>XML</code> of the VM named <code>Ubuntu14</code></p>\n\n<pre><code>virshCmd := exec.Command(\"virsh\", \"dumpxml\", \"Ubuntu14\")\n\nvar virshCmdOutput bytes.Buffer\nvar stderr bytes.Buffer\nvirshCmd.Stdout = &amp;virshCmdOutput\nvirshCmd.Stderr = &amp;stderr\nerr := virshCmd.Run()\nif err != nil {\n    fmt.Println(err)\n    fmt.Println(stderr.String())\n}\n\nfmt.Println(virshCmdOutput.String())\n</code></pre>\n\n<p>This code always goes into the error condition for the given domain name  and I get the following output.</p>\n\n<pre><code>exit status 1\nerror: failed to get domain 'Ubuntu14'\nerror: Domain not found: no domain with matching name 'Ubuntu14'\n</code></pre>\n\n<p>But if I run the standalone command <code>virsh dumpxml Ubuntu14</code>, I get the correct <code>XML</code> definition. </p>\n\n<p>I would appreciate if someone could give me some hints on what I'm doing wrong. My host machine is <code>Ubuntu-16.04</code> and <code>golang</code> version is <code>go1.6.2 linux/amd64</code></p>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4801914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ad5de6156b6dda0f35d8d614ace4d43?s=128&d=identicon&r=PG&f=1", "display_name": "Yurii Vasilchuk", "link": "https://stackoverflow.com/users/4801914/yurii-vasilchuk"}, "edited": false, "score": 0, "creation_date": 1484843016, "post_id": 41727284, "comment_id": 70686242, "body": "Thanks for you answer. You wrote that things that I do is a bit wired, maybe you&#39;re right, I&#39;m newbie in golang. So what is go-way to solve problem? I don&#39;t want to write the similar code many times, but in a lot of &#39;controller&#39; functions I need to do same things: decode input from json to my models (structs), encode data from my objects to json and write it to output, but I don&#39;t understand howto do it in go-way, can you help me?"}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 63, "user_id": 4801914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ad5de6156b6dda0f35d8d614ace4d43?s=128&d=identicon&r=PG&f=1", "display_name": "Yurii Vasilchuk", "link": "https://stackoverflow.com/users/4801914/yurii-vasilchuk"}, "edited": false, "score": 0, "creation_date": 1484856484, "post_id": 41727284, "comment_id": 70693948, "body": "@YuriiVasilchuk I don&#39;t understand your exact use case. I think you could change your approach to have a single function that does the encoding and decoding (go&#39;s Marshal/Unmarshal are quite generic: they take interface{}s so you can pass anything). All this function needs to know is the source/destination types and I think you &quot;know&quot; that from the handler."}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 2, "last_activity_date": 1484765736, "creation_date": 1484765736, "answer_id": 41727284, "question_id": 41727025, "link": "https://stackoverflow.com/questions/41727025/how-to-instantiate-value-of-unknown-type-in-go/41727284#41727284", "title": "How to instantiate value of unknown type in Go?", "body": "<p>What you're doing is a bit weird but <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>reflect</code></a> can provide all the info you need.</p>\n\n<pre><code>func myFunction(a string, b int32) error {\n    return nil\n}\n\nfunc myWrapper(mystery interface{}) {\n    typ := reflect.TypeOf(mystery)\n\n    // Check typ.Kind before playing with In(i);\n    for i := 0; i &lt; typ.NumIn(); i++ {\n        fmt.Printf(\"Param %d: %v\\n\", i, typ.In(i))\n    }\n    for i := 0; i &lt; typ.NumOut(); i++ {\n        fmt.Printf(\"Result %d: %v\\n\", i, typ.Out(i))\n    }\n\n}\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>Param 0: string\nParam 1: int32\nResult 0: error\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 0, "last_activity_date": 1484769675, "creation_date": 1484769675, "answer_id": 41728416, "question_id": 41727025, "link": "https://stackoverflow.com/questions/41727025/how-to-instantiate-value-of-unknown-type-in-go/41728416#41728416", "title": "How to instantiate value of unknown type in Go?", "body": "<p>Something like this should work (untested):</p>\n\n<pre><code>func wrapper(ctlr interface{}, w http.ResponseWriter, r *http.Request) error {\n\n    tpe := reflect.TypeOf(ctlr)\n    if tpe.Kind() != reflect.Func || tpe.NumIn() != 1 || tpe.NumOut() != 1 {\n        // TODO: handle wrong ctlr type\n    }\n\n    // 1. Determine type of argument of 'controller' function\n    argt := tpe.In(0)\n\n    // 2. Determine type of result of 'controller' function\n    // rest := tpe.Out(0) // commented out since it's useless\n\n    // 3. Instantiate and fill argument value from Body of *http.Request (decode from json)\n    arg := reflect.Zero(argt)\n    err := json.NewDecoder(r.Body).Decode(&amp;arg)\n    if err != nil {\n        // TODO: handle err\n    }\n\n    // 4. Call controller Function with instantiated on previous step argument\n    resv := reflect.ValueOf(ctlr).Call([]reflect.Value{arg})[0]\n\n    // 5. Write results of previous step into http.ResponseWriter (encoded as json)\n    err = json.NewEncoder(w).Encode(resv.Interface())\n    if err != nil {\n        // TODO: handle err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>Note that the second step is unnecessary.</p>\n"}], "owner": {"reputation": 63, "user_id": 4801914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ad5de6156b6dda0f35d8d614ace4d43?s=128&d=identicon&r=PG&f=1", "display_name": "Yurii Vasilchuk", "link": "https://stackoverflow.com/users/4801914/yurii-vasilchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4256, "favorite_count": 0, "accepted_answer_id": 41727284, "answer_count": 2, "score": 0, "last_activity_date": 1484769675, "creation_date": 1484764763, "question_id": 41727025, "link": "https://stackoverflow.com/questions/41727025/how-to-instantiate-value-of-unknown-type-in-go", "title": "How to instantiate value of unknown type in Go?", "body": "<p>I develop some server in golang. I try to create some wrapper-function, which can helps me in future.</p>\n\n<p>What I have:</p>\n\n<p>1) I had some DTO structs, for example:</p>\n\n<pre><code>type Request struct {\n    Field1   string `json:\"field1\"`\n    Field2   string `json:\"field2\"`\n}\n\ntype Response struct {\n    Field1   string `json:\"field1\"`\n    Field2   string `json:\"field2\"`\n    Field3   string `json:\"field3\"`\n}\n</code></pre>\n\n<p>2) I had some functions, in controller layer, which (by conventions) receives 1 argument (pointer to struct) and returns 1 result (pointer to struct), for example:</p>\n\n<pre><code>func SomeHandler(request *Request) *Response{\n    ...do something\n    return &amp;Response{\"first\",\"second\",\"third\"}\n}\n</code></pre>\n\n<p>What I need:</p>\n\n<p>I need to write wrapper function which receives as argument:</p>\n\n<ol> \n  <li>pointer to 'controller' function</li>\n  <li>http.ResponseWriter</li>\n  <li>*http.Request</li>\n</ol>\n\n<p>This wrapper function must:</p>\n\n<ol>\n  <li>Determine type of argument of 'controller' function</li>\n  <li>Determine type of result of 'controller' function</li>\n  <li>Instantiate and fill argument value from Body of *http.Request (decode from json) </li>\n  <li>Call controller Function with instantiated on previous step argument</li>\n  <li>Write results of previous step into http.ResponseWriter (encoded as json)</li>\n</ol>\n\n<p>Wrapper must work correct with any types of 'controller' functions - signatures of this functions is different (different argument type, different result type)</p>\n\n<p>Can anybody help me with implementing of this wrapper?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484761213, "post_id": 41725729, "comment_id": 70646511, "body": "Rather than use backreferences, which aren&#39;t supported in go, and can be much less efficient, just use a for loop and a counter."}], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 0, "last_activity_date": 1484760840, "creation_date": 1484760840, "answer_id": 41725882, "question_id": 41725729, "link": "https://stackoverflow.com/questions/41725729/how-to-count-the-number-of-consecutively-repeated-characters-in-a-string/41725882#41725882", "title": "How to count the number of consecutively repeated characters in a string", "body": "<p>A simple loop should do the trick. Just remember that Go uses UTF8 for strings. You need to compare Runes (character) not bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 3547, "user_id": 546750, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5e663c9fc0ebe46af81b8a49d5e2aa91?s=128&d=identicon&r=PG", "display_name": "ahmy", "link": "https://stackoverflow.com/users/546750/ahmy"}, "is_accepted": true, "score": 2, "last_activity_date": 1484838720, "last_edit_date": 1484838720, "creation_date": 1484774724, "answer_id": 41729723, "question_id": 41725729, "link": "https://stackoverflow.com/questions/41725729/how-to-count-the-number-of-consecutively-repeated-characters-in-a-string/41729723#41729723", "title": "How to count the number of consecutively repeated characters in a string", "body": "<p><a href=\"https://play.golang.org/p/HeK3f4uEvz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/HeK3f4uEvz</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    // invalid password with repetition\n    password := \"blablaaaabla\"\n    fmt.Printf(\"%s invalid ? %+v\\n\", password, invalid(password))\n\n    // correct password with no repetition\n    password = \"blabla\"\n    fmt.Printf(\"%s invalid ? %+v\\n\", password, invalid(password))\n\n    // valid password with unicode character\n    password = \"bla\u221e\u221ebla\"\n    fmt.Printf(\"%s invalid ? %+v\\n\", password, invalid(password))\n\n    // invalid password with unicode character\n    password = \"bla\u221e\u221e\u221ebla\"\n    fmt.Printf(\"%s invalid ? %+v\\n\", password, invalid(password))\n}\n\nfunc invalid(s string) bool {\n    var lastChar rune\n    var lastCharCount = 0\n    for _, c := range s {\n        if c == lastChar {\n            lastCharCount++\n            if lastCharCount &gt;= 3 {\n                return true\n            }\n        } else {\n            lastChar = c\n            lastCharCount = 1\n        }\n    }\n\n    return false\n}\n</code></pre>\n\n<p>results</p>\n\n<pre><code>blablaaaabla invalid ? true\nblabla invalid ? false\nbla\u221e\u221ebla invalid ? false\nbla\u221e\u221e\u221ebla invalid ? true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": false, "score": 1, "last_activity_date": 1484775438, "last_edit_date": 1484775438, "creation_date": 1484774991, "answer_id": 41729798, "question_id": 41725729, "link": "https://stackoverflow.com/questions/41725729/how-to-count-the-number-of-consecutively-repeated-characters-in-a-string/41729798#41729798", "title": "How to count the number of consecutively repeated characters in a string", "body": "<p>This works:</p>\n\n<pre><code>func AbideMaxRepetitions(max int, s string) bool {\n    var rr rune\n    rc := 0\n    for _, r := range s {\n        if rr == r {\n            rc++\n            if rc &gt; max {\n                return false\n            }\n        } else {\n            rr = r\n            rc = 1\n        }\n\n    }\n    return true\n}\n</code></pre>\n\n<p>When running:</p>\n\n<pre><code>func main() {\n    ss := []string{\"pass\", \"paaass\", \"paaaaaaaaaass\", \"ppa\", \"pppa\", \"x\", \"xx\", \"xxx\"}\n    for _, s := range ss {\n        fmt.Printf(\"%q: %v\\n\", s, AbideMaxRepetitions(2, s))\n    }\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>\"pass\": true\n\"paaass\": false\n\"paaaaaaaaaass\": false\n\"ppa\": true\n\"pppa\": false\n\"x\": true\n\"xx\": true\n\"xxx\": false\n</code></pre>\n"}], "owner": {"reputation": 2713, "user_id": 876882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FmRII.jpg?s=128&g=1", "display_name": "Frax", "link": "https://stackoverflow.com/users/876882/frax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 41729723, "answer_count": 3, "score": 0, "last_activity_date": 1484838720, "creation_date": 1484760278, "question_id": 41725729, "link": "https://stackoverflow.com/questions/41725729/how-to-count-the-number-of-consecutively-repeated-characters-in-a-string", "title": "How to count the number of consecutively repeated characters in a string", "body": "<p>Basically, what I want to achieve is to not allow passwords with lots of consecutively repeated chars/digits.\nI'm trying to write a <strong>go</strong> function to which I pass a string and a maximum allowed number of consecutively repeated characters, and it should tell me if it's surpassed or not.</p>\n\n<p>I used to do it easily in <strong>javascript</strong> using the a regular expression in the following way:</p>\n\n<pre><code>var regexString = '(.)\\\\1{' + (maxAllowedRepetitions) + ',}';\nvar regex = new RegExp(regexString);\nreturn regex.test(string)\n</code></pre>\n\n<p>... where maxAllowedRepetitions is the max limit. If the limit is 3 and a string is 'blablabla', it returns <code>false</code>. If it is blablaaaabla, it returns <code>true</code> since the character 'a' is repeated more than 3 times.</p>\n\n<p>I'm finding it difficult to achieve the same thing using <strong>go</strong> regexp.<br>\nI don't mind not using regexp. I just need a good way to achieve this.<br>\nAny suggestions?</p>\n"}, {"tags": ["amazon-web-services", "elasticsearch", "go", "amazon-elasticsearch"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 2802535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68480f90f287048f4f6a829ae3ec9810?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/2802535/frank"}, "is_accepted": false, "score": 0, "last_activity_date": 1486358205, "creation_date": 1486358205, "answer_id": 42060748, "question_id": 41725728, "link": "https://stackoverflow.com/questions/41725728/have-issues-access-to-es-with-aws-request-signing/42060748#42060748", "title": "Have issues access to ES with AWS request signing", "body": "<p>There appears to be an issue in the signing library.\nThe following pull request fixed it. (not yet merged)\n<a href=\"https://github.com/sha1sum/aws_signing_client/pull/3\" rel=\"nofollow noreferrer\">https://github.com/sha1sum/aws_signing_client/pull/3</a></p>\n"}], "owner": {"reputation": 56, "user_id": 355476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6789b9138f4439f8dd29f27285bd9ea?s=128&d=identicon&r=PG", "display_name": "eolexe", "link": "https://stackoverflow.com/users/355476/eolexe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1299, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486462740, "creation_date": 1484760276, "last_edit_date": 1486462740, "question_id": 41725728, "link": "https://stackoverflow.com/questions/41725728/have-issues-access-to-es-with-aws-request-signing", "title": "Have issues access to ES with AWS request signing", "body": "<p>I am building a golang RESTful API and trying to access ES using signed requests.\nI have followed documentation on AWS the documentation of the Golang AWS elastic search client package I am using (olivere/elastic)</p>\n\n<p>Following golang code is used to create a new client</p>\n\n<pre><code>signer := v4.NewSigner(credentials.NewStaticCredentials(\"IAM_USER_ID\", \"IAM_USER_SECRET\", \"\"))\nawsClient, err := aws_signing_client.New(signer, nil, \"es\", \"us-east-1\")\nif err != nil {\n    return nil, err\n}\nreturn elastic.NewClient(\n    elastic.SetURL(\"https://my-aws-endpoint.us-east-1.es.amazonaws.com\"),\n    elastic.SetScheme(\"https\"),\n    elastic.SetHttpClient(awsClient),\n    elastic.SetSniff(false), // See note below\n)\n</code></pre>\n\n<p>In ElasticSearch AWS console, I have modified an access policy like that:\n<a href=\"https://i.stack.imgur.com/C2SVb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C2SVb.png\" alt=\"selected access policy template\"></a>\n<a href=\"https://i.stack.imgur.com/1uCPL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1uCPL.png\" alt=\"access policy\"></a></p>\n\n<p>Seems I am able to discover the ES node, but when I try to execute a query, ES return http status 403 \u2013 don't have permission.</p>\n\n<p>I also have tried to grant IAM user with the AmazonESFullAccess policy but seems it doesn't have any effect.</p>\n"}, {"tags": ["algorithm", "go", "time-complexity", "binary-tree"], "comments": [{"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 2, "creation_date": 1484758586, "post_id": 41725118, "comment_id": 70644930, "body": "Where is the <code>insert</code> function?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484758629, "post_id": 41725118, "comment_id": 70644969, "body": "Can you show the Benchmark function you&#39;re using?"}, {"owner": {"reputation": 3274, "user_id": 569076, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ce87534730dc5358b4c3dbedc1c05350?s=128&d=identicon&r=PG", "display_name": "Elbek", "link": "https://stackoverflow.com/users/569076/elbek"}, "edited": false, "score": 0, "creation_date": 1484776655, "post_id": 41725118, "comment_id": 70654859, "body": "you should wram up running 5-10 times before timing it, sometimes languages such as java (JIT) does optimization during runtime, not sure about go, but microbenchmarking is tricky."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1484801734, "post_id": 41725118, "comment_id": 70662132, "body": "Binary Tree is not a Binary Search Tree"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1484839799, "post_id": 41725118, "comment_id": 70683974, "body": "From your description, I&#39;d suspect that the tree actually contains only 100,000 integers, so it takes the same amount of time to insert. But you&#39;re doing 10 times as many queries."}], "answers": [{"comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1484759844, "post_id": 41725497, "comment_id": 70645739, "body": "In such case, <code>Insert</code> should also become <code>O(n)</code>, shouldn&#39;t it?"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1484763419, "post_id": 41725497, "comment_id": 70647747, "body": "@user58697: worst-case, yes, but any given call may take less time in an unpredictable way."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 1, "last_activity_date": 1484763799, "last_edit_date": 1484763799, "creation_date": 1484759615, "answer_id": 41725497, "question_id": 41725118, "link": "https://stackoverflow.com/questions/41725118/why-does-this-binary-tree-search-take-so-much-longer-than-an-insertion/41725497#41725497", "title": "Why does this binary tree search take so much longer than an insertion?", "body": "<p>The <code>Insert</code> function should periodically rebalance the tree, as an imbalanced tree may lead to very uneven traversal times.  As a result, <code>Insert</code> <em>should</em> generally be slower that <code>Contains</code>.</p>\n\n<p>If your <code>Insert</code> function does not rebalance the tree, then the time required for any given function become O(n) worst case instead of O(log n) and fairly unpredictable.</p>\n\n<p>In addition, when talking about O(...) time complexity, we're generally talking about <em>worst case</em> behavior.  If you time single calls, then any given call may take (much) less time than the worst case -- for example, <code>Contains</code> looking for the node that happens to be the root will return immediately regardless of the size.</p>\n"}], "owner": {"reputation": 399, "user_id": 4644468, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9a52b2a168cce82a0f3997c132a7e107?s=128&d=identicon&r=PG&f=1", "display_name": "hiy", "link": "https://stackoverflow.com/users/4644468/hiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 1, "accepted_answer_id": 41725497, "answer_count": 1, "score": -1, "last_activity_date": 1484763799, "creation_date": 1484758453, "last_edit_date": 1484758768, "question_id": 41725118, "link": "https://stackoverflow.com/questions/41725118/why-does-this-binary-tree-search-take-so-much-longer-than-an-insertion", "title": "Why does this binary tree search take so much longer than an insertion?", "body": "<p>I'm trying to learn/understand some basic algorithms, and today I decided to write a binary tree in Go. This is what the structure looks like:</p>\n\n<pre><code>type Node struct {\n  Value int\n  Left  *Node\n  Right *Node\n}\n</code></pre>\n\n<p>Here's my function to check if the tree contains an int:</p>\n\n<pre><code>func (tree *Node) Contains(val int) bool {\n  if val == tree.Value {\n    return true\n  } else if val &gt; tree.Value {\n    if tree.Right != nil {\n      return tree.Right.Contains(val)\n    } else {\n      return false\n    }\n  } else if val &lt; tree.Value {\n    if tree.Left != nil {\n      return tree.Left.Contains(val)\n    } else {\n      return false\n    }\n  } else { // huh\n    return false\n  }\n}\n</code></pre>\n\n<p>I wrote a test function to test how long different operations on the tree take. It takes my <code>Insert()</code> function <strong>34ms</strong> to insert 100,000 random integers, and it takes my <code>Contains()</code> function <strong>33ms</strong> to check if the tree contains 100,000  random integers. If I bump the number of random integers up to 1,000,000, it takes my <code>Insert()</code> function <strong>34ms</strong> to run, but my <code>Contains()</code> function suddenly takes <strong>321ms</strong> to run.</p>\n\n<p>Why does <code>Contains()</code> run time increase so drastically, while <code>Insert()</code> stays practically the same?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1484757128, "post_id": 41724608, "comment_id": 70643873, "body": "What are you trying to accomplish here?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484757151, "post_id": 41724608, "comment_id": 70643886, "body": "Please show an example of what you&#39;re asking. You can iterate directly over Node.m and Node.o."}], "answers": [{"comments": [{"owner": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "edited": false, "score": 0, "creation_date": 1484760488, "post_id": 41725014, "comment_id": 70646104, "body": "Thanks for the suggestion. Why are you dereferencing, &amp;Foo ? According to golang cheatsheet it doesn&#39;t show that when declaring variable. Is there a performance gain when you do that?"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "edited": false, "score": 1, "creation_date": 1484761758, "post_id": 41725014, "comment_id": 70646802, "body": "@NinjaGaiden &amp;Foo doesn&#39;t dereference, rather it passes the reference of Foo, so foo is actually a pointer, *Foo"}, {"owner": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "edited": false, "score": 0, "creation_date": 1484761965, "post_id": 41725014, "comment_id": 70646901, "body": "I see, so its more memory efficient. I will use it next time."}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 1, "last_activity_date": 1484764579, "last_edit_date": 1495540915, "creation_date": 1484758184, "answer_id": 41725014, "question_id": 41724608, "link": "https://stackoverflow.com/questions/41724608/iterate-through-struct-in-golang-without-reflect/41725014#41725014", "title": "Iterate through struct in golang without reflect", "body": "<p>Is there a reason you don't want to use the <code>reflect</code> package? like <a href=\"https://stackoverflow.com/questions/18926303/iterate-through-a-struct-in-go\">Iterate through a struct in Go</a> and <a href=\"https://stackoverflow.com/questions/21246642/iterate-over-string-fields-in-struct\">Iterate Over String Fields in Struct</a> ?</p>\n\n<p>From the former question, it seems like, yeah you can iterate without <code>reflect</code> by iterating through an <code>interface</code> of the fields, <a href=\"https://play.golang.org/p/bPWUII_D7q\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bPWUII_D7q</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Foo struct {\n    num int\n    str string\n}\n\nfunc main() {\n    foo := &amp;Foo{42, \"Hello\"} // struct with fields of many types...\n    for _, data := range []interface{}{foo.num, foo.str} {\n        fmt.Println(data)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "is_accepted": false, "score": 0, "last_activity_date": 1484762015, "last_edit_date": 1484762015, "creation_date": 1484760417, "answer_id": 41725771, "question_id": 41724608, "link": "https://stackoverflow.com/questions/41724608/iterate-through-struct-in-golang-without-reflect/41725771#41725771", "title": "Iterate through struct in golang without reflect", "body": "<p>Here is what I did,</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n)\n\ntype Node struct {\n        m []string\n        o []string\n}\n\nfunc main() {\n\n        var mm = []string{\"abc\", \"def\"}\n        var oo = []string{\"111\", \"222\"}\n\n        var v = Node{m: mm, o: oo}\n\n        for i := range v.m {\n                fmt.Println(v.m[i],v.o[i])\n        }\n}\n</code></pre>\n\n<p>This gives me my desired output. Just one thing is I have to write <code>v.m</code> so I suppose I should still use reflect package. </p>\n"}, {"tags": [], "owner": {"reputation": 376, "user_id": 899843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2156758e4d22a4dc2a4df09d51931e8e?s=128&d=identicon&r=PG", "display_name": "Josh Lubawy", "link": "https://stackoverflow.com/users/899843/josh-lubawy"}, "is_accepted": true, "score": 1, "last_activity_date": 1484815434, "creation_date": 1484815434, "answer_id": 41737325, "question_id": 41724608, "link": "https://stackoverflow.com/questions/41724608/iterate-through-struct-in-golang-without-reflect/41737325#41737325", "title": "Iterate through struct in golang without reflect", "body": "<p><strong>Edit:</strong> I just realized my output doesn't match yours, do you want the letters paired with the numbers? If so then you'll need to re-work what you have.</p>\n\n<p>You can use <code>strings.Join</code> and a type switch statement to accomplish this:</p>\n\n<p><a href=\"https://play.golang.org/p/ygtdxv02uK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ygtdxv02uK</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\ntype Node struct {\n    m []string\n    o []string\n    p []int\n}\n\nfunc main() {\n\n    var mm = []string{\"abc\", \"def\"}\n    var oo = []string{\"111\", \"222\"}\n    var pp = []int{1, 2, 3}\n\n    var v = Node{m: mm, o: oo, p: pp}\n\n    for _, d := range []interface{}{v.m, v.o, v.p} {\n        switch d.(type) {\n        case []string:\n            fmt.Println(strings.Join(d.([]string), \",\"))\n        default:\n            fmt.Println(d)\n        }\n    }\n\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>abc,def\n111,222\n[1 2 3]\n</code></pre>\n"}], "owner": {"reputation": 2502, "user_id": 3589054, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2af7ed5cc40b1b8479cd082ca3e0c4af?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaGaiden", "link": "https://stackoverflow.com/users/3589054/ninjagaiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7361, "favorite_count": 0, "accepted_answer_id": 41737325, "answer_count": 3, "score": 0, "last_activity_date": 1484815434, "creation_date": 1484757052, "last_edit_date": 1484758417, "question_id": 41724608, "link": "https://stackoverflow.com/questions/41724608/iterate-through-struct-in-golang-without-reflect", "title": "Iterate through struct in golang without reflect", "body": "<p>I have a struct like this</p>\n\n<pre><code>import (\n        \"fmt\"\n)\n\ntype Node struct {\n        m []string\n        o []string\n}\n\nfunc main() {\n\n        var mm = []string{\"abc\", \"def\"}\n        var oo = []string{\"111\", \"222\"}\n\n        var v = Node{m: mm, o: oo}\n\n        for _, d := range []interface{}{v.m, v.o} {\n                fmt.Println(d)\n        }\n\n}\n</code></pre>\n\n<p>The output I get is,</p>\n\n<pre><code>[abc def]\n[111 222]\n</code></pre>\n\n<p>My desired output is,</p>\n\n<pre><code>abc,111\ndef,222\n</code></pre>\n\n<p>I don't want to use reflect package because, I want to use native go built-ins as much as possible. If it becomes too burdensome I will fall back on reflect package.</p>\n"}, {"tags": ["html", "templates", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1484755772, "post_id": 41723876, "comment_id": 70642905, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13904441/whats-the-best-way-to-bundle-static-resources-in-a-go-program/28071360#28071360\">What&#39;s the best way to bundle static resources in a Go program?</a>"}, {"owner": {"reputation": 1272, "user_id": 536291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/891a65a3a9d1c0426a1a8a1c27cd20d2?s=128&d=identicon&r=PG", "display_name": "Matej Ba\u0107o", "link": "https://stackoverflow.com/users/536291/matej-ba%c4%87o"}, "edited": false, "score": 3, "creation_date": 1484756022, "post_id": 41723876, "comment_id": 70643074, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17796043/embedding-text-file-into-compiled-executable\" title=\"embedding text file into compiled executable\">stackoverflow.com/questions/17796043/&hellip;</a>"}, {"owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 1, "creation_date": 1484759672, "post_id": 41723876, "comment_id": 70645626, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13904441/whats-the-best-way-to-bundle-static-resources-in-a-go-program\">What&#39;s the best way to bundle static resources in a Go program?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1272, "user_id": 536291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/891a65a3a9d1c0426a1a8a1c27cd20d2?s=128&d=identicon&r=PG", "display_name": "Matej Ba\u0107o", "link": "https://stackoverflow.com/users/536291/matej-ba%c4%87o"}, "is_accepted": false, "score": 1, "last_activity_date": 1484755965, "creation_date": 1484755965, "answer_id": 41724185, "question_id": 41723876, "link": "https://stackoverflow.com/questions/41723876/how-to-embed-go-html-templates-into-code/41724185#41724185", "title": "How to embed Go HTML templates into code?", "body": "<p>The most simple solution is to embed templates in string literal inside Go source code.</p>\n\n<p>There is a tool that can help, see <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\" title=\"go-bindata\">go-bindata</a>.</p>\n\n<p>I used <code>go generate</code> in some of previous projects for this type of operation, see <a href=\"https://blog.golang.org/generate%20go-generate\" rel=\"nofollow noreferrer\">blog post on go generate command</a> for introduction.</p>\n"}, {"tags": [], "owner": {"reputation": 376, "user_id": 899843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2156758e4d22a4dc2a4df09d51931e8e?s=128&d=identicon&r=PG", "display_name": "Josh Lubawy", "link": "https://stackoverflow.com/users/899843/josh-lubawy"}, "is_accepted": false, "score": 0, "last_activity_date": 1484815976, "creation_date": 1484815976, "answer_id": 41737486, "question_id": 41723876, "link": "https://stackoverflow.com/questions/41723876/how-to-embed-go-html-templates-into-code/41737486#41737486", "title": "How to embed Go HTML templates into code?", "body": "<p>In addition to <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">go-bindata</a> which was already mentioned, there is <a href=\"https://github.com/elazarl/go-bindata-assetfs\" rel=\"nofollow noreferrer\">go-bindata-assetfs</a> which you can use to serve static files from a webserver. It's good for Javascript, CSS, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 2023, "user_id": 247904, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O6InT.png?s=128&g=1", "display_name": "zserge", "link": "https://stackoverflow.com/users/247904/zserge"}, "is_accepted": false, "score": 2, "last_activity_date": 1610473871, "creation_date": 1610473871, "answer_id": 65689292, "question_id": 41723876, "link": "https://stackoverflow.com/questions/41723876/how-to-embed-go-html-templates-into-code/65689292#65689292", "title": "How to embed Go HTML templates into code?", "body": "<p>With Go 1.16 there would be official <code>&quot;embed&quot;</code> package and the following would be possible (<em>is</em> possible if you read this after February 2021):</p>\n<pre><code>//go:embed &quot;mytemplate.tmpl&quot;\nvar myTemplate string\n</code></pre>\n<p>This code embeds <code>mytemplate.html</code> at compile time and it becomes available as a string (or as <code>[]byte</code> or as a FileSystem, if you wish). No 3rd-party tools or libraries needed.</p>\n"}, {"tags": [], "owner": {"reputation": 2324, "user_id": 86375, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/830d4a5362713c3080d20f4222922f10?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/86375/cameron"}, "is_accepted": false, "score": 0, "last_activity_date": 1610572100, "creation_date": 1610572100, "answer_id": 65709808, "question_id": 41723876, "link": "https://stackoverflow.com/questions/41723876/how-to-embed-go-html-templates-into-code/65709808#65709808", "title": "How to embed Go HTML templates into code?", "body": "<p>In Go 1.16 which is slated for February, there is the //go:embed comment directive.<br />\nThis allows you to directly embed files in your binary.<br />\nAnd a beta download of 1.16 is available at this point in time.</p>\n<p>Link for draft design of <a href=\"https://go.googlesource.com/proposal/+/master/design/draft-embed.md\" rel=\"nofollow noreferrer\">the go:embed comment directive</a></p>\n<p>Link for the <a href=\"https://github.com/golang/go/issues/41191\" rel=\"nofollow noreferrer\">Github issue for go embed with some updates</a></p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1395, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1610572100, "creation_date": 1484755159, "question_id": 41723876, "link": "https://stackoverflow.com/questions/41723876/how-to-embed-go-html-templates-into-code", "title": "How to embed Go HTML templates into code?", "body": "<p>I have a set of templates as files, like <code>base.html</code>, <code>login.html</code>, <code>profile.html</code>, <code>header.html</code> and so on. They are structured in folders.</p>\n\n<p>It's fine to have them as separate files during development but when I deploy the app, I'd like to have them all embedded as strings or parsed and compiled templates ready to use from the code as usual.</p>\n\n<p>How should I better make these templates as Go code? So that I don't have to have a <code>templates</code> folder in production, but everything in the single executable file?</p>\n"}, {"tags": ["go", "docker", "makefile"], "comments": [{"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1484908118, "post_id": 41722442, "comment_id": 70714129, "body": "Why the downvote?"}], "answers": [{"comments": [{"owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "edited": false, "score": 0, "creation_date": 1484830951, "post_id": 41736650, "comment_id": 70677643, "body": "I believe the OP does not intend to have a go environment on the produced image, only the compiled binary."}], "tags": [], "owner": {"reputation": 547, "user_id": 4036946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wMtQe.gif?s=128&g=1", "display_name": "jsxqf", "link": "https://stackoverflow.com/users/4036946/jsxqf"}, "is_accepted": false, "score": 0, "last_activity_date": 1484812915, "creation_date": 1484812915, "answer_id": 41736650, "question_id": 41722442, "link": "https://stackoverflow.com/questions/41722442/build-deploy-push-docker-images-for-golang-static-binaries/41736650#41736650", "title": "Build, deploy, push docker images for golang static binaries", "body": "<p>Provide a <code>base</code> image (with GOPATH, godep ... pre configured).</p>\n\n<p>Create Dockerfile based on the <code>base</code> image, then user only need to alter the COPY path.</p>\n"}, {"comments": [{"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 0, "creation_date": 1484908735, "post_id": 41750331, "comment_id": 70714547, "body": "Earlier I used to commit my static go binaries to the repository every time the code gets updated. It was a simple matter of running a script to build and push then. Now, I want to get rid of binaries from git repos and would like a better way to do it.  Yes. There definitely seems to be some tooling required. The forums that I read suggest a similar way, using a makefile. Maybe a go script which builds binaries and calls the docker APIs to build the image. Seems like too much of a hassle for a small thing though. I started with the makefile approach and will get to it if time permits."}], "tags": [], "owner": {"reputation": 2316, "user_id": 301051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0e6e06df1c2f81554cdc6f6e5444367?s=128&d=identicon&r=PG", "display_name": "Pablo Lalloni", "link": "https://stackoverflow.com/users/301051/pablo-lalloni"}, "is_accepted": true, "score": 1, "last_activity_date": 1484855071, "creation_date": 1484855071, "answer_id": 41750331, "question_id": 41722442, "link": "https://stackoverflow.com/questions/41722442/build-deploy-push-docker-images-for-golang-static-binaries/41750331#41750331", "title": "Build, deploy, push docker images for golang static binaries", "body": "<p>So far, when I've been on your situation, I've always come up with a Makefile for doing all the work, which, like you said, has never been simple. Although it's never been simple, I've done it using at least 2 different approaches dependending on the level of dependency you want between the build process and the development environment.</p>\n\n<p>The simplest way is, as you say, just throw in a Makefile the steps you would do by yourself. You can use Dockerfiles ARGuments to parameterize the binary name so you don't have to modify the Dockerfile during the build.</p>\n\n<p>Here you have a quick and dirty (working) Makefile I've just made up for getting you started:</p>\n\n<pre><code>APP_IMAGE=group/example\nAPP_TAG=1.0\nAPP_BINARY=example\n\n.PHONY: clean image binary\n\nall: image\n\nclean:\n    if [ -r $(APP_BINARY) ]; then rm $(APP_BINARY); fi\n    if [ -n \"$$(docker images -q $(APP_IMAGE):$(APP_TAG))\" ]; then docker rmi $(APP_IMAGE):$(APP_TAG); fi\n\nimage: binary\n    docker build --build-arg APP_BINARY=$(APP_BINARY) -t $(APP_IMAGE):$(APP_TAG) $(dir $(abspath $(lastword $(MAKEFILE_LIST))))\n\nbinary: $(APP_BINARY)\n\n$(APP_BINARY): main.go\n    go build -o $@ $^\n</code></pre>\n\n<p>That Makefile expects to be in the same directory as the Dockerfile.</p>\n\n<p>Here is a minimal one (which works):</p>\n\n<pre><code>FROM alpine:3.5\nARG APP_BINARY\nADD ${APP_BINARY} /app\nENTRYPOINT /app\n</code></pre>\n\n<p>I've tested that having a main.go in the same top-level project directory as both Makefile and Dockerfile, in case you have a main.go nested inside some inside directory (\"ROOT/cmd/bla\" is commonplace) then you should change the \"go build\" line to account for that.</p>\n\n<p>Although I've been doing things like that for a while, now that I see (and think about) your question I've come to see that a dedicated tool which knows specifically how to do this could be great to have. Specifically a tool that mimics \"go build/get/install\" but can build docker images... so where you can run the following command to get a binary:</p>\n\n<pre><code>go install github.com/my/program\n</code></pre>\n\n<p>You could also run the following command to get a simple docker image:</p>\n\n<pre><code>goi install github.com/my/program\n</code></pre>\n\n<p>How does that sound? Is there something like that in existence? Should I get started?</p>\n"}], "owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "accepted_answer_id": 41750331, "answer_count": 2, "score": -1, "last_activity_date": 1484855071, "creation_date": 1484750977, "question_id": 41722442, "link": "https://stackoverflow.com/questions/41722442/build-deploy-push-docker-images-for-golang-static-binaries", "title": "Build, deploy, push docker images for golang static binaries", "body": "<p>I am looking for a solution to a simple configuration problem to solve; it has been nagging me for quite some time now. :)</p>\n\n<p>I have a golang project on github which gives me a static binary, and uses godeps.</p>\n\n<p>Now I want to ensure that the <code>godep go install ...</code> command can be run after a git clone and a docker container be built from this newly built binary locally.</p>\n\n<p>As an option, the user should be able to push it to docker hub or a private repo as applicable.</p>\n\n<p>I am thinking of using Makefiles, but that seems too complicated (set the gopath, then godep build, modify the Dockerfile dynamically to point to the place where the binary is located, then a docker build).</p>\n\n<p>Is there an easier way to do it?</p>\n"}, {"tags": ["go", "runtime"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1484744519, "post_id": 41720090, "comment_id": 70634784, "body": "Could you elaborate what a &quot;c runtime&quot; is? Go does not depend on inexistent stuff..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484744761, "post_id": 41720090, "comment_id": 70634942, "body": "Go does not require any C libraries if that&#39;s what you&#39;re asking."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1484744828, "post_id": 41720090, "comment_id": 70634989, "body": "<a href=\"http://stackoverflow.com/q/36783409/2285935\">Ref</a>"}, {"owner": {"reputation": 6743, "user_id": 1432751, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e80f2b22b8c98730708ad3842c11604b?s=128&d=identicon&r=PG", "display_name": "Dmitry Bubnenkov", "link": "https://stackoverflow.com/users/1432751/dmitry-bubnenkov"}, "edited": false, "score": 0, "creation_date": 1484745150, "post_id": 41720090, "comment_id": 70635235, "body": "JimB, so Go-devs reimplemented all low-level stuff?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1484747835, "post_id": 41720090, "comment_id": 70637121, "body": "@user1432751: The answer depends on what you mean by &quot;low-level stuff&quot;. The stdlib is of course implemented entirely in Go. Go however relies on an operating system to provide a number of basic syscalls to run the application."}], "answers": [{"comments": [{"owner": {"reputation": 5244, "user_id": 6942134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1nTLi.png?s=128&g=1", "display_name": "SergiyKolesnikov", "link": "https://stackoverflow.com/users/6942134/sergiykolesnikov"}, "edited": false, "score": 1, "creation_date": 1597852437, "post_id": 41721182, "comment_id": 112270447, "body": "The <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">cgo documentation</a> says that cgo is enabled by default for native builds. So, it looks like one has to set CGO_ENABLED=0 to make sure that there is no a dependency on C runtime."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 16, "last_activity_date": 1484843096, "last_edit_date": 1484843096, "creation_date": 1484747378, "answer_id": 41721182, "question_id": 41720090, "link": "https://stackoverflow.com/questions/41720090/does-go-depend-on-c-runtime/41721182#41721182", "title": "Does Go depend on C runtime?", "body": "<p>If you're talking about executable files provided by a Go compiler, then the answer is \"yes or no&mdash;it depends\":</p>\n\n<p>In most cases, the resulting executable program does <em>not</em> depend on a C run-time library.</p>\n\n<p>However, on some platforms under certain circumstances the C runtime library gets <em>dynamically</em> linked in.\nIn particular, this was the case with Go versions &lt; 1.5 on Linux when DNS resolution was used: the runtime depended on the platform's <code>libc</code> implementation to handle such resolution.\n<a href=\"https://golang.org/doc/go1.5#net\" rel=\"noreferrer\">In 1.5 this has been reworked</a>.</p>\n\n<p>Another possible case is (IIRC) Solaris which provides no stable way to access the kernel's syscalls directly and <a href=\"http://garrett.damore.org/2015/09/on-go-portability-and-system-interfaces.html\" rel=\"noreferrer\">requires routing these calls through the platform's <code>libc</code></a>.</p>\n\n<p>There is another case: using <code>cgo</code> which is a layer to interface Go code with foreign C code.  Using <code>cgo</code> makes your Go program depend on the C runtime.  Note that you might not use <code>cgo</code> directly but one or more of the third-party packages you might be using can use <code>cgo</code>, and&mdash;transitively&mdash;your program ends up depending on the C runtime library.</p>\n"}, {"comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1546007552, "post_id": 51297883, "comment_id": 94757648, "body": "Don&#39;t know which version of Go you used, but on 1.11.1 your example produces binary without any dependencies"}, {"owner": {"reputation": 63, "user_id": 6816304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1covj8SuFWw/AAAAAAAAAAI/AAAAAAAAG6o/ZdhadlUtoVY/photo.jpg?sz=128", "display_name": "yagami kishin", "link": "https://stackoverflow.com/users/6816304/yagami-kishin"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1546247503, "post_id": 51297883, "comment_id": 94808299, "body": "Ummm, today I checked my example with 1.11.1 and 1.11.4 on Linux, but the binary still depends on c runtime. I also checked it using the <code>golang:1.11.1</code> docker image. So I&#39;m not really sure why the example doesn&#39;t work in your env."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1546254351, "post_id": 51297883, "comment_id": 94810617, "body": "try building with cgo turned off. I tested by cross-compiling on Windows and macOS. The binary had an empty dynamic section."}], "tags": [], "owner": {"reputation": 63, "user_id": 6816304, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1covj8SuFWw/AAAAAAAAAAI/AAAAAAAAG6o/ZdhadlUtoVY/photo.jpg?sz=128", "display_name": "yagami kishin", "link": "https://stackoverflow.com/users/6816304/yagami-kishin"}, "is_accepted": false, "score": 4, "last_activity_date": 1531373147, "creation_date": 1531373147, "answer_id": 51297883, "question_id": 41720090, "link": "https://stackoverflow.com/questions/41720090/does-go-depend-on-c-runtime/51297883#51297883", "title": "Does Go depend on C runtime?", "body": "<p>I think the accepted answer is correct, but a binary which imports the 'net' package usually depends on a c runtime even in go 1.10 and Unix.</p>\n\n<p>Here is the example of the simple echo server:</p>\n\n<pre><code>package main\n\nimport (\n        \"io\"\n        \"log\"\n        \"net\"\n)\n\nfunc main() {\n        ln, err := net.Listen(\"tcp\", \":8080\")\n        if err != nil {\n                log.Fatal(err)\n        }\n\n        for {\n                conn, err := ln.Accept()\n                if err != nil {\n                        log.Print(err)\n                        continue\n                }\n\n                _, err = io.Copy(conn, conn) // blocked until the client closes the conn.\n                if err != nil {\n                        log.Print(err)\n                        continue\n                }\n\n                if err = conn.Close(); err != nil {\n                        log.Print(err)\n                }\n        }\n}\n</code></pre>\n\n<p>Build it and check its dependencies:</p>\n\n<pre><code>$ go build ./libc_check.go\n$ ldd ./libc_check\n        linux-vdso.so.1 =&gt;  (0x00007ffe34fc1000)\n        libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fc005d4e000)\n        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fc005984000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007fc005f6b000)\n</code></pre>\n\n<p>It is because 'the decision of how to run the resolver applies at run time, not build time' as <a href=\"https://golang.org/doc/go1.5#net\" rel=\"nofollow noreferrer\">the release note indicates</a>.</p>\n\n<p>To avoid this dependency, use the 'netgo' build tag like this:</p>\n\n<pre><code>$ go build -tags netgo ./libc_check.go\n$ ldd ./libc_check\n        not a dynamic executable\n</code></pre>\n"}], "owner": {"reputation": 6743, "user_id": 1432751, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e80f2b22b8c98730708ad3842c11604b?s=128&d=identicon&r=PG", "display_name": "Dmitry Bubnenkov", "link": "https://stackoverflow.com/users/1432751/dmitry-bubnenkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4260, "favorite_count": 2, "accepted_answer_id": 41721182, "answer_count": 2, "score": 6, "last_activity_date": 1606901813, "creation_date": 1484744342, "last_edit_date": 1606901813, "question_id": 41720090, "link": "https://stackoverflow.com/questions/41720090/does-go-depend-on-c-runtime", "title": "Does Go depend on C runtime?", "body": "<p>I can't find info does golang depend on c runtime? If it's depend on it is it's statically compiled in go-binary to make Go-app work everywhere without dependences? </p>\n\n<p>Here is topic about <a href=\"https://stackoverflow.com/questions/2766233/what-is-the-c-runtime-library\">what C-runtime is</a> </p>\n"}, {"tags": ["unit-testing", "go", "mocking"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1484772689, "post_id": 41719826, "comment_id": 70652813, "body": "I&#39;m not sure where the problem is: You construct an instance of <code>MyStruct</code> and call <code>MethodA</code> and check the result. That&#39;s what you do with <code>MethodB</code> already. To control the returned value you handcrafted the instance of MyStruct by setting its fields. And that&#39;s it. If you want deterministic output you have to control the input and the OtherStruct field <i>is</i> and input to Method{A,B}. If you have more fields you have to control all which are inputs to the functions under test."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1484772861, "post_id": 41719826, "comment_id": 70652919, "body": "Note that Go does not force you to stuff any functionality into <b>methods</b>. Maybe you could use more functions? Maybe even OtherInterface could be replaced by a simple function argument?"}, {"owner": {"reputation": 91, "user_id": 5100374, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/M22Xo.jpg?s=128&g=1", "display_name": "arzonus", "link": "https://stackoverflow.com/users/5100374/arzonus"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1484776741, "post_id": 41719826, "comment_id": 70654893, "body": "@Volker thank you for your comment. I don&#39;t agree with that this case is not problem. There is simple example. In real code, my struct have 5-10 fields with different interfaces, and when I&#39;m testing methodA, which call methodB, methodB have difficult logic. MethodB can call multiple fields&#39; methods, also this class methods, but I need to mock only methodB. Why I need mock other structures and methods? It&#39;s not easy way. You are testing structure, but I need to  testing structure&#39;s methods."}], "owner": {"reputation": 91, "user_id": 5100374, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/M22Xo.jpg?s=128&g=1", "display_name": "arzonus", "link": "https://stackoverflow.com/users/5100374/arzonus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 568, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1484743592, "creation_date": 1484743592, "question_id": 41719826, "link": "https://stackoverflow.com/questions/41719826/how-can-i-mock-structure-method-in-same-structure-method-in-golang", "title": "How can I mock structure method in same structure method in Golang?", "body": "<p>I have troubles with mocking.. I have same code:</p>\n\n<pre><code>type OtherInterface interface {\n   Do() error\n}\ntype MyInterface interface {\n   MethodA() error\n   MethodB() error\n}\ntype MyStruct struct {\n  OtherStruct OtherInterface\n}\nfunc(s *MyStruct) MethodA() error {\n  return s.MethodB()\n}\nfunc(s *MyStruct) MethodB() error {\n  return s.OtherStruct.Do()\n}\n</code></pre>\n\n<p>And test code of MethodB:</p>\n\n<pre><code>type MockOtherStruct struct {\n  Do_Error error\n}\nfunc (t *MockOtherStruct) Do() error {return t.Do_Error}\n\n\nTestMyStruct_MethodB(t *testing.B) {\n  expectedError = nil\n  mos := &amp;MockOtherStruct{\n    Do_Error: nil\n  }\n  ms := MyStruct{\n   OtherStruct: mos,\n  }\n  err := ms.MethodB()\n  if err != expectedError {\n    t.Fatal(err)\n  }      \n}\n</code></pre>\n\n<p>But how can I test MethodA?</p>\n\n<p>Yes, I can also mock OtherStruct and use not mocked MethodB, but in big structs I can have many fields with other structs, but use one internal method.. </p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484743747, "post_id": 41719797, "comment_id": 70634271, "body": "The only thing your first goroutine accomplishes, is causing a data race that possibly corrupts your slice. Once you remove all data races, please show a complete example."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484744168, "post_id": 41719797, "comment_id": 70634563, "body": "I have added my complete program. And I totally think you are right. The first goroutine is the problam. Let me see how o fix it. Maybe I will just let it  complete the loop without using any goroutine there. It isnt taking much time anyways."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484744439, "post_id": 41719797, "comment_id": 70634727, "body": "Yes you were right. It was because of the first goroutine. I am sorry, this was my first experience with concurrency. Thank you."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484744694, "post_id": 41719797, "comment_id": 70634893, "body": "You can fix it by removing it. There nothing there that needs to be concurrent."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484745736, "post_id": 41719797, "comment_id": 70635679, "body": "I removed it and I thought the problem was fixed but 1 out of 5 times it gives the TLS handshake error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484747657, "post_id": 41719797, "comment_id": 70637003, "body": "Your code still contains multiple race data races. Run your program with the race detector. This probably isn&#39;t causing the TLS error though. It may be an issue with the remote host, or the host could be rejecting your connections due to rate limiting or the limiting of concurrent connections."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 2, "creation_date": 1484801884, "post_id": 41719797, "comment_id": 70662173, "body": "I invite you to read this <a href=\"https://golang.org/cmd/gofmt/\" rel=\"nofollow noreferrer\">golang.org/cmd/gofmt</a>"}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484804359, "post_id": 41719797, "comment_id": 70662968, "body": "@JimB I used channels to try to fix the data racing but now the whole thing is slower. What is a better way to solve it? I have added my updated main code in the description."}, {"owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1484806606, "post_id": 41719797, "comment_id": 70663774, "body": "@YandryPozo Thank you, I always forget to gofmt my code."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484835528, "post_id": 41719797, "comment_id": 70680733, "body": "You&#39;ve fixed the &quot;problem&quot; by removing the concurrency. You now have a single goroutine which synchronously gets each file one at a time. You could do the same thing much simpler with a single for loop. The timeouts were probably from your unbounded workers before. If you fix the race conditions you can add a few more workers and actually have some concurrency. (note, you should also <code>range</code> over the channel rather than use your <code>more</code> value)."}], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "is_accepted": true, "score": 5, "last_activity_date": 1485861712, "creation_date": 1485861712, "answer_id": 41956295, "question_id": 41719797, "link": "https://stackoverflow.com/questions/41719797/tls-handshake-timeout-on-requesting-data-concurrently-from-api/41956295#41956295", "title": "TLS handshake timeout on requesting data concurrently from api", "body": "<p>The <code>net/http</code> occurs when there is a large amount of http.Get() requests from client side. To avoid the <code>TLS handshake timeout error</code>, </p>\n\n<pre><code>t := &amp;http.Transport{\n            Dial: (&amp;net.Dialer{\n                    Timeout: 60 * time.Second,\n                    KeepAlive: 30 * time.Second,\n            }).Dial,\n            // We use ABSURDLY large keys, and should probably not.\n            TLSHandshakeTimeout: 60 * time.Second,\n    }\n    c := &amp;http.Client{\n            Transport: t,\n    }\n    resp, err := c.Get(\"https://internal.lan/\")\n</code></pre>\n\n<p>Found it <a href=\"https://github.com/mitchellh/goamz/issues/241\" rel=\"noreferrer\">here</a></p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1930, "favorite_count": 2, "accepted_answer_id": 41956295, "answer_count": 1, "score": 0, "last_activity_date": 1485861712, "creation_date": 1484743510, "last_edit_date": 1484804289, "question_id": 41719797, "link": "https://stackoverflow.com/questions/41719797/tls-handshake-timeout-on-requesting-data-concurrently-from-api", "title": "TLS handshake timeout on requesting data concurrently from api", "body": "<p>This is my first program in which I have used concurrency so I might be missing something fairly simple.</p>\n\n<pre><code>package main\n\nimport(\n    \"net/http\"\n    \"net/url\"\n    \"log\"\n    \"flag\"\n    \"io/ioutil\"\n    \"fmt\"\n    \"golang.org/x/net/html\"\n    \"strings\"\n    \"encoding/json\"\n    \"os\"\n    \"html/template\"\n)\n\ntype fileInfo struct{\n    Title string `json:\"Title\"`;\n    Year string `json:\"Year\"`;\n    Runtime string `json:\"Runtime\"`\n    Genre string `json:\"Genre\"` \n    Rating string `json:\"imdbRating\"`;\n    Description string `json:\"Plot\"`;\n    Image string `json:\"Poster\"`;\n    Awards string `json:\"Awards\"`;\n}\n\nvar movie struct{\n    Name string;\n    Year string;\n}\nvar Movies []fileInfo\nfunc main() {\n    flag.Parse()\n    files, _ := ioutil.ReadDir(flag.Args()[0])\n    var queryNames []string\n    for _, f := range files {\n        go func(){\n            queryNames= append(queryNames,url.QueryEscape(f.Name()))\n        }()\n    }\n    //fmt.Println(os.Getenv(\"GOPATH\") + \"/src/github.com/krashcan/review/template/index.tpl\")\n    fmt.Println(\"Preparing data\")\n\n\n    for _, f := range queryNames {\n        go GetTitleAndYear(\"https://opensubtitles.co/search?q=\" + f)\n    }\n\n\n\n\n    fmt.Println(\"Done\")\n    http.HandleFunc(\"/\",ShowRatings)\n    http.Handle(\"/static/\",http.StripPrefix(\"/static/\",http.FileServer(http.Dir(os.Getenv(\"GOPATH\") + \"/src/github.com/krashcan/review/static\"))))\n\n    log.Fatal(http.ListenAndServe(\":8080\",nil))\n}\n\nfunc ShowRatings(w http.ResponseWriter,r *http.Request){\n    t,err := template.ParseFiles(os.Getenv(\"GOPATH\") + \"/src/github.com/krashcan/review/template/index.tpl\")\n    if(err!=nil){\n        log.Fatal(err)\n    }\n    t.Execute(w,Movies)\n}\n\nfunc GetTitleAndYear(url string){\n    resp,err := http.Get(url)\n    if err!=nil{\n        log.Fatal(err)\n    }\n    var movieData string\n    if resp.StatusCode != 200 {\n        fmt.Println(\"statuscode\",err)\n    }\n    z := html.NewTokenizer(resp.Body)\n    for{\n        tt := z.Next()\n\n        if tt == html.ErrorToken{\n            return\n        }else if tt==html.StartTagToken{\n            t:= z.Token()\n            if t.Data==\"h4\"{\n                tt = z.Next()\n                tt = z.Next()\n                tt = z.Next()\n                t = z.Token()\n                movieData = strings.TrimSpace(t.Data)               \n                break\n            }\n        }\n    }\n\n    movie.Name = movieData[:len(movieData)-6]\n    movie.Year = movieData[len(movieData)-5:len(movieData)-1]\n    movie.Name = strings.Replace(movie.Name, \" \", \"+\", -1)\n    url = \"http://www.omdbapi.com/?t=\" + movie.Name + \"&amp;y=\" + movie.Year + \"&amp;plot=short&amp;r=json\"  \n    req,err := http.Get(url)\n\n    if err!=nil{\n        log.Fatal(err)\n    }\n    var x fileInfo\n    jsonParser := json.NewDecoder(req.Body)\n    if err := jsonParser.Decode(&amp;x); err != nil {\n        log.Fatal(\"parsing config file\", err)\n    }\n    Movies = append(Movies,x)\n    fmt.Println(x.Title,x.Year)     \n}\n</code></pre>\n\n<p>This program ran perfectly for the first time. But after that it keeps on giving <code>net/http:TLS Handshake timeout</code> on random filenames. I am not sure what is causing this. What might be a possible solution? Also what exactly is this error? </p>\n\n<p>EDIT 2: To solve the racing problem in concurrency, I used channels but now my program is very very slow compared to before. My updated main function :</p>\n\n<pre><code>func main() {\n    flag.Parse()\n    files, _ := ioutil.ReadDir(flag.Args()[0])\n    var queryNames []string\n    for _, f := range files {\n        queryNames= append(queryNames,url.QueryEscape(f.Name()))\n    }\n    //fmt.Println(os.Getenv(\"GOPATH\") + \"/src/github.com/krashcan/review/template/index.tpl\")\n    fmt.Println(\"Preparing data\")\n    ch := make(chan string)\n    done := make(chan bool)\n    go func(){\n        for{\n            name,more := &lt;-ch\n            if more{\n                GetTitleAndYear(\"https://opensubtitles.co/search?q=\" + name)\n            }else{\n                done &lt;-true\n            }\n        }\n    }()\n\n    for i:=0;i&lt;len(queryNames);i++{\n        ch &lt;- queryNames[i] \n    }\n    &lt;- done\n    fmt.Println(\"Preparation DONE\")\n    http.HandleFunc(\"/\",ShowRatings)\n    http.Handle(\"/static/\",http.StripPrefix(\"/static/\",http.FileServer(http.Dir(os.Getenv(\"GOPATH\") + \"/src/github.com/krashcan/review/static\"))))\n\n    log.Fatal(http.ListenAndServe(\":8080\",nil))\n}\n</code></pre>\n\n<p>Please suggest me a way to have the same speed as before but also avoid racing around problems.</p>\n\n<p>EDIT 1: I have added my complete program. There is no way to depict line no.s on stack overflow , I have used concurrency only in the main function. If you feel the need to advice me on my way of writing go programs, please do so, I am a beginner and I would love to do things right.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 1, "creation_date": 1484745319, "post_id": 41718408, "comment_id": 70635366, "body": "<a href=\"http://stackoverflow.com/a/33768929/2285935\">Refer</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484752726, "post_id": 41718408, "comment_id": 70640743, "body": "Your error isn&#39;t a Go problem, <code>159.107.45.245:12345</code> is in use, so you can&#39;t bind to it again (this is why outgoing connections always use a random system assigned port number.)"}, {"owner": {"reputation": 725, "user_id": 156459, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e944b56331602c572d23b47243dca582?s=128&d=identicon&r=PG", "display_name": "thamurath", "link": "https://stackoverflow.com/users/156459/thamurath"}, "edited": false, "score": 0, "creation_date": 1484769689, "post_id": 41718408, "comment_id": 70651225, "body": "You are right ... there was a service going up and down using the port ... so It been difficult to see it .."}], "owner": {"reputation": 725, "user_id": 156459, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e944b56331602c572d23b47243dca582?s=128&d=identicon&r=PG", "display_name": "thamurath", "link": "https://stackoverflow.com/users/156459/thamurath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "closed_date": 1484752341, "answer_count": 0, "score": 0, "last_activity_date": 1484769632, "creation_date": 1484739348, "last_edit_date": 1484769632, "question_id": 41718408, "link": "https://stackoverflow.com/questions/41718408/golang-http-connection-from-a-specific-source-port", "closed_reason": "Duplicate", "title": "Golang http connection from a specific source port", "body": "<p>I am trying to connect with a remote http server to test some middlebox.\nI need to be able to specify the connection source port because the middlebox software does not allow wildwcards yet in the five tuple specification for the redirection rules ... so </p>\n\n<p>How can I create a http request specifying the source port?</p>\n\n<p>Thanks in advance... </p>\n"}, {"tags": ["authentication", "go", "docker", "oauth", "rancher"], "answers": [{"tags": [], "owner": {"reputation": 964, "user_id": 5666255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be87dca96b332fd97c059c310758d6f1?s=128&d=identicon&r=PG", "display_name": "Vincent Fiduccia", "link": "https://stackoverflow.com/users/5666255/vincent-fiduccia"}, "is_accepted": true, "score": 0, "last_activity_date": 1484766290, "creation_date": 1484766290, "answer_id": 41727450, "question_id": 41716240, "link": "https://stackoverflow.com/questions/41716240/extending-ranchers-auth-service-to-use-other-oauth-provider/41727450#41727450", "title": "Extending Rancher&#39;s Auth-service to use other (OAuth) provider", "body": "<p>It is an external service mainly to make it easier for us to develop additional providers, and to pull that code out of the Cattle core (the migration of which is on-going, only Github is moved and Shibboleth was added as a new one only into the Golang one).</p>\n\n<p>While it is possible, this is not currently a general public plugin point. There is not any formal way to register your own provider, get that into the server container, provide UI to configure it, or log into it once configured.</p>\n"}], "owner": {"reputation": 3, "user_id": 7434803, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0Sdi_Un6kZI/AAAAAAAAAAI/AAAAAAAAAMU/LUKNa9ulJPU/photo.jpg?sz=128", "display_name": "Gabriele Cerfoglio", "link": "https://stackoverflow.com/users/7434803/gabriele-cerfoglio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 41727450, "answer_count": 1, "score": 0, "last_activity_date": 1484766290, "creation_date": 1484733402, "question_id": 41716240, "link": "https://stackoverflow.com/questions/41716240/extending-ranchers-auth-service-to-use-other-oauth-provider", "title": "Extending Rancher&#39;s Auth-service to use other (OAuth) provider", "body": "<p>Our team is currently looking to use Rancher for a Docker container orchestration solution, and one the things I'm looking to do is try setting up Access Control on the Rancher server using a provider that isn't supported by Rancher at the moment (this being <a href=\"https://account.lab.fiware.org/\" rel=\"nofollow noreferrer\">Fiware Lab</a> which can be a OAuth provider). </p>\n\n<p>Rancher handles authentication in a separate Golang service available in <a href=\"https://github.com/rancher/rancher-auth-service\" rel=\"nofollow noreferrer\">this repo</a>. This could be extended to allow for a new provider for authentication as described in the wiki of the repo. What I'm confused about however is how I could then deploy my extended service with Rancher Server. Is it possible to just run the extended service without having to build a new Docker image for Rancher Server altogether? </p>\n"}, {"tags": ["javascript", "go", "datatables"], "answers": [{"tags": [], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "is_accepted": true, "score": 1, "last_activity_date": 1484741024, "last_edit_date": 1484741024, "creation_date": 1484737335, "answer_id": 41717691, "question_id": 41715107, "link": "https://stackoverflow.com/questions/41715107/how-to-use-jquery-datatable-with-golang/41717691#41717691", "title": "How to use JQuery Datatable with Golang?", "body": "<p>Just convert <strong>Map into a Slice</strong> and use it in JQuery.</p>\n\n<pre><code>dataValue := reflect.ValueOf(dBdetails)\nvar valueSlice []string\nfor key, value := range dataValue.MapKeys() {\n    keySlice = append(keySlice, key)\n    valueSlice = append(valueSlice, value)\n}\n\nlog.Println(keySlice, valueSlice)\n</code></pre>\n\n<p>The above code will convert map into slice.</p>\n"}], "owner": {"reputation": 133, "user_id": 7255142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/svdMc.jpg?s=128&g=1", "display_name": "Sarath Sankara Kurup", "link": "https://stackoverflow.com/users/7255142/sarath-sankara-kurup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 0, "accepted_answer_id": 41717691, "answer_count": 1, "score": 0, "last_activity_date": 1484741024, "creation_date": 1484730183, "question_id": 41715107, "link": "https://stackoverflow.com/questions/41715107/how-to-use-jquery-datatable-with-golang", "title": "How to use JQuery Datatable with Golang?", "body": "<p>I am using JQuery Datatable to list the details in my Database. I wrote my server side in Golang. I have my database values stored in a map called <code>dBdetails</code> now I want to display the contents of this map using Datables. How can I do?</p>\n"}, {"tags": ["pointers", "go", "struct", "reference", "pass-by-reference"], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 3, "last_activity_date": 1484729574, "creation_date": 1484729574, "answer_id": 41714922, "question_id": 41714727, "link": "https://stackoverflow.com/questions/41714727/why-does-the-memory-address-of-a-struct-reference-change/41714922#41714922", "title": "Why does the memory address of a struct reference change?", "body": "<p>You are not displaying the address of the struct, you are displaying the address of the address (address of the pointer). The pointer is passed as a parameter and thus new each time. Remove the &amp; in <code>log.Printf(\"Whatever.GetNameByReference() memory address: %v\", &amp;whatever)</code> to get what you want (and use %p instead of %v).</p>\n"}, {"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1484729845, "post_id": 41714969, "comment_id": 70624892, "body": "Btw: You should come up with better names. Distinguishing <code>whatever</code> and <code>Whatever</code> is basically impossible."}, {"owner": {"reputation": 1465, "user_id": 5848613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HTjcL.png?s=128&g=1", "display_name": "21st", "link": "https://stackoverflow.com/users/5848613/21st"}, "edited": false, "score": 0, "creation_date": 1484735061, "post_id": 41714969, "comment_id": 70628411, "body": "Thanks a lot, great answer! Regarding the naming, I don&#39;t like using abbrevations and I not sure about using self / this.. any other idea?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 1465, "user_id": 5848613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HTjcL.png?s=128&g=1", "display_name": "21st", "link": "https://stackoverflow.com/users/5848613/21st"}, "edited": false, "score": 3, "creation_date": 1484736684, "post_id": 41714969, "comment_id": 70629523, "body": "In Go it would be <code>func (w *Whatever)</code>."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 11, "last_activity_date": 1484731703, "last_edit_date": 1484731703, "creation_date": 1484729751, "answer_id": 41714969, "question_id": 41714727, "link": "https://stackoverflow.com/questions/41714727/why-does-the-memory-address-of-a-struct-reference-change/41714969#41714969", "title": "Why does the memory address of a struct reference change?", "body": "<p>Never think and never talk about references. Go has no notion of \"reference\", everything is a value. Some things are pointer values. Your problem stems from thinking about <code>*X</code> as \"a reference to an X\" which it isn't: It is a value holding the memory address of an <code>X</code> (or nil).</p>\n\n<p>So in <code>func (whatever *Whatever)</code> the variable <code>whatever</code> is a pointer to a <code>Whatever</code>. The value of <code>whatever</code> is the memory address of the <code>Whatever</code> the pointer points to. You would like to print this memory address, i.e. the value of <code>whatever</code>.</p>\n\n<p>You do <code>Printf(\"%v\", &amp;whatever)</code>. Remember: <code>whatever</code> is a variable (holding a memory address). So <code>&amp;whatever</code> is the address of the variable itself: <code>&amp;whatever</code> is of type <code>**Whatever</code>. What you find at the address <code>&amp;whatever</code> is <em>not</em> the value you are interested in; it is just the temporary variable used to store the address of the original <code>Whatever</code>. Of course this temporary variable is not pinned in memory an may change freely.</p>\n\n<p>You should do <code>Printf(\"%p\", whatever)</code>. The verb <code>%p</code> is for pointer values and <code>whatever</code>is a pointer and you are interested in its value, so print this value.</p>\n"}, {"comments": [{"owner": {"reputation": 1465, "user_id": 5848613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HTjcL.png?s=128&g=1", "display_name": "21st", "link": "https://stackoverflow.com/users/5848613/21st"}, "edited": false, "score": 0, "creation_date": 1484735110, "post_id": 41715745, "comment_id": 70628440, "body": "Thanks, the learning.. not quite what is was looking for, but great learning. Thx"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1484731997, "creation_date": 1484731997, "answer_id": 41715745, "question_id": 41714727, "link": "https://stackoverflow.com/questions/41714727/why-does-the-memory-address-of-a-struct-reference-change/41715745#41715745", "title": "Why does the memory address of a struct reference change?", "body": "<p>Calling method</p>\n\n<pre><code>func (whatever *Whatever) GetNameByReference() (string) {\n</code></pre>\n\n<p>is much the same as calling function providing receiver as first argument</p>\n\n<pre><code>func GetNameByReference(whatever *Whatever) (string) {\n</code></pre>\n\n<p>Go calling convention is to always pass arguments copy_by_value. So each time you call  <code>whatever.GetNameByReference()</code> it receives fresh copy of <code>whatever</code> which itself holds same <code>*Whatever</code> address. As already written doing</p>\n\n<pre><code>log.Printf(\"Whatever.GetNameByReference() memory address: %v\", whatever) //instead of &amp;whatever\n</code></pre>\n\n<p>will log the same <code>whatever</code> value which is address.</p>\n"}], "owner": {"reputation": 1465, "user_id": 5848613, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HTjcL.png?s=128&g=1", "display_name": "21st", "link": "https://stackoverflow.com/users/5848613/21st"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3041, "favorite_count": 1, "accepted_answer_id": 41714969, "answer_count": 3, "score": 5, "last_activity_date": 1558349519, "creation_date": 1484728863, "last_edit_date": 1558349519, "question_id": 41714727, "link": "https://stackoverflow.com/questions/41714727/why-does-the-memory-address-of-a-struct-reference-change", "title": "Why does the memory address of a struct reference change?", "body": "<p>I have a struct and a method that's working on the structs reference. The pointer address is changing every time I call the method. Why is it like that? </p>\n\n<p>Code</p>\n\n<pre><code>package main\n\nimport \"k8s.io/contrib/compare/Godeps/_workspace/src/github.com/emicklei/go-restful/log\"\n\ntype Whatever struct{\n    Name string\n}\n\nfunc (whatever *Whatever) GetNameByReference() (string) {\nlog.Printf(\"Whatever.GetNameByReference() memory address: %v\", &amp;whatever)\n\n    return whatever.Name\n}\n\nfunc evaluateMemoryAddressWhenNotWritingAnything()  {\n    whatever := Whatever{}\n\n    whatever.GetNameByReference()\n    whatever.GetNameByReference()\n    whatever.GetNameByReference()\n}\n\nfunc main() {\n    evaluateMemoryAddressWhenNotWritingAnything()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>log.go:30: Whatever.GetNameByReference() memory address: 0xc420034020\nlog.go:30: Whatever.GetNameByReference() memory address: 0xc420034030\nlog.go:30: Whatever.GetNameByReference() memory address: 0xc420034038\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 1, "creation_date": 1484725358, "post_id": 41713767, "comment_id": 70622375, "body": "function&#39;s arg type should be equal"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 2, "creation_date": 1484725469, "post_id": 41713767, "comment_id": 70622433, "body": "There is no duck typing in go, and <code>ConcreteAPI</code> doesn&#39;t implement the <code>API</code> interface because <code>API</code> has a method <code>Create(Model)</code>  and <code>ConcreteAPI</code> doesn&#39;t."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1484725822, "post_id": 41713767, "comment_id": 70622599, "body": "&quot;Does anybody have suggestions on how to make whats above actually work?&quot; Yes: Stop thinking in traditional OOP and redesign."}], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 5788028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da7b5eaa51dfae3f99db1e64a6b739d?s=128&d=identicon&r=PG&f=1", "display_name": "Rachoac", "link": "https://stackoverflow.com/users/5788028/rachoac"}, "edited": false, "score": 1, "creation_date": 1484729008, "post_id": 41714684, "comment_id": 70624391, "body": "Thanks Yu Peng, I was trying to avoid that approach as it requires casting:  <code>func (api ConcreteAPI) Create(model Model) {     fmt.Println(&quot;Created concrete model with id &quot; +  model.(ConcreteModel).ID() + &quot;, name &quot; +  model.(ConcreteModel).Name()) }</code>  but that does seem like the only way to do what I want unfortunately, as I would like ConcreteAPI to work explicitly with ConcreteModel in its signature (so I can&#39;t throw a different implementation of Model into its Create method)"}], "tags": [], "owner": {"reputation": 1, "user_id": 7428732, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TZzHY0oFpQE/AAAAAAAAAAI/AAAAAAAAABQ/5_TJ-TQSYRg/photo.jpg?sz=128", "display_name": "Yu Peng", "link": "https://stackoverflow.com/users/7428732/yu-peng"}, "is_accepted": false, "score": 0, "last_activity_date": 1484728681, "creation_date": 1484728681, "answer_id": 41714684, "question_id": 41713767, "link": "https://stackoverflow.com/questions/41713767/why-isnt-golang-duck-typing-not-working-for-me-in-my-code-below/41714684#41714684", "title": "Why isn&#39;t golang duck typing not working for me in my code below?", "body": "<p>ConcreteAPI doesn't implements API's method ,please you can add:</p>\n\n<p>func( concreteApi *ConcreteAPI )  Create(Model){}</p>\n\n<p>but you have another error see detail below:\nConcreteModel also doesn't implements  Model </p>\n"}], "owner": {"reputation": 112, "user_id": 5788028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da7b5eaa51dfae3f99db1e64a6b739d?s=128&d=identicon&r=PG&f=1", "display_name": "Rachoac", "link": "https://stackoverflow.com/users/5788028/rachoac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484728681, "creation_date": 1484725252, "question_id": 41713767, "link": "https://stackoverflow.com/questions/41713767/why-isnt-golang-duck-typing-not-working-for-me-in-my-code-below", "title": "Why isn&#39;t golang duck typing not working for me in my code below?", "body": "<p>In the code below, I'm trying to create concrete implementations of a Model interface and API interface:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n/////////\n\ntype Model interface {\n    ID() string\n}\n\ntype API interface {\n    Create(Model)\n}\n\n/////////\n\ntype ConcreteModel struct {}\n\nfunc (model ConcreteModel) ID() string {\n    return \"123\"\n}\n\nfunc (model ConcreteModel) Name() string {\n    return \"aron\"\n}\n\ntype ConcreteAPI struct{}\n\nfunc (api ConcreteAPI) Create(model ConcreteModel) {\n    fmt.Println(\"Created concrete model with id \" + model.ID() + \", name \" + model.Name())\n}\n\nfunc main() {\n    // invocation via interface\n    func(api API) {\n        api.Create(ConcreteModel{})\n    }(ConcreteAPI{})\n}\n</code></pre>\n\n<p>Utterly confusing to me is why I get the following error when running this code:</p>\n\n<pre><code>ConcreteAPI does not implement API (wrong type for Create method)\n        have Create(ConcreteModel)\n        want Create(Model)\n</code></pre>\n\n<p>From what I glean about golang ducktyping, it would seem that ConcreteAPI should be fulfilling the contract of Create(Model) because <code>ConcreteModel</code> has the required methods of <code>Model</code>, namely <code>ID() string</code>.</p>\n\n<p>The reason I want to try to do something like this is that <code>func(api API)</code> is a stand-in for something that knows how to play with concrete API implementations, in my intended real-world codebase.</p>\n\n<p>Does anybody have suggestions on how to make whats above actually work?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1484728971, "post_id": 41712839, "comment_id": 70624360, "body": "there is &quot; source string &quot;field in Pinger struct but how do I set it? I can not see any method to set it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484745084, "post_id": 41712839, "comment_id": 70635177, "body": "If the package doesn&#39;t expose that field, you either need to modify the package or use a different one."}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484730386, "creation_date": 1484721337, "last_edit_date": 1484730386, "question_id": 41712839, "link": "https://stackoverflow.com/questions/41712839/specify-source-ip-address-while-using-go-ping-library", "title": "Specify source IP address while using go-ping library", "body": "<p>I am using go-ping library (<a href=\"https://github.com/sparrc/go-ping\" rel=\"nofollow noreferrer\">https://github.com/sparrc/go-ping</a>) in my code, Is there any way so that I can specify source IP address from which to measure RTT just like we have -s option in using ping.</p>\n\n<p>Here is my code. I want to specify source IP address to measure all these values. Has anyone done this before?</p>\n\n<pre><code>timeout := time.Second * 1000\ninterval := time.Second\ncount := 5\nhost := p.ipAddr\npinger, cmdErr := ping.NewPinger(host)\n\nif cmdErr != nil {\n    glog.Error(\"Failed to ping \" + p.ipAddr)\n    err = cmdErr\n    return\n}\n\npinger.Count = count\npinger.Interval = interval\npinger.Timeout = timeout\npinger.SetPrivileged(false)\npinger.Run()\nstats := pinger.Statistics()\nlatency = float64(stats.AvgRtt) / float64(time.Millisecond)\njitter = float64(stats.StdDevRtt) / float64(time.Millisecond)\npacketLoss = stats.PacketLoss \n</code></pre>\n"}, {"tags": ["go", "build"], "comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484712642, "post_id": 41710989, "comment_id": 70617689, "body": "Try <code>go build -o .&#47;bin&#47;main .&#47;src&#47;main.go </code>"}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484712887, "post_id": 41710989, "comment_id": 70617756, "body": "thanks I will try that - can you also explain what to do if there is more than one .go file in the src directory?"}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484712921, "post_id": 41710989, "comment_id": 70617772, "body": "would it be: go build -o ./bin/main ./src/**/*"}, {"owner": {"reputation": 96, "user_id": 1116295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dc7d254af9648054dd03211d16a5c3e?s=128&d=identicon&r=PG", "display_name": "exavolt", "link": "https://stackoverflow.com/users/1116295/exavolt"}, "edited": false, "score": 1, "creation_date": 1484713883, "post_id": 41710989, "comment_id": 70618024, "body": "This should be enough: <code>go build -o .&#47;bin&#47;main .&#47;src</code>. I use a similar pattern (I use the same code base for multiple apps, each app has different module composition)."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1484714257, "post_id": 41710989, "comment_id": 70618113, "body": "thanks - does Golang always write everything to only a single binary file?"}, {"owner": {"reputation": 96, "user_id": 1116295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dc7d254af9648054dd03211d16a5c3e?s=128&d=identicon&r=PG", "display_name": "exavolt", "link": "https://stackoverflow.com/users/1116295/exavolt"}, "edited": false, "score": 1, "creation_date": 1484714370, "post_id": 41710989, "comment_id": 70618146, "body": "Currently (Go &lt;= 1.7), yes. But we will have a working plugin system built-in in Go 1.8 which is due next month."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484756774, "post_id": 41710989, "comment_id": 70643632, "body": "Read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> for more details on how to setup your environment."}], "answers": [{"tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 2, "last_activity_date": 1485095396, "last_edit_date": 1485095396, "creation_date": 1484755474, "answer_id": 41723995, "question_id": 41710989, "link": "https://stackoverflow.com/questions/41710989/building-golang-project-properly/41723995#41723995", "title": "Building Golang project properly", "body": "<pre><code>GOPATH=$PROJECT_DIR &amp;&amp; cd $PROJECT_DIR &amp;&amp; go install main\n</code></pre>\n\n<p>Also move your main.go file into src/main/main.go.</p>\n\n<p>This will produce a bin/main executable.</p>\n\n<p>If you have multiple executables you wanna build, you have to put each main.go file into a separate folder/package. The name of the generated executable is taken from the directory name the file is inside. The package name of the main.go files must always be main if it should create a binary.</p>\n\n<p>To compile multiple executables you have to use:</p>\n\n<pre><code>GOPATH=$PROJECT_DIR &amp;&amp; cd $PROJECT_DIR &amp;&amp; go install ...\n</code></pre>\n\n<p>The <code>...</code> matches all folders/packages.</p>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1537, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1485095480, "creation_date": 1484711031, "last_edit_date": 1485095480, "question_id": 41710989, "link": "https://stackoverflow.com/questions/41710989/building-golang-project-properly", "title": "Building Golang project properly", "body": "<p>I have a project structure that looks like so:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2zF7e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2zF7e.png\" alt=\"enter image description here\"></a>\nI was planning on just using a shell script (build.sh) to set GOPATH and build the project.</p>\n\n<p>I am not sure how to build a Golang project properly, my short term goal is to just to build the packages in the src directory and put the binaries into the bin directory.</p>\n\n<p>I am not sure what go build command can do that, I have tried a few things.</p>\n\n<p>So first my question is - is this a reasonable project structure and second, how can I compile my src directory to bin?</p>\n\n<p>What I have gives me the following error:</p>\n\n<pre><code>can't load package: package .: no buildable Go source files in /home/oleg/WebstormProjects/oresoftware/stack-server\n</code></pre>\n\n<p>So I believe I need to tell Go to look in the <code>src</code> directory, because Go is only looking for .go files in the project root, but I am not sure how to do that.</p>\n\n<p>If it matters, the main.go file has a package name of \"main\".</p>\n"}, {"tags": ["multithreading", "go", "concurrency", "race-condition", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484702298, "post_id": 41709220, "comment_id": 70615069, "body": "Do you actually need to close the file? The safest method is to just leave the reading goroutine until process exit."}, {"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484719334, "post_id": 41709220, "comment_id": 70619818, "body": "I don&#39;t see why you would want to use a file handle across different thread of execution or for that matter any resource. It will only make your code complex."}, {"owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484729159, "post_id": 41709220, "comment_id": 70624480, "body": "@JimB, I do need to close the file in order to implement reconnection: e.g. when I unplug the device whose node was <code>&#47;dev&#47;ttyUSB0</code>, and I don&#39;t close the file, then the file <code>&#47;dev&#47;ttyUSB0</code> will still be opened, and when I plug the device back, it&#39;ll become <code>&#47;dev&#47;ttyUSB1</code>. I need it to be <code>&#47;dev&#47;ttyUSB0</code> again."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484748519, "post_id": 41709220, "comment_id": 70637586, "body": "@DmitryFrank: if removing the device doesn&#39;t unblock the read, how do you know the device has been removed?"}, {"owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484750614, "post_id": 41709220, "comment_id": 70639202, "body": "@JimB, ok that&#39;s a bad example: in this particular case <code>Read</code> will return <code>io.EOF</code> indeed, but the question is more general. E.g. consider having the goroutine which reads data from the serial port and sending the received data to some channel, and the user having a &quot;disconnect&quot; button, which obviously should close the file, and do that without races."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484751356, "post_id": 41709220, "comment_id": 70639727, "body": "@DmitryFrank: it&#39;s not just about the race in Go -- POSIX doesn&#39;t allow you to cancel a read by closing the file from another thread. The only safe solution here is to poll the file via select/epoll/etc on the file descriptor. That still leaves a tiny race within the polling timeout, but this isn&#39;t something inherent to Go in particular."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484777359, "post_id": 41730225, "comment_id": 70655157, "body": "A Read without incoming data will block indefinitely. This can&#39;t interrupt a Read call."}, {"owner": {"reputation": 3547, "user_id": 546750, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5e663c9fc0ebe46af81b8a49d5e2aa91?s=128&d=identicon&r=PG", "display_name": "ahmy", "link": "https://stackoverflow.com/users/546750/ahmy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484838786, "post_id": 41730225, "comment_id": 70683206, "body": "you might be right, I&#39;ll see if i change it to ch &lt;-f.Read(b) instead of default:"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484839265, "post_id": 41730225, "comment_id": 70683563, "body": "That still doesn&#39;t change anything, because the Read is evaluated first. You simply cannot interrupt a Read directly on a file on Go (for now)."}], "tags": [], "owner": {"reputation": 3547, "user_id": 546750, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5e663c9fc0ebe46af81b8a49d5e2aa91?s=128&d=identicon&r=PG", "display_name": "ahmy", "link": "https://stackoverflow.com/users/546750/ahmy"}, "is_accepted": false, "score": -1, "last_activity_date": 1484776777, "creation_date": 1484776777, "answer_id": 41730225, "question_id": 41709220, "link": "https://stackoverflow.com/questions/41709220/concurrent-read-close-in-go-in-a-crossplatform-way/41730225#41730225", "title": "Concurrent Read/Close in Go, in a crossplatform way", "body": "<p>I belive you need 2 signals:</p>\n\n<ol>\n<li>main -> reader, to tell it to stop reading</li>\n<li>reader -> main, to tell that reader has been terminated</li>\n</ol>\n\n<p>of course you can select go signaling primitive (channel, waitgroup, context etc) that you prefer.</p>\n\n<p>Example below, I use waitgroup and context. The reason is \nthat you can spin multiple reader and only need to close the context to tell all the reader go-routine to stop.</p>\n\n<p>I created multiple go routine just as \nan example that you can even coordinate multiple go routine with it.</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"os\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n\n    ctx, cancelFn := context.WithCancel(context.Background())\n\n    f, err := os.Open(\"/dev/ttyUSB0\")\n    if err != nil {\n        panic(err)\n    }\n\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 3; i++ {\n        wg.Add(1)\n\n        // Start a goroutine which keeps reading from a serial port\n        go func(i int) {\n            defer wg.Done()\n            reader(ctx, f)\n            fmt.Printf(\"reader %d closed\\n\", i)\n        }(i)\n    }\n\n    time.Sleep(1000 * time.Millisecond)\n    fmt.Println(\"closing\")\n    cancelFn() // signal all reader to stop\n    wg.Wait()  // wait until all reader finished\n    f.Close()\n    fmt.Println(\"file closed\")\n    time.Sleep(1000 * time.Millisecond)\n}\n\nfunc reader(ctx context.Context, f *os.File) {\n    b := make([]byte, 100)\n    for {\n        select {\n        case &lt;-ctx.Done():\n            return\n        default:\n            f.Read(b)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 856, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484776777, "creation_date": 1484697697, "question_id": 41709220, "link": "https://stackoverflow.com/questions/41709220/concurrent-read-close-in-go-in-a-crossplatform-way", "title": "Concurrent Read/Close in Go, in a crossplatform way", "body": "<p>I recently realized that I don't know how to properly <code>Read</code> and <code>Close</code> in Go concurrently. In my particular case, I need to do that with a serial port, but the problem is more generic.</p>\n\n<p>If we do that without any extra effort to synchronize things, it leads to a race condition. Simple example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    f, err := os.Open(\"/dev/ttyUSB0\")\n    if err != nil {\n        panic(err)\n    }\n\n    // Start a goroutine which keeps reading from a serial port\n    go reader(f)\n\n    time.Sleep(1000 * time.Millisecond)\n    fmt.Println(\"closing\")\n    f.Close()\n    time.Sleep(1000 * time.Millisecond)\n}\n\nfunc reader(f *os.File) {\n    b := make([]byte, 100)\n    for {\n        f.Read(b)\n    }\n}\n</code></pre>\n\n<p>If we save the above as <code>main.go</code>, and run <code>go run --race main.go</code>, the output will look as follows:</p>\n\n<pre><code>closing\n==================\nWARNING: DATA RACE\nWrite at 0x00c4200143c0 by main goroutine:\n  os.(*file).close()\n      /usr/local/go/src/os/file_unix.go:143 +0x124\n  os.(*File).Close()\n      /usr/local/go/src/os/file_unix.go:132 +0x55\n  main.main()\n      /home/dimon/mydata/projects/go/src/dmitryfrank.com/testfiles/main.go:20 +0x13f\n\nPrevious read at 0x00c4200143c0 by goroutine 6:\n  os.(*File).read()\n      /usr/local/go/src/os/file_unix.go:228 +0x50\n  os.(*File).Read()\n      /usr/local/go/src/os/file.go:101 +0x6f\n  main.reader()\n      /home/dimon/mydata/projects/go/src/dmitryfrank.com/testfiles/main.go:27 +0x8b\n\nGoroutine 6 (running) created at:\n  main.main()\n      /home/dimon/mydata/projects/go/src/dmitryfrank.com/testfiles/main.go:16 +0x81\n==================\nFound 1 data race(s)\nexit status 66\n</code></pre>\n\n<p>Ok, but how to handle that properly? Of course, we can't just lock some mutex before calling <code>f.Read()</code>, because the mutex will end up locked basically all the time. To make it work properly, we'd need some sort of cooperation between reading and locking, like conditional variables do: the mutex gets unlocked before putting the goroutine to wait, and it's locked back when the goroutine wakes up.</p>\n\n<p>I would implement something like this manually, but then I need some way to <code>select</code> things while reading. Like this: (<strong>pseudocode</strong>)</p>\n\n<pre><code>select {\ncase b := &lt;-f.NextByte():\n  // process the byte somehow\ndefault:\n}\n</code></pre>\n\n<p>I examined docs of the packages <a href=\"https://golang.org/pkg/os/\" rel=\"nofollow noreferrer\">os</a> and <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\">sync</a>, and so far I don't see any way to do that.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1484695121, "post_id": 41708697, "comment_id": 70612977, "body": "This has nothing to do with &quot;shadowing&quot;. You are assigning a value to <code>err</code>, but never accessing it."}, {"owner": {"reputation": 1467, "user_id": 1005866, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b2efb2cc52b0c41088f7ff2c9b590d72?s=128&d=identicon&r=PG", "display_name": "Jimmy Zoto", "link": "https://stackoverflow.com/users/1005866/jimmy-zoto"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1484695619, "post_id": 41708697, "comment_id": 70613145, "body": "Facepalm. The compiler generates the error for the line where it&#39;s declared instead of where it&#39;s assigned, so I focused there. In the real code, there&#39;s a shadowed err var that further masks the error. Thanks...."}], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 3, "last_activity_date": 1484696687, "last_edit_date": 1484696687, "creation_date": 1484695853, "answer_id": 41708895, "question_id": 41708697, "link": "https://stackoverflow.com/questions/41708697/variable-shadowing-in-go/41708895#41708895", "title": "Variable shadowing in Go", "body": "<p>This is not because of any shadowing. You have not used <code>err</code> variable that is  declared for anything but assigning a value to it .</p>\n\n<p>according to FAQ</p>\n\n<blockquote>\n  <p>The presence of an unused variable may indicate a bug, while unused\n  imports just slow down compilation. Accumulate enough unused imports\n  in your code tree and things can get very slow. For these reasons, Go\n  allows neither</p>\n</blockquote>\n\n<p>If you declare a variable it has to be used </p>\n\n<p>In the given program <code>err</code> is declared and is being used to assign data to .The value of <code>err</code> is not used at all</p>\n\n<p>You may bipass this kind of error by doing a _ assignment</p>\n\n<p>ie,</p>\n\n<pre><code>  var _ = err\n</code></pre>\n\n<p>or\n  using <code>err</code> like </p>\n\n<pre><code>  if err != nil {\n      fmt.Println(err.Error())\n      return\n  }\n</code></pre>\n\n<p>The following code would solve it,but i would suggest use the err for checking error</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var (\n        err error\n        dto = make(map[string]interface{})\n    )\n    _ = err\n\n    dto[`thing`], err = getThings()\n    fmt.Println(dto[`thing`])\n}\n\nfunc getThings() (string, error) {\n    return `the thing`, nil\n}\n</code></pre>\n\n<p><strong>PS :</strong> You must use variables you declare inside functions, but it's <strong>OK</strong> if you have unused global variables. It's also OK to have unused function arguments.</p>\n"}], "owner": {"reputation": 1467, "user_id": 1005866, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b2efb2cc52b0c41088f7ff2c9b590d72?s=128&d=identicon&r=PG", "display_name": "Jimmy Zoto", "link": "https://stackoverflow.com/users/1005866/jimmy-zoto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1632, "favorite_count": 2, "accepted_answer_id": 41708895, "answer_count": 1, "score": 1, "last_activity_date": 1484696687, "creation_date": 1484694736, "question_id": 41708697, "link": "https://stackoverflow.com/questions/41708697/variable-shadowing-in-go", "title": "Variable shadowing in Go", "body": "<p>The following code generates the compile error : \"err declared and not used\". If there is a scope/shadowing issue here, it's due to a principle I don't understand. Can someone explain?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var (\n        err error\n        dto = make(map[string]interface{})\n    )\n\n    dto[`thing`],err = getThings();\n    fmt.Println(dto[`thing`]);\n}\n\nfunc getThings() (string,error) {\n    return `the thing`,nil\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1454, "user_id": 786418, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b52ad7b6375c1bcfbde2e24bd7833e4?s=128&d=identicon&r=PG", "display_name": "lucaswxp", "link": "https://stackoverflow.com/users/786418/lucaswxp"}, "edited": false, "score": 0, "creation_date": 1484684762, "post_id": 41706279, "comment_id": 70608210, "body": "Ahh, that makes sense. Thanks :)"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1484684814, "post_id": 41706279, "comment_id": 70608232, "body": "Worth noting, this also applies if you ever try to take the address of objects using a for loop.  You must use an index loop, because the <code>for _, n := range o</code> form copies the object at each index into a single address location. <a href=\"https://play.golang.org/p/jkB85jgVKw\" rel=\"nofollow noreferrer\">play.golang.org/p/jkB85jgVKw</a>"}], "tags": [], "owner": {"reputation": 26092, "user_id": 824377, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e600bd229c588891a7616f303e30efd9?s=128&d=identicon&r=PG", "display_name": "AJcodez", "link": "https://stackoverflow.com/users/824377/ajcodez"}, "is_accepted": true, "score": 8, "last_activity_date": 1484685240, "last_edit_date": 1495542837, "creation_date": 1484684640, "answer_id": 41706279, "question_id": 41706212, "link": "https://stackoverflow.com/questions/41706212/impossible-to-modify-struct-inside-array/41706279#41706279", "title": "Impossible to modify struct inside array?", "body": "<p>Structs are copied in range loops. You need to access by index.</p>\n\n<pre><code>for i := range nodes {\n    nodes[i].Resources = append(nodes[i].Resources, ResourceUsage{Type: \"test\"})\n}\n</code></pre>\n\n<p>You could also choose to use pointers, which would not copy data.</p>\n\n<pre><code>nodes := make([]*Node, 2)\nnodes[0] = &amp;Node{}\nnodes[1] = &amp;Node{}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/users/4551301/kaedys\">@Kaedys</a> points out, you can't take the address of the iterated value.</p>\n\n<pre><code>for _, v := range nodes {\n    &amp;v // mistake\n}\n</code></pre>\n"}], "owner": {"reputation": 1454, "user_id": 786418, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b52ad7b6375c1bcfbde2e24bd7833e4?s=128&d=identicon&r=PG", "display_name": "lucaswxp", "link": "https://stackoverflow.com/users/786418/lucaswxp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 41706279, "answer_count": 1, "score": 1, "last_activity_date": 1484685240, "creation_date": 1484684386, "question_id": 41706212, "link": "https://stackoverflow.com/questions/41706212/impossible-to-modify-struct-inside-array", "title": "Impossible to modify struct inside array?", "body": "<p>I'm just starting to learn golang and I have the following code:</p>\n\n<p><a href=\"https://play.golang.org/p/OBsf9MRLD8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OBsf9MRLD8</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"os\"\n)\n\ntype ResourceUsage struct {\n    Type string\n}\ntype Node struct {\n    Resources []ResourceUsage\n}\n\nfunc main(){\n    encoder := json.NewEncoder(os.Stdout)\n    nodes := make([]Node, 2)\n    nodes[0] = Node{}\n    nodes[1] = Node{}\n\n    for _,n := range nodes {\n        n.Resources = append(n.Resources, ResourceUsage{Type: \"test\"})\n    }\n    encoder.Encode(nodes)\n}\n</code></pre>\n\n<p>I was hoping it to print</p>\n\n<pre><code>[{\"Resources\":[{\"Type:\"test\"}]},{\"Resources\":[{\"Type:\"test\"}]}]\n</code></pre>\n\n<p>But instead I get:</p>\n\n<pre><code>[{\"Resources\":null},{\"Resources\":null}]\n</code></pre>\n\n<p>How can I accomplish the expected output?</p>\n"}, {"tags": ["image", "image-processing", "go", "color-palette"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484684083, "post_id": 41705828, "comment_id": 70607877, "body": "You choose the palette for your image. You can only have 256 colors, so you need to choose the ones that best fit your image. If you&#39;re not sure, you can start with <code>pallet.WebSafe</code>"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 1, "creation_date": 1484684266, "post_id": 41705828, "comment_id": 70607971, "body": "take a look at related QA <a href=\"http://stackoverflow.com/a/41283985/2521214\">Images lose quality after saving as GIF</a> and all the linked suff in that answer too ..."}, {"owner": {"reputation": 1053, "user_id": 4573388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/96d071c19a97ba184cbf5e4a75ae014b?s=128&d=identicon&r=PG&f=1", "display_name": "Fractale", "link": "https://stackoverflow.com/users/4573388/fractale"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484685005, "post_id": 41705828, "comment_id": 70608324, "body": "thank @JimB it works!!! :D but the picture is ugly compare to png :/ I have test palette.Plan9 for better result but does it have over more precise palette?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484685574, "post_id": 41705828, "comment_id": 70608607, "body": "@Fractale: there&#39;s no such things as a &quot;more precise palette&quot;, because you can only have 256 colors. You can dither the image with the palette you have, calculate a palette that more closely resembles your image, or a combination of both."}, {"owner": {"reputation": 1053, "user_id": 4573388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/96d071c19a97ba184cbf5e4a75ae014b?s=128&d=identicon&r=PG&f=1", "display_name": "Fractale", "link": "https://stackoverflow.com/users/4573388/fractale"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484686409, "post_id": 41705828, "comment_id": 70609042, "body": "Thanks @JimB, if I have an image.NRGBA vector how can I compute the best palette for my gif?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484691776, "post_id": 41705828, "comment_id": 70611692, "body": "@Fractale: you haven&#39;t shown any examples of what you&#39;re doing, so you&#39;re probably using the built-in FloydSteinberg Drawer for dithering. As for <a href=\"https://en.wikipedia.org/wiki/Color_quantization\" rel=\"nofollow noreferrer\">color quantization</a>, a <a href=\"https://en.wikipedia.org/wiki/Median_cut\" rel=\"nofollow noreferrer\">median-cut</a> algorithm is commonly used."}, {"owner": {"reputation": 1053, "user_id": 4573388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/96d071c19a97ba184cbf5e4a75ae014b?s=128&d=identicon&r=PG&f=1", "display_name": "Fractale", "link": "https://stackoverflow.com/users/4573388/fractale"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484692332, "post_id": 41705828, "comment_id": 70611913, "body": "Thanks @JimB, I do  a raytracer so I have a image.NRGBA vector at the end, now I want to create a gif with a good palette. So how to get a good palette from a image.NRGBA? :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484756903, "post_id": 41705828, "comment_id": 70643712, "body": "I already linked to explanations of color quantization and the Heckbert median-cut algorithm. A quick search of godoc shows an implementation <a href=\"https://godoc.org/github.com/soniakeys/quant/median\" rel=\"nofollow noreferrer\">here</a> if you want to try that."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1484813117, "post_id": 41705828, "comment_id": 70666668, "body": "In my link is the info too btw the standard VGA palette is already optimized for dithering so you either need to enable dithering in your framework/lib or whatever or do it your self in case you cant...  As you doing ray-tracer I bet you want to save output in real time. Good quantization takes time so I would go for dithering which is much much faster."}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 1, "last_activity_date": 1538765759, "creation_date": 1538765759, "answer_id": 52671768, "question_id": 41705828, "link": "https://stackoverflow.com/questions/41705828/animated-gif-in-golang-creation-of-image-paletted/52671768#52671768", "title": "animated gif in golang - creation of *image.Paletted", "body": "<p>The standard library has a own package for that: <a href=\"https://golang.org/pkg/image/color/palette/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/image/color/palette/</a></p>\n\n<p>At the moment there are two predefined palettes availiable: Plan9 and WebSafe</p>\n\n<p>You can use the package like that:</p>\n\n<pre><code>frame := image.NewPaletted(\n    image.Rect(0, 0, 100, 200),\n    palette.WebSafe,\n)\n</code></pre>\n"}], "owner": {"reputation": 1053, "user_id": 4573388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/96d071c19a97ba184cbf5e4a75ae014b?s=128&d=identicon&r=PG&f=1", "display_name": "Fractale", "link": "https://stackoverflow.com/users/4573388/fractale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "accepted_answer_id": 52671768, "answer_count": 1, "score": 1, "last_activity_date": 1538765759, "creation_date": 1484682959, "last_edit_date": 1484692751, "question_id": 41705828, "link": "https://stackoverflow.com/questions/41705828/animated-gif-in-golang-creation-of-image-paletted", "title": "animated gif in golang - creation of *image.Paletted", "body": "<p>I want to create an animated gif with go.</p>\n\n<p>I need for that to compute multiple *image.Paletted.</p>\n\n<p>But when I want to create it, I need p color.Palette but I don't know how to get the palette</p>\n\n<p>How can I have the Palette?</p>\n"}, {"tags": ["mysql", "go", "foreign-keys", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 723, "user_id": 2423216, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bwCkf.png?s=128&g=1", "display_name": "Alvaro Denis Acosta", "link": "https://stackoverflow.com/users/2423216/alvaro-denis-acosta"}, "is_accepted": false, "score": 1, "last_activity_date": 1490048504, "creation_date": 1490048504, "answer_id": 42915025, "question_id": 41705659, "link": "https://stackoverflow.com/questions/41705659/golang-gorm-how-i-can-use-sql-nullint64-to-be-int10-in-mysql/42915025#42915025", "title": "golang -&gt; gorm: How I can use sql.NullInt64 to be int(10) in mysql?", "body": "<p>The \"magic\" on <code>gorm.Model</code> is only the name of the fields, any <code>struct</code> with these fields look like this according to the gorm documentation, at the end of <a href=\"http://jinzhu.me/gorm/models.html#conventions\" rel=\"nofollow noreferrer\">Conventions</a></p>\n\n<p>For example: Save records having <code>UpdatedAt</code> field will set it to current time.</p>\n\n<p>Or</p>\n\n<p>Delete records having <code>DeletedAt</code> field, it won't be deleted from database, but only set field <code>DeletedAt</code>'s value to current time, and the record is not findable when querying, refer <a href=\"http://jinzhu.me/gorm/crud.html#delete\" rel=\"nofollow noreferrer\">Soft Delete</a></p>\n\n<p>So solve the issue is very easy, this is the code for my case:</p>\n\n<pre><code>package models\n\nimport \"time\"\n\ntype Model struct {\n    ID        uint `gorm:\"primary_key;type:bigint(20) not null auto_increment\"`\n    CreatedAt time.Time\n    UpdatedAt time.Time\n    DeletedAt *time.Time `sql:\"index\"`\n}\n</code></pre>\n\n<p>So, now I only need use it as base model :)</p>\n"}], "owner": {"reputation": 723, "user_id": 2423216, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bwCkf.png?s=128&g=1", "display_name": "Alvaro Denis Acosta", "link": "https://stackoverflow.com/users/2423216/alvaro-denis-acosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1192, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1490048504, "creation_date": 1484682307, "last_edit_date": 1495542329, "question_id": 41705659, "link": "https://stackoverflow.com/questions/41705659/golang-gorm-how-i-can-use-sql-nullint64-to-be-int10-in-mysql", "title": "golang -&gt; gorm: How I can use sql.NullInt64 to be int(10) in mysql?", "body": "<pre><code>type Contact struct {\n  gorm.Model\n  PersonID sql.NullInt64\n}\n\ntype Person struct {\n  gorm.Model\n}\n</code></pre>\n\n<p>I am trying to use <a href=\"http://jinzhu.me/gorm/\" rel=\"nofollow noreferrer\">gorm</a> with mysql in the previuos code but I have the following problem:</p>\n\n<p>I want:</p>\n\n<ul>\n<li>Use <code>sql.NullInt64</code> to work easily with null values.</li>\n<li>Use the base model definition <code>gorm.Model</code>, including fields <code>ID</code>, <code>CreatedAt</code>, <code>UpdatedAt</code>, <code>DeletedAt</code>.</li>\n<li>Add a constraint <code>Db.Model(&amp;models.Contact{}).AddForeignKey</code>.</li>\n</ul>\n\n<p>My problem:</p>\n\n<ul>\n<li><code>Person.ID</code> become <code>\"int(10)\"</code> in mysql.</li>\n<li><code>Contact.PersonID</code> become <code>\"bigint(20)\"</code></li>\n<li>MySql need the same type for <a href=\"https://stackoverflow.com/questions/16969060/mysql-error-1215-cannot-add-foreign-key-constraint/16969176#16969176\">pk and fk</a>.</li>\n</ul>\n\n<p>Some body can help me to solve this?</p>\n"}, {"tags": ["go", "process", "quadratic"], "comments": [{"owner": {"reputation": 109, "user_id": 4380753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OAb61.jpg?s=128&g=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/4380753/omar"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1484681102, "post_id": 41705138, "comment_id": 70606290, "body": "@KenWhite, I am pretty sure what quadratic means. But in this example, and in programming in general, what does quadratic process mean? And how does it affect performance? If you have a link to that, I would appreciate it. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4380753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OAb61.jpg?s=128&g=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/4380753/omar"}, "edited": false, "score": 0, "creation_date": 1484683122, "post_id": 41705579, "comment_id": 70607358, "body": "Thanks @jussius. I understand now! And this is exactly what is discussed later in the book. And the cost here is memory-wise I assume?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484687348, "post_id": 41705579, "comment_id": 70609563, "body": "More or less.  Lets say you were appending &quot;Hello&quot; and &quot;World&quot; using `s = &quot;Hello&quot; + &quot;World&quot;.  You would create a new rune array 10 runes in length, then copy &quot;Hello&quot; into the first half, and &quot;World&quot; into the second.  Fairly easy."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1484687376, "post_id": 41705579, "comment_id": 70609577, "body": "However, if you expand this to say concatenating &quot;H&quot;, &quot;e&quot;, &quot;l&quot;, &quot;l&quot;, &quot;o&quot;, &quot;W&quot;, &quot;o&quot;, &quot;r&quot;, &quot;l&quot;, and &quot;d&quot;, and you were still using the <code>+</code> (or <code>+=</code>) operator, now we have an issue.  You start with <code>&quot;H&quot; + &quot;e&quot;</code>, make a new array of length 2, copy in &quot;H&quot; and &quot;e&quot;.  Now you have <code>&quot;He&quot; + &quot;l&quot;</code>.  New array of length 3, copy in &quot;He&quot; and then &quot;l&quot;.  Repeat until you&#39;re out of strings.  You&#39;re creating a new array each time, because strings are immutable, so concatenation has to make a new string, and thus a new underlying array. This means a LOT of allocation and copying, especially for the earlier strings."}, {"owner": {"reputation": 109, "user_id": 4380753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OAb61.jpg?s=128&g=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/4380753/omar"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484688171, "post_id": 41705579, "comment_id": 70609999, "body": "Thanks @Kaedys, that&#39;s what I understood from the answer above. But your example &quot;Hello&quot; + &quot;World&quot; example was much required!"}, {"owner": {"reputation": 1583, "user_id": 1301428, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9bd29eb02b5aef24baebc9db4b588b6d?s=128&d=identicon&r=PG", "display_name": "user1301428", "link": "https://stackoverflow.com/users/1301428/user1301428"}, "edited": false, "score": 0, "creation_date": 1546454867, "post_id": 41705579, "comment_id": 94859865, "body": "So, in BigO terms, the for loop is O(N) and, because string concatenation requires a new string to be created every time the loop runs (and because array creation also has O(N) complexity), therefore the program has O(N^2) complexity?"}, {"owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "reply_to_user": {"reputation": 1583, "user_id": 1301428, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9bd29eb02b5aef24baebc9db4b588b6d?s=128&d=identicon&r=PG", "display_name": "user1301428", "link": "https://stackoverflow.com/users/1301428/user1301428"}, "edited": false, "score": 0, "creation_date": 1547200467, "post_id": 41705579, "comment_id": 95119242, "body": "@user1301428 Well, you could say that the whole program is just a single for loop, so the loop (i.e. the program) has O(n^2) complexity. Easy way to think of it is that if you double the number of arguments, it means you have to create twice as many strings, but it also means the average length of the strings you&#39;re creating is twice as long (and thus, twice as costly). So in total you have to do 4 times as much work."}, {"owner": {"reputation": 1583, "user_id": 1301428, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/9bd29eb02b5aef24baebc9db4b588b6d?s=128&d=identicon&r=PG", "display_name": "user1301428", "link": "https://stackoverflow.com/users/1301428/user1301428"}, "edited": false, "score": 0, "creation_date": 1547204196, "post_id": 41705579, "comment_id": 95121403, "body": "@jussius A loop doesn\u2019t have O(n^2) complexity just because it\u2019s a loop though :P it could just contains instructions that are O(1), making its complexity O(N)"}], "tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 7, "last_activity_date": 1484735323, "last_edit_date": 1484735323, "creation_date": 1484682028, "answer_id": 41705579, "question_id": 41705138, "link": "https://stackoverflow.com/questions/41705138/what-is-a-quadratic-process/41705579#41705579", "title": "What is a quadratic process?", "body": "<p>Generally speaking quadratic means something that pertains to squared numbers. In this context it means that the cost of the process is proportional to the square of the input size. This is because strings are concatenated using <code>+=</code> operator which is expensive in Go as strings are immutable and a new string must be created in memory every time you concatenate. More efficient ways to concatenate strings include writing to <code>bytes.Buffer</code> and converting it to string, or using <code>strings.Join</code> function</p>\n"}], "owner": {"reputation": 109, "user_id": 4380753, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OAb61.jpg?s=128&g=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/4380753/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 1, "accepted_answer_id": 41705579, "answer_count": 1, "score": 7, "last_activity_date": 1484735323, "creation_date": 1484680355, "question_id": 41705138, "link": "https://stackoverflow.com/questions/41705138/what-is-a-quadratic-process", "title": "What is a quadratic process?", "body": "<p>I was reading the Go programming language book (by Donovan and Kernighan) and about their example <a href=\"https://github.com/adonovan/gopl.io/blob/master/ch1/echo1/main.go\" rel=\"noreferrer\">echo1</a>, they said: \"<em>This is a quadratic process that could be costly if the number of arguments is large, but for echo, that's unlikely</em>\". What does quadratic process mean?, and how is it costly if the number of arguments is large?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "nsq", "go-nsq"], "comments": [{"owner": {"reputation": 7660, "user_id": 2350684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuQa5.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/2350684/oliver"}, "edited": false, "score": 0, "creation_date": 1484761947, "post_id": 41704986, "comment_id": 70646891, "body": "What&#39;s the <code>maxInFlight</code> set to?"}, {"owner": {"reputation": 7660, "user_id": 2350684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuQa5.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/2350684/oliver"}, "edited": false, "score": 0, "creation_date": 1484762020, "post_id": 41704986, "comment_id": 70646930, "body": "Also, be aware that if you&#39;re exposing the IP of your <code>nsqd</code> host and it&#39;s open to the public, then anyone can connect to it and e.g. delete topics and channels."}, {"owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "reply_to_user": {"reputation": 7660, "user_id": 2350684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuQa5.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/2350684/oliver"}, "edited": false, "score": 0, "creation_date": 1484784514, "post_id": 41704986, "comment_id": 70657599, "body": "@Oliver where should I set maxinflight? I tried setting it in server side using <code>config.Set</code> w/ value of 10000.. thank you. Yeah I forgot to delete the IP, thank you for the edit"}, {"owner": {"reputation": 7660, "user_id": 2350684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuQa5.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/2350684/oliver"}, "edited": false, "score": 0, "creation_date": 1484795770, "post_id": 41704986, "comment_id": 70660504, "body": "Try setting it to <code>1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "edited": false, "score": 0, "creation_date": 1484845448, "post_id": 41743673, "comment_id": 70687824, "body": "thank you for the explanation. I have tried connecting directly to nsqds as I am planning to deploy it to k8s, i can just use services instead of <code>nslookupd</code>. for development purposes, on a 4core 32gb ram,  both client and server <code>maxInFlight</code> set to more than 10k and has 1 nsqd as example. the delay improved a bit, but not as quick as realtime.. I will update my post.."}, {"owner": {"reputation": 506, "user_id": 2807852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b9d6ade43924cd5f03955d68501c44?s=128&d=identicon&r=PG", "display_name": "Pierce", "link": "https://stackoverflow.com/users/2807852/pierce"}, "edited": false, "score": 0, "creation_date": 1485344426, "post_id": 41743673, "comment_id": 70885197, "body": "As an addendum: you really don&#39;t want to create a topic (or channel) for &quot;each import&quot; - you want a mostly static set of topics and channels. If a consumer is already connected to a topic/channel on an nsqd, it will receive new messages very quickly.  Try using a single topic/channel for all of these messages e.g. topic=&quot;import_progress&quot;. A consumer can filter out messages it is not interested in reasonably efficiently."}], "tags": [], "owner": {"reputation": 41, "user_id": 1162632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ef5a905c7d18d1bfc173db591737b0?s=128&d=identicon&r=PG", "display_name": "boxcarr", "link": "https://stackoverflow.com/users/1162632/boxcarr"}, "is_accepted": false, "score": 4, "last_activity_date": 1484834562, "last_edit_date": 1592644375, "creation_date": 1484834562, "answer_id": 41743673, "question_id": 41704986, "link": "https://stackoverflow.com/questions/41704986/nsqjs-clients-not-receiving-messages-immediately-from-go-nsq-server-side/41743673#41743673", "title": "nsqjs clients, not receiving messages immediately from go-nsq server side", "body": "<p>There are a couple of reasons why a nsqjs client will be slow to receive a message just published:</p>\n<ol>\n<li><p>If the topic is new and the discovery of topics is via <code>nsqlookupd</code>, then by default, the nsqjs Reader will attempt to discover new topics every 30 seconds.</p>\n<p>From the example above, it looks like you are creating new topics for every import. I believe that if you start publishing messages first from the Golang client and then start the nsqjs client, then you shouldn't see the delay.</p>\n</li>\n<li><p>If you have multiple nsqds with a <code>max-in-flight</code> set too low, then it puts the nsqjs <code>Reader</code> in a starvation mode where it moves the <code>RDY</code> count between nsqds for a set period of time.</p>\n<p>I'm not sure that's what's going on here since I can't tell anything about the nsq topology. As long as your max-in-flight is set higher than the number of <code>nsqd</code> instances that you have, then you'll be in good shape.</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1484845726, "creation_date": 1484679823, "last_edit_date": 1484845726, "question_id": 41704986, "link": "https://stackoverflow.com/questions/41704986/nsqjs-clients-not-receiving-messages-immediately-from-go-nsq-server-side", "title": "nsqjs clients, not receiving messages immediately from go-nsq server side", "body": "<p>trying to learn nsq, and following the examples from <a href=\"http://tleyden.github.io/blog/2014/11/12/an-example-of-using-nsq-from-go/\" rel=\"nofollow noreferrer\">here golang example</a> and <a href=\"https://github.com/dudleycarr/nsqjs\" rel=\"nofollow noreferrer\">here nsqjs</a>. I am sending messages in server side doing w/ a for loop and go routines</p>\n\n<pre><code>var wg sync.WaitGroup\nfor i := 0; i &lt; 100; i++ {\n    wg.Add(1)\n    go func(x int) {\n        defer wg.Done()\n\n        chanName := fmt.Sprintf(\"import_progress_587e6442ff74889098498f6e\")\n        m := map[string]interface{}{\n            \"body\": map[string]interface{}{\n                \"progress\": x,\n            },\n        }\n        msg, _ := json.Marshal(m)\n\n        req := NSQPubReq{\n            Topic: chanName,\n            Body:  msg,\n        }\n        if err := producer.Publish(req.Topic, req.Body); err != nil {\n        }\n        utils.Info(fmt.Sprintf(\"sent msg=%v\", string(msg)))\n\n    }(i)\n}\n\nwg.Wait()\n</code></pre>\n\n<p>but the problem is, on the clientside. </p>\n\n<pre><code>// channel = 'import_progress_587e6442ff74889098498f6e'\nlet reader = new nsq.Reader(channel, channel, {\n    //lookupdHTTPAddresses: '&lt;&lt;IP&gt;&gt;:4161',\n    maxInFlight: 10000,\n    snappy: true\n})\nreader.connect()\n\nreader.on('message', (msg) =&gt; {\n    var msgData = {\n            id:     msg.id,\n            body:   msg.body.toString(),\n            chan:   channel\n    }\n    io.emit(channel, msgData)\n    msg.finish()\n})\n</code></pre>\n\n<p>the message don't come up immediately to the client. i will wait for a couple of seconds until the message come to the nodejs client. is there any settings that I need to do? thank you!</p>\n"}, {"tags": ["windows", "go", "uac"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1484676974, "post_id": 41704057, "comment_id": 70604039, "body": "Don&#39;t you have an external manifest file at the same directory your program is located in? And what&#39;s the offending name (if not secret)?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1484723491, "post_id": 41704057, "comment_id": 70621501, "body": "<a href=\"https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/9ff819d4-f31f-4f7f-a523-da87007bb254/external-manifest-file-doesnt-invoke-uac-prompt?forum=windowscompatibility\" rel=\"nofollow noreferrer\">This thread</a> might give you a set of ideas to try out (external manifest and its indexing / cacheing issues)."}, {"owner": {"reputation": 223, "user_id": 3552752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d0f06e96cdb086ca131e70e5a3de5b?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/3552752/alan"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1484766871, "post_id": 41704057, "comment_id": 70649622, "body": "Thanks for the reply Kostix. Eventually discovered it was a Windows thing <a href=\"http://stackoverflow.com/a/41727595/3552752\">stackoverflow.com/a/41727595/3552752</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1484798924, "post_id": 41704057, "comment_id": 70661305, "body": "good to know! Consider accepting your own answer \u2014 that&#39;s perfectly OK"}], "answers": [{"tags": [], "owner": {"reputation": 223, "user_id": 3552752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d0f06e96cdb086ca131e70e5a3de5b?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/3552752/alan"}, "is_accepted": true, "score": 4, "last_activity_date": 1484766816, "creation_date": 1484766816, "answer_id": 41727595, "question_id": 41704057, "link": "https://stackoverflow.com/questions/41704057/32-bit-go-binary-requires-privilege-escalation-64-bit-does-not/41727595#41727595", "title": "32 bit Go Binary requires privilege escalation, 64 bit does not", "body": "<p>Turns out Windows automatically requires elevated privileges for apps depending on file name. It checks file names to see if there an installer, so files with names such as \"Setup\" or \"Update\" will be required to have elevated privledges on a 32 bit application.</p>\n"}], "owner": {"reputation": 223, "user_id": 3552752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d0f06e96cdb086ca131e70e5a3de5b?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/3552752/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 41727595, "answer_count": 1, "score": 1, "last_activity_date": 1484766816, "creation_date": 1484676449, "question_id": 41704057, "link": "https://stackoverflow.com/questions/41704057/32-bit-go-binary-requires-privilege-escalation-64-bit-does-not", "title": "32 bit Go Binary requires privilege escalation, 64 bit does not", "body": "<p>Using GoLang 1.7.4, I was building a binary for my application with the target being windows/amd64, This binary built fine and when ran, did not cause a UAC prompt to appear for privilege escalation. </p>\n\n<p>I switched to building the binary for windows/386, however when the binary is built it now requires privilege escalation, to make it even stranger, if I build the binary for windows/386 using a different name, it does not require escalated privileges to run, however as soon as I rename the binary to the name it is usually built as ( rename is done in Windows Explorer) , it suddenly requires escalated privileges again.</p>\n\n<p>All this was being done on a Windows 10 64 bit machine, any ideas to what exactly is going on?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "edited": false, "score": 3, "creation_date": 1484671301, "post_id": 41702246, "comment_id": 70600785, "body": "Different operating systems have differences in their Application Binary Interfaces, it is not possible."}, {"owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "edited": false, "score": 0, "creation_date": 1484671317, "post_id": 41702246, "comment_id": 70600800, "body": "I don&#39;t think it&#39;s possible to have multiplatform binaries in general. Does not matter if they are created by the go compiler or anything else."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1484671804, "post_id": 41702246, "comment_id": 70601152, "body": "You first have to modify all operating systems to support each others&#39; binaries, or modify all to support a universal binary format and modify the Go tools to support this universal format. In other words, it&#39;s not possible."}, {"owner": {"reputation": 96, "user_id": 1116295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dc7d254af9648054dd03211d16a5c3e?s=128&d=identicon&r=PG", "display_name": "exavolt", "link": "https://stackoverflow.com/users/1116295/exavolt"}, "edited": false, "score": 0, "creation_date": 1484676867, "post_id": 41702246, "comment_id": 70603978, "body": "Why would you even want that? Have you ever seen binary distribution of <i>any</i> software which uses a single universal package for all platforms? I think the main problem is the entry point which varies between OSes."}, {"owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "edited": false, "score": 0, "creation_date": 1484682572, "post_id": 41702246, "comment_id": 70607040, "body": "I want to provide the program to the customers of the software to run on their machine. They might have different platforms. Thats was why i was looking for a common file. I know how to cross compile them and make a source for each system"}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1484677260, "post_id": 41702641, "comment_id": 70604235, "body": "If course, it <i>is</i> possible using a multitude of programming languages: they just have to be interpreted (Python, Perl etc) or compile down to some intermediate format (Java, C# etc). Of course,this entails having an interpreter/runtime on each target platform, and the libraries used must be cross-platform as well, which is a problem in itself."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1484692882, "post_id": 41702641, "comment_id": 70612105, "body": "@kostix: I wouldn&#39;t really call it a &quot;cross-platform binary&quot; if it&#39;s something that needs to be run/interpreted by a &quot;platform-specific binary&quot;."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484726669, "post_id": 41702641, "comment_id": 70622992, "body": "@JimB, well my train of thought was like this: the OP clearly lacks low-level knowledge about what are different executable file formats / OS ABIs; I felt like the answer was a bit moot on stressing this very point, so I felt like chiming in and clearing this up a bit for the OP. So yes, you&#39;re techincally correct; may be I&#39;d just like the answer to be a bit wordy on the details. ;-)"}, {"owner": {"reputation": 2384, "user_id": 102315, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c8b935f2e5d916f361ffe33fe94a3d10?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/102315/alper"}, "edited": false, "score": 0, "creation_date": 1559239908, "post_id": 41702641, "comment_id": 99367253, "body": "Sure I get this, but maybe a way to cross compile for all platforms and then have some kind of loader that executes the right binary for the platform. Didn&#39;t macOS do something like this for a while?"}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 2, "last_activity_date": 1556747270, "last_edit_date": 1592644375, "creation_date": 1484671826, "answer_id": 41702641, "question_id": 41702246, "link": "https://stackoverflow.com/questions/41702246/go-binary-file-for-all-platform/41702641#41702641", "title": "Go binary file for all platform", "body": "<p><strong>No</strong>, it is not at all possible in Go or any other programming language (the <strong>executable</strong> is necessarily tailored to individual platforms and architectures).</p>\n<p>However, to <strong>cross-compile</strong>, some <a href=\"https://github.com/mitchellh/gox\" rel=\"nofollow noreferrer\">tools</a> do exist which do the cross compiling for you.</p>\n<p>This <a href=\"https://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5\" rel=\"nofollow noreferrer\">post</a> helps explain how to cross compile with Golang (which is pretty easy at this point).</p>\n<hr />\n<p>There's also a Unix StackExchange question, <a href=\"https://unix.stackexchange.com/a/298283/177527\">https://unix.stackexchange.com/a/298283/177527</a>, which explains <em>why</em> different architectures require different binaries:</p>\n<blockquote>\n<p>The reason is because the code is compiled to machine code for a specific architecture, and machine code is very different between most processor families (ARM and x86 for instance are very different).</p>\n</blockquote>\n<p>The binary <em>also</em> depends on the OS, as explained here <a href=\"https://softwareengineering.stackexchange.com/a/251255\">https://softwareengineering.stackexchange.com/a/251255</a>:</p>\n<blockquote>\n<p><strong>Binary Format</strong>: The executable has to conform to a certain binary format, which allows the operating system to correctly load, initialize, and start the program. Windows mainly uses the Portable Executable format, while Linux uses ELF.</p>\n<p><strong>System APIs</strong>: The program may be using libraries, which have to be present on the executing system. If a program uses functions from Windows APIs, it can't be run on Linux. In the Unix world, the central operating system APIs have been standardized to POSIX: a program using only the POSIX functions will be able to run on any conformant Unix system, such as Mac OS X and Solaris.</p>\n</blockquote>\n"}], "owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4239, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1556747270, "creation_date": 1484670673, "question_id": 41702246, "link": "https://stackoverflow.com/questions/41702246/go-binary-file-for-all-platform", "title": "Go binary file for all platform", "body": "<p>I have a .go file and produced the binary file using go build command from Mac. Is there a way to build a binary file which runs in windows,linux,IOS ?</p>\n\n<p>I am aware we can build binary file for each of them by changing the GOOS,GOARCH params but i would like to have a single go binary file which should run in all the platforms . Please help me out of this.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1484670288, "post_id": 41702035, "comment_id": 70600142, "body": "I don&#39;t think there is an idiomatic way. I&#39;d prefer #3 if I can, simply because it&#39;s shorter."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1484690502, "post_id": 41702035, "comment_id": 70611148, "body": "You forgot the most verbose declaration <code>var a string = &quot;&quot;</code>, I stick with #3 when possible."}], "answers": [{"tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 1, "last_activity_date": 1484672501, "last_edit_date": 1484672501, "creation_date": 1484671405, "answer_id": 41702504, "question_id": 41702035, "link": "https://stackoverflow.com/questions/41702035/idiomatic-way-to-initialise-an-empty-string-in-go/41702504#41702504", "title": "Idiomatic way to initialise an empty string in Go", "body": "<p>There isn't a <em>right</em> way to declare empty variables, but there are some things to keep in mind, like you can't use the <code>:=</code> shortcut outside of a function body, as they can with <code>var</code>:</p>\n\n<pre><code>var (\n    name string\n    age  int64\n)\n</code></pre>\n\n<p>I find <code>var name = \"\"</code> to be the <em>clearest</em> indication that you're declaring an empty variable, but I like the <strong>type</strong> explicitness of <code>var name string</code>. In any case, do consider <strong>where</strong> you are declaring variables. Sometimes all at once outside the function body is appropriate, but often <strong>nearest to where you actually use it</strong> is best.</p>\n\n<p>rob (Pike?) wrote on a <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/OqYL9lgsPQ4/udp0nPHPZTgJ\" rel=\"nofollow noreferrer\">mailthread</a> about <strong>top-level</strong> declaration </p>\n\n<blockquote>\n  <p>At the top level, var (or const or type or func) is necessary: each item must be introduced by a keyword for ur-syntactic reasons related to recognizing statement boundaries.  With the later changes involving semicolons, it became possible, I believe, to eliminate the need for var in some cases, but since const, type, and func must remain, it's not a compelling argument.</p>\n</blockquote>\n\n<p>There is a certain ambiguity in \"short-variable\" declarations (using <code>:=</code>), as to whether the variable is <strong>declared</strong> or <strong>redeclared</strong> as outlined in the <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">specs</a>:</p>\n\n<blockquote>\n  <p>Unlike regular variable declarations, a short variable declaration may redeclare variables provided they were originally declared earlier in the same block (or the parameter lists if the block is the function body) with the same type, and at least one of the non-blank variables is new. As a consequence, redeclaration can only appear in a multi-variable short declaration. Redeclaration does not introduce a new variable; it just assigns a new value to the original.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1484671437, "creation_date": 1484671437, "answer_id": 41702516, "question_id": 41702035, "link": "https://stackoverflow.com/questions/41702035/idiomatic-way-to-initialise-an-empty-string-in-go/41702516#41702516", "title": "Idiomatic way to initialise an empty string in Go", "body": "<p>There is absolutely no difference in the generated code (with the current compiler \u2013 Go 1.7.4), and also <code>gometalinter</code> does not complain for any of those. Use whichever you like.</p>\n\n<p>Some differences:</p>\n\n<ul>\n<li>You can only use the short variable declaration in functions.</li>\n<li><p>With short variable declaration, you can create variables of multiple types in one line, e.g.</p>\n\n<pre><code>a, b := \"\", 0\n</code></pre></li>\n</ul>\n\n<p>The following 3 apps generate identical code:</p>\n\n<p><code>a.go</code></p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main() { var a string; fmt.Println(a) }\n</code></pre>\n\n<p><code>b.go</code></p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main() { var a = \"\"; fmt.Println(a) }\n</code></pre>\n\n<p><code>c.go</code></p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main() { a := \"\"; fmt.Println(a) }\n</code></pre>\n\n<p>To verify, build each (e.g. with <code>go build -o a</code>), and use <code>diff</code> on Linux to compare the executable binaries:</p>\n\n<pre><code>diff a b &amp;&amp; diff a c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1484671633, "creation_date": 1484671633, "answer_id": 41702577, "question_id": 41702035, "link": "https://stackoverflow.com/questions/41702035/idiomatic-way-to-initialise-an-empty-string-in-go/41702577#41702577", "title": "Idiomatic way to initialise an empty string in Go", "body": "<pre><code>var a string\n</code></pre>\n\n<p>It's not immediately visible that it's the empty string for someone not really fluent in go. Some might expect it's some null/nil value.</p>\n\n<pre><code>var b = \"\"\n</code></pre>\n\n<p>Would be the most explicit, means everyone sees that it's a variable containing the empty string.</p>\n\n<pre><code>b := \"\"\n</code></pre>\n\n<p>The := assigment is so common in go that it would be the most readable in my opinion. Unless it's outside of a function body of course.</p>\n"}, {"tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": true, "score": 6, "last_activity_date": 1484671913, "creation_date": 1484671913, "answer_id": 41702668, "question_id": 41702035, "link": "https://stackoverflow.com/questions/41702035/idiomatic-way-to-initialise-an-empty-string-in-go/41702668#41702668", "title": "Idiomatic way to initialise an empty string in Go", "body": "<p>You should choose whichever makes the code clearer. If the zero value will actually be used (e.g. when you start with an empty string and concatenate others to it), it's probably clearest to use the <code>:=</code> form. If you are just declaring the variable, and will be assigning it a different value later, use <code>var</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 0, "last_activity_date": 1484691256, "creation_date": 1484691256, "answer_id": 41707961, "question_id": 41702035, "link": "https://stackoverflow.com/questions/41702035/idiomatic-way-to-initialise-an-empty-string-in-go/41707961#41707961", "title": "Idiomatic way to initialise an empty string in Go", "body": "<p>I try to stick to the short declaration for a couple of reasons.</p>\n\n<ol>\n<li>It's shorter</li>\n<li>Consistency</li>\n<li>Allocates memory for maps, slices and pointers to structs and types.</li>\n</ol>\n\n<p>Although <code>var a string</code> and <code>a := \"\"</code> are the same, <code>b := []T{}</code> and <code>var b []T</code> are not the same. When dealing with slices and maps the shorter declaration will not be nil. More often then not (especially with maps) I want allocated memory.</p>\n\n<p>There are few situations where <code>var</code> will be needed, for instance, you are calling a function that will populate a property of a type.</p>\n\n<pre><code>var err error\nfoo.Name, err = getFooName()\n</code></pre>\n\n<p>Using <code>:=</code> syntax in the above situation will error out since <code>foo.Name</code> is already declared.</p>\n"}], "owner": {"reputation": 43, "user_id": 4129860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d73ebc263571912ff03bd56853916d?s=128&d=identicon&r=PG&f=1", "display_name": "jamesroutley", "link": "https://stackoverflow.com/users/4129860/jamesroutley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11102, "favorite_count": 0, "accepted_answer_id": 41702668, "answer_count": 5, "score": 4, "last_activity_date": 1484691256, "creation_date": 1484669953, "question_id": 41702035, "link": "https://stackoverflow.com/questions/41702035/idiomatic-way-to-initialise-an-empty-string-in-go", "title": "Idiomatic way to initialise an empty string in Go", "body": "<p>In Go you can initialise an empty string (in a function) in the following ways:</p>\n\n<pre><code>var a string\nvar b = \"\"\nc := \"\"\n</code></pre>\n\n<p>As far as I know, each statement is semantically identical. Is one of them more idiomatic than the others?</p>\n"}, {"tags": ["sql", "go"], "comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484666464, "post_id": 41700380, "comment_id": 70597550, "body": "The first one is just fine, the second one is over engineered."}, {"owner": {"reputation": 3, "user_id": 5427067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0b21033de9b03f465b4e69367979780?s=128&d=identicon&r=PG&f=1", "display_name": "Hi\u1ebfu", "link": "https://stackoverflow.com/users/5427067/hi%e1%ba%bfu"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484667605, "post_id": 41700380, "comment_id": 70598329, "body": "The sql queries above are just representation. The actual queries are longer but the ideas about the CTEs are the same. Is it still over engineered then in that situation? Please check my edit"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5427067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0b21033de9b03f465b4e69367979780?s=128&d=identicon&r=PG&f=1", "display_name": "Hi\u1ebfu", "link": "https://stackoverflow.com/users/5427067/hi%e1%ba%bfu"}, "edited": false, "score": 0, "creation_date": 1484667961, "post_id": 41700516, "comment_id": 70598541, "body": "It is possible to create a view but is there any solution that doesn&#39;t require to involve any changes to the database?"}, {"owner": {"reputation": 550, "user_id": 1143604, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/fb0c214b93046700cbe9774197d3aeca?s=128&d=identicon&r=PG", "display_name": "Antonio Ciolino", "link": "https://stackoverflow.com/users/1143604/antonio-ciolino"}, "reply_to_user": {"reputation": 3, "user_id": 5427067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0b21033de9b03f465b4e69367979780?s=128&d=identicon&r=PG&f=1", "display_name": "Hi\u1ebfu", "link": "https://stackoverflow.com/users/5427067/hi%e1%ba%bfu"}, "edited": false, "score": 0, "creation_date": 1484670310, "post_id": 41700516, "comment_id": 70600161, "body": "If adding a view is considered a change...which I would not consider it that. I would say you CAN do it another way, but I would position that you should NOT.  You are really trying to solve two things here: Code Maintenance and Code Smell. The solution to both is s a single place for the code.  Also, making a concatenation procedure is a bad code smell because a single typo causes a cascade of issues that are hard to test  - whereas a centralized view would be easier to test, though the cascade data issue is still present. That makes the problem a tester issue and not a developer one."}], "tags": [], "owner": {"reputation": 550, "user_id": 1143604, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/fb0c214b93046700cbe9774197d3aeca?s=128&d=identicon&r=PG", "display_name": "Antonio Ciolino", "link": "https://stackoverflow.com/users/1143604/antonio-ciolino"}, "is_accepted": true, "score": 1, "last_activity_date": 1484665577, "creation_date": 1484665577, "answer_id": 41700516, "question_id": 41700380, "link": "https://stackoverflow.com/questions/41700380/should-i-separate-common-sql-query-or-cte-and-put-it-in-an-variable/41700516#41700516", "title": "Should I separate common SQL query or CTE and put it in an variable?", "body": "<p>in my experience the CTEs tended to get jumbled in each SP. Is it possible to leverage a view on the CTE instead n your use cases? That would clean up your documentation and code maintenance.</p>\n"}], "owner": {"reputation": 3, "user_id": 5427067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0b21033de9b03f465b4e69367979780?s=128&d=identicon&r=PG&f=1", "display_name": "Hi\u1ebfu", "link": "https://stackoverflow.com/users/5427067/hi%e1%ba%bfu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 41700516, "answer_count": 1, "score": 0, "last_activity_date": 1484667485, "creation_date": 1484665240, "last_edit_date": 1484667485, "question_id": 41700380, "link": "https://stackoverflow.com/questions/41700380/should-i-separate-common-sql-query-or-cte-and-put-it-in-an-variable", "title": "Should I separate common SQL query or CTE and put it in an variable?", "body": "<p>I have some sql queries that have some common parts in them. The CTE used to get the data about houses look similar in both queries.</p>\n\n<pre><code>const GetUserListSQL = `\n  WITH \"HouseData\" AS (\n    SELECT\n      \"UserId\",\n      json_object_agg(\n        \"Id\",\n        (SELECT x FROM (SELECT\n          \"Price\",\n          \"Area\",\n          \"Address\"\n        ) x)\n      ) AS \"HouseMap\"\n    FROM \"Houses\"\n    GROUP BY \"UserId\"\n  )\n  SELECT\n    \"Id\",\n    \"Name\",\n  FROM \"Users\"\n  LEFT JOIN \"HouseData\" ON \"Users\".\"Id\" = \"HouseData\".\"UserId\"\n`\n\n\nconst GetUserSQL = `\n  WITH \"HouseData\" AS (\n    SELECT\n      json_object_agg(\n        \"Id\",\n        (SELECT x FROM (SELECT\n          \"Price\",\n          \"Area\",\n          \"Address\"\n        ) x)\n      ) AS \"HouseMap\"\n    FROM \"Houses\"\n    WHERE \"UserId\" = $1\n  )\n  SELECT\n    \"Id\",\n    \"Name\",\n  FROM \"Users\"\n  LEFT JOIN \"HouseData\" ON TRUE\n  WHERE \"Users\".\"Id\" = $1\n`\n</code></pre>\n\n<p>Should I make the CTE to get house data or user fields a separate const? Will it increase reusability (like you only need to add fields in one place)? Will it reduce readability (it looks kind of weird somehow). Someone suggested that I wrote those SQL like below:</p>\n\n<pre><code>const HouseDataCTE = `\n  SELECT\n    \"UserId\",\n    json_object_agg(\n      \"Id\",\n      (SELECT x FROM (SELECT\n        \"Price\" \n        \"Area\",\n        \"Address\"\n      ) x)\n    ) AS \"HouseMap\"\n  FROM \"Houses\"\n`\n\nconst UserCommonSQL = `\n  SELECT\n    \"Id\",\n    \"Name\"\n  FROM \"Users\"\n`\n\nconst GetUserListSQL = `\n  WITH \"HouseData\" AS (\n    ` + HouseDataCTE + `\n    GROUP BY \"UserId\"\n  )\n  ` + UserCommonSQL + `\n  LEFT JOIN \"HouseData\" ON \"Users\".\"Id\" = \"HouseData\".\"UserId\"\n`\n\nconst GetUserSQL = `\n  WITH \"HouseData\" AS (\n    ` + HouseDataCTE + `\n    WHERE \"UserId\" = $1\n  )\n  ` + UserCommonSQL + `\n  LEFT JOIN \"HouseData\" ON TRUE\n  WHERE \"Users\".\"Id\" = $1\n`\n</code></pre>\n\n<p>If I write it like that I feel like I have to jump back and forth to inspect the SQL (the queries are not placed close together), which is kind of annoying in my opinion. Are there any convention or best practices for these kinds of situation ?</p>\n\n<p>EDIT: The sql queries above are shorter version of an actual long SQL queries I'm using. The longer version has 4-5 CTEs from different tables and the common fields for \"Users\" are about 20 columns. What should be done in that situation then? </p>\n"}, {"tags": ["database", "postgresql", "go"], "answers": [{"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 3, "last_activity_date": 1484668497, "last_edit_date": 1484668497, "creation_date": 1484667264, "answer_id": 41701125, "question_id": 41699630, "link": "https://stackoverflow.com/questions/41699630/best-way-to-connect-to-multiple-database-in-go-postgress/41701125#41701125", "title": "Best way to connect to multiple database in go postgress", "body": "<p>I have create my own way to connect to multiple connection database.</p>\n\n<p>first I create the base file for <a href=\"https://github.com/Gujarats/API-Golang/blob/mock-sql/database/postgre.go\" rel=\"nofollow noreferrer\">postgre</a> : </p>\n\n<pre><code>type PostgreHost struct {\n    Driver   string\n    Database string\n    Username string\n    Ssl      string\n    Password string\n}\n\ntype PostgreSystem interface {\n    Init()\n    Connect() (*sqlx.DB, error)\n}\n\nvar logger *log.Logger\n\nfunc (p PostgreHost) Init() {\n    logger = log.New(os.Stderr,\n        \"Postgre\",\n        log.Ldate|log.Ltime|log.Lshortfile)\n}\n\nfunc (p *PostgreHost) Connect() (*sqlx.DB, error) {\n    connection := fmt.Sprintf(\"user=%v password= %v dbname=%v sslmode=%v\", p.Username, p.Password, p.Database, p.Ssl)\n    db, err := sqlx.Connect(\n        p.Driver,\n        connection)\n    if err != nil {\n        logger.Fatal(err)\n        return nil, err\n    }\n\n    return db, nil\n}\n\nfunc GetPostgreDb(postgre PostgreSystem) (*sqlx.DB, error) {\n    return postgre.Connect()\n}\n</code></pre>\n\n<p>and then call it to create list of the connection like <a href=\"https://github.com/Gujarats/API-Golang/blob/mock-sql/database/allSystem.go\" rel=\"nofollow noreferrer\">this</a> : </p>\n\n<pre><code>//we create different types of databse connection here\nfunc SystemConnection() map[string]interface{} {\n    listConnection := make(map[string]interface{})\n    var err error\n    // create redis connection\n    redisConn := RedisHost{\n        Address:  \"localhost:6379\",\n        Password: \"\",\n        DB:       0,\n    }\n\n    redisConnection, err := redisConn.Connect()\n    if err != nil {\n        panic(err)\n    }\n\n    // create postgre connection\n    postgreConn := PostgreHost{\n        Driver:   \"postgres\",\n        Database: \"postgres\",\n        Username: \"postgres\",\n        Ssl:      \"disable\",\n        Password: \"root\",\n    }\n   // you can create your another connection here : \n   postgreConn2 := PostgreHost{\n        Driver:   \"postgres\",\n        Database: \"postgres\",\n        Username: \"postgres\",\n        Ssl:      \"disable\",\n        Password: \"root\",\n    }\n\n    postgreConnection, err := GetPostgreDb(&amp;postgreConn)\n\n    if err != nil {\n        panic(err)\n    }\n\n    postgreConnection2, err := GetPostgreDb(&amp;postgreConn2)\n\n    if err != nil {\n        panic(err)\n    }\n\n    listConnection[\"redis\"] = redisConnection\n    listConnection[\"postgre\"] = postgreConnection\n    listConnection[\"postgre2\"] = postgreConnection2\n    return listConnection\n}\n</code></pre>\n\n<p>and finally call all the connection from the map : </p>\n\n<pre><code>    //getting list of all the connection.\n    listConnection := database.SystemConnection()\n\n    //getting redis connection convert it from interface to *redisClient.\n    redisConn := listConnection[\"redis\"].(*redis.Client)\n\n    // get postgre connection.\n    postgreConn := listConnection[\"postgre\"].(*sqlx.DB)\n    postgreConn2 := listConnection[\"postgre2\"].(*sqlx.DB)\n</code></pre>\n\n<p>you can get all the source code from <a href=\"https://github.com/Gujarats/API-Golang/tree/mock-sql\" rel=\"nofollow noreferrer\">here</a>. it still on progress but hopefully you can get the idea. Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 1116295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dc7d254af9648054dd03211d16a5c3e?s=128&d=identicon&r=PG", "display_name": "exavolt", "link": "https://stackoverflow.com/users/1116295/exavolt"}, "is_accepted": false, "score": 2, "last_activity_date": 1484680152, "last_edit_date": 1484680152, "creation_date": 1484679812, "answer_id": 41704983, "question_id": 41699630, "link": "https://stackoverflow.com/questions/41699630/best-way-to-connect-to-multiple-database-in-go-postgress/41704983#41704983", "title": "Best way to connect to multiple database in go postgress", "body": "<ul>\n<li>Have a context struct to represent a site</li>\n<li>This context struct holds a DB connection</li>\n<li>When a user logged in, also set which site is active for him / her (I assume that a user account can have more than one sites).</li>\n<li>When the user accesses the server, check the cookie for the site</li>\n<li>Carefully use mutex to get the context from global list / map (map would be <code>map[string]Context</code>) based on the site name obtained from the cookie.</li>\n<li>If the context doesn't exist, instantiate one. Internally, it creates a connection to the DB to the appropriate table for the site and registers itself to the global list (use mutex).</li>\n<li>In each context instance, have a timer for certain minutes which resets when accessed. When it timed out (i.e., when it's not accessed for certain minutes), or the last user who owns the site logged out, it will remove itself from global list (again, use mutex) and drop its DB connection.</li>\n</ul>\n"}], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1550, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1484680152, "creation_date": 1484663143, "last_edit_date": 1484663252, "question_id": 41699630, "link": "https://stackoverflow.com/questions/41699630/best-way-to-connect-to-multiple-database-in-go-postgress", "title": "Best way to connect to multiple database in go postgress", "body": "<p>I'm developing a website builder and store each website data in separate databases.<br>\nMy question is how to handle multiple database connection properly and efficiently.\nAll databases and code are in same server</p>\n"}, {"tags": ["multithreading", "go", "mutex", "false-sharing"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1484658015, "post_id": 41697727, "comment_id": 70591369, "body": "Yes, your understanding is wrong: &quot;False sharing&quot; has nothing to do with several threads accessing the same memory (race condition if one writes) but with processor cache lines: Just google for &quot;false sharing&quot;:"}, {"owner": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1484673905, "post_id": 41697727, "comment_id": 70602424, "body": "@Volker Thabk you. I understood. Let me get clarified. Let there be two threads t1 and t2 running on cores C1 and C2. Let t1 be allowed to run first (now t2 waits as there is muted lock). Let t1 write data into c1&#39;s L1 cache(the cache line which stores our structure). Now t2 is ready in C2. But L2 Cache in C2 has to be updated(by MESI protocol)to the new values. After this, t2 can proceed with its job. This is where false sharing occurs. Am I correct?"}, {"owner": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1484674422, "post_id": 41697727, "comment_id": 70602723, "body": "When you do padding, each thread will be allocated a cache line in L1 which will be pointing to different memory locations in L2 or higher memory. As each thread is working on different memory locations, they are not shared and so no MESI and no false sharing. Am I correct?"}, {"owner": {"reputation": 1028, "user_id": 314437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2ccffdf1c76d99aa812546bfd4f0977?s=128&d=identicon&r=PG", "display_name": "k3a", "link": "https://stackoverflow.com/users/314437/k3a"}, "edited": false, "score": 0, "creation_date": 1596303333, "post_id": 41697727, "comment_id": 111771611, "body": "&quot;Premature optimization is the root of all evil.&quot; - a famous quote by Sir Tony Hoare (popularized by Donald Knuth). Learn from it. And stop optimizing cache lines unless you have a perfect code and measure that this is your current #1 performance bottleneck."}], "answers": [{"comments": [{"owner": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "edited": false, "score": 0, "creation_date": 1484719965, "post_id": 41698532, "comment_id": 70620063, "body": "Ooops. I don&#39;t get how this is the answer to my question. My question is, if only one thread has access to a memory, false sharing cannot happen and then why the programmer has added extra bits. I now got it cleared myself (look at my comments to question). The aim is to make the size of the structure a multiple of the cache line. Why will it matter if it is padded at the start and/or ends?"}, {"owner": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "edited": false, "score": 0, "creation_date": 1484720069, "post_id": 41698532, "comment_id": 70620104, "body": "moreover according to this link: <a href=\"http://www.geeksforgeeks.org/structure-member-alignment-padding-and-data-packing/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/&hellip;</a> the compiler seems to change the order of the variables declared. So your style of padding and the one that has posted in question makes no difference"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "edited": false, "score": 0, "creation_date": 1484720119, "post_id": 41698532, "comment_id": 70620124, "body": "@user3219492 <code>false-sharing</code> has nothing to do with threads accessing same memmory. You may think of it as a performance  problem due to two process sharing same <code>cache line</code>"}, {"owner": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "edited": false, "score": 0, "creation_date": 1484720409, "post_id": 41698532, "comment_id": 70620239, "body": "yes. I got my doubt cleared (comments in question). My point is, the one you have posted is not the answer for my doubt I feel."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "edited": false, "score": 0, "creation_date": 1484720523, "post_id": 41698532, "comment_id": 70620282, "body": "@user3219492 Compiler changing the order is specific to languages even ANCI-C does not specify exactly how it does it.In i have often seen people using padding in this manner in golang"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "edited": false, "score": 0, "creation_date": 1484722072, "post_id": 41698532, "comment_id": 70620868, "body": "@user3219492 this thread may help you understand it better <a href=\"https://www.codeproject.com/Articles/51553/Concurrency-Hazards-False-Sharing#heading0005\" rel=\"nofollow noreferrer\">codeproject.com/Articles/51553/&hellip;</a>.  Check this gist also <a href=\"https://github.com/Workiva/go-datastructures/blob/master/queue/ring.go\" rel=\"nofollow noreferrer\">github.com/Workiva/go-datastructures/blob/master/queue/ring.&zwnj;&#8203;go</a>"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 2, "last_activity_date": 1484722107, "last_edit_date": 1484722107, "creation_date": 1484659976, "answer_id": 41698532, "question_id": 41697727, "link": "https://stackoverflow.com/questions/41697727/strange-code-for-preventing-false-sharing/41698532#41698532", "title": "Strange code for preventing false sharing", "body": "<p>Memory locations on the same cache line are subject to false-sharing, which is very bad for performance. \nCache line size  ranges from <strong>32 to 128</strong> bytes, depending on processor model. 128 byte pad will reduce chance for same cache line being used by different processes and that improvesthe performace</p>\n\n<p>as i see it, the following would be better as it would be more explicit</p>\n\n<pre><code>type poolLocal struct {\n      _     [64]byte     // Prevents false sharing.\n      private interface{}   // Can be used only by the respective P.\n      shared  []interface{} // Can be used by any P.\n      Mutex                 // Protects shared.\n      _     [64]byte     // Prevents false sharing.\n}\n</code></pre>\n"}], "owner": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 2, "accepted_answer_id": 41698532, "answer_count": 1, "score": 0, "last_activity_date": 1484722107, "creation_date": 1484657521, "question_id": 41697727, "link": "https://stackoverflow.com/questions/41697727/strange-code-for-preventing-false-sharing", "title": "Strange code for preventing false sharing", "body": "<p>I want to discuss the following structure in golang from this <a href=\"https://golang.org/src/sync/pool.go\" rel=\"nofollow noreferrer\">link</a></p>\n\n<pre><code>// Local per-P Pool appendix.\n    57  type poolLocal struct {\n    58      private interface{}   // Can be used only by the respective P.\n    59      shared  []interface{} // Can be used by any P.\n    60      Mutex                 // Protects shared.\n    61      pad     [128]byte     // Prevents false sharing.\n    62  }\n</code></pre>\n\n<p>The above structure can be accessed only one thread at a time as Mutex is used. The coder will Lock the structure in the beginning of a thread and unlock it when the thread completes. So the memory is not shared between threads. So <strong>no more than one core will have\naccess to the memory</strong>. So, by my understanding, <strong>false sharing cannot happen</strong> here. If false sharing cannot happen, why did the coder pad the structure\nwith extra bytes (pad [128]byte) ? Is my understanding wrong? </p>\n"}, {"tags": ["go", "firebase", "firebase-authentication"], "answers": [{"comments": [{"owner": {"reputation": 2393, "user_id": 2732224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/bSvzW.jpg?s=128&g=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/2732224/shivam"}, "edited": false, "score": 1, "creation_date": 1510057027, "post_id": 41700315, "comment_id": 81264656, "body": "do we have any other reference to create a user in firebase in golang?"}], "tags": [], "owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "is_accepted": true, "score": 2, "last_activity_date": 1606789530, "last_edit_date": 1606789530, "creation_date": 1484665081, "answer_id": 41700315, "question_id": 41695205, "link": "https://stackoverflow.com/questions/41695205/how-to-create-a-user-in-firebase-using-golang/41700315#41700315", "title": "How to create a user in Firebase using golang?", "body": "<p>Firebase has added an Admin SDK for Go. See Mujtaba's answer for more information: <a href=\"https://stackoverflow.com/a/47889860\">https://stackoverflow.com/a/47889860</a></p>\n<hr />\n<p>Previous answer:</p>\n<p><strike>There is no Firebase SDK for Go. But certain parts of Firebase have a REST API that allows you to use those features from almost any platform/technology. The Firebase Database is one of those features and the Firego library is a wrapper around the REST API of the Firebase Database for Go developers.</p>\n<p>Unfortunately there is no REST API for creating users in Firebase Authentication. So it won't be possible to create users through Firego or through a public REST API from your Go code.</p>\n<p>The simplest solution would be to create a REST endpoint on a app server you control, where you then use the <a href=\"https://firebase.google.com/docs/auth/admin/\" rel=\"nofollow noreferrer\">Firebase Admin SDK</a> to <a href=\"https://firebase.google.com/docs/auth/admin/manage-users#create_a_user\" rel=\"nofollow noreferrer\">create the user</a>.</strike></p>\n"}, {"tags": [], "owner": {"reputation": 647, "user_id": 7884251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pbFJl.jpg?s=128&g=1", "display_name": "Mujtaba Mahmood", "link": "https://stackoverflow.com/users/7884251/mujtaba-mahmood"}, "is_accepted": false, "score": 19, "last_activity_date": 1541186539, "last_edit_date": 1541186539, "creation_date": 1513696040, "answer_id": 47889860, "question_id": 41695205, "link": "https://stackoverflow.com/questions/41695205/how-to-create-a-user-in-firebase-using-golang/47889860#47889860", "title": "How to create a user in Firebase using golang?", "body": "<p>Recently Google added Go Lang to their list of programming languages that are supported by Firebase Authentication using <a href=\"https://firebase.google.com/docs/auth/admin/\" rel=\"noreferrer\">Firebase Admin SDK</a>.</p>\n\n<p>To create a user:</p>\n\n<pre><code>params := (&amp;auth.UserToCreate{}).\n        Email(\"user@example.com\").\n        EmailVerified(false).\n        PhoneNumber(\"+1234567890\").\n        Password(\"secretPassword\").\n        DisplayName(\"Donald Drump\").\n        PhotoURL(\"http://www.example.com/12345678/photo.png\").\n        Disabled(false)\nu, err := client.CreateUser(context.Background(), params)\nif err != nil {\n        log.Fatalf(\"error creating user: %v\\n\", err)\n}\nlog.Printf(\"Successfully created user: %v\\n\", u)\n</code></pre>\n\n<p>if you want to create a user with your own user ID and don't want an automated generated ID by Firebase then:</p>\n\n<pre><code>params := (&amp;auth.UserToCreate{}).\n        UID(uid).\n        Email(\"user@example.com\").\n        PhoneNumber(\"+1234567890\")\nu, err := client.CreateUser(context.Background(), params)\nif err != nil {\n        log.Fatalf(\"error creating user: %v\\n\", err)\n}\nlog.Printf(\"User created successfully : %v\\n\", u)\n</code></pre>\n\n<p>to update a user:</p>\n\n<pre><code>params := (&amp;auth.UserToUpdate{}).\n        Email(\"user@example.com\").\n        EmailVerified(true).\n        PhoneNumber(\"+1234567890\").\n        Password(\"newPassword\").\n        DisplayName(\"Donald Drump\").\n        PhotoURL(\"http://www.example.com/12345678/photo.png\").\n        Disabled(true)\nu, err := client.UpdateUser(context.Background(), uid, params)\nif err != nil {\n        log.Fatalf(\"error updating user: %v\\n\", err)\n}\nlog.Printf(\"Successfully updated user: %v\\n\", u)\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 7255142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/svdMc.jpg?s=128&g=1", "display_name": "Sarath Sankara Kurup", "link": "https://stackoverflow.com/users/7255142/sarath-sankara-kurup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6035, "favorite_count": 3, "accepted_answer_id": 41700315, "answer_count": 2, "score": 3, "last_activity_date": 1606789530, "creation_date": 1484650358, "last_edit_date": 1484664860, "question_id": 41695205, "link": "https://stackoverflow.com/questions/41695205/how-to-create-a-user-in-firebase-using-golang", "title": "How to create a user in Firebase using golang?", "body": "<p>Is there any way to create a user in Firebase using Userame, Email and Password with Golang. A user can be created with Javascript using <code>createUserWithEmailAndPassword(email, password)</code> But I need the same with Golang. Is there a package or function available? I am using firego to connect with Firebase.</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1484649370, "post_id": 41694806, "comment_id": 70585576, "body": "God damn, thanks mate! :) will mark as answered when I can"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1484649275, "creation_date": 1484649275, "answer_id": 41694806, "question_id": 41694776, "link": "https://stackoverflow.com/questions/41694776/go-cant-access-exported-data-in-other-files/41694806#41694806", "title": "Go can&#39;t access exported data in other files", "body": "<p>You only exported the type <code>BeaconMsg</code> (the type name), but the fields are unexported.</p>\n\n<p>If you want to access the fields too from other packages, you have to export them by starting their names with a capital letter:</p>\n\n<pre><code>type BeaconMsg struct {\n    InstanceID  int\n    NamespaceID int\n    Distance    int\n}\n</code></pre>\n"}], "owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 41694806, "answer_count": 1, "score": 0, "last_activity_date": 1484654737, "creation_date": 1484649166, "last_edit_date": 1484654737, "question_id": 41694776, "link": "https://stackoverflow.com/questions/41694776/go-cant-access-exported-data-in-other-files", "title": "Go can&#39;t access exported data in other files", "body": "<p>My project exports these values in different files:</p>\n\n<pre><code>//messages.go    \npackage types\n\n    //BeaconMsg with data from google glass and the connected beacons\n    type BeaconMsg struct {\n        instanceID  int\n        namespaceID int\n        distance    int\n    }\n\n//beacondata.go\npackage types\n\nimport (\n    \"time\"\n)\n\n//Beacondata with data from glasses containing beacon information\ntype Beacondata struct {\n    instanceID   int\n    namespaceID  int\n    distance     int\n    RegisterTime time.Time\n}\n</code></pre>\n\n<p>In another file I import the types like this:</p>\n\n<pre><code>import (\n    \"glassbackend/types\"\n)\n</code></pre>\n\n<p>Code that throws the error:</p>\n\n<pre><code>req := new(types.BeaconMsg)\n        if err := structFromRequest(req, r); err != nil {\n            log.Errorf(context, \"error extracting data from request %v\", err)\n            w.WriteHeader(http.StatusBadRequest)\n            return\n        }\n        if req.namespaceID == \"\" || req.instanceID == \"\" {blab blabl}\n</code></pre>\n\n<p>but then this code throws me the error \"req.namespaceID undefined (cannot refer to unexported field or method namespaceID)(build)</p>\n\n<p>Note that the code <code>req := new(types.BeaconMsg)</code> does not cast any error, only the last row of my code.</p>\n\n<p>Does anyone have any idea as to what is happening? Am I doing something wrong with the exports? I don't think there is much else to do either right or wrong?</p>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1519708412, "post_id": 41695012, "comment_id": 85007985, "body": "What if Y is an <code>interface{}</code>, i got error: <code>cannot call non-function Y (type interface {})</code>"}], "tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 6, "last_activity_date": 1517234029, "last_edit_date": 1517234029, "creation_date": 1484649856, "answer_id": 41695012, "question_id": 41694647, "link": "https://stackoverflow.com/questions/41694647/how-do-i-use-reflect-to-check-if-the-type-of-a-struct-field-is-interface/41695012#41695012", "title": "How do I use reflect to check if the type of a struct field is interface{}?", "body": "<p>You can get the type of the interface <code>Y</code> by creating a nil instance and using reflection:</p>\n\n<pre><code>yType := reflect.TypeOf((*Y)(nil)).Elem()\n</code></pre>\n\n<p>and then use the expression</p>\n\n<pre><code>reflect.TypeOf(x).Implements(yType)\n</code></pre>\n\n<p>to check if the type implements the interface.</p>\n\n<p>Interfaces themselves can not be instantiated. The interface{} interface which is the empty interface is implemented by all types so all fields implement that.</p>\n\n<p><a href=\"https://play.golang.org/p/gRfheIW_9Y\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gRfheIW_9Y</a></p>\n\n<p>Actually it also works with the empty interface{} itself but this will always return true (if i'm not missing something):</p>\n\n<p><a href=\"https://play.golang.org/p/29rWP4LtIo\" rel=\"nofollow noreferrer\">https://play.golang.org/p/29rWP4LtIo</a></p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1484656229, "last_edit_date": 1495540507, "creation_date": 1484656229, "answer_id": 41697222, "question_id": 41694647, "link": "https://stackoverflow.com/questions/41694647/how-do-i-use-reflect-to-check-if-the-type-of-a-struct-field-is-interface/41697222#41697222", "title": "How do I use reflect to check if the type of a struct field is interface{}?", "body": "<p><code>interface{}</code> is a type, and <a href=\"https://golang.org/pkg/reflect/#TypeOf\" rel=\"nofollow noreferrer\"><code>reflect.TypeOf()</code></a> expects a value. So you can't pass the literal <code>interface{}</code> to it. You can only pass a value.</p>\n\n<p>Back to the original question. Let's see a <code>struct</code> example:</p>\n\n<pre><code>type My struct {\n    A int\n    B interface{}\n    C io.Reader\n}\n</code></pre>\n\n<p>You want to tell if the type of a field is <code>interface{}</code>. Acquire the <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>reflect.Type</code></a> of the <code>struct</code> type, then you can access the fields using <code>Type.Field()</code> or <code>Type.FieldByName()</code>.</p>\n\n<p>This gives you a value of type <a href=\"https://golang.org/pkg/reflect/#StructField\" rel=\"nofollow noreferrer\"><code>reflect.StructField</code></a> which stores the type of the field.</p>\n\n<p>So far so good. But what should we compare it to? <code>interface{}</code> is an interface type with 0 methods. You can't have (instantiate) a value of that type. You can only have values of concrete types, but yes, they may be wrapped in an interface type.</p>\n\n<p>You could use <code>Type.Kind</code>, and compare it to <code>reflect.Interface</code>, which tells you if it's an interface, but this is <code>true</code> for all interface types. You could also check if it has 0 methods with <code>Type.NumMethod()</code>, which must be 0 for <code>interface{}</code>, but other interfaces could also have 0 methods...</p>\n\n<p>You may use <code>Type.Name</code>, but since <code>interface{}</code> is a <em>unnamed</em> type, its name is the empty string <code>\"\"</code> (and there are other unnamed types). You may use <code>Type.String()</code> which returns <code>\"interface {}\"</code> for the empty interface:</p>\n\n<pre><code>t := reflect.TypeOf(My{})\n\nfor i := 0; i &lt; t.NumField(); i++ {\n    f := t.Field(i)\n    fmt.Printf(\"Field %q, type: %-12v, type name: %-8q, is interface{}: %v\\n\",\n        f.Name, f.Type,\n        f.Type.Name(),\n        f.Type.String() == \"interface {}\",\n    )\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/gN2Itm17T9\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Field \"A\", type: int         , type name: \"int\"   , is interface{}: false\nField \"B\", type: interface {}, type name: \"\"      , is interface{}: true\nField \"C\", type: io.Reader   , type name: \"Reader\", is interface{}: false\n</code></pre>\n\n<p>You might find this related question interesting / useful: <a href=\"https://stackoverflow.com/questions/36310538/identify-non-builtin-types-using-reflect/37292523#37292523\">Identify non builtin-types using reflect</a></p>\n"}], "owner": {"reputation": 28206, "user_id": 624884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04a353473303cb908cd95f25277a4ba2?s=128&d=identicon&r=PG&f=1", "display_name": "F21", "link": "https://stackoverflow.com/users/624884/f21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13608, "favorite_count": 2, "accepted_answer_id": 41697222, "answer_count": 2, "score": 3, "last_activity_date": 1564056633, "creation_date": 1484648830, "question_id": 41694647, "link": "https://stackoverflow.com/questions/41694647/how-do-i-use-reflect-to-check-if-the-type-of-a-struct-field-is-interface", "title": "How do I use reflect to check if the type of a struct field is interface{}?", "body": "<p>I am using the reflect package to determine the type of a struct field is <code>interface{}</code></p>\n\n<p>I want to do the comparison like so (where <code>t</code> is a <code>reflect.Type</code>):</p>\n\n<pre><code>if  t == reflect.TypeOf(interface{}) {\n\n}\n</code></pre>\n\n<p>The problem is that the compiler complains: <code>type interface {} is not an expression</code>.</p>\n\n<p>Is there anyway to check if the type of a struct field is an <code>interface{}</code>?</p>\n"}, {"tags": ["go", "firebase", "firebase-realtime-database"], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 7255142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/svdMc.jpg?s=128&g=1", "display_name": "Sarath Sankara Kurup", "link": "https://stackoverflow.com/users/7255142/sarath-sankara-kurup"}, "is_accepted": true, "score": -1, "last_activity_date": 1570726556, "last_edit_date": 1570726556, "creation_date": 1484719378, "answer_id": 41712419, "question_id": 41692888, "link": "https://stackoverflow.com/questions/41692888/how-to-fetch-from-firebase-using-golang/41712419#41712419", "title": "how to fetch from firebase using golang", "body": "<pre><code>v := map[string]YourStruct{}\nerr := dB.Child(\"YourChild\").Value(&amp;v)\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Println(\"%s\\n\", v)\n</code></pre>\n\n<p>Where <code>YourStruct{}</code> is the struct which you use for fetching values. <code>YourChild</code> is the child name of your above code.</p>\n"}], "owner": {"reputation": 145, "user_id": 7255164, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh4.googleusercontent.com/-cE2wBWM4mOQ/AAAAAAAAAAI/AAAAAAAAAD0/zi0sUFSB6ug/photo.jpg?sz=128", "display_name": "farsana p b", "link": "https://stackoverflow.com/users/7255164/farsana-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 41712419, "answer_count": 1, "score": -2, "last_activity_date": 1570726556, "creation_date": 1484643733, "last_edit_date": 1570721398, "question_id": 41692888, "link": "https://stackoverflow.com/questions/41692888/how-to-fetch-from-firebase-using-golang", "title": "how to fetch from firebase using golang", "body": "<p>Database structure\nI want to retrieve all the data stored in this database using Golang</p>\n\n<pre><code>{\n    \"-KaMY9JKmgyRWVApfcXW\": {\n        \"EmailId\": \"aaa@gmail.com\",\n        \"FirstName\": \"abc\",\n        \"LastName\": \"xyz\",\n        \"UserType\": \"user\"\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "timestamp", "filetime"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484646071, "post_id": 41692192, "comment_id": 70583249, "body": "It seems it is using In little endian, you store the least significant byte in the smallest address. Reverse it byte by byte and normalize the nano seconds with 1970 ,1601 difference"}], "answers": [{"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484646250, "post_id": 41693442, "comment_id": 70583373, "body": "good work, 1c67dc4ab30dd201 is not hex rather they are byte arrays only .It would be better if the program is updated with that"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 1, "creation_date": 1484646318, "post_id": 41693442, "comment_id": 70583423, "body": "@Sarathsp Yeah, I agree, but the asker provided hexa numbers, so that&#39;s what I started from."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484646645, "post_id": 41693442, "comment_id": 70583647, "body": "makes sense. I wonder if this <code>endianness</code>  a part of the protocol or thee machine that sends it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 1, "creation_date": 1484646714, "post_id": 41693442, "comment_id": 70583704, "body": "@Sarathsp Anyway, updated for a case where the data is available as a byte slice."}, {"owner": {"reputation": 11, "user_id": 7429038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ6aE.png?s=128&g=1", "display_name": "holz", "link": "https://stackoverflow.com/users/7429038/holz"}, "edited": false, "score": 0, "creation_date": 1484662520, "post_id": 41693442, "comment_id": 70594613, "body": "and endianess is part of the protocol"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1484666531, "last_edit_date": 1484666531, "creation_date": 1484645441, "answer_id": 41693442, "question_id": 41692192, "link": "https://stackoverflow.com/questions/41692192/decode-hex-timestamp-probably-filetime/41693442#41693442", "title": "Decode Hex Timestamp, probably filetime", "body": "<p>I don't know the OPCUA protocol, but your hexa timestamps can be converted to Go timetamps like this:</p>\n\n<p>First, the bytes of the timestamps have to be read <strong>backward</strong> (different byteorder than you used).</p>\n\n<p>So instead of these:</p>\n\n<pre><code>0x1c67dc4ab30dd201, 0x15605a199070d201, 0x322b4f629970d201\n</code></pre>\n\n<p>You have to reverse the bytes and work with these:</p>\n\n<pre><code>0x01d20db34adc671c, 0x01d27090195a6015, 0x01d27099624f2b32\n</code></pre>\n\n<p>Next, these values are in <strong>10-microsecond unit</strong>, so to get nanoseconds, multiply by 100.</p>\n\n<p>And last, the offset is <strong>369 years</strong> compared to Epoch, which is January 1, 1970 UTC.</p>\n\n<p>The final conversion:</p>\n\n<pre><code>var delta = time.Date(1970-369, 1, 1, 0, 0, 0, 0, time.UTC).UnixNano()\n\nfunc convert(t int64) time.Time {\n    // reverse bytes:\n    var t2 int64\n    for i := 0; i &lt; 8; i, t = i+1, t&gt;&gt;8 {\n        t2 = t2&lt;&lt;8 | t&amp;0xff\n    }\n\n    return time.Unix(0, t2*100+delta)\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>// If you want results in CET:\ncet, err := time.LoadLocation(\"CET\")\nif err != nil {\n    panic(err)\n}\n\nts := []int64{0x1c67dc4ab30dd201, 0x15605a199070d201, 0x322b4f629970d201}\nfor _, t := range ts {\n    fmt.Println(convert(t).In(cet))\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/yEXwYoK21l\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2016-09-13 13:38:05.3431068 +0200 CEST\n2017-01-17 08:05:35.0120469 +0100 CET\n2017-01-17 09:12:02.8828466 +0100 CET\n</code></pre>\n\n<h2>Processing <code>[]byte</code> input</h2>\n\n<p>If the timestamp is handed to you as a byte slice (<code>[]byte</code>), or you have an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> from which you can read a byte slice, you don't need that byte-reversal loop; you can use the following converter function:</p>\n\n<pre><code>func convert2(data []byte) time.Time {\n    t := binary.LittleEndian.Uint64(data)\n    return time.Unix(0, int64(t)*100+delta)\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>data := []byte{0x32, 0x2b, 0x4f, 0x62, 0x99, 0x70, 0xd2, 0x01}\nfmt.Println(convert2(data).In(cet))\n</code></pre>\n\n<p>Output (this one is also in the <a href=\"https://play.golang.org/p/yEXwYoK21l\" rel=\"nofollow noreferrer\">Playground example</a> linked above):</p>\n\n<pre><code>2017-01-17 09:12:02.8828466 +0100 CET\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7429038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ6aE.png?s=128&g=1", "display_name": "holz", "link": "https://stackoverflow.com/users/7429038/holz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1543, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484666531, "creation_date": 1484641551, "last_edit_date": 1484641717, "question_id": 41692192, "link": "https://stackoverflow.com/questions/41692192/decode-hex-timestamp-probably-filetime", "title": "Decode Hex Timestamp, probably filetime", "body": "<p>im struggling with a timestamp i want to convert to human readable format, it is from OPCUA protocol and is supposed to be in hundreds of nanoseconds since 1. Jan 1601, so it should be filetime. However, trying various solutions posted here i am not able to convert it to the right time.</p>\n\n<p>Here are some examples, <br></p>\n\n<pre><code>1c67dc4ab30dd201 -&gt; Sep 13, 2016 13:38:05.343106800 CET \n15605a199070d201 -&gt; Jan 17, 2017 08:05:35.012046900 CET \n322b4f629970d201 -&gt; Jan 17, 2017 09:12:02.882846600 CET \n</code></pre>\n\n<p>As wireshark is able to decode it there must be a way, maybe someone is able and willing to tell me which steps are necessary to do it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484634149, "post_id": 41690156, "comment_id": 70576951, "body": "By easy do you mean you want to avoid writing a loop and convert each value to string?"}, {"owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484634950, "post_id": 41690156, "comment_id": 70577257, "body": "Yes. If i use loops then no point in using string.Join. Is there a way ?"}, {"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484635699, "post_id": 41690156, "comment_id": 70577601, "body": "If you know the map type of <code>invoiceList</code> you can use type assertion to convert it into a map type and then loop over keys of the map"}, {"owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484635958, "post_id": 41690156, "comment_id": 70577722, "body": "The key of the map is string and value is a custom object. But when i call MapKeys() it returns reflet.Value array instead string. I just want to get the keys as an array of the original data type like Java."}, {"owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484636056, "post_id": 41690156, "comment_id": 70577772, "body": "Either i need the array as string [] from the map Or i have to convert the array from reflect.Value to string (dont want to loop them and make a new array everytime). Any one of them is possible ?"}], "answers": [{"comments": [{"owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "edited": false, "score": 3, "creation_date": 1484682444, "post_id": 41690880, "comment_id": 70606971, "body": "I hope there is no way other than this"}, {"owner": {"reputation": 1256, "user_id": 6619344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ofG5P.png?s=128&g=1", "display_name": "devforfu", "link": "https://stackoverflow.com/users/6619344/devforfu"}, "edited": false, "score": 8, "creation_date": 1538639833, "post_id": 41690880, "comment_id": 92215776, "body": "It seems that this approach works better then @zola&#39;s proposal. Though as a Python developer, I am a bit surprised that we need to use reflection to get dictionary keys :)"}, {"owner": {"reputation": 140, "user_id": 5642535, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204856587967186/picture?type=large", "display_name": "Jeremy Hindle", "link": "https://stackoverflow.com/users/5642535/jeremy-hindle"}, "edited": false, "score": 0, "creation_date": 1599612028, "post_id": 41690880, "comment_id": 112824709, "body": "Using reflect for this is completely unnecessary.  See answer below for a better method."}], "tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": true, "score": 17, "last_activity_date": 1484636708, "creation_date": 1484636708, "answer_id": 41690880, "question_id": 41690156, "link": "https://stackoverflow.com/questions/41690156/how-to-get-the-keys-as-string-array-from-map/41690880#41690880", "title": "How to get the keys as string array from map?", "body": "<p>You will need to use loop but you won't need to create a new slice every time as we already know the length. Example:</p>\n\n<pre><code>func main() {\n    a := map[string]int{\n        \"A\": 1, \"B\": 2,\n    }\n    keys := reflect.ValueOf(a).MapKeys()\n    strkeys := make([]string, len(keys))\n    for i := 0; i &lt; len(keys); i++ {\n        strkeys[i] = keys[i].String()\n    }\n    fmt.Print(strings.Join(strkeys, \",\"))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 557, "user_id": 2361801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3822d4528721b17bf4212d410e729372?s=128&d=identicon&r=PG", "display_name": "Dimchansky", "link": "https://stackoverflow.com/users/2361801/dimchansky"}, "edited": false, "score": 5, "creation_date": 1538643292, "post_id": 41691320, "comment_id": 92217660, "body": "<code>keys := make([]string, 0, len(data))</code>, otherwise you&#39;ll have commas at the beginning of the result string."}, {"owner": {"reputation": 674, "user_id": 7285457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b81fc46ff4c9fe4c9d7c61942277b3?s=128&d=identicon&r=PG", "display_name": "Pizza lord", "link": "https://stackoverflow.com/users/7285457/pizza-lord"}, "edited": false, "score": 1, "creation_date": 1543418505, "post_id": 41691320, "comment_id": 93914148, "body": "no need for  key ,_      key := range data is cleaner"}], "tags": [], "owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "is_accepted": false, "score": 35, "last_activity_date": 1565610386, "last_edit_date": 1565610386, "creation_date": 1484638260, "answer_id": 41691320, "question_id": 41690156, "link": "https://stackoverflow.com/questions/41690156/how-to-get-the-keys-as-string-array-from-map/41691320#41691320", "title": "How to get the keys as string array from map?", "body": "<p>instead of using reflection you can use a for loop and range to get a slice of keys like this</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"strings\"\n)\n\nfunc main() {\n  data := map[string]int{\n      \"A\": 1,\n      \"B\": 2,\n  }\n  keys := make([]string, 0, len(data))\n  for key := range data {\n    keys = append(keys, key)\n  }\n\n  fmt.Print(strings.Join(keys, \",\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 338, "user_id": 4142018, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b54734016ab9dcf104695a6a749dd690?s=128&d=identicon&r=PG&f=1", "display_name": "user4142018", "link": "https://stackoverflow.com/users/4142018/user4142018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44152, "favorite_count": 0, "accepted_answer_id": 41690880, "answer_count": 2, "score": 15, "last_activity_date": 1565610386, "creation_date": 1484633612, "last_edit_date": 1565610264, "question_id": 41690156, "link": "https://stackoverflow.com/questions/41690156/how-to-get-the-keys-as-string-array-from-map", "title": "How to get the keys as string array from map?", "body": "<p>I need to use <code>strings.Join(invoicesBatch, \",\")</code> to join a string array. But the array I got from the map using <code>reflect.ValueOf(invoiceList).MapKeys()</code> is <code>reflect.Value</code> array. Is there a easy way to convert them into a string array. </p>\n\n<p>The map was initialized with string key.</p>\n"}, {"tags": ["go", "firebase", "firebase-realtime-database"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1484628539, "post_id": 41689193, "comment_id": 70575207, "body": "change the line <code>var v map[string]interface{}</code> for <code>v := make(map[string]interface{})</code>"}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 7255142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/svdMc.jpg?s=128&g=1", "display_name": "Sarath Sankara Kurup", "link": "https://stackoverflow.com/users/7255142/sarath-sankara-kurup"}, "is_accepted": false, "score": 0, "last_activity_date": 1484654530, "creation_date": 1484654530, "answer_id": 41696619, "question_id": 41689193, "link": "https://stackoverflow.com/questions/41689193/how-to-get-a-value-from-firebase-using-firego/41696619#41696619", "title": "How to get a value from firebase using firego?", "body": "<p>I found the solution myself:</p>\n\n<pre><code>    v := map[string]employeeDetails{}\n    err := dB.Child(\"Employee_Details\").Value(&amp;v)\n    if err != nil {\n      log.Fatal(err)\n    }\n    fmt.Println(\"%s\\n\", v)\n</code></pre>\n\n<p>Where Employee_Details is a child in the database and employeeDetails is a struct i used to store values.</p>\n"}], "owner": {"reputation": 133, "user_id": 7255142, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/svdMc.jpg?s=128&g=1", "display_name": "Sarath Sankara Kurup", "link": "https://stackoverflow.com/users/7255142/sarath-sankara-kurup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484654530, "creation_date": 1484628024, "last_edit_date": 1484628073, "question_id": 41689193, "link": "https://stackoverflow.com/questions/41689193/how-to-get-a-value-from-firebase-using-firego", "title": "How to get a value from firebase using firego?", "body": "<p>I am trying to retrieve values from firebase database using firego. I have found a solution on github </p>\n\n<pre><code>var v map[string]interface{}\nif err := f.Value(&amp;v); err != nil {\n  log.Fatal(err)\n}\nfmt.Printf(\"%s\\n\", v)\n</code></pre>\n\n<p>But, I am unable to implement the above code. I have to retrieve from a child named Employee_Details. How can I do this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1484616845, "post_id": 41687665, "comment_id": 70572440, "body": "You never need a pointer to an interface. Just remove the pointer from the type."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484630309, "post_id": 41687665, "comment_id": 70575749, "body": "adding to what @JimB said this post might help you <a href=\"http://stackoverflow.com/questions/13511203/why-cant-i-assign-a-struct-to-an-interface\" title=\"why cant i assign a struct to an interface\">stackoverflow.com/questions/13511203/&hellip;</a>"}, {"owner": {"reputation": 1454, "user_id": 786418, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b52ad7b6375c1bcfbde2e24bd7833e4?s=128&d=identicon&r=PG", "display_name": "lucaswxp", "link": "https://stackoverflow.com/users/786418/lucaswxp"}, "edited": false, "score": 3, "creation_date": 1484744813, "post_id": 41687665, "comment_id": 70634978, "body": "Why the downvote? I know it&#39;s a newbie mistake, but there&#39;s no place in SO for beginners?"}], "answers": [{"comments": [{"owner": {"reputation": 1454, "user_id": 786418, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b52ad7b6375c1bcfbde2e24bd7833e4?s=128&d=identicon&r=PG", "display_name": "lucaswxp", "link": "https://stackoverflow.com/users/786418/lucaswxp"}, "edited": false, "score": 0, "creation_date": 1484622876, "post_id": 41687955, "comment_id": 70573754, "body": "That works, thanks! But I don&#39;t quite understand why I can&#39;t pass pointers, does that means that interfaces are &quot;first class citizens&quot;, I can have pointers to actual interfaces instead of a struct? Don&#39;t know if that makes sense."}, {"owner": {"reputation": 1316, "user_id": 5310423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JN8B6.png?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5310423/marco"}, "reply_to_user": {"reputation": 1454, "user_id": 786418, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b52ad7b6375c1bcfbde2e24bd7833e4?s=128&d=identicon&r=PG", "display_name": "lucaswxp", "link": "https://stackoverflow.com/users/786418/lucaswxp"}, "edited": false, "score": 0, "creation_date": 1484626735, "post_id": 41687955, "comment_id": 70574681, "body": "@lucaswxp I edited my answer with a way to pass in pointers; hopefully it helps you!"}, {"owner": {"reputation": 96, "user_id": 1116295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dc7d254af9648054dd03211d16a5c3e?s=128&d=identicon&r=PG", "display_name": "exavolt", "link": "https://stackoverflow.com/users/1116295/exavolt"}, "reply_to_user": {"reputation": 1454, "user_id": 786418, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b52ad7b6375c1bcfbde2e24bd7833e4?s=128&d=identicon&r=PG", "display_name": "lucaswxp", "link": "https://stackoverflow.com/users/786418/lucaswxp"}, "edited": false, "score": 0, "creation_date": 1484628075, "post_id": 41687955, "comment_id": 70575053, "body": "@lucaswxp The main issue in your code, as also pointed by @JimB, is that your <code>AcceptInterface</code> expects <i>pointer</i> to an interface argument. In general, you should just use interface argument. If it&#39;s fixed, you can pass struct pointers into it."}], "tags": [], "owner": {"reputation": 1316, "user_id": 5310423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JN8B6.png?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5310423/marco"}, "is_accepted": true, "score": 11, "last_activity_date": 1484626377, "last_edit_date": 1592644375, "creation_date": 1484618644, "answer_id": 41687955, "question_id": 41687665, "link": "https://stackoverflow.com/questions/41687665/pass-struct-for-function-that-accepts-a-interface/41687955#41687955", "title": "Pass struct for function that accepts a interface", "body": "<p>As the error says,</p>\n<blockquote>\n<p>cannot use object (type *MyType) as type *MyInterface in argument to AcceptInterface: *MyInterface is pointer to interface, not interface</p>\n</blockquote>\n<p>This means that it is expecting an <code>interface</code> value, not a pointer.</p>\n<p>If you change the pointers to values in your code (by removing the <code>&amp;</code> and <code>*</code>), the program will run with no errors:</p>\n<pre><code>package main\n\n\ntype MyInterface interface {\n    Test()\n}\n\ntype MyType struct {\n\n}\nfunc (m MyType) Test(){}\n\nfunc AcceptInterface(i MyInterface){\n}\n\nfunc main() {\n\n    object := MyType{}\n    AcceptInterface(object)\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/8ONqtYO1jT\" rel=\"noreferrer\">Play it</a></p>\n<h3>Edit 1</h3>\n<p>If you still want to use a pointer as an argument, there are two important parts of the Go language to note</p>\n<ol>\n<li><p>From the <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"noreferrer\">Go Spec</a> on what <em>exacly</em> is a variable that fits an instance:</p>\n<blockquote>\n<p>A variable of interface type can store a value of any type with a method set that is any superset of the interface.</p>\n</blockquote>\n</li>\n<li><p>From the <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"noreferrer\">Go Spec</a> on what pointers being automatically dereferenced:</p>\n<blockquote>\n<p>As with selectors, a reference to a non-interface method with a value receiver using a pointer will automatically dereference that pointer: <code>pt.Mv</code> is equivalent to <code>(*pt).Mv</code> [and] as with method calls, a reference to a non-interface method with a pointer receiver using an addressable value will automatically take the address of that value: <code>t.Mp</code> is equivalent to <code>(&amp;t).Mp.</code></p>\n</blockquote>\n</li>\n</ol>\n<p>Those two points are important, because when combined they explain that <em>pointers to variables can still fit instances</em>. This is because the pointer's <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"noreferrer\">method set</a> is automatically dereferenced by the Go compiler <em>(and since the variable it is referencing can fit an instance, the pointer can, too)</em>!</p>\n<p>In action, this means that in order to see if a pointer fits an instance, you have to declare the instance as a <em>value</em> and the pointer as a <em>pointer</em>.</p>\n<p>If you run this code:</p>\n<pre><code>package main\n\ntype MyInterface interface {\n    Test()\n}\n\ntype MyType struct {\n}\n\nfunc (m MyType) Test() {}\n\nfunc AcceptInterface(i MyInterface) {\n}\n\nfunc main() {\n    object := &amp;MyType{}\n    AcceptInterface(object)\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/xJjAShDJMv\" rel=\"noreferrer\">Play it</a></p>\n<p>you will see that there are no errors! Notice how there <em>is</em> an <code>&amp;</code> in the <code>object</code> declaration, but <em>no <code>*</code></em> in the <code>i</code> declaration?</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484662755, "post_id": 41688190, "comment_id": 70594810, "body": "From the spec: <code>The method set of the corresponding pointer type *T is the set of all methods declared with receiver *T or T</code>. You can use a pointer or struct value interchangeably with a value receiver."}], "tags": [], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "is_accepted": false, "score": 0, "last_activity_date": 1484620316, "creation_date": 1484620316, "answer_id": 41688190, "question_id": 41687665, "link": "https://stackoverflow.com/questions/41687665/pass-struct-for-function-that-accepts-a-interface/41688190#41688190", "title": "Pass struct for function that accepts a interface", "body": "<pre><code>type MyInterface interface {\n    Test()\n}\n\ntype MyType struct {\n\n}\nfunc (m MyType) Test(){}\n</code></pre>\n\n<p><strong>Note</strong>: it means that <code>MyType</code> implemts the interface <code>MyInterface</code>, not <code>MyType*</code>.</p>\n\n<p>You can use:</p>\n\n<pre><code>func (m *MyType) Test(){}  //Notice here\n\nfunc AcceptInterface(i *MyInterface){\n}\n\nfunc main() {\n\n    object := &amp;MyType{}\n    AcceptInterface(object)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": false, "score": 0, "last_activity_date": 1484632099, "last_edit_date": 1484632099, "creation_date": 1484627230, "answer_id": 41689073, "question_id": 41687665, "link": "https://stackoverflow.com/questions/41687665/pass-struct-for-function-that-accepts-a-interface/41689073#41689073", "title": "Pass struct for function that accepts a interface", "body": "<p>Use explicit typing if you want to pass a pointer to interface:</p>\n\n<pre><code>func main() {\n    var object MyInterface = MyType{}\n    AcceptInterface(&amp;object)\n}\n</code></pre>\n\n<p>I would not recommend using pointer interfaces as you would need to write code like <code>(*i).Test()</code> to call the interface pointer methods. The compiler do auto dereferencing for struct pointers, not so for interface pointers.</p>\n"}], "owner": {"reputation": 1454, "user_id": 786418, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b52ad7b6375c1bcfbde2e24bd7833e4?s=128&d=identicon&r=PG", "display_name": "lucaswxp", "link": "https://stackoverflow.com/users/786418/lucaswxp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9134, "favorite_count": 3, "accepted_answer_id": 41687955, "answer_count": 3, "score": 6, "last_activity_date": 1484632099, "creation_date": 1484616364, "question_id": 41687665, "link": "https://stackoverflow.com/questions/41687665/pass-struct-for-function-that-accepts-a-interface", "title": "Pass struct for function that accepts a interface", "body": "<p>I have the following code:</p>\n\n<pre><code>package main\n\n\ntype MyInterface interface {\n    Test()\n}\n\ntype MyType struct {\n\n}\nfunc (m MyType) Test(){}\n\nfunc AcceptInterface(i *MyInterface){\n}\n\nfunc main() {\n\n    object := &amp;MyType{}\n    AcceptInterface(object)\n}\n</code></pre>\n\n<p>I was expecting this to work, because MyType implements MyInterface, but I get:</p>\n\n<blockquote>\n  <p>cannot use object (type *MyType) as type *MyInterface in argument to\n  AcceptInterface:  *MyInterface is pointer to interface, not interface</p>\n</blockquote>\n\n<p>I tried doing type assertion: object.(MyInterface), but that doesn't work either.</p>\n\n<p>How can I accomplish this?</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484619840, "post_id": 41687657, "comment_id": 70573086, "body": "The runtime.Gosched does nothing here, so I&#39;m not sure the intent is. You&#39;re program doesn&#39;t deadlock, the main goroutine continues and exits."}, {"owner": {"reputation": 279, "user_id": 5663012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QPFU7.jpg?s=128&g=1", "display_name": "MikeZhang", "link": "https://stackoverflow.com/users/5663012/mikezhang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484634924, "post_id": 41687657, "comment_id": 70577249, "body": "As i know , the Gosched() will push the main goroutine back to the queue and  wait all the goroutines done."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484653891, "post_id": 41687657, "comment_id": 70588572, "body": "I&#39;m not sure where you got the idea that Gosched puts the goroutine in a blocking queue, but that&#39;s incorrect. The docs say &quot;Gosched yields the processor, allowing other goroutines to run. It does not suspend the current goroutine, so execution resumes automatically.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "is_accepted": false, "score": 1, "last_activity_date": 1484621681, "last_edit_date": 1592644375, "creation_date": 1484621681, "answer_id": 41688351, "question_id": 41687657, "link": "https://stackoverflow.com/questions/41687657/why-this-go-program-not-enter-deadlock-status-as-expected/41688351#41688351", "title": "Why this Go program not enter deadlock status as expected?", "body": "<p>For your code:</p>\n<pre><code>var mux sync.Mutex\n\nfunc main() {\n    runtime.GOMAXPROCS(1)\n    for i := 0; i &lt; 3; i++ {\n    go func() {\n        log.Println(&quot;Trying to Lock the Mux&quot;)\n        mux.Lock()\n        log.Println(&quot;The mux is Locked&quot;)\n    }()\n  }\n  runtime.Gosched()\n}\n</code></pre>\n<p>There is no deadlock, for</p>\n<blockquote>\n<p>func (m *Mutex) Lock()</p>\n<p>Lock locks m. If the lock is already in use,\nthe calling goroutine blocks until the mutex is available.</p>\n</blockquote>\n<p>So the second and third goroutine just wait there. This is <a href=\"https://en.wikipedia.org/wiki/Busy_waiting\" rel=\"nofollow noreferrer\">busy waiting</a>. then the main goroutine exit, so the second and third goroutine also exist.</p>\n"}, {"comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "reply_to_user": {"reputation": 279, "user_id": 5663012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QPFU7.jpg?s=128&g=1", "display_name": "MikeZhang", "link": "https://stackoverflow.com/users/5663012/mikezhang"}, "edited": false, "score": 0, "creation_date": 1484635036, "post_id": 41688951, "comment_id": 70577292, "body": "It is a FIFO but it is used for scheduling the goroutines i.e the runtime will pick goroutines to schedule using FIFO policy from this queue. FIFO is just how you put and fetch items from a queue, what you do with those items is not what FIFO is about."}], "tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": false, "score": 2, "last_activity_date": 1484626374, "creation_date": 1484626374, "answer_id": 41688951, "question_id": 41687657, "link": "https://stackoverflow.com/questions/41687657/why-this-go-program-not-enter-deadlock-status-as-expected/41688951#41688951", "title": "Why this Go program not enter deadlock status as expected?", "body": "<p>A deadlock is a condition where <strong>all</strong> the goroutines are in waiting state (waiting for lock or reading from channel etc). The reason is simple, if all of them are waiting then there is no one left that can do something that lead to any of the waiting goroutines to continue. In your case your main function, which is also a goroutine is not in waiting state. When the main goroutine exits the process exits too.</p>\n\n<blockquote>\n  <p>The function runtime.Gosched() should push the main goroutine to the\n  only FIFO queue(runtime.GOMAXPROCS(1)) right? why it can be excute\n  before the left two goroutine that already in the queue?</p>\n</blockquote>\n\n<p>The queue is a schedule queue. The runtime will pick a goroutine from the queue, run it for some time, pause it, pick another goroutine.</p>\n"}], "owner": {"reputation": 279, "user_id": 5663012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QPFU7.jpg?s=128&g=1", "display_name": "MikeZhang", "link": "https://stackoverflow.com/users/5663012/mikezhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484626374, "creation_date": 1484616316, "question_id": 41687657, "link": "https://stackoverflow.com/questions/41687657/why-this-go-program-not-enter-deadlock-status-as-expected", "title": "Why this Go program not enter deadlock status as expected?", "body": "<p>I am a newbie in Go, i wrote this code and hope it will enter deadlock status, but failed.</p>\n\n<pre><code>var mux sync.Mutex\n\nfunc main() {\n    runtime.GOMAXPROCS(1)\n    for i := 0; i &lt; 3; i++ {\n    go func() {\n        log.Println(\"Trying to Lock the Mux\")\n        mux.Lock()\n        log.Println(\"The mux is Locked\")\n    }()\n  }\n  runtime.Gosched()\n}\n//Output:\n//2017/01/17 08:59:42 Trying to Lock the Mux\n//2017/01/17 08:59:42 The mux is Locked\n//2017/01/17 08:59:42 Trying to Lock the Mux\n//2017/01/17 08:59:42 Trying to Lock the Mux\n</code></pre>\n\n<p>As you can see. this code run well and print something and then quit without any deadlock error. For I know, the first <strong>go func(){}</strong> goroutine has returned and locked the mux then quit. But the other two goroutines will be blocked because the mux has already blocked.  </p>\n\n<p>The function <strong>runtime.Gosched()</strong> should push the main goroutine to the only FIFO queue(<strong>runtime.GOMAXPROCS(1)</strong>) right? why it can be excute before the left two goroutine that already in the queue? </p>\n\n<p>BTW,this following code will return the deadlock error as expected</p>\n\n<pre><code>var mux sync.Mutex\n\nfunc main() {\n    runtime.GOMAXPROCS(1)\n    var wg sync.WaitGroup\n    wg.Add(3)\n    for i := 0; i &lt; 3; i++ {\n        go func() {\n            defer wg.Done()\n            log.Println(\"Trying to Lock the Mux\")\n            mux.Lock()\n            log.Println(\"The mux is Locked\")\n\n        }()\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "deadlock"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484615092, "post_id": 41687081, "comment_id": 70572051, "body": "Always defer the WaitGroup.Done(). You have a return path in your first goroutine that doesn&#39;t call Done."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484615402, "post_id": 41687081, "comment_id": 70572109, "body": "@JimB that almost got me too. But note that it isn&#39;t a return path - it&#39;s an inline func declared and passed into another function - which only has one execution path.  But yes, typical practices call for calling <code>defer wg.Done()</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1484615757, "post_id": 41687081, "comment_id": 70572181, "body": "@eduncan911: oops, thanks. Just scanned for early returns and didn&#39;t read closely enough."}, {"owner": {"reputation": 1373, "user_id": 4165479, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ed71eed5c9cf3f219c4e303d76dd79ff?s=128&d=identicon&r=PG&f=1", "display_name": "LuMa", "link": "https://stackoverflow.com/users/4165479/luma"}, "edited": false, "score": 0, "creation_date": 1484617231, "post_id": 41687081, "comment_id": 70572527, "body": "Thanks for the hint!"}], "answers": [{"tags": [], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "is_accepted": false, "score": 2, "last_activity_date": 1484613836, "creation_date": 1484613836, "answer_id": 41687363, "question_id": 41687081, "link": "https://stackoverflow.com/questions/41687081/deadlock-error-in-golang/41687363#41687363", "title": "Deadlock error in golang", "body": "<p>Because you need close <code>files</code> channel.\nIn your case, you don't close it, so </p>\n\n<p><code>for range files {\n     fmt.Println(&lt;-files)\n }</code>  will wait get value from <code>files</code> channel. so <code>wg.Done()</code> will never done in <code>printHashes</code>.</p>\n\n<pre><code>func searchFiles(searchPath string, files chan&lt;- string, wg *sync.WaitGroup) {\n    visit := func(path string, f os.FileInfo, err error) error {\n        if !f.IsDir() &amp;&amp; strings.Contains(\".mp4.mp3.flac\", filepath.Ext(f.Name())) {\n            files &lt;- path\n        }\n        return err\n    }\n\n    if err := filepath.Walk(searchPath, visit); err != nil {\n        fmt.Println(err)\n    }\n\n    wg.Done()\n    close(files) // close the chanel, because you don't put thing into the channel anymore.\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1373, "user_id": 4165479, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ed71eed5c9cf3f219c4e303d76dd79ff?s=128&d=identicon&r=PG&f=1", "display_name": "LuMa", "link": "https://stackoverflow.com/users/4165479/luma"}, "edited": false, "score": 0, "creation_date": 1484617678, "post_id": 41687429, "comment_id": 70572622, "body": "Thanks for the detailed answer and the hint about syscall level file locks. My initial idea was, that walking the directory tree of a 500GB music library might take some time. So why not start reading tags (which is far slower) as early as possible."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 1373, "user_id": 4165479, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ed71eed5c9cf3f219c4e303d76dd79ff?s=128&d=identicon&r=PG&f=1", "display_name": "LuMa", "link": "https://stackoverflow.com/users/4165479/luma"}, "edited": false, "score": 1, "creation_date": 1484656092, "post_id": 41687429, "comment_id": 70590029, "body": "@LuMa Actually, reading MP3 Tags is pretty damn fast.  It&#39;s well know the bytecode offsets of the MP3 tag within an MP3.  And therefore, it&#39;s a quick <code>open file -&gt; read byte offset locations -&gt; close file</code> operation.  syscalls will still be the major lock, which will be the performance killer.  Unless... they are on different drives.  :)"}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 1, "last_activity_date": 1484615669, "last_edit_date": 1484615669, "creation_date": 1484614413, "answer_id": 41687429, "question_id": 41687081, "link": "https://stackoverflow.com/questions/41687081/deadlock-error-in-golang/41687429#41687429", "title": "Deadlock error in golang", "body": "<p>Within <code>searchFiles</code>, you want to <code>close(files)</code> when done sending.  This convention is called sender-closes (receivers never close).  Also, remove the call to <code>wg.Done()</code> as you are not done... There could still be items on the channel.</p>\n\n<p>The <code>close(files)</code> will signal the <code>for range files</code> to close and exit the loop, which will call your <code>wg.Done()</code> to signal the main function that everything is done.</p>\n\n<p>(Untested on mobile)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n    \"strings\"\n    \"sync\"\n)\n\nconst searchPath = \"/Users/luma/Music/test\" // 5GB of music.\n\nfunc main() {\n    files := make(chan string)\n\n    var wg sync.WaitGroup\n    wg.Add(1)\n\n    go printHashes(files)\n    go searchFiles(searchPath, files, &amp;wg)\n\n    wg.Wait()\n}\n\nfunc searchFiles(searchPath string, files chan&lt;- string) {\n    visit := func(path string, f os.FileInfo, err error) error {\n        if !f.IsDir() &amp;&amp; strings.Contains(\".mp4.mp3.flac\", filepath.Ext(f.Name())) {\n            files &lt;- path\n        }\n        return err\n    }\n\n    if err := filepath.Walk(searchPath, visit); err != nil {\n        fmt.Println(err)\n    }\n    close(files)\n}\n\nfunc printHashes(files &lt;-chan string, wg *sync.WaitGroup) {\n    defer wg.Done()\n    for range files {\n        fmt.Println(&lt;-files)\n    }\n}\n</code></pre>\n\n<p>Note that while this may seem fast, using a single goroutine is fine and unblocks the main goroutine too.  But, you may not gain any advantage if you try to read multiple files for id3 tags in multiple goroutines - they will all share the same file i/o lock at the syscall level.  The only way that would advantageous would be if the processing of data far out weighs the file i/o locking (e.g. something big in computation, because processing is far faster than syscall locks).</p>\n\n<p>PS, welcome to the Go community!</p>\n"}], "owner": {"reputation": 1373, "user_id": 4165479, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ed71eed5c9cf3f219c4e303d76dd79ff?s=128&d=identicon&r=PG&f=1", "display_name": "LuMa", "link": "https://stackoverflow.com/users/4165479/luma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "accepted_answer_id": 41687429, "answer_count": 2, "score": 3, "last_activity_date": 1484615669, "creation_date": 1484612024, "question_id": 41687081, "link": "https://stackoverflow.com/questions/41687081/deadlock-error-in-golang", "title": "Deadlock error in golang", "body": "<p>I recently looked at go and got hooked, it looks so interesting! After completing the tutorial I wanted to build something by myself: I want to list all of my songs from my music library. I think I can profit from go's concurrency here. While on routine is walking down the directory tree it pushes music files (path to those files) into a channel which are then picked up by another routine that reads the ID3 tags, so I don't have to wait until every file has been found.</p>\n\n<p>This is my simple and naive approach:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n    \"strings\"\n    \"sync\"\n)\n\nconst searchPath = \"/Users/luma/Music/test\" // 5GB of music.\n\nfunc main() {\n    files := make(chan string)\n\n    var wg sync.WaitGroup\n    wg.Add(2)\n\n    go printHashes(files, &amp;wg)\n    go searchFiles(searchPath, files, &amp;wg)\n\n    wg.Wait()\n}\n\nfunc searchFiles(searchPath string, files chan&lt;- string, wg *sync.WaitGroup) {\n    visit := func(path string, f os.FileInfo, err error) error {\n        if !f.IsDir() &amp;&amp; strings.Contains(\".mp4.mp3.flac\", filepath.Ext(f.Name())) {\n            files &lt;- path\n        }\n        return err\n    }\n\n    if err := filepath.Walk(searchPath, visit); err != nil {\n        fmt.Println(err)\n    }\n\n    wg.Done()\n}\n\nfunc printHashes(files &lt;-chan string, wg *sync.WaitGroup) {\n    for range files {\n        fmt.Println(&lt;-files)\n    }\n\n    wg.Done()\n}\n</code></pre>\n\n<p>This program doesn't read the tags, yet. Instead it just prints the file path. This works, it lists all music files extremely fast! But I see this error after the program finishes:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [semacquire]:\nsync.runtime_Semacquire(0xc42007205c)\n    /usr/local/Cellar/go/1.7.4_2/libexec/src/runtime/sema.go:47 +0x30\nsync.(*WaitGroup).Wait(0xc420072050)\n    /usr/local/Cellar/go/1.7.4_2/libexec/src/sync/waitgroup.go:131 +0x97\nmain.main()\n    /Users/luma/Code/Go/src/github.com/LuMa/test/main.go:22 +0xfa\n\ngoroutine 17 [chan receive]:\nmain.printHashes(0xc42008e000, 0xc420072050)\n    /Users/luma/Code/Go/src/github.com/LuMa/test/main.go:42 +0xb4\ncreated by main.main\n    /Users/luma/Code/Go/src/github.com/LuMa/test/main.go:19 +0xab\nexit status 2\n</code></pre>\n\n<p>What is causing the deadlock?</p>\n"}, {"tags": ["ios", "google-app-engine", "go", "google-api"], "comments": [{"owner": {"reputation": 1362, "user_id": 1638814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/79045cf2a5e6cd8d939d0e6d39327133?s=128&d=identicon&r=PG", "display_name": "nvartolomei", "link": "https://stackoverflow.com/users/1638814/nvartolomei"}, "edited": false, "score": 1, "creation_date": 1484686396, "post_id": 41686932, "comment_id": 70609030, "body": "Short answer: yes."}], "answers": [{"tags": [], "owner": {"reputation": 743, "user_id": 7384851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dWNIH.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/7384851/aaron"}, "is_accepted": true, "score": 1, "last_activity_date": 1484759865, "creation_date": 1484759865, "answer_id": 41725588, "question_id": 41686932, "link": "https://stackoverflow.com/questions/41686932/app-engine-as-ios-backend/41725588#41725588", "title": "App Engine as iOS Backend", "body": "<p>Yes, a <a href=\"http://googleappengine.blogspot.co.uk/2010/03/app-engine-joins-google-over-ipv6.html\" rel=\"nofollow noreferrer\">blog post in 2010</a> the GAE team stated</p>\n\n<blockquote>\n  <p>The Google over IPv6 program allows ISPs with good connectivity to request IPv6 access for most Google services. In about a week, we'll be adding Google App Engine and the appspot.com domain to this program. This means that all App Engine apps will become accessible over IPv6 to anyone participating in the program!</p>\n  \n  <p>For most people, this won't require any changes to your code at all. If your App Engine code reads os.environ[\"REMOTE_ADDR\"] in Python, or HttpServletRequest.getRemoteAddr() in Java, be aware that this value may be an IPv4 address, like \"192.0.2.1\", or an IPv6 address, like \"2001:db8::1\". Now is the time to verify that your code doesn't make any IPv4-specific assumptions, so that your IPv6-ready users will have a seamless transition.</p>\n</blockquote>\n"}], "owner": {"reputation": 127, "user_id": 6338687, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5fa4cef633e50c700f9ff8df10365491?s=128&d=identicon&r=PG", "display_name": "Victor", "link": "https://stackoverflow.com/users/6338687/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 41725588, "answer_count": 1, "score": 0, "last_activity_date": 1484759865, "creation_date": 1484610999, "question_id": 41686932, "link": "https://stackoverflow.com/questions/41686932/app-engine-as-ios-backend", "title": "App Engine as iOS Backend", "body": "<p>I'm quite new to backend dev, and Google cloud seemed like a good option for hosting a Golang API for an iOS app.</p>\n\n<p>Recently app started requiring that the app should be accessible in a IPv6 only environment, and I was wondering if Google Cloud App Engine can provide me with that.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["inheritance", "go", "struct", "compiler-errors", "compilation"], "comments": [{"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1498392421, "post_id": 41686692, "comment_id": 76473215, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33098460/getting-error-unknown-field-in-struct-literal\">Getting error: unknown field in struct literal</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 1, "creation_date": 1484610750, "post_id": 41686831, "comment_id": 70570951, "body": "this solves the issue though i couldnt quite understand the topic can you please ad some more detail i checked the spec but the meanin is not very clear @hassansin"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1484610943, "post_id": 41686831, "comment_id": 70570994, "body": "Also see my answer for a way to do it without having to use separate assignments."}], "tags": [], "owner": {"reputation": 13835, "user_id": 1807881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sied7.png?s=128&g=1", "display_name": "hassansin", "link": "https://stackoverflow.com/users/1807881/hassansin"}, "is_accepted": true, "score": 9, "last_activity_date": 1484610272, "last_edit_date": 1592644375, "creation_date": 1484610272, "answer_id": 41686831, "question_id": 41686692, "link": "https://stackoverflow.com/questions/41686692/embedding-structs-in-golang-gives-error-unknown-field/41686831#41686831", "title": "Embedding structs in golang gives error &quot;unknown field&quot;", "body": "<p>You are trying to initialize promoted fields which is not possible by composite literals. From <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"noreferrer\">Go spec</a>:</p>\n<blockquote>\n<p>A field or method f of an anonymous field in a struct x is called promoted if <strong>x.f</strong> is a legal selector that denotes that field or method f.</p>\n<p>Promoted fields act like ordinary fields of a struct except that they cannot be used as field names in composite literals of the\nstruct.</p>\n</blockquote>\n<p>But you can access them using dot notation:</p>\n<pre><code>ra:= returnAccount{}\nra.Tp = acnt.Tp\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1484611220, "post_id": 41686862, "comment_id": 70571060, "body": "this is not the case this vill make one exta level of indention i need to embed account directly under returnAccount"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 1, "creation_date": 1484611280, "post_id": 41686862, "comment_id": 70571074, "body": "The indentation is irrelevant. This just shows how you can set those fields in a literal as opposed to doing it with separate assignments. You don&#39;t have to do it this way if you don&#39;t want to, but it&#39;s identical to what you were trying to do. Please remove your down vote as this answer is correct."}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1484611676, "post_id": 41686862, "comment_id": 70571181, "body": "unless you edit the question the site does not allow me to remove the vote and the point is that the account struct will keep growing as the program needs more details i dont want to type all changes to 2 or more places by hand its not the way i prefer to write programs"}, {"owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1484612818, "post_id": 41686862, "comment_id": 70571482, "body": "can you make a minor change to your post so i can upvote actually i solved the issue your way"}, {"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "reply_to_user": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "edited": false, "score": 0, "creation_date": 1573855607, "post_id": 41686862, "comment_id": 104037740, "body": "There you go @nikoss, it finally happened"}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 13, "last_activity_date": 1573855596, "last_edit_date": 1573855596, "creation_date": 1484610517, "answer_id": 41686862, "question_id": 41686692, "link": "https://stackoverflow.com/questions/41686692/embedding-structs-in-golang-gives-error-unknown-field/41686862#41686862", "title": "Embedding structs in golang gives error &quot;unknown field&quot;", "body": "<p>You can't initialize the fields in the embedded type directly, but you can do it like this:</p>\n\n<pre><code>accounts[v.AccountId] = returnAccount{\n    Account: Account{\n        Tp:        v.Tp,\n        AccountId: v.AccountId,\n        Username:  v.Username,\n    },\n}\n</code></pre>\n\n<p>Or, if <code>v</code> is of type <code>Account</code>, you can just use</p>\n\n<pre><code>accounts[v.AccountId] = returnAccount{\n    Account: v,\n}\n</code></pre>\n"}], "owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9821, "favorite_count": 1, "accepted_answer_id": 41686831, "answer_count": 2, "score": 8, "last_activity_date": 1573855596, "creation_date": 1484609320, "last_edit_date": 1572020387, "question_id": 41686692, "link": "https://stackoverflow.com/questions/41686692/embedding-structs-in-golang-gives-error-unknown-field", "title": "Embedding structs in golang gives error &quot;unknown field&quot;", "body": "<p>i have a <code>struct</code> in <code>user</code> package called <code>account</code></p>\n\n<pre><code>type Account struct {\n    Tp          string `json:\"type\"bson:\"type\"`\n    AccountId   string  `json:\"account_id\"bson:\"account_id\"`\n    Credentials map[string]interface{} `json:\"credentials,omitempty\"bson:\"credentials,omitempty\"`\n    ProfilePicture string `json:\"profile_picture,omitempty\"`\n    Username string `json:\"username\"bson:\"username\"`\n    AccessToken map[string]interface{}`bson:\"access_token,omitempty\"`\n}\n</code></pre>\n\n<p>and in <code>user/accounts</code> im trying to embed this account struct into another struct</p>\n\n<pre><code>type returnAccount struct {\n    user.Account\n    AccessToken string `json:\"access_token,omitempty\"`\n}\n</code></pre>\n\n<p>user package is properly imported before trying to embed i was using it successfully</p>\n\n<p>finaly in a loop i am getting user accounts and making a map of <code>returnAccount</code> and returning from my function \nhere is my function </p>\n\n<pre><code>func getAccounts(usr *user.AuthenticatedUser, id ...string) (accounts map[string]returnAccount) {\n    accounts = make(map[string]returnAccount)\n    if len(id) &gt; 0 {\n        for _, v := range id {\n            for _, acnt := range usr.Accounts {\n                if acnt.AccountId == v {\n                    accounts[acnt.AccountId] = returnAccount{\n                        Tp:       acnt.Tp,\n                        AccountId:acnt.AccountId,\n                    }\n                }\n            }\n        }\n        return\n    }\n    for _, v := range usr.Accounts {\n        accounts[v.AccountId] = returnAccount{\n            Tp:       v.Tp,\n            AccountId:v.AccountId,\n            Username: v.Username,\n\n        }\n\n    }\n    return\n}\n</code></pre>\n\n<p>However this code wont compile here is the error message</p>\n\n<pre><code># sgin/api/user/accounts\napi/user/accounts/getaccounts.go:16: unknown returnAccount field 'Tp' in struct literal\napi/user/accounts/getaccounts.go:17: unknown returnAccount field 'AccountId' in struct literal\napi/user/accounts/getaccounts.go:26: unknown returnAccount field 'Tp' in struct literal\napi/user/accounts/getaccounts.go:27: unknown returnAccount field 'AccountId' in struct literal\napi/user/accounts/getaccounts.go:28: unknown returnAccount field 'Username' in struct literal\n</code></pre>\n\n<p>everything seems pretty straightforward and simple i cannot figure out why i get this error all members i need to reach of the Account struct are exported </p>\n\n<p>The reason why i need this field is i want to send access token to clients through api but not the secret and also i want to reduce the indention level</p>\n"}, {"tags": ["mysql", "go", "database-connection"], "answers": [{"tags": [], "owner": {"reputation": 625, "user_id": 4174678, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-4-R8SvnftWw/AAAAAAAAAAI/AAAAAAAAAAA/rABVJRgbn1M/photo.jpg?sz=128", "display_name": "Andrey K.", "link": "https://stackoverflow.com/users/4174678/andrey-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1485026229, "creation_date": 1485026229, "answer_id": 41783436, "question_id": 41686318, "link": "https://stackoverflow.com/questions/41686318/mysql-bad-connection-on-the-same-laptop/41783436#41783436", "title": "Mysql bad connection on the same laptop", "body": "<p>I have the answer for my own question.\nAccording to a study, this situation appear when debugger stops on breakpoints.\nAfter this, I checked settings file for the MySql in OpenServer and found\n<code>wait_timeout</code> parameter. Then I checked documentation on MySql website at <a href=\"http://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_wait_timeout\" rel=\"nofollow noreferrer\">http://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_wait_timeout</a> and found default value for this (28800 instead 5 in OpenServer). When I changed the setting to the default value, the problem disappeared.</p>\n"}], "owner": {"reputation": 625, "user_id": 4174678, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-4-R8SvnftWw/AAAAAAAAAAI/AAAAAAAAAAA/rABVJRgbn1M/photo.jpg?sz=128", "display_name": "Andrey K.", "link": "https://stackoverflow.com/users/4174678/andrey-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 41783436, "answer_count": 1, "score": -2, "last_activity_date": 1485026229, "creation_date": 1484607156, "question_id": 41686318, "link": "https://stackoverflow.com/questions/41686318/mysql-bad-connection-on-the-same-laptop", "title": "Mysql bad connection on the same laptop", "body": "<p>I use local mysql server from OpenServer for developing on Golang.</p>\n\n<p>Sometimes I see errors \"driver:bad connection\"...\nWhat may cause this problems?</p>\n\n<p>Windows 10, OpenServer 5.2.2, Mysql server 5.6-x64, Golang 1.7.4, Ozzo-dbx 1.0.6</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xs5b7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xs5b7.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/mzIZs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mzIZs.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["pointers", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1484606412, "post_id": 41685850, "comment_id": 70569465, "body": "Thanks, that&#39;s exactly what I did. Not sure why I was finding this so darn difficult, but it&#39;s working now"}], "tags": [], "owner": {"reputation": 62, "user_id": 6206819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6bd9c835e7fd559c83549b7c33987b?s=128&d=identicon&r=PG", "display_name": "Antoine Martin", "link": "https://stackoverflow.com/users/6206819/antoine-martin"}, "is_accepted": true, "score": 1, "last_activity_date": 1484604755, "creation_date": 1484604755, "answer_id": 41685850, "question_id": 41685713, "link": "https://stackoverflow.com/questions/41685713/passing-structs-to-functions-across-packages/41685850#41685850", "title": "Passing structs to functions across packages", "body": "<p>You should be able to pass the structs to the main package, just check that you put <code>import \"path/to/config\"</code> at the top of your file.</p>\n\n<p>The path has to be the full path to your package from your <code>$GOPATH/src/</code> directory</p>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 41685850, "answer_count": 1, "score": -1, "last_activity_date": 1484604755, "creation_date": 1484604067, "question_id": 41685713, "link": "https://stackoverflow.com/questions/41685713/passing-structs-to-functions-across-packages", "title": "Passing structs to functions across packages", "body": "<p>In an attempt to become more familiar with go, I am trying to refactor some code which is already working fine.</p>\n\n<p>The original code has three structs:</p>\n\n<pre><code>type ConfigGroup struct {\n        Interval int\n        Tprefix string\n        Target []string\n}\n\ntype ConfigDefaults struct {\n        Interval int\n        Sprefix string\n}\n\ntype Config struct {\n    Group map[string]*ConfigGroup\n    Defaults ConfigDefaults\n}\n</code></pre>\n\n<p>These structs get passed to a function like so:</p>\n\n<pre><code>func runpinger(clientStatsd statsd.Statter, defaults *ConfigDefaults, group *ConfigGroup) {\n// some stuff here\n}\n</code></pre>\n\n<p>Now, I've reworked the config (which uses gocfg) to use <a href=\"https://github.com/hashicorp/hcl\" rel=\"nofollow noreferrer\">hcl</a> instead, which seems to provide a cleaner config syntax.</p>\n\n<p>I've moved the config parser into a package, <code>config</code>, with structs that look like this:</p>\n\n<pre><code>type Config struct {\n  Interval int            `hcl:\"interval\"`\n  Prefix   string         `hcl:\"prefix\"`\n  Groups   []TargetGroups `hcl:\"target_group\"`\n}\n\ntype TargetGroups struct {\n  Name     string    `hcl:\",key\"`\n  Prefix   string    `hcl:\"prefix\"`\n  Interval int       `hcl:\"interval\"`\n  Targets  []Targets `hcl:\"target\"`\n}\n\ntype Targets struct {\n  Address string `hcl:\"address\"`\n  Label   string `hcl:\"label\"`\n}\n</code></pre>\n\n<p>and then a function in <code>config</code> package that looks like this:</p>\n\n<pre><code>func Parse(ConfigFile string) (*Config, error) {\n\n  result := &amp;Config{}\n  var errors *multierror.Error\n\n  config, err := ioutil.ReadFile(ConfigFile)\n\n  if err != nil {\n    return nil, err\n  }\n\n  hclParseTree, err := hcl.Parse(string(config))\n  if err != nil {\n    return nil, err\n  }\n\n  if err := hcl.DecodeObject(&amp;result, hclParseTree); err != nil {\n    return nil, err\n  }\n\n  return result, errors.ErrorOrNil()\n\n}\n</code></pre>\n\n<p>Now, in my main package I'd like to pass these structs to the function again. How can I do this across packages?</p>\n\n<p>I tried:</p>\n\n<pre><code>func(runpinger config *config.Config) {\n // here\n}\n</code></pre>\n\n<p>But that didn't seem to work. Ideally, I'd like to just pass a pointer to the \"sub-struct\" (ie the TargetGroups struct) as well, although I'm not sure if that's possible.</p>\n"}, {"tags": ["go", "exec"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1484635960, "post_id": 41685393, "comment_id": 70577724, "body": "Asked and answered also <a href=\"https://groups.google.com/d/topic/golang-nuts/owTRsLVg_8o/discussion\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 138, "user_id": 3397525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43854def0fe4142847afc456eb16f327?s=128&d=identicon&r=PG", "display_name": "TheOriginalAlex", "link": "https://stackoverflow.com/users/3397525/theoriginalalex"}, "is_accepted": false, "score": 2, "last_activity_date": 1484603265, "creation_date": 1484603265, "answer_id": 41685523, "question_id": 41685393, "link": "https://stackoverflow.com/questions/41685393/exec-command-with-cp-exits-with-status-1/41685523#41685523", "title": "exec.Command with cp exits with status 1", "body": "<p>You can't do wild cards in <code>exec.Command</code>.  I'd iterate through the files in the directory and check if the extension ends in <code>.json</code> and then copy that file.</p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1484637026, "creation_date": 1484637026, "answer_id": 41690953, "question_id": 41685393, "link": "https://stackoverflow.com/questions/41685393/exec-command-with-cp-exits-with-status-1/41690953#41690953", "title": "exec.Command with cp exits with status 1", "body": "<h2>The problem</h2>\n\n<p>To explain: the so-called \"wildcards\" are expanded by the shell in which you typically execute command-line commands. That is, when you invoke <code>cp -r ./*.json dir/</code>, the shell kicks in, expands <code>*.json</code> by itself&mdash;producing a list of names of the files matching that pattern and located in the current directory and pass the <code>cp</code> command <em>a list</em> of such names.</p>\n\n<p>So if you have, say, 10 matching files, the actuall call to <code>cp</code> will end up looking like</p>\n\n<pre><code>cp -r file1.json file2.json ... dir/\n</code></pre>\n\n<p>When you pass call <code>cp ...</code> directly&mdash;without the shell kicking in and expanding that <code>*.json</code> \"fileglob\" for you, the <code>cp</code> command receives the name of a file \"*.json\" verbatim and attempts to open it.  Since the file named exactly \"*.json\" supposedly does not exist, <code>cp</code> fails and exits.</p>\n\n<h2>The solutions</h2>\n\n<p>The first (admittedly lame) solution is to pass a call to <code>cp</code> \"through\" a shell.  That is, turn your call to <code>cp</code> into a shell script and pass it to a shell.</p>\n\n<p>The simplest way to do this is to use something like</p>\n\n<pre><code>exec.Command(`/bin/sh -c 'cp -r ./*.json manifest'`)\n</code></pre>\n\n<p>This will call a shell <code>/bin/sh</code> and pass it the script to execute via its <code>-c</code> command-line option.</p>\n\n<p>Another solution is to roll copying yourself using the standard Go library: the functions of the <code>path/filepath</code> package provide support for both expanding fileglobs as the shell would do it and iterating over the entries of a given directory.  Using either of these approaches you can build the list of files to copy and/or iterate over them.</p>\n\n<p>Then you can use the function <code>os.OpenFile()</code> to open the source and destination files, and <code>io.Copy()</code> to copy the contents between them.</p>\n"}, {"tags": [], "owner": {"reputation": 597, "user_id": 609832, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e91c3fda9470ad160f5a1b100efba543?s=128&d=identicon&r=PG", "display_name": "deepujain", "link": "https://stackoverflow.com/users/609832/deepujain"}, "is_accepted": false, "score": 0, "last_activity_date": 1484681304, "creation_date": 1484681304, "answer_id": 41705376, "question_id": 41685393, "link": "https://stackoverflow.com/questions/41685393/exec-command-with-cp-exits-with-status-1/41705376#41705376", "title": "exec.Command with cp exits with status 1", "body": "<p>Using <a href=\"https://github.com/juju/utils/blob/master/fs/copy.go\" rel=\"nofollow noreferrer\">https://github.com/juju/utils/blob/master/fs/copy.go</a> that internally uses io, os packages</p>\n"}], "owner": {"reputation": 597, "user_id": 609832, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e91c3fda9470ad160f5a1b100efba543?s=128&d=identicon&r=PG", "display_name": "deepujain", "link": "https://stackoverflow.com/users/609832/deepujain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1851, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1484681304, "creation_date": 1484602703, "last_edit_date": 1484602873, "question_id": 41685393, "link": "https://stackoverflow.com/questions/41685393/exec-command-with-cp-exits-with-status-1", "title": "exec.Command with cp exits with status 1", "body": "<pre><code>util.ExecuteCommandWithOuput(exec.Command(\"cp\", \"-r\", \"./*.json\", artifact.dir))\n\nfunc ExecuteCommandWithOuput(cmd *exec.Cmd) {\n    output, err := cmd.Output()\n    if err != nil {\n        log.Print(\"Error executing \", cmd.Args, err)\n    }\n    fmt.Print(string(output))\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>2017/01/16 13:26:35 Error executing [cp -r ./*.json myartifact] exit status 1\n</code></pre>\n\n<p>Questions</p>\n\n<ol>\n<li>How do i get details of complete error message on failure of cp\ncommand ? I did have err != nill and Print err </li>\n<li>Does exec.Command not support copy of files and recursive copy of directories ? </li>\n<li>Any suggestions how i implement copy of files and recursive copy of\ndirectories ?</li>\n</ol>\n\n<p>I have just started adopting Go and hence a new comer with Go.</p>\n"}, {"tags": ["go", "google-cloud-platform", "stackdriver", "google-cloud-logging", "google-cloud-error-reporting"], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 1638814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/79045cf2a5e6cd8d939d0e6d39327133?s=128&d=identicon&r=PG", "display_name": "nvartolomei", "link": "https://stackoverflow.com/users/1638814/nvartolomei"}, "is_accepted": false, "score": 1, "last_activity_date": 1484686907, "creation_date": 1484686907, "answer_id": 41706919, "question_id": 41684218, "link": "https://stackoverflow.com/questions/41684218/how-to-log-a-error-to-stackdriver-error-reporting-via-stackdriver-logging/41706919#41706919", "title": "How to log a error to Stackdriver Error Reporting via Stackdriver Logging", "body": "<p>From the <a href=\"https://godoc.org/cloud.google.com/go/logging#Entry\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<pre><code>// Payload must be either a string or something that\n// marshals via the encoding/json package to a JSON object\n// (and not any other type of JSON value).\n</code></pre>\n\n<p>Looks like inserting stacktrace as a string is the way to go.</p>\n"}, {"comments": [{"owner": {"reputation": 2049, "user_id": 324098, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ddb089dbe33b4f8e0d04e7f87155e0b?s=128&d=identicon&r=PG", "display_name": "CodeGroover", "link": "https://stackoverflow.com/users/324098/codegroover"}, "edited": false, "score": 0, "creation_date": 1555494670, "post_id": 41715494, "comment_id": 98128320, "body": "package no longer exist by this url"}], "tags": [], "owner": {"reputation": 5248, "user_id": 481649, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/AoETz.jpg?s=128&g=1", "display_name": "Steren", "link": "https://stackoverflow.com/users/481649/steren"}, "is_accepted": true, "score": 2, "last_activity_date": 1568991219, "last_edit_date": 1568991219, "creation_date": 1484731336, "answer_id": 41715494, "question_id": 41684218, "link": "https://stackoverflow.com/questions/41684218/how-to-log-a-error-to-stackdriver-error-reporting-via-stackdriver-logging/41715494#41715494", "title": "How to log a error to Stackdriver Error Reporting via Stackdriver Logging", "body": "<p>There is <a href=\"https://godoc.org/cloud.google.com/go/errorreporting\" rel=\"nofollow noreferrer\">a dedicated Go package</a> that should help you achieve this: <code>import \"cloud.google.com/go/errorreporting\"</code></p>\n\n<p>You can configure it to report errors via Stackdriver Logging, and it will take care of the sending the correct log structure.</p>\n"}], "owner": {"reputation": 891, "user_id": 4381110, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8ba3b0252ad9321924c81c724c829fa3?s=128&d=identicon&r=PG&f=1", "display_name": "tomwassing", "link": "https://stackoverflow.com/users/4381110/tomwassing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 41715494, "answer_count": 2, "score": 3, "last_activity_date": 1568991219, "creation_date": 1484597242, "last_edit_date": 1516818736, "question_id": 41684218, "link": "https://stackoverflow.com/questions/41684218/how-to-log-a-error-to-stackdriver-error-reporting-via-stackdriver-logging", "title": "How to log a error to Stackdriver Error Reporting via Stackdriver Logging", "body": "<p>I am trying to log an error to Stackdriver Error Reporting in Go. On the first page of the Error Reporting, there is stated \"Reporting errors from your application can be achieved by logging application errors to Google Stackdriver Logging or...\" (<a href=\"https://cloud.google.com/error-reporting/docs/\" rel=\"nofollow noreferrer\">https://cloud.google.com/error-reporting/docs/</a>). How do I do that with the Go client libraries?</p>\n\n<p>The <code>Entry</code> provided by the <strong>logging</strong> library is constructed like this:</p>\n\n<p><a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/blob/master/logging/logging.go#L412\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/.../logging.go#L412</a></p>\n\n<pre><code>type Entry struct {\n    Timestamp time.Time\n    Severity Severity\n    Payload interface{}\n    Labels map[string]string\n    InsertID string\n    HTTPRequest *HTTPRequest\n    Operation *logpb.LogEntryOperation\n    LogName string\n    Resource *mrpb.MonitoredResource\n}\n</code></pre>\n\n<p>Do I need to marshal <a href=\"https://cloud.google.com/error-reporting/docs/formatting-error-messages\" rel=\"nofollow noreferrer\">this</a> JSON structure into the Payload? Or can I insert the stacktrace as string?</p>\n"}, {"tags": ["go", "web-applications"], "comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1484600064, "post_id": 41683952, "comment_id": 70566743, "body": "Instead of serving them raw from the webserver directly, just add a verification layer on the route that a user asks to see one of his files."}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "edited": false, "score": 0, "creation_date": 1484647254, "post_id": 41683952, "comment_id": 70584093, "body": "you can use <code>http.ServeFile()</code> to serve a file. With some controller logic of course"}], "answers": [{"tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1484650910, "creation_date": 1484650910, "answer_id": 41695399, "question_id": 41683952, "link": "https://stackoverflow.com/questions/41683952/how-do-you-securely-serve-a-file-in-golang/41695399#41695399", "title": "How do you securely serve a file in golang", "body": "<p>If ur filenames are random and long enough and use a secure random generator this is already secure (unless directory-listing is enabled) with some limits though.</p>\n\n<p><a href=\"https://golang.org/pkg/crypto/rand/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/crypto/rand/</a></p>\n\n<p>One user will have access to the file only if he has the url with the random name. The limitation is though that the URL will be saved in the browser history, if someone else finds it he will also have access to it.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 7427144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5033d6ea6fdfed44eb6e7865ed5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Apophis", "link": "https://stackoverflow.com/users/7427144/apophis"}, "edited": false, "score": 0, "creation_date": 1489257534, "post_id": 41697918, "comment_id": 72596104, "body": "how do you strip prefix in this case?"}], "tags": [], "owner": {"reputation": 111, "user_id": 5105452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03067d52af81acb2fe4659b163dcfaa7?s=128&d=identicon&r=PG&f=1", "display_name": "xeone", "link": "https://stackoverflow.com/users/5105452/xeone"}, "is_accepted": true, "score": 3, "last_activity_date": 1484658067, "creation_date": 1484658067, "answer_id": 41697918, "question_id": 41683952, "link": "https://stackoverflow.com/questions/41683952/how-do-you-securely-serve-a-file-in-golang/41697918#41697918", "title": "How do you securely serve a file in golang", "body": "<p>This question in pretty vague and architectural decisions must be made to optimize data access and secure the files.</p>\n\n<p>However, here is a simple solution that might serve your use-case. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"mime\"\n    \"net/http\"\n    \"path/filepath\"\n)\n\n//UserFilesMap is the map that contains\nvar UserFilesMap map[string]FilePermission\n\ntype FilePermission map[string]struct{}\n\n//FileServer is the function that serves files\nfunc FileServer(w http.ResponseWriter, r *http.Request) {\n    //get the file path the user wants to access\n    filename := r.URL.Path[9:]\n    var uname, pass string\n    var ok bool\n    if uname, pass, ok = r.BasicAuth(); !ok {\n        w.WriteHeader(http.StatusForbidden)\n        return\n    }\n\n    if !(uname == \"user\" &amp;&amp; pass == \"1234\") {\n        w.WriteHeader(http.StatusForbidden)\n        return\n    }\n\n    //Checking if user has permission to the file\n    if _, ok := UserFilesMap[uname][filename]; !ok {\n        w.WriteHeader(http.StatusForbidden)\n        return\n    }\n\n    w.Header().Set(\"Content-Type\", mime.TypeByExtension(filepath.Ext(filename)))\n    http.ServeFile(w, r, \"files/\"+filename)\n}\n\nfunc main() {\n    UserFilesMap = make(map[string]FilePermission)\n    // UserFilesMap[\"user\"] = FilePermission{\"xyz.txt\": struct{}{}}\n    UserFilesMap[\"user\"] = FilePermission{\"abc.txt\": struct{}{}}\n    http.HandleFunc(\"/getFile/\", FileServer)\n    if err := http.ListenAndServe(\":8080\", nil); err != nil {\n        fmt.Println(\"Error in ListenAndServe\")\n    }\n}\n</code></pre>\n\n<p>Here, I used a map to store the permissions of files. I would suggest you go for a SQL table instead.</p>\n"}], "owner": {"reputation": 53, "user_id": 7427144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5033d6ea6fdfed44eb6e7865ed5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Apophis", "link": "https://stackoverflow.com/users/7427144/apophis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "accepted_answer_id": 41697918, "answer_count": 2, "score": 1, "last_activity_date": 1588007724, "creation_date": 1484595938, "question_id": 41683952, "link": "https://stackoverflow.com/questions/41683952/how-do-you-securely-serve-a-file-in-golang", "title": "How do you securely serve a file in golang", "body": "<p>I'm new to developing web applications. I'm working with golang and would like to serve user uploaded files securely, such as allowing them to view their own files only.</p>\n\n<p>Now I have saved those files to a local file system with random names. If I serve the entire directory, malicious users may view other users files. This sounds like a common use case, I wonder what's the best approach to deal with it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1484594061, "post_id": 41682683, "comment_id": 70564042, "body": "Doesn&#39;t <code>go install</code> put the binary in <code>bin&#47;</code>? how are you calling/imporiting the lib from the utility?"}, {"owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 1, "creation_date": 1484595031, "post_id": 41682683, "comment_id": 70564507, "body": "I use <code>go install</code> on the library, which would go under <code>pkg</code>. The utility has a main() and would go under <code>bin</code> if I were using <code>go install</code> to build the utility, but for the utility I&#39;ve using <code>go build</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "is_accepted": false, "score": 0, "last_activity_date": 1484687322, "creation_date": 1484687322, "answer_id": 41707016, "question_id": 41682683, "link": "https://stackoverflow.com/questions/41682683/go-cant-find-local-package/41707016#41707016", "title": "Go can&#39;t find local package", "body": "<p>I was able to solve my issue by building the utility with the <code>CC</code> and <code>CGO_ENABLED</code> variables defined. I needed them defined for building the utility even though it didn't include any cgo code it was still needed because of the library.</p>\n\n<p>If it's possible to build the utility without needing to do this I would still be interested as it's a pain to have every user of the library be required to define these.</p>\n"}], "owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484687322, "creation_date": 1484590760, "question_id": 41682683, "link": "https://stackoverflow.com/questions/41682683/go-cant-find-local-package", "title": "Go can&#39;t find local package", "body": "<p>I have two projects, one is a library and the other is a utility. I've used <code>go install</code> to build the library and place it in the pkg area. This seems to have worked as expected.</p>\n\n<pre><code>sbio $ pwd\n      /home/mjohn/workspaces/goprojects/src/crown/sbio\nsbio $ CC=armv7l-timesys-linux-gnueabi-gcc CGO_ENABLED=1 GOOS=linux GOARCH=arm GOARM=7 go install\nsbio $ ls ../../../pkg/linux_arm/crown\n      sbio.a\n</code></pre>\n\n<p>My issue is when I try to have my utility use this library. It complains about <code>no buildable Go source files</code> but its looking under the <code>src</code> directory, which makes me think its not seeing it in the <code>pkg</code> area. My import path in the utility is <code>crown/sbio</code>. Any ideas would be helpful.</p>\n\n<pre><code>utility $ GOOS=linux GOARCH=arm GOARM=7 go build\n         go build crown/sbio: no buildable Go source files in /home/mjohn/workspaces/goprojects/src/crown/sbio\n\nutility $ GOOS=linux GOARCH=arm GOARM=7 go build -v -x -work\n         WORK=/tmp/go-build709862068\n         crown/sbio\n         github.com/jessevdk/go-flags\n         mkdir -p $WORK/github.com/jessevdk/go-flags/_obj/\n         os/signal\n         mkdir -p $WORK/github.com/jessevdk/\n         cd /home/mjohn/workspaces/goprojects/src/github.com/jessevdk/go-flags\n         /home/mjohn/software/go/pkg/tool/linux_386/compile -o $WORK/github.com/jessevdk/go-flags.a -trimpath $WORK -p github.com/jessevdk/go-flags -complete -buildid 2e7b82d3996437f712d51c2be269e6cd3eb809d6 -D _/home/mjohn/workspaces/goprojects/src/github.com/jessevdk/go-flags -I $WORK -pack ./arg.go ./closest.go ./command.go ./command_private.go ./completion.go ./convert.go ./error.go ./flags.go ./group.go ./group_private.go ./help.go ./ini.go ./ini_private.go ./man.go ./multitag.go ./option.go ./option_private.go ./optstyle_other.go ./parser.go ./parser_private.go ./termsize.go ./termsize_linux.go\n         mkdir -p $WORK/os/signal/_obj/\n         mkdir -p $WORK/os/\n         cd /home/mjohn/software/go/src/os/signal\n         /home/mjohn/software/go/pkg/tool/linux_386/compile -o $WORK/os/signal.a -trimpath $WORK -p os/signal -buildid 36d5db084a1ab49c3fbb474d340be7996d6606d8 -D _/home/mjohn/software/go/src/os/signal -I $WORK -pack -asmhdr $WORK/os/signal/_obj/go_asm.h ./doc.go ./signal.go ./signal_unix.go\n         mkdir -p $WORK/crown/sbio/_obj/\n         mkdir -p $WORK/crown/\n         go build crown/sbio: no buildable Go source files in /home/mjohn/workspaces/goprojects/src/crown/sbio\n         /home/mjohn/software/go/pkg/tool/linux_386/asm -o $WORK/os/signal/_obj/sig.o -trimpath $WORK -I $WORK/os/signal/_obj/ -I /home/mjohn/software/go/pkg/include -D GOOS_linux -D GOARCH_arm ./sig.s\n         pack r $WORK/os/signal.a $WORK/os/signal/_obj/sig.o # internal\n\nutility $ go env\n         GOARCH=\"386\"\n         GOBIN=\"\"\n         GOEXE=\"\"\n         GOHOSTARCH=\"386\"\n         GOHOSTOS=\"linux\"\n         GOOS=\"linux\"\n         GOPATH=\"/home/mjohn/workspaces/goprojects\"\n         GORACE=\"\"\n         GOROOT=\"/home/mjohn/software/go\"\n         GOTOOLDIR=\"/home/mjohn/software/go/pkg/tool/linux_386\"\n         CC=\"gcc\"\n         GOGCCFLAGS=\"-fPIC -m32 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build583017880=/tmp/go-build -gno-record-gcc-switches\"\n         CXX=\"g++\"\n         CGO_ENABLED=\"1\"\n\nutility $ go version\n         go version go1.7.4 linux/386\n</code></pre>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1484591009, "post_id": 41682427, "comment_id": 70562518, "body": "Go has automatic pointer dereferencing with (dot) calls."}], "answers": [{"tags": [], "owner": {"reputation": 2336, "user_id": 1826232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DldsJ.png?s=128&g=1", "display_name": "Asdine", "link": "https://stackoverflow.com/users/1826232/asdine"}, "is_accepted": true, "score": 2, "last_activity_date": 1484591068, "creation_date": 1484591068, "answer_id": 41682759, "question_id": 41682427, "link": "https://stackoverflow.com/questions/41682427/why-do-methods-on-pointers-work-when-the-pointer-is-a-variable-but-not-otherwis/41682759#41682759", "title": "Why do methods on pointers work when the pointer is a variable, but not otherwise?", "body": "<p>It's because of automatic derefencing of <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow noreferrer\">method values</a></p>\n\n<blockquote>\n  <p>As with selectors, a reference to a non-interface method with a value receiver using a pointer will automatically dereference that pointer: pt.Mv is equivalent to (*pt).Mv.</p>\n</blockquote>\n\n<p>For the second line, you have this error because you take the address of the <strong>result</strong> of testFunc which doesn't return any value.\nWhat you tried to do is the following:</p>\n\n<pre><code>(&amp;baz).testFunc()\n</code></pre>\n\n<p>which works as expected</p>\n"}], "owner": {"reputation": 1316, "user_id": 5310423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JN8B6.png?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5310423/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41682759, "answer_count": 1, "score": -1, "last_activity_date": 1484612731, "creation_date": 1484589774, "last_edit_date": 1484612731, "question_id": 41682427, "link": "https://stackoverflow.com/questions/41682427/why-do-methods-on-pointers-work-when-the-pointer-is-a-variable-but-not-otherwis", "title": "Why do methods on pointers work when the pointer is a variable, but not otherwise?", "body": "<p>When running the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Bar struct {\n    name string\n}\n\nfunc (foo Bar) testFunc() {\n    fmt.Println(foo.name)\n}\n\nfunc doTest(pointer *Bar) {\n    pointer.testFunc() // run `testFunc` on the pointer (even though it expects a value of type `Bar`, not `*Bar`)\n}\n\nfunc main() {\n    var baz Bar = Bar{\n        name: \"Johnny Appleseed\",\n    }\n\n    doTest(&amp;baz) // send a pointer of `baz` to `doTest()`\n}\n</code></pre>\n\n<p>The output reads: <code>Johnny Appleseed</code>. I would have thought I would have encountered an error for calling <code>testFunc()</code> on a pointer.</p>\n\n<p>After that, I tried switching out <code>doTest(&amp;baz)</code> for <code>&amp;baz.testFunc()</code>. Then I received the error:</p>\n\n<pre><code>tmp/sandbox667065035/main.go:24: baz.testFunc() used as value\n</code></pre>\n\n<p>Why do I only get the error when calling <code>baz.testFunc()</code> directly instead of through another function? Wouldn't calling <code>doTest(&amp;baz)</code> and <code>&amp;baz.testFunc()</code> do the exact same thing, as <code>doTest(pointer *Bar)</code> simply calls <code>pointer.testFunc()</code>?</p>\n\n<p><em><a href=\"https://play.golang.org/p/xotjr1iKOt\" rel=\"nofollow noreferrer\">Playground 1 (<code>doTest(&amp;baz)</code>)</a></em></p>\n\n<p><em><a href=\"https://play.golang.org/p/Tqg7LSl8LA\" rel=\"nofollow noreferrer\">Playground 2 (<code>&amp;baz.testFunc()</code>)</a></em></p>\n"}, {"tags": ["go", "streaming", "httpresponse"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1484593662, "post_id": 41682200, "comment_id": 70563853, "body": "What is timing out? Are you setting a timeout yourself, or is the remote server timing out? And please, always check your errors."}], "answers": [{"tags": [], "owner": {"reputation": 259, "user_id": 4548474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e5ea8283f095b898128b63da9fa0e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Matty", "link": "https://stackoverflow.com/users/4548474/matty"}, "is_accepted": true, "score": 0, "last_activity_date": 1484634464, "creation_date": 1484634464, "answer_id": 41690351, "question_id": 41682200, "link": "https://stackoverflow.com/questions/41682200/golang-is-timing-out-on-my-stream/41690351#41690351", "title": "Golang is timing out on my stream", "body": "<p>Turn out that the the market was closed for MLK Day and hence there was no response from the sever. </p>\n\n<p>After a certain timeout, the remote server times out.</p>\n"}], "owner": {"reputation": 259, "user_id": 4548474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e5ea8283f095b898128b63da9fa0e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Matty", "link": "https://stackoverflow.com/users/4548474/matty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 41690351, "answer_count": 1, "score": -2, "last_activity_date": 1484634464, "creation_date": 1484588954, "question_id": 41682200, "link": "https://stackoverflow.com/questions/41682200/golang-is-timing-out-on-my-stream", "title": "Golang is timing out on my stream", "body": "<p>I am trying to write a go server that receives a stream of data from an http request. The problem is that it times out once it receives <code>{status: connected}</code> How do I keep the connection alive?</p>\n\n<pre><code>func stream() {\n    t := time.Now()\n    a := t.Format(\"15:03\")\n    if a &gt; string(\"08:30\") &amp;&amp; a &lt; string(\"15:00\") {\n        color.Red(\"Streaming. . .\")\n        config := oauth1.NewConfig(\"HIDDEN\", \"HIDDEN\")\n        token := oauth1.NewToken(\"HIDDEN\", \"HIDDEN\")\n        httpClient := config.Client(oauth1.NoContext, token)\n        path := \"https://stream.tradeking.com/v1/market/quotes.json?symbols=aapl\"\n        resp, _ := httpClient.Get(path)\n        fmt.Println(resp)\n        body, _ := ioutil.ReadAll(resp.Body)\n        fmt.Printf(\"Raw Response Body:\\n%v\\n\", string(body))\n        defer resp.Body.Close()\n    } else {\n        color.Red(\"%s \\nMarkets are closed! Please, come back later.\", t)\n    }\n}\n</code></pre>\n\n<p>I call this function in main. I also receive what looks like the header:\n<code>&amp;{200 OK 200 HTTP/1.1 1 1 map[Date:[Mon, 16 Jan 2017 17:45:36 GMT] X-Powered-By:[Express] Server:[cloudflare-ngi\nnx] Content-Type:[application/json] Connection:[keep-alive] Set-Cookie:[__cfduid=dcfcf86c79c56e659ce2b1bade3643c\n981484588736; expires=Tue, 16-Jan-18 17:45:36 GMT; path=/; domain=.tradeking.com; HttpOnly] Vary:[Accept-Encodin\ng] Cf-Ray:[322361d0efd40938-DFW]] 0xc42032e0c0 -1 [chunked] false true map[] 0xc4200d21e0 0xc42040cbb0}</code></p>\n"}, {"tags": ["go", "handler", "reverse-proxy"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484664850, "post_id": 41681068, "comment_id": 70596315, "body": "I&#39;m not sure what you&#39;re asking? Are you trying to detect when the reverse proxy has detected the client disconnect? The docs state exactly when <code>Request.Context</code> is canceled: &quot;the context is canceled when the ServeHTTP method returns&quot;, which of course will happen after a client disconnects, but not always be caused by a disconnect."}, {"owner": {"reputation": 2563, "user_id": 2736017, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/uLQEA.jpg?s=128&g=1", "display_name": "vania-pooh", "link": "https://stackoverflow.com/users/2736017/vania-pooh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484740510, "post_id": 41681068, "comment_id": 70632067, "body": "Yes, my question is - will context be canceled in case of reverse proxy? From the code it&#39;s not clear."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484750600, "post_id": 41681068, "comment_id": 70639189, "body": "I&#39;m still not sure what you&#39;re asking besides what is documented -- the context is canceled when ServeHTTP returns. Maybe looking at the current code rather than go1.7 will answer your question, which has been updated to use the Context interface rather than the deprecated CancelRequest method."}], "owner": {"reputation": 2563, "user_id": 2736017, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/uLQEA.jpg?s=128&g=1", "display_name": "vania-pooh", "link": "https://stackoverflow.com/users/2736017/vania-pooh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484584906, "creation_date": 1484584906, "question_id": 41681068, "link": "https://stackoverflow.com/questions/41681068/golang-how-to-handle-reverse-proxy-client-disconnect", "title": "Golang: how to handle reverse proxy client disconnect", "body": "<p>Go <strong><a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\">httputil.ReverseProxy</a></strong> is known to automatically cancel proxying requests on client disconnect. This is implemented using <strong><a href=\"https://golang.org/pkg/net/http/#CloseNotifier\" rel=\"nofollow noreferrer\">http.CloseNotifier</a></strong> functionality. My question is - how can I handle client disconnect i.e. execute some callback action? Should I use <strong><a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">http.Request</a></strong> context like the following?</p>\n\n<pre><code>select {\ncase &lt;-r.Context().Done(): {\n    //Some action\n}\ndefault:\n}\n</code></pre>\n"}, {"tags": ["ajax", "go", "vue.js", "beego"], "comments": [{"owner": {"reputation": 2254, "user_id": 420096, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/988ae614387d311ba767cb053f77b915?s=128&d=identicon&r=PG", "display_name": "Sombriks", "link": "https://stackoverflow.com/users/420096/sombriks"}, "edited": false, "score": 0, "creation_date": 1484584577, "post_id": 41680798, "comment_id": 70559114, "body": "can you see the payload traffic in network tab under developer tools? just to make sure there&#39;s actual data being sent to the server."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484584778, "post_id": 41680798, "comment_id": 70559232, "body": "no beego expert, but it might be that a head method endpoint is also needed if you go cross domain"}, {"owner": {"reputation": 1592, "user_id": 1672261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/185c55d00bfcbf953b0d5c88ed0d6c75?s=128&d=identicon&r=PG&f=1", "display_name": "Alen", "link": "https://stackoverflow.com/users/1672261/alen"}, "reply_to_user": {"reputation": 2254, "user_id": 420096, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/988ae614387d311ba767cb053f77b915?s=128&d=identicon&r=PG", "display_name": "Sombriks", "link": "https://stackoverflow.com/users/420096/sombriks"}, "edited": false, "score": 0, "creation_date": 1484587640, "post_id": 41680798, "comment_id": 70560818, "body": "@Sombriks I checked, and there is data, {body: &quot;test&quot;}"}, {"owner": {"reputation": 1592, "user_id": 1672261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/185c55d00bfcbf953b0d5c88ed0d6c75?s=128&d=identicon&r=PG&f=1", "display_name": "Alen", "link": "https://stackoverflow.com/users/1672261/alen"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484587674, "post_id": 41680798, "comment_id": 70560831, "body": "@RickyA It&#39;s not cross domain, I&#39;m testing it on localhost"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484588986, "post_id": 41680798, "comment_id": 70561537, "body": "on the same port?"}, {"owner": {"reputation": 1592, "user_id": 1672261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/185c55d00bfcbf953b0d5c88ed0d6c75?s=128&d=identicon&r=PG&f=1", "display_name": "Alen", "link": "https://stackoverflow.com/users/1672261/alen"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484589245, "post_id": 41680798, "comment_id": 70561653, "body": "@RickyA Yes, the VueJS application is rendered inside Go template, I&#39;m bulding hybrid app, half is SPA and half is regular app.  I&#39;ve done this with PHP and it works great but can&#39;t implement it in Go"}], "answers": [{"tags": [], "owner": {"reputation": 1592, "user_id": 1672261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/185c55d00bfcbf953b0d5c88ed0d6c75?s=128&d=identicon&r=PG&f=1", "display_name": "Alen", "link": "https://stackoverflow.com/users/1672261/alen"}, "is_accepted": false, "score": 0, "last_activity_date": 1484596286, "creation_date": 1484596286, "answer_id": 41684022, "question_id": 41680798, "link": "https://stackoverflow.com/questions/41680798/beego-not-accepting-ajax-params/41684022#41684022", "title": "Beego not accepting ajax params", "body": "<p>It seems that Beego only accepts data with this header: <code>'Content-Type': 'multipart/form-data'</code> so after I added that header everything was ok.\nSince I didn't know how to do that with <code>axios</code> I switched to <code>vue-resource</code> and this is the example code which works with Beego:</p>\n\n<pre><code>this.$http.post(\"/\", {test: \"test\"}, {\n    emulateJSON: true\n});\n</code></pre>\n\n<p>Now you can print it like this:</p>\n\n<pre><code>fmt.Println(this.GetString(\"test\"))\n</code></pre>\n\n<p>I hope this helps someone</p>\n"}, {"tags": [], "owner": {"reputation": 3182, "user_id": 4788022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/debbef497a053890443b151e838eca08?s=128&d=identicon&r=PG", "display_name": "PanJunjie\u6f58\u4fca\u6770", "link": "https://stackoverflow.com/users/4788022/panjunjie%e6%bd%98%e4%bf%8a%e6%9d%b0"}, "is_accepted": false, "score": 0, "last_activity_date": 1484622890, "creation_date": 1484622890, "answer_id": 41688534, "question_id": 41680798, "link": "https://stackoverflow.com/questions/41680798/beego-not-accepting-ajax-params/41688534#41688534", "title": "Beego not accepting ajax params", "body": "<p>Just verified that axios and vue-resource use <code>application/json</code> by default. The <code>emulateJSON</code> you use here <a href=\"https://github.com/pagekit/vue-resource/blob/db9c0ccc9af812fd72c2e3ad7c7ce3a73b7f7b7f/docs/config.md#legacy-web-servers\" rel=\"nofollow noreferrer\">tells vue-resource to use <code>application/x-www-form-urlencoded</code></a>. You probably just need to do a json decode in beego because it by default treats request body as <code>urlencoded</code>.  </p>\n\n<p><code>multipart/form-data</code> works probably because it's been there for long(like <code>urlencoded</code>) so beego by default recognizes it. To use vue-resource to post a <code>multipart/form-data</code> request: <a href=\"https://github.com/pagekit/vue-resource/blob/db9c0ccc9af812fd72c2e3ad7c7ce3a73b7f7b7f/docs/recipes.md#forms\" rel=\"nofollow noreferrer\">use FormData</a>. <a href=\"https://github.com/mzabriskie/axios#request-config\" rel=\"nofollow noreferrer\">Axios also accepts a FormData as <code>data</code></a>.</p>\n"}], "owner": {"reputation": 1592, "user_id": 1672261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/185c55d00bfcbf953b0d5c88ed0d6c75?s=128&d=identicon&r=PG&f=1", "display_name": "Alen", "link": "https://stackoverflow.com/users/1672261/alen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484622890, "creation_date": 1484583960, "question_id": 41680798, "link": "https://stackoverflow.com/questions/41680798/beego-not-accepting-ajax-params", "title": "Beego not accepting ajax params", "body": "<p>I'm trying to make simple POST request using VueJS to an application which is written in Beego framework (GoLang) but the application doesn't see any input request. Everything is ok when I use standard form request (no ajax).\nThis is my VueJS code:</p>\n\n<pre><code>storePost: function(event) {\n    axios.post(\"/api/posts/store\", {body: \"test\"}).then(function(response) {\n        if (response.data.status == 200) {\n            this.posts.push(response.data.data);\n        }else {\n            console.log(\"error\");\n        }\n    }, function(response){\n        console.log(\"error\");\n    });\n}\n</code></pre>\n\n<p>and this is my Beego code:</p>\n\n<pre><code>// router.go\nbeego.Router(\"/api/posts/store\", &amp;controllers_API.PostsController{}, \"post:Store\")\n\n// PostsController.go\nfunc (this *PostsController) Store() {\n    fmt.Println(this.GetString(\"body\"))\n\n    // some irrelevant code which handles the response...\n}\n</code></pre>\n\n<p><code>fmt.Println</code> always prints nothing. When I use standard forms <code>fmt.Println</code> prints the value of the <code>body</code> with no problems.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484573650, "post_id": 41677358, "comment_id": 70552307, "body": "what is the <code>package</code> in your <code>data.go</code> file?"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484573979, "post_id": 41677358, "comment_id": 70552494, "body": "Editing with data.go in question"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484574109, "post_id": 41677358, "comment_id": 70552565, "body": "what happens when you do a direct build: <code>go build $gopath&#47;src&#47;googleglass_backend&#47;server.go</code>?"}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1484574229, "post_id": 41677358, "comment_id": 70552636, "body": "Try changing the struct and file name to something else - Data and data.go are very non-descriptive"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1484574231, "post_id": 41677358, "comment_id": 70552641, "body": "Since I&#39;m using google app engine, I dont have a main function. It says:  go build /Users/simon/Programming/golang_projects/src/googleglass_bac&zwnj;&#8203;kend/server.go  # command-line-arguments runtime.main: call to external function main.main runtime.main: main.main: not defined runtime.main: undefined: main.main"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1484574411, "post_id": 41677358, "comment_id": 70552740, "body": "@Sridhar, when I change it to beacondata, it says the same thing but with the new name. Am I importing them twice?"}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1484574497, "post_id": 41677358, "comment_id": 70552797, "body": "Yes it would appear so. What&#39;s your GOROOT?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1484574510, "post_id": 41677358, "comment_id": 70552804, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26794225/google-go-appengine-imports-and-conflicts-when-serving-testing\">Google Go AppEngine imports and conflicts when serving / testing</a>"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1484574591, "post_id": 41677358, "comment_id": 70552862, "body": "@Sridhar my GOROOT is blank.. But I dont think I am using GOROOT when using the google app engine? Am i?"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484574604, "post_id": 41677358, "comment_id": 70552873, "body": "@RickyA ill check that! Thanks"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484575287, "post_id": 41677358, "comment_id": 70553316, "body": "@RickyA Im following the instructions on that page you linked but I cant seem to get it working. I am positive that is the error, ie importing twice. I am trying to change my imports to not include the domain, only importing types, not googleglass_beacon/types. But that wont work.."}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 1, "creation_date": 1484575591, "post_id": 41677358, "comment_id": 70553534, "body": "Try moving types to /Users/simon/Programming/golang_projects/src/, i.e. up one directory and import in googleglass_beacon app as types"}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1484575676, "post_id": 41677358, "comment_id": 70553591, "body": "That&#39;s one of the solutions in the link that @RickyA posted. Make types a package outside the appengine directory."}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1484575912, "post_id": 41677358, "comment_id": 70553741, "body": "Hmm. That seems to work, but I wont be able to version stuff with git as easily now..?"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1484576321, "post_id": 41677358, "comment_id": 70554009, "body": "I cant really understand what to do with the last answer on this question? Can someone explain what files should be where? Since I dont think having types and handlers beside the project. <a href=\"http://stackoverflow.com/questions/26794225/google-go-appengine-imports-and-conflicts-when-serving-testing\" title=\"google go appengine imports and conflicts when serving testing\">stackoverflow.com/questions/26794225/&hellip;</a>"}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1484577742, "post_id": 41677358, "comment_id": 70554923, "body": "If you mean <a href=\"http://stackoverflow.com/a/34390759/1093710\">this</a> that&#39;s suggesting having only 2 files in the app folder - app.go (with init) and app.yaml. You could also just dump everything in the single folder and not have a separate package for types and handlers."}], "owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484574006, "creation_date": 1484572771, "last_edit_date": 1484574006, "question_id": 41677358, "link": "https://stackoverflow.com/questions/41677358/google-app-engine-cant-build", "title": "Google App Engine cant build", "body": "<p>Im having problem with building my project, i.e, \"goapp serve\".</p>\n\n<p>I get this message:</p>\n\n<pre><code>Failed to build Go application: (Executed command: /Users/simon/go_appengine/goroot/bin/go-app-builder -app_base /Users/simon/Programming/golang_projects/src/googleglass_backend -arch 6 -dynamic -goroot /Users/simon/go_appengine/goroot -gopath /Users/simon/Programming/golang_projects -nobuild_files ^^$ -incremental_rebuild -unsafe -print_extras_hash handlers/mainpage.go types/user.go types/data.go handlers/utils.go server.go)\n\n2017/01/16 14:04:30 go-app-builder: Failed parsing input: app file data.go conflicts with same file imported from GOPATH\n</code></pre>\n\n<p>My project structure looks like this:</p>\n\n<pre><code> golang_projects\n    bin\n       ...\n    pkg\n       ...\n    src\n       googleglass_backend\n           app.yaml\n           handlers\n               utils.go\n               mainpage.go\n           index.yaml\n           server.go\n           types\n               data.go\n               user.go\n</code></pre>\n\n<p>My GOPATH looks like this:</p>\n\n<pre><code>/Users/simon/Programming/golang_projects\n</code></pre>\n\n<p>I dont know what data.go could be conflicting with?</p>\n\n<p>My server.go file:</p>\n\n<pre><code>package main\n\nimport (\n    \"googleglass_backend/handlers\"\n    \"googleglass_backend/types\"\n\n    \"github.com/gorilla/mux\"\n    \"encoding/gob\"\n\n    \"net/http\"\n\n    \"github.com/rs/cors\"\n)\n\nfunc init() {\n    router := mux.NewRouter()\n    gob.Register(types.User{})\n    //For all includes in html files\n    router.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"web/static/\"))))\n\n    router.HandleFunc(\"/\", handlers.IndexTemplate)\n    handler := cors.Default().Handler(router)\n    http.Handle(\"/\", handler)\n\n}\n</code></pre>\n\n<p>Contents of data.go:</p>\n\n<pre><code>package types\n\nimport (\n    \"time\"\n)\n\ntype Data struct {\n    xaxis        int\n    yaxis        int\n    beacon_1     int\n    beacon_2     int\n    beacon_3     int\n    RegisterTime time.Time\n}\n</code></pre>\n"}, {"tags": ["c++", "go", "dll", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1484566264, "post_id": 41675205, "comment_id": 70547890, "body": "Mark your own answer as accepted -- this is a recommended practice on SO."}], "tags": [], "owner": {"reputation": 964, "user_id": 4104496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nvkZ6.jpg?s=128&g=1", "display_name": "Shashi Bhushan", "link": "https://stackoverflow.com/users/4104496/shashi-bhushan"}, "is_accepted": true, "score": 1, "last_activity_date": 1484565623, "creation_date": 1484565623, "answer_id": 41675205, "question_id": 41674590, "link": "https://stackoverflow.com/questions/41674590/how-to-make-a-callback-to-go-method-from-c-dll/41675205#41675205", "title": "How to make a callback to GO method from C++ DLL", "body": "<p>I found exactly what i was looking for. Posting here so that it may help other with this problem.</p>\n\n<p><a href=\"https://github.com/golang/go/wiki/cgo#function-pointer-callbacks\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/cgo#function-pointer-callbacks</a></p>\n"}], "owner": {"reputation": 964, "user_id": 4104496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nvkZ6.jpg?s=128&g=1", "display_name": "Shashi Bhushan", "link": "https://stackoverflow.com/users/4104496/shashi-bhushan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1315, "favorite_count": 0, "accepted_answer_id": 41675205, "answer_count": 1, "score": 0, "last_activity_date": 1484565623, "creation_date": 1484563646, "question_id": 41674590, "link": "https://stackoverflow.com/questions/41674590/how-to-make-a-callback-to-go-method-from-c-dll", "title": "How to make a callback to GO method from C++ DLL", "body": "<p>I have a GO program with a function that make a CGO call to c method defined in a dll. That part works great.. \nNow i need to make a callback from my dll to GO. Is that possible, any helping pointers ?  </p>\n\n<p>Note that my DLL code is separate codebase which gets compiled and linked separately to generate dll using visual studio. I'm on windows 10 64 bit machine. </p>\n"}, {"tags": ["go", "deadlock", "tcpserver"], "answers": [{"comments": [{"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1484567562, "post_id": 41674894, "comment_id": 70548645, "body": "The specifics are described at <a href=\"https://golang.org/ref/mem#tmp_7\" rel=\"nofollow noreferrer\">golang.org/ref/mem#tmp_7</a> (the &quot;Channel Communication&quot; section, should the anchor change)."}], "tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": true, "score": 4, "last_activity_date": 1484567655, "last_edit_date": 1484567655, "creation_date": 1484564546, "answer_id": 41674894, "question_id": 41674415, "link": "https://stackoverflow.com/questions/41674415/go-deadlock-issue-with-go-channel-and-select/41674894#41674894", "title": "Go : Deadlock issue with go channel and select", "body": "<p>In Go, an unbuffered channel is a \"synchronisation point\". That is, if you have a channel <code>c</code>, and do <code>c &lt;- value</code>, the goroutine blocks until someone is ready to do <code>v = &lt;- c</code> (and the converse holds, receiving from a blocking channel without something to receive blocks until the value is available, but this is possibly less surprising). Specifically, for a blocking channel, the receive completes before the send completes.</p>\n\n<p>Since you only have a single goroutine, it will be unable to loop back to reading from the channel and the write will block until something can read.</p>\n\n<p>You could, in theory, get around this by doing something like: <code>go func() { msg &lt;- fmt.Sprintf(\"Disconneting\", allConn[conn] }()</code>, so essentially spawning a short-lived goroutine to do the write.</p>\n"}], "owner": {"reputation": 169, "user_id": 1990250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hrA2h.jpg?s=128&g=1", "display_name": "Devarsh Shah", "link": "https://stackoverflow.com/users/1990250/devarsh-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 41674894, "answer_count": 1, "score": 0, "last_activity_date": 1484567655, "creation_date": 1484563022, "question_id": 41674415, "link": "https://stackoverflow.com/questions/41674415/go-deadlock-issue-with-go-channel-and-select", "title": "Go : Deadlock issue with go channel and select", "body": "<p>I've implemented a demo tcp chat server in golang, it works fine, but every time a user disconnects and I try to write a message to the broadcast channel to let other users know a user has disconnected it blocks, and would not further process any new messages from other client because its a nonbuffered channel</p>\n\n<p>I've commented by code and explained it you can go through it, I don't know why the code blocks, I've written msgs</p>\n\n<ol>\n<li>I'm about to write to a channel  </li>\n<li>I've written to the channel    </li>\n<li>I've read from the channel</li>\n</ol>\n\n<p>and messages are in perfect order still my msg channel blocks.</p>\n\n<p>Ps: If I'm using buffered channel the code is not blocking, but I want to know where is my code getting stuck.\nI also tried running my code with -race flag but no help</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"net\"\n    \"sync\"\n)\n\nfunc main() {\n    msg := make(chan string)          //broadcast channel (making it buffered channel the problem goes away)\n    allConn := make(map[net.Conn]int) //Collection of incoming connections for broadcasting the message\n    disConn := make(chan net.Conn)    //client disconnect channel\n    newConn := make(chan net.Conn)    //new client connection channel\n    mutext := new(sync.RWMutex)       //mux to assign unique id to incoming connections\n    i := 0\n    listener, err := net.Listen(\"tcp\", \"127.0.0.1:8081\")\n    checkErr(err)\n    fmt.Println(\"Tcp server started at 127.0.0.1:8081\")\n    //Accept incoming connections and store them in global connection store allConn\n    go func() {\n        for {\n            conn, err := listener.Accept()\n            checkErr(err)\n            mutext.Lock()\n            allConn[conn] = i\n            i++\n            mutext.Unlock()\n            newConn &lt;- conn\n        }\n    }()\n    for {\n        select {\n        //Wait for a new client message to arrive and broadcast the message\n        case umsg := &lt;-msg:\n            fmt.Println(\"Broadcast Channel: Already Read\")\n            bmsg := []byte(umsg)\n            for conn1, _ := range allConn {\n                _, err := conn1.Write(bmsg)\n                checkErr(err)\n            }\n\n        //Handle client disconnection [disConn]\n        case conn := &lt;-disConn:\n            mutext.RLock()\n            fmt.Println(\"user disconneting\", allConn[conn])\n            mutext.RUnlock()\n            delete(allConn, conn)\n            fmt.Println(\"Disconnect: About to Write\")\n            //this call results in deadlock even when channel is empty, buffered channel resolves the issue\n            //need to know why\n            msg &lt;- fmt.Sprintf(\"Disconneting\", allConn[conn])\n            fmt.Println(\"Disconnect: Already Written\")\n\n        //Read client incoming message and put it on broadcasting channel and upon disconnect put on it disConn channel\n        case conn := &lt;-newConn:\n            go func(conn net.Conn) {\n                for {\n                    buf := make([]byte, 64)\n                    n, err := conn.Read(buf)\n                    if err != nil {\n                        if err == io.EOF {\n                            disConn &lt;- conn\n                            break\n                        }\n                    }\n                    fmt.Println(\"Client: About to Write\")\n                    msg &lt;- string(buf[0:n])\n                    fmt.Println(\"Client: Already Written\")\n                }\n            }(conn)\n            mutext.RLock()\n            fmt.Println(\"User Connected\", allConn[conn])\n            mutext.RUnlock()\n        }\n    }\n}\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 2, "creation_date": 1484560865, "post_id": 41673576, "comment_id": 70544853, "body": "If you&#39;re not doing this for educational purposes, I would recommend you use <a href=\"http://www.thegeekstuff.com/2010/07/logrotate-examples\" rel=\"nofollow noreferrer\">logrotate</a> instead."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484562951, "post_id": 41673576, "comment_id": 70546069, "body": "Can you please explain the expected behaviour ? Is it supposed to watch a directory for files and every x duration it has to be zipped and moved to remote or it will rotate all existing log files in a directoy ?"}, {"owner": {"reputation": 59, "user_id": 2514007, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1dbdb537b79e8f0c15f535741539c500?s=128&d=identicon&r=PG", "display_name": "Mahesh Jadhav", "link": "https://stackoverflow.com/users/2514007/mahesh-jadhav"}, "edited": false, "score": 0, "creation_date": 1484565459, "post_id": 41673576, "comment_id": 70547479, "body": "File should be created with unique name after x duration..Each file should be monitored and rotated after filesize threshold or fileduration threshold is reached. It should not rotate all files in dir."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 2514007, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1dbdb537b79e8f0c15f535741539c500?s=128&d=identicon&r=PG", "display_name": "Mahesh Jadhav", "link": "https://stackoverflow.com/users/2514007/mahesh-jadhav"}, "edited": false, "score": 0, "creation_date": 1484566180, "post_id": 41674959, "comment_id": 70547844, "body": "Thanks Sarathsp. This has really helped optimizing the CPU"}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 3, "last_activity_date": 1484564766, "creation_date": 1484564766, "answer_id": 41674959, "question_id": 41673576, "link": "https://stackoverflow.com/questions/41673576/how-should-i-optimize-file-rotation-in-golang/41674959#41674959", "title": "how should I optimize file rotation in golang?", "body": "<p>The primary problem with your code is in the for loop all the time you are passing a <code>FileStruct</code> to the channel either <code>old</code> or <code>new</code> . So there is no wait time for the channel receive for data and inside the if loop you are doing stat on the file for getting its data which mostly you must have already done</p>\n\n<p>Here is strace on your program</p>\n\n<pre><code>% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n 93.58   11.835475        3793      3120       227 futex\n  6.38    0.807279           4    192048         1 stat\n  0.03    0.003284           9       366           sched_yield\n  0.01    0.000759           7       114           rt_sigaction\n  0.00    0.000271          90         3           openat\n  0.00    0.000197          10        19           mmap\n  0.00    0.000143          20         7           write\n  0.00    0.000071          24         3           clone\n  0.00    0.000064           8         8           rt_sigprocmask\n  0.00    0.000034          17         2           select\n  0.00    0.000021          11         2           read\n  0.00    0.000016          16         1           sched_getaffinity\n  0.00    0.000014          14         1           munmap\n  0.00    0.000014          14         1           execve\n  0.00    0.000013          13         1           arch_prctl\n  0.00    0.000011          11         1           close\n  0.00    0.000000           0         2           sigaltstack\n  0.00    0.000000           0         1           gettid\n------ ----------- ----------- --------- --------- ----------------\n100.00   12.647666                195700       228 total\n</code></pre>\n\n<p>Here with in around 40 seconds there are 195k system calls</p>\n\n<p>What you may do is add a wait time just after for</p>\n\n<pre><code>for { \n      &lt;- time.After(time.Second)\n       if file, ok := &lt;- rotate.File; ok{\n</code></pre>\n\n<p>And you may add <code>fileinfo</code> in the <code>FileStruct</code> and on every looping you may check for that in the struct first then only do the <code>stat</code></p>\n\n<p>Here is the strace after adding <code>&lt;- time.After(time.Second)</code></p>\n\n<pre><code>% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n 65.65    0.001512          35        43         1 futex\n 23.71    0.000546           5       114           rt_sigaction\n  3.04    0.000070           9         8           mmap\n  2.43    0.000056          19         3           clone\n  2.26    0.000052           7         8           rt_sigprocmask\n  0.56    0.000013           7         2           stat\n  0.48    0.000011          11         1           munmap\n  0.48    0.000011           6         2           sigaltstack\n  0.43    0.000010          10         1           execve\n  0.39    0.000009           9         1           sched_getaffinity\n  0.35    0.000008           8         1           arch_prctl\n  0.22    0.000005           5         1           gettid\n  0.00    0.000000           0         2           read\n  0.00    0.000000           0         3           write\n  0.00    0.000000           0         1           close\n  0.00    0.000000           0         1           openat\n------ ----------- ----------- --------- --------- ----------------\n100.00    0.002303                   192         1 total\n</code></pre>\n\n<h2>Conclusion</h2>\n\n<p>For same time duration code without <code>time.After()</code> made 195K system calls where the one with <code>time.After(time.Second)</code> made only 192 system calls. You can further improve it by adding already fetched file info as a part of <code>FileStruct</code></p>\n"}], "owner": {"reputation": 59, "user_id": 2514007, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1dbdb537b79e8f0c15f535741539c500?s=128&d=identicon&r=PG", "display_name": "Mahesh Jadhav", "link": "https://stackoverflow.com/users/2514007/mahesh-jadhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 1, "accepted_answer_id": 41674959, "answer_count": 1, "score": 0, "last_activity_date": 1484564766, "creation_date": 1484560382, "question_id": 41673576, "link": "https://stackoverflow.com/questions/41673576/how-should-i-optimize-file-rotation-in-golang", "title": "how should I optimize file rotation in golang?", "body": "<p>I had designed and implemented the file rotation of file in golang.\nAs per design I am rotating the file based on <code>filesize &gt;= FileSizeThreshold(50000bytes)</code> or <code>file duration &gt;= FileDurationThreshold(1 minute)</code> (whichever is first).</p>\n\n<p>Following is the implementation in golang.</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"path/filepath\"\n    \"time\"\n    \"log\"\n    \"strings\"\n    \"flag\"\n    \"os/exec\"\n)\ntype FileStruct struct{\n    Filename string\n    CreatedAt time.Time\n}\ntype FileRotate struct {\n    Dir string\n    File chan FileStruct\n}\n\nconst(\n    MAX_FILE_SIZE  = 50000\n    MAX_FILE_DURATION = time.Minute * 1\n    filename_time_format = \"20060102150405000\"\n    MAX_TRY = 5\n)\nvar blockingChan chan int\nfunc main(){\n    path := flag.String(\"dir\", \"\", \"absolute path of dir \")\n    flag.Parse()\n    if strings.Contains(*path, \"./\") {\n        log.Fatalln(\"ERROR: please give absolute path\")\n    }\n    if info, err := os.Stat(*path); err == nil{\n        if ! info.IsDir(){\n            log.Fatalln(*path,\" is not a directory\")\n        }\n        log.Println(\"directory found..\")\n    } else {\n        if os.IsNotExist(err){\n            log.Println(\"directory not found..\")\n            log.Println(\"creating the directory..\",*path)\n            if err := exec.Command(\"mkdir\",\"-p\",*path).Run(); err != nil{\n                log.Fatalln(\"failed to create the directory ERROR:\",err)\n            }\n            log.Println(\"directory created successfully\")\n        }\n    }\n    filerotate := &amp;FileRotate{*path,make(chan FileStruct,1)}\n    go filerotate.FileOperationsRoutine()\n\n    log.Println(\"generating file name struct..\")\n    filerotate.File &lt;- GetFileStruct()\n    &lt;- blockingChan\n}\n\nfunc (rotate *FileRotate) FileOperationsRoutine(){\n    try := 0\n    var f *os.File\n    for{\n        if file, ok := &lt;- rotate.File; ok{\n            if f == nil {\n                log.Println(\"WARN: file ptr is nil\")\n            }\n            filePath := filepath.Join(rotate.Dir, file.Filename)\n            fileInfo, err := os.Stat(filePath)\n            if err != nil &amp;&amp; os.IsNotExist(err) {\n                log.Println(\"file:\", filePath, \" does not exist...creating file\")\n                _, err = os.Create(filePath)\n                if err != nil {\n                    log.Println(\"failed to create the file ERROR:\",err)\n                    try++\n                    if try == MAX_TRY {\n                        log.Println(\"tried creating the file \",MAX_TRY,\" times. No luck\")\n                        time.Sleep(time.Second * 3)\n                        continue\n                    }\n                    rotate.File &lt;- file\n                    continue\n                }\n                log.Println(\"file:\", filePath, \" created successfully\")\n                fileInfo,err = os.Stat(filePath)\n            }\n            sizeCheck := fileInfo.Size() &gt;= MAX_FILE_SIZE\n            durationCheck := time.Now().After(file.CreatedAt.Add(MAX_FILE_DURATION))\n            if sizeCheck || durationCheck {\n                log.Println(\"filesize of \",filePath,\" is \",fileInfo.Size(),\"..filesizeCheck=\",sizeCheck)\n                log.Println(\"fileDurationCheck=\",durationCheck)\n                log.Println(\"rotating the file..\")\n                f.Close()\n                f = nil\n                go ZipAndSendRoutine(filePath)\n                rotate.File &lt;- GetFileStruct()\n            }else{\n                if f == nil {\n                    f, err = os.OpenFile(filePath, os.O_RDWR | os.O_APPEND, 0644)\n                    if err != nil {\n                        log.Println(\"failed to open the file ERROR:\", err)\n                        try++\n                        if try == MAX_TRY {\n                            log.Println(\"tried opening the file \", MAX_TRY, \" times. No luck\")\n                            time.Sleep(time.Second * 3)\n                            continue\n                        }\n                        rotate.File &lt;- file\n                        continue\n                    }\n                    log.Println(\"file opened in append mode\")\n                }\n                rotate.File &lt;- file\n            }\n        }\n    }\n}\n\nfunc GetFileStruct() FileStruct{\n    current_time := time.Now()\n    log.Println(\"returning the filestruct..\")\n    return FileStruct{\"example_\" + current_time.Format(filename_time_format),current_time}\n}\n\nfunc ZipAndSendRoutine(file string){\n    log.Println(\"zipping and sending the file:\",file,\"to remote server\")\n}\n</code></pre>\n\n<p>Execution log :</p>\n\n<pre><code>root@workstation:/media/sf_golang# ./bin/file_rotation -dir \"/tmp/file_rotaion\"\n2017/01/16 15:05:03 directory found..\n2017/01/16 15:05:03 starting file operations routine...\n2017/01/16 15:05:03 generating file name struct..\n2017/01/16 15:05:03 returning the filestruct..\n2017/01/16 15:05:03 WARN: file ptr is nil\n2017/01/16 15:05:03 file: /tmp/file_rotaion/example_20170116150503000  does not exist...creating file\n2017/01/16 15:05:03 file: /tmp/file_rotaion/example_20170116150503000  created successfully\n2017/01/16 15:05:03 file opened in append mode\n2017/01/16 15:06:03 filesize of  /tmp/file_rotaion/example_20170116150503000  is  0 ..filesizeCheck= false ...fileDurationCheck= true\n2017/01/16 15:06:03 rotating the file..\n2017/01/16 15:06:03 returning the filestruct..\n2017/01/16 15:06:03 WARN: file ptr is nil\n2017/01/16 15:06:03 file: /tmp/file_rotaion/example_20170116150603000  does not exist...creating file\n2017/01/16 15:06:03 file: /tmp/file_rotaion/example_20170116150603000  created successfully\n2017/01/16 15:06:03 file opened in append mode\n2017/01/16 15:06:03 zipping and sending the file: /tmp/file_rotaion/example_20170116150503000 to remote server\n2017/01/16 15:07:03 filesize of  /tmp/file_rotaion/example_20170116150603000  is  0 ..filesizeCheck= false ...fileDurationCheck= true\n2017/01/16 15:07:03 rotating the file..\n2017/01/16 15:07:03 returning the filestruct..\n2017/01/16 15:07:03 WARN: file ptr is nil\n2017/01/16 15:07:03 file: /tmp/file_rotaion/example_20170116150703000  does not exist...creating file\n2017/01/16 15:07:03 file: /tmp/file_rotaion/example_20170116150703000  created successfully\n2017/01/16 15:07:03 file opened in append mode\n2017/01/16 15:07:03 zipping and sending the file: /tmp/file_rotaion/example_20170116150603000 to remote server\n</code></pre>\n\n<p>As seen from the logs, the utility is working as expected. \nBut during the execution of this utility, CPU usage was almost 100%</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uen4F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uen4F.png\" alt=\"CPU utilization during process execution\"></a>\nAfter stopping the utility..\n<a href=\"https://i.stack.imgur.com/X3glG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X3glG.png\" alt=\"CPU utilization after process stopped\"></a>\nI have identified the cause of this: \n<code>FileOperations</code> goroutine is running indefinitely and within this routine I am sending the file pointer on <code>rotate.File</code> channel</p>\n\n<p>I am stuck at this point and not sure how to optimize this further.\nCould anyone tell me how should I optimize CPU utilization for this utility?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 737406, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9480929efdf8d1c9fee6bb46449a8288?s=128&d=identicon&r=PG", "display_name": "Shubhra", "link": "https://stackoverflow.com/users/737406/shubhra"}, "edited": false, "score": 1, "creation_date": 1484636742, "post_id": 41670589, "comment_id": 70578083, "body": "Thank you, its was very helpful."}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 8, "last_activity_date": 1558528433, "last_edit_date": 1558528433, "creation_date": 1484548005, "answer_id": 41670589, "question_id": 41670155, "link": "https://stackoverflow.com/questions/41670155/get-public-ip-in-golang/41670589#41670589", "title": "Get public IP in Golang", "body": "<p>The following IP blocks are reserved for private IP addresses.</p>\n\n<pre><code>Class        Starting IPAddress    Ending IP Address    # of Hosts\nA            10.0.0.0              10.255.255.255       16,777,216\nB            172.16.0.0            172.31.255.255       1,048,576\nC            192.168.0.0           192.168.255.255      65,536\nLink-local-u 169.254.0.0           169.254.255.255      65,536\nLink-local-m 224.0.0.0             224.0.0.255          256\nLocal        127.0.0.0             127.255.255.255      16777216\n</code></pre>\n\n<p>You may write a function that checks for if the ip comes under these</p>\n\n<p>Here is an attempt to do the same,the code below is not handling ipv6 please add if needed </p>\n\n<pre><code>func IsPublicIP(IP net.IP) bool {\n    if IP.IsLoopback() || IP.IsLinkLocalMulticast() || IP.IsLinkLocalUnicast() {\n        return false\n    }\n    if ip4 := IP.To4(); ip4 != nil {\n        switch {\n        case ip4[0] == 10:\n            return false\n        case ip4[0] == 172 &amp;&amp; ip4[1] &gt;= 16 &amp;&amp; ip4[1] &lt;= 31:\n            return false\n        case ip4[0] == 192 &amp;&amp; ip4[1] == 168:\n            return false\n        default:\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>Here is play <a href=\"https://play.golang.org/p/fhcq7C3u4Lo\" rel=\"nofollow noreferrer\">link</a> </p>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 5999876, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-dvp3atWOjTQ/AAAAAAAAAAI/AAAAAAAAAaE/ri-ebmLz1dA/photo.jpg?sz=128", "display_name": "Dowland Aiello", "link": "https://stackoverflow.com/users/5999876/dowland-aiello"}, "edited": false, "score": 2, "creation_date": 1533043407, "post_id": 42017521, "comment_id": 90194129, "body": "Unfortunately, this will only work on networks that don&#39;t employ the use of NAT. Please revise your answer."}, {"owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "edited": false, "score": 0, "creation_date": 1591164131, "post_id": 42017521, "comment_id": 109947277, "body": "this may return an private ip as well in case when your machine is behind the NAT"}], "tags": [], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "is_accepted": false, "score": -2, "last_activity_date": 1486100521, "creation_date": 1486100521, "answer_id": 42017521, "question_id": 41670155, "link": "https://stackoverflow.com/questions/41670155/get-public-ip-in-golang/42017521#42017521", "title": "Get public IP in Golang", "body": "<p>I use the following code for finding out public IP :</p>\n\n<pre><code>//function to get the public ip address\nfunc GetOutboundIP() string {\n    conn, err := net.Dial(\"udp\", \"8.8.8.8:80\")\n    HandleError(\"net.Dial: \",err)\n    defer conn.Close()\n    localAddr := conn.LocalAddr().String()\n    idx := strings.LastIndex(localAddr, \":\")\n    return localAddr[0:idx]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 14880468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6710e4cf7ea716096361d1f5227e475d?s=128&d=identicon&r=PG&f=1", "display_name": "Yariya", "link": "https://stackoverflow.com/users/14880468/yariya"}, "is_accepted": false, "score": 0, "last_activity_date": 1617020322, "creation_date": 1617020322, "answer_id": 66854089, "question_id": 41670155, "link": "https://stackoverflow.com/questions/41670155/get-public-ip-in-golang/66854089#66854089", "title": "Get public IP in Golang", "body": "<p>Using an IP api will 100% give you your public IP :</p>\n<pre><code>type IP struct {\n    Query string\n}\n\nfunc getip2() string {\n    req, err := http.Get(&quot;http://ip-api.com/json/&quot;)\n    if err != nil {\n        return err.Error()\n    }\n    defer req.Body.Close()\n\n    body, err := ioutil.ReadAll(req.Body)\n    if err != nil {\n        return err.Error()\n    }\n\n    var ip IP\n    json.Unmarshal(body, &amp;ip)\n\n    return ip.Query\n}\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 737406, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9480929efdf8d1c9fee6bb46449a8288?s=128&d=identicon&r=PG", "display_name": "Shubhra", "link": "https://stackoverflow.com/users/737406/shubhra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7884, "favorite_count": 0, "accepted_answer_id": 41670589, "answer_count": 3, "score": 2, "last_activity_date": 1617020322, "creation_date": 1484545674, "question_id": 41670155, "link": "https://stackoverflow.com/questions/41670155/get-public-ip-in-golang", "title": "Get public IP in Golang", "body": "<p>How do we get public IP in golang? Method <code>req.Header.Get(\"X-Forwarded-For\")</code> returns array of IPs. How do we identify which one is public and which on internal? Is there any other method to fetch public(external) IP? </p>\n"}, {"tags": ["arrays", "go", "input"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 6005455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/d5f9e96b8a84cb61cfa5c9fb445ada1a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael VEE", "link": "https://stackoverflow.com/users/6005455/michael-vee"}, "edited": false, "score": 0, "creation_date": 1597143178, "post_id": 41670081, "comment_id": 112031334, "body": "how can I test this function?"}], "tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": true, "score": 7, "last_activity_date": 1484545175, "creation_date": 1484545175, "answer_id": 41670081, "question_id": 41669840, "link": "https://stackoverflow.com/questions/41669840/how-to-read-a-list-of-numbers-into-an-array-in-go/41670081#41670081", "title": "How to read a list of numbers into an Array in Go", "body": "<p>What you are using is slices not arrays. Arrays can only be used when you know the length at compile time.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    length := 0\n    fmt.Println(\"Enter the number of inputs\")\n    fmt.Scanln(&amp;length)\n    fmt.Println(\"Enter the inputs\")\n    numbers := make([]int, length)\n    for i := 0; i &lt; length; i++ {\n        fmt.Scanln(&amp;numbers[i])\n    }\n    fmt.Println(numbers)\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6643210, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa44986fcb2caa1a389735cf23744508?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/6643210/manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3229, "favorite_count": 0, "accepted_answer_id": 41670081, "answer_count": 1, "score": 3, "last_activity_date": 1581009028, "creation_date": 1484543650, "question_id": 41669840, "link": "https://stackoverflow.com/questions/41669840/how-to-read-a-list-of-numbers-into-an-array-in-go", "title": "How to read a list of numbers into an Array in Go", "body": "<p>I want to read a list of numbers given by the user into an array and perform operations on them.</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {\n    var n,c,i int\n    var a []int    \nfmt.Println(\"Enter the number of inputs\")\n fmt.Scanln(&amp;n)\nfmt.Println(\"Enter the inputs\")\n for i=0 ; i&lt;n-1; i++ {\n     fmt.Scanln(&amp;c)\n}\n    fmt.Println(a[i]) \n}\n</code></pre>\n\n<p>Can someone help me out.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1484583575, "post_id": 41669605, "comment_id": 70558570, "body": "Needs to be <code>err.(*net.DNSError)</code>.  The DNSError type is always returned by address (as one should usually do when storing an object in an interface), so the type assertion <code>err.(net.DNSError)</code> will always fail."}, {"owner": {"reputation": 195, "user_id": 1462575, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84d6e3eac75a18d138c6a78977fcc0e8?s=128&d=identicon&r=PG", "display_name": "Riley Guerin", "link": "https://stackoverflow.com/users/1462575/riley-guerin"}, "edited": false, "score": 0, "creation_date": 1484608599, "post_id": 41669605, "comment_id": 70570275, "body": "how did you figure that out? what is the process?"}, {"owner": {"reputation": 1756, "user_id": 2679770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cJ5uH.jpg?s=128&g=1", "display_name": "darxtrix", "link": "https://stackoverflow.com/users/2679770/darxtrix"}, "reply_to_user": {"reputation": 195, "user_id": 1462575, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84d6e3eac75a18d138c6a78977fcc0e8?s=128&d=identicon&r=PG", "display_name": "Riley Guerin", "link": "https://stackoverflow.com/users/1462575/riley-guerin"}, "edited": false, "score": 1, "creation_date": 1556045270, "post_id": 41669605, "comment_id": 98301749, "body": "@RileyGuerin This might help <code>fmt.Println(reflect.TypeOf(err))</code>"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 2, "last_activity_date": 1484542052, "creation_date": 1484542052, "answer_id": 41669605, "question_id": 41669475, "link": "https://stackoverflow.com/questions/41669475/golang-idiomatic-way-to-detect-no-such-host-error/41669605#41669605", "title": "golang idiomatic way to detect no such host error", "body": "<p>I think you can use <a href=\"https://golang.org/src/net/net.go?s=16532:16823#L541\" rel=\"nofollow noreferrer\">DNSError</a> type instead of common <code>Error</code>.</p>\n\n<pre><code>err, ok := err.(net.DNSError)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 4797577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d63b3f2ac2be5e0fc87da8170fdb6e?s=128&d=identicon&r=PG&f=1", "display_name": "Musab G&#252;ltekin", "link": "https://stackoverflow.com/users/4797577/musab-g%c3%bcltekin"}, "is_accepted": false, "score": 1, "last_activity_date": 1618646870, "last_edit_date": 1618646870, "creation_date": 1546551299, "answer_id": 54030114, "question_id": 41669475, "link": "https://stackoverflow.com/questions/41669475/golang-idiomatic-way-to-detect-no-such-host-error/54030114#54030114", "title": "golang idiomatic way to detect no such host error", "body": "<p><strong>As Of Go 1.13:</strong>\nYou can use <a href=\"https://golang.org/pkg/errors/#As\" rel=\"nofollow noreferrer\">errors.As</a></p>\n<pre><code>var dnsError *net.DNSError\nif errors.As(err, &amp;dnsError) {\n    fmt.Println(&quot;DNS Error&quot;, dnsError)\n}\n</code></pre>\n<p><strong>Original Answer:</strong></p>\n<p>You can check DNS errors with this code. For example if <strong>err</strong> is our error:</p>\n<pre><code>if err, ok := err.(*url.Error); ok {\n    if err, ok := err.Err.(*net.OpError); ok {\n        if _, ok := err.Err.(*net.DNSError); ok {\n            retry(r)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 1462575, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/84d6e3eac75a18d138c6a78977fcc0e8?s=128&d=identicon&r=PG", "display_name": "Riley Guerin", "link": "https://stackoverflow.com/users/1462575/riley-guerin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1619, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1618646870, "creation_date": 1484541077, "question_id": 41669475, "link": "https://stackoverflow.com/questions/41669475/golang-idiomatic-way-to-detect-no-such-host-error", "title": "golang idiomatic way to detect no such host error", "body": "<p>I am using this but it doesn't feel right:</p>\n\n<pre><code>if err, ok := err.(net.Error); ok {\n    var message string\n    if err.Timeout() {\n        message = \"Timeout\"\n    } else if strings.HasSuffix(err.Error(), \"no such host\") {\n        message = \"No such host\"\n    }\n}\n</code></pre>\n\n<p>Is there a more idiomatic way?</p>\n"}, {"tags": ["arrays", "json", "go"], "comments": [{"owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "edited": false, "score": 0, "creation_date": 1484541554, "post_id": 41669446, "comment_id": 70537001, "body": "I put the code on GoLang Playground to make it easier to see what I&#39;m seeing: <a href=\"https://play.golang.org/p/Pebw7UgGRC\" rel=\"nofollow noreferrer\">play.golang.org/p/Pebw7UgGRC</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 2, "last_activity_date": 1484586463, "last_edit_date": 1484586463, "creation_date": 1484542063, "answer_id": 41669607, "question_id": 41669446, "link": "https://stackoverflow.com/questions/41669446/go-lang-decode-json-simple-array-not-being-picked-up/41669607#41669607", "title": "GO Lang decode JSON (simple array not being picked up)", "body": "<p>The <strong>encoded</strong> string isn't a valid JSON, easy to detect because you're ignoring an important error on Unmarshal, try this:</p>\n\n<pre><code>err := json.Unmarshal(data, &amp;x)\nfmt.Println(err)\n</code></pre>\n\n<p>It looks like you missed the last '}' of your JSON.</p>\n"}, {"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1484542195, "creation_date": 1484542195, "answer_id": 41669623, "question_id": 41669446, "link": "https://stackoverflow.com/questions/41669446/go-lang-decode-json-simple-array-not-being-picked-up/41669623#41669623", "title": "GO Lang decode JSON (simple array not being picked up)", "body": "<p>Your base64-encoded string is not valid:</p>\n\n<pre><code>illegal base64 data at input byte 404\n</code></pre>\n"}], "owner": {"reputation": 1745, "user_id": 3888307, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65d6a22ea2fb9fb7a3d78bd57b9d71ea?s=128&d=identicon&r=PG&f=1", "display_name": "user3888307", "link": "https://stackoverflow.com/users/3888307/user3888307"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 41669607, "answer_count": 2, "score": 0, "last_activity_date": 1484586463, "creation_date": 1484540844, "question_id": 41669446, "link": "https://stackoverflow.com/questions/41669446/go-lang-decode-json-simple-array-not-being-picked-up", "title": "GO Lang decode JSON (simple array not being picked up)", "body": "<p>Structs and JSON are not super fun in Go.</p>\n\n<p>I have a simple example of some JSON, and a struct. Everything seems to get parsed Okay, but for some reason the array does not get picked up.</p>\n\n<p>Can anyone tell me what I might be missing.</p>\n\n<p>Code---\n    package main</p>\n\n<pre><code>import (\n    \"encoding/base64\"\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype Oauth struct {\nAud string   `json:\"aud\"`\nCid string   `json:\"cid\"`\nExp int      `json:\"exp\"`\nIat int      `json:\"iat\"`\nIss string   `json:\"iss\"`\nJti string   `json:\"jti\"`\nScp []string `json:\"scp\"`\nSub string   `json:\"sub\"`\nUID string   `json:\"uid\"`\nVer int      `json:\"ver\"`\n}\n\nfunc main () {\n\n// This is the String {\"ver\":1,\"jti\":\"AT.zgv9oQpw-7l3BCg6Xb5NCG2Pf8zxgiQa1EUBXycmaDk\",\"iss\":\"https://companyx.okta.com/oauth2/aus1a4ibdat0JYw5s1d8\",\"aud\":\"http://localhost\",\"iat\":1484538606,\"exp\":1484542206,\"cid\":\"3jmNvVCFZ5F6lWOzIONO\",\"uid\":\"00uy74c0h7NGTLBSXQOC\",\"scp\":[\"read\",\"remove\",\"reserve\"],\"sub\":\"oktaadmin@okta.com\"}\nencoded := \"eyJ2ZXIiOjEsImp0aSI6IkFULnpndjlvUXB3LTdsM0JDZzZYYjVOQ0cyUGY4enhnaVFhMUVVQlh5Y21hRGsiLCJpc3MiOiJodHRwczovL2NvbXBhbnl4Lm9rdGEuY29tL29hdXRoMi9hdXMxYTRpYmRhdDBKWXc1czFkOCIsImF1ZCI6Imh0dHA6Ly9sb2NhbGhvc3QiLCJpYXQiOjE0ODQ1Mzg2MDYsImV4cCI6MTQ4NDU0MjIwNiwiY2lkIjoiM2ptTnZWQ0ZaNUY2bFdPeklPTk8iLCJ1aWQiOiIwMHV5NzRjMGg3TkdUTEJTWFFPQyIsInNjcCI6WyJyZWFkIiwicmVtb3ZlIiwicmVzZXJ2ZSJdLCJzdWIiOiJva3RhYWRtaW5Ab2t0YS5jb20ifQ\"\n\ndata, _ := base64.StdEncoding.DecodeString(encoded)\n\nfmt.Println(string(data))\nfmt.Println (\"\")\n\nvar x Oauth\njson.Unmarshal([]byte(data), &amp;x)\nfmt.Printf (\"%+v\",x.Scp);\n\n}\n</code></pre>\n\n<p>The result is always an Empty Array []</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484535912, "post_id": 41668644, "comment_id": 70535778, "body": "You need to allocate space to read into. You&#39;re only providing a nil slice, so Read can&#39;t <i>read</i> anything."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 1, "creation_date": 1484536523, "post_id": 41668644, "comment_id": 70535904, "body": "Read reads up to len(html) bytes into html , here it is zero"}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 1, "last_activity_date": 1484535131, "creation_date": 1484535131, "answer_id": 41668781, "question_id": 41668644, "link": "https://stackoverflow.com/questions/41668644/how-to-use-http-response-method-read-in-go/41668781#41668781", "title": "How to use http Response method Read in go?", "body": "<p>Try to use \"io/ioutil\" package:</p>\n\n<pre><code>import \"io/ioutil\"\n...\nbody, err := ioutil.ReadAll(resp.Body)\nresp.Body.Close()\nfmt.Println(string(body)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 0, "last_activity_date": 1484535231, "creation_date": 1484535231, "answer_id": 41668787, "question_id": 41668644, "link": "https://stackoverflow.com/questions/41668644/how-to-use-http-response-method-read-in-go/41668787#41668787", "title": "How to use http Response method Read in go?", "body": "<p>You're missing a good helper and friend <a href=\"https://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"nofollow noreferrer\">ReadAll()</a></p>\n\n<p>Your code should looks like this:</p>\n\n<pre><code>import \"io/ioutil\"\n\nresp, err := http.Get(\"https://example.com\")\n// check err\n\ndefer resp.Body.Close() // we have to close Body if we want to reuse the connection\n\nhtml, err := ioutil.ReadAll(resp.Body)\n// check err\n\nfmt.Println(string(html))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 7, "last_activity_date": 1594702668, "last_edit_date": 1594702668, "creation_date": 1484536443, "answer_id": 41668945, "question_id": 41668644, "link": "https://stackoverflow.com/questions/41668644/how-to-use-http-response-method-read-in-go/41668945#41668945", "title": "How to use http Response method Read in go?", "body": "<p>short answer: You are passing a slice <code>html</code> where its len would be '0' and Read reads up to <code>len(html)</code> bytes into html</p>\n<p>Here is snippet from <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\">https://golang.org/pkg/io/#Reader</a></p>\n<blockquote>\n<p>Read reads up to len(p) bytes into p. It returns the number of bytes\nread (0 &lt;= n &lt;= len(p)) and any error encountered. Even if Read\nreturns n &lt; len(p), it may use all of p as scratch space during the\ncall. If some data is available but not len(p) bytes, Read\nconventionally returns what is available instead of waiting for more.</p>\n</blockquote>\n<p>Now what you may do  use <code>ioutil</code> and update the code as</p>\n<pre><code>body, err := ioutil.ReadAll(resp.Body)\n</code></pre>\n<p>Code</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;net/http&quot;\n)\n\nfunc main() {\n    resp, err := http.Get(&quot;http://httpbin.org/ip&quot;)\n    if err != nil {\n        fmt.Println(&quot;Error making request&quot;, err.Error())\n        return\n    }\n    defer resp.Body.Close()\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Println(&quot;Error reading response&quot;, err.Error())\n        return\n    }\n    fmt.Println(&quot;Response\\n&quot;, string(body))\n}\n</code></pre>\n<p>Here is play <a href=\"https://play.golang.org/p/9w9N2VK5iUJ\" rel=\"nofollow noreferrer\">link</a>, in go playground HTTP requests won't work it is a security precaution so you may test this in your machine</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3520, "favorite_count": 1, "accepted_answer_id": 41668945, "answer_count": 3, "score": 2, "last_activity_date": 1594702668, "creation_date": 1484533800, "last_edit_date": 1484538515, "question_id": 41668644, "link": "https://stackoverflow.com/questions/41668644/how-to-use-http-response-method-read-in-go", "title": "How to use http Response method Read in go?", "body": "<p>It's been a while since I dealt with go and I seem to have forgotten how to read the docs. </p>\n\n<p>If I do a get request like this...</p>\n\n<pre><code>resp, err := http.Get(\"https://example.com\")\n</code></pre>\n\n<p>I then see that the response has a <code>Body</code> that is of an <code>io.ReadCloser</code> type (<a href=\"https://golang.org/pkg/io/#ReadCloser\" rel=\"nofollow noreferrer\">https://golang.org/pkg/io/#ReadCloser</a>). I see the ReadCloser is an interface to <code>Reader</code> and <code>Closer</code>.</p>\n\n<p>When I look at the <code>Reader</code> interface I see it has a <code>Read</code> method that reads bytes into <code>p</code> (<a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\">https://golang.org/pkg/io/#Reader</a>).</p>\n\n<p>To recap, the http <code>Response</code> has a body which is a <code>io.ReadCloser</code> Interface which itself contains a <code>Reader</code> interface which has a <code>Read</code> method.</p>\n\n<p>When I try this I would expect to <code>Read</code> the response bytes into HTML, but I see nothing...</p>\n\n<pre><code>var html []byte\nnum, err := resp.Body.Read(html)\nfmt.Println(\"\\n\\thtml: \", html)\nfmt.Printf(\"\\n\\tnum: %v, err: %v\\n\", num, err)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>html:  []\nnum: 0, err: &lt;nil&gt;\n</code></pre>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": false, "score": 0, "last_activity_date": 1484528656, "creation_date": 1484528656, "answer_id": 41668119, "question_id": 41668053, "link": "https://stackoverflow.com/questions/41668053/cap-vs-len-of-slice-in-golang/41668119#41668119", "title": "cap vs len of slice in golang", "body": "<p>You've answered your question - the length of the underlying array in a slice is not necessarily the same as the number of elements that array contains.</p>\n"}, {"tags": [], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "is_accepted": false, "score": 7, "last_activity_date": 1484529048, "creation_date": 1484529048, "answer_id": 41668169, "question_id": 41668053, "link": "https://stackoverflow.com/questions/41668053/cap-vs-len-of-slice-in-golang/41668169#41668169", "title": "cap vs len of slice in golang", "body": "<p>From the <a href=\"https://golang.org/src/builtin/builtin.go?s=5727:5747#L145\" rel=\"noreferrer\">source code</a>:</p>\n\n<pre><code>// The len built-in function returns the length of v, according to its type:\n//  Array: the number of elements in v.\n//  Pointer to array: the number of elements in *v (even if v is nil).\n//  Slice, or map: the number of elements in v; if v is nil, len(v) is zero.\n//  String: the number of bytes in v.\n//  Channel: the number of elements queued (unread) in the channel buffer;\n//  if v is nil, len(v) is zero.\nfunc len(v Type) int\n\n// The cap built-in function returns the capacity of v, according to its type:\n//  Array: the number of elements in v (same as len(v)).\n//  Pointer to array: the number of elements in *v (same as len(v)).\n//  Slice: the maximum length the slice can reach when resliced;\n//  if v is nil, cap(v) is zero.\n//  Channel: the channel buffer capacity, in units of elements;\n//  if v is nil, cap(v) is zero.\nfunc cap(v Type) int\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2111, "user_id": 2159730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QLdPH.jpg?s=128&g=1", "display_name": "Randy Howard", "link": "https://stackoverflow.com/users/2159730/randy-howard"}, "edited": false, "score": 2, "creation_date": 1517417345, "post_id": 41668362, "comment_id": 84090383, "body": "Great answer.  The OP may not care anymore, but I can see this being helpful for a lot of people that may find it down the road."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 2111, "user_id": 2159730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QLdPH.jpg?s=128&g=1", "display_name": "Randy Howard", "link": "https://stackoverflow.com/users/2159730/randy-howard"}, "edited": false, "score": 2, "creation_date": 1517424716, "post_id": 41668362, "comment_id": 84094812, "body": "@RandyHoward Thanks, I appreciate that. I find knowing that the pointer address changes to be quite important."}, {"owner": {"reputation": 191, "user_id": 2767346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/KY1uq.png?s=128&g=1", "display_name": "Brad Ellis", "link": "https://stackoverflow.com/users/2767346/brad-ellis"}, "edited": false, "score": 1, "creation_date": 1517585091, "post_id": 41668362, "comment_id": 84168456, "body": "@jmaloney. This is very helpful.  One thing I&#39;m still having trouble understanding is that the nil value for arrays and slices is zero (not nil or null) so, how can the length ever actually be different than the capacity. Shouldn&#39;t each element in a slice of capacity 3 have {1,0,0} in the first iteration...giving the len to be 3 not 1?  I mean if it&#39;s just convention, I don&#39;t understand the logic in that convention.  Am I just missing something or should I just accept it as is?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 191, "user_id": 2767346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/KY1uq.png?s=128&g=1", "display_name": "Brad Ellis", "link": "https://stackoverflow.com/users/2767346/brad-ellis"}, "edited": false, "score": 3, "creation_date": 1517603560, "post_id": 41668362, "comment_id": 84178127, "body": "@BradEllis Arrays unlike slices do not have a nil value. When you create an array <code>var array [3]int</code> you are explicitly allocating the capacity and length of an array. When speaking of an array in Go the cap and len functions are the same. You need to remember that a slice in Go is a data type that utilizes an array but is not the array. So when you call <code>cap(someSlice)</code> you are checking the capacity or length of the underline array, but when you call <code>len(someSlice)</code> you are checking how many items you explicitly added to the slice. Exampe: <a href=\"https://play.golang.org/p/ahlHLkD4_Wt\" rel=\"nofollow noreferrer\">play.golang.org/p/ahlHLkD4_Wt</a>"}, {"owner": {"reputation": 8565, "user_id": 4221433, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19e2y.jpg?s=128&g=1", "display_name": "Vikas Bansal", "link": "https://stackoverflow.com/users/4221433/vikas-bansal"}, "edited": false, "score": 1, "creation_date": 1536313613, "post_id": 41668362, "comment_id": 91388115, "body": "go is doubling the <code>cap</code> when it reaches the cap.. why? is it a good thing ... e.g. to added <code>769</code> items array cap will be <code>1536</code>"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 8565, "user_id": 4221433, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19e2y.jpg?s=128&g=1", "display_name": "Vikas Bansal", "link": "https://stackoverflow.com/users/4221433/vikas-bansal"}, "edited": false, "score": 0, "creation_date": 1536336759, "post_id": 41668362, "comment_id": 91401896, "body": "@VikasBansal It&#39;s an optimization to avoid constant allocation. For instance say you were appending a bunch of items to a slice in a for loop, the performance would be terrible if you had to constantly re-allocate the memory for the underlining array."}, {"owner": {"reputation": 5455, "user_id": 703529, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh3.googleusercontent.com/-G-kFsAfpLpU/AAAAAAAAAAI/AAAAAAAAAJE/8uMPWwMFaD0/photo.jpg?sz=128", "display_name": "serkan", "link": "https://stackoverflow.com/users/703529/serkan"}, "edited": false, "score": 0, "creation_date": 1591133774, "post_id": 41668362, "comment_id": 109939594, "body": "when the size exceeds the capacity it doubles. i am not sure if it was working previously otherwise but now it just doubles."}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 5455, "user_id": 703529, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh3.googleusercontent.com/-G-kFsAfpLpU/AAAAAAAAAAI/AAAAAAAAAJE/8uMPWwMFaD0/photo.jpg?sz=128", "display_name": "serkan", "link": "https://stackoverflow.com/users/703529/serkan"}, "edited": false, "score": 0, "creation_date": 1591136550, "post_id": 41668362, "comment_id": 109940473, "body": "@serkan I&#39;m guessing one of the recent Go releases changed how append resized the underline array."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 107, "last_activity_date": 1591125329, "last_edit_date": 1591125329, "creation_date": 1484531087, "answer_id": 41668362, "question_id": 41668053, "link": "https://stackoverflow.com/questions/41668053/cap-vs-len-of-slice-in-golang/41668362#41668362", "title": "cap vs len of slice in golang", "body": "<p>A slice is an abstraction that uses an array under the covers.</p>\n\n<p><code>cap</code> tells you the capacity of the underlying array. <code>len</code> tells you how many items are in the array.</p>\n\n<p>The slice abstraction in Go is very nice since it will resize the underlying array for you, plus in Go arrays cannot be resized so slices are almost always used instead.</p>\n\n<p>Example:</p>\n\n<pre><code>s := make([]int, 0, 3)\nfor i := 0; i &lt; 5; i++ {\n    s = append(s, i)\n    fmt.Printf(\"cap %v, len %v, %p\\n\", cap(s), len(s), s)\n}\n</code></pre>\n\n<p>Will output something like this:</p>\n\n<pre><code>cap 3, len 1, 0x1040e130\ncap 3, len 2, 0x1040e130\ncap 3, len 3, 0x1040e130\ncap 6, len 4, 0x10432220\ncap 6, len 5, 0x10432220\n</code></pre>\n\n<p>As you can see once the capacity is met, <code>append</code> will return a new slice with a larger capacity. On the 4th iteration you will notice a larger capacity and a new pointer address.</p>\n\n<p><a href=\"https://play.golang.org/p/RhhsGgFYI1\" rel=\"noreferrer\">Play example</a></p>\n\n<p>I realize you did not ask about arrays and append but they are pretty foundational in understanding the slice and the reason for the builtins.</p>\n"}], "owner": {"reputation": 18201, "user_id": 586227, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/bb85f92a56d4431cb1c74357a755d68f?s=128&d=identicon&r=PG", "display_name": "Ali Adravi", "link": "https://stackoverflow.com/users/586227/ali-adravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20693, "favorite_count": 10, "accepted_answer_id": 41668362, "answer_count": 3, "score": 38, "last_activity_date": 1591125329, "creation_date": 1484527883, "question_id": 41668053, "link": "https://stackoverflow.com/questions/41668053/cap-vs-len-of-slice-in-golang", "title": "cap vs len of slice in golang", "body": "<p>What is the difference between cap and len of a slice in golang?</p>\n\n<p>According to definition:</p>\n\n<p>A slice has both a length and a capacity.</p>\n\n<p>The length of a slice is the number of elements it contains.</p>\n\n<p>The capacity of a slice is the number of elements in the underlying array, counting from the first element in the slice.</p>\n\n<pre><code>x := make([]int, 0, 5) // len(b)=0, cap(b)=5\n</code></pre>\n\n<p>Does the len mean non null values only?</p>\n"}, {"tags": ["api", "go", "quandl"], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 4548474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e5ea8283f095b898128b63da9fa0e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Matty", "link": "https://stackoverflow.com/users/4548474/matty"}, "edited": false, "score": 0, "creation_date": 1484511628, "post_id": 41665747, "comment_id": 70529935, "body": "Both examples work. Thanks.  Why is type assertion needed before printing? It doesn&#39;t change the type? What allows it to index? Maybe I am misunderstanding the code above."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 259, "user_id": 4548474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e5ea8283f095b898128b63da9fa0e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Matty", "link": "https://stackoverflow.com/users/4548474/matty"}, "edited": false, "score": 1, "creation_date": 1484512343, "post_id": 41665747, "comment_id": 70530162, "body": "You can&#39;t apply an index to something that isn&#39;t a slice type. So if you have an item of type <code>interface{}</code>, you can&#39;t index it. When you do the type assertion, you&#39;re creating an item of <code>[]interface{}</code>, which is a slice, so you can index it."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 1, "last_activity_date": 1484510836, "creation_date": 1484510836, "answer_id": 41665747, "question_id": 41665383, "link": "https://stackoverflow.com/questions/41665383/accessing-data-from-interfaces-in-go/41665747#41665747", "title": "Accessing Data From Interfaces in Go", "body": "<p>If you know that the type of <code>Data</code> is <code>[]interface{}</code>, you can do a type assertion:</p>\n\n<pre><code>slice := result.Data.([]interface{})\nfmt.Println(slice[0])\n</code></pre>\n\n<p>If there are several possibilities for the type of <code>Data</code>, you can use a type switch:</p>\n\n<pre><code>switch data := result.Data.(type) {\ncase []interface{}:\n    fmt.Println(data[0])\ncase string:\n    fmt.Println(data)\ndefault:\n    // unexpected type\n}\n</code></pre>\n\n<p>You may also want to look at the <code>reflect</code> package if your requirements are more complicated.</p>\n"}], "owner": {"reputation": 259, "user_id": 4548474, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e5ea8283f095b898128b63da9fa0e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Matty", "link": "https://stackoverflow.com/users/4548474/matty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1419, "favorite_count": 0, "accepted_answer_id": 41665747, "answer_count": 1, "score": 0, "last_activity_date": 1484510836, "creation_date": 1484508604, "question_id": 41665383, "link": "https://stackoverflow.com/questions/41665383/accessing-data-from-interfaces-in-go", "title": "Accessing Data From Interfaces in Go", "body": "<p>I am trying to implement a simple api in Golang. My experience in the backend is more with python and node, so I am having some difficulty printing out data held within the interface since it won't allow me to index it. I have searched around and several people have asked similar questions when the interface is one value, but not when the interface is a <code>slice</code>, I believe ([]interface{}). I have tried vaping the interface to no avail.</p>\n\n<p>When I point the browser to <code>/quandl/ddd/10</code> I would like to <code>fmt.Println</code> the specific numerical data, i.e. (\"2017-01-13\",\n15.67,\n16.41,\n15.67,\n16.11,\n3595248,\n0,\n1,\n15.67,\n16.41,\n15.67,\n16.11,\n3595248\n])</p>\n\n<pre><code> package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"net/url\"\n\n    \"github.com/fatih/color\"\n    \"github.com/gorilla/mux\"\n)\n\ntype QuandlResponse struct {\n    SourceCode string      `json:\"source_code\"`\n    SourceName string      `json:\"source_name\"`\n    Code       string      `json:\"code\"`\n    Frequency  string      `json:\"frequency\"`\n    FromDate   string      `json:\"from_date\"`\n    ToDate     string      `json:\"to_date\"`\n    Columns    []string    `json:\"column_names\"`\n    Data       interface{} `json:\"data\"`\n}\n\nfunc getContent(w http.ResponseWriter, r *http.Request) {\n    stock := mux.Vars(r)[\"stock\"]\n    limit := mux.Vars(r)[\"limit\"]\n    url := \"https://www.quandl.com/api/v1/datasets/WIKI/\" + url.QueryEscape(stock) + \".json?&amp;limit=\" + url.QueryEscape(limit) + \"&amp;auth_token=XXXXX\"\n    response, err := http.Get(url)\n    if err != nil {\n        fmt.Println(err)\n    }\n    contents, err := ioutil.ReadAll(response.Body)\n    var result QuandlResponse\n    json.Unmarshal(contents, &amp;result)\n    json.NewEncoder(w).Encode(result)\n    fmt.Println(result.Data[0]) \n\n\n}\n    func callAll() {\n        rabbit := mux.NewRouter()\n        rabbit.HandleFunc(\"/quandl/{stock}/{limit}\", getContent)\n        http.ListenAndServe(\":8000\", rabbit)\n    }\n\nfunc main() {\n    color.Blue(\"Running Server @localhost:8000\")\n    callAll()\n\n}\n</code></pre>\n"}, {"tags": ["html", "go"], "answers": [{"tags": [], "owner": {"reputation": 768, "user_id": 1038386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOhSk.jpg?s=128&g=1", "display_name": "Meehow", "link": "https://stackoverflow.com/users/1038386/meehow"}, "is_accepted": false, "score": 0, "last_activity_date": 1484513909, "creation_date": 1484513909, "answer_id": 41666256, "question_id": 41665308, "link": "https://stackoverflow.com/questions/41665308/embed-data-or-not-what-are-best-practices-for-serving-parsing-dynamic-content/41666256#41666256", "title": "embed data or not what are best practices for serving/parsing dynamic content", "body": "<p>I you add something like</p>\n\n<pre><code>var templates = template.Must(template.ParseGlob(\"templates/*.html\"))\n</code></pre>\n\n<p>in global scope, then they are parsed only on startup.</p>\n\n<p>If you upload and run your app on some server, then probably having separate files is more convenient because then you can use rsync to avoid uploading file which didn't change since last upload.</p>\n\n<p>Putting everything to one file can make things easier if you want to distribute only one executable for download.</p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484513909, "creation_date": 1484508042, "question_id": 41665308, "link": "https://stackoverflow.com/questions/41665308/embed-data-or-not-what-are-best-practices-for-serving-parsing-dynamic-content", "title": "embed data or not what are best practices for serving/parsing dynamic content", "body": "<p>I am starting to use <a href=\"https://golang.org/\" rel=\"nofollow noreferrer\">go</a> for serving dynamic html content, parsing templates, replace variables, etc. so far all good, I found that I could create a single binary and deploy a single file including all the static files by using packages like <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">go-bindata</a>.</p>\n\n<p>But when it comes to performance what are the best practices to follow?</p>\n\n<p>If I am right, having a single binary with all the static content embedded will result in a bigger file in size.</p>\n\n<p>Having a binary that needs/depends to parse the templates <code>(*.tpl)</code> only at at startup maybe smaller in size, but will need to be shipped with all the static content.</p>\n\n<p>If space is the only difference, having a single binary looks like the more comfortable way to go for some cases, but not been an expert on the topic, I would like to know some best practices to follow keeping an eye on performance.</p>\n"}, {"tags": ["sorting", "go", "reverse", "stability"], "comments": [{"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "edited": false, "score": 3, "creation_date": 1484505390, "post_id": 41664250, "comment_id": 70527807, "body": "Your code not working: <a href=\"https://play.golang.org/p/A3a5FPZL8Q\" rel=\"nofollow noreferrer\">play.golang.org/p/A3a5FPZL8Q</a>"}, {"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "reply_to_user": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "edited": false, "score": 0, "creation_date": 1484506083, "post_id": 41664250, "comment_id": 70528086, "body": "@Aminadav of course, it&#39;s a simplified example using integers, to represent  the general problem."}], "answers": [{"comments": [{"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1484514443, "post_id": 41666218, "comment_id": 70530800, "body": "I looked at that however the behaviour I am looking for is not the same as &#39;reverse and stable sort&#39;. I want the ordering of equal element to be applied as in the original list, and not as in the reversed one."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1484514714, "post_id": 41666218, "comment_id": 70530884, "body": "Well, unless I&#39;m mistaken about your example, the code I provided works and would produce your first example."}, {"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1484515096, "post_id": 41666218, "comment_id": 70530990, "body": "HA! I see what you did. You implemented Less() as &#39;&gt;&#39;. That&#39;s smart."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1484515178, "post_id": 41666218, "comment_id": 70531019, "body": "@LorenzoBelli: Elwinar did <i>not</i> suppose to reverse after stable sorting: He proposed to stable sort with <code>Less</code> checking for more. His answer is correct."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1484517954, "post_id": 41666218, "comment_id": 70531824, "body": "You can still use <code>sort.Reverse</code> with a normal definition of <code>Less</code>. Did you try it? See <a href=\"https://play.golang.org/p/s8FezweFOj\" rel=\"nofollow noreferrer\">play.golang.org/p/s8FezweFOj</a>."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1484518718, "post_id": 41666218, "comment_id": 70532002, "body": "True that. The implementation of <code>sort.Reverse</code> is simply a type that implements <code>sort.Interface</code>, and reverse the results to <code>Less</code>. In fact, it should work too.   That being said, depending on if your &quot;reverse sort&quot; is supposed to be the normal way to sort your values, I would advise to implement the interface using whatever definition of &quot;i should be before j&quot; and don&#39;t worry about the &quot;integer sorting&quot;: if you&#39;re sorting scores for example, you&#39;ll want the biggest first."}, {"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1484657281, "post_id": 41666218, "comment_id": 70590876, "body": "@AndySchweig That is very very useful. That is not what I would have expected: <code>sort.Stable(sort.Reverse(w))</code> does not behave the same as reversing and stable sorting!"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 2, "last_activity_date": 1484513680, "creation_date": 1484513680, "answer_id": 41666218, "question_id": 41664250, "link": "https://stackoverflow.com/questions/41664250/how-to-stable-reverse-sort-a-slice-in-go/41666218#41666218", "title": "How to stable reverse sort a slice in Go?", "body": "<p>Implement the <code>sort.Interface</code> interface on a slice type, so you can choose the sort order, and apply a stable sort on it. Example : <a href=\"https://play.golang.org/p/TWAtH7asi3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TWAtH7asi3</a></p>\n"}, {"comments": [{"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1484657125, "post_id": 41689732, "comment_id": 70590777, "body": "Yes definitely this helps. It&#39;s actually the same solution as Elwinar, shown here. This should to the job"}, {"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "reply_to_user": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1484894354, "post_id": 41689732, "comment_id": 70706827, "body": "Yes...  Same as Elwinar. I&#39;ve just added implementation for your scenario."}], "tags": [], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "is_accepted": true, "score": 1, "last_activity_date": 1484631470, "creation_date": 1484631470, "answer_id": 41689732, "question_id": 41664250, "link": "https://stackoverflow.com/questions/41664250/how-to-stable-reverse-sort-a-slice-in-go/41689732#41689732", "title": "How to stable reverse sort a slice in Go?", "body": "<p>Implement the <code>sort.Interface</code> interface on your custom struct.</p>\n\n<pre><code>type myStruct struct{\n    t time.Time\n    d time.Duration\n}\n\ntype Slice []myStruct\n\nfunc (s Slice) Len() int {  return len(s) }\n\nfunc (s Slice) Less(i, j int) bool {\n    return (s[i].t).After(s[j].t)\n}\n\nfunc (s Slice) Swap(i, j int) {\n    s[i], s[j] = s[j], s[i]\n}\n</code></pre>\n\n<p>In your case, following function will sort in reverse order based on <code>t</code></p>\n\n<pre><code>func (s Slice) Less(i, j int) bool {\n    return (s[i].t).After(s[j].t)\n}\n</code></pre>\n\n<p><code>(s[i].t).After(s[j].t)</code> reports whether <code>s[i].t</code> is after <code>s[j].t</code>.</p>\n\n<p>If you want only sort, use following one</p>\n\n<pre><code>func (s Slice) Less(i, j int) bool {\n    return (s[i].t).Before(s[j].t)\n}\n</code></pre>\n\n<p>Hope this will help. </p>\n"}, {"tags": [], "owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "is_accepted": false, "score": 0, "last_activity_date": 1489003744, "creation_date": 1489003744, "answer_id": 42680983, "question_id": 41664250, "link": "https://stackoverflow.com/questions/41664250/how-to-stable-reverse-sort-a-slice-in-go/42680983#42680983", "title": "How to stable reverse sort a slice in Go?", "body": "<p>It seems you don't need to go through the trouble of implementing the sort interface. You can just sort bare using <a href=\"https://godoc.org/sort#Slice\" rel=\"nofollow noreferrer\">sort.Slice</a> or <a href=\"https://godoc.org/sort#SliceStable\" rel=\"nofollow noreferrer\">sort.SliceStable</a>.</p>\n\n<p>Here is what worked for me (<a href=\"https://play.golang.org/p/P_twYm1Cqg\" rel=\"nofollow noreferrer\">go playground</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n    \"time\"\n)\n\nfunc main() {\n    layout := \"Jan 2 15:04:05 -0700 MST 2006\"\n    t1, _ := time.Parse(layout, \"Jan 2 15:04:05 -0700 MST 2008\")\n    t2, _ := time.Parse(layout, \"Jan 2 15:04:05 -0700 MST 2001\")\n    t3, _ := time.Parse(layout, \"Jan 2 15:04:05 -0700 MST 2003\")\n    t4, _ := time.Parse(layout, \"Jan 2 15:04:05 -0700 MST 2006\")\n\n    timestamps := []struct {\n        T time.Time\n        d time.Duration\n    }{\n        {t1, 1},\n        {t2, 1},\n        {t3, 1},\n        {t4, 1},\n    }\n\n    // forward\n    sort.Slice(timestamps, func(i, j int) bool { \n        return timestamps[i].T.Before(timestamps[j].T) \n    })\n    fmt.Println(\"By time:\", timestamps)\n\n    // reverse\n    sort.Slice(timestamps, func(i, j int) bool { \n        return timestamps[i].T.After(timestamps[j].T) \n    })\n    fmt.Println(\"By time:\", timestamps)\n}\n</code></pre>\n"}], "owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1374, "favorite_count": 0, "accepted_answer_id": 41689732, "answer_count": 3, "score": -2, "last_activity_date": 1489003744, "creation_date": 1484502203, "last_edit_date": 1484505676, "question_id": 41664250, "link": "https://stackoverflow.com/questions/41664250/how-to-stable-reverse-sort-a-slice-in-go", "title": "How to stable reverse sort a slice in Go?", "body": "<p>I do have</p>\n\n<pre><code>4, 5', 6, 5''\n</code></pre>\n\n<p>and want to reverse stable sort as</p>\n\n<pre><code>6, 5', 5'', 4\n</code></pre>\n\n<p>but not</p>\n\n<pre><code>6, 5'', 5', 4\n</code></pre>\n\n<p>This (invalid) code would not work</p>\n\n<pre><code>keys := []int{4, 5', 6, 5''}\nsort.Stable(sort.Reverse(sort.Ints(keys)))\n</code></pre>\n\n<p>it would produce:</p>\n\n<pre><code>6, 5'', 5', 4\n</code></pre>\n\n<hr>\n\n<p>Here the problem is shown as simplified as a slice of integers, but In reality I need to use it applied to a slice of structs</p>\n\n<pre><code>type myStruct struct {\n    t time.Time\n    d time.Duration\n}\n</code></pre>\n\n<p>and reverse stable sort based in the <code>t</code> field.</p>\n\n<hr>\n\n<p>Edit: After few comments I made explicit that the integer one is a non working example to simplify the problem.</p>\n"}, {"tags": ["go", "types", "type-conversion"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1484515759, "post_id": 41663704, "comment_id": 70531178, "body": "A png isn&#39;t a series of big endian uint16s. What exactly are you trying to do?"}], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1484515724, "creation_date": 1484515724, "answer_id": 41666527, "question_id": 41663704, "link": "https://stackoverflow.com/questions/41663704/golang-how-to-convert-an-image-image-to-uint16/41666527#41666527", "title": "Golang: How to convert an image.image to uint16", "body": "<p><code>binary.BigEndian.Uint16</code> converts two bytes  (in a slice) to a 16-bit value using big endian byte order. If you want to convert bytes to a slice of <code>uint16</code>, you should use <code>binary.Read</code>:</p>\n\n<pre><code>// This reads 10 uint16s from file.\nslice := make([]uint16, 10)\nerr := binary.Read(file, binary.BigEndian, slice)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 964, "user_id": 3184079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819c77c230e755f43bfbbbb87429c046?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3184079/omar"}, "is_accepted": false, "score": 0, "last_activity_date": 1484535675, "creation_date": 1484535675, "answer_id": 41668853, "question_id": 41663704, "link": "https://stackoverflow.com/questions/41663704/golang-how-to-convert-an-image-image-to-uint16/41668853#41668853", "title": "Golang: How to convert an image.image to uint16", "body": "<p>It sounds like you're looking to get raw pixels. If that's the case, I don't recommend reading the file as binary directly. It means you would need to parse the file format yourself since image files contain more information than just the raw pixel values. There are already tools in the image package to deal with that.</p>\n\n<p>This code should get you on the right track. It reads RGBA values, so it ends up with a 1D array of uint8's of length width * height * 4, since there are four values per pixel.</p>\n\n<p><a href=\"https://play.golang.org/p/WUgHQ3pRla\" rel=\"nofollow noreferrer\">https://play.golang.org/p/WUgHQ3pRla</a></p>\n\n<pre><code>import (\n    \"bufio\"\n    \"fmt\"\n    \"image\"\n    \"os\"\n\n    // for decoding png files\n    _ \"image/png\"\n)\n\n// RGBA attempts to load an image from file and return the raw RGBA pixel values.\nfunc RGBA(path string) ([]uint8, error) {\n    file, err := os.Open(path)\n    if err != nil {\n        return nil, err\n    }\n\n    img, _, err := image.Decode(bufio.NewReader(file))\n    if err != nil {\n        return nil, err\n    }\n\n    switch trueim := img.(type) {\n    case *image.RGBA:\n        return trueim.Pix, nil\n    case *image.NRGBA:\n        return trueim.Pix, nil\n    }\n    return nil, fmt.Errorf(\"unhandled image format\")\n}\n</code></pre>\n\n<p>I'm not entirely sure where the uint16 values you need should come from, but presumably it's data per pixel, so the code should be very similar to this except the switch on <code>trueim</code> should likely check for something other than <code>image.RGBA</code>. Take a look at the other image types in <a href=\"https://golang.org/pkg/image\" rel=\"nofollow noreferrer\">https://golang.org/pkg/image</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7421889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f6b62e058701ef54532b93f21f9f6e4?s=128&d=identicon&r=PG&f=1", "display_name": "LuisZ", "link": "https://stackoverflow.com/users/7421889/luisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1189, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484535675, "creation_date": 1484499216, "last_edit_date": 1484508592, "question_id": 41663704, "link": "https://stackoverflow.com/questions/41663704/golang-how-to-convert-an-image-image-to-uint16", "title": "Golang: How to convert an image.image to uint16", "body": "<p>I am trying to use the go-skeltrack library with some depth images I have (Not using freenect). For that I need to modify the provided example by replacing the kinect images by my  own. For that I have to read an image and convert it later to an <code>[]uint16</code> variable. The code which I tried is:</p>\n\n<pre><code>file, err := os.Open(\"./images/4.png\")\nif err != nil {\n    fmt.Println(\"4.png file not found!\")\n    os.Exit(1)\n}\ndefer file.Close()\n\nfileInfo, _ := file.Stat()\nvar size int64 = fileInfo.Size()\nbytes := make([]byte, size)\n\n// read file into bytes \nbuffer := bufio.NewReader(file)\n_, err = buffer.Read(bytes)  \n\nintegerImage := binary.BigEndian.Uint16(bytes)\n\nonDepthFrame(integerImage)\n</code></pre>\n\n<p>Where onDepthFrame is a function which has the form </p>\n\n<pre><code>func onDepthFrame(depth []uint16).\n</code></pre>\n\n<p>But I am getting the following error while compiling:</p>\n\n<blockquote>\n  <p>./skeltrackOfflineImage.go:155: cannot use integerImage (type uint16) as type []uint16 in argument to onDepthFrame</p>\n</blockquote>\n\n<p>Which of course refers to the fact that I generated a single integer instead of an array. I am quite confused about the way that <code>Go</code> data types conversion works. Please help!</p>\n\n<p>Thanks in advance for your help.\nLuis</p>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 2, "last_activity_date": 1484498524, "last_edit_date": 1484498524, "creation_date": 1484498148, "answer_id": 41663493, "question_id": 41663322, "link": "https://stackoverflow.com/questions/41663322/test-to-check-if-a-function-didnt-run/41663493#41663493", "title": "Test to check if a function didn&#39;t run?", "body": "<p>If <code>c.Start</code> is synchronous, you can simply pass a function that sets a value in the test case's scope, and then test against that value. Condider the <code>functionCalled</code> variable in the example below that is set by the <code>trigger</code> function (<a href=\"https://play.golang.org/p/gwNg8qAThh\" rel=\"nofollow noreferrer\">playground</a>):</p>\n\n<pre><code>func TestFd(t *testing.T) {\n    functionCalled := false\n    trigger := func(i int) {\n        functionCalled = true;\n    }\n\n    c := &amp;fd.Fdcount{Interval: 1, MaxFiles: 1}\n    c.Start(trigger)\n\n    if !functionCalled {\n        t.FatalF(\"function was not called\")\n    }\n}\n</code></pre>\n\n<p>If <code>c.Start</code> is asynchronous, you can use a <code>select</code> statement to implement a timeout that will fail the test when the passed function was not called within a given time frame (<a href=\"https://play.golang.org/p/IWuC4hKTDW\" rel=\"nofollow noreferrer\">playground</a>):</p>\n\n<pre><code>func TestFd(t *testing.T) {\n    functionCalled := make(chan bool)\n    timeoutSeconds := 1 * time.Second\n    trigger := func(i int) {\n        functionCalled &lt;- true\n    }\n\n    timeout := time.After(timeoutSeconds)\n\n    c := &amp;SomeStruct{}\n    c.Start(trigger)\n\n    select {\n        case &lt;- functionCalled:\n            t.Logf(\"function was called\")\n        case &lt;- timeout:\n            t.Fatalf(\"function was not called within timeout\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 41663493, "answer_count": 1, "score": 0, "last_activity_date": 1484498524, "creation_date": 1484497144, "question_id": 41663322, "link": "https://stackoverflow.com/questions/41663322/test-to-check-if-a-function-didnt-run", "title": "Test to check if a function didn&#39;t run?", "body": "<p>So I'm new to testing in general and I'm stuck trying to write a test for a function that triggers another function. This is what I have so far but it's kind of backwards and blocks forever if the function doesn't run:</p>\n\n<pre><code>var cha = make(chan bool, 1)                \n\nfunc TestFd(t *testing.T) {                 \n  c := &amp;fd.Fdcount{Interval: 1, MaxFiles: 1}\n  c.Start(trigger)\n  if &lt;- cha {                               \n\n  }                                         \n}                                           \n\nfunc trigger(i int) {                       \n  cha &lt;- true                               \n}               \n</code></pre>\n\n<p><code>c.Start</code> will trigger the <code>trigger()</code> function when certain criteria is met. It tests whether or not the criteria is met every <code>1</code> second.</p>\n\n<p>The error case is when the function fails to run. Is there a way to test for this or is there a way to use the testing package to test for success (e.g. <code>t.Pass()</code>)?</p>\n"}, {"tags": ["go", "struct", "casting", "dry"], "comments": [{"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1484485310, "post_id": 41661356, "comment_id": 70521056, "body": "just <code>case Driver, Metric:</code>"}, {"owner": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "reply_to_user": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1484485680, "post_id": 41661356, "comment_id": 70521151, "body": "It compiles but doesn&#39;t work - v is unknown if you do that"}], "answers": [{"comments": [{"owner": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "edited": false, "score": 0, "creation_date": 1484486286, "post_id": 41661391, "comment_id": 70521302, "body": "When I do that v is not being casted (stays ModuleSource)"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "edited": false, "score": 0, "creation_date": 1484486420, "post_id": 41661391, "comment_id": 70521333, "body": "@kambi: I have updated my answer to remove taking the address of <code>v</code>."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "edited": false, "score": 0, "creation_date": 1484487010, "post_id": 41661391, "comment_id": 70521505, "body": "@kambi: Then you need to make sure that you set <code>moduleSource</code> to one."}, {"owner": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "edited": false, "score": 0, "creation_date": 1484487611, "post_id": 41661391, "comment_id": 70521715, "body": "Yes it is set, when I use the separated version of Driver and Metric it works well"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 0, "last_activity_date": 1484487027, "last_edit_date": 1484487027, "creation_date": 1484485478, "answer_id": 41661391, "question_id": 41661356, "link": "https://stackoverflow.com/questions/41661356/eliminating-duplicate-code-in-type-switch/41661391#41661391", "title": "Eliminating duplicate code in type switch", "body": "<p>A list of types are allowed in a type switch, as defined in the <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">Go spec</a>.</p>\n\n<pre><code>switch v := moduleSource.(type) {\n    case *Driver, *Metric:\n        // v has the same type as moduleSource\n        dec.Decode(v)\n        _, _ = ormInstance.Insert(v)\n\n    default:\n        fmt.Println(\"unknown type\")\n}\n</code></pre>\n"}], "owner": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484487027, "creation_date": 1484485236, "last_edit_date": 1484486844, "question_id": 41661356, "link": "https://stackoverflow.com/questions/41661356/eliminating-duplicate-code-in-type-switch", "title": "Eliminating duplicate code in type switch", "body": "<p>Since I can't use fallthrough in type switch, is there any way to merge the two cases in this code?  </p>\n\n<pre><code>switch v := moduleSource.(type) {\n            case Driver:\n               dec.Decode(&amp;v)\n                _, _ = ormInstance.Insert(&amp;v)\n\n            case Metric:\n                dec.Decode(&amp;v)\n                _, _ = ormInstance.Insert(&amp;v)\n\n            default:\n                    fmt.Println(\"unknown type\")\n    }\n</code></pre>\n\n<p>The ORM call <code>ormInstance.Insert()</code> has to have the right struct for it to work.</p>\n"}, {"tags": ["go", "struct", "types", "casting"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1484481863, "post_id": 41660857, "comment_id": 70520116, "body": "Go is statically typed, so if you need a specific type of struct, you must know what type that is at compilation time"}, {"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484482948, "post_id": 41660857, "comment_id": 70520450, "body": "<code>I don&#39;t know anything about the original struct besides what come inside the struct</code> What does that mean?"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1484487045, "last_edit_date": 1495539949, "creation_date": 1484486258, "answer_id": 41661503, "question_id": 41660857, "link": "https://stackoverflow.com/questions/41660857/how-to-cast-interface-back-into-its-original-struct/41661503#41661503", "title": "How to cast interface{} back into its original struct?", "body": "<p>No: as mentioned in <a href=\"https://www.reddit.com/r/golang/comments/3k53kv/question_converting_interface_to_struct/\" rel=\"nofollow noreferrer\">this thread</a></p>\n\n<blockquote>\n  <p>Go is neither covariant nor contravariant. Types are either <strong><a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">equal</a></strong> or they aren't.</p>\n  \n  <p>You have to either take the structs apart and deal with the pieces, or <a href=\"https://stackoverflow.com/a/20676355/6309\">use reflection</a>.<br>\n  Type assertions are only \"<strong><a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">assertions</a></strong>\", not \"coercions\" of any kind.</p>\n</blockquote>\n\n<p>See also <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/3G9l44npJ5M\" rel=\"nofollow noreferrer\">this thread</a>, which reminds us that:</p>\n\n<blockquote>\n  <ul>\n  <li>A pointer is one kind of type.</li>\n  <li>A struct is another kind of type.</li>\n  <li>An integer is another kind of type.</li>\n  <li>A floating point number is another kind of type.</li>\n  <li>A boolean is another kind of type.</li>\n  </ul>\n  \n  <p>The principle of an interface concerns the methods attached to a type <code>T</code>, not what type <code>T</code> is.</p>\n  \n  <p>An interface type is defined by a set of methods.<br>\n  Any value that implements the methods can be assigned to an interface value of that type.</p>\n</blockquote>\n\n<p>That would make the conversion from interface to concrete type quite difficult to do.</p>\n"}, {"tags": [], "owner": {"reputation": 18111, "user_id": 155585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bdacd9384d4e7a9335e22cf40473dc?s=128&d=identicon&r=PG", "display_name": "Steven Soroka", "link": "https://stackoverflow.com/users/155585/steven-soroka"}, "is_accepted": false, "score": 8, "last_activity_date": 1517181616, "last_edit_date": 1517181616, "creation_date": 1517180657, "answer_id": 48492325, "question_id": 41660857, "link": "https://stackoverflow.com/questions/41660857/how-to-cast-interface-back-into-its-original-struct/48492325#48492325", "title": "How to cast interface{} back into its original struct?", "body": "<p>You need to know at least the possible types it could be. There's a couple cases, 1. You think you might know what it is. 2. You have a list of possible types it could be, 3. Your code knows nothing about the underlying types.</p>\n\n<ol>\n<li>If you think you know it, you can use type assertion to convert back to the original struct type.</li>\n</ol>\n\n<p>...</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype MyStruct struct {\n  Thing string\n}\n\nfunc (s *MyStruct) Display() {\n  fmt.Println(s.Thing)\n}\n\ntype Thingable interface {\n  Display()\n}\n\nfunc main() {\n  s := &amp;MyStruct{\n    Thing: \"Hello\",\n  }\n\n  // print as MyThing\n  s.Display()\n\n  var thinger Thingable\n  thinger = s\n\n  // print as thingable interface\n  thinger.Display()\n\n  // convert thinger back to MyStruct\n  s2 := thinger.(*MyStruct) // this is \"type assertion\", you're asserting that thinger is a pointer to MyStruct. This will panic if thinger is not a *MyStruct\n\n  s2.Display()\n}\n</code></pre>\n\n<p>You can see this in action here: <a href=\"https://play.golang.org/p/rL12Lrpqsyu\" rel=\"noreferrer\">https://play.golang.org/p/rL12Lrpqsyu</a></p>\n\n<p>Note if you want to test the type without panicking if you're wrong, do <code>s2, ok := thinger.(*MyStruct)</code>. ok will be true if it was successful and false otherwise.</p>\n\n<ol start=\"2\">\n<li>if you want to test your interface variable against a bunch of types, use a switch: (scroll to bottom)</li>\n</ol>\n\n<p>...</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype MyStruct struct {\n    Thing string\n}\n\ntype MyStruct2 struct {\n    Different string\n}\n\nfunc (s *MyStruct) Display() {\n    fmt.Println(s.Thing)\n}\n\nfunc (s *MyStruct2) Display() {\n    fmt.Println(s.Different)\n}\n\ntype Thingable interface {\n    Display()\n}\n\nfunc main() {\n    s := &amp;MyStruct{\n        Thing: \"Hello\",\n    }\n\n    // print as MyThing\n    s.Display()\n\n    var thinger Thingable\n    thinger = s\n\n    // print as thingable interface\n    thinger.Display()\n\n    // try to identify thinger\n    switch t := thinger.(type) {\n    case *MyStruct:\n        fmt.Println(\"thinger is a *MyStruct. Thing =\", t.Thing)\n    case *MyStruct2:\n        fmt.Println(\"thinger is a *MyStruct2. Different =\", t.Different)\n    default:\n        fmt.Println(\"thinger is an unknown type:\", reflect.TypeOf(thinger))\n    }\n}\n</code></pre>\n\n<p>You can try that out here <a href=\"https://play.golang.org/p/7NEbwB5j6Is\" rel=\"noreferrer\">https://play.golang.org/p/7NEbwB5j6Is</a></p>\n\n<ol start=\"3\">\n<li>If you really don't know anything about the underlying types, you'll have to expose the things you need through interface functions and call those. Chances are you can do this without knowing anything about the underlying type.</li>\n</ol>\n"}], "owner": {"reputation": 2789, "user_id": 664160, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0c7dfdfb981d63a230619d0962c4d91?s=128&d=identicon&r=PG", "display_name": "kambi", "link": "https://stackoverflow.com/users/664160/kambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8647, "favorite_count": 3, "accepted_answer_id": 41661503, "answer_count": 2, "score": 3, "last_activity_date": 1517181616, "creation_date": 1484481741, "last_edit_date": 1484486503, "question_id": 41660857, "link": "https://stackoverflow.com/questions/41660857/how-to-cast-interface-back-into-its-original-struct", "title": "How to cast interface{} back into its original struct?", "body": "<p>I need a way to dynamically cast a struct/interface back to its original object.\nI can add methods / functions inside. basically I need something like this:</p>\n\n<pre><code>MyStruct  =&gt;  Interface{}  =&gt; MyStruct\n</code></pre>\n\n<p>When on the final conversion I don't know anything about the original struct besides what come inside the struct, so I can't just so:</p>\n\n<pre><code>a.(MyStruct)\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "service", "module"], "comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1484471470, "post_id": 41659139, "comment_id": 70517589, "body": "Have you looked into GCE, which gives you a VM and you can run whatever process you want to?"}], "answers": [{"comments": [{"owner": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "edited": false, "score": 0, "creation_date": 1484494452, "post_id": 41659919, "comment_id": 70523949, "body": "Yes, I think that is what I want to do, but there is no working example in the documentation. And I only found one outdated blog post about this. Can you provide more information please?"}], "tags": [], "owner": {"reputation": 2826, "user_id": 1900169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wqxtO.jpg?s=128&g=1", "display_name": "Frank Wilson", "link": "https://stackoverflow.com/users/1900169/frank-wilson"}, "is_accepted": false, "score": 1, "last_activity_date": 1484474715, "creation_date": 1484474715, "answer_id": 41659919, "question_id": 41659139, "link": "https://stackoverflow.com/questions/41659139/google-app-engine-a-single-backend-service-module/41659919#41659919", "title": "Google App Engine: a single backend service/module?", "body": "<p>Have you considered using a module with <a href=\"https://cloud.google.com/appengine/docs/go/an-overview-of-app-engine#scaling_types_and_instance_classes\" rel=\"nofollow noreferrer\">manual scaling</a>? You could map <code>/_ah/start</code> to a handler that does your loop. Unlike with automatic scaling your loop can continue for up to 24 hours.</p>\n"}], "owner": {"reputation": 806, "user_id": 719020, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/7dfa71310fe94858b6f042303b414873?s=128&d=identicon&r=PG", "display_name": "ChrisR", "link": "https://stackoverflow.com/users/719020/chrisr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484474715, "creation_date": 1484468133, "question_id": 41659139, "link": "https://stackoverflow.com/questions/41659139/google-app-engine-a-single-backend-service-module", "title": "Google App Engine: a single backend service/module?", "body": "<p>How does one have a simple backend module/service/backend (or whatever they decide to call it in the future since they seem to use all three interchangeably) on GAE? I need zero endpoints and no web server: I have an app that reads stuff from an endpoint and I want to store that in a database. This is not a cron job, imagine this as a <code>while(1){do_stuff()}</code>.</p>\n\n<p>I am woefully confused at the GAE tutorials, which I've been reading for over three hours now. I'm just shocked at how bad the documentation is: there is a ton of information but not a single working example (e.g. the <code>.yaml</code> files of the <a href=\"https://cloud.google.com/appengine/docs/go/configuration-files\" rel=\"nofollow noreferrer\">config file</a> document are incomplete and don't work out of the box).</p>\n"}, {"tags": ["go", "kubernetes", "openstack", "docker-volume", "openstack-cinder"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6487494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996501a58f6e54d6a6906ca770803af7?s=128&d=identicon&r=PG&f=1", "display_name": "Lance.yang", "link": "https://stackoverflow.com/users/6487494/lance-yang"}, "edited": false, "score": 0, "creation_date": 1484468380, "post_id": 41659037, "comment_id": 70516883, "body": "eh,I&#39;ve not run a cinder example,I just read the source code.  can you tell me how the plugin works? and how it communicate with cinder? I&#39;m very confused.    thanks a lot!!!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 11, "user_id": 6487494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996501a58f6e54d6a6906ca770803af7?s=128&d=identicon&r=PG&f=1", "display_name": "Lance.yang", "link": "https://stackoverflow.com/users/6487494/lance-yang"}, "edited": false, "score": 0, "creation_date": 1484468490, "post_id": 41659037, "comment_id": 70516903, "body": "@Lance.yang Exactly. My point is, should you try to run a cinder example, it might not work from kubernetes"}, {"owner": {"reputation": 435, "user_id": 4457564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3d84b316c9cc9b7272bae964ac6b5a?s=128&d=identicon&r=PG&f=1", "display_name": "Ewa", "link": "https://stackoverflow.com/users/4457564/ewa"}, "edited": false, "score": 0, "creation_date": 1488972690, "post_id": 41659037, "comment_id": 72464885, "body": "I don&#39;t know how the cinder volume plugin works, but I want you to know that it works. For sure in Kubernetes 1.5.3, both dynamic and static way."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 435, "user_id": 4457564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3d84b316c9cc9b7272bae964ac6b5a?s=128&d=identicon&r=PG&f=1", "display_name": "Ewa", "link": "https://stackoverflow.com/users/4457564/ewa"}, "edited": false, "score": 0, "creation_date": 1488973218, "post_id": 41659037, "comment_id": 72465273, "body": "@Ewa Thank you. I have included your comment in the answer for more visibility (with a link to your recent answer)"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1488973184, "last_edit_date": 1495535474, "creation_date": 1484467247, "answer_id": 41659037, "question_id": 41658969, "link": "https://stackoverflow.com/questions/41658969/how-the-kubernetes-cinder-volume-plugin-works/41659037#41659037", "title": "How the kubernetes cinder volume plugin works?", "body": "<p>cinder volume is a <a href=\"https://kubernetes.io/docs/user-guide/persistent-volumes/\" rel=\"nofollow noreferrer\">persistent volume</a>, more precisely one of the persistent volume <a href=\"https://kubernetes.io/docs/user-guide/persistent-volumes/#storageclasses\" rel=\"nofollow noreferrer\">storage classes</a>.</p>\n\n<blockquote>\n  <p>Each StorageClass contains the fields provisioner and parameters, which are used when a PersistentVolume belonging to the class needs to be dynamically provisioned.</p>\n</blockquote>\n\n<p>Cinder specifically is an <a href=\"http://docs.openstack.org/admin-guide/dashboard-manage-volumes.html\" rel=\"nofollow noreferrer\">Openstack volume type</a>.<br>\nIt is an <a href=\"https://wiki.openstack.org/wiki/Cinder\" rel=\"nofollow noreferrer\">OpenStack Block Storage Cinder</a>, which:</p>\n\n<blockquote>\n  <ul>\n  <li>implements services and libraries to provide on demand, self-service access to Block Storage resources.  </li>\n  <li>Provides Software Defined Block Storage via abstraction and automation on top of various traditional backend block storage devices.</li>\n  </ul>\n</blockquote>\n\n<p>You can see how Kubernetes uses cinder in <a href=\"https://github.com/kubernetes/kubernetes/blob/master/pkg/volume/cinder/cinder_test.go\" rel=\"nofollow noreferrer\"><code>pkg/volume/cinder/cinder_test.go</code></a>.<br>\nHowever, as mentioned in \"<a href=\"https://stackoverflow.com/a/40841681/6309\">Kubernetes Cinder volumes do not mount with cloud-provider=openstack</a>\":</p>\n\n<blockquote>\n  <p>the the Cinder provisioner is not implemented yet, given the following statement in the docs (<a href=\"http://kubernetes.io/docs/user-guide/persistent-volumes/#provisioner\" rel=\"nofollow noreferrer\">StorageClasses Provisioner</a>):</p>\n  \n  <blockquote>\n    <p>During beta, the available provisioner types are <code>kubernetes.io/aws-ebs</code> and <code>kubernetes.io/gce-pd</code></p>\n  </blockquote>\n</blockquote>\n\n<p>So no \"<code>kubernetes.io/cinder</code>\" yet.<br>\nYet, <a href=\"https://stackoverflow.com/users/4457564/ewa\">Ewa</a> mentions <a href=\"https://stackoverflow.com/questions/41658969/how-the-kubernetes-cinder-volume-plugin-works/41659037?noredirect=1#comment72464885_41659037\">in the comments</a> making it work: see \"<a href=\"https://stackoverflow.com/a/42670021/6309\">Kubernetes Cinder volumes do not mount with <code>cloud-provider=openstack</code></a>\" as an example.</p>\n"}, {"tags": [], "owner": {"reputation": 353, "user_id": 471550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a0b98134a04f3e7cf6939bbe01949b?s=128&d=identicon&r=PG", "display_name": "fkpwolf", "link": "https://stackoverflow.com/users/471550/fkpwolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1532414090, "creation_date": 1532414090, "answer_id": 51491950, "question_id": 41658969, "link": "https://stackoverflow.com/questions/41658969/how-the-kubernetes-cinder-volume-plugin-works/51491950#51491950", "title": "How the kubernetes cinder volume plugin works?", "body": "<p>Check <a href=\"https://stackoverflow.com/questions/46067591/how-to-use-openstack-cinder-to-create-storage-class-and-dynamically-provision-pe\">this question</a>. Kubernetes has configuration(<code>--cloud-config</code> paramter) on how to connect cloud provider like OpenStack to operate Load Balance IP &amp; Block Storage.</p>\n"}], "owner": {"reputation": 11, "user_id": 6487494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996501a58f6e54d6a6906ca770803af7?s=128&d=identicon&r=PG&f=1", "display_name": "Lance.yang", "link": "https://stackoverflow.com/users/6487494/lance-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2103, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1532414090, "creation_date": 1484466662, "last_edit_date": 1484467305, "question_id": 41658969, "link": "https://stackoverflow.com/questions/41658969/how-the-kubernetes-cinder-volume-plugin-works", "title": "How the kubernetes cinder volume plugin works?", "body": "<p>I'm new to k8s, and recently, I read the cinder volume plugin source code:\n<a href=\"https://github.com/kubernetes/kubernetes/tree/master/pkg/volume/cinder\" rel=\"nofollow noreferrer\">cinder volume plugin</a>.</p>\n\n<p>I don't know how the plugin works, and how it communicates with cinder?\nAnd I don't find the request and response in code.</p>\n\n<p>Does the cinder volume plugin call cinder API or other ways?</p>\n"}, {"tags": ["go", "routing"], "comments": [{"owner": {"reputation": 955936, "user_id": 29407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3a181e9cdd4757a8b416d93878770c5?s=128&d=identicon&r=PG", "display_name": "Darin Dimitrov", "link": "https://stackoverflow.com/users/29407/darin-dimitrov"}, "edited": false, "score": 1, "creation_date": 1484471203, "post_id": 41658590, "comment_id": 70517538, "body": "Are you sure that you have all the template files correctly named in the <code>templates</code> folder? For example if you want to navigate to <code>&#47;contact</code> you should have a <code>templates&#47;contact.html</code> file."}, {"owner": {"reputation": 1893, "user_id": 4900669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pTcS6.jpg?s=128&g=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4900669/ivan"}, "edited": false, "score": 0, "creation_date": 1484493374, "post_id": 41658590, "comment_id": 70523617, "body": "I create directory <code>templates</code> with <code>index.html</code>, <code>about.html</code> and <code>contact.html</code> and your code work (but I have to edit your code, because you haven&#39;t function <code>profile</code> and <code>resume</code>, I change first to <code>about</code>, and delete second)"}, {"owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "edited": false, "score": 0, "creation_date": 1484496912, "post_id": 41658590, "comment_id": 70524736, "body": "Root directory is called staticSite.  Inside staticSite, two directories.  Public for css file, and templates.  Inside templates directory are all html files. In root directory is main.go"}], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "is_accepted": false, "score": 0, "last_activity_date": 1484500622, "creation_date": 1484500622, "answer_id": 41663956, "question_id": 41658590, "link": "https://stackoverflow.com/questions/41658590/routing-in-golang-failing/41663956#41663956", "title": "routing in golang failing", "body": "<p>Sorry for the mix up, there was a typo in the links within the html files.\nIf anyone else has this issue, it wasn't with the go side of things. It was within the HTML files not linking to the correct routes.  </p>\n"}], "owner": {"reputation": 64, "user_id": 1447789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ef6c4b2cccc9969ec837ce7163a60fdb?s=128&d=identicon&r=PG", "display_name": "Deliri", "link": "https://stackoverflow.com/users/1447789/deliri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484500622, "creation_date": 1484462806, "last_edit_date": 1484470728, "question_id": 41658590, "link": "https://stackoverflow.com/questions/41658590/routing-in-golang-failing", "title": "routing in golang failing", "body": "<p>So I created a simple static site using go. </p>\n\n<p><a href=\"https://play.golang.org/p/s3XOqLj2SM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/s3XOqLj2SM</a></p>\n\n<p>When you hit the root directory, the index.html page loads just fine including all the assets. </p>\n\n<p>If you try to navigate to one of the other pages, the html does not load. I get a 404 error. </p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["node.js", "go", "packages"], "comments": [{"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1484448616, "post_id": 41657255, "comment_id": 70513282, "body": "What do you mean &quot;remotely&quot;? All go source files ought to be in your path, or atleast <code>GOPATH</code>"}, {"owner": {"reputation": 11272, "user_id": 4954970, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cd55f03cb2048a05411472dd6ac1eab8?s=128&d=identicon&r=PG&f=1", "display_name": "kpimov", "link": "https://stackoverflow.com/users/4954970/kpimov"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1484449780, "post_id": 41657255, "comment_id": 70513476, "body": "That was badly worded. I know the packages I pull from github are kept in my <code>GOPATH</code>. I was talking about how the directories within <code>$GOPATH&#47;src&#47;</code> are named with the github repo the package originated from."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1484450091, "post_id": 41657255, "comment_id": 70513530, "body": "Read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to write Go code</a>.  With the exception of the &#39;go get&#39; subcommand, all of the Go tools work with local files and care not that a directory name might correspond to a Github or other remote location."}, {"owner": {"reputation": 11272, "user_id": 4954970, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cd55f03cb2048a05411472dd6ac1eab8?s=128&d=identicon&r=PG&f=1", "display_name": "kpimov", "link": "https://stackoverflow.com/users/4954970/kpimov"}, "edited": false, "score": 0, "creation_date": 1484451205, "post_id": 41657255, "comment_id": 70513733, "body": "Ah ok, that makes more sense now. I was confused about how I&#39;d be able to update the packages if the directory the source code is in doesn&#39;t correspond to a real github repo, but I&#39;m sure there are other ways to handle updates for my own code besides <code>go get</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1484451942, "post_id": 41657255, "comment_id": 70513847, "body": "Use git commands directly when working with your own code and other code that you edit"}, {"owner": {"reputation": 11272, "user_id": 4954970, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cd55f03cb2048a05411472dd6ac1eab8?s=128&d=identicon&r=PG&f=1", "display_name": "kpimov", "link": "https://stackoverflow.com/users/4954970/kpimov"}, "edited": false, "score": 0, "creation_date": 1484452316, "post_id": 41657255, "comment_id": 70513896, "body": "I do. What I want to do is automate rebuilding the packages when needed, but I think that can be handled in the launch script I&#39;m using by checking if any of the source files&#39; metadata for when they were last modified has changed or if a hash of the files&#39; contents has changed since the last time the launch script was run. I&#39;m wondering if there are better ways to do this though."}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 1, "creation_date": 1484453012, "post_id": 41657255, "comment_id": 70513978, "body": "Have you looked into vendoring?"}, {"owner": {"reputation": 11272, "user_id": 4954970, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cd55f03cb2048a05411472dd6ac1eab8?s=128&d=identicon&r=PG&f=1", "display_name": "kpimov", "link": "https://stackoverflow.com/users/4954970/kpimov"}, "edited": false, "score": 0, "creation_date": 1484455109, "post_id": 41657255, "comment_id": 70514401, "body": "I hadn&#39;t heard of it before, but it looks like it&#39;s exactly what I need! Thanks, I&#39;ll leave this open if any of you want to post an answer"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1484499437, "post_id": 41657255, "comment_id": 70525621, "body": "Use the &#39;go install&#39; command to automatically rebuild your packages."}], "answers": [{"tags": [], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "is_accepted": true, "score": 1, "last_activity_date": 1484456155, "creation_date": 1484456155, "answer_id": 41657954, "question_id": 41657255, "link": "https://stackoverflow.com/questions/41657255/importing-go-packages-locally-rather-than-remotely/41657954#41657954", "title": "Importing Go packages locally rather than remotely", "body": "<p>It happens the same to my team too and we end up using vendor it's pretty easy to manage all the external packages. So, whoever checkout your repo will have all the packages inside vendor.</p>\n\n<p><a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder/\" rel=\"nofollow noreferrer\">Understanding and using the vendor folder</a></p>\n\n<p>And Please refer this site lots of other option out there too:</p>\n\n<p><a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow noreferrer\">Golang Package Management Tools</a></p>\n"}], "owner": {"reputation": 11272, "user_id": 4954970, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cd55f03cb2048a05411472dd6ac1eab8?s=128&d=identicon&r=PG&f=1", "display_name": "kpimov", "link": "https://stackoverflow.com/users/4954970/kpimov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 41657954, "answer_count": 1, "score": -2, "last_activity_date": 1484456155, "creation_date": 1484447775, "last_edit_date": 1484451091, "question_id": 41657255, "link": "https://stackoverflow.com/questions/41657255/importing-go-packages-locally-rather-than-remotely", "title": "Importing Go packages locally rather than remotely", "body": "<p>In a node.js project, I'm using Go for a critical part of it that node isn't adequate enough to handle. I want to split the Go code into a <code>sockets</code> package and a <code>main</code> package, with <code>sockets</code> containing required structs/interfaces for the <code>main</code> package to run. The problem I'm having is that from what I can gather from Go's documentation, I can only use external packages like <code>sockets</code> remotely from github/gopkg. I don't want to split the repository for the project into one containing the Go code and one containing node's. How can I make the <code>sockets</code> package available for <code>main</code> to import locally while making it possible to rebuild the binaries for the two packages if any updates to their source code are made?</p>\n\n<p>Edit: importing the packages is no longer an issue, but rebuilding packages on update still remains</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1195, "user_id": 1949387, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/07aecc3a985b916b35133da1d5b5634c?s=128&d=identicon&r=PG", "display_name": "user1949387", "link": "https://stackoverflow.com/users/1949387/user1949387"}, "edited": false, "score": 0, "creation_date": 1484443714, "post_id": 41655602, "comment_id": 70512494, "body": "Thanks a lot that is exactly what I needed, it works ."}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1484433123, "last_edit_date": 1484433123, "creation_date": 1484432419, "answer_id": 41655602, "question_id": 41654800, "link": "https://stackoverflow.com/questions/41654800/golang-opening-external-files-sent-over-http-request-with-new-package/41655602#41655602", "title": "Golang opening external files sent over http request with new package", "body": "<p>No need to open the image; it's already available on the request.</p>\n\n<p>You can do something along these lines:</p>\n\n<pre><code>file = r.FormFile()\nimg = image.Decode(file)\nimgResized = imaging.Resize(img, ..)\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/net/http/#Request.FormFile\" rel=\"nofollow noreferrer\">Request.FormFile</a> returns a <a href=\"https://golang.org/pkg/mime/multipart/#File\" rel=\"nofollow noreferrer\">multipart.File</a>, which is an io.Reader, so can be passed to <a href=\"https://golang.org/pkg/image/#Decode\" rel=\"nofollow noreferrer\">image.Decode</a> to get an Image to pass to <a href=\"https://godoc.org/github.com/disintegration/imaging#Resize\" rel=\"nofollow noreferrer\">imaging.Resize</a>.</p>\n\n<p>Remember to check and handle every potential error.</p>\n"}], "owner": {"reputation": 1195, "user_id": 1949387, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/07aecc3a985b916b35133da1d5b5634c?s=128&d=identicon&r=PG", "display_name": "user1949387", "link": "https://stackoverflow.com/users/1949387/user1949387"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 41655602, "answer_count": 1, "score": 1, "last_activity_date": 1484433123, "creation_date": 1484426584, "question_id": 41654800, "link": "https://stackoverflow.com/questions/41654800/golang-opening-external-files-sent-over-http-request-with-new-package", "title": "Golang opening external files sent over http request with new package", "body": "<p>I am using Golang as a restful api. I have an IOS app that user's upload photos afterwards the image is sent to Golang and it processes the image and uploads it (to Amazon s3), therefore the images are not found in my local directory . I was using the FormFile before to read the images such as </p>\n\n<pre><code>func s3ImageUpload(w http.ResponseWriter, r *http.Request) {\n     r.ParseForm()\n\n     file, handler, err := r.FormFile(\"file\")\n     if err != nil {\n         fmt.Println(\"Error Uploading Image\")\n         return\n     }\n\n  // Rest of Code that uploads Image to my Amazon s3 Bucket no issues here\n}\n</code></pre>\n\n<p>The problem with the above code is that sometimes Images as big as 4MB were being uploaded and that was too big so I got a new package to resize images <a href=\"https://www.github.com/disintegration/imaging\" rel=\"nofollow noreferrer\">https://www.github.com/disintegration/imaging</a> . I posted on this yesterday and received great help and managed to upload images found on my <strong>local</strong> directory, however I need to find how to load images coming externally . The only issue I been having is with the <strong>Open method</strong> of this package and according to go-docs this is the explanation of that method</p>\n\n<p><em>func Open</em></p>\n\n<pre><code>func Open(filename string) (image.Image, error)\n</code></pre>\n\n<p><em>Open loads an image from file</em></p>\n\n<p>so if I have an image in my local directory and want to resize it I can do this</p>\n\n<pre><code>file_open,err := imaging.Open(\"/Users/IH/Documents/pictures/BigTurtle.jpg\")\n\n        if err != nil {\n            print(\"Imaging Open error\")\n        }\n        new_image := imaging.Resize(file_open, 300, 300, imaging.Lanczos)\n</code></pre>\n\n<p>// rest of code sends new image to Amazon s3 it works correctly\nThat all works but as stated before the images are coming externally from other people's IOS devices so I can not put in an image path. I have tried to do this</p>\n\n<pre><code>file_open,err := imaging.Open(handler.filename)\n</code></pre>\n\n<p>and</p>\n\n<pre><code> file_open,err := imaging.Open(\"file\")\n</code></pre>\n\n<p>but it states no image or directory found, I am new to Golang but is there some way that I can get the external file being sent into imaging.open ? \n I need that one because the 1st parameter of the method `imaging.Resize() is of type <strong>image.Image</strong> which is the same type as <strong>imaging.Open</strong>  . Unfortunately the  <strong>r.FormFile(\"file\")</strong>  is of type Multipart.File and can not be resized at least not to my limited knowledge. Any help would be great .</p>\n"}, {"tags": ["go", "goroutine", "channels"], "answers": [{"comments": [{"owner": {"reputation": 122, "user_id": 2728010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf368fa3f6bd958386a88440864b6330?s=128&d=identicon&r=PG&f=1", "display_name": "sks", "link": "https://stackoverflow.com/users/2728010/sks"}, "edited": false, "score": 0, "creation_date": 1484422778, "post_id": 41653781, "comment_id": 70506962, "body": "Then how does <code>for</code> loop return when I put it in goroutines. ? Thanks"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 122, "user_id": 2728010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf368fa3f6bd958386a88440864b6330?s=128&d=identicon&r=PG&f=1", "display_name": "sks", "link": "https://stackoverflow.com/users/2728010/sks"}, "edited": false, "score": 0, "creation_date": 1484422914, "post_id": 41653781, "comment_id": 70507013, "body": "You can pass another <code>chan</code> of and empty struct, a closing channel. But <code>WaitGroups</code> work well too"}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 3, "last_activity_date": 1484423091, "last_edit_date": 1484423091, "creation_date": 1484420300, "answer_id": 41653781, "question_id": 41653695, "link": "https://stackoverflow.com/questions/41653695/all-goroutines-are-asleep-deadlock/41653781#41653781", "title": "all goroutines are asleep deadlock", "body": "<p>The <code>for</code> statements loops forever, and so the <code>&lt;-c</code> chan is never passed along and the chans get filled, but the <code>main</code> thread gets stuck waiting for <code>c := fanInNew(a, b)</code>.</p>\n\n<p><code>fanInNew()</code> <strong>never returns</strong> because <code>for</code> <strong>loops forever</strong> (and <strong>blocks on <code>select</code></strong> btw):</p>\n\n<pre><code>func fanInNew(input1, input2 &lt;-chan string) &lt;-chan string {\n    c := make(chan string)\n    for { // Loop forever and read from inputs 1 and 2\n        select {\n        case s := &lt;-input1:\n            c &lt;- s\n        case s := &lt;-input2:\n            c &lt;- s            \n        }\n    }\n    return c\n}\n</code></pre>\n\n<p>Then in the <strong>main thread</strong> this function never returns the <code>c</code> chan.</p>\n\n<pre><code>func main() {\n    // Never gets passed the next line\n    c := fanInNew(boring(\"joe\"), boring(\"anh\"))\n}\n</code></pre>\n\n<p>So you can put the <code>for</code> loops themselves in goroutines, as you did in the second example. <em>Also</em> typically goroutines should return, either because you pass a message in (such as by <code>close()</code>ing), or because they reach a return statement. </p>\n\n<p>In any case, what you have in the 2nd example is great for demonstrating the use of anonymous <strong>closures</strong>. The <code>chan</code> passed into the goroutine can be returned elsewhere and enable safe message passing between threads:</p>\n\n<pre><code>c := make(chan string)\ngo func() {\n    for {\n        select {\n        case s := &lt;-input1:\n            c &lt;- s\n        case s := &lt;-input2:\n            c &lt;- s\n        }\n    }\n}()\nreturn c\n</code></pre>\n\n<p>There are a few ways of ending a for loop in an anonymous goroutine, including select on a second <code>chan</code>, a <strong>closing channel</strong>, which when <code>close()</code>ed you can return. Also, typically <a href=\"https://golang.org/pkg/sync/#example_WaitGroup\" rel=\"nofollow noreferrer\"><code>WaitGroups</code></a> can achieve that.</p>\n"}], "owner": {"reputation": 122, "user_id": 2728010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf368fa3f6bd958386a88440864b6330?s=128&d=identicon&r=PG&f=1", "display_name": "sks", "link": "https://stackoverflow.com/users/2728010/sks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1484423091, "creation_date": 1484419825, "question_id": 41653695, "link": "https://stackoverflow.com/questions/41653695/all-goroutines-are-asleep-deadlock", "title": "all goroutines are asleep deadlock", "body": "<p>I am trying to play around with goroutines and channel</p>\n\n<pre><code>    package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc boring(msg string) &lt;-chan string {\n    c := make(chan string)\n    go func() {\n        for i := 0; ; i++ {\n            c &lt;- fmt.Sprintf(\"%s %d\", msg, i)\n            time.Sleep(time.Duration(rand.Intn(1e3)) * time.Millisecond)\n        }\n    }()\n    return c\n}\nfunc main() {\n    c := fanInNew(boring(\"joe\"), boring(\"anh\"))\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(&lt;-c)\n    }\n    fmt.Println(\"You both are boring, I am leaving\")\n}\n\nfunc fanInNew(input1, input2 &lt;-chan string) &lt;-chan string {\n    c := make(chan string)\n    for {\n        select {\n        case s := &lt;-input1:\n            c &lt;- s\n        case s := &lt;-input2:\n            c &lt;- s\n        }\n    }\n    return c\n}\n</code></pre>\n\n<p>If i run this program it is giving me error, all goroutines are asleep, deadlock.</p>\n\n<p>But If I put <code>select</code> inside anonymous goroutine, it works just fine. Working example:</p>\n\n<pre><code>    package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc boring(msg string) &lt;-chan string {\n    c := make(chan string)\n    go func() {\n        for i := 0; ; i++ {\n            c &lt;- fmt.Sprintf(\"%s %d\", msg, i)\n            time.Sleep(time.Duration(rand.Intn(1e3)) * time.Millisecond)\n        }\n    }()\n    return c\n}\nfunc main() {\n    c := fanInNew(boring(\"joe\"), boring(\"anh\"))\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(&lt;-c)\n    }\n    fmt.Println(\"You both are boring, I am leaving\")\n}\n\nfunc fanInNew(input1, input2 &lt;-chan string) &lt;-chan string {\n    c := make(chan string)\n    go func() {\n        for {\n            select {\n            case s := &lt;-input1:\n                c &lt;- s\n            case s := &lt;-input2:\n                c &lt;- s\n            }\n        }\n    }()\n    return c\n}\n</code></pre>\n\n<p>Can you please help me to understand reasoning behind it.</p>\n"}, {"tags": ["multithreading", "go", "linux-kernel", "threadpool"], "answers": [{"comments": [{"owner": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "edited": false, "score": 0, "creation_date": 1484414261, "post_id": 41652713, "comment_id": 70504174, "body": "Thank you. Just want to clarify your goroutine <code>having more threads than CPU&#39;s usually increase the performance of your application</code> comment: I agree having more threads than CPU cores is better, but you does not need to increase <code>GOMAXPROXCS</code> just for that: &quot;Goroutine that are blocked in I/O or other system calls or are calling non-GO functions, do need an OS thread, but GOMAXPROXCS need not account for them&quot; from &lt;The go programming language&gt; page 281."}, {"owner": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "edited": false, "score": 0, "creation_date": 1484414647, "post_id": 41652713, "comment_id": 70504302, "body": "If it&#39;s like what I understand from your answer: CPU time is roughly even distributed on number of total CPU-intensive threads across OS. <code>GOMAXPROXCS</code> being set to number of cores does not make sense to me --- Using the number of cores as number of threads in thread pool would be meaningless."}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "reply_to_user": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "edited": false, "score": 0, "creation_date": 1484418606, "post_id": 41652713, "comment_id": 70505600, "body": "If it is the case than maybe in GO there is no point of having more goroutine workers than CPU&#39;s."}], "tags": [], "owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "is_accepted": false, "score": 0, "last_activity_date": 1484413893, "creation_date": 1484413893, "answer_id": 41652713, "question_id": 41652650, "link": "https://stackoverflow.com/questions/41652650/will-my-program-get-more-cpu-time-if-it-has-more-threads/41652713#41652713", "title": "Will my program get more cpu time if it has more threads", "body": "<blockquote>\n  <p>It does not seem very fair to me. If I am a irresponsible programmer,\n  I can just spawn more threads to eat more CPU resource.</p>\n</blockquote>\n\n<p>you can also allocate your entire free memory, cause OS-failure and hijack the network card. you can do sorts of things but then who will want to consume your softwares? </p>\n\n<blockquote>\n  <p>How this relate to golang: In go, typically the go scheduler has a\n  thread pool of #of-CPU-cores threads. Why does this make sense if a\n  process with more threads gets more stuff done?</p>\n</blockquote>\n\n<p>Golang goroutines are basically a threadpool. each goroutine is a thread-pool work item. many things can make your thread-pool thread block, like using synchronous IO, waiting on a (non-spin-lock) lock and manually sleeping or yielding. in these cases, which are very common, having more threads than CPU's usually increase the performance of your application.<br/>\nDo note that not all IO is a disk IO. writing to your console is an IO operation, but it isn't really a \"Disk IO\".<br/><br/>\nanother thing is that context switching may not consume a large portion of your CPU, and having more threads may not make your tasks-throughput degrade. so in this case having more threads means that your parallelism is higher, and yet you don't loose performance. this is somewhat common situation. context switching between threads these days is very cheap. having a bit more threads than your cores may not necessary kill your performance or degrade it in some way. </p>\n"}], "owner": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1484413893, "creation_date": 1484413491, "last_edit_date": 1592644375, "question_id": 41652650, "link": "https://stackoverflow.com/questions/41652650/will-my-program-get-more-cpu-time-if-it-has-more-threads", "title": "Will my program get more cpu time if it has more threads", "body": "<p>If currently kernel is scheduling 60 threads, they belong to 3 processes:</p>\n<blockquote>\n<p>A: 10 threads</p>\n<p>B: 20 threads</p>\n<p>C: 30 threads</p>\n</blockquote>\n<p>And they are all doing computing (no disk IO)</p>\n<p>Will C gets more stuff done than B, and B gets more stuff done than A?</p>\n<p>It does not seem very fair to me. If I am a irresponsible programmer, I can just spawn more threads to eat more CPU resource.</p>\n<p>How this relate to golang:\nIn go, typically the go scheduler has a thread pool of #of-CPU-cores threads. Why does this make sense if a process with more threads gets more stuff done?</p>\n"}, {"tags": ["go", "mutex", "race-condition"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1484422335, "post_id": 41652576, "comment_id": 70506795, "body": "The problem is likely outside of the code you&#39;ve shown here. Try running vet on your program, which can catch accidental copying of mutexes. Though not the problem here, it&#39;s also easier to visually confirm locking if you defer the Unlock() immediately after Lock()"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1484449313, "post_id": 41652576, "comment_id": 70513387, "body": "This code looks OK to me. Is this all the code that accesses <code>ActiveTransactions</code>?"}, {"owner": {"reputation": 65, "user_id": 4640361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd65f8f6b29330c41259210bb59edc84?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent Chang", "link": "https://stackoverflow.com/users/4640361/vincent-chang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484471472, "post_id": 41652576, "comment_id": 70517591, "body": "@JimB running go vet helped, problem was located outside of this code indeed. Thanks"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1484471912, "post_id": 41652576, "comment_id": 70517690, "body": "@VincentChang please check the answer data-race condition is actually there in the code ,mostly it is harmless"}, {"owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "edited": false, "score": 0, "creation_date": 1561655404, "post_id": 41652576, "comment_id": 100146150, "body": "If the question is unanswerable with the information given, and the original poster&#39;s problem is resolved, should this question be closed or deleted?"}], "owner": {"reputation": 65, "user_id": 4640361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd65f8f6b29330c41259210bb59edc84?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent Chang", "link": "https://stackoverflow.com/users/4640361/vincent-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1285, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1519317961, "creation_date": 1484413004, "last_edit_date": 1519317961, "question_id": 41652576, "link": "https://stackoverflow.com/questions/41652576/golang-protecting-struct-with-mutex-race-is-still-detected-with-locks", "title": "Golang protecting struct with mutex, race is still detected with locks", "body": "<p>I have a struct defined as follows:</p>\n\n<pre><code>type transactionList map[string]Transaction\ntype ActiveTransactions struct {\n    mtx sync.Mutex\n    trm transactionList\n}\n</code></pre>\n\n<p>This struct has several methods defined:</p>\n\n<pre><code>func (act *ActiveTransactions) NewTransaction(id string, myPayload Payload) {\n    act.mtx.Lock()\n    act.trm[id] = Transaction{currentState: FirstState, Payload: myPayload}\n    act.mtx.Unlock()\n}\n\nfunc (act *ActiveTransactions) GetState(id string) TState {\n    act.mtx.Lock()\n    state := act.trm[id].currentState\n    act.mtx.Unlock()\n    return state\n}\n\nfunc (act *ActiveTransactions) UpdateState(id string, newState TState) {\n    act.mtx.Lock()\n    tmp := act.trm[id]\n    tmp.currentState = newState\n    act.trm[id] = tmp\n    act.mtx.Unlock()\n}\n</code></pre>\n\n<p>This type is created once and is accessed by multiple goroutines. When I run the code it occasionally panics because of concurrent read/write map access (which is not entirely clear to me since access to the map is protected with <code>sync.Mutex</code>).</p>\n\n<p>I have tried to run the code with -race option and it detects race condition as well (from the -race output I can see that race happens for GetState and NewTransaction methods)</p>\n\n<p>What's happening here? Should trm be protected by mtx once <code>Lock()</code> is called? From the examples, I searched in the docs and tutorials the pattern looks ok. Obviously, something is wrong, but it eludes me.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 0, "creation_date": 1484384758, "post_id": 41648308, "comment_id": 70495831, "body": "In your code the second number is the <code>nbytes</code> variable. Or does the older script really take 18.5 hours (66576 seconds) to run?"}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "reply_to_user": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 0, "creation_date": 1484385128, "post_id": 41648308, "comment_id": 70495908, "body": "Thank you, ... I&#39;ve update the question with new title and a better description. Sorry again."}], "answers": [{"comments": [{"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1484385637, "post_id": 41648431, "comment_id": 70496004, "body": "Yeah!!! I&#39;ve just inverted <code>nbytes, err := io.Copy(ioutil.Discard, resp.Body)</code> and <code>body, err := ioutil.ReadAll(resp.Body)</code>. Good Thank you for the answer!"}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1484386205, "post_id": 41648431, "comment_id": 70496135, "body": "But, .. how can I read the content and then count the amount of bytes?"}, {"owner": {"reputation": 4370, "user_id": 465082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab74528b8223851cd7b546beec220fdc?s=128&d=identicon&r=PG", "display_name": "Kashyap", "link": "https://stackoverflow.com/users/465082/kashyap"}, "reply_to_user": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1484387424, "post_id": 41648431, "comment_id": 70496400, "body": "Not entirely sure. <code>body</code> holds a byte array. You <i>can</i> find out the length of that using <code>len</code> but this is probably not what you want. I checked the values, and there was a difference of around 56, with <code>io.Copy</code> returning a higher value."}, {"owner": {"reputation": 4370, "user_id": 465082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab74528b8223851cd7b546beec220fdc?s=128&d=identicon&r=PG", "display_name": "Kashyap", "link": "https://stackoverflow.com/users/465082/kashyap"}, "reply_to_user": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1484390566, "post_id": 41648431, "comment_id": 70497117, "body": "correction: the comment about difference is my mistake."}], "tags": [], "owner": {"reputation": 4370, "user_id": 465082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab74528b8223851cd7b546beec220fdc?s=128&d=identicon&r=PG", "display_name": "Kashyap", "link": "https://stackoverflow.com/users/465082/kashyap"}, "is_accepted": true, "score": 1, "last_activity_date": 1484385723, "last_edit_date": 1484385723, "creation_date": 1484385506, "answer_id": 41648431, "question_id": 41648308, "link": "https://stackoverflow.com/questions/41648308/why-nbytes-err-io-copyioutil-discard-resp-body-always-returns-0/41648431#41648431", "title": "why `nbytes, err := io.Copy(ioutil.Discard, resp.Body)` always returns 0?", "body": "<p>The reason for this is because you've already read the response at the time of that call once. So the second time, 0 bytes are read from the stream. After the error checking calls are removed:</p>\n\n<pre><code>resp, err := http.Get(url)\nbody, err := ioutil.ReadAll(resp.Body)\nnbytes, err := io.Copy(ioutil.Discard, resp.Body)\n</code></pre>\n\n<p>Note the <code>ReadAll</code> call on the second line.</p>\n\n<p>One more small suggestion I'd like to propose (not related to the actual question) is to use the <code>defer</code> calls right after initialising the stream. For instance:</p>\n\n<pre><code>resp, err := http.Get(url)\nif err != nil {\n    ch &lt;- fmt.Sprint(err)\n    return\n}\ndefer resp.Body.Close()\n</code></pre>\n\n<p>Although not mentioned specifically, it can be inferred from <a href=\"https://golang.org/doc/effective_go.html#defer\" rel=\"nofollow noreferrer\">this section in Effective Go</a>. Paraphrasing here:</p>\n\n<blockquote>\n  <p>Second, it means that the close sits near the open, which is much clearer than placing it at the end of the function.</p>\n</blockquote>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2628, "favorite_count": 0, "accepted_answer_id": 41648431, "answer_count": 1, "score": 0, "last_activity_date": 1484386177, "creation_date": 1484384336, "last_edit_date": 1484386177, "question_id": 41648308, "link": "https://stackoverflow.com/questions/41648308/why-nbytes-err-io-copyioutil-discard-resp-body-always-returns-0", "title": "why `nbytes, err := io.Copy(ioutil.Discard, resp.Body)` always returns 0?", "body": "<p>I've written a simple program that fetch a list of url to store them inside some files. In this example google and gmail. I always run same command in different software version. Program is stored inside goFetchAll: this is the name of compiled version of the algorithm.</p>\n\n<ul>\n<li>go build</li>\n<li>./goFetchAll <a href=\"http://www.google.com\" rel=\"nofollow noreferrer\">http://www.google.com</a> <a href=\"http://www.gmail.com\" rel=\"nofollow noreferrer\">http://www.gmail.com</a></li>\n</ul>\n\n<blockquote>\n<pre><code>0.23s        0  http://www.google.com\n1.15s        0  http://www.gmail.com\n</code></pre>\n</blockquote>\n\n<p>The second number should be the number of bytes of content. But it is alway 0.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n    \"strings\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n\n    ch := make(chan string)\n\n    for _, url := range os.Args[1:] {\n        go fetch(url, ch)\n    }\n\n    for range os.Args[1:] {\n        fmt.Println(&lt;-ch)\n    }\n\n    secs := time.Since(start).Seconds()\n    fmt.Sprintf(\"%.2fs elapsed\\n\", secs)\n}\n\nfunc fetch(url string, ch chan&lt;- string) {\n    start := time.Now()\n    resp, err := http.Get(url)\n    if err != nil {\n        ch &lt;- fmt.Sprint(err)\n        return\n    }\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        ch &lt;- fmt.Sprintf(\"Cant catch content\")\n        return\n    }\n\n    nbytes, err := io.Copy(ioutil.Discard, resp.Body)\n    defer resp.Body.Close()\n    if err != nil {\n        ch &lt;- fmt.Sprintf(\"while reading %s: %v\", url, err)\n        return\n    }\n\n    secs := time.Since(start).Seconds()\n    ch &lt;- fmt.Sprintf(\"%.2fs  %7d  %s\", secs, nbytes, url)\n\n    // store on file\n    filename := string(url)\n    filename = strings.Replace(filename, \":\", \"\", -1)\n    filename = strings.Replace(filename, \"//\", \"-\", -1)\n    filename = strings.Replace(filename, \"/\", \"\", -1)\n    filename = strings.Replace(filename, \".\", \"-\", -1)\n    filename = \"downloads/\" + filename + \".html\"\n\n    f, err := os.Create(filename)\n    f.Write(body)\n    defer f.Close()\n    if err != nil {\n        ch &lt;- fmt.Sprintf(\"while writing %s: %v\", url, err)\n        return\n    }\n}\n</code></pre>\n\n<p>I've also an older version of same script that actually works:</p>\n\n<blockquote>\n<pre><code>0.25s    10363  http://www.google.com\n0.89s    66576  http://www.gmail.com\n</code></pre>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n\n    ch := make(chan string)\n\n    for _, url := range os.Args[1:] {\n        go fetch(url, ch)\n    }\n\n    for range os.Args[1:] {\n        fmt.Println(&lt;-ch)\n    }\n\n    fmt.Println(\"%.2fs elapsed\\n\", time.Since(start).Seconds())\n}\n\nfunc fetch(url string, ch chan&lt;- string) {\n    start := time.Now()\n    resp, err := http.Get(url)\n    if err != nil {\n        ch &lt;- fmt.Sprint(err)\n        return\n    }\n\n    nbytes, err := io.Copy(ioutil.Discard, resp.Body)\n    resp.Body.Close()\n    if err != nil {\n        ch &lt;- fmt.Sprintf(\"whioe reading %s: %v\", url, err)\n        return\n    }\n\n    secs := time.Since(start).Seconds()\n    ch &lt;- fmt.Sprintf(\"%.2fs  %7d  %s\", secs, nbytes, url)\n}\n</code></pre>\n\n<p>Can someone explain why the newest version always count 0 seconds?</p>\n\n<hr>\n\n<p>My partial solution is the following. I've just request again <code>http.Get(url)</code></p>\n\n<pre><code>resp, err := http.Get(url)\nnbytes, err := io.Copy(ioutil.Discard, resp.Body)\ndefer resp.Body.Close() // dont leak resources\nif err != nil {\n    ch &lt;- fmt.Sprintf(\"while reading %s: %v\", url, err)\n    return\n}\n\nresp, err = http.Get(url)\nbody, err := ioutil.ReadAll(resp.Body)\nif err != nil {\n    ch &lt;- fmt.Sprintf(\"Cant catch content\")\n    return\n}\n</code></pre>\n"}, {"tags": ["python", "go", "io", "byte"], "comments": [{"owner": {"reputation": 2138, "user_id": 208928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/750d9308974f986f174f94947adaeec2?s=128&d=identicon&r=PG", "display_name": "Sairam", "link": "https://stackoverflow.com/users/208928/sairam"}, "edited": false, "score": 0, "creation_date": 1484380054, "post_id": 41647802, "comment_id": 70494895, "body": "can you hexdump the file to see the contents?"}, {"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "reply_to_user": {"reputation": 2138, "user_id": 208928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/750d9308974f986f174f94947adaeec2?s=128&d=identicon&r=PG", "display_name": "Sairam", "link": "https://stackoverflow.com/users/208928/sairam"}, "edited": false, "score": 0, "creation_date": 1484380148, "post_id": 41647802, "comment_id": 70494912, "body": "<code>012c 3837 3700 </code>"}, {"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "reply_to_user": {"reputation": 2138, "user_id": 208928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/750d9308974f986f174f94947adaeec2?s=128&d=identicon&r=PG", "display_name": "Sairam", "link": "https://stackoverflow.com/users/208928/sairam"}, "edited": false, "score": 0, "creation_date": 1484380156, "post_id": 41647802, "comment_id": 70494913, "body": "thats the hexdump"}, {"owner": {"reputation": 2138, "user_id": 208928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/750d9308974f986f174f94947adaeec2?s=128&d=identicon&r=PG", "display_name": "Sairam", "link": "https://stackoverflow.com/users/208928/sairam"}, "edited": false, "score": 0, "creation_date": 1484380505, "post_id": 41647802, "comment_id": 70494985, "body": "can you put your complete golang code and give a permalink in the question - <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">play.golang.org</a> (with the Share link)"}, {"owner": {"reputation": 2138, "user_id": 208928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/750d9308974f986f174f94947adaeec2?s=128&d=identicon&r=PG", "display_name": "Sairam", "link": "https://stackoverflow.com/users/208928/sairam"}, "edited": false, "score": 0, "creation_date": 1484380698, "post_id": 41647802, "comment_id": 70495028, "body": "with the given code. I get it perfectly fine  &gt; go run test.go test.thief [1 44 56 55 55 0]"}, {"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "reply_to_user": {"reputation": 2138, "user_id": 208928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/750d9308974f986f174f94947adaeec2?s=128&d=identicon&r=PG", "display_name": "Sairam", "link": "https://stackoverflow.com/users/208928/sairam"}, "edited": false, "score": 0, "creation_date": 1484381072, "post_id": 41647802, "comment_id": 70495112, "body": "yes i actually tested the single file and its likely a something else going wrong"}, {"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "reply_to_user": {"reputation": 2138, "user_id": 208928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/750d9308974f986f174f94947adaeec2?s=128&d=identicon&r=PG", "display_name": "Sairam", "link": "https://stackoverflow.com/users/208928/sairam"}, "edited": false, "score": 0, "creation_date": 1484381214, "post_id": 41647802, "comment_id": 70495146, "body": "How do i put a whole go package in the playground? this is my repo <a href=\"https://github.com/jweinst1/thief\" rel=\"nofollow noreferrer\">github.com/jweinst1/thief</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "edited": false, "score": 0, "creation_date": 1484380208, "post_id": 41647854, "comment_id": 70494918, "body": "Im on python3, maybe thats why? I am using bytes in some other code but its not causing the error and isn&#39;t relevant so i removed it."}, {"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "edited": false, "score": 0, "creation_date": 1484380217, "post_id": 41647854, "comment_id": 70494919, "body": "This is the hexdump of the file"}, {"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "edited": false, "score": 0, "creation_date": 1484380224, "post_id": 41647854, "comment_id": 70494921, "body": "<code>012c 3837 3700 </code>"}, {"owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "reply_to_user": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "edited": false, "score": 0, "creation_date": 1484380336, "post_id": 41647854, "comment_id": 70494942, "body": "I don&#39;t see how the contents of the file matter unless thats some golf code that interacts with go&#39;s <code>ReadFile</code> or something."}, {"owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "edited": false, "score": 0, "creation_date": 1484380424, "post_id": 41647854, "comment_id": 70494967, "body": "well this code works if i read some normal file like a .txt file or something, so i feel i might be writing the bytes in correctly."}, {"owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "reply_to_user": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "edited": false, "score": 0, "creation_date": 1484380499, "post_id": 41647854, "comment_id": 70494983, "body": "the contents of the gocode above will not compile with go&#39;s regular compiler because the variable <code>bytes</code> is declared and not used. Did you write your own go compiler?"}], "tags": [], "owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "is_accepted": false, "score": 0, "last_activity_date": 1484379996, "creation_date": 1484379996, "answer_id": 41647854, "question_id": 41647802, "link": "https://stackoverflow.com/questions/41647802/cannot-read-bytes-from-file-with-go-after-writing/41647854#41647854", "title": "cannot read bytes from file with go after writing", "body": "<p>It looks like you're not writing to the file in your python code?</p>\n\n<p>I get </p>\n\n<pre><code>Traceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: write() argument must be str, not bytearray\n</code></pre>\n\n<p>After your third line which would explain why golang can't find the file contents.</p>\n\n<p>Also you're not using <code>bytes</code> so your gocode won't compile. Do this instead.</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n   \"io/ioutil\"\n   \"os\"\n)\n\nfunc main() {\n  //gets command line args\n    userArgs := os.Args[1:]\n\n    _, err := ioutil.ReadFile(userArgs[0]) // just pass the file name\n    if err != nil {\n        fmt.Print(err)\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "is_accepted": true, "score": 2, "last_activity_date": 1484381020, "creation_date": 1484381020, "answer_id": 41647963, "question_id": 41647802, "link": "https://stackoverflow.com/questions/41647802/cannot-read-bytes-from-file-with-go-after-writing/41647963#41647963", "title": "cannot read bytes from file with go after writing", "body": "<p>If you use Python 3, the file must be opened in the binary mode:</p>\n\n<pre><code>btest = open(\"test.thief\", \"wb\")\n</code></pre>\n"}], "owner": {"reputation": 2104, "user_id": 5129504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/476994845791992/picture?type=large", "display_name": "Josh Weinstein", "link": "https://stackoverflow.com/users/5129504/josh-weinstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "accepted_answer_id": 41647963, "answer_count": 2, "score": -1, "last_activity_date": 1484381456, "creation_date": 1484379334, "last_edit_date": 1484381456, "question_id": 41647802, "link": "https://stackoverflow.com/questions/41647802/cannot-read-bytes-from-file-with-go-after-writing", "title": "cannot read bytes from file with go after writing", "body": "<p>So, i am trying to make a simple AOT virtual machine in golang, that reads a bytecode file as it's input. I am trying to very basically, write bytes to a file then read them with <code>ioutil</code>, however I am encountering a null dereference error.</p>\n\n<p>This is my python code used for writing to the file:</p>\n\n<pre><code>btest = open(\"test.thief\", \"w\")\nbytes_to_write = bytearray([1, 44, 56, 55, 55, 0])\n\nbtest.write(bytes_to_write)\n\nbtest.close()\n</code></pre>\n\n<p>This is the code in my go file that I am using to read the bytes</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n   \"io/ioutil\"\n   \"os\"\n)\n\nfunc main() {\n  //gets command line args\n    userArgs := os.Args[1:]\n\n    bytes, err := ioutil.ReadFile(userArgs[0]) // just pass the file name\n    if err != nil {\n        fmt.Print(err)\n    }\n\n     fmt.Println(bytes)\n     machine := NewEnv()\n     ReadBytes(machine, bytes)\n\n}\n</code></pre>\n\n<p>And this is the error i am getting:</p>\n\n<pre><code>Joshuas-MacBook-Pro-3:thief Josh$ ./bin/Thief test.thief\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x2af3]\n\ngoroutine 1 [running]:\nmain.ReadBytes(0xc82000e390, 0xc82000c480, 0x6, 0x206)\n    /Users/Josh/thief/src/Thief/read.go:26 +0x353\nmain.main()\n    /Users/Josh/thief/src/Thief/Main.go:18 +0x1f2\n</code></pre>\n\n<p>I have also tried opening the file in binary mode with the python code, but it produces the same error. Basically the goal of this is that I want to be able to extract an array of bytes but also have a way to write theme.</p>\n\n<p>Am i writing the bytes incorrectly?</p>\n\n<p>Here is the hexdump:</p>\n\n<p><code>012c 3837 3700</code></p>\n\n<p>EDIT:</p>\n\n<p>This is the rest of my go files</p>\n\n<p>opfuncs.go</p>\n\n<pre><code>package main\n\n\n//file for machine functions and operations\n\n//prints string format of some bytes\nfunc print(env Env, data []byte) {\n    fmt.Println(string(data))\n}\n\n\nvar OPERS map[byte]func(Env, []byte)\n\n//0 is reserved as the null terminator\nfunc init(){\n    OPERS = map[byte]func(Env, []byte){\n        1:print,\n    }\n}\n</code></pre>\n\n<p>env.go</p>\n\n<pre><code>package main\n\n\n//file for the env struct\n\n\n\ntype Env struct {\n    items map[string]interface{}\n}\n\nfunc NewEnv() Env {\n    return Env{make(map[string]interface{})}\n}\n\n//general getter\nfunc (self *Env) get(key string) interface{} {\n    val, has := self.items[key]\n    if has {\n        return val\n    } else {\n        return nil\n    }\n}\n\n//general setter\nfunc (self *Env) set(key string, value interface{}) {\n    self.items[key] = value\n}\n\nfunc (self *Env) contains(key string) bool {\n    _, has := self.items[key]\n    return has\n}\n\nfunc (self *Env) declare(key string) {\n    self.items[key] = Null{}\n}\n\nfunc (self *Env) is_null(key string) bool {\n    _, ok := self.items[key].(Null)\n    return ok\n}\n\n//deletes an item from storage\nfunc (self *Env) del(key string) {\n    delete(self.items, key)\n}\n</code></pre>\n\n<p>read.go</p>\n\n<pre><code>package main\n\n//file that contains the reading function for the VM\n\nfunc ReadBytes(env Env, in []byte) {\n    bytes := make([]byte, 1)\n    fn := byte(0)\n    mode := 0\n    for i:=0;i&lt;len(in);i++ {\n        switch mode {\n        case 0:\n            fn = byte(i)\n            mode = 1\n        case 1:\n            if i != len(in)-1 {\n                if in[i+1] == 0 {\n                    bytes = append(bytes, in[i])\n                    mode = 2\n                } else {\n                    bytes = append(bytes, in[i])\n                }\n            } else {\n                bytes = append(bytes, in[i])\n            }\n        case 2:\n            OPERS[fn](env, bytes)\n            mode = 0\n            fn = byte(0)\n            bytes = make([]byte, 1)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "edited": false, "score": 0, "creation_date": 1484379559, "post_id": 41647788, "comment_id": 70494787, "body": "Uh, set the variable of ThumbnailUrl to the url you want in whatever is calling the template? I don&#39;t think <code>replace</code> is a thing in go templates."}], "answers": [{"tags": [], "owner": {"reputation": 2138, "user_id": 208928, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/750d9308974f986f174f94947adaeec2?s=128&d=identicon&r=PG", "display_name": "Sairam", "link": "https://stackoverflow.com/users/208928/sairam"}, "is_accepted": true, "score": 5, "last_activity_date": 1484380410, "creation_date": 1484380410, "answer_id": 41647898, "question_id": 41647788, "link": "https://stackoverflow.com/questions/41647788/how-to-replace-string-in-go-template/41647898#41647898", "title": "How to replace string in Go template?", "body": "<blockquote>\n  <p>You can write a helper view function like this</p>\n</blockquote>\n\n<pre><code>func replace(input, from,to string) string {\n    return strings.Replace(input,from,to, -1)\n}\n\nfuncMap = template.FuncMap{\n        \"replace\":  replace,\n}\ntemplate := template.New(\"\").Funcs(internalFuncMap)\n</code></pre>\n\n<p>and use the <code>template</code> to render the view.</p>\n\n<blockquote>\n  <p>code ref links</p>\n</blockquote>\n\n<ol>\n<li><a href=\"https://github.com/sairam/kinli/blob/master/template_funcs.go#L57-L59\" rel=\"noreferrer\">https://github.com/sairam/kinli/blob/master/template_funcs.go#L57-L59</a></li>\n<li><a href=\"https://github.com/sairam/kinli/blob/master/templates.go#L48\" rel=\"noreferrer\">https://github.com/sairam/kinli/blob/master/templates.go#L48</a></li>\n</ol>\n"}], "owner": {"reputation": 382, "user_id": 2658551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EzVok.jpg?s=128&g=1", "display_name": "Dian", "link": "https://stackoverflow.com/users/2658551/dian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10303, "favorite_count": 2, "accepted_answer_id": 41647898, "answer_count": 1, "score": 10, "last_activity_date": 1484405203, "creation_date": 1484379227, "last_edit_date": 1484405203, "question_id": 41647788, "link": "https://stackoverflow.com/questions/41647788/how-to-replace-string-in-go-template", "title": "How to replace string in Go template?", "body": "<p>I use <code>\"text/template\"</code> module.</p>\n\n<p>I have struct like this to parse XML from Blogger</p>\n\n<pre><code>type Media struct {\n    ThumbnailUrl string `xml:\"url,attr\"`\n}\n\n\ntype Entry struct {\n    ID string `xml:\"id\"`\n    Published Date `xml:\"published\"`\n    Updated Date `xml:\"updated\"`\n    Draft Draft `xml:\"control&gt;draft\"`\n    Title string `xml:\"title\"`\n    Content string `xml:\"content\"`\n    Tags Tags `xml:\"category\"`\n    Author Author `xml:\"author\"`\n    Media Media `xml:\"thumbnail\"`\n    Extra string\n}\n</code></pre>\n\n<p>Then I create Go Template like this</p>\n\n<pre><code>[image]\n    src = \"{{ replace .Media.ThumbnailUrl 's72-c' 's1600' }}\"\n    link = \"\"\n    thumblink = \"{{ .Media.ThumbnailUrl }}\"\n    alt = \"\"\n    title = \"\"\n    author = \"\"\n    license = \"\"\n    licenseLink = \"\"\n</code></pre>\n\n<p>The replace function not defined. I want to replace URL from <code>{{ .Media.ThumbnailUrl }}</code></p>\n\n<p>For example:</p>\n\n<p>from this URL</p>\n\n<p><code>https://2.bp.blogspot.com/-DEeRanrBa6s/WGWGwA2qW5I/AAAAAAAADg4/feGUc-g9rXc9B7hXpKr0ecG9UOMXU3_VQCK4B/s72-c/pemrograman%2Bjavascript%2B-%2Bpetanikode.png</code></p>\n\n<p>To this URL</p>\n\n<p><code>https://2.bp.blogspot.com/-DEeRanrBa6s/WGWGwA2qW5I/AAAAAAAADg4/feGUc-g9rXc9B7hXpKr0ecG9UOMXU3_VQCK4B/s1600/pemrograman%2Bjavascript%2B-%2Bpetanikode.png</code></p>\n"}, {"tags": ["mysql", "sql", "go", "mariadb"], "comments": [{"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1484456464, "post_id": 41647251, "comment_id": 70514639, "body": "Does &quot;not supplied&quot; come in as the empty string, or as <code>NULL</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484373655, "post_id": 41647264, "comment_id": 70493759, "body": "Wouldn&#39;t this require me to pass in the same variable twice in a row?"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484373700, "post_id": 41647264, "comment_id": 70493769, "body": "Is that my only option?"}, {"owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484373771, "post_id": 41647264, "comment_id": 70493778, "body": "No, I found another one"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484373804, "post_id": 41647264, "comment_id": 70493782, "body": "Ah, that&#39;s exactly what I was looking for. Thanks! I&#39;ll accept your answer when it allows me in a few minutes."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484374679, "post_id": 41647264, "comment_id": 70493911, "body": "I thought I read MariaDB recognizes empty string as null, but I was wrong. Since empty string is not <code>NULL</code>, <code>COALESCE()</code> is choosing the empty string."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484376022, "post_id": 41647264, "comment_id": 70494133, "body": "I ended up using the first example and passing in each variable twice in a row. However, it would be better if I could only supply each variable once."}, {"owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484377155, "post_id": 41647264, "comment_id": 70494325, "body": "The clean solution would be to make sure the DB gets NULL instead of empty strings."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484411512, "post_id": 41647264, "comment_id": 70503212, "body": "Is there an easy way for that to be done? I am just Unmarshalling JSON into a struct and passing it in to the method to be updated. Even if the JSON has a null value, it gets set to empty string when the struct is created."}, {"owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1484411974, "post_id": 41647264, "comment_id": 70503360, "body": "Sorry, I am no expert in JSON."}], "tags": [], "owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "is_accepted": true, "score": 2, "last_activity_date": 1484373815, "last_edit_date": 1484373815, "creation_date": 1484373624, "answer_id": 41647264, "question_id": 41647251, "link": "https://stackoverflow.com/questions/41647251/update-mariadb-column-when-provided-value-is-not-empty-string/41647264#41647264", "title": "Update MariaDB column when provided value is not empty string", "body": "<p>Like this</p>\n\n<pre><code>UPDATE Users\nSET FirstName = case when ? is null then FirstName else ? end\n</code></pre>\n\n<p>or to pass each parameter just once</p>\n\n<pre><code>UPDATE Users\nSET FirstName = coalesce(?, FirstName)\n</code></pre>\n"}], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 41647264, "answer_count": 1, "score": 0, "last_activity_date": 1484374607, "creation_date": 1484373475, "last_edit_date": 1484374607, "question_id": 41647251, "link": "https://stackoverflow.com/questions/41647251/update-mariadb-column-when-provided-value-is-not-empty-string", "title": "Update MariaDB column when provided value is not empty string", "body": "<p>I am currently working on a Golang application that talks to a MariaDB database. My service will take in a <code>*User</code> and attempt to update the matching record.</p>\n\n<p>For example:</p>\n\n<pre><code>func (d *database) UpdateUser(user *User) error {\n    stmt, err := d.Prepare(`UPDATE Users\n        SET FirstName=?, LastName=?, Email=?, Address1=?, Address2=?,\n            City=?, State=?, Country=?, PostalCode=?\n        WHERE Id=?`)\n    if err != nil {\n        return err\n    }\n\n    _, err := res, err := stmt.Exec(user.FirstName, user.LastName, user.Email,\n        user.Address1, user.Address2, user.City, user.State, user.Country, \n        user.PostalCode, user.Id)\n    return err\n}\n</code></pre>\n\n<p>However, I do not want to update fields that aren't supplied. I am looking for something closer to this, where it would not update the value if the provided one is an empty string:</p>\n\n<pre><code>`UPDATE Users\n SET FirstName=? OR FirstName, LastName=? OR LastName, Email=? OR Email, \n     Address1=? OR Address1, Address2=? OR Address2, City=? OR City, \n     State=? OR State, Country=? OR Country, PostalCode=? OR PostalCode\n WHERE Id=?`\n</code></pre>\n\n<p>I have seen that SQL allows for updating using a <code>CASE</code> statement, but I do not see a way to use this without providing the same variable to the <code>Exec()</code> several times.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1484375858, "post_id": 41647054, "comment_id": 70494115, "body": "Beware though that the <code>path</code> package is for manipulating path components of URIs; for filesystem paths one has to use the <code>path&#47;filepath</code> package instead."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1484371388, "creation_date": 1484371388, "answer_id": 41647054, "question_id": 41646985, "link": "https://stackoverflow.com/questions/41646985/golang-os-open-can-i-use-form-file-along-with-it-for-dynamic-files/41647054#41647054", "title": "Golang os.Open can I use form file along with it for dynamic files", "body": "<p>In a file server (such as <a href=\"https://gist.github.com/alexisrobert/982674#file-webserver-go-L244\" rel=\"nofollow noreferrer\">this one</a>), you are suppose to concatenate a <code>root_folder</code> to the file/path you get from your form.</p>\n\n<pre><code>filepath := path.Join((root_folder), h.Filename)\n</code></pre>\n\n<p>That way, you open files which are within a certain root folder, instead of <em>any</em> file on your system (which is not secure at all).</p>\n"}], "owner": {"reputation": 913, "user_id": 5551912, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4ed9452605a562b6865a5527f92173a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rome Torres", "link": "https://stackoverflow.com/users/5551912/rome-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 1, "accepted_answer_id": 41647054, "answer_count": 1, "score": 1, "last_activity_date": 1484371388, "creation_date": 1484370541, "question_id": 41646985, "link": "https://stackoverflow.com/questions/41646985/golang-os-open-can-i-use-form-file-along-with-it-for-dynamic-files", "title": "Golang os.Open can I use form file along with it for dynamic files", "body": "<p>This is my first time using Os.Open and I was wondering can I use that for dynamic images (Images found in different directories) or do I have to put the full path every single time ? For instance in my FormFile</p>\n\n<pre><code>func ExampleFunc(w http.ResponseWriter, t *http.Request) {\n     t.ParseForm()\n     f, h, err := t.FormFile(\"file\")\n       if err != nil {\n        print(err) }\n       os.Open(h.Filename)\n}\n</code></pre>\n\n<p>The function above gives me an error no such file or directory found however if I put the full path in there such as </p>\n\n<pre><code>os.Open(\"/Home/myfiles/Documents/pictures/horse_riding.png\")\n</code></pre>\n\n<p>Then the image opens, is there a way of dynamically get the Image path and inserting that in os.Open ? I do have a FormFile that gets information about the incoming file but not the full path .</p>\n"}, {"tags": ["database", "sqlite", "go"], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 1253162, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c3a4df172b3c5620a365cc81d28e3f9c?s=128&d=identicon&r=PG", "display_name": "Adam Dally", "link": "https://stackoverflow.com/users/1253162/adam-dally"}, "edited": false, "score": 0, "creation_date": 1484404497, "post_id": 41647695, "comment_id": 70500914, "body": "Thank you for pointing out the exact direction. I realized then I wasn&#39;t looping through the results of the query to scan for the value. Works great!"}], "tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": true, "score": 1, "last_activity_date": 1484378056, "creation_date": 1484378056, "answer_id": 41647695, "question_id": 41646639, "link": "https://stackoverflow.com/questions/41646639/retrieving-sqlite-pragma-user-version-with-golang/41647695#41647695", "title": "Retrieving SQLite Pragma user_version with Golang", "body": "<p>When you are using <code>PRAGMA user_version</code> to read the value, this statement behaves exactly like a query, i.e., <code>SELECT user_version FROM somewhere</code>.\nSo just use <code>Query()</code>.</p>\n"}], "owner": {"reputation": 405, "user_id": 1253162, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c3a4df172b3c5620a365cc81d28e3f9c?s=128&d=identicon&r=PG", "display_name": "Adam Dally", "link": "https://stackoverflow.com/users/1253162/adam-dally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 41647695, "answer_count": 1, "score": 1, "last_activity_date": 1484378056, "creation_date": 1484366001, "question_id": 41646639, "link": "https://stackoverflow.com/questions/41646639/retrieving-sqlite-pragma-user-version-with-golang", "title": "Retrieving SQLite Pragma user_version with Golang", "body": "<p>This is the first project where I've used SQLite and in an attempt to do semi-automatic schema migration I would like to use the user_version pragma that has been suggested by many other answers on stackoverflow.</p>\n\n<p>I am attempting to do this in Golang but am unsure if I should be using Exec, Query, or something similar to get this result and then how to render it into something usable.</p>\n\n<p>within sqlite3 I can run 'PRAGMA user_version;' and it will return 3 or whatever value I have it set to.</p>\n"}, {"tags": ["go", "amazon-s3"], "answers": [{"comments": [{"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 0, "creation_date": 1567560520, "post_id": 41645765, "comment_id": 101995393, "body": "You should accept your answer. You can do it now since it has been more than 2 days."}, {"owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "edited": false, "score": 0, "creation_date": 1616781593, "post_id": 41645765, "comment_id": 118119974, "body": "Using an empty buffer is very inefficient. It is 20x times faster for 30MB file if you preallocate memory. See <a href=\"https://github.com/aws/aws-sdk-go-v2/pull/483\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-go-v2/pull/483</a>"}], "tags": [], "owner": {"reputation": 541, "user_id": 6896226, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/39304dac7e265dae778259258a7df64f?s=128&d=identicon&r=PG&f=1", "display_name": "sriba", "link": "https://stackoverflow.com/users/6896226/sriba"}, "is_accepted": false, "score": 35, "last_activity_date": 1567560949, "last_edit_date": 1567560949, "creation_date": 1484356386, "answer_id": 41645765, "question_id": 41645377, "link": "https://stackoverflow.com/questions/41645377/golang-s3-download-to-buffer-using-s3manager-downloader/41645765#41645765", "title": "golang s3 download to buffer using s3manager.downloader", "body": "<p>Found it from the link\n<a href=\"https://groups.google.com/forum/#!topic/Golang-Nuts/4z8rcWEZ8Os\" rel=\"noreferrer\">https://groups.google.com/forum/#!topic/Golang-Nuts/4z8rcWEZ8Os</a></p>\n\n<pre><code>buff := &amp;aws.WriteAtBuffer{}\ndownloader := s3manager.NewDownloader(session.New(&amp;aws.Config{\n                                      Region: aws.String(S3_Region)}))\nnumBytes, err := downloader.Download(buff,....\ndata := buff.Bytes() // now data is my []byte array\n</code></pre>\n\n<p>Works and fits the need.</p>\n\n<p>See also: <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/aws/#WriteAtBuffer\" rel=\"noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/aws/#WriteAtBuffer</a></p>\n"}], "owner": {"reputation": 541, "user_id": 6896226, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/39304dac7e265dae778259258a7df64f?s=128&d=identicon&r=PG&f=1", "display_name": "sriba", "link": "https://stackoverflow.com/users/6896226/sriba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12418, "favorite_count": 6, "answer_count": 1, "score": 14, "last_activity_date": 1567560949, "creation_date": 1484353005, "last_edit_date": 1567559873, "question_id": 41645377, "link": "https://stackoverflow.com/questions/41645377/golang-s3-download-to-buffer-using-s3manager-downloader", "title": "golang s3 download to buffer using s3manager.downloader", "body": "<p>I'm using the Amazon s3 SDK to download files like below:</p>\n\n<pre><code>file, err := os.Create(\"/tmp/download_file\")\ndownloader := s3manager.NewDownloader(session.New(&amp;aws.Config{\n                                 Region: aws.String(\"us-west-2\")}))\nnumBytes, err := downloader.Download(file,\n    &amp;s3.GetObjectInput{\n        Bucket: aws.String(bucketName),\n        Key:    aws.String(fileName),\n    })\n</code></pre>\n\n<p>It downloads to a file.</p>\n\n<p>How do I get the download content into a <code>[]byte</code> slice (buffer) directly. \nI tried something like:</p>\n\n<pre><code>var tBuf bytes.Buffer\ntBufIo := bufio.NewWriter(&amp;tBuf)\n</code></pre>\n\n<p>instead of \"file\". But I get an error for <code>io.WriterAt</code> interface</p>\n\n<blockquote>\n  <p>cannot use *tBufIo (type bufio.Writer) as type io.WriterAt in argument to downloader.Download</p>\n</blockquote>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1484350082, "creation_date": 1484350082, "answer_id": 41645022, "question_id": 41644747, "link": "https://stackoverflow.com/questions/41644747/golang-how-can-i-integrate-new-package-into-my-image-upload-code/41645022#41645022", "title": "Golang how can I integrate new package into my image upload code", "body": "<p>You're saving the new image to a file, then not doing anything with that file. You could read the file off the disk if you want, or you could encode it in memory:</p>\n\n<pre><code>...\nresized := imaging.Resize(fileOpen, 300, 300, imaging.Lanczos)\n\nvar buf byte.Buffer\nerr = imaging.Encode(&amp;buf, resized, imaging.JPEG)\nif err != nil {\n    log.Println(err)\n    return\n}\n\nparams := &amp;s3.PutObjectInput{\n    Bucket: aws.String(\"amazon-bucket\"),\n    Key:    aws.String(path),\n    Body:   buf.Bytes(),\n}\n...\n</code></pre>\n"}], "owner": {"reputation": 1195, "user_id": 1949387, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/07aecc3a985b916b35133da1d5b5634c?s=128&d=identicon&r=PG", "display_name": "user1949387", "link": "https://stackoverflow.com/users/1949387/user1949387"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 41645022, "answer_count": 1, "score": 0, "last_activity_date": 1484350082, "creation_date": 1484348250, "question_id": 41644747, "link": "https://stackoverflow.com/questions/41644747/golang-how-can-i-integrate-new-package-into-my-image-upload-code", "title": "Golang how can I integrate new package into my image upload code", "body": "<p>I am new to Golang and have a function that uploads an image to my Amazon s3 account and saves it . Everything works great however I was looking for a way to resize images as some images are up to 4MB in size. I found a package that works correctly for resizing images <a href=\"https://github.com/disintegration/imaging\" rel=\"nofollow noreferrer\">https://github.com/disintegration/imaging</a> . My question is how can I use the new resized image instead of the old file to upload ? For instance this is my original code that uploads an image and does not resize</p>\n\n<pre><code>func UploadProfile(w http.ResponseWriter, r *http.Request) {\n     r.ParseForm()\n     var buff bytes.Buffer\n         var result string\n\n\n     sess, _ := \"access keys\"\n\n     svc := s3.New(sess)\n\n     file, handler, err := r.FormFile(\"file\")\n     if err != nil {\n         fmt.Println(\"Error Uploading Image\")\n         return\n     }\n     defer file.Close()\n     read_file,err := ioutil.ReadAll(file)\n     fileBytes := bytes.NewReader(read_file)\n     if err != nil {\n         fmt.Println(\"Error Reading file\")\n         return\n     }\n\n\n     file.Read(read_file)\n     path := handler.Filename\n     params := &amp;s3.PutObjectInput{\n         Bucket: aws.String(\"amazon-bucket\"),\n         Key: aws.String(path),\n         Body: fileBytes,\n     }\n     resp, err := svc.PutObject(params)\n     if err != nil {\n         fmt.Printf(\"bad response: %s\", err)\n\n     }\n\n }\n</code></pre>\n\n<p>The issue I am now having is with this snippet below</p>\n\n<pre><code> file_open,err := imaging.Open(\"myImage.jpg\")\n\n        if err != nil {\n            print(\"Imaging Open error\")\n        }\n        new_image := imaging.Resize(file_open, 300, 300, imaging.Lanczos)\n        errs := imaging.Save(new_image, \"dst.jpg\")\n        if errs != nil {\n            print(err)\n        }\n</code></pre>\n\n<p>The code above gets any image and resizes it to 300 by 300 which is exactly what I want, now how can I use that new Image and send it to my s3 image bucket ? The part that confuses me is that the new_image is of type <strong>image.NRGBA</strong> while the original image is of type <strong>Multipart.File</strong> . When I upload an image to Amazon it wants to know how many bytes it has and I can't do something like</p>\n\n<pre><code>read_file,err := ioutil.ReadAll(new_image)\n        if err != nil {\n            fmt.Println(\"Error Reading file\")\n            return\n        }\n</code></pre>\n\n<p>because it only expects something of type io.Reader is there any work around this ? so that I can save my new Image to Amazon s3 ?</p>\n"}, {"tags": ["mongodb", "go", "macos-sierra"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484347261, "post_id": 41644489, "comment_id": 70488923, "body": "Did you recompile mongoimport after you installed go1.7 (go1.7.4)?"}, {"owner": {"reputation": 1499, "user_id": 5128105, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/NDMnr.png?s=128&g=1", "display_name": "Sundar", "link": "https://stackoverflow.com/users/5128105/sundar"}, "edited": false, "score": 0, "creation_date": 1486315443, "post_id": 41644489, "comment_id": 71282193, "body": "Use homebrew to reinstall mongo."}, {"owner": {"reputation": 337, "user_id": 1144561, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/276649d62720dbe5f34abdb8ace44f1c?s=128&d=identicon&r=PG", "display_name": "tjones", "link": "https://stackoverflow.com/users/1144561/tjones"}, "edited": false, "score": 0, "creation_date": 1490384411, "post_id": 41644489, "comment_id": 73105247, "body": "I have a similar error, reinstalling mongo doesn&#39;t help."}], "answers": [{"tags": [], "owner": {"reputation": 345, "user_id": 522213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0bfef3a94ce9a742ef0692d742f11b02?s=128&d=identicon&r=PG", "display_name": "Lokendra Chauhan", "link": "https://stackoverflow.com/users/522213/lokendra-chauhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1504149479, "last_edit_date": 1504149479, "creation_date": 1504149065, "answer_id": 45972605, "question_id": 41644489, "link": "https://stackoverflow.com/questions/41644489/mongoimport-throwing-random-mspanlist-insert-error-on-mac-sierra-10-12-2/45972605#45972605", "title": "mongoimport throwing Random MSpanList_Insert error on mac Sierra 10.12.2", "body": "<p><strong>I solved similar issue after cleaning up the data and running 'mongoimport' again using new mongo version 3.7.4 on macOS Sierra 10.12.6.</strong>  </p>\n\n<p><strong>Before solving the issue:</strong> </p>\n\n<p>I was using mongo version 3.0.7 (with macOS Sierra 10.12.6). I have observed similar issue today when I tried to import a large JSON file. Here is the sample command and error: </p>\n\n<pre><code>./mongoimport --host localhost --port 27017 --db mydb --collection access --type json  --file /Users/data.json\n\n2017-08-31T08:08:29.376+0530    connected to: localhost:27017\nfailed MSpanList_Insert 0x1341998 0x2a98efb0db8fa 0x0\nfatal error: MSpanList_Insert\n\nruntime stack:\nruntime.MSpanList_Insert(0x433940, 0x1341998)\n    /usr/local/go/src/runtime/mheap.c:692 +0x8f\nruntime.MHeap_Alloc(0x433660, 0x1, 0x10000000009, 0xd9e9)\n    /usr/local/go/src/runtime/mheap.c:240 +0x66\nruntime.MCentral_CacheSpan(0x43a9b8, 0xc20c2e9c88)\n    /usr/local/go/src/runtime/mcentral.c:85 +0x167\nruntime.MCache_Refill(0x600960, 0x9, 0x8013417f8)\n    /usr/local/go/src/runtime/mcache.c:90 +0xa0\n\ngoroutine 20 [running]:\nruntime.switchtoM()\n    /usr/local/go/src/runtime/asm_amd64.s:198 fp=0xc20c2e9368 sp=0xc20c2e9360\nruntime.mallocgc(0x80, 0x0, 0x3, 0xc208531718)\n    /usr/local/go/src/runtime/malloc.go:178 +0x849 fp=0xc20c2e9418 sp=0xc20c2e9368\nruntime.rawmem(0x80, 0x80)\n    /usr/local/go/src/runtime/malloc.go:371 +0x39 fp=0xc20c2e9440 sp=0xc20c2e9418\n\n./mongoimport --version\nmongoimport version: 3.0.7\ngit version: 134c548992e8248c7a7c53777a652cbb2490ab6c\n</code></pre>\n\n<p><strong>How it got fixed:</strong>\nI removed the mongo data under /data/db/*. It will be some other path as per your configuration.</p>\n\n<pre><code>sudo rm -rf /data/db/*\n</code></pre>\n\n<p>Then I downloaded &amp; installed new mongo version 3.7.4 from <a href=\"http://here\" rel=\"nofollow noreferrer\">https://www.mongodb.com/dr/fastdl.mongodb.org/osx/mongodb-osx-ssl-x86_64-3.4.7.tgz/download</a> </p>\n\n<pre><code>drwxr-xr-x   8 root  root  272 Aug 31 07:38 mongodb-osx-x86_64-3.0.7\ndrwxr-xr-x   7 root  root  238 Aug 31 07:39 mongodb-osx-x86_64-3.4.7\nlrwxr-xr-x   1 root  root   24 Aug 31 07:39 mongo -&gt; mongodb-osx-x86_64-3.4.7\n</code></pre>\n\n<p>Check the mongoimport versoin</p>\n\n<pre><code>./mongoimport  --version\nmongoimport version: r3.4.7\ngit version: cf38c1b8a0a8dca4a11737581beafef4fe120bcd\nGo version: go1.7\n   os: darwin\n   arch: amd64\n   compiler: gc\nOpenSSL version: OpenSSL 0.9.8zh 14 Jan 2016\n</code></pre>\n\n<p>I was successfully able to import the large file (in GBs) using 'mongoimport' 3.4.7.</p>\n\n<p>Note: if you can't cleanup the data same as I did because of any reason. You can try installing new mongo separately and try 'mongoimport' using new version.</p>\n\n<p>I also tried the 'mongoimport' using older version after cleaning up the data but it didn't work. Using latest 'mongoimport' helped to solve my issue.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 59, "user_id": 4730869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c4764234cb3dab2863261f151538bcf?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Heinz", "link": "https://stackoverflow.com/users/4730869/phil-heinz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1369, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1504149479, "creation_date": 1484346797, "question_id": 41644489, "link": "https://stackoverflow.com/questions/41644489/mongoimport-throwing-random-mspanlist-insert-error-on-mac-sierra-10-12-2", "title": "mongoimport throwing Random MSpanList_Insert error on mac Sierra 10.12.2", "body": "<p>My goal is importing a dump from Modulus into my local MongoDB. I have a script that took all of the JSON files and imported them one by one. The script worked great until I installed Sierra. Here is the script:</p>\n\n<pre><code>#!/bin/bash\nFILES=/Users/username/Documents/ModulusDumps/1-12-17/*\nfor f in $FILES\ndo\n  filename=\"${f##*/}\"\n  basename=\"${filename%.[^.]*}\"\n  echo \"$basename $filename\"\n  mongoimport --db meteor --collection $basename --type json --file $f --drop -h 127.0.0.1:3001\ndone\n</code></pre>\n\n<p>Now, after the Sierra install, the script still runs through the JSON files and works, but at random places in the import I get the following:</p>\n\n<blockquote>\n  <p>failed MSpanList_Insert 0x7a0100 0x142f1b79b2cc2 0x0 fatal error:\n  MSpanList_Insert</p>\n  \n  <p>runtime stack: runtime.MSpanList_Insert(0x427610, 0x7a0100)\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/mheap.c:692 +0x8f\n  runtime.MHeap_Alloc(0x4275a0, 0x1, 0x10000000002, 0xd9e9)\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/mheap.c:240 +0x66\n  runtime.MCentral_CacheSpan(0x42e118, 0x4ba3e8)\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/mcentral.c:85 +0x167\n  runtime.MCache_Refill(0x4b5960, 0xc200000002, 0x4ba3e8)\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/mcache.c:90 +0xa0</p>\n  \n  <p>goroutine 54 [running]: runtime.switchtoM()\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/asm_amd64.s:198\n  fp=0xc209723878 sp=0xc209723870 runtime.mallocgc(0x5, 0x0, 0x3,\n  0xc20924dff0)\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/malloc.go:147 +0x1bb\n  fp=0xc209723928 sp=0xc209723878 runtime.rawstring(0x5, 0x0, 0x0, 0x0,\n  0x0, 0x0)\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/string.go:195 +0x93\n  fp=0xc209723958 sp=0xc209723928\n  runtime.slicebytetostring(0xc208275afc, 0x5, 0x49, 0x0, 0x0)\n    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/string.go:69 +0x4b\n  fp=0xc2097239e8 sp=0xc209723958\n  github.com/mongodb/mongo-tools/common/json.maybeUnquote(0xc208275afc,\n  0x5, 0x49, 0x0, 0x0, 0xc208106001)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/common/json/decode.go:1170\n  +0x88 fp=0xc209723a28 sp=0xc2097239e8 github.com/mongodb/mongo-tools/common/json.(*decodeState).objectInterface(0xc208625f00,\n  0xe)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/common/json/decode.go:1076\n  +0x14e fp=0xc209723ac0 sp=0xc209723a28 github.com/mongodb/mongo-tools/common/json.(*decodeState).valueInterface(0xc208625f00,\n  0x0, 0x0)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/common/json/decode.go:978\n  +0x84 fp=0xc209723b10 sp=0xc209723ac0 github.com/mongodb/mongo-tools/common/json.(*decodeState).bsonDInterface(0xc208625f00,\n  0x0, 0x0, 0x0)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/common/json/decode.go:1044\n  +0x25a fp=0xc209723bf0 sp=0xc209723b10 github.com/mongodb/mongo-tools/common/json.(*decodeState).bsonDocument(0xc208625f00,\n  0x0, 0x0, 0x0)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/common/json/decode.go:358\n  +0x65 fp=0xc209723c18 sp=0xc209723bf0 github.com/mongodb/mongo-tools/common/json.(*decodeState).unmarshalBsonD(0xc208625f00,\n  0x0, 0x0, 0x0, 0x0, 0x0)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/common/json/decode.go:190\n  +0x151 fp=0xc209723c70 sp=0xc209723c18 github.com/mongodb/mongo-tools/common/json.UnmarshalBsonD(0xc208275900,\n  0x245, 0x245, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/common/json/decode.go:107\n  +0x173 fp=0xc209723ce0 sp=0xc209723c70 github.com/mongodb/mongo-tools/mongoimport.JSONConverter.Convert(0xc208275900,\n  0x245, 0x245, 0x604e, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/mongoimport/json.go:142\n  +0x7b fp=0xc209723dd8 sp=0xc209723ce0 github.com/mongodb/mongo-tools/mongoimport.(*JSONConverter).Convert(0xc208ac3b40,\n  0x0, 0x0, 0x0, 0x0, 0x0)  :8 +0xcd fp=0xc209723e28\n  sp=0xc209723dd8\n  github.com/mongodb/mongo-tools/mongoimport.(*importWorker).processDocuments(0xc2080ac040,\n  0xc2080ac000, 0x0, 0x0)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/mongoimport/common.go:380\n  +0x166 fp=0xc209723f68 sp=0xc209723e28 github.com/mongodb/mongo-tools/mongoimport.func\u00b7002(0xc208086120,\n  0xc2080c6060, 0xc2080d85a0)\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/mongoimport/common.go:268\n  +0xa7 fp=0xc209723fc8 sp=0xc209723f68 runtime.goexit()    /usr/local/Cellar/go/1.4.2/libexec/src/runtime/asm_amd64.s:2232 +0x1\n  fp=0xc209723fd0 sp=0xc209723fc8 created by\n  github.com/mongodb/mongo-tools/mongoimport.streamDocuments\n    /private/tmp/mongodb20150321-60760-11xdj8i/mongodb-src-r3.0.1/src/github.com/mongodb/mongo-tools/.gopath/src/github.com/mongodb/mongo-tools/mongoimport/common.go:275\n  +0x490</p>\n</blockquote>\n\n<p>Plus some additional output...\nI've been searching all day and found that this error is not new in Sierra and is related to the Go language. Something about 1.4 version not being supported or not supporting Sierra. \nI've installed Go 1.7 and tested it, but to no avail. Same error in random places during the mongoimport.\nAny help would be appreciated!!</p>\n"}, {"tags": ["inheritance", "go", "polymorphism"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484345524, "post_id": 41643909, "comment_id": 70488315, "body": "This still sounds like you&#39;re trying to something like inheritance, which isn&#39;t going to work well in Go. Do you have a concrete problem you&#39;re trying to solve?"}, {"owner": {"reputation": 964, "user_id": 74012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/40a9bad4dee523ee7b0339d18fc8a830?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/74012/patrick"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484346060, "post_id": 41643909, "comment_id": 70488513, "body": "Yes, it surrounds users that have different attributes depending on the type of user, and I&#39;m trying to stay away from inheritance to do it in idiomatic go."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1484346618, "post_id": 41643909, "comment_id": 70488704, "body": "Often when shifting away from inheritance-based OOP, you can &quot;invert&quot; the logic. Rather than users being of different &quot;types&quot;, have a User type with attributes that differentiate them. You can also base <i>everything</i> on behavior, and simply define methods that return the fields you&#39;re interested in and use the method sets to define interfaces. It&#39;s hard to say with contrived examples which best fits the problem you&#39;re working on."}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594374543, "post_id": 41643909, "comment_id": 111109984, "body": "How to use an interface? Decouple code. See <a href=\"https://stackoverflow.com/a/62297796/12817546\">stackoverflow.com/a/62297796/12817546</a>. Call a method \u201cdynamically\u201d. See <a href=\"https://stackoverflow.com/a/62336440/12817546\">stackoverflow.com/a/62336440/12817546</a>. Access a Go package. See <a href=\"https://stackoverflow.com/a/62278078/12817546\">stackoverflow.com/a/62278078/12817546</a>. Assign any value to a variable. See <a href=\"https://stackoverflow.com/a/62337836/12817546\">stackoverflow.com/a/62337836/12817546</a>."}], "answers": [{"comments": [{"owner": {"reputation": 964, "user_id": 74012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/40a9bad4dee523ee7b0339d18fc8a830?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/74012/patrick"}, "edited": false, "score": 2, "creation_date": 1484404768, "post_id": 41645017, "comment_id": 70501007, "body": "I&#39;ve kept away from defining getters and setters in my go programming, because it didn&#39;t feel correct from an idiomatic standpoint, but perhaps it is the only way out anyway?"}, {"owner": {"reputation": 1924, "user_id": 1420080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/BEP3m.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1420080/michael"}, "edited": false, "score": 1, "creation_date": 1484410068, "post_id": 41645017, "comment_id": 70502699, "body": "If it is just for the sake of accessing, why don&#39;t expose the vars writing them capital?"}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 964, "user_id": 74012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/40a9bad4dee523ee7b0339d18fc8a830?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/74012/patrick"}, "edited": false, "score": 1, "creation_date": 1484446463, "post_id": 41645017, "comment_id": 70512978, "body": "@Patrick Have you checked the output from &quot;Printout 2&quot;? And compared it to &quot;Printout 1&quot;? I only used getters  and setters in the example as nothing more useful suggested in the code. The code is actually illustrating how to simulate inheritance and polymorphism from OOP. You obviously don&#39;t need an interface to simply access structure fields. See &quot;Printout 1&quot; for that."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "reply_to_user": {"reputation": 964, "user_id": 74012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/40a9bad4dee523ee7b0339d18fc8a830?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/74012/patrick"}, "edited": false, "score": 1, "creation_date": 1484447886, "post_id": 41645017, "comment_id": 70513178, "body": "@Patrick Just look at getName() again and how it produces different output in Printout 2 depending on actual type of the object, even though they all are supposedly &quot;downcasted&quot; to StoreInterface. Ignore the method name - it&#39;s irrelevant for the concept illustrated."}, {"owner": {"reputation": 964, "user_id": 74012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/40a9bad4dee523ee7b0339d18fc8a830?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/74012/patrick"}, "edited": false, "score": 0, "creation_date": 1484523123, "post_id": 41645017, "comment_id": 70533145, "body": "Thanks for all the input. I ended up implementing it in a very similar fashion."}], "tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": true, "score": 4, "last_activity_date": 1484350027, "creation_date": 1484350027, "answer_id": 41645017, "question_id": 41643909, "link": "https://stackoverflow.com/questions/41643909/how-to-think-when-defining-interfaces-in-golang/41645017#41645017", "title": "How to think when defining interfaces in golang?", "body": "<p>I think below is what you're after. Sorry for ugly names, but I had to make them standout to make a point. And keep in mind there are no virtual functions in go, even though example below sort of simulates one.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n\ntype StoreInterface interface {\n    getName() string\n    setName(string)\n    getPhone() string\n    setPhone(string)\n}\n\ntype Store struct {\n   name  string\n   phone string\n}\n\nfunc (store *Store) getName() string {\n   return store.name;\n}\n\nfunc (store *Store) setName(newName string){\n   store.name = newName;\n}\n\nfunc (store *Store) getPhone() string {\n   return store.phone;\n}\n\nfunc (store *Store) setPhone(newPhone string){\n   store.phone = newPhone;\n}\n\ntype HardwareStore struct{ Store }\n\ntype FoodStore struct{ Store }\n\ntype OnlineStore struct {\n    Store\n    url string\n}\n\nfunc (os *OnlineStore) getName() string{\n    return fmt.Sprintf(\"%v(%v)\", os.name, os.url)\n}\n\nfunc main() {\n    s := Store{name:\"s\", phone:\"111\"}\n    h := HardwareStore{Store{name:\"h\", phone:\"222\"}}\n    f := FoodStore{Store{name:\"f\", phone:\"333\"}}\n    o := OnlineStore{Store:Store{name:\"o\", phone:\"444\"}, url:\"http://test.com\"}\n\n    fmt.Println (\"Printout 1\")\n    stores := []*Store{&amp;s, &amp;h.Store, &amp;f.Store, &amp;o.Store}\n    for _, s := range stores {\n        fmt.Printf(\"\\t%v: %v\\n\", s.name, s.phone);\n    }\n\n    fmt.Println (\"Printout 2\")\n    stores2 := []StoreInterface{&amp;s, &amp;h, &amp;f, &amp;o}\n    for _, s := range stores2 {\n        fmt.Printf(\"\\t%v: %v\\n\", s.getName(), s.getPhone());\n    }\n }\n</code></pre>\n\n<p>Still, it goes without saying that you need to change your mindset from inheritance to functions, data structures and behavior. It's hard to break old habits (I come from many years of OOP too). But when in Rome you should think like Romans do :o) Otherwise you gonna be missing on some potential of the language. </p>\n"}], "owner": {"reputation": 964, "user_id": 74012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/40a9bad4dee523ee7b0339d18fc8a830?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/74012/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 3, "accepted_answer_id": 41645017, "answer_count": 1, "score": 2, "last_activity_date": 1484357438, "creation_date": 1484343901, "question_id": 41643909, "link": "https://stackoverflow.com/questions/41643909/how-to-think-when-defining-interfaces-in-golang", "title": "How to think when defining interfaces in golang?", "body": "<p>I've noticed how hard it is to let go of the OOP style programming I've used in Java and PHP over the last 10 years or so. I'm giving golang a go (pun intended) since a few weeks, but I'm trying to feel natural around the composition over inheritance principle golang has.</p>\n\n<p>How would I define a useful interface to make sure all these structs can fulfill it? I've tried to come up with a useful example that does not involve dogs, humans or weird constructs of vehicles...</p>\n\n<pre><code>package main\n\ntype Store struct {\n  name  string\n  phone string\n}\n\ntype HardwareStore struct{ Store }\n\ntype FoodStore struct{ Store }\n\ntype OnlineStore struct {\n  Store\n  url string\n}\n</code></pre>\n\n<p>I think it might be because I base my thinking around their state/data and not their behaviour, I'm struggling a bit.</p>\n\n<p>The obvious first choice, without an interface, would probably be this (simplified), which of course fails:</p>\n\n<pre><code>s := Store{}\nh := HardwareStore{}\nf := FoodStore{}\no := OnlineStore{}\n\nstores := []Store{s, h, f, o}\n</code></pre>\n"}, {"tags": ["go", "govendor"], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1484340979, "creation_date": 1484340979, "question_id": 41643305, "link": "https://stackoverflow.com/questions/41643305/handle-nested-vendor-directories-in-govendor", "title": "Handle nested &quot;vendor&quot; directories in govendor", "body": "<p>I'm writing an application that import some package <code>B</code> from a private bitbucket repo. So I have copied <code>B</code> into my <code>vendor</code> directory. <code>B</code> package has the <code>vendor</code> directory inside which, in turn, contains package <code>C</code>. I also want to use that package <code>C</code> in my app directly.</p>\n\n<p>This is causing my app to have nested <code>vendor</code> directories and making my build fail with two versions of <code>C</code> package.  Can someone let me know how <code>govendor</code> can be used to avoid this?</p>\n\n<p>Versions</p>\n\n<ul>\n<li>Govendor - 1.0.8 </li>\n<li>Go - 1.7.3</li>\n</ul>\n"}, {"tags": ["go", "rethinkdb"], "answers": [{"tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": true, "score": 1, "last_activity_date": 1484632020, "last_edit_date": 1484632020, "creation_date": 1484351295, "answer_id": 41645183, "question_id": 41641501, "link": "https://stackoverflow.com/questions/41641501/filter-by-fields-content-contains-string/41645183#41645183", "title": "Filter by field&#39;s content contains string", "body": "<p>I simplified your problem a bit by dumping the data into a map and then did a simple regexp match which works well.</p>\n\n<p>package main</p>\n\n<pre><code>import (\n  \"fmt\"\n  \"regexp\"\n)\n\n\nfunc main() {\n  data := map[string]string{\n    \"548272c9-6615-4e93-aa15-9af0a830c9a2\": \"universite paris sorbonne\",\n    \"943234f3-6615-4e93-aa15-9af0a830c9a2\": \"universite paris dauphine\",\n    \"24f477f3-6615-4e93-aa15-9af0a830c9a2\": \"universite sorbonne nouvelle\",\n  }\n\n  var matches = make([]string, 0)\n  for _, value := range data {\n    matched, err := regexp.MatchString(\".*paris dau.*\", value)\n    if err == nil &amp;&amp; matched {\n      matches = append(matches, value)\n    }\n  }\n\n  fmt.Printf(\"Matches: %v\\n\", matches)\n}\n</code></pre>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 41645183, "answer_count": 1, "score": -2, "last_activity_date": 1484632020, "creation_date": 1484333418, "last_edit_date": 1484631948, "question_id": 41641501, "link": "https://stackoverflow.com/questions/41641501/filter-by-fields-content-contains-string", "title": "Filter by field&#39;s content contains string", "body": "<p>I've some object : </p>\n\n<pre><code>{\n    \"name\":  \"universite paris sorbonne\" ,\n    \"id\":  \"548272c9-6615-4e93-aa15-9af0a830c9a2\"\n}\n{\n    \"name\":  \"universite paris dauphine\" ,\n    \"id\":  \"943234f3-6615-4e93-aa15-9af0a830c9a2\"\n}\n{\n    \"name\":  \"universite sorbonne nouvelle\" ,\n    \"id\":  \"24f477f3-6615-4e93-aa15-9af0a830c9a2\"\n}\n</code></pre>\n\n<p>How can i do if i would like select each object which contain <code>paris dau</code> in their name ?</p>\n\n<p>I've tried with that, but it doesn't work.</p>\n\n<pre><code>    curs, _ = r.Table(\"places\").\n    Filter(func(customer r.Term) interface{}{\n        return customer.Field('name').Downcase().Contains(func (custo r.Term) interface{}{\n            return custo.Match(\".\\\\*\" + strings.ToLower('paris dau') + \".\\\\*\")\n        })\n</code></pre>\n\n<p>any suggest ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1484333252, "post_id": 41641418, "comment_id": 70482767, "body": "What do you want to do? You can define any of those very easily."}, {"owner": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "edited": false, "score": 0, "creation_date": 1484333417, "post_id": 41641418, "comment_id": 70482835, "body": "You can the answers here: 1. <a href=\"http://stackoverflow.com/questions/21950244/is-there-a-way-to-iterate-over-a-range-of-integers-in-golang\" title=\"is there a way to iterate over a range of integers in golang\">stackoverflow.com/questions/21950244/&hellip;</a> 2. <a href=\"http://stackoverflow.com/questions/17575840/better-way-to-generate-array-of-all-letters-in-the-alphabet\" title=\"better way to generate array of all letters in the alphabet\">stackoverflow.com/questions/17575840/&hellip;</a>"}, {"owner": {"reputation": 5917, "user_id": 4440675, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/q44sl.jpg?s=128&g=1", "display_name": "Amit Tripathi", "link": "https://stackoverflow.com/users/4440675/amit-tripathi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484333432, "post_id": 41641418, "comment_id": 70482841, "body": "@JimB Writing an application that involves base62 encoding.  Yes, I can but I believe this should be included in language. I don&#39;t want to define every time I need those. Isn&#39;t its available in Go?"}, {"owner": {"reputation": 5917, "user_id": 4440675, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/q44sl.jpg?s=128&g=1", "display_name": "Amit Tripathi", "link": "https://stackoverflow.com/users/4440675/amit-tripathi"}, "reply_to_user": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "edited": false, "score": 0, "creation_date": 1484333657, "post_id": 41641418, "comment_id": 70482932, "body": "@LuizdePr&#225; I don&#39;t know how those questions are related to this. I don&#39;t want to iterate over a range. I want to get a list of numbers/letters between a range in Go."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1484333767, "post_id": 41641418, "comment_id": 70482972, "body": "I don&#39;t think anyone considers these things as critical as you do. <a href=\"https://play.golang.org/p/ruV_CjSK5r\" rel=\"nofollow noreferrer\">play.golang.org/p/ruV_CjSK5r</a>. I think the problem may lie more in trying to write python in Go, rather than getting the values you need. Having a slice of ints or a string of ascii letters wouldn&#39;t necessarily be used in Go like you use it in python."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1484333994, "post_id": 41641418, "comment_id": 70483065, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/35704948/generate-array-with-with-range-of-integers/35705756#35705756\">Generate array with with range of integers</a>."}, {"owner": {"reputation": 5917, "user_id": 4440675, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/q44sl.jpg?s=128&g=1", "display_name": "Amit Tripathi", "link": "https://stackoverflow.com/users/4440675/amit-tripathi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1484334135, "post_id": 41641418, "comment_id": 70483140, "body": "@JimB I am used to convenient way of doing things in Python maybe thats why even after trying to search on Google and failing to find, I was not ready to accept that a modern language would not have this &quot;essential&quot; feature. So, I asked here.  I think I need to switch to Go way of doing things. Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 2707807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8CyS.jpg?s=128&g=1", "display_name": "wgoudsbloem", "link": "https://stackoverflow.com/users/2707807/wgoudsbloem"}, "is_accepted": false, "score": 2, "last_activity_date": 1484361251, "creation_date": 1484361251, "answer_id": 41646241, "question_id": 41641418, "link": "https://stackoverflow.com/questions/41641418/go-get-all-the-numbers-letters-range-between-two-limits/41646241#41646241", "title": "Go: Get all the numbers/letters range between two limits", "body": "<p>Go doesn't provide a lot of syntactic sugar. You just have to write what those Python and Scala functions do for you.</p>\n\n<pre><code>for i := 1; i &lt;= 10; i++ {\n    fmt.Print(i)\n}\nfor i := 'A'; i &lt;= 'Z'; i++ {\n    fmt.Printf(\"%c\", i)\n}\nfor i := 'a'; i &lt;= 'z'; i++ {\n    fmt.Printf(\"%c\", i)\n}\n</code></pre>\n\n<p>12345678910ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</p>\n\n<p><a href=\"https://play.golang.org/p/SU0uFVIg0k\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SU0uFVIg0k</a></p>\n"}], "owner": {"reputation": 5917, "user_id": 4440675, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/q44sl.jpg?s=128&g=1", "display_name": "Amit Tripathi", "link": "https://stackoverflow.com/users/4440675/amit-tripathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484361251, "creation_date": 1484333085, "question_id": 41641418, "link": "https://stackoverflow.com/questions/41641418/go-get-all-the-numbers-letters-range-between-two-limits", "title": "Go: Get all the numbers/letters range between two limits", "body": "<p>I am new to Go. I have 2 questions:</p>\n\n<ol>\n<li><p>Is there a way to get all the numbers between a range in Go? I can do <code>range(1, 10)</code> in Python or <code>1 to 10</code> in Scala to get a range.</p></li>\n<li><p>How to get all the alphabets  in go? Like Python's <code>string.letters</code> and <code>string.ascii_lower</code>.</p></li>\n</ol>\n"}, {"tags": ["string", "go", "type-conversion"], "comments": [{"owner": {"reputation": 1256, "user_id": 1946396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd8fc3b20061700ebd6eac590a0494c1?s=128&d=identicon&r=PG", "display_name": "shieldstroy", "link": "https://stackoverflow.com/users/1946396/shieldstroy"}, "edited": false, "score": 0, "creation_date": 1484330081, "post_id": 41640603, "comment_id": 70481096, "body": "Can you also post the exact lines that are giving you issues in addition to your snippet. The lines don&#39;t match up so it&#39;s hard to know where the issue is."}, {"owner": {"reputation": 1256, "user_id": 1946396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd8fc3b20061700ebd6eac590a0494c1?s=128&d=identicon&r=PG", "display_name": "shieldstroy", "link": "https://stackoverflow.com/users/1946396/shieldstroy"}, "edited": false, "score": 0, "creation_date": 1484330129, "post_id": 41640603, "comment_id": 70481136, "body": "Also add the models.User struct definition to your snippet, might be helpful"}, {"owner": {"reputation": 182, "user_id": 1973789, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fccf0e6880b1d1bf4dfa8c12303956c?s=128&d=identicon&r=PG", "display_name": "itsbalamurali", "link": "https://stackoverflow.com/users/1973789/itsbalamurali"}, "reply_to_user": {"reputation": 1256, "user_id": 1946396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd8fc3b20061700ebd6eac590a0494c1?s=128&d=identicon&r=PG", "display_name": "shieldstroy", "link": "https://stackoverflow.com/users/1946396/shieldstroy"}, "edited": false, "score": 0, "creation_date": 1484330255, "post_id": 41640603, "comment_id": 70481210, "body": "@shieldstroy here you go <a href=\"https://gist.github.com/itsbalamurali/e46d10acdceda906925d0e4836e9023f\" rel=\"nofollow noreferrer\">gist.github.com/itsbalamurali/e46d10acdceda906925d0e4836e902&zwnj;&#8203;3f</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484330382, "post_id": 41640603, "comment_id": 70481284, "body": "You keep unnecessarily taking the address of things in that code. Hint, <code>&amp;user.Username</code> will never be <code>nil</code>."}, {"owner": {"reputation": 182, "user_id": 1973789, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fccf0e6880b1d1bf4dfa8c12303956c?s=128&d=identicon&r=PG", "display_name": "itsbalamurali", "link": "https://stackoverflow.com/users/1973789/itsbalamurali"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484330543, "post_id": 41640603, "comment_id": 70481388, "body": "@JimB very new to this pointers thingy &amp; go :)"}], "answers": [{"comments": [{"owner": {"reputation": 1256, "user_id": 1946396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd8fc3b20061700ebd6eac590a0494c1?s=128&d=identicon&r=PG", "display_name": "shieldstroy", "link": "https://stackoverflow.com/users/1946396/shieldstroy"}, "reply_to_user": {"reputation": 182, "user_id": 1973789, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fccf0e6880b1d1bf4dfa8c12303956c?s=128&d=identicon&r=PG", "display_name": "itsbalamurali", "link": "https://stackoverflow.com/users/1973789/itsbalamurali"}, "edited": false, "score": 3, "creation_date": 1484330747, "post_id": 41640766, "comment_id": 70481502, "body": "No problem. Good luck! In general you can not worry too much about pointers until the compiler tells you that you need to. That&#39;s not entirely true but you&#39;ll get the hang of it."}], "tags": [], "owner": {"reputation": 1256, "user_id": 1946396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd8fc3b20061700ebd6eac590a0494c1?s=128&d=identicon&r=PG", "display_name": "shieldstroy", "link": "https://stackoverflow.com/users/1946396/shieldstroy"}, "is_accepted": true, "score": 4, "last_activity_date": 1484330492, "creation_date": 1484330492, "answer_id": 41640766, "question_id": 41640603, "link": "https://stackoverflow.com/questions/41640603/golang-cannot-convert-type-string-to-type-string/41640766#41640766", "title": "Golang Cannot Convert (type *string) to type string", "body": "<p>The if on line 9 needs to change I think. <code>user.Username</code> and <code>user.Password</code> are strings so they will never be nil. What you need to check instead is for empty string like this: <code>if user.Username != \"\" &amp;&amp; user.Password != \"\" {</code></p>\n\n<p><code>pass := &amp;user.Password\npassword := []byte(*pass)</code></p>\n\n<p>Don't take the address of user.Password. Just use <code>password := []byte(user.Password)</code></p>\n\n<p>Basically all of your issues are variations on that theme.</p>\n\n<p>Start fixing this issue by removing all <code>&amp;</code> and <code>*</code> from your code and it will probably work (except for this one: <code>ctx.Get(\"database\").(*gorm.DB)</code>)</p>\n"}], "owner": {"reputation": 182, "user_id": 1973789, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fccf0e6880b1d1bf4dfa8c12303956c?s=128&d=identicon&r=PG", "display_name": "itsbalamurali", "link": "https://stackoverflow.com/users/1973789/itsbalamurali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9654, "favorite_count": 0, "accepted_answer_id": 41640766, "answer_count": 1, "score": 3, "last_activity_date": 1484330492, "creation_date": 1484329917, "question_id": 41640603, "link": "https://stackoverflow.com/questions/41640603/golang-cannot-convert-type-string-to-type-string", "title": "Golang Cannot Convert (type *string) to type string", "body": "<p>When I tried to compile the following code I get following errors:</p>\n\n<p><code>users.go:31: cannot convert pass (type *string) to type string</code></p>\n\n<p><code>users.go:78: cannot convert &amp;user.Password (type *string) to type []byte</code> </p>\n\n<p>How do I dereference or convert the pointer to the string literal?</p>\n\n<p>Thanks in advance.</p>\n\n<p>code which I am trying to compile: <a href=\"https://play.golang.org/p/gtMKLNAyNk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gtMKLNAyNk</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1484327988, "post_id": 41640018, "comment_id": 70479920, "body": "Thanks. I suspected it wouldn&#39;t so that is great. Would it be possible to Init the reader outside the for loop?"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1484328374, "post_id": 41640018, "comment_id": 70480143, "body": "Well, you could probably use the <code>gzip.Reader</code> directly on your connection reader. It makes sense since I imagine that your connection is yielding gziped data, but I never used these packages, so I can&#39;t guarantee that\u2026"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1484331680, "post_id": 41640018, "comment_id": 70482005, "body": "@LeeArmstrong: If you want to reuse the gzip.Reader, it has a Reset method specifically so you don&#39;t have to allocate a new one every loop.."}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1484331779, "post_id": 41640018, "comment_id": 70482062, "body": "@JimB Ah thanks, trouble I have though (I think) is that I feed it the packet buffer and that isn&#39;t there until later on?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1484332315, "post_id": 41640018, "comment_id": 70482323, "body": "@LeeArmstrong: I&#39;m not sure what you mean. You have the <code>[]byte</code> (the &quot;packet&quot;) at that point, and you&#39;re reading it all immediately. If each &quot;packet&quot; is an individual gzip stream, then <code>gzipReader.Reset(bytes.NewBuffer(packet))</code> would do the same with less allocation. This looks a little strange though, since you usually compress things at a lower level for greater efficiency."}, {"owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "edited": false, "score": 0, "creation_date": 1484333334, "post_id": 41640018, "comment_id": 70482808, "body": "Thanks, and yes I do want to keep allocations down.  I tried <a href=\"https://gist.github.com/leearmstrong/deb6b309f75827298da15a6322a31d66\" rel=\"nofollow noreferrer\">gist.github.com/leearmstrong/deb6b309f75827298da15a6322a31d6&zwnj;&#8203;6</a> but I get a crash sadly.  That is essentially what I think I want to achieve"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 3, "last_activity_date": 1484328182, "last_edit_date": 1484328182, "creation_date": 1484327775, "answer_id": 41640018, "question_id": 41639955, "link": "https://stackoverflow.com/questions/41639955/leaking-reader-with-tight-loop/41640018#41640018", "title": "Leaking Reader with tight loop", "body": "<p>Your problem is that <code>defer</code> functions are only called at the end of the function. Not the loop. So, yes, it is probable that they stay open.</p>\n\n<p>One method would be to encapsulate your tight-loop into a function. </p>\n\n<pre><code>func uncompress(packet []byte) ([]byte, error) {\n    r, _ := gzip.NewReader(bytes.NewBuffer(packet))\n    defer r.Close()\n    return ioutil.ReadAll(r)\n}\n\n// Read client data from channel\nfunc (c *Client) listen() {\n    /* \u2026 */\n\n    for {\n        /* \u2026 */\n\n        if packet != nil {\n            b, err := uncompress(packet)\n            if err != nil {\n                log.Fatal(err)\n            }\n            c.server.onNewMessage(c, b)\n        }\n\n    }\n}\n</code></pre>\n\n<p>Another would be to unroll the defer call and do it manually.</p>\n\n<pre><code>// Read client data from channel\nfunc (c *Client) listen() {\n    /* \u2026 */\n\n    for {\n        /* \u2026 */\n\n        if packet != nil {\n            r, _ := gzip.NewReader(bytes.NewBuffer(packet))\n            b, err := ioutil.ReadAll(r)\n            if err != nil {\n                log.Fatal(err)\n            }\n            r.Close()\n            c.server.onNewMessage(c, b)\n        }\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11213, "user_id": 103999, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/231742e13810156987b1e462314f8eb9?s=128&d=identicon&r=PG", "display_name": "Lee Armstrong", "link": "https://stackoverflow.com/users/103999/lee-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 41640018, "answer_count": 1, "score": 0, "last_activity_date": 1484328182, "creation_date": 1484327516, "question_id": 41639955, "link": "https://stackoverflow.com/questions/41639955/leaking-reader-with-tight-loop", "title": "Leaking Reader with tight loop", "body": "<p>I have the following code that I think is leaking heavily.  And analysing it I suspect that the <code>defer r.Close()</code> is never called.  </p>\n\n<p>Would there be a better way of using the Reader and gzip here at all?</p>\n\n<pre><code>// Read client data from channel\nfunc (c *Client) listen() {\n    timeoutDuration := 30 * time.Second\n\n    reader := bufio.NewReader(c.conn)\n\n    clientBuffer := new(bytes.Buffer)\n\n    for {\n        c.conn.SetReadDeadline(time.Now().Add(timeoutDuration))\n\n        byte, err := reader.ReadByte()\n\n        if err != nil {\n            c.conn.Close()\n            c.server.onClientConnectionClosed(c, err)\n            return\n        }\n\n        clientBuffer.WriteByte(byte)\n        packet := popPacketFromBuffer(clientBuffer)\n\n        if packet != nil {\n            packetBuffer := bytes.NewBuffer(packet)\n\n            r, _ := gzip.NewReader(packetBuffer)\n            defer r.Close()\n\n            b, err := ioutil.ReadAll(r)\n            if err != nil {\n                log.Fatal(err)\n            }\n\n            c.server.onNewMessage(c, b)\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["curl", "go", "gorequest"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1484323690, "last_edit_date": 1484323690, "creation_date": 1484321993, "answer_id": 41638227, "question_id": 41638076, "link": "https://stackoverflow.com/questions/41638076/post-with-go-fails-but-works-with-curl/41638227#41638227", "title": "POST with Go fails but works with curl", "body": "<p>You're sending a json body with your Go code, but an <code>application/x-www-form-urlencoded</code> body with curl.</p>\n\n<p>You can encode the string manually as you've done with curl:</p>\n\n<pre><code>Body:      \"password=acwr6414&amp;user=john\",\n</code></pre>\n\n<p>Or you can use a <code>url.Values</code> to properly encode the body:</p>\n\n<pre><code>creds := url.Values{}\ncreds.Set(\"user\", \"john\")\ncreds.Set(\"password\", \"acwr6414\")\n\nres, err := goreq.Request{\n    ContentType: \"application/x-www-form-urlencoded\",\n    Method:      \"POST\",\n    Uri:         \"http://127.0.0.1:5000/api/login\",\n    Body:        creds.Encode(),\n    ShowDebug:   true,\n}.Do()\n</code></pre>\n"}], "owner": {"reputation": 8438, "user_id": 3176550, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/m6HBi.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/3176550/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "accepted_answer_id": 41638227, "answer_count": 1, "score": 1, "last_activity_date": 1484323690, "creation_date": 1484321492, "question_id": 41638076, "link": "https://stackoverflow.com/questions/41638076/post-with-go-fails-but-works-with-curl", "title": "POST with Go fails but works with curl", "body": "<p>I've tested the following curl command against my app, and it returns successfully:</p>\n\n<pre><code>curl --data \"username=john&amp;password=acwr6414\" http://127.0.0.1:5000/api/login\n</code></pre>\n\n<p>However trying to replicate the above in go has proven quite a challenge, I keep getting a 400 Bad Request error from the server, here's the code:</p>\n\n<pre><code>    type Creds struct {\n        Username string `json:\"username\"`\n        Password string `json:\"password\"`\n    }\n\nuser := \"john\"\npass := \"acwr6414\"\n\n    creds := Creds{Username: user, Password: pass}\n    res, err := goreq.Request{\n        Method:    \"POST\",\n        Uri:       \"http://127.0.0.1:5000/api/login\",\n        Body:      creds,\n        ShowDebug: true,\n    }.Do()\n    fmt.Println(res.Body.ToString())\n    fmt.Println(res, err)\n</code></pre>\n\n<p>I'm using the goreq package, I've tried at least 3 or 4 other packages with no difference. The error I get is:</p>\n\n<pre><code>&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\"&gt;\n&lt;title&gt;400 Bad Request&lt;/title&gt;\n&lt;h1&gt;Bad Request&lt;/h1&gt;\n&lt;p&gt;The browser (or proxy) sent a request that this server could not understand.&lt;/p&gt;\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3006, "user_id": 920130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eF81F.jpg?s=128&g=1", "display_name": "Mathias Dolidon", "link": "https://stackoverflow.com/users/920130/mathias-dolidon"}, "edited": false, "score": 0, "creation_date": 1484308924, "post_id": 41634125, "comment_id": 70467966, "body": "<code>rand.Seed</code> does not return anything. It only initializes the default pseudo random numbers generator. Using this seed, you&#39;ll simply call <code>rand.Intn</code>, not <code>r.Intn</code>"}, {"owner": {"reputation": 1773, "user_id": 1887860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vTWIU.png?s=128&g=1", "display_name": "Matei Radu", "link": "https://stackoverflow.com/users/1887860/matei-radu"}, "edited": false, "score": 0, "creation_date": 1484314554, "post_id": 41634125, "comment_id": 70471298, "body": "I believe that <code>r := rand.Intn(999)</code> after initializing with <code>rand.Seed(time.Now().UnixNano())</code> should do the trick."}, {"owner": {"reputation": 3006, "user_id": 920130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eF81F.jpg?s=128&g=1", "display_name": "Mathias Dolidon", "link": "https://stackoverflow.com/users/920130/mathias-dolidon"}, "edited": false, "score": 0, "creation_date": 1484316119, "post_id": 41634125, "comment_id": 70472258, "body": "Matei, no. The doc is both very simple and pretty clear ! Either you use the global generator, or you initialize a named generator."}], "answers": [{"tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": false, "score": 2, "last_activity_date": 1484308938, "creation_date": 1484308938, "answer_id": 41634222, "question_id": 41634125, "link": "https://stackoverflow.com/questions/41634125/why-the-following-golang-code-doesnt-run/41634222#41634222", "title": "Why the following Golang code doesn&#39;t run?", "body": "<p><code>rand.Seed</code> doesn't return any value, its a void function.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7252865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc4e210b19e76ae642fa5836b51508e?s=128&d=identicon&r=PG", "display_name": "Bulat Zamalutdinov", "link": "https://stackoverflow.com/users/7252865/bulat-zamalutdinov"}, "is_accepted": false, "score": 1, "last_activity_date": 1484314181, "creation_date": 1484314181, "answer_id": 41635756, "question_id": 41634125, "link": "https://stackoverflow.com/questions/41634125/why-the-following-golang-code-doesnt-run/41635756#41635756", "title": "Why the following Golang code doesn&#39;t run?", "body": "<p>From godoc</p>\n\n<blockquote>\n  <p>Seed uses the provided seed value to initialize the generator to a\n  deterministic state. Seed should not be called concurrently with any\n  other Rand method.</p>\n</blockquote>\n\n<p>That means, that it set some seed for generating random numbers and don't return anything, but you tried to use it as some value</p>\n"}, {"tags": [], "owner": {"reputation": 1316, "user_id": 5310423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JN8B6.png?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5310423/marco"}, "is_accepted": false, "score": 0, "last_activity_date": 1484321033, "creation_date": 1484321033, "answer_id": 41637929, "question_id": 41634125, "link": "https://stackoverflow.com/questions/41634125/why-the-following-golang-code-doesnt-run/41637929#41637929", "title": "Why the following Golang code doesn&#39;t run?", "body": "<p><code>rand.Seed</code> \u201csets up\u201d <code>rand.Intn</code>, if you will. When you call <code>rand.Seed</code>, it creates a seed that can be used <em>later</em> with <code>rand.Intn</code>. <code>rand.Intn</code> returns a value, so</p>\n\n<pre><code>rand.Seed(time.Now().UnixNano())\nfmt.Println(rand.Intn(999))\n</code></pre>\n\n<p>works. But since <code>rand.Seed</code> does <em>not</em> return a value, calling <code>rand.Intn</code> on it returns an error.</p>\n"}], "owner": {"reputation": 417, "user_id": 7293425, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DFFOL.jpg?s=128&g=1", "display_name": "Indu Pillai", "link": "https://stackoverflow.com/users/7293425/indu-pillai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1484322592, "creation_date": 1484308586, "last_edit_date": 1484322592, "question_id": 41634125, "link": "https://stackoverflow.com/questions/41634125/why-the-following-golang-code-doesnt-run", "title": "Why the following Golang code doesn&#39;t run?", "body": "<p>This code runs and gives a random number from 0 to 999:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    fmt.Println(rand.Intn(999))\n}\n</code></pre>\n\n<p>But the following code refuses to run and gives an error</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc main() {\n    r := rand.Seed(time.Now().UnixNano())\n    fmt.Println(r.Intn(999))\n}\n</code></pre>\n\n<p><strong>Error message:</strong></p>\n\n<blockquote>\n  <p>rand.Seed(time.Now().UnixNano()) used as value</p>\n</blockquote>\n\n<p>Note: I'm new to stackOverflow, so if the question isn't according to the rules or standards, please forgive me.</p>\n"}, {"tags": ["json", "go", "marshalling", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 1, "last_activity_date": 1484327377, "creation_date": 1484327377, "answer_id": 41639920, "question_id": 41632922, "link": "https://stackoverflow.com/questions/41632922/easyjson-unmarshal-array-into-go-struct/41639920#41639920", "title": "easyjson unmarshal array into go struct", "body": "<p>What about </p>\n\n<pre><code>//easyjson:json\ntype ItemSlice []Item\n</code></pre>\n\n<p>?</p>\n\n<p>Then, you can do</p>\n\n<pre><code>func ConvertJsonToItem(jsondata string) ItemSlice {\n    var items ItemSlice\n    lexer := jlexer.Lexer{Data: []byte(jsondata)}\n\n    items.UnmarshalEasyJSON(&amp;lexer)\n    if lexer.Error() != nil {\n        panic(lexer.Error())\n    }\n    return items\n}\n</code></pre>\n\n<p>And if you really don't want an <code>ItemSlice</code> in your outer code, you can still convert it back to <code>[]Item</code> before returning it (but you'll have to do the exact same operation in the other way it you want to marshal it later\u2026).</p>\n"}], "owner": {"reputation": 3, "user_id": 7414202, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8kLsu.jpg?s=128&g=1", "display_name": "AndreasHerold", "link": "https://stackoverflow.com/users/7414202/andreasherold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "accepted_answer_id": 41639920, "answer_count": 1, "score": 0, "last_activity_date": 1484327377, "creation_date": 1484304819, "last_edit_date": 1495542274, "question_id": 41632922, "link": "https://stackoverflow.com/questions/41632922/easyjson-unmarshal-array-into-go-struct", "title": "easyjson unmarshal array into go struct", "body": "<p>I started working with golang and easyjson recently. Now I have to unmarshal a json array into a struct to work with it.\nSo here's what I got.</p>\n\n<p>The incoming JSON-data looks like this</p>\n\n<pre><code>[\n    {\n        \"Item1\":true,\n        \"Item2\":\"hello\",\n        \"Item3\":{\n            \"A\": 1,\n        },\n    },\n    ...\n]\n</code></pre>\n\n<p>My struct:</p>\n\n<pre><code>package something\n\n//easyjson:json\ntype Item struct {\n    Item1 bool\n    Item2 string\n    Item3 SubItem\n}\n\n//easyjson:json\ntype SubItem struct {\n    A int      \n}\n</code></pre>\n\n<p>(I build the *_easyjson.go file)</p>\n\n<p>And here's how I would use easyjson:</p>\n\n<pre><code>func ConvertJsonToItem(jsondata string) Item {\n    var item Item\n    lexer := jlexer.Lexer{Data: []byte(jsondata)}\n\n    item.UnmarshalEasyJSON(&amp;lexer)\n    if lexer.Error() != nil {\n        panic(lexer.Error())\n    }\n    return Item\n}\n</code></pre>\n\n<p>That won't work, I know, because the json consists of an array of \"Item\"-structs. But writing something like</p>\n\n<pre><code>var items []Item\n</code></pre>\n\n<p>won't work either because I can't execute UnmarshalEasyJSON on a slice.\nI'm using easyjson because it's the fastet way to handle json data.</p>\n\n<p>So my question is: how can I handle the object array with easyjson.</p>\n\n<p>By the way, I know this question is similar to this one <a href=\"https://stackoverflow.com/questions/34225656/unmarshal-json-into-struct-cannot-unmarshal-array-into-go-value\">Unmarshal json into struct: cannot unmarshal array into Go value</a> but there the user uses the builtin json package and I have/want to use easyjson.\nThank you in advance.</p>\n"}, {"tags": ["go", "random", "concurrency", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4695298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfffb44bbbe44d9254ca278ba7193dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/4695298/karl"}, "edited": false, "score": 1, "creation_date": 1484309379, "post_id": 41632900, "comment_id": 70468232, "body": "Okay, that all makes a lot of sense. I was guessing it might have to do with the cost associated with using the channel (though I didn&#39;t think of it in terms of communications overhead in relation to the unit of work being done, but rather in terms of possible congestion of the channel or something like that). Many thanks for the clear and pedagogical walkthrough!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1484313246, "last_edit_date": 1484313246, "creation_date": 1484304709, "answer_id": 41632900, "question_id": 41632285, "link": "https://stackoverflow.com/questions/41632285/generating-random-numbers-concurrently-in-go/41632900#41632900", "title": "Generating random numbers concurrently in Go", "body": "<p>First let's correct and optimize some things in your code:</p>\n\n<p>Since Go 1.5, <code>GOMAXPROCS</code> defaults to the number of CPU cores available, so no need to set that (although it does no harm).</p>\n\n<p>Numbers to generate:</p>\n\n<pre><code>var numIntsToGenerate = 100000000\nvar numIntsPerThread = numIntsToGenerate / numThreads\n</code></pre>\n\n<p>If <code>numThreads</code> is like 3, in case of multi goroutines, you'll have less numbers generated (due to integer division), so let's correct it:</p>\n\n<pre><code>numIntsToGenerate = numIntsPerThread * numThreads\n</code></pre>\n\n<p>No need a buffer for 100 million values, reduce that to a sensible value (e.g. 1000):</p>\n\n<pre><code>ch := make(chan int, 1000)\n</code></pre>\n\n<p>If you want to use <code>append()</code>, the slices you create should have 0 length (and proper capacity):</p>\n\n<pre><code>singleThreadIntSlice := make([]int, 0, numIntsToGenerate)\nmultiThreadIntSlice := make([]int, 0, numIntsToGenerate)\n</code></pre>\n\n<p>But in your case that's unnecessary, as only 1 goroutine is collecting the results, you can simply use indexing, and create slices like this:</p>\n\n<pre><code>singleThreadIntSlice := make([]int, numIntsToGenerate)\nmultiThreadIntSlice := make([]int, numIntsToGenerate)\n</code></pre>\n\n<p>And when collecting results:</p>\n\n<pre><code>for i := 0; i &lt; numIntsToGenerate; i++ {\n    singleThreadIntSlice[i] = &lt;-ch\n}\n\n// ...\n\nfor i := 0; i &lt; numIntsToGenerate; i++ {\n    multiThreadIntSlice[i] = &lt;-ch\n}\n</code></pre>\n\n<p>Ok. Code is now better. Attempting to run it, you will still experience that the multi-goroutine version runs slower. Why is that?</p>\n\n<p>It's because controlling, synchronizing and collecting results from multiple goroutines does have overhead. If the task they perform is little, the communication overhead will be greater and overall you lose performance.</p>\n\n<p>Your case is such a case. Generating a single random number once you set up your <code>rand.Rand()</code> is pretty fast.</p>\n\n<p>Let's modify your \"task\" to be big enough so that we can see the benefit of multiple goroutines:</p>\n\n<pre><code>// 1 million is enough now:\nvar numIntsToGenerate = 1000 * 1000\n\n\nfunc makeRandomNumbers(numInts int, ch chan int) {\n    source := rand.NewSource(time.Now().UnixNano())\n    generator := rand.New(source)\n    for i := 0; i &lt; numInts; i++ {\n        // Kill time, do some processing:\n        for j := 0; j &lt; 1000; j++ {\n            generator.Intn(numInts * 100)\n        }\n        // and now return a single random number\n        ch &lt;- generator.Intn(numInts * 100)\n    }\n}\n</code></pre>\n\n<p>In this case to get a random number, we generate 1000 random numbers and just throw them away (to make some calculation / kill time) before we generate the one we return. We do this so that the calculation time of the worker goroutines <em>outweights</em> the communication overhead of multiple goroutines.</p>\n\n<p>Running the app now, my results on a 4-core machine:</p>\n\n<pre><code>Initiating single-threaded random number generation.\nSingle-threaded run took 2.440604504s\nInitiating multi-threaded random number generation.\nMulti-threaded run took 987.946758ms\n</code></pre>\n\n<p>The multi-goroutine version runs <strong>2.5 times</strong> faster. This means if your goroutines would deliver random numbers in 1000-blocks, you would see 2.5 times faster execution (compared to the single goroutine generation).</p>\n\n<p><strong>One last note:</strong></p>\n\n<p>Your single-goroutine version also uses multiple goroutines: 1 to generate numbers and 1 to collect the results. Most likely the collector does not fully utilize a CPU core and mostly just waits for the results, but still: 2 CPU cores are used. Let's estimate that \"1.5\" CPU cores are utilized. While the multi-goroutine version utilizes 4 CPU cores. Just as a rough estimation: 4 / 1.5 = 2.66, very close to our performance gain.</p>\n"}, {"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1484308489, "post_id": 41633691, "comment_id": 70467676, "body": "I&#39;d replace &quot;multidimensional slice&quot; with &quot;slice of slices&quot;: Go does not have multi-dimensional slices, so let&#39;s not pretend they exist ;-)"}], "tags": [], "owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "is_accepted": false, "score": 1, "last_activity_date": 1484308665, "last_edit_date": 1484308665, "creation_date": 1484307108, "answer_id": 41633691, "question_id": 41632285, "link": "https://stackoverflow.com/questions/41632285/generating-random-numbers-concurrently-in-go/41633691#41633691", "title": "Generating random numbers concurrently in Go", "body": "<p>If you really want to generate the random numbers in parallel then each task should be about generate the numbers and then return them in one go rather than the task being generate one number at a time and feed them to a channel as that reading and writing to channel will slow things down in multi go routine case. Below is the modified code where then task generate the required numbers in one go and this performs better in multi go routines case, also I have used slice of slices to collect the result from multi go routines.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport \"math/rand\"\nimport \"runtime\"\n\nfunc main() {\n    // Figure out how many CPUs are available and tell Go to use all of them\n    numThreads := runtime.NumCPU()\n    runtime.GOMAXPROCS(numThreads)\n\n    // Number of random ints to generate\n    var numIntsToGenerate = 100000000\n    // Number of ints to be generated by each spawned goroutine thread\n    var numIntsPerThread = numIntsToGenerate / numThreads\n\n    // Channel for communicating from goroutines back to main function\n    ch := make(chan []int)\n\n    fmt.Printf(\"Initiating single-threaded random number generation.\\n\")\n    startSingleRun := time.Now()\n    // Generate all of the ints from a single goroutine, retrieve the expected\n    // number of ints from the channel and put in target slice\n    go makeRandomNumbers(numIntsToGenerate, ch)\n    singleThreadIntSlice := &lt;-ch\n    elapsedSingleRun := time.Since(startSingleRun)\n    fmt.Printf(\"Single-threaded run took %s\\n\", elapsedSingleRun)\n\n    fmt.Printf(\"Initiating multi-threaded random number generation.\\n\")\n\n    multiThreadIntSlice := make([][]int, numThreads)\n    startMultiRun := time.Now()\n    // Run the designated number of goroutines, each of which generates its\n    // expected share of the total random ints, retrieve the expected number\n    // of ints from the channel and put in target slice\n    for i := 0; i &lt; numThreads; i++ {\n        go makeRandomNumbers(numIntsPerThread, ch)\n    }\n    for i := 0; i &lt; numThreads; i++ {\n        multiThreadIntSlice[i] = &lt;-ch\n    }\n    elapsedMultiRun := time.Since(startMultiRun)\n    fmt.Printf(\"Multi-threaded run took %s\\n\", elapsedMultiRun)\n    //To avoid not used warning\n    fmt.Print(len(singleThreadIntSlice))\n}\n\nfunc makeRandomNumbers(numInts int, ch chan []int) {\n    source := rand.NewSource(time.Now().UnixNano())\n    generator := rand.New(source)\n    result := make([]int, numInts)\n    for i := 0; i &lt; numInts; i++ {\n        result[i] = generator.Intn(numInts * 100)\n    }\n    ch &lt;- result\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4695298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfffb44bbbe44d9254ca278ba7193dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/4695298/karl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2813, "favorite_count": 0, "accepted_answer_id": 41632900, "answer_count": 2, "score": 3, "last_activity_date": 1484313246, "creation_date": 1484302962, "last_edit_date": 1484305357, "question_id": 41632285, "link": "https://stackoverflow.com/questions/41632285/generating-random-numbers-concurrently-in-go", "title": "Generating random numbers concurrently in Go", "body": "<p>I'm new to Go and to concurrent/parallel programming in general. In order to try out (and hopefully see the performance benefits of) goroutines, I've put together a small test program that simply generates 100 million random <code>int</code>s - first in a single goroutine, and then in as many goroutines as reported by <code>runtime.NumCPU()</code>.</p>\n\n<p>However, I consistently get worse performance using more goroutines than using a single one. I assume I'm missing something vital in either my programs design or the way in which I use goroutines/channels/other Go features. Any feedback is much appreciated.</p>\n\n<p>I attach the code below.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport \"math/rand\"\nimport \"runtime\"\n\nfunc main() {\n  // Figure out how many CPUs are available and tell Go to use all of them\n  numThreads := runtime.NumCPU()\n  runtime.GOMAXPROCS(numThreads)\n\n  // Number of random ints to generate\n  var numIntsToGenerate = 100000000\n  // Number of ints to be generated by each spawned goroutine thread\n  var numIntsPerThread = numIntsToGenerate / numThreads\n  // Channel for communicating from goroutines back to main function\n  ch := make(chan int, numIntsToGenerate)\n\n  // Slices to keep resulting ints\n  singleThreadIntSlice := make([]int, numIntsToGenerate, numIntsToGenerate)\n  multiThreadIntSlice := make([]int, numIntsToGenerate, numIntsToGenerate)\n\n  fmt.Printf(\"Initiating single-threaded random number generation.\\n\")\n  startSingleRun := time.Now()\n  // Generate all of the ints from a single goroutine, retrieve the expected\n  // number of ints from the channel and put in target slice\n  go makeRandomNumbers(numIntsToGenerate, ch)\n  for i := 0; i &lt; numIntsToGenerate; i++ {\n    singleThreadIntSlice = append(singleThreadIntSlice,(&lt;-ch))\n  }\n  elapsedSingleRun := time.Since(startSingleRun)\n  fmt.Printf(\"Single-threaded run took %s\\n\", elapsedSingleRun)\n\n\n  fmt.Printf(\"Initiating multi-threaded random number generation.\\n\")\n  startMultiRun := time.Now()\n  // Run the designated number of goroutines, each of which generates its\n  // expected share of the total random ints, retrieve the expected number\n  // of ints from the channel and put in target slice\n  for i := 0; i &lt; numThreads; i++ {\n    go makeRandomNumbers(numIntsPerThread, ch)\n  }\n  for i := 0; i &lt; numIntsToGenerate; i++ {\n    multiThreadIntSlice = append(multiThreadIntSlice,(&lt;-ch))\n  }\n  elapsedMultiRun := time.Since(startMultiRun)\n  fmt.Printf(\"Multi-threaded run took %s\\n\", elapsedMultiRun)\n}\n\n\nfunc makeRandomNumbers(numInts int, ch chan int) {\n  source := rand.NewSource(time.Now().UnixNano())\n  generator := rand.New(source)\n  for i := 0; i &lt; numInts; i++ {\n        ch &lt;- generator.Intn(numInts*100)\n    }\n}\n</code></pre>\n"}]