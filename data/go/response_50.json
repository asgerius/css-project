[{"tags": ["memory", "go", "system-calls", "memory-mapped-files"], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 0, "last_activity_date": 1450900669, "creation_date": 1450900669, "answer_id": 34442827, "question_id": 34442474, "link": "https://stackoverflow.com/questions/34442474/go-windows-to-pass-flag-to-memory-map-syscall/34442827#34442827", "title": "Go Windows to pass Flag to memory map syscall", "body": "<p>It looks like you can get the integer values for the protection flags from <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366537%28v=vs.85%29.aspx\" rel=\"nofollow\">the Windows reference for that syscall</a>. There doesn't seem to be a one-to-one mapping with the Unix-y flags, e.g. rather than having a flag for shared maps, it appears you get a shared map by default when you pass the call a filename.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 34442827, "answer_count": 1, "score": 1, "last_activity_date": 1450900669, "creation_date": 1450899044, "question_id": 34442474, "link": "https://stackoverflow.com/questions/34442474/go-windows-to-pass-flag-to-memory-map-syscall", "title": "Go Windows to pass Flag to memory map syscall", "body": "<p>In Unix, Go can do this:</p>\n\n<pre><code>// func Mmap(fd int, offset int64, length int, prot int, flags int) (data []byte, err error)\nsyscall.Mmap(., ., ., ., syscall.MAP_SHARED|syscall.XXX)\n</code></pre>\n\n<p>In Windows, you can use this:</p>\n\n<p><a href=\"https://github.com/golang/go/blob/master/src/syscall/zsyscall_windows.go#L970-L981\" rel=\"nofollow\">https://github.com/golang/go/blob/master/src/syscall/zsyscall_windows.go#L970-L981</a></p>\n\n<pre><code>// func CreateFileMapping(fhandle Handle, sa *SecurityAttributes, prot uint32, maxSizeHigh uint32, maxSizeLow uint32, name *uint16) (handle Handle, err error)\nsyscall.CreateFileMapping(., ., syscall.PAGE_READONLY, ., ., nil)\n</code></pre>\n\n<p>But I don't see any flag arguments to <code>CreateFileMapping</code> for Windows.</p>\n\n<p>Does anybody know how to pass flags to <code>CreateFileMapping</code> function like <code>syscall.MAP_SHARED|syscall.XXX</code>?</p>\n"}, {"tags": ["generics", "go"], "comments": [{"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1450891487, "post_id": 34440646, "comment_id": 56622794, "body": "Bad news. You can&#39;t write generics in Go. While you could potentially combine logic into a single function, you will still have to have code specific to each type you want to unmarshal."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450892035, "post_id": 34440646, "comment_id": 56623091, "body": "<a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Umarshal</code></a> already has default &quot;generic&quot; types it populates if you use them, or an empty interface{}."}], "answers": [{"tags": [], "owner": {"reputation": 358, "user_id": 4536186, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nNlUY.png?s=128&g=1", "display_name": "Harlam", "link": "https://stackoverflow.com/users/4536186/harlam"}, "is_accepted": false, "score": 0, "last_activity_date": 1450896398, "last_edit_date": 1450896398, "creation_date": 1450891853, "answer_id": 34440872, "question_id": 34440646, "link": "https://stackoverflow.com/questions/34440646/how-to-create-a-generic-function-to-unmarshal-all-types/34440872#34440872", "title": "How to create a generic function to unmarshal all types?", "body": "<p>Go doesn't support generics, but you can write something like this:</p>\n\n<pre><code>func genericUnmarshalForType1(file string) interface{} {\n\n    raw, err := ioutil.ReadFile(file)\n\n    if err != nil {\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n\n    var x interface{}\n    if err = json.NewDecoder(raw).Decode(x); err != nil {\n        return nil\n    }\n\n    return x\n}\n\nfunc main() {\n    x := genericUnmarshalForType1(\"filename.json\");\n\n    var t1 Type1\n    var t2 Type2\n\n    switch t := x.(type) {\n    case Type1:\n        t1 = t\n    case Type2:\n        t2 = t\n    }\n}\n</code></pre>\n\n<p>Also I recommend you to read <a href=\"http://attilaolah.eu/2013/11/29/json-decoding-in-go/\" rel=\"nofollow\">http://attilaolah.eu/2013/11/29/json-decoding-in-go/</a> about <code>Unmarshal</code> using and data types.</p>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1450891892, "creation_date": 1450891892, "answer_id": 34440882, "question_id": 34440646, "link": "https://stackoverflow.com/questions/34440646/how-to-create-a-generic-function-to-unmarshal-all-types/34440882#34440882", "title": "How to create a generic function to unmarshal all types?", "body": "<p>Do it the same way <code>json.Unmarshal</code> does it:</p>\n\n<pre><code>func genericUnmarshal(file string, v interface{}) {\n    // File emulation.\n    raw := []byte(`{\"a\":42,\"b\":\"foo\"}`)\n    json.Unmarshal(raw, v)\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/iO-cbK50BE\" rel=\"nofollow\">http://play.golang.org/p/iO-cbK50BE</a>.</p>\n\n<p>You can make this function better by actually returning any errors encountered.</p>\n"}], "owner": {"reputation": 489, "user_id": 1401162, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/34ccb916234d4117540155fed4e4ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Vipercold", "link": "https://stackoverflow.com/users/1401162/vipercold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 1, "accepted_answer_id": 34440882, "answer_count": 2, "score": 0, "last_activity_date": 1450896398, "creation_date": 1450890783, "last_edit_date": 1450892105, "question_id": 34440646, "link": "https://stackoverflow.com/questions/34440646/how-to-create-a-generic-function-to-unmarshal-all-types", "title": "How to create a generic function to unmarshal all types?", "body": "<p>I have a function below, and I would like to make it generic:</p>\n\n<pre><code>func genericUnmarshalForType1(file string) Type1 {\n\n  raw, err := ioutil.ReadFile(file)\n\n  if err != nil {\n      fmt.Println(err.Error())\n      os.Exit(1)\n  }\n\n  var type1 Type1\n\n  json.Unmarshal(raw, &amp;type1)\n}\n</code></pre>\n\n<p>I would like to create a function that accepts Type1 or Type2 without the need to create a function per type. How can I do this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "edited": false, "score": 0, "creation_date": 1450890099, "post_id": 34440268, "comment_id": 56622028, "body": "Obviously: VMNET_SUBNET = &quot;192.168.224.0&quot; in the snippet above"}], "answers": [{"comments": [{"owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "edited": false, "score": 0, "creation_date": 1450894148, "post_id": 34440538, "comment_id": 56624229, "body": "Doh! Thanks! I love the short solution (albeit the other one works fine too). I was looking for something SHORT and that cuts it very nicely. Regexp is so powerful (and yet so hostile for me). Thanks!"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 7, "last_activity_date": 1450890334, "creation_date": 1450890334, "answer_id": 34440538, "question_id": 34440268, "link": "https://stackoverflow.com/questions/34440268/parsing-of-text-file-to-match-string-and-extract-value-in-golang/34440538#34440538", "title": "Parsing of text file to match string and extract value (in Golang)", "body": "<p>You can use a <a href=\"https://golang.org/pkg/regexp/\" rel=\"noreferrer\">regular expression</a>:</p>\n\n<pre><code>re := regexp.MustCompile(`.*VNET_(\\d+)_.*192.168.224.0`)\nmatches := re.FindStringSubmatch(text)\nfmt.Println(matches[1])\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/NQlA2BObtU\" rel=\"noreferrer\">http://play.golang.org/p/NQlA2BObtU</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": false, "score": 4, "last_activity_date": 1450892275, "creation_date": 1450892275, "answer_id": 34440987, "question_id": 34440268, "link": "https://stackoverflow.com/questions/34440268/parsing-of-text-file-to-match-string-and-extract-value-in-golang/34440987#34440987", "title": "Parsing of text file to match string and extract value (in Golang)", "body": "<p>Here is a robust way to parse these data that builds on @ainar-g's answer:</p>\n\n<p><a href=\"http://play.golang.org/p/6-PELcLvVz\" rel=\"noreferrer\">http://play.golang.org/p/6-PELcLvVz</a></p>\n\n<p>The goal here is to store the properties for each VNET in a map, using the following type:</p>\n\n<pre><code>type vnet map[int]map[string]string\n</code></pre>\n\n<p>This code:</p>\n\n<pre><code>var re = regexp.MustCompile(`.*VNET_(\\d+)_([^\\s]+) (.*)`)\nfunc ReadVnet(r io.Reader) vnet {\n    s := bufio.NewScanner(r)\n    v := make(vnet)\n\n    for s.Scan() {\n        matches := re.FindStringSubmatch(s.Text())\n        id, err := strconv.Atoi(matches[1])\n        if err != nil {\n            continue\n        }\n\n        if _, ok := v[id]; !ok {\n            v[id] = make(map[string]string)\n        }\n        v[id][matches[2]] = matches[3]\n    }\n\n    return v\n}\n</code></pre>\n\n<p>creates the map in question:</p>\n\n<pre><code>map[1:map[DHCP:yes DHCP_CFG_HASH:4CF2C196E368CE83B9D1895C5E05301CDFDEBCA0 HOSTONLY_NETMASK:255.255.255.0 HOSTONLY_SUBNET:192.168.224.0 VIRTUAL_ADAPTER:yes] 8:map[DHCP:yes DHCP_CFG_HASH:D326C0BC7FF6C38C57AF341F9075E576C175B250 HOSTONLY_NETMASK:255.255.255.0 HOSTONLY_SUBNET:172.16.102.0 NAT:yes VIRTUAL_ADAPTER:yes]]\n</code></pre>\n\n<p>Now you can iterate on the map to find the item of interest:</p>\n\n<pre><code>func main() {\n    v := ReadVnet(bytes.NewBufferString(text))\n\n    for id, properties := range v {\n        if ip, ok := properties[\"HOSTONLY_SUBNET\"]; ok &amp;&amp; ip == \"192.168.224.0\" {\n            fmt.Println(id)\n            return\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 333, "user_id": 995368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hjdrh.png?s=128&g=1", "display_name": "Xavier Nicollet", "link": "https://stackoverflow.com/users/995368/xavier-nicollet"}, "is_accepted": false, "score": 2, "last_activity_date": 1450978211, "creation_date": 1450978211, "answer_id": 34456107, "question_id": 34440268, "link": "https://stackoverflow.com/questions/34440268/parsing-of-text-file-to-match-string-and-extract-value-in-golang/34456107#34456107", "title": "Parsing of text file to match string and extract value (in Golang)", "body": "<p>This is a version without regexp:</p>\n\n<pre><code>  idxEnd := strings.Index(txt, \"192.168.224.0\")\n  idxVNET := strings.LastIndex(txt[:idxEnd], \"VNET_\")\n  beginNumber := idxVNET + 5\n  length := strings.Index(txt[beginNumber:idxEnd], \"_\")\n  number, _ := strconv.Atoi(txt[beginNumber : beginNumber+length])\n  fmt.Printf(\"number: %T %v\\n\", number, number)\n</code></pre>\n\n<p>Would you try to do that on a very (very) big string, it should be faster.</p>\n"}], "owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7764, "favorite_count": 0, "accepted_answer_id": 34440538, "answer_count": 3, "score": 3, "last_activity_date": 1450978211, "creation_date": 1450889367, "last_edit_date": 1450890016, "question_id": 34440268, "link": "https://stackoverflow.com/questions/34440268/parsing-of-text-file-to-match-string-and-extract-value-in-golang", "title": "Parsing of text file to match string and extract value (in Golang)", "body": "<p>I am scratching my head around a need that seems to be potentially common but I couldn't locate any example on the web. </p>\n\n<p>I have a file like this: </p>\n\n<pre><code>  answer VNET_1_DHCP yes\n  answer VNET_1_DHCP_CFG_HASH 4CF2C196E368CE83B9D1895C5E05301CDFDEBCA0  \n  answer VNET_1_HOSTONLY_NETMASK 255.255.255.0\n  answer VNET_1_HOSTONLY_SUBNET 192.168.224.0\n  answer VNET_1_VIRTUAL_ADAPTER yes\n  answer VNET_8_DHCP yes\n  answer VNET_8_DHCP_CFG_HASH D326C0BC7FF6C38C57AF341F9075E576C175B250\n  answer VNET_8_HOSTONLY_NETMASK 255.255.255.0\n  answer VNET_8_HOSTONLY_SUBNET 172.16.102.0\n  answer VNET_8_NAT yes\n  answer VNET_8_VIRTUAL_ADAPTER yes\n</code></pre>\n\n<p>I need to extract the VNET number of a specific subnet (192.168.224.0). VNET numbers could vary (and the subnet could, in theory, not even exist). So I need to match if the subnet exists, and if exists extract the network number (<code>1</code> in this example). </p>\n\n<p>I found it to be SUPER easy to implement this in BASH: </p>\n\n<pre><code> if grep -q 192.168.224.0 ./networking; then\n      echo \"The ${VMNET_SUBNET} network already exists\"\n      NETWORK_NUMBER=$(grep ${VMNET_SUBNET} ./networking | cut -d'_' -f 2)\n      echo NETWORK_NUMBER  \n else &lt;do something to create it.....&gt; \n</code></pre>\n\n<p>I am trying to find the easiest way to implement this using Go. </p>\n\n<p>Thanks. </p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1450890515, "post_id": 34440246, "comment_id": 56622257, "body": "I would change my routes to be a little more REST like. something like: <code>POST &#47;users</code> would create a user and <code>PUT &#47;users&#47;{userID}</code> would update the user. Then you could apply the appropriate middleware to each route."}], "answers": [{"tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": true, "score": 5, "last_activity_date": 1450897704, "creation_date": 1450897704, "answer_id": 34442172, "question_id": 34440246, "link": "https://stackoverflow.com/questions/34440246/accessing-route-in-middleware-using-gin/34442172#34442172", "title": "Accessing route in middleware using Gin", "body": "<p>You could check the url from the auth handler. The actual request is on the context, so it's as easy as:</p>\n\n<pre><code>if c.Request.URL.Path == \"/user.save\" {\n    // Do your thing\n}\n</code></pre>\n\n<p>Another solution is to parameterize your auth middleware, something like this:</p>\n\n<pre><code>api.POST(\"/user.save\", auth(true), user.Save())\napi.POST(\"/user.somethingElse\", auth(false), user.SomethingElse())\n\nfunc auth(isUserSave bool) gin.HandlerFunc {\n    return func(c *gin.Context) {\n        if isUserSave {\n            // Do your thing\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2874, "favorite_count": 0, "accepted_answer_id": 34442172, "answer_count": 1, "score": 2, "last_activity_date": 1506681182, "creation_date": 1450889294, "last_edit_date": 1489490925, "question_id": 34440246, "link": "https://stackoverflow.com/questions/34440246/accessing-route-in-middleware-using-gin", "title": "Accessing route in middleware using Gin", "body": "<p>I have a <code>user.save</code> route (below) in my Golang API that can be used to <code>create</code> and <code>update</code> a user depending on whether an <code>id</code> was provided in the request object. The route uses the <code>auth</code> middleware which other routes do too.</p>\n\n<pre><code>api.POST(\"/user.save\", auth(), user.Save())\napi.POST(\"/user.somethingElse\", auth(), user.SomethingElse())\n</code></pre>\n\n<p>Here is my middleware:</p>\n\n<pre><code>func auth() gin.HandlerFunc {\n    return func(c *gin.Context) {\n        //I would like to know here if user.save was the route called\n        //do authy stuff\n    }\n}\n</code></pre>\n\n<p>I'm thinking that if I can detect in the <code>auth</code> middleware whether the <code>user.save</code> route was called I can then check to see if an <code>id</code> was included and decide whether to continue or return.</p>\n"}, {"tags": ["postgresql", "reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1450891576, "creation_date": 1450891576, "answer_id": 34440815, "question_id": 34440242, "link": "https://stackoverflow.com/questions/34440242/golang-reflect-for-sql-scan-report-error/34440815#34440815", "title": "golang reflect for sql scan report error", "body": "<p><code>url.URL</code> doesn't implement <a href=\"https://golang.org/pkg/database/sql/#Scanner\" rel=\"nofollow\"><code>sql.Scanner</code></a>, so it cannot be scanned from DB. You can either make a wrapper type that does implement <code>sql.Scanner</code>:</p>\n\n<pre><code>type sqlURL struct { url.URL }\nfunc (su *sqlURL) Scan(v interface{}) error {\n    u, err := url.Parse(string(v.([]byte)))\n    if err != nil {\n        return err\n    }\n    *su = sqlURL{*u}\n    return nil\n}\n</code></pre>\n\n<p>or scan the URL into a string separately and then parse it:</p>\n\n<pre><code>var urlStr string\nerr = db.QueryRow(command).Scan(/* ... */, &amp;urlStr)\n// check err\nu, err := url.Parse(urlStr)\n// check err\nuser.Site = *u\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5711571, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-NXogzROk9Qc/AAAAAAAAAAI/AAAAAAAAEK0/zto59EqRCow/photo.jpg?sz=128", "display_name": "up duan", "link": "https://stackoverflow.com/users/5711571/up-duan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 34440815, "answer_count": 1, "score": 1, "last_activity_date": 1450891576, "creation_date": 1450889286, "question_id": 34440242, "link": "https://stackoverflow.com/questions/34440242/golang-reflect-for-sql-scan-report-error", "title": "golang reflect for sql scan report error", "body": "<pre><code>/**\n-- name is character varying(64)\nCREATE TABLE users\n(\n  id bigint NOT NULL,\n  no character(24),\n  identity name,\n  name name,\n  head character varying(256),\n  email character varying(256),\n  site character varying(256),\n  create_time timestamp without time zone,\n  city_id bigint,\n  timezone jsonb,\n  update_time timestamp without time zone,\n  CONSTRAINT user__pk PRIMARY KEY (id)\n)\n\nspottly=# SELECT \"id\", \"no\", \"identity\", \"name\", \"head\", \"email\", \"site\", \"create_time\", \"city_id\", \"update_time\", \"timezone\" FROM \"users\" WHERE \"email\" = 'fixopen@yeah.net' LIMIT 1 OFFSET 0;\n       id       | no | identity |  name   |                  head                  |      email       |            site            | create_time | city_id | update_time | timezone\n----------------+----+----------+---------+----------------------------------------+------------------+----------------------------+-------------+---------+-------------+----------\n 95083655397376 |    | fixopen  | fixopen | /uploader/52e2762edf4e633666000867.png | fixopen@yeah.net | http://spottly.com/fixopen |             |         |             |\n(1 row)\n*/\n\npackage main\n\nimport (\n    \"database/sql\"\n    //\"errors\"\n    \"fmt\"\n    _ \"github.com/lib/pq\"\n    \"log\"\n    \"net/url\"\n    \"reflect\"\n    \"strings\"\n    \"time\"\n)\n\ntype User struct {\n    Id          uint64    `json:\"id\"`\n    No          *string   `json:\"no\"`\n    Identity    string    `json:\"identity\"`\n    Name        string    `json:\"name\"`\n    Head        url.URL   `json:\"head\"`\n    Email       *string   `json:\"email\"`\n    Site        url.URL   `json:\"site\"`\n    Create_time time.Time `json:\"create-time\"`\n    City_id     *uint64   `json:\"city-id\"`\n    Update_time time.Time `json:\"update-time\"`\n    Timezone    *string   `json:\"timezone\"`\n}\n\nfunc main() {\n    connectionString := \"host=localhost port=5432 user=postgres dbname=spottly password=123456 sslmode=disable\"\n    db, err := sql.Open(\"postgres\", connectionString)\n    defer db.Close()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    t := reflect.TypeOf(User{})\n    //u := reflect.New(t).Elem().Interface()\n    //fmt.Printf(\"u is %T, %#v\\n\", u, u)\n\n    resultValuePtr := reflect.New(t)\n    resultValue := resultValuePtr.Elem()\n    fieldCount := t.NumField()\n    fields := make([]reflect.StructField, fieldCount)\n    for i := 0; i &lt; fieldCount; i++ {\n        fields[i] = t.Field(i)\n    }\n    columns := make([]string, fieldCount)\n    fieldAddrs := make([]interface{}, fieldCount)\n    for i := 0; i &lt; fieldCount; i++ {\n        columns[i] = strings.ToLower(fields[i].Name)\n        fieldAddrs[i] = resultValue.Field(i).Addr().Interface()\n    }\n    columnNames := strings.Join(columns, \"\\\", \\\"\")\n    command := \"SELECT \\\"\" + columnNames + \"\\\" FROM \\\"users\\\" WHERE \\\"email\\\" = 'fixopen@yeah.net' LIMIT 1 OFFSET 0\"\n    fmt.Printf(\"query command is %v\\n\", command)\n    // fmt.Printf(\"meta field is %v\\n\", fields)\n    // fmt.Printf(\"field addr is %#v\\n\", fieldAddrs)\n    err = db.QueryRow(command).Scan(fieldAddrs...)\n    if err == nil {\n        result := resultValuePtr.Interface()\n        fmt.Printf(\"result is %#v\\n\", result)\n    } else {\n        fmt.Printf(\"Select one error is %v\\n\", err)\n        //panic(errors.New(\"halt\"))\n    }\n}\n</code></pre>\n\n<p>database schema and data show in comment.</p>\n\n<p>the query command is:</p>\n\n<p><code>SELECT \"id\", \"no\", \"identity\", \"name\", \"head\", \"email\", \"site\", \"create_time\", \"city_id\", \"update_time\", \"timezone\" FROM \"users\" WHERE \"email\" = 'fixopen@yeah.net' LIMIT 1 OFFSET 0</code></p>\n\n<p>same as comment, this command execute with <code>psql</code> return one row data.</p>\n\n<p>sql Scan method execute error, output:</p>\n\n<p><code>Select one error is sql: Scan error on column index 4: unsupported driver -&gt; Scan pair: []uint8 -&gt; *url.URL</code></p>\n\n<p>My golang version is <code>go version go1.5.2 darwin/amd64</code></p>\n\n<p>PostgreSQL version is <code>9.4.2</code></p>\n\n<p>use <code>github.com/lib/pq</code> access DB.</p>\n\n<p>It's the db driver not support scan string column to url.URL?</p>\n\n<p>what do I can?</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 0, "last_activity_date": 1450883940, "creation_date": 1450883940, "answer_id": 34438699, "question_id": 34438636, "link": "https://stackoverflow.com/questions/34438636/golang-reflect-create-object-is-error/34438699#34438699", "title": "golang reflect create object is error", "body": "<p>Your structure actually have 4 fields, notice the extra whitespaces that delimit the empty string field.</p>\n\n<p>Try using the <code>%#v</code> to show the golang-syntax representation of your struct, that's much more easier to read (but can become quite crowded on big structures).</p>\n"}], "owner": {"reputation": 101, "user_id": 5711571, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-NXogzROk9Qc/AAAAAAAAAAI/AAAAAAAAEK0/zto59EqRCow/photo.jpg?sz=128", "display_name": "up duan", "link": "https://stackoverflow.com/users/5711571/up-duan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 34438699, "answer_count": 1, "score": -2, "last_activity_date": 1450883940, "creation_date": 1450883692, "question_id": 34438636, "link": "https://stackoverflow.com/questions/34438636/golang-reflect-create-object-is-error", "title": "golang reflect create object is error", "body": "<p><code>less main.go</code> output:</p>\n\n<p>```</p>\n\n<pre><code>package main\n\nimport (\n    \"reflect\"\n    \"net/url\"\n    \"fmt\"\n)\n\ntype User struct {\n    Id uint64 `json:\"id\"`\n    No *string `json:\"no\"`\n    Identity string `json:\"identity\"`\n    Head url.URL `json:\"head\"`\n}\n\nfunc main() {\n    t := reflect.TypeOf(User{})\n    u := reflect.New(t).Elem().Interface()\n    fmt.Printf(\"u is %T, %v\\n\", u, u)\n}\n</code></pre>\n\n<p>```</p>\n\n<p><code>go version</code> output:</p>\n\n<p><code>\ngo version go1.5.2 darwin/amd64\n</code></p>\n\n<p><code>go build main.go</code> correct</p>\n\n<p><code>./main</code> output:</p>\n\n<p><code>\nu is main.User, {0 &lt;nil&gt;  {  &lt;nil&gt;     }}\n</code></p>\n\n<p>what the matter?? why u object only third field? the User struct include four field!</p>\n\n<p>In my really project, I find the created object's field's type is incorrect</p>\n"}, {"tags": ["datetime", "time", "go"], "comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1450884685, "post_id": 34438395, "comment_id": 56618585, "body": "Do you just want to convert the string to a timestamp or do you want it to come out of the database as a <code>time.Time</code> value? I think the latter would be more useful."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1450888253, "post_id": 34438395, "comment_id": 56620891, "body": "Roy, you should not put the information from tags into title. You&#39;ve tagged your question <code>go</code> and that&#39;s all what&#39;s needed."}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 1, "creation_date": 1450955286, "post_id": 34438395, "comment_id": 56645153, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14106541/go-parsing-date-time-strings-which-are-not-standard-formats\">Go - Parsing date/time strings which are not &#39;standard&#39; formats</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8060, "user_id": 3834036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PEZNI.png?s=128&g=1", "display_name": "Lior Bar-On", "link": "https://stackoverflow.com/users/3834036/lior-bar-on"}, "is_accepted": false, "score": 2, "last_activity_date": 1450886214, "creation_date": 1450886214, "answer_id": 34439392, "question_id": 34438395, "link": "https://stackoverflow.com/questions/34438395/convert-a-mysql-datetime-string-to-time-time-format/34439392#34439392", "title": "Convert a MySQL datetime string to time.Time format", "body": "<p>Indeed, I'm not aware of any ISO-8601 parsing support in Go's standard libraries. </p>\n\n<p>Let us use RFC-3309, which is the closest:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"time\"\n  \"strings\"\n)\n\nfunc main() {\n\n  // convert iso-8601 into rfc-3339 format\n  rfc3339t := strings.Replace(\"2015-12-23 00:00:00\", \" \", \"T\", 1) + \"Z\"\n\n  // parse rfc-3339 datetime\n  t, err := time.Parse(time.RFC3339, rfc3339t)\n  if err != nil {\n    panic(err)\n  }\n\n  // convert into unix time\n  ut := t.UnixNano() / int64(time.Millisecond)\n\n  fmt.Println(ut)\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>1450828800000\n</code></pre>\n\n<p><strong>Playground: <a href=\"http://play.golang.org/p/HxZCpxmjvg\" rel=\"nofollow\">http://play.golang.org/p/HxZCpxmjvg</a></strong></p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 3311, "user_id": 61363, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30ed41f682f716613fe62a0831f522dd?s=128&d=identicon&r=PG", "display_name": "del-boy", "link": "https://stackoverflow.com/users/61363/del-boy"}, "is_accepted": true, "score": 14, "last_activity_date": 1593345559, "last_edit_date": 1593345559, "creation_date": 1450886735, "answer_id": 34439549, "question_id": 34438395, "link": "https://stackoverflow.com/questions/34438395/convert-a-mysql-datetime-string-to-time-time-format/34439549#34439549", "title": "Convert a MySQL datetime string to time.Time format", "body": "<p>You can create your own time format for parsing, if one does not exist in standard library.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    layout := &quot;2006-01-02 15:04:05&quot;\n    str := &quot;2015-12-23 00:00:00&quot;\n    t, err := time.Parse(layout, str)\n\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(t.Unix())\n}\n</code></pre>\n<p>Output</p>\n<pre><code>1450828800\n</code></pre>\n<p>I do not know were official documentation for time format is, but you can find it <a href=\"https://golang.org/src/time/format.go\" rel=\"nofollow noreferrer\">here</a>, from line 64.</p>\n"}], "owner": {"reputation": 2337, "user_id": 1192134, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/425e8d7681582a05884d498eb9fec507?s=128&d=identicon&r=PG", "display_name": "Roy van Zanten", "link": "https://stackoverflow.com/users/1192134/roy-van-zanten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5016, "favorite_count": 2, "accepted_answer_id": 34439549, "answer_count": 2, "score": 5, "last_activity_date": 1593345559, "creation_date": 1450882882, "last_edit_date": 1451422995, "question_id": 34438395, "link": "https://stackoverflow.com/questions/34438395/convert-a-mysql-datetime-string-to-time-time-format", "title": "Convert a MySQL datetime string to time.Time format", "body": "<p>I just cant manage to parse an SQL datetime (MySQL) value into a <code>time.Time</code> value. I cant find the layout fitting sql datetime. And also not really understand how this works.</p>\n\n<p>I do imagine I'am not the first struggling with this, though i cant really find how I should make this work.</p>\n\n<p>Input:</p>\n\n<pre><code>2015-12-23 00:00:00\n</code></pre>\n\n<p>Desired output:</p>\n\n<pre><code>1450825200\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>time, err := time.Parse(time.SomeSqlDateTimeLayout, \"2015-12-23 00:00:00\")\ntimestamp := time.Unix()\n</code></pre>\n"}, {"tags": ["arrays", "string", "go", "memory-leaks", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1450878652, "post_id": 34436863, "comment_id": 56615074, "body": "strings are immutable, so this just allocates a new string every time."}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450879202, "post_id": 34436863, "comment_id": 56615424, "body": "@jimb is there a clear reference about string slicing always allocating a full new string? So far, I have found this: &quot;In Go, a string is in effect a read-only slice of bytes.&quot; <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">blog.golang.org/strings</a>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 2, "creation_date": 1450879657, "post_id": 34436863, "comment_id": 56615699, "body": "Slicing does not make a new string. But assigning the slice back to buf does."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1450880359, "post_id": 34436863, "comment_id": 56616084, "body": "I am actually not sure about this anymore. Maybe the string&#39;s bytes do end up hanging around..."}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450880429, "post_id": 34436863, "comment_id": 56616120, "body": "@jimb So is it safe to assume there should not exist an underlying array which grows indefinitely in this case?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450881357, "post_id": 34436863, "comment_id": 56616653, "body": "@Everton: it&#39;s safe to assume and easy to test. Just run your <code>push</code> in a loop with gctrace on. On my system it keeps a stable 4MB heap."}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450881961, "post_id": 34436863, "comment_id": 56617004, "body": "@JimB Great, thanks!"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1451338540, "post_id": 34436863, "comment_id": 56743854, "body": "See also <a href=\"http://stackoverflow.com/questions/16909917/substrings-and-the-go-garbage-collector\" title=\"substrings and the go garbage collector\">stackoverflow.com/questions/16909917/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "edited": false, "score": 0, "creation_date": 1450882041, "post_id": 34437683, "comment_id": 56617048, "body": "Thanks for this: &quot;it&#39;s safe to assume and easy to test. Just run your push in a loop with gctrace on. On my system it keeps a stable 4MB heap. \u2013 JimB&quot;"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450882321, "post_id": 34437683, "comment_id": 56617242, "body": "Still, I wonder if holding a reference to <code>s[i:j]</code> keeps <code>s</code> in memory? For example in Java <code>s.substring(i,j)</code> was holding to <code>s</code> data until Java 8."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 2, "creation_date": 1450882939, "post_id": 34437683, "comment_id": 56617592, "body": "@kostya: yes a single slice can keep the bytes alive as expected, <a href=\"http://play.golang.org/p/H6zQ0fMi-g\" rel=\"nofollow noreferrer\">play.golang.org/p/H6zQ0fMi-g</a>, but that&#39;s not what this example was doing. I&#39;ll add a note about that though."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450883986, "post_id": 34437683, "comment_id": 56618150, "body": "@JimB, this is quite interesting question. I will try to write down an alternative answer."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1451317865, "last_edit_date": 1451317865, "creation_date": 1450880444, "answer_id": 34437683, "question_id": 34436863, "link": "https://stackoverflow.com/questions/34436863/can-this-type-of-golang-string-slicing-leak-memory-in-underlying-byte-array/34437683#34437683", "title": "Can this type of golang string slicing leak memory in underlying byte array?", "body": "<p>No, this example can't cause a memory leak, since you need to allocate new strings each time you call <code>push</code>. It's possible that some bytes will be kept around at times to reduce allocations, but how that works is an implementation detail that shouldn't be taken into consideration.</p>\n\n<p>If you're thinking of a similar situation which can arise when you assign a result of a slice operation, but never append. There's no leak per say, as long as you understand the semantics of slicing. </p>\n\n<pre><code>s := make([]byte, 1024)\ns = s[1000:]\nfmt.Println(s, len(s), cap(s))\n</code></pre>\n\n<p>This example will leave the first 1000 bytes allocated, but inaccessible. The answer to this is simple, don't do that. It's not hard to avoid, and if you do need to ensure that you've released the underlying array, use <code>copy</code> to move the bytes to a new slice.  </p>\n\n<p>This works the same with strings:</p>\n\n<pre><code>s = s[1020:]\n// may leave the first 1000 bytes allocated\n</code></pre>\n\n<p>This is again fairly easy to see what's going on, and avoid. If you're using huge strings, you're often better off using <code>[]byte</code> anyway, where you have better control over allocation, and can copy the bytes when needed. </p>\n"}, {"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 3, "last_activity_date": 1450884804, "creation_date": 1450884804, "answer_id": 34438953, "question_id": 34436863, "link": "https://stackoverflow.com/questions/34436863/can-this-type-of-golang-string-slicing-leak-memory-in-underlying-byte-array/34438953#34438953", "title": "Can this type of golang string slicing leak memory in underlying byte array?", "body": "<p>A result of applying slice expression to a string in <code>p := s[i:j]</code> is a string. As far as I can tell the Go language specification (<a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">https://golang.org/ref/spec</a>) doesn't specify that <code>p</code> will be backed by the same memory as <code>s</code>.</p>\n\n<p>However it looks like in Go 1.6 and earlier versions a live reference to <code>p</code> will hold <code>s</code> from being garbage collected. This might however change in the future versions of Go.</p>\n\n<p>An interesting fact that in Java <code>String.substring</code> method was implemented in the same way until Java 8. In Java 8 however <code>substring</code> returns a copy.</p>\n\n<p>Back to your example. The following line actually creates a new string instance every time you call <code>push</code> function:</p>\n\n<pre><code>buf += s\n</code></pre>\n\n<p>The old instance of buf gets garbage collected. So your example is not affected by the problem described above.</p>\n"}], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1791, "favorite_count": 2, "accepted_answer_id": 34437683, "answer_count": 2, "score": 4, "last_activity_date": 1451317865, "creation_date": 1450877575, "question_id": 34436863, "link": "https://stackoverflow.com/questions/34436863/can-this-type-of-golang-string-slicing-leak-memory-in-underlying-byte-array", "title": "Can this type of golang string slicing leak memory in underlying byte array?", "body": "<p>Can golang string slicing like <code>buf = buf[n:]</code> cause memory leak in the underlying byte array?</p>\n\n<p>If so, is it possible to get any information (like capacity, or base memory address) about the underlying byte array, in order to verify the leak?</p>\n\n<p>Please see sample code below:</p>\n\n<pre><code>var buf string\n\nfunc push(s string) {\n    buf += s\n    if len(buf) &gt; 3 {\n        buf = buf[len(buf)-3:] // can this line leak memory in underlying byte array?\n    }\n    fmt.Printf(\"buf=[%v]\\n\", buf)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/ad2_j2eGQh\" rel=\"nofollow\" title=\"Playground\">Run it on playground</a></p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1450877523, "post_id": 34436547, "comment_id": 56614413, "body": "Are you sure the user postgres has no password? I.e. does <code>user=postgres password=postgres</code> work?"}, {"owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1450877759, "post_id": 34436547, "comment_id": 56614540, "body": "@Ainar-G I am. I can connect to psql and use other app (Rails) without password."}], "answers": [{"comments": [{"owner": {"reputation": 358, "user_id": 4536186, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nNlUY.png?s=128&g=1", "display_name": "Harlam", "link": "https://stackoverflow.com/users/4536186/harlam"}, "reply_to_user": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "edited": false, "score": 0, "creation_date": 1450878301, "post_id": 34436957, "comment_id": 56614853, "body": "show please &quot;cat /var/lib/pgsql/&lt;your version&gt;/data/pg_hba.conf&quot; results"}, {"owner": {"reputation": 358, "user_id": 4536186, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nNlUY.png?s=128&g=1", "display_name": "Harlam", "link": "https://stackoverflow.com/users/4536186/harlam"}, "reply_to_user": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "edited": false, "score": 0, "creation_date": 1450886185, "post_id": 34436957, "comment_id": 56619600, "body": "try to replace &quot;ident&quot; into &quot;trust&quot;"}, {"owner": {"reputation": 358, "user_id": 4536186, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nNlUY.png?s=128&g=1", "display_name": "Harlam", "link": "https://stackoverflow.com/users/4536186/harlam"}, "reply_to_user": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "edited": false, "score": 0, "creation_date": 1450886239, "post_id": 34436957, "comment_id": 56619632, "body": "I have on my server: local   all             all                                     trust; host    all             all             127.0.0.1/32           trust; host    all             all             ::1/128                trust"}, {"owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "edited": false, "score": 0, "creation_date": 1450889780, "post_id": 34436957, "comment_id": 56621833, "body": "Ok, looks like I am lazy... I needed to check this option: <code>host - The host to connect to. Values that start with &#47; are for unix domain sockets. (default is localhost)</code>. Other drivers by default use unix socket, here default is localhost. And looks like I don&#39;t have ident installed..."}], "tags": [], "owner": {"reputation": 358, "user_id": 4536186, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nNlUY.png?s=128&g=1", "display_name": "Harlam", "link": "https://stackoverflow.com/users/4536186/harlam"}, "is_accepted": false, "score": 2, "last_activity_date": 1450877954, "creation_date": 1450877954, "answer_id": 34436957, "question_id": 34436547, "link": "https://stackoverflow.com/questions/34436547/golang-lib-pg-cant-connect-to-postgres/34436957#34436957", "title": "Golang lib/pg can&#39;t connect to postgres", "body": "<p>Run in console:</p>\n\n<pre><code>psql \"user=postgres dbname=vagrant sslmode=disable\"\n</code></pre>\n\n<p>If you cannot connect so it needs to change sslmode else I will think more.</p>\n"}, {"tags": [], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "is_accepted": true, "score": 4, "last_activity_date": 1451290409, "creation_date": 1451290409, "answer_id": 34489908, "question_id": 34436547, "link": "https://stackoverflow.com/questions/34436547/golang-lib-pg-cant-connect-to-postgres/34489908#34489908", "title": "Golang lib/pg can&#39;t connect to postgres", "body": "<p>Ok,\ncorrect connection string is:</p>\n\n<pre><code>\"user=postgres host=/tmp dbname=vagrant sslmode=disable\"\n</code></pre>\n\n<p>I assumed pg library uses same defaults as <code>psql</code> or ruby driver. Lesson learned.</p>\n"}], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6176, "favorite_count": 0, "accepted_answer_id": 34489908, "answer_count": 2, "score": 3, "last_activity_date": 1451290409, "creation_date": 1450876480, "last_edit_date": 1450880513, "question_id": 34436547, "link": "https://stackoverflow.com/questions/34436547/golang-lib-pg-cant-connect-to-postgres", "title": "Golang lib/pg can&#39;t connect to postgres", "body": "<p>I have such code:</p>\n\n<pre><code>package main\n\nimport (\n        \"database/sql\"\n        \"fmt\"\n        \"log\"\n\n        _ \"github.com/lib/pq\"\n)\n\nfunc main() {\n        db, err := sql.Open(\"postgres\", \"user=postgres dbname=vagrant sslmode=disable\")\n        if err != nil {\n                log.Fatal(err)\n        }\n\n        rows, err := db.Query(\"SELECT 3+5\")\n        if err != nil {\n                log.Fatal(err)\n        }\n        fmt.Println(rows)\n}\n</code></pre>\n\n<p>And its result is:</p>\n\n<pre><code>[vagrant@localhost go-postgres]$ go run test.go\n2015/12/19 11:03:53 pq: Ident authentication failed for user \"postgres\"\nexit status 1\n</code></pre>\n\n<p>But I can access postgres:</p>\n\n<pre><code>[vagrant@localhost go-postgres]$ psql -U postgres vagrant\npsql (9.4.4)\nType \"help\" for help.\n\nvagrant=#\n</code></pre>\n\n<p>And I don't have any troubles with using Rails app with postgres. </p>\n\n<p>Anyone has an idea?</p>\n\n<p>EDIT:\nHere is my pg_hba.conf:</p>\n\n<pre><code>local   all             all                                     trust\nhost    all             all             127.0.0.1/32            ident\nhost    all             all             ::1/128                 ident\n</code></pre>\n\n<p>EDIT2:</p>\n\n<p>I found this in my postgres logs:</p>\n\n<pre><code>&lt; 2015-12-19 12:13:05.094 UTC &gt;LOG:  could not connect to Ident server at address \"::1\", port 113: Connection refused\n&lt; 2015-12-19 12:13:05.094 UTC &gt;FATAL:  Ident authentication failed for user \"postgres\"\n&lt; 2015-12-19 12:13:05.094 UTC &gt;DETAIL:  Connection matched pg_hba.conf line 84: \"host    all             all             ::1/128                 ident\"\n</code></pre>\n\n<p>I think it will really help ;)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1450878435, "post_id": 34436185, "comment_id": 56614940, "body": "going with the practical way, how do you test the if err != nil, because it&#39;s not returning anything, a solution will be to store all the errors and then return them, but at the moment I don&#39;t have a error return, I just write to <code>os.Stderr</code> thx btw"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1450883754, "post_id": 34436185, "comment_id": 56618025, "body": "Return a <code>[]error</code>, which can be <code>nil</code> if you don&#39;t have any error."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 1, "creation_date": 1450883786, "post_id": 34436185, "comment_id": 56618054, "body": "By the way, you should probably avoid printing anything except in your main function, be the the real <code>main</code> or the function that correspond to you command/subcommand if you use a CLI package."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 2, "last_activity_date": 1450875654, "last_edit_date": 1450875654, "creation_date": 1450875286, "answer_id": 34436185, "question_id": 34435542, "link": "https://stackoverflow.com/questions/34435542/testing-function-to-get-100-coverage/34436185#34436185", "title": "Testing function to get 100% coverage", "body": "<h1>The extremist way</h1>\n\n<p>Change the method signature to take as input a <code>func (string) (os.File, error)</code> and inject it while doing the tests.</p>\n\n<p>Something along these lines:</p>\n\n<pre><code>func countLines(files []string, open func(string) (*os.File, error)) int {\n    ...\n    f, err := open(e)\n    ...\n}\n</code></pre>\n\n<p>Then, you can do tests and inject a function that will returns what arrange you for the test.</p>\n\n<h1>The practical way</h1>\n\n<p>Simply create files under a <code>test</code> directory of your packages, and do you tests using these files.\nThe upside is that the method is simpler, the tests too. The first method can become quite bothersome when you have a lot of dependencies\u2026</p>\n"}], "owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 34436185, "answer_count": 1, "score": -1, "last_activity_date": 1450875654, "creation_date": 1450873040, "question_id": 34435542, "link": "https://stackoverflow.com/questions/34435542/testing-function-to-get-100-coverage", "title": "Testing function to get 100% coverage", "body": "<p>How would you write a test for the below function to get 100% coverage?</p>\n\n<pre><code>func countLines(files []string) int {\n  sum := 0\n  for _, e := range files {\n    f, err := os.Open(e)\n    if err != nil {\n      fmt.Fprintf(os.Stderr, \"err: %v\\n\", err)\n      continue\n    }\n    sum += countFileLine(f)\n    f.Close()\n  }\n  return sum\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 0, "creation_date": 1450872518, "post_id": 34435246, "comment_id": 56611525, "body": "Please provide sample of the file that you are trying to read."}, {"owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "reply_to_user": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 0, "creation_date": 1450872962, "post_id": 34435246, "comment_id": 56611785, "body": "@PrashantThakkar Example provided in original post now. Some Value Pairs may be in one record and not in the others and order is also not fixed."}, {"owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 0, "creation_date": 1450873499, "post_id": 34435246, "comment_id": 56612108, "body": "Thanks, For the error that you are getting it clearly says that &quot;)&quot; is missing. Corrected: if i := bytes.IndexAny(data, &quot;\\n\\n&quot;); i &gt;= 0 {"}, {"owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "reply_to_user": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 0, "creation_date": 1450873735, "post_id": 34435246, "comment_id": 56612249, "body": "@PrashantThakkar Ah no!! I have been staring at that code and did not pick it up. Ugh. Thanks for that. Is the way I am doing it the recommended way?"}], "answers": [{"comments": [{"owner": {"reputation": 152, "user_id": 5660064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q0D4N3-5iEE/AAAAAAAAAAI/AAAAAAAALB4/Lv6t4v1ANRg/photo.jpg?sz=128", "display_name": "Todd McLeod", "link": "https://stackoverflow.com/users/5660064/todd-mcleod"}, "edited": false, "score": 0, "creation_date": 1450999411, "post_id": 34438908, "comment_id": 56659516, "body": "Your code doesn&#39;t work. Check it out here on the Go playground: <a href=\"https://play.golang.org/p/v5aOCK7zRG\" rel=\"nofollow noreferrer\">play.golang.org/p/v5aOCK7zRG</a>"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 152, "user_id": 5660064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q0D4N3-5iEE/AAAAAAAAAAI/AAAAAAAALB4/Lv6t4v1ANRg/photo.jpg?sz=128", "display_name": "Todd McLeod", "link": "https://stackoverflow.com/users/5660064/todd-mcleod"}, "edited": false, "score": 0, "creation_date": 1451070397, "post_id": 34438908, "comment_id": 56673180, "body": "Thank you for mentioning it, I effectively inverted a condition while removing irrelevant context from my code. I fixed it, and added a check in the end to account for the end of file."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 2, "last_activity_date": 1451070307, "last_edit_date": 1451070307, "creation_date": 1450884668, "answer_id": 34438908, "question_id": 34435246, "link": "https://stackoverflow.com/questions/34435246/golang-reading-a-text-file-with-multi-line-rows/34438908#34438908", "title": "Golang: Reading a text file with multi-line rows", "body": "<p>You way is working, but I would advise you to use a <code>bufio.Scanner</code>, which defaults to scanning line by line.\nThen, you just start reading your file line by line and populating your struct. When encountering a blank line, put your struct into a slice and start with a new one.</p>\n\n<p>Here is an example taken from one of my open source projects that demonstrate it:</p>\n\n<pre><code>buffer := [][]string{}\nblock := []string{}\nscanner := bufio.NewScanner(strings.NewReader(data))\nfor scanner.Scan() {\n    l := scanner.Text()\n\n    if len(strings.TrimSpace(l)) != 0 {\n        block = append(block, l)\n        continue\n    }\n\n    // At this point, the script has reached an empty line,\n    // which means the block is ready to be processed.\n    // If the block is not empty, append it to the buffer and empty it.\n    if len(block) != 0 {\n        buffer = append(buffer, block)\n        block = []string{}\n    }\n}\n\nif len(block) != 0 {\n    buffer = append(buffer, block)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "edited": false, "score": 0, "creation_date": 1451042113, "post_id": 34458734, "comment_id": 56666436, "body": "Thanks very much for this!"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1451070692, "post_id": 34458734, "comment_id": 56673236, "body": "You basically took my answer and reposted it\u2026 you didn&#39;t even change the variables names to simulate solving the problem yourself. Pitiful\u2026"}, {"owner": {"reputation": 152, "user_id": 5660064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q0D4N3-5iEE/AAAAAAAAAAI/AAAAAAAALB4/Lv6t4v1ANRg/photo.jpg?sz=128", "display_name": "Todd McLeod", "link": "https://stackoverflow.com/users/5660064/todd-mcleod"}, "edited": false, "score": 0, "creation_date": 1451088887, "post_id": 34458734, "comment_id": 56677006, "body": "The intent is the solution, not IP rights or genius originality. Your code wasn&#39;t working. I provided another iteration. I pointed out where I felt my code could be improved. Somebody improved it, providing another iteration. Team work focused on the solution. To me, that&#39;s what stackoverflow is about: coders coming together to help each other. I&#39;m not trying to steal your code. Chill and play nice. Name calling is uncalled for."}], "tags": [], "owner": {"reputation": 152, "user_id": 5660064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q0D4N3-5iEE/AAAAAAAAAAI/AAAAAAAALB4/Lv6t4v1ANRg/photo.jpg?sz=128", "display_name": "Todd McLeod", "link": "https://stackoverflow.com/users/5660064/todd-mcleod"}, "is_accepted": true, "score": 1, "last_activity_date": 1450999312, "creation_date": 1450999312, "answer_id": 34458734, "question_id": 34435246, "link": "https://stackoverflow.com/questions/34435246/golang-reading-a-text-file-with-multi-line-rows/34458734#34458734", "title": "Golang: Reading a text file with multi-line rows", "body": "<p>Broken out. First understand scanning and make sure that is working:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    scanner := bufio.NewScanner(strings.NewReader(data))\n    for scanner.Scan() {\n        l := scanner.Text()\n        fmt.Println(l)\n\n    }\n\n}\n\nvar data = `\nName = \"John\"\nSurname = \"Smith\"\nVal1 = 700\nVal2 = 800\n\nName = \"Pete\"\nSurname = \"Jones\"\nVal1 = 555\nVal2 = 666\nVal3 = 444\n`\n</code></pre>\n\n<p>Here is <a href=\"https://play.golang.org/p/FFP8bfO3AQ\" rel=\"nofollow\">the code on the Go playground</a>.</p>\n\n<p>Next, gather the data you need into a slice. There is probably a way to check end of file, EOF, but I wasn't able to find it. This is what I came up with and this works:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    buffer := [][]string{}\n    block := []string{}\n    scanner := bufio.NewScanner(strings.NewReader(data))\n    for scanner.Scan() {\n        l := scanner.Text()\n\n        if len(l) != 0 {\n            block = append(block, l)\n            continue\n        }\n\n        if len(l) == 0 &amp;&amp; len(block) != 0 {\n            buffer = append(buffer, block)\n            block = []string{}\n            continue\n        }\n\n        if len(l) == 0 {\n            block = []string{}\n            continue\n        }\n\n    }\n\n    if len(block) != 0 {\n        buffer = append(buffer, block)\n        block = []string{}\n    }\n\n    fmt.Println(\"PRINTING BUFFER - END OF PROGRAM - ALL DATA PROCESSED:\", buffer)\n\n}\n\nvar data = `\nName = \"John\"\nSurname = \"Smith\"\nVal1 = 700\nVal2 = 800\n\nName = \"Pete\"\nSurname = \"Jones\"\nVal1 = 555\nVal2 = 666\nVal3 = 444\n`\n</code></pre>\n\n<p>Here is <a href=\"https://play.golang.org/p/Cq26494Z-_\" rel=\"nofollow\">the code on the playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 314, "user_id": 5716193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9QW0.jpg?s=128&g=1", "display_name": "Amnon", "link": "https://stackoverflow.com/users/5716193/amnon"}, "is_accepted": false, "score": 1, "last_activity_date": 1451032849, "last_edit_date": 1451032849, "creation_date": 1451028576, "answer_id": 34460912, "question_id": 34435246, "link": "https://stackoverflow.com/questions/34435246/golang-reading-a-text-file-with-multi-line-rows/34460912#34460912", "title": "Golang: Reading a text file with multi-line rows", "body": "<p>bufio.Scan() returns false on EOF.\nWe will return a second 'ok' argument, so our caller can tell if we have\nhit the end of our input.</p>\n\n<p>Best to accumulate our record in a slice of strings, and concatenate at the end.\nThe obvious way of appending each line in turn to the result string will work, but is O(n^2) in the number of lines.</p>\n\n<p>Putting it all together:</p>\n\n<pre><code>func ReadBlock(scanner *bufio.Scanner) (string, bool) {\n    var o []string\n    if scanner.Scan() == false {\n        return \"\", false\n    }\n\n    for len(scanner.Text()) &gt; 0 {\n        o = append(o, scanner.Text())\n        if scanner.Scan() == false {\n            break\n        }\n    }\n    return strings.Join(o, \" \"), true\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/C_fB8iaYJo\" rel=\"nofollow\">https://play.golang.org/p/C_fB8iaYJo</a></p>\n\n<p>p.s. looking at your input, I suspect you would want to return the result as a map rather than a concatenated string.</p>\n"}, {"tags": [], "owner": {"reputation": 627, "user_id": 4689430, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/SJU8y.png?s=128&g=1", "display_name": "elixir", "link": "https://stackoverflow.com/users/4689430/elixir"}, "is_accepted": false, "score": 2, "last_activity_date": 1451036660, "last_edit_date": 1495542331, "creation_date": 1451036660, "answer_id": 34461775, "question_id": 34435246, "link": "https://stackoverflow.com/questions/34435246/golang-reading-a-text-file-with-multi-line-rows/34461775#34461775", "title": "Golang: Reading a text file with multi-line rows", "body": "<p>Here is an alternate approach to do the same, using <code>bufio.Reader</code>. The logic is almost similar to <a href=\"https://stackoverflow.com/users/3472656/elwinar\">Elwiner</a>'s answer. </p>\n\n<p><code>myReadLine</code> function below uses <code>bufio.Reader</code> to read the next multiline entry in the file.</p>\n\n<pre><code>func myReadLine(file *os.File, reader *bufio.Reader) (lines []string, err error){\n  for {\n    line, _, err := reader.ReadLine()\n    if err != nil || len(line) == 0 {\n      break\n    }\n    lines = append(lines, string(line))\n  }\n  return lines, err\n}\n</code></pre>\n\n<p>The below code sample illustrates sample usage of the above function:</p>\n\n<pre><code>reader := bufio.NewReader(file)\nfor {\n    lines, err := myReadLine(file, reader)\n    if err != nil || len(lines) == 0 { \n        break \n    }\n    fmt.Println(lines)\n}\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4702, "favorite_count": 1, "accepted_answer_id": 34458734, "answer_count": 4, "score": 0, "last_activity_date": 1451070307, "creation_date": 1450872051, "last_edit_date": 1450874385, "question_id": 34435246, "link": "https://stackoverflow.com/questions/34435246/golang-reading-a-text-file-with-multi-line-rows", "title": "Golang: Reading a text file with multi-line rows", "body": "<p>I have a text file with multi-line rows, delimited by a blank line. What would be the best way to read that row for row in Go?</p>\n\n<p>I think I may have to use a Scanner with my own Split function, but just wondering if there is a better/easier way that I am missing.</p>\n\n<p>I have tried using my own Splitfunc based on bufio.ScanLines:</p>\n\n<pre><code>func MyScanLines(data []byte, atEOF bool) (advance int, token []byte,    err error) {\n    if atEOF &amp;&amp; len(data) == 0 {\n            return 0, nil, nil\n    }\n    if i := bytes.IndexAny(data, \"\\n\\n\"); i &gt;= 0 {\n            return i + 1, dropCR(data[0:i]), nil\n    }\n    if atEOF {\n            return len(data), dropCR(data), nil\n    }\n    return 0, nil, nil\n}\n</code></pre>\n\n<p>But I get an error on the IndexAny call:\n\"syntax error: unexpected semicolon or newline, expecting )\" - Fixed that</p>\n\n<p>Update: Fixed the syntax error above as suggested, but I only get the first line returned. I am reading the file as follows:</p>\n\n<pre><code>scanner.Split(MyScanLines)\nscanner.Scan()\nfmt.Println(scanner.Text())\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>Example of test file I am trying to read:</p>\n\n<pre><code>Name = \"John\"\nSurname = \"Smith\"\nVal1 = 700\nVal2 = 800\n\nName = \"Pete\"\nSurname = \"Jones\"\nVal1 = 555\nVal2 = 666\nVal3 = 444\n\n .\n .\n .\n</code></pre>\n"}, {"tags": ["unit-testing", "go", "gorilla", "testify"], "answers": [{"comments": [{"owner": {"reputation": 2146, "user_id": 1972313, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/E5SGl.png?s=128&g=1", "display_name": "Sebastian-Lauren\u0163iu Plesciuc", "link": "https://stackoverflow.com/users/1972313/sebastian-lauren%c5%a3iu-plesciuc"}, "edited": false, "score": 0, "creation_date": 1450879497, "post_id": 34437345, "comment_id": 56615601, "body": "Isn&#39;t this a functional test though? I was trying to do a unit test, basically just call the function as you would any function with some values you create and check the result."}, {"owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "reply_to_user": {"reputation": 2146, "user_id": 1972313, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/E5SGl.png?s=128&g=1", "display_name": "Sebastian-Lauren\u0163iu Plesciuc", "link": "https://stackoverflow.com/users/1972313/sebastian-lauren%c5%a3iu-plesciuc"}, "edited": false, "score": 0, "creation_date": 1450879773, "post_id": 34437345, "comment_id": 56615758, "body": "It is. But in my opinion, to test a network server, functional test is enough. In go, I do unit testing mostly for complicated logic."}, {"owner": {"reputation": 2146, "user_id": 1972313, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/E5SGl.png?s=128&g=1", "display_name": "Sebastian-Lauren\u0163iu Plesciuc", "link": "https://stackoverflow.com/users/1972313/sebastian-lauren%c5%a3iu-plesciuc"}, "edited": false, "score": 0, "creation_date": 1450881034, "post_id": 34437345, "comment_id": 56616471, "body": "Ok. Thank you for the tip but that doesn&#39;t really answer the question. If I were to NOT use URL parameters with <code>gorilla&#47;mux</code> the unit tests would work and essentially I could conducts tests in parallel for each endpoint handler function without having to go through an actual http server. If I were to only use functional/acceptance tests I would avoid the actual problem that <code>gorilla&#47;mux</code> has and my tests would take longer. I am planning to use both functional and unit tests in my project."}, {"owner": {"reputation": 2146, "user_id": 1972313, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/E5SGl.png?s=128&g=1", "display_name": "Sebastian-Lauren\u0163iu Plesciuc", "link": "https://stackoverflow.com/users/1972313/sebastian-lauren%c5%a3iu-plesciuc"}, "edited": false, "score": 0, "creation_date": 1450881143, "post_id": 34437345, "comment_id": 56616527, "body": "Let me be clear, I can use a JSON in a POST message to achieve the same thing and the unit tests will work. But that would avoid the problem, not solve it."}], "tags": [], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "is_accepted": false, "score": 2, "last_activity_date": 1450879316, "creation_date": 1450879316, "answer_id": 34437345, "question_id": 34435185, "link": "https://stackoverflow.com/questions/34435185/unit-testing-for-functions-that-use-gorilla-mux-url-parameters/34437345#34437345", "title": "Unit testing for functions that use gorilla/mux URL parameters", "body": "<p>In golang, I have slightly different approach to testing. </p>\n\n<p>I slightly rewrite your lib code:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"net/http\"\n\n        \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n        startServer()\n}\n\nfunc startServer() {\n        mainRouter := mux.NewRouter().StrictSlash(true)\n        mainRouter.HandleFunc(\"/test/{mystring}\", GetRequest).Name(\"/test/{mystring}\").Methods(\"GET\")\n        http.Handle(\"/\", mainRouter)\n\n        err := http.ListenAndServe(\":8080\", mainRouter)\n        if err != nil {\n                fmt.Println(\"Something is wrong : \" + err.Error())\n        }\n}\n\nfunc GetRequest(w http.ResponseWriter, r *http.Request) {\n        vars := mux.Vars(r)\n        myString := vars[\"mystring\"]\n\n        w.WriteHeader(http.StatusOK)\n        w.Header().Set(\"Content-Type\", \"text/plain\")\n        w.Write([]byte(myString))\n}\n</code></pre>\n\n<p>And here is test for it:</p>\n\n<pre><code>package main\n\nimport (\n        \"io/ioutil\"\n        \"net/http\"\n        \"testing\"\n        \"time\"\n\n        \"github.com/stretchr/testify/assert\"\n)\n\nfunc TestGetRequest(t *testing.T) {\n        go startServer()\n        client := &amp;http.Client{\n                Timeout: 1 * time.Second,\n        }\n\n        r, _ := http.NewRequest(\"GET\", \"http://localhost:8080/test/abcd\", nil)\n\n        resp, err := client.Do(r)\n        if err != nil {\n                panic(err)\n        }\n        assert.Equal(t, http.StatusOK, resp.StatusCode)\n        body, err := ioutil.ReadAll(resp.Body)\n        if err != nil {\n                panic(err)\n        }\n        assert.Equal(t, []byte(\"abcd\"), body)\n}\n</code></pre>\n\n<p>I think this is a better approach - you are really testing what you wrote since its very easy to start/stop listeners in go!</p>\n"}, {"comments": [{"owner": {"reputation": 2146, "user_id": 1972313, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/E5SGl.png?s=128&g=1", "display_name": "Sebastian-Lauren\u0163iu Plesciuc", "link": "https://stackoverflow.com/users/1972313/sebastian-lauren%c5%a3iu-plesciuc"}, "edited": false, "score": 0, "creation_date": 1451056371, "post_id": 34456848, "comment_id": 56669743, "body": "Thank you. I think I&#39;ll use option 3. However <code>gorilla&#47;mux</code> should fix this to make unit test possible."}, {"owner": {"reputation": 2265, "user_id": 148145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e83d41789fe69fc6b149992cc0abc4e7?s=128&d=identicon&r=PG", "display_name": "xentek", "link": "https://stackoverflow.com/users/148145/xentek"}, "edited": false, "score": 0, "creation_date": 1489605032, "post_id": 34456848, "comment_id": 72749118, "body": "I got around this by inspecting the way gorilla/mux did testing in their own package here, and put my own assertion inside the handler where they were checking the value of <code>vars</code>: <a href=\"https://github.com/gorilla/mux/blob/master/context_native_test.go#L22\" rel=\"nofollow noreferrer\">github.com/gorilla/mux/blob/master/context_native_test.go#L2&zwnj;&#8203;2</a>"}, {"owner": {"reputation": 1474, "user_id": 2134124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCNRz.jpg?s=128&g=1", "display_name": "Dineshs91", "link": "https://stackoverflow.com/users/2134124/dineshs91"}, "edited": false, "score": 0, "creation_date": 1543923929, "post_id": 34456848, "comment_id": 94085264, "body": "Option 3 gives this error <code>(type VarsHandler) as type func(http.ResponseWriter, *http.Request) in argument to router.HandleFunc</code>"}, {"owner": {"reputation": 1474, "user_id": 2134124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCNRz.jpg?s=128&g=1", "display_name": "Dineshs91", "link": "https://stackoverflow.com/users/2134124/dineshs91"}, "edited": false, "score": 2, "creation_date": 1544028051, "post_id": 34456848, "comment_id": 94133523, "body": "I am using <code>mux.SetURLVars()</code>"}], "tags": [], "owner": {"reputation": 3311, "user_id": 61363, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30ed41f682f716613fe62a0831f522dd?s=128&d=identicon&r=PG", "display_name": "del-boy", "link": "https://stackoverflow.com/users/61363/del-boy"}, "is_accepted": true, "score": 24, "last_activity_date": 1451085460, "last_edit_date": 1451085460, "creation_date": 1450983329, "answer_id": 34456848, "question_id": 34435185, "link": "https://stackoverflow.com/questions/34435185/unit-testing-for-functions-that-use-gorilla-mux-url-parameters/34456848#34456848", "title": "Unit testing for functions that use gorilla/mux URL parameters", "body": "<p>Trouble is, even when you use <code>0</code> as value to set context values, it is not same value that <code>mux.Vars()</code> reads. <code>mux.Vars()</code> is using <code>varsKey</code> (as you already saw) which is of type <code>contextKey</code> and not <code>int</code>. </p>\n\n<p>Sure, <code>contextKey</code> is defined as:</p>\n\n<pre><code>type contextKey int\n</code></pre>\n\n<p>which means that it has int as underlying object, but type plays part when comparing values in go, so <code>int(0) != contextKey(0)</code>. </p>\n\n<p>I do not see how you could trick gorilla mux or context into returning your values. </p>\n\n<hr>\n\n<p>That being said, couple of ways to test this comes to mind (note that code below is untested, I have typed it directly here, so there might be some stupid errors):</p>\n\n<ol>\n<li>As somebody suggested, run a server and send HTTP requests to it.</li>\n<li><p>Instead of running server, just use gorilla mux Router in your tests. In this scenario, you would have one router that you pass to <code>ListenAndServe</code>, but you could also use that same router instance in tests and call <code>ServeHTTP</code> on it. Router would take care of setting context values and they would be available in your handlers.</p>\n\n<pre><code>func Router() *mux.Router {\n    r := mux.Router()\n    r.HandleFunc(\"/employees/{1}\", GetRequest)\n    (...)\n    return r \n}\n</code></pre>\n\n<p>somewhere in main function you would do something like this:</p>\n\n<pre><code>http.Handle(\"/\", Router())\n</code></pre>\n\n<p>and in your tests you can do:</p>\n\n<pre><code>func TestGetRequest(t *testing.T) {\n    r := http.NewRequest(\"GET\", \"employees/1\", nil)\n    w := httptest.NewRecorder()\n\n    Router().ServeHTTP(w, r)\n    // assertions\n}\n</code></pre></li>\n<li><p>Wrap your handlers so that they accept URL parameters as third argument and wrapper should call <code>mux.Vars()</code> and pass URL parameters to handler.</p>\n\n<p>With this solution, your handlers would have signature:</p>\n\n<pre><code>type VarsHandler func (w http.ResponseWriter, r *http.Request, vars map[string]string)\n</code></pre>\n\n<p>and you would have to adapt calls to it to conform to <code>http.Handler</code> interface:</p>\n\n<pre><code>func (vh VarsHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\n    vh(w, r, vars)\n}\n</code></pre>\n\n<p>To register handler you would use:</p>\n\n<pre><code>func GetRequest(w http.ResponseWriter, r *http.Request, vars map[string]string) {\n    // process request using vars\n}\n\nmainRouter := mux.NewRouter().StrictSlash(true)\nmainRouter.HandleFunc(\"/test/{mystring}\", VarsHandler(GetRequest)).Name(\"/test/{mystring}\").Methods(\"GET\")\n</code></pre></li>\n</ol>\n\n<p>Which one you use is matter of personal preference. Personally, I would probably go with option 2 or 3, with slight preference towards 3.</p>\n"}, {"tags": [], "owner": {"reputation": 11390, "user_id": 167251, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/fGNwt.jpg?s=128&g=1", "display_name": "larsmoa", "link": "https://stackoverflow.com/users/167251/larsmoa"}, "is_accepted": false, "score": 1, "last_activity_date": 1457867748, "last_edit_date": 1457867748, "creation_date": 1457861926, "answer_id": 35968707, "question_id": 34435185, "link": "https://stackoverflow.com/questions/34435185/unit-testing-for-functions-that-use-gorilla-mux-url-parameters/35968707#35968707", "title": "Unit testing for functions that use gorilla/mux URL parameters", "body": "<p>I use the following helper function to invoke handlers from unit tests:</p>\n\n<pre><code>func InvokeHandler(handler http.Handler, routePath string,\n    w http.ResponseWriter, r *http.Request) {\n\n    // Add a new sub-path for each invocation since\n    // we cannot (easily) remove old handler\n    invokeCount++\n    router := mux.NewRouter()\n    http.Handle(fmt.Sprintf(\"/%d\", invokeCount), router)\n\n    router.Path(routePath).Handler(handler)\n\n    // Modify the request to add \"/%d\" to the request-URL\n    r.URL.RawPath = fmt.Sprintf(\"/%d%s\", invokeCount, r.URL.RawPath)\n    router.ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>Because there is no (easy) way to deregister HTTP handlers and multiple calls to <code>http.Handle</code> for the same route will fail. Therefore the function adds a new route (e.g. <code>/1</code> or <code>/2</code>) to ensure the path is unique. This magic is necessary to use the function in multiple unit test in the same process.</p>\n\n<p>To test your <code>GetRequest</code>-function:</p>\n\n<pre><code>func TestGetRequest(t *testing.T) {\n    t.Parallel()\n\n    r, _ := http.NewRequest(\"GET\", \"/test/abcd\", nil)\n    w := httptest.NewRecorder()\n\n    InvokeHandler(http.HandlerFunc(GetRequest), \"/test/{mystring}\", w, r)\n\n    assert.Equal(t, http.StatusOK, w.Code)\n    assert.Equal(t, []byte(\"abcd\"), w.Body.Bytes())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26092, "user_id": 824377, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e600bd229c588891a7616f303e30efd9?s=128&d=identicon&r=PG", "display_name": "AJcodez", "link": "https://stackoverflow.com/users/824377/ajcodez"}, "is_accepted": false, "score": 0, "last_activity_date": 1474603654, "creation_date": 1474603654, "answer_id": 39652461, "question_id": 34435185, "link": "https://stackoverflow.com/questions/34435185/unit-testing-for-functions-that-use-gorilla-mux-url-parameters/39652461#39652461", "title": "Unit testing for functions that use gorilla/mux URL parameters", "body": "<p>The issue is you can't set vars.</p>\n\n<pre><code>var r *http.Request\nvar key, value string\n\n// runtime panic, map not initialized\nmux.Vars(r)[key] = value\n</code></pre>\n\n<p>The solution is to create a new router on each test.</p>\n\n<pre><code>// api/route.go\n\npackage api\n\nimport (\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n)\n\ntype Route struct {\n    http.Handler\n    Method string\n    Path string\n}\n\nfunc (route *Route) Test(w http.ResponseWriter, r *http.Request) {\n    m := mux.NewRouter()\n    m.Handle(route.Path, route).Methods(route.Method)\n    m.ServeHTTP(w, r)\n}\n</code></pre>\n\n<p>In your handler file.</p>\n\n<pre><code>// api/employees/show.go\n\npackage employees\n\nimport (\n    \"github.com/gorilla/mux\"\n)\n\nfunc Show(db *sql.DB) *api.Route {\n    h := func(w http.ResponseWriter, r http.Request) {\n        username := mux.Vars(r)[\"username\"]\n        // .. etc ..\n    }\n    return &amp;api.Route{\n        Method: \"GET\",\n        Path: \"/employees/{username}\",\n\n        // Maybe apply middleware too, who knows.\n        Handler: http.HandlerFunc(h),\n    }\n}\n</code></pre>\n\n<p>In your tests.</p>\n\n<pre><code>// api/employees/show_test.go\n\npackage employees\n\nimport (\n    \"testing\"\n)\n\nfunc TestShow(t *testing.T) {\n    w := httptest.NewRecorder()\n    r, err := http.NewRequest(\"GET\", \"/employees/ajcodez\", nil)\n    Show(db).Test(w, r)\n}\n</code></pre>\n\n<p>You can use <code>*api.Route</code> wherever an <code>http.Handler</code> is needed. </p>\n"}, {"comments": [{"owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "edited": false, "score": 2, "creation_date": 1604361604, "post_id": 48933356, "comment_id": 114319539, "body": "This should be the accepted answer. Saved my behind! Thanks!"}, {"owner": {"reputation": 98, "user_id": 5823795, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153284869035796/picture?type=large", "display_name": "TheArcticWalrus", "link": "https://stackoverflow.com/users/5823795/thearcticwalrus"}, "edited": false, "score": 0, "creation_date": 1613530617, "post_id": 48933356, "comment_id": 117100739, "body": "Yeah, this works really well and does not bog down the package with useless functions"}], "tags": [], "owner": {"reputation": 531, "user_id": 4979187, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Iif12FZrP2w/AAAAAAAAAAI/AAAAAAAAAA4/212OSJiQyfw/photo.jpg?sz=128", "display_name": "Luiz Fernando", "link": "https://stackoverflow.com/users/4979187/luiz-fernando"}, "is_accepted": false, "score": 53, "last_activity_date": 1560317844, "last_edit_date": 1560317844, "creation_date": 1519319307, "answer_id": 48933356, "question_id": 34435185, "link": "https://stackoverflow.com/questions/34435185/unit-testing-for-functions-that-use-gorilla-mux-url-parameters/48933356#48933356", "title": "Unit testing for functions that use gorilla/mux URL parameters", "body": "<p><code>gorilla/mux</code> provides the <a href=\"https://www.gorillatoolkit.org/pkg/mux#SetURLVars\" rel=\"noreferrer\"><code>SetURLVars</code></a> function for testing purposes, which you can use to inject your mock <code>vars</code>.</p>\n\n<pre><code>func TestGetRequest(t *testing.T) {\n    t.Parallel()\n\n    r, _ := http.NewRequest(\"GET\", \"/test/abcd\", nil)\n    w := httptest.NewRecorder()\n\n    //Hack to try to fake gorilla/mux vars\n    vars := map[string]string{\n        \"mystring\": \"abcd\",\n    }\n\n    // CHANGE THIS LINE!!!\n    r = mux.SetURLVars(r, vars)\n\n    GetRequest(w, r)\n\n    assert.Equal(t, http.StatusOK, w.Code)\n    assert.Equal(t, []byte(\"abcd\"), w.Body.Bytes())\n}\n</code></pre>\n"}], "owner": {"reputation": 2146, "user_id": 1972313, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/E5SGl.png?s=128&g=1", "display_name": "Sebastian-Lauren\u0163iu Plesciuc", "link": "https://stackoverflow.com/users/1972313/sebastian-lauren%c5%a3iu-plesciuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15762, "favorite_count": 8, "accepted_answer_id": 34456848, "answer_count": 5, "score": 35, "last_activity_date": 1560317844, "creation_date": 1450871821, "last_edit_date": 1450879347, "question_id": 34435185, "link": "https://stackoverflow.com/questions/34435185/unit-testing-for-functions-that-use-gorilla-mux-url-parameters", "title": "Unit testing for functions that use gorilla/mux URL parameters", "body": "<p>Here's what I'm trying to do :</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n    mainRouter := mux.NewRouter().StrictSlash(true)\n    mainRouter.HandleFunc(\"/test/{mystring}\", GetRequest).Name(\"/test/{mystring}\").Methods(\"GET\")\n    http.Handle(\"/\", mainRouter)\n\n    err := http.ListenAndServe(\":8080\", mainRouter)\n    if err != nil {\n        fmt.Println(\"Something is wrong : \" + err.Error())\n    }\n}\n\nfunc GetRequest(w http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\n    myString := vars[\"mystring\"]\n\n    w.WriteHeader(http.StatusOK)\n    w.Header().Set(\"Content-Type\", \"text/plain\")\n    w.Write([]byte(myString))\n}\n</code></pre>\n\n<p>This creates a basic http server listening on port <code>8080</code> that echoes the URL parameter given in the path. So for <code>http://localhost:8080/test/abcd</code> it will write back a response containing <code>abcd</code> in the response body.</p>\n\n<p>The unit test for the <code>GetRequest()</code> function is in <strong>main_test.go</strong> :</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"net/http/httptest\"\n    \"testing\"\n\n    \"github.com/gorilla/context\"\n    \"github.com/stretchr/testify/assert\"\n)\n\nfunc TestGetRequest(t *testing.T) {\n    t.Parallel()\n\n    r, _ := http.NewRequest(\"GET\", \"/test/abcd\", nil)\n    w := httptest.NewRecorder()\n\n    //Hack to try to fake gorilla/mux vars\n    vars := map[string]string{\n        \"mystring\": \"abcd\",\n    }\n    context.Set(r, 0, vars)\n\n    GetRequest(w, r)\n\n    assert.Equal(t, http.StatusOK, w.Code)\n    assert.Equal(t, []byte(\"abcd\"), w.Body.Bytes())\n}\n</code></pre>\n\n<p>The test result is  :</p>\n\n<pre><code>--- FAIL: TestGetRequest (0.00s)\n    assertions.go:203: \n\n    Error Trace:    main_test.go:27\n\n    Error:      Not equal: []byte{0x61, 0x62, 0x63, 0x64} (expected)\n                    != []byte(nil) (actual)\n\n            Diff:\n            --- Expected\n            +++ Actual\n            @@ -1,4 +1,2 @@\n            -([]uint8) (len=4 cap=8) {\n            - 00000000  61 62 63 64                                       |abcd|\n            -}\n            +([]uint8) &lt;nil&gt;\n\n\nFAIL\nFAIL    command-line-arguments  0.045s\n</code></pre>\n\n<p>The question is how do I fake the <code>mux.Vars(r)</code> for the unit tests?\nI've found some discussions <a href=\"https://groups.google.com/d/topic/gorilla-web/TKOE2I0116Y\">here</a> but the proposed solution no longer works. The proposed solution was :</p>\n\n<pre><code>func buildRequest(method string, url string, doctype uint32, docid uint32) *http.Request {\n    req, _ := http.NewRequest(method, url, nil)\n    req.ParseForm()\n    var vars = map[string]string{\n        \"doctype\": strconv.FormatUint(uint64(doctype), 10),\n        \"docid\":   strconv.FormatUint(uint64(docid), 10),\n    }\n    context.DefaultContext.Set(req, mux.ContextKey(0), vars) // mux.ContextKey exported\n    return req\n}\n</code></pre>\n\n<p>This solution doesn't work since <code>context.DefaultContext</code> and <code>mux.ContextKey</code> no longer exist.</p>\n\n<p>Another proposed solution would be to alter your code so that the request functions also accept a <code>map[string]string</code> as a third parameter. Other solutions include actually starting a server and building the request and sending it directly to the server. In my opinion this would defeat the purpose of unit testing, turning them essentially into functional tests.</p>\n\n<p>Considering the fact the the linked thread is from 2013. Are there any other options?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>So I've read the <code>gorilla/mux</code> source code, and according to <code>mux.go</code> the function <code>mux.Vars()</code> is defined <a href=\"https://github.com/gorilla/mux/blob/master/mux.go#L306\">here</a> like this :</p>\n\n<pre><code>// Vars returns the route variables for the current request, if any.\nfunc Vars(r *http.Request) map[string]string {\n    if rv := context.Get(r, varsKey); rv != nil {\n        return rv.(map[string]string)\n    }\n    return nil\n}\n</code></pre>\n\n<p>The value of <code>varsKey</code> is defined as <code>iota</code> <a href=\"https://github.com/gorilla/mux/blob/master/mux.go#L302\">here</a>. So essentially, the key value is <code>0</code>. I've written a small test app to check this :\n<strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n    \"github.com/gorilla/context\"\n)\n\nfunc main() {\n    r, _ := http.NewRequest(\"GET\", \"/test/abcd\", nil)\n    vars := map[string]string{\n        \"mystring\": \"abcd\",\n    }\n    context.Set(r, 0, vars)\n    what := Vars(r)\n\n    for key, value := range what {\n        fmt.Println(\"Key:\", key, \"Value:\", value)\n    }\n\n    what2 := mux.Vars(r)\n    fmt.Println(what2)\n\n    for key, value := range what2 {\n        fmt.Println(\"Key:\", key, \"Value:\", value)\n    }\n\n}\n\nfunc Vars(r *http.Request) map[string]string {\n    if rv := context.Get(r, 0); rv != nil {\n        return rv.(map[string]string)\n    }\n    return nil\n}\n</code></pre>\n\n<p>Which when run, outputs : </p>\n\n<pre><code>Key: mystring Value: abcd\nmap[]\n</code></pre>\n\n<p>Which makes me wonder why the test doesn't work and why the direct call to <code>mux.Vars</code> doesn't work.</p>\n"}, {"tags": ["http", "authentication", "go"], "comments": [{"owner": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 2, "creation_date": 1450869831, "post_id": 34434374, "comment_id": 56609929, "body": "Is any error returned? As a sidenote, do not name the actual error &quot;error&quot;, but rather &quot;err&quot;, creates less confusion. For debug measures, try POSTing to a local server, where you can see what you get, also try that with the Java and C++ implementations for comparison."}, {"owner": {"reputation": 1, "user_id": 5710780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddb36d2de9e2d9de54c9f79d1a7be73?s=128&d=identicon&r=PG&f=1", "display_name": "Taaeem", "link": "https://stackoverflow.com/users/5710780/taaeem"}, "reply_to_user": {"reputation": 818, "user_id": 5292835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f2a5019f9a977706135c3f8246bba1?s=128&d=identicon&r=PG&f=1", "display_name": "mrd0ll4r", "link": "https://stackoverflow.com/users/5292835/mrd0ll4r"}, "edited": false, "score": 0, "creation_date": 1450885415, "post_id": 34434374, "comment_id": 56619105, "body": "No error is returned and I compared the requests of node and go and their identical as far as i can tell."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450944540, "post_id": 34434374, "comment_id": 56640497, "body": "i think capture the http (wireshark) must help finding out the problem."}], "owner": {"reputation": 1, "user_id": 5710780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddb36d2de9e2d9de54c9f79d1a7be73?s=128&d=identicon&r=PG&f=1", "display_name": "Taaeem", "link": "https://stackoverflow.com/users/5710780/taaeem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450869108, "creation_date": 1450869108, "question_id": 34434374, "link": "https://stackoverflow.com/questions/34434374/authentication-with-net-http-in-go-isnt-working", "title": "Authentication with net/http in Go isn&#39;t working", "body": "<p>I have a problem, I have a server that logs into another server and gets some data.\nThe login works in NodeJS like this: </p>\n\n<pre><code>var data = {\n    login_act: \"username\",\n    login_pwd: \"password\"\n};\nrequest.post({url: 'https://example.com', form: data}, callback())`\n</code></pre>\n\n<p>and in Java like this:</p>\n\n<pre><code>try {\n    URL mUrl = new URL(\"https://example.com\");\n\n    HttpURLConnection connection = (HttpURLConnection) mUrl.openConnection();\n    connection.setDoOutput(true);\n    connection.setInstanceFollowRedirects(false);\n\n    String urlParameters  = \"login_act=\" + username + \"&amp;login_pwd=\" + password;\n    byte[] postData       = urlParameters.getBytes(\"UTF-8\");\n\n    connection.setRequestMethod(\"POST\");\n    connection.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\n    try( DataOutputStream wr = new DataOutputStream( connection.getOutputStream())) {\n        wr.write( postData );\n    }\n}\n</code></pre>\n\n<p>I also made a C++ implementation of the same situation:</p>\n\n<pre><code>QNetworkAccessManager *vManager = new QNetworkAccessManager;\nQNetworkRequest req;\nreq.setUrl(QUrl(\"https://example.com\"));\nreq.setHeader(QNetworkRequest::ContentTypeHeader, \"application/x-www-form-urlencoded\");\nQByteArray postData;\npostData.append(\"login_act=\" + username + \"&amp;\");\npostData.append(\"login_pwd=\" + password + \"\");\n\nconnect(vManager, SIGNAL(finished(QNetworkReply*)), this, SLOT(authFinished(QNetworkReply*)));\nQNetworkReply *reply = vManager-&gt;post(req, postData);\nreply-&gt;ignoreSslErrors();\n</code></pre>\n\n<p>But when I try to do the same in Go it refuses to log in:</p>\n\n<pre><code>resp, error := http.PostForm(\"https://example.com\", url.Values{\"login_act\": {\"username\"}, \"login_pwd\": {\"password\"}})\n</code></pre>\n\n<p>The site is build in such a way that, when login fails it just returns the standard site with the login form and if login suceeds it returns a 302 statuscode.\nMaybe someone can help me I'm new to the go programming language and maybe I just miss something important.\nThanks in advance.</p>\n"}, {"tags": ["parse-platform", "go"], "comments": [{"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1450892174, "post_id": 34433351, "comment_id": 56623174, "body": "Without more information, it&#39;s hard to tell where the error might be. The code for verifying checksum appears to be sound, so it&#39;s likely that the file you&#39;ve downloaded <i>actually</i> doesn&#39;t match the checksum this code expects. Where the checksum is coming from isn&#39;t apparent from the linked file."}, {"owner": {"reputation": 4739, "user_id": 1348187, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/dZMOO.jpg?s=128&g=1", "display_name": "Rafael Ruiz Mu&#241;oz", "link": "https://stackoverflow.com/users/1348187/rafael-ruiz-mu%c3%b1oz"}, "reply_to_user": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1450895166, "post_id": 34433351, "comment_id": 56624722, "body": "Unfortunately I can&#39;t tell anything else. Perhaps I could :("}, {"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1450902833, "post_id": 34433351, "comment_id": 56628273, "body": "You could always build your own &quot;verbose&quot; version from source, adding in logging at critical points. For example, you might output the expected and actual checksums to see if they match the file that has been downloaded."}], "owner": {"reputation": 4739, "user_id": 1348187, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/dZMOO.jpg?s=128&g=1", "display_name": "Rafael Ruiz Mu&#241;oz", "link": "https://stackoverflow.com/users/1348187/rafael-ruiz-mu%c3%b1oz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450872039, "creation_date": 1450865803, "last_edit_date": 1592644375, "question_id": 34433351, "link": "https://stackoverflow.com/questions/34433351/strange-error-message-using-the-parse-command-line-tool", "title": "Strange error message using the Parse command line tool", "body": "<p>I'm trying to execute <code>parse download</code> with the Parse.com's command line tool and I'm getting this error message:</p>\n<blockquote>\n<p>Failed to download Cloud Code.</p>\n<p>Invalid checksum, try again</p>\n</blockquote>\n<p>I can't explain anymore because this happened suddenly and there's not any documentation about that <a href=\"https://github.com/ParsePlatform/parse-cli/blob/master/parsecmd/download.go\" rel=\"nofollow noreferrer\">but this piece of code</a>.</p>\n<p>What am I doing wrong?</p>\n<p>Thank you.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 2, "creation_date": 1450864969, "post_id": 34432977, "comment_id": 56606887, "body": "The <code>i</code> in the first loop is redundant. You could/should use a <code>for{}</code> in the <code>pinger()</code> function as well."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 2, "creation_date": 1450865548, "post_id": 34432977, "comment_id": 56607250, "body": "Where did you find this example with <code>i</code>? Don&#39;t look there ever again."}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 1440666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OKlp9.jpg?s=128&g=1", "display_name": "Kevin LE GOFF", "link": "https://stackoverflow.com/users/1440666/kevin-le-goff"}, "edited": false, "score": 0, "creation_date": 1450880915, "post_id": 34433109, "comment_id": 56616398, "body": "Thanks for the answer !"}], "tags": [], "owner": {"reputation": 33452, "user_id": 296452, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/15ba69c4116f6646b861202252d953ab?s=128&d=identicon&r=PG", "display_name": "Andreas Wederbrand", "link": "https://stackoverflow.com/users/296452/andreas-wederbrand"}, "is_accepted": false, "score": 2, "last_activity_date": 1450865118, "creation_date": 1450865118, "answer_id": 34433109, "question_id": 34432977, "link": "https://stackoverflow.com/questions/34432977/difference-between-for-and-for-i-0-i-in-go/34433109#34433109", "title": "Difference between for{} and for i=0; i++ {} in go", "body": "<p>The \"best\" way is to write code that is easy to read and maintain. Your variable <code>i</code> in <code>func pinger</code> serves no purpose and someone stumbling upon that code later on will have a hard time understand what it's for.</p>\n\n<p>I would just do </p>\n\n<pre><code>func pinger(c chan string) {\n  for {\n    c &lt;- \"ping\" \n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 713, "user_id": 1440666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OKlp9.jpg?s=128&g=1", "display_name": "Kevin LE GOFF", "link": "https://stackoverflow.com/users/1440666/kevin-le-goff"}, "edited": false, "score": 0, "creation_date": 1450880947, "post_id": 34433174, "comment_id": 56616416, "body": "Thanks for the answer It make perfect sense !"}], "tags": [], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "is_accepted": true, "score": 4, "last_activity_date": 1450865334, "creation_date": 1450865334, "answer_id": 34433174, "question_id": 34432977, "link": "https://stackoverflow.com/questions/34432977/difference-between-for-and-for-i-0-i-in-go/34433174#34433174", "title": "Difference between for{} and for i=0; i++ {} in go", "body": "<p>The <code>i</code> in the first loop is redundant; it's always best to get rid of unused variables therefore You should use a <code>for{}</code> in the pinger() function as well. </p>\n\n<p>Here is a working example:</p>\n\n<pre><code>package main\n\nimport(\n \"time\"\n \"fmt\"\n)\n\nfunc main() {\n    c := make(chan string)\n    go printer(c)\n    go pinger(c)\n    time.Sleep(time.Second * 60)\n}\n\nfunc pinger(c chan string) {\n    for{\n        c &lt;- \"ping\" \n    }\n}\n\nfunc printer(c chan string) {\n   for {\n       msg := &lt;- c\n       fmt.Println(msg)\n       time.Sleep(time.Second * 1)\n   }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/szhdFGbiLl\" rel=\"nofollow\">Run on playground</a></p>\n"}], "owner": {"reputation": 713, "user_id": 1440666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OKlp9.jpg?s=128&g=1", "display_name": "Kevin LE GOFF", "link": "https://stackoverflow.com/users/1440666/kevin-le-goff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 34433174, "answer_count": 2, "score": 1, "last_activity_date": 1450865334, "creation_date": 1450864704, "question_id": 34432977, "link": "https://stackoverflow.com/questions/34432977/difference-between-for-and-for-i-0-i-in-go", "title": "Difference between for{} and for i=0; i++ {} in go", "body": "<p>I am currently learming Go. I am readging the book <em>An Introduction to programming in go</em></p>\n\n<p>I am at the concurrency section and form what I understand I can see two way to define an infinite loop a go program.</p>\n\n<pre><code>func pinger(c chan string) {\n    for i := 0; ; i++ {\n        c &lt;- \"ping\" \n    }\n}\n\nfunc printer(c chan string) {\n   for {\n       msg := &lt;- c\n       fmt.Println(msg)\n       time.Sleep(time.Second * 1)\n   }\n}\n</code></pre>\n\n<p>I am wondering what is the use of the i variable in the pinger function. What is the best \"go\" way to declare an infinite loop ? I would say the the one in the printer function is better but as I am new to I might miss something with the declaration in the pinger function.</p>\n\n<p>Thanks for all people who will help.</p>\n"}, {"tags": ["go", "concurrency"], "answers": [{"tags": [], "owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "is_accepted": false, "score": 1, "last_activity_date": 1450861158, "creation_date": 1450861158, "answer_id": 34431921, "question_id": 34431565, "link": "https://stackoverflow.com/questions/34431565/how-to-place-http-serve-in-its-own-goroutine-if-it-blocks/34431921#34431921", "title": "How to place http.Serve in its own goroutine if it blocks?", "body": "<p>You could use a timeout on your select statement, e.g.</p>\n\n<pre><code>timeout := time.After(5 * time.Millisecond) // TODO: ajust the value\nselect {\ncase err := &lt;-serveErr:\n    return err\ncase _ := &lt;- timeout:\n    return nil\n}\n</code></pre>\n\n<p>This way your select will block until <code>serveErr</code> has a value or the specified <code>timeout</code> has elapsed. Note that the execution of your function will therefore block the calling goroutine for up to the duration of the specified timeout.</p>\n\n<p>Rob Pike's excellent talk on <a href=\"https://www.youtube.com/watch?v=f6kdp27TYZs\" rel=\"nofollow\">go concurrency patterns</a> might be helpful.</p>\n"}, {"comments": [{"owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "edited": false, "score": 0, "creation_date": 1450995462, "post_id": 34432253, "comment_id": 56658693, "body": "Thanks for your insight. What I am doing is wrong. I thought <code>net.Listener.Accept</code> was the function that returned the binding errors on first use but in fact <code>net.Listen</code> is the culprit which makes things a lot easier. For the time being I&#39;ll just panic if <code>http.Serve</code> via <code>net.Listener.Accept</code> produces an error. If I find this error path is frequent then I can use a channel to pipe the error to and let callers of the function <code>serveOnErr</code> listen on the channel."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 4, "last_activity_date": 1450863661, "last_edit_date": 1450863661, "creation_date": 1450862442, "answer_id": 34432253, "question_id": 34431565, "link": "https://stackoverflow.com/questions/34431565/how-to-place-http-serve-in-its-own-goroutine-if-it-blocks/34432253#34432253", "title": "How to place http.Serve in its own goroutine if it blocks?", "body": "<blockquote>\n  <p>http.Serve either returns an error as soon as it is called or blocks if successfully executing</p>\n</blockquote>\n\n<p>This assumption is not correct. And I believe it rarely occurs. <a href=\"https://golang.org/src/net/http/server.go?s=56308:56354#L1873\" rel=\"nofollow\"><code>http.Serve</code></a> calls <code>net.Listener.Accept</code> in the loop \u2013 an error can occur any time (socket closed, too many open file descriptors etc.). It's <code>http.ListenAndServe</code>, usually being used for running http servers, which often fails early while binding listening socket (no permissions, address already in use).</p>\n\n<p>In my opinion what you're trying to do is wrong, unless really your <code>net.Listener.Accept</code> is failing on the first call for some reason. Is it? If you want to be 100% sure your server is working, you could try to connect to it (and maybe actually transmit something), but once you successfully bound the socket I don't see it really necessary.</p>\n"}], "owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 34432253, "answer_count": 2, "score": 1, "last_activity_date": 1450863661, "creation_date": 1450859702, "question_id": 34431565, "link": "https://stackoverflow.com/questions/34431565/how-to-place-http-serve-in-its-own-goroutine-if-it-blocks", "title": "How to place http.Serve in its own goroutine if it blocks?", "body": "<p><a href=\"https://golang.org/pkg/net/http/#Serve\" rel=\"nofollow\"><code>http.Serve</code></a> either returns an error as soon as it is called or blocks if successfully executing.</p>\n\n<p>How can I make it so that if it blocks it does so in its own goroutine? I currently have the following code:</p>\n\n<pre><code>func serveOrErr(l net.Listener, handler http.Handler) error {\n    starting := make(chan struct{})\n    serveErr := make(chan error)\n    go func() {\n        starting &lt;- struct{}{}\n        if err := http.Serve(l, handler); err != nil {\n            serveErr &lt;- err \n        }   \n    }()\n    &lt;-starting\n\n    select {\n    case err := &lt;-serveErr:\n        return err\n    default:\n        return nil\n    }\n}\n</code></pre>\n\n<p>This seemed like a good start and works on my test machine but I believe that there are no guarantees that <code>serveErr &lt;- err</code> would be called before <code>case err := &lt;-serveErr</code> therefore leading to inconsistent results due to a data race if <code>http.Serve</code> were to produce an error.</p>\n"}, {"tags": ["go", "htop"], "comments": [{"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1450858389, "post_id": 34431262, "comment_id": 56603485, "body": "I looked at <a href=\"http://stackoverflow.com/questions/27497512/why-does-not-the-memory-decrease-in-golang\">memory decrease golang question</a> but it only says dont depend on FreeOSMemory or runtime.GC(), what else can I do ?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1450869469, "post_id": 34431262, "comment_id": 56609721, "body": "As <a href=\"https://en.m.wikipedia.org/wiki/Donald_Knuth\" rel=\"nofollow noreferrer\">a very skillful man</a> once said: <a href=\"http://c2.com/cgi/wiki?PrematureOptimization\" rel=\"nofollow noreferrer\">&quot;Premature optimization is the root of all evil.&quot;</a>. With just slightly under 8 Gb of physical and below 12 Gb virtual memory allocated, you shouldn&#39;t bother too much. Hint: there is a difference between &quot;sum of memory allocated in the past&quot; and &quot;currently used&quot;."}, {"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450896505, "post_id": 34431262, "comment_id": 56625343, "body": "@JimB I&#39;m storing alot of data in memory for faster access, and since I want to avoid allowing the os to start swapping pages, since other processes also use the same server, I thought of killing it when it goes into a bad state. Btw -  How long before it goes back to the OS ? Its been ten hours and HeapIdle is still 2.5G . It seems like this is never going back to the os."}, {"owner": {"reputation": 2497, "user_id": 1050818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d62e386c079f824fe7f0c8e8e83128b?s=128&d=identicon&r=PG", "display_name": "maxcnunes", "link": "https://stackoverflow.com/users/1050818/maxcnunes"}, "edited": false, "score": 0, "creation_date": 1552396723, "post_id": 34431262, "comment_id": 96986281, "body": "@AbhishekShivanna have you ever got to the bottom of it? Were you able to reduce the HeapIdle?"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1450896774, "post_id": 34437599, "comment_id": 56625491, "body": "Thanks for the explanation. I get and put to a cache, but to avoid hassles of locks, I make clones before giving a value. Since this cache has alot of entries, the creation and deletion of all these clones is putting a load on the gc. I wanted to call <code>debug.FreeOSMemory()</code> periodically as I don&#39;t want the os to start swapping pages since that will affect other processes on the same server."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1450898778, "post_id": 34437599, "comment_id": 56626465, "body": "@AbhishekShivanna: just like the docs for FreeOSMemory say, memory is returned by the runtime to the OS in a background task (called the heap scavenger). That can take 5-10 minutes with the current settings. You can see what&#39;s happening with GC and the scavenger by running with gctrace."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1450887139, "last_edit_date": 1450887139, "creation_date": 1450880175, "answer_id": 34437599, "question_id": 34431262, "link": "https://stackoverflow.com/questions/34431262/discrepancy-between-htop-and-golang-readmemstats/34437599#34437599", "title": "discrepancy between htop and golang readmemstats", "body": "<p>The effective memory consumption of your program will be <code>Sys-HeapReleased</code>. This still won't be exactly what the OS reports, because the OS can choose to allocate memory how it sees fit based on the requests of the program.</p>\n\n<p>If your program runs for any appreciable amount of time, the excess memory will be offered back to the OS so there's no need to call <code>debug.FreeOSMemory()</code>. It's also not the job of the garbage collector to keep memory as low as possible; the goal is to use memory as efficiently as possible. This requires some overhead, and room for future allocations.</p>\n\n<p>If you're having trouble with memory usage, it would be a lot more productive to profile your program and see why you're allocating more than expected, instead of killing your process based on incorrect assumptions about memory.</p>\n"}], "owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 3, "answer_count": 1, "score": 2, "last_activity_date": 1450887139, "creation_date": 1450858257, "last_edit_date": 1450858985, "question_id": 34431262, "link": "https://stackoverflow.com/questions/34431262/discrepancy-between-htop-and-golang-readmemstats", "title": "discrepancy between htop and golang readmemstats", "body": "<p>My program loads a lot of data at start up and then calls debug.FreeOSMemory() so that any extra space is given back immediately.</p>\n\n<pre><code>loadDataIntoMem()\ndebug.FreeOSMemory()\n</code></pre>\n\n<p>after loading into memory , htop shows me the following for the process</p>\n\n<pre><code> VIRT    RES     SHR\n 11.6G   7629M   8000\n</code></pre>\n\n<p>But a call to <code>runtime.ReadMemStats</code> shows me the following</p>\n\n<pre><code>Alloc         5593336608   5.3G\nBuckHashSys   1574016      1.6M\nHeapAlloc     5593336610   5.3G\nHeapIdle      2607980544   2.5G\nHeapInuse     7062446080   6.6G\nHeapReleased  2607980544   2.5G\nHeapSys       9670426624   9.1G\nMCacheInuse   9600         9.4K\nMCacheSys     16384        16K\nMSpanInuse    106776176    102M\nMSpanSys      115785728    111M\nOtherSys      25638523     25M\nStackInuse    589824       576K\nStackSys      589824       576K\nSys           10426738360  9.8G\nTotalAlloc    50754542056  48G\n</code></pre>\n\n<ol>\n<li>Alloc is the amount obtained from system and not yet freed ( This is \nresident memory right ?) But there is a big difference between the two.</li>\n<li>I rely on HeapIdle to kill my program i.e if HeapIdle is more than 2 GB, restart - in this case it is 2.5, and isn't going down even after a while. Golang should use from heap idle when allocating more in the future, thus reducing heap idle right ?</li>\n<li>If assumption 1 is wrong, which stat can accurately tell me what the RES value in htop is.</li>\n<li>What can I do to reduce the value of HeapIdle ?</li>\n</ol>\n\n<p>This was tried on go 1.4.2, 1.5.2 and 1.6.beta1</p>\n"}, {"tags": ["go", "oauth", "google-drive-api"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1450851028, "post_id": 34426033, "comment_id": 56600299, "body": "What have you tried thus far? Is it possible to download the files from a non-browser client without authenticating? This might be better asked on the go-nuts mailing list or on the Go forum (<a href=\"https://forum.golangbridge.org/\" rel=\"nofollow noreferrer\">forum.golangbridge.org</a>) if you haven&#39;t cracked the beginning of it just yet."}, {"owner": {"reputation": 33, "user_id": 5631808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3aa0769f41c8e2c83c5f97af83a7e21?s=128&d=identicon&r=PG&f=1", "display_name": "Jullius Pajanustan", "link": "https://stackoverflow.com/users/5631808/jullius-pajanustan"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1450866813, "post_id": 34426033, "comment_id": 56608079, "body": "I&#39;ve found <a href=\"http://stackoverflow.com/questions/18177419/download-public-file-from-google-drive-golang\">this</a> useful post so I think I&#39;m not going to use the gdrive client utility anymore. Thanks..."}], "owner": {"reputation": 33, "user_id": 5631808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3aa0769f41c8e2c83c5f97af83a7e21?s=128&d=identicon&r=PG&f=1", "display_name": "Jullius Pajanustan", "link": "https://stackoverflow.com/users/5631808/jullius-pajanustan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 986, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450880974, "creation_date": 1450826136, "question_id": 34426033, "link": "https://stackoverflow.com/questions/34426033/go-how-to-download-a-file-from-google-drive-without-oauth", "title": "Go - How to download a file from Google Drive without OAuth?", "body": "<p>I'm planning to make a console-based program to download a publicly shared file from Google Drive by just entering the file's ID using Go programming language. I want to use prasmussen's <a href=\"https://github.com/prasmussen/gdrive\" rel=\"nofollow\">gdrive</a> utility source as a basis to my work but this utility uses OAuth and needs to sign-in your GDrive's account on a browser first before you can use it. What I actually wanted is to just use the <strong>download function</strong> from it to directly download files without the authentication stuff.  </p>\n\n<p>To make things simpler, I want the whole program to be written only to the <strong>main package</strong> also, don't want to include the <a href=\"https://github.com/voxelbrain/goptions\" rel=\"nofollow\">goptions</a> stuff for displaying the program's usage.  </p>\n\n<p>Someone help me locate the partial codes from the sources?  </p>\n\n<p>Here's a publicly shared file to be downloaded:</p>\n\n<blockquote>\n  <p>File Name: Getting Started.pdf<br>\n  File ID: 0B5gMcwYHq3zkc3RhcnRlcl9maWxl<br>\n  File Size: 1.48 MB  </p>\n</blockquote>\n\n<p><br></p>\n\n<p>Thanks</p>\n"}, {"tags": ["mongodb", "indexing", "go"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1450824865, "post_id": 34425770, "comment_id": 56593096, "body": "You create the index on <code>db.C(&quot;session&quot;)</code>, but you are looking at <code>db.mydb.getIndexes()</code>."}, {"owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1450825373, "post_id": 34425770, "comment_id": 56593278, "body": "Ah right, that&#39;s a mistake here on stackoverflow. If I look up the session collection there are no indexes."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1450825863, "post_id": 34425770, "comment_id": 56593461, "body": "Code works for me. Please add a <a href=\"http://www.stackoverflow.com/help/mcve\">minimal, complete and verifiable example</a>."}, {"owner": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1582805896, "post_id": 34425770, "comment_id": 106908454, "body": "@MarkusWMahlberg can you give me an updated example for TTL entry. Thanks"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "edited": false, "score": 0, "creation_date": 1582811095, "post_id": 34425770, "comment_id": 106911318, "body": "@RafidKotta No. Either the sample works for you or you have a different question, which I might or might not answer. However, you can get my daily rate on request."}], "answers": [{"comments": [{"owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1450878893, "post_id": 34427226, "comment_id": 56615220, "body": "Well doesn&#39;t really matter, since this is in development and the collection is cleaned each test :)"}], "tags": [], "owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "is_accepted": true, "score": 1, "last_activity_date": 1450834343, "creation_date": 1450834343, "answer_id": 34427226, "question_id": 34425770, "link": "https://stackoverflow.com/questions/34425770/golang-mgo-ttl-index/34427226#34427226", "title": "golang mgo TTL index", "body": "<p>So the issue was that I had to drop the collection. The index existed already so it was not recreated with the expiration constraint.</p>\n"}, {"comments": [{"owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "edited": false, "score": 0, "creation_date": 1467885911, "post_id": 38216189, "comment_id": 63906328, "body": "Yes the variable &quot;session_expire&quot; is of type time.Duration. I add that to my question."}, {"owner": {"reputation": 4599, "user_id": 2058131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iWT11.png?s=128&g=1", "display_name": "Adam Erickson", "link": "https://stackoverflow.com/users/2058131/adam-erickson"}, "edited": false, "score": 0, "creation_date": 1527093006, "post_id": 38216189, "comment_id": 87999520, "body": "Or you can just do <code>3600 * time.Second</code>"}], "tags": [], "owner": {"reputation": 616, "user_id": 2744934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72727bdc9c905a07064920beb874cdab?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Spear", "link": "https://stackoverflow.com/users/2744934/mike-spear"}, "is_accepted": false, "score": 1, "last_activity_date": 1467778118, "creation_date": 1467778118, "answer_id": 38216189, "question_id": 34425770, "link": "https://stackoverflow.com/questions/34425770/golang-mgo-ttl-index/38216189#38216189", "title": "golang mgo TTL index", "body": "<p>I was trying to use the answer to this question, and ran into a problem.  Consider the following small change:</p>\n\n<pre><code>sessionTTL := mgo.Index{\n    Key:         []string{\"created\"},\n    Unique:      false,\n    DropDups:    false,\n    Background:  true,\n    ExpireAfter: 60 * 60} // one hour\n\nif err := db.C(\"session\").EnsureIndex(sessionTTL); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>The problem with this is that the code silently fails if <code>ExpireAfter</code> is not a proper <code>time.Duration</code>.</p>\n\n<p>I had to change to:\n        ExpireAfter: time.Duration(60 * 60) * time.Second,</p>\n"}], "owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2323, "favorite_count": 0, "accepted_answer_id": 34427226, "answer_count": 2, "score": 2, "last_activity_date": 1467885937, "creation_date": 1450824761, "last_edit_date": 1467885937, "question_id": 34425770, "link": "https://stackoverflow.com/questions/34425770/golang-mgo-ttl-index", "title": "golang mgo TTL index", "body": "<p>how do I create a TTL (time to live) index with golang and mongodb?\nThis is how I'm trying to do it currently:</p>\n\n<pre><code>sessionTTL := mgo.Index{\n    Key:         []string{\"created\"},\n    Unique:      false,\n    DropDups:    false,\n    Background:  true,\n    ExpireAfter: session_expire} // session_expire is a time.Duration\n\nif err := db.C(\"session\").EnsureIndex(sessionTTL); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>But if I look it up using:</p>\n\n<pre><code>db.session.getIndexes()\n</code></pre>\n\n<p>session_expire is set to 5*time.Second. The field \"created\" in the document is set to current date using time.Now(), so I expected the documents the be deleted after 5 seconds.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1450825270, "post_id": 34425786, "comment_id": 56593248, "body": "So basically anything that has <code>Read(p []byte) (n int, err error)</code> can be passed?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1450825619, "post_id": 34425786, "comment_id": 56593365, "body": "@alex: yes. That kind of the whole point of go interfaces: <a href=\"https://golang.org/doc/effective_go.html#interfaces\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#interfaces</a>. You really need to understand them in order to use go. <a href=\"http://tour.golang.org/methods/4\" rel=\"nofollow noreferrer\">tour.golang.org/methods/4</a>"}, {"owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1450826276, "post_id": 34425786, "comment_id": 56593585, "body": "I just wanted to make sure, the problem is that I don&#39;t know how to find in the standard lib everything that will satisfy that interface besides taking them one by one, or how did you know that os.File is satisfying io.Reader?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "edited": false, "score": 0, "creation_date": 1450878583, "post_id": 34425786, "comment_id": 56615033, "body": "@alex: It will quickly become very obvious when something implements the common interfaces, like those in <code>io</code>. There are so many things that implement <code>io.Reader</code>, it&#39;s not really useful to try and list them all. Plus even is <code>io.Reader</code> wasn&#39;t available, you could declare your own reader interface to accept the types you need."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1450824826, "creation_date": 1450824826, "answer_id": 34425786, "question_id": 34425754, "link": "https://stackoverflow.com/questions/34425754/test-function-which-requires-os-file-as-argument/34425786#34425786", "title": "Test function which requires *os.File as argument", "body": "<p>Your <code>toCount</code> function only requires an <code>io.Reader</code>. If you change the signature to</p>\n\n<pre><code>func toCount(f io.Reader) int\n</code></pre>\n\n<p>It can accept an <code>*os.File</code> and any other kind of reader you want to use to test. </p>\n"}], "owner": {"reputation": 1689, "user_id": 3791027, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a240d8bb3d536a1ecc16adf28f7b1feb?s=128&d=identicon&r=PG&f=1", "display_name": "RockNinja", "link": "https://stackoverflow.com/users/3791027/rockninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 34425786, "answer_count": 1, "score": -2, "last_activity_date": 1450824826, "creation_date": 1450824673, "question_id": 34425754, "link": "https://stackoverflow.com/questions/34425754/test-function-which-requires-os-file-as-argument", "title": "Test function which requires *os.File as argument", "body": "<p>I would like to write a test for the bellow function, but I can't understand what I can send as an argument to <code>toCount</code>, because I don't want to open/create a file, I know that os.Stdin will work, but I think you're not allowed to write into it.</p>\n\n<pre><code>func toCount(f *os.File) int {\n  input := buffo.NewScanner(f)\n  sum := 0;\n  for input.Scan() {\n    sum++\n  }\n  return sum\n}\n</code></pre>\n"}, {"tags": ["vim", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450815757, "post_id": 34423799, "comment_id": 56589283, "body": "Is it a difference in PATH? (and why would you ever need to edit Go code as root?)"}, {"owner": {"reputation": 690, "user_id": 2410000, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9162b1a691401003e3589017088242de?s=128&d=identicon&r=PG", "display_name": "Alexander Trust", "link": "https://stackoverflow.com/users/2410000/alexander-trust"}, "edited": false, "score": 1, "creation_date": 1450816096, "post_id": 34423799, "comment_id": 56589424, "body": "I think it is already answered here: <a href=\"http://stackoverflow.com/questions/15579822/add-golang-syntax-highlighting-for-vim\" title=\"add golang syntax highlighting for vim\">stackoverflow.com/questions/15579822/&hellip;</a>"}, {"owner": {"reputation": 11411, "user_id": 406249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7055935d2e651d2e2907133f34675a16?s=128&d=identicon&r=PG", "display_name": "Nick McCurdy", "link": "https://stackoverflow.com/users/406249/nick-mccurdy"}, "edited": false, "score": 1, "creation_date": 1451589803, "post_id": 34423799, "comment_id": 56843889, "body": "It seems like you need to install a go language support plugin. To configure this for root, simply add this to the root user&#39;s config file (it&#39;s probably in <code>&#47;root&#47;.vimrc</code>, unless if your root user has a different home directory)."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1516185343, "post_id": 34423799, "comment_id": 83582387, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15579822/add-golang-syntax-highlighting-for-vim\">Add GoLang syntax highlighting for VIM</a>"}], "owner": {"reputation": 227, "user_id": 5042017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561ca49422f5075c332879f2c6204508?s=128&d=identicon&r=PG&f=1", "display_name": "Jaimy", "link": "https://stackoverflow.com/users/5042017/jaimy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 478, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450825152, "creation_date": 1450815418, "last_edit_date": 1450815570, "question_id": 34423799, "link": "https://stackoverflow.com/questions/34423799/how-to-turn-syntax-on-in-vim-for-golang-for-both-root-user-and-normal-user-mode", "title": "how to turn syntax on in vim for golang for both root user and normal user mode?", "body": "<p>I modified ~/.vimrc and added the following line:</p>\n\n<pre><code>syntax on\n</code></pre>\n\n<p>to turn syntax on. The syntax is highlighted for python, java, but for golang it doesn't highlight at all.</p>\n\n<p>I would like to do the same when editing vim files, logged in as root too. \nI tried to modify vimrc as root but none of the modes work with syntax.</p>\n"}, {"tags": ["go", "autocomplete", "visual-studio-code"], "comments": [{"owner": {"reputation": 491, "user_id": 7655137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5203fc333c6443affb37aa2209267d71?s=128&d=identicon&r=PG&f=1", "display_name": "darkwing", "link": "https://stackoverflow.com/users/7655137/darkwing"}, "edited": false, "score": 0, "creation_date": 1528474646, "post_id": 34423746, "comment_id": 88536964, "body": "Where is the <code>gocode</code> log located that you refer to?"}], "answers": [{"comments": [{"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1450874239, "post_id": 34428285, "comment_id": 56612540, "body": "Thanks @kostya, seems my GOPATH is not set, but it is when I run echo %GOPATH%, any idea why that would be?"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1450878705, "post_id": 34428285, "comment_id": 56615111, "body": "I just saw your issue in gocode project. Possibly a bug in the VS plugin. I don&#39;t use it, so cannot help you unfortunately."}, {"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1450889575, "post_id": 34428285, "comment_id": 56621703, "body": "I found the issue on the extension and posted it to the vscode extension GitHub issue. If anyone have this error here&#39;s how I fixed it locally for now: <a href=\"https://github.com/Microsoft/vscode-go/issues/167\" rel=\"nofollow noreferrer\">github.com/Microsoft/vscode-go/issues/167</a>"}, {"owner": {"reputation": 30856, "user_id": 105562, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/e66ceae48943526967c5118011e58b63?s=128&d=identicon&r=PG", "display_name": "Travis Reeder", "link": "https://stackoverflow.com/users/105562/travis-reeder"}, "edited": false, "score": 0, "creation_date": 1473804971, "post_id": 34428285, "comment_id": 66278669, "body": "Boom, thanks, ran first 3 lines above and started working again."}, {"owner": {"reputation": 841, "user_id": 127316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cf38858a3a705d200e722c77b4f8a5?s=128&d=identicon&r=PG", "display_name": "John Eikenberry", "link": "https://stackoverflow.com/users/127316/john-eikenberry"}, "edited": false, "score": 0, "creation_date": 1543962625, "post_id": 34428285, "comment_id": 94105258, "body": "The <code>github.com&#47;nsf&#47;gocode</code> repo is no longer maintained. Recommended version is now <code>github.com&#47;mdempsky&#47;gocode</code>."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 11, "last_activity_date": 1555562650, "last_edit_date": 1555562650, "creation_date": 1450842111, "answer_id": 34428285, "question_id": 34423746, "link": "https://stackoverflow.com/questions/34423746/gocode-external-package-give-no-suggestion-for-vscode/34428285#34428285", "title": "gocode external package give no suggestion for vscode", "body": "<p>Try running gocode server process in the console and observe the output:</p>\n\n<pre><code>gocode close\ngocode -debug -s\n</code></pre>\n\n<p>Make sure that you are running the latest version of gocode:</p>\n\n<pre><code>go get -u github.com/mdempsky/gocode\n</code></pre>\n\n<p>You might want to run the following command to build gocode instead (though I believe you won't be able to use debug method that I suggested in this case):</p>\n\n<pre><code>go get -u -ldflags -H=windowsgui github.com/mdempsky/gocode\n</code></pre>\n\n<p>as suggested at <a href=\"https://github.com/mdempsky/gocode\" rel=\"nofollow noreferrer\">https://github.com/mdempsky/gocode</a></p>\n"}], "owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5451, "favorite_count": 1, "accepted_answer_id": 34428285, "answer_count": 1, "score": 5, "last_activity_date": 1555562650, "creation_date": 1450815143, "last_edit_date": 1495540439, "question_id": 34423746, "link": "https://stackoverflow.com/questions/34423746/gocode-external-package-give-no-suggestion-for-vscode", "title": "gocode external package give no suggestion for vscode", "body": "<p>My auto-complete / intellisense stopped working after upgrading from the Go extension here of Visual Studio Code: <a href=\"https://github.com/microsoft/vscode-go\" rel=\"nofollow noreferrer\">https://github.com/microsoft/vscode-go</a></p>\n\n<p>I've opened an issue in there, but I'm thinking this might have to do with gocode.</p>\n\n<p>I'm running Windows 10, Go version 1.5.1, Visual Studio Code 0.10.5 and Go extension 0.6.21. Was working fine before updating and I was using Go extension 0.6.17.</p>\n\n<p>Problem is suggestions / intellisense works for internal package, but every external package I have no longer give suggestions when writing . or ctrl+space. Even net/http or core Go package does not work.</p>\n\n<p>I wanted to try and run gocode myself to see what it's actually returning, so I've looked into the code for the extension and it is executing a child process similar to that: <code>gocode -f=json autocomplete filename offset</code>.</p>\n\n<p>Not really sure how to get <code>offset</code> or what it represents, number of bytes for position that triggers the auto-complete? In any case, when I run this I got no output and I do not return to the prompt, I have to CTRL+C to return.</p>\n\n<p>I'm unable to find anything interesting on Google either, probably wrongly searching or not exactly knowing what to search for.</p>\n\n<p>Does someone would have an idea, goal of running gocode was to see if in fact the gocode was returning suggestion for external package than if yes, there's something with the extension.</p>\n\n<p>If gocode does not returns anything, well it means it's not working properly now, anything I can do?</p>\n\n<p>Thanks</p>\n\n<p>Edit 1: Log from <code>gocode</code> following <a href=\"https://stackoverflow.com/a/34428285/316855\">kostya answer</a></p>\n\n<p><code>\n2015/12/23 07:26:11 Import path \"github.com/gocraft/web\" was not resolved\n2015/12/23 07:26:11 Gocode's build context is:\n2015/12/23 07:26:11  GOROOT: c:\\go\n2015/12/23 07:26:11  GOPATH:\n2015/12/23 07:26:11  GOOS: windows\n2015/12/23 07:26:11  GOARCH: amd64\n2015/12/23 07:26:11  GBProjectRoot: \"\"\n2015/12/23 07:26:11  lib-path: \"\"\n</code></p>\n\n<p>It seems my GOPATH variable is not evaluated, but it's set, and when I run <code>echo %GOPATH%</code> I receive the correct value.</p>\n"}, {"tags": ["xml", "parsing", "go"], "answers": [{"comments": [{"owner": {"reputation": 1455, "user_id": 169174, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e7db9357aea6e8c18d49fc29e60893b0?s=128&d=identicon&r=PG", "display_name": "chamilad", "link": "https://stackoverflow.com/users/169174/chamilad"}, "edited": false, "score": 0, "creation_date": 1450816541, "post_id": 34423836, "comment_id": 56589626, "body": "Thanks! I&#39;ve added the code I&#39;ve written so far and the HTML format. I&#39;m not getting any output though."}], "tags": [], "owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1450815583, "creation_date": 1450815583, "answer_id": 34423836, "question_id": 34423333, "link": "https://stackoverflow.com/questions/34423333/go-xml-parsing-boolean-attribute-in-html-causes-xml-validation-error/34423836#34423836", "title": "Go XML - Parsing boolean attribute in HTML causes XML validation error", "body": "<p>You can use Decoder to unmarshal. Using decoder you can turn off the strict parsing and overcome the error that you are facing. Since you had put only one line of xml/html to parse I have assumed root element and some value between hr tag and below is the sample implementation</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype Hr struct {\n    XMLName xml.Name `xml:\"a\"`\n    TagName string   `xml:\"hr\"`\n}\n\nfunc main() {   \n    s := \"&lt;a&gt;&lt;hr noshade&gt;value&lt;/hr&gt;&lt;/a&gt;\"\n\n    hr := &amp;Hr{}\n    d := xml.NewDecoder(strings.NewReader(s))\n    d.Strict = false\n    err := d.Decode(hr)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(hr.TagName)\n}\n</code></pre>\n\n<p>fmt.Println(hr.TagName) will print \"value\"</p>\n"}, {"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 0, "last_activity_date": 1450823454, "creation_date": 1450823454, "answer_id": 34425536, "question_id": 34423333, "link": "https://stackoverflow.com/questions/34423333/go-xml-parsing-boolean-attribute-in-html-causes-xml-validation-error/34425536#34425536", "title": "Go XML - Parsing boolean attribute in HTML causes XML validation error", "body": "<p>There are many errors in your code:</p>\n\n<ul>\n<li>If the attribute is not public, it cannot be accessed by another package (<code>xml</code> in this case): Make all the attributes upper case.</li>\n<li>li was missing the tag name.</li>\n</ul>\n\n<p>See this working code</p>\n\n<p><a href=\"http://play.golang.org/p/rkNf2OfvdM\" rel=\"nofollow\">http://play.golang.org/p/rkNf2OfvdM</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"log\"\n    \"strings\"\n)\n\ntype Anchor struct {\n    XMLName xml.Name `xml:\"a\"`\n    Href    string   `xml:\"href,attr\"`\n}\n\ntype ListEntry struct {\n    XMLName xml.Name `xml:\"li\"`\n        Filename Anchor\n}\n\ntype DirList struct {\n    XMLName xml.Name    `xml:\"ul\"`\n    Entries []ListEntry `xml:\"li\"`\n}\n\ntype Header struct {\n    XMLName xml.Name `xml:\"h2\"`\n}\n\ntype Head struct {\n    XMLName xml.Name `xml:\"head\"`\n    Title   Title\n}\n\ntype Title struct {\n    XMLName xml.Name `xml:\"title\"`\n}\n\ntype Html struct {\n    XMLName xml.Name `xml:\"html\"`\n    Body    Body     `xml:\"body\"`\n    Head    Head\n}\n\ntype Body struct {\n    H2            Header\n    DirectoryList DirList\n    Hr            Hr\n    Em            Em\n}\n\ntype Hr struct {\n    XMLName xml.Name `xml:\"hr\"`\n}\n\ntype Em struct {\n    XMLName xml.Name `xml:\"em\"`\n    link    Anchor\n}\n\nvar contents = `&lt;html&gt;&lt;head&gt;&lt;title&gt;Some title&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;\n &lt;h2&gt;Title here&lt;/h2&gt;\n &lt;ul&gt;\n  &lt;li&gt;&lt;a href=\"../\"&gt;..&lt;/a&gt;&lt;/li&gt;\n  &lt;li&gt;&lt;a href=\"file1.txt\"&gt;file1.txt&lt;/a&gt;&lt;/li&gt;\n  &lt;li&gt;&lt;a href=\"file2.zip\"&gt;file2.zip&lt;/a&gt;&lt;/li&gt;\n &lt;/ul&gt;\n &lt;hr noshade&gt;&lt;em&gt;Powered by &lt;a href=\"http://subversion.apache.org/\"&gt;Apache Subversion&lt;/a&gt; version 1.7.18 (r1615261).&lt;/em&gt;\n&lt;/body&gt;&lt;/html&gt;`\n\nfunc main() {\n    htmlTag := Html{}\n    decoder := xml.NewDecoder(strings.NewReader(contents))\n    decoder.Strict = false\n    decoder.AutoClose = xml.HTMLAutoClose\n    decoder.Entity = xml.HTMLEntity\n\n    err := decoder.Decode(&amp;htmlTag)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Printf(\"DirList: %v %#[1]v\\n\", htmlTag)\n}\n</code></pre>\n"}], "owner": {"reputation": 1455, "user_id": 169174, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e7db9357aea6e8c18d49fc29e60893b0?s=128&d=identicon&r=PG", "display_name": "chamilad", "link": "https://stackoverflow.com/users/169174/chamilad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 570, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450823454, "creation_date": 1450813494, "last_edit_date": 1450816439, "question_id": 34423333, "link": "https://stackoverflow.com/questions/34423333/go-xml-parsing-boolean-attribute-in-html-causes-xml-validation-error", "title": "Go XML - Parsing boolean attribute in HTML causes XML validation error", "body": "<p>I have an html output with the following tag.</p>\n\n<pre><code>&lt;hr noshade&gt;\n</code></pre>\n\n<p>My struct for this is </p>\n\n<pre><code>type Hr struct {\n    TagName xml.Name `xml:\"hr\"`\n}\n</code></pre>\n\n<p>When I try to pass the html using \"encoding/xml\", it throws an error saying the attribute doesn't have a <code>'='</code> character. </p>\n\n<p>I've seen that this error is thrown because the default Decoder evaluates XML with <code>Strict</code> set to true. </p>\n\n<p>How can I ignore this and continue parsing the document (using <code>xml.Unmarshal()</code>)? </p>\n\n<p>EDIT: Including the XML and the structs used.</p>\n\n<p>I found out the Decoder settings, and used NewDecoder, however it seems the unmarshalling doesn't happen properly.</p>\n\n<pre><code>&lt;html&gt;&lt;head&gt;&lt;title&gt;Some title&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;\n &lt;h2&gt;Title here&lt;/h2&gt;\n &lt;ul&gt;\n  &lt;li&gt;&lt;a href=\"../\"&gt;..&lt;/a&gt;&lt;/li&gt;\n  &lt;li&gt;&lt;a href=\"file1.txt\"&gt;file1.txt&lt;/a&gt;&lt;/li&gt;\n  &lt;li&gt;&lt;a href=\"file2.zip\"&gt;file2.zip&lt;/a&gt;&lt;/li&gt;\n  .....\n &lt;/ul&gt;\n &lt;hr noshade&gt;&lt;em&gt;Powered by &lt;a href=\"http://subversion.apache.org/\"&gt;Apache Subversion&lt;/a&gt; version 1.7.18 (r1615261).&lt;/em&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>Code I've written so far</p>\n\n<pre><code>type Anchor struct {\n    TagName xml.Name `xml:\"a\"`\n    Href    string   `xml:\"href,attr\"`\n}\n\ntype ListEntry struct {\n    TagName  xml.Name `xml:\"li\"`\n    Filename Anchor\n}\n\ntype DirList struct {\n    XMLName xml.Name `xml:\"ul\"`\n    Entries []ListEntry\n}\n\ntype Header struct {\n    TagName xml.Name `xml:\"h2\"`\n}\n\ntype Head struct {\n    TagName xml.Name `xml:\"head\"`\n    title   Title\n}\n\ntype Title struct {\n    TagName xml.Name `xml:\"title\"`\n}\n\ntype html struct {\n    TagName xml.Name `xml:\"html\"`\n    body    Body     `xml:\"body\"`\n    head    Head\n}\n\ntype Body struct {\n    H2            Header\n    DirectoryList DirList\n    hr            Hr\n    em            Em\n}\n\ntype Hr struct {\n    TagName xml.Name `xml:\"hr\"`\n}\n\ntype Em struct {\n    TagName xml.Name `xml:\"em\"`\n    link    Anchor\n}\n\n   contents := retrieveFromWeb()\n\n    htmlTag := html{}\n    decoder := xml.NewDecoder(strings.NewReader(contents))\n    decoder.Strict = false\n    decoder.AutoClose = xml.HTMLAutoClose\n    decoder.Entity = xml.HTMLEntity\n\n    err = decoder.Decode(&amp;htmlTag)\n\n    fmt.Println(\"DirList: \", htmlTag)\n</code></pre>\n\n<p>Current output</p>\n\n<pre><code>DirList:  {{ } {{{ }} {{ } []} {{ }} {{ } {{ } }}} {{ } {{ }}}}\n</code></pre>\n"}, {"tags": ["arrays", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 6, "last_activity_date": 1450820933, "last_edit_date": 1450820933, "creation_date": 1450813597, "answer_id": 34423364, "question_id": 34423221, "link": "https://stackoverflow.com/questions/34423221/length-and-capacity-in-go-slices/34423364#34423364", "title": "length and capacity in Go slices", "body": "<p>Yep, slicing can get you access to the elements beyond the <code>len</code> of the original slice (though not beyond its <code>cap</code>, or who knows what memory you'd be accessing). </p>\n\n<p>This means, for example, that you can implement <code>append</code>-like functionality, returning a \"grown\" slice with <code>len</code> increased to something closer to the <code>cap</code>. That is, <code>append</code>'s access to the region between <code>len</code> and <code>cap</code> isn't only available to built-in functions; you have it as well. Look at <a href=\"https://blog.golang.org/slices#TOC_9.\" rel=\"nofollow\">Append: an example</a> in the Go blog entry on slices to see it done (and if interested read the whole post; it helps make slices as a whole make sense).</p>\n\n<p><a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow\">The spec on slice expressions</a> (and <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow\">slice types</a>) and the <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow\">Slice Tricks page</a> may also be interesting.</p>\n"}], "owner": {"reputation": 5634, "user_id": 2517730, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Xojng.jpg?s=128&g=1", "display_name": "Yar", "link": "https://stackoverflow.com/users/2517730/yar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "accepted_answer_id": 34423364, "answer_count": 1, "score": 2, "last_activity_date": 1450820933, "creation_date": 1450813003, "question_id": 34423221, "link": "https://stackoverflow.com/questions/34423221/length-and-capacity-in-go-slices", "title": "length and capacity in Go slices", "body": "<p>Say we have slice of b such</p>\n\n<pre><code>b:= make([]int, 0, 5) // length: 0, cap: 5\n</code></pre>\n\n<p>and slice of \"c\" made from slice of \"b\"</p>\n\n<pre><code>c:= b[:2]  // length: 2 (?), cap: 5\n</code></pre>\n\n<p>The question if how come we have length of 2 for \"c\"? I was expecting length of zero as well, like b, since we are making c out of b</p>\n"}, {"tags": ["go", "zlib"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 2, "last_activity_date": 1450800004, "creation_date": 1450800004, "answer_id": 34419785, "question_id": 34419220, "link": "https://stackoverflow.com/questions/34419220/golang-zlib-reader-output-not-being-copied-over-to-stdout/34419785#34419785", "title": "golang zlib reader output not being copied over to stdout", "body": "<p>I think you messed up the code logic with all this <code>defer</code> stuff and your \"trick\" err checking.</p>\n\n<p>Files are definitively written when flushed or closed. You just copy into new.txt without closing it <strong>before</strong> opening it to read it.</p>\n\n<p>Defering the closing of the file is neat inside a function which has multiple exits: It makes sure the file is closed once the function is left. But your main requires the new.txt to be closed after the copy, before re-opening it. So don't defer the close here.</p>\n\n<p>BTW: Your defense against log.Fatal terminating the code without calling your defers is, well, at least strange. The files are all put into some proper state by the OS, there is absolutely no need to complicate the stuff like this.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1450800543, "last_edit_date": 1450800543, "creation_date": 1450800040, "answer_id": 34419794, "question_id": 34419220, "link": "https://stackoverflow.com/questions/34419220/golang-zlib-reader-output-not-being-copied-over-to-stdout/34419794#34419794", "title": "golang zlib reader output not being copied over to stdout", "body": "<p>Your <code>defer</code> func doesn't do anything, because you're shadowing the <code>err</code> variable on every new assignment. If you want a <code>defer</code> to run, return from a separate function, and call <code>log.Fatal</code> after the return statement. </p>\n\n<p>As for why you're not seeing any output, it's because you're deferring all the Close calls. The <code>zlib.Writer</code> isn't flushed until after the function exits, and neither is the destination file. Call <code>Close()</code> explicitly where you need it. </p>\n\n<pre><code>zdest := zlib.NewWriter(dest)\n\nif _, err := io.Copy(zdest, src); err != nil {\n    log.Fatal(err)\n}\nzdest.Close()\ndest.Close()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1450800164, "creation_date": 1450800164, "answer_id": 34419829, "question_id": 34419220, "link": "https://stackoverflow.com/questions/34419220/golang-zlib-reader-output-not-being-copied-over-to-stdout/34419829#34419829", "title": "golang zlib reader output not being copied over to stdout", "body": "<p>Check the error from the second <code>Copy</code>:</p>\n\n<pre><code>2015/12/22 19:00:33 \nDeferred log: \n unexpected EOF\nexit status 1\n</code></pre>\n\n<p>The thing is, you need to close <code>zdest</code> immediately after you've done writing. Close it after the first <code>Copy</code> and it works.</p>\n"}, {"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 1, "last_activity_date": 1450823917, "creation_date": 1450823917, "answer_id": 34425615, "question_id": 34419220, "link": "https://stackoverflow.com/questions/34419220/golang-zlib-reader-output-not-being-copied-over-to-stdout/34425615#34425615", "title": "golang zlib reader output not being copied over to stdout", "body": "<p>I would have suggested to use <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow\">io.MultiWriter</a>.\nIn this way you read only once from src. Not much gain for small files but is faster for bigger files. </p>\n\n<pre><code>  w :=  io.MultiWriter(dest, os.Stdout)\n</code></pre>\n"}], "owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 34419794, "answer_count": 4, "score": 1, "last_activity_date": 1450823917, "creation_date": 1450798176, "question_id": 34419220, "link": "https://stackoverflow.com/questions/34419220/golang-zlib-reader-output-not-being-copied-over-to-stdout", "title": "golang zlib reader output not being copied over to stdout", "body": "<p>I've modified the official documentation example for the zlib package to use an opened file rather than a set of hardcoded bytes (code below).</p>\n\n<p>The code reads in the contents of a source text file and compresses it with the zlib package. I then try to read back the compressed file and print its decompressed contents into stdout.</p>\n\n<p>The code doesn't error, but it also doesn't do what I expect it to do; which is to display the decompressed file contents into stdout. </p>\n\n<blockquote>\n  <p>Also: is there another way of displaying this information, rather than using <code>io.Copy</code>?</p>\n</blockquote>\n\n<pre><code>    package main\n\n    import (\n        \"compress/zlib\"\n        \"io\"\n        \"log\"\n        \"os\"\n    )\n\n    func main() {\n        var err error\n\n        // This defends against an error preventing `defer` from being called\n        // As log.Fatal otherwise calls `os.Exit`\n        defer func() {\n            if err != nil {\n                log.Fatalln(\"\\nDeferred log: \\n\", err)\n            }\n        }()\n\n        src, err := os.Open(\"source.txt\")\n        if err != nil {\n            return\n        }\n        defer src.Close()\n\n        dest, err := os.Create(\"new.txt\")\n        if err != nil {\n            return\n        }\n        defer dest.Close()\n\n        zdest := zlib.NewWriter(dest)\n        defer zdest.Close()\n\n        if _, err := io.Copy(zdest, src); err != nil {\n            return\n        }\n\n        n, err := os.Open(\"new.txt\")\n        if err != nil {\n            return\n        }\n\n        r, err := zlib.NewReader(n)\n        if err != nil {\n            return\n        }\n        defer r.Close()\n        io.Copy(os.Stdout, r)\n\n        err = os.Remove(\"new.txt\")\n        if err != nil {\n            return\n        }\n    }\n</code></pre>\n"}, {"tags": ["multithreading", "go", "concurrency"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1450793932, "post_id": 34417872, "comment_id": 56576809, "body": "<a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">golang.org/pkg/sync/#WaitGroup</a>?"}, {"owner": {"reputation": 164, "user_id": 5707560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5AzNZ.png?s=128&g=1", "display_name": "Yehor Smoliakov", "link": "https://stackoverflow.com/users/5707560/yehor-smoliakov"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1450794224, "post_id": 34417872, "comment_id": 56577000, "body": "@Ainar-G I do not understand how to properly add"}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 1653085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8irj8.jpg?s=128&g=1", "display_name": "Vitaly Velikodny", "link": "https://stackoverflow.com/users/1653085/vitaly-velikodny"}, "is_accepted": false, "score": 1, "last_activity_date": 1450797443, "creation_date": 1450797443, "answer_id": 34418950, "question_id": 34417872, "link": "https://stackoverflow.com/questions/34417872/how-to-wait-for-the-implementation-of/34418950#34418950", "title": "How to wait for the implementation of", "body": "<p>var wg sync.WaitGroup</p>\n\n<p>When start each goroutine do:</p>\n\n<pre><code>wg.Add(1)\n</code></pre>\n\n<p>When goroutine work done decrement counter with</p>\n\n<pre><code>wg.Done()\n</code></pre>\n\n<p>as a result, instead of</p>\n\n<pre><code>for {\n    time.Sleep(1 * time.Second)\n}\n</code></pre>\n\n<p>do</p>\n\n<pre><code> wg.Wait()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3949, "user_id": 1816872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1V08e.jpg?s=128&g=1", "display_name": "Ivan Black", "link": "https://stackoverflow.com/users/1816872/ivan-black"}, "is_accepted": false, "score": 1, "last_activity_date": 1450797699, "creation_date": 1450797699, "answer_id": 34419049, "question_id": 34417872, "link": "https://stackoverflow.com/questions/34417872/how-to-wait-for-the-implementation-of/34419049#34419049", "title": "How to wait for the implementation of", "body": "<p>Just use the <a href=\"https://godoc.org/sync#WaitGroup\" rel=\"nofollow\">sync.WaitGroup</a></p>\n\n\n\n<pre><code>package main\n\nimport(\n    \"sync\"\n)\n\nfunc stuff(wg *sync.WaitGroup) {\n    defer wg.Done() // tell the WaitGroup it's done\n    /* stuff */\n}\n\nfunc main() {\n    count := 50\n    wg := new(sync.WaitGroup)\n    wg.Add(count) // add number of gorutines to the WaitGroup\n    for i := 0; i &lt; count; i++ {\n        go stuff(wg)\n    }\n    wg.Wait() // wait for all\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/LkFnYb-3EU\" rel=\"nofollow\">Play</a></p>\n"}, {"tags": [], "owner": {"reputation": 152, "user_id": 5660064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q0D4N3-5iEE/AAAAAAAAAAI/AAAAAAAALB4/Lv6t4v1ANRg/photo.jpg?sz=128", "display_name": "Todd McLeod", "link": "https://stackoverflow.com/users/5660064/todd-mcleod"}, "is_accepted": true, "score": 1, "last_activity_date": 1450803124, "creation_date": 1450803124, "answer_id": 34420766, "question_id": 34417872, "link": "https://stackoverflow.com/questions/34417872/how-to-wait-for-the-implementation-of/34420766#34420766", "title": "How to wait for the implementation of", "body": "<p>Using the pipeline pattern, and the \"fan out / fan in\" pattern:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n    \"sync\"\n)\n\nfunc main() {\n    file := \"here is first line\\n\" +\n        \"here is second line\\n\" +\n        \"here is line 3\\n\" +\n        \"here is line 4\\n\" +\n        \"here is line 5\\n\" +\n        \"here is line 6\\n\" +\n        \"here is line 7\\n\"\n    scanner := bufio.NewScanner(strings.NewReader(file))\n\n    // all lines onto one channel\n    in := getStrings(scanner)\n\n    // FAN OUT\n    // Multiple functions reading from the same channel until that channel is closed\n    // Distribute work across multiple functions (ten goroutines) that all read from in.\n    xc := fanOut(in, 10)\n\n    // FAN IN\n    // multiplex multiple channels onto a single channel\n    // merge the channels from c0 through c9 onto a single channel\n    for n := range merge(xc) {\n        fmt.Println(n)\n    }\n}\n\nfunc getStrings(scanner *bufio.Scanner) &lt;-chan string {\n    out := make(chan string)\n    go func() {\n        for scanner.Scan() {\n            out &lt;- scanner.Text()\n        }\n        close(out)\n    }()\n    return out\n}\n\nfunc fanOut(in &lt;-chan string, n int) []&lt;-chan string {\n    var xc []&lt;-chan string\n    for i := 0; i &lt; n; i++ {\n        xc = append(xc, parseStrings(in))\n    }\n    return xc\n}\n\nfunc parseStrings(in &lt;-chan string) &lt;-chan string {\n    out := make(chan string)\n    go func() {\n        for n := range in {\n            out &lt;- parseLine(n)\n        }\n        close(out)\n    }()\n    return out\n}\n\nfunc parseLine(line string) string {\n    return line\n}\n\nfunc merge(cs []&lt;-chan string) &lt;-chan string {\n    var wg sync.WaitGroup\n    wg.Add(len(cs))\n\n    out := make(chan string)\n    for _, c := range cs {\n        go func(c &lt;-chan string) {\n            for n := range c {\n                out &lt;- n\n            }\n            wg.Done()\n        }(c)\n    }\n\n    go func() {\n        wg.Wait()\n        close(out)\n    }()\n    return out\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/h9lhyS300w\" rel=\"nofollow\">Check it out on the playground</a>.</p>\n"}], "owner": {"reputation": 164, "user_id": 5707560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5AzNZ.png?s=128&g=1", "display_name": "Yehor Smoliakov", "link": "https://stackoverflow.com/users/5707560/yehor-smoliakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 34420766, "answer_count": 3, "score": 0, "last_activity_date": 1450803124, "creation_date": 1450793821, "question_id": 34417872, "link": "https://stackoverflow.com/questions/34417872/how-to-wait-for-the-implementation-of", "title": "How to wait for the implementation of", "body": "<p>I have a large log file that you want to analyze in parallel.</p>\n\n<p>I have this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    filename := \"log.txt\"\n    threads := 10\n\n    // Read the  file\n    file, err := os.Open(filename)\n    if err != nil {\n        fmt.Println(\"Could not open file with the database.\")\n        os.Exit(1)\n    }\n    defer file.Close()\n\n    scanner := bufio.NewScanner(file)\n\n    // Channel for strings\n    tasks := make(chan string)\n\n    // Run the threads that catch events from the channel and understand one line of the log file\n    for i := 0; i &lt; threads; i++ {\n        go parseStrings(tasks)\n    }\n\n    // Start a thread load lines from a file into the channel\n    go getStrings(scanner, tasks)\n\n    // At this point I have to wait until all of the threads executed\n    // For example, I set the sleep\n    for {\n        time.Sleep(1 * time.Second)\n    }\n}\n\nfunc getStrings(scanner *bufio.Scanner, tasks chan&lt;- string) {\n    for scanner.Scan() {\n        s := scanner.Text()\n        tasks &lt;- s\n    }\n}\n\nfunc parseStrings(tasks &lt;-chan string) {\n    for {\n        s := &lt;-tasks\n        event := parseLine(s)\n        fmt.Println(event)\n    }\n}\n\nfunc parseLine(line string) string {\n    return line\n}\n</code></pre>\n\n<p>Actually, as I wait for the end of all threads?\nI was advised to create a separate thread in which I'll add the result of, but how to add?</p>\n"}, {"tags": ["bash", "shell", "go"], "answers": [{"comments": [{"owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "edited": false, "score": 0, "creation_date": 1450792750, "post_id": 34417179, "comment_id": 56576041, "body": "Thanks @JimB Mh... I am not sure I am following. I am trying to pass an array for args (which is what I was trying to do before including the actual command as first argument) but it complains that <code>cannot use shell_commandArgs (type []string) as type string in argument to exec.Command</code>."}, {"owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "edited": false, "score": 0, "creation_date": 1450793255, "post_id": 34417179, "comment_id": 56576388, "body": "Maybe I have misinterpreted what you were suggesting. Now I have created a string variable that contains <code>ls</code> and another string variable (not a slice) that contains <code>-la &#47;var</code>. This works better and it executes but for some reasons it is misinterpreted (it exits 1 instead of listing the content of <code>&#47;var</code>). With one argument only (e.g. <code>-la</code> it works just fine."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "edited": false, "score": 0, "creation_date": 1450793667, "post_id": 34417179, "comment_id": 56576644, "body": "Every argument is separate. The full string <code>&quot;-la &#47;var&quot;</code> isn&#39;t a valid argument to <code>ls</code> -- you want <code>&quot;-la&quot;, &quot;&#47;var&quot;</code>."}, {"owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "edited": false, "score": 0, "creation_date": 1450793905, "post_id": 34417179, "comment_id": 56576795, "body": "Yes. agreed. That is part of the problem I am trying to solve. I am trying to build a generic function that can accept a variable number of arguments. I originally thought I could pass a slice that contains all the individual arguments and inside the function I&#39;d concatenate them properly to pass them onto the exec.Command instruction."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "edited": false, "score": 1, "creation_date": 1450794105, "post_id": 34417179, "comment_id": 56576917, "body": "@mreferre: You don&#39;t concatenate them, you can do just what I&#39;ve shown here to pass any number of arguments. The <code>exec_cmd</code> function accepts a variadic number of arguments, and passes them all along to <code>exec.Command</code>."}, {"owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "edited": false, "score": 0, "creation_date": 1450794703, "post_id": 34417179, "comment_id": 56577287, "body": "Oh I see what you mean. Silly me that I went down the road of building an array to then decompose it and then concatenate again when I could have done something like: <code>exe_cmd(&quot;ls&quot;, &quot;-la&quot;, &quot;&#47;var&quot;)</code>. What confused me is that I didn&#39;t know that a Go function could accept a variable number of parameters (sorry, I am 6 hours into Go) :) Thanks a lot. Seems to be working now."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1450817715, "last_edit_date": 1450817715, "creation_date": 1450791515, "answer_id": 34417179, "question_id": 34417008, "link": "https://stackoverflow.com/questions/34417008/creating-a-function-that-runs-arbitrary-shell-commands-in-go/34417179#34417179", "title": "Creating a function that runs arbitrary shell commands in Go", "body": "<p>You can simply match the argument signature of the <code>exec.Command</code> function, which is </p>\n\n<pre><code>(name string, arg ...string)\n</code></pre>\n\n<p>And use the variadic syntax to pass the function argument along to <code>exec.Command</code></p>\n\n<pre><code>func execCmd(name string, args ...string) {\n    cmd := exec.Command(name, args...)\n\n    fmt.Printf(\"Command is: %s, %s\", name, args)\n\n    out, err := cmd.Output()\n\n    fmt.Printf(\"OutVar: %s\\n\", out)\n    fmt.Printf(\"ErrVar: %s\\n\", err)\n}\n</code></pre>\n\n<p>Note however, you're not invoking a shell here, so relying on any shell builtin's will fail. </p>\n"}], "owner": {"reputation": 1472, "user_id": 3146741, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/UAcvh.jpg?s=128&g=1", "display_name": "mreferre", "link": "https://stackoverflow.com/users/3146741/mreferre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 34417179, "answer_count": 1, "score": 2, "last_activity_date": 1450817715, "creation_date": 1450790973, "question_id": 34417008, "link": "https://stackoverflow.com/questions/34417008/creating-a-function-that-runs-arbitrary-shell-commands-in-go", "title": "Creating a function that runs arbitrary shell commands in Go", "body": "<p>I am trying to create a generic function in go that takes in input a shell command (with arguments) and execute it. </p>\n\n<p>Note the shell commands may have a different number of arguments. </p>\n\n<p>I understand that the <code>exec.Command()</code> in Go takes as input the format <code>(\"ls\", \"-la\", \"/var\")</code> for the command + arguments. </p>\n\n<p>This code snipped below doesn't work: </p>\n\n<pre><code>func exe_cmd(commandarray []string) {\nvar shell_command string = \"\"\nfor i := 0; i &lt; len(commandarray); i++ {\n                  shell_command = shell_command + \" \" + commandarray[i]\n                  }\ncmd := exec.Command(shell_command)\nfmt.Println(\"Command is: \", shell_command)\nfmt.Printf(\"==&gt; Executing: %s\\n\", strings.Join(cmd.Args, \" \"))\nout, err := cmd.Output()\nfmt.Printf(\"OutVar: %s\\n\", out)\nfmt.Printf(\"ErrVar: %s\\n\", err)\n}\n\nfunc dummy() {\ndummycmd := []string{\"ls\", \"-la\", \"/var\"}\nexe_cmd(dummycmd)\n}\n</code></pre>\n\n<p>A the end of the <code>for</code> the <code>shell_command</code> variable will contain <code>\"ls -la /var\"</code> and I am having a hard time to figure out how to form it in a way that is what the input format requires i.e. <code>\"ls\", \"-la\", \"/var\"</code></p>\n\n<p>I have also tried to set <code>dummycmd</code> as a variable with <code>\"ls -la /var\"</code> but I figure that was even worse if requirement is to pass it to the exec.Command in the format above. </p>\n\n<p>Thoughts?  </p>\n\n<p>Thanks. </p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 12908, "user_id": 1201324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hkRLn.jpg?s=128&g=1", "display_name": "Tim Hoffman", "link": "https://stackoverflow.com/users/1201324/tim-hoffman"}, "edited": false, "score": 1, "creation_date": 1450780181, "post_id": 34412688, "comment_id": 56568221, "body": "If you have just created an entity then you once you put() you have the key, so you should be fetching by key not a query and then you will able to deal with the eventual consistency as per the answer below."}], "answers": [{"tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": false, "score": 5, "last_activity_date": 1450778460, "creation_date": 1450778460, "answer_id": 34413074, "question_id": 34412688, "link": "https://stackoverflow.com/questions/34412688/entity-is-not-available-immediately-after-being-put-into-google-app-engine-datas/34413074#34413074", "title": "Entity is not available immediately after being put into Google App Engine Datastore", "body": "<p>You should read about eventual consistency: <a href=\"https://cloud.google.com/appengine/docs/go/datastore/structuring_for_strong_consistency\">https://cloud.google.com/appengine/docs/go/datastore/structuring_for_strong_consistency</a></p>\n\n<p>You could make an ancestor query or you could try to refer to the newly created entity by key. </p>\n"}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1463154892, "creation_date": 1450777211, "last_edit_date": 1463154892, "question_id": 34412688, "link": "https://stackoverflow.com/questions/34412688/entity-is-not-available-immediately-after-being-put-into-google-app-engine-datas", "title": "Entity is not available immediately after being put into Google App Engine Datastore", "body": "<p>My application has a flow as the followings:-</p>\n\n<ol>\n<li>User enters New Entity Page.</li>\n<li>User hits save button, the system puts the new entity into Datastore.</li>\n<li>The system redirects the user immediately to Edit page.</li>\n<li>Edit page makes a query for the newly just inserted entity.</li>\n<li>(Problem) newly inserted entity sometimes were not available.</li>\n</ol>\n\n<p>I think it is because Datastore needs to do some data replication therefore the newly inserted data will not be available immediately after the Put(..) function returned. What should I do with the problem or do I need to use transaction?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 377, "user_id": 422959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4217340c86093c3da686bc9d6f2295f?s=128&d=identicon&r=PG", "display_name": "turkishweb", "link": "https://stackoverflow.com/users/422959/turkishweb"}, "edited": false, "score": 2, "creation_date": 1450781389, "post_id": 34412502, "comment_id": 56569115, "body": "why someone should downvote a question like this?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1450787560, "post_id": 34412502, "comment_id": 56572869, "body": "I agree. This question is useful, albeit it could be improved."}, {"owner": {"reputation": 426, "user_id": 1367414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff8fb2b91d470633184505d5e1f15366?s=128&d=identicon&r=PG", "display_name": "Xunnamius", "link": "https://stackoverflow.com/users/1367414/xunnamius"}, "edited": false, "score": 0, "creation_date": 1594090050, "post_id": 34412502, "comment_id": 110997076, "body": "I&#39;ve noticed a lot of strange downvotes around MongoDB questions. I think some people here don&#39;t like MongoDB..."}], "answers": [{"tags": [], "owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "is_accepted": true, "score": 6, "last_activity_date": 1450781397, "creation_date": 1450781397, "answer_id": 34414094, "question_id": 34412502, "link": "https://stackoverflow.com/questions/34412502/delete-all-the-document-older-than-a-date-using-id-in-mongo-using-mgo/34414094#34414094", "title": "Delete all the document older than a date using _id in mongo using mgo", "body": "<p>I really don't like answer my self but since the only help I recive from stackoverflow community was a negative rating (without any explain) I post the solution:</p>\n\n<p>The problem is mgo have <a href=\"https://godoc.org/labix.org/v2/mgo#Collection.RemoveAll\" rel=\"noreferrer\">RemoveAll</a> where delete all the element match the criteria, so my new query is:<code>collection.RemoveAll(bson.M{\"_id\": bson.M{\"$lt\": objectId}})</code></p>\n"}], "owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2172, "favorite_count": 0, "accepted_answer_id": 34414094, "answer_count": 1, "score": 8, "last_activity_date": 1469143286, "creation_date": 1450776626, "last_edit_date": 1469143286, "question_id": 34412502, "link": "https://stackoverflow.com/questions/34412502/delete-all-the-document-older-than-a-date-using-id-in-mongo-using-mgo", "title": "Delete all the document older than a date using _id in mongo using mgo", "body": "<p>I'm working in <code>Golang</code> and <code>mgo</code> and I would like to delete all the documents in a collection older than a specified date, using <code>_id</code> value. </p>\n\n<p>So far I've tried to create a dummy objectId using a struct <code>NewObjectIdWithTime</code> after that I'm trying to delete documents using</p>\n\n<pre><code>collection.Remove(bson.M{\"_id\": bson.M{\"$lt\": objectId}})\n</code></pre>\n\n<p>But I'm not getting any results, any suggestion?</p>\n"}, {"tags": ["go", "bluetooth-lowenergy", "gatt"], "comments": [{"owner": {"reputation": 1486, "user_id": 1037960, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YJ9wv.jpg?s=128&g=1", "display_name": "Zimano", "link": "https://stackoverflow.com/users/1037960/zimano"}, "edited": false, "score": 0, "creation_date": 1450772482, "post_id": 34411267, "comment_id": 56563721, "body": "You need to give more context for an answer that is not too broad. It is most probably because you can&#39;t connect to two devices <i>at the exact same time</i>. You probably were turning both peripherals on <i>before</i> your own software started scanning, right? You were correct when you said you could connect to both if you turned them on one by one, because then your software has time to set up the necessary l2cap socket and whatnot."}, {"owner": {"reputation": 71, "user_id": 5427011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f5a86e0628b23af0594eb757fe3ab2?s=128&d=identicon&r=PG&f=1", "display_name": "waqas", "link": "https://stackoverflow.com/users/5427011/waqas"}, "reply_to_user": {"reputation": 1486, "user_id": 1037960, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YJ9wv.jpg?s=128&g=1", "display_name": "Zimano", "link": "https://stackoverflow.com/users/1037960/zimano"}, "edited": false, "score": 0, "creation_date": 1450773660, "post_id": 34411267, "comment_id": 56564279, "body": "Thanks , yes I turned both peripherals on before started scanning . So what is solution to this problem ? because peripherals should be always on and when I turn my central on , it should connect to all peripherals."}, {"owner": {"reputation": 1486, "user_id": 1037960, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YJ9wv.jpg?s=128&g=1", "display_name": "Zimano", "link": "https://stackoverflow.com/users/1037960/zimano"}, "edited": false, "score": 0, "creation_date": 1450773787, "post_id": 34411267, "comment_id": 56564340, "body": "The solution would be to handle both connections one after another. And not at the same time. It is perfectly fine to have two devices connected as GATT clients though, it is just important to note that you can&#39;t connect to both at the same time! So connect to one, then connect to the other. Both will be connected."}], "owner": {"reputation": 71, "user_id": 5427011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f5a86e0628b23af0594eb757fe3ab2?s=128&d=identicon&r=PG&f=1", "display_name": "waqas", "link": "https://stackoverflow.com/users/5427011/waqas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 757, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1450772215, "creation_date": 1450772215, "question_id": 34411267, "link": "https://stackoverflow.com/questions/34411267/golang-gatt-package-to-connect-multiple-peripherals-at-a-time", "title": "Golang GATT package to connect multiple peripherals at a time", "body": "<p>I'm using Golang GATT package by PayPal and editing its example file explorer.go to connect multiple peripherals at a time. \nThe issue I'm facing is if I try to connect two peripherals at a time , sometimes it connect to both and sometimes it connect to only one. However if I turn on both peripherals one by one, both are connected successfully. </p>\n\n<p>Can you help where may be the issue ? </p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 34060, "user_id": 222467, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e566810c16d40d7ab4f674df14edf6cb?s=128&d=identicon&r=PG", "display_name": "Igor Artamonov", "link": "https://stackoverflow.com/users/222467/igor-artamonov"}, "edited": false, "score": 0, "creation_date": 1450771953, "post_id": 34411106, "comment_id": 56563488, "body": "do you understand that memcache is a temporarily storage, all data can be lost at any moment?"}, {"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "reply_to_user": {"reputation": 34060, "user_id": 222467, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e566810c16d40d7ab4f674df14edf6cb?s=128&d=identicon&r=PG", "display_name": "Igor Artamonov", "link": "https://stackoverflow.com/users/222467/igor-artamonov"}, "edited": false, "score": 0, "creation_date": 1450772601, "post_id": 34411106, "comment_id": 56563772, "body": "Yes, I do. If memcache is lost, the system will write the data to memcache again. But is it secured?"}, {"owner": {"reputation": 34060, "user_id": 222467, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e566810c16d40d7ab4f674df14edf6cb?s=128&d=identicon&r=PG", "display_name": "Igor Artamonov", "link": "https://stackoverflow.com/users/222467/igor-artamonov"}, "edited": false, "score": 0, "creation_date": 1450772951, "post_id": 34411106, "comment_id": 56563936, "body": "ok, I thought you want to use memcache as a main storage"}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "edited": false, "score": 0, "creation_date": 1450798939, "post_id": 34411106, "comment_id": 56580074, "body": "Use sessions instead. Sessions are unique per user, and they are automatically backed by memcache and datastore."}], "answers": [{"comments": [{"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1451104000, "post_id": 34411419, "comment_id": 56678911, "body": "better to use session as a comment says"}, {"owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "reply_to_user": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1451127185, "post_id": 34411419, "comment_id": 56682760, "body": "Can you provide a link for that? The only reference to something similar to session I can find on the App Engine documentation is the Java Servlet API HttpSession."}, {"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1451147004, "post_id": 34411419, "comment_id": 56687451, "body": "explained in my answer"}], "tags": [], "owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "is_accepted": true, "score": 2, "last_activity_date": 1450772834, "creation_date": 1450772834, "answer_id": 34411419, "question_id": 34411106, "link": "https://stackoverflow.com/questions/34411106/is-google-app-engine-memcache-secure/34411419#34411419", "title": "Is Google App Engine memcache secure?", "body": "<p>Yes, Memcache is secure. If you save important content to Memcache you have to back it up on datastore because it can be evicted at any moment. There are datastore APIs on Python (NDB) and Java (Objectify) that manage the cache for you automatically, but I'm not sure about Go.</p>\n\n<p>If your users log in with their Google Account you can use the Users API<a href=\"https://cloud.google.com/appengine/docs/go/users/\" rel=\"nofollow\">1</a>.</p>\n\n<hr>\n"}, {"comments": [{"owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1451148917, "post_id": 34473102, "comment_id": 56687998, "body": "This is a Go question."}, {"owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1451155297, "post_id": 34473102, "comment_id": 56689816, "body": "Ok, I see this is a valid alternative, but it should be noted this is not a feature of App Engine, but a 3rd party package."}, {"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "reply_to_user": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1451155805, "post_id": 34473102, "comment_id": 56689944, "body": "indeed. thou it does the same as the official java and python inplementations in appengine. it does not use a new service, it uses existing datastore and memcache."}, {"owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1451176690, "post_id": 34473102, "comment_id": 56694896, "body": "I don&#39;t see any official Session API for Python either. The Java one is an implementation of HttpSession interface from the Java Servlet API, I guess so already existing Java code that uses this interface continues working on App Engine. Also it is disabled by default for performance reasons."}, {"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "reply_to_user": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1451188773, "post_id": 34473102, "comment_id": 56696562, "body": "its because its not an API. Google provides it in different ways. Python has sessions in webapp2"}], "tags": [], "owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "is_accepted": false, "score": 1, "last_activity_date": 1451149733, "last_edit_date": 1451149733, "creation_date": 1451146946, "answer_id": 34473102, "question_id": 34411106, "link": "https://stackoverflow.com/questions/34411106/is-google-app-engine-memcache-secure/34473102#34473102", "title": "Is Google App Engine memcache secure?", "body": "<p>Yes, memcache is secure as the marked answer says (even shared memcache).</p>\n\n<p>However as one comment says, you should really not reinvent appengine sessions, and instead use them. Google for \"appengine go sessions\" and you will find resources about it. The first link in that search:\n<a href=\"https://godoc.org/code.google.com/p/sadbox/appengine/sessions\" rel=\"nofollow\">https://godoc.org/code.google.com/p/sadbox/appengine/sessions</a></p>\n\n<p>shows you how to use them in Go.</p>\n\n<p>Besides handling the memcache and datastore implementation, it has additional features like configurable expiration.</p>\n"}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 34411419, "answer_count": 2, "score": 0, "last_activity_date": 1477933226, "creation_date": 1450771557, "last_edit_date": 1477933226, "question_id": 34411106, "link": "https://stackoverflow.com/questions/34411106/is-google-app-engine-memcache-secure", "title": "Is Google App Engine memcache secure?", "body": "<p>My application checks user authentication and authorization on every request and I am thinking of moving the authentication and authorization data from datastore to memcache. </p>\n\n<p>Is memcache suitable for this usecase? Is it secure or I should not do it?</p>\n"}, {"tags": ["reflection", "go", "refactoring"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450774905, "post_id": 34410869, "comment_id": 56564923, "body": "Have a look at <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx</a>."}, {"owner": {"reputation": 25, "user_id": 3928922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9110f300ab0e81f1871253241221bf57?s=128&d=identicon&r=PG&f=1", "display_name": "The Genius 2000", "link": "https://stackoverflow.com/users/3928922/the-genius-2000"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450775835, "post_id": 34410869, "comment_id": 56565460, "body": "Thanks...that should solve the scanning repetition, any suggestions about the 3 functions &amp; reflection in general?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3928922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9110f300ab0e81f1871253241221bf57?s=128&d=identicon&r=PG&f=1", "display_name": "The Genius 2000", "link": "https://stackoverflow.com/users/3928922/the-genius-2000"}, "edited": false, "score": 0, "creation_date": 1450786170, "post_id": 34415145, "comment_id": 56572064, "body": "Yes, it was nearly perfect. All I had to do is return the row because Scan() treats dest as the first in a series of items. Thanks!"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 2, "last_activity_date": 1450784485, "creation_date": 1450784485, "answer_id": 34415145, "question_id": 34410869, "link": "https://stackoverflow.com/questions/34410869/avoiding-reflection-how-best-can-i-refactor-this-code/34415145#34415145", "title": "Avoiding reflection - How best can I refactor this code?", "body": "<p>Something like:</p>\n\n<pre><code>func LoadObject(sql string, id int, dest ...interface{}) error {\n    db := tools.OpenDB()\n    defer db.Close()\n    stmt, err := db.Prepare(sql)\n    if err != nil {\n        log.Panic(err)\n    }   \n    defer stmt.Close()\n    return stmt.QueryRow(id).Scan(dest)\n}\n\n// Loads the company from the database with the given id.\nfunc LoadCompany(id int) (c Company, err error) {\n    err = LoadObject(\"SELECT * FROM companies WHERE id = ?\", &amp;c.id,\n        &amp;c.FullName, &amp;c.Name, &amp;c.History, &amp;c.Overview, &amp;c.Est, &amp;c.Phone, &amp;c.Website, &amp;c.Email)\n    return\n}\n</code></pre>\n\n<p>Note that I haven't compiled this code, but hopefully it is good enough to give you an idea.</p>\n\n<p>A few suggestions:</p>\n\n<ul>\n<li>Read through the docs: <a href=\"https://golang.org/pkg/database/sql/\" rel=\"nofollow\">https://golang.org/pkg/database/sql/</a></li>\n<li>create <code>sql.DB</code> instance once on program start up</li>\n<li>specify column order explicitly in the SQL statements (<code>select full_name, history, .... from companies ....</code>)</li>\n</ul>\n"}], "owner": {"reputation": 25, "user_id": 3928922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9110f300ab0e81f1871253241221bf57?s=128&d=identicon&r=PG&f=1", "display_name": "The Genius 2000", "link": "https://stackoverflow.com/users/3928922/the-genius-2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 34415145, "answer_count": 1, "score": 1, "last_activity_date": 1450784485, "creation_date": 1450770577, "last_edit_date": 1450772613, "question_id": 34410869, "link": "https://stackoverflow.com/questions/34410869/avoiding-reflection-how-best-can-i-refactor-this-code", "title": "Avoiding reflection - How best can I refactor this code?", "body": "<p>I started experimenting with Go, and so far it's been a blast. I decided to make a small app which will help a friend organize information business-related information in his (small) company, and I thought I would use Go to implement it.</p>\n\n<p>I haven't (exactly) run into a problem, it's more of a question, when should I consider using reflection? For example, I have 3 related types: <code>Company</code>, <code>Project</code> and <code>Staff</code>. They all have several fields in common (such as <code>id</code>,<code>name</code>) so as you can imagine, the functions that load them from the database (I'm using <code>MySQL</code>) are all very similar.</p>\n\n<p>Look at <code>LoadCompany()</code>, <code>LoadStaff()</code>, and <code>LoadProject()</code> :</p>\n\n<pre><code>// Loads the company from the database with the given id.\nfunc LoadCompany(id int) (Company, error) {\n    db := tools.OpenDB()\n    defer db.Close()\n    stmt, err := db.Prepare(\"SELECT * FROM companies WHERE id = ?\")\n    if err != nil {\n        log.Panic(err)\n    }   \n    var c Company \n    err = stmt.QueryRow(id).Scan(&amp;c.id, &amp;c.FullName, &amp;c.Name, &amp;c.History, &amp;c.Overview, &amp;c.Est, &amp;c.Phone, &amp;c.Website, &amp;c.Email)\n    if err != nil {\n        return Company{}, err \n    }   \n    return c, nil \n}\n\n// Loads the staff from the database with the given id.\nfunc LoadStaff(id int) (Staff, error) {\n    db := tools.OpenDB()\n    defer db.Close()\n    stmt, err := db.Prepare(\"SELECT * FROM staff WHERE id = ?\")\n    if err != nil {\n        log.Panic(err)\n    }\n    var s Staff\n    err = stmt.QueryRow(id).Scan(&amp;s.id, &amp;s.FullName, &amp;s.Name, &amp;s.Email, &amp;s.Joined, &amp;s.Left, &amp;s.History, &amp;s.Phone, &amp;s.Position)\n    if err != nil {\n        return Staff{}, err\n    }\n    return s, nil\n}\n\n// Loads the project from the database with the given id.\nfunc LoadProject(id int) (Project, error) {\n    db := tools.OpenDB()\n    defer db.Close()\n    stmt, err := db.Prepare(\"SELECT * FROM projects WHERE id = ?\")\n    if err != nil {\n        log.Panic(err)\n    }\n    var p Project\n    err = stmt.QueryRow(id).Scan(&amp;p.id, &amp;p.Title, &amp;p.Overview, &amp;p.Value, &amp;p.Started, &amp;p.Finished, &amp;p.Client, &amp;p.Architect, &amp;p.Status)\n    if err != nil {\n        return Project{}, err\n    }\n    return p, nil\n}\n</code></pre>\n\n<p>When I wrote <code>LoadCompany()</code>, I was feeling pretty good about myself (<em>ahem</em> as a beginner/intermediate programmer) because it seemed minimal and clean. But as I wrote <code>LoadStaff()</code> and <code>LoadProject()</code>, all I was doing is copying and tweaking. I'm certain there's a better way to do this, but I'm weary of jumping into reflection, after reading <a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\">Pike's post on it</a>:</p>\n\n<blockquote>\n  <p>[Reflection is] a powerful tool that should be used with care and avoided unless strictly necessary. </p>\n</blockquote>\n\n<p>So my question is, should I use reflection, and if so, can you give me some pointers on the best technique for something like this? This is only the tip of the iceberg, because I feel as though the rest of the functions and methods relating to these types are all similarly repetitive (and don't get me started on the tests!).</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-sdk", "aws-iot", "aws-sdk-go"], "comments": [{"owner": {"reputation": 23680, "user_id": 2414957, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0MuAW.jpg?s=128&g=1", "display_name": "Mona Jalal", "link": "https://stackoverflow.com/users/2414957/mona-jalal"}, "edited": false, "score": 0, "creation_date": 1457239271, "post_id": 34409792, "comment_id": 59313568, "body": "Hey Josiah, can you please have a look at my question? I am lost on how to find the accessKeyId <a href=\"http://stackoverflow.com/questions/35823058/aws-iot-describe-endpointyou-must-specify-a-region\" title=\"aws iot describe endpointyou must specify a region\">stackoverflow.com/questions/35823058/&hellip;</a>"}, {"owner": {"reputation": 453, "user_id": 280548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704a932e80905fab4aef95920f20e85e?s=128&d=identicon&r=PG", "display_name": "Jason D.", "link": "https://stackoverflow.com/users/280548/jason-d"}, "edited": false, "score": 0, "creation_date": 1464283206, "post_id": 34409792, "comment_id": 62433207, "body": "Hi Josiah, are you still having this issue? Have you verified that the topic is owned by the account your request is being made with, and that the region being use is correct. Does it help if you use the IoT control plane API &quot;IoT.DescribeEndpoint&quot; to get the endpoint address instead of hardcoding it?"}, {"owner": {"reputation": 199, "user_id": 2999721, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4f295d5bdebbf607ad32f7ce5036aded?s=128&d=identicon&r=PG", "display_name": "jsgoecke", "link": "https://stackoverflow.com/users/2999721/jsgoecke"}, "edited": false, "score": 1, "creation_date": 1464714094, "post_id": 34409792, "comment_id": 62591798, "body": "Did you ever get this working in Golang? As I have the same issue."}, {"owner": {"reputation": 1128, "user_id": 2643565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22540b310c40f56070bb367bcdad5c79?s=128&d=identicon&r=PG", "display_name": "lazieburd", "link": "https://stackoverflow.com/users/2643565/lazieburd"}, "edited": false, "score": 0, "creation_date": 1464871699, "post_id": 34409792, "comment_id": 62669324, "body": "This worked for me as written, I was able to push MQTT message to a topic, however, I realized I need to use my thing public key as credentials and NOT my AWS credentials.  I see nothing in Config.Credentials struct to specify keys yet. Tip: Add to aws.Config{}    LogLevel: aws.LogLevel(aws.LogDebug), to see what&#39;s happening and use MQTT client in AWS console to see incoming message"}, {"owner": {"reputation": 1128, "user_id": 2643565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22540b310c40f56070bb367bcdad5c79?s=128&d=identicon&r=PG", "display_name": "lazieburd", "link": "https://stackoverflow.com/users/2643565/lazieburd"}, "edited": false, "score": 0, "creation_date": 1465852033, "post_id": 34409792, "comment_id": 63064229, "body": "Also note, you&#39;ll eventually run into this issue <a href=\"https://github.com/aws/aws-sdk-go/issues/706\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-go/issues/706</a> where you cannot auth using device certs."}, {"owner": {"reputation": 192, "user_id": 2841181, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a6d29bd82dd9c6c44286a60e7c0ae08?s=128&d=identicon&r=PG&f=1", "display_name": "okmttdhr", "link": "https://stackoverflow.com/users/2841181/okmttdhr"}, "edited": false, "score": 0, "creation_date": 1506486391, "post_id": 34409792, "comment_id": 79835286, "body": "I have the same issue, any updates?"}, {"owner": {"reputation": 71, "user_id": 1482675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c71896cc2ed1c515e02c0817a69e5b78?s=128&d=identicon&r=PG", "display_name": "Craig Swank", "link": "https://stackoverflow.com/users/1482675/craig-swank"}, "edited": false, "score": 0, "creation_date": 1572629164, "post_id": 34409792, "comment_id": 103629960, "body": "I have a working example and the only difference I see between mine and what you posted is my endpoint is passed into the configuration without the &quot;http://&quot; (just like in your working node.js example)"}], "answers": [{"tags": [], "owner": {"reputation": 673, "user_id": 1595262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82cb7b22459aaa7eae5f8a3a0c6bf91?s=128&d=identicon&r=PG", "display_name": "Itamar Lavender", "link": "https://stackoverflow.com/users/1595262/itamar-lavender"}, "is_accepted": false, "score": 0, "last_activity_date": 1566397926, "creation_date": 1566397926, "answer_id": 57593951, "question_id": 34409792, "link": "https://stackoverflow.com/questions/34409792/http-post-to-aws-iot-using-golang-aws-sdk-iotdataplane/57593951#57593951", "title": "HTTP POST to AWS IoT using Golang-AWS-SDK IoTDataPlane", "body": "<p>If still relevant to anyone...\nuse Credentials *credentials.Credentials in aws.Config</p>\n\n<p>see docs at:\n<a href=\"https://godoc.org/github.com/aws/aws-sdk-go/aws#Config\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/aws/aws-sdk-go/aws#Config</a></p>\n"}], "owner": {"reputation": 1749, "user_id": 4523809, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152801229048124/picture?type=large", "display_name": "Josiah Choi", "link": "https://stackoverflow.com/users/4523809/josiah-choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2601, "favorite_count": 2, "answer_count": 1, "score": 7, "last_activity_date": 1566397926, "creation_date": 1450766001, "last_edit_date": 1489194019, "question_id": 34409792, "link": "https://stackoverflow.com/questions/34409792/http-post-to-aws-iot-using-golang-aws-sdk-iotdataplane", "title": "HTTP POST to AWS IoT using Golang-AWS-SDK IoTDataPlane", "body": "<p>I want to send a message to a MQTT topic via AWS IoT in golang using AWS-SDK via HTTP,<br>\nwhen tried with below code it was unsuccessful. The response was :</p>\n\n<pre><code>ResourceNotFoundException: Not Found\nstatus code: 404, request id: 3d2c0f11-09f6-4e86-94bf-ea877a30ebcd\n</code></pre>\n\n<p>The following is the code I use:</p>\n\n<pre><code>package main\n\n\nimport (\n        \"github.com/aws/aws-sdk-go/aws\"\n        \"github.com/aws/aws-sdk-go/aws/session\"\n        \"github.com/aws/aws-sdk-go/service/iotdataplane\"\n        \"fmt\"\n)\n\n\nfunc main(){\nsvc := iotdataplane.New(session.New(), &amp;aws.Config {Region: aws.String(\"us-west-2\"), Endpoint: aws.String(\"https://YOUR_PREFIX.iot.us-west-2.amazonaws.com\")})\n\nparams := &amp;iotdataplane.PublishInput{\n        Topic:   aws.String(\"mytopic\"), // Required\n        Payload: []byte(\"PAYLOAD\"),\n        Qos:     aws.Int64(0),\n}\nresp, err := svc.Publish(params)\n\nif err != nil {\n        // Print the error, cast err to awserr.Error to get the Code and\n        // Message from an error.\n        fmt.Println(err.Error())\n        return\n}\n\n// Pretty-print the response data.\nfmt.Println(resp)\n</code></pre>\n\n<p>And I also verified there have valid credential setting and policies verified for my AWS account. The following is my aws credentials in ~/.aws/credentials</p>\n\n<pre><code>[default]\naws_access_key_id = YOUR_ACCESS_KEY_ID\naws_secret_access_key = YOUR_SECRET_ACCESS_KEY\n</code></pre>\n\n<p>and Policy attached into your identities:</p>\n\n<pre><code>{\n\"Version\": \"2012-10-17\",\n\"Statement\": [\n    {\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"iot:*\"\n        ],\n        \"Resource\": \"*\"\n   }\n]\n</code></pre>\n\n<p>}</p>\n\n<p>I also tried with Node.JS it works!! The following is the WORKING source in Node for reference:</p>\n\n<pre><code>var    AWS = require('aws-sdk');\n\nAWS.config.update({region: 'us-west-2'});\nvar iotdata = new AWS.IotData({endpoint: 'YOUR_PREFIX.iot.us-west-2.amazonaws.com'});\n\n\nvar params = {\n  topic: 'mytopic', /* required */\n  payload: new Buffer('hello') || 'STRING_VALUE',\n  qos: 0\n};\n\niotdata.publish(params, function(err, data) {\n  if (err) console.log(err, err.stack); // an error occurred\n  else     console.log(data);           // successful response\n});\n</code></pre>\n\n<p>For the Node JS works, it need a proper AWS.config file in the root folder. Like this:</p>\n\n<pre><code>accessKeyId = YOUR_ACCESS_KEY_ID\nsecretAccessKey = YOUR_SECRET_ACCESS_KEY\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1448, "user_id": 3990714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9d3ffcc10f19da50e8c320016137dd7?s=128&d=identicon&r=PG&f=1", "display_name": "nonamorando", "link": "https://stackoverflow.com/users/3990714/nonamorando"}, "is_accepted": true, "score": 0, "last_activity_date": 1450762997, "creation_date": 1450762997, "answer_id": 34409180, "question_id": 34408854, "link": "https://stackoverflow.com/questions/34408854/how-can-i-access-an-array-of-commands-w-cli-in-go/34409180#34409180", "title": "How can I access an array of commands w/ Cli in Go?", "body": "<p>Ok, so what I did was create two arrays of the same contents and just removed elements accordingly to create an array of only the raw commands.</p>\n\n<pre><code>func noFlagCliArgs(cliArgs []string) []string {\n    a := cliArgs\n    for pos, arg := range cliArgs {\n        if strings.Compare(string(arg[0]), \"-\") == 0 {\n            // Cut out two to get rid of flag and its argument\n            a = append(a[:pos], a[pos+2:]...)\n        }\n    }\n    return a\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1777, "user_id": 398012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5acae9bd48788da33f1cab4eb9a381b?s=128&d=identicon&r=PG", "display_name": "cynicaljoy", "link": "https://stackoverflow.com/users/398012/cynicaljoy"}, "is_accepted": false, "score": 0, "last_activity_date": 1450764982, "creation_date": 1450764982, "answer_id": 34409573, "question_id": 34408854, "link": "https://stackoverflow.com/questions/34408854/how-can-i-access-an-array-of-commands-w-cli-in-go/34409573#34409573", "title": "How can I access an array of commands w/ Cli in Go?", "body": "<p>I think you might not have your flags defined correctly, see this example I cooked up:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n\n    \"github.com/codegangsta/cli\"\n)\n\nfunc main() {\n    app := cli.NewApp()\n    app.Name = \"so-example\"\n    app.Usage = \"Demonstrate CLI usage\"\n\n    app.Commands = []cli.Command{\n        {\n            Name:    \"one\",\n            Usage:   \"first thing\",\n            Flags: []cli.Flag{\n                cli.StringFlag{\n                    Name:  \"test\",\n                    Value: \"foobar\",\n                    Usage: \"something cool\",\n                },\n            },\n            Action: func(c *cli.Context) {\n                fmt.Println(\"completed task\", c.Command.Name, \" with args \", c.Args())\n                if (c.String(\"test\") != \"foobar\") {\n                    fmt.Println(\"Where'd foobar go?\")\n                }\n            },\n        },\n        {\n            Name:    \"two\",\n            Usage:   \"second thing\",\n            Flags: []cli.Flag{\n                cli.StringFlag{\n                    Name:  \"test\",\n                    Value: \"foobar\",\n                    Usage: \"something cool\",\n                },\n            },\n            Action: func(c *cli.Context) {\n                fmt.Println(\"completed task\", c.Command.Name, \" with args \", c.Args())\n                fmt.Println(\"Testing value:\", c.String(\"test\"))\n                if (c.String(\"test\") != \"foobar\") {\n                    fmt.Println(\"Where'd foobar go?\")\n                }\n            },\n        },\n    }\n    app.Run(os.Args)\n}\n</code></pre>\n\n<h2>Quick examples:</h2>\n\n<h3>Without flag</h3>\n\n<pre><code>$ ./sandbox two foo bar hello world\ncompleted task two  with args  [foo bar hello world]\nTesting value: foobar\n</code></pre>\n\n<h3>With flag</h3>\n\n<pre><code>$ ./sandbox two foo bar hello world --test \"see\"\ncompleted task two  with args  [foo bar hello world]\nTesting value: see\nWhere'd foobar go?\n</code></pre>\n"}], "owner": {"reputation": 1448, "user_id": 3990714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9d3ffcc10f19da50e8c320016137dd7?s=128&d=identicon&r=PG&f=1", "display_name": "nonamorando", "link": "https://stackoverflow.com/users/3990714/nonamorando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 34409180, "answer_count": 2, "score": 1, "last_activity_date": 1450764982, "creation_date": 1450761211, "question_id": 34408854, "link": "https://stackoverflow.com/questions/34408854/how-can-i-access-an-array-of-commands-w-cli-in-go", "title": "How can I access an array of commands w/ Cli in Go?", "body": "<p>Currently using <a href=\"https://github.com/codegangsta/cli\" rel=\"nofollow\">Codegangsta's Cli Library</a>. I run a command like so:</p>\n\n<pre><code>myGoProgram arg1 arg2 arg3 --flag1 flag1arg \n</code></pre>\n\n<p>Running </p>\n\n<pre><code>app.Action = func(c *cli.Context) {\n        fmt.Println(\"Context: \", c.Args())\n}\n</code></pre>\n\n<p>returns: <code>[arg1 arg2 arg3 --flag1 flag1arg]</code> (<a href=\"https://godoc.org/github.com/codegangsta/cli#Context.Args\" rel=\"nofollow\">c.Args()'s return type</a>)</p>\n\n<p>How can I access <code>arg1</code>, <code>arg2</code>, and <code>arg3</code>, but not <code>--flag1</code> or <code>flag1arg</code>? Do I have to iterate through this array?</p>\n"}, {"tags": ["http", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "edited": false, "score": 0, "creation_date": 1450765733, "post_id": 34409626, "comment_id": 56560765, "body": "Yes my implementation was starting to look messy like that. Except I was also trying to optionally satisfy http.Flusher, making 8 permutations instead of 4. And I just saw that http.ResponseWriter sometimes also implements io.ReaderFrom, making what 16 permutations?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "edited": false, "score": 0, "creation_date": 1450766626, "post_id": 34409626, "comment_id": 56561090, "body": "How about writing a <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">go generate</a> program to write the code for all of the permutations!  Seriously though, I am hoping that somebody answers with a simple solution."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1450765226, "creation_date": 1450765226, "answer_id": 34409626, "question_id": 34408808, "link": "https://stackoverflow.com/questions/34408808/golang-embed-an-interface-with-additional-hidden-methods/34409626#34409626", "title": "Golang embed an interface with additional hidden methods?", "body": "<p>If you know that the response writer satisfies all of the interfaces listed in the question, then you can do this:</p>\n\n<pre><code>type allResponseWriterInterfaces {\n    http.ResponseWriter\n    http.Hijacker\n    http.CloseNotifier\n    http.Flusher\n}\n\ntype MyWriter struct {\n    BytesWritten int\n    allResponseWriterInterfaces\n}\n\n...\n\naw, ok := w.(allResponseWriterInterfaces)\nif !ok {\n    // oops, response writer does not implement the interfaces\n    // handle the error\n}\nmw := MyWriter{0, aw}\n</code></pre>\n\n<p>It get's messy if the response writer does not satisfy all of the interfaces.  See <a href=\"https://github.com/gorilla/handlers/blob/1af6d56d7cd39d982856bc0cee11142baf392c52/handlers.go#L81-L95\" rel=\"nofollow\">the Gorilla logger</a> for an example of handling the case where the response writer satisfies (http.ResponseWriter, http.CloseNotifier) or (http.ResponseWriter, http.CloseNotifier, http.Hijacker).</p>\n"}, {"tags": [], "owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "is_accepted": false, "score": 0, "last_activity_date": 1452195415, "creation_date": 1452195415, "answer_id": 34663699, "question_id": 34408808, "link": "https://stackoverflow.com/questions/34408808/golang-embed-an-interface-with-additional-hidden-methods/34663699#34663699", "title": "Golang embed an interface with additional hidden methods?", "body": "<p>One solution is the brute-force solution. Actually implement all permutations. I tried this and found out how painful it is. There are 18 permutations!</p>\n\n<p>So here is a general-purpose wrapper. The advantage is that you can re-use this wrapper as many times as you want.</p>\n\n<p>The key is to define an interface like so:</p>\n\n<pre><code>// ResponseWriterTo can proxy requests to an underlying http.ResponseWriter.\n// It is used with CustomResponseWriter to wrap an http.ResponseWriter with\n// custom behavior.\ntype ResponseWriterTo interface {\n    HeaderTo(w http.ResponseWriter) http.Header\n    WriteHeaderTo(w http.ResponseWriter, s int)\n    WriteTo(w http.ResponseWriter, b []byte) (n int, err error)\n\n    // Additional methods that http.ResponseWriter sometimes implements.\n    CloseNotifyTo(w http.CloseNotifier) &lt;-chan bool\n    FlushTo(w http.Flusher)\n    HijackTo(w http.Hijacker) (net.Conn, *bufio.ReadWriter, error)\n\n    // ReaderFrom is used by the http package to optimize reads from TCP\n    // connections or from files.\n    ReadFromTo(w io.ReaderFrom, r io.Reader) (n int64, err error)\n}\n</code></pre>\n\n<p>so that we can define a custom wrapper function (this is the verbose part):</p>\n\n<pre><code>// CustomResponseWriter creates a http.ResponseWriter that implements as many\n// hidden interfaces from the base http.ResponseWriter as are available.\nfunc CustomResponseWriter(base http.ResponseWriter, custom ResponseWriterTo) http.ResponseWriter {\n    rw := &amp;customResponseWriter{base: base, custom: custom}\n\n    // the base http.ResponseWriter can implement many hidden interfaces,\n    // so check all permutations\n\n    type HCFR interface {\n        http.ResponseWriter\n        http.Hijacker\n        http.CloseNotifier\n        http.Flusher\n        io.ReaderFrom\n    }\n    if _, ok := base.(HCFR); ok {\n        return struct {\n            HCFR\n        }{rw}\n    }\n\n    type HCF interface {\n        http.ResponseWriter\n        http.Hijacker\n        http.CloseNotifier\n        http.Flusher\n    }\n    if _, ok := base.(HCF); ok {\n        return struct {\n            HCF\n        }{rw}\n    }\n\n    type HCR interface {\n        http.ResponseWriter\n        http.Hijacker\n        http.CloseNotifier\n        io.ReaderFrom\n    }\n    if _, ok := base.(HCR); ok {\n        return struct {\n            HCR\n        }{rw}\n    }\n\n    type HFR interface {\n        http.ResponseWriter\n        http.Hijacker\n        http.Flusher\n        io.ReaderFrom\n    }\n    if _, ok := base.(HFR); ok {\n        return struct {\n            HFR\n        }{rw}\n    }\n\n    type CFR interface {\n        http.ResponseWriter\n        http.CloseNotifier\n        http.Flusher\n        io.ReaderFrom\n    }\n    if _, ok := base.(CFR); ok {\n        return struct {\n            CFR\n        }{rw}\n    }\n\n    type HC interface {\n        http.ResponseWriter\n        http.Hijacker\n        http.CloseNotifier\n    }\n    if _, ok := base.(HC); ok {\n        return struct {\n            HC\n        }{rw}\n    }\n\n    type HF interface {\n        http.ResponseWriter\n        http.Hijacker\n        http.Flusher\n    }\n    if _, ok := base.(HF); ok {\n        return struct {\n            HF\n        }{rw}\n    }\n\n    type CF interface {\n        http.ResponseWriter\n        http.CloseNotifier\n        http.Flusher\n    }\n    if _, ok := base.(CF); ok {\n        return struct {\n            CF\n        }{rw}\n    }\n\n    type HR interface {\n        http.ResponseWriter\n        http.Hijacker\n        io.ReaderFrom\n    }\n    if _, ok := base.(HR); ok {\n        return struct {\n            HR\n        }{rw}\n    }\n\n    type CR interface {\n        http.ResponseWriter\n        http.CloseNotifier\n        io.ReaderFrom\n    }\n    if _, ok := base.(CR); ok {\n        return struct {\n            CR\n        }{rw}\n    }\n\n    type FR interface {\n        http.ResponseWriter\n        http.Flusher\n        io.ReaderFrom\n    }\n    if _, ok := base.(FR); ok {\n        return struct {\n            FR\n        }{rw}\n    }\n\n    type H interface {\n        http.ResponseWriter\n        http.Hijacker\n    }\n    if _, ok := base.(H); ok {\n        return struct {\n            H\n        }{rw}\n    }\n\n    type C interface {\n        http.ResponseWriter\n        http.CloseNotifier\n    }\n    if _, ok := base.(C); ok {\n        return struct {\n            C\n        }{rw}\n    }\n\n    type F interface {\n        http.ResponseWriter\n        http.Flusher\n    }\n    if _, ok := base.(F); ok {\n        return struct {\n            F\n        }{rw}\n    }\n\n    type R interface {\n        http.ResponseWriter\n        io.ReaderFrom\n    }\n    if _, ok := base.(R); ok {\n        return struct {\n            R\n        }{rw}\n    }\n\n    return struct {\n        http.ResponseWriter\n    }{rw}\n}\n\n// customResponseWriter allows us to adapt a ResponseWriterTo to a ResponseWriter.\ntype customResponseWriter struct {\n    base   http.ResponseWriter\n    custom ResponseWriterTo\n}\n\nfunc (w *customResponseWriter) Header() http.Header         { return w.custom.HeaderTo(w.base) }\nfunc (w *customResponseWriter) Write(b []byte) (int, error) { return w.custom.WriteTo(w.base, b) }\nfunc (w *customResponseWriter) WriteHeader(s int)           { w.custom.WriteHeaderTo(w.base, s) }\nfunc (w *customResponseWriter) CloseNotify() &lt;-chan bool {\n    return w.custom.CloseNotifyTo(w.base.(http.CloseNotifier))\n}\nfunc (w *customResponseWriter) Flush() { w.custom.FlushTo(w.base.(http.Flusher)) }\nfunc (w *customResponseWriter) Hijack() (net.Conn, *bufio.ReadWriter, error) {\n    return w.custom.HijackTo(w.base.(http.Hijacker))\n}\nfunc (w *customResponseWriter) ReadFrom(r io.Reader) (n int64, err error) {\n    return w.custom.ReadFromTo(w.base.(io.ReaderFrom), r)\n}\n</code></pre>\n\n<p>The idea is to embed the correct interface into a struct. Then only the \"right\" methods are exposed.</p>\n"}], "owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1452195415, "creation_date": 1450760937, "question_id": 34408808, "link": "https://stackoverflow.com/questions/34408808/golang-embed-an-interface-with-additional-hidden-methods", "title": "Golang embed an interface with additional hidden methods?", "body": "<p>I want to embed a <code>http.ResponseWriter</code> in a struct. That's fine, it makes sure my struct also implements <code>http.ResponseWriter</code>:</p>\n\n<pre><code>type MyWriter struct {\n    BytesWritten int\n    http.ResponseWriter\n}\n</code></pre>\n\n<p>However, it no longer implements <code>http.Hijacker</code>, <code>http.CloseNotifier</code> or <code>http.Flusher</code> even though the embedded <code>http.ResponseWriter</code> usually does.</p>\n\n<p>Is there some way to do this?</p>\n"}, {"tags": ["sql", "go", "db2", "informix"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1450750139, "post_id": 34407388, "comment_id": 56556623, "body": "I doubt it.  Informix and DB2 are very different databases, even though both are owned by the same company (which also owns Netezza)."}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1450751753, "post_id": 34407388, "comment_id": 56556974, "body": "That&#39;s what I was afraid of..."}, {"owner": {"reputation": 1176, "user_id": 5228248, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VXJ9M2UfpGg/AAAAAAAAAAI/AAAAAAAAADk/G62kxHkYJQI/photo.jpg?sz=128", "display_name": "Lu&#237;s Marques", "link": "https://stackoverflow.com/users/5228248/lu%c3%ads-marques"}, "edited": false, "score": 0, "creation_date": 1450777599, "post_id": 34407388, "comment_id": 56566497, "body": "Informix supports the DRDA protocols, but your Informix DBA must set up the proper &quot;listener&quot; on the informix instance."}], "answers": [{"comments": [{"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1450814209, "post_id": 34410068, "comment_id": 56588624, "body": "Thanks, I&#39;ll try it on community versions first of DB2 and Informix... Will post results."}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1455999384, "post_id": 34410068, "comment_id": 58746432, "body": "Quick update, per hunch, I was able to use ODBC library to connect.  Works perfectly!"}], "tags": [], "owner": {"reputation": 14264, "user_id": 4923755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1sCUT.jpg?s=128&g=1", "display_name": "data_henrik", "link": "https://stackoverflow.com/users/4923755/data-henrik"}, "is_accepted": false, "score": 1, "last_activity_date": 1450767328, "creation_date": 1450767328, "answer_id": 34410068, "question_id": 34407388, "link": "https://stackoverflow.com/questions/34407388/using-db2-driver-with-informix/34410068#34410068", "title": "Using DB2 driver with Informix", "body": "<p>IBM offers integrated driver packages like \"IBM Data Server Driver Package\" that work both with DB2 (on Linux, Unix, and Windows and on z/OS and IBM i) and with Informix. So for your problem of using a third-party driver for the language Go it is very likely that it will work with Informix, too. The <a href=\"https://github.com/ibmdb/python-ibmdb\" rel=\"nofollow\">driver for Python and Django</a> is for DB2 and Informix - other language, same solutions.</p>\n\n<p>Here is the link to an <a href=\"http://www.ibm.com/developerworks/data/library/techarticle/dm-1012dsclidriver/index.html\" rel=\"nofollow\">article describing parts of the driver architecture</a>. At the end of that page are links to download the mentioned IBM Data Server Driver Packages. </p>\n"}], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450767328, "creation_date": 1450749752, "question_id": 34407388, "link": "https://stackoverflow.com/questions/34407388/using-db2-driver-with-informix", "title": "Using DB2 driver with Informix", "body": "<p>I'm new to IBM platforms and will soon be working with an Informix-based system.  My preferred language (Go) has third-party driver for DB2.  </p>\n\n<p>Haven't tried yet, but does anyone know if I can use this driver for Informix too (or can suggest a driver)?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "types"], "answers": [{"comments": [{"owner": {"reputation": 7087, "user_id": 966097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ee7b96184af7d8545fa8516b847401a2?s=128&d=identicon&r=PG", "display_name": "Mike H-R", "link": "https://stackoverflow.com/users/966097/mike-h-r"}, "edited": false, "score": 0, "creation_date": 1450744884, "post_id": 34406759, "comment_id": 56555318, "body": "I linked to that in my question. :)"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1450744971, "post_id": 34406759, "comment_id": 56555342, "body": "You also didn&#39;t provide an answer of any sort, just a statement of fact. Try extending that idea to how you would handle this in Go rather than just stating you can&#39;t overload methods."}, {"owner": {"reputation": 4412, "user_id": 3922295, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d9d14b9e3e69ff6fcc3718f491516f22?s=128&d=identicon&r=PG&f=1", "display_name": "alacy", "link": "https://stackoverflow.com/users/3922295/alacy"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1450745201, "post_id": 34406759, "comment_id": 56555393, "body": "@evanmcdonnal I was in the process of giving a high level explanation of exactly what you have an example of. Typing on a phone is not the most efficient way to answer. +1 to your answer."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450745622, "post_id": 34406759, "comment_id": 56555503, "body": "Ah thank you. Sorry if that comment was rudely worded. Intended to be constructive."}], "tags": [], "owner": {"reputation": 4412, "user_id": 3922295, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d9d14b9e3e69ff6fcc3718f491516f22?s=128&d=identicon&r=PG&f=1", "display_name": "alacy", "link": "https://stackoverflow.com/users/3922295/alacy"}, "is_accepted": false, "score": 0, "last_activity_date": 1450745127, "last_edit_date": 1450745127, "creation_date": 1450744838, "answer_id": 34406759, "question_id": 34406700, "link": "https://stackoverflow.com/questions/34406700/how-can-i-write-a-function-that-takes-either-one-of-many-types-in-go/34406759#34406759", "title": "How can I write a function that takes either one of many types in go?", "body": "<p>Function overloading is not supported in the language. From the official Golang site it says,</p>\n\n<blockquote>Method dispatch is simplified if it doesn't need to do type matching as well. Experience with other languages told us that having a variety of methods with the same name but different signatures was occasionally useful but that it could also be confusing and fragile in practice. Matching only by name and requiring consistency in the types was a major simplifying decision in Go's type system.\n\nRegarding operator overloading, it seems more a convenience than an absolute requirement. Again, things are simpler without it.</blockquote>\n\n<p><a href=\"https://golang.org/doc/faq#overloading\" rel=\"nofollow\">https://golang.org/doc/faq#overloading</a></p>\n\n<p>One potential solution would be to define a high level function that type checks and handles different types similarly to how you would overload multiple functions. See @evanmcdonnal's solution for a great example. </p>\n"}, {"comments": [{"owner": {"reputation": 7087, "user_id": 966097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ee7b96184af7d8545fa8516b847401a2?s=128&d=identicon&r=PG", "display_name": "Mike H-R", "link": "https://stackoverflow.com/users/966097/mike-h-r"}, "edited": false, "score": 0, "creation_date": 1450745161, "post_id": 34406772, "comment_id": 56555384, "body": "Type switch and Type assertions. Thanks, that looks like exactly what I wanted to google. :). Seems a shame that we need to lose type information by casting it to an empty interface. Is there some way of creating a type that is either string or error and saying that our fatal function takes something of that type?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 7087, "user_id": 966097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ee7b96184af7d8545fa8516b847401a2?s=128&d=identicon&r=PG", "display_name": "Mike H-R", "link": "https://stackoverflow.com/users/966097/mike-h-r"}, "edited": false, "score": 0, "creation_date": 1450745542, "post_id": 34406772, "comment_id": 56555478, "body": "@MikeH-R you could declare an interface which both string and err implement. Your use case is a bit odd though. <code>error</code> is actually an interface and it&#39;s only method is <code>Error()</code> which returns the string you want to display as the error. Here&#39;s another idea... Make a single definition of <code>fatal</code> that accepts only <code>error</code> and then do <code>errors.New(theString)</code> when you have a string and pass the error into it. Here&#39;s the error packages source if you&#39;re curious; <a href=\"https://golang.org/src/errors/errors.go\" rel=\"nofollow noreferrer\">golang.org/src/errors/errors.go</a>"}, {"owner": {"reputation": 7087, "user_id": 966097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ee7b96184af7d8545fa8516b847401a2?s=128&d=identicon&r=PG", "display_name": "Mike H-R", "link": "https://stackoverflow.com/users/966097/mike-h-r"}, "edited": false, "score": 0, "creation_date": 1450745827, "post_id": 34406772, "comment_id": 56555557, "body": "Thanks evan, very helpful."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1450746264, "post_id": 34406772, "comment_id": 56555680, "body": "Because fmt.Println contains a superset of the logic in this answer, the function can be simplified to:  <code>func fatal(v interface{}) { fmt.Println(v); os.Exit(1); }</code>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1450747897, "post_id": 34406772, "comment_id": 56556076, "body": "@CodingPickle good update. As pointed out, <code>fmt.Println</code> checks if the type is an error and will print <code>input.Error()</code> if it is so there is actually no need to type assert or do anything if the two types you&#39;re dealing with are string and error. That being said, the question asks how to write a function which accepts multiple types so I supplied a generalized answer that explains how to handle these scenarios in Go, rather than just an example to demonstrate the lack of need in this specific case."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1450744929, "creation_date": 1450744929, "answer_id": 34406772, "question_id": 34406700, "link": "https://stackoverflow.com/questions/34406700/how-can-i-write-a-function-that-takes-either-one-of-many-types-in-go/34406772#34406772", "title": "How can I write a function that takes either one of many types in go?", "body": "<p>The most common way to do this would be to define the method as <code>func fatal(err interface{})</code> then do type assertions or use a type switch within it's body to handle each of the different types. If I were coding for your example it would look like this;</p>\n\n<pre><code>func fatal(err interface{}) {\n     if v, ok := err.(string); ok {\n         fmt.Println(v)\n     }\n     if v, ok := err.(error); ok {\n          fmt.Println(v.Error())\n     } else {\n        // panic ?\n     }\n}\n</code></pre>\n\n<p>Also; here's a quick read about type switches and assertions that may be helpful; <a href=\"http://blog.denevell.org/golang-interface-type-assertions-switch.html\" rel=\"nofollow\">http://blog.denevell.org/golang-interface-type-assertions-switch.html</a>\nYou can also check out effective-go as it has sections on both features.</p>\n"}, {"comments": [{"owner": {"reputation": 7087, "user_id": 966097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ee7b96184af7d8545fa8516b847401a2?s=128&d=identicon&r=PG", "display_name": "Mike H-R", "link": "https://stackoverflow.com/users/966097/mike-h-r"}, "edited": false, "score": 0, "creation_date": 1450745483, "post_id": 34406811, "comment_id": 56555464, "body": "Hi, thanks @voutasaurus. I was just moving from using <code>log.Fatal</code> to something else, It <i>almosts</i> does exactly what I want, but I was getting annoyed by the timestamp that it prints so wrote (or tried to write) a helper function that was similar. (writing a small command line app and the timestamps feel unnecessary). Thanks for the tip and the info on OR types. (then again, you never can get a type system as nice as haskell elsewhere, sigh)."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "reply_to_user": {"reputation": 7087, "user_id": 966097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ee7b96184af7d8545fa8516b847401a2?s=128&d=identicon&r=PG", "display_name": "Mike H-R", "link": "https://stackoverflow.com/users/966097/mike-h-r"}, "edited": false, "score": 2, "creation_date": 1450745853, "post_id": 34406811, "comment_id": 56555565, "body": "You can define your own logger that doesn&#39;t print the timestamp in one line: <a href=\"http://play.golang.org/p/TLMxtCag_0\" rel=\"nofollow noreferrer\">play.golang.org/p/TLMxtCag_0</a>"}, {"owner": {"reputation": 7087, "user_id": 966097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ee7b96184af7d8545fa8516b847401a2?s=128&d=identicon&r=PG", "display_name": "Mike H-R", "link": "https://stackoverflow.com/users/966097/mike-h-r"}, "edited": false, "score": 1, "creation_date": 1450745977, "post_id": 34406811, "comment_id": 56555598, "body": "hahaha, you&#39;re right! Serves me right for not reading up on the log package in the first place. Oh well, at least I learned something."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1450746452, "post_id": 34406811, "comment_id": 56555727, "body": "... or you can change the flags on the default logger to suppress the timestamp:  <code>log.SetFlags(0)</code>."}], "tags": [], "owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "is_accepted": false, "score": 2, "last_activity_date": 1451265400, "last_edit_date": 1451265400, "creation_date": 1450745211, "answer_id": 34406811, "question_id": 34406700, "link": "https://stackoverflow.com/questions/34406700/how-can-i-write-a-function-that-takes-either-one-of-many-types-in-go/34406811#34406811", "title": "How can I write a function that takes either one of many types in go?", "body": "<p>Use log.Fatal() instead. <a href=\"https://golang.org/pkg/log/#Fatal\" rel=\"nofollow\">https://golang.org/pkg/log/#Fatal</a></p>\n\n<p>You can use interface{} but it is not recommended because you lose all the benefits of type checking when you do that. The Go authors get to use interface{} because they understand the appropriate level of additional testing and checks to do when using interface{}. It's much easier (even for intermediate and advanced gophers) to use builtin and standard library functions when something like this is required.</p>\n\n<p>Go does not have algebraic or/sum types either. The standard workaround is to define an and/product type with pointers (e.g. struct{*string, *error}) and go to the effort of making sure you only ever make one of the fields non nil at any point in time.</p>\n"}], "owner": {"reputation": 7087, "user_id": 966097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ee7b96184af7d8545fa8516b847401a2?s=128&d=identicon&r=PG", "display_name": "Mike H-R", "link": "https://stackoverflow.com/users/966097/mike-h-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 34406772, "answer_count": 3, "score": 2, "last_activity_date": 1451265400, "creation_date": 1450744438, "question_id": 34406700, "link": "https://stackoverflow.com/questions/34406700/how-can-i-write-a-function-that-takes-either-one-of-many-types-in-go", "title": "How can I write a function that takes either one of many types in go?", "body": "<p>I'm trying go for a small project and tried to write these functions:</p>\n\n<pre><code>func fatal(reason string) {\n    println(reason)\n    os.Exit(1)\n}\n\nfunc fatal(err error) {\n    fatal(err.Error())\n}\n</code></pre>\n\n<p>After digging about a bit and finding <a href=\"https://stackoverflow.com/questions/23681871/golang-methods-with-same-name-and-arity-but-different-type\">this answer</a>, which referenced <a href=\"https://golang.org/doc/faq#overloading\" rel=\"nofollow\">the docs on overloading</a> I realised that what I was trying to do was illegal in go.</p>\n\n<p>What I want is a simple api that allows me to call fatal with either a string or an error in order to simplify my logic. How do I achieve this or a similar goal? </p>\n\n<p>It would feel inelegant to have <code>func fatal(reason string)</code> along with <code>func fatalErr(err error)</code>, is that what's needed? Am I missing a different feature of the language that allows me to do what I want?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450738259, "post_id": 34405587, "comment_id": 56553161, "body": "It&#39;s hard to tell what you intend to do with channels from that video. Are you trying to stream bytes through a channel? Do you have an example of what you&#39;ve tried?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1450738362, "post_id": 34405587, "comment_id": 56553203, "body": "Channels are a great tool for sharing data between goroutines, it doesn&#39;t really matter what kind of data is, there is one or more appropriate formats for you to use. A <code>[]byte</code> array is certainly an option. &quot;I have heard that many times go channels are overused or unnecessary&quot; - never seen that myself. My experience couldn&#39;t be more opposite. Most people use waitgroups to manage their goroutines instead of channels, writing their concurrent code much like it&#39;s C++ or something rather than making use of channels."}, {"owner": {"reputation": 585, "user_id": 2096729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a88e4cbf821389a6a010f6859cc55e2a?s=128&d=identicon&r=PG", "display_name": "Cole Lawrence", "link": "https://stackoverflow.com/users/2096729/cole-lawrence"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450739185, "post_id": 34405587, "comment_id": 56553517, "body": "@JimB My idea is modular node-based sharing of information so an if-block might look like this: <a href=\"https://gist.github.com/ZombieHippie/4bd31c9a0a70cee4ee93\" rel=\"nofollow noreferrer\">gist.github.com/ZombieHippie/4bd31c9a0a70cee4ee93</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1450739777, "post_id": 34405587, "comment_id": 56553739, "body": "Go team member Andrew Gerrand wrote a synthesizer in Go, so his stuff might be interesting to look at: <a href=\"https://github.com/nf/sigourney\" rel=\"nofollow noreferrer\">github.com/nf/sigourney</a>"}, {"owner": {"reputation": 585, "user_id": 2096729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a88e4cbf821389a6a010f6859cc55e2a?s=128&d=identicon&r=PG", "display_name": "Cole Lawrence", "link": "https://stackoverflow.com/users/2096729/cole-lawrence"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450739792, "post_id": 34405587, "comment_id": 56553743, "body": "@evanmcdonnal here is an example of the IfNode being used: <a href=\"http://play.golang.org/p/UUGaFNVlEJ\" rel=\"nofollow noreferrer\">play.golang.org/p/UUGaFNVlEJ</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1450740160, "post_id": 34405587, "comment_id": 56553873, "body": "My instinct is, you probably don&#39;t need channels because you can probably do what you need to with one CPU if you optimize the most expensive operations (e.g. <a href=\"https://github.com/nf/sigourney/tree/master/fast\" rel=\"nofollow noreferrer\">fast sine</a>), work with chunks (&quot;frames&quot;) at a time (e.g. a few ms not a single sample) , and reuse buffers between frames instead of allocating new ones each time."}], "owner": {"reputation": 585, "user_id": 2096729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a88e4cbf821389a6a010f6859cc55e2a?s=128&d=identicon&r=PG", "display_name": "Cole Lawrence", "link": "https://stackoverflow.com/users/2096729/cole-lawrence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450737763, "creation_date": 1450737763, "question_id": 34405587, "link": "https://stackoverflow.com/questions/34405587/go-channels-for-audio-playback-manipulation-best-design-pattern", "title": "Go channels for audio playback manipulation. Best design pattern?", "body": "<p>I am looking at developing another visual programming environment that sends data between manipulating nodes. I can see go channels as a viable method of transferring data, but I have heard that many times go channels are overused or unnecessary in a majority of applications.</p>\n\n<p>Here is an example of Max MSP which does something similar to what my objectives are with audio manipulation: <a href=\"https://youtu.be/tAtYht4QVnA?t=2m23s\" rel=\"nofollow\">https://youtu.be/tAtYht4QVnA?t=2m23s</a></p>\n\n<p>The dotted lines are wave data, while the slid lines are single values.</p>\n\n<p>So in my application, I want to know if go channels would be appropriate for this, or should I design my own data transfer and manipulation system?</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-iam", "sts-securitytokenservice"], "owner": {"reputation": 53, "user_id": 5098891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b1a1fdaf871a7bd91fed089606accd?s=128&d=identicon&r=PG&f=1", "display_name": "gambol", "link": "https://stackoverflow.com/users/5098891/gambol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1450793112, "creation_date": 1450728794, "last_edit_date": 1450793112, "question_id": 34403619, "link": "https://stackoverflow.com/questions/34403619/aws-sts-assumerolewithwebidentityinput", "title": "aws sts AssumeRoleWithWebIdentityInput", "body": "<p>I'm having problems using the AWS STS service to give temporary user access to the console. I can use the IDP and AssumeRoleWithWebIdentityInput method to retrieve credentials fine and have tested the credentials as working using the aws-cli tools, but providing a redirect into the console simply, despite numerous attempts/permutations doesn't work. I simple get the message: <strong><em>\"Some of your credentials are missing. Please contact your administrator.\"</em></strong>\nNote: the attached policy to the role whom has the trust with custom IDP is AmazonEC2ReadOnlyAccess. Note: I also tried the GetFederatedToken(), which ends the same way; the credentials work for the API, but try the sign-in and redirect I can't access the console. Has anyone come across this? ... this there something i'm missing in the policy to permit console access?</p>\n\n<p>I also tried added the policy document to the request, again, nothing more an then copy and paste of the AmazonEC2ReadOnlyAccess policy, but no dice</p>\n\n<pre><code>// assume the identity - works fine - i recieve my credentials\n// and i can use the access_id, secret and session token placed  \n// a /.aws/credentials fine\n\ninput := &amp;sts.AssumeRoleWithWebIdentityInput{\n            RoleArn:         aws.String(\"arn:aws:iam::ACCOUNT_ID:role/USER-web-identity\"),\n            RoleSessionName:  aws.String(context.email),\n            WebIdentityToken: aws.String(context.token.Encode()),\n            DurationSeconds:  aws.Int64(900),\n        }\n\n.. skipping code\n\n// a then try and give the user access to the console as\n// described in http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_enable-console-custom-url.html\nparams := &amp;url.Values{}\nparams.Add(\"Action\", \"getSigninToken\")\nparams.Add(\"SessionType\", \"json\")\nparams.Add(\"Session\", string(encoded))\n\n\n// I receive the signintoken response fine and encode into a\n// redirect url to the console\nquery := &amp;url.Values{}\nquery.Add(\"Action\", \"login\")\nquery.Add(\"Issuer\", \"https://127.0.0.1:3000/sso/session\")\nquery.Add(\"Destination\", \"https://console.aws.amazon.com\")\nquery.Add(\"SigninToken\", token)\n\ncx.Redirect(http.StatusTemporaryRedirect, fmt.Sprintf(\"%s?%s\", signInURL, query.Encode()))\n\n// get nothing but \"Some of you credentials are missing\"\n</code></pre>\n"}, {"tags": ["go", "apache-spark", "cassandra"], "comments": [{"owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 0, "creation_date": 1450730524, "post_id": 34402549, "comment_id": 56549641, "body": "You could extract the data from Cassandra in Avro and load it in Spark"}], "answers": [{"tags": [], "owner": {"reputation": 2150, "user_id": 2552806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/WrYEO.png?s=128&g=1", "display_name": "Reshef", "link": "https://stackoverflow.com/users/2552806/reshef"}, "is_accepted": true, "score": 4, "last_activity_date": 1450734907, "creation_date": 1450734907, "answer_id": 34404997, "question_id": 34402549, "link": "https://stackoverflow.com/questions/34402549/best-way-to-integrate-go-with-spark/34404997#34404997", "title": "Best way to integrate go with Spark", "body": "<p>I think the best tool to work on Cassandra data with Scala would be <a href=\"https://github.com/datastax/spark-cassandra-connector/blob/master/README.md\" rel=\"nofollow\">spark-cassandra-connector</a> .</p>\n\n<p>It is so easy and powerful.</p>\n"}, {"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 1, "last_activity_date": 1450750859, "creation_date": 1450750859, "answer_id": 34407521, "question_id": 34402549, "link": "https://stackoverflow.com/questions/34402549/best-way-to-integrate-go-with-spark/34407521#34407521", "title": "Best way to integrate go with Spark", "body": "<p>Running applications that are written in non JVM languages (such as Go) on Spark requires support from Spark itself. The resulting application will most likely be slower and won't have access to all Spark features.</p>\n\n<p>To understand what it takes to run a python Spark app you can read <a href=\"https://cwiki.apache.org/confluence/display/SPARK/PySpark+Internals\" rel=\"nofollow\">https://cwiki.apache.org/confluence/display/SPARK/PySpark+Internals</a></p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2139, "favorite_count": 0, "accepted_answer_id": 34404997, "answer_count": 2, "score": 2, "last_activity_date": 1450750859, "creation_date": 1450724342, "question_id": 34402549, "link": "https://stackoverflow.com/questions/34402549/best-way-to-integrate-go-with-spark", "title": "Best way to integrate go with Spark", "body": "<p>I am running a Cassandra and I am using gocql driver to connect to Cassandra.<br>Works really good.<br>\nI am considering using Apache Spark to analyse on data. <br>\nShould I write a Spark application in Scala or Java and then expose the app to go(somehow) - or how would you do it? <br><br>\nI am not aware of any go Spark driver.<br><br>\nAny directions and information is welcome.\nRegards</p>\n"}, {"tags": ["git", "svn", "github", "go"], "comments": [{"owner": {"reputation": 436078, "user_id": 31671, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xEJu4.jpg?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/31671/alex"}, "edited": false, "score": 2, "creation_date": 1450711030, "post_id": 34398910, "comment_id": 56538932, "body": "Bitbucket has free private repos."}, {"owner": {"reputation": 26602, "user_id": 761095, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6qOuP.png?s=128&g=1", "display_name": "bahrep", "link": "https://stackoverflow.com/users/761095/bahrep"}, "edited": false, "score": 2, "creation_date": 1450711276, "post_id": 34398910, "comment_id": 56539103, "body": "This is offtopic on StackOverflow, IMO."}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1450711495, "post_id": 34398910, "comment_id": 56539239, "body": "It&#39;s a question about how to do development in Go. I&#39;d have thought that that&#39;s pretty directly relevant to SO."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 5, "creation_date": 1450711982, "post_id": 34398910, "comment_id": 56539609, "body": "Go has nothing to do with GutHub, it&#39;s just community who chose to share most of the open-source packages there. And <code>go get</code> is only a <i>convenient</i> tool which supports GitHub repositories (but also other). You can use any source control system and keep it anywhere \u2013 just in some cases <code>go get</code> will not work and you will need to checkout repositories manually."}], "answers": [{"comments": [{"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 0, "creation_date": 1450712424, "post_id": 34399317, "comment_id": 56539909, "body": "How did my answer get downvoted at the very instant that I submitted it?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1450712838, "post_id": 34399317, "comment_id": 56540180, "body": "It&#39;s not directly related, but the many import paths pointing to GitHub often causes newcomers to think that GitHub is the only choice."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 3, "creation_date": 1450712842, "post_id": 34399317, "comment_id": 56540183, "body": "Just note we&#39;re talking precisely about <code>go get</code> here and not general go development. <code>go get</code> is a handy tool for fetching packages from the internet, but <code>go build</code> doesn&#39;t care about github and such \u2013 when seeing <code>import &quot;github.com&#47;some&#47;pkg&quot;</code> it just treats it as a <i>path</i> in file system to lookup (relatively to <code>$GOPATH&#47;src</code> or <code>vendor</code> directory in your project)."}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "edited": false, "score": 1, "creation_date": 1450712965, "post_id": 34399317, "comment_id": 56540270, "body": "The thing that tripped me up was the suggestion in <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a> (How to write Go code) that a Github repo is <i>the</i> way to start a project. The comments here have been very helpful in understanding the topic better."}], "tags": [], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "is_accepted": false, "score": 3, "last_activity_date": 1450712372, "creation_date": 1450712372, "answer_id": 34399317, "question_id": 34398910, "link": "https://stackoverflow.com/questions/34398910/does-go-development-require-a-paid-github-account-for-private-development/34399317#34399317", "title": "Does Go development require a paid Github account for private development?", "body": "<p>\"go get\" and the \"import\" statement both support <a href=\"https://golang.org/cmd/go/#hdr-Remote_import_paths\" rel=\"nofollow\">several remote repositories</a>, including:</p>\n\n<ul>\n<li>Bitbucket (Git, Mercurial)</li>\n<li>GitHub (Git)</li>\n<li>Launchpad (Bazaar)</li>\n<li>IBM DevOps Services (Git)</li>\n</ul>\n\n<p>as well as syntax for code hosted on other servers:</p>\n\n<blockquote>\n  <p>For code hosted on other servers, import paths may either be qualified\n  with the version control type, or the go tool can dynamically fetch\n  the import path over https/http and discover where the code resides\n  from a &lt;meta&gt; tag in the HTML.</p>\n  \n  <p>To declare the code location, an import path of the form</p>\n  \n  <p>repository.vcs/path specifies the given repository, with or without\n  the .vcs suffix, using the named version control system, and then the\n  path inside that repository. The supported version control systems\n  are:</p>\n  \n  <ul>\n  <li>Bazaar      .bzr</li>\n  <li>Git         .git</li>\n  <li>Mercurial   .hg</li>\n  <li>Subversion  .svn</li>\n  </ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 8, "last_activity_date": 1450712719, "creation_date": 1450712719, "answer_id": 34399425, "question_id": 34398910, "link": "https://stackoverflow.com/questions/34398910/does-go-development-require-a-paid-github-account-for-private-development/34399425#34399425", "title": "Does Go development require a paid Github account for private development?", "body": "<p><code>go get</code> supports most git, mercurial, bazaar &amp; svn repos, so your own Git server, Bitbucket, GitLab, etc are all acceptable. This is touched on in the docs here: <a href=\"https://golang.org/doc/code.html#PackagePaths\">https://golang.org/doc/code.html#PackagePaths</a></p>\n\n<p>Similarly, you can just create a <code>$GOPATH/src/yourname/yourpkg</code> dir, but you will have a harder time sharing your code with others. </p>\n\n<p>In addition, you can use <a href=\"http://golang.org/cmd/go/#hdr-Remote_import_paths\">remote import paths</a> (aka \"vanity domains\") to allow <code>go get scott.com/pkg/usefulthing</code> instead of directly pointing to GitHub, etc. Useful as you can avoid being tied to a single platform, should you wish to move in the future. </p>\n"}, {"tags": [], "owner": {"reputation": 8069, "user_id": 296923, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb7b3af2d2d967711454dc8d9c21798f?s=128&d=identicon&r=PG", "display_name": "Ziffusion", "link": "https://stackoverflow.com/users/296923/ziffusion"}, "is_accepted": false, "score": 3, "last_activity_date": 1450713018, "creation_date": 1450713018, "answer_id": 34399516, "question_id": 34398910, "link": "https://stackoverflow.com/questions/34398910/does-go-development-require-a-paid-github-account-for-private-development/34399516#34399516", "title": "Does Go development require a paid Github account for private development?", "body": "<p>You don't need to <em>be</em> on Github yourself to use other available repos on Github. Bitbucket offers unlimited private repositories. You can even choose to have a completely local git repository (not using any git hosting service), and still use repos available on Github.</p>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "closed_date": 1450718970, "accepted_answer_id": 34399425, "answer_count": 3, "score": 2, "last_activity_date": 1450713018, "creation_date": 1450710954, "question_id": 34398910, "link": "https://stackoverflow.com/questions/34398910/does-go-development-require-a-paid-github-account-for-private-development", "closed_reason": "Not suitable for this site", "title": "Does Go development require a paid Github account for private development?", "body": "<p>I'm just getting started with Go. I use subversion for most of my development, but the Go tutorial seems to assume that everything is hosted on Github in either a public repository or a (paid) private repository. It looks like I'm forced to choose between:</p>\n\n<ol>\n<li>committing to everybody having access to everything I write,</li>\n<li>spending $7 a month for a private Github repository,</li>\n<li>not using source code control or</li>\n<li>losing the ability to use Go's get/import facility properly</li>\n</ol>\n\n<p>Am I missing something here, or is this really the case?</p>\n"}, {"tags": ["windows", "go", "cmd"], "comments": [{"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1450706935, "post_id": 34397567, "comment_id": 56536242, "body": "Are you sure that <code>cmd &#47;c dir &quot;New Folder&quot;</code> will not work?"}, {"owner": {"reputation": 5905, "user_id": 3962346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vrs0W.jpg?s=128&g=1", "display_name": "Jason Faulkner", "link": "https://stackoverflow.com/users/3962346/jason-faulkner"}, "edited": false, "score": 0, "creation_date": 1450707512, "post_id": 34397567, "comment_id": 56536596, "body": "You can use spaces in commands. I just tested with this full command prompt: <code>C:\\Windows\\System32&gt;cmd &#47;c dir &quot;C:\\program files&quot; &#47;b</code>"}, {"owner": {"reputation": 68521, "user_id": 2128947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ASTM.jpg?s=128&g=1", "display_name": "Magoo", "link": "https://stackoverflow.com/users/2128947/magoo"}, "edited": false, "score": 0, "creation_date": 1450708097, "post_id": 34397567, "comment_id": 56536972, "body": "Please show your attempt by editing-in the code section to your question. Why are you &quot;forced&quot; to use <code>cmd &#47;c</code> and what are you actually trying to do?"}, {"owner": {"reputation": 159, "user_id": 2050150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2443c843dcc1f7f2df89eacf72e23250?s=128&d=identicon&r=PG", "display_name": "pyed", "link": "https://stackoverflow.com/users/2050150/pyed"}, "reply_to_user": {"reputation": 68521, "user_id": 2128947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ASTM.jpg?s=128&g=1", "display_name": "Magoo", "link": "https://stackoverflow.com/users/2128947/magoo"}, "edited": false, "score": 0, "creation_date": 1450716445, "post_id": 34397567, "comment_id": 56542394, "body": "@magoo I&#39;m forced because I&#39;m executing it via Go"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1450716728, "post_id": 34397567, "comment_id": 56542553, "body": "Possible alternatives:  a) Use <a href=\"https://godoc.org/io/ioutil#ReadDir\" rel=\"nofollow noreferrer\">godoc.org/io/ioutil#ReadDir</a> to get a directory listing.  b) Invoke the command directly instead of running it in cmd.exe."}, {"owner": {"reputation": 68521, "user_id": 2128947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ASTM.jpg?s=128&g=1", "display_name": "Magoo", "link": "https://stackoverflow.com/users/2128947/magoo"}, "edited": false, "score": 0, "creation_date": 1450717202, "post_id": 34397567, "comment_id": 56542817, "body": "yes - seems to be a <code>go</code> problem rather than a <code>cmd</code> problem. Perhaps doubling up on the <code>&quot;</code> in the value assigned to <code>cmd</code> (ie <code>cmd := </code>dir &quot;&quot;C:\\Users\\pyed\\Desktop\\new folder&quot;&quot;``) - and that&#39;s a pure guess - I&#39;ve no idea whatever about <code>go</code>. I thought it was a Chinese game..."}, {"owner": {"reputation": 159, "user_id": 2050150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2443c843dcc1f7f2df89eacf72e23250?s=128&d=identicon&r=PG", "display_name": "pyed", "link": "https://stackoverflow.com/users/2050150/pyed"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1450717217, "post_id": 34397567, "comment_id": 56542823, "body": "@CodingPickle <code>dir</code> is part of <code>cmd</code> so it can&#39;t be Invoked directly, I&#39;ve considered writing a lister using ReadDir, but I rather use <code>dir</code> with all its features instead."}, {"owner": {"reputation": 159, "user_id": 2050150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2443c843dcc1f7f2df89eacf72e23250?s=128&d=identicon&r=PG", "display_name": "pyed", "link": "https://stackoverflow.com/users/2050150/pyed"}, "reply_to_user": {"reputation": 68521, "user_id": 2128947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ASTM.jpg?s=128&g=1", "display_name": "Magoo", "link": "https://stackoverflow.com/users/2128947/magoo"}, "edited": false, "score": 0, "creation_date": 1450717431, "post_id": 34397567, "comment_id": 56542948, "body": "@Magoo I added more quotes as you said just for fun, and I got a weird error: <code>The network name cannot be found.</code> \u0ca0_\u0ca0"}], "answers": [{"tags": [], "owner": {"reputation": 159, "user_id": 2050150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2443c843dcc1f7f2df89eacf72e23250?s=128&d=identicon&r=PG", "display_name": "pyed", "link": "https://stackoverflow.com/users/2050150/pyed"}, "is_accepted": false, "score": 0, "last_activity_date": 1450723229, "creation_date": 1450723229, "answer_id": 34402272, "question_id": 34397567, "link": "https://stackoverflow.com/questions/34397567/is-there-a-way-to-escape-spaces-for-the-dir-command/34402272#34402272", "title": "is there a way to escape spaces for the &quot;DIR&quot; command", "body": "<p>so it is probably an <code>exec.Command</code> issue, doing the following works</p>\n\n<pre><code>command := exec.Command(\"cmd\", \"/C\", \"dir\", \"C:\\Users\\pyed\\Desktop\\new folder\")\n</code></pre>\n\n<p>and yes, you don't need to escape the space at all.</p>\n"}], "owner": {"reputation": 159, "user_id": 2050150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2443c843dcc1f7f2df89eacf72e23250?s=128&d=identicon&r=PG", "display_name": "pyed", "link": "https://stackoverflow.com/users/2050150/pyed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 869, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1450723229, "creation_date": 1450706761, "last_edit_date": 1450715595, "question_id": 34397567, "link": "https://stackoverflow.com/questions/34397567/is-there-a-way-to-escape-spaces-for-the-dir-command", "title": "is there a way to escape spaces for the &quot;DIR&quot; command", "body": "<p>I know that <code>dir</code> requires you to double-quote a directory name that has spaces, but I'm forced to use <code>cmd /C</code> which doesn't respect double-quotes</p>\n\n<p>now to list a directory that has a space in its name seems impossible, whereas the <code>CD</code> commands doesn't care at all about spaces, executing <code>&gt; CD New folder</code> will move you to <code>New folder</code> without any issues.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I'm trying to call it from a <code>Go</code> program</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"os/exec\"\n)\n\n// this function wraps up `exec.Command`\nfunc CommandRunner(cmd string) ([]byte, error) {\n    // make stdout and stderr buffers to save the output to\n    var stdout, stderr bytes.Buffer\n    // make up the command\n    command := exec.Command(\"cmd\", \"/C\", cmd)\n    // set stdout and stderr to the command's stdout and stderr\n    command.Stdout = &amp;stdout\n    command.Stderr = &amp;stderr\n\n    // start the command and watch for errors\n    if err := command.Start(); err != nil {\n        // return the err and stderr\n        return stderr.Bytes(), err\n    }\n    // wait for the command to finish\n    if err := command.Wait(); err != nil {\n        // return the err and stderr\n        return stderr.Bytes(), err\n    }\n\n    return stdout.Bytes(), nil\n}\n\nfunc main() {\n    cmd := `dir \"C:\\Users\\pyed\\Desktop\\new folder\"`\n    out, _ := CommandRunner(cmd)\n    fmt.Println(string(out))\n\n}\n</code></pre>\n\n<p>it will return <code>the filename, directory name or volume label syntax is incorrect</code>, any commands without double-quotes will work just fine.</p>\n\n<p>execute <code>cmd /?</code> and read the section that starts with <code>If /C or /K...</code> that what made me say <code>cmd /C</code> doesn't allow double-quotes </p>\n"}, {"tags": ["postgresql", "function", "go"], "answers": [{"tags": [], "owner": {"reputation": 358, "user_id": 4536186, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nNlUY.png?s=128&g=1", "display_name": "Harlam", "link": "https://stackoverflow.com/users/4536186/harlam"}, "is_accepted": true, "score": 0, "last_activity_date": 1450712107, "creation_date": 1450712107, "answer_id": 34399242, "question_id": 34396986, "link": "https://stackoverflow.com/questions/34396986/how-to-get-inout-value-from-a-function-stored-procedure-with-golang/34399242#34399242", "title": "How to get INOUT value from a function (stored procedure)? with GOLANG", "body": "<p>Your function doesn't know what result to return. And it's better to add new variable in function.</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION mytest(\n    IN v_name character varying,\n    IN v_id bigint)\n  RETURNS bigint AS\n$BODY$  \n  DECLARE\n    result bigint;\n  BEGIN  \n    result := v_id + 1;\n    return result;\n  END;\n$BODY$\nLANGUAGE plpgsql VOLATILE\nCOST 100;\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4992628, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-witbjBlgNUU/AAAAAAAAAAI/AAAAAAAAAA0/5BnzF0zyZb8/photo.jpg?sz=128", "display_name": "shang hai old Lee", "link": "https://stackoverflow.com/users/4992628/shang-hai-old-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 1, "accepted_answer_id": 34399242, "answer_count": 1, "score": 2, "last_activity_date": 1450740027, "creation_date": 1450704945, "question_id": 34396986, "link": "https://stackoverflow.com/questions/34396986/how-to-get-inout-value-from-a-function-stored-procedure-with-golang", "title": "How to get INOUT value from a function (stored procedure)? with GOLANG", "body": "<p>ALL\nHow to get a INOUT parameter value from a function(stored procedure) so as,I want to get the value of v_id :</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION mytest(\n    IN v_name character varying,\n    INOUT v_id bigint)\n  RETURNS bigint AS\n$BODY$  \n    Begin  \n        v_id := 99;\n        select  v_name;\n        return ;\n    END;\n    $BODY$\n  LANGUAGE plpgsql VOLATILE\n  COST 100;\n</code></pre>\n\n<p>When I call this func, look this,and I use the library from github.com/lib/pq,and my program has panic:</p>\n\n<pre><code>  func main() {\n    dbstring := \"user=postgres dbname=xxx password=xxx host=127.0.0.1            port=5432  sslmode=disable\"\n    db, err := sql.Open(\"postgres\", dbstring)\n       db.SetMaxIdleConns(4)\n    db.SetMaxOpenConns(10)\n    if err != nil {\n        panic(err)\n    }\nvar mynum int64 = 0\nvar s string\na, err2 :=  db.Query(\"SELECT mytest($1::TEXT,$2::bigint)\",\"lihao\",mynum)\nif err2 != nil {\n    fmt.Fprintln(os.Stderr, \"Error sending mytest:\", err)\n    //os.Exit(1)\n}else{\n    fmt.Fprintln(os.Stdout, \"a is:\",a)\n    fmt.Fprintln(os.Stdout, \"mynum is:\",mynum)\n}\nfor a.Next() {\n    err = a.Scan(&amp;s, &amp;mynum)\n    if err != nil {\n        panic(err)\n    }\n   fmt.Fprintln(os.Stdout, \"mynum is:\",mynum)\n }\n}\n</code></pre>\n\n<p>it is panic, so here:</p>\n\n<pre><code>D:\\Go&gt;fs_con.exe\nError sending mytest: \npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x20 pc=0x48d4b9]\n\ngoroutine 1 [running]:\ndatabase/sql.(*Rows).Next(0x0, 0xc082028018)\nc:/go/src/database/sql/sql.go:1633 +0x29\nmain.main()\nD:/Go/fs_con.go:35 +0x48d\n\ngoroutine 5 [chan receive]:\ndatabase/sql.(*DB).connectionOpener(0xc0820683c0)\nc:/go/src/database/sql/sql.go:634 +0x4c\ncreated by database/sql.Open\nc:/go/src/database/sql/sql.go:481 +0x33d\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "edited": false, "score": 0, "creation_date": 1450708660, "post_id": 34396215, "comment_id": 56537299, "body": "What happens with your code? Do you get any errors?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1450733909, "post_id": 34396215, "comment_id": 56551306, "body": "What was the <b>question</b> again?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3212497"}, "edited": false, "score": 0, "creation_date": 1450817297, "post_id": 34396215, "comment_id": 56589989, "body": "How can I query a user by username in mgo and than update its details ? Basically i dont know how to use Update function in mgo... Thanks for your time."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1450870690, "post_id": 34396215, "comment_id": 56610446, "body": "Ok, can you explain the problems with your code? You might want to read <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a>, which enhances the probability for getting a useful answer <i>drastically</i>. You might find <a href=\"https://en.m.wikipedia.org/wiki/Eric_S._Raymond\" rel=\"nofollow noreferrer\">ESR</a>&#39;s excellent essay <a href=\"http://catb.org/~esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">How To Ask Questions The Smart Way</a> helpful, too."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3212497"}, "edited": false, "score": 0, "creation_date": 1450948471, "post_id": 34396215, "comment_id": 56642031, "body": "I am sorry, I was wondering are you familiar with golang ? Basically you can just copy paste the code and run it yourself . The question is self explanatory. I am not a writer !!!"}, {"owner": {"reputation": 1759, "user_id": 1512962, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/EfW0L.png?s=128&g=1", "display_name": "Anonymous Penguin", "link": "https://stackoverflow.com/users/1512962/anonymous-penguin"}, "edited": false, "score": 1, "creation_date": 1453341906, "post_id": 34396215, "comment_id": 57563555, "body": "You may not be, but that&#39;s not an excuse to clearly document your issue. What&#39;s happening on your side? We don&#39;t see what you&#39;re seeing, and we certainly don&#39;t want to spend a half an hour debugging a program just because you refuse to provide an acceptable explanation. Please remember that we are helping you for free, and you are expected to be nice and cooperative with everyone. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 152, "user_id": 1657083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KD4f8.jpg?s=128&g=1", "display_name": "RadekSohlich", "link": "https://stackoverflow.com/users/1657083/radeksohlich"}, "is_accepted": false, "score": 0, "last_activity_date": 1473608168, "creation_date": 1473608168, "answer_id": 39437767, "question_id": 34396215, "link": "https://stackoverflow.com/questions/34396215/golang-mgo-update-details-for-a-user/39437767#39437767", "title": "Golang, mgo update details for a user", "body": "<p>Well I see at least one problem a that is the case sensitive queries. So if your struct uses lowercase keys in json, you must use a lowercase one.</p>\n\n<pre><code>// This shoud match \n// against the \"Name\" property\nselectedUser := bson.M{\"Name\": username}\n\nupdatedUser := bson.M{\"$set\": bson.M{\n                \"Name\":      r.Form[\"username\"][0],\n                \"Gender\":    r.Form[\"gender\"][0],\n                \"Age\":       r.Form[\"age\"][0],\n                \"CreatedAt\": time.Now(),\n }}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11486905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GyrM.gif?s=128&g=1", "display_name": "Jyotsna Gupta", "link": "https://stackoverflow.com/users/11486905/jyotsna-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1557619651, "creation_date": 1557619651, "answer_id": 56095207, "question_id": 34396215, "link": "https://stackoverflow.com/questions/34396215/golang-mgo-update-details-for-a-user/56095207#56095207", "title": "Golang, mgo update details for a user", "body": "<pre><code>data := model.Data {\n            Name:      r.Form[\"username\"][0],\n            Gender:    r.Form[\"gender\"][0],\n            Age:       r.Form[\"age\"][0],\n            CreatedAt:  time.Now(),\n        }\n\nselectedUser := bson.M{\"name\": username}\nupdatedUser := bson.M{\"$push\": bson.M{\"user\": bson.M{\"$each\": []model.User{data}}}}\nerr = c.Update(selectedUser, updatedUser)\n</code></pre>\n\n<p>This will update the user array against matching username. It would be great if you can share the struct too. I have answered with the assumptions.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3212497"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 516, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557619651, "creation_date": 1450702458, "last_edit_date": 1453343515, "question_id": 34396215, "link": "https://stackoverflow.com/questions/34396215/golang-mgo-update-details-for-a-user", "title": "Golang, mgo update details for a user", "body": "<p>I have been having some trouble updating a user on a mongodatabase. Basically I want to select the user by username and than edit its details. I am using Gorilla Mux and mgo to connect with MongoDB.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>func ViewUserHandler(w http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\n    username := vars[\"username\"]\n    session, err := mgo.Dial(\"mongodb://DATABASE_URL\")\n\n    if err != nil {\n        panic(err)\n    }\n\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n    c := session.DB(\"studnet\").C(\"user\")\n\n    result := Person{}\n    // get the user_id using a hidden field when clicked using javascript\n    err = c.Find(bson.M{\"name\": username}).One(&amp;result)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    if r.Method == \"GET\" {\n        t, _ := template.ParseFiles(\"profile.html\")\n        t.Execute(w, result)\n    }\n    // update the user profile details\n    if r.Method == \"POST\" {\n        r.ParseForm()\n\n        // TODO : update the user\n        selectedUser := bson.M{\"name\": username}\n        updatedUser := bson.M{\"$set\": bson.M{\n            \"Name\":      r.Form[\"username\"][0],\n            \"Gender\":    r.Form[\"gender\"][0],\n            \"Age\":       r.Form[\"age\"][0],\n            \"CreatedAt\": time.Now(),\n        }}\n        err = c.Update(selectedUser, updatedUser)\n\n        if err != nil {\n            panic(err)\n        }\n        http.Redirect(w, r, \"/view/\"+username, 301)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "timeout"], "comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1450800940, "post_id": 34395060, "comment_id": 56581387, "body": "Can you post how youre adding your wait groups and stuff like are you doing it through a loop or??"}, {"owner": {"reputation": 3988, "user_id": 623999, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c070b9baf7a3fe991ff6f596375572b5?s=128&d=identicon&r=PG", "display_name": "jab", "link": "https://stackoverflow.com/users/623999/jab"}, "edited": false, "score": 0, "creation_date": 1466448489, "post_id": 34395060, "comment_id": 63310119, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/32840687/timeout-for-waitgroup-wait\">Timeout for WaitGroup.Wait()</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "is_accepted": false, "score": 1, "last_activity_date": 1450846904, "last_edit_date": 1450846904, "creation_date": 1450818328, "answer_id": 34424411, "question_id": 34395060, "link": "https://stackoverflow.com/questions/34395060/how-to-implement-a-timeout-when-using-sync-waitgroup-wait/34424411#34424411", "title": "How to implement a timeout when using sync.WaitGroup.wait?", "body": "<p>Another way to do it would be to monitor it internally, your question is limited but I'm going to assume you're starting your goroutines through a loop even if you're not you can refactor this to work for you but you could do one of these 2 examples, the first one will timeout each request to timeout individually and the second one will timeout the entire batch of requests and move on if too much time has passed </p>\n\n<pre><code>var wg sync.WaitGroup\nwg.Add(1)\ngo func() {\n    success := make(chan struct{}, 1)\n    go func() {\n        // send your request and wait for a response\n        // pretend response was received\n        time.Sleep(5 * time.Second)\n        success &lt;- struct{}{}\n        // goroutine will close gracefully after return     \n        fmt.Println(\"Returned Gracefully\")\n    }()\n\n    select {\n    case &lt;-success:\n        break\n    case &lt;-time.After(1 * time.Second):\n        break\n    }\n\n    wg.Done()\n    // everything should be garbage collected and no longer take up space\n}()\n\nwg.Wait()\n\n// do whatever with what you got    \nfmt.Println(\"Done\")\ntime.Sleep(10 * time.Second)\nfmt.Println(\"Checking to make sure nothing throws errors after limbo goroutine is done\")\n</code></pre>\n\n<p>Or if you just want a general easy way to timeout ALL requests you could do something like</p>\n\n<pre><code>var wg sync.WaitGroup\nwaiter := make(chan int)\nwg.Add(1)\ngo func() {\n    success := make(chan struct{}, 1)\n    go func() {\n        // send your request and wait for a response\n        // pretend response was received\n        time.Sleep(5 * time.Second)\n        success &lt;- struct{}{}\n        // goroutine will close gracefully after return     \n        fmt.Println(\"Returned Gracefully\")\n    }()\n\n    select {\n    case &lt;-success:\n        break\n    case &lt;-time.After(1 * time.Second):\n        // control the timeouts for each request individually to make sure that wg.Done gets called and will let the goroutine holding the .Wait close\n        break\n    }\n    wg.Done()\n    // everything should be garbage collected and no longer take up space\n}()\n\ncompleted := false\ngo func(completed *bool) {\n    // Unblock with either wait\n    wg.Wait()\n    if !*completed {\n        waiter &lt;- 1         \n        *completed = true\n    }       \n    fmt.Println(\"Returned Two\")\n}(&amp;completed)\n\ngo func(completed *bool) {\n    // wait however long\n    time.Sleep(time.Second * 5)\n    if !*completed {\n        waiter &lt;- 1         \n        *completed = true\n    }       \n    fmt.Println(\"Returned One\")\n}(&amp;completed)\n\n\n // block until it either times out or .Wait stops blocking \n &lt;-waiter\n\n// do whatever with what you got    \nfmt.Println(\"Done\")\ntime.Sleep(10 * time.Second)\nfmt.Println(\"Checking to make sure nothing throws errors after limbo goroutine is done\")\n</code></pre>\n\n<p>This way your WaitGroup will stay in sync and you won't have any goroutines left in limbo </p>\n\n<p><a href=\"http://play.golang.org/p/g0J_qJ1BUT\" rel=\"nofollow\">http://play.golang.org/p/g0J_qJ1BUT</a> try it here you can change the variables around to see it work differently </p>\n\n<p>Edit: I'm on mobile If anybody could fix the formatting that would be great thanks. </p>\n"}, {"comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450831868, "post_id": 34424586, "comment_id": 56595181, "body": "Not sure why a non-blocking send is needed here, unless it&#39;s only a safety measure in case buffer size doesn&#39;t match number of workers. Otherwise counting (proposed for loop) is most probably a better solution than <code>WaitGroup</code> when workers are producing something on a channel."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1450819179, "creation_date": 1450819179, "answer_id": 34424586, "question_id": 34395060, "link": "https://stackoverflow.com/questions/34395060/how-to-implement-a-timeout-when-using-sync-waitgroup-wait/34424586#34424586", "title": "How to implement a timeout when using sync.WaitGroup.wait?", "body": "<p>Send your results to a buffered channel enough to take all results, without blocking, and read them in for-select loop in the main thread:</p>\n\n<pre><code>func work(msg string, d time.Duration, ret chan&lt;- string) {\n    time.Sleep(d) // Work emulation.\n    select {\n    case ret &lt;- msg:\n    default:\n    }\n}\n\n// ...\n\nconst N = 2\nch := make(chan string, N)\n\ngo work(\"printed\", 100*time.Millisecond, ch)\ngo work(\"not printed\", 1000*time.Millisecond, ch)\n\ntimeout := time.After(500 * time.Millisecond)\nloop:\nfor received := 0; received &lt; N; received++ {\n    select {\n    case msg := &lt;-ch:\n        fmt.Println(msg)\n    case &lt;-timeout:\n        fmt.Println(\"timeout!\")\n        break loop\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/PxeEEJo2dz\" rel=\"nofollow\">http://play.golang.org/p/PxeEEJo2dz</a>.</p>\n\n<p>See also: <a href=\"http://blog.golang.org/go-concurrency-patterns-timing-out-and\" rel=\"nofollow\">Go Concurrency Patterns: Timing out, moving on</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 29, "last_activity_date": 1450828489, "creation_date": 1450828489, "answer_id": 34426463, "question_id": 34395060, "link": "https://stackoverflow.com/questions/34395060/how-to-implement-a-timeout-when-using-sync-waitgroup-wait/34426463#34426463", "title": "How to implement a timeout when using sync.WaitGroup.wait?", "body": "<p>If all you want is your neat select, you can easily convert blocking function to a channel by spawning a routine which calls a method and closes/sends on channel once done.</p>\n\n<pre><code>done := make(chan struct{})\ngo func() {\n   wg.Wait()\n   close(done)\n}()\n\nselect {\ncase &lt;-done:\n// All done!\ncase &lt;-time.After(500 * time.Millisecond):\n// Hit timeout.\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 8109026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jomoj.jpg?s=128&g=1", "display_name": "Raed Shomali", "link": "https://stackoverflow.com/users/8109026/raed-shomali"}, "is_accepted": false, "score": 1, "last_activity_date": 1498539080, "last_edit_date": 1498539080, "creation_date": 1498404088, "answer_id": 44747765, "question_id": 34395060, "link": "https://stackoverflow.com/questions/34395060/how-to-implement-a-timeout-when-using-sync-waitgroup-wait/44747765#44747765", "title": "How to implement a timeout when using sync.WaitGroup.wait?", "body": "<p>If you would like to avoid mixing concurrency logic with business logic, I wrote this library <a href=\"https://github.com/shomali11/parallelizer\" rel=\"nofollow noreferrer\">https://github.com/shomali11/parallelizer</a> to help you with that. It encapsulates the concurrency logic so you do not have to worry about it.</p>\n\n<p>So in your example:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/shomali11/parallelizer\"\n    \"fmt\"\n)\n\nfunc main() {\n    urls := []string{ ... }\n    results = make([]*HttpResponse, len(urls)\n\n    options := &amp;Options{ Timeout: time.Second }\n    group := parallelizer.NewGroup(options)\n    for index, url := range urls {\n        group.Add(func(index int, url string, results *[]*HttpResponse) {\n            return func () {\n                ...\n\n                results[index] = &amp;HttpResponse{url, response, err}\n            }\n        }(index, url, &amp;results))\n    }\n\n    err := group.Run()\n\n    fmt.Println(\"Done\")\n    fmt.Println(fmt.Sprintf(\"Results: %v\", results))\n    fmt.Printf(\"Error: %v\", err) // nil if it completed, err if timed out\n}\n</code></pre>\n"}], "owner": {"reputation": 3121, "user_id": 1889327, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/lFDYA.jpg?s=128&g=1", "display_name": "andy", "link": "https://stackoverflow.com/users/1889327/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8438, "favorite_count": 4, "accepted_answer_id": 34426463, "answer_count": 4, "score": 12, "last_activity_date": 1498539080, "creation_date": 1450698738, "last_edit_date": 1450782290, "question_id": 34395060, "link": "https://stackoverflow.com/questions/34395060/how-to-implement-a-timeout-when-using-sync-waitgroup-wait", "title": "How to implement a timeout when using sync.WaitGroup.wait?", "body": "<p>I have come across a situation that i want to trace some goroutine to sync on a specific point, for example when all the urls are fetched. Then, we can put them all and show them in specific order. </p>\n\n<p>I think this is the <strong>barrier</strong> comes in. It is in <code>go</code> with <code>sync.WaitGroup</code>. However, in real situation that we can not make sure that all the fetch operation will succeed in a short time. So, i want to introduce a timeout when <code>wait</code> for the fetch operations.</p>\n\n<p>I am a newbie to <code>Golang</code>, so can someone give me some advice?</p>\n\n<hr>\n\n<p>What i am looking for is like this:</p>\n\n<pre><code>   wg := &amp;sync.WaigGroup{}\n   select {\n   case &lt;-wg.Wait():\n   // All done!\n   case &lt;-time.After(500 * time.Millisecond):\n   // Hit timeout.\n   }\n</code></pre>\n\n<p>I know <code>Wait</code> do not support <code>Channel</code>.</p>\n"}, {"tags": ["encryption", "go", "rsa", "public-key-encryption"], "comments": [{"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450682364, "post_id": 34389421, "comment_id": 56522400, "body": "Please edit with the full output of the error (stack trace included). Also you should definitely be handling the error returned by EncryptPKCS1v15 (not the source of the problem but it&#39;ll be a source of future problems)."}, {"owner": {"reputation": 2861, "user_id": 1242186, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/GeXMz.jpg?s=128&g=1", "display_name": "cnaize", "link": "https://stackoverflow.com/users/1242186/cnaize"}, "reply_to_user": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450688252, "post_id": 34389421, "comment_id": 56525050, "body": "@voutasaurus <code>pem.Decode</code> doesn&#39;t provide any errors, it just returns <code>nil block</code>"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450688697, "post_id": 34389421, "comment_id": 56525297, "body": "Oh, right. So your data is probably incorrect. Put in a log.Println(data) and see whether it matches your file. If it does then the file itself is not in pem format. Check the file has the PEM header/footer (i.e. the BEGIN CERTIFICATE and END CERTIFICATE thing)."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450691234, "post_id": 34389421, "comment_id": 56526659, "body": "Also as an aside I recommend just using log instead of glog (tutorial: <a href=\"http://www.goinggo.net/2013/11/using-log-package-in-go.html\" rel=\"nofollow noreferrer\">goinggo.net/2013/11/using-log-package-in-go.html</a>)."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450691417, "post_id": 34389421, "comment_id": 56526775, "body": "Does the ssh key stored in id_rsa actually work otherwise? Also is it password protected?"}, {"owner": {"reputation": 2861, "user_id": 1242186, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/GeXMz.jpg?s=128&g=1", "display_name": "cnaize", "link": "https://stackoverflow.com/users/1242186/cnaize"}, "reply_to_user": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450692615, "post_id": 34389421, "comment_id": 56527537, "body": "@voutasaurus yes, the public key must to be valid, because I use it on github for example, it starts with <code>ssh-rsa</code>, is it ok? and yes, it password protected. how to parse it correctly?"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450693013, "post_id": 34389421, "comment_id": 56527771, "body": "Take a look at the x509 package. <a href=\"https://golang.org/pkg/crypto/x509/#DecryptPEMBlock\" rel=\"nofollow noreferrer\">golang.org/pkg/crypto/x509/#DecryptPEMBlock</a>  FYI the public key is probably not encrypted. But the password will be required if you want to read the private key."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450693752, "post_id": 34389421, "comment_id": 56528249, "body": "Given that it&#39;s a public key that you&#39;re trying to read, would you consider posting it here?"}, {"owner": {"reputation": 2861, "user_id": 1242186, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/GeXMz.jpg?s=128&g=1", "display_name": "cnaize", "link": "https://stackoverflow.com/users/1242186/cnaize"}, "reply_to_user": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450702906, "post_id": 34389421, "comment_id": 56533819, "body": "@voutasaurus nevermind, after generating key-pair with <code>openssl</code>, everything works, thanks for your help"}], "owner": {"reputation": 2861, "user_id": 1242186, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/GeXMz.jpg?s=128&g=1", "display_name": "cnaize", "link": "https://stackoverflow.com/users/1242186/cnaize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 620, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450699797, "creation_date": 1450675348, "last_edit_date": 1450699797, "question_id": 34389421, "link": "https://stackoverflow.com/questions/34389421/pem-decode-returns-nil-when-given-contents-of-id-rsa-pem", "title": "pem.Decode - returns nil when given contents of id_rsa.pem", "body": "<p><br>\nI'm trying to use <code>rsa</code> package for <code>encrypt</code> and <code>decrypt</code> with <code>public</code> and <code>private</code> keys.</p>\n\n<pre><code>func main() {\n    flag.Parse()\n\n    text := \"my super secret\"\n    glog.Infof(\"Original text: %s\\n\", text)\n\n    glog.Infoln(\"Loading public key..\")\n    pubKey, err := loadPublicKey(\"id_rsa.pub\")\n    if err == nil {\n        glog.Infoln(\"SUCCESS!\")\n    } else {\n        glog.Errorln(\"LOOSE =(\")\n    }\n\n    etext, err := encrypt([]byte(text), pubKey)\n    if err != nil {\n        glog.Errorf(\"Can't encrypt text: %+v\\n\", err)\n    }\n    glog.Infof(\"Encrypted text: %s\\n\", etext)\n\n    glog.Infoln(\"Loading private key..\")\n    privKey, err := loadPrivateKey(\"id_rsa\")\n    if err == nil {\n        glog.Infoln(\"SUCCESS!\")\n    } else {\n        glog.Errorln(\"LOOSE =(\")\n    }\n\n    dtext, err := decrypt(etext, privKey)\n    if err != nil {\n        glog.Errorf(\"Can't decrypt text: %+v\\n\", err)\n    }\n    glog.Infof(\"Decrypted text: %s\\n\", dtext)\n\n    glog.Flush()\n}\n\nfunc loadPublicKey(path string) (*rsa.PublicKey, error) {\n    data, err := ioutil.ReadFile(path)\n    if err != nil {\n        return nil, err\n    }\n\n    block, _ := pem.Decode(data)\n    if block == nil {\n        return nil, fmt.Errorf(\"no key found\\n\")\n    }\n\n    if block.Type != \"PUBLIC KEY\" {\n        return nil, fmt.Errorf(\"invalid key type - %s\\n\", block.Type)\n    }\n\n    pubKey, err := x509.ParsePKIXPublicKey(block.Bytes)\n    if err != nil {\n        return nil, fmt.Errorf(\"can't parse key - %+v\\n\", err)\n    }\n\n    return pubKey.(*rsa.PublicKey), nil\n}\n\nfunc loadPrivateKey(path string) (*rsa.PrivateKey, error) {\n    data, err := ioutil.ReadFile(path)\n    if err != nil {\n        return nil, err\n    }\n\n    block, _ := pem.Decode(data)\n    if block == nil {\n        return nil, fmt.Errorf(\"no key found\\n\")\n    }\n\n    if block.Type != \"PRIVATE KEY\" {\n        return nil, fmt.Errorf(\"invalid key type - %s\\n\", block.Type)\n    }\n\n    return x509.ParsePKCS1PrivateKey(block.Bytes)\n}\n\nfunc encrypt(data []byte, pubKey *rsa.PublicKey) ([]byte, error) {\n    return rsa.EncryptPKCS1v15(rand.Reader, pubKey, data)\n}\n\nfunc decrypt(data []byte, privKey *rsa.PrivateKey) ([]byte, error) {\n    return rsa.DecryptPKCS1v15(rand.Reader, privKey, data)\n}\n</code></pre>\n\n<p>But I have an error in <code>rsa.EncryptPKCS1v15</code>:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x5c16c]\n\ngoroutine 1 [running]:\ncrypto/rsa.EncryptPKCS1v15(0x11641f8, 0xc8200762a0, 0x0, 0xc82004ddc8, 0xf, 0x20, 0x0, 0x0, 0x0, 0x0, ...)\n    /usr/local/go/src/crypto/rsa/pkcs1v15.go:32 +0x5c\nmain.encrypt(0xc82004ddc8, 0xf, 0x20, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /Users/cnaize/Dropbox/develop/gocode/src/test/main.go:132 +0x87\nmain.main()\n    /Users/cnaize/Dropbox/develop/gocode/src/test/main.go:67 +0x3b8\n</code></pre>\n\n<p>Why where is the error? How to resolve this?</p>\n\n<p><strong>EDITED</strong>:\n<br>\nthanks, now I understand the problem - in <code>loadPublicKey(\"id_rsa.pub\")</code> <code>pem.Decode(data)</code> returns <code>nil block</code>.\n<br>\nWhat is the right way to parse <code>ssh</code> keys?</p>\n"}, {"tags": ["json", "go", "plaintext"], "comments": [{"owner": {"reputation": 131, "user_id": 2315939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e88dc1843c2d1c713b9c402098f0a0?s=128&d=identicon&r=PG", "display_name": "Dave Strickler", "link": "https://stackoverflow.com/users/2315939/dave-strickler"}, "edited": false, "score": 0, "creation_date": 1450886829, "post_id": 34388758, "comment_id": 56619994, "body": "Thanks for the edit voutasaurus."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 2315939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e88dc1843c2d1c713b9c402098f0a0?s=128&d=identicon&r=PG", "display_name": "Dave Strickler", "link": "https://stackoverflow.com/users/2315939/dave-strickler"}, "edited": false, "score": 0, "creation_date": 1450705852, "post_id": 34388793, "comment_id": 56535571, "body": "This works perfectly - many thanks. I didn&#39;t consider a recursive call into the printing function itself, which of course now is an obvious solution."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1450671143, "last_edit_date": 1450671143, "creation_date": 1450670656, "answer_id": 34388793, "question_id": 34388758, "link": "https://stackoverflow.com/questions/34388758/converting-a-json-dir-tree-into-indented-plain-text-in-golang/34388793#34388793", "title": "Converting a JSON dir tree into indented plain text in GoLang", "body": "<p>Write a function to recurse down the directory tree printing a file and its children. Increase the indent level when recursing down the tree.</p>\n\n<pre><code>func printFile(f *File, indent string) {\n   fmt.Printf(\"%s%s\\n\", indent, f.Name)\n   for _, f := range f.Children {\n     printFile(f, indent+\"  \")\n   }\n}\n</code></pre>\n\n<p>Call the function with the root of the tree:</p>\n\n<pre><code>printFile(root, \"\")\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/ssLo3YpFIY\" rel=\"nofollow\">run the code on the playground</a></kbd></p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 2315939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e88dc1843c2d1c713b9c402098f0a0?s=128&d=identicon&r=PG", "display_name": "Dave Strickler", "link": "https://stackoverflow.com/users/2315939/dave-strickler"}, "edited": false, "score": 0, "creation_date": 1450886933, "post_id": 34388805, "comment_id": 56620050, "body": "Thanks, but json.MarshalIndent outputs JSON (as it should). I was looking for a plain text output that&#39;s more human readable."}, {"owner": {"reputation": 6099, "user_id": 211176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1098198f10f2890217a272bf037e58f5?s=128&d=identicon&r=PG&f=1", "display_name": "adam_0", "link": "https://stackoverflow.com/users/211176/adam-0"}, "edited": false, "score": 0, "creation_date": 1458322340, "post_id": 34388805, "comment_id": 59825794, "body": "Though this doesn&#39;t answer the question, I upvoted it because it was the first result on Google where I was looking for exactly this."}], "tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 2, "last_activity_date": 1450670736, "creation_date": 1450670736, "answer_id": 34388805, "question_id": 34388758, "link": "https://stackoverflow.com/questions/34388758/converting-a-json-dir-tree-into-indented-plain-text-in-golang/34388805#34388805", "title": "Converting a JSON dir tree into indented plain text in GoLang", "body": "<p>You can achieve this with <a href=\"https://golang.org/pkg/encoding/json/#MarshalIndent\" rel=\"nofollow\">MarshalIndent</a>. Here is a <kbd><a href=\"http://play.golang.org/p/R-k6WnPnQ_\" rel=\"nofollow\">go playground</a></kbd> example.</p>\n\n<pre><code>instance := MyStruct{12344, \"ohoasdoh\", []int{1, 2, 3, 4, 5}}\nres, _ := json.MarshalIndent(instance, \"\", \"  \")\nfmt.Println(string(res))\n</code></pre>\n\n<p>Which will give you something like:</p>\n\n<pre><code>{\n  \"Num\": 12344,\n  \"Str\": \"ohoasdoh\",\n  \"Arr\": [\n    1,\n    2,\n    3,\n    4,\n    5\n  ]\n}\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 2315939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e88dc1843c2d1c713b9c402098f0a0?s=128&d=identicon&r=PG", "display_name": "Dave Strickler", "link": "https://stackoverflow.com/users/2315939/dave-strickler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1450691945, "creation_date": 1450670291, "last_edit_date": 1450691945, "question_id": 34388758, "link": "https://stackoverflow.com/questions/34388758/converting-a-json-dir-tree-into-indented-plain-text-in-golang", "title": "Converting a JSON dir tree into indented plain text in GoLang", "body": "<p>I have a dir tree in a JSON struct that I'm trying to format in plain text. Formatting it in XML or YAML is pretty easy. Formatting it in plain text is much harder than I thought. </p>\n\n<p>The JSON struct is formatted like this :</p>\n\n<pre><code>type File struct {\n   Name     string  `json:\"Name\"`\n   Children []*File `json:\"Children\"`\n}\n</code></pre>\n\n<p>Since the JSON structure allows for 'children', the JSON is nested, and since it's a dir tree, I don't know how deep the nesting will get (within reason).</p>\n\n<p>I need the converted JSON to look like this :</p>\n\n<pre><code>base_dir\n  sub_dir_1\n  sub_dir_2\n    file_in_sub_dir_2\n  sub_dir_3\n  ...\n</code></pre>\n\n<p>Can anyone tell me how this could be done in a reasonably simple way? Right now I'm having to brute force with lots of looping and indenting with tabs, and I'm just sure there's a more elegant way in Go.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1450670251, "post_id": 34388692, "comment_id": 56518715, "body": "With encoding/json you have to define a struct type with the right fields (and json field tags if your fields in code don&#39;t match the json field names), declare a variable of that struct type and then pass a pointer to that variable to the json.Unmarshal function along with the json in byte slice form. Start with the Unmarshal function on some simple examples (refer to the godoc for json)."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5430281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270606eaa097d1de6d79cd0975d75bbe?s=128&d=identicon&r=PG&f=1", "display_name": "bha", "link": "https://stackoverflow.com/users/5430281/bha"}, "edited": false, "score": 0, "creation_date": 1450670821, "post_id": 34388750, "comment_id": 56518867, "body": "Perfect! Thank you so much!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1450670256, "creation_date": 1450670256, "answer_id": 34388750, "question_id": 34388692, "link": "https://stackoverflow.com/questions/34388692/golang-parsing-json-string-arrays-from-twitch-tv-restful-service/34388750#34388750", "title": "Golang - Parsing JSON string arrays from Twitch TV RESTful service", "body": "<p>If you want to unmarshal moderators only, use the following:</p>\n\n<pre><code>var v struct {\n    Chatters struct {\n        Moderators []string\n    }\n}\nif err := json.Unmarshal(data, &amp;v); err != nil {\n    // handle error\n}\n for _, mod := range v2.Chatters.Moderators {\n    fmt.Println(mod)\n}\n</code></pre>\n\n<p>If you want to get all types of chatters, use the following:</p>\n\n<pre><code>var v struct {\n    Chatters map[string][]string\n}\nif err := json.Unmarshal(data, &amp;v); err != nil {\n    handle error\n}\nfor kind, users := range v1.Chatters {\n    for _, user := range users {\n        fmt.Println(kind, user)\n    }\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/VHNff5Wf0y\" rel=\"nofollow\">run the code on the playground</a></kbd></p>\n"}], "owner": {"reputation": 29, "user_id": 5430281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270606eaa097d1de6d79cd0975d75bbe?s=128&d=identicon&r=PG&f=1", "display_name": "bha", "link": "https://stackoverflow.com/users/5430281/bha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 34388750, "answer_count": 1, "score": 1, "last_activity_date": 1450670256, "creation_date": 1450669699, "question_id": 34388692, "link": "https://stackoverflow.com/questions/34388692/golang-parsing-json-string-arrays-from-twitch-tv-restful-service", "title": "Golang - Parsing JSON string arrays from Twitch TV RESTful service", "body": "<p>I've been working on parsing a JSON object that I retrieve through an HTTP GET request using Go's built in HTTP library. I initially tried using the default JSON library in Go in order to do this, but I was having a difficult time (I am a novice in Go still). I eventually resorted to using a different library and had little trouble after that, as shown below:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/antonholmquist/jason\"\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    resp, err := http.Get(\"http://tmi.twitch.tv/group/user/deernadia/chatters\")\n    if nil != err {\n        panic(err)\n    }\n    defer resp.Body.Close()\n    body, err := jason.NewObjectFromReader(resp.Body)\n\n    chatters, err := body.GetObject(\"chatters\")\n    if nil != err {\n        panic(err)\n    }\n\n    moderators, err := chatters.GetStringArray(\"moderators\")\n    if nil != err {\n        panic(err)\n    }\n\n    for _, moderator := range moderators {\n        fmt.Println(moderator)\n    }\n}\n</code></pre>\n\n<p>Where <code>github.com/antonholmquist/jason</code> corresponds to the custom JSON library I used.</p>\n\n<p>This code produces something similar to the following output when run in a Linux shell (the RESTful service will update about every 30 seconds or so, which means the values in the JSON object will potentially change):</p>\n\n<pre><code>antwan250\nbbrock89\nboxception22\ncmnights\ndeernadia\nfartfalcon\nfijibot\nfoggythought\nfulc_\nh_ov\niceydefeat\nkingbobtheking\nlospollogne\nnightbot\nnosleeptv\noctaviuskhan\npateyy\nphosphyg\npoisonyvie\nshevek18\ntrox94\ntrox_bot\nuggasmesh\nurbanelf\nwalmartslayer\nwift3\n</code></pre>\n\n<p>And the raw JSON looks similar to this (with some of the users removed for brevity):</p>\n\n<pre><code>{\n  \"_links\": {},\n  \"chatter_count\": 469,\n  \"chatters\": {\n    \"moderators\": [\n      \"antwan250\",\n      \"bbrock89\",\n      \"boxception22\",\n      \"cmnights\",\n      \"deernadia\",\n      \"fartfalcon\",\n      \"fijibot\",\n      \"foggythought\",\n      \"fulc_\",\n      \"h_ov\",\n      \"iceydefeat\",\n      \"kingbobtheking\",\n      \"lospollogne\",\n      \"nightbot\",\n      \"nosleeptv\",\n      \"octaviuskhan\",\n      \"pateyy\",\n      \"phosphyg\",\n      \"poisonyvie\",\n      \"shevek18\",\n      \"trox94\",\n      \"trox_bot\",\n      \"uggasmesh\",\n      \"urbanelf\",\n      \"walmartslayer\",\n      \"wift3\"\n    ],\n    \"staff\": [\n      \"tnose\"\n    ],\n    \"admins\": [],\n    \"global_mods\": [],\n    \"viewers\": [\n      \"03xuxu30\",\n      \"0dominic0\",\n      \"3389942\",\n      \"812mfk\",\n      \"910dan\",\n      \"aaradabooti\",\n      \"admiralackbar99\",\n      \"adrian97lol\",\n      \"aequitaso_o\",\n      \"aethiris\",\n      \"afropigeon\",\n      \"ahhhmong\",\n      \"aizaix\",\n      \"aka_magosh\",\n      \"akitoalexander\",\n      \"alex5761\",\n      \"allenhei\",\n      \"allou_fun_park\",\n      \"amilton_tkm\",\n      \"... more users that I removed...\",\n      \"zachn17\",\n      \"zero_x1\",\n      \"zigslip\",\n      \"ziirbryad\",\n      \"zonato83\",\n      \"zorr03body\",\n      \"zourtv\"\n    ]\n  }\n}\n</code></pre>\n\n<p>As I said before, I'm using a custom library hosted on Github in order to accomplish what I needed, but <strong>for the sake of learning</strong>, I'm curious... how would I accomplish this same thing using Go's built in JSON library?</p>\n\n<p>To be clear, what I'd like to do is be able to harvest the users from each JSON array embedded within the JSON object returned from the HTTP GET request. I'd also like to be able to get the list of viewers, admins, global moderators, etc., in the same way, but I figured that if I can see the moderator example using the default Go library, then reproducing that code for the other user types will be trivial.</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2428, "user_id": 2202911, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9a06f86b30413aa2d4c274a7b017231e?s=128&d=identicon&r=PG", "display_name": "user2202911", "link": "https://stackoverflow.com/users/2202911/user2202911"}, "edited": false, "score": 0, "creation_date": 1450669359, "post_id": 34388627, "comment_id": 56518467, "body": "So simple.. Thank you so much!!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 13, "last_activity_date": 1450669178, "creation_date": 1450669178, "answer_id": 34388627, "question_id": 34388593, "link": "https://stackoverflow.com/questions/34388593/how-to-enter-an-optional-flag-with-no-parameters-in-go-cli-program/34388627#34388627", "title": "How to enter an optional flag with no parameters in Go CLI program", "body": "<p>You must <a href=\"https://godoc.org/flag#Parse\" rel=\"noreferrer\">parse the flags</a> after all flags are defined and before flags are accessed:</p>\n\n<pre><code>func main() {\n  boolPtr := flag.Bool(\"fork\", false, \"a bool\")\n  flag.Parse()  // add this line\n  fmt.Println(\"fork:\", *boolPtr)\n}\n</code></pre>\n\n<p>With this change, the <code>fork</code> flag will work as desire.</p>\n"}], "owner": {"reputation": 2428, "user_id": 2202911, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9a06f86b30413aa2d4c274a7b017231e?s=128&d=identicon&r=PG", "display_name": "user2202911", "link": "https://stackoverflow.com/users/2202911/user2202911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5588, "favorite_count": 0, "accepted_answer_id": 34388627, "answer_count": 1, "score": 3, "last_activity_date": 1450669178, "creation_date": 1450668916, "question_id": 34388593, "link": "https://stackoverflow.com/questions/34388593/how-to-enter-an-optional-flag-with-no-parameters-in-go-cli-program", "title": "How to enter an optional flag with no parameters in Go CLI program", "body": "<p>I have read the docs for the following two libraries used to create flags. :</p>\n\n<ol>\n<li><a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow\">https://golang.org/pkg/flag/</a> </li>\n<li><a href=\"https://github.com/codegangsta/cli\" rel=\"nofollow\">https://github.com/codegangsta/cli</a></li>\n</ol>\n\n<p>And have not come across a way to do optional flags. How can this be done?</p>\n\n<p>According to the code from <a href=\"https://gobyexample.com/command-line-flags\" rel=\"nofollow\">https://gobyexample.com/command-line-flags</a> :</p>\n\n<pre><code>package main\nimport \"flag\"\nimport \"fmt\"\n\nfunc main() {\n  boolPtr := flag.Bool(\"fork\", false, \"a bool\")\n  fmt.Println(\"fork:\", *boolPtr)\n}\n</code></pre>\n\n<p>and executed by :\n$ ./command-line-flags -fork</p>\n\n<p>Should result in true, this is the behavior I desire but I am getting false on my machine. </p>\n\n<p>Any guidance would be appreciated,\nThanks</p>\n"}, {"tags": ["go", "bytearray"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 9, "last_activity_date": 1450668924, "last_edit_date": 1450668924, "creation_date": 1450664125, "answer_id": 34388102, "question_id": 34388083, "link": "https://stackoverflow.com/questions/34388083/read-entire-file-of-newline-delimited-json-blobs-to-memory-and-unmarshal-each-bl/34388102#34388102", "title": "Read entire file of newline delimited JSON blobs to memory and unmarshal each blob with the least amount of conversions in golang?", "body": "<p>Use <a href=\"https://godoc.org/bufio#Scanner\" rel=\"noreferrer\">bufio.Scanner</a> to read a line at a time:</p>\n\n<pre><code> f, err := os.Open(fname)\n if err != nil {\n     // handle error\n }\n s := bufio.NewScanner(f)\n for s.Scan() {\n    var v ValueTypeToUnmarshalTo\n    if err := json.Unmarshal(s.Bytes(), &amp;v); err != nil {\n       //handle error\n    }\n    // do something with v\n}\nif s.Err() != nil {\n    // handle scan error\n}\n</code></pre>\n\n<p>or use ioutil.ReadFile to slurp up the entire file and <a href=\"https://godoc.org/bytes#Split\" rel=\"noreferrer\">bytes.Split</a> to break the file into lines:</p>\n\n<pre><code> p, err := ioutil.ReadFile(fname)\n if err != nil {\n    // handle error\n }\n for _, line := range bytes.Split(p, []byte{'\\n'}) {\n    var v ValueTypeToUnmarshalTo\n    if err := json.Unmarshal(line, &amp;v); err != nil {\n       //handle error\n    }\n    // do something with v\n }\n</code></pre>\n\n<p>or use the <a href=\"https://godoc.org/encoding/json#Decoder\" rel=\"noreferrer\">json.Decoder</a> built-in streaming feature to read mulitple values from the file:</p>\n\n<pre><code> f, err := os.Open(fname)\n if err != nil {\n    // handle error\n }\n d := json.NewDecoder(f)\n for {\n    var v ValueTypeToUnmarshalTo\n    if err := d.Decode(&amp;v); err == io.EOF {\n       break // done decoding file\n    } else if err != nil {\n       // handle error\n    }\n    // do something with v\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/zFwBjHMUWf\" rel=\"noreferrer\">Run the code on the playground</a></kbd></p>\n\n<p>The ioutil.ReadFile approach uses more memory than the other approaches (one byte for each byte in file plus one slice header for each line).</p>\n\n<p>Because the decoder ignores whitespace following a JSON value, the three approaches handle \\r\\n line terminators.</p>\n\n<p>There are no data conversions in any of these approaches other than those inherent to unmarshalling JSON bytes to Go values.</p>\n"}], "owner": {"reputation": 2659, "user_id": 425997, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6pMR3.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/425997/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4255, "favorite_count": 3, "answer_count": 1, "score": 1, "last_activity_date": 1450668924, "creation_date": 1450663942, "last_edit_date": 1495542345, "question_id": 34388083, "link": "https://stackoverflow.com/questions/34388083/read-entire-file-of-newline-delimited-json-blobs-to-memory-and-unmarshal-each-bl", "title": "Read entire file of newline delimited JSON blobs to memory and unmarshal each blob with the least amount of conversions in golang?", "body": "<p>I'm new to go, so don't know a whole lot about the language specific constructs.</p>\n\n<p>My use case is first to read into memory an input file containing JSON blobs that are newline delimited. From this \"array\" of JSON source, I'd like to unmarshal each array element to deal with it in golang. The expected structure mapping is already defined.</p>\n\n<p>I typically like to read all lines at once, so <code>ioutil.ReadFile()</code> as mentioned in <a href=\"https://stackoverflow.com/questions/13514184/how-can-i-read-a-whole-file-into-a-string-variable-in-golang\">How can I read a whole file into a string variable in Golang?</a> seems like a good choice. And <code>json.Unmarshal</code> appears to take byte array as the source. But if I'm using ReadFile(), I have a single array of bytes for the whole file. How might I extract slices of this byte array such that the newline bytes (as delimiters) are skipped and each slice is one of those JSON blobs? I'd assume the best technique is one that doesn't do or minimizes data type conversions. As the easy hack would be something like convert the byte array to string, split the newline delimited string to array then cast each string array element back to bytes to pass to json.Unmarshal. I'd prefer the optimized approach but not sure how to tackle the implementation algorithm details in go, could use some tips here.</p>\n\n<p>Ideally, I'd like the preprocessing done beforehand, so that I'm not dealing with the content of the JSON byte array from file as I'm iterating over the slices, etc. Rather I'd like to preprocess the single byte array read from file into an array of byte array slices, with all the newline bytes removed, each slice being the segments that were delimited by newline.</p>\n"}, {"tags": ["go", "concurrency", "httpserver"], "comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450716403, "post_id": 34386232, "comment_id": 56542366, "body": "I do understand your confusion. You&#39;ve seen some behaviour and made a false conclusion and then based on this you asked your question. It was well worded, so I was able to answer. I guess if you skipped the conclusion about routines and just asked why this is not working as expected, you would have more luck and collect some upvotes. One way or another I hope your problem is now solved. Per my update, you can also see this working correctly in Chrome by opening multiple tabs with a different URL each."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450716976, "post_id": 34386232, "comment_id": 56542701, "body": "You may have realized by now, but the first thing to do when troubleshooting basic HTTP is to get the browser out of the equation -- in only introduces browser-specific behavior. Also, update your Go install, learning with such an old version is only going to hamper you with mismatched documentation and possibly missing features."}], "answers": [{"comments": [{"owner": {"reputation": 805, "user_id": 2052138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/05865fee450c2ae5b1686d898e1115d3?s=128&d=identicon&r=PG", "display_name": "Highstaker", "link": "https://stackoverflow.com/users/2052138/highstaker"}, "edited": false, "score": 0, "creation_date": 1540287144, "post_id": 34386358, "comment_id": 92799403, "body": "Confirming this on Chromium 69. On Firefox 62 it works as intended though: I refresh all tabs simultaneously and the queries finish at the same time."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 23, "last_activity_date": 1450715452, "last_edit_date": 1450715452, "creation_date": 1450648839, "answer_id": 34386358, "question_id": 34386232, "link": "https://stackoverflow.com/questions/34386232/why-isnt-this-go-http-server-spawning-a-goroutine-per-request-in-chrome-47/34386358#34386358", "title": "Why isn&#39;t this go HTTP server spawning a goroutine per request in Chrome 47?", "body": "<p>All is good, your handler is run in a separate routine for each request. Take a look at the source code of <a href=\"https://golang.org/src/net/http/server.go#L1883\" rel=\"noreferrer\"><code>http.Server.Serve</code></a> method. The last line in accepting loop says:</p>\n\n<pre><code>go c.serve()\n</code></pre>\n\n<p>The problem is probably with your testing. If you check the behaviour through the multiple tabs in browser the requests for matching URLs are probably queued instead of running them simultaneously (i.e. your client is not using \"routines\", not the server).</p>\n\n<p>Try two different browsers or just use command line and, say, <code>curl</code> to test requests in parallel. For example (with some help from bash):</p>\n\n<pre><code>$ for i in {1..5}; do time curl localhost:8080 &amp;; done\n# after ignoring some mess...\ncurl localhost:8080  0.00s user 0.00s system 0% cpu 10.013 total\ncurl localhost:8080  0.00s user 0.00s system 0% cpu 10.014 total\ncurl localhost:8080  0.00s user 0.00s system 0% cpu 10.012 total\ncurl localhost:8080  0.00s user 0.00s system 0% cpu 10.019 total\n</code></pre>\n\n<p>You server works like a charm.</p>\n\n<p><strong>Update</strong></p>\n\n<p>I can confirm this behaviour on Chrome 47, but also noticed you can open multiple tabs with, say, <code>http://localhost:8080/test1</code>, <code>http://localhost:8080/test2</code> etc. and you will get expected results. That indicates there's indeed some queuing mechanism in Chrome for matching URLs.</p>\n"}], "owner": {"reputation": 455, "user_id": 2643470, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NvItC.png?s=128&g=1", "display_name": "tlovely", "link": "https://stackoverflow.com/users/2643470/tlovely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8785, "favorite_count": 3, "accepted_answer_id": 34386358, "answer_count": 1, "score": 7, "last_activity_date": 1450733039, "creation_date": 1450648000, "last_edit_date": 1450733039, "question_id": 34386232, "link": "https://stackoverflow.com/questions/34386232/why-isnt-this-go-http-server-spawning-a-goroutine-per-request-in-chrome-47", "title": "Why isn&#39;t this go HTTP server spawning a goroutine per request in Chrome 47?", "body": "<p><em>Previously titled: <strong>How to spawn goroutine per HTTP request?</strong></em></p>\n\n<p>The code below is a simple HTTP server that echos the path back to the requester. I used it to test if the <code>ListenAndServe</code> method of the <code>net/http</code> package by default fires a goroutine to handle each request; which I discovered it doesn't. If I make three requests at the same time, the first takes 10 seconds to return, the second 20 (10 seconds after the first returns), and the third 30 seconds.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net/http\"\n  \"time\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n  time.Sleep(10000 * time.Millisecond)\n  fmt.Fprint(w, r.URL.Path)\n}\n\nfunc main() {\n  http.HandleFunc(\"/\", handler)\n  http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Basically what I want is the main goroutine to listen for an HTTP connection, then pass the reading of the request and the response to a handler spawned in another goroutine. </p>\n\n<p>Could someone point me in the right direction for accomplishing this? Preferably using the <code>net/http</code> package in go.</p>\n\n<p><strong>UPDATE 12/21/15 08:46 AM MST</strong></p>\n\n<p>I conducted the same exact test you did using my web browser (chrome 47), five requests at the root of localhost:8080, and the results were roughly:</p>\n\n<pre><code>1st: 10 seconds\n2nd: 20 seconds\n3rd: 30 seconds\n4th: 36 seconds     \n5th: 38 seconds\n</code></pre>\n\n<p>So, hopefully, the folks who would otherwise down-vote my question would understand my confusion and why I made the assumption I did. I have no idea why I got the results I did on the 4th and 5th request.</p>\n\n<p>I ran the same test using curl and had the same results as @tomasz.</p>\n\n<p>I'm using <code>go1.2.1</code>.</p>\n\n<p><strong>UPDATE 12/21/15 02:08 PM MST</strong></p>\n\n<p>Per @tomasz's suggestion below, I retitled this question from \"How to spawn goroutine per HTTP request\" to \"Why isn't this go HTTP server spawning a goroutine per request in Chrome 47?\"</p>\n"}, {"tags": ["go", "websocket", "connection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450710580, "post_id": 34386026, "comment_id": 56538599, "body": "Accessing <code>ActiveClients</code> from multiple goroutines is a data race -- you at least need to protect it with a mutex. You know when the connection is closed when you have a Read or Write error. What &quot;database&quot; column are you trying to change?"}, {"owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450713613, "post_id": 34386026, "comment_id": 56540683, "body": "Online column to 0 from 1. But, I solved it, with a function which concurrent check the clients map."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450714602, "post_id": 34386026, "comment_id": 56541255, "body": "Please run your code with the race detector. If you&#39;re building off the example here it will crash under concurrent load."}], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1009, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450646772, "creation_date": 1450646772, "question_id": 34386026, "link": "https://stackoverflow.com/questions/34386026/golang-websocket-client-closed-the-connection", "title": "Golang websocket client closed the connection", "body": "<p>I have a golang connection. If the client opened the connection the database change the online column to 1. Here is my code but I didnt implement the last thing. My question, how can I change the database column to 0 if the client closed the connection. How can I track the client, and catch the connection close? </p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/net/websocket\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n\n    \"strconv\"\n)\n\ntype Clients struct {\n    webs *websocket.Conn\n    clientAddr string\n    id int\n}\n\nvar (\n    ActiveClients = make(map[Clients]int)\n)\n\nfunc Echo(ws *websocket.Conn){\n    var err error\n\n    client := ws.Request().RemoteAddr\n    sockCli := Clients{webs: ws, clientAddr: client, id: 0}\n    ActiveClients[sockCli] = 1\n\n\n    for{\n        var reply string\n\n        if err = websocket.Message.Receive(ws, &amp;reply); err != nil{\n            fmt.Println(\"Cant receive\", err)\n            break\n        }else{\n            if sockCli.id == 0{\n                sockCli.id, err = strconv.Atoi(reply)\n\n            }\n        }\n\n\n        if err = websocket.Message.Send(ws, \"id:\"+strconv.Itoa(sockCli.id)); err != nil{\n            fmt.Println(\"Cant send\")\n        }\n\n\n\n        for cs, _ := range ActiveClients {\n            if cs.id == 1{\n                if err = websocket.Message.Send(cs.webs, \"asd\"); err != nil {\n                    // we could not send the message to a peer\n                    log.Println(\"Could not send message to \", cs.clientAddr, err.Error())\n                }\n            }else {\n                fmt.Println(\"No\")\n            }\n\n\n\n        }\n\n\n    }\n\n}\n\nfunc main(){\n    http.Handle(\"/\", websocket.Handler(Echo))\n\n    if err := http.ListenAndServe(\":1234\", nil); err != nil{\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["reflection", "go", "interface"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 7, "last_activity_date": 1450646608, "creation_date": 1450646608, "answer_id": 34385993, "question_id": 34385735, "link": "https://stackoverflow.com/questions/34385735/should-the-usage-of-reflection-be-avoided-in-go/34385993#34385993", "title": "Should the usage of reflection be avoided in Go?", "body": "<p>You should avoid reflection.</p>\n\n<p>Some packages (e.g. fmt) cannot be implemented without reflection as you cannot typeswitch on all existing and upcoming types.</p>\n\n<p>If you are new to Go: Keep away from reflection.</p>\n"}, {"comments": [{"owner": {"reputation": 281, "user_id": 5517206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f35a78e8cfdebb7a0223bf33c7d3e220?s=128&d=identicon&r=PG&f=1", "display_name": "linirod", "link": "https://stackoverflow.com/users/5517206/linirod"}, "edited": false, "score": 0, "creation_date": 1450685189, "post_id": 34387719, "comment_id": 56523672, "body": "Thanks for feedback kostya :)"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 8, "last_activity_date": 1450660413, "creation_date": 1450660413, "answer_id": 34387719, "question_id": 34385735, "link": "https://stackoverflow.com/questions/34385735/should-the-usage-of-reflection-be-avoided-in-go/34387719#34387719", "title": "Should the usage of reflection be avoided in Go?", "body": "<p>There are a few problem domains where reflection makes it easier to write reusable libraries:</p>\n\n<ul>\n<li>marshalling/unmarshalling, plenty of examples in the standard library, e.g. <code>encoding/json</code>, <code>encoding/xml</code></li>\n<li>formatting, e.g. <code>text/template</code>, <code>html/template</code>, <code>fmt.Printf</code>.</li>\n</ul>\n\n<p>However there is a price you pay for using reflection:</p>\n\n<ul>\n<li>compile time errors become runtime errors (e.g. <code>fmt.Printf(\"%d\", stringVariable)</code>)</li>\n<li>performance becomes worse</li>\n</ul>\n\n<p>Very often an alternative solution exists that do not require reflection such as code generation, that is used by marshalling libraries like protobuf or thrift.</p>\n\n<p>I agree with @volker that you should use reflection only when you know that it will simplify already existing code and aware of all downsides.</p>\n"}], "owner": {"reputation": 281, "user_id": 5517206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f35a78e8cfdebb7a0223bf33c7d3e220?s=128&d=identicon&r=PG&f=1", "display_name": "linirod", "link": "https://stackoverflow.com/users/5517206/linirod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 34387719, "answer_count": 2, "score": 7, "last_activity_date": 1450660413, "creation_date": 1450644816, "last_edit_date": 1450645914, "question_id": 34385735, "link": "https://stackoverflow.com/questions/34385735/should-the-usage-of-reflection-be-avoided-in-go", "title": "Should the usage of reflection be avoided in Go?", "body": "<p>I'm new to <code>Go</code> and also new to the concept of <code>reflection</code>, but <strong>should</strong> and <strong>can</strong> the usage of <a href=\"https://golang.org/pkg/reflect/\">reflect</a> package be avoided in <code>Go</code>? Is there a scenario where <code>reflect</code> is unavoidable?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1450646703, "post_id": 34384648, "comment_id": 56513275, "body": "Take the complete Tour of Go first; these two hours are well spent."}, {"owner": {"reputation": 4341, "user_id": 4572536, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/91d825b498c552b821ccc3314ddd8929?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndArtist", "link": "https://stackoverflow.com/users/4572536/devandartist"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1450647488, "post_id": 34384648, "comment_id": 56513514, "body": "@Volker I have read this book: <a href=\"https://www.golang-book.com\" rel=\"nofollow noreferrer\">golang-book.com</a> I might missed a few things here and there."}], "answers": [{"comments": [{"owner": {"reputation": 4341, "user_id": 4572536, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/91d825b498c552b821ccc3314ddd8929?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndArtist", "link": "https://stackoverflow.com/users/4572536/devandartist"}, "edited": false, "score": 0, "creation_date": 1450638352, "post_id": 34384674, "comment_id": 56510681, "body": "Great, I might have missed that detail in my <code>Go</code> book. So I can think of names in lowercase like <code>private types</code>."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 3, "last_activity_date": 1450638169, "creation_date": 1450638169, "answer_id": 34384674, "question_id": 34384648, "link": "https://stackoverflow.com/questions/34384648/go-function-call-from-a-library/34384674#34384674", "title": "Go: Function call from a library", "body": "<p>I suppose that you have not read the Go docs very closely. All names which begin with capital letters are exported from their package. All names in lowercase are not exported.</p>\n\n<ul>\n<li><a href=\"https://golang.org/doc/\" rel=\"nofollow\">https://golang.org/doc/</a></li>\n<li><a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">https://golang.org/ref/spec#Exported_identifiers</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 3, "last_activity_date": 1450638369, "creation_date": 1450638369, "answer_id": 34384703, "question_id": 34384648, "link": "https://stackoverflow.com/questions/34384648/go-function-call-from-a-library/34384703#34384703", "title": "Go: Function call from a library", "body": "<p>In Go, it's an important distinction whether a symbol's name is written in upper or lower camel case. This goes for functions, but also for types (like structs or interfaces) and also struct members.</p>\n\n<p>You can read this up in the <a href=\"https://golang.org/doc/effective_go.html#names\" rel=\"nofollow\">Go documentation</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>Names are as important in Go as in any other language. They even have semantic effect: <strong>the visibility of a name outside a package is determined by whether its first character is upper case</strong>.</p>\n</blockquote>\n\n<p>This means that you <strong>cannot name functions and types arbitrarily</strong>. If you need to call this function from another module, it must be named <code>Foo</code>, and not <code>foo</code>.</p>\n"}], "owner": {"reputation": 4341, "user_id": 4572536, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/91d825b498c552b821ccc3314ddd8929?s=128&d=identicon&r=PG&f=1", "display_name": "DevAndArtist", "link": "https://stackoverflow.com/users/4572536/devandartist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 34384703, "answer_count": 2, "score": -1, "last_activity_date": 1450638369, "creation_date": 1450638049, "last_edit_date": 1592644375, "question_id": 34384648, "link": "https://stackoverflow.com/questions/34384648/go-function-call-from-a-library", "title": "Go: Function call from a library", "body": "<p>Now I'm really confused. Here is my problem (Go is new to me):</p>\n<p>Firs file:</p>\n<pre><code>// main.go\npackage main\n\nimport &quot;./libraries/test&quot;\n\nfunc main() {\n\n    test.foo()\n}\n</code></pre>\n<p>Second file:</p>\n<pre><code>// test.go\npackage test\n\nimport &quot;fmt&quot;\n\nfunc foo() {\n\n    fmt.Println(&quot;foo&quot;)\n}\n</code></pre>\n<p>My structure looks like this:</p>\n<pre><code>main.go\n   /libraries\n        /test\n           test.go\n</code></pre>\n<p>If I compile this code I'll get this error messages:</p>\n<blockquote>\n<p>./main.go:7: cannot refer to unexported name test.foo</p>\n<p>./main.go:7: undefined: test.foo</p>\n</blockquote>\n<p>If I change <code>foo</code> to <code>Foo</code> everywhere the error is gone and the program works as expected.</p>\n"}, {"tags": ["go", "godeps"], "comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450650248, "post_id": 34384595, "comment_id": 56514285, "body": "Check out <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow noreferrer\">glide</a> \u2013 its main purpose is to support &quot;go 1.5 vendor experiment&quot;. I was researching the vendoring topic recently myself and chose this tool, however, there are other options to consider of course."}, {"owner": {"reputation": 496, "user_id": 4042821, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-bLyOhWILdEg/AAAAAAAAAAI/AAAAAAAAACY/PLPlL9iwQTQ/photo.jpg?sz=128", "display_name": "Jeffrey Ellin", "link": "https://stackoverflow.com/users/4042821/jeffrey-ellin"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450653446, "post_id": 34384595, "comment_id": 56515137, "body": "Looks pretty nice,  but if I am reading correctly it doesn&#39;t seem to work with specific tags.  Running    <code>glide get github.com&#47;Masterminds&#47;cookoo</code>    will basically get the latest commit id from github?"}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450653859, "post_id": 34384595, "comment_id": 56515246, "body": "You have to specify <a href=\"https://github.com/Masterminds/glide#glideyaml\" rel=\"nofollow noreferrer\">glide.yaml</a> and fill it with desired tag/branch/hash."}, {"owner": {"reputation": 496, "user_id": 4042821, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-bLyOhWILdEg/AAAAAAAAAAI/AAAAAAAAACY/PLPlL9iwQTQ/photo.jpg?sz=128", "display_name": "Jeffrey Ellin", "link": "https://stackoverflow.com/users/4042821/jeffrey-ellin"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450658906, "post_id": 34384595, "comment_id": 56516404, "body": "is it recommended to still commit the vendor directory?  I am hoping not."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450660658, "post_id": 34384595, "comment_id": 56516744, "body": "committing vendor directory makes it easier for other developers to compile your app with just standard Go tools. Also if any of your dependencies is no longer available in the future at the old url your project is safe. In the end it is up to you."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450663448, "post_id": 34384595, "comment_id": 56517283, "body": "It&#39;s fine not to check the vendor directory, but then you (and others) probably should to stick with package manager of <i>your</i> choice (e.g. glide in this context). There is also <a href=\"https://github.com/Masterminds/glide#q-should-i-check-vendor-into-version-control\" rel=\"nofollow noreferrer\">a comment about this</a> on their github page."}, {"owner": {"reputation": 496, "user_id": 4042821, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-bLyOhWILdEg/AAAAAAAAAAI/AAAAAAAAACY/PLPlL9iwQTQ/photo.jpg?sz=128", "display_name": "Jeffrey Ellin", "link": "https://stackoverflow.com/users/4042821/jeffrey-ellin"}, "edited": false, "score": 0, "creation_date": 1450664034, "post_id": 34384595, "comment_id": 56517402, "body": "Sounds good.  Just now trying to figure out how the globe cache is supposed to work. It&#39;s suboptimal for our ci system to need to continually re download the dependencies."}], "answers": [{"tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": true, "score": 0, "last_activity_date": 1450708914, "creation_date": 1450708914, "answer_id": 34398251, "question_id": 34384595, "link": "https://stackoverflow.com/questions/34384595/advice-on-vendoring-dependencies-in-go/34398251#34398251", "title": "Advice on vendoring dependencies in Go", "body": "<p>There are a few tools that help with vendoring your dependencies. Most of them are able to handle <code>GO15VENDOREXPERIMENT</code>. </p>\n\n<p>For example:</p>\n\n<ul>\n<li><a href=\"https://github.com/tools/godep\" rel=\"nofollow\">godep</a></li>\n<li><a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow\">glide</a></li>\n</ul>\n"}], "owner": {"reputation": 496, "user_id": 4042821, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-bLyOhWILdEg/AAAAAAAAAAI/AAAAAAAAACY/PLPlL9iwQTQ/photo.jpg?sz=128", "display_name": "Jeffrey Ellin", "link": "https://stackoverflow.com/users/4042821/jeffrey-ellin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 34398251, "answer_count": 1, "score": 2, "last_activity_date": 1450708914, "creation_date": 1450637753, "question_id": 34384595, "link": "https://stackoverflow.com/questions/34384595/advice-on-vendoring-dependencies-in-go", "title": "Advice on vendoring dependencies in Go", "body": "<p>I am working on a project that requires some dependencies.  I am a little confused by the best practices regarding vendoring.  Currently I am using GO15VENDOREXPERIMENT and have copied the dependencies into the vendor directory.</p>\n\n<p><a href=\"https://github.com/jeffellin/machine-cloudformation/tree/master/vendor/github.com\" rel=\"nofollow\">https://github.com/jeffellin/machine-cloudformation/tree/master/vendor/github.com</a></p>\n\n<p>When I need to update the dependencies I checkout the source code manually from docker-machine and copy it into my vendor directory.  This brings in a lot of unnecessary code,  tests, etc.  Is there any recommendations on automating this?  I am used to maven where I can just specify version info in a configuration file.</p>\n\n<p>What about GODEPS?  How does that play into the GO15VENDOREXPERIMENT. I would prefer a solution where I don't have to checkin dependencies into my source tree.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3751, "user_id": 6792646, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/90c3356d59254bbb5b4464ee3524294e?s=128&d=identicon&r=PG", "display_name": "Daksh Miglani", "link": "https://stackoverflow.com/users/6792646/daksh-miglani"}, "edited": false, "score": 0, "creation_date": 1529318213, "post_id": 34383705, "comment_id": 88814916, "body": "windows users check my answer :)"}], "answers": [{"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 137, "last_activity_date": 1450632445, "creation_date": 1450632445, "answer_id": 34383753, "question_id": 34383705, "link": "https://stackoverflow.com/questions/34383705/how-do-i-compare-strings-in-golang/34383753#34383753", "title": "How do I compare strings in GoLang?", "body": "<p><code>==</code> is the correct operator to compare strings in Go. However, the strings that you read from STDIN with <code>reader.ReadString</code> do not contain <code>\"a\"</code>, but <code>\"a\\n\"</code> (if you look closely, you'll see the extra line break in your example output).</p>\n\n<p>You can use the <a href=\"https://golang.org/pkg/strings/#TrimRight\"><code>strings.TrimRight</code></a> function to remove trailing whitespaces from your input:</p>\n\n<pre><code>if strings.TrimRight(input, \"\\n\") == \"a\" {\n    // ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 358, "user_id": 6267238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53d46b675ae20a5956ccc01ec32faa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Carlson", "link": "https://stackoverflow.com/users/6267238/jason-carlson"}, "edited": false, "score": 4, "creation_date": 1536682518, "post_id": 50907597, "comment_id": 91508380, "body": "There&#39;s no need to differentiate. The second argument is a cutset, not a suffix, and any characters in the cutset will be trimmed, in any order/combination. Trimming &quot;\\r\\n&quot; will suffice on both."}], "tags": [], "owner": {"reputation": 3751, "user_id": 6792646, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/90c3356d59254bbb5b4464ee3524294e?s=128&d=identicon&r=PG", "display_name": "Daksh Miglani", "link": "https://stackoverflow.com/users/6792646/daksh-miglani"}, "is_accepted": false, "score": 10, "last_activity_date": 1529318199, "creation_date": 1529318199, "answer_id": 50907597, "question_id": 34383705, "link": "https://stackoverflow.com/questions/34383705/how-do-i-compare-strings-in-golang/50907597#50907597", "title": "How do I compare strings in GoLang?", "body": "<p>For the Platform Independent Users or Windows users, what you can do is:</p>\n\n<p>import runtime:</p>\n\n<pre><code>import (\n    \"runtime\"\n    \"strings\"\n)\n</code></pre>\n\n<p>and then trim the string like this:</p>\n\n<pre><code>if runtime.GOOS == \"windows\" {\n  input = strings.TrimRight(input, \"\\r\\n\")\n} else {\n  input = strings.TrimRight(input, \"\\n\")\n}\n</code></pre>\n\n<p>now you can compare it like that:</p>\n\n<pre><code>if strings.Compare(input, \"a\") == 0 {\n  //....yourCode\n}\n</code></pre>\n\n<p>This is a better approach when you're making use of STDIN on multiple platforms.</p>\n\n<h1>Explanation</h1>\n\n<p>This happens because on windows lines end with <code>\"\\r\\n\"</code> which is known as CRLF, but on UNIX lines end with <code>\"\\n\"</code> which is known as LF and that's why we trim <code>\"\\n\"</code> on unix based operating systems while we trim <code>\"\\r\\n\"</code> on windows.</p>\n"}, {"tags": [], "owner": {"reputation": 217, "user_id": 5713047, "user_type": "registered", "profile_image": "https://graph.facebook.com/511702685666241/picture?type=large", "display_name": "Abhishek Srivastava", "link": "https://stackoverflow.com/users/5713047/abhishek-srivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1559543699, "creation_date": 1559543699, "answer_id": 56422179, "question_id": 34383705, "link": "https://stackoverflow.com/questions/34383705/how-do-i-compare-strings-in-golang/56422179#56422179", "title": "How do I compare strings in GoLang?", "body": "<p>The content inside strings in Golang can be compared using <code>==</code> operator. If the results are not as expected there may be some hidden characters like <code>\\n</code>, <code>\\r</code>, spaces, etc. So as a general rule of thumb, try removing those using functions provided by <code>strings</code> package in golang. </p>\n\n<p>For Instance, spaces can be removed using <code>strings.TrimSpace</code> function. You can also define a custom function to remove any character you need. <code>strings.TrimFunc</code> function can give you more power.</p>\n"}, {"tags": [], "owner": {"reputation": 4661, "user_id": 1692706, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GyaAv.png?s=128&g=1", "display_name": "Debosmit Ray", "link": "https://stackoverflow.com/users/1692706/debosmit-ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1570827861, "creation_date": 1570827861, "answer_id": 58348430, "question_id": 34383705, "link": "https://stackoverflow.com/questions/34383705/how-do-i-compare-strings-in-golang/58348430#58348430", "title": "How do I compare strings in GoLang?", "body": "<p>Assuming there are no prepending/succeeding whitespace characters, there are still a few ways to assert string equality. Some of those are:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/strings/#ToLower\" rel=\"nofollow noreferrer\"><code>strings.ToLower(..)</code></a> then <code>==</code></li>\n<li><a href=\"https://golang.org/pkg/strings/#example_EqualFold\" rel=\"nofollow noreferrer\"><code>strings.EqualFold(.., ..)</code></a></li>\n<li><a href=\"https://godoc.org/golang.org/x/text/cases#Lower\" rel=\"nofollow noreferrer\"><code>cases#Lower</code></a> paired with <code>==</code></li>\n<li><a href=\"https://godoc.org/golang.org/x/text/cases#Fold\" rel=\"nofollow noreferrer\"><code>cases#Fold</code></a> paired with <code>==</code></li>\n</ul>\n\n<p>Here are some basic benchmark results (in these tests, <code>strings.EqualFold(.., ..)</code> seems like the most performant choice):</p>\n\n<pre><code>goos: darwin\ngoarch: amd64\nBenchmarkStringOps/both_strings_equal::equality_op-4               10000        182944 ns/op\nBenchmarkStringOps/both_strings_equal::strings_equal_fold-4        10000        114371 ns/op\nBenchmarkStringOps/both_strings_equal::fold_caser-4                10000       2599013 ns/op\nBenchmarkStringOps/both_strings_equal::lower_caser-4               10000       3592486 ns/op\n\nBenchmarkStringOps/one_string_in_caps::equality_op-4               10000        417780 ns/op\nBenchmarkStringOps/one_string_in_caps::strings_equal_fold-4        10000        153509 ns/op\nBenchmarkStringOps/one_string_in_caps::fold_caser-4                10000       3039782 ns/op\nBenchmarkStringOps/one_string_in_caps::lower_caser-4               10000       3861189 ns/op\n\nBenchmarkStringOps/weird_casing_situation::equality_op-4           10000        619104 ns/op\nBenchmarkStringOps/weird_casing_situation::strings_equal_fold-4    10000        148489 ns/op\nBenchmarkStringOps/weird_casing_situation::fold_caser-4            10000       3603943 ns/op\nBenchmarkStringOps/weird_casing_situation::lower_caser-4           10000       3637832 ns/op\n</code></pre>\n\n<p>Since there are quite a few options, so here's the code to generate benchmarks.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"testing\"\n\n    \"golang.org/x/text/cases\"\n    \"golang.org/x/text/language\"\n)\n\nfunc BenchmarkStringOps(b *testing.B) {\n    foldCaser := cases.Fold()\n    lowerCaser := cases.Lower(language.English)\n\n    tests := []struct{\n        description string\n        first, second string\n    }{\n        {\n            description: \"both strings equal\",\n            first: \"aaaa\",\n            second: \"aaaa\",\n        },\n        {\n            description: \"one string in caps\",\n            first: \"aaaa\",\n            second: \"AAAA\",\n        },\n        {\n            description: \"weird casing situation\",\n            first: \"aAaA\",\n            second: \"AaAa\",\n        },\n    }\n\n    for _, tt := range tests {\n        b.Run(fmt.Sprintf(\"%s::equality op\", tt.description), func(b *testing.B) {\n            for i := 0; i &lt; b.N; i++ {\n                benchmarkStringEqualsOperation(tt.first, tt.second, b)\n            }\n        })\n\n        b.Run(fmt.Sprintf(\"%s::strings equal fold\", tt.description), func(b *testing.B) {\n            for i := 0; i &lt; b.N; i++ {\n                benchmarkStringsEqualFold(tt.first, tt.second, b)\n            }\n        })\n\n        b.Run(fmt.Sprintf(\"%s::fold caser\", tt.description), func(b *testing.B) {\n            for i := 0; i &lt; b.N; i++ {\n                benchmarkStringsFoldCaser(tt.first, tt.second, foldCaser, b)\n            }\n        })\n\n        b.Run(fmt.Sprintf(\"%s::lower caser\", tt.description), func(b *testing.B) {\n            for i := 0; i &lt; b.N; i++ {\n                benchmarkStringsLowerCaser(tt.first, tt.second, lowerCaser, b)\n            }\n        })\n    }\n}\n\nfunc benchmarkStringEqualsOperation(first, second string, b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        _ = strings.ToLower(first) == strings.ToLower(second)\n    }\n}\n\nfunc benchmarkStringsEqualFold(first, second string, b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        _ = strings.EqualFold(first, second)\n    }\n}\n\nfunc benchmarkStringsFoldCaser(first, second string, caser cases.Caser, b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        _ = caser.String(first) == caser.String(second)\n    }\n}\n\nfunc benchmarkStringsLowerCaser(first, second string, caser cases.Caser, b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        _ = caser.String(first) == caser.String(second)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2428, "user_id": 2202911, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9a06f86b30413aa2d4c274a7b017231e?s=128&d=identicon&r=PG", "display_name": "user2202911", "link": "https://stackoverflow.com/users/2202911/user2202911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131976, "favorite_count": 12, "accepted_answer_id": 34383753, "answer_count": 4, "score": 96, "last_activity_date": 1570827861, "creation_date": 1450632180, "last_edit_date": 1450632319, "question_id": 34383705, "link": "https://stackoverflow.com/questions/34383705/how-do-i-compare-strings-in-golang", "title": "How do I compare strings in GoLang?", "body": "<p>I am unable to produce a 'true' result when it comes to Go string comparison. I wrote the following to explain the issue and attached a screenshot of the output</p>\n\n<pre><code>// string comparison in Go\npackage main\nimport \"fmt\"\nimport \"bufio\"\nimport \"os\"\n\nfunc main() {\n    var isLetterA bool \n\n    fmt.Println(\"Enter the letter a\")\n    reader := bufio.NewReader(os.Stdin)\n    input, _ := reader.ReadString('\\n')\n\n    if(input == \"a\") {\n        isLetterA = true\n    } else {\n        isLetterA = false \n    }\n\n    fmt.Println(\"You entered\",input)\n    fmt.Println(\"Is it the letter a?\",isLetterA)\n\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eiGMI.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/eiGMI.png\" alt=\"example\"></a></p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 279, "user_id": 1592136, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df0fe11c457ee38f1b6c8587eea95bd2?s=128&d=identicon&r=PG", "display_name": "Kanwal Prakash Singh", "link": "https://stackoverflow.com/users/1592136/kanwal-prakash-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1450629728, "creation_date": 1450629728, "answer_id": 34383269, "question_id": 34382838, "link": "https://stackoverflow.com/questions/34382838/fetching-the-data-from-a-mongodb-in-golang/34383269#34383269", "title": "fetching the data from a mongodb in golang", "body": "<p>oh I found the solution \nthe \"result\" variable should be of type bson.M and then you can typecast accordingly as you go deep into the nesting structure.</p>\n"}], "owner": {"reputation": 279, "user_id": 1592136, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df0fe11c457ee38f1b6c8587eea95bd2?s=128&d=identicon&r=PG", "display_name": "Kanwal Prakash Singh", "link": "https://stackoverflow.com/users/1592136/kanwal-prakash-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450629728, "creation_date": 1450627101, "question_id": 34382838, "link": "https://stackoverflow.com/questions/34382838/fetching-the-data-from-a-mongodb-in-golang", "title": "fetching the data from a mongodb in golang", "body": "<p>I'm trying to fetch data from mongodb in golang using the gopkg.in/mgo.v2 driver, the format of the data is not fixed , as in few rows will be containing some fields which other rows might not. </p>\n\n<p>here is the code for the same </p>\n\n<pre><code>session, err := mgo.Dial(\"mongodb://root:root@localhost:27017/admin\")\ndb := session.DB(\"test\")\nfmt.Println(reflect.TypeOf(db))\nCheckError(err,\"errpor\")\nresult := make(map[string]string)\n//query := make(map[string]string)\n//query[\"_id\"] = \"3434\"\n\nerr1 := db.C(\"mycollection\").Find(nil).One(&amp;result)\nCheckError(err1,\"error\")\nfor k := range result {\n    fmt.Println(k)\n}\n</code></pre>\n\n<p>Now the data contained in the collection is { \"_id\" : \"3434\", \"0\" : 1 }, however the for loop gives the output as _id , shouldn't there be two keys '_id' and '0' ? or am I doing something wrong here.</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450628417, "post_id": 34382790, "comment_id": 56507448, "body": "You initialize them like any other struct field. Can you show en example of where you&#39;re having a problem?"}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450629097, "post_id": 34382790, "comment_id": 56507676, "body": "<code>structValue.Field(i).Set(reflect.MakeChan(structValue.Field(&zwnj;&#8203;i).Type(), 1))</code> solves it."}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450626779, "creation_date": 1450626779, "question_id": 34382790, "link": "https://stackoverflow.com/questions/34382790/initialize-all-channels-in-a-struct-using-reflect", "title": "Initialize all channels in a struct using reflect", "body": "<p>I have some structs that contain some fields and some channels. I managed to dynamically fill the fields from a map, but how do I initialize the channels? I need to set the size of them as well.</p>\n\n<pre><code>type MyStruct struct {\n    ...\n    Out           chan *mypackage.OtherStruct `json:\"-\"`\n    Quit          chan struct{}               `json:\"-\"`\n}\n</code></pre>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 750, "user_id": 1748069, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/QOMeY.jpg?s=128&g=1", "display_name": "Matthew S", "link": "https://stackoverflow.com/users/1748069/matthew-s"}, "edited": false, "score": 0, "creation_date": 1450808038, "post_id": 34382467, "comment_id": 56585400, "body": "This appears to be a problem with go/build not honoring GO15VENDOREXPERIMENT. See <a href=\"https://github.com/golang/go/issues/12278\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/12278</a>"}], "owner": {"reputation": 750, "user_id": 1748069, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/QOMeY.jpg?s=128&g=1", "display_name": "Matthew S", "link": "https://stackoverflow.com/users/1748069/matthew-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 367, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450624707, "creation_date": 1450624707, "question_id": 34382467, "link": "https://stackoverflow.com/questions/34382467/revel-not-working-with-go15vendorexperiment", "title": "Revel not working with GO15VENDOREXPERIMENT?", "body": "<p>I'm using revel together with GO15VENDOREXPERIMENT. This implies that my revel package is located in the vendor folder inside my project folder:</p>\n\n<pre><code>$GOPATH\\src\\myproject\\vendor\\github.com\\revel\n</code></pre>\n\n<p>Revel and my project build correctly. Go implicitly changes the revel imports to:</p>\n\n<pre><code>\"myproject/vendor/github.com/revel/revel\n</code></pre>\n\n<p>However, when I go to run my project, revel tries to import from the standard GOPATH. It does not recognize that I have GO15VENDOREXPERIMENT turned on. </p>\n\n<pre><code>c:\\WorkspaceGo\\go\\src\\myproject&gt;revel run myproject\n~\n~ revel! http://revel.github.io\n~\nERROR 2015/12/20 09:51:27 revel.go:281: Failed to find Revel with error: \ncannot find package \"github.com/revel/revel\" in any of:\n    C:\\Go\\src\\github.com\\revel\\revel (from $GOROOT)\n    c:\\WorkspaceGo\\go\\src\\github.com\\revel\\revel (from $GOPATH)\n</code></pre>\n\n<p>How can I make revel recognize GO15VENDOREXPERIMENT so that it uses the correct GOPATH?</p>\n"}, {"tags": ["go", "gogs"], "comments": [{"owner": {"reputation": 3198, "user_id": 1658975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4FKr5.png?s=128&g=1", "display_name": "Ryu_hayabusa", "link": "https://stackoverflow.com/users/1658975/ryu-hayabusa"}, "edited": false, "score": 1, "creation_date": 1450622370, "post_id": 34382103, "comment_id": 56505541, "body": "would the down votes care to comment ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450628974, "post_id": 34382103, "comment_id": 56507626, "body": "What version of <code>git</code> do you have?"}, {"owner": {"reputation": 3198, "user_id": 1658975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4FKr5.png?s=128&g=1", "display_name": "Ryu_hayabusa", "link": "https://stackoverflow.com/users/1658975/ryu-hayabusa"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450630003, "post_id": 34382103, "comment_id": 56508000, "body": "@JimB git version 1.9.1"}, {"owner": {"reputation": 3198, "user_id": 1658975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4FKr5.png?s=128&g=1", "display_name": "Ryu_hayabusa", "link": "https://stackoverflow.com/users/1658975/ryu-hayabusa"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450630278, "post_id": 34382103, "comment_id": 56508087, "body": "<b><i>go get</i></b> command is working but its terribly slow for packages that have lots of dependencies. the <b>-v</b> flag helped me to get a verbose output of what is happening."}], "answers": [{"comments": [{"owner": {"reputation": 3198, "user_id": 1658975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4FKr5.png?s=128&g=1", "display_name": "Ryu_hayabusa", "link": "https://stackoverflow.com/users/1658975/ryu-hayabusa"}, "edited": false, "score": 1, "creation_date": 1450622634, "post_id": 34382152, "comment_id": 56505622, "body": "I will give a try and update here, thanks for the answer."}, {"owner": {"reputation": 3198, "user_id": 1658975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4FKr5.png?s=128&g=1", "display_name": "Ryu_hayabusa", "link": "https://stackoverflow.com/users/1658975/ryu-hayabusa"}, "edited": false, "score": 0, "creation_date": 1450624118, "post_id": 34382152, "comment_id": 56506071, "body": "&#39;godep get  github.com/gogits/gogs&#39;  is also stuck  indefinitely . I think it has to do with the size of package."}, {"owner": {"reputation": 4674, "user_id": 1058125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ffd738da318a9ac181fbbef599e64a3?s=128&d=identicon&r=PG", "display_name": "Boynux", "link": "https://stackoverflow.com/users/1058125/boynux"}, "reply_to_user": {"reputation": 3198, "user_id": 1658975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4FKr5.png?s=128&g=1", "display_name": "Ryu_hayabusa", "link": "https://stackoverflow.com/users/1658975/ryu-hayabusa"}, "edited": false, "score": 0, "creation_date": 1450624326, "post_id": 34382152, "comment_id": 56506135, "body": "Hmmm, is your environment setup correctly? Seems you have some sort of configuration issues. (just a guess). Just create a fresh VM, install Go and give it another try please."}], "tags": [], "owner": {"reputation": 4674, "user_id": 1058125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ffd738da318a9ac181fbbef599e64a3?s=128&d=identicon&r=PG", "display_name": "Boynux", "link": "https://stackoverflow.com/users/1058125/boynux"}, "is_accepted": false, "score": -1, "last_activity_date": 1450622528, "creation_date": 1450622528, "answer_id": 34382152, "question_id": 34382103, "link": "https://stackoverflow.com/questions/34382103/getting-packages-for-go-language/34382152#34382152", "title": "Getting packages for GO language", "body": "<p>You can use GoDep which is a powerful Go dependency manager: <a href=\"https://github.com/tools/godep\" rel=\"nofollow\">https://github.com/tools/godep</a></p>\n\n<p>GoDep also helps you to have a predictable build since it freezes dependencies in your app\nVery easy to get started, just follow instruction on its Github page.</p>\n"}, {"tags": [], "owner": {"reputation": 3198, "user_id": 1658975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4FKr5.png?s=128&g=1", "display_name": "Ryu_hayabusa", "link": "https://stackoverflow.com/users/1658975/ryu-hayabusa"}, "is_accepted": false, "score": 2, "last_activity_date": 1450630590, "creation_date": 1450630590, "answer_id": 34383429, "question_id": 34382103, "link": "https://stackoverflow.com/questions/34382103/getting-packages-for-go-language/34383429#34383429", "title": "Getting packages for GO language", "body": "<p><strong><em>go get</em></strong> command is working but its terribly slow for packages that have lots of dependencies. the <strong>-v</strong> flag(not in doc) helped me to get a verbose output of what is happening. </p>\n\n<p>Took almost an hour to finish. Culprit might possibly be github or my ISP.\nVerbose output should had made default by the developers.</p>\n\n<p>*sorry for my English.</p>\n"}], "owner": {"reputation": 3198, "user_id": 1658975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4FKr5.png?s=128&g=1", "display_name": "Ryu_hayabusa", "link": "https://stackoverflow.com/users/1658975/ryu-hayabusa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1450630590, "creation_date": 1450622217, "last_edit_date": 1450623971, "question_id": 34382103, "link": "https://stackoverflow.com/questions/34382103/getting-packages-for-go-language", "title": "Getting packages for GO language", "body": "<p>The below command is taking ages with no output or anything, is there an alternative way to download packages for go language.? I am new to golang.</p>\n\n<pre><code> go get -u github.com/gogits/gogs/\n</code></pre>\n\n<p>PS: my net connection is not that slow, downloading through git takes around 1 min, but i can't individually do that for all dependencies.</p>\n\n<p>Edit 1: Small packages like <code>go get github.com/tools/godep</code> downloads and install flawlessly,  i have the problem only with github.com/gogits/gogs/ . Its stuck there for an hour.  Even a download progress  would have been helpful.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 5, "creation_date": 1450619577, "post_id": 34381652, "comment_id": 56504654, "body": "You&#39;re looking for the <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">sqlx</a> package."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1450645010, "post_id": 34381652, "comment_id": 56512778, "body": "@TimCooper feel free to make this an answer and I&#39;ll gladly mark it as answered, unless something comes up later on that doesn&#39;t involve a third party package"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450619255, "creation_date": 1450619255, "question_id": 34381652, "link": "https://stackoverflow.com/questions/34381652/is-it-possible-to-scan-a-sql-statement-directly-into-a-struct", "title": "Is it possible to scan a sql statement directly into a struct?", "body": "<p>Say I have this:</p>\n\n<pre><code>type User struct {\n    Email string\n    Username string\n    Addresses []Address\n}\n\ntype Address struct {\n    Street string\n}\n\nusers := &amp;User{}\n\nrows, _ := db.Query(`SELECT * FROM users NATURAL JOIN users_addresses`)\n\nrows.Scan(users)\n</code></pre>\n\n<p>Is it possible to just scan into a struct that has the same layout as the table in the database without having to scan into each struct field directly or is that the only way to do it?</p>\n"}, {"tags": ["curl", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450618362, "post_id": 34380915, "comment_id": 56504309, "body": "Why all the tls.Config stuff? None of that is in your curl command. Also, why is your curl command specifying a --cacert, then setting --insecure?"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1451463057, "post_id": 34380915, "comment_id": 56792180, "body": "If the ca.crt isn&#39;t in your OS&#39;s trust store then you do need to set RootCAs. You don&#39;t need to set the rest of tlsconfig. The default tlsconfig is fine. You definitely don&#39;t need to set InsecureSkipVerify. Is something not working?"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563142458, "creation_date": 1450613806, "last_edit_date": 1450615100, "question_id": 34380915, "link": "https://stackoverflow.com/questions/34380915/convert-curl-to-golang-code", "title": "Convert curl to GOlang code", "body": "<p>I am a GO newbie. I am trying to convert a curl command to GOlang. </p>\n\n<pre><code>curl --cacert \"pki/ca.crt\" \\\n  -H \"Authorization: Bearer my_bearer_token\" \\\n  --insecure \\\n  --max-time 5 --fail --output /dev/null --silent \\\n  \"https://myserver/status\"; do\n</code></pre>\n\n<p>This is what I have got:</p>\n\n<pre><code>mTLSConfig := &amp;tls.Config {\n    CipherSuites: []uint16 {\n        tls.TLS_RSA_WITH_RC4_128_SHA,\n        tls.TLS_RSA_WITH_3DES_EDE_CBC_SHA,\n        tls.TLS_RSA_WITH_AES_128_CBC_SHA,\n        tls.TLS_ECDHE_RSA_WITH_RC4_128_SHA,\n        tls.TLS_RSA_WITH_AES_128_CBC_SHA,\n        tls.TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,\n    },\n    InsecureSkipVerify: true, // --insecure\n}\nmTLSConfig.PreferServerCipherSuites = true\nmTLSConfig.MinVersion = tls.VersionTLS10\nmTLSConfig.MaxVersion = tls.VersionTLS10\ncerts := x509.NewCertPool()\ncerts.AppendCertsFromPEM([]byte(caCert))\nmTLSConfig.RootCAs = certs\ntr := &amp;http.Transport{\n    TLSClientConfig: mTLSConfig,\n}\n\nclient := &amp;http.Client{Transport: tr}\nreq, _ := http.NewRequest(\"GET\", \"https://myserver/status\", nil)\nreq.Header.Set(\"Authorization\", fmt.Sprintf(\"Bearer my_bearer_token\"))\nresp, err := client.Do(req)\nglog.V(4).Info(resp, err)\nif err != nil {\n    return true\n}\nreturn false\n</code></pre>\n\n<p>Am I doing it right?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 3, "creation_date": 1450601787, "post_id": 34379341, "comment_id": 56500271, "body": "For i/o bound tasks you might not get all that much from CPU concurrency. You might want to look into channels, too."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1450602112, "post_id": 34379341, "comment_id": 56500331, "body": "What the &quot;process r&quot; is? If it is something relatively &quot;easy&quot; it might not be worth to do it in separate gorutine - overhead is bigger than gain. Also, as the result, will you have one &quot;log data set&quot; (ie all 5 files are merged to one) or will there be 5 different resultsets?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1450602162, "post_id": 34379341, "comment_id": 56500343, "body": "@ain My understanding is that it would have to be <i>pretty</i> insubstantial. The overhead of goroutines is INCREDIBLY low."}, {"owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1450602187, "post_id": 34379341, "comment_id": 56500353, "body": "@salvador No, not hard to implement, but I won&#39;t get to a development environment before middle of next week. Was curious to know what other people thought of the idea."}, {"owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1450602324, "post_id": 34379341, "comment_id": 56500390, "body": "@ain There will be 5 separate result files, one for each source file. Also, &quot;process r&quot; easy enough, but there is some processing to be done. e.g Regexes, convert from hex to decimal, output in csv"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1450602329, "post_id": 34379341, "comment_id": 56500392, "body": "@AdamSmith Yes, but it all adds up (adding to waitgroup too) and if the proccessing is really simple then it just isn&#39;t worth to do it."}, {"owner": {"reputation": 15285, "user_id": 113158, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48b539a26d13f6c9e40081805d8f47ac?s=128&d=identicon&r=PG", "display_name": "Jean Hominal", "link": "https://stackoverflow.com/users/113158/jean-hominal"}, "edited": false, "score": 0, "creation_date": 1450602534, "post_id": 34379341, "comment_id": 56500449, "body": "Do you need the row results to be output in the same order as in the input file?"}, {"owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "reply_to_user": {"reputation": 15285, "user_id": 113158, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/48b539a26d13f6c9e40081805d8f47ac?s=128&d=identicon&r=PG", "display_name": "Jean Hominal", "link": "https://stackoverflow.com/users/113158/jean-hominal"}, "edited": false, "score": 0, "creation_date": 1450602607, "post_id": 34379341, "comment_id": 56500462, "body": "@Jean No, order does not matter at all"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "edited": false, "score": 0, "creation_date": 1450641304, "post_id": 34379570, "comment_id": 56511665, "body": "Thank you very much for this!"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 7, "last_activity_date": 1450811524, "last_edit_date": 1450811524, "creation_date": 1450603533, "answer_id": 34379570, "question_id": 34379341, "link": "https://stackoverflow.com/questions/34379341/golang-processing-5-huge-files-concurrently/34379570#34379570", "title": "Golang: Processing 5 huge files concurrently", "body": "<p>You should definitely use channels to manage your processed rows. Alternatively you could also write another goroutine to handle your output.</p>\n\n<pre><code>var numGoWriters = 10\n\nfunc processRow(r Row, ch chan&lt;- string) {\n    res := process(r)\n    ch &lt;- res\n}\n\nfunc writeRow(f File, ch &lt;-chan string) {\n    w := bufio.NewWriter(f)\n    for s := range ch {\n        _, err := w.WriteString(s + \"\\n\")\n    }\n\nfunc processFile(f File) {\n    outFile, err := os.Create(\"/path/to/file.out\")\n    if err != nil {\n        // handle it\n    }\n    defer outFile.Close()\n    var wg sync.WaitGroup\n    ch := make(chan string, 10)  // play with this number for performance\n    defer close(ch) // once we're done processing rows, we close the channel\n                    // so our worker threads exit\n    fScanner := bufio.NewScanner(f)\n    for fScanner.Scan() {\n        wg.Add(1)\n        go func() {\n            processRow(fScanner.Text(), ch)\n            wg.Done()\n        }()\n    }\n    for i := 0; i &lt; numGoWriters; i++ {\n        go writeRow(outFile, ch)\n    }\n    wg.Wait()  \n}\n</code></pre>\n\n<p>Here we have <code>processRow</code> doing all the processing (I assumed to <code>string</code>), <code>writeRow</code> doing all the out I/O, and <code>processFile</code> tying each file together. Then all <code>main</code> has to do is hand off the files, spawn the goroutines, <em>et voila</em>.</p>\n\n<pre><code>func main() {\n    var wg sync.WaitGroup\n\n    filenames := [...]string{\"here\", \"are\", \"some\", \"log\", \"paths\"}\n    for fname := range filenames {\n        inFile, err := os.Open(fname)\n        if err != nil {\n            // handle it\n        }\n        defer inFile.Close()\n        wg.Add(1)\n        go processFile(inFile)\n    }\n    wg.Wait()\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1639, "favorite_count": 4, "accepted_answer_id": 34379570, "answer_count": 1, "score": 3, "last_activity_date": 1450811524, "creation_date": 1450601531, "question_id": 34379341, "link": "https://stackoverflow.com/questions/34379341/golang-processing-5-huge-files-concurrently", "title": "Golang: Processing 5 huge files concurrently", "body": "<p>I have 5 huge (4 million rows each) logfiles that I process in Perl currently and I thought I may try to implement the same in Go and its concurrent features. So, being very inexperienced in Go, I was thinking of doing as below. Any comments on the approach will be greatly appreciated.\nSome rough pseudocode:</p>\n\n<pre><code>var wg1 sync.WaitGroup\nvar wg2 sync.WaitGroup\n\nfunc processRow (r Row) {\n    wg2.Add(1)\n    defer wg2.Done()\n    res = &lt;process r&gt;\n    return res\n}\n\nfunc processFile(f File) {\n    wg1.Add(1)\n    open(newfile File)\n    defer wg1.Done()\n    line = &lt;row from f&gt;\n    result = go processRow(line)\n    newFile.Println(result) // Write new processed line to newFile\n    wg2.Wait()\n    newFile.Close()\n\n}\n\nfunc main() {\n\n    for each f logfile {\n        go processFile(f)\n    }\n    wg1.Wait()\n}\n</code></pre>\n\n<p>So, idea is that I process these 5 files concurrently and then all rows of each file will in turn also be processed concurrently.</p>\n\n<p>Will that work?</p>\n"}, {"tags": ["go", "long-integer", "literals", "unsigned", "uint64"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1450565243, "post_id": 34376141, "comment_id": 56494035, "body": "Relevant section in the specification: <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">Constants</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3835277"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 1, "creation_date": 1450586149, "post_id": 34376141, "comment_id": 56497527, "body": "@SalvadorDali what do you mean by &quot;put&quot;? The answer to my original question is no,  there is no such thing as a <code>uint64</code> literal in Go. You have to cast to <code>uint64</code>, apparently."}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 11, "last_activity_date": 1450565037, "creation_date": 1450565037, "answer_id": 34376163, "question_id": 34376141, "link": "https://stackoverflow.com/questions/34376141/are-there-uint64-literals-in-go/34376163#34376163", "title": "Are there uint64 literals in Go?", "body": "<p>you can just cast your integer literal to <code>uint64</code>.</p>\n\n<pre><code>for i := uint64(1); i &lt;= k; i++ {\n    // do something\n}\n</code></pre>\n\n<p>Alternatively you could initialize <code>i</code> outside of the <code>for</code> loop, but then it's scoped larger than the loop itself.</p>\n\n<pre><code>var i uint64\nfor i = 1; i &lt;= k; i++ {\n    // note the `=` instead of the `:=`\n}\n// i still exists and is now k+1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1450565106, "creation_date": 1450565106, "answer_id": 34376170, "question_id": 34376141, "link": "https://stackoverflow.com/questions/34376141/are-there-uint64-literals-in-go/34376170#34376170", "title": "Are there uint64 literals in Go?", "body": "<p>You have to explicitly declare your variables as that type. The int literal will be of type <code>int</code> <a href=\"https://play.golang.org/p/OgaZzmpLfB\" rel=\"nofollow\">https://play.golang.org/p/OgaZzmpLfB</a> something like <code>var i uint64</code> is required. In your example you'd have to change your assignment as well so something like this;</p>\n\n<pre><code>var i uint64\nfor i = 2; i &lt;= k; i += 1 { // I want i to be a uint64\n    ...\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3835277"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7044, "favorite_count": 1, "accepted_answer_id": 34376163, "answer_count": 2, "score": 6, "last_activity_date": 1450565126, "creation_date": 1450564861, "question_id": 34376141, "link": "https://stackoverflow.com/questions/34376141/are-there-uint64-literals-in-go", "title": "Are there uint64 literals in Go?", "body": "<p>I'm looking at the <a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"noreferrer\">numeric types</a> in Go. I want to use uint64 literals. Is this possible in Go?</p>\n\n<p>Here's an example of how I'd like to use uint64 literals:</p>\n\n<pre><code>for i := 2; i &lt;= k; i += 1 { // I want i to be a uint64\n    ...\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1450564835, "post_id": 34376090, "comment_id": 56493936, "body": "See if the following command gives you the information you need: <code>objdump -t &lt;binary&gt;  | grep &lt;package&gt;</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450628723, "post_id": 34376090, "comment_id": 56507549, "body": "Your code is only guaranteed to be included if it&#39;s used. If your code runs, then it&#39;s there, if it&#39;s not used then it doesn&#39;t really matter."}, {"owner": {"reputation": 307, "user_id": 2659047, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a75a1eac5f3c9c7baf26e98fa07d051b?s=128&d=identicon&r=PG", "display_name": "Mike Nishizawa", "link": "https://stackoverflow.com/users/2659047/mike-nishizawa"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1451957237, "post_id": 34376090, "comment_id": 56951383, "body": "@TimCooper - Thanks, that was helpful."}], "owner": {"reputation": 307, "user_id": 2659047, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a75a1eac5f3c9c7baf26e98fa07d051b?s=128&d=identicon&r=PG", "display_name": "Mike Nishizawa", "link": "https://stackoverflow.com/users/2659047/mike-nishizawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450564469, "creation_date": 1450564469, "question_id": 34376090, "link": "https://stackoverflow.com/questions/34376090/is-it-possible-to-check-the-contents-of-a-binary-in-go", "title": "Is it possible to check the contents of a binary in Go?", "body": "<p>I am currently adding code into a larger project using Go, however I am not sure my code is being included during the build.  Is it possible to introspect the binary to ensure it is there?  This would be an operation similar to java's </p>\n\n<p><code>jar -tf something.jar</code></p>\n"}, {"tags": ["go", "system-calls"], "comments": [{"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1450596619, "post_id": 34374582, "comment_id": 56499221, "body": "According to EnumProcessModules documentation, the modules is an array of handles. So it should be modules := make(syscall.Handle, 2049). And last parameter of EnumProcessModules is *uint32, so your &quot;needed&quot; variable should be uint32, not int. int does not have fixed size (it is int32 on 386, and is int64 on amd64)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450711669, "post_id": 34374582, "comment_id": 56539363, "body": "You&#39;re passing a slice pointer to a windows function that knows nothing about slices. You wither need to use an array or use the address of the first element."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9864684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vTru72dLfHc/AAAAAAAAAAI/AAAAAAAAAEg/5UmYR5M4adE/photo.jpg?sz=128", "display_name": "Ozair J&#250;nior", "link": "https://stackoverflow.com/users/9864684/ozair-j%c3%banior"}, "is_accepted": false, "score": 0, "last_activity_date": 1531515077, "creation_date": 1531515077, "answer_id": 51332641, "question_id": 34374582, "link": "https://stackoverflow.com/questions/34374582/go-syscall-enumprocessmodules/51332641#51332641", "title": "Go syscall EnumProcessModules", "body": "<p>Yes, you must reference the first element.</p>\n\n<pre><code>var n uint32\nvar needed uint32\n\n// How many I need?\nret, _, _ := procEnumProcessModules.Call(\n  uintptr(handle),\n  0,\n  uintptr(n),\n  uintptr(unsafe.Pointer(&amp;needed)))\n\nif int(ret) == 1 &amp;&amp; needed &gt; 0 {\n\n  procHandles := make([]syscall.Handle, needed) \n  procHandlesPtr := unsafe.Pointer(&amp;procHandles[0])\n\n  n = needed\n  ret2, _, _ := procEnumProcessModules.Call(\n    uintptr(n),\n    uintptr(procHandlesPtr),\n    uintptr(n), \n    uintptr(unsafe.Pointer(&amp;needed))))\n\n  if int(ret2) == 1 {\n    for i:= 0; i &lt; needed / 4; i++ {\n       fmt.Println(procHandles[i])\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531515077, "creation_date": 1450553729, "last_edit_date": 1450553973, "question_id": 34374582, "link": "https://stackoverflow.com/questions/34374582/go-syscall-enumprocessmodules", "title": "Go syscall EnumProcessModules", "body": "<p>Im trying to call ;EnumProcessModules; using Go of a given handle</p>\n\n<pre><code>var (\n    psapi = syscall.NewLazyDLL(\"Psapi.dll\")\n    procEnumProcessModules = psapi.NewProc(\"EnumProcessModules\")\n)\n\nfunc EnumProcessModules(handle uintptr) {\n    log.Println(handle)\n    modules := make([]interface{}, 2049)\n    var needed int\n    procEnumProcessModules.Call(\n        handle,\n        uintptr(unsafe.Pointer(&amp;modules)),\n        uintptr(2048),\n        uintptr(unsafe.Pointer(&amp;needed)),\n    )\n    log.Println(needed)\n    for i := 0; i &lt; needed; i++ {\n        log.Println(modules[i])\n    }\n}\n</code></pre>\n\n<p>Everything seems to work... needed is set but the moment I try to access modules variable I get the following error:</p>\n\n<pre><code>unexpected fault address 0x12d0000\nfatal error: fault\n[signal 0xc0000005 code=0x0 addr=0x12d0000 pc=0x455b56]\n</code></pre>\n\n<p>How should the modules array look like?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 2, "creation_date": 1450557040, "post_id": 34373933, "comment_id": 56491934, "body": "I&#39;m not positive, but I think that may be either the terminal or the shell (in either case, not your program), so unless you can instruct whichever is outputting the <code>^C</code> not to do that (via some IPC mechanism?) I&#39;m not sure that you can do anything about it."}, {"owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "reply_to_user": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 1, "creation_date": 1450557092, "post_id": 34373933, "comment_id": 56491947, "body": "Yeah I thought that might be the answer."}, {"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 1, "creation_date": 1450560618, "post_id": 34373933, "comment_id": 56492840, "body": "You could use the <code>kill</code> command to send the signal to the process, thereby curcumventing the shell, if the <code>^C</code> does NOT show then, you can be relatively certain that it&#39;s the shell or terminal printing this."}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 1, "creation_date": 1450561876, "post_id": 34373933, "comment_id": 56493171, "body": "Confirmed: <a href=\"https://superuser.com/questions/147013/how-to-disable-c-from-being-echoed-on-linux-on-ctrl-c\" title=\"how to disable c from being echoed on linux on ctrl c\">superuser.com/questions/147013/&hellip;</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1450611433, "post_id": 34373933, "comment_id": 56502548, "body": "When you input <code>^C</code> at the terminal, it generates <code>SIGINT</code>, not <code>SIGTERM</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3468, "user_id": 71978, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ex4dt.jpg?s=128&g=1", "display_name": "TomOnTime", "link": "https://stackoverflow.com/users/71978/tomontime"}, "is_accepted": false, "score": 1, "last_activity_date": 1454311102, "last_edit_date": 1492086991, "creation_date": 1454311102, "answer_id": 35124914, "question_id": 34373933, "link": "https://stackoverflow.com/questions/34373933/prevent-c-from-being-displayed-on-ctrlc-in-go/35124914#35124914", "title": "Prevent ^C from being displayed on Ctrl+C in Go", "body": "<p>If you put the terminal into raw mode, you'll get the keystrokes directly and the tty won't interpret them (and display ^C).</p>\n\n<p>I'm not sure of the best way to set raw mode in Go, but golang.org/x/crypto/ssh/terminal's RawMode() does it. You would then have to enable INT and TERM handling otherwise you'll receive a ^C as input, instead having it be processed as an interruption. </p>\n\n<p>An explanation of raw mode is here:  <a href=\"https://unix.stackexchange.com/questions/21752/what-s-the-difference-between-a-raw-and-a-cooked-device-driver\">https://unix.stackexchange.com/questions/21752/what-s-the-difference-between-a-raw-and-a-cooked-device-driver</a></p>\n\n<p>A similar answer is here: <a href=\"https://superuser.com/questions/147013/how-to-disable-c-from-being-echoed-on-linux-on-ctrl-c\">https://superuser.com/questions/147013/how-to-disable-c-from-being-echoed-on-linux-on-ctrl-c</a></p>\n"}, {"comments": [{"owner": {"reputation": 2463, "user_id": 1052007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272df854e268223a57c4aec2d7b65436?s=128&d=identicon&r=PG", "display_name": "Hugo", "link": "https://stackoverflow.com/users/1052007/hugo"}, "edited": false, "score": 0, "creation_date": 1572347858, "post_id": 47072622, "comment_id": 103523615, "body": "Super awesome - I bet Python does that too."}], "tags": [], "owner": {"reputation": 2698, "user_id": 948369, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d4ef98bb6b9fa36ebde9b7fc2b333bbb?s=128&d=identicon&r=PG", "display_name": "Glaslos", "link": "https://stackoverflow.com/users/948369/glaslos"}, "is_accepted": false, "score": 5, "last_activity_date": 1509617489, "creation_date": 1509617489, "answer_id": 47072622, "question_id": 34373933, "link": "https://stackoverflow.com/questions/34373933/prevent-c-from-being-displayed-on-ctrlc-in-go/47072622#47072622", "title": "Prevent ^C from being displayed on Ctrl+C in Go", "body": "<p>If you print something afterwards, you can do</p>\n\n<pre><code>fmt.Print(\"\\r\")\nlog.Println(\"Shutting down\")\n</code></pre>\n\n<p><code>\\r</code> is a carriage return character; it tells your terminal emulator to move the cursor at the start of the line. This way you can overwrite the <code>^C</code> on the terminal.</p>\n"}], "owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1509617489, "creation_date": 1450549443, "question_id": 34373933, "link": "https://stackoverflow.com/questions/34373933/prevent-c-from-being-displayed-on-ctrlc-in-go", "title": "Prevent ^C from being displayed on Ctrl+C in Go", "body": "<p>I'd like to prevent \"^C\" from being outputted to the terminal when Ctrl+C is pressed.</p>\n\n<p>I'm capturing the interrupt command like this:</p>\n\n<pre><code>c := make(chan os.Signal, 1)\nsignal.Notify(c, os.Interrupt)\nsignal.Notify(c, syscall.SIGTERM)\ngo func() {\n    &lt;-c\n    // exit code here\n}()\n</code></pre>\n\n<p>... however, when I press Ctrl+C, \"^C\" is outputted into the terminal. This isn't ideal.</p>\n"}, {"tags": ["performance", "go", "amazon-s3", "concurrency", "parallel-processing"], "comments": [{"owner": {"reputation": 102, "user_id": 808884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13b08594968d5041011c18ba34c6651b?s=128&d=identicon&r=PG", "display_name": "mentat", "link": "https://stackoverflow.com/users/808884/mentat"}, "edited": false, "score": 0, "creation_date": 1461860527, "post_id": 34372972, "comment_id": 61402226, "body": "I just ran into this as well. I suspect that ListObjectsPages is not goroutine safe but it could be the single session as well. I thought that having a session was supposed to make the SDK goroutine safe though."}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1008, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450543272, "creation_date": 1450543272, "last_edit_date": 1495542235, "question_id": 34372972, "link": "https://stackoverflow.com/questions/34372972/download-from-multiple-sources-in-parallel-using-a-goroutine", "title": "Download from multiple sources in parallel using a goroutine", "body": "<p>First I would like to say i've already viewed <a href=\"https://stackoverflow.com/questions/23635070/golang-download-multiple-files-in-parallel-using-goroutines\">Golang download multiple files in parallel using goroutines</a> and <a href=\"https://stackoverflow.com/questions/19208725/example-for-sync-waitgroup-correct\">Example for sync.WaitGroup correct?</a> and i've used them as a guide in my code.  However I'm not certain that it's working for me. I'm trying to download files from multiple buckets on aws.  This is what I have (some lines will be blank for security reasons).</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"os\"\n    \"os/user\"\n    \"path/filepath\"\n    \"sync\"\n    \"time\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/s3\"\n    \"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n)\n\nvar (\n    //Bucket         = \"\"                                               // Download from this bucket\n    Prefix         = \"\" // Using this key prefix\n    LocalDirectory = \"s3logs\"                                                    // Into this directory\n)\n\n// create a single session to be used\nvar sess = session.New()\n\n// used to control concurrency\nvar wg sync.WaitGroup\n\nfunc main() {\n    start := time.Now()\n    //map of buckets to region\n    regBuckets := map[string]string{\n\n    }\n\n\n\n    // download the files for each bucket\n    for region, bucket := range regBuckets {\n        fmt.Println(region)\n        wg.Add(1)\n        go getLogs(region, bucket, LocalDirectory, &amp;wg)\n    }\n    wg.Wait()\n    elapsed := time.Since(start)\n    fmt.Printf(\"\\nTime took %s\\n\", elapsed)\n\n}\n\n// function to get data from buckets\n\nfunc getLogs(region string, bucket string, directory string, wg *sync.WaitGroup) {\n    client := s3.New(sess, &amp;aws.Config{Region: aws.String(region)})\n    params := &amp;s3.ListObjectsInput{Bucket: &amp;bucket, Prefix: &amp;Prefix}\n    manager := s3manager.NewDownloaderWithClient(client, func(d *s3manager.Downloader) {\n        d.PartSize = 6 * 1024 * 1024 // 6MB per part\n        d.Concurrency = 5\n    })\n    d := downloader{bucket: bucket, dir: directory, Downloader: manager}\n    client.ListObjectsPages(params, d.eachPage)\n    wg.Done()\n}\n\n// downloader object and methods\ntype downloader struct {\n    *s3manager.Downloader\n    bucket, dir string\n}\n\nfunc (d *downloader) eachPage(page *s3.ListObjectsOutput, more bool) bool {\n    for _, obj := range page.Contents {\n        d.downloadToFile(*obj.Key)\n    }\n    return true\n}\n\nfunc (d *downloader) downloadToFile(key string) {\n    // Create the directories in the path\n    // desktop path\n    user, errs := user.Current()\n    if errs != nil {\n        panic(errs)\n    }\n    homedir := user.HomeDir\n    desktop := homedir + \"/Desktop/\" + d.dir\n    file := filepath.Join(desktop, key)\n    if err := os.MkdirAll(filepath.Dir(file), 0775); err != nil {\n        panic(err)\n    }\n\n    // Setup the local file\n    fd, err := os.Create(file)\n    if err != nil {\n        panic(err)\n    }\n    defer fd.Close()\n\n    // Download the file using the AWS SDK\n    fmt.Printf(\"Downloading s3://%s/%s to %s...\\n\", d.bucket, key, file)\n    params := &amp;s3.GetObjectInput{Bucket: &amp;d.bucket, Key: &amp;key}\n    d.Download(fd, params)\n    _, e := d.Download(fd, params)\n    if e != nil {\n        panic(e)\n    }\n}\n</code></pre>\n\n<p>In the <code>regBuckets</code> hashmap I place a list of <code>bucket names : regions</code>  In the for loop below I print the bucket name.  So If i have two buckets I want to download the items from both buckets at the same time.  I was testing this with a print statement.  I excepted to see the name of the first bucket and soon after the name of the second bucket.  However it seems like instead of downloading the files from multiple buckets is parallel it's downloading them in order, e.g bucket 1 when bucket 1 is done the for loop continues and then bucket 2...etc So i need help making sure I'm downloading in parallel because I have roughly 10 buckets and speed is important.  I also wonder if it's because i'm using a single session.  Any idea?</p>\n"}, {"tags": ["json", "go", "marshalling", "unmarshalling"], "comments": [{"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1450558319, "post_id": 34372786, "comment_id": 56492242, "body": "You can also directly marshal the struct without converting to map[string]interface{} before. The same applies for unmarshaling. I don&#39;t quite understand why you would want/need to take the detour over the map"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1450558367, "post_id": 34372786, "comment_id": 56492258, "body": "@tike: Yes, if I have JSON-formatted data. I don&#39;t. This question is about not having to use JSON as the intermediate step."}, {"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1450558476, "post_id": 34372786, "comment_id": 56492293, "body": "So why do you need to convert the struct to map in the first place?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1450558574, "post_id": 34372786, "comment_id": 56492314, "body": "I need to interface with an API that expects an arbitrary structure, but I don&#39;t want to have to pass <code>map[string]interface{}</code> all over the place in my code."}, {"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1450558705, "post_id": 34372786, "comment_id": 56492352, "body": "Does API mean a function in some library you use, which accepts only map[string]interface{} as argument? Just to be clear :-)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1450558796, "post_id": 34372786, "comment_id": 56492382, "body": "@tike: Basically. But don&#39;t get hung up on that detail. I&#39;ve actually been using this pattern in a number of projects with slightly different APIs and needs , and just want to find a better solution."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1450558967, "post_id": 34372786, "comment_id": 56492421, "body": "I know I can just re-implement what the <code>json</code> package does with reflection to read the tags... and that&#39;s probably what I will do.  But I was hoping for something simpler, which wouldn&#39;t require my own, hairy utility functions"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1450559150, "post_id": 34372786, "comment_id": 56492460, "body": "<a href=\"https://github.com/mitchellh/mapstructure\" rel=\"nofollow noreferrer\">github.com/mitchellh/mapstructure</a> ?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1450559212, "post_id": 34372786, "comment_id": 56492472, "body": "@elithrar: That looks promising. Thanks!"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1450606540, "post_id": 34372786, "comment_id": 56501342, "body": "@CodingPickle: That&#39;s similar, but seems to ignore tags, which I would consider a vital part of my question."}], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "closed_date": 1493626971, "answer_count": 0, "score": 2, "last_activity_date": 1450606649, "creation_date": 1450541983, "last_edit_date": 1450606649, "question_id": 34372786, "link": "https://stackoverflow.com/questions/34372786/is-there-a-convenient-way-to-convert-a-json-like-mapstringinterface-to-struc", "closed_reason": "Duplicate", "title": "Is there a convenient way to convert a JSON-like map[string]interface{} to struct , and vice versa, with tags in Go?", "body": "<p>Suppose I have a Go struct, complete with JSON tags:</p>\n\n<pre><code>type Person struct {\n    Name    string   `json:\"name\"`\n    Age     int      `json:\"age,omitifempty\"`\n    Flags   []string `json:\"-\"`\n}\n\np := Person{ Name: \"Bob\", Age: 36, Flags: []string{\"employed\",\"father\"} }\n</code></pre>\n\n<p>Now I want to convert this to a generic <code>map[string]interface{}</code>, such as I might receive from a REST API via JSON:</p>\n\n<pre><code>p2 := map[string]interface{}{\n    \"name\": \"Bob\",\n    \"age\": 36,\n}\n</code></pre>\n\n<p>I have devised the following function to accomplish this using the <a href=\"https://golang.org/pkg/encoding/json\" rel=\"nofollow\">json</a> package. But the intermediate step of a JSON string seems unnecessary and wasteful.</p>\n\n<pre><code>func ConvertJSONObject(input, output interface{}) error {\n    encoded, err := json.Marshal(input)\n    if err != nil {\n        return err\n    }\n    return json.Unmarshal(encoded, output)\n}\n</code></pre>\n\n<p>Now I can do this:</p>\n\n<pre><code>var p2 map[string]interface{}\nConvertJSONObject(p, &amp;p2)\n</code></pre>\n\n<p>As an added bonus, the same function works in reverse, to turn a <code>map[string]interface{}</code> into a populated struct:</p>\n\n<pre><code>var p Person\nConvertJSONObject(p2, &amp;p)\n</code></pre>\n\n<p>Is there a simpler solution, which honors tags in the roughly the same way the json package does?</p>\n"}, {"tags": ["go", "system-calls"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1450552639, "post_id": 34372669, "comment_id": 56490686, "body": "I think the specification does this on purpose: specifically to prevent abuses such as making C code write something to a Go value of type <code>bool</code> and then expect the Go code to interpret it &quot;the right way&quot;.  All-in-all, you can know the size of a boolean value at runtime via <a href=\"https://golang.org/pkg/unsafe/#Sizeof\" rel=\"nofollow noreferrer\"><code>unsafe.Sizeof()</code></a>."}], "tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": true, "score": 3, "last_activity_date": 1450541190, "creation_date": 1450541190, "answer_id": 34372669, "question_id": 34372601, "link": "https://stackoverflow.com/questions/34372601/go-syscall-call-windows/34372669#34372669", "title": "Go syscall call windows", "body": "<p><code>BOOL</code> in WinAPI is declared as <code>typedef int BOOL</code>. So it doesn't match Go's <code>bool</code>. Specifications doesn't even mention what's the size it has. It's probably 1 byte but it doesn't say it. You should use <code>int32</code> instead.</p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 1, "accepted_answer_id": 34372669, "answer_count": 1, "score": 1, "last_activity_date": 1450541190, "creation_date": 1450540705, "question_id": 34372601, "link": "https://stackoverflow.com/questions/34372601/go-syscall-call-windows", "title": "Go syscall call windows", "body": "<p>Im currently trying to use user32.dll EnumWindows on Go but seems to not be working</p>\n\n<pre><code>var(\n    user32 = syscall.NewLazyDLL(\"user32.dll\")\n    procEnumWindows = user32.NewProc(\"EnumWindows\")\n)\n\nfunc EnumWindows() int {\n    ret, _, _ := procEnumWindows.Call(\n        syscall.NewCallback(enumWindowsProc),\n        uintptr(0),\n    )\n    return int(ret)\n}\n\nfunc enumWindowsProc(hwnd syscall.Handle, lparam uintptr) bool {\n    return true\n}\n</code></pre>\n\n<p>Calling EnumWindows will give the following error:</p>\n\n<pre><code>panic: compileCallback: output parameter size is wrong\n</code></pre>\n\n<p>Im not sure how should I use the syscall package... I cant seem to find enough documentation on it</p>\n\n<p>On the MSDN doc page it says that the callback should return a BOOL and thats what I am doing?</p>\n"}, {"tags": ["intellij-idea", "go", "kubernetes"], "answers": [{"tags": [], "owner": {"reputation": 924, "user_id": 524089, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/44a8d08d1f8cd6b193486f873e5aa672?s=128&d=identicon&r=PG", "display_name": "imesh", "link": "https://stackoverflow.com/users/524089/imesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1450494093, "creation_date": 1450494093, "answer_id": 34366803, "question_id": 34366779, "link": "https://stackoverflow.com/questions/34366779/developing-and-testing-kubernetes-api-extensions/34366803#34366803", "title": "Developing and testing Kubernetes API extensions", "body": "<p>Install Golang plugin for IDEA:\n<a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/wiki/Documentation\" rel=\"nofollow\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin/wiki/Documentation</a></p>\n"}], "owner": {"reputation": 5266, "user_id": 3289590, "user_type": "registered", "accept_rate": 19, "profile_image": "https://i.stack.imgur.com/6DozU.jpg?s=128&g=1", "display_name": "Dimuthu", "link": "https://stackoverflow.com/users/3289590/dimuthu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450494093, "creation_date": 1450493887, "question_id": 34366779, "link": "https://stackoverflow.com/questions/34366779/developing-and-testing-kubernetes-api-extensions", "title": "Developing and testing Kubernetes API extensions", "body": "<p>I want to run/build Kubernetes from source. I normally use Intelij idea to open sources but I can't see that there is a source support for 'Go' in my ide. My main concern is to write an extension for Kubernetes API. How can I easily setup source in idea to develop and test that extension? I also have a locally installed Kubernetes API.</p>\n"}, {"tags": ["go", "path"], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1450491398, "post_id": 34366532, "comment_id": 56475532, "body": "Awesome thank you.  I&#39;m still learning the core library.  I&#39;ve been working with python."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1450523090, "post_id": 34366532, "comment_id": 56481679, "body": "@msanti, not that this will break in some future Windows version when it will decide to rename &quot;Desktop&quot; to something else.  The real way to go it to use the &quot;special folders&quot; facility of the Windows shell integration API to get the location of the desktop folder on the Windows your program is running on. Unfortunately this requires certain skills in C, Windows API and calling it from Go (the latter is easy). I&#39;d ask a question on the <a href=\"https://groups.google.com/group/golang-nuts\" rel=\"nofollow noreferrer\">go-nuts mailing list</a>."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1450530220, "post_id": 34366532, "comment_id": 56483693, "body": "Oh it&#39;s fine. I&#39;m a Linux, Unix user and that&#39;s where this script will remain lol"}], "tags": [], "owner": {"reputation": 5356, "user_id": 1885921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02ba513b62ef9f2f7798b9bac1ccf822?s=128&d=identicon&r=PG", "display_name": "vodolaz095", "link": "https://stackoverflow.com/users/1885921/vodolaz095"}, "is_accepted": true, "score": 7, "last_activity_date": 1575998223, "last_edit_date": 1575998223, "creation_date": 1450490875, "answer_id": 34366532, "question_id": 34366477, "link": "https://stackoverflow.com/questions/34366477/golang-save-file-to-desktop/34366532#34366532", "title": "golang save file to desktop", "body": "<p>You can find current user profile using this function - <a href=\"https://godoc.org/os/user#Current\" rel=\"nofollow noreferrer\">https://godoc.org/os/user#Current</a></p>\n\n<p>So, depending on your OS, desktop will be in corresponding folder in home directory.</p>\n\n<p>something like this</p>\n\n<pre><code>   myself, error := user.Current()\n   if error != nil {\n     panic(error)\n   }\n   homedir := myself.HomeDir\n   desktop := homedir+\"/Desktop/\" + d.dir\n</code></pre>\n\n<p>also it is worth notice, that there is a <a href=\"https://github.com/mitchellh/go-homedir\" rel=\"nofollow noreferrer\">github.com/mitchellh/go-homedir</a>\nlibrary that <code>is a Go library for detecting the user's home directory without the use of cgo, so the library can be used in cross-compilation environments.</code>\nSo using it can be better to make your program more portable.</p>\n"}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4412, "favorite_count": 0, "accepted_answer_id": 34366532, "answer_count": 1, "score": 2, "last_activity_date": 1575998223, "creation_date": 1450490441, "question_id": 34366477, "link": "https://stackoverflow.com/questions/34366477/golang-save-file-to-desktop", "title": "golang save file to desktop", "body": "<p>I'm trying to saving files to my desktop, however whenever I run my script it saves the file in whatever directory the go script is located in. </p>\n\n<p>This is the chunk of code i'm working with </p>\n\n<pre><code>func (d *downloader) downloadToFile(key string) {\n    // Create the directories in the path\n    // desktop path\n    desktop := \"Desktop/\" + d.dir\n    file := filepath.Join(desktop, key)\n    if err := os.MkdirAll(filepath.Dir(file), 0775); err != nil {\n        panic(err)\n    }\n\n    // Setup the local file\n    fd, err := os.Create(file)\n    if err != nil {\n        panic(err)\n    }\n    defer fd.Close()\n\n    // Download the file using the AWS SDK\n    fmt.Printf(\"Downloading s3://%s/%s to %s...\\n\", d.bucket, key, file)\n    params := &amp;s3.GetObjectInput{Bucket: &amp;d.bucket, Key: &amp;key}\n    d.Download(fd, params)\n    _, e := d.Download(fd, params)\n    if e != nil {\n        panic(e)\n    }\n}\n</code></pre>\n\n<p>I've tried the path </p>\n\n<pre><code>desktop := \"Desktop/\" + d.dir\ndesktop := \"/Desktop/\" + d.dir\ndesktop := \"Desktop/\" + d.dir\ndesktop := \"~/Desktop/ + d.dir\n</code></pre>\n\n<p>I can't seem to get the files to save to the desktop, for instance when i tried</p>\n\n<pre><code>desktop := \"~/Desktop/ + d.dir\n</code></pre>\n\n<p>A directory <code>~</code> was created, inside of <code>~</code> Desktop was created, inside of Desktop the d.dir was created, and in there all the files.  Again I want to run the script an no matter where I run it I want to d.dir folder with it's contents so be created on the desktop.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 901, "user_id": 1390561, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/54a92ddcdeb300851985eab386609da7?s=128&d=identicon&r=PG", "display_name": "Jacob Kranz", "link": "https://stackoverflow.com/users/1390561/jacob-kranz"}, "edited": false, "score": 0, "creation_date": 1450489196, "post_id": 34366359, "comment_id": 56475180, "body": "But the file only goes to one goroutine, right?"}, {"owner": {"reputation": 24651, "user_id": 628273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/999ac8e29041aeeda8e0e35b416efa04?s=128&d=identicon&r=PG", "display_name": "Teoman Soygul", "link": "https://stackoverflow.com/users/628273/teoman-soygul"}, "reply_to_user": {"reputation": 901, "user_id": 1390561, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/54a92ddcdeb300851985eab386609da7?s=128&d=identicon&r=PG", "display_name": "Jacob Kranz", "link": "https://stackoverflow.com/users/1390561/jacob-kranz"}, "edited": false, "score": 0, "creation_date": 1450490720, "post_id": 34366359, "comment_id": 56475415, "body": "Yes. Channels don&#39;t broadcast messages, only goes to one listener."}], "tags": [], "owner": {"reputation": 24651, "user_id": 628273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/999ac8e29041aeeda8e0e35b416efa04?s=128&d=identicon&r=PG", "display_name": "Teoman Soygul", "link": "https://stackoverflow.com/users/628273/teoman-soygul"}, "is_accepted": false, "score": 0, "last_activity_date": 1450489007, "creation_date": 1450489007, "answer_id": 34366359, "question_id": 34366194, "link": "https://stackoverflow.com/questions/34366194/how-do-channels-distribute-evenly-to-multiple-goroutines/34366359#34366359", "title": "How do channels distribute evenly to multiple goroutines", "body": "<p>When there are multiple receivers for a single channel as in your example, input will be received in a random order.</p>\n"}], "owner": {"reputation": 901, "user_id": 1390561, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/54a92ddcdeb300851985eab386609da7?s=128&d=identicon&r=PG", "display_name": "Jacob Kranz", "link": "https://stackoverflow.com/users/1390561/jacob-kranz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "closed_date": 1450489242, "answer_count": 1, "score": 0, "last_activity_date": 1450489007, "creation_date": 1450487277, "question_id": 34366194, "link": "https://stackoverflow.com/questions/34366194/how-do-channels-distribute-evenly-to-multiple-goroutines", "closed_reason": "Duplicate", "title": "How do channels distribute evenly to multiple goroutines", "body": "<p>I have this code to upload a maximum of 30 files at any given time (there could be thousands of files needing to be uploaded).  Everything works exactly like I want it to: the goroutines take a file from the tasks, uploads it, and onto the next.</p>\n\n<p>My question is: why don't the goroutines upload the same files?  I've tested this and it seems like a file is never uploaded twice.  Are the channels doing a round robin?</p>\n\n<pre><code>tasks := make(chan string, 10000)\nvar wg sync.WaitGroup\n\n// create a limited number of routines\nroutineLimit := 30\nfor i := 0; i &lt; routineLimit; i++ {\n    wg.Add(1)\n    go func() {\n        // check to see if there is a new task\n        for file := range tasks {\n            Upload(file) // upload the file\n        }\n        wg.Done()\n    }()\n}\n\n// get the files\nfiles := GetFilePaths()\nfor _, file := range(files) {\n        // add the file to the queue of tasks\n    tasks &lt;- file\n}\n\nwg.Wait()\n</code></pre>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1450474503, "post_id": 34364225, "comment_id": 56471041, "body": "Yes, that&#39;s possible. Since a serialized protobuf message is just a list of key-value pairs, you can just append a serialized field to the byte slice."}, {"owner": {"reputation": 1126, "user_id": 1481644, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/D8KJh.png?s=128&g=1", "display_name": "Anchor", "link": "https://stackoverflow.com/users/1481644/anchor"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1450475145, "post_id": 34364225, "comment_id": 56471283, "body": "Ah Occam&#39;s Razor strikes again! Thanks, and feel free to post as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1450475506, "last_edit_date": 1592644375, "creation_date": 1450475506, "answer_id": 34364499, "question_id": 34364225, "link": "https://stackoverflow.com/questions/34364225/altering-serialized-protobuf-message-on-the-fly/34364499#34364499", "title": "Altering serialized protobuf message on the fly?", "body": "<p>From the <a href=\"https://developers.google.com/protocol-buffers/docs/encoding#structure\" rel=\"nofollow noreferrer\">documentation on protocol buffers</a>:</p>\n<blockquote>\n<p>As you know, a protocol buffer message is a series of key-value pairs. The binary version of a message just uses the field's number as the key \u2013 the name and declared type for each field can only be determined on the decoding end by referencing the message type's definition (i.e. the .proto file).</p>\n<p>When a message is encoded, the keys and values are concatenated into a byte stream. When the message is being decoded, the parser needs to be able to skip fields that it doesn't recognize. This way, new fields can be added to a message without breaking old programs that do not know about them. To this end, the &quot;key&quot; for each pair in a wire-format message is actually two values \u2013 the field number from your .proto file, plus a wire type that provides just enough information to find the length of the following value.</p>\n</blockquote>\n<p>Therefore, to append a field to an encoded protocol buffer message, you can simply append an encoded field to the end of the byte stream/slice.</p>\n"}], "owner": {"reputation": 1126, "user_id": 1481644, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/D8KJh.png?s=128&g=1", "display_name": "Anchor", "link": "https://stackoverflow.com/users/1481644/anchor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 34364499, "answer_count": 1, "score": 1, "last_activity_date": 1450475506, "creation_date": 1450474233, "question_id": 34364225, "link": "https://stackoverflow.com/questions/34364225/altering-serialized-protobuf-message-on-the-fly", "title": "Altering serialized protobuf message on the fly?", "body": "<p>Is it possible to alter (append, merge, etc) a serialized <code>protobuf</code> message without having to unmarshal it first? I'm using the <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow\">golang/protobuf package</a>.</p>\n\n<p>Ideally I would like to have a service that can receive incoming serialized messages, append some fields on-the-fly, then pass the message along to the next service -kind of like middleware, where additional information can just be added to the payload without having to constantly unmarshal and marshal.</p>\n\n<p>Some context: the system is realtime, so I'd like to minimize overhead wherever possible.</p>\n"}, {"tags": ["struct", "go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1450544770, "post_id": 34362649, "comment_id": 56488214, "body": "They&#39;re not setting the variable to a struct, they&#39;re setting it to a slice of structs."}], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 2809099, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd0dbb2c532c987eb900d1134a7ff82?s=128&d=identicon&r=PG&f=1", "display_name": "thegreenfrog", "link": "https://stackoverflow.com/users/2809099/thegreenfrog"}, "edited": false, "score": 0, "creation_date": 1450481318, "post_id": 34362686, "comment_id": 56473415, "body": "How is the code able to access the strings in the struct via c.in and c.out?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 215, "user_id": 2809099, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd0dbb2c532c987eb900d1134a7ff82?s=128&d=identicon&r=PG&f=1", "display_name": "thegreenfrog", "link": "https://stackoverflow.com/users/2809099/thegreenfrog"}, "edited": false, "score": 1, "creation_date": 1450483607, "post_id": 34362686, "comment_id": 56474064, "body": "@thegreenfrog the loop is iterating the slice of structs, there are 3 of them. Each of these lines <code>{&quot;Hello, world&quot;, &quot;dlrow ,olleH&quot;}</code> is instantiating one. <code>for _, c := range cases</code> is more or less a foreach loop I would read it as &quot;for each case <code>c</code> in <code>cases</code>&quot;. <code>.</code> is commonly called the access operator (not sure if Go has a specific name different than that), you use it to access properties on a struct. If I have some struct <code>A</code> with some fields <code>One</code>, <code>Two</code>, and <code>Three</code>, I access those fields from an instance of type <code>A</code> call it <code>a</code> like <code>a.One</code>, <code>a.Two</code>, <code>a.Three</code>."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 215, "user_id": 2809099, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd0dbb2c532c987eb900d1134a7ff82?s=128&d=identicon&r=PG&f=1", "display_name": "thegreenfrog", "link": "https://stackoverflow.com/users/2809099/thegreenfrog"}, "edited": false, "score": 0, "creation_date": 1450483765, "post_id": 34362686, "comment_id": 56474112, "body": "I can expand on that in the answer if you need further clarification. If use of the access operator is not familiar to you I would recommend doing some general reading on object oriented programming because it is used in nearly every language."}, {"owner": {"reputation": 215, "user_id": 2809099, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd0dbb2c532c987eb900d1134a7ff82?s=128&d=identicon&r=PG&f=1", "display_name": "thegreenfrog", "link": "https://stackoverflow.com/users/2809099/thegreenfrog"}, "edited": false, "score": 0, "creation_date": 1450488728, "post_id": 34362686, "comment_id": 56475113, "body": "Ok so <code>in</code> and <code>want</code> are essentially variables for us to access the two elements in each slice?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 215, "user_id": 2809099, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd0dbb2c532c987eb900d1134a7ff82?s=128&d=identicon&r=PG&f=1", "display_name": "thegreenfrog", "link": "https://stackoverflow.com/users/2809099/thegreenfrog"}, "edited": false, "score": 0, "creation_date": 1450491095, "post_id": 34362686, "comment_id": 56475480, "body": "@thegreenfrog I&#39;ll update on that in the answer. The declaration in this example combines several different concepts so it will be more clear if I break out the code."}, {"owner": {"reputation": 215, "user_id": 2809099, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd0dbb2c532c987eb900d1134a7ff82?s=128&d=identicon&r=PG&f=1", "display_name": "thegreenfrog", "link": "https://stackoverflow.com/users/2809099/thegreenfrog"}, "edited": false, "score": 0, "creation_date": 1450503348, "post_id": 34362686, "comment_id": 56477336, "body": "Wow thanks for the followup. That was a really thorough and in-depth explanation!"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 8, "last_activity_date": 1586676483, "last_edit_date": 1586676483, "creation_date": 1450467190, "answer_id": 34362686, "question_id": 34362649, "link": "https://stackoverflow.com/questions/34362649/structs-in-golang/34362686#34362686", "title": "Structs in GoLang", "body": "<p>Below is the code with some comments to help clarify each statements role in this.</p>\n\n<pre><code>import \"testing\"\n\nfunc TestReverse(t *testing.T) {\n    cases := []struct { // declaration of anonymous type\n        in, want string // fields on that type called in and want, both strings\n    }{\n        {\"Hello, world\", \"dlrow ,olleH\"},\n        {\"Hello, \u4e16\u754c\", \"\u754c\u4e16 ,olleH\"},\n        {\"\", \"\"},\n    } // composite literal initilization\n    // note the use of := in assigning to cases, that op combines declaration and assignment into one statement\n    for _, c := range cases { // range over cases, ignoring the index - the underscore means to discard that return value\n        got := Reverse(c.in) // c is the current instance, access in with the familiar dot notation\n        if got != c.want { // again, access operator on c, the current instance\n            t.Errorf(\"Reverse(%q) == %q, want %q\", c.in, got, c.want) // more access\n        }\n    }\n}\n</code></pre>\n\n<p>Let me know if that helps. I can try giving more of a summary in spoken language or add more details if some of the statements don't make sense still. Also, fyi if you're not familiar range 'ranges' over a collection, returning <code>k, v</code> where <code>k</code> is the index or key and <code>v</code> the value.</p>\n\n<p>EDIT: details on the declaration/initilization of <code>cases</code></p>\n\n<pre><code>    cases := []struct {\n        in, want string\n    }\n</code></pre>\n\n<p>This bit inside the first pair of curly braces is the definition of a struct. This is an anonymous type, a normal declaration would look like this;</p>\n\n<pre><code>    type case struct {\n        in string\n        want string\n    }\n</code></pre>\n\n<p>If you had something like this then there would be a type called <code>case</code> in the scope of this package (not exported, if you wanted to make it 'public' so it would need to be <code>type Case</code> instead). Instead the examples struct is anonymous. It works the same as normal type, however as a developer, you will have no way to reference that type so you can only practically work with the collection initialized here. Internally this type is the same as any other struct with 2 unexported strings for fields. The fields are named <code>in</code> and <code>want</code>. Notice that in the assignment here <code>cases := []struct</code> you have <code>[]</code> before <code>struct</code> this means you're declaring a slice of this anonymous type.</p>\n\n<p>This next little bit, is called static initialization. This is a syntax for initializing collections as types. Each of these nested bits like <code>{\"\", \"\"}</code> is the declaration and initilization of one of these anonymous structs, denoted again by the curly braces. In this case you're assigning two empty strings to <code>in</code> and <code>want</code> respectively (if you don't use names, the order is the same as in the definition). The outer pair of braces is for the slice. If your slice were of say int's or string's, then you would just have the values right there without the extra level of nesting like <code>myInts := []int{5,6,7}</code>.</p>\n\n<pre><code>    {\n        {\"Hello, world\", \"dlrow ,olleH\"},\n        {\"Hello, \u4e16\u754c\", \"\u754c\u4e16 ,olleH\"},\n        {\"\", \"\"},\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 6001349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PTE_eA98cOE/AAAAAAAAAAI/AAAAAAAAACI/GhBOo8gJQbU/photo.jpg?sz=128", "display_name": "harold ramos", "link": "https://stackoverflow.com/users/6001349/harold-ramos"}, "is_accepted": false, "score": 1, "last_activity_date": 1457373482, "last_edit_date": 1457373482, "creation_date": 1457372441, "answer_id": 35850330, "question_id": 34362649, "link": "https://stackoverflow.com/questions/34362649/structs-in-golang/35850330#35850330", "title": "Structs in GoLang", "body": "<p>Go root of  what is a struct.</p>\n\n<p>you declare your variables in it so then \nyou can use it from a function.\nExample:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n)\n\nfunc main() {\n    Get()\n\n}\n\nfunc Get(){\n    out := new(Var)\n\n    out.name = \"james\"\n\n    fmt.Println(out.name)\n}\ntype Var struct {\n    name string\n}\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 2809099, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1fd0dbb2c532c987eb900d1134a7ff82?s=128&d=identicon&r=PG&f=1", "display_name": "thegreenfrog", "link": "https://stackoverflow.com/users/2809099/thegreenfrog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3738, "favorite_count": 0, "accepted_answer_id": 34362686, "answer_count": 2, "score": 6, "last_activity_date": 1586676483, "creation_date": 1450466982, "last_edit_date": 1450543685, "question_id": 34362649, "link": "https://stackoverflow.com/questions/34362649/structs-in-golang", "title": "Structs in GoLang", "body": "<p>I am just starting with GoLang, and I am looking at one of their tutorials (<a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">https://golang.org/doc/code.html</a>). </p>\n\n<p>In one of their examples, they set a variable to a struct, but I am so confused as to how they are accessing elements of the struct in the for loop below? Any chance someone can clarify? Thanks alot!</p>\n\n<p>Code:</p>\n\n<pre><code>package stringutil\n\nimport \"testing\"\n\nfunc TestReverse(t *testing.T) {\n    cases := []struct {\n        in, want string\n    }{\n        {\"Hello, world\", \"dlrow ,olleH\"},\n        {\"Hello, \u4e16\u754c\", \"\u754c\u4e16 ,olleH\"},\n        {\"\", \"\"},\n    }\n    for _, c := range cases {\n        got := Reverse(c.in)\n        if got != c.want {\n            t.Errorf(\"Reverse(%q) == %q, want %q\", c.in, got, c.want)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "download"], "comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450473945, "post_id": 34361891, "comment_id": 56470813, "body": "700-800GB/min equals to 100Mb/s. Pretty common <i>bandwidth limit</i>. Can your machine handle more?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450474103, "post_id": 34361891, "comment_id": 56470877, "body": "Yeah it can handle more, still the Concurrency should be doing something.  What&#39;s the point of setting a Concurrency is 1 core performs just as well as 4. For that matter I&#39;d wrap it in python for the same speed. Ultimately I could run this script on an aws instance with a huge number of cores. Also, I said it was pulling .80gb/min, so less than 1gb per minute.  I would love to have 700gbs/min lol"}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450475580, "post_id": 34361891, "comment_id": 56471485, "body": "Sure, a typo on my side, GB should read MB. A little bit more of context might be helpful with solving this \u2013 for example number of log files you&#39;re trying to fetch, average size and ec2 machine type. AFAIR my t2.small could handle around this kind of traffic from S3, with very high concurrency, but for relatively small files (~70kB). I don&#39;t think number of cores actually matters as this would be an IO bound process. Although concurrency in terms of number of connections could \u2013 mainly when dealing with small files."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1450476302, "post_id": 34361891, "comment_id": 56471774, "body": "Many log files over many buckets, whose file size is variable on traffic. A days worth of data is well over 5gb on a per bucket level. I need these files to do stats on the impressions. There was this one script on github I came across that claimed to have a download speed of 1gb per second.  I don&#39;t need that much speed, but I do need a bump to do things with this data. Now was far as I know I should be able to download each file concurrently. I&#39;m not seeing a speed increase no matter how many cores I devote. Given what the other scripts bench marks are I know there is run for improvement."}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450472690, "creation_date": 1450463549, "last_edit_date": 1450472690, "question_id": 34361891, "link": "https://stackoverflow.com/questions/34361891/increasing-aws-log-download-speed", "title": "Increasing aws log download speed", "body": "<p>I'm going to start with showing the code and then what I'm trying to do, code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/s3\"\n    \"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n)\n\nvar (\n    // empty strings for security reasons\n    Bucket         = \"\"                                               // Download from this bucket\n    Prefix         = \"\" // Using this key prefix\n    LocalDirectory = \"s3logs\"                                                    // Into this directory\n)\n\nfunc main() {\n    sess := session.New()\n    client := s3.New(sess, &amp;aws.Config{Region: aws.String(\"us-west-1\")})\n    params := &amp;s3.ListObjectsInput{Bucket: &amp;Bucket, Prefix: &amp;Prefix}\n\n    manager := s3manager.NewDownloaderWithClient(client, func(d *s3manager.Downloader) {\n        d.PartSize = 64 * 1024 * 1024 // 64MB per part\n        d.Concurrency = 8\n    }) // works\n\n    //manager := s3manager.NewDownloaderWithClient(client) //works\n\n    d := downloader{bucket: Bucket, dir: LocalDirectory, Downloader: manager}\n\n    client.ListObjectsPages(params, d.eachPage)\n\n}\n\ntype downloader struct {\n    *s3manager.Downloader\n    bucket, dir string\n}\n\nfunc (d *downloader) eachPage(page *s3.ListObjectsOutput, more bool) bool {\n    for _, obj := range page.Contents {\n        d.downloadToFile(*obj.Key)\n    }\n\n    return true\n}\n\nfunc (d *downloader) downloadToFile(key string) {\n    // Create the directories in the path\n    file := filepath.Join(d.dir, key)\n\n    if err := os.MkdirAll(filepath.Dir(file), 0775); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"Downloading \" + key)\n    // Setup the local file\n    fd, err := os.Create(file)\n    if err != nil {\n        panic(err)\n    }\n\n    defer fd.Close()\n\n    // Download the file using the AWS SDK\n    fmt.Printf(\"Downloading s3://%s/%s to %s...\\n\", d.bucket, key, file)\n    params := &amp;s3.GetObjectInput{Bucket: &amp;d.bucket, Key: &amp;key}\n    _, e := d.Download(fd, params)\n    if e != nil {\n        panic(e)\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>I'm trying to download the log files from a particular bucket and eventually many buckets.  I need the download to be as fast as possible because.  There is lots of data. My question is what is the most effective way to download huge amounts of data quickly?  The whole process is nil if those logs can't be downloaded at a reasonable speed.  Is there a faster way, it's already concurrent according to amazons doc?  Any ideas?  Also, i've noticed a curious thing.  It doesn't matter if I set the Concurrency to 1, 4, or 20.  Everything is still downloading at ~.70 - ~/.80 gb / min</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1450466210, "post_id": 34362199, "comment_id": 56467118, "body": "Very interesting solution. Would probably be a bit hard with deeply nested structs, but should work on with simple ones."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1450466354, "post_id": 34362199, "comment_id": 56467186, "body": "@captncraig yeah it&#39;s less than ideal. If you wanna get really serious I think you could implement a general solution by flattening the <code>allFields</code> map and using a recursive algorithm to get all fields off nested structures in the concrete type. FYI for getting field names might find this useful; <a href=\"http://stackoverflow.com/questions/24337145/get-name-of-struct-field-using-reflection\" title=\"get name of struct field using reflection\">stackoverflow.com/questions/24337145/&hellip;</a>"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1450466438, "post_id": 34362199, "comment_id": 56467224, "body": "I really like how this toml lib handles it: <a href=\"https://godoc.org/github.com/BurntSushi/toml#MetaData.Undecoded\" rel=\"nofollow noreferrer\">godoc.org/github.com/BurntSushi/toml#MetaData.Undecoded</a> but that kind of thing would require changes to the core json package :("}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1450466784, "post_id": 34362199, "comment_id": 56467403, "body": "@captncraig I don&#39;t know how feasible this is, just an idea that came to mind based on the package you linked to; implement <code>UnmarshalJSON</code> for <code>interface{}</code>, chain a call to the normal version of it, but not before reflecting the type and checking for all fields within the incoming string. If you access the json tag, you can guarantee a match pretty well by doing <code>tag = &quot; + tag + &quot;:</code> (ofc with proper quoting there, not sure how to do it in comment). Input strings can&#39;t really cause collision because they would need escapes so the <code>string.Contains</code> would be fairly reliable I think."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1450464875, "creation_date": 1450464875, "answer_id": 34362199, "question_id": 34361860, "link": "https://stackoverflow.com/questions/34361860/can-i-access-extra-fields-when-unmarshalling-json-in-go/34362199#34362199", "title": "Can I access &quot;extra&quot; fields when unmarshalling json in Go?", "body": "<p>As you're probably aware you can unmarshal any valid json into a <code>map[string]interface{}</code>. Having unmarsahled into an instance of <code>Foo</code> already there is no meta data available where you could check fields that were excluded or anything like that. You could however, unmarshal into both types and then check the map for keys that don't correspond to fields on <code>Foo</code>.</p>\n\n<pre><code>in := []byte(`{\"bar\":\"aaa\", \"baz\":123}`)\n\nfoo := &amp;Foo{}\njson.Unmarshal(in,foo)\n\nallFields := &amp;map[string]interface{}\njson.Unmarshal(in, allFields)\nfor k, _ := range allFields {\n    fmt.Println(k)\n    // could also use reflect to get field names as string from Foo\n    // the get the symmetric difference by nesting another loop here\n    // and appending any key that is in allFields but not on Foo to a slice\n}\n</code></pre>\n"}], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1450464875, "creation_date": 1450463427, "question_id": 34361860, "link": "https://stackoverflow.com/questions/34361860/can-i-access-extra-fields-when-unmarshalling-json-in-go", "title": "Can I access &quot;extra&quot; fields when unmarshalling json in Go?", "body": "<p>Lets say I have this type:</p>\n\n<pre><code>type Foo struct{\n   Bar string `json:\"bar\"`\n}\n</code></pre>\n\n<p>and I want to unmarshal this json into it:</p>\n\n<pre><code>in := []byte(`{\"bar\":\"aaa\", \"baz\":123}`)\n\nfoo := &amp;Foo{}\njson.Unmarshal(in,foo)\n</code></pre>\n\n<p>will succeed just fine. I would like to at least know that there were fields that were skipped in the processing. Is there any good way to access that information?</p>\n\n<p><a href=\"https://play.golang.org/p/r6RxgRIWoU\" rel=\"nofollow\">playground snippet</a></p>\n"}, {"tags": ["go", "libgit2"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450447899, "post_id": 34353216, "comment_id": 56456476, "body": "There&#39;s some scripts in the git2go repo to make a static build. Have you tried those?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1450449931, "post_id": 34353216, "comment_id": 56457765, "body": "When I need C code statically compiled with my go code (e.g. Sqlite) I usually just do <code>go install -tags netgo -ldflags &#39;-extldflags &quot;-static&quot;&#39;</code>."}, {"owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "edited": false, "score": 0, "creation_date": 1450455017, "post_id": 34353216, "comment_id": 56460980, "body": "The Makefile is using those scripts and they do generate a static object <code>libgit2.a</code> file, but after building my program, I get <code>error while loading shared libraries: libhttp_parser.so.2.1: cannot open shared object file: No such file or directory</code>. Here is one of the flags that appear when running the build <code>-L&#47;usr&#47;local&#47;lib -lgit2 -lhttp_parser -lssh2 -lgcrypt -lrt -lssl -lcrypto -ldl -lz</code>"}, {"owner": {"reputation": 5037, "user_id": 1370215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023e1295851b018af03706f391b76931?s=128&d=identicon&r=PG", "display_name": "Carlos Mart&#237;n Nieto", "link": "https://stackoverflow.com/users/1370215/carlos-mart%c3%adn-nieto"}, "edited": false, "score": 0, "creation_date": 1450458567, "post_id": 34353216, "comment_id": 56463087, "body": "That&#39;s a way to build libgit2 into git2go statically, the external libs are still loading dynamically by the result"}], "answers": [{"comments": [{"owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "edited": false, "score": 0, "creation_date": 1450612505, "post_id": 34361020, "comment_id": 56502798, "body": "Thanks Carlos. Your suggestion worked like a charm. I forked the git2go repo and added a new <code>make</code> rule for achieving this. Please see the link below. Do you think it&#39;s worth making a pull request for?  <a href=\"https://github.com/sithembiso/git2go/blob/next/Makefile#L16\" rel=\"nofollow noreferrer\">github.com/sithembiso/git2go/blob/next/Makefile#L16</a>"}, {"owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "edited": false, "score": 0, "creation_date": 1450612895, "post_id": 34361020, "comment_id": 56502900, "body": "I would like to contribute to the third option after my current project. Even though the changes I made have solved my problem for now, they have increased the size of my binary file from <code>19MB</code> to <code>23MB</code>. Also, building for different platforms requires great care for now."}, {"owner": {"reputation": 5037, "user_id": 1370215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023e1295851b018af03706f391b76931?s=128&d=identicon&r=PG", "display_name": "Carlos Mart&#237;n Nieto", "link": "https://stackoverflow.com/users/1370215/carlos-mart%c3%adn-nieto"}, "reply_to_user": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "edited": false, "score": 0, "creation_date": 1450881641, "post_id": 34361020, "comment_id": 56616812, "body": "Embedding multiple crypto libraries into git2go is not something I think the upstream project should have in its code, but TLS and SSH are both things you get with Go itself so we should go use that. It also helpfully bypasses the OpenSSL multithreading nonsense."}], "tags": [], "owner": {"reputation": 5037, "user_id": 1370215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023e1295851b018af03706f391b76931?s=128&d=identicon&r=PG", "display_name": "Carlos Mart&#237;n Nieto", "link": "https://stackoverflow.com/users/1370215/carlos-mart%c3%adn-nieto"}, "is_accepted": true, "score": 2, "last_activity_date": 1450460073, "creation_date": 1450460073, "answer_id": 34361020, "question_id": 34353216, "link": "https://stackoverflow.com/questions/34353216/git2go-with-libssl-and-libssh2-in-single-binary/34361020#34361020", "title": "git2go with libssl and libssh2 in single binary", "body": "<p>One way would be to build those dependencies statically as well and use <code>PKG_CONFIG_PATH</code> point to your own copies so everything gets linked statically. That should make CMake choose the static versions.</p>\n\n<p>But if the goal is to avoid depending on the user-installed libraries rather than making everything a single executable, I would recommend shipping the libraries and working with the load path to make sure they get loaded. With <code>gcc</code> you'd pass <code>-Wl,-R</code> to set the search path in the binary itself, so you can set where to search for the shared libraries you're shipping with your app. With <code>go</code> it looks like you can pass <code>-r</code> to the linker (via <code>-ldflags</code> or manually) to do the same thing.</p>\n\n<p>libgit2 is rather extensible, so there is a third option which is to implement the TLS stream and SSH transport in Go and plug those into a version of libgit2 without support for these. This is however a significant amount of work.</p>\n"}], "owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 1, "accepted_answer_id": 34361020, "answer_count": 1, "score": 2, "last_activity_date": 1450460073, "creation_date": 1450433809, "question_id": 34353216, "link": "https://stackoverflow.com/questions/34353216/git2go-with-libssl-and-libssh2-in-single-binary", "title": "git2go with libssl and libssh2 in single binary", "body": "<p>Could anyone offer some suggestions (or resources) on how I could package a GO program that uses git2go, libssl and libssh2 such that it doesn't require the end user to install these libraries separately?</p>\n\n<p>I am only targeting Linux distros (if it matters)</p>\n"}, {"tags": ["mysql", "go", "null", "bigint"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 2, "creation_date": 1450430585, "post_id": 34350074, "comment_id": 56446042, "body": "how about the err of scan? you just ignore it"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450466627, "post_id": 34350074, "comment_id": 56467341, "body": "Yeah I was able to find the issue once I print the error. Caleb&#39;s solution works."}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 4, "last_activity_date": 1450443537, "creation_date": 1450443537, "answer_id": 34356271, "question_id": 34350074, "link": "https://stackoverflow.com/questions/34350074/why-go-sql-driver-fails-to-handle-null-in-mysql-bigint-field/34356271#34356271", "title": "Why go-sql-driver fails to handle NULL in MySQL bigint field?", "body": "<p><code>queueLength</code> should be a <a href=\"https://godoc.org/database/sql#NullInt64\" rel=\"nofollow\"><code>NullInt64</code></a> instead of an <code>int64</code>.</p>\n\n<pre><code>var queueLength sql.NullInt64\n</code></pre>\n\n<p>In Go <code>int</code>s can't be <code>nil</code> so there's no way for <code>Scan</code> to save <code>NULL</code> in <code>queueLength</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2086, "user_id": 1739662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ca4e51bd75777486cb5ae469e9c85d2?s=128&d=identicon&r=PG", "display_name": "liwp_Stephen", "link": "https://stackoverflow.com/users/1739662/liwp-stephen"}, "is_accepted": false, "score": 0, "last_activity_date": 1450705050, "creation_date": 1450705050, "answer_id": 34397030, "question_id": 34350074, "link": "https://stackoverflow.com/questions/34350074/why-go-sql-driver-fails-to-handle-null-in-mysql-bigint-field/34397030#34397030", "title": "Why go-sql-driver fails to handle NULL in MySQL bigint field?", "body": "<p>I use this tool for Null and Zero fields, it includes many data types.</p>\n\n<p>The github url is <a href=\"https://github.com/guregu/null\" rel=\"nofollow\">https://github.com/guregu/null</a></p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1056, "favorite_count": 0, "accepted_answer_id": 34356271, "answer_count": 2, "score": 1, "last_activity_date": 1450705050, "creation_date": 1450422024, "last_edit_date": 1450484463, "question_id": 34350074, "link": "https://stackoverflow.com/questions/34350074/why-go-sql-driver-fails-to-handle-null-in-mysql-bigint-field", "title": "Why go-sql-driver fails to handle NULL in MySQL bigint field?", "body": "<p>I am using <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow\">go-sql-driver</a> to connect to MySQL database. In one of my table I am using a field called queue_length as BIGINT. This field is NULL by default. When I try to query all the fields from the table using go-sql-driver in Golang, the fields after queue_length are not coming in the result set including queue_length.</p>\n\n<p>In my use case,</p>\n\n<p><strong>Table fields</strong>\n[unique_id, qid, title, text, queue_length, user_id, date_created, last_updated]</p>\n\n<p>When I execute the following code I am getting values for fields before queue_length but [queue_length, user_id, date_created, last_updated] fields are not coming in result set.</p>\n\n<p>But if I don't select queue_length, all fields are coming in result set. I am scanning queue_length in queueLength variable in code which is of type int64. The value coming from table is NULL. I tried type conversion also. Didn't work.</p>\n\n<p>Is this a bug in go-sql-driver or am I doing anything wrong? Could anyone help me with this?</p>\n\n<pre><code>func GetQueues(uniqueId string) ([]*objects.Queue, error) {\n    db, err := GetDBConnection()\n    defer db.Close()\n\n    rows, err := db.Query(\"SELECT qid, title, text, queue_length, user_id, date_created, last_updated FROM queue WHERE unique_id = ?\", uniqueId)\n    if err != nil {\n        panic(err.Error())\n    }\n    defer rows.Close()\n\n    var qId             string\n    var title           string\n    var text            string\n    var userId          string\n    var dateCreated     string\n    var lastUpdated     string\n    var queueLength     int64\n    var queue           *objects.Queue\n    var queues          []*objects.Queue\n\n    for rows.Next() {\n        err           = rows.Scan(&amp;qId, &amp;title, &amp;text, &amp;queueLength, &amp;userId, &amp;dateCreated, &amp;lastUpdated)\n        queue         = &amp;objects.Queue{ QId: qId, Title: title, Text: text, UniqueId: uniqueId, UserId: userId, DateCreated: dateCreated, LastUpdated: lastUpdated, QueueLength: queueLength }\n        queues        = append(queues, queue)\n    }\n    err = rows.Err()\n\n    if err != nil {\n        panic(err.Error())\n        return nil, err\n    }\n    return queues, err\n}\n</code></pre>\n"}, {"tags": ["html", "go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1450424482, "post_id": 34348596, "comment_id": 56442864, "body": "I believe this has nothing to do with <code>mux</code>, you should change your handlers to use <code>text&#47;template</code> package instead of <code>html&#47;template</code>."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 0, "last_activity_date": 1450413279, "creation_date": 1450413279, "answer_id": 34348596, "question_id": 34348072, "link": "https://stackoverflow.com/questions/34348072/go-html-comments-are-not-rendered/34348596#34348596", "title": "Go - HTML comments are not rendered", "body": "<p>You can use <code>text/template</code> instead of <code>html/template</code> and do all escaping manually using built-in functions such as <code>html</code> and <code>js</code> (<a href=\"https://golang.org/pkg/text/template/#hdr-Functions\" rel=\"nofollow\">https://golang.org/pkg/text/template/#hdr-Functions</a>). Be aware that this is very error prone though.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1481821290, "last_edit_date": 1481821290, "creation_date": 1450426137, "answer_id": 34351058, "question_id": 34348072, "link": "https://stackoverflow.com/questions/34348072/go-html-comments-are-not-rendered/34351058#34351058", "title": "Go - HTML comments are not rendered", "body": "<p>There is a special type in the <a href=\"https://golang.org/pkg/html/template/\" rel=\"noreferrer\"><code>html/template</code></a> package: <a href=\"https://golang.org/pkg/html/template/#HTML\" rel=\"noreferrer\"><code>template.HTML</code></a>. Values of this type in the template are not escaped when the template is rendered.</p>\n\n<p>So you may \"mark\" your HTML comments as <code>template.HTML</code> and so they will not be escaped or omitted during executing your template.</p>\n\n<p>One way to do this is to register a custom function for your template, a function which can be called from your template which takes a <code>string</code> argument and returns it as <code>template.HTML</code>. You can \"pass\" all the HTML comments to this function, and as a result, your HTML comments will be retained in the output.</p>\n\n<p>See this example:</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Funcs(template.FuncMap{\n        \"safe\": func(s string) template.HTML { return template.HTML(s) },\n    }).Parse(src))\n    t.Execute(os.Stdout, nil)\n}\n\nconst src = `&lt;html&gt;&lt;body&gt;\n{{safe \"&lt;!-- This is a comment --&gt;\"}}\n&lt;div&gt;Some &lt;b&gt;HTML&lt;/b&gt; content&lt;/div&gt;\n&lt;/body&gt;&lt;/html&gt;`\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/CT8EZEwDIO\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;\n&lt;!-- This is a comment --&gt;\n&lt;div&gt;Some &lt;b&gt;HTML&lt;/b&gt; content&lt;/div&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>So basically after registering our <code>safe()</code> function, transform all your HTML comments to a template action calling this <code>safe()</code> function and passing your original HTML comment.</p>\n\n<p>Convert this:</p>\n\n<pre><code>&lt;!-- Some HTML comment --&gt;\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>{{safe \"&lt;!-- Some HTML comment --&gt;\"}}\n</code></pre>\n\n<p>Or alternatively (whichever you like):</p>\n\n<pre><code>{{\"&lt;!-- Some HTML comment --&gt;\" | safe}}\n</code></pre>\n\n<p>And you're good to go.</p>\n\n<p><strong>Note:</strong> If your HTML comment contains quotation marks (<code>'\"'</code>), you can / have to escape it like this:</p>\n\n<pre><code>{{safe \"&lt;!-- Some \\\"HTML\\\" comment --&gt;\"}}\n</code></pre>\n\n<p><strong>Note #2:</strong> Be aware that you shouldn't use conditional HTML comments as that may break the context sensitive escaping of <code>html/template</code> package. For details read <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/8y6by6SERyU\" rel=\"noreferrer\">this</a>.</p>\n"}], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2158, "favorite_count": 0, "accepted_answer_id": 34351058, "answer_count": 2, "score": 7, "last_activity_date": 1543907321, "creation_date": 1450409097, "last_edit_date": 1543907321, "question_id": 34348072, "link": "https://stackoverflow.com/questions/34348072/go-html-comments-are-not-rendered", "title": "Go - HTML comments are not rendered", "body": "<p>I'm building go web application. I found some anomaly on the rendered html page. All of my html comments <code>&lt;!-- --&gt;</code> are suddenly not being rendered. My guess it's because the go version I used (just updated to higher version), because it was fine before I updated it.</p>\n\n<p>This is my code:</p>\n\n<pre><code>&lt;!-- prepare the breadcrumbs --&gt;\n&lt;ul class=\"breadcrumb\" data-bind=\"foreach: viewModel.breadcrumbs\"&gt;\n    &lt;!-- ko if: ($index() + 1) &lt; len(viewModel.breadcrumbs()) --&gt;\n    &lt;li&gt;\n        &lt;a data-bind=\"attr: { href: href }\"&gt;\n            &lt;i class=\"fa fa-home\"&gt;&lt;/i&gt; \n            &lt;span data-bind=\"text: title\"&gt;&lt;/span&gt;\n        &lt;/a&gt;\n    &lt;/li&gt;\n    &lt;!-- /ko --&gt;\n\n    &lt;!-- ko if: ($index() + 1) == len(viewModel.breadcrumbs()) --&gt;\n    &lt;li class=\"active\" data-bind=\"text: title\"&gt;&lt;/li&gt;\n    &lt;!-- /ko --&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>And this is the rendered page source:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cl8PP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cl8PP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Because of this issue, many of my KnockoutJS codes which are written using <em>containerless control flow syntax</em> goes crazy, it doesn't work at all.</p>\n\n<p>What should I do to solve this? Thanks in advance</p>\n"}, {"tags": ["postgresql", "go", "beego"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450411857, "post_id": 34347523, "comment_id": 56438295, "body": "do you have a database (postgresql?) running on your machine?"}, {"owner": {"reputation": 11, "user_id": 5133322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054cb5658400a48e0db541cec9b22fc9?s=128&d=identicon&r=PG&f=1", "display_name": "chocomousse", "link": "https://stackoverflow.com/users/5133322/chocomousse"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450414954, "post_id": 34347523, "comment_id": 56439131, "body": "yes i have, i managed to fix the connection problem, now my error message is  register db Ping &#39;default&#39;, pg: role &quot;apple&quot; does not exist must have one register DataBase alias named &#39;default&#39;"}], "owner": {"reputation": 11, "user_id": 5133322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054cb5658400a48e0db541cec9b22fc9?s=128&d=identicon&r=PG&f=1", "display_name": "chocomousse", "link": "https://stackoverflow.com/users/5133322/chocomousse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450404836, "creation_date": 1450404836, "question_id": 34347523, "link": "https://stackoverflow.com/questions/34347523/error-when-running-bee-run-e-godep", "title": "Error when running &quot;bee run -e=Godep&quot;", "body": "<p>I encountered this error message after running \"bee run -e=Godeps\":</p>\n\n<p>[ORM] registerdb Ping 'default', dial tcp 127.0.0.1:5432: connectex: No connection could be made because the targer machine actively refused it. must have one register Database alias named 'default'</p>\n\n<p>could anyone give me some idea on how to fix it? thanks in advance!</p>\n"}, {"tags": ["eclipse", "go", "goclipse"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1450402799, "post_id": 34347133, "comment_id": 56436179, "body": "What I do is to have a workspace under my <code>workspaces</code> folder and put the  actual projects under <code>$GOPATH&#47;src</code>"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5645343, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aceafcadfded241dc64799a0a326cf83?s=128&d=identicon&r=PG&f=1", "display_name": "batflaps", "link": "https://stackoverflow.com/users/5645343/batflaps"}, "edited": false, "score": 0, "creation_date": 1450460916, "post_id": 34352200, "comment_id": 56464388, "body": "Okay, but when I use Goclipse to start a new go project, it tries to put it in ../workspace/go/newprojectname as the default location, should I specify ../workspace/go/src/newprojectname since if I run <code>go get github.com&#47;whatever</code> it puts it in ../workspace/go/src/github.com/whatever?"}, {"owner": {"reputation": 131, "user_id": 5645343, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aceafcadfded241dc64799a0a326cf83?s=128&d=identicon&r=PG&f=1", "display_name": "batflaps", "link": "https://stackoverflow.com/users/5645343/batflaps"}, "edited": false, "score": 0, "creation_date": 1450468890, "post_id": 34352200, "comment_id": 56468427, "body": "okay, I used ../workspace/go/src/somename/ for the default location under Goclipse, and it seems to work. Thanks."}], "tags": [], "owner": {"reputation": 3561, "user_id": 2381508, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/946bccd20d5d9648c87f4c4b0489d176?s=128&d=identicon&r=PG", "display_name": "Abhishek Nalin", "link": "https://stackoverflow.com/users/2381508/abhishek-nalin"}, "is_accepted": false, "score": 1, "last_activity_date": 1450430507, "creation_date": 1450430507, "answer_id": 34352200, "question_id": 34347133, "link": "https://stackoverflow.com/questions/34347133/goclipse-workspace-for-golang-vs-other-languages/34352200#34352200", "title": "Goclipse workspace for golang vs other languages", "body": "<p>Use workspace/go as your workspace. From <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">code organization guidelines</a> on golang.org</p>\n\n<blockquote>\n  <p>Go code must be kept inside a workspace. A workspace is a directory\n  hierarchy with three directories at its root:</p>\n  \n  <ul>\n  <li>src contains Go source files organized into packages (one package per    directory), </li>\n  <li>pkg contains package objects, and </li>\n  <li>bin contains executable    commands.</li>\n  </ul>\n  \n  <p>The go tool builds source packages and installs the resulting binaries\n  to the pkg and bin directories.</p>\n  \n  <p>The src subdirectory typically contains multiple version control\n  repositories (such as for Git or Mercurial) that track the development\n  of one or more source packages.</p>\n</blockquote>\n"}], "owner": {"reputation": 131, "user_id": 5645343, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aceafcadfded241dc64799a0a326cf83?s=128&d=identicon&r=PG&f=1", "display_name": "batflaps", "link": "https://stackoverflow.com/users/5645343/batflaps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450430507, "creation_date": 1450401703, "question_id": 34347133, "link": "https://stackoverflow.com/questions/34347133/goclipse-workspace-for-golang-vs-other-languages", "title": "Goclipse workspace for golang vs other languages", "body": "<p>I have code in /home/user/Documents/code/workspace/ (Debian Jessie) in subfolders like java/ for java and python/ for python I've written. For golang in Eclipse, should I use the workspace ~/Documents/code/workspace or ../workspace/go or ../workspace/go/src?</p>\n"}, {"tags": ["http", "web", "go", "webserver", "localhost"], "comments": [{"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1450400404, "post_id": 34346832, "comment_id": 56435612, "body": "I tried your code, to be sure, but it works here. Since you are using a relative path, have you made sure, you are running the app from within the <code>Backend</code> directory and not your projects root directory?"}], "answers": [{"comments": [{"owner": {"reputation": 1040, "user_id": 5081185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/yQ8Wl.jpg?s=128&g=1", "display_name": "Mat&#250;\u0161 \u010congr&#225;dy", "link": "https://stackoverflow.com/users/5081185/mat%c3%ba%c5%a1-%c4%8congr%c3%a1dy"}, "edited": false, "score": 0, "creation_date": 1450430344, "post_id": 34347003, "comment_id": 56445916, "body": "Hello, thanks for the answers so far. Im running this script:  &quot;go run C:\\Go\\Projects\\src\\github.com\\congrady\\Bakalarka\\Backend\\mai&zwnj;&#8203;n.go&quot;  and my Gopath is &quot;C:\\Go\\Projects\\&quot;  By the way, I think that my Go code worked once, but suddenly it stopped working. Isn&#39;t there a problem with something else? (dependencies, the way that localhost work, etc.) I think that Go lang don&#39;t even find my html file at all."}, {"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "reply_to_user": {"reputation": 1040, "user_id": 5081185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/yQ8Wl.jpg?s=128&g=1", "display_name": "Mat&#250;\u0161 \u010congr&#225;dy", "link": "https://stackoverflow.com/users/5081185/mat%c3%ba%c5%a1-%c4%8congr%c3%a1dy"}, "edited": false, "score": 0, "creation_date": 1450430928, "post_id": 34347003, "comment_id": 56446258, "body": "This is about the working directory, i.e. the directory you are located in when running the command. As I said in the comment, your code is ok."}], "tags": [], "owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "is_accepted": true, "score": 0, "last_activity_date": 1450429011, "last_edit_date": 1450429011, "creation_date": 1450400708, "answer_id": 34347003, "question_id": 34346832, "link": "https://stackoverflow.com/questions/34346832/go-server-not-serving-files-properly/34347003#34347003", "title": "Go server not serving files properly", "body": "<p>Be aware that if you hardcode relative paths in your source file, the directory which you are in when starting the app matters.</p>\n\n<p>In the current configuration, make sure to start the app from the <code>Backend</code> directory, i.e.</p>\n\n<p><em>C:\\Go\\Projects\\src\\github.com\\congrady\\Bakalarka\\Backend</em>,</p>\n\n<p><strong>NOT</strong> your apps root directory</p>\n\n<p><em>C:\\Go\\Projects\\src\\github.com\\congrady\\Bakalarka</em></p>\n\n<p>or</p>\n\n<p>change the string in the main file to <strong>Frontend/index.html</strong> and run from</p>\n\n<p><em>C:\\Go\\Projects\\src\\github.com\\congrady\\Bakalarka</em></p>\n"}], "owner": {"reputation": 1040, "user_id": 5081185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/yQ8Wl.jpg?s=128&g=1", "display_name": "Mat&#250;\u0161 \u010congr&#225;dy", "link": "https://stackoverflow.com/users/5081185/mat%c3%ba%c5%a1-%c4%8congr%c3%a1dy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 34347003, "answer_count": 1, "score": 0, "last_activity_date": 1450429011, "creation_date": 1450399200, "question_id": 34346832, "link": "https://stackoverflow.com/questions/34346832/go-server-not-serving-files-properly", "title": "Go server not serving files properly", "body": "<p>I am creating a SPA.\nI am trying to respond all requests with index.html\n(I handle routing on the frontend).</p>\n\n<p>My directory structure look like this:</p>\n\n<p>Backend</p>\n\n<p>-- main.go</p>\n\n<p>Frontend</p>\n\n<p>..(some other files)..</p>\n\n<p>-- index.html</p>\n\n<p>Whole project is located in \"C:\\Go\\Projects\\src\\github.com\\congrady\\Bakalarka\"</p>\n\n<p>My main.go file looks like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"../Frontend/index.html\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>When I run my main.go file (using go run), my localhost always responds with \"404 page not found\".\nWhen I try to serve static content using fmt, everything works fine.</p>\n\n<p>Please help, I'm stuck on this for a really long time and I can't get it to work.\nThanks</p>\n"}, {"tags": ["unit-testing", "testing", "go", "tdd"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 2, "creation_date": 1450397831, "post_id": 34346496, "comment_id": 56434892, "body": "Perhaps you could consider removing the coupling between your <code>askQuestion</code> function and <code>StdIn</code>. Maybe pass in an <code>io.Reader</code> instead... that way your test doesn&#39;t have to rely on piping <code>StdIn</code> data and can use a byte buffer instead."}], "answers": [{"tags": [], "owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "is_accepted": false, "score": 2, "last_activity_date": 1450399185, "creation_date": 1450399185, "answer_id": 34346831, "question_id": 34346496, "link": "https://stackoverflow.com/questions/34346496/golang-unit-testing-user-input/34346831#34346831", "title": "Golang unit testing user input", "body": "<p>Go's tests need to live in files which are named <code>xyz_test.go</code>, so the playground is not the right place to familiarize yourself with the unit testing feature.</p>\n\n<p>If you have go installed locally, run the command <code>go help test</code>, to get a very brief introduction.</p>\n"}], "owner": {"reputation": 11, "user_id": 5693101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f665d83535b5d8a05919d4e37cbaebee?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Young", "link": "https://stackoverflow.com/users/5693101/kevin-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1168, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450399185, "creation_date": 1450396815, "question_id": 34346496, "link": "https://stackoverflow.com/questions/34346496/golang-unit-testing-user-input", "title": "Golang unit testing user input", "body": "<p>I am trying to learn go with a TDD mindset. I am stuck getting my head wrapped around testing. </p>\n\n<p>In the example below, I am prompting a user for input, doing a little validation and printing the results. I wrote a test for it (which is passing) however I don't feel like it is hitting the validation portion, so I am doing something wrong. Any advice would be appreciated.</p>\n\n<p><a href=\"https://play.golang.org/p/FDpbof9Y20\" rel=\"nofollow\">https://play.golang.org/p/FDpbof9Y20</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"regexp\"\n    \"strings\"\n)\n\nfunc main() {\n    response := askQuestion(\"What is your name?\")\n    fmt.Printf(\"Hello %s\\n\",response)\n}\n\nfunc askQuestion(question string) string {\n    reader := bufio.NewReader(os.Stdin)\n    answer := \"\"\n\n    for {\n        fmt.Printf(\"%s\\n\", question)\n        input, err := reader.ReadString('\\n')\n        if err != nil {\n            if err != io.EOF {\n                panic(err)\n            }\n            break\n        }\n\n        if regexp.MustCompile(`[A-Z]{5}`).MatchString(strings.TrimSpace(input)) == true {\n            answer = strings.TrimSpace(input)\n            fmt.Printf(\"You entered %s\\n\", answer)\n            break\n        } else {\n            fmt.Printf(\"\\033[31mYou must enter only 5 upper case letters.\\n\\033[0m\")\n            continue\n        }\n    }\n\n    return answer\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/WcI4CRfle5\" rel=\"nofollow\">https://play.golang.org/p/WcI4CRfle5</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"os\"\n    \"reflect\"\n    \"strings\"\n    \"testing\"\n)\n\nfunc TestAskQuestion(t *testing.T) {\n    expected := \"foo\"\n    entered := \"foo\"\n\n    askQuestion(\"What is your last name?\")\n\n    oldStdout := os.Stdout\n    r, w, _ := os.Pipe()\n\n    os.Stdout = w\n    fmt.Println(entered)\n\n    outC := make(chan string)\n    go func() {\n        var buf bytes.Buffer\n        io.Copy(&amp;buf, r)\n        outC &lt;- buf.String()\n\n    }()\n\n    w.Close()\n    os.Stdout = oldStdout\n    out := strings.TrimSpace(&lt;-outC)\n\n    b, _ := ioutil.ReadAll(os.Stdin)\n    t.Log(string(b))\n\n    if !reflect.DeepEqual(expected, out) {\n        t.Fatalf(\"Test Status Failure Issue. Got: '%v' expected %s\", out, expected)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "goclipse"], "answers": [{"tags": [], "owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "is_accepted": false, "score": 0, "last_activity_date": 1452524601, "creation_date": 1452524601, "answer_id": 34724617, "question_id": 34346221, "link": "https://stackoverflow.com/questions/34346221/how-do-i-create-a-new-goclipse-project-so-that-it-follows-the-normal-go-project/34724617#34724617", "title": "How do I create a new GoClipse project so that it follows the normal Go project structure?", "body": "<p>Unfortunately the above is not possible. The closest you can get is creating your Eclipse project in the location <code>/Users/ray/go/src/github/user/project</code> (note that beforehand you will need to set the Eclipse preferences GOPATH to <code>/Users/ray/go</code>). This way you will have:</p>\n\n<ul>\n<li><code>/Users/ray/go/src/github/user/project</code> for the source directory</li>\n<li><code>/Users/ray/go/pkg/darwin_amd64/github/user/project</code> for the package directory</li>\n<li><code>/Users/ray/go/bin</code> for the binary directory</li>\n</ul>\n\n<p>but Eclipse settings/files will be in <code>/Users/ray/go/src/github/user/project</code>. (ATM, the only Eclipse files are <code>.project</code> and <code>.settings/</code>. You can add these to Git ignore if you are concerned about them appearing in version control)</p>\n"}], "owner": {"reputation": 61, "user_id": 1437822, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PAcDk.png?s=128&g=1", "display_name": "rharris", "link": "https://stackoverflow.com/users/1437822/rharris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 441, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459829255, "creation_date": 1450395034, "last_edit_date": 1459829255, "question_id": 34346221, "link": "https://stackoverflow.com/questions/34346221/how-do-i-create-a-new-goclipse-project-so-that-it-follows-the-normal-go-project", "title": "How do I create a new GoClipse project so that it follows the normal Go project structure?", "body": "<p>My Environment:</p>\n\n<ul>\n<li>OS X 10.10.5</li>\n<li>Eclipse Mars.1 (4.5.1)</li>\n<li>GoClipse 0.13.0</li>\n<li>go version go1.5.2 darwin/amd64</li>\n</ul>\n\n<p>My GoClipse Settings:</p>\n\n<ul>\n<li>Eclipse workspace: /Users/ray/go_workspace</li>\n<li>Go Installation\n\n<ul>\n<li>GOROOT: /usr/local/go</li>\n<li>gofmt: /usr/local/go/bin/gofmt</li>\n<li>godoc: /usr/local/go/bin/godoc</li>\n<li>GOOS: </li>\n<li>GOARCH: </li>\n<li>GOPATH: [x] Same as GOPATH env variable (which is /Users/ray/go)</li>\n</ul></li>\n<li>Tools\n\n<ul>\n<li>Go oracle path: /Users/ray/go/bin/oracle</li>\n<li>[x] Start gocode server automatically</li>\n<li>[x] Enable gocode log console</li>\n<li>gocode path: /Users/ray/go/bin/gocode</li>\n</ul></li>\n</ul>\n\n<p>When I create a new Go project using default settings, the project folder is put under the eclipse workspace: /Users/ray/go_workspace/project with the bin, pkg, and src folders as subfolders.</p>\n\n<p>What I want to do is create a new Go project and have it use:</p>\n\n<ul>\n<li>/Users/ray/go/src/github/user/project for the source directory</li>\n<li>/Users/ray/go/pkg/darwin_amd64/github/user/project for the package directory</li>\n<li>/Users/ray/go/bin for the binary directory</li>\n<li>/Users/ray/go_workspace/user/project for any Eclipse/GoClipse settings</li>\n</ul>\n\n<p>How do I configure Eclipse/GoClipse/Project settings to get this to work?</p>\n"}, {"tags": ["linux", "go", "memory-leaks"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450394467, "post_id": 34346064, "comment_id": 56433807, "body": "VirtualMemory, especially on OSX,  is meaningless. RSS is a little better guide to how much memory the process is suing."}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 0, "creation_date": 1450398222, "post_id": 34346064, "comment_id": 56435028, "body": "Tip: <a href=\"https://golang.org/pkg/os/exec/#Cmd.Run\" rel=\"nofollow noreferrer\">Run()</a> executes the process and hangs until it exits."}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 0, "creation_date": 1450398851, "post_id": 34346064, "comment_id": 56435223, "body": "I&#39;d also recommend allocating a <a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">pool of goroutines</a> to limit the number of processes running at the same time."}, {"owner": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "reply_to_user": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 0, "creation_date": 1450409600, "post_id": 34346064, "comment_id": 56437783, "body": "@Zippoxer your points are well received, but Run also hits this same explosion in virtual memory. Run is just shorthand for a .Start() followed by .Wait().  A pool of goroutines is a good architectural choice for many projects, but not really what I&#39;m looking for in this case."}, {"owner": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450409665, "post_id": 34346064, "comment_id": 56437808, "body": "@JimB, this post is about a CentOS problem, not an OSX problem. The problem is real in that the server stops being responsive when the virtual memory usage hits 40gb.  I suppose you are suggesting that the problem might be happening on OSX as well but I&#39;m not detecting it due to VSS being meaningless on OSX."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450410023, "post_id": 34346064, "comment_id": 56437885, "body": "Sorry, misread how centos is the problem here. Are you on a current version of go? Can you run it with gctrace=1 and see what the garbage collector is reporting? And RSS is still going to be a better measure than VSS. Does the system have swap enabled? Does the OOM killer eventually kill the server?"}, {"owner": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450411339, "post_id": 34346064, "comment_id": 56438191, "body": "@JimB Yes, OOM kills the server. The problem happens in git 1.5.1 and 1.5.2, I haven&#39;t tried 1.4.x. RSS stays low, and I&#39;ve ran with go&#39;s http profiler and don&#39;t see anything large on the heap. I will run with gctrace=1 and report back."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450430770, "post_id": 34346064, "comment_id": 56446147, "body": "it not answer your question, but what if not <code>Wait()</code> but just <code>Start()</code> and return?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1450448041, "post_id": 34346064, "comment_id": 56456570, "body": "@Gattster I suggest you update the post with this information. That the virtual memory grows to many gigabytes is in itself not any problem. It&#39;s fine to grab a lot of virtual memory that might remain unused,, even if us humans don&#39;t like seeing such huge numbers in <code>ps</code> or <code>top</code>..  That you eventually hit OOM, at least if the case is where you do wait until all 300 requests complete and the shell scripts terminate before firing of another test of 300 requests IS a problem."}, {"owner": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450491965, "post_id": 34346064, "comment_id": 56475619, "body": "@JiangYD if I do what you said, I don&#39;t hit any crazy fast memory leak. The problem with the approach you mentioned is the sleepscript.sh processes will hang around as zombies unless I call <code>Wait()</code> to clean them up.  I wonder if I should work at a lower level then <code>Cmd.Start()</code>."}, {"owner": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450503823, "post_id": 34346064, "comment_id": 56477428, "body": "@JiangYD also, if you don&#39;t call <code>Wait()</code>, the virtual memory never grows to a huge size."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450527167, "post_id": 34346064, "comment_id": 56482770, "body": "<code>wait</code> is a blocking syscall and requires its own thread -- a new one is spawned if there aren&#39;t any idle.  Every child process needs to have wait called, that&#39;s just part of the POSIX api."}], "answers": [{"comments": [{"owner": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "edited": false, "score": 0, "creation_date": 1450499194, "post_id": 34357485, "comment_id": 56476711, "body": "thank for your answer. It is enlightening, but I think something more buggy is happening here. If I start 300 commands and have them an a wait state, my process is only using a few megs of virt ram. If I start those 300 commands at the exact same time, then we start using 10+gb of VIRT and it grows again only if I do simultaneous starts of commands."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "edited": false, "score": 0, "creation_date": 1450525608, "post_id": 34357485, "comment_id": 56482346, "body": "@Gattster it&#39;s the &quot;exact same time&quot; parts that&#39;s the problem. If the <code>wait</code> is called serially at all, the threads can be reused, but when all the existing threads are in a blocking syscall the runtime needs to spawn a new thread to continue running. Look at the number of threads in your process between your two examples."}, {"owner": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "edited": false, "score": 0, "creation_date": 1450546546, "post_id": 34357485, "comment_id": 56488789, "body": "Thanks @JimB. I am considering avoiding this problem by running my long-running subprocesses with <code>daemonize &#47;tmp&#47;sleepscript.sh</code>, and synchronizing my calls to <code>Cmd.Run()</code>."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "edited": false, "score": 0, "creation_date": 1450661758, "post_id": 34357485, "comment_id": 56516953, "body": "@Gattster <code>run</code> also call <code>wait</code>.  the examle code in answer here <a href=\"http://stackoverflow.com/questions/33948726/can-go-spawn-and-communicate-with-external-processes-without-starting-one-os-thr/33951418?noredirect=1#comment55938173_33951418\" title=\"can go spawn and communicate with external processes without starting one os thr\">stackoverflow.com/questions/33948726/&hellip;</a> may help"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450733516, "post_id": 34357485, "comment_id": 56551132, "body": "@JiangYD: that&#39;s a poor idea for a long running server (which this presumable would be, being an http server), since your example leaves every exec&#39;ed command as a zombie."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "edited": false, "score": 0, "creation_date": 1450752553, "post_id": 34357485, "comment_id": 56557152, "body": "@Gattster why zombies? i not find that. <code>go run src&#47;main.go  Waiting for WaitGroup ... Starting process  0 ... Starting process  1 ... Finishing process  0 ... Finishing process  1 ... WaitGroup finished! jiangyd@jiangyd-OptiPlex-3020:~&#47;tmp&#47;testgo$ ps   PID TTY          TIME CMD  9667 pts&#47;16   00:00:00 ps 29933 pts&#47;16   00:00:00 bash </code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450753562, "post_id": 34357485, "comment_id": 56557373, "body": "@JiangYD, when your process exits, the zombie entries in the process table are inherited by init, which calls <code>wait</code> for you. If the server process doesn&#39;t exit, it will just accumulate these zombies. Also, your version doesn&#39;t necessarily save OS threads, because file IO is also a blocking syscall and requires its own OS thread."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450757282, "post_id": 34357485, "comment_id": 56558225, "body": "@JimB you&#39;re right, thanks for point the problems. I have updated the example."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1450447632, "creation_date": 1450447632, "answer_id": 34357485, "question_id": 34346064, "link": "https://stackoverflow.com/questions/34346064/go-memory-leak-when-doing-concurrent-os-exec-command-wait/34357485#34357485", "title": "Go memory leak when doing concurrent os/exec.Command.Wait()", "body": "<p>Each request you make requires Go to spawn a new OS thread to <code>Wait</code> on the child process. Each thread will consume a 2MB stack, and a much larger chunk of VIRT memory (that's less relevant, since it's virtual, but you may still be hitting a ulimit setting). Threads are reused by the Go runtime, but they are currently never destroyed, since most programs that use a large number of threads will do so again.</p>\n\n<p>If you make 300 simultaneous requests, and wait for them to complete before making any others, memory should stabilize. However if you continue to send more requests before the others have completed, you will exhaust some system resource: either memory, file descriptors, or threads. </p>\n\n<p>The key point is that spawning a child process and calling <code>wait</code> isn't free, and if this were a real-world use case you need to limit the number of times <code>startCmd()</code> can be called concurrently. </p>\n"}], "owner": {"reputation": 4233, "user_id": 199335, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f13795a3e9cd2678006fe6e029ba566b?s=128&d=identicon&r=PG", "display_name": "Gattster", "link": "https://stackoverflow.com/users/199335/gattster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 954, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1450727038, "creation_date": 1450394189, "last_edit_date": 1450727038, "question_id": 34346064, "link": "https://stackoverflow.com/questions/34346064/go-memory-leak-when-doing-concurrent-os-exec-command-wait", "title": "Go memory leak when doing concurrent os/exec.Command.Wait()", "body": "<p>I am running into a situation where a go program is taking up 15gig of virtual memory and continues to grow. The problem only happens on our CentOS server. On my OSX devel machine, I can't reproduce it. </p>\n\n<p>Have I discovered a bug in go, or am I doing something incorrectly?</p>\n\n<p>I have boiled the problem down to a simple demo, which I'll describe now.  First build and run this go server:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"os/exec\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/startapp\", startAppHandler)\n    http.ListenAndServe(\":8081\", nil)\n}\n\nfunc startCmd() {\n    cmd := exec.Command(\"/tmp/sleepscript.sh\")\n    cmd.Start()\n    cmd.Wait()\n}\n\nfunc startAppHandler(w http.ResponseWriter, r *http.Request) {\n    startCmd()\n    w.Write([]byte(\"Done\"))\n}\n</code></pre>\n\n<p>Make a file named /tmp/sleepscript.sh and chmod it to 755</p>\n\n<pre><code>#!/bin/bash\nsleep 5\n</code></pre>\n\n<p>And then make several concurrent requests to /startapp. In a bash shell, you can do it this way:</p>\n\n<pre><code>for i in {1..300}; do (curl http://localhost:8081/startapp &amp;); done\n</code></pre>\n\n<p>The VIRT memory should now be several gigabytes. If you re-run the above for loop, the VIRT memory will continue to grow by gigabytes every time. </p>\n\n<p><strong>Update 1:</strong> The problem is that I am hitting OOM issues on CentOS. (thanks @nos)</p>\n\n<p><strong>Update 2:</strong> Worked around the problem by using <code>daemonize</code> and syncing the calls to <code>Cmd.Run()</code>. Thanks @JimB for confirming that <code>.Wait()</code> running in it's own thread is part of the POSIX api and there isn't a way to avoid calling <code>.Wait()</code> without leaking resources. </p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1450452351, "post_id": 34345876, "comment_id": 56459232, "body": "In my code, the client variable is an s3 session.  So I should be able to pass  client instead of nil into the NewDownloader.  However when I do I receive the error   ./test.go:25: cannot use client (type *s3.S3) as type client.ConfigProvider in argument to s3manager.NewDownloader: \t*s3.S3 does not implement client.ConfigProvider (missing ClientConfig method)   I&#39;ve modified the error and source above.   I also tried you&#39;re method above  session := session.New() manager := s3manager.NewDownloader(sess)  but is throws the error session has no method New(), my code is based on aws example code."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1450453656, "post_id": 34345876, "comment_id": 56460079, "body": "@msanti: No, <code>client</code> isn&#39;t a <code>client.ConfigProvider</code>. Just create a session, and use it for both your client and manager."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1450457055, "post_id": 34345876, "comment_id": 56462215, "body": "Thank you! Sorry for the confusion"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 0, "last_activity_date": 1450452824, "last_edit_date": 1450452824, "creation_date": 1450393154, "answer_id": 34345876, "question_id": 34345611, "link": "https://stackoverflow.com/questions/34345611/download-log-files-from-aws-s3-panic-runtime-error/34345876#34345876", "title": "Download Log Files from AWS S3 panic: runtime error:", "body": "<p>You're passing <code>nil</code> to <code>s3manager.NewDownloader</code> where it requires a <code>Session</code></p>\n\n<pre><code>sess := session.New()\nmanager := s3manager.NewDownloader(sess)\n</code></pre>\n"}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 34345876, "answer_count": 1, "score": 0, "last_activity_date": 1450452824, "creation_date": 1450391915, "last_edit_date": 1450452465, "question_id": 34345611, "link": "https://stackoverflow.com/questions/34345611/download-log-files-from-aws-s3-panic-runtime-error", "title": "Download Log Files from AWS S3 panic: runtime error:", "body": "<p>I'm to download all the log files in a particular bucket (eventually every bucket I have), here is the code I'm using</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/s3\"\n    \"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n)\n\nvar (\n    // variables empty for security\n    Bucket         = \"\"                                               // Download from this bucket\n    Prefix         = \"\" // Using this key prefix\n    LocalDirectory = \"s3logs\"                                                    // Into this directory\n)\n\nfunc main() {\n\n    client := s3.New(session.New(), &amp;aws.Config{Region: aws.String(\"us-west-1\")})\n    params := &amp;s3.ListObjectsInput{Bucket: &amp;Bucket, Prefix: &amp;Prefix}\n\n    manager := s3manager.NewDownloader(client)\n    d := downloader{bucket: Bucket, dir: LocalDirectory, Downloader: manager}\n\n    client.ListObjectsPages(params, d.eachPage)\n\n}\n\ntype downloader struct {\n    *s3manager.Downloader\n    bucket, dir string\n}\n\nfunc (d *downloader) eachPage(page *s3.ListObjectsOutput, more bool) bool {\n    for _, obj := range page.Contents {\n        d.downloadToFile(*obj.Key)\n    }\n\n    return true\n}\n\nfunc (d *downloader) downloadToFile(key string) {\n    // Create the directories in the path\n    file := filepath.Join(d.dir, key)\n\n    if err := os.MkdirAll(filepath.Dir(file), 0775); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"Downloading \" + key)\n    // Setup the local file\n    fd, err := os.Create(file)\n    if err != nil {\n        panic(err)\n    }\n\n    defer fd.Close()\n\n    // Download the file using the AWS SDK\n    fmt.Printf(\"Downloading s3://%s/%s to %s...\\n\", d.bucket, key, file)\n    params := &amp;s3.GetObjectInput{Bucket: &amp;d.bucket, Key: &amp;key}\n    d.Download(fd, params)\n}\n</code></pre>\n\n<p>However when I run this code I receive a panic error</p>\n\n<p>cannot use client (type *s3.S3) as type client.ConfigProvider in argument to s3manager.NewDownloader:\n*s3.S3 does not implement client.ConfigProvider (missing ClientConfig method)</p>\n\n<p>I have no idea what this code won't work, any thoughts and or fixes</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1450386403, "post_id": 34344172, "comment_id": 56430012, "body": "Don&#39;t declare <code>instance</code> the second time."}, {"owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450386484, "post_id": 34344172, "comment_id": 56430051, "body": "Hi, again. But where should I declare it? Is there any convention for handle with this?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1450386717, "post_id": 34344172, "comment_id": 56430157, "body": "Have you read through the docs yet? <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>, <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">Effective Go</a>, <a href=\"http://tour.golang.org/\" rel=\"nofollow noreferrer\">Tour of Go</a>"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 1, "creation_date": 1450387512, "post_id": 34344172, "comment_id": 56430584, "body": "Or just rename each to something other than <code>instance</code>?"}, {"owner": {"reputation": 1615, "user_id": 1376205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff8ba613f2dc50cc30e7f3af3e2914?s=128&d=identicon&r=PG", "display_name": "Will C", "link": "https://stackoverflow.com/users/1376205/will-c"}, "edited": false, "score": 0, "creation_date": 1450389622, "post_id": 34344172, "comment_id": 56431706, "body": "<code>instance</code> is a vague variable name. What is it an instance of? You&#39;re using the same variable name for two different types. Its almost like defining a class with two class variables that have different types; of course the compiler will complain. Either 1. put your structs in different packages and not in the same <code>dao</code> package or 2. rename your variables."}, {"owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "edited": false, "score": 0, "creation_date": 1450390087, "post_id": 34344172, "comment_id": 56431935, "body": "I come from Java background. This is because to have two variables with the same name in different files is not strange for me. But now,  I know that it is not possible in Go. I have named it &quot;instance&quot; because I was trying to implement singleton pattern."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450390193, "post_id": 34344172, "comment_id": 56431990, "body": "@bigdestroyer: A general tip, don&#39;t write java in Go. Go isn&#39;t OO in the same way as java, and the patterns one would use in java are often counter-productive in Go."}], "answers": [{"tags": [], "owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "is_accepted": true, "score": 21, "last_activity_date": 1450428679, "last_edit_date": 1450428679, "creation_date": 1450398774, "answer_id": 34346779, "question_id": 34344172, "link": "https://stackoverflow.com/questions/34344172/go-instance-redeclared-in-this-block/34346779#34346779", "title": "Go: &quot;instance&quot; redeclared in this block", "body": "<p>Files have no real meaning for go, unlike in java, python and many others, they are just for you to organize your code as you see fit.</p>\n\n<p>In go variables are visible <code>package</code> wide, that means that both declartions of <code>instance</code> are variables with package wide visibility. Hence the compiler complains about having two global variables with the same name.</p>\n\n<p>Rename any one of your two instance variables and it will compile. </p>\n\n<p>Reading the links in the comments above is highly recommend ;-)</p>\n"}], "owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12568, "favorite_count": 0, "accepted_answer_id": 34346779, "answer_count": 1, "score": 8, "last_activity_date": 1450428679, "creation_date": 1450386134, "question_id": 34344172, "link": "https://stackoverflow.com/questions/34344172/go-instance-redeclared-in-this-block", "title": "Go: &quot;instance&quot; redeclared in this block", "body": "<p>I have these two files:</p>\n\n<p><strong>daoFactory.go</strong></p>\n\n<pre><code>package dao\n\nimport \"sync\"\n\ntype daoFactory struct {}\n\nvar instance *daoFactory\n\n//some functions\n</code></pre>\n\n<p><strong>fakeProvisionDao.go</strong></p>\n\n<pre><code>package dao\n\nimport (\n    \"sync\"\n    \"model\"\n)\n\ntype provisionDao struct {\n}\n\nvar instance *provisionDao\n\n//some functions\n</code></pre>\n\n<p>Both are in the same package: <code>dao</code>.</p>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>\"instance\" redeclared in this block</p>\n</blockquote>\n\n<p>Obviously, the cause is that <code>instance</code> variable is declared in both files. I'm beggining in Go programming and I don't know how should I handle with this error.</p>\n"}, {"tags": ["xml", "soap", "go", "envelope"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450386256, "post_id": 34343240, "comment_id": 56429930, "body": "I haven&#39;t looked closely at what you&#39;re doing yet, but your round-trip issue is probably addressed somewhere here: <a href=\"https://github.com/golang/go/issues/13400\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/13400</a>. I tent to look outside encoding/xml for anything but simple XML."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3368555"}, "edited": false, "score": 0, "creation_date": 1450471486, "post_id": 34347174, "comment_id": 56469788, "body": "very good tip about the symbol  <code>&gt;</code>  to wrap nested struct fields in one go."}], "tags": [], "owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "is_accepted": false, "score": 0, "last_activity_date": 1450429742, "last_edit_date": 1450429742, "creation_date": 1450402031, "answer_id": 34347174, "question_id": 34343240, "link": "https://stackoverflow.com/questions/34343240/best-way-to-parse-xml-envelope-soap-in-go/34347174#34347174", "title": "Best way to parse Xml Envelope Soap in Go", "body": "<p>As far as I can see, your envelopes are the same (from a parsing/schema point of view), so you could use struct <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">embedding</a> to reduce the amount of structs.</p>\n\n<p>To further reduce the amout of structs you can use the <code>&gt;</code> syntax in struct tags to wrap nested struct fields in one go (<a href=\"https://golang.org/pkg/encoding/xml/#Marshal\" rel=\"nofollow\">xml.Marshal</a>, <a href=\"https://golang.org/pkg/encoding/xml/#UnMarshal\" rel=\"nofollow\">xml.Unmarshal</a>)</p>\n\n<pre><code>type Envelope struct {\n     XMLName    xml.Name `xml:\"Envelope\"`\n     Val1       string   `xml:\"xmlns:soapenv,attr\"`\n     Val2       string   `xml:\"xmlns:web,attr\"`\n}\n\ntype Msg1 struct {\n     Envelope \n     Input string `xml:\"soapenv:Body&gt;web:chunkTest&gt;inputText\"`\n}\n</code></pre>\n\n<p>I've not tested this to perfection, but it should be enough to get you started.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3368555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1011, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1450429742, "creation_date": 1450382380, "question_id": 34343240, "link": "https://stackoverflow.com/questions/34343240/best-way-to-parse-xml-envelope-soap-in-go", "title": "Best way to parse Xml Envelope Soap in Go", "body": "<p>i'm doing a command line app that acts as interface to some SOAP services.\nIn order to send and recive some valid response i have to parse a custom xml(envelope) that every soap service has his own frame envelope and in that frame i must add my buff/text/info.</p>\n\n<p>One frame looks like this.</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:web=\"http://webPosRo.uaic/\"&gt;\n&lt;soapenv:Body&gt;\n    &lt;web:parseText_XML&gt;\n        &lt;rawTextInput&gt;HERE&lt;/rawTextInput&gt;\n    &lt;/web:parseText_XML&gt;\n&lt;/soapenv:Body&gt;\n</code></pre>\n\n<p>And if you look in \"HERE\" i must place my content that i want to send.\nI find it quite strange to use the encoding/xml package because i have 6 services for example and per service i have one envelope type.</p>\n\n<p>And in order to pass them i need to make 6 different pairs of structs like this.</p>\n\n<pre><code> type Envelope struct {\n    XMLName    xml.Name `xml:\"Envelope\"`\n    Val1       string   `xml:\"xmlns:soapenv,attr\"`\n    Val2       string   `xml:\"xmlns:web,attr\"`\n    CreateBody Body     `xml:\"soapenv:Body\"`\n    }\n\n    type Body struct {\n        CreateText Text `xml:\"web:parseText_XML\"`\n    }\n\n    type Text struct {\n        TextRow []byte `xml:\"rawTextInput\"`\n    }\n</code></pre>\n\n<p>And if i have another envelope like.</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:web=\"http://webNpChunkerRo.uaic/\"&gt;\n   &lt;soapenv:Body&gt;\n      &lt;web:chunkText&gt;\n         &lt;inputText&gt;\n         &lt;/inputText&gt;\n      &lt;/web:chunkText&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>I have another 3 struct pair type.</p>\n\n<pre><code>type Envelope1 struct {\n    XMLName    xml.Name `xml:\"Envelope\"`\n    Val1       string   `xml:\"xmlns:soapenv,attr\"`\n    Val2       string   `xml:\"xmlns:web,attr\"`\n    CreateBody Body1    `xml:\"soapenv:Body\"`\n}\n\ntype Body1 struct {\n    CreateText Text1 `xml:\"web:chunkTest\"`\n}\n\ntype Text1 struct {\n    TypeRow []byte `xml:\"inputText\"`\n}\n</code></pre>\n\n<p>And i find it quite strange.. and also in order to parse that first node that has a namespace</p>\n\n<pre><code>&lt;soapenv:Envelope ... &gt;\n//content\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>After i Unmarshall and Marshall i get</p>\n\n<pre><code>&lt;Envelope ... &gt;\n//content\n&lt;/Envelope&gt;\n</code></pre>\n\n<p>Just the first note loses that namespace \"soapenv\" and in order to have it compleate i must make a function that sanitize it like this.</p>\n\n<pre><code>func sanitizeEnvelope(buffer []byte) []byte {\n\n    var (\n        StartF = []byte(\"&lt;Envelope\")\n        FinalF = []byte(\"&lt;/Envelope&gt;\")\n        StartT = []byte(\"&lt;soapenv:Envelope \")\n        FinalT = []byte(\"&lt;/soapenv:Envelope&gt;\")\n    )\n\n    // Check all the bytes equal to StartF and FinalF\n    // And replace all with StartT and FinalT\n    buffer = bytes.Replace(buffer, StartF, StartT, -1)\n    buffer = bytes.Replace(buffer, FinalF, FinalT, -1)\n\n    // return the new sanitize envelope buffer\n    return buffer\n}\n</code></pre>\n\n<p>It's there any better solution to parse this and also include that first node namsepace? Or it's ok with a sanitize solution like one above?</p>\n"}, {"tags": ["pointers", "go", "casting", "null"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1450381453, "post_id": 34342522, "comment_id": 56427385, "body": "<code>NilMyError()</code> returns a <code>nil</code> pointer. <code>NilErrorFromMyError()</code> returns this <code>nil</code> value, but before it does, an implicit interface value of type <code>error</code> is created because <code>*MyError</code> is a concrete type and <code>error</code> is an interface type. This is where your <code>nil</code> value &quot;gets&quot; lost: a non-<code>nil</code> interface value will be created holding a <code>nil</code> value and <code>*MyError</code> type. Read the duplicate-marked answer for greater detail."}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 0, "creation_date": 1450383347, "post_id": 34342522, "comment_id": 56428485, "body": "Hey, check out <a href=\"http://stackoverflow.com/a/34343388/230340\">my answer</a> explaining exactly this problem. Hope I helped."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1450404286, "post_id": 34342522, "comment_id": 56436523, "body": "This is <a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">explained in the Go Language FAQ</a>."}], "owner": {"reputation": 1010, "user_id": 3187183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CxbLu.jpg?s=128&g=1", "display_name": "b.ben", "link": "https://stackoverflow.com/users/3187183/b-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 1, "closed_date": 1450380823, "answer_count": 0, "score": 0, "last_activity_date": 1450379864, "creation_date": 1450379864, "question_id": 34342522, "link": "https://stackoverflow.com/questions/34342522/golang-convert-nil-pointer-of-struct-to-error-but-not-get-nil-value", "closed_reason": "Duplicate", "title": "Golang, convert nil pointer of struct to error, but not get nil value", "body": "<p>Why <code>c</code> is not print while it's value is nil</p>\n\n<p>Am I misunderstand something?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype MyError struct {\n    Why string\n    What string\n}\n\nfunc (this *MyError) Error() string {\n    return this.What + this.Why\n}\n\nfunc main() {\n    nilError := error(nil)\n    if nilError == nil {\n        fmt.Println(\"a\")\n    }\n    if NilMyError() == nil {\n        fmt.Println(\"b\")\n    }   \n    if NilErrorFromMyError() == nil {\n        fmt.Println(\"c\")\n    }\n}\n\nfunc NilErrorFromMyError() error {\n    return NilMyError()\n}\n\nfunc NilMyError() *MyError {\n    return nil\n}\n</code></pre>\n\n<p>Result :</p>\n\n<pre><code>a\nb\n</code></pre>\n"}, {"tags": ["performance", "go"], "comments": [{"owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "edited": false, "score": 0, "creation_date": 1450371321, "post_id": 34339353, "comment_id": 56421582, "body": "If you are receiving a parameter that is already of the type <code>time.Duration</code> then you should not need to multiply it by <code>time.Second</code>, just call the function by passing <code>1*time.Millisecond</code> and you&#39;ll have 345600*1000 requests, if you have enough memory to handle it you&#39;ll be fine, otherwise just choose a duration between 1 millisecond and 1 second."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450375865, "post_id": 34339353, "comment_id": 56424272, "body": "Why do you think that 1 core can only handle 1 req/sec? BTW, <code>runtime.GOMAXPROCS(runtime.NumCPU())</code> is the default, so there&#39; no need to set that."}, {"owner": {"reputation": 29, "user_id": 5691697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f8d04246b32a702a951d54c383dbfe?s=128&d=identicon&r=PG&f=1", "display_name": "soiepark", "link": "https://stackoverflow.com/users/5691697/soiepark"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450433001, "post_id": 34339353, "comment_id": 56447485, "body": "@JimB I do not, my program only uses 1sec intervals to not overload the database. BTW the <code>runtime.GOMAXPROCS(runtime.NumCPU())</code> is by default since Go <b>1.5</b> only and my code still runs on 1.4 version."}, {"owner": {"reputation": 10639, "user_id": 1431750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5557aad9ff70c36cfac418f511bdea98?s=128&d=identicon&r=PG", "display_name": "aneroid", "link": "https://stackoverflow.com/users/1431750/aneroid"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450435132, "post_id": 34339353, "comment_id": 56448843, "body": "Your bottleneck is going to be your bandwidth rather than CPU power. How many threads your hardware can handle will have to be determined via trial and error. Without a GUI and on a server, I&#39;d expect this to be done with no less than 64 threads/procs. Monitor/measure CPU idle time and network activity to determine what you should use. And as per what @JimB said, remove the timing part, and just poll the db in sets of 100 to 1000 records. Store those results separately (like in a FIFO queue) and keep popping items off it when threads/procs are done."}, {"owner": {"reputation": 29, "user_id": 5691697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f8d04246b32a702a951d54c383dbfe?s=128&d=identicon&r=PG&f=1", "display_name": "soiepark", "link": "https://stackoverflow.com/users/5691697/soiepark"}, "reply_to_user": {"reputation": 10639, "user_id": 1431750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5557aad9ff70c36cfac418f511bdea98?s=128&d=identicon&r=PG", "display_name": "aneroid", "link": "https://stackoverflow.com/users/1431750/aneroid"}, "edited": false, "score": 0, "creation_date": 1450457129, "post_id": 34339353, "comment_id": 56462272, "body": "@aneroid how do you ensure multiple workers do not process same URL? easier to say than do ;) btw go channels are FIFO."}, {"owner": {"reputation": 10639, "user_id": 1431750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5557aad9ff70c36cfac418f511bdea98?s=128&d=identicon&r=PG", "display_name": "aneroid", "link": "https://stackoverflow.com/users/1431750/aneroid"}, "edited": false, "score": 0, "creation_date": 1450463493, "post_id": 34339353, "comment_id": 56465859, "body": "Every time you <code>pop(0)</code> (first item) from the queue, at some point you&#39;ll get an error since your queue will be empty. At that point, query another set of 100-1000 URLs and set a flag that prevents further pop-errors from polling more results from the db. Or if that presents an un-fixable race condition, then let each thread/proc pull 10 URLs (or just 1) from the db which belong only to it. This will require a read lock on the db to prevent race conditions so make sure to fetch all rows before continuing the scraping."}, {"owner": {"reputation": 10639, "user_id": 1431750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5557aad9ff70c36cfac418f511bdea98?s=128&d=identicon&r=PG", "display_name": "aneroid", "link": "https://stackoverflow.com/users/1431750/aneroid"}, "edited": false, "score": 0, "creation_date": 1450463656, "post_id": 34339353, "comment_id": 56465928, "body": "You can use <a href=\"http://stackoverflow.com/a/30558173/1431750\">go&#39;s closures</a> to make a static variable which manages the poll/don&#39;t poll condition. Sorry, don&#39;t know much about go but the ideas/methods I&#39;ve mentioned should be portable. Was thinking of how I&#39;d do it in Python when I answered :-)"}, {"owner": {"reputation": 29, "user_id": 5691697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f8d04246b32a702a951d54c383dbfe?s=128&d=identicon&r=PG&f=1", "display_name": "soiepark", "link": "https://stackoverflow.com/users/5691697/soiepark"}, "edited": false, "score": 0, "creation_date": 1450475303, "post_id": 34339353, "comment_id": 56471363, "body": "Not really - cannot wait for queue to get empty to add more URLs as this way I can never meet the requirements and process as much as I wish."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5691697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f8d04246b32a702a951d54c383dbfe?s=128&d=identicon&r=PG&f=1", "display_name": "soiepark", "link": "https://stackoverflow.com/users/5691697/soiepark"}, "edited": false, "score": 0, "creation_date": 1450440293, "post_id": 34340565, "comment_id": 56451968, "body": "This is better approach - thanks! However what would you recommend to ensure same URL isn&#39;t processed by multiple workers? Some servers have long response time. I had a simple solution of having additional db column to indicate what state the given URL is in. But it won&#39;t work with the above but modified code."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 29, "user_id": 5691697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f8d04246b32a702a951d54c383dbfe?s=128&d=identicon&r=PG&f=1", "display_name": "soiepark", "link": "https://stackoverflow.com/users/5691697/soiepark"}, "edited": false, "score": 0, "creation_date": 1450493571, "post_id": 34340565, "comment_id": 56475828, "body": "where I have <code>ch &lt;- &quot;http:&#47;&#47;ibm.com&quot;</code>, you would just loop over the database rows and submit to the channel.   Or do you mean in case you stop/restart your app?"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 2, "last_activity_date": 1450372768, "creation_date": 1450372768, "answer_id": 34340565, "question_id": 34339353, "link": "https://stackoverflow.com/questions/34339353/performant-web-spider-with-no-external-dependencies/34340565#34340565", "title": "Performant web-spider with no external dependencies", "body": "<p>Why have the timing component at all?</p>\n\n<p>Just create a channel that you feed URLs to, then spawn N goroutines that loop over that channel and do the work.</p>\n\n<p>then just tweak the value of N until your CPU/memory is capped ~90% utilization (to accommodate fluctuations in site response times)</p>\n\n<p>something like this (<a href=\"http://play.golang.org/p/-vDvAenHie\" rel=\"nofollow\">on Play</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"sync\"\n\nvar numWorkers = 10\n\nfunc crawler(urls chan string, wg *sync.WaitGroup) {\n    defer wg.Done()\n    for u := range urls {\n        fmt.Println(u)\n    }\n}\nfunc main() {\n    ch := make(chan string)\n    var wg sync.WaitGroup\n    for i := 0; i &lt; numWorkers; i++ {\n        wg.Add(1)\n        go crawler(ch, &amp;wg)\n    }\n    ch &lt;- \"http://ibm.com\"\n    ch &lt;- \"http://google.com\"\n    close(ch)\n    wg.Wait()\n    fmt.Println(\"All Done\")\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5691697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f8d04246b32a702a951d54c383dbfe?s=128&d=identicon&r=PG&f=1", "display_name": "soiepark", "link": "https://stackoverflow.com/users/5691697/soiepark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1450372768, "creation_date": 1450369001, "question_id": 34339353, "link": "https://stackoverflow.com/questions/34339353/performant-web-spider-with-no-external-dependencies", "title": "Performant web-spider with no external dependencies", "body": "<p>I'm trying to write my first web-spider in Golang. Its task is to crawl domains (and inspect their html) from the provided database query. The idea is to have no 3rd party dependencies (e.g. msg queue), or as little as possible, yet it has to be performant enough to crawl 5 million domains per day. I have approx 150 million domains I need to check every month.</p>\n\n<p>The very basic version below - it runs in \"infinite loop\" as theoretically the crawl process would be endless.</p>\n\n<pre><code>func crawl(n time.Duration) {\n    var wg sync.WaitGroup\n    runtime.GOMAXPROCS(runtime.NumCPU())\n\n    for _ = range time.Tick(n * time.Second) {\n        wg.Add(1)\n\n        go func() {\n            defer wg.Done()\n\n            // do the expensive work here - query db, crawl domain, inspect html\n        }()\n    }\n    wg.Wait()\n}\n\nfunc main() {\n    go crawl(1)\n\n    select{}\n}\n</code></pre>\n\n<p>Running this code on 4 CPU cores at the moment means it can perform max 345600 requests during 24 hours ((60 * 60 * 24) * 4) with the given threshold of 1s. At least that's my understanding :-) If my thinking's correct then I will need to come up with solution being 14x faster to meet daily requirements.</p>\n\n<p>I would appreciate your advices in regards to make the crawler faster, but without resolving to complicated stack setup or buying server with more CPU cores.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 1315, "user_id": 570078, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6AOeF.jpg?s=128&g=1", "display_name": "shebaw", "link": "https://stackoverflow.com/users/570078/shebaw"}, "edited": false, "score": 1, "creation_date": 1450363912, "post_id": 34335513, "comment_id": 56416224, "body": "@shebaw I see. I left the <code>error</code> interface out of the equation. I revised my answer."}, {"owner": {"reputation": 1315, "user_id": 570078, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6AOeF.jpg?s=128&g=1", "display_name": "shebaw", "link": "https://stackoverflow.com/users/570078/shebaw"}, "edited": false, "score": 0, "creation_date": 1450364352, "post_id": 34335513, "comment_id": 56416555, "body": "I guess that and the second explanation the book gives is, had we made <code>errorString</code> to be a string, then any error that happens to have the same error string will evaluate to <code>True</code>. Ex: <code>io.EOF == errors.New(&quot;EOF&quot;)</code> which is incorrect."}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 1315, "user_id": 570078, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6AOeF.jpg?s=128&g=1", "display_name": "shebaw", "link": "https://stackoverflow.com/users/570078/shebaw"}, "edited": false, "score": 0, "creation_date": 1450368350, "post_id": 34335513, "comment_id": 56419396, "body": "@shebaw Right, that&#39;s also incorrect. If <code>errors.New</code> returns a pointer to the <code>errorString</code>, it won&#39;t matter if <code>errorString</code> is a struct or a string."}], "tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": true, "score": 5, "last_activity_date": 1450369009, "last_edit_date": 1450369009, "creation_date": 1450358073, "answer_id": 34335513, "question_id": 34335100, "link": "https://stackoverflow.com/questions/34335100/why-is-errorstring-a-struct-not-a-string/34335513#34335513", "title": "Why is errorString a struct, not a string", "body": "<p>The book's explanation about \"protecting representation from inadvertent updates\" looks misleading to me. Whether <code>errorString</code> is a struct or a string, the error message is still a string and a string is <a href=\"https://golang.org/ref/spec#String_types\" rel=\"nofollow\">immutable by specification</a>.</p>\n\n<p>This isn't a debate about uniqueness either. For example, <code>errors.New(\"EOF\") == io.EOF</code> evaluates to <code>false</code>, although both errors have the exact same underlying message. The same would apply even if <code>errorString</code> was a string, as long as <code>errors.New</code> would return <em>a pointer to</em> it (<a href=\"http://play.golang.org/p/42oND2MDiU\" rel=\"nofollow\">see my example</a>.)</p>\n\n<p>You could say a struct implementing <code>error</code> is idiomatic since that's also how the standard library introduces custom errors. Take a look at <code>SyntaxError</code> from the <code>encoding/json</code> package:</p>\n\n<pre><code>type SyntaxError struct {\n        Offset int64 // error occurred after reading Offset bytes\n        // contains filtered or unexported fields\n}\n\nfunc (e *SyntaxError) Error() string { return e.msg }\n</code></pre>\n\n<p>(<a href=\"https://golang.org/src/encoding/json/scanner.go?s=1944:2070#L54\" rel=\"nofollow\">source</a>)</p>\n\n<p>Also, a struct implementing the <code>error</code> interface has no performance implications and does not consume more memory over a string implementation.  See <a href=\"http://research.swtch.com/godata\" rel=\"nofollow\">Go Data Structures</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 4, "last_activity_date": 1450366410, "creation_date": 1450366410, "answer_id": 34338353, "question_id": 34335100, "link": "https://stackoverflow.com/questions/34335100/why-is-errorstring-a-struct-not-a-string/34338353#34338353", "title": "Why is errorString a struct, not a string", "body": "<p>Your testerr package works pretty well but it looses a major feature of the \"struct-based\" standard error package: That of un-equality:</p>\n\n<pre><code>package main\nimport ( \"fmt\"; \"testerr\";  \"errors\" )\n\nfunc main() {\n    a := testerr.New(\"foo\")\n    b := testerr.New(\"foo\")\n    fmt.Println(a == b)  // true\n\n    c := errors.New(\"foo\")\n    d := errors.New(\"foo\")\n    fmt.Println(c == d)  // false\n}\n</code></pre>\n\n<p>With <code>errorString</code> being a plain string different errors with the same string content become equal. The original code uses a pointer to struct and each <code>New</code> allocates a new struct so the different values returned from <code>New</code>are different if compared with <code>==</code> albeit the equal error text.</p>\n\n<p>No compiler is allowed to produce the same pointer here. And this feature of \"different calls to New produce different error values\" is important to prevent unintended equality of errors. Your testerr can be modified to yield this property by having <code>*errorString</code> implement <code>Error</code>. Try it: You need a temporary to take the address of. It \"feels\" wrong. One could imagine a fancy compiler which internalises the string values and might return the same pointer (as it points to the same internalised string) which would break this nice inequality property.  </p>\n"}], "owner": {"reputation": 1315, "user_id": 570078, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6AOeF.jpg?s=128&g=1", "display_name": "shebaw", "link": "https://stackoverflow.com/users/570078/shebaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1633, "favorite_count": 0, "accepted_answer_id": 34335513, "answer_count": 2, "score": 11, "last_activity_date": 1450369009, "creation_date": 1450356786, "last_edit_date": 1450362294, "question_id": 34335100, "link": "https://stackoverflow.com/questions/34335100/why-is-errorstring-a-struct-not-a-string", "title": "Why is errorString a struct, not a string", "body": "<p>I am reading The Go Programming Language book and in it's description of the error package and the interface</p>\n\n<pre><code>package errors\n\ntype error interface {\n    Error() string\n}\n\nfunc New(text string) error { return &amp;errorString{text} }\n\ntype errorString struct { text string }\n\nfunc (e *errorString) Error() string { return e.text }\n</code></pre>\n\n<p>it says</p>\n\n<blockquote>\n  <p>The underlying type of errorString is a struct, not a string, to protect its representation from inadvertent (or premeditated) updates.</p>\n</blockquote>\n\n<p>What does this mean? Wouldn't the package hide the underlying type since <code>errorString</code> isn't exported?</p>\n\n<p><strong>Update</strong>\nHere is the test code I used implementing <code>errorString</code> using a <code>string</code> instead. Note that when try to use it from another package, you can't just assign a string as an error.</p>\n\n<pre><code>package testerr\n\ntype Error interface {\n        Error() string\n}\n\nfunc New(text string) Error {\n        return errorString(text)\n}\n\ntype errorString string\n\nfunc (e errorString) Error() string { return string(e) }\n</code></pre>\n\n<p>And testing it with the suggested codes</p>\n\n<pre><code>func main() {\n    err := errors.New(\"foo\")\n    err = \"bar\"\n    fmt.Prinln(err)\n}\n</code></pre>\n\n<p>Will end up producing an error when compiling</p>\n\n<p><code>cannot use \"bar\" (type string) as type testerr.Error in assignment:\n    string does not implement testerr.Error (missing Error method)</code></p>\n\n<p>Of course there is a <strong>downside</strong> to this since different errors that happen to have the same error string will evaluate to being equal which we don't want.</p>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 1, "creation_date": 1450354680, "post_id": 34334276, "comment_id": 56409988, "body": "This guide may be useful for you <a href=\"http://www.goinggo.net/2014/10/error-handling-in-go-part-i.html\" rel=\"nofollow noreferrer\">goinggo.net/2014/10/error-handling-in-go-part-i.html</a>"}, {"owner": {"reputation": 67, "user_id": 2013774, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b26972193ae745c5636844effede88d2?s=128&d=identicon&r=PG", "display_name": "aleksandr", "link": "https://stackoverflow.com/users/2013774/aleksandr"}, "reply_to_user": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1450354784, "post_id": 34334276, "comment_id": 56410068, "body": "Yeah, you are right. I&#39;m not started yet realize it and tend to use just global errors.go file )"}, {"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1450355956, "post_id": 34334276, "comment_id": 56410824, "body": "Why not just have a <code>errors.go</code> since your handlers share the same package and name the error appropriately:  ``` const (   ClientErrorCheckIdCity = iota   ClientErrorCheckName   OrderErrorCheckIdCity   OrderErrorCheckItem ) ```"}, {"owner": {"reputation": 67, "user_id": 2013774, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b26972193ae745c5636844effede88d2?s=128&d=identicon&r=PG", "display_name": "aleksandr", "link": "https://stackoverflow.com/users/2013774/aleksandr"}, "edited": false, "score": 0, "creation_date": 1450355998, "post_id": 34334276, "comment_id": 56410844, "body": "I think that i can use <a href=\"http://www.postgresql.org/docs/9.4/static/errcodes-appendix.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/9.4/static/errcodes-appendix.html</a> approach. Define some classes of errors where error codes a 5 charachter string"}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1450870685, "post_id": 34334276, "comment_id": 56610441, "body": "if you think my answer was good, would you mind accepting it? =)"}], "answers": [{"tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": false, "score": 3, "last_activity_date": 1450355889, "creation_date": 1450355889, "answer_id": 34334834, "question_id": 34334276, "link": "https://stackoverflow.com/questions/34334276/good-way-to-group-errors-constant-errors-in-each-module-of-app/34334834#34334834", "title": "Good way to group errors (constant errors) in each module of app", "body": "<p>Place each error where it's originated and export it.</p>\n\n<p>See the <a href=\"http://www.goinggo.net/2014/10/error-handling-in-go-part-i.html\" rel=\"nofollow\">link</a> from my comment.</p>\n\n<pre><code>var ErrInvalidParam = fmt.Errorf(\u201cinvalid parameter [%s]\u201d, param)\n</code></pre>\n\n<p>If you want to add an error code, create a new type <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"nofollow\">satisfying the error interface</a> and add the appropriate members like errorCode or related data.</p>\n\n<p>If you want, create a build method as helper, similar as <a href=\"https://golang.org/src/errors/errors.go\" rel=\"nofollow\">errors.New</a> does</p>\n"}], "owner": {"reputation": 67, "user_id": 2013774, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b26972193ae745c5636844effede88d2?s=128&d=identicon&r=PG", "display_name": "aleksandr", "link": "https://stackoverflow.com/users/2013774/aleksandr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2906, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1618480262, "creation_date": 1450354247, "question_id": 34334276, "link": "https://stackoverflow.com/questions/34334276/good-way-to-group-errors-constant-errors-in-each-module-of-app", "title": "Good way to group errors (constant errors) in each module of app", "body": "<p>I have an Go app (web service) which returns errors in json like this:</p>\n\n<pre><code>{errorString: \"internal server error\"}\n</code></pre>\n\n<p>It's not ok because \"internal server error\" is just some programmer error string not usefull for client. The solution is to add error codes:</p>\n\n<pre><code>{errCode: 1, errorString: \"internal server error\"}\n</code></pre>\n\n<p>Now, client known that 1 means \"internal server error\" and can process it as want. For example, show for user message \"Internal Server Error\" or (in my case) the same in russian lang.</p>\n\n<p>Ok.</p>\n\n<p>So, obviously i need some file where all error constants will be described.\nFor ex. errors.go</p>\n\n<pre><code>const (\n   ErrNo = iota\n\n   // Common Errors\n   ErrNotFound\n   ErrInternalServerError\n\n   **// More specified errors**\n)\n</code></pre>\n\n<p>The problem is in <strong>More specified errors</strong> section.</p>\n\n<p>I have 2 ways:</p>\n\n<ol>\n<li>places all errors definiton in one file errors.go </li>\n<li>try to place specific errors to each related file:</li>\n</ol>\n\n<p>my controller is devided on several files in package server:</p>\n\n<p>clienthandler.go -- for client requests,\norderhandler.go -- for orders requests and so on.</p>\n\n<p>specific client errors must be places in clienthandler.go, order errors in orderhandler.go</p>\n\n<p>But how it can be realized?</p>\n\n<p>I know one simple solution:\nTake some max count of errors for each controller, for example 1000.</p>\n\n<p>clienthandler.go</p>\n\n<pre><code>package server\n\nconst (\n   ErrCheckIdCity = 1000*1 + iota\n   ErrCheckName\n)\n</code></pre>\n\n<p>that is 1000 errors (from 1000 to 1999) reserved for this file</p>\n\n<p>orderhandler.go</p>\n\n<pre><code>package server\n\nconst (\n   ErrCheckIdCity = 1000*2 + iota\n   ErrCheckItem\n)\n</code></pre>\n\n<p>that is 1000 errors (from 2000 to 2999) reserved for this file</p>\n\n<p>But disadvantge is that we limit myself by 1000 errors per controller</p>\n\n<p>May be thers is some better way?\nOr i need just use one global errros.go file ) ?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "edited": false, "score": 0, "creation_date": 1556815286, "post_id": 34334207, "comment_id": 98565406, "body": "What if the multiple nodes have a different name space? How do I unmarshal by namespaces?"}], "tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": false, "score": 1, "last_activity_date": 1450353989, "creation_date": 1450353989, "answer_id": 34334207, "question_id": 34334008, "link": "https://stackoverflow.com/questions/34334008/xml-marshalling-with-golang-multiple-nodes-with-identical-node-name/34334207#34334207", "title": "XML Marshalling with Golang - Multiple Nodes with Identical Node Name", "body": "<p>Yes, you can marshal/unmarshal multiple nodes with the same names. Just use a slice.</p>\n\n<p>Take a look at the <code>Email</code> slice in the <code>encoding/xml</code> example:</p>\n\n<pre><code>type Email struct {\n    Where string `xml:\"where,attr\"`\n    Addr  string\n}\ntype Address struct {\n    City, State string\n}\ntype Result struct {\n    XMLName xml.Name `xml:\"Person\"`\n    Name    string   `xml:\"FullName\"`\n    Phone   string\n    Email   []Email\n    Groups  []string `xml:\"Group&gt;Value\"`\n    Address\n}\n</code></pre>\n\n<p>And the corresponding XML document:</p>\n\n<pre><code>&lt;Person&gt;\n  &lt;FullName&gt;Grace R. Emlin&lt;/FullName&gt;\n  &lt;Company&gt;Example Inc.&lt;/Company&gt;\n  &lt;Email where=\"home\"&gt;\n    &lt;Addr&gt;gre@example.com&lt;/Addr&gt;\n  &lt;/Email&gt;\n  &lt;Email where='work'&gt;\n    &lt;Addr&gt;gre@work.com&lt;/Addr&gt;\n  &lt;/Email&gt;\n  &lt;Group&gt;\n    &lt;Value&gt;Friends&lt;/Value&gt;\n    &lt;Value&gt;Squash&lt;/Value&gt;\n  &lt;/Group&gt;\n  &lt;City&gt;Hanga Roa&lt;/City&gt;\n  &lt;State&gt;Easter Island&lt;/State&gt;\n&lt;/Person&gt;\n</code></pre>\n\n<p>(<a href=\"https://golang.org/pkg/encoding/xml/#example_Unmarshal\" rel=\"nofollow\">full example</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "edited": false, "score": 0, "creation_date": 1450354446, "post_id": 34334270, "comment_id": 56409816, "body": "Thank you for the quick and elaborate answer."}, {"owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "edited": false, "score": 0, "creation_date": 1562757276, "post_id": 34334270, "comment_id": 100475551, "body": "To include the header <code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</code> you could do <code>[]byte(xml.Header + string(out))</code>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1473775526, "last_edit_date": 1473775526, "creation_date": 1450354222, "answer_id": 34334270, "question_id": 34334008, "link": "https://stackoverflow.com/questions/34334008/xml-marshalling-with-golang-multiple-nodes-with-identical-node-name/34334270#34334270", "title": "XML Marshalling with Golang - Multiple Nodes with Identical Node Name", "body": "<p>For repeating XML tags, simply use a slice in Go.</p>\n\n<p>See this simple example which handles your XML input focused on unmarshaling <code>&lt;Impression&gt;</code> tags, then marshaling them again:</p>\n\n<pre><code>type Impression struct {\n    Id      string `xml:\"id,attr\"`\n    Content string `xml:\",chardata\"`\n}\n\ntype VAST struct {\n    Impressions []Impression `xml:\"Ad&gt;InLine&gt;Impression\"`\n}\n\nfunc main() {\n    v := &amp;VAST{}\n    if err := xml.Unmarshal([]byte(src), v); err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\\n\\n\", v)\n\n    if out, err := xml.MarshalIndent(v, \"\", \"  \"); err != nil {\n        panic(err)\n    } else {\n        fmt.Println(string(out))\n    }\n}\n</code></pre>\n\n<p>Output (wrapped, try it on the <a href=\"http://play.golang.org/p/JG0ontd6cO\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{Impressions:[{Id:ft_vast_i Content:http://servedby.fla...[CUT]...1076585830} \n{Id:3rdparty Content:} {Id:3rdparty Content:} {Id:3rdparty Content:} \n{Id:3rdparty Content:} {Id:3rdparty Content:} {Id:3rdparty Content:}]}\n\n&lt;VAST&gt;\n  &lt;Ad&gt;\n    &lt;InLine&gt;\n      &lt;Impression id=\"ft_vast_i\"&gt;http://servedby.fla...[CUT]...1076585830&lt;/Impression&gt;\n      &lt;Impression id=\"3rdparty\"&gt;&lt;/Impression&gt;\n      &lt;Impression id=\"3rdparty\"&gt;&lt;/Impression&gt;\n      &lt;Impression id=\"3rdparty\"&gt;&lt;/Impression&gt;\n      &lt;Impression id=\"3rdparty\"&gt;&lt;/Impression&gt;\n      &lt;Impression id=\"3rdparty\"&gt;&lt;/Impression&gt;\n      &lt;Impression id=\"3rdparty\"&gt;&lt;/Impression&gt;\n    &lt;/InLine&gt;\n  &lt;/Ad&gt;\n&lt;/VAST&gt;\n</code></pre>\n"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1793, "favorite_count": 1, "accepted_answer_id": 34334270, "answer_count": 2, "score": 3, "last_activity_date": 1473775526, "creation_date": 1450353374, "question_id": 34334008, "link": "https://stackoverflow.com/questions/34334008/xml-marshalling-with-golang-multiple-nodes-with-identical-node-name", "title": "XML Marshalling with Golang - Multiple Nodes with Identical Node Name", "body": "<p>In <a href=\"http://www.iab.com/guidelines/digital-video-ad-serving-template-vast-3-0/\" rel=\"nofollow\">VAST</a> spec, an XML file may contains several nodes with the same name - for example, several <code>Impression</code> nodes, which differ only in their <code>id</code>. </p>\n\n<p>Consider the following example:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;VAST xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"2.0\" xsi:noNamespaceSchemaLocation=\"vast.xsd\"&gt;\n   &lt;Ad id=\"812030\"&gt;\n      &lt;InLine&gt;\n         &lt;AdSystem&gt;FT&lt;/AdSystem&gt;\n         &lt;AdTitle&gt;Flashtalking mobile vast template 2.0&lt;/AdTitle&gt;\n         &lt;Description&gt;date of revision 10-04-14&lt;/Description&gt;\n         &lt;Impression id=\"ft_vast_i\"&gt;&lt;![CDATA[http://servedby.flashtalking.com/imp/1/31714;812030;201;gif;DailyMail;640x360VASTHTML5/?ft_creative=377314&amp;ft_configuration=0&amp;cachebuster=1076585830]]&gt;&lt;/Impression&gt;\n         &lt;Impression id=\"3rdparty\" /&gt;\n         &lt;Impression id=\"3rdparty\" /&gt;\n         &lt;Impression id=\"3rdparty\" /&gt;\n         &lt;Impression id=\"3rdparty\" /&gt;\n         &lt;Impression id=\"3rdparty\" /&gt;\n         &lt;Impression id=\"3rdparty\" /&gt;\n         &lt;Creatives&gt;\n            &lt;Creative sequence=\"1\"&gt;\n               &lt;Linear&gt;\n                  &lt;Duration&gt;00:00:15&lt;/Duration&gt;\n                  &lt;TrackingEvents&gt;\n                     &lt;Tracking event=\"start\"&gt;&lt;![CDATA[http://stat.flashtalking.com/reportV3/ft.stat?34923237-0-13-0-27565A88066DCD-1076585830]]&gt;&lt;/Tracking&gt;\n                     &lt;Tracking event=\"midpoint\"&gt;&lt;![CDATA[http://stat.flashtalking.com/reportV3/ft.stat?34923237-0-15-0-27565A88066DCD-1076585830]]&gt;&lt;/Tracking&gt;\n                     &lt;Tracking event=\"firstQuartile\"&gt;&lt;![CDATA[http://stat.flashtalking.com/reportV3/ft.stat?34923237-0-14-0-27565A88066DCD-1076585830]]&gt;&lt;/Tracking&gt;\n                     &lt;Tracking event=\"thirdQuartile\"&gt;&lt;![CDATA[http://stat.flashtalking.com/reportV3/ft.stat?34923237-0-16-0-27565A88066DCD-1076585830]]&gt;&lt;/Tracking&gt;\n                     &lt;Tracking event=\"complete\"&gt;&lt;![CDATA[http://stat.flashtalking.com/reportV3/ft.stat?34923237-0-17-0-27565A88066DCD-1076585830]]&gt;&lt;/Tracking&gt;\n                     &lt;Tracking event=\"mute\"&gt;&lt;![CDATA[http://stat.flashtalking.com/reportV3/ft.stat?34923237-0-38-0-27565A88066DCD-1076585830]]&gt;&lt;/Tracking&gt;\n                     &lt;Tracking event=\"fullscreen\"&gt;&lt;![CDATA[http://stat.flashtalking.com/reportV3/ft.stat?34923237-0-313-0-27565A88066DCD-1076585830]]&gt;&lt;/Tracking&gt;\n                  &lt;/TrackingEvents&gt;\n                  &lt;VideoClicks&gt;\n                     &lt;ClickThrough&gt;&lt;![CDATA[http://servedby.flashtalking.com/click/1/31714;812030;377314;211;0/?random=1076585830&amp;ft_width=640&amp;ft_height=360&amp;url=http://www.google.co.uk]]&gt;&lt;/ClickThrough&gt;\n                  &lt;/VideoClicks&gt;\n                  &lt;MediaFiles&gt;\n                     &lt;MediaFile id=\"1\" delivery=\"progressive\" type=\"video/mp4\" bitrate=\"524\" width=\"640\" height=\"360\"&gt;&lt;![CDATA[http://cdn.flashtalking.com/17601/30988_26752_WacoClub_640x360_384kbps.mp4]]&gt;&lt;/MediaFile&gt;\n                  &lt;/MediaFiles&gt;\n               &lt;/Linear&gt;\n            &lt;/Creative&gt;\n            &lt;Creative sequence=\"1\"&gt;\n               &lt;CompanionAds /&gt;\n            &lt;/Creative&gt;\n         &lt;/Creatives&gt;\n      &lt;/InLine&gt;\n   &lt;/Ad&gt;\n&lt;/VAST&gt;\n</code></pre>\n\n<p>Note the multiple <code>Impression</code> nodes which differ only by their <code>id</code> attribute (and in fact even that may sometime be identical).</p>\n\n<p>Is there a way to represent such structure with Golang in a way that will maintain the ability to marshal and unmarshal the xml with the <code>encoding/xml</code> package?  </p>\n"}, {"tags": ["linux", "go", "cgo"], "comments": [{"owner": {"reputation": 243, "user_id": 5218609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9e44b9545e752299956f515b6eb1a426?s=128&d=identicon&r=PG&f=1", "display_name": "Grv", "link": "https://stackoverflow.com/users/5218609/grv"}, "edited": false, "score": 0, "creation_date": 1450351057, "post_id": 34333107, "comment_id": 56407748, "body": "You can use ar command to build library(.a)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450378604, "post_id": 34333107, "comment_id": 56425787, "body": "You&#39;re probably more likely to get an answer about implementation details like this on the go mailing list."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 2390833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d5939336cf74f2c7d15dba3d866506?s=128&d=identicon&r=PG", "display_name": "Ahhmyface", "link": "https://stackoverflow.com/users/2390833/ahhmyface"}, "is_accepted": false, "score": 0, "last_activity_date": 1466462117, "last_edit_date": 1466462117, "creation_date": 1466443399, "answer_id": 37928364, "question_id": 34333107, "link": "https://stackoverflow.com/questions/34333107/is-there-a-way-to-include-multiple-c-archive-packages-in-a-single-binary/37928364#37928364", "title": "Is there a way to include multiple c-archive packages in a single binary", "body": "<p>I fumbled my way through this today after coming across your question.</p>\n\n<p>The key is to define a single main package that imports the packages that you need and build them all together with a single \"go install\" command. I was unable to get this to work with \"go build\".</p>\n\n<pre><code>package main //import golib\n\nimport (\n        _ \"golib/operations/bar\"\n        _ \"golib/foo\"\n)\nfunc main() {}\n</code></pre>\n\n<hr>\n\n<pre><code>go install  -buildmode=c-archive golib\n</code></pre>\n\n<hr>\n\n<p>This will place your .a and .h files under a pkg/arch/golib directory. You can include the .h files as usual, but you only need to link against golib.a</p>\n\n<pre><code>aaron@aaron-laptop:~/code/pkg/linux_amd64$ ls\ngithub.com  golang.org  golib  golib.a\naaron@aaron-laptop:~/code/pkg/linux_amd64$ ls golib\nfoo.a  foo.h operations  \naaron@aaron-laptop:~/code/pkg/linux_amd64$ ls golib/operations\nbar.a bar.h\n</code></pre>\n\n<hr>\n\n<p>Note that go will complain about unused packages if you omit the underscore in the import.</p>\n"}], "owner": {"reputation": 6235, "user_id": 622060, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/59aeda6ad8dea5965841953391441d7d?s=128&d=identicon&r=PG", "display_name": "Per Johansson", "link": "https://stackoverflow.com/users/622060/per-johansson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1466462117, "creation_date": 1450350578, "last_edit_date": 1450351812, "question_id": 34333107, "link": "https://stackoverflow.com/questions/34333107/is-there-a-way-to-include-multiple-c-archive-packages-in-a-single-binary", "title": "Is there a way to include multiple c-archive packages in a single binary", "body": "<p>I'm trying to include multiple Go c-archive packages in a single C binary, but I'm getting multiple definition errors due to the full runtime being included in each c-archive.</p>\n\n<p>I've tried putting multiple packages in the same c-archive but go build does not allow this.</p>\n\n<p>I've also tried removing <code>go.o</code> from all the archives except one, but it seems my own Go code is also in that object file so that doesn't work, and it's even the reason I get multiple defines instead of the linker ignoring <code>go.o</code> from subsequent archives.</p>\n\n<p>It would probably work to use <code>c-shared</code> instead of <code>c-archive</code>, but I don't wish to do that as I then have to put the shared libraries on my target machine, which is more complicated compared to just putting the final program binary there. I'd like everything to be statically linked if possible.</p>\n\n<p>Is there a way to get this working? I can accept a linux only solution if that matters (some <code>GNU ld</code> trickery probably in that case).</p>\n\n<p>Putting everything in a single Go package is not really an option, since it's a fairly large code base and there would be different programs wanting different parts. It would have to be an auto-generated package in that case.</p>\n\n<p>Full steps to reproduce the problem:</p>\n\n<pre><code>cd $GOPATH/src\nmkdir a b\ncat &gt; a/a.go &lt;&lt;EOT\npackage main\n\nimport \"C\"\n\n//export a\nfunc a() {\n    println(\"a\")\n}\n\nfunc main() {}\nEOT\ncat &gt; b/b.go &lt;&lt;EOT\npackage main\n\nimport \"C\"\n\n//export b\nfunc b() {\n    println(\"b\")\n}\n\nfunc main() {}\nEOT\ncat &gt; test.c &lt;&lt;EOT\n#include \"a.h\"\n#include \"b.h\"\n\nint\nmain(int argc, char *argv[]) {\n    a();\n    b();\n}\nEOT\ngo build -buildmode=c-archive -o a.a a\ngo build -buildmode=c-archive -o b.a b\ngcc test.c a.a b.a\n</code></pre>\n"}, {"tags": ["php", "go", "gzip"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 7, "creation_date": 1450351091, "post_id": 34332902, "comment_id": 56407761, "body": "Compression is often considered a <i>non-deterministic</i> operation. The same data may be compressed to different byte streams, but when decoded, they will give you back the same, original data. Possible duplicate of <a href=\"http://stackoverflow.com/questions/29002769/why-do-gzip-of-java-and-go-get-different-results\">Why do gzip of Java and Go get different results?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": false, "score": 1, "last_activity_date": 1450390517, "creation_date": 1450390517, "answer_id": 34345298, "question_id": 34332902, "link": "https://stackoverflow.com/questions/34332902/php-gzdeflate-gzinflate-functionality-on-golang/34345298#34345298", "title": "PHP gzdeflate/gzinflate functionality on Golang", "body": "<p>The test is not wether the result of compression is identical or not. The test is whether compression followed by decompression results in the exact same thing as what you started with, regardless of where or how the compressor or decompressor is implemented. E.g. you should be able to pass the compressed data from Go to PHP or vice versa, and have the decompression there give the original input exactly.</p>\n"}], "owner": {"reputation": 31, "user_id": 4399434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M_LJBxams-c/AAAAAAAAAAI/AAAAAAAAAC8/po9s1vtn3rw/photo.jpg?sz=128", "display_name": "Alexander Telpis", "link": "https://stackoverflow.com/users/4399434/alexander-telpis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450390517, "creation_date": 1450349994, "last_edit_date": 1450353170, "question_id": 34332902, "link": "https://stackoverflow.com/questions/34332902/php-gzdeflate-gzinflate-functionality-on-golang", "title": "PHP gzdeflate/gzinflate functionality on Golang", "body": "<p>I need to implement gzdeflate/gzinflate functions in <code>go</code> (compress level 9)</p>\n\n<pre><code>&lt;?php $z = gzdeflate($str, 9); ?&gt;\n</code></pre>\n\n<p>My current Go realisation looks like this:</p>\n\n<pre><code>func gzdeflate(str string) string {\n    var b bytes.Buffer\n\n    w, _ := gzip.NewWriterLevel(&amp;b, 9)\n    w.Write([]byte(str))\n    w.Close()\n    return b.String()\n}\n\nfunc gzinflate(str string) string {\n    b := bytes.NewReader([]byte(str))\n    r, _ := gzip.NewReader(b)\n    bb2 := new(bytes.Buffer)\n    _, _ = io.Copy(bb2, r)\n    r.Close()\n    byts := bb2.Bytes()\n    return string(byts)\n}\n</code></pre>\n\n<p>I receive different results</p>\n"}, {"tags": ["go", "point"], "answers": [{"tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": true, "score": 1, "last_activity_date": 1450350251, "creation_date": 1450350251, "answer_id": 34332995, "question_id": 34332873, "link": "https://stackoverflow.com/questions/34332873/go-function-return-pointer-to-memory/34332995#34332995", "title": "Go: function return pointer to memory", "body": "<p>That's perfectly safe. When you call v.Scale, a copy of Vertex is allocated and you return a pointer to it. The copy won't be garbage collected as long as it's referenced to by the pointer. If the pointer goes out of scope (and can't be used anymore), the copy would be freed.</p>\n"}], "owner": {"reputation": 2327, "user_id": 2280212, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/IUER1.jpg?s=128&g=1", "display_name": "Federico Ponzi", "link": "https://stackoverflow.com/users/2280212/federico-ponzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "closed_date": 1450350617, "accepted_answer_id": 34332995, "answer_count": 1, "score": 0, "last_activity_date": 1450350251, "creation_date": 1450349889, "question_id": 34332873, "link": "https://stackoverflow.com/questions/34332873/go-function-return-pointer-to-memory", "closed_reason": "Duplicate", "title": "Go: function return pointer to memory", "body": "<p>I'm following the golang tour, this page: <a href=\"https://tour.golang.org/methods/3\" rel=\"nofollow\">https://tour.golang.org/methods/3</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\ntype Vertex struct {\n    X, Y float64\n}\n\nfunc (v Vertex) Scale(f float64) *Vertex {\n    v.X = v.X * f\n    v.Y = v.Y * f\n    return &amp;v //I'm returning a pointer to v\n}\n\nfunc (v Vertex) Abs() float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc main() {\n    v := &amp;Vertex{3, 4}\n    fmt.Printf(\"Before scaling: %+v, Abs: %v\\n\", v, v.Abs())\n    v = v.Scale(5) //I'm assiging it to v\n    fmt.Printf(\"After scaling: %+v, Abs: %v\\n\", v, v.Abs())\n}\n</code></pre>\n\n<p>When i call v.Scale a copy of v is passed to the Scale function. Then, the Scale returns a pointer to the v that it has recevied.</p>\n\n<p>Is this safe? Or will i end up with a sigsev at some point?</p>\n\n<p>(Sorry for the title, but i couldn't think of a proper one feel free to edit it)</p>\n"}, {"tags": ["go", "webp"], "answers": [{"tags": [], "owner": {"reputation": 9072, "user_id": 887263, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b6500b41998cd1ed4aa28464ec0118bb?s=128&d=identicon&r=PG", "display_name": "Aniket", "link": "https://stackoverflow.com/users/887263/aniket"}, "is_accepted": true, "score": 0, "last_activity_date": 1450417065, "creation_date": 1450417065, "answer_id": 34349130, "question_id": 34332497, "link": "https://stackoverflow.com/questions/34332497/exec-not-running-command-from-golang-application/34349130#34349130", "title": "exec not running command from Golang application", "body": "<p>The problem was not with the execution of the command but somehow Go was not able to find the correct library. On checking the output of the command, I got the following:</p>\n\n<pre><code>cwebp: error while loading shared libraries: libwebp.so.5: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>This led me to the direction that the installation of libwebp must have been faulty. Earlier, I had built libwebp from source. So, I installed it via <code>apt-get install libwebp-dev</code> and the command ran successfully.</p>\n"}], "owner": {"reputation": 9072, "user_id": 887263, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b6500b41998cd1ed4aa28464ec0118bb?s=128&d=identicon&r=PG", "display_name": "Aniket", "link": "https://stackoverflow.com/users/887263/aniket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 34349130, "answer_count": 1, "score": 1, "last_activity_date": 1450417065, "creation_date": 1450348784, "last_edit_date": 1450416948, "question_id": 34332497, "link": "https://stackoverflow.com/questions/34332497/exec-not-running-command-from-golang-application", "title": "exec not running command from Golang application", "body": "<p>I am running a Go application in a Debian environment. All my development has been carried out on OSX and it ran fine, but I am having a problem running a command on shell from my Go code.</p>\n\n<pre><code>cmdName := \"cwebp\"\ncmdArgs := []string{srcPath, \"-o\", dstPath}\nlog.Printf(\"Executing %s : %+v\", cmdName, cmdArgs)\ncmd := exec.Command(cmdName, cmdArgs...)\n_, err := cmd.StdoutPipe()\nif err != nil {\n    log.Printf(\"Error: %s\", err)\n}\nerr = cmd.Run()\nif err != nil {\n    log.Printf(\"Error: %s\", err)\n}\n</code></pre>\n\n<p>The application process is running from my root user and the command works fine when I run it from shell.</p>\n\n<p>Earlier, I thought that I am facing the issue due to an incorrect PATH environment variable. On printing that before running the command, I get the correct path. Moreover, I have tried to use <a href=\"https://golang.org/pkg/os/exec/#LookPath\" rel=\"nofollow\">LookPath</a> and got the correct path as <code>/usr/local/bin/cwebp</code>.</p>\n"}, {"tags": ["struct", "go", "append", "slice"], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 7071067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXwJV.png?s=128&g=1", "display_name": "Paulo Campez", "link": "https://stackoverflow.com/users/7071067/paulo-campez"}, "edited": false, "score": 0, "creation_date": 1565827437, "post_id": 34329515, "comment_id": 101475555, "body": "Ty sir, i got the same problem and this solution solved"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 18, "last_activity_date": 1471849695, "last_edit_date": 1471849695, "creation_date": 1450339586, "answer_id": 34329515, "question_id": 34329441, "link": "https://stackoverflow.com/questions/34329441/golang-struct-array-values-not-appending-in-loop/34329515#34329515", "title": "Golang struct array values not appending In loop", "body": "<p>You are not appending anything to <code>book.Categories</code>, in each iteration of the <code>for</code> loop you always create a new slice with a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literal</a> and you assign it to <code>book.Categories</code>.</p>\n\n<p>If you want to append values, use the builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"noreferrer\"><code>append()</code></a> function:</p>\n\n<pre><code>for i := 0; i &lt; 10; i++ {\n    book.Categories = append(book.Categories, Category{\n        Id:   10,\n        Name: \"Vanaraj\",\n    })\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/anWN5Y7KbE\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{1 Vanaraj [{10 Vanaraj} {10 Vanaraj} {10 Vanaraj} {10 Vanaraj} {10 Vanaraj} {10 Vanaraj} {10 Vanaraj} {10 Vanaraj} {10 Vanaraj} {10 Vanaraj}]}\n</code></pre>\n\n<p>Also note that if you know the iteration count in advance (<code>10</code> in your case), you can create a big-enough slice beforehand, you can use <code>for ... range</code> and just assign values to the proper element without calling <code>append()</code>. This is more efficient:</p>\n\n<pre><code>book.Categories = make([]Category, 10)\nfor i := range book.Categories {\n    book.Categories[i] = Category{\n        Id:   10,\n        Name: \"Vanaraj\",\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 818, "user_id": 4238326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/5j2E9.jpg?s=128&g=1", "display_name": "vanarajcs", "link": "https://stackoverflow.com/users/4238326/vanarajcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17206, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1471849695, "creation_date": 1450339326, "last_edit_date": 1450339943, "question_id": 34329441, "link": "https://stackoverflow.com/questions/34329441/golang-struct-array-values-not-appending-in-loop", "title": "Golang struct array values not appending In loop", "body": "<p>This is my code:</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n)\n\ntype Category struct {\n    Id   int\n    Name string\n}\n\ntype Book struct {\n    Id         int\n    Name       string\n    Categories []Category\n}\n\nfunc main() {\n    var book Book\n\n    book.Id = 1\n    book.Name = \"Vanaraj\"\n\n    for i := 0; i &lt; 10; i++ {\n        book.Categories = []Category{\n            {\n                Id : 10,\n                Name : \"Vanaraj\",\n            },\n        }\n    }\n\n    fmt.Println(book)\n}\n</code></pre>\n\n<p>I need to append the values to the categories. The values are appending only one time. But I need to append the values to the array.</p>\n\n<p>How to fix this?</p>\n"}, {"tags": ["google-chrome", "http", "internet-explorer", "web", "go"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1450323093, "post_id": 34326108, "comment_id": 56394195, "body": "Are you certain you are typing the same URL into Chrome as you did into IE?"}, {"owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1450323341, "post_id": 34326108, "comment_id": 56394275, "body": "@TimBiegeleisen:Yes."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1450323759, "post_id": 34326108, "comment_id": 56394407, "body": "I&#39;m not a Go expert, so the only advice I can give you is to check the Go server access logs."}, {"owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 1, "creation_date": 1450324083, "post_id": 34326108, "comment_id": 56394497, "body": "@TimBiegeleisen: TBH, I don&#39;t think it is related to Go; I think it seems related to some weird configurations of Chrome."}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 1, "creation_date": 1450356248, "post_id": 34326108, "comment_id": 56410999, "body": "Use Chromes Developer Tools to see whats happening"}], "answers": [{"comments": [{"owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1450331831, "post_id": 34327247, "comment_id": 56396731, "body": "Yes, when I type &quot;localhost:9000&quot;, it redirects to 16.155.255.10/apache-default. The IE, chrome, and web application all run on one notebook computer."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 0, "creation_date": 1450333828, "post_id": 34327247, "comment_id": 56397479, "body": "that&#39;s very odd.  Only think I can think of is that your chrome is setup with some kind of proxy or something.   Good luck figuring it out"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "edited": false, "score": 2, "creation_date": 1450334336, "post_id": 34327247, "comment_id": 56397709, "body": "In case this helps, 16.155.255.10 is an hp.com address.  Guessing your notebook is hp brand.  I&#39;d assume there&#39;s a plugin or some kind of proxy that is intercepting your requests in chrome but not IE.  If you manually upgraded to Windows 10, HP&#39;s settings might have gotten dropped from IE, but chrome would have kept its settings."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1450330773, "last_edit_date": 1450330773, "creation_date": 1450330112, "answer_id": 34327247, "question_id": 34326108, "link": "https://stackoverflow.com/questions/34326108/why-do-the-ie-and-chrome-display-different-content/34327247#34327247", "title": "Why do the IE and Chrome display different content?", "body": "<p>It appears you are running chrome from a different host, yes? (based on the fact that it shows an IP addr that isn't localhost)</p>\n\n<pre><code>log.Fatal(http.ListenAndServe(\"localhost:9000\", nil))\n</code></pre>\n\n<p>This means: listen specifically on 127.0.0.1:9000 (assuming your hosts file still has localhost assigned to 127.0.0.1 as is the default)</p>\n\n<p>There's no way to hit that from another box.</p>\n\n<p>Change to:</p>\n\n<pre><code>log.Fatal(http.ListenAndServe(\":9000\", nil))\n</code></pre>\n\n<p>Which will cause the go server to listen on all addresses of the machine it runs on.</p>\n\n<p>Or are you saying that in chrome you type \"localhost:9000\" and it redirects to 16.155.255.10/apache-default from the same machine you tried IE on?</p>\n"}], "owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450330773, "creation_date": 1450322854, "last_edit_date": 1592644375, "question_id": 34326108, "link": "https://stackoverflow.com/questions/34326108/why-do-the-ie-and-chrome-display-different-content", "title": "Why do the IE and Chrome display different content?", "body": "<p>I write a simple <code>Go</code> web server which just returns the path to web client:</p>\n<pre><code>package main\nimport (\n    &quot;net/http&quot;\n    &quot;log&quot;\n)\n\ntype httpServer struct {\n}\n\nfunc (server httpServer) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(r.URL.Path))\n}\n\nfunc main() {\n    var server httpServer\n    http.Handle(&quot;/&quot;, server)\n    log.Fatal(http.ListenAndServe(&quot;localhost:9000&quot;, nil))\n}\n</code></pre>\n<p>Use <code>IE</code> web browser, it displays OK:<br />\n<a href=\"https://i.stack.imgur.com/2yk3V.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2yk3V.jpg\" alt=\"enter image description here\" /></a></p>\n<p>But the <code>Chrome</code> always redirect another site:<br />\n<a href=\"https://i.stack.imgur.com/Yrvj6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yrvj6.jpg\" alt=\"enter image description here\" /></a></p>\n<p>I doubt it is related to proxy. But why <code>IE</code> is OK, while <code>Chrome</code> not? I think they should use the same proxy.</p>\n"}]