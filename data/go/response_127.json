[{"tags": ["go"], "comments": [{"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 2, "creation_date": 1497483965, "post_id": 44556231, "comment_id": 76103190, "body": "How many times do you think you are sending to the channel?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1497484188, "post_id": 44556231, "comment_id": 76103253, "body": "@saarrrr mentioned you&#39;re sending value only once to channel. Try changing this line <code>c &lt;- 0</code> into  <code>for i:=0; i&lt;5; i++ { c &lt;- i }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 894, "user_id": 6078917, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/HRZj4.jpg?s=128&g=1", "display_name": "ryan", "link": "https://stackoverflow.com/users/6078917/ryan"}, "edited": false, "score": 0, "creation_date": 1497484364, "post_id": 44556342, "comment_id": 76103297, "body": "Thanks.  I suppose I misunderstood the channel.  How do I make the go func keep printing &#39;.&#39; until a quit signal is received?"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "reply_to_user": {"reputation": 894, "user_id": 6078917, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/HRZj4.jpg?s=128&g=1", "display_name": "ryan", "link": "https://stackoverflow.com/users/6078917/ryan"}, "edited": false, "score": 1, "creation_date": 1497485362, "post_id": 44556342, "comment_id": 76103513, "body": "The only way to read a channel without blocking (that I know of) is to use a <code>select</code> statement with a default case. <a href=\"https://play.golang.org/p/nOG_hfih4D\" rel=\"nofollow noreferrer\">play.golang.org/p/nOG_hfih4D</a>"}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 1, "creation_date": 1497561663, "post_id": 44556342, "comment_id": 76143107, "body": "another way, though slightly hacky is to use <code>reflect.ValueOf(c).TryRecv()</code> where <code>c</code> is a channel"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 3, "last_activity_date": 1497485394, "last_edit_date": 1497485394, "creation_date": 1497483849, "answer_id": 44556342, "question_id": 44556231, "link": "https://stackoverflow.com/questions/44556231/trying-to-understand-go-func-with-waitgroup/44556342#44556342", "title": "Trying to understand go func with WaitGroup", "body": "<p><code>if &lt;-c == -1</code> will block until there is something in the channel.  So, the first value is 0, it gets it, prints out a <code>.</code>, sleeps one second (while outside the goroutine it is sleeping 5 seconds), then it blocks until it gets the next value.  And then it returns.</p>\n\n<p>The only way to read a channel without blocking (that I know of) is to use a select statement with a default case. </p>\n\n<pre><code>go func() {\n    defer wg.Done()\n    for {\n        select {\n        case x, ok := &lt;-c:\n            if ok &amp;&amp; x == -1 {\n                fmt.Print(\":\")\n                return\n            }\n        default:\n            fmt.Print(\".\")\n        }\n\n        time.Sleep(time.Second)\n    }\n\n}()\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/nOG_hfih4D\" rel=\"nofollow noreferrer\">https://play.golang.org/p/nOG_hfih4D</a></p>\n"}], "owner": {"reputation": 894, "user_id": 6078917, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/HRZj4.jpg?s=128&g=1", "display_name": "ryan", "link": "https://stackoverflow.com/users/6078917/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497619986, "creation_date": 1497483022, "question_id": 44556231, "link": "https://stackoverflow.com/questions/44556231/trying-to-understand-go-func-with-waitgroup", "title": "Trying to understand go func with WaitGroup", "body": "<p>I have the following code <a href=\"https://play.golang.org/p/9jPlypO4d-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9jPlypO4d-</a></p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(1)\n    c := make(chan int)\n    go func() {\n            defer wg.Done()\n            for {\n                    if &lt;-c == -1 {\n                            fmt.Print(\":\")\n                            return\n                    }\n\n                    fmt.Print(\".\")\n                    time.Sleep(time.Second)\n            }\n\n    }()\n\n    c &lt;- 0\n    time.Sleep(time.Second * 5)\n    c &lt;- -1\n    wg.Wait()\n}\n</code></pre>\n\n<p>I wonder why there is only one <code>.</code> printed?  Shouldn't it be like 4 or 5?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "edited": false, "score": 0, "creation_date": 1497532591, "post_id": 44555039, "comment_id": 76125669, "body": "Ahhh ok, so then to fix that I would drop the equals sign portion and just declare it?"}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "edited": false, "score": 0, "creation_date": 1497532757, "post_id": 44555039, "comment_id": 76125803, "body": "But the problem I run into is I want it to be that I don&#39;t know the size of the slice coming in.  So when I drop the = first part what do I replace it with, because when I just drop it I get a array out of bounds exception."}], "tags": [], "owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "is_accepted": false, "score": 1, "last_activity_date": 1497476182, "last_edit_date": 1497476182, "creation_date": 1497475788, "answer_id": 44555039, "question_id": 44554951, "link": "https://stackoverflow.com/questions/44554951/flipping-a-slice-with-a-for-loop-logic-error/44555039#44555039", "title": "Flipping a slice with a for loop logic error", "body": "<p><strong>Short answer:</strong></p>\n\n<p><code>tempArr1[count] = first[i]\n</code></p>\n\n<p>This line is logically identical to: </p>\n\n<p><code>first[count] = first[i]\n</code></p>\n\n<p><strong>Detailed answer:</strong></p>\n\n<p><code>x := [5]int{}</code> and <code>x := []int{}</code> are in fact two very different assignments. In the first case <code>x</code> is actually a static array. In the second case <code>x</code> is a <strong>slice</strong> which is in fact <strong>a data structure which has a length, capacity and a pointer to the underlying array</strong>. Therefore, <code>var tempArr1 []int = first</code> means copy the pointer to the underlying array of <code>first</code> into the <code>tempArr1</code>, so any modification to <code>first[i]</code> will be reflected in <code>tempArr1</code> and vice versa   </p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "edited": false, "score": 0, "creation_date": 1497532968, "post_id": 44555137, "comment_id": 76125976, "body": "Got it fixed thanks for your Help!  I needed to give the slice a length and didn&#39;t know how till I saw your make method and looked it up!"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497559609, "post_id": 44555137, "comment_id": 76142170, "body": "If you don&#39;t mind reversing in-place, it can be even shorter by using the multiple-variable-assignment syntax.  Cuts down on memory footprint, too. <a href=\"https://play.golang.org/p/cCXEuQ3Nr5\" rel=\"nofollow noreferrer\">play.golang.org/p/cCXEuQ3Nr5</a>"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1497561717, "post_id": 44555137, "comment_id": 76143130, "body": "@Kaedys Yes, peterSO&#39;s answer demonstrates reversing in place. With a good array duplication function, the inplace version would be preferred."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1497476566, "last_edit_date": 1497476566, "creation_date": 1497476185, "answer_id": 44555137, "question_id": 44554951, "link": "https://stackoverflow.com/questions/44554951/flipping-a-slice-with-a-for-loop-logic-error/44555137#44555137", "title": "Flipping a slice with a for loop logic error", "body": "<p>This can be done much simpler by realizing there's no need to actually swap the individual elements. Instead, reverse each array and swap their order. Much simpler!</p>\n\n<pre><code>func reverseReverse( a, b []int ) ([]int, []int) {\n    return reverse(b), reverse(a)\n}\n\nfunc reverse( a []int ) []int {\n    end := len(a) - 1\n\n    // Allocate a new array slice of the same length to copy to.\n    ret := make( []int, len(a) )\n\n    // Copy each element of a into ret, reversed.\n    for i := range a {\n        ret[end-i] = a[i]\n    }\n\n    return ret\n}\n</code></pre>\n\n<p>With that revelation, there's little need for the very specialized <code>reverseReverse</code> function. Swap the order yourself.</p>\n\n<pre><code>fmt.Println(reverse(sliceH), reverse(sliceF))\n</code></pre>\n\n<hr>\n\n<p>Note that if you just want to take a slice of an array, it's sufficient to write <code>sliceH []int := h[:]</code> without specifying the start and end. The start is assumed to be 0 and the end is the end. Also note there's no need to declare the type, <code>:=</code> takes care of that for you.</p>\n\n<p>Even better, you can declare and initialize them directly.</p>\n\n<pre><code>sliceF:= []int{1,2,3,4,5}\nsliceH:= []int{6,7,8,9,10}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1497507963, "post_id": 44555296, "comment_id": 76109430, "body": "Note that although <code>reverse()</code> returns a slice, as if it were a copy, it reverses the original array. That&#39;s misleading. <code>reverse(s1); reverse(s2); fmt.Println(s2, s1)</code> works just as well."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1497477015, "creation_date": 1497477015, "answer_id": 44555296, "question_id": 44554951, "link": "https://stackoverflow.com/questions/44554951/flipping-a-slice-with-a-for-loop-logic-error/44555296#44555296", "title": "Flipping a slice with a for loop logic error", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc reverse(s []int) []int {\n    for i := 0; i &lt; len(s)/2; i++ {\n        s[i], s[len(s)-1-i] = s[len(s)-1-i], s[i]\n    }\n    return s\n}\n\nfunc main() {\n    s1, s2 := []int{1, 2, 3, 4, 5}, []int{6, 7, 8, 9, 10}\n    fmt.Println(s1, s2)\n    s1, s2 = reverse(s2), reverse(s1)\n    fmt.Println(s1, s2)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[1 2 3 4 5] [6 7 8 9 10]\n[10 9 8 7 6] [5 4 3 2 1]\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 44555137, "answer_count": 3, "score": 2, "last_activity_date": 1497477015, "creation_date": 1497475446, "question_id": 44554951, "link": "https://stackoverflow.com/questions/44554951/flipping-a-slice-with-a-for-loop-logic-error", "title": "Flipping a slice with a for loop logic error", "body": "<p>So I am trying to write a method that takes two slices, flips both of them and then gives them to each other.</p>\n\n<p>Ex.</p>\n\n<p>s1 = {1,2,3,4,5}</p>\n\n<p>s2 = {6,7,8,9,10}</p>\n\n<p>Should return:</p>\n\n<p>s1 = {10,9,8,7,6}</p>\n\n<p>s2 = {5,4,3,2,1}</p>\n\n<p>Here is my code: </p>\n\n<pre><code>package main\nimport(\n    \"fmt\"\n)\n\nfunc main(){\n    f:= [5]int{1,2,3,4,5}\n    h:= [5]int{6,7,8,9,10}\n    var sliceF []int = f[0:5]\n    var sliceH []int = h[0:5]\n\n    fmt.Println(reverseReverse(sliceF,sliceH))\n\n}\nfunc reverseReverse(first []int, second []int) ([]int, []int){\n    //creating temp arrays to hold the traversed arrays before swapping.\n    var tempArr1 []int = first\n    var tempArr2 []int = second\n    //count is used for counting up the tempArrays in the correct order in the For loops\n    var count  int= 0\n    //goes through the first array and sets the values starting from the end equal to the temp array\n    //which increases normally from left to right.\n    for i :=len(first)-1; i&gt;=0;i--{\n        tempArr1[count] = first[i]\n        fmt.Println(i)\n        count++\n    }\n    count =0\n    //same as first for loop just on the second array\n    for i :=len(second)-1; i&gt;=0;i--{\n        tempArr2[count] = second[i]\n        count++\n    }\n    //trying to replace the values of the param arrays to be equal to the temp arrays\n    first=tempArr2\n    second = tempArr1\n    //returning the arrays\n    return first,second\n}\n</code></pre>\n\n<p>When run here is the output: </p>\n\n<p>4</p>\n\n<p>3</p>\n\n<p>2</p>\n\n<p>1</p>\n\n<p>0</p>\n\n<p>[10 9 8 9 10] </p>\n\n<p>[5 4 3 4 5]</p>\n\n<p>*Not I included a print statement in the for loop to check if the index is decreasing properly.  </p>\n\n<p>I understand there are better ways to do this but for proof of concept I want to use a for loop.</p>\n\n<p>Any help appreciated.  I am new to go and tend to have java habits so I assume somehow my problem is related to that.  </p>\n"}, {"tags": ["go", "floating-point", "format"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497494873, "post_id": 44554607, "comment_id": 76105446, "body": "Related: <a href=\"https://stackoverflow.com/questions/36515818/golang-is-there-any-standard-library-to-convert-float64-to-string-with-fix-widt/36518167#36518167\">Golang: is there any standard library to convert float64 to string with fix width with maximum number of significant digits?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": false, "score": 3, "last_activity_date": 1497473984, "creation_date": 1497473984, "answer_id": 44554652, "question_id": 44554607, "link": "https://stackoverflow.com/questions/44554607/maximum-float-width/44554652#44554652", "title": "Maximum Float Width", "body": "<p>You can accomplish this with <code>%g</code>:</p>\n\n<pre><code>fmt.Printf(\"%.4g\\n\", 18.8836)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/accWeNXG9V\" rel=\"nofollow noreferrer\">https://play.golang.org/p/accWeNXG9V</a></p>\n"}], "owner": {"reputation": 631, "user_id": 763405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/41dadac86a35b6500f1c8626f6ccc9e1?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/763405/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1497473984, "creation_date": 1497473793, "question_id": 44554607, "link": "https://stackoverflow.com/questions/44554607/maximum-float-width", "title": "Maximum Float Width", "body": "<p>In go, the statement</p>\n\n<pre><code>fmt.Sprintf(\"%4.3f\", 18.8836)\n</code></pre>\n\n<p>Will return</p>\n\n<pre><code>18.883\n</code></pre>\n\n<p>Is there a way of making the return value</p>\n\n<pre><code>18.88\n</code></pre>\n\n<p>In other words, is there a way to make the 4 apply to the whole width of the number and not just the decimal portion?</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497469188, "post_id": 44553318, "comment_id": 76097088, "body": "<code>[]int</code> and <code>[5]int</code> are different types. Just use slices throughout. Your errors don&#39;t correspond to the source you posted, but getting rid of the arrays will fix them anyway."}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497469330, "post_id": 44553318, "comment_id": 76097158, "body": "@JimB I want it to use arrays though and when I used all arrays I got errors as well, is there a way I can use all arrays?  I will edit it to show what it was like without splices and the errors I got."}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497469764, "post_id": 44553318, "comment_id": 76097392, "body": "I edited it to show what it was before the splices.  I want to do with with arrays if possible I am sure splices would work too, but I wanted to do it with arrays for proof of concept."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497469857, "post_id": 44553318, "comment_id": 76097440, "body": "<code>(first [...]int, second [...]int)</code> isn&#39;t valid syntax, which the compiler will tell you. Your arguments are slices, so either make them arrays or use slices throughout."}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497470161, "post_id": 44553318, "comment_id": 76097618, "body": "Check the edit, I made them all arrays and I still have the same problem with more."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497470255, "post_id": 44553318, "comment_id": 76097671, "body": "you have not made them all arrays; the only arrays in the source are <code>f</code> and <code>h</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497470410, "post_id": 44553318, "comment_id": 76097757, "body": "looking at the edits, <code>var tempArr1 [len(first)]int</code> isn&#39;t valid either, again the compiler will tell you this."}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497470432, "post_id": 44553318, "comment_id": 76097763, "body": "I know it isnt valid can you explain to me why?  I don&#39;t know why that is wron g"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497470548, "post_id": 44553318, "comment_id": 76097822, "body": "It says <code>non-constant array bound</code>. Arrays size must be a constant, as it&#39;s part of the type. Arrays are fixed values and can&#39;t be dynamically sized."}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497470795, "post_id": 44553318, "comment_id": 76097954, "body": "There we go ok so the len() method doesn&#39;t count as constant."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497470841, "post_id": 44553318, "comment_id": 76097986, "body": "By definition, constants are known at compile time. <code>len()</code> is evaluated at runtime, therefor cannot be constant."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "edited": false, "score": 0, "creation_date": 1497469631, "post_id": 44553408, "comment_id": 76097322, "body": "Can you see my edit.  I wanted to try to do it with only arrays and I changed it to splices to try to solve error from using all arrays.  Is it possible to do it with all arrays? Please see edits.  If I have to use splices then I can get over than just curious if I can with only arrays."}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "edited": false, "score": 0, "creation_date": 1497470043, "post_id": 44553408, "comment_id": 76097548, "body": "So I am understanding that if I don&#39;t know the size of the array I will be getting I have to use a splice, but there is no way to use an array as a param without specifying the the length?"}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "edited": false, "score": 0, "creation_date": 1497470101, "post_id": 44553408, "comment_id": 76097586, "body": "Again I am used to java where I can say the param is an array[] of length whatever I am given."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497470302, "post_id": 44553408, "comment_id": 76097701, "body": "An array has a fixed length, a slice has variable length. You can get a slice of an array <code>myArray</code> with <code>myArray[:]</code>, which is the slice of all elements in the array."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497470329, "post_id": 44553408, "comment_id": 76097712, "body": "You can use arrays or slices anywhere, but if you&#39;re using arrays, you have to specify the length."}, {"owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "edited": false, "score": 0, "creation_date": 1497470485, "post_id": 44553408, "comment_id": 76097789, "body": "But to be clear, len(first) is not specifying the length?  This is considered variable to go?"}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "edited": false, "score": 0, "creation_date": 1497470736, "post_id": 44553408, "comment_id": 76097929, "body": "@HoldenMalinchock that is correct. In addition, the reason your attempt with &quot;var tempArr1 [len(first)]int&quot; doesn&#39;t work is because arrays are fixed (read constant): <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Array_types</a>"}], "tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": true, "score": 2, "last_activity_date": 1497470618, "last_edit_date": 1497470618, "creation_date": 1497469332, "answer_id": 44553408, "question_id": 44553318, "link": "https://stackoverflow.com/questions/44553318/using-slices-and-arrays-in-go-error/44553408#44553408", "title": "Using slices and Arrays in go error", "body": "<p>Couple of issues:</p>\n\n<ul>\n<li>You have to make a slice with a length of 5 before you can access elements in it. You'll panic if you simply do var tempArr1 []int</li>\n<li>You can use slices instead of arrays, and your return types will match with []int</li>\n</ul>\n\n<p>You'll find your fix here:<br>\n<a href=\"https://play.golang.org/p/5E2hL0796o\" rel=\"nofollow noreferrer\">https://play.golang.org/p/5E2hL0796o</a></p>\n\n<p>Edit: to allow you to keep your data types as an array, simply change your return types to match. Your function signature should look like this:</p>\n\n<pre><code>func reverseReverse(first [5]int, second [5]int) ([5]int, [5]int)\n</code></pre>\n\n<p>GoPlay here:<br>\n<a href=\"https://play.golang.org/p/_eV3Q0kspQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_eV3Q0kspQ</a></p>\n\n<p>To answer your question, you cannot have a function take in an array of arbitrary size. You would have to specify the length. There is a fundamental difference in Go for []int and [5]int.</p>\n"}], "owner": {"reputation": 53, "user_id": 8162498, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/67a66ff6f6afaef03931e5806a5f74c0?s=128&d=identicon&r=PG&f=1", "display_name": "HoldenMalinchock", "link": "https://stackoverflow.com/users/8162498/holdenmalinchock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 1, "accepted_answer_id": 44553408, "answer_count": 1, "score": 0, "last_activity_date": 1497470618, "creation_date": 1497469031, "last_edit_date": 1497470485, "question_id": 44553318, "link": "https://stackoverflow.com/questions/44553318/using-slices-and-arrays-in-go-error", "title": "Using slices and Arrays in go error", "body": "<p>I am learning go and I am used to using Java so I am running into errors than in my mind don't seem to be a problem.  Here is my code:</p>\n\n<pre><code>package main\nimport(\n    \"fmt\"\n)\n\nfunc main(){\n    f:= [5]int{1,2,3,4,5}\n    h:= [5]int{6,7,8,9,10}\n\n    fmt.Println(reverseReverse(f,h))\n\n}\nfunc reverseReverse(first []int, second []int) ([]int, []int){\n    //creating temp arrays to hold the traversed arrays before swapping.\n    var tempArr1 []int\n    var tempArr2 []int\n    //count is used for counting up the tempArrays in the correct order in the For loops\n    var count = 0\n    //goes through the first array and sets the values starting from the end equal to the temp array\n    //which increases normally from left to right.\n    for i :=len(first)-1; i&gt;=0;i--{\n        tempArr1[count] = first[i]\n        count++\n    }\n    count =0\n    //same as first for loop just on the second array\n    for i :=len(second)-1; i&gt;=0;i--{\n        tempArr2[count] = second[i]\n        count++\n    }\n    //trying to replace the values of the param arrays to be equal to the temp arrays\n    first=tempArr2\n    second = tempArr1\n    //returning the arrays\n    return first,second\n}\n</code></pre>\n\n<p>Basically I am trying to write a method that takes two arrays and returns them reversed and swapped. </p>\n\n<p>Ex:</p>\n\n<pre><code>arr1 = {1,2,3}\n\narr2 = {6,7,8}\n</code></pre>\n\n<p>should return:</p>\n\n<pre><code>arr1 = {8,7,6}\n\narr2 = {3,2,1}\n</code></pre>\n\n<p>My error that I am getting is as such :</p>\n\n<blockquote>\n  <p>src\\main\\goProject.go:35: cannot use first (type [5]int) as type []int\n  in return argument</p>\n  \n  <p>src\\main\\goProject.go:35: cannot use second (type [5]int) as type\n  []int in return argument</p>\n</blockquote>\n\n<p>It says: Cannot use f (type [5]int) as type []int on the variables in my print statement.</p>\n\n<p>I had problems before and swapped my tempArrays to be slices, but I don't understand why I am getting this error.</p>\n\n<p>Side note: I tried replacing the parameters array lengths to ... with no luck either:</p>\n\n<pre><code>func reverseReverse(first [...]int, second [...]int) ([]int, []int){\n</code></pre>\n\n<p>This created the same error as before just says: </p>\n\n<pre><code>f (type [5]int) as type [...]int\n</code></pre>\n\n<p>So my question is: why am I getting this error?  This is all the code I have comment any questions for more info if need be.  </p>\n\n<p>Here:</p>\n\n<p>Before I changed the temp array to a slice I had this:</p>\n\n<pre><code>var tempArr1 [len(first)]int\nvar tempArr2 [len(second)]int\n</code></pre>\n\n<p>I still get the same error as stated before, but the new error is:</p>\n\n<p>src\\main\\goProject.go:15: non-constant array bound len(first)</p>\n\n<p>src\\main\\goProject.go:16: non-constant array bound len(second)</p>\n\n<p>And I understand it should be constant, but why is using len() not make it constant?</p>\n"}, {"tags": ["json", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1497467275, "creation_date": 1497467275, "answer_id": 44552814, "question_id": 44552481, "link": "https://stackoverflow.com/questions/44552481/golang-gorm-and-decoding-http-request-body-into-json/44552814#44552814", "title": "Golang GORM and Decoding HTTP.Request.Body into JSON", "body": "<p>The request is valid JSON, so you won't get a JSON error. If the zero value for your struct is allowed by the schema, that's also valid, so you won't get an error from gorm. By all measures you're using, your input is valid. If you want additional validation, you'll have to write it into your handler.</p>\n"}], "owner": {"reputation": 1303, "user_id": 1990524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1b7da006e44f2492030e9ad17d15d23?s=128&d=identicon&r=PG", "display_name": "jjuser19jj", "link": "https://stackoverflow.com/users/1990524/jjuser19jj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1506, "favorite_count": 0, "accepted_answer_id": 44552814, "answer_count": 1, "score": 1, "last_activity_date": 1497467275, "creation_date": 1497466097, "question_id": 44552481, "link": "https://stackoverflow.com/questions/44552481/golang-gorm-and-decoding-http-request-body-into-json", "title": "Golang GORM and Decoding HTTP.Request.Body into JSON", "body": "<p>I am trying to decode a json request (handled with gorilla/mux) into a struct and save it with GORM into a mysql database. I send the request with curl (see the cURL command). The request is invalid and should fail at 2 points 1) It should not decode into the struct 2) It should not be saved to the database. I am not sure what I am doing wrong and would appreciate help :) </p>\n\n<p>The decoded struct looks like this:</p>\n\n<pre><code>{{0 0001-01-01 00:00:00 +0000 UTC 0001-01-01 00:00:00 +0000 UTC &lt;nil&gt;}   }\n</code></pre>\n\n<p>cURL command:</p>\n\n<pre><code>curl -d '{\"key1\":\"value1\", \"key2\":\"value2\"}' -H \"Content-Type: application/json\" -X POST http://localhost:8080/api/dimoengra/subscribe\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package subscribe\n\nimport \"github.com/jinzhu/gorm\"\nimport \"net/http\"\nimport \"encoding/json\"\nimport \"fmt\"\n\n// Subscription ...\ntype Subscription struct {\n  gorm.Model\n  ServiceID             string `gorm:\"not null\" json:\"ServiceID\"`\n  MessageCode           string `gorm:\"not null\" json:\"MessageCode\"`\n  SubscriberCallbackURL string `gorm:\"not null\" json:\"SubscriberCallbackURL\"`\n}\n\n// SubscribeHandler ...\nfunc SubscribeHandler(w http.ResponseWriter, r *http.Request, db *gorm.DB) {\n\nfmt.Println(\"Handle Subscribtion\")\n\nif r.Body == nil {\n    http.Error(w, \"Please send a request body\", 400)\n    fmt.Println(\"Empty body\")\n    return\n}\n\nvar s Subscription\nerr := json.NewDecoder(r.Body).Decode(&amp;s)\nif err != nil {\n    fmt.Println(\"Error:\", err)\n    http.Error(w, err.Error(), 400)\n    return\n}\nfmt.Println(s)\n\nerr = Subscribe(db, s)\nif err != nil {\n    fmt.Println(\"Error:\", err)\n    http.Error(w, err.Error(), 400)\n    return\n}\n\n}\n\n// Subscribe ...\nfunc Subscribe(db *gorm.DB, subscription Subscription) error {\n\nerr := db.Create(&amp;subscription)\nfmt.Println(\"err:\", err.Error)\nreturn err.Error\n}\n</code></pre>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497467957, "post_id": 44552393, "comment_id": 76096434, "body": "<a href=\"https://blog.golang.org/subtests\" rel=\"nofollow noreferrer\">subtests</a> are basically simple &quot;suites&quot;. If you want more flexibility, that&#39;s were external packages can help out, or you write your own simple wrappers."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497472116, "post_id": 44552393, "comment_id": 76098612, "body": "@JimB It turns out that, subtests are very cool, I don&#39;t know why I couldn&#39;t found them before, duckduckgoing all around. Thx for that!"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497467118, "post_id": 44552619, "comment_id": 76096035, "body": "I think he was referring to <a href=\"https://golang.org/pkg/testing/#hdr-Main\" rel=\"nofollow noreferrer\"><code>TestMain(m *testing.M)</code></a>, but yes, subtests are the easiest method without an external test framework."}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497467358, "post_id": 44552619, "comment_id": 76096150, "body": "@JimB indeed, I was thinking about <a href=\"https://golang.org/pkg/testing/#M.Run\" rel=\"nofollow noreferrer\">M.Run</a> but wrote about T.Run."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1497471949, "post_id": 44552619, "comment_id": 76098524, "body": "How this solves my problem? Can you give an example? I made some research on subtests; with them, I need to wrap my tests under another test, so I can use before/each hooks in the test. But, how is that related to <code>TestMain</code>?"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1497473185, "post_id": 44552619, "comment_id": 76099175, "body": "@inanc you need to do the same stuff with before/after wrappers(setup and close respectively in my answer) and then run main with <code>m.Run()</code>"}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 1, "creation_date": 1497473535, "post_id": 44552619, "comment_id": 76099384, "body": "@olegkovalov I still didn&#39;t get it, sorry, can you update the example? How am I going to use <code>TestMain</code> for distinct test files which need distinct setup/tear conditions in the same package?"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1497474182, "post_id": 44552619, "comment_id": 76099688, "body": "@inanc see updated answer, hope this will help you :)"}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1497474866, "post_id": 44552619, "comment_id": 76100028, "body": "@olegkovalov Hmm, how is this different than writing all the <code>setup1</code>, <code>setup2</code>, <code>teardown1</code>, <code>teardown2</code> funcs into <code>TestMain</code> directly. Isn&#39;t this going to run <code>setup1</code> and <code>teardown1</code> if I only run my 2nd test file&#39;s tests only? Thx! :|"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1497475268, "post_id": 44552619, "comment_id": 76100215, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/146702/discussion-between-olegkovalov-and-inanc\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1558347937, "post_id": 44552619, "comment_id": 99058364, "body": "Using subtests like you suggest, is there a way to prefix the tests so that you can identify which is throwing the error ?"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "reply_to_user": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1558355165, "post_id": 44552619, "comment_id": 99062272, "body": "@BlueMagma There is no such ability for <code>M.Run</code> but we&#39;ve that for <code>T.Run</code> <a href=\"https://golang.org/pkg/testing/#T.Run\" rel=\"nofollow noreferrer\">golang.org/pkg/testing/#T.Run</a>"}, {"owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "edited": false, "score": 0, "creation_date": 1558355253, "post_id": 44552619, "comment_id": 99062322, "body": "See paragraph <code>Introducing sub tests</code> here <a href=\"https://dave.cheney.net/2019/05/07/prefer-table-driven-tests\" rel=\"nofollow noreferrer\">dave.cheney.net/2019/05/07/prefer-table-driven-tests</a>"}, {"owner": {"reputation": 4181, "user_id": 64690, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cccf12ff65346b9aac871222d4fe7ffc?s=128&d=identicon&r=PG", "display_name": "Mark J Miller", "link": "https://stackoverflow.com/users/64690/mark-j-miller"}, "edited": false, "score": 0, "creation_date": 1565715005, "post_id": 44552619, "comment_id": 101435695, "body": "This example doesn&#39;t work with the <code>-run</code> argument. Or at least it becomes dependent upon the order the setups run in. If I filter the test running using <code>-run</code> to something which requires <code>setup2</code> then my test will be run immediately following <code>setup</code> and then fail because the proper setup hasn&#39;t run yet."}], "tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": false, "score": 3, "last_activity_date": 1497474163, "last_edit_date": 1497474163, "creation_date": 1497466640, "answer_id": 44552619, "question_id": 44552393, "link": "https://stackoverflow.com/questions/44552393/testmain-multiple-definitions-found/44552619#44552619", "title": "TestMain multiple definitions found", "body": "<p>You can use <a href=\"https://golang.org/pkg/testing/#M.Run\" rel=\"nofollow noreferrer\">M.Run</a>.</p>\n\n<pre><code>func TestMain(m *testing.M) {\n    setup()\n    code := m.Run() \n    close()\n    os.Exit(code)\n}\n</code></pre>\n\n<p>See <a href=\"https://blog.golang.org/subtests\" rel=\"nofollow noreferrer\">subtest</a> for additional info.</p>\n\n<p>More detailed example:</p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n)\n\nfunc setup()    {}\nfunc teardown() {}\n\nfunc setup2()    {}\nfunc teardown2() {}\n\nfunc TestMain(m *testing.M) {\n    var wrappers = []struct {\n        Setup    func()\n        Teardown func()\n    }{\n        {\n            Setup:    setup,\n            Teardown: teardown,\n        },\n        {\n            Setup:    setup2,\n            Teardown: teardown2,\n        },\n    }\n\n    for _, w := range wrappers {\n        w.Setup()\n        code := m.Run()\n        w.Teardown()\n\n        if code != 0 {\n            panic(\"code insn't null\")\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2835, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1497474163, "creation_date": 1497465848, "last_edit_date": 1497466206, "question_id": 44552393, "link": "https://stackoverflow.com/questions/44552393/testmain-multiple-definitions-found", "title": "TestMain multiple definitions found", "body": "<p>If I define, two tests, each with its own <code>TestMain</code> method, <code>go test</code> errors: <code>\"multiple definitions found of TestMain\"</code>.</p>\n\n<p>I can understand and was expecting this behaviour actually, because, there should not be more than one TestMain in the same package. However, I don't know what to do now. Each test suite has its own needs. I need to create distinct <code>TestMain</code>s to setup the tests, <em>of course, without renaming my packages</em>.</p>\n\n<p>I could do that easily in other languages with setup methods like <code>before</code>, <code>after</code>, which is <strong>unique to a test class</strong>.</p>\n\n<p>I'll probably go and use <a href=\"https://github.com/stretchr/testify\" rel=\"nofollow noreferrer\">testify</a>'s suites. Sad that this is not supported in stdlib.</p>\n\n<p>Do you have any suggestions?</p>\n"}, {"tags": ["jquery", "ajax", "go"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1497466735, "post_id": 44552209, "comment_id": 76095856, "body": "Are you able to access the <code>http:&#47;&#47;localhost:8080&#47;editnote</code> via browser? If yes then this is not a go issue. Then you have to refer jquery ajax documentation."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497467414, "post_id": 44552209, "comment_id": 76096181, "body": "Second @jeevatkm&#39;s note. Isolate each piece when troubleshooting. Test your HTTP API by itself, see if it&#39;s working, then move on to the UI piece."}, {"owner": {"reputation": 21, "user_id": 8162220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fb2dfbd59f610424f1e2c2d757ce0f?s=128&d=identicon&r=PG&f=1", "display_name": "cmshnrblu", "link": "https://stackoverflow.com/users/8162220/cmshnrblu"}, "edited": false, "score": 0, "creation_date": 1497467736, "post_id": 44552209, "comment_id": 76096320, "body": "yes, i can access it via browser."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1497467837, "post_id": 44552209, "comment_id": 76096378, "body": "check your developer-console."}, {"owner": {"reputation": 21, "user_id": 8162220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fb2dfbd59f610424f1e2c2d757ce0f?s=128&d=identicon&r=PG&f=1", "display_name": "cmshnrblu", "link": "https://stackoverflow.com/users/8162220/cmshnrblu"}, "edited": false, "score": 0, "creation_date": 1497468168, "post_id": 44552209, "comment_id": 76096546, "body": "@tkausl-- thank you--answered via main thread for clarity"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8162220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fb2dfbd59f610424f1e2c2d757ce0f?s=128&d=identicon&r=PG&f=1", "display_name": "cmshnrblu", "link": "https://stackoverflow.com/users/8162220/cmshnrblu"}, "edited": false, "score": 0, "creation_date": 1497467984, "post_id": 44552820, "comment_id": 76096444, "body": "I tried this and still no response from server, is there any more information from my .html or server that would help?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 21, "user_id": 8162220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fb2dfbd59f610424f1e2c2d757ce0f?s=128&d=identicon&r=PG&f=1", "display_name": "cmshnrblu", "link": "https://stackoverflow.com/users/8162220/cmshnrblu"}, "edited": false, "score": 1, "creation_date": 1497468272, "post_id": 44552820, "comment_id": 76096599, "body": "Sample code logs it into console. Have to checked the browser console? For chrome <code>Right click -&gt; Inspect -&gt; Console tab</code>.    Also check the <code>Network</code> tab, you can see full insights on request and response. It will help  you to debug your issue."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1497468627, "last_edit_date": 1497468627, "creation_date": 1497467293, "answer_id": 44552820, "question_id": 44552209, "link": "https://stackoverflow.com/questions/44552209/ajax-newbie-learning-golang-jquery/44552820#44552820", "title": "Ajax newbie learning (golang jquery)", "body": "<blockquote>\n  <p>It seems jQuery slim build, <a href=\"https://blog.jquery.com/2017/03/20/jquery-3-2-1-now-available/\" rel=\"nofollow noreferrer\">doesn't support ajax function</a>. So include\n  <code>jquery-3.2.1.min.js</code> try, it will work.</p>\n</blockquote>\n\n<p>SO post: Read about <a href=\"https://stackoverflow.com/questions/35424053/what-are-the-differences-between-normal-and-slim-package-of-jquery\">normal vs slim build</a>.</p>\n\n<p>Can you try this jquery ajax call?</p>\n\n<pre><code>$.ajax({\n  type: 'GET', // default is GET, so you can exclude if you want\n  url : '/editnote', // don't hard the host address\n  dataType: 'html',\n  success: function(data) {\n     console.log(data);\n  },\n  error: function(e){\n     console.log(e);\n  }\n});\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8162220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fb2dfbd59f610424f1e2c2d757ce0f?s=128&d=identicon&r=PG&f=1", "display_name": "cmshnrblu", "link": "https://stackoverflow.com/users/8162220/cmshnrblu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 0, "accepted_answer_id": 44552820, "answer_count": 1, "score": 0, "last_activity_date": 1497468725, "creation_date": 1497465248, "last_edit_date": 1497468725, "question_id": 44552209, "link": "https://stackoverflow.com/questions/44552209/ajax-newbie-learning-golang-jquery", "title": "Ajax newbie learning (golang jquery)", "body": "<p>Ok, so I have thoroughly scoured stackoverflow looking for solutions that can make my code work, and I believe I am close, but I cant tell exactly why my code isnt working. </p>\n\n<p>So, I am trying to build a dynamic content page and have an ajax request sent from click onto my notes to allow them to be expanded and viewed, and edited. </p>\n\n<p>Heres the script I am trying to use:</p>\n\n<pre><code>&lt;script&gt;\n$('.notes').on('click',function (e){\n   alert(\"ok\");\n   $.ajax({\n    type:'GET',\n    url :'localhost:8080/editnote',\n    dataType: 'html',\n    success: function(data) {\n        console.log('success',data);\n        $('#interactive').html(data);\n\n    },\n    error: function(jqXHR,textStatus,errorThrown ){\n       alert('Exception:'+errorThrown );\n    }\n});\n e.preventDefault();\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>Now, here is the golang snippet I am trying to get it to interact with. It doesn't seem to be connecting whatsoever to my server since the handlefunc never registers the troubleshooting fmt println. </p>\n\n<p>handlefunc snippet:</p>\n\n<pre><code>func test(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"code got here\")\n    s := `Here is some text from test`\n    fmt.Fprintln(w, s)\n}\n</code></pre>\n\n<p>and here is the main() snippet:</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/editnote\", test)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Any insight here would be highly valued. Thank you so much for reviewing this question. </p>\n\n<p>edit: I forgot to mention that the alert on the script successfully fires, so the on click script is working, just not the ajax. </p>\n\n<p>edit2: via developer console:</p>\n\n<pre><code>Uncaught TypeError: $.ajax is not a function\n    at HTMLDivElement.&lt;anonymous&gt; ((index):153)\n    at HTMLDivElement.dispatch (jquery-3.2.1.slim.min.js:3)\n    at HTMLDivElement.q.handle (jquery-3.2.1.slim.min.js:3)\n</code></pre>\n\n<p>Update: it appears that the issue here after i did some digging about the console was that i was using a slim version of jquery 3.2.1. After switching to a minified non-slim version, i am getting server responses to the query! I still have loads of work to do on this app, but this was a very valued solution! Thanks very much to everyone who helped me diagnose this problem!</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497465153, "post_id": 44552057, "comment_id": 76094924, "body": "If <code>longRunningFn</code> is still running, it will be in the full stack trace. What have you tried?"}], "answers": [{"tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": true, "score": 1, "last_activity_date": 1497468059, "last_edit_date": 1497468059, "creation_date": 1497465152, "answer_id": 44552180, "question_id": 44552057, "link": "https://stackoverflow.com/questions/44552057/stacktrace-of-goroutine-when-enclosing-function-ends/44552180#44552180", "title": "Stacktrace of goroutine when enclosing function ends", "body": "<p>Yes, you can use the <a href=\"https://golang.org/pkg/runtime/#Stack\" rel=\"nofollow noreferrer\">runtime.Stack</a> to print the stack of all goroutines:</p>\n\n<blockquote>\n  <p>Stack formats a stack trace of the calling goroutine into buf and returns the number of bytes written to buf. If all is true, Stack formats stack traces of all other goroutines into buf after the trace for the current goroutine.</p>\n</blockquote>\n\n<p>Simple GoPlay here:<br>\n<a href=\"https://play.golang.org/p/sB-ynAVwmU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/sB-ynAVwmU</a></p>\n\n<p>It also looks like you can print out the stack of a specific goroutine by using debug.PrintStack in conjunction with the runtime library. Credit from another S.O. answer here: <a href=\"https://stackoverflow.com/questions/19094099/how-to-dump-goroutine-stacktraces\">How to dump goroutine stacktraces?</a></p>\n"}], "owner": {"reputation": 97, "user_id": 2389440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aff95c24828ce7a62ebc665fead657b2?s=128&d=identicon&r=PG", "display_name": "Knucklehead", "link": "https://stackoverflow.com/users/2389440/knucklehead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 44552180, "answer_count": 1, "score": 1, "last_activity_date": 1497468059, "creation_date": 1497464710, "question_id": 44552057, "link": "https://stackoverflow.com/questions/44552057/stacktrace-of-goroutine-when-enclosing-function-ends", "title": "Stacktrace of goroutine when enclosing function ends", "body": "<p>Given:</p>\n\n<pre><code>func main() {\n    timeout := time.NewTimer(n)\n    go longRunningFn()\n    &lt;-timeout.C\n}\n</code></pre>\n\n<p>Is it possible to get a stacktrace of <code>longRunningFn</code> when <code>main</code> times out? </p>\n"}, {"tags": ["go", "dynamic"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "edited": false, "score": 0, "creation_date": 1497461583, "post_id": 44551138, "comment_id": 76092945, "body": "could you please include what the console says upon error."}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 4, "creation_date": 1497461924, "post_id": 44551138, "comment_id": 76093145, "body": "you cannot use <code>var dp[m][n] int</code> with variables, if you need a dynamic matrix you have to use slices or define <code>dp</code> with constants values"}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": false, "score": 4, "last_activity_date": 1497475081, "creation_date": 1497475081, "answer_id": 44554871, "question_id": 44551138, "link": "https://stackoverflow.com/questions/44551138/compile-error-non-constant-array-bound-dynamic-programming/44554871#44554871", "title": "Compile Error : Non-Constant Array Bound (Dynamic Programming)", "body": "<p>As @Motakjuq mentioned in comment: you cannot define a dynamic array, both dimensions must be constant for an array, but slice will help you.</p>\n\n<p>Use something like this:</p>\n\n<pre><code>dp := make([][]int, m)\nfor i := range dp {\n    dp[i] = make([]int, n)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4209441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T25cNIIZueQ/AAAAAAAAAAI/AAAAAAAAADk/zpy--EzqoM4/photo.jpg?sz=128", "display_name": "Pratibha Singh", "link": "https://stackoverflow.com/users/4209441/pratibha-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497525247, "creation_date": 1497461287, "last_edit_date": 1497525247, "question_id": 44551138, "link": "https://stackoverflow.com/questions/44551138/compile-error-non-constant-array-bound-dynamic-programming", "title": "Compile Error : Non-Constant Array Bound (Dynamic Programming)", "body": "<p>Im trying to solve the minimum path sum problem of Dynamic programming using golang and below is my program for that which shows compilation error.</p>\n\n<pre><code>enter code here\nfunc minPathSum(grid [][]int) int {\n    var dp[m+1][n+1] int\n    dp[0][0] = grid[0][0]\n\n    //for column initialization\n    for i := 0; i &lt;= m; i++ {\n        dp[i][0] = dp[i-1][0] + grid[i][0]\n    }\n\n    //for row initialization\n    for j := 0; j &lt;= n; j++ {\n        dp[0][j] = dp[0][j-1] + grid[0][j]\n    }\n    for i := 0; i &lt;= m; i++ {\n        for j := 0; j &lt;= n; j++ {\n            dp[i][j] = min(dp[i][j-1], dp[i-1][j], dp[i-1][j-1]) + grid[i][j]\n        }\n    }\n    return dp[m][n]\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "go", "mocking"], "comments": [{"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1497482109, "post_id": 44550509, "comment_id": 76102702, "body": "Unfortunately this is not that simple in Golang. The best bet would be to refactor your function so that <code>json.Unmarshal</code> can be forcefully made to return an error, e.g. when calling <code>json.Unmarshal(a, &amp;b)</code> and a is not in json format."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1497484834, "creation_date": 1497484834, "answer_id": 44556479, "question_id": 44550509, "link": "https://stackoverflow.com/questions/44550509/how-to-mock-a-function-to-get-a-different-return-value-in-golang/44556479#44556479", "title": "How to mock a function to get a different return value in golang", "body": "<p>What I would do in this situation is have an exported package variable <code>Unmarshaller</code> and set it to <code>json.Unmarshal</code> in the <code>init()</code> method.</p>\n\n<pre><code>var Unmarshaller func(data []byte, v interface{}) error;\n\nfunc init() {\n    Unmarshaller = json.Unmarshal\n}\n</code></pre>\n\n<p>Then, when you want to force an error, you can just do</p>\n\n<pre><code>mypackage.Unmarshaller = func(data[] byte, v interface{}) error {\n    return errors.New(\"It broke!\")\n}\n</code></pre>\n\n<p>Then, in your code, instead of calling <code>json.Unmarshal</code> directly, you call your package level `Unmarshaller, so</p>\n\n<pre><code>err =: json.Unmarshal(jsonBytes, &amp;test)\n</code></pre>\n\n<p>would become</p>\n\n<pre><code>err =: Unmarshaller(jsonBytes, &amp;test)\n</code></pre>\n\n<p>As a short example: <a href=\"https://play.golang.org/p/CinLmprtp5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CinLmprtp5</a></p>\n"}], "owner": {"reputation": 73, "user_id": 6337688, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/4659dbaec484d2a7206ee95cef4aa585?s=128&d=identicon&r=PG&f=1", "display_name": "bhaskar jupudi", "link": "https://stackoverflow.com/users/6337688/bhaskar-jupudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1817, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1497484834, "creation_date": 1497459042, "last_edit_date": 1497459166, "question_id": 44550509, "link": "https://stackoverflow.com/questions/44550509/how-to-mock-a-function-to-get-a-different-return-value-in-golang", "title": "How to mock a function to get a different return value in golang", "body": "<p>I'm writing unit tests for a function that I developed in golang. Here is the code snippet:</p>\n\n<pre><code>func myFunc () {\n    //there is some code\n    err := json.Unmarshal (a, &amp;b)\n    if err != nil {\n        //handle error    \n    }\n\n    //there is some more code\n\n    err := json.Unmarshal (c, &amp;d)\n    if err != nil {\n        //handle error    \n    }\n}\n</code></pre>\n\n<p>Now I want to mock first unmarshal to return success and second unmarshal to return failure. In python, I see one similar post:\n<a href=\"https://stackoverflow.com/questions/24897145/python-mock-multiple-return-values\">Python mock multiple return values</a></p>\n\n<p>But I cannot find one for golang. Can anyone please help me on this.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1497456783, "post_id": 44549750, "comment_id": 76090241, "body": "Sounds like u are writing a keylogger."}, {"owner": {"reputation": 41, "user_id": 8142292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6760bdcd28ff6e1aca6d69ed64147cc6?s=128&d=identicon&r=PG&f=1", "display_name": "Alanay", "link": "https://stackoverflow.com/users/8142292/alanay"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1497456905, "post_id": 44549750, "comment_id": 76090297, "body": "Yeah, that&#39;s the plan. Not for malicious use though."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497457532, "post_id": 44549750, "comment_id": 76090637, "body": "If they keylogger works, and the email sending works, I&#39;m not sure I understand the question. Put the logged keystrokes into the email body."}, {"owner": {"reputation": 41, "user_id": 8142292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6760bdcd28ff6e1aca6d69ed64147cc6?s=128&d=identicon&r=PG&f=1", "display_name": "Alanay", "link": "https://stackoverflow.com/users/8142292/alanay"}, "edited": false, "score": 0, "creation_date": 1497460002, "post_id": 44549750, "comment_id": 76092043, "body": "Yes that&#39;s what I&#39;m trying to do, but I don&#39;t know how to put the variable into the body."}, {"owner": {"reputation": 537, "user_id": 5478887, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e8d8fba40f49258d4b90ec24cb0cf1f?s=128&d=identicon&r=PG&f=1", "display_name": "Piotrowy", "link": "https://stackoverflow.com/users/5478887/piotrowy"}, "edited": false, "score": 0, "creation_date": 1497483117, "post_id": 44549750, "comment_id": 76102955, "body": "I think you should use <code>sprintf</code> function. You can read about it here <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">golang.org/pkg/fmt</a> or here <a href=\"https://stackoverflow.com/questions/11123865/golang-format-a-string-without-printing\" title=\"golang format a string without printing\">stackoverflow.com/questions/11123865/&hellip;</a>"}, {"owner": {"reputation": 341, "user_id": 529321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e974ce23b1f3016285b373fcba49c310?s=128&d=identicon&r=PG", "display_name": "skomp", "link": "https://stackoverflow.com/users/529321/skomp"}, "edited": false, "score": 2, "creation_date": 1497507499, "post_id": 44549750, "comment_id": 76109241, "body": "If you plan to put more stuff into the body: templates might the way to. If not: sprintf, as already mentioned."}], "owner": {"reputation": 41, "user_id": 8142292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6760bdcd28ff6e1aca6d69ed64147cc6?s=128&d=identicon&r=PG&f=1", "display_name": "Alanay", "link": "https://stackoverflow.com/users/8142292/alanay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497456507, "creation_date": 1497456507, "question_id": 44549750, "link": "https://stackoverflow.com/questions/44549750/how-can-i-put-variables-into-an-email-body-with-golang", "title": "How can I put variables into an email body with Golang?", "body": "<p>My aim is for every time for ENTER to be pressed in the program all the keys recorded will be emailed. What I need to do is put the keystrokes into the body, and then make it loop to create another email.</p>\n\n<p>Key recording code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n    \"net/smtp\"\n)\n\nfunc main() {\n    exec.Command(\"stty\", \"-F\", \"/dev/tty\", \"cbreak\", \"min\", \"1\").Run()\n    exec.Command(\"stty\", \"-F\", \"/dev/tty\", \"-echo\").Run()\n    defer exec.Command(\"stty\", \"-F\", \"/dev/tty\", \"echo\").Run()\n\n    var b []byte = make([]byte, 1)\n    for {\n        os.Stdin.Read(b)\n        fmt.Println(\"I got the byte\", b, \"(\"+string(b)+\")\")\n    }\n}\n</code></pre>\n\n<p>Email code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"net/mail\"\n    \"net/smtp\"\n    \"crypto/tls\"\n)\n\nfunc main() {\n\n    from := mail.Address{\"\", \"username@example.tld\"}\n    to   := mail.Address{\"\", \"username@anotherexample.tld\"}\n    subj := \"This is the email subject\"\n    body := \"This is an example body.\\n With two lines.\"\n\n    headers := make(map[string]string)\n    headers[\"From\"] = from.String()\n    headers[\"To\"] = to.String()\n    headers[\"Subject\"] = subj\n\n    message := \"\"\n    for k,v := range headers {\n        message += fmt.Sprintf(\"%s: %s\\r\\n\", k, v)\n    }\n    message += \"\\r\\n\" + body\n\n    servername := \"smtp.example.tld:465\"\n\n    host, _, _ := net.SplitHostPort(servername)\n\n    auth := smtp.PlainAuth(\"\",\"username@example.tld\", \"password\", host)\n\n    tlsconfig := &amp;tls.Config {\n        InsecureSkipVerify: true,\n        ServerName: host,\n    }\n\n    conn, err := tls.Dial(\"tcp\", servername, tlsconfig)\n    if err != nil {\n        log.Panic(err)\n    }\n\n    c, err := smtp.NewClient(conn, host)\n    if err != nil {\n        log.Panic(err)\n    }\n\n    if err = c.Auth(auth); err != nil {\n        log.Panic(err)\n    }\n\n    if err = c.Mail(from.Address); err != nil {\n        log.Panic(err)\n    }\n\n    if err = c.Rcpt(to.Address); err != nil {\n        log.Panic(err)\n    }\n\n    w, err := c.Data()\n    if err != nil {\n        log.Panic(err)\n    }\n\n    _, err = w.Write([]byte(message))\n    if err != nil {\n        log.Panic(err)\n    }\n\n    err = w.Close()\n    if err != nil {\n        log.Panic(err)\n    }\n\n    c.Quit()\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21857, "user_id": 842075, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9e1e6d890077d7e1199084462fd0a5b1?s=128&d=identicon&r=PG", "display_name": "Molecular Man", "link": "https://stackoverflow.com/users/842075/molecular-man"}, "edited": false, "score": 2, "creation_date": 1497455157, "post_id": 44548521, "comment_id": 76089198, "body": "if you are on unix-like os then you could just use find+sed <a href=\"https://stackoverflow.com/a/1583282/842075\">stackoverflow.com/a/1583282/842075</a>"}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 21857, "user_id": 842075, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9e1e6d890077d7e1199084462fd0a5b1?s=128&d=identicon&r=PG", "display_name": "Molecular Man", "link": "https://stackoverflow.com/users/842075/molecular-man"}, "edited": false, "score": 0, "creation_date": 1497456075, "post_id": 44548521, "comment_id": 76089826, "body": "Agreed with @MolecularMan on the sed approach"}], "answers": [{"comments": [{"owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "edited": false, "score": 0, "creation_date": 1497583547, "post_id": 44555295, "comment_id": 76149047, "body": "Thanks for sharing this cool trick! FWIW, I have written a python script to do basic search and replace. It does well enough to do the rest by hand. Here is my script: <a href=\"https://github.com/appscode/libbuild/blob/master/reimport.py\" rel=\"nofollow noreferrer\">github.com/appscode/libbuild/blob/master/reimport.py</a>"}], "tags": [], "owner": {"reputation": 686, "user_id": 433041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a490daadb32be545d472824bdbfbe0f?s=128&d=identicon&r=PG", "display_name": "Oleg Kovalov", "link": "https://stackoverflow.com/users/433041/oleg-kovalov"}, "is_accepted": false, "score": 0, "last_activity_date": 1497477919, "last_edit_date": 1497477919, "creation_date": 1497477013, "answer_id": 44555295, "question_id": 44548521, "link": "https://stackoverflow.com/questions/44548521/how-to-change-go-package-alias-en-masse/44555295#44555295", "title": "How to change GO package alias en masse?", "body": "<p>There is a cool trick with std tools.</p>\n\n<p><code>gofmt</code> has an option <code>-r rule</code> which works like this:</p>\n\n<p><code>gofmt -w -l -r \"github.com/a/b -&gt; github.com/c/d\" .</code></p>\n\n<p>where <code>rule</code> have format <code>pattern -&gt; replacement</code></p>\n\n<p>See <a href=\"https://golang.org/cmd/gofmt/\" rel=\"nofollow noreferrer\">gofmt docs</a> </p>\n\n<p>Also there is a <code>gofix</code> tool, but I haven't tried it, see <a href=\"https://golang.org/cmd/fix/\" rel=\"nofollow noreferrer\">docs</a> and <a href=\"https://blog.golang.org/introducing-gofix\" rel=\"nofollow noreferrer\">blog</a></p>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1057, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497477919, "creation_date": 1497452958, "question_id": 44548521, "link": "https://stackoverflow.com/questions/44548521/how-to-change-go-package-alias-en-masse", "title": "How to change GO package alias en masse?", "body": "<p>I want rename many packages across many files. At the same time, I also want to change package aliases. Is there any tool to do that? The ones I find in go/x/tools only change package imports.</p>\n\n<p>I want to go from\nimport \"github.com/a/b\"</p>\n\n<p>to</p>\n\n<p>import b \"github.com/c/d\"</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8148655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a332a2252f67d949deefffb77e652b7?s=128&d=identicon&r=PG&f=1", "display_name": "ocuparedu", "link": "https://stackoverflow.com/users/8148655/ocuparedu"}, "edited": false, "score": 0, "creation_date": 1497452460, "post_id": 44548105, "comment_id": 76087284, "body": "thank you it worked.  your example is safe with SQL injection?"}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 51, "user_id": 8148655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a332a2252f67d949deefffb77e652b7?s=128&d=identicon&r=PG&f=1", "display_name": "ocuparedu", "link": "https://stackoverflow.com/users/8148655/ocuparedu"}, "edited": false, "score": 1, "creation_date": 1497453150, "post_id": 44548105, "comment_id": 76087776, "body": "The example I gave you is not. You should really use prepared statements if you&#39;re unsure of the safety of your params. I&#39;ll update the answer with the appropriate information."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1497456273, "post_id": 44548105, "comment_id": 76089952, "body": "Right now your example doesn&#39;t make sense - you use <code>fmt.Sprintf</code> but there is no format specifier in the string and the parameter <code>login</code> is never used. You probably want <code>rows, err := db.Query(&quot;SELECT id FROM users WHERE login=?&quot;, login)</code> as your example."}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1497456508, "post_id": 44548105, "comment_id": 76090099, "body": "Derp, good call and exactly right. I kinda wanted to show both approaches for using fmt.Sprintf to formating his string (which is originally what he was asking) but also touch on the dangers of using that in conjunction with db.Exec. In this case though, he would be fine with either example snippet above (modified to your comment)."}, {"owner": {"reputation": 51, "user_id": 8148655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a332a2252f67d949deefffb77e652b7?s=128&d=identicon&r=PG&f=1", "display_name": "ocuparedu", "link": "https://stackoverflow.com/users/8148655/ocuparedu"}, "edited": false, "score": 0, "creation_date": 1497457794, "post_id": 44548105, "comment_id": 76090787, "body": "and isn&#39;t there other way to make a dynamic query without using <code>sprintf</code> ? because i see sprintf too risky"}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 51, "user_id": 8148655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a332a2252f67d949deefffb77e652b7?s=128&d=identicon&r=PG&f=1", "display_name": "ocuparedu", "link": "https://stackoverflow.com/users/8148655/ocuparedu"}, "edited": false, "score": 0, "creation_date": 1497458206, "post_id": 44548105, "comment_id": 76091030, "body": "@ocuparedu you can also use a prepared statement (see my link in the answer I posted)."}], "tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": false, "score": 2, "last_activity_date": 1497517643, "last_edit_date": 1497517643, "creation_date": 1497451788, "answer_id": 44548105, "question_id": 44548030, "link": "https://stackoverflow.com/questions/44548030/building-a-dynamic-query-in-mysql-and-golang/44548105#44548105", "title": "building a dynamic query in mysql and golang", "body": "<p>To answer your question on how to format the string, the simple answer is to use <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\">fmt.Sprintf</a> to structure your string. <strong><em>However</em></strong> see further down for a quick note on using fmt.Sprintf for db queries:</p>\n\n<blockquote>\n  <p>Sprintf formats according to a format specifier and returns the resulting string.</p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>query := fmt.Sprintf(\"SELECT id FROM users WHERE login='%s'\", login)\nerr = db.Query(query)\n\n// Equivalent to:\nrows, err := db.Query(\"SELECT id FROM users WHERE login=?\", login)\n</code></pre>\n\n<p>Using this for queries, you're safe from injections. That being said, you might be tempted to modify this and use db.Exec for creations/updates/deletions as well. As a general rule of thumb, <strong>if you use db.Exec with fmt.Sprintf and do not sanitize your inputs first, you open yourself up to sql injections</strong>.</p>\n\n<p>GoPlay with simple example of why fmt.Sprintf with db.Exec is bad:<br>\n<a href=\"https://play.golang.org/p/-IWyymAg_Q\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-IWyymAg_Q</a></p>\n\n<p>You should use <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow noreferrer\">db.Query</a> or <a href=\"https://golang.org/pkg/database/sql/#DB.Prepare\" rel=\"nofollow noreferrer\">db.Prepare</a> in an appropriate way to avoid these sorts of attack vectors. You might have to modify the code sample above to come up with a injection-safe snippet, but hopefully I gave you enough to get started.</p>\n"}], "owner": {"reputation": 51, "user_id": 8148655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a332a2252f67d949deefffb77e652b7?s=128&d=identicon&r=PG&f=1", "display_name": "ocuparedu", "link": "https://stackoverflow.com/users/8148655/ocuparedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3364, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1497517643, "creation_date": 1497451579, "last_edit_date": 1497451960, "question_id": 44548030, "link": "https://stackoverflow.com/questions/44548030/building-a-dynamic-query-in-mysql-and-golang", "title": "building a dynamic query in mysql and golang", "body": "<p>How can I build a dynamic query depending on the parameters that I get?</p>\n\n<p>This example is stupid and the syntax is wrong but you will get the idea of what I want.</p>\n\n<p>I guess that I need to add a slice of variables to the end of the query.</p>\n\n<p>I know how to do it in PHP, but not in golang.</p>\n\n<pre><code>db := OpenDB()\n\ndefer db.Close()\n\nvar filter string\n\nif name != \"\" {     \nfilter = filter \" AND name = ?\" \n\n}\n\nif surname != \"\" {  \nfilter = filter + \" AND surname = ?\"\n\n}\n\nif address != \"\" {  \nfilter =  filter + \" AND address = ?\" \n\n}\n\nerr = db.Query(\"SELECT id FROM users WHERE login = ?\" +\nfilter, login)\n</code></pre>\n"}, {"tags": ["go", "hash", "byte", "bcrypt", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497456590, "post_id": 44548579, "comment_id": 76090141, "body": "Use <code>bcrypt.CompareHashAndPassword</code> method of password comparison  instead of <code>bytes.Equal</code>."}, {"owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497597311, "post_id": 44548579, "comment_id": 76154063, "body": "I&#39;ve just compared hashes, it is author&#39;s problem, not verifying password."}], "tags": [], "owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "is_accepted": false, "score": 1, "last_activity_date": 1497453159, "creation_date": 1497453159, "answer_id": 44548579, "question_id": 44547272, "link": "https://stackoverflow.com/questions/44547272/saving-and-read-byte-in-golang-from-database/44548579#44548579", "title": "Saving and Read byte[] in Golang from database", "body": "<p>I suppose your problem is wrong id at <em>db.First(&amp;user,id)</em>. Probably you get wrong raw. I've tried to repoduce error and I couldn't. Following code works fine.</p>\n\n<pre><code>bs, err := bcrypt.GenerateFromPassword([]byte(\"12345\"), bcrypt.DefaultCost)\nexpected := bs\n\ndb.Create(&amp;Member{MyField: bs})\nvar member Member\n\ndb.First(&amp;member)\nactual := member.MyField\n\nif !bytes.Equal(actual, expected) {\n    panic(\"fields are not equal\")\n}\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3577, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1497453159, "creation_date": 1497449564, "question_id": 44547272, "link": "https://stackoverflow.com/questions/44547272/saving-and-read-byte-in-golang-from-database", "title": "Saving and Read byte[] in Golang from database", "body": "<p>I am working on a API in Golang, am using Gorm as ORM. Currently am having an issue with a []byte field, I have it defined in my struct as:</p>\n\n<pre><code>type Member struct {\n    MyField              []byte     `gorm:\"column:MyField\" schema:\"-\"`\n}\n</code></pre>\n\n<p>Then, I have the methods to Save and Read that resource, so the value when I save it is different to value that I am reading. For example,am using bcrypt to generate the hashed password, trying with 12345 the result is:</p>\n\n<pre><code>[36 50 97 36 49 48 36 46 56 98 88 72 82 71 113 66 100 65 105 103 70 119 114 97 73 77 99 78 117 106 54 78 103 88 68 49 56 110 103 112 105 86\n104 79 117 47 114 57 116 51 47 53 97 100 109 103 106 46 68 109]\n</code></pre>\n\n<p>Until there everything is ok, then when I read the register from the database and print that value I get:</p>\n\n<pre><code>[36 50 97 36 48 52 36 56 49 67 66 121 118 90 47 47 104 49 83 120 50 108 112 71 73 51 67 88 46 97 52 74 54 66 84 73 106 105 110 122 98 69 90 51\n78 113 67 66 49 103 50 56 116 47 57 120 78 103 109 54]\n</code></pre>\n\n<p>They are different, why?\nI used gorm to create the tables, and the type of that column is defined in my postgres database as <em>bytea</em></p>\n\n<p><strong>The code</strong></p>\n\n<p><strong><em>To save:</em></strong></p>\n\n<pre><code>bs, err := bcrypt.GenerateFromPassword([]byte(Pass), bcrypt.DefaultCost)    \n\nif err != nil {\n        fmt.Println(\"Hey error!\")\n}\nuser.MyField = bs\ndb.Create(&amp;user)\n</code></pre>\n\n<p><strong><em>To Read:</em></strong>\n    db.First(&amp;user,id)\nfmt.Println(user.MyField)</p>\n"}, {"tags": ["go", "wrapper", "proxy-classes"], "answers": [{"comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1497449513, "post_id": 44547002, "comment_id": 76085062, "body": "My program maybe does not work perfect, but idea was - if w support interface http.Flusher, rec also should support it. If w does not support http.Flusher, we should create rec, that does not support it. It is not an issue, if w could support only one interface. But what if w could implement some of three interfaces?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1497450082, "post_id": 44547002, "comment_id": 76085516, "body": "Yes, that&#39;s what I&#39;m saying. If you&#39;re embedding the <code>ResponseWriter</code> in <code>statusRecorder</code>, then <code>statusRecorder</code> implements <b>all</b> interfaces that were implemented by what you pass in as the <code>ResponseWriter</code>, without having to shadow any of the themods."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1497513079, "post_id": 44547002, "comment_id": 76112422, "body": "That sounds much better, than works. See this example - at first I wrote directly to httptest.NewRecorder. That is a flusher, but in the second, I wrapped it - but it does not work at all. <a href=\"https://play.golang.org/p/j-me5z_ggW\" rel=\"nofollow noreferrer\">play.golang.org/p/j-me5z_ggW</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1497530942, "post_id": 44547002, "comment_id": 76124427, "body": "I&#39;m sorry, you are absolutely right. The test case I used to prove it before I answered was flawed. There&#39;s another option, I&#39;ll update my answer shortly."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1497543401, "post_id": 44547002, "comment_id": 76133400, "body": "thank, but this was what I want to avoid. There are also another possibilities, but it would be reasonable to use it for more &quot;emulated&quot; interfaces. One is using reflect.StructOf, that allow us to create such structs in run-time, and also use &quot;go generate&quot; create such code by computer. But each of this possibilities are ugly."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1497534320, "last_edit_date": 1497534320, "creation_date": 1497448846, "answer_id": 44547002, "question_id": 44546815, "link": "https://stackoverflow.com/questions/44546815/wrapper-proxy-in-golang/44547002#44547002", "title": "Wrapper (proxy) in golang", "body": "<p>You're embedding <code>ResponseWriter</code>, and shadowing <code>Flush</code> without adding any behavior; remove the shadow method. You'll still need to do some type wrangling, but you don't need to do any method implementations unless you're trying to add or alter behavior (presumably just <code>WriteHeader</code> based on the question).</p>\n\n<p>Because you're just trying to expose methods of embedded types here, you don't even need to define all the structs, you can use anonymous structs (<a href=\"https://play.golang.org/p/nm2BQLRmzW\" rel=\"nofollow noreferrer\">playground example here</a>):</p>\n\n<pre><code>type statusRecorder struct {\n    // Not sure what all is in here but let's assume at least:\n    http.ResponseWriter\n    status int\n}\n\nfunc logware(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // Per the docs:\n        // The default ResponseWriter for HTTP/1.x connections supports Hijacker, but HTTP/2 connections intentionally do not.\n        // Pusher is the interface implemented by ResponseWriters that support HTTP/2 server push.\n        // Therefor w will only ever be a Hijacker or a Pusher, never both.\n\n        sr := &amp;statusRecorder{w, 200}\n\n        if h, ok := w.(http.Hijacker); ok {\n            if f, ok := w.(http.Flusher); ok {\n                w = &amp;struct {\n                    http.ResponseWriter\n                    http.Hijacker\n                    http.Flusher\n                }{sr, h, f}\n            } else {\n                w = &amp;struct {\n                    http.ResponseWriter\n                    http.Hijacker\n                }{sr, h}\n            }\n        } else if p, ok := w.(http.Pusher); ok {\n            if f, ok := w.(http.Flusher); ok {\n                w = &amp;struct {\n                    http.ResponseWriter\n                    http.Pusher\n                    http.Flusher\n                }{sr, p, f}\n            } else {\n                w = &amp;struct {\n                    *statusRecorder\n                    http.Pusher\n                }{sr, p}\n            }\n        } else {\n            w = sr\n        }\n\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n"}], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1388, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497534320, "creation_date": 1497448391, "last_edit_date": 1497529109, "question_id": 44546815, "link": "https://stackoverflow.com/questions/44546815/wrapper-proxy-in-golang", "title": "Wrapper (proxy) in golang", "body": "<p>When I read article <a href=\"https://upgear.io/blog/golang-tip-wrapping-http-response-writer-for-middleware/?utm_source=golangweekly&amp;utm_medium=email\" rel=\"nofollow noreferrer\">https://upgear.io/blog/golang-tip-wrapping-http-response-writer-for-middleware/?utm_source=golangweekly&amp;utm_medium=email</a>, I realize that is easy to make a wrapper (design pattern Proxy), that wrap some methods.</p>\n\n<p>Situation is bit complicated, when you don't want loose an interface, when wrapped object had it.</p>\n\n<p>In example example I've written how to optionally implement http.Flusher. But how to solve a situation from article, when w could implement some of 3 interfaces (http.Flusher, http.Hijacker, http.Pusher). Is it better solution, that write 8 different types, where each implements combination of previous?</p>\n\n<pre><code>// add type, that do what statusRecorder, but keeps ability to be Flusher\ntype statusRecordFlusher statusRecorder\n\nfunc (w *statusRecordFlusher) Flush() {\n    w.ResponseWriter.(http.Flusher).Flush()\n}\n\n// and decision, how to wrap\nfunc logware(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // Initialize the status to 200 in case WriteHeader is not called\n        var rec http.ResponseWriter\n        if _, ok := w.(http.Flusher); ok {\n            rec = &amp;statusRecordFlusher{w, 200}\n        } else {\n            rec = &amp;statusRecorder{w, 200}\n        }\n\n        next.ServeHTTP(rec, r)\n    })\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "testing", "go", "struct"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497447825, "post_id": 44546106, "comment_id": 76083706, "body": "You could simplify this somewhat by making recordedArgs a [][]interface{}, since you know every element is going to be a []interface{}. It saves you some unnecessary type assertion."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1497448168, "creation_date": 1497448168, "answer_id": 44546724, "question_id": 44546106, "link": "https://stackoverflow.com/questions/44546106/how-to-properly-mock-a-struct-with-member-functions-in-golang/44546724#44546724", "title": "How to properly mock a struct with member functions in Golang?", "body": "<p>If you're mocking out clients for HTTP APIs, you might want to just use <a href=\"https://golang.org/pkg/net/http/httptest/#Server\" rel=\"nofollow noreferrer\"><code>httptest.Server</code></a>, which would simplify this tremendously. Rather than mocking out the client, mock out the server the client connects to. It's really easy to use, and you can still record the request method, path, body, etc., as well as returning arbitrary response values the same way you're doing with the mock client.</p>\n\n<p>If that's not an option, you can abstract out your mock method to make it reusable:</p>\n\n<pre><code>type TestClient struct {\n     recordedArgs [][]interface{}\n     returnValues []interface{}\n}\n\nfunc (c *TestClient) mock(args ...interface{}) interface{} {\n    c.recordedArgs = append(c.recordedArgs, args)\n    if len(c.returnValues) != 0 {\n        last := c.returnValues[0]\n        c.returnValues = c.returnValues[1:]\n        return last\n    }\n    return nil\n}\n\nfunc (c *TestClient) Request(body io.Reader, method string, endpoint string, headers []Header) ([]byte, error) {\n    return c.mock(body,method,endpoint,headers).([]byte), nil\n}\n</code></pre>\n\n<p>This cuts your usage-specific method down to one line.</p>\n"}], "owner": {"reputation": 23, "user_id": 6092767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/defa5f7eb62ea467d0cd16988e0edcec?s=128&d=identicon&r=PG&f=1", "display_name": "capturcus", "link": "https://stackoverflow.com/users/6092767/capturcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1963, "favorite_count": 0, "accepted_answer_id": 44546724, "answer_count": 1, "score": 2, "last_activity_date": 1497448168, "creation_date": 1497446560, "question_id": 44546106, "link": "https://stackoverflow.com/questions/44546106/how-to-properly-mock-a-struct-with-member-functions-in-golang", "title": "How to properly mock a struct with member functions in Golang?", "body": "<p>I have two structs: <code>FunctionalityClient</code> and <code>TestClient</code>, both implementing  <code>Interface</code>. I have a global variable <code>Client</code> of type <code>Interface</code>. I assign to <code>Client</code> either the actual client, or the mock client, depending on whether it's a test or a normal run.</p>\n\n<p><code>Interface</code> has a method <code>Request</code> that I want to mock in tests. That is, I want to:</p>\n\n<ul>\n<li>record what were the argument passed to the function</li>\n<li>return some arbitrarily defined return value from the function</li>\n</ul>\n\n<p>So the struct looks like this:</p>\n\n<pre><code>type TestClient struct {\n     recordedArgs []interface{}\n     returnValues []interface{}\n}\nfunc (c *TestClient) Request(body io.Reader, method string, endpoint string, headers []Header) ([]byte, error) {\n    c.recordedArgs = append(c.recordedArgs, []interface{}{body, method, endpoint, headers})  // this can't be typed if I want the code to be reusable\n        if len(c.returnValues) != 0 {\n        last := c.returnValues[0]\n        c.returnValues = c.returnValues[1:]\n        return last.([]byte), nil\n    }\n    return nil, nil\n}\n</code></pre>\n\n<p>And I use it like so:</p>\n\n<pre><code>testClient := TestClient{\n    returnValues: []interface{}{\n        []byte(\"arbitrarily defined return value\"),\n        []byte(\"this will be returned after calling Request a second time\"),\n    }\n}\nClient = &amp;testClient\n// run the test\n// now let's check the results\nr1 := testClient.recordedArgs[1].([]interface{})  // because I append untyped lists to recordedArgs\nassert.Equal(t, \"POST\", r1[1].(string))\nassert.Equal(t, \"/file\", r1[2].(string))\n// and so on\n</code></pre>\n\n<p><strong>Now the question.</strong></p>\n\n<p>I have a few structs that I want to mock like this. Currently I just copy and paste the code above for each struct. But that really sucks, I would like the mock logic to be abstracted away somehow. I would also accept something like Mockito's <code>when</code>: when the mocked function is called with specific arguments, return a specific value and record the call.</p>\n\n<p>How can I properly mock a struct with member functions in Golang?</p>\n"}, {"tags": ["pointers", "go", "methods", "struct"], "answers": [{"comments": [{"owner": {"reputation": 11794, "user_id": 1911432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f356ebb1b2eb81dcfa42974d4f2d308?s=128&d=identicon&r=PG", "display_name": "hunterloftis", "link": "https://stackoverflow.com/users/1911432/hunterloftis"}, "edited": false, "score": 0, "creation_date": 1497465225, "post_id": 44543748, "comment_id": 76094963, "body": "Thanks, that makes perfect sense.  Is it correct that the options are 1) don&#39;t do that (assign first, then address) or 2) use a value receiver? What are the tradeoffs if I decide to go with option 2? (given that the Vector3 struct is only 3 float64s, value copy time isn&#39;t a huge deal, are there other downsides I&#39;m not thinking of?)"}, {"owner": {"reputation": 1261, "user_id": 5405093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-w8jn4kVX0To/AAAAAAAAAAI/AAAAAAAAMwc/8j2h2xb8ncw/photo.jpg?sz=128", "display_name": "Manoj Suthar", "link": "https://stackoverflow.com/users/5405093/manoj-suthar"}, "edited": false, "score": 0, "creation_date": 1569561147, "post_id": 44543748, "comment_id": 102643667, "body": "Nice answer @icza. But why does assigning to a variable work and chaining does not? I understand that variables are addressable, but wouldn&#39;t it be better if return values were also addressed automatically for easier chaining?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1261, "user_id": 5405093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-w8jn4kVX0To/AAAAAAAAAAI/AAAAAAAAMwc/8j2h2xb8ncw/photo.jpg?sz=128", "display_name": "Manoj Suthar", "link": "https://stackoverflow.com/users/5405093/manoj-suthar"}, "edited": false, "score": 0, "creation_date": 1569577292, "post_id": 44543748, "comment_id": 102650743, "body": "@ManojSuthar Yes, it would be convenient in some cases, but it would restrict the hands of the compiler. See <a href=\"https://stackoverflow.com/questions/34197248/how-can-i-store-reference-to-the-result-of-an-operation-in-go/34197367#34197367\">How can I store reference to the result of an operation in Go?</a> Return values may not have a permanent address. If it would be allowed to take the address of the return values, that would require to allocate memory for the return values on the heap, which is of course less efficient."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 32, "last_activity_date": 1497470054, "last_edit_date": 1497470054, "creation_date": 1497440384, "answer_id": 44543748, "question_id": 44543374, "link": "https://stackoverflow.com/questions/44543374/cannot-take-the-address-of-and-cannot-call-pointer-method-on/44543748#44543748", "title": "&quot;cannot take the address of&quot; and &quot;cannot call pointer method on&quot;", "body": "<p>The <code>Vector3.Normalize()</code> method has a <em>pointer</em> receiver, so in order to call this method, a pointer to <code>Vector3</code> value is required (<code>*Vector3</code>). In your first example you store the return value of <code>Vector3.Minus()</code> in a variable, which will be of type <code>Vector3</code>.</p>\n\n<p>Variables in Go are addressable, and when you write <code>diff.Normalize()</code>, this is a shortcut, and the compiler will automatically take the address of the <code>diff</code> variable to have the required receiver value of type <code>*Vector3</code> in order to call <code>Normalize()</code>. So the compiler will \"transform\" it to</p>\n\n<pre><code>(&amp;diff).Normalize()\n</code></pre>\n\n<p>This is detailed in <a href=\"https://golang.org/ref/spec#Calls\" rel=\"noreferrer\">Spec: Calls:</a></p>\n\n<blockquote>\n  <p>A method call <code>x.m()</code> is valid if the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"noreferrer\">method set</a> of (the type of) <code>x</code> contains <code>m</code> and the argument list can be assigned to the parameter list of <code>m</code>. If <code>x</code> is <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"noreferrer\">addressable</a> and <code>&amp;x</code>'s method set contains <code>m</code>, <code>x.m()</code> is shorthand for <code>(&amp;x).m()</code>.</p>\n</blockquote>\n\n<p>The reason why your second example doesn't work is because return values of function and method calls are <strong>not addressable</strong>, so the compiler is not able to do the same here, the compiler is not able to take the address of the return value of the <code>Vector3.Minus()</code> call.</p>\n\n<p>What is addressable is exactly listed in the <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"noreferrer\">Spec: Address operators:</a></p>\n\n<blockquote>\n  <p>The operand must be <em>addressable</em>, that is, either a variable, pointer indirection, or slice indexing operation; or a field selector of an addressable struct operand; or an array indexing operation of an addressable array. As an exception to the addressability requirement, <code>x</code> [in the expression of <code>&amp;x</code>] may also be a (possibly parenthesized) <a href=\"http://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literal</a>.</p>\n</blockquote>\n\n<p>See related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30744965/how-to-get-the-pointer-of-return-value-from-function-call/30751102#30751102\">How to get the pointer of return value from function call?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/34197248/how-can-i-store-reference-to-the-result-of-an-operation-in-go/34197367#34197367\">How can I store reference to the result of an operation in Go?</a></p>\n\n<h3>Possible \"workarounds\"</h3>\n\n<p>\"Easiest\" (requiring the least change) is simply to assign to a variable, and call the method after that. This is your first working solution.</p>\n\n<p>Another way is to modify the methods to have a value receiver (instead of pointer receiver), so that there is no need to take the address of the return values of the methods, so calls can be \"chained\". Note that this might not be viable if a method needs to modify the receiver, as that is only possible if it is a pointer (as the receiver is passed just like any other parameters \u2013 by making a copy \u2013, and if it's not a pointer, you could only modify the copy).</p>\n\n<p>Another way is to modify the return values to return pointers (<code>*Vector3</code>) instead of <code>Vector3</code>. If the return value is already a pointer, no need to take its address as it's good as-is for the receiver to a method that requires a pointer receiver.</p>\n\n<p>You may also create a simple helper function which returns its address. It could look something like this:</p>\n\n<pre><code>func pv(v Vector3) *Vector3 {\n    return &amp;v\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>dir := pv(projected.Minus(c.Origin)).Normalize()\n</code></pre>\n\n<p>This could also be a method of <code>Vector3</code>, e.g.:</p>\n\n<pre><code>func (v Vector3) pv() *Vector3 {\n    return &amp;v\n}\n</code></pre>\n\n<p>And then using it:</p>\n\n<pre><code>dir := projected.Minus(c.Origin).pv().Normalize()\n</code></pre>\n\n<p><strong>Some notes:</strong></p>\n\n<p>If your type consists of 3 <code>float64</code> values only, you should not see significant performance differences. But you should be consistent about your receiver and result types. If most of your methods have pointer receivers, so should all of them. If most of your methods return pointers, so should all of them.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 12837963, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mt5UQ2ZPJ9A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfjLv10dcro3hFq217F54Yysarqgg/photo.jpg?sz=128", "display_name": "VitalyGo877", "link": "https://stackoverflow.com/users/12837963/vitalygo877"}, "is_accepted": false, "score": 0, "last_activity_date": 1580810583, "last_edit_date": 1580810583, "creation_date": 1580808176, "answer_id": 60054196, "question_id": 44543374, "link": "https://stackoverflow.com/questions/44543374/cannot-take-the-address-of-and-cannot-call-pointer-method-on/60054196#60054196", "title": "&quot;cannot take the address of&quot; and &quot;cannot call pointer method on&quot;", "body": "<p>The accepted answer is really long so I'm just going to post what helped me:</p>\n\n<p>I got this error regarding this line:</p>\n\n<pre><code>services.HashingServices{}.Hash(\"blabla\")\n</code></pre>\n\n<p>so I just changed it to:</p>\n\n<pre><code>(&amp;services.HashingServices{}).Hash(\"blabla\")\n</code></pre>\n"}], "owner": {"reputation": 11794, "user_id": 1911432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f356ebb1b2eb81dcfa42974d4f2d308?s=128&d=identicon&r=PG", "display_name": "hunterloftis", "link": "https://stackoverflow.com/users/1911432/hunterloftis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15999, "favorite_count": 5, "accepted_answer_id": 44543748, "answer_count": 2, "score": 20, "last_activity_date": 1580810583, "creation_date": 1497439364, "last_edit_date": 1497455910, "question_id": 44543374, "link": "https://stackoverflow.com/questions/44543374/cannot-take-the-address-of-and-cannot-call-pointer-method-on", "title": "&quot;cannot take the address of&quot; and &quot;cannot call pointer method on&quot;", "body": "<p>This compiles and works:</p>\n\n<pre><code>diff := projected.Minus(c.Origin)\ndir := diff.Normalize()\n</code></pre>\n\n<p>This does not (yields the errors in the title):</p>\n\n<pre><code>dir := projected.Minus(c.Origin).Normalize()\n</code></pre>\n\n<p>Can someone help me understand why? (learning Go)</p>\n\n<p>Here are those methods:</p>\n\n<pre><code>// Minus subtracts another vector from this one\nfunc (a *Vector3) Minus(b Vector3) Vector3 {\n    return Vector3{a.X - b.X, a.Y - b.Y, a.Z - b.Z}\n}\n\n// Normalize makes the vector of length 1\nfunc (a *Vector3) Normalize() Vector3 {\n    d := a.Length()\n    return Vector3{a.X / d, a.Y / d, a.Z / d}\n}\n</code></pre>\n"}, {"tags": ["go", "raspberry-pi3", "gpio"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497438390, "post_id": 44542702, "comment_id": 76076408, "body": "How if you remove <code>fmt.Print</code> and other similar function (instead, write the data to a buffer etc.)? It may take some times and may affect the timing. Also add <code>default</code> to the select."}, {"owner": {"reputation": 11467, "user_id": 741404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/28832e0d64ab5e5b21c9a78c02d8aefc?s=128&d=identicon&r=PG", "display_name": "jdevelop", "link": "https://stackoverflow.com/users/741404/jdevelop"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497439047, "post_id": 44542702, "comment_id": 76076905, "body": "the timing is not the problem - the function in <code>BeginWatch</code> is never being invoked after the first write to the pin 21. I also tried the very same code w/o any write in the go code - started it and then <code>echo 1 &gt; &#47;sys&#47;class&#47;gpio&#47;gpio21&#47;value</code>. Before than the function on pin 17 is invoked couple of times per second (due to some noise), after - not invoked at all."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497488163, "post_id": 44542702, "comment_id": 76104083, "body": "Then your code looks ok, except we don&#39;t know how you implement <code>ReadBit&#47;WriteBit</code> and don&#39;t find a line/statement which prevents the application to exit before all the incoming data has been read. The above code will exit as soon as <code>frame.WriteFrame</code> being executed, and probably the data not yet arrived at receiving buffer. If this is not the problem, then you can try to attach interrupt to other pin (not GPIO17). Make sure the internal pull-up is activated, so the input pin is not floating. Sometimes, replacing the board may works."}, {"owner": {"reputation": 11467, "user_id": 741404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/28832e0d64ab5e5b21c9a78c02d8aefc?s=128&d=identicon&r=PG", "display_name": "jdevelop", "link": "https://stackoverflow.com/users/741404/jdevelop"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497576759, "post_id": 44542702, "comment_id": 76147562, "body": "the problem was in the logger - i have missed the <code>default</code> statement to intercept no status, and it went stuck at this point."}], "owner": {"reputation": 11467, "user_id": 741404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/28832e0d64ab5e5b21c9a78c02d8aefc?s=128&d=identicon&r=PG", "display_name": "jdevelop", "link": "https://stackoverflow.com/users/741404/jdevelop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 677, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1497437508, "creation_date": 1497437508, "question_id": 44542702, "link": "https://stackoverflow.com/questions/44542702/raspberry-pi-gpio-and-irq-processing", "title": "Raspberry Pi GPIO and IRQ processing", "body": "<p>I am experimenting with the implementation of the manchester protocol for a 433 mhz transceiver. So I wrote a simple program that uses 2 pins - one for sending, another one for receiving the signal. The receiver part uses IRQ to intercept the edge change on the pin, and read its value to pass down to the manchester decoder. So far it looks good, in theory and tests, but in reality as soon as I start writing some data to the <strong>transmitter</strong> pin - the interrupt watcher on the <strong>receiver</strong> pin stops working. I use the same board for connecting the transmitter and the receiver parts.</p>\n\n<p>I created some simple program to simply watch on the edge changes - and it intercepts the changes just fine, unless you use mem (wiringpi gpio) or sysfs to write a value to another pin. At this point the interrupts stop to happen.</p>\n\n<p>Am I missing something?</p>\n\n<p>Below is the original sample that uses GPIO 17 for reading and watching the edge change, and GPIO 21 for transmitting the signal.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/jdevelop/go-manchester/manchester\"\n    \"github.com/davecheney/gpio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc receive(bps int) {\n    pin, err := gpio.OpenPin(17, gpio.ModeInput)\n    if err != nil {\n        panic(err)\n    }\n\n    frame := manchester.NewDataFrame()\n    driver := manchester.NewManchesterDriver(int64(bps), 1000000)\n\n\n\n    if err = pin.BeginWatch(gpio.EdgeBoth, func() {\n        driver.ReadBit(manchester.Up, time.Now().UnixNano(), func(bool) {\n            val := pin.Get()\n            println(val)\n            if frame.ReadBit(val) {\n                println(\"DONE\")\n            }\n        })\n    }); err != nil {\n        panic(err)\n    }\n\n    defer pin.EndWatch()\n    defer pin.Close()\n\n    time.Sleep(10 * time.Second)\n\n    fmt.Println(frame)\n\n}\n\nfunc main() {\n\n    text := os.Args[2]\n    bps, _ := strconv.Atoi(os.Args[1])\n\n    driver := manchester.NewManchesterDriver(int64(bps), 100)\n    frame := manchester.BuildDataFrame([]byte(text))\n\n    pin, _ := gpio.OpenPin(21, gpio.ModeOutput)\n    pin.Clear()\n\n    defer pin.Close()\n\n    logger := make(chan bool, 100)\n\n    loggerF := func() {\n        for {\n            select {\n            case lvl := &lt;-logger:\n                if lvl {\n                    fmt.Print(1)\n                } else {\n                    fmt.Print(0)\n                }\n            }\n        }\n    }\n\n    signal := func(level bool) {\n        if level {\n            pin.Set()\n        } else {\n            pin.Clear()\n        }\n    }\n\n    go loggerF()\n    go receive(bps)\n\n    frame.WriteFrame(func(bit bool) {\n        logger &lt;- bit\n        driver.WriteBit(bit, signal)\n    })\n\n    pin.Clear()\n\n    fmt.Println()\n    fmt.Println(\"Done\")\n\n}\n</code></pre>\n"}, {"tags": ["string", "go", "casting", "integer"], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 14, "last_activity_date": 1553169329, "last_edit_date": 1553169329, "creation_date": 1497430593, "answer_id": 44540053, "question_id": 44539789, "link": "https://stackoverflow.com/questions/44539789/how-to-convert-number-int-or-float64-to-string-in-golang/44540053#44540053", "title": "How to convert number (int or float64) to string in Golang", "body": "<p>You may use <code>fmt.Sprint</code></p>\n\n<p><code>fmt.Sprint</code> returns string format of any variable passed to it</p>\n\n<p><strong>Sample</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    f := fmt.Sprint(5.03)\n    i := fmt.Sprint(5)\n    fmt.Println(\"float:\",f,\"\\nint:\",i)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/8ZgjjO2k3X\" rel=\"noreferrer\">play link</a></p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 4186443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uqu0j1kHoY0/AAAAAAAAAAI/AAAAAAAAAD8/u8ud-2ebIOQ/photo.jpg?sz=128", "display_name": "Federico", "link": "https://stackoverflow.com/users/4186443/federico"}, "is_accepted": false, "score": 1, "last_activity_date": 1497430602, "creation_date": 1497430602, "answer_id": 44540055, "question_id": 44539789, "link": "https://stackoverflow.com/questions/44539789/how-to-convert-number-int-or-float64-to-string-in-golang/44540055#44540055", "title": "How to convert number (int or float64) to string in Golang", "body": "<p>If you don't know what type the number you need to convert to string will be, you can just use <code>fmt.Sprintf</code> with the <code>%v</code> verb:</p>\n\n<pre><code>fmt.Sprintf(\"%v\", 1.23) // \"1.23\"\nfmt.Sprintf(\"%v\", 5) // \"5\"\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 7408740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/df389f51a248ce0d5e1d8ad146510ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Wulthan", "link": "https://stackoverflow.com/users/7408740/wulthan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11561, "favorite_count": 1, "accepted_answer_id": 44540053, "answer_count": 2, "score": 4, "last_activity_date": 1553169329, "creation_date": 1497429900, "question_id": 44539789, "link": "https://stackoverflow.com/questions/44539789/how-to-convert-number-int-or-float64-to-string-in-golang", "title": "How to convert number (int or float64) to string in Golang", "body": "<p>How do I convert any given number which can be a int or float64 to string ?</p>\n\n<p>Using strconv.FormatFloat or FormatInt I have to specify that the given number is a float or integer.\nIn my case it is unknown what I get.</p>\n\n<p>Behaviour:</p>\n\n<p>When I get a <code>5</code> it should be converted into <code>\"5\"</code> and not <code>\"5.00\"</code></p>\n\n<p>When I get a <code>1.23</code> it should be converted into <code>\"1.23\"</code> and not <code>\"1\"</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1497428771, "post_id": 44539107, "comment_id": 76069396, "body": "What is the intention behind the <code>select</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 74019, "user_id": 292291, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e31d9d39e9fb0ec4cc5573a5e5b01ce7?s=128&d=identicon&r=PG", "display_name": "Jiew Meng", "link": "https://stackoverflow.com/users/292291/jiew-meng"}, "edited": false, "score": 0, "creation_date": 1497435399, "post_id": 44539590, "comment_id": 76074217, "body": "I didn&#39;t expect it but you are right. The <code>hub.Broadcast</code> is blocking because I did not run <code>Hub.run()</code> to drain items from the channel."}], "tags": [], "owner": {"reputation": 76, "user_id": 4186443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uqu0j1kHoY0/AAAAAAAAAAI/AAAAAAAAAD8/u8ud-2ebIOQ/photo.jpg?sz=128", "display_name": "Federico", "link": "https://stackoverflow.com/users/4186443/federico"}, "is_accepted": true, "score": 1, "last_activity_date": 1497429402, "creation_date": 1497429402, "answer_id": 44539590, "question_id": 44539107, "link": "https://stackoverflow.com/questions/44539107/golang-running-something-every-few-seconds-with-ticker/44539590#44539590", "title": "Golang: Running something every few seconds with Ticker", "body": "<p>Given that it's not known the implementation of <code>hub</code>, sending messages to the <code>hub.Broadcast</code> channel is blocking, therefore if nobody is consuming messages from it it will wait, preventing the loop to continue.</p>\n"}], "owner": {"reputation": 74019, "user_id": 292291, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e31d9d39e9fb0ec4cc5573a5e5b01ce7?s=128&d=identicon&r=PG", "display_name": "Jiew Meng", "link": "https://stackoverflow.com/users/292291/jiew-meng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 44539590, "answer_count": 1, "score": 1, "last_activity_date": 1497429406, "creation_date": 1497427945, "question_id": 44539107, "link": "https://stackoverflow.com/questions/44539107/golang-running-something-every-few-seconds-with-ticker", "title": "Golang: Running something every few seconds with Ticker", "body": "<p>I want to run something (update clients via websocket) every few seconds. I think I should use <code>time.Ticker</code>. But how do I get it to work? I have the below but its not working ... </p>\n\n<pre><code>func main() {\n    hub = NewAppSocketHub()\n\n    ticker := time.NewTicker(time.Second)\n    go func() {\n        for {\n            log.Printf(\"In loop\")\n            select {\n            case &lt;-ticker.C:\n                log.Printf(\"Broadcasting to %d clients\", len(hub.Clients))\n                hub.Broadcast &lt;- UpdatePayload{\n                    InstanceID: \"Test\",\n                    Status:     \"running\",\n                }\n            }\n        }\n        log.Printf(\"Out of loop\")\n    }()\n\n    r := chi.NewRouter()\n    r.Use(render.SetContentType(render.ContentTypeJSON))\n    r.Use(Cors)\n\n    r.Post(\"/auth/login\", Login)\n    r.HandleFunc(\"/ws\", WebSocketEcho)\n    // ...\n\n    http.ListenAndServe(\":9000\", r)\n    log.Printf(\"Ended...\")\n}\n</code></pre>\n\n<p>I think you can ignore <code>NewAppSocketHub</code> and other app specific implementation. The problem I have currently is I get </p>\n\n<pre><code>2017/06/14 16:08:05 In loop\n2017/06/14 16:08:06 Broadcasting to 0 clients\n</code></pre>\n\n<p>And it seem the loop breaks? Whats wrong? </p>\n"}, {"tags": ["google-app-engine", "memory", "go", "sizeof"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1497440831, "last_edit_date": 1497440831, "creation_date": 1497439477, "answer_id": 44543414, "question_id": 44536740, "link": "https://stackoverflow.com/questions/44536740/getting-size-of-a-structure-in-gae-go/44543414#44543414", "title": "Getting size of a structure in GAE/Go", "body": "<p>Your proposed solution is not valid code, it has multiple errors.</p>\n\n<p>For example <code>GetSize()</code> has no result type, so you couldn't return anything.</p>\n\n<p>Next, the expression you return is also a syntax error, it attempts to convert an <code>*int</code> pointer to <code>int</code> which is not valid.</p>\n\n<p>You need to dereference the pointer first, so the correct syntax would be:</p>\n\n<pre><code>func GetSize(T interface{}) int {\n    size := reflect.TypeOf(T).Size()\n    return int(*(*int)(unsafe.Pointer(size)))\n}\n</code></pre>\n\n<p><strong>But.</strong> It makes no sense. <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>reflect.Type.Size()</code></a> already returns the size (the number of bytes needed to store a value of the given type), so there is no need of that <code>unsafe</code> magic. What may be confusing is that its return type is <code>uintptr</code>, but you may simply use that value after converting it to <code>int</code> for example.</p>\n\n<p>Simply use:</p>\n\n<pre><code>func GetSize(v interface{}) int {\n    return int(reflect.TypeOf(v).Size())\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>fmt.Println(\"Size of int:\", GetSize(int(0)))\nfmt.Println(\"Size of int64:\", GetSize(int64(0)))\nfmt.Println(\"Size of [100]byte:\", GetSize([100]byte{}))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/vaKGKyMuFp\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Size of int: 4\nSize of int64: 8\nSize of [100]byte: 100\n</code></pre>\n\n<p>One thing you must not forget: this <code>GetSize()</code> will not recurisvely examine the size of the passed value. So for example if it's a struct with a pointer field, it will not \"count\" the size of the pointed value, only the size of the pointer field.</p>\n\n<p>Constructing a <code>GetSize()</code> that recurisvely counts the total size of a complex data structure is non-trivial due to types like <code>map</code>. For details, see <a href=\"https://stackoverflow.com/questions/44257522/how-to-get-variable-memory-size-of-variable-in-golang/44258164#44258164\">How to get variable memory size of variable in golang?</a></p>\n"}], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 44543414, "answer_count": 1, "score": 1, "last_activity_date": 1497440831, "creation_date": 1497420516, "last_edit_date": 1497439860, "question_id": 44536740, "link": "https://stackoverflow.com/questions/44536740/getting-size-of-a-structure-in-gae-go", "title": "Getting size of a structure in GAE/Go", "body": "<p>I would like to get the size of a structure in GAE/Go.</p>\n\n<p>I read <a href=\"https://stackoverflow.com/questions/31338588/generic-function-to-get-size-of-any-structure-in-golang\">this</a> post and wrote the code as below.</p>\n\n<pre><code>import (\n    \"reflect\"\n    \"unsafe\"\n)\n\nfunc GetSize(T interface{}) {\n    size := reflect.TypeOf(T).Size()\n    return int((*int)(unsafe.Pointer(size)))\n}\n</code></pre>\n\n<p>But this code does not work because GAE does not allow to import <code>unsafe</code>.</p>\n\n<p>How can I do this in GAE/Go?</p>\n"}, {"tags": ["go", "nested", "go-templates"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1497426156, "post_id": 44536284, "comment_id": 76067702, "body": "I hope you mean <code>http.HandleFunc</code>, not <a href=\"https://www.youtube.com/watch?v=71NCzuDNUcg\" rel=\"nofollow noreferrer\"><code>http.HandelFunc</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8157095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rv8C01bznnU/AAAAAAAAAAI/AAAAAAAAG6s/IY45t5y9PG8/photo.jpg?sz=128", "display_name": "aircandyman", "link": "https://stackoverflow.com/users/8157095/aircandyman"}, "edited": false, "score": 0, "creation_date": 1497429461, "post_id": 44536682, "comment_id": 76069840, "body": "hey, thanks for the answer I&#39;ve only been using Go for about 4 weeks so pretty new. I tried out your solution but still got the same 404 error.."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 11, "user_id": 8157095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rv8C01bznnU/AAAAAAAAAAI/AAAAAAAAG6s/IY45t5y9PG8/photo.jpg?sz=128", "display_name": "aircandyman", "link": "https://stackoverflow.com/users/8157095/aircandyman"}, "edited": false, "score": 0, "creation_date": 1497455694, "post_id": 44536682, "comment_id": 76089558, "body": "For 404, it&#39;s surely your router assignment/creation issue. Can you put your code on play.golang.org and share it? I will have a look."}, {"owner": {"reputation": 11, "user_id": 8157095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rv8C01bznnU/AAAAAAAAAAI/AAAAAAAAG6s/IY45t5y9PG8/photo.jpg?sz=128", "display_name": "aircandyman", "link": "https://stackoverflow.com/users/8157095/aircandyman"}, "edited": false, "score": 0, "creation_date": 1497563339, "post_id": 44536682, "comment_id": 76143876, "body": "Hay, it&#39;s here. I&#39;ve been playing with it so i&#39;ve commented some stuff out. <a href=\"https://play.golang.org/p/iHUqZQQcv3\" rel=\"nofollow noreferrer\">play.golang.org/p/iHUqZQQcv3</a>"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 0, "last_activity_date": 1497566548, "last_edit_date": 1497566548, "creation_date": 1497420285, "answer_id": 44536682, "question_id": 44536284, "link": "https://stackoverflow.com/questions/44536284/golang-templates-not-working-with-httprouter/44536682#44536682", "title": "golang templates not working with httprouter", "body": "<p><strong>Revising after the comment response</strong>. I had a look <a href=\"https://play.golang.org/p/iHUqZQQcv3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iHUqZQQcv3</a></p>\n\n<p>You have following issues:</p>\n\n<ol>\n<li>Router handler register issue <code>r.GET(\"/tstats/\", serveTemplate)</code> - It will only match <code>http://localhost:8080/tstats/</code> rest everything is <code>404</code>\n\n<ul>\n<li>For e.g.: 404 -> <code>http://localhost:8080/tstats/myfile1.html</code></li>\n</ul></li>\n<li>The way you calculate the template path file <code>filepath.Join(\"templates\", filepath.Clean(r.URL.Path))</code></li>\n</ol>\n\n<p>Honestly it is very hard to guess, how you're planning/designing your application. Anyway-</p>\n\n<p>Update your code like below:</p>\n\n<ul>\n<li>Change <code>/tstats/</code> => <code>/tstats/*tmpl</code> in the router mapping</li>\n<li>Change <code>fp := filepath.Join(\"templates\", filepath.Clean(r.URL.Path))</code> => <code>fp := filepath.Join(\"templates\", \"tstats\", params.ByName(\"tmpl\"))</code></li>\n</ul>\n\n<p>Now, for the request <a href=\"http://localhost:8080/tstats/myfile1.html\" rel=\"nofollow noreferrer\">http://localhost:8080/tstats/myfile1.html</a>. It will look for template here <code>templates/tstats/myfile1.html</code>.</p>\n\n<hr>\n\n<p><strong>(This was initial response)</strong></p>\n\n<p>It seems like <code>HandlerFunc</code> register issue that leading to 404.</p>\n\n<p>I have created sample from your code, can you try <a href=\"https://play.golang.org/p/6ilS0htj-I\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6ilS0htj-I</a></p>\n\n<p>BTW, I believe; in your first sample code <code>tpl</code> variable in the <code>func init</code> is not used. Since you have local variable of same name in the <code>serveTemplate</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 8157095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rv8C01bznnU/AAAAAAAAAAI/AAAAAAAAG6s/IY45t5y9PG8/photo.jpg?sz=128", "display_name": "aircandyman", "link": "https://stackoverflow.com/users/8157095/aircandyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 1, "accepted_answer_id": 44536682, "answer_count": 1, "score": 0, "last_activity_date": 1497588167, "creation_date": 1497418771, "last_edit_date": 1497588167, "question_id": 44536284, "link": "https://stackoverflow.com/questions/44536284/golang-templates-not-working-with-httprouter", "title": "golang templates not working with httprouter", "body": "<p>I've created nested templating that works when I use \"net/http\" and http.HandelFunc , however, I've decided to use     \"github.com/julienschmidt/httprouter\" going forward as I want to have move flexibility and now my templates don't work, I get a 404 error.</p>\n\n<p>Please, can you help?</p>\n\n<p><strong>Directory structure</strong></p>\n\n<pre><code>/\n/main.go\n/templates\n/templates/tstats/file.go.html\n</code></pre>\n\n<p><strong>This code works</strong></p>\n\n<pre><code>func init() {\n    tpl = template.Must(template.ParseGlob(\"templates/*.go.html\"))\n}\nhttp.HandleFunc(\"/tstats/\", serveTemplate)\n\nfunc serveTemplate(w http.ResponseWriter, r *http.Request) {\n    lp := filepath.Join(\"templates\", \"layout.html\")\n    fp := filepath.Join(\"templates\", filepath.Clean(r.URL.Path))\n    gh := filepath.Join(\"templates\", \"INC_Header.go.html\")\n    gn := filepath.Join(\"templates\", \"INC_Nav.go.html\")\n    gf := filepath.Join(\"templates\", \"INC_Footer.go.html\")\n    //log.Println(r.URL.Path)\n\ntpl, err := template.ParseFiles(lp, fp, gh, gn, gf)\nif err := tpl.ExecuteTemplate(w, \"layout\", nil); err != nil {\n    log.Println(err.Error())\n    http.Error(w, http.StatusText(500), 500)\n}\n</code></pre>\n\n<p><strong>The new code that is producing a 404</strong> </p>\n\n<pre><code>func serveTemplate(w http.ResponseWriter, r *http.Request, _ \n    httprouter.Params) {\n    lp := filepath.Join(\"templates\", \"layout.html\")\n    fp := filepath.Join(\"templates\", filepath.Clean(r.URL.Path))\n    gh := filepath.Join(\"templates\", \"INC_Header.go.html\")\n    gn := filepath.Join(\"templates\", \"INC_Nav.go.html\")\n    gf := filepath.Join(\"templates\", \"INC_Footer.go.html\")\n    //log.Println(`enter code here`r.URL.Path)\n\n    tmpl, err := template.ParseFiles(lp, fp, gh, gn, gf)\n    if err := tmpl.ExecuteTemplate(w, \"layout\", nil); err != nil {\n        log.Println(err.Error())\n        http.Error(w, http.StatusText(500), 500)\n   }\n</code></pre>\n"}, {"tags": ["go", "random", "time", "sleep"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1497428178, "post_id": 44536045, "comment_id": 76069023, "body": "Related: <a href=\"https://stackoverflow.com/questions/41503758/conversion-of-time-duration-type-microseconds-value-to-milliseconds-in-golang/41503910#41503910\">conversion of time.Duration type microseconds value to milliseconds in golang</a>."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1568189742, "post_id": 44536045, "comment_id": 102192124, "body": "<a href=\"https://stackoverflow.com/q/17573190/86967\">How to multiply duration by integer?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 1644554, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/61d8fce781fc3f25dcbc232f86958d23?s=128&d=identicon&r=PG", "display_name": "Dmytro Bogatov", "link": "https://stackoverflow.com/users/1644554/dmytro-bogatov"}, "edited": false, "score": 0, "creation_date": 1537413957, "post_id": 44536061, "comment_id": 91777410, "body": "int64 or uint64 ?"}, {"owner": {"reputation": 442, "user_id": 2666708, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001247574760/picture?type=large", "display_name": "Prateek Bhuwania", "link": "https://stackoverflow.com/users/2666708/prateek-bhuwania"}, "reply_to_user": {"reputation": 613, "user_id": 1644554, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/61d8fce781fc3f25dcbc232f86958d23?s=128&d=identicon&r=PG", "display_name": "Dmytro Bogatov", "link": "https://stackoverflow.com/users/1644554/dmytro-bogatov"}, "edited": false, "score": 0, "creation_date": 1561358148, "post_id": 44536061, "comment_id": 100021195, "body": "<code>time.Sleep((rand.Int63n(10)) * time.Second)</code> I tried to pass in int64, but even that doesn&#39;t work. @DmytroBogatov is probably correct."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 442, "user_id": 2666708, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001247574760/picture?type=large", "display_name": "Prateek Bhuwania", "link": "https://stackoverflow.com/users/2666708/prateek-bhuwania"}, "edited": false, "score": 0, "creation_date": 1561376608, "post_id": 44536061, "comment_id": 100030377, "body": "@PrateekBhuwania try <code>time.Sleep(time.Duration(rand.Int63n(10))*time.Second)</code>. There is no automatic type casting in Go. As for my answer it is still correct: <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#Duration</a>"}, {"owner": {"reputation": 442, "user_id": 2666708, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001247574760/picture?type=large", "display_name": "Prateek Bhuwania", "link": "https://stackoverflow.com/users/2666708/prateek-bhuwania"}, "edited": false, "score": 0, "creation_date": 1561404715, "post_id": 44536061, "comment_id": 100044657, "body": "@abhink Yes, your solution is correct. I was just wondering if <code>time.Second</code> is an <code>int64</code> and <code>rand.Int63n()</code> also returns an <code>int64</code>, then why is there a type mismatch during multiplication ?"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 40, "last_activity_date": 1583435242, "last_edit_date": 1583435242, "creation_date": 1497417801, "answer_id": 44536061, "question_id": 44536045, "link": "https://stackoverflow.com/questions/44536045/how-to-implement-random-sleep-in-golang/44536061#44536061", "title": "How to implement Random sleep in golang", "body": "<p>Match the types of argument to <code>time.Sleep</code>:</p>\n\n<pre><code>r := rand.Intn(10)\ntime.Sleep(time.Duration(r) * time.Microsecond)\n</code></pre>\n\n<p>This works because <code>time.Duration</code> has <code>int64</code> as its underlying type:</p>\n\n<pre><code>type Duration int64\n</code></pre>\n\n<p>Docs: <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"noreferrer\">https://golang.org/pkg/time/#Duration</a></p>\n"}, {"tags": [], "owner": {"reputation": 1254, "user_id": 7786358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h1mWp.jpg?s=128&g=1", "display_name": "matson kepson", "link": "https://stackoverflow.com/users/7786358/matson-kepson"}, "is_accepted": false, "score": 3, "last_activity_date": 1592483949, "creation_date": 1592483949, "answer_id": 62450183, "question_id": 44536045, "link": "https://stackoverflow.com/questions/44536045/how-to-implement-random-sleep-in-golang/62450183#62450183", "title": "How to implement Random sleep in golang", "body": "<p>If you try to run same rand.Intn several times, you will see always the same number in output</p>\n\n<p>Just like its written in the official docu <a href=\"https://golang.org/pkg/math/rand/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/rand/</a> </p>\n\n<blockquote>\n  <p>Top-level functions, such as Float64 and Int, use a default shared Source that produces a deterministic sequence of values each time a program is run. Use the Seed function to initialize the default Source if different behavior is required for each run.</p>\n</blockquote>\n\n<p>It rather should look like </p>\n\n<pre><code>rand.Seed(time.Now().UnixNano())\nr := rand.Intn(100)\ntime.Sleep(time.Duration(r) * time.Millisecond)\n</code></pre>\n"}], "owner": {"reputation": 1614, "user_id": 3234481, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000276638043/picture?type=large", "display_name": "Ravichandra", "link": "https://stackoverflow.com/users/3234481/ravichandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17411, "favorite_count": 4, "accepted_answer_id": 44536061, "answer_count": 2, "score": 20, "last_activity_date": 1592483949, "creation_date": 1497417713, "question_id": 44536045, "link": "https://stackoverflow.com/questions/44536045/how-to-implement-random-sleep-in-golang", "title": "How to implement Random sleep in golang", "body": "<p>I am trying to implement random time sleep (in Golang)</p>\n\n<pre><code>r := rand.Intn(10)\ntime.Sleep(100 * time.Millisecond)  //working \ntime.Sleep(r * time.Microsecond)    // Not working (mismatched types int and time.Duration)\n</code></pre>\n"}, {"tags": ["function", "go", "wrapper"], "comments": [{"owner": {"reputation": 171, "user_id": 7422727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cab72d39be45e13173848b83a0640b?s=128&d=identicon&r=PG&f=1", "display_name": "xunatai", "link": "https://stackoverflow.com/users/7422727/xunatai"}, "edited": false, "score": 2, "creation_date": 1497413639, "post_id": 44535260, "comment_id": 76061651, "body": "The signatures of the functions passed as a parameter must match the signature of the function type of the parameter exactly. You&#39;ll have to rewrite the functions you pass to take <code>interface{}</code>&#39;s, and cast them to the appropriate types inside those functions."}, {"owner": {"reputation": 135, "user_id": 2705941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45240d9f4697e99dbc4ff5b102cbc413?s=128&d=identicon&r=PG&f=1", "display_name": "Kuzunoha", "link": "https://stackoverflow.com/users/2705941/kuzunoha"}, "reply_to_user": {"reputation": 171, "user_id": 7422727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cab72d39be45e13173848b83a0640b?s=128&d=identicon&r=PG&f=1", "display_name": "xunatai", "link": "https://stackoverflow.com/users/7422727/xunatai"}, "edited": false, "score": 0, "creation_date": 1497414356, "post_id": 44535260, "comment_id": 76061868, "body": "That way, for N functions, I need N wrappers. I need the general function wrapper to greatly simplify me code."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1497414390, "post_id": 44535260, "comment_id": 76061875, "body": "Yes. Or redesign."}], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 2, "last_activity_date": 1497417551, "creation_date": 1497417551, "answer_id": 44536004, "question_id": 44535260, "link": "https://stackoverflow.com/questions/44535260/pass-function-as-argument-in-go/44536004#44536004", "title": "Pass function as argument in Go", "body": "<p>A better way to solve your problem would be to use closures.</p>\n\n<p>For example, change the type of <code>retryer</code>:</p>\n\n<pre><code>func retryer(f func() error, maxRetry int, waitBetween time.Duration) error {\n    // retry and wait logic\n    err := f()\n    // error handling, retry, and wait logic\n    return err\n}\n</code></pre>\n\n<p>Now call functions to be retried as:</p>\n\n<pre><code>// ...\nclassId := \"some value\"\n// ...\n\nvar st []Student\nvar errors []error\nerr := retryer(func() error {\n    st, errors = GetTopStudent(classId)\n    // handle errors\n    return nil\n}, numTries, waitTime)\n// use st here\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 2705941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45240d9f4697e99dbc4ff5b102cbc413?s=128&d=identicon&r=PG&f=1", "display_name": "Kuzunoha", "link": "https://stackoverflow.com/users/2705941/kuzunoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3784, "favorite_count": 0, "accepted_answer_id": 44536004, "answer_count": 1, "score": -1, "last_activity_date": 1497417551, "creation_date": 1497413408, "question_id": 44535260, "link": "https://stackoverflow.com/questions/44535260/pass-function-as-argument-in-go", "title": "Pass function as argument in Go", "body": "<p>I've tried to create a function in Go that used to retry any fail query functions (usually because serialization issue).</p>\n\n<pre><code>func retryer(functionA func(interface{}) (interface{}, []error), maxRetry int, waitBetween time.Duration) interface{} {\n    //when no error in functionA, retryer returns whatever functionA returns\n    //when maxRetry is reached, returns nil\n}\n</code></pre>\n\n<p>The functions I want to retry are looked like this</p>\n\n<pre><code>func GetTopStudent(classId string) ([]Student, []error) {\n    //queries top 10 students for class with classId\n}\n\nfunc GetAverageStudentScores(classId string, from time.Time, until time.Time) ([]Pair, []error) {\n    //queries all average score using aggregate, grouping by studentId\n    //Pair behaves like C++ pair&lt;string,string&gt;\n}\n</code></pre>\n\n<p>But, the results is a compile error</p>\n\n<pre><code>cannot use GetTopStudent (type func(string) ([]Student, []error)) as type func(interface{}) (interface {}, []error) in argument to retryer\n</code></pre>\n\n<p>I've tried to modify it a little and I got another compile error</p>\n\n<pre><code>cannot use GetTopStudent (type func(string) ([]Student, []error)) as type func(string) (interface {}, []error) in argument to retryer\n</code></pre>\n\n<p>Can anyone help me creating a general function to wrap a function to retry on error?</p>\n"}, {"tags": ["go", "stripe-payments"], "comments": [{"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497414137, "post_id": 44535143, "comment_id": 76061795, "body": "What pointer is null? Can you share the error?"}, {"owner": {"reputation": 2119, "user_id": 4624236, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-YcZ9puA0zLE/AAAAAAAAAAI/AAAAAAAAAGU/5JSTNxNO9-A/photo.jpg?sz=128", "display_name": "Rutger Huijsmans", "link": "https://stackoverflow.com/users/4624236/rutger-huijsmans"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497414527, "post_id": 44535143, "comment_id": 76061908, "body": "Added logs, doesn&#39;t tell me much though"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497414943, "post_id": 44535143, "comment_id": 76062053, "body": "Then I guess it&#39;s up to you to add some <code>Println</code>s and figure out where the error happens?"}, {"owner": {"reputation": 2119, "user_id": 4624236, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-YcZ9puA0zLE/AAAAAAAAAAI/AAAAAAAAAGU/5JSTNxNO9-A/photo.jpg?sz=128", "display_name": "Rutger Huijsmans", "link": "https://stackoverflow.com/users/4624236/rutger-huijsmans"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497414991, "post_id": 44535143, "comment_id": 76062064, "body": "The error occurs when I put a Println around customer.DefaultSource.Card.Brand"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497415044, "post_id": 44535143, "comment_id": 76062089, "body": "So maybe <code>customer.DefaultSource</code> is <code>nil</code>? Or perhaps <code>customer.DefaultSource.Card</code>?"}, {"owner": {"reputation": 2119, "user_id": 4624236, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-YcZ9puA0zLE/AAAAAAAAAAI/AAAAAAAAAGU/5JSTNxNO9-A/photo.jpg?sz=128", "display_name": "Rutger Huijsmans", "link": "https://stackoverflow.com/users/4624236/rutger-huijsmans"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497415360, "post_id": 44535143, "comment_id": 76062197, "body": "Yea, that&#39;s what I don&#39;t get. How can they be empty? A Stripe customer gets created with a default card (default source) right?"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497415405, "post_id": 44535143, "comment_id": 76062221, "body": "Have you determined which value is <code>nil</code> yet?"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497415568, "post_id": 44535143, "comment_id": 76062278, "body": "What library are you using? Stripe&#39;s Go SDK doesn&#39;t seem to have <code>CreateUserID</code> in it."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497415702, "post_id": 44535143, "comment_id": 76062324, "body": "According to the Stripe documentation, <code>DefaultSource</code> is &quot;expandable,&quot; so it&#39;s only returned from the server if the client requests it. Maybe you&#39;re not asking Stripe to expand that field. (You&#39;d have to look at what the library you&#39;re using does.)"}, {"owner": {"reputation": 2119, "user_id": 4624236, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-YcZ9puA0zLE/AAAAAAAAAAI/AAAAAAAAAGU/5JSTNxNO9-A/photo.jpg?sz=128", "display_name": "Rutger Huijsmans", "link": "https://stackoverflow.com/users/4624236/rutger-huijsmans"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497418417, "post_id": 44535143, "comment_id": 76063360, "body": "CreateUserID is our own function. I added it to here as well."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497418597, "post_id": 44535143, "comment_id": 76063426, "body": "Try a <code>customerParams.Expand(&quot;default_source&quot;)</code> in <code>CreateUserID</code>?"}, {"owner": {"reputation": 2119, "user_id": 4624236, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-YcZ9puA0zLE/AAAAAAAAAAI/AAAAAAAAAGU/5JSTNxNO9-A/photo.jpg?sz=128", "display_name": "Rutger Huijsmans", "link": "https://stackoverflow.com/users/4624236/rutger-huijsmans"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497418796, "post_id": 44535143, "comment_id": 76063499, "body": "I&#39;ll try; adding it above the customerParams.SetSource(stripeToken)"}, {"owner": {"reputation": 2119, "user_id": 4624236, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-YcZ9puA0zLE/AAAAAAAAAAI/AAAAAAAAAGU/5JSTNxNO9-A/photo.jpg?sz=128", "display_name": "Rutger Huijsmans", "link": "https://stackoverflow.com/users/4624236/rutger-huijsmans"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1497419204, "post_id": 44535143, "comment_id": 76063678, "body": "YOU ARE CORRECT! That was exactly it. Please answer the question and I&#39;ll accept your answer as the right one."}], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 0, "last_activity_date": 1497419581, "creation_date": 1497419581, "answer_id": 44536480, "question_id": 44535143, "link": "https://stackoverflow.com/questions/44535143/cant-get-card-brand-from-stripe/44536480#44536480", "title": "Can&#39;t get card brand from Stripe", "body": "<p>Per <a href=\"https://stripe.com/docs/api#customer_object\" rel=\"nofollow noreferrer\">the Stripe documentation</a>, the <code>default_card</code> field is not expanded by default. You can expand it by adding this line to <code>CreateUserID</code>:</p>\n\n<pre><code>customerParams.Expand(\"default_source\")\n</code></pre>\n"}], "owner": {"reputation": 2119, "user_id": 4624236, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-YcZ9puA0zLE/AAAAAAAAAAI/AAAAAAAAAGU/5JSTNxNO9-A/photo.jpg?sz=128", "display_name": "Rutger Huijsmans", "link": "https://stackoverflow.com/users/4624236/rutger-huijsmans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 44536480, "answer_count": 1, "score": 0, "last_activity_date": 1497419581, "creation_date": 1497412540, "last_edit_date": 1497418370, "question_id": 44535143, "link": "https://stackoverflow.com/questions/44535143/cant-get-card-brand-from-stripe", "title": "Can&#39;t get card brand from Stripe", "body": "<pre><code>func (s *Service) CreateNewCreditCard(user *models.User, creditCardRequest *CreditCardRequest) (error) {\n\n    userID := string(user.ID)\n    customer, err := s.stripe_a.CreateUserID(creditCardRequest.StripeToken, userID)\n\n    if err != nil {\n        return err\n    }\n\n    //TO DO - NOT BEING FILLED WITH DATA --&gt; this needs to be added to the brand colom in the database\n    //customer.DefaultSource.Card.Brand\n\n    // Save to the DB\n    stripeCustomer := &amp;models.StripeCustomer{\n        UserID:         util.IntOrNull(int64(user.ID)),\n        CustomerID:     util.StringOrNull(customer.ID),\n        Last4:          util.StringOrNull(creditCardRequest.Last4),\n        Brand:          util.StringOrNull(\"VISA\"),\n    }\n    if err := s.db.Create(stripeCustomer).Error; err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>I'm trying to get the card's brand of the default card for the user that customer that I'm inserting into my database but this always lead to a crash because of a null pointer. </p>\n\n<p>I don't get why though. In the Stripe console the customer has a default card displaying \"VISA\" </p>\n\n<p>Added logs:</p>\n\n<pre><code>[2017-06-14 04:26:40]  [18.51ms]  SELECT * FROM \"orders\"  WHERE \"orders\".\"deleted_at\" IS NULL AND ((\"user_id\" IN ('2'))) ORDER BY \"orders\".\"id\" ASC\n2017/06/14 04:26:40 Requesting POST api.stripe.com/v1/customers\n2017/06/14 04:26:41 [C] [asm_amd64.s:514] the request url is  /v1/credit-cards\n2017/06/14 04:26:41 [C] [asm_amd64.s:514] Handler crashed with error runtime error: invalid memory address or nil pointer dereference\n2017/06/14 04:26:41 [C] [asm_amd64.s:514] /usr/local/go/src/runtime/asm_amd64.s:514\n2017/06/14 04:26:41 [C] [asm_amd64.s:514] /usr/local/go/src/runtime/panic.go:489\n2017/06/14 04:26:41 [C] [asm_amd64.s:514] /usr/local/go/src/runtime/panic.go:63\n2017/06/14 04:26:41 [C] [asm_amd64.s:514] /usr/local/go/src/runtime/signal_unix.go:290\n</code></pre>\n\n<p>This is the CreateUserID function:</p>\n\n<pre><code>func (a *Adapter) CreateUserID(stripeToken string, userID string) (*stripe.Customer, error) {\n    // Assign secret key from configuration to Stripe\n    stripe.Key = a.cnf.Stripe.SecretKey\n\n    // Create a Customer:\n    customerParams := &amp;stripe.CustomerParams{\n        Desc: userID,\n    }\n    customerParams.SetSource(stripeToken)\n\n    customer, _ := customer.New(customerParams)\n\n    return customer, nil\n}\n</code></pre>\n\n<p>How can I make it ask for the card's brand? </p>\n"}, {"tags": ["go", "hash", "bcrypt"], "answers": [{"comments": [{"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "edited": false, "score": 0, "creation_date": 1497397683, "post_id": 44533222, "comment_id": 76058019, "body": "yes I have it in that way, the thing is that am debugging why always the CompareHashAndPassword gives me error. In the first argument I send the hashed password as declared (a []byte) and the second is the password sent by the user as byte also"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "edited": false, "score": 0, "creation_date": 1497398052, "post_id": 44533222, "comment_id": 76058099, "body": "@SrednyMCasanova it totally works fine then <a href=\"https://pastebin.com/9rAyRtXU\" rel=\"nofollow noreferrer\">pastebin.com/9rAyRtXU</a> You have a problem somewhere else"}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "edited": false, "score": 0, "creation_date": 1497398302, "post_id": 44533222, "comment_id": 76058150, "body": "thank you, maybe something with the database. Thank you very much!"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": false, "score": 9, "last_activity_date": 1497398301, "last_edit_date": 1497398301, "creation_date": 1497397400, "answer_id": 44533222, "question_id": 44533183, "link": "https://stackoverflow.com/questions/44533183/bcrypt-generating-different-hash-for-the-same-password/44533222#44533222", "title": "Bcrypt generating different hash for the same password", "body": "<p>Bcrypt generates a random salt (that is included as a part of the resulting hash). So it is different every time with purpose.</p>\n\n<p>You need to use <a href=\"https://godoc.org/golang.org/x/crypto/bcrypt#CompareHashAndPassword\" rel=\"noreferrer\"><code>bcrypt.CompareHashAndPassword</code></a> to compare the hashed password and the plaintext password.</p>\n\n<p>The first argument of <code>bcrypt.CompareHashAndPassword</code> is the hashed password, the second is the plaintext password. <del>So you passed them in the wrong order.</del></p>\n\n<p><strong>WARNING</strong>: the cost you've chosen <code>4</code> is extremely low. Consider choosing something like <code>10</code> or over.</p>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2163, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1497426644, "creation_date": 1497397061, "last_edit_date": 1497426644, "question_id": 44533183, "link": "https://stackoverflow.com/questions/44533183/bcrypt-generating-different-hash-for-the-same-password", "title": "Bcrypt generating different hash for the same password", "body": "<p>I am using <a href=\"https://godoc.org/golang.org/x/crypto/bcrypt\" rel=\"nofollow noreferrer\">Bcrypt</a> in Go to hash and compare the password given by the user. The thing is in the login, when I compare the password using <em>CompareHashAndPassword</em> it never matches so always says that the password is incorrect. Based on the concept of <em>hash</em> is supposed that with the same input we will have anytime the same output, and this is not my case.</p>\n\n<p>**My code to hash (in the sign up) **</p>\n\n<pre><code>bs, err := bcrypt.GenerateFromPassword([]byte(Password), bcrypt.MinCost)\n</code></pre>\n\n<p><strong>What I did</strong></p>\n\n<ul>\n<li>Send as password: 12345</li>\n<li><p>When I print <em>bs</em> I get:</p>\n\n<p><strong>Attempt 1:</strong> [36 50 97 36 48 52 36 49 104 78 117 77 56 73 113 99 114 78 99 111 100 57 57 120 101 69 117 118 117 103 87 108 68 76 88 70 119 110 65 116 68 108 118\n57 68 86 81 88 77 50 71 78 101 81 104 65 54 67 107 121]</p>\n\n<p><strong>Attempt 2:</strong>\n[36 50 97 36 48 52 36 47 50 84 70 73 120 56 70 67 116 69 101 48 113 86 89 103 89 119 71 97 46 120 77 116 83 86 57 56 112 122 66 103 46 106 74 104 10\n8 82 113 117 85 110 51 103 115 107 109 102 109 49 115 113]</p>\n\n<p><strong>Attempt 3:</strong>\n[36 50 97 36 48 52 36 51 103 97 117 103 49 74 110 113 85 101 113 54 121 69 108 109 72 76 108 72 46 85 121 65 87 122 103 119 88 71 82 114 56 105 65 6\n9 49 113 73 112 52 48 85 69 85 47 118 56 56 47 48 67]</p></li>\n</ul>\n\n<p>Correct me if I am wrong, but in all that attempts the result should not be the same?</p>\n\n<p>Then, I save that values in the database and these are the values for each attempt:</p>\n\n<ol>\n<li>$2a$04$1hNuM8IqcrNcod99xeEuvugWlDLXFwnAtDlv9DVQXM2GNeQhA6Cky</li>\n<li>$2a$04$/2TFIx8FCtEe0qVYgYwGa.xMtSV98pzBg.jJhlRquUn3gskmfm1sq</li>\n<li>$2a$04$3gaug1JnqUeq6yElmHLlH.UyAWzgwXGRr8iAE1qIp40UEU/v88/0C</li>\n</ol>\n\n<p>Then, to compare the password, in the login:</p>\n\n<pre><code>err := bcrypt.CompareHashAndPassword(user.Password, []byte(p))\n</code></pre>\n\n<p><strong>user.Password</strong> is a []byte this value is conusulted from the database</p>\n\n<p>Thank you\n<strong>p</strong> is the password send in the form by the user</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1497396153, "post_id": 44533029, "comment_id": 76057648, "body": "<code>which shows that the channel is holding 2 values at a time.</code> it doesn&#39;t. Your channel does not hold even a single value."}, {"owner": {"reputation": 259, "user_id": 6398020, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2fc9cc1619a0b712df3032f6b9772c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio", "link": "https://stackoverflow.com/users/6398020/mauricio"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1497396226, "post_id": 44533029, "comment_id": 76057662, "body": "Please elaborate"}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 6398020, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2fc9cc1619a0b712df3032f6b9772c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio", "link": "https://stackoverflow.com/users/6398020/mauricio"}, "edited": false, "score": 0, "creation_date": 1497397000, "post_id": 44533130, "comment_id": 76057858, "body": "I see. The forloop inside the second go routine keeps executing, so the second print statement executes, and stops at the channel-passing. Thank you for that"}], "tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": true, "score": 3, "last_activity_date": 1497396653, "creation_date": 1497396653, "answer_id": 44533130, "question_id": 44533029, "link": "https://stackoverflow.com/questions/44533029/channel-buffer-taking-one-more-value-than-expected-in-go/44533130#44533130", "title": "Channel buffer taking one more value than expected in Go", "body": "<blockquote>\n  <p>which shows that the channel is holding 2 values at a time.</p>\n</blockquote>\n\n<p>Thats not the case. This is how the code executes:</p>\n\n<ol>\n<li>The <strong>main</strong> goroutine blocks on a read on the channel</li>\n<li>The second goroutine writes to the channel <em>and continues executing</em>.</li>\n<li>The second goroutine blocks <em>at the second write attempt</em> because noone is reading</li>\n<li>The <strong>main</strong> goroutine continues executing, prints the read number</li>\n<li>The <strong>main</strong> goroutine reads another number since someone is writing to it</li>\n<li>The <strong>main</strong> goroutine prints the read number and blocks on the next read</li>\n<li>The second goroutine continues executing at step <strong>2.</strong></li>\n</ol>\n\n<p>There is no buffer, just concurrency.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3319093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SZ3N0.jpg?s=128&g=1", "display_name": "ambitioner", "link": "https://stackoverflow.com/users/3319093/ambitioner"}, "is_accepted": false, "score": 0, "last_activity_date": 1559641158, "creation_date": 1559641158, "answer_id": 56441295, "question_id": 44533029, "link": "https://stackoverflow.com/questions/44533029/channel-buffer-taking-one-more-value-than-expected-in-go/56441295#56441295", "title": "Channel buffer taking one more value than expected in Go", "body": "<pre><code>package main\n\nimport (\n    \"log\"\n)\n\nfunc main() {\n    seq := make(chan bool)\n    for i := range numGen(6, seq) {\n        &lt;-seq\n        log.Println(\"taking from channel\", i)\n    }\n}\n\nfunc numGen(num int, seq chan bool) chan int {\n    c := make(chan int)\n    go func() {\n        for i := 0; i &lt; num; i++ {\n            c &lt;- i\n            log.Println(\"passing to channel\", i)\n            seq &lt;- true // \u8981\u4fdd\u8bc1\u987a\u5e8f\uff0c\u8fd9\u91cc\u53d1\u9001\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002\n        }\n        close(c)\n    }()\n\n    return c\n}\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 6398020, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2fc9cc1619a0b712df3032f6b9772c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio", "link": "https://stackoverflow.com/users/6398020/mauricio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 44533130, "answer_count": 2, "score": 0, "last_activity_date": 1559641158, "creation_date": 1497395933, "question_id": 44533029, "link": "https://stackoverflow.com/questions/44533029/channel-buffer-taking-one-more-value-than-expected-in-go", "title": "Channel buffer taking one more value than expected in Go", "body": "<p>I thought that channels in Go only hold 1 value by default unless the buffer size if specified. I read that <a href=\"https://stackoverflow.com/questions/11943841/golang-what-is-channel-buffer-size\">here</a>. But when I run this:</p>\n\n<pre><code>func main (){\n    for i := range numGen(6) {\n        log.Println(\"taking from channel\", i)\n    }\n}\n\nfunc numGen(num int) chan int {\n    c := make(chan string)\n    go func() {\n        for i := 0; i &lt; num; i++ {\n            log.Println(\"passing to channel\", i)\n            c &lt;- i\n        }\n        close(c)\n    }\n    return c\n}\n</code></pre>\n\n<p>my output is:</p>\n\n<pre><code>2017/06/13 18:09:08 passing to channel 0\n2017/06/13 18:09:08 passing to channel 1\n2017/06/13 18:09:08 taking from channel 0\n2017/06/13 18:09:08 taking from channel 1\n2017/06/13 18:09:08 passing to channel 2\n2017/06/13 18:09:08 passing to channel 3\n2017/06/13 18:09:08 taking from channel 2\n2017/06/13 18:09:08 taking from channel 3\n2017/06/13 18:09:08 passing to channel 4\n2017/06/13 18:09:08 passing to channel 5\n2017/06/13 18:09:08 taking from channel 4\n2017/06/13 18:09:08 taking from channel 5\n</code></pre>\n\n<p>which shows that the channel is holding 2 values at a time. Specifying a buffer size like this</p>\n\n<pre><code>c := make(chan int, 0)\n</code></pre>\n\n<p>does nothing. Any way I could make it only hold 1, value, not 2?</p>\n"}, {"tags": ["xml", "go", "marshalling", "unmarshalling"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498069134, "post_id": 44532848, "comment_id": 76351017, "body": "Did you get a chance to verify the answer?"}, {"owner": {"reputation": 2008, "user_id": 710618, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/779233af08fd9f187990a44146f1778c?s=128&d=identicon&r=PG", "display_name": "Alexandre Thenorio", "link": "https://stackoverflow.com/users/710618/alexandre-thenorio"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498491013, "post_id": 44532848, "comment_id": 76507449, "body": "Sort of. I took a look at your example and I understand it however I think this is already what I am doing and I wrote the example wrong. I need some time to go through everything but it will likely take me a bit of time. Thank you very much for the quick reply. I&#39;ll get back as soon as I am able to look into it deeper"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498493806, "post_id": 44532848, "comment_id": 76509233, "body": "Thanks, that&#39;s okay. However as per example you gave I have added answer for it. So you can accept answer and create new question with issue details. Please let&#39;s not mix multiple things into one Q&amp;A."}, {"owner": {"reputation": 2008, "user_id": 710618, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/779233af08fd9f187990a44146f1778c?s=128&d=identicon&r=PG", "display_name": "Alexandre Thenorio", "link": "https://stackoverflow.com/users/710618/alexandre-thenorio"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1498498136, "post_id": 44532848, "comment_id": 76511633, "body": "I agree. It has been marked"}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1497395356, "creation_date": 1497395356, "answer_id": 44532959, "question_id": 44532848, "link": "https://stackoverflow.com/questions/44532848/unable-to-correctly-unmarshal-marshal-dynamic-xml-structs-in-go/44532959#44532959", "title": "Unable to correctly unmarshal/marshal dynamic XML structs in Go", "body": "<p>I have modified your sample here <a href=\"https://play.golang.org/p/rbcoL0ayeb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rbcoL0ayeb</a>. Change your definition to following:</p>\n\n<p>Series:</p>\n\n<pre><code>type Series struct {\n   Name []Name `xml:\"name\"`\n}\n</code></pre>\n\n<p>Website:</p>\n\n<pre><code>type Website struct {\n   Url []Url `xml:\"url\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 2008, "user_id": 710618, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/779233af08fd9f187990a44146f1778c?s=128&d=identicon&r=PG", "display_name": "Alexandre Thenorio", "link": "https://stackoverflow.com/users/710618/alexandre-thenorio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 44532959, "answer_count": 1, "score": 0, "last_activity_date": 1497395356, "creation_date": 1497394550, "question_id": 44532848, "link": "https://stackoverflow.com/questions/44532848/unable-to-correctly-unmarshal-marshal-dynamic-xml-structs-in-go", "title": "Unable to correctly unmarshal/marshal dynamic XML structs in Go", "body": "<p>I have am xsd describing an XML schema and I am trying to write the representation of this xsd in go structures so I am able to marshal/unmarshal XML based on this schema.</p>\n\n<p>Here is some go playground code I wrote to reproduce the problem I am having.</p>\n\n<p><a href=\"https://play.golang.org/p/ktJOsCDyLW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ktJOsCDyLW</a></p>\n\n<p>In the schema, the tags <code>video</code> and <code>web</code> are dynamic  (as in they can both appear under <code>media</code> more than once and have different content inside).</p>\n\n<p>I attempted writing a dynamic struct along with the Unmarshaller/Marshaller interface as the example shows and I seem to be able to perform the parsing but it unmarshals/marshals the internal content incorrect ignoring the Name and URL lists, only taking one element of each.</p>\n\n<p>I am uncertain what the issue is here.</p>\n\n<p>Any help on the matter is appreciated</p>\n"}, {"tags": ["for-loop", "go"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1497391721, "post_id": 44532365, "comment_id": 76056364, "body": "what are you expecting to happen? What do you get? Note that you are using the loop index as your doubling target, do u mean that?"}, {"owner": {"reputation": 41, "user_id": 8142292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6760bdcd28ff6e1aca6d69ed64147cc6?s=128&d=identicon&r=PG&f=1", "display_name": "Alanay", "link": "https://stackoverflow.com/users/8142292/alanay"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1497392049, "post_id": 44532365, "comment_id": 76056505, "body": "I also tried doing it with another variable but go 2, 4, 6, 8... instead somehow. In any case a good answer has been given now."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8142292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6760bdcd28ff6e1aca6d69ed64147cc6?s=128&d=identicon&r=PG&f=1", "display_name": "Alanay", "link": "https://stackoverflow.com/users/8142292/alanay"}, "edited": false, "score": 0, "creation_date": 1497391852, "post_id": 44532400, "comment_id": 76056430, "body": "Thank you, exactly what I need. Except the Println should be above x*=2 to include the 1. :)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1497392804, "last_edit_date": 1497392804, "creation_date": 1497391752, "answer_id": 44532400, "question_id": 44532365, "link": "https://stackoverflow.com/questions/44532365/how-do-i-keep-doubling-a-number-through-a-for-loop-in-go/44532400#44532400", "title": "How do I keep doubling a number through a for loop in Go?", "body": "<p>You <em>are</em> doubling <code>i</code>, but you're creating a new <code>i</code> every iteration, with with the value from the <code>i</code> used in the for loop clause.</p>\n\n<p>You probably want something like</p>\n\n<pre><code>x := 1\nfor i := 1; i &lt; 10; i++ {\n    fmt.Println(x)\n    x *= 2\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8142292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6760bdcd28ff6e1aca6d69ed64147cc6?s=128&d=identicon&r=PG&f=1", "display_name": "Alanay", "link": "https://stackoverflow.com/users/8142292/alanay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 44532400, "answer_count": 1, "score": -1, "last_activity_date": 1497392804, "creation_date": 1497391536, "question_id": 44532365, "link": "https://stackoverflow.com/questions/44532365/how-do-i-keep-doubling-a-number-through-a-for-loop-in-go", "title": "How do I keep doubling a number through a for loop in Go?", "body": "<p>I've tried many different things, to no avail. This is a simple thing but I'm struggling with it, and can't find much helpful resources.</p>\n\n<p>Here's part of what I have tried:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    for i := 1; i &lt; 10; i++ {\n        i := (i * 2)\n        fmt.Println(i)\n    }\n}\n</code></pre>\n"}, {"tags": ["templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 2, "last_activity_date": 1497391337, "creation_date": 1497391337, "answer_id": 44532324, "question_id": 44532017, "link": "https://stackoverflow.com/questions/44532017/how-can-i-add-a-default-value-to-a-go-text-template/44532324#44532324", "title": "How can I add a default value to a go text/template?", "body": "<p>Go template does not have <code>default</code> function. However you can use library that provides <code>default</code> func.</p>\n\n<p>For e.g.: <code>github.com/leekchan/gtf</code></p>\n\n<p>Refer here, how it is implemented at <a href=\"https://github.com/leekchan/gtf/blob/master/gtf.go#L28\" rel=\"nofollow noreferrer\">https://github.com/leekchan/gtf/blob/master/gtf.go#L28</a></p>\n\n<hr>\n\n<p>Read hugo <code>isset</code> func <a href=\"http://gohugo.io/templates/functions/\" rel=\"nofollow noreferrer\">here</a> and source is <a href=\"https://github.com/gohugoio/hugo/blob/master/tpl/collections/collections.go#L368\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 422, "user_id": 1408254, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/de7779cbd2d46b90375bfb03d81b0e66?s=128&d=identicon&r=PG", "display_name": "Noah", "link": "https://stackoverflow.com/users/1408254/noah"}, "edited": false, "score": 1, "creation_date": 1497467321, "post_id": 44533710, "comment_id": 76096134, "body": "It&#39;s certainly not pretty, but it works!  I think you&#39;re right about the intended purpose--I should probably be handing defaults outside of the template.  I will keep that in mind for a future revision of this project."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 4, "last_activity_date": 1497401541, "creation_date": 1497401541, "answer_id": 44533710, "question_id": 44532017, "link": "https://stackoverflow.com/questions/44532017/how-can-i-add-a-default-value-to-a-go-text-template/44533710#44533710", "title": "How can I add a default value to a go text/template?", "body": "<p>Another solution is by changing the template definition to</p>\n\n<pre><code>// Define Template\nt := template.Must(template.New(\"t2\").Parse(`\n    Hello World!\n    The table name is {{with .table_name}}{{index . 0}}{{else}}DefaultTableName{{end}}\n`))\n</code></pre>\n\n<p>But, the value won't be stored in a variable, so if you want to reuse it in other places, you need to write it again. The main purpose of the standard template package is for rendering <em>precomputed</em> value, and <em>logic</em> related operations/functions have limited capability. However, you can define your own <code>function</code> then register it to the template's <a href=\"https://golang.org/pkg/text/template/#FuncMap\" rel=\"nofollow noreferrer\">FuncMap</a> e.g. the <code>default</code> function mentioned by @jeevatkm.</p>\n"}], "owner": {"reputation": 422, "user_id": 1408254, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/de7779cbd2d46b90375bfb03d81b0e66?s=128&d=identicon&r=PG", "display_name": "Noah", "link": "https://stackoverflow.com/users/1408254/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9191, "favorite_count": 0, "accepted_answer_id": 44533710, "answer_count": 2, "score": 2, "last_activity_date": 1497401541, "creation_date": 1497389976, "question_id": 44532017, "link": "https://stackoverflow.com/questions/44532017/how-can-i-add-a-default-value-to-a-go-text-template", "title": "How can I add a default value to a go text/template?", "body": "<p>I want to create a golang template with a default value that is used if a parameter is not supplied, but if I try to use the <code>or</code> function in my template,  it gives me this error:</p>\n\n<pre><code>template: t2:2:20: executing \"t2\" at &lt;index .table_name 0&gt;: error calling index: index of untyped nil\n</code></pre>\n\n<p>Here's an example of the code: <a href=\"https://play.golang.org/p/BwlpROrhm6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BwlpROrhm6</a></p>\n\n<pre><code>// text/template is a useful text generating tool.\n// Related examples: http://golang.org/pkg/text/template/#pkg-examples\npackage main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"text/template\"\n)\n\nvar fullParams = map[string][]string{\n    \"table_name\": []string{\"TableNameFromParameters\"},\n    \"min\":        []string{\"100\"},\n    \"max\":        []string{\"500\"},\n}\nvar minimalParams = map[string][]string{\n    \"min\": []string{\"100\"},\n    \"max\": []string{\"500\"},\n}\n\nfunc check(err error) {\n    if err != nil {\n        fmt.Print(err)\n    }\n}\n\nfunc main() {\n    // Define Template\n    t := template.Must(template.New(\"t2\").Parse(`\n        {{$table_name := (index .table_name 0) or \"DefaultTableName\"}}\n        Hello World!\n        The table name is {{$table_name}}\n    `))\n    check(t.Execute(os.Stdout, fullParams))\n    check(t.Execute(os.Stdout, minimalParams))\n}\n</code></pre>\n\n<p>Googling has pointed me towards an <code>isset</code> function in <a href=\"https://github.com/gohugoio/hugo\" rel=\"nofollow noreferrer\">hugo's template engine</a>, but I can't figure out how they implemented it, and I am not sure if it would even solve my problem. </p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1497391051, "post_id": 44531857, "comment_id": 76056132, "body": "Also see the FAQ: <a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">golang.org/doc/faq#nil_error</a>"}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1497389586, "post_id": 44531924, "comment_id": 76055505, "body": "It does not explain why it&#39;s not <code>nil</code>. It declares a pointer and initialises it with the <code>nil </code>value."}], "tags": [], "owner": {"reputation": 39, "user_id": 1284672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OsJ59.png?s=128&g=1", "display_name": "Mike Wilding", "link": "https://stackoverflow.com/users/1284672/mike-wilding"}, "is_accepted": false, "score": 1, "last_activity_date": 1497389547, "creation_date": 1497389547, "answer_id": 44531924, "question_id": 44531857, "link": "https://stackoverflow.com/questions/44531857/go-pointer-to-interface-is-not-null/44531924#44531924", "title": "Go pointer to interface is not null", "body": "<p>From my understanding your <code>var err2 *MyError</code> definition is generating a pointer to the struct definition and NOT an actual instantiated object.</p>\n"}, {"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": false, "score": 1, "last_activity_date": 1497389936, "creation_date": 1497389936, "answer_id": 44532004, "question_id": 44531857, "link": "https://stackoverflow.com/questions/44531857/go-pointer-to-interface-is-not-null/44532004#44532004", "title": "Go pointer to interface is not null", "body": "<p>In Go interface types are represented by a structure with 2 fields: one denotes its actual type and the other is a pointer to the value.</p>\n\n<p>It means that an interface value is never equal to <code>nil</code> unless the value you passed is actually a <code>nil</code> value.</p>\n\n<p>Relevant and good talk: <a href=\"https://www.youtube.com/watch?v=ynoY2xz-F8s\" rel=\"nofollow noreferrer\">GopherCon 2016: Francesc Campoy - Understanding nil</a></p>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1497390425, "creation_date": 1497390425, "answer_id": 44532120, "question_id": 44531857, "link": "https://stackoverflow.com/questions/44531857/go-pointer-to-interface-is-not-null/44532120#44532120", "title": "Go pointer to interface is not null", "body": "<p><code>error</code> is a built-in interface, and <code>*MyError</code> implements that interface. Even though the value of <code>err2</code> is nil, when you pass it to <code>isNil</code>, the function gets a non-nil interface value. That value contains information about the type (<code>*MyError</code>) and the value itself, which is a nil pointer.</p>\n\n<p>If you try printing <code>err</code> in <code>isNil</code>, you'll see that in the second case, you get \"some error\" even though <code>err2</code> is nil. This demonstrates why <code>err</code> is not nil in that case (it has to contain the type information).</p>\n"}], "owner": {"reputation": 3516, "user_id": 119333, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/or6j6.jpg?s=128&g=1", "display_name": "Martin Magakian", "link": "https://stackoverflow.com/users/119333/martin-magakian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "closed_date": 1497415772, "accepted_answer_id": 44532120, "answer_count": 3, "score": 0, "last_activity_date": 1497390705, "creation_date": 1497389297, "last_edit_date": 1497390705, "question_id": 44531857, "link": "https://stackoverflow.com/questions/44531857/go-pointer-to-interface-is-not-null", "closed_reason": "Duplicate", "title": "Go pointer to interface is not null", "body": "<p>Can someone provide some explanation about this code behaviour:\n<a href=\"https://play.golang.org/p/_TjQhthHl3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_TjQhthHl3</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype MyError struct{}\nfunc (e *MyError) Error() string {\n    return \"some error\"\n}\n\nfunc main() {\n    var err error\n    if err == nil {\n        fmt.Println(\"[OK] err is nil ...\")\n    }else{\n        fmt.Println(\"[KO] err is NOT nil...\")\n    }\n    isNil(err)\n\n\n    var err2 *MyError\n    if err2 == nil {\n        fmt.Println(\"[OK] err2 is nil ...\")\n    }else{\n        fmt.Println(\"[KO] err2 is NOT nil...\")\n    }\n    isNil(err2)\n}\n\nfunc isNil(err error){\n    if err == nil {\n        fmt.Println(\"[OK] ... still nil\")\n    }else{\n        fmt.Println(\"[KO] .. why not nil?\")\n    }\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>[OK] err is nil ...\n[OK] ... still nil\n[OK] err2 is nil ...\n[KO] .. why err2 not nil?\n</code></pre>\n\n<p>I found this post <a href=\"https://stackoverflow.com/questions/13476349/check-for-nil-and-nil-interface-in-go\">Check for nil and nil interface in Go</a> but I still don't get it...</p>\n"}, {"tags": ["windows", "go", "visual-studio-code"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 2, "creation_date": 1497389686, "post_id": 44531822, "comment_id": 76055558, "body": "Open your VS code settings, look for <code>go.gopath</code> in workspace settings and user settings. What is the value you have?"}, {"owner": {"reputation": 423, "user_id": 7782213, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RaQQ_6Zx4LY/AAAAAAAAAAI/AAAAAAAAAAo/C_wAEa046d4/photo.jpg?sz=128", "display_name": "Efron Licht", "link": "https://stackoverflow.com/users/7782213/efron-licht"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497390285, "post_id": 44531822, "comment_id": 76055820, "body": "<code>&quot;go.gopath&quot;: null</code> I tried changing it to <code>&quot;C:&#47;work&#47;go&quot;</code> but that isn&#39;t doing it either."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497391515, "post_id": 44531822, "comment_id": 76056288, "body": "Okay that&#39;s the default value in workspace. Let&#39;s try setting go.gopath in the user settings like <code>&quot;go.gopath&quot;: &quot;C:&#47;work&#47;go&quot;</code>."}, {"owner": {"reputation": 423, "user_id": 7782213, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RaQQ_6Zx4LY/AAAAAAAAAAI/AAAAAAAAAAo/C_wAEa046d4/photo.jpg?sz=128", "display_name": "Efron Licht", "link": "https://stackoverflow.com/users/7782213/efron-licht"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497396177, "post_id": 44531822, "comment_id": 76057652, "body": "I did. No dice, unfortunately."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497397640, "post_id": 44531822, "comment_id": 76058005, "body": "If that&#39;s case. Can you remove the <code>go.gopath</code> settings from VS code and close it. Also unset the GOPATH env variable.  Now we are gonna try with default values. VS Code and Go should use default gopath i.e. USER_HOME/go. If this doesn&#39;t work, sorry your VS code app is messed up. Do a clean install, try, try, again."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497413790, "post_id": 44531822, "comment_id": 76061696, "body": "&quot;<i>Everything was fine yesterday...</i>&quot;. So, did you updated any of Visual Studio Code or Go Extension that may causing this issue? Or maybe you set <code>GOPATH</code> in <code>env</code> as <code>%HOMEPATH%\\...</code> ? Take a look at <a href=\"https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path\">this QA</a>."}, {"owner": {"reputation": 423, "user_id": 7782213, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RaQQ_6Zx4LY/AAAAAAAAAAI/AAAAAAAAAAo/C_wAEa046d4/photo.jpg?sz=128", "display_name": "Efron Licht", "link": "https://stackoverflow.com/users/7782213/efron-licht"}, "edited": false, "score": 0, "creation_date": 1497643211, "post_id": 44531822, "comment_id": 76182435, "body": "Nope. I tried a clean install and everything..."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497646451, "post_id": 44531822, "comment_id": 76183972, "body": "If you want we can create a chat and give it try on debugging your issue."}, {"owner": {"reputation": 423, "user_id": 7782213, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RaQQ_6Zx4LY/AAAAAAAAAAI/AAAAAAAAAAo/C_wAEa046d4/photo.jpg?sz=128", "display_name": "Efron Licht", "link": "https://stackoverflow.com/users/7782213/efron-licht"}, "edited": false, "score": 0, "creation_date": 1497648699, "post_id": 44531822, "comment_id": 76184837, "body": "Thanks! I&#39;m on the clock right now so it will have to wait, but I appreciate your help."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1497717731, "post_id": 44531822, "comment_id": 76200905, "body": "Powershell does not matter here: you only need for your tasks/launch.json to have the right value for GOPATH."}], "answers": [{"comments": [{"owner": {"reputation": 423, "user_id": 7782213, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RaQQ_6Zx4LY/AAAAAAAAAAI/AAAAAAAAAAo/C_wAEa046d4/photo.jpg?sz=128", "display_name": "Efron Licht", "link": "https://stackoverflow.com/users/7782213/efron-licht"}, "edited": false, "score": 0, "creation_date": 1497718462, "post_id": 44600783, "comment_id": 76201143, "body": "This did it! Thank you for your help."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 423, "user_id": 7782213, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RaQQ_6Zx4LY/AAAAAAAAAAI/AAAAAAAAAAo/C_wAEa046d4/photo.jpg?sz=128", "display_name": "Efron Licht", "link": "https://stackoverflow.com/users/7782213/efron-licht"}, "edited": false, "score": 0, "creation_date": 1497718540, "post_id": 44600783, "comment_id": 76201174, "body": "@EfronLicht Well done! I recently switched to VSCode for Go, and I have a surprisingly good experience with it so far."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1497673833, "creation_date": 1497673833, "answer_id": 44600783, "question_id": 44531822, "link": "https://stackoverflow.com/questions/44531822/gopath-environment-errors/44600783#44600783", "title": "Gopath environment errors", "body": "<p>I use VSCode 1.13.1 on Windows 10, and I launch or debug without any issue.</p>\n\n<p>Launching involves in your workspace a <code>${workspaceroot}/.vscode/tasks.json</code> file.<br>\nTo be sure of the GOPATH value, mine includes:</p>\n\n<pre><code>{\n    // See https://go.microsoft.com/fwlink/?LinkId=733558\n    // for the documentation about the tasks.json format\n    \"version\": \"0.1.0\",\n    \"command\": \"build\",\n    \"isShellCommand\": true,\n    \"showOutput\": \"always\",\n    \"tasks\": [\n        {\n            \"options\": {\n                \"env\": {\n                    \"GOROOT\": \"D:/prgs/go/latest\",\n                    \"GOPATH\": \"${workspaceRoot}\"\n                }\n            },\n            \"echoCommand\": false,\n            \"taskName\": \"install\",\n            \"isBuildCommand\": true\n        },\n</code></pre>\n\n<p>You can replace <code>\"${workspaceRoot}\"</code> by <code>C:/work/go</code> in your case.<br>\nThat way, a <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>B</kbd> triggers a compilation+installation (<code>go install</code>)</p>\n\n<p>And the debugger involves:</p>\n\n<ul>\n<li>having a <code>dlv.exe</code> in the %PATH%</li>\n<li>a <code>${workspaceroot}/.vscode/launch.json</code> file</li>\n</ul>\n\n<p>Here is mine</p>\n\n<pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"stopOnEntry\": false,\n            \"cwd\": \"${workspaceRoot}\",\n            \"name\": \"Launch\",\n            \"type\": \"go\",\n            \"request\": \"launch\",\n            \"mode\": \"debug\",\n            \"remotePath\": \"\",\n            \"port\": 2345,\n            \"host\": \"127.0.0.1\",\n            \"program\": \"${fileDirname}\",\n            \"env\": {\n                \"GOPATH\": \"${workspaceRoot}\"\n            },\n            \"args\": [],\n            \"showLog\": true\n        }\n    ]\n}\n</code></pre>\n\n<p>Again you can replace <code>\"${workspaceRoot}\"</code> by <code>C:/work/go</code> in your case (both in <code>GOPATH</code> and <code>cwd</code>). </p>\n\n<p>Note that I specificy GOPATH <em>as well as</em> cwd (current working directory)\nI open my file relative from the workspace root (that way, the breakpoints are recognized). A simple <kbd>F5</kbd> from <code>main.go</code> does run delve successfully (on Windows!)</p>\n\n<p>With that, I can launch VSCode from a <code>cmd</code> Windows shell which has no <code>GOROOT</code> or <code>GOPATH</code> set, and it still works. (because my local user settings do include <code>\"go.goroot\": \"D:/prgs/go/latest\"</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 423, "user_id": 7782213, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RaQQ_6Zx4LY/AAAAAAAAAAI/AAAAAAAAAAo/C_wAEa046d4/photo.jpg?sz=128", "display_name": "Efron Licht", "link": "https://stackoverflow.com/users/7782213/efron-licht"}, "edited": false, "score": 0, "creation_date": 1497714579, "post_id": 44601249, "comment_id": 76199902, "body": "I don&#39;t know what tmux is, so that can&#39;t be it, sorry. Thank you for your advice!"}], "tags": [], "owner": {"reputation": 337, "user_id": 1920214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f138092492c317d91304aa0af579caf6?s=128&d=identicon&r=PG", "display_name": "payneio", "link": "https://stackoverflow.com/users/1920214/payneio"}, "is_accepted": false, "score": 0, "last_activity_date": 1497678557, "creation_date": 1497678557, "answer_id": 44601249, "question_id": 44531822, "link": "https://stackoverflow.com/questions/44531822/gopath-environment-errors/44601249#44601249", "title": "Gopath environment errors", "body": "<p>If you are launching VSCode from the command line in a tmux shell, try launching outside of tmux. Also try launching from the launcher. Changes in tmux and VSCode on MacOS have been giving me headaches with environment settings lately resulting in similar issues.</p>\n"}], "owner": {"reputation": 423, "user_id": 7782213, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RaQQ_6Zx4LY/AAAAAAAAAAI/AAAAAAAAAAo/C_wAEa046d4/photo.jpg?sz=128", "display_name": "Efron Licht", "link": "https://stackoverflow.com/users/7782213/efron-licht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1066, "favorite_count": 2, "accepted_answer_id": 44600783, "answer_count": 2, "score": 4, "last_activity_date": 1497714551, "creation_date": 1497389166, "last_edit_date": 1497714551, "question_id": 44531822, "link": "https://stackoverflow.com/questions/44531822/gopath-environment-errors", "title": "Gopath environment errors", "body": "<p>I'm using Visual Studio code to write some go code. Everything was working fine yesterday, but now I can't run the debugger or build in VS-Code.</p>\n\n<p>I am on Windows 10, and I use Powershell as my terminal of choice.</p>\n\n<p>I get the following error:</p>\n\n<pre><code>go: GOPATH entry is relative; must be absolute path: \"/Users/efronlicht/go\".\nFor more details see: 'go help gopath'\nexit status 2\nProcess exiting with code: 1\n</code></pre>\n\n<p>This is a VS-CODE specific error, because I can build go source files with <code>go build</code> through the terminal as usual. </p>\n\n<p>Here are the results of <code>go env</code>:</p>\n\n<pre><code>set GOARCH=amd64\nset GOBIN=\nset GOEXE=.exe\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=C:\\work\\go\nset GORACE=\nset GOROOT=C:\\Go\nset GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_amd64\nset GCCGO=gccgo\nset CC=gcc\nset GOGCCFLAGS=-m64 -mthreads -fmessage-length=0\nset CXX=g++\nset CGO_ENABLED=1\nset PKG_CONFIG=pkg-config\nset CGO_CFLAGS=-g -O2\nset CGO_CPPFLAGS=\nset CGO_CXXFLAGS=-g -O2\nset CGO_FFLAGS=-g -O2\nset CGO_LDFLAGS=-g -O2\n</code></pre>\n\n<p>As you can see, my GOPATH is an absolute path, not a relative one.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1497383746, "post_id": 44530376, "comment_id": 76052519, "body": "Please copy-and-paste the text into your question rather than linking to a screenshot."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1497383862, "post_id": 44530376, "comment_id": 76052590, "body": "It probably has to do with the behavior of the Windows <code>set</code> command. When I do something similar on Linux it does affect the output of <code>go env</code> as expected. I&#39;ll let someone who&#39;s more familiar with Windows provide more information. And I&#39;m not 100% clear on the relationship between environment variables and the output of <code>go env</code>; the man page is not terribly illuminating."}, {"owner": {"reputation": 31, "user_id": 8074902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/564d822d84d36bcaf3ee83bb44beab1b?s=128&d=identicon&r=PG&f=1", "display_name": "TF Gui", "link": "https://stackoverflow.com/users/8074902/tf-gui"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1497384335, "post_id": 44530376, "comment_id": 76052818, "body": "Thank you for your reply Thompson, I have edited it but not sure if it looks proper now. I am not sure how to format commands."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8074902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/564d822d84d36bcaf3ee83bb44beab1b?s=128&d=identicon&r=PG&f=1", "display_name": "TF Gui", "link": "https://stackoverflow.com/users/8074902/tf-gui"}, "edited": false, "score": 0, "creation_date": 1497386586, "post_id": 44531095, "comment_id": 76053971, "body": "It works! Thank you for your answer I am so grateful, if not you I may make this mistake many times before I  figure it out."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1497386261, "creation_date": 1497386261, "answer_id": 44531095, "question_id": 44530376, "link": "https://stackoverflow.com/questions/44530376/go-environment-variables-stay-unchanged-after-setting/44531095#44531095", "title": "Go environment variables stay unchanged after setting", "body": "<p>\"Any extra spaces around either the variable name or the string, will not be ignored, SET is not forgiving of extra spaces like many other scripting languages.\"</p>\n\n<p>Change <code>set GOOS = darwin</code> to <code>set GOOS=darwin</code> - i.e., the same format you see in the output of <code>go env</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 8074902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/564d822d84d36bcaf3ee83bb44beab1b?s=128&d=identicon&r=PG&f=1", "display_name": "TF Gui", "link": "https://stackoverflow.com/users/8074902/tf-gui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 44531095, "answer_count": 1, "score": 1, "last_activity_date": 1497386261, "creation_date": 1497383641, "last_edit_date": 1497384271, "question_id": 44530376, "link": "https://stackoverflow.com/questions/44530376/go-environment-variables-stay-unchanged-after-setting", "title": "Go environment variables stay unchanged after setting", "body": "<p>I start learning Go programming by watching online tutorials. I use Windows command prompt. However, after I typed <code>set GOOS = darwin</code> then used <code>go env</code> to print environment variables, <code>GOOS</code> was not set to <code>GOOS=darwin</code> but still <code>GOOS=windows</code> as default. </p>\n\n<hr>\n\n<p>Here is what I got. Could someone tell me where I went wrong such that I cannot make change on <code>GOOS</code>? </p>\n\n<pre><code>C:\\GoPath\\src\\palindrome&gt;set GOOS = darwin\n\nC:\\GoPath\\src\\palindrome&gt;go env\nset GOARCH=amd64\nset GOBIN=\nset GOEXE=.exe\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "is_accepted": false, "score": 0, "last_activity_date": 1497383616, "creation_date": 1497383616, "answer_id": 44530368, "question_id": 44530054, "link": "https://stackoverflow.com/questions/44530054/go-lang-how-do-represent-json-with-types-that-can-vary/44530368#44530368", "title": "Go Lang how do represent Json with types that can vary", "body": "<p>In go you would you the JSON library to parse the JSON-encoded data into a struct. So for your example let's say you are getting your data from a webpage. </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n    \"io/ioutil\"\n)\n\ntype Payload struct {\n    EntityName string\n    properties Properties\n}\n\ntype Properties struct{\n    name string\n    type string\n    value string\n\n}\n\n\nfunc main() {\n    url := \"some site where data is stored\"\n    res, err  := http.Get(url)\n    if err != nil {\n        panic (err)\n    } \n    defer res.Body.Close()\n\n    body, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        panic(err)\n    }\n\n    var p Payload\n\n    err = json.Unmarshal(body, &amp;p)\n    if err != nil{\n       panic (err)\n    }\n\n    fmt.Println(p.EntityName\\n, p.properties)\n}\n</code></pre>\n\n<p>This is by no means an efficient or smart way of doing this, I just quickly hacked this together. But I hope it conveys the concept. </p>\n"}], "owner": {"reputation": 835, "user_id": 1105727, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/Ys5Bh.jpg?s=128&g=1", "display_name": "Charles Bryant", "link": "https://stackoverflow.com/users/1105727/charles-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "closed_date": 1497383759, "answer_count": 1, "score": 0, "last_activity_date": 1497383616, "creation_date": 1497382345, "question_id": 44530054, "link": "https://stackoverflow.com/questions/44530054/go-lang-how-do-represent-json-with-types-that-can-vary", "closed_reason": "Duplicate", "title": "Go Lang how do represent Json with types that can vary", "body": "<p>I have a need to unmarshal a json object that has values that can change. A typical object would have as an example the following properties defined:</p>\n\n<pre><code>{\n    \"entityName\": \"example Property\",\n    \"properties\": [\n        {\n            \"name\": \"property1\",\n            \"type\": \"string\",\n            \"value\": \"Test Value\"\n        },\n        {\n            \"name\": \"property2\",\n            \"type\": \"float\",\n            \"value\": \"12.5\"\n        },\n        {\n            \"name\": \"property3\",\n            \"type\": \"integer\",\n            \"value\": 1\n        }\n    ]\n}\n</code></pre>\n\n<p>Each property would declare itself as the type it would need to be unmarshalled to. I have solved this problem in Java using generics but I am unsure, how I would declare my object in Go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497380943, "post_id": 44529031, "comment_id": 76051024, "body": "Why would you need to expose the s3 SDK as an <i>sftp</i> handler? What would the &quot;something&quot; you feel you need actually <i>do</i>?"}, {"owner": {"reputation": 148, "user_id": 2792754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4861baa09063b947120dcfba7ccb4b94?s=128&d=identicon&r=PG", "display_name": "icub3d", "link": "https://stackoverflow.com/users/2792754/icub3d"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497395957, "post_id": 44529031, "comment_id": 76057594, "body": "Bascially, because the business says so. I&#39;m retrofitting an existing system. The clients expect to use SFTP and we can&#39;t change that. Other parts of the project are using an S3 clone and the business wants the submissions to now be stored there."}, {"owner": {"reputation": 148, "user_id": 2792754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4861baa09063b947120dcfba7ccb4b94?s=128&d=identicon&r=PG", "display_name": "icub3d", "link": "https://stackoverflow.com/users/2792754/icub3d"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497396128, "post_id": 44529031, "comment_id": 76057641, "body": "As to what it would actual do, is still a mystery. Thus the question. I&#39;m guessing in the Get example it would read from the io.Reader filling a buffer. It would then wait on the ReadAt() calls until the buffer had the data available to get it."}, {"owner": {"reputation": 193, "user_id": 2287586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c61a5823ce5155c4b5b67e5c0e59d1?s=128&d=identicon&r=PG", "display_name": "Renato", "link": "https://stackoverflow.com/users/2287586/renato"}, "edited": false, "score": 0, "creation_date": 1502468950, "post_id": 44529031, "comment_id": 78239113, "body": "I have the same issue, did you find a good solution?"}, {"owner": {"reputation": 148, "user_id": 2792754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4861baa09063b947120dcfba7ccb4b94?s=128&d=identicon&r=PG", "display_name": "icub3d", "link": "https://stackoverflow.com/users/2792754/icub3d"}, "edited": false, "score": 0, "creation_date": 1502559018, "post_id": 44529031, "comment_id": 78264341, "body": "No good solution. I ended up saving the incoming file to disk before uploading it to s3."}], "answers": [{"tags": [], "owner": {"reputation": 2428, "user_id": 345350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50cb4981bbaa51b1713269a29f78d826?s=128&d=identicon&r=PG", "display_name": "donatJ", "link": "https://stackoverflow.com/users/345350/donatj"}, "is_accepted": true, "score": 2, "last_activity_date": 1504798077, "creation_date": 1504798077, "answer_id": 46100148, "question_id": 44529031, "link": "https://stackoverflow.com/questions/44529031/is-there-an-easy-way-to-buffer-io-readerat-and-io-writerat/46100148#46100148", "title": "Is there an easy way to buffer io.ReaderAt and io.WriterAt?", "body": "<p>I'm personally making use of <a href=\"https://github.com/avvmoto/buf-readerat\" rel=\"nofollow noreferrer\">https://github.com/avvmoto/buf-readerat</a> which specifically buffers ReadAt. Saved me a lot of pain.</p>\n"}], "owner": {"reputation": 148, "user_id": 2792754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4861baa09063b947120dcfba7ccb4b94?s=128&d=identicon&r=PG", "display_name": "icub3d", "link": "https://stackoverflow.com/users/2792754/icub3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "accepted_answer_id": 46100148, "answer_count": 1, "score": 4, "last_activity_date": 1504798077, "creation_date": 1497378810, "question_id": 44529031, "link": "https://stackoverflow.com/questions/44529031/is-there-an-easy-way-to-buffer-io-readerat-and-io-writerat", "title": "Is there an easy way to buffer io.ReaderAt and io.WriterAt?", "body": "<p>I'm implementing a custom sftp server for a project at work that will use an AWS compatible system as the backend. Based on what I am seeing, I'm thinking I should implement the <a href=\"http://godoc.org/github.com/pkg/sftp#Handlers\" rel=\"nofollow noreferrer\">sftp.Handlers</a> interface using the <a href=\"http://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/\" rel=\"nofollow noreferrer\">s3.Uploader and s3.Downloader</a> or <a href=\"http://docs.aws.amazon.com/sdk-for-go/api/service/s3/\" rel=\"nofollow noreferrer\">s3.PutObject and s3.GetObject</a>.</p>\n\n<p>I've used <a href=\"https://golang.org/pkg/io/#PipeReader\" rel=\"nofollow noreferrer\">io.PipeReader</a> and <a href=\"https://golang.org/pkg/io/#PipeWriter\" rel=\"nofollow noreferrer\">io.PipeWriter</a> before to pipe an io.Writer to an io.Reader but in this case, I need to do something like:</p>\n\n<ul>\n<li>Get: io.ReaderAt &lt;- ??? &lt;- io.Reader</li>\n<li>Put: io.WriterAt -> ??? -> io.Reader</li>\n</ul>\n\n<p>I'm guessing ??? will be different in both cases but they both seem like they'd be a type of pipe where we hold data until it's available for the other end. Does something like this exist or do I need to implement it myself? Any suggestions on implementing it?</p>\n"}, {"tags": ["file", "go", "byte", "reader"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8126874, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e495242d2b08ca95225832f8175faa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Piao", "link": "https://stackoverflow.com/users/8126874/jason-piao"}, "edited": false, "score": 0, "creation_date": 1497380358, "post_id": 44529311, "comment_id": 76050738, "body": "I have to step back in the file Im currently reading, so I can&#39;t just discard the next n bytes. I have to jump back to the top of the file sometimes. Can you put a negative number In discard?"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "reply_to_user": {"reputation": 67, "user_id": 8126874, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e495242d2b08ca95225832f8175faa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Piao", "link": "https://stackoverflow.com/users/8126874/jason-piao"}, "edited": false, "score": 0, "creation_date": 1497383101, "post_id": 44529311, "comment_id": 76052123, "body": "No, but you can use <code>file.seek()</code> and create another <code>bufio.Reader</code> if you need it."}, {"owner": {"reputation": 67, "user_id": 8126874, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e495242d2b08ca95225832f8175faa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Piao", "link": "https://stackoverflow.com/users/8126874/jason-piao"}, "edited": false, "score": 0, "creation_date": 1497383762, "post_id": 44529311, "comment_id": 76052532, "body": "Yeah.. I was trying to avoid that.. but I guess thats the only option. Thanks!"}], "tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": false, "score": 2, "last_activity_date": 1497383519, "last_edit_date": 1497383519, "creation_date": 1497379672, "answer_id": 44529311, "question_id": 44528935, "link": "https://stackoverflow.com/questions/44528935/read-a-row-of-a-file-starting-at-byte-offset-until-new-line/44529311#44529311", "title": "Read a row of a file starting at byte offset until new line", "body": "<p>One way is use the <code>bufio</code> pkg. An example of this is the following:</p>\n\n\n\n<pre><code>fd, err := os.Open(\"your_file.csv\")\nif err != nil { //error handler\n    log.Println(err)\n    return\n}\n\nreader := bufio.NewReader(fd) // creates a new reader\n\n_, err = reader.Discard(64) // discard the following 64 bytes\nif err != nil { // error handler\n    log.Println(err)\n    return\n}\n\n// use isPrefix if is needed, this example doesn't use it\n// read line until a new line is found\nline, _, err := reader.ReadLine() \nif err != nil { // error handler\n    log.Println(err)\n    return\n}\nfmt.Println(string(line))\n</code></pre>\n\n<p>Another way to read the line, you can use <code>fd.Seek(64,0)</code> to jump to a specific byte like</p>\n\n \n\n<pre><code>_, err = fd.Seek(64, 0)  // Set the current position for the fd\nif err != nil { // error handler\n    log.Println(err)\n    return\n}\n</code></pre>\n\n<p>And afterward use the reader to read the line.</p>\n\n \n\n<pre><code>reader := bufio.NewReader(fd)\n\nline, _, err := reader.ReadLine()\nif err != nil {\n    log.Println(err)\n    return\n}\nfmt.Println(string(line))\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8126874, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e495242d2b08ca95225832f8175faa8c?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Piao", "link": "https://stackoverflow.com/users/8126874/jason-piao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3030, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1497388903, "creation_date": 1497378459, "last_edit_date": 1497388903, "question_id": 44528935, "link": "https://stackoverflow.com/questions/44528935/read-a-row-of-a-file-starting-at-byte-offset-until-new-line", "title": "Read a row of a file starting at byte offset until new line", "body": "<p>I am using os.ReadAt() to read certain rows in a csv/tsv file. However, I don't know how many bytes are in that row, I just need to read the line starting at the byte offset I specify until the newline.</p>\n\n<pre><code>buffer = make([]byte, 46)\nos.ReadAt(buffer, 64) //Read at byte offset 64 and put contents in buffer\n</code></pre>\n\n<p>However, this only allows me to read 46 bytes of the line in.\nIs there any way to read the entire line until the newline?</p>\n\n<p>Thanks</p>\n\n<p>Update:</p>\n\n<p>I just create a struct that holds the offset and line length.. Should've done this in the beginning.. my bad</p>\n"}, {"tags": ["string", "go", "type-conversion", "byte", "rune"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497372345, "post_id": 44527223, "comment_id": 76046303, "body": "If you don&#39;t want to convert a <code>string</code> to <code>[]rune</code> in every call, you need to use <code>[]rune</code>"}, {"owner": {"reputation": 1485, "user_id": 2229960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/62652e679c426edd1a718d4dd9de6d66?s=128&d=identicon&r=PG", "display_name": "Eissa N.", "link": "https://stackoverflow.com/users/2229960/eissa-n"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497372689, "post_id": 44527223, "comment_id": 76046474, "body": "@JimB But, my input is a string and I try to avoid conversion of <code>string</code> to <code>[]rune</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497373415, "post_id": 44527223, "comment_id": 76046856, "body": "My point is that you need to convert a <code>string</code> to a <code>[]rune</code> in order to index it as such. If you don&#39;t want to repeatedly convert the <code>string</code>, then use a <code>[]rune</code> as the argument type, and convert it once."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497373710, "post_id": 44527223, "comment_id": 76047023, "body": "Or are you simply looking for: <a href=\"https://play.golang.org/p/RdH7oMCHIZ\" rel=\"nofollow noreferrer\">play.golang.org/p/RdH7oMCHIZ</a>?"}, {"owner": {"reputation": 1485, "user_id": 2229960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/62652e679c426edd1a718d4dd9de6d66?s=128&d=identicon&r=PG", "display_name": "Eissa N.", "link": "https://stackoverflow.com/users/2229960/eissa-n"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497373970, "post_id": 44527223, "comment_id": 76047154, "body": "@JimB Yes, that is what I am looking for, but without conversion from <code>string</code> to <code>[]rune</code>. It seems that it&#39;s not possible though because of the way <code>string</code> is designed as @icza mentions <a href=\"https://stackoverflow.com/a/44527543/2229960\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1539443077, "last_edit_date": 1539443077, "creation_date": 1497373386, "answer_id": 44527543, "question_id": 44527223, "link": "https://stackoverflow.com/questions/44527223/access-random-rune-element-of-string-without-using-for-range/44527543#44527543", "title": "Access random rune element of string without using for ... range", "body": "<p><code>string</code> values in Go store the UTF-8 encoded byte sequence of the text. This is a design decision that has been made and it won't change.</p>\n\n<p>If you want to efficiently get a <code>rune</code> from it at an arbitrary index, you have to decode the bytes, you can't do anything about that (the <code>for ... range</code> does this decoding). There is no \"shortcut\". The chosen representation just doesn't provide this out of the box.</p>\n\n<p>If you have to do this frequently / many times, you should change your input and not use <code>string</code> but a <code>[]rune</code>, as it's a slice and can be efficiently indexed. <code>string</code> in Go is not <code>[]rune</code>. <code>string</code> in Go is effectively a read-only <code>[]byte</code> (UTF-8). Period.</p>\n\n<p>If you can't change the input type, you may build an internal cache mapped from <code>string</code> to its <code>[]rune</code>:</p>\n\n<pre><code>var cache = map[string][]rune{}\n\nfunc RuneAt(s string, idx int) rune {\n    rs := cache[s]\n    if rs == nil {\n        rs = []rune(s)\n        cache[s] = []rune(s)\n    }\n    if idx &gt;= len(rs) {\n        return 0\n    }\n    return rs[idx]\n}\n</code></pre>\n\n<p>It depends on case whether this is worth it: if <code>RuneAt()</code> is called with a small set of <code>string</code>s, this may improve performance a lot. If the passed strings are more-or-less unique, this will result in worse performance and a lot of memory usage. Also this implementation is not safe for concurrent use.</p>\n"}], "owner": {"reputation": 1485, "user_id": 2229960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/62652e679c426edd1a718d4dd9de6d66?s=128&d=identicon&r=PG", "display_name": "Eissa N.", "link": "https://stackoverflow.com/users/2229960/eissa-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 44527543, "answer_count": 1, "score": 1, "last_activity_date": 1539443077, "creation_date": 1497372164, "last_edit_date": 1497379697, "question_id": 44527223, "link": "https://stackoverflow.com/questions/44527223/access-random-rune-element-of-string-without-using-for-range", "title": "Access random rune element of string without using for ... range", "body": "<p>I recently asked <a href=\"https://stackoverflow.com/questions/44487910/does-accessing-elements-of-string-as-byte-perform-conversion\">this</a> question and the answers increased my understanding, but they didn't solve the actual problem I had. So, I will try to ask a similar but different question as follows. </p>\n\n<p>Suppose that I want to access random <code>rune</code> element of a <code>string</code>. One way is:</p>\n\n<pre><code>func RuneElement(str string, idx int) rune {\n  var ret rune\n  for i, c := range str {\n    if i == idx {\n      return c\n    }\n  }\n  return ret // out of range -&gt; proper handling is needed\n}\n</code></pre>\n\n<p>What if I want to call such a function a lot of times? I guess what I am looking for is like an operator/function like <code>str[i]</code> (which returns a <code>byte</code>) that return the <code>rune</code> element at <code>i</code>-th position. Why this element can be accessed using <code>for ... range</code> but not through a funtcion like <code>str.At(i)</code> for example?</p>\n"}, {"tags": ["inheritance", "go", "methods", "embedding", "organization"], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1497375220, "post_id": 44527419, "comment_id": 76047841, "body": "Yes: I&#39;d like my base class to be a little more fragile\u2026"}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1497375585, "post_id": 44527419, "comment_id": 76048083, "body": "I like this approach; it definitely makes the code easier to maintain.  It&#39;s a pity that it comes at the cost of making <code>foo</code> and <code>bar</code> bigger by the size of an interface variable (which gets expensive if you have lots instances) <i>and</i> making zero values invalid.  :-/"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497380754, "post_id": 44527419, "comment_id": 76050929, "body": "The size of an interface variable is just a few bytes; if memory consumption is your top concern, you should focus on that at the expense of your design. But it would take many, many instances to have a significant impact, as an interface value adds only two words of overhead (16 bytes on a 64-bit system). Presumably your data structure eclipses that by far."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1497384337, "post_id": 44527419, "comment_id": 76052819, "body": "Oh: I have to take back my previous comment (but I won&#39;t delete it as Adrain&#39;s reply would otherwise lack context): I now see that the additional cost is just the size of pointer, not an interface value.  I &quot;tsk&quot; myself for inattentive reading."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497384480, "post_id": 44527419, "comment_id": 76052903, "body": "@Adrian: in this case my actual <code>foo</code> objects are just 40 bytes (of which 7 are alignment padding), so adding another 16 is not insignificant.  Fortunately I have thought of a clever way to rearrange things, adding an interface value but with no net change in size in the most common case."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1497380793, "last_edit_date": 1497380793, "creation_date": 1497372986, "answer_id": 44527419, "question_id": 44526957, "link": "https://stackoverflow.com/questions/44526957/how-can-i-organise-this-go-code-that-redefines-methods-from-an-embedded-type-to/44527419#44527419", "title": "How can I organise this Go code that redefines methods from an embedded type to be less redundant and more maintainable?", "body": "<p>In Go there is <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">embedding</a>, but there is no <a href=\"https://en.wikipedia.org/wiki/Polymorphism_(computer_science)\" rel=\"nofollow noreferrer\">polymorphism</a>. If you embed a type in a struct, all the methods of the embedded type get promoted and will be in the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> of the wrapper struct type. But you can't \"override\" the promoted methods. Sure, you can add your own method with the same name, and calling a method by that name on the wrapper struct will invoke your method, but if this method is called from the embedded type, that will not be dispatched to your method, it will still call the \"original\" method that was defined to the embedded type.</p>\n\n<p>Read more about this here: <a href=\"https://stackoverflow.com/questions/41819033/does-fragile-base-class-issue-exist-in-go/41827686#41827686\">Does fragile base class issue exist in Go?</a> and here: <a href=\"https://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method/29390981#29390981\">Go embedded struct call child method instead parent method</a>.</p>\n\n<p>It looks like you only want to \"inherit\" the <code>double()</code> and <code>toString()</code> methods (which should be called <code>String()</code> in Go), but not the <code>get()</code> method as its implementation changes from type-to-type.</p>\n\n<p>So basically you should refactor a little. Your <code>foo</code> type should have / get a value that provides the <code>get()</code> method. You can capture this with a <code>getter</code> interface:</p>\n\n<pre><code>type getter interface {\n    get() int\n}\n</code></pre>\n\n<p>And the <code>foo</code> implementation:</p>\n\n<pre><code>type foo struct {\n    g getter\n}\n\nfunc (f foo) double() int {\n    return f.g.get() * 2\n}\n\nfunc (f foo) toString() string {\n    return fmt.Sprintf(\"%d\", f.g.get())\n}\n</code></pre>\n\n<p>And a <code>bar</code> type which embeds <code>foo</code>, and only provides the \"missing\" <code>get()</code>:</p>\n\n<pre><code>type bar struct {\n    foo\n}\n\nfunc (b bar) get() int {\n    return 69\n}\n</code></pre>\n\n<p>Usage example:</p>\n\n<pre><code>b := bar{}\nb.foo = foo{g: b}\nfmt.Println(b.double())\nfmt.Println(b.toString())\n</code></pre>\n\n<p>Output is as expected (try it on the <a href=\"https://play.golang.org/p/ZvpnNdEYEi\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>138\n69\n</code></pre>\n\n<h3>With a simple function value</h3>\n\n<p>Using the above <code>getter</code> interface is nice, as it provides flexibility in the future, should you need to add other methods to it.</p>\n\n<p>If this is not the case and all you need is a single function, you may leave out the interface and just use a function value.</p>\n\n<p>This is how it could look like:</p>\n\n<pre><code>type foo struct {\n    get func() int\n}\n\nfunc (f foo) double() int {\n    return f.get() * 2\n}\n\nfunc (f foo) toString() string {\n    return fmt.Sprintf(\"%d\", f.get())\n}\n\ntype bar struct {\n    foo\n}\n\nfunc (b bar) get() int {\n    return 69\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>b := bar{}\nb.foo = foo{get: b.get}\nfmt.Println(b.double())\nfmt.Println(b.toString())\n</code></pre>\n\n<p>Output is the same. Try it on the <a href=\"https://play.golang.org/p/7f5OVjhwWw\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Note that while we used the <code>bar.get()</code> method (<code>b.get</code> <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow noreferrer\">method value</a>), it is not a requirement that <code>get()</code> should be a method. It can be an ordinary function value, or even a <a href=\"https://golang.org/ref/spec#Function_literals\" rel=\"nofollow noreferrer\">function literal</a>, such as:</p>\n\n<pre><code>b := bar{foo: foo{get: func() int { return 69 }}}\nfmt.Println(b.double())\nfmt.Println(b.toString())\n</code></pre>\n\n<p>Try this one on the <a href=\"https://play.golang.org/p/-qHV3HmmlC\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497380793, "creation_date": 1497371300, "last_edit_date": 1497379876, "question_id": 44526957, "link": "https://stackoverflow.com/questions/44526957/how-can-i-organise-this-go-code-that-redefines-methods-from-an-embedded-type-to", "title": "How can I organise this Go code that redefines methods from an embedded type to be less redundant and more maintainable?", "body": "<p>I have <a href=\"https://play.golang.org/p/oRBB1xs_Sn\" rel=\"nofollow noreferrer\">some example code</a> in which I declare a type <code>foo</code> with some methods which call each other (say: <code>foo.get</code>, which is called by <code>foo.double</code> and <code>foo.toString</code>).</p>\n\n<p>I have another type, <code>bar</code>, which embeds <code>foo</code> and redefines <code>get</code>.  I am forced to redefine <code>double</code> and <code>toString</code> on <code>bar</code>, so they can see <code>bar.get</code> (rather than only <code>foo.get</code>), but the body of these functions is basically identical to the original.</p>\n\n<p>Is there a better way to organise this code, to avoid the redundancy while still having <code>bar</code> fulfill the same interfaces as <code>foo</code>?</p>\n\n<p>Notes:</p>\n\n<ul>\n<li>The code as organised above <em>works</em> fine; it's just difficult to maintain because when I go to redefine a method originally declared on <code>foo</code> on an type that embeds <code>foo</code> I have to check carefully to see which other methods on <code>foo</code> call it, and make sure to redefine all of those too.  It has proven to be very easy to accidentally miss one.</li>\n<li>In the real project on which this is based there are nearly a dozen types which embed '<code>foo</code>', and a similar number of inter-connected methods on each type.</li>\n<li>I could add an interface-valued member to foo containing a pointer to the outermost enclosing struct that embeds it, and have <code>foo.double</code> call <code>f.outermost.get()</code> instead of <code>f.get()</code>, but this seems a little wasteful and would mean that zero values of <code>foo</code> were not valid.  (Plus it is only possible if the embedded type is a struct.)</li>\n</ul>\n"}, {"tags": ["go", "floating-point", "bit-manipulation", "constants"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497365767, "post_id": 44524774, "comment_id": 76041902, "body": "You can store it as a <code>uint64</code> constant and convert it on demand (which is how the math package does it internally)"}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497368004, "post_id": 44524774, "comment_id": 76043431, "body": "That&#39;s actually a good suggestion.  It&#39;s a bit annoying for exported values (e.g. ones used as sentinel values) because the dependant package would also need to import <code>math</code>, but at least it ensures constness."}], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1497367663, "post_id": 44524824, "comment_id": 76043182, "body": "I understand that.  But it does not answer the question.  (I think the answer to the question might be &quot;submit a go language change proposal&quot;, but I want to make sure I have not missed something before I do that.)"}], "tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": false, "score": 2, "last_activity_date": 1497365227, "creation_date": 1497365227, "answer_id": 44524824, "question_id": 44524774, "link": "https://stackoverflow.com/questions/44524774/how-can-i-declare-a-float-typed-go-constant-of-arbitrary-bit-pattern/44524824#44524824", "title": "How can I declare a float-typed Go constant of arbitrary bit pattern?", "body": "<p>Your call to Math.Float64frombits occurs at runtime, not compile time, and thus, is not constant. From the effective Go page (which will explain it better than I can):</p>\n\n<blockquote>\n  <p>Constants in Go are just that\u2014constant. They are created at compile\n  time, even when defined as locals in functions, and can only be\n  numbers, strings or booleans. Because of the compile-time restriction,\n  the expressions that define them must be constant expressions,\n  evaluatable by the compiler. For instance, 1&lt;&lt;3 is a constant\n  expression, while math.Sin(math.Pi/4) is not because the function call\n  to math.Sin needs to happen at run time.</p>\n</blockquote>\n\n<p>Link: <a href=\"https://golang.org/doc/effective_go.html#constants\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#constants</a></p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497365730, "post_id": 44524941, "comment_id": 76041868, "body": "That doesn&#39;t apply the bitwise representation to the float64, it&#39;s essentially <code>float64(0x7ff8c0c0ac0ffee1)</code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497365884, "post_id": 44524941, "comment_id": 76041981, "body": "Yes, that is correct. Question wasn&#39;t specific on the details of what they were expecting as output from the input, so I gave the only available option for setting a const value from an arbitrary hex value."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497366022, "post_id": 44524941, "comment_id": 76042076, "body": "The question specifies results equivalent to <code>Float64frombits</code>. Numerically converting an arbitrary hex value to a float64 is not the same as interpreting the uint64 bits as a float64."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497366671, "post_id": 44524941, "comment_id": 76042540, "body": "Depending on the value, it could be made equivalent using an appropriate hex value. It&#39;s hard to say, since the question&#39;s example <code>math.Float64frombits(0x7ff8c0c0ac0ffee1)</code> returns <code>NaN</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1497367582, "post_id": 44524941, "comment_id": 76043134, "body": "That&#39;s part of the point, the bits start with the NaN mask value, and can&#39;t by written as a float64 literal. Not to mention that since hex literals can only be integral values, they represent a very small portion of possible float64 values, so it can only be approximated in a very limited sense."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1497365549, "creation_date": 1497365549, "answer_id": 44524941, "question_id": 44524774, "link": "https://stackoverflow.com/questions/44524774/how-can-i-declare-a-float-typed-go-constant-of-arbitrary-bit-pattern/44524941#44524941", "title": "How can I declare a float-typed Go constant of arbitrary bit pattern?", "body": "<p>You can't call a function like <code>Float64frombits</code> in a constant declaration; the function call means it can't be evaluated fully at compile time, so it can't be used as a constant. You can, however, just dump bits into a float value:</p>\n\n<pre><code>const myFloat float64 = 0x7ff8c0c0ac0ffee1\n\nfunc main() {\n    fmt.Println(myFloat)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1497368380, "creation_date": 1497368380, "answer_id": 44525986, "question_id": 44524774, "link": "https://stackoverflow.com/questions/44524774/how-can-i-declare-a-float-typed-go-constant-of-arbitrary-bit-pattern/44525986#44525986", "title": "How can I declare a float-typed Go constant of arbitrary bit pattern?", "body": "<p>If you want to store the bit value (which is essentially a <code>uint64</code>), and have it available as a <code>float64</code> to external packages, you can provide a \"constant\" function, which you guarantee to only return the constant value. This is precisely how functions like <a href=\"https://golang.org/pkg/math/#NaN\" rel=\"nofollow noreferrer\"><code>math.NaN</code></a> work.</p>\n\n<pre><code>const uintFoo = 0x7ff8c0c0ac0ffee1\n\nfunc ConstFoo() float64 {\n    return math.Float64frombits(uintFoo)\n}\n</code></pre>\n"}], "owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1497368380, "creation_date": 1497365094, "question_id": 44524774, "link": "https://stackoverflow.com/questions/44524774/how-can-i-declare-a-float-typed-go-constant-of-arbitrary-bit-pattern", "title": "How can I declare a float-typed Go constant of arbitrary bit pattern?", "body": "<p>In Go I can declare a typed float constant like this:</p>\n\n<pre><code>const foo float64 = 1e100\n</code></pre>\n\n<p>or a float variable of arbitrary bit pattern like this:</p>\n\n<pre><code>var bar = math.Float64frombits(0x7ff8c0c0ac0ffee1)\n</code></pre>\n\n<p>But this is an error (\"const initializer\u2026 is not a constant\"):</p>\n\n<pre><code>const baz = math.Float64frombits(0x7ff8c0c0ac0ffee1)\n</code></pre>\n\n<p>How might I declare a typed float const of arbitrary bit pattern?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1497365155, "post_id": 44524001, "comment_id": 76041418, "body": "what does your schema look like? I typically use autoincrement for the id column on a table"}, {"owner": {"reputation": 133, "user_id": 3753231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae66c6a32eb588a63df8298aad156df7?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/3753231/justin"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1497365954, "post_id": 44524001, "comment_id": 76042030, "body": "I figured it out I will post my results. @Nevermore"}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 811827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f091e1ad556fc066d3a09052f8936312?s=128&d=identicon&r=PG", "display_name": "Cyberience", "link": "https://stackoverflow.com/users/811827/cyberience"}, "edited": false, "score": 0, "creation_date": 1582621632, "post_id": 44525193, "comment_id": 106831153, "body": "why didn&#39;t you use AUTOINCREMENT on the ID column?"}], "tags": [], "owner": {"reputation": 133, "user_id": 3753231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae66c6a32eb588a63df8298aad156df7?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/3753231/justin"}, "is_accepted": true, "score": 0, "last_activity_date": 1497366228, "creation_date": 1497366228, "answer_id": 44525193, "question_id": 44524001, "link": "https://stackoverflow.com/questions/44524001/get-last-record-form-my-sqlite-db-using-go/44525193#44525193", "title": "Get Last record form my sqlite db using go", "body": "<p>I was missing \"int\" in the func </p>\n\n<p>Wrong: </p>\n\n<pre><code>func getBookLastID() {....\n</code></pre>\n\n<p>Correct: </p>\n\n<pre><code>func getBookLastID() int {....\n</code></pre>\n\n<p>Correct All:</p>\n\n<pre><code>func getBookLastID() int { \n\n    var id int\n\n    err := db.QueryRow(\"select ifnull(max(id), 0) as id from books\").Scan(&amp;id)\n    if err != nil {\n      panic(err)\n    }\n    fmt.Println(\"New record ID is:\", id + 1)\n    return id + 1\n}\n\nfunc insertBook(name, author string, pages int, publicationDate time.Time) (int, error) {\n    //Create\n\n    lastid := getBookLastID() \n\n\n    res, err := db.Exec(`INSERT INTO books(id, name, author, pages, publication_date) VALUES($1, $2, $3, $4, $5)`, lastid, name, author, pages, publicationDate)\n\n    if err != nil {\n        return 0, err\n    }\n\n    rowsCreated, err := res.RowsAffected()\n\n        if err != nil {\n        return 0, err\n    }\n\n    return int(rowsCreated), err\n\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 3753231, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae66c6a32eb588a63df8298aad156df7?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/3753231/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 44525193, "answer_count": 1, "score": 0, "last_activity_date": 1497366228, "creation_date": 1497363060, "question_id": 44524001, "link": "https://stackoverflow.com/questions/44524001/get-last-record-form-my-sqlite-db-using-go", "title": "Get Last record form my sqlite db using go", "body": "<p>I want to query my sqlite db to get the last id in my book table then insert the data with the last id + 1. I am new to Go and I can't figure out how to set my lastid int variable. Any help would be greatly appreciated. </p>\n\n<pre><code>func getBookLastID() {\n\n  var lastid int\n  err := db.QueryRow(\"select max(id) from books\").Scan(&amp;lastid)\n  fmt.Println(lastid)\n  return (lastid + 1)\n}\n\nfunc insertBook(name, author string, pages int, publicationDate time.Time) (int, error) {\n        //Create\n        var bookID int\n\n        var lastid int \n        lastid = getBookLastID()\n\n        err := db.QueryRow(`INSERT INTO books(id, name, author, pages, publication_date) VALUES($1, $2, $3, $4, $5)`, lastid, name, author, pages, publicationDate).Scan(&amp;bookID)\n\n        if err != nil {\n                return 0, err\n        }\n\n        fmt.Printf(\"Last inserted ID: %v\\n\", bookID)\n        return bookID, err\n}\n</code></pre>\n"}, {"tags": ["go", "webstorm"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1497362012, "post_id": 44523559, "comment_id": 76039028, "body": "It&#39;s valid from a Go perspective. I can&#39;t comment on the webstorm side of it, sorry :("}], "answers": [{"tags": [], "owner": {"reputation": 1544, "user_id": 4996722, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sddyE.jpg?s=128&g=1", "display_name": "OneMoreQuestion", "link": "https://stackoverflow.com/users/4996722/onemorequestion"}, "is_accepted": true, "score": 0, "last_activity_date": 1497362570, "creation_date": 1497362570, "answer_id": 44523831, "question_id": 44523559, "link": "https://stackoverflow.com/questions/44523559/webstorm-issue-with-golang-struct/44523831#44523831", "title": "WebStorm issue with GoLang struct", "body": "<p>The Go code is correct so as long as there is a GoSDK is defined in WebStorm it should be okay. Make sure that Golang settings are in place. </p>\n\n<p>Click on <strong>WebStorm</strong> -> <strong>Preferences</strong> -> <strong>Languages</strong> <strong>&amp;</strong> <strong>Frameworks</strong> -> <strong>Go</strong> and make sure everything is set there. </p>\n\n<p>Refer to: <a href=\"https://plugins.jetbrains.com/plugin/5047-go-language-golang-org-support-plugin\" rel=\"nofollow noreferrer\">Go language (golang.org) support plugin</a></p>\n"}, {"tags": [], "owner": {"reputation": 1183, "user_id": 4274484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0dPT2.jpg?s=128&g=1", "display_name": "hypnoglow", "link": "https://stackoverflow.com/users/4274484/hypnoglow"}, "is_accepted": false, "score": 0, "last_activity_date": 1497364040, "creation_date": 1497364040, "answer_id": 44524363, "question_id": 44523559, "link": "https://stackoverflow.com/questions/44523559/webstorm-issue-with-golang-struct/44524363#44524363", "title": "WebStorm issue with GoLang struct", "body": "<p>The Go code is correct. As mentioned, you need to enable Go SDK for each separate project.</p>\n\n<p>Also, make sure your WebStorm has <a href=\"https://plugins.jetbrains.com/plugin/9568-go\" rel=\"nofollow noreferrer\">Go Plugin</a> installed or just use <a href=\"https://www.jetbrains.com/go/\" rel=\"nofollow noreferrer\">Gogland IDE</a> (that's like WebStorm but for Go) - it is free now while in beta.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6758349"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 44523831, "answer_count": 2, "score": 0, "last_activity_date": 1497364040, "creation_date": 1497361939, "question_id": 44523559, "link": "https://stackoverflow.com/questions/44523559/webstorm-issue-with-golang-struct", "title": "WebStorm issue with GoLang struct", "body": "<p>For some reason, WebStorm (by JetBrains) marks the following simple GoLang struct as error. Specifically, it does not like <code>string</code> </p>\n\n<pre><code>type Person struct {\n    Name string    `json:\"name\"`\n    Address string    `json:\"address\"`\n}\n</code></pre>\n\n<p>But from the looks of it, there is nothing wrong with this? Is there a plugin I am missing in WebStorm?</p>\n"}, {"tags": ["go", "build", "dependency-management"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1497357011, "post_id": 44521071, "comment_id": 76034835, "body": "Or are you looking for <code>go list</code> ? Take a look at <code>Imports</code> and <code>Deps</code>."}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 1, "creation_date": 1497370105, "post_id": 44521071, "comment_id": 76044887, "body": "I&#39;m not sure why this is diverging into a discussion about the technical meaning of stack trace - this always happens to me on SO. I have a CI job building dozen of services (that I didn&#39;t write) and this is what I see in the logs but that doesn&#39;t help me. I have no idea who is importing kafkaAvailMonitor.go i.e. who is breaking the build. go list was a helpful suggestion but didn&#39;t show anything - would love to know more about that."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1498571070, "post_id": 44521071, "comment_id": 76544429, "body": "<code>go list -f &#39;{{ .GoFiles }}&#39; github.com&#47;Shopify&#47;sarama&#47;tz&#47;breaker</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1498922648, "post_id": 44521071, "comment_id": 76704536, "body": "The OP isn&#39;t looking for a <i>stack trace</i>, he wants the <i>dependency tree</i>."}], "answers": [{"comments": [{"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1498515298, "post_id": 44768397, "comment_id": 76519882, "body": "Are you familiar with the build &quot;output&quot; of other language like Java/C#/Python etc? Where you build something and it tells you the dependency chain e.g. A import B at line 3 which imports C at line 2? The issue with your answer is that I have to run &quot;go list&quot; on every dependency so if A depends on B depends on C etc. I have go all the way down each one which on a large project is impossible. The whole point is that I don&#39;t want to add tz/breaker - someone is adding it by mistake but I can&#39;t figure out who because it&#39;s buried under several other dependencies."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 1, "creation_date": 1498538041, "post_id": 44768397, "comment_id": 76525053, "body": "&quot;The issue with your answer is that I have to run &quot;go list&quot; on every dependency so if A depends on B depends on C etc&quot;: that is easily scriptable, I have edited the answer accordingly."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 1, "creation_date": 1498538121, "post_id": 44768397, "comment_id": 76525072, "body": "&quot;The whole point is that I don&#39;t want to add tz/breaker - someone is adding it by mistake&quot;. Someone? That &quot;someone&quot; is <code>kafkaAvailMonitor.go</code>, line 8. The question becomes: do you need <code>kafkaAvailMonitor.go</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1498922869, "post_id": 44768397, "comment_id": 76704615, "body": "I think the point is: the OP doesn&#39;t know what is depending on <code>kafkaAvailMonitor.go</code>."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1498929056, "post_id": 44768397, "comment_id": 76706462, "body": "@Fli hence the script, in order to list all  dependencies on all packages, in order to find the one importing <code>kafkaAvailMonitor</code>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 9, "last_activity_date": 1498538001, "last_edit_date": 1498538001, "creation_date": 1498509948, "answer_id": 44768397, "question_id": 44521071, "link": "https://stackoverflow.com/questions/44521071/how-to-view-full-dependency-tree-for-nested-go-dependencies/44768397#44768397", "title": "How to view full dependency tree for nested Go dependencies", "body": "<blockquote>\n  <p>if the following isn't a stack trace what is it? </p>\n</blockquote>\n\n<p>It is the list of path where Go is looking for your missing package.</p>\n\n<blockquote>\n  <p>I have no idea who is importing kafkaAvailMonitor.go</p>\n</blockquote>\n\n<p>It is not \"imported\", just part of your sources and compiled.<br>\nExcept it cannot compile, because it needs <code>github.com/Shopify/sarama/tz/breaker</code>, which is not in <code>GOROOT</code> or <code>GOPATH</code>.</p>\n\n<p>Still, check what <a href=\"https://dave.cheney.net/2014/09/14/go-list-your-swiss-army-knife\" rel=\"noreferrer\"><code>go list</code> would return</a> on your direct package, to see if <code>kafkaAvailMonitor</code> is mentioned.</p>\n\n<blockquote>\n  <p><code>go list</code> can show both the packages that your package directly depends, or its complete set of transitive dependencies.</p>\n</blockquote>\n\n<pre><code>% go list -f '{{ .Imports }}' github.com/davecheney/profile\n[io/ioutil log os os/signal path/filepath runtime runtime/pprof]\n% go list -f '{{ .Deps }}' github.com/davecheney/profile\n[bufio bytes errors fmt io io/ioutil log math os os/signal path/filepath reflect run\n</code></pre>\n\n<p>You can then script go list in order to list <em>all</em> dependencies.<br>\nSee <a href=\"https://gist.github.com/nilium/0e70b090f72c23248fe6d281cd8ba869\" rel=\"noreferrer\">this bash script for instance</a>, by <a href=\"https://github.com/nilium\" rel=\"noreferrer\">Noel Cower (<code>nilium</code>)</a></p>\n\n<pre><code>#!/usr/bin/env bash\n# Usage: lsdep [PACKAGE...]\n#\n# Example (list github.com/foo/bar and package dir deps [the . argument])\n# $ lsdep github.com/foo/bar .\n#\n# By default, this will list dependencies (imports), test imports, and test\n# dependencies (imports made by test imports).  You can recurse further by\n# setting TESTIMPORTS to an integer greater than one, or to skip test\n# dependencies, set TESTIMPORTS to 0 or a negative integer.\n\n: \"${TESTIMPORTS:=1}\"\n\nlsdep_impl__ () {\n    local txtestimps='{{range $v := .TestImports}}{{print . \"\\n\"}}{{end}}'\n    local txdeps='{{range $v := .Deps}}{{print . \"\\n\"}}{{end}}'\n\n    {\n        go list -f \"${txtestimps}${txdeps}\" \"$@\"\n        if [[ -n \"${TESTIMPORTS}\" ]] &amp;&amp; [[ \"${TESTIMPORTS:-1}\" -gt 0 ]]\n        then\n            go list -f \"${txtestimps}\" \"$@\" |\n            sort | uniq |\n            comm -23 - &lt;(go list std | sort) |\n                TESTIMPORTS=$((TESTIMPORTS - 1)) xargs bash -c 'lsdep_impl__ \"$@\"' \"$0\"\n        fi\n    } |\n    sort | uniq |\n    comm -23 - &lt;(go list std | sort)\n}\nexport -f lsdep_impl__\n\nlsdep_impl__ \"$@\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1499401924, "post_id": 44959807, "comment_id": 76900198, "body": "Nice. I know that go list Imports had to be useful here. +1"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1499431263, "post_id": 44959807, "comment_id": 76916668, "body": "Yes - the the real disappointment is that go list has a recursive option but it flattens the tree - so you can see all the dependencies but not the order. go list -f &quot;{{.ImportPath}} {{.Deps}}&quot; ./..."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1499431356, "post_id": 44959807, "comment_id": 76916727, "body": "Arf! &lt;facepalm&gt;"}], "tags": [], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1617484343, "last_edit_date": 1617484343, "creation_date": 1499379914, "answer_id": 44959807, "question_id": 44521071, "link": "https://stackoverflow.com/questions/44521071/how-to-view-full-dependency-tree-for-nested-go-dependencies/44959807#44959807", "title": "How to view full dependency tree for nested Go dependencies", "body": "<p>The above answer still doesn't show me a dependency tree so I've taken the time to write a script to do what I need - hopefully that helps other people.</p>\n<p>The issue with the above solution (the others proposed like go list) is that it only tells me the top level. They don't &quot;traverse the tree.&quot; This is the output I get - which doesn't help any more than what go build gives me.</p>\n<pre><code>.../npd/auth/\n   .../mon/mlog\n   .../auth/service\n</code></pre>\n<p>This is what I'm trying to get - I know that auth is broken (top) and that breaker is broken (bottom) from go build but I have no idea what's in between - my script below gives me this output.</p>\n<pre><code>.../npd/auth/\n    .../npd/auth/service                \n        .../npd/auth/resource\n            .../npd/auth/storage\n               .../npd/middleware\n                  .../npd/metrics/persist\n                    .../npd/kafka\n                        .../vendor-library/src/github.com/Shopify/sarama\n                            .../vendor-library/src/github.com/Shopify/sarama/vz/breaker\n</code></pre>\n<p>My script</p>\n<pre class=\"lang-py prettyprint-override\"><code>import subprocess\nimport os\n\nfolder_locations=['.../go/src','.../vendor-library/src']\n\ndef getImports(_cwd):\n    #When the commands were combined they overflowed the bugger and I couldn't find a workaround\n    cmd1 = [&quot;go&quot;, &quot;list&quot;, &quot;-f&quot;, &quot; {{.ImportPath}}&quot;,&quot;./...&quot;]\n    cmd2 = [&quot;go&quot;, &quot;list&quot;, &quot;-f&quot;, &quot; {{.Imports}}&quot;,&quot;./...&quot;]\n\n    process = subprocess.Popen(' '.join(cmd1), cwd=_cwd,shell=True,\n                               stdout=subprocess.PIPE,\n                               stderr=subprocess.PIPE)\n\n    out1, err = process.communicate()\n\n    process = subprocess.Popen(' '.join(cmd2), cwd=_cwd,shell=True,\n                               stdout=subprocess.PIPE,\n                               stderr=subprocess.PIPE)\n\n    out2, err = process.communicate()\n    out2clean=str(out2).replace(&quot;b'&quot;,'').replace('[','').replace(']','').replace(&quot;'&quot;,'')\n\n    return str(out1).split('\\\\n'),out2clean.split('\\\\n')\n\ndef getFullPath(rel_path):\n    for i in folder_locations:\n        if os.path.exists(i+'/'+rel_path):\n            return i+'/'+rel_path\n    return None\n\ndef getNextImports(start,depth):\n\n    depth=depth+1\n    indent = '\\t'*(depth+1)\n\n    for i,val in enumerate(start.keys()):\n\n        if depth==1:\n            print (val)\n\n        out1,out2=getImports(val)\n\n        noDeps=True\n        for j in out2[i].split(' '):\n            noDeps=False\n    \n            _cwd2=getFullPath(j)\n            new_tree = {_cwd2:[]}\n            not_exists = (not _cwd2 in alltmp)\n    \n            if not_exists:\n                print(indent+_cwd2)\n                start[val].append(new_tree)\n                getNextImports(new_tree,depth)\n                alltmp.append(_cwd2)\n\n        if noDeps:\n            print(indent+'No deps')\n\n_cwd = '/Users/.../npd/auth'\n\nalltmp=[]\nstart_root={_cwd:[]}\ngetNextImports(start_root,0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9594, "user_id": 448734, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94ccfc629c6862b5950de3512742bcae?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/448734/bryan"}, "is_accepted": false, "score": 9, "last_activity_date": 1595595385, "creation_date": 1595595385, "answer_id": 63074019, "question_id": 44521071, "link": "https://stackoverflow.com/questions/44521071/how-to-view-full-dependency-tree-for-nested-go-dependencies/63074019#63074019", "title": "How to view full dependency tree for nested Go dependencies", "body": "<p>When using modules you may be able to get what you need from <code>go mod graph</code>.</p>\n<pre><code>usage: go mod graph\n\nGraph prints the module requirement graph (with replacements applied)\nin text form. Each line in the output has two space-separated fields: a module\nand one of its requirements. Each module is identified as a string of the form\npath@version, except for the main module, which has no @version suffix.\n</code></pre>\n<p>I.e., for the original question, run <code>go mod graph | grep github.com/Shopify/sarama</code> then look more closely at each entry on the left-hand side.</p>\n"}], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8615, "favorite_count": 2, "accepted_answer_id": 44768397, "answer_count": 3, "score": 10, "last_activity_date": 1617484343, "creation_date": 1497355628, "last_edit_date": 1598104957, "question_id": 44521071, "link": "https://stackoverflow.com/questions/44521071/how-to-view-full-dependency-tree-for-nested-go-dependencies", "title": "How to view full dependency tree for nested Go dependencies", "body": "<p>I'm trying to debug the following build error in our CI where &quot;A depends on B which can't build because it depends on C.&quot; I'm building my data service which doesn't directly depend on kafkaAvailMonitor.go which makes this error hard to trace. In other words:</p>\n<blockquote>\n<p>data (what I'm building) depends on (?) which depends on\nkafkaAvailMonitor.go</p>\n</blockquote>\n<p>It may seem trivial to fix for a developer they just do &quot;go get whatever&quot; but I can't do that as part of the release process - I have to find the person that added the dependency and ask them to fix it.</p>\n<p>I'm aware that there are tools to visualize the dependency tree and other more sophisticated build systems, but this seems like a pretty basic issue: is there any way I can view the full dependency tree to see what's causing the build issue?</p>\n<pre><code>go build -a -v\n\n../../../msgq/kafkaAvailMonitor.go:8:2: cannot find package \n  &quot;github.com/Shopify/sarama/tz/breaker&quot; in any of:\n  /usr/lib/go-1.6/src/github.com/Shopify/sarama/tz/breaker (from $GOROOT)\n  /home/jenkins/go/src/github.com/Shopify/sarama/tz/breaker (from $GOPATH)\n  /home/jenkins/vendor-library/src/github.com/Shopify/sarama/tz/breaker\n  /home/jenkins/go/src/github.com/Shopify/sarama/tz/breaker\n  /home/jenkins/vendor-library/src/github.com/Shopify/sarama/tz/breaker\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1497349836, "post_id": 44516601, "comment_id": 76029714, "body": "Try <a href=\"https://regex101.com/r/B2ESZj/1\" rel=\"nofollow noreferrer\"><code>(round-trip|rtt)\\s+\\S+\\s*=\\s*([0-9.]+)&#47;([0-9.]+)&#47;([0-9.]+)&#47;(&zwnj;&#8203;[0-9.]+)\\s*ms</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1497351804, "last_edit_date": 1497351804, "creation_date": 1497349954, "answer_id": 44518998, "question_id": 44516601, "link": "https://stackoverflow.com/questions/44516601/capture-result-of-ping-command-in-golang/44518998#44518998", "title": "capture result of ping command in golang", "body": "<p>You need to be more precise when defining the regex. <code>.*</code> is too greedy and matches across commas and other stuff.</p>\n\n<p>I suggest using</p>\n\n<pre><code>var latencyPattern = regexp.MustCompile(`(round-trip|rtt)\\s+\\S+\\s*=\\s*([0-9.]+)/([0-9.]+)/([0-9.]+)/([0-9.]+)\\s*ms`)\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/B2ESZj/1\" rel=\"nofollow noreferrer\">regex demo</a>.</p>\n\n<p><a href=\"https://play.golang.org/p/drI2b8poLK\" rel=\"nofollow noreferrer\">Go lang demo</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n    \"strings\"\n    \"strconv\"\n)\n\nfunc main() {\n    strOutput := `1-&gt;5 packets transmitted, 5 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 0.067/0.078/0.087/0.007 ms \n        2-&gt;5 packets transmitted, 5 received, 0% packet loss, time 801ms\nrtt min/avg/max/stddev = 0.019/0.034/0.044/0.010 ms, ipg/ewma 200.318/0.038 ms`\n    latencyPattern := regexp.MustCompile(`(round-trip|rtt)\\s+\\S+\\s*=\\s*([0-9.]+)/([0-9.]+)/([0-9.]+)/([0-9.]+)\\s*ms`)\n    matches := latencyPattern.FindAllStringSubmatch(strOutput, -1)\n    for _, item := range matches {\n        latency, _ := strconv.ParseFloat(strings.TrimSpace(item[3]), 64)\n            jitter, _ := strconv.ParseFloat(strings.TrimSpace(item[5]), 64)\n            fmt.Printf(\"AVG = %.3f, STDDEV = %.3f\\n\", latency, jitter)\n\n        }\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>AVG = 0.078, STDDEV = 0.007\nAVG = 0.034, STDDEV = 0.010\n</code></pre>\n\n<p><strong>Pattern details</strong>:</p>\n\n<ul>\n<li><code>(round-trip|rtt)</code> - <code>round-trip</code> or <code>rtt</code> substrings</li>\n<li><code>\\s+</code> - 1+ whitespaces</li>\n<li><code>\\S+</code> - 1+ non-whitespace symbols</li>\n<li><code>\\s*=\\s*</code> - a <code>=</code> enclosed with 0+ whitespaces</li>\n<li><code>([0-9.]+)</code> - Group 1: the first number</li>\n<li><code>/</code> - a <code>/</code></li>\n<li><code>([0-9.]+)</code> - Group 2: the second number</li>\n<li><code>/</code> - a <code>/</code></li>\n<li><code>([0-9.]+)</code> - Group 3: the third number</li>\n<li><code>/</code> - a <code>/</code></li>\n<li><code>([0-9.]+)</code> - Group 4: the fourth number</li>\n<li><code>\\s*</code> - 0+ whitespaces</li>\n<li><code>ms</code> - a substring <code>ms</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1497359969, "creation_date": 1497359969, "answer_id": 44522754, "question_id": 44516601, "link": "https://stackoverflow.com/questions/44516601/capture-result-of-ping-command-in-golang/44522754#44522754", "title": "capture result of ping command in golang", "body": "<p>Personally, I would simplify this as much as possible, especially since you aren't trying to pull out all the data, just a couple parts - which are conveniently in the same format in both versions! Essentially, in that string, you only care about <code>min/avg/max/stddev = 0.019/0.034/0.044/0.010</code>:</p>\n\n<pre><code>re := regexp.MustCompile(\"min/avg/max/stddev = ([0-9./]+)\")\nsub := re.FindStringSubmatch(input)\nparts := strings.Split(sub[1], \"/\")\nfmt.Printf(\"Avg: %s, StdDev: %s\\n\", parts[1], parts[3])\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/k_hWMfOovo\" rel=\"nofollow noreferrer\">Example on playground</a>.</p>\n"}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 44518998, "answer_count": 2, "score": 1, "last_activity_date": 1497359969, "creation_date": 1497343835, "last_edit_date": 1497344317, "question_id": 44516601, "link": "https://stackoverflow.com/questions/44516601/capture-result-of-ping-command-in-golang", "title": "capture result of ping command in golang", "body": "<p>I have result of ping command in two ways-></p>\n\n<pre><code>1-&gt;5 packets transmitted, 5 packets received, 0.0% packet loss\nround-trip min/avg/max/stddev = 0.067/0.078/0.087/0.007 ms\n\n2-&gt;5 packets transmitted, 5 received, 0% packet loss, time 801ms\nrtt min/avg/max/stddev = 0.019/0.034/0.044/0.010 ms, ipg/ewma 200.318/0.038 ms\n</code></pre>\n\n<p>these are results of ping command in two different platforms.\nNow From this I want value of avg/stddev in both the cases.\nI have written a regex-</p>\n\n<pre><code>var latencyPattern = regexp.MustCompile(\"(round-trip|rtt) .* = (.*)/(.*)/(.*)/(.*) *ms,\")\nif matches := latencyPattern.FindStringSubmatch(strOutput); len(matches) &gt;= 5{\n    latency, _ = strconv.ParseFloat(strings.TrimSpace(matches[3]), 64)\n    jitter, _ = strconv.ParseFloat(strings.TrimSpace(matches[5]), 64)\n}\n</code></pre>\n\n<p>Now this pattern is working fine for 2nd result of ping (giving me 0.034 and 0.01 as result). But for result 1, it is not able to find the pattern (i.e. to give 0.078 and 0.007). \nHow can I change the regex to work for both?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 10229, "user_id": 195130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e8ae4e7eded8cd37805b4b31cc1f1c53?s=128&d=identicon&r=PG", "display_name": "Chandra Sekar", "link": "https://stackoverflow.com/users/195130/chandra-sekar"}, "is_accepted": true, "score": 2, "last_activity_date": 1497503867, "last_edit_date": 1497503867, "creation_date": 1497342671, "answer_id": 44516160, "question_id": 44515710, "link": "https://stackoverflow.com/questions/44515710/xml-unmarshal-not-working-on-first-element/44516160#44516160", "title": "XML unmarshal not working on First element", "body": "<p>The root element of XML is unmarshalled into the type of the pointer provided. In your case, this is <code>XMLCS</code>. Since <code>version</code> is an attribute of the root element, it will go into a field named <code>version</code> in <code>XMLCS</code>, if present.</p>\n\n<p>So changing your struct as below should fix the problem,</p>\n\n<pre><code>type XMLCS struct {\n    XMLName string `xml:\"container\"`\n    Version string `xml:\"version,attr\"`\n}\n</code></pre>\n\n<p>Read the <a href=\"https://golang.org/pkg/encoding/xml/#Marshal\" rel=\"nofollow noreferrer\">documentation of Marshal</a> for details on how XML is mapped to structs.</p>\n"}], "owner": {"reputation": 2054, "user_id": 615120, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/xoAHa.jpg?s=128&g=1", "display_name": "rnk", "link": "https://stackoverflow.com/users/615120/rnk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 44516160, "answer_count": 1, "score": 0, "last_activity_date": 1497503867, "creation_date": 1497341201, "last_edit_date": 1497344523, "question_id": 44515710, "link": "https://stackoverflow.com/questions/44515710/xml-unmarshal-not-working-on-first-element", "title": "XML unmarshal not working on First element", "body": "<p>I'm trying to unmarshal XML.</p>\n\n<pre><code>type XMLCSFP struct {\n    Version string `xml:\"version,attr\"`\n}\n\ntype XMLCS struct {\n    Container XMLCSFP `xml:\"container\"`\n}\n\n\nv2 := XMLCS{}\ndata := `\n&lt;container xmlns=\"urn:oasis:names:tc:opendocument:xmlns:container\" version=\"1.0\"&gt;\n    &lt;rootfiles&gt;\n        &lt;rootfile full-path=\"EPUB/package.opf\" media-type=\"application/oebps-package+xml\"/&gt;\n    &lt;/rootfiles&gt;\n&lt;/container&gt;\n`\nerr = xml.Unmarshal([]byte(data), &amp;v)\n    if err != nil {\n    fmt.Printf(\"error: %v\", err)\n    return\n}\nfmt.Println(v)\n</code></pre>\n\n<p>It's not showing me the version <code>1.0</code>. The struct value is <code>nil</code></p>\n\n<p><strong>But when I wrap the xml with <code>div</code> container. It's working fine.</strong></p>\n\n<pre><code>data := `\n&lt;div&gt;\n&lt;container xmlns=\"urn:oasis:names:tc:opendocument:xmlns:container\" version=\"1.0\"&gt;\n    &lt;rootfiles&gt;\n        &lt;rootfile full-path=\"EPUB/package.opf\" media-type=\"application/oebps-package+xml\"/&gt;\n    &lt;/rootfiles&gt;\n&lt;/container&gt;\n&lt;/div&gt;\n`\n</code></pre>\n\n<p>What is the problem with the first one? Thanks!</p>\n"}, {"tags": ["go", "json-api", "go-echo"], "answers": [{"comments": [{"owner": {"reputation": 6283, "user_id": 434792, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/11d0482f7d0ebdbe1d42c81f7817db5d?s=128&d=identicon&r=PG", "display_name": "michaelbn", "link": "https://stackoverflow.com/users/434792/michaelbn"}, "edited": false, "score": 0, "creation_date": 1497441784, "post_id": 44528288, "comment_id": 76079003, "body": "Thanks! I used approach 1. I updated your code so it will return the right <code>content-type</code> value. -&gt; <code>application&#47;vnd.api+json</code>"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1497441659, "last_edit_date": 1497441659, "creation_date": 1497376067, "answer_id": 44528288, "question_id": 44515677, "link": "https://stackoverflow.com/questions/44515677/how-to-return-valid-jsonapi-response-using-google-jsonapi-and-echo-framework/44528288#44528288", "title": "How to return valid jsonapi response using google/jsonapi and echo framework", "body": "<p>You're code looks alright. However it can be simplified-</p>\n\n<pre><code>var b bytes.Buffer // you could use buffer pool here\nerr := jsonapi.MarshalManyPayload(&amp;b, albumList())\nif err != nil {\n    return err\n}\nreturn c.JSONBlob(http.StatusOK, b.Bytes())\n</code></pre>\n\n<hr>\n\n<p>Following approaches for your thoughts:</p>\n\n<p>Approach 1 -</p>\n\n<pre><code>c.Response().Header().Set(echo.HeaderContentType, jsonapi.MediaType)\nc.Response().WriteHeader(http.StatusOK)\nreturn jsonapi.MarshalManyPayload(c.Response(), albumList())\n</code></pre>\n\n<hr>\n\n<p>Approach 2 -</p>\n\n<pre><code>var b bytes.Buffer // you could use buffer pool here\nerr := jsonapi.MarshalManyPayload(&amp;b, albumList())\nif err != nil {\n    return err\n}\nc.Response().Header().Set(echo.HeaderContentType, jsonapi.MediaType)\nc.Response().WriteHeader(http.StatusOK)\n_, err := b.WriteTo(c.Response())\nreturn err\n</code></pre>\n"}], "owner": {"reputation": 6283, "user_id": 434792, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/11d0482f7d0ebdbe1d42c81f7817db5d?s=128&d=identicon&r=PG", "display_name": "michaelbn", "link": "https://stackoverflow.com/users/434792/michaelbn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 1, "accepted_answer_id": 44528288, "answer_count": 1, "score": 1, "last_activity_date": 1497441659, "creation_date": 1497341129, "question_id": 44515677, "link": "https://stackoverflow.com/questions/44515677/how-to-return-valid-jsonapi-response-using-google-jsonapi-and-echo-framework", "title": "How to return valid jsonapi response using google/jsonapi and echo framework", "body": "<p>The code bellow return a two concated JSON strings and a wrong content-type <code>text/plain</code>. Should be <code>application/vnd.api+json</code></p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/google/jsonapi\"\n    \"github.com/labstack/echo\"\n    \"net/http\"\n)\n\ntype Album struct {\n    ID   int    `jsonapi:\"primary,albums\"`\n    Name string `jsonapi:\"attr,name\"`\n}\n\nfunc main() {\n    e := echo.New()\n    e.GET(\"/\", func(c echo.Context) error {\n        jsonapi.MarshalManyPayload(c.Response(), albumList())\n        return c.JSON(http.StatusOK, c.Response())\n    })\n    e.Logger.Fatal(e.Start(\":1323\"))\n}\n\nfunc albumList() []*Album {\n    a1 := Album{123, \"allbum1\"}\n    a2 := Album{456, \"allbum2\"}\n    albums := []*Album{&amp;a1, &amp;a2}\n    return albums\n}\n</code></pre>\n\n<p>faulty output (two concated jsons). The first is a correct <code>jsonapi</code> structure and I think the second is related to <code>echo-framework</code>:</p>\n\n<pre><code>{\n  \"data\": [\n    {\n      \"type\": \"albums\",\n      \"id\": \"123\",\n      \"attributes\": {\n    \"name\": \"allbum1\"\n      }\n    },\n    {\n      \"type\": \"albums\",\n      \"id\": \"456\",\n      \"attributes\": {\n    \"name\": \"allbum2\"\n      }\n    }\n  ]\n}\n{\n  \"Writer\": {},\n  \"Status\": 200,\n  \"Size\": 133,\n  \"Committed\": true\n}\n</code></pre>\n\n<p>This code fix the problem but is seems awkward. I have the feeling there is a better way to facilitate it using <code>echo</code>.</p>\n\n<pre><code>e.GET(\"/\", func(c echo.Context) error {\n    var b bytes.Buffer\n    body := bufio.NewWriter(&amp;b)\n    err := jsonapi.MarshalManyPayload(body, albumList())\n    if err != nil {\n        fmt.Println(err)\n    }\n    body.Flush()\n    return c.JSONBlob(http.StatusOK, b.Bytes())\n})\n</code></pre>\n\n<p>Any idea?</p>\n"}, {"tags": ["go", "gokogiri"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497332554, "post_id": 44512577, "comment_id": 76019009, "body": "Probably you also need to install <a href=\"http://brewformulas.org/Libxslt\" rel=\"nofollow noreferrer\"><code>libxslt</code></a>. Then after installing both <code>libxml2</code> and <code>libxslt</code>, I think you need to perform <code>go get -u github.com&#47;moovweb&#47;gokogiri</code> to recompile the package."}, {"owner": {"reputation": 1236, "user_id": 1289628, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4ce1c64def03a08f11757ead0ae2b43a?s=128&d=identicon&r=PG", "display_name": "Subhash Chandran", "link": "https://stackoverflow.com/users/1289628/subhash-chandran"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497346116, "post_id": 44512577, "comment_id": 76026990, "body": "Did <code>brew install libxslt</code>, still no luck :-("}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 2, "creation_date": 1497347394, "post_id": 44512577, "comment_id": 76027973, "body": "I found <a href=\"https://github.com/shirou/gopsutil/issues/339\" rel=\"nofollow noreferrer\">this issue</a>. Upgrade to <code>go1.8.1</code> or build with <code>go build -ldflags=-s</code>."}, {"owner": {"reputation": 1236, "user_id": 1289628, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4ce1c64def03a08f11757ead0ae2b43a?s=128&d=identicon&r=PG", "display_name": "Subhash Chandran", "link": "https://stackoverflow.com/users/1289628/subhash-chandran"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497358995, "post_id": 44512577, "comment_id": 76036486, "body": "@putu your solution works as a charm :-) Can you post that as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 1, "last_activity_date": 1497361667, "creation_date": 1497361667, "answer_id": 44523442, "question_id": 44512577, "link": "https://stackoverflow.com/questions/44512577/adding-gokogiri-dependency-causes-killed-9-exit/44523442#44523442", "title": "Adding gokogiri dependency causes `Killed: 9` exit", "body": "<p>According to <a href=\"https://github.com/shirou/gopsutil/issues/339\" rel=\"nofollow noreferrer\">similar issue</a>, and also in <a href=\"https://github.com/golang/go/issues/19734\" rel=\"nofollow noreferrer\"><code>Golang issue #19734</code></a>, <code>cgo</code> command broken on darwin after performing c tool-chain (Xcode 8.3) update from Apple.</p>\n\n<p>The solution: <code>upgrade to go1.8.1 or above</code> or add <code>-ldflags=-s</code> to <code>build</code> or <code>test</code> command, e.g. <code>go build -ldflags=-s</code>.</p>\n"}], "owner": {"reputation": 1236, "user_id": 1289628, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4ce1c64def03a08f11757ead0ae2b43a?s=128&d=identicon&r=PG", "display_name": "Subhash Chandran", "link": "https://stackoverflow.com/users/1289628/subhash-chandran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 44523442, "answer_count": 1, "score": 0, "last_activity_date": 1497361667, "creation_date": 1497329179, "question_id": 44512577, "link": "https://stackoverflow.com/questions/44512577/adding-gokogiri-dependency-causes-killed-9-exit", "title": "Adding gokogiri dependency causes `Killed: 9` exit", "body": "<p>The environment I am using is <code>go1.8</code> on MacOS Sierra.</p>\n\n<p>The code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n\n    \"github.com/moovweb/gokogiri\"\n    \"github.com/moovweb/gokogiri/xpath\"\n)\n\nfunc main() {\n    fmt.Println(\"hello world\")\n    b, _ := ioutil.ReadFile(\"x.xml\")\n    fmt.Println(string(b))\n    doc, _ := gokogiri.ParseXml(b)\n    compiled := xpath.Compile(\"/path/to/node\")\n    ss, _ := doc.Root().Search(compiled)\n    for _, s := range ss {\n        fmt.Println(s.Content())\n    }\n}\n</code></pre>\n\n<p>After I build and run:</p>\n\n<pre><code>$ ./hello-world\nKilled: 9\n</code></pre>\n\n<p>Even the <code>hello world</code> message is not printed. Later on, on investigating the <a href=\"https://github.com/moovweb/gokogiri\" rel=\"nofollow noreferrer\">gokogiri</a> README, I saw instructions on installing libxml2. So I did <code>brew install libxml2</code> and tried, and that also did not fix the issue.</p>\n"}, {"tags": ["pointers", "go", "reference"], "comments": [{"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 4, "creation_date": 1497331960, "post_id": 44512567, "comment_id": 76018762, "body": "there is no reference in golang, only pointer. and all parameters are passed by value."}, {"owner": {"reputation": 4792, "user_id": 3957182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/43d0d6b75c03b847afbf11f7bd274ecb?s=128&d=identicon&r=PG&f=1", "display_name": "wandermonk", "link": "https://stackoverflow.com/users/3957182/wandermonk"}, "reply_to_user": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1497332043, "post_id": 44512567, "comment_id": 76018787, "body": "@zzn i was not expecting an objective answer. Could you please take some of your valuable time to elaborate?"}, {"owner": {"reputation": 4792, "user_id": 3957182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/43d0d6b75c03b847afbf11f7bd274ecb?s=128&d=identicon&r=PG&f=1", "display_name": "wandermonk", "link": "https://stackoverflow.com/users/3957182/wandermonk"}, "reply_to_user": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1497333087, "post_id": 44512567, "comment_id": 76019238, "body": "@zzn thank you i got the resource <a href=\"https://kuree.gitbooks.io/the-go-programming-language-report/content/26/text.html\" rel=\"nofollow noreferrer\">kuree.gitbooks.io/the-go-programming-language-report/content&zwnj;&#8203;/26/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 1, "creation_date": 1497333207, "post_id": 44512567, "comment_id": 76019283, "body": "As @zzn said: Go has absolutely no notion of &quot;pass by reference&quot; so it simply makes no sense to talk or reason about references in Go. Speculating about how Go would profit from &quot;references&quot; is pretty esoteric (as it won&#39;t happen). Several methods on <code>http.Request</code> modify the request thus require a pointer receiver thus requests are handled around as pointers everywhere. This is called consistency and has nothing to do with syntactic sugar or readability."}, {"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1497333218, "post_id": 44512567, "comment_id": 76019288, "body": "i don&#39;t really clear what&#39;s problem here. typically, if the value is too large to copy, or want to modify it, you should use pointer. golang actually a more safe language, pointer is not that dangerous. <code>r</code> is only a valid <code>http.Request</code> pointer or <code>nil</code>, no other cases. but in this case, only valid http.Request pointer actually."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1497333451, "post_id": 44512567, "comment_id": 76019361, "body": "Regarding the additional question &quot;Please throw some light if my understanding is wrong.&quot; Yes, totally. Whether <code>r</code> points to some existing request or is nil (there are no other options) depends on how <code>hello</code> is called and on nothing else. To learn about pointers work through the Tour of Go starting from <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/1</a>"}, {"owner": {"reputation": 5945, "user_id": 2664985, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b481e39808c4dd2db7a66c1931a9bb08?s=128&d=identicon&r=PG", "display_name": "Jack Wilsdon", "link": "https://stackoverflow.com/users/2664985/jack-wilsdon"}, "edited": false, "score": 0, "creation_date": 1548980610, "post_id": 44512567, "comment_id": 95750106, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13255907/in-go-http-handlers-why-is-the-responsewriter-a-value-but-the-request-a-pointer\">In Go HTTP handlers, why is the ResponseWriter a value but the Request a pointer?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4792, "user_id": 3957182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/43d0d6b75c03b847afbf11f7bd274ecb?s=128&d=identicon&r=PG&f=1", "display_name": "wandermonk", "link": "https://stackoverflow.com/users/3957182/wandermonk"}, "edited": false, "score": 0, "creation_date": 1497333939, "post_id": 44513396, "comment_id": 76019534, "body": "Well thanks for pointing to the right source. <a href=\"http://www.airs.com/blog/archives/281\" rel=\"nofollow noreferrer\">airs.com/blog/archives/281</a> this blog made me more sense."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1497365093, "post_id": 44513396, "comment_id": 76041368, "body": "&quot;ResponseWriter is an interface&quot; is an important detail - it means that what you receive as the ResponseWriter <i>is also a pointer</i>."}], "tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": true, "score": 1, "last_activity_date": 1497333656, "creation_date": 1497333656, "answer_id": 44513396, "question_id": 44512567, "link": "https://stackoverflow.com/questions/44512567/why-the-request-is-a-pointer-variable-why-not-a-reference-variable/44513396#44513396", "title": "Why the request is a pointer variable? Why not a reference variable?", "body": "<p>Duplicate of <a href=\"https://stackoverflow.com/questions/13255907/in-go-http-handlers-why-is-the-responsewriter-a-value-but-the-request-a-pointer\">In Go HTTP handlers, why is the ResponseWriter a value but the Request a pointer?</a></p>\n\n<p>Mainly the ResponseWriter is an interface (you may want to understand more about interfaces, just in case you haven't gone over it). Just to add, the request is a pointer to a struct - there's no point in having a copy of the request struct (which happens when passed by value), so it's not passed as a struct (think of it esp. when you pass it downstream to other functions, you can just pass this down directly)</p>\n"}, {"tags": [], "owner": {"reputation": 2788, "user_id": 989991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/x05ME.png?s=128&g=1", "display_name": "joakim", "link": "https://stackoverflow.com/users/989991/joakim"}, "is_accepted": false, "score": 1, "last_activity_date": 1562175070, "last_edit_date": 1592644375, "creation_date": 1562175070, "answer_id": 56875336, "question_id": 44512567, "link": "https://stackoverflow.com/questions/44512567/why-the-request-is-a-pointer-variable-why-not-a-reference-variable/56875336#56875336", "title": "Why the request is a pointer variable? Why not a reference variable?", "body": "<p>As correctly mentioned in many other answers here and elsewhere, <code>ResponseWriter</code> is an interface and the implications of this have beed described in detail in <em>SO</em> answers and blogs.</p>\n<p>What I would like to address is what I feel is the big\u2014and dangerous\u2014misconception here, that the reason request is passed by &quot;reference&quot; (although such a thing does not really exist in <em>Go</em>) is that &quot;we want to make changes to it visible to the server&quot;.</p>\n<p>Quoting a couple of answers from other people:</p>\n<blockquote>\n<p>[..]it's just a struct, and since we want to change this struct and have the web server see those changes, it has to be a pointer[..] <a href=\"https://stackoverflow.com/a/13256311/989991\">SO</a></p>\n<p>[..]changes to Request by the handler need to be visible to the server, so we\u2019re only passing it by reference instead of by value [..] <a href=\"https://stackoverflow.com/a/48679117/989991\">SO</a></p>\n</blockquote>\n<p><strong>This is wrong</strong>; in fact <a href=\"https://godoc.org/net/http#Handler\" rel=\"nofollow noreferrer\">the docs explicitly warn against tampering with / mutating the request</a>:</p>\n<blockquote>\n<p>Except for reading the body, handlers should not modify the provided Request.</p>\n</blockquote>\n<p>Quite the opposite, no? :-)</p>\n<p>If you want to change the request, e.g. append a tracing header before passing it on to the next handler in a middleware chain <em>you have to copy the request</em> and pass the copied version down the chain.</p>\n<p>Why use a pointer if we are explicitly telling people not to mutate the request? <strong>Performance</strong>, <code>Request</code> is a large struct and copying it can bring performance down, especially with long middleware chains in mind. The team had to strike a balance, definitely not an ideal solution, but the tradeoffs are clearly on the side of performance here (instead of API safety).</p>\n"}], "owner": {"reputation": 4792, "user_id": 3957182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/43d0d6b75c03b847afbf11f7bd274ecb?s=128&d=identicon&r=PG&f=1", "display_name": "wandermonk", "link": "https://stackoverflow.com/users/3957182/wandermonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 2, "accepted_answer_id": 44513396, "answer_count": 2, "score": 2, "last_activity_date": 1562175070, "creation_date": 1497329122, "last_edit_date": 1497350473, "question_id": 44512567, "link": "https://stackoverflow.com/questions/44512567/why-the-request-is-a-pointer-variable-why-not-a-reference-variable", "title": "Why the request is a pointer variable? Why not a reference variable?", "body": "<p>I have been learning GO Lang for a month now. I have been coding in java for more than 4 years. In java the Request and Response both are object references. But, when it comes to GoLang the Response is a object reference and the Request is a Pointer Reference.</p>\n\n<p>A reference, like a pointer, is an object that you can use to refer indirectly to another object. A reference declaration has essentially the same syntactic structure as a pointer declaration.</p>\n\n<pre><code>func hello(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello world!\")\n}\n</code></pre>\n\n<p>Apart from the readability perspective and the syntactic sugar is there any other intention behind using the Request as a pointer variable.</p>\n\n<p>Adding to the above question the request here is an arbitrary pointer. i.e the request is not yet exists but the pointer is already referring to a memory location. Please throw some light if my understanding is wrong. </p>\n"}, {"tags": ["file", "go", "io", "system-calls", "mmap"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497341120, "post_id": 44512345, "comment_id": 76023714, "body": "Probably I don&#39;t get what you mean. If you&#39;re using <code>mmap</code>, isn&#39;t the content of the file will be available as <code>[]byte</code>?. To get the string, you can do <code>string(mmap[:100])</code> &lt;-- convert first 100 bytes to a string. Or you can use <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow noreferrer\"><code>bytes.Buffer</code></a> (but probably not what you want since you&#39;re avoiding io.reader/io.writer pattern)"}, {"owner": {"reputation": 493, "user_id": 1525079, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ad6a9e8944ef2aedf0f9dd0436c47af?s=128&d=identicon&r=PG", "display_name": "anirudh.vyas", "link": "https://stackoverflow.com/users/1525079/anirudh-vyas"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497420146, "post_id": 44512345, "comment_id": 76064155, "body": "I wanna avoid reader - but my problem is I suspect while writing string to bytes via mmap it&#39;s not flushing legit chars just some control chars - I suspect my encoding might be screwed up - any suggestions?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497425206, "post_id": 44512345, "comment_id": 76067063, "body": "Take a look at <a href=\"https://github.com/riobard/go-mmap\" rel=\"nofollow noreferrer\"><code>https:&#47;&#47;github.com&#47;riobard&#47;go-mmap</code></a>. That package can be used as a reference on <code>mmap</code> usage. For writing string to <code>mmap</code>, you can do <code>copy(mmap, []byte(&quot;Your string&quot;))</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1497707546, "post_id": 44512345, "comment_id": 76197801, "body": "<i>There are a number of reasons I do mmap and munmap as opposed to read, write I/O.</i> And if those reasons are performance related, did you bother to actually benchmark <code>mmap()</code> vs. <code>read()</code>/<code>write()</code>? Because if you&#39;re using <code>mmap()</code> like this for performance reasons, you&#39;re almost certainly wrong. <a href=\"https://stackoverflow.com/a/9818473/4756299\">Read this answer</a>, and especially the two links to one Linus Torvalds explaining how <code>mmap()</code> can be <b><i>SLOW</i></b>. And note that as good as that answer is, the author blows it at the end by comparing <code>mmap()</code> to <code>fread()</code> - buffered, <code>stdio</code>-based and slow."}], "answers": [{"comments": [{"owner": {"reputation": 493, "user_id": 1525079, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ad6a9e8944ef2aedf0f9dd0436c47af?s=128&d=identicon&r=PG", "display_name": "anirudh.vyas", "link": "https://stackoverflow.com/users/1525079/anirudh-vyas"}, "edited": false, "score": 0, "creation_date": 1497420062, "post_id": 44524821, "comment_id": 76064117, "body": "That doesn&#39;t work - I am doing an unsafe pointer conversion to byte array gotten from mmap to get a string array pointer - but when I read I see some control chars maybe I&#39;m not encoding string to bytes right way when I&#39;m flushing them to file via mmap?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 493, "user_id": 1525079, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ad6a9e8944ef2aedf0f9dd0436c47af?s=128&d=identicon&r=PG", "display_name": "anirudh.vyas", "link": "https://stackoverflow.com/users/1525079/anirudh-vyas"}, "edited": false, "score": 0, "creation_date": 1497446514, "post_id": 44524821, "comment_id": 76082629, "body": "Possible the control chars are in the data, possible the encoding coming out doesn&#39;t match the encoding going in, and possible you&#39;re doing a string conversion on a byte slice that starts in the middle of a multi-byte UTF-8 code point."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1497365223, "creation_date": 1497365223, "answer_id": 44524821, "question_id": 44512345, "link": "https://stackoverflow.com/questions/44512345/mmap-syscall-using-golang-for-reads/44524821#44524821", "title": "mmap syscall using Golang for reads", "body": "<p>As @putu noted in a comment, a byte slice can be converted to a string by a simple type conversion:</p>\n\n<pre><code>asStr = string(byteSlice) // entire slice as a string\npartStr = string(byteSlice[:100]) // first 100 bytes as a string\n</code></pre>\n"}], "owner": {"reputation": 493, "user_id": 1525079, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ad6a9e8944ef2aedf0f9dd0436c47af?s=128&d=identicon&r=PG", "display_name": "anirudh.vyas", "link": "https://stackoverflow.com/users/1525079/anirudh-vyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1811, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1497365223, "creation_date": 1497327717, "question_id": 44512345, "link": "https://stackoverflow.com/questions/44512345/mmap-syscall-using-golang-for-reads", "title": "mmap syscall using Golang for reads", "body": "<p>I am not an Go unsafe package expert - Neither am I a seasoned C programmer. I am trying to read a huge file > 1G using mmap syscall in go. There are a number of reasons I do mmap and munmap as opposed to read, write I/O. That is beside the point -  I can write to the file in a test, when I read from the file, I can ascertain that bytes length matches up, but I cannot read contents of this string file :( Can someone suggest some reading? I need to do to go a little further, here's some code I cooked up for sample test:</p>\n\n<pre><code>filename := \"/tmp/dd_file.db\"\nf, err := os.OpenFile(filename, os.O_RDWR, 0666)\ndefer f.Close()\nif err != nil {\n    fmt.Printf(\"error opening file: %v\", err)\n}\nstat, _ := f.Stat()\nsize := stat.Size()\nfmt.Printf(\"[READ-ONLY] : size was : %+v\\n\", size)\ngot := make([]byte, size)\nif _, err := f.ReadAt(got, 0); err != nil &amp;&amp; err != io.EOF {\n    panic(err)\n}\nwant, err := ioutil.ReadFile(filename)\nif err != nil {\n    fmt.Printf(\"[READ-ONLY] : ioutil.ReadFile: %v\", err)\n}\n// going to change the file size now, punch in a few things\nt := unsafe.Sizeof(\"\")\nif err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n}\n_, err = f.Seek(int64(t-1), 0)\nif err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n}\n_, err = f.Write([]byte(\" \"))\nif err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n}\nmmap, err := syscall.Mmap(int(f.Fd()), 0, int(t), syscall.PROT_READ|syscall.PROT_WRITE, syscall.MAP_SHARED)\nif err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n}\n // not too sure on reading data on string - doesnt work as expected.\nmap_array := (*[10000]string)(unsafe.Pointer(&amp;mmap[0]))\nmap_array[0] = \"yellow!\"\nerr = syscall.Munmap(mmap)\nif err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n}\nnewStat, _ := f.Stat()\nnewSize := newStat.Size()\nfmt.Printf(\"[mmap( ) RW] : size was : %+v\\n\", newSize)\ngot = make([]byte, newSize)\nif _, err := f.ReadAt(got, 0); err != nil &amp;&amp; err != io.EOF {\n    panic(err)\n}\nif len(got) == len(want) {\n    fmt.Println(\"well the lengths are equal atleast??!\")\n}\nif !bytes.Equal(got, want) {\n    fmt.Printf(\"\\n [mmap( ) RW] : works! got  %d \\n want %d\", len(got), len(want))\n}\n</code></pre>\n\n<p>This obviously works as expected - but what if I wanted to read via mmap( ) on an mmapped file, how do I read string out of these bytes (I have a sense there is an encoding package somewhere that I might have to put to use perhaps but then StringHeader on unsafe documentation confused me).</p>\n\n<p>Suggestions.</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1497333655, "post_id": 44512343, "comment_id": 76019437, "body": "I&#39;m sorry, you can&#39;t. But there is <code>grep</code> which works as well."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497365599, "post_id": 44518901, "comment_id": 76041773, "body": "<i>Assuming they&#39;re using Linux.</i>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497365651, "post_id": 44518901, "comment_id": 76041810, "body": "Also note this will list test functions but not subtests run with <code>T.Run</code>."}, {"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497426364, "post_id": 44518901, "comment_id": 76067812, "body": "@Adrian it will also work on Mac if they install GNU grep."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497445997, "post_id": 44518901, "comment_id": 76082204, "body": "It&#39;ll work on Windows if they install GNUWin32 grep &amp; find also, but I imagine most people haven&#39;t."}], "tags": [], "owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "is_accepted": false, "score": 1, "last_activity_date": 1497355397, "last_edit_date": 1497355397, "creation_date": 1497349701, "answer_id": 44518901, "question_id": 44512343, "link": "https://stackoverflow.com/questions/44512343/list-tests-but-dont-run-them/44518901#44518901", "title": "List tests but don&#39;t run them", "body": "<p>There is no <code>go</code> subcommand for that, but you can do it with a little bit of <code>find</code> and <code>grep</code> (GNU version, for the <code>-P</code> flag) magic:</p>\n\n<pre><code>find /path/to/your/project -not -path \"./vendor\" -type f -name \"*_test.go\" -exec cat {} \\; | grep -oP '^func (\\w+)\\(\\w \\*testing\\.T\\) {$' | grep -oP ' \\w+' | grep -oP '\\w+';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1497532946, "creation_date": 1497532946, "answer_id": 44568708, "question_id": 44512343, "link": "https://stackoverflow.com/questions/44512343/list-tests-but-dont-run-them/44568708#44568708", "title": "List tests but don&#39;t run them", "body": "<p>In go1.9 the <code>go test</code> command accepts a new <code>-list</code> flag, which takes a regular expression as an argument and prints to stdout the name of any tests, benchmarks, or examples that match it, without running them.</p>\n\n<p>The <a href=\"https://tip.golang.org/cmd/go/#hdr-Description_of_testing_flags\" rel=\"nofollow noreferrer\">test flags documentation</a> can be found under <a href=\"https://tip.golang.org\" rel=\"nofollow noreferrer\">https://tip.golang.org</a> until the official go1.9 release. </p>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 44568708, "answer_count": 2, "score": 2, "last_activity_date": 1497532946, "creation_date": 1497327713, "question_id": 44512343, "link": "https://stackoverflow.com/questions/44512343/list-tests-but-dont-run-them", "title": "List tests but don&#39;t run them", "body": "<p>How do I list the tests available to <code>go test</code> without running them? I want to know what tests (including subtests) are present so I can manually pick a subset of them to run with a later command. I would expect something like <code>go test -l</code> or <code>go test -n</code> for something like this.</p>\n"}, {"tags": ["file", "http", "go", "server"], "answers": [{"comments": [{"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1497340431, "post_id": 44510724, "comment_id": 76023285, "body": "w.Header().Set(&quot;Content-Disposition&quot;, &quot;attachment; filename=YOURNAME&quot;)  &lt;- this is what I was looking for, thank you"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 9, "last_activity_date": 1497358343, "last_edit_date": 1497358343, "creation_date": 1497314740, "answer_id": 44510724, "question_id": 44510661, "link": "https://stackoverflow.com/questions/44510661/golang-communicating-the-name-of-the-file-served-to-the-browser-client/44510724#44510724", "title": "Golang communicating the name of the file served to the browser/client", "body": "<p>Set the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition\" rel=\"noreferrer\">content disposition</a> header before serving the content:</p>\n\n<pre><code>f, err := os.Open(file.Path)\nif err != nil {\n    // handle error\n}\ndefer f.Close()\nfi, err := f.Stat()\nif err != nil {\n     // handle error\n}\nw.Header().Set(\"Content-Disposition\", \"attachment; filename=YOURNAME\")\nhttp.ServeContent(w, r, file.Name, fi.ModTime(), f)\n</code></pre>\n\n<p>Note that this code passes an *os.File directly to ServeContent instead of reading the entire file to memory.</p>\n\n<p>The code can be simplified further by calling <a href=\"https://godoc.org/net/http#ServeFile\" rel=\"noreferrer\">ServeFile</a>:</p>\n\n<pre><code>w.Header().Set(\"Content-Disposition\", \"attachment; filename=YOURNAME\")\nhttp.ServeFile(w, r, file.Name)\n</code></pre>\n"}], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1789, "favorite_count": 0, "accepted_answer_id": 44510724, "answer_count": 1, "score": 4, "last_activity_date": 1497358343, "creation_date": 1497314122, "question_id": 44510661, "link": "https://stackoverflow.com/questions/44510661/golang-communicating-the-name-of-the-file-served-to-the-browser-client", "title": "Golang communicating the name of the file served to the browser/client", "body": "<p>I'm serving some files dynamically using golang and the following code handles the actual serving of files:</p>\n\n<pre><code>        data, err := ioutil.ReadFile(file.Path)\n        logo.RuntimeError(err)\n        http.ServeContent(w, r, file.Name, time.Now(), bytes.NewReader(data))\n</code></pre>\n\n<p>Within the previous code \"file\" is simply a custom struct holding various information about the file. </p>\n\n<p>The only problem with this code is that it results in me downloading a file called \"download\" whenever I call the specific handler. I'd like to give the file the user is downloading a custom name, or, rather, signify in a way that is as browser neutral as possible that I want the file to have a certain name.</p>\n\n<p>I assume this might be doable using w.WriteHeader ? But I've been unable to find any examples or clear guidelines on how to do this.</p>\n"}, {"tags": ["javascript", "jquery", "go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8151453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67237883636affc611fad15053751bf?s=128&d=identicon&r=PG&f=1", "display_name": "ReginadScarr", "link": "https://stackoverflow.com/users/8151453/reginadscarr"}, "edited": false, "score": 0, "creation_date": 1497311391, "post_id": 44510109, "comment_id": 76013601, "body": "So, for whatever reason (maybe I had changed something without realizing it) - but after I did what you said I&#39;m actually getting back the correct _gorilla_csrf - it wasn&#39;t coming through before. That being said, I&#39;m still getting 403 forbiddens when setting the X-CSRF-Token header to the value returned by getCookie, any idea why?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 1, "user_id": 8151453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67237883636affc611fad15053751bf?s=128&d=identicon&r=PG&f=1", "display_name": "ReginadScarr", "link": "https://stackoverflow.com/users/8151453/reginadscarr"}, "edited": false, "score": 0, "creation_date": 1497311624, "post_id": 44510109, "comment_id": 76013656, "body": "@ReginadScarr Good to hear, you&#39;re getting the correct <code>_gorilla_csrf</code> cookie. You can accept the answer, I believe."}, {"owner": {"reputation": 1, "user_id": 8151453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67237883636affc611fad15053751bf?s=128&d=identicon&r=PG&f=1", "display_name": "ReginadScarr", "link": "https://stackoverflow.com/users/8151453/reginadscarr"}, "edited": false, "score": 0, "creation_date": 1497320165, "post_id": 44510109, "comment_id": 76015520, "body": "So, it looks like i&#39;m not actually getting the right key... it sends back the same thing, every time, without fail. I&#39;m at a loss as what to do here."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 1, "user_id": 8151453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67237883636affc611fad15053751bf?s=128&d=identicon&r=PG&f=1", "display_name": "ReginadScarr", "link": "https://stackoverflow.com/users/8151453/reginadscarr"}, "edited": false, "score": 0, "creation_date": 1497322756, "post_id": 44510109, "comment_id": 76016071, "body": "That&#39;s strange. Okay let me give it try at my end and let you know."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 1, "user_id": 8151453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67237883636affc611fad15053751bf?s=128&d=identicon&r=PG&f=1", "display_name": "ReginadScarr", "link": "https://stackoverflow.com/users/8151453/reginadscarr"}, "edited": false, "score": 0, "creation_date": 1497323854, "post_id": 44510109, "comment_id": 76016339, "body": "I have tried the sample code from gorilla pkg, it works perfectly. For your reference <a href=\"https://play.golang.org/p/jVKR7dtPrV\" rel=\"nofollow noreferrer\">play.golang.org/p/jVKR7dtPrV</a>"}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": false, "score": 1, "last_activity_date": 1497309943, "creation_date": 1497309943, "answer_id": 44510109, "question_id": 44509679, "link": "https://stackoverflow.com/questions/44509679/issues-with-gorilla-csrf/44510109#44510109", "title": "Issues with gorilla/csrf", "body": "<p>It seems you're overwriting the gorilla created real CSRF token using this line. Gorilla is using session store to keep real CSRF tokens for validation.</p>\n\n<pre><code>w.Header().Set(\"Set-Cookie\", \"_gorilla_csrf=\"+csrf.Token(r))\n</code></pre>\n\n<p>Please do not touch <code>_gorilla_csrf</code> this cookie.</p>\n\n<p>Gorilla supports the CSRF via <code>form field</code> and <code>header</code> only. So pick your choice, their <a href=\"https://github.com/gorilla/csrf/blob/master/README.md\" rel=\"nofollow noreferrer\">readme</a> has required information you need (Form field, Header and Customizing field name &amp; header name).</p>\n\n<p><code>gorilla/csrf</code> checks CSRF token in this order:</p>\n\n<blockquote>\n  <p>gorilla/csrf inspects the HTTP headers (first) and form body (second) on subsequent POST/PUT/PATCH/DELETE/etc. requests for the token.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 8151453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67237883636affc611fad15053751bf?s=128&d=identicon&r=PG&f=1", "display_name": "ReginadScarr", "link": "https://stackoverflow.com/users/8151453/reginadscarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497319791, "creation_date": 1497306732, "last_edit_date": 1497319791, "question_id": 44509679, "link": "https://stackoverflow.com/questions/44509679/issues-with-gorilla-csrf", "title": "Issues with gorilla/csrf", "body": "<p>So, for the life of me I cannot figure out how to get gorilla's csrf to work when not injecting it straight into fields. It keeps talking about passing it through headers and cookies, but nothing I do seems to work... here's what I have for my go server:</p>\n\n<p>`</p>\n\n<pre><code>package main\nimport (\n    \"gorilla/mux\"\n    \"gorilla/csrf\"\n    \"net/http\"\n    \"log\"\n    \"encoding/json\"\n    \"http/template\"\n    \"time\"\n)\n\nfunc showLoginPage(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Set-Cookie\", \"_gorilla_csrf=\"+csrf.Token(r))\n    templates.ExecuteTemplate(w, \"&lt;template_here&gt;\", nil)\n}\n\n\nfunc doLogin(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Set-Cookie\", \"_gorilla_csrf=\"+csrf.Token(r))\n    /**\n    builds resp\n    **/\n    w.Write(resp)\n}\n\nfunc main() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/login\", showLoginPage).Methods(\"GET\")\n    r.HandleFunc(\"/login\", doLogin).Methods(\"POST\")\n    r.PathPrefix(\"/js/\").Handler(http.StripPrefix(\"/js/\", http.FileServer(http.Dir(\"./js\"))))\n    r.PathPrefix(\"/css/\").Handler(http.StripPrefix(\"/css/\", http.FileServer(http.Dir(\"./css\"))))\n\n    srv := &amp;http.Server{\n          Handler:      csrf.Protect([]byte(\"very-secret-string\"), csrf.Secure(false))(r),\n          Addr:         \"127.0.0.1:8000\",\n          // Good practice: enforce timeouts for servers you create!\n          WriteTimeout: 15 * time.Second,\n          ReadTimeout:  15 * time.Second,\n    }\n    log.Fatal(srv.ListenAndServe())\n}\n</code></pre>\n\n<p>`</p>\n\n<p>whereas, on my frontend I have this so that all requests get updated:\n`</p>\n\n<pre><code>var getCookie = function(cname) {\n  var name = cname + \"=\";\n  var ca = document.cookie.split(';');\n  for (var i = 0; i &lt; ca.length; i++) {\n      var c = ca[i];\n      while (c.charAt(0) == ' ') c = c.substring(1);\n      if (c.indexOf(name) == 0) return c.substring(name.length, c.length);\n  }\n  return \"\";\n};\n$.ajaxPrefilter(function( options ) {\n    options.beforeSend = function (xhr) { \n        xhr.setRequestHeader('X-CSRF-Token', getCookie('_gorilla_csrf'));\n    }\n});\n</code></pre>\n\n<p>`</p>\n\n<p>I know I have to be missing something, but I really just can't seem to grasp this at all. Any help would be very appreciated.</p>\n"}, {"tags": ["arrays", "go", "multidimensional-array", "reflection", "slice"], "answers": [{"tags": [], "owner": {"reputation": 349, "user_id": 1862123, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/17a3486a39c8d9d47d10e9c76a31d9d1?s=128&d=identicon&r=PG", "display_name": "Richard John Catalano", "link": "https://stackoverflow.com/users/1862123/richard-john-catalano"}, "is_accepted": false, "score": 0, "last_activity_date": 1497296964, "creation_date": 1497296964, "answer_id": 44507611, "question_id": 44507308, "link": "https://stackoverflow.com/questions/44507308/how-to-make-a-multidimensional-array-or-slice-using-reflection/44507611#44507611", "title": "How to make a Multidimensional Array or Slice using Reflection", "body": "<p>Okay, I guess I didn't look at it hard enough the first time, but the answer is kind of obvious in retrospect. I made an example using this Go Playground right here: <a href=\"https://play.golang.org/p/J0pAGNIpDX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/J0pAGNIpDX</a></p>\n\n<p>ICYMI, the basic way is to take the type of the type you're working with (the base type) and then run the SliceOf/ArrayOf functions on the type in a loop for as many dimensions as you need. </p>\n"}], "owner": {"reputation": 349, "user_id": 1862123, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/17a3486a39c8d9d47d10e9c76a31d9d1?s=128&d=identicon&r=PG", "display_name": "Richard John Catalano", "link": "https://stackoverflow.com/users/1862123/richard-john-catalano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499886329, "creation_date": 1497295641, "last_edit_date": 1497344587, "question_id": 44507308, "link": "https://stackoverflow.com/questions/44507308/how-to-make-a-multidimensional-array-or-slice-using-reflection", "title": "How to make a Multidimensional Array or Slice using Reflection", "body": "<p>I am currently working on a project to create a binding in Go for another language that utilizes multidimensional arrays. I'm trying to find a dynamic way to arbitarily create a slice of slices or array of arrays with potentially multiple dimensions. I am currently looking through the reflect documentation but nothing is jumping out at me that seems to be an intuitive method for doing what I need to do.</p>\n\n<p>For context, I can get the type information and parse it into this struct:</p>\n\n<pre><code>const (\n    IntTy byte = iota\n    UintTy\n    BoolTy\n    StringTy\n    AddressTy\n    HashTy\n    FixedPointTy\n    FunctionTy\n    FixedBytesTy\n    StaticArrayTy\n    DynamicArrayTy\n    MultiDimensionalArrayTy\n    StructTy\n    BytesTy\n)\n\n// Type is the reflection of the supported argument type\ntype Type struct {\n    // Slice descriptions\n    IsStatic           bool // Determines if its a static array\n    IsDynamic          bool // Determines if its a dynamic array\n    IsMultiDimensional bool // Determine if there is more than dimension to the array\n    SliceSize          int  // Size of the slice if it's static\n    Dimensions         int  // Number of dimensions if type is a multidimensional array\n\n    // If applicable (struct, slice), the underlying type\n    Elem *Type\n\n    Kind           reflect.Kind // corresponding go Kind.\n    Type           reflect.Type // corresponding go Type.\n    Size           int          // type size (denotes uint256, uint248, etc.)\n    T              byte         // Our own type checking\n    RequiresOffset bool         // denotes whether the type needs an offset\n\n    stringKind string // holds the unparsed string for deriving signatures\n}\n</code></pre>\n\n<p>Note that there are fields made to help describe the slice and the underlying type (we want to be as accurate as possible). I have a type byte as well as elements denoting the number of elements and dimensions for the slice. But what would be an intuitive way to create a golang multidimensional slice type from these description? One algorithm showcasing this for say a [][]uint or a [][][]uint would be greatly appreciated.</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1497297107, "post_id": 44507189, "comment_id": 76008561, "body": "Can you try this <code>curl -X POST &#39;http:&#47;&#47;localhost:4000&#47;url?X=val1&amp;Y=val2&amp;x=1&amp;x=2&#39;</code>?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497297184, "post_id": 44507189, "comment_id": 76008587, "body": "Are you sure this is POST request? You do not have post body."}, {"owner": {"reputation": 2101, "user_id": 191799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/040b77e27e69c24ee87cc6a7dc342f44?s=128&d=identicon&r=PG", "display_name": "manugupt1", "link": "https://stackoverflow.com/users/191799/manugupt1"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497297370, "post_id": 44507189, "comment_id": 76008657, "body": "@jeevatkm That just worked.. Thanks a lot!"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497299065, "post_id": 44507189, "comment_id": 76009480, "body": "you&#39;re welcome, added answer with details."}], "answers": [{"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 6, "last_activity_date": 1497298972, "creation_date": 1497298972, "answer_id": 44508113, "question_id": 44507189, "link": "https://stackoverflow.com/questions/44507189/reading-queryarray-from-gin-golang/44508113#44508113", "title": "Reading QueryArray from Gin golang", "body": "<p>Drafted answer from my comment for SO users.</p>\n\n<p>Repeat field name with values:</p>\n\n<pre><code>curl -X POST 'http://localhost:4000/url?X=val1&amp;Y=val2&amp;x=1&amp;x=2'\n</code></pre>\n\n<p>or:</p>\n\n<p>Separated by commas:</p>\n\n<pre><code>curl -X POST 'http://localhost:4000/url?X=val1&amp;Y=val2&amp;x=1,2'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 6150881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a42d9d73c727b1b482f4e215ac1b663?s=128&d=identicon&r=PG&f=1", "display_name": "Rabhi salim", "link": "https://stackoverflow.com/users/6150881/rabhi-salim"}, "is_accepted": false, "score": 0, "last_activity_date": 1602849306, "creation_date": 1602849306, "answer_id": 64388721, "question_id": 44507189, "link": "https://stackoverflow.com/questions/44507189/reading-queryarray-from-gin-golang/64388721#64388721", "title": "Reading QueryArray from Gin golang", "body": "<p>This maybe over-engineered, but it got things done for me:</p>\n<pre><code>// @Param property_type query []uint32 false &quot;property_types&quot;\nfunc (svc *HttpService) acceptListofQuery(c *gin.Context) {\n    var propertyTypes []uint32\n    propertyTypes, done := svc.parsePropTypes(c)\n    if done {\n        return\n    }\n    // ..... rest of logic here\n    c.JSON(200, &quot;We good&quot;)\n}\n\nfunc (svc *HttpService) parsePropTypes(c *gin.Context) ([]uint32, bool) {\n    var propertyTypes []uint32\n    var propertyTypesAsString string\n    var propertyTypesAsArrayOfStrings []string\n    propertyTypesAsString, success := c.GetQuery(&quot;property_types&quot;)\n    propertyTypesAsArrayOfStrings = strings.Split(propertyTypesAsString, &quot;,&quot;)\n    if success {\n        for _, propertyTypeAsString := range propertyTypesAsArrayOfStrings {\n            i, err := strconv.Atoi(propertyTypeAsString)\n            if err != nil {\n                svc.ErrorWithJson(c, 400, errors.New(&quot;invalid property_types array&quot;))\n                return nil, true\n            }\n            propertyTypes = append(propertyTypes, uint32(i))\n        }\n   }\n    return propertyTypes, false\n}\n</code></pre>\n<p>Then you can send something like:</p>\n<pre><code>curl -X POST 'http://localhost:4000/url?property_types=1,4,7,12\n</code></pre>\n"}], "owner": {"reputation": 2101, "user_id": 191799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/040b77e27e69c24ee87cc6a7dc342f44?s=128&d=identicon&r=PG", "display_name": "manugupt1", "link": "https://stackoverflow.com/users/191799/manugupt1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3783, "favorite_count": 0, "accepted_answer_id": 44508113, "answer_count": 2, "score": 1, "last_activity_date": 1602849306, "creation_date": 1497295209, "question_id": 44507189, "link": "https://stackoverflow.com/questions/44507189/reading-queryarray-from-gin-golang", "title": "Reading QueryArray from Gin golang", "body": "<p>Hi I am passing a query parameter to my gin server like this:</p>\n\n<blockquote>\n  <p>curl -X POST \\<br>\n  '<a href=\"http://localhost:4000/url?X=val1&amp;Y=val2&amp;x[]=1&amp;x[]=2\" rel=\"nofollow noreferrer\">http://localhost:4000/url?X=val1&amp;Y=val2&amp;x[]=1&amp;x[]=2</a>'</p>\n</blockquote>\n\n<p>This is then sent to the my gin handler function</p>\n\n<pre><code>func handler (c *gin.Context) {\n    fmt.Println(c.Query(\"X\"))\n    fmt.Println(c.Query(\"Y\"))\n    fmt.Println(c.QueryArray(\"x\"))\n}\n</code></pre>\n\n<p>While c.Query(\"x\") and c.Query(\"Y\") works, c.QueryArray(\"x\") does not work!</p>\n\n<p>I am not sure what am I missing over here. I have tried the same with GET request as well and it does not work.</p>\n\n<p>Other experiments that did not work for me are here:</p>\n\n<pre><code>fmt.Println(c.Params.Get(\"x\"))\nfmt.Println(c.Params.Get(\"gene\"))\nfmt.Println(c.PostFormArray(\"x\"))\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4984, "user_id": 721578, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/aa50860353d6c6bba575cefe31c5709f?s=128&d=identicon&r=PG", "display_name": "Benjam", "link": "https://stackoverflow.com/users/721578/benjam"}, "edited": false, "score": 2, "creation_date": 1497305544, "post_id": 44507106, "comment_id": 76012120, "body": "<code>go get .&#47;...</code> should do the trick for all missing dependencies."}], "answers": [{"comments": [{"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 0, "creation_date": 1497295814, "post_id": 44507300, "comment_id": 76007941, "body": "I tried it, it didn&#39;t show any error message, but I didn&#39;t get any message that it downloaded too. Plus also need the other package too."}, {"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "reply_to_user": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 0, "creation_date": 1497295988, "post_id": 44507300, "comment_id": 76008016, "body": "It shouldn&#39;t show any message that it downloaded the required package. Check your $GOPATH/src, downloaded package should be there."}, {"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 1, "creation_date": 1497296072, "post_id": 44507300, "comment_id": 76008062, "body": "There is go dep, which does a lot of that \u2013 <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">github.com/golang/dep</a>"}, {"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 0, "creation_date": 1497296111, "post_id": 44507300, "comment_id": 76008083, "body": "@n-canter Okay, yes, it was there. What about the second crypto/sha3 dependency?"}, {"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1497296157, "post_id": 44507300, "comment_id": 76008104, "body": "go get golang.org/x/crypto/sha3"}, {"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "reply_to_user": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1497296200, "post_id": 44507300, "comment_id": 76008129, "body": "@fhe mentioned go dep, not official tool yet, but looks promising"}, {"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 0, "creation_date": 1497296285, "post_id": 44507300, "comment_id": 76008167, "body": "@n-canter Thank you."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1497299282, "post_id": 44507300, "comment_id": 76009572, "body": "Note that once the import statements are correct, <code>go get .&#47;...</code> from the project root folder will download all dependencies."}], "tags": [], "owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "is_accepted": true, "score": 1, "last_activity_date": 1497295597, "creation_date": 1497295597, "answer_id": 44507300, "question_id": 44507106, "link": "https://stackoverflow.com/questions/44507106/how-to-resolve-packages-dependencies-in-go/44507300#44507300", "title": "How to resolve packages dependencies in Go?", "body": "<p>As far as I know there is no such a tool.\nBut in your case you may use 'go get', just remove .git from the end of the line.</p>\n\n<pre><code>go get git.schwanenlied.me/yawning/chacha20\n</code></pre>\n\n<p>same for import statement</p>\n\n<pre><code>import (\n    \"git.schwanenlied.me/yawning/chacha20\"\n    \"golang.org/x/crypto/sha3\"\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 378, "user_id": 3585078, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/602470386/picture?type=large", "display_name": "Pubudu", "link": "https://stackoverflow.com/users/3585078/pubudu"}, "is_accepted": false, "score": 0, "last_activity_date": 1519206806, "creation_date": 1519206806, "answer_id": 48902828, "question_id": 44507106, "link": "https://stackoverflow.com/questions/44507106/how-to-resolve-packages-dependencies-in-go/48902828#48902828", "title": "How to resolve packages dependencies in Go?", "body": "<p>Have you tried godep? You can read the documentation <a href=\"https://github.com/tools/godep\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6319, "favorite_count": 0, "accepted_answer_id": 44507300, "answer_count": 2, "score": 0, "last_activity_date": 1519206806, "creation_date": 1497294873, "question_id": 44507106, "link": "https://stackoverflow.com/questions/44507106/how-to-resolve-packages-dependencies-in-go", "title": "How to resolve packages dependencies in Go?", "body": "<p>I'm relatively new to Go, and I wanted some source code that I downloaded. Though, it imports two packages which I do not have, namely these two:</p>\n\n<pre><code>import (\n    \"git.schwanenlied.me/yawning/chacha20.git\"\n    \"golang.org/x/crypto/sha3\"\n)\n</code></pre>\n\n<p>It there a tool or way in Go that automatically reads the source files in a directory and downloads the packages needed? On the other hand, when I just try to use <code>go get</code> to download them, I get an error that it uses insecure protocol (due to git). Any ideas how to resolve these dependencies?</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1497295594, "post_id": 44507052, "comment_id": 76007825, "body": "Images returns images, you&#39;re returning containers? Are you expecting them to be the same?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7335683, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/1c26b3318b8d48bcc7f4bbc375a21c48?s=128&d=identicon&r=PG&f=1", "display_name": "vic", "link": "https://stackoverflow.com/users/7335683/vic"}, "edited": false, "score": 0, "creation_date": 1497349168, "post_id": 44508608, "comment_id": 76029253, "body": "My mistake: i used ImageList but pasted ContainerList by mistake"}], "tags": [], "owner": {"reputation": 721, "user_id": 2410055, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5fc954d02c44aa25bca91c04658b2bbe?s=128&d=identicon&r=PG", "display_name": "SasaT", "link": "https://stackoverflow.com/users/2410055/sasat"}, "is_accepted": false, "score": 0, "last_activity_date": 1497301129, "creation_date": 1497301129, "answer_id": 44508608, "question_id": 44507052, "link": "https://stackoverflow.com/questions/44507052/docker-golang-api-containerlist-fails-with-tls/44508608#44508608", "title": "docker golang API ContainerList fails with TLS", "body": "<p>You have a list of images but you haven't created any containers yet, therefore <code>cli.ContainerList()</code> returns empty list</p>\n\n<p>What you are probably looking for is <code>cli.ImageList()</code></p>\n\n<p>Docs:\n<a href=\"https://godoc.org/github.com/docker/engine-api/client#Client.ImageList\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/docker/engine-api/client#Client.ImageList</a></p>\n"}], "owner": {"reputation": 37, "user_id": 7335683, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/1c26b3318b8d48bcc7f4bbc375a21c48?s=128&d=identicon&r=PG&f=1", "display_name": "vic", "link": "https://stackoverflow.com/users/7335683/vic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578900980, "creation_date": 1497294646, "last_edit_date": 1578900980, "question_id": 44507052, "link": "https://stackoverflow.com/questions/44507052/docker-golang-api-containerlist-fails-with-tls", "title": "docker golang API ContainerList fails with TLS", "body": "<p>I have dockerd configured with TLS authentication on CoreOS;</p>\n\n<p>Cli <code>docker images</code> returns me valid list of images:</p>\n\n<pre><code>REPOSITORY                 TAG                 IMAGE ID            CREATED             SIZE\nbusybox                    latest              c75bebcdd211        3 weeks ago         1.106 MB\n</code></pre>\n\n<p>But trying it in \"go\" code:</p>\n\n<pre><code>export DOCKER_CERT_PATH=~/.docker\n     images, err := cli.ImageList(context.Background(), types.ImageListOptions{})\n</code></pre>\n\n<p>returns me empty list</p>\n\n<p>Below is my docker configuration:</p>\n\n<pre><code>Client:\n Version:      1.12.6\n API version:  1.24\n Go version:   go1.6.3\n Git commit:   d5236f0\n Built:        Tue May 30 23:15:08 2017\n OS/Arch:      linux/amd64\n\nServer:\n Version:      1.12.6\n API version:  1.24\n Go version:   go1.6.3\n Git commit:   d5236f0\n Built:        Tue May 30 23:15:08 2017\n OS/Arch:      linux/amd64\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497289054, "post_id": 44505515, "comment_id": 76004407, "body": "Please show the definition of <code>Greet2</code>."}, {"owner": {"reputation": 445, "user_id": 1515684, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/706bc7f6b63750239ac901c1a5b5b71a?s=128&d=identicon&r=PG", "display_name": "Sheshank Kodam", "link": "https://stackoverflow.com/users/1515684/sheshank-kodam"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497289101, "post_id": 44505515, "comment_id": 76004441, "body": "@adrian Added Greet2 definition"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497289108, "post_id": 44505515, "comment_id": 76004450, "body": "<code>Greet2</code> takes a <code>func(string)</code> as its second parameter, not a <code>Printer</code> which is a <code>func(s string) string</code>. The types are not the same and not interchangeable."}, {"owner": {"reputation": 445, "user_id": 1515684, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/706bc7f6b63750239ac901c1a5b5b71a?s=128&d=identicon&r=PG", "display_name": "Sheshank Kodam", "link": "https://stackoverflow.com/users/1515684/sheshank-kodam"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497289615, "post_id": 44505515, "comment_id": 76004707, "body": "I have changed the Printer type to func(string) <code>type Printer func(string) string</code>. Same <code>error</code>. Also <code>createPrintFunction(&quot;!!!&quot;)</code> is a type of <code>func(string)</code>, so the type error doesn&#39;t make sense."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1497289722, "post_id": 44505515, "comment_id": 76004769, "body": "No, <code>createPrintFunction(&quot;!!!&quot;)</code> returns a <code>Printer</code>, which is a <code>func(s string) string</code>, which is not the same thing as a <code>func(string)</code> which is what <code>Greet2</code> takes. The return value is significant; <code>Greet2</code> takes a parameter with no return value, while <code>Printer</code> has a return value of type <code>string</code>."}, {"owner": {"reputation": 445, "user_id": 1515684, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/706bc7f6b63750239ac901c1a5b5b71a?s=128&d=identicon&r=PG", "display_name": "Sheshank Kodam", "link": "https://stackoverflow.com/users/1515684/sheshank-kodam"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497290051, "post_id": 44505515, "comment_id": 76004934, "body": "Got it. I made <code>Printer</code> as second parameter to <code>Greet2</code>,  <code>Greet2(salutation Salutation, do Printer)</code> and it worked."}, {"owner": {"reputation": 445, "user_id": 1515684, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/706bc7f6b63750239ac901c1a5b5b71a?s=128&d=identicon&r=PG", "display_name": "Sheshank Kodam", "link": "https://stackoverflow.com/users/1515684/sheshank-kodam"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497290225, "post_id": 44505515, "comment_id": 76005017, "body": "@Adrian Thanks. One quick question. How do i get return value from <code>do(salutation.name + &quot; &quot; + salutation.greeting)</code> in <code>Greet2</code>? Instead of returning <code>Done</code>, i would like to return the actual value returned?"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497290122, "post_id": 44505826, "comment_id": 76004961, "body": "This is exactly what I wrote in my comment."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1497290240, "post_id": 44505826, "comment_id": 76005026, "body": "@Adrian This is a Question &amp; Answer site. You could have written an answer. &#175;_(\u30c4)_/&#175;"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497291995, "post_id": 44505826, "comment_id": 76005926, "body": "@Schwern if you read the comments, you&#39;ll see it took some back &amp; forth to arrive at an answer."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497295078, "post_id": 44505826, "comment_id": 76007559, "body": "@Adrian It&#39;s great that you put in the work, but it didn&#39;t result in an answer. The point of the site is to produce good answers that can be voted, edited, and commented on, and so people don&#39;t have to wade through comments. No answer camping."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 3, "last_activity_date": 1497290193, "last_edit_date": 1497290193, "creation_date": 1497290077, "answer_id": 44505826, "question_id": 44505515, "link": "https://stackoverflow.com/questions/44505515/how-to-return-from-function-types-when-using-closures-in-go/44505826#44505826", "title": "How to return from function types when using closures in Go", "body": "<p>The problem is the signatures don't match. That includes the return type.</p>\n\n<p><code>Greet2</code> wants <code>func(string)</code> but <code>createPrintFunction</code> returns <code>func(s string) string</code>. Note that Greet2's returns nothing, but the <code>createPrintFunction</code> function returns a string.</p>\n\n<p>You'll have to decide how to make them match. You probably want to use the return value in <code>Greet2</code> for something better than \"Done\".</p>\n\n<pre><code>func Greet2(salutation Salutation, do func(string) string) string {\n    return do(salutation.name + \" \" + salutation.greeting)\n}\n</code></pre>\n\n<p>Since you've defined <code>type Printer func(s string) string</code> its best to use it consistently to avoid this sort of problem. <code>Greet2</code> takes a <code>Printer</code> and <code>createPrintFunction</code> returns a <code>Printer</code>. Then if <code>Printer</code> changes things will still work.</p>\n\n<pre><code>func Greet2(salutation Salutation, do Printer) string {\n    return do(salutation.name + \" \" + salutation.greeting)\n}\n</code></pre>\n\n<p>...but the <code>do</code> generated by <code>createPrintFunction</code> doesn't use its arguments.  It's hard to advise what it should do because much of this code just passes its arguments straight through, or ignores them.</p>\n\n<p>Anyhow, the signatures have to match.</p>\n"}, {"tags": [], "owner": {"reputation": 445, "user_id": 1515684, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/706bc7f6b63750239ac901c1a5b5b71a?s=128&d=identicon&r=PG", "display_name": "Sheshank Kodam", "link": "https://stackoverflow.com/users/1515684/sheshank-kodam"}, "is_accepted": false, "score": -1, "last_activity_date": 1497290558, "creation_date": 1497290558, "answer_id": 44505946, "question_id": 44505515, "link": "https://stackoverflow.com/questions/44505515/how-to-return-from-function-types-when-using-closures-in-go/44505946#44505946", "title": "How to return from function types when using closures in Go", "body": "<p>Solution:</p>\n\n<pre><code>func Greet2(salutation Salutation, do Printer) (string){\n    return do(salutation.name + \" \" + salutation.greeting)\n}\n\ntype Printer func(string) string\n\nfunc createPrintFunction(custom string) Printer {\n    return func(s string) string {\n        return s\n    }\n}\n\nfunc pluralSightModule1Closures1(w http.ResponseWriter, r *http.Request) {\n    var s = Salutation{\"Joe\", \"Hello\"}\n    res := Greet2(s, createPrintFunction(\"!!!\"))\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.Write([]byte (res))\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 445, "user_id": 1515684, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/706bc7f6b63750239ac901c1a5b5b71a?s=128&d=identicon&r=PG", "display_name": "Sheshank Kodam", "link": "https://stackoverflow.com/users/1515684/sheshank-kodam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1497290558, "creation_date": 1497288955, "last_edit_date": 1497289624, "question_id": 44505515, "link": "https://stackoverflow.com/questions/44505515/how-to-return-from-function-types-when-using-closures-in-go", "title": "How to return from function types when using closures in Go", "body": "<p>Im new to GoLang and cannot figure out whats wrong in the code below. What i'm trying to do is \"Create and return Printer function on the fly\"</p>\n\n<pre><code>type Salutation struct {  name string   \n    greeting string\n}\n\ntype Printer func(s string) string\n\nfunc Greet2(salutation Salutation, do func(string)) (string){\n    do(salutation.name + \" \" + salutation.greeting)\n    return \"Done\"\n}\n\nfunc createPrintFunction(custom string) Printer {\n    return func(s string) string {\n        return \"hello\"\n    }\n}\n\nfunc pluralSightModule1Closures1(w http.ResponseWriter, r *http.Request) {\n    var s = Salutation{\"Joe\", \"Hello\"}\n    res := Greet2(s, createPrintFunction(\"!!!\"))\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.Write([]byte (res))\n}\n</code></pre>\n\n<p>I get the following compilation error</p>\n\n<pre><code> cannot use createPrintFunction(\"!!!\") (type Printer) as type func(string) in argument to Greet2\n</code></pre>\n"}, {"tags": ["go", "error-handling", "panic"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1497286965, "post_id": 44504354, "comment_id": 76003328, "body": "Related: <a href=\"https://stackoverflow.com/questions/35412449/why-did-go-add-panic-and-recover-in-addition-to-error-handling/35413011#35413011\">Why did Go add panic and recover in addition to error handling?</a> (Not an exact answer to this question, but some reasoning applies here as well.)"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497290970, "post_id": 44504354, "comment_id": 76005403, "body": "For validations use error, here you&#39;re checking <code>isNotIterable(iterable)</code>. Error would be appropriate."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 3, "creation_date": 1497292159, "post_id": 44504354, "comment_id": 76006016, "body": "rule of thumb: In the acual <code>main</code> function it is ok to use panics. Errors in all other cases. In libraries that are used in several other programs it is really &#39;forbidden&#39; to use panic."}, {"owner": {"reputation": 14728, "user_id": 2142577, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/820c611835bb6eea4851c318a3b73345?s=128&d=identicon&r=PG", "display_name": "laike9m", "link": "https://stackoverflow.com/users/2142577/laike9m"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497358651, "post_id": 44504354, "comment_id": 76036170, "body": "@RickyA Mind posting an answer?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497360663, "post_id": 44504354, "comment_id": 76037879, "body": "<a href=\"https://stackoverflow.com/a/28473339/248922\">this</a> answers it rather completely"}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 1, "creation_date": 1532008505, "post_id": 44504354, "comment_id": 89819993, "body": "Related: <a href=\"https://stackoverflow.com/q/22863605/328115\">Is function parameter validation using errors a good pattern in Go?</a> (really the same question)"}], "answers": [{"comments": [{"owner": {"reputation": 14728, "user_id": 2142577, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/820c611835bb6eea4851c318a3b73345?s=128&d=identicon&r=PG", "display_name": "laike9m", "link": "https://stackoverflow.com/users/2142577/laike9m"}, "edited": false, "score": 1, "creation_date": 1497329722, "post_id": 44505268, "comment_id": 76017926, "body": "Agreed. But how do I determine if the program can continue? For me, it seems that if some integer is accidentally passed in, there&#39;s no way for the program to continue running."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 14728, "user_id": 2142577, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/820c611835bb6eea4851c318a3b73345?s=128&d=identicon&r=PG", "display_name": "laike9m", "link": "https://stackoverflow.com/users/2142577/laike9m"}, "edited": false, "score": 2, "creation_date": 1497359246, "post_id": 44505268, "comment_id": 76036706, "body": "That may be the case. Perhapse &quot;can continue&quot; is a little vague - what it really means is, if the error occurred, is there any way your program could <i>handle</i> the error? Generally speaking, in go, if you&#39;re not sure, return an error. Panics should be pretty rare."}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 3, "creation_date": 1532008759, "post_id": 44505268, "comment_id": 89820181, "body": "This reply is not an answer: it is a question (<i>Ask yourself...</i>)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1532008878, "post_id": 44505268, "comment_id": 89820257, "body": "Read it in its entirety. It encourages the reader to ask themselves a question, in order to offer logic based on the answer to make a decision for themselves."}, {"owner": {"reputation": 6292, "user_id": 1483676, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/h2IgH.jpg?s=128&g=1", "display_name": "cubuspl42", "link": "https://stackoverflow.com/users/1483676/cubuspl42"}, "edited": false, "score": 2, "creation_date": 1557152349, "post_id": 44505268, "comment_id": 98659621, "body": "At the same time, a <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">post</a> from the  official blog suggests a different approach. They give the <a href=\"https://golang.org/src/encoding/json/decode.go\" rel=\"nofollow noreferrer\">json library</a> as an example, which uses <code>panic</code> internally and converts it to an error in the public API."}, {"owner": {"reputation": 6292, "user_id": 1483676, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/h2IgH.jpg?s=128&g=1", "display_name": "cubuspl42", "link": "https://stackoverflow.com/users/1483676/cubuspl42"}, "edited": false, "score": 0, "creation_date": 1557152375, "post_id": 44505268, "comment_id": 98659636, "body": "I&#39;m not saying it&#39;s a good design, just leaving it for reference."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 46, "last_activity_date": 1608727807, "last_edit_date": 1608727807, "creation_date": 1497288094, "answer_id": 44505268, "question_id": 44504354, "link": "https://stackoverflow.com/questions/44504354/should-i-use-panic-or-return-error/44505268#44505268", "title": "Should I use panic or return error?", "body": "<p>You should assume that a panic will be immediately fatal, for the entire program, or at the very least for the current goroutine. Ask yourself &quot;when this happens, should the application immediately crash?&quot; If yes, use a panic; otherwise, use an error.</p>\n"}, {"comments": [{"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 2, "creation_date": 1532004992, "post_id": 44506401, "comment_id": 89817367, "body": "Define &quot;normal operation&quot;. Because that&#39;s the point of the question: &quot;is the check <code>isNotIterable</code> about normal operation?&quot;"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "is_accepted": false, "score": -1, "last_activity_date": 1497292302, "creation_date": 1497292302, "answer_id": 44506401, "question_id": 44504354, "link": "https://stackoverflow.com/questions/44504354/should-i-use-panic-or-return-error/44506401#44506401", "title": "Should I use panic or return error?", "body": "<p>A panic typically means something went unexpectedly wrong. Mostly used to fail fast on errors that shouldn\u2019t occur during normal operation, or that we aren\u2019t prepared to handle gracefully. So in this case just return the error, you don't want your program to panic. </p>\n"}, {"tags": [], "owner": {"reputation": 24922, "user_id": 4001, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3b2c4583cd2eee64afe2ff888d590cf9?s=128&d=identicon&r=PG", "display_name": "abbot", "link": "https://stackoverflow.com/users/4001/abbot"}, "is_accepted": false, "score": -2, "last_activity_date": 1497301286, "creation_date": 1497301286, "answer_id": 44508642, "question_id": 44504354, "link": "https://stackoverflow.com/questions/44504354/should-i-use-panic-or-return-error/44508642#44508642", "title": "Should I use panic or return error?", "body": "<p>Don't use panic for normal error handling. Use error and multiple return values. See <a href=\"https://golang.org/doc/effective_go.html#errors\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#errors</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 6914680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbfe189eb8fbf0973db448cf097a7a88?s=128&d=identicon&r=PG&f=1", "display_name": "Parmatma", "link": "https://stackoverflow.com/users/6914680/parmatma"}, "is_accepted": false, "score": 2, "last_activity_date": 1497442549, "creation_date": 1497442549, "answer_id": 44544557, "question_id": 44504354, "link": "https://stackoverflow.com/questions/44504354/should-i-use-panic-or-return-error/44544557#44544557", "title": "Should I use panic or return error?", "body": "<p>If some mandatory requirement is not provided or not there while starting the service (eg. database connection, some service configuration which is required) then you should use panic.</p>\n\n<p>There should be return error for any user response or server side error.</p>\n"}, {"comments": [{"owner": {"reputation": 14728, "user_id": 2142577, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/820c611835bb6eea4851c318a3b73345?s=128&d=identicon&r=PG", "display_name": "laike9m", "link": "https://stackoverflow.com/users/2142577/laike9m"}, "edited": false, "score": 0, "creation_date": 1554986878, "post_id": 51423219, "comment_id": 97956783, "body": "also makes sense."}], "tags": [], "owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "is_accepted": false, "score": 10, "last_activity_date": 1532007832, "last_edit_date": 1532007832, "creation_date": 1532004800, "answer_id": 51423219, "question_id": 44504354, "link": "https://stackoverflow.com/questions/44504354/should-i-use-panic-or-return-error/51423219#51423219", "title": "Should I use panic or return error?", "body": "<p><strong>Use <code>panic</code>.</strong></p>\n\n<p>Because your use case is to <strong>catch a bad use of your API</strong>. This should never happen at runtime if the program is calling your API properly.</p>\n\n<p>In fact, any program calling your API with correct arguments will behave in the same way <em>if the test is removed</em>. The test is there only to fail early with an error message helpful to the programmer that did the mistake. Ideally, the panic might be reached once during development when running the testsuite and the programmer would fix the call even before committing the bad code, and that incorrect use would never reach production.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/a/22865084/328115\">this reponse</a> to question <em>Is function parameter validation using errors a good pattern in Go?</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 10796, "user_id": 1105249, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/083d54b8327a76a1dcf57df507ab7b34?s=128&d=identicon&r=PG", "display_name": "Luis Masuelli", "link": "https://stackoverflow.com/users/1105249/luis-masuelli"}, "is_accepted": false, "score": 2, "last_activity_date": 1534306541, "creation_date": 1534306541, "answer_id": 51852863, "question_id": 44504354, "link": "https://stackoverflow.com/questions/44504354/should-i-use-panic-or-return-error/51852863#51852863", "title": "Should I use panic or return error?", "body": "<p>Ask yourself these questions:</p>\n\n<ul>\n<li>Do you expect the exceptional situation to occur, regardless how well would you code your app? Do you think it should be useful to make the user aware of such condition as part of the normal usage of your app? Handle it as an error, because it concerns the application as working normally.</li>\n<li>Should that exceptional situation NOT occur if you code appropriately (and somewhat defensively)? (example: dividing by zero, or accessing an array element out of bounds) Is your app totally clueless under that error? Panic.</li>\n<li>Do you have your API and want to ensure users use it appropriately? Panic. Your API will seldom recover if used incorrectly.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5021, "user_id": 4470135, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/oXA6y.jpg?s=128&g=1", "display_name": "yuranos", "link": "https://stackoverflow.com/users/4470135/yuranos"}, "is_accepted": false, "score": 1, "last_activity_date": 1607204030, "last_edit_date": 1607204030, "creation_date": 1602265854, "answer_id": 64284968, "question_id": 44504354, "link": "https://stackoverflow.com/questions/44504354/should-i-use-panic-or-return-error/64284968#64284968", "title": "Should I use panic or return error?", "body": "<p>I like the way it's done in some libraries where on top of a regular method <code>DoSomething</code>, its &quot;panicky&quot; version is added with <code>MustDoSomething</code>. I'm relatively new to <code>go</code>, but I've already seen it in several places, notably <a href=\"https://jmoiron.github.io/sqlx/\" rel=\"nofollow noreferrer\"><code>sqlx</code></a>.<br />\nIn general, if you want to expose your code to someone else, you should either have <code>Must-</code> and a regular version of the method, or your methods/functions should give the client a chance to recover the way they want and so <code>error</code> should be available to them in a <code>go</code>-idiomatic way.<br />\nHaving said that, I agree that if your API/library is used inappropriately, it's Ok to panic as well. As a matter of fact, I've also seen methods like <code>MustGetenv()</code> that will panic if a critical env.var is missing. Fail-fast mechanism basically.</p>\n"}], "owner": {"reputation": 14728, "user_id": 2142577, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/820c611835bb6eea4851c318a3b73345?s=128&d=identicon&r=PG", "display_name": "laike9m", "link": "https://stackoverflow.com/users/2142577/laike9m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13842, "favorite_count": 9, "accepted_answer_id": 44505268, "answer_count": 7, "score": 35, "last_activity_date": 1608727807, "creation_date": 1497284876, "question_id": 44504354, "link": "https://stackoverflow.com/questions/44504354/should-i-use-panic-or-return-error", "title": "Should I use panic or return error?", "body": "<p>Go provides two ways of handling errors, but I'm not sure which one to use.</p>\n\n<p>Assuming I'm implementing a classic <code>ForEach</code> function which accepts a slice or a map as an argument. To check whether an iterable is passed in, I could do:</p>\n\n<pre><code>func ForEach(iterable interface{}, f interface{}) {\n    if isNotIterable(iterable) {\n        panic(\"Should pass in a slice or map!\")\n    }\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>func ForEach(iterable interface{}, f interface{}) error {\n    if isNotIterable(iterable) {\n        return fmt.Errorf(\"Should pass in a slice or map!\")\n    }\n}\n</code></pre>\n\n<p>I saw some discussions saying <code>panic()</code> should be avoided, but people also say that if program cannot recover from error, you should <code>panic()</code>.</p>\n\n<p>Which one should I use? And what's the main principle for picking the right one?</p>\n"}, {"tags": ["go", "goland"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1497280359, "post_id": 44502449, "comment_id": 75999382, "body": "I don&#39;t see a question, are you asking <i>what</i> to set GOPATH to? You can refer to the documentation: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 181, "user_id": 6281483, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Ffl9B.jpg?s=128&g=1", "display_name": "Shinchan", "link": "https://stackoverflow.com/users/6281483/shinchan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497331125, "post_id": 44502449, "comment_id": 76018453, "body": "Thanks!The link is very helpful for beginners like me.Can you suggest some tutorials for Gogland IDE.Whatever tutorials I found are not that descriptive.I mean a fresher like me would expect details like what to do with various settings in Gogland etc. Jetbrains have given excellent documentation for intelliJ IDEA but as far as Gogland I think it is not that descriptive."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1497357969, "post_id": 44502449, "comment_id": 76035639, "body": "Well Gogland is still in beta/EAP, so it&#39;s intended for experienced users to test out, and you may need to discover many of the features and interfaces on your own as they evolve. I&#39;m sure better documentation will be written, but things are still subject to change."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 6281483, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Ffl9B.jpg?s=128&g=1", "display_name": "Shinchan", "link": "https://stackoverflow.com/users/6281483/shinchan"}, "edited": false, "score": 1, "creation_date": 1497330872, "post_id": 44506125, "comment_id": 76018361, "body": "Thanks! I think you are correct.I went to File-&gt; settings-&gt;GOPATH.Added the value C:\\GO\\bin and then ran my program.It worked.Also GOROOT contains the value GO1.8.3(C:\\GO)"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 1, "creation_date": 1497340426, "post_id": 44506125, "comment_id": 76023282, "body": "That would be incorrect as GOPATH and GOROOT must be different from each other. As of Go 1.8, the default GOPATH value is &lt;your-home-dir&gt;/go."}, {"owner": {"reputation": 181, "user_id": 6281483, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Ffl9B.jpg?s=128&g=1", "display_name": "Shinchan", "link": "https://stackoverflow.com/users/6281483/shinchan"}, "edited": false, "score": 0, "creation_date": 1497365233, "post_id": 44506125, "comment_id": 76041489, "body": "You mean to say the values I have in GOPATH and GOROOT are wrong.If that is true then I do not understand how my programs are running.I did not manually give the value for GOROOT.The value was already there.I mean by default it had that value.I only entered the value for GOHOME.Also can you suggest how to resolve it?"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1497380437, "post_id": 44506125, "comment_id": 76050777, "body": "You don&#39;t need to touch GOROOT, that one is implicit when you configure the Go SDK (or when the IDE detects it automatically). The value that you need to configure, GOPATH, must not be set into where you installed Go. in the description you&#39;ve posted it looks like you&#39;ve set GOPATH = GOROOT, which is why I&#39;ve posted the reply. Just set the GOPATH as described (and not in GOROOT). Your apps compile because you currently probably aren&#39;t using any packages / dependencies in your code. If you want to learn Go, you can join the Gophers Slack <a href=\"https://invite.slack.golangbridge.org/\" rel=\"nofollow noreferrer\">invite.slack.golangbridge.org</a> and get more info"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "is_accepted": true, "score": 11, "last_activity_date": 1497377071, "last_edit_date": 1497377071, "creation_date": 1497291311, "answer_id": 44506125, "question_id": 44502449, "link": "https://stackoverflow.com/questions/44502449/gopath-is-empty-gogland-ide/44506125#44506125", "title": "GOPATH is empty (Gogland IDE)", "body": "<p>As of Go 1.8, the default GOPATH value is /go. </p>\n\n<p>GOPATH is where your source code will live. You can either use the default one or use a custom one, for example, I use D:\\go. </p>\n\n<p>The IDE has not detected the GOPATH because none was set. When you download Go you are also presented with the installation instructions, please have a look at that as well.</p>\n"}], "owner": {"reputation": 181, "user_id": 6281483, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Ffl9B.jpg?s=128&g=1", "display_name": "Shinchan", "link": "https://stackoverflow.com/users/6281483/shinchan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12795, "favorite_count": 0, "accepted_answer_id": 44506125, "answer_count": 1, "score": 8, "last_activity_date": 1617154465, "creation_date": 1497279101, "last_edit_date": 1497296597, "question_id": 44502449, "link": "https://stackoverflow.com/questions/44502449/gopath-is-empty-gogland-ide", "title": "GOPATH is empty (Gogland IDE)", "body": "<p>I am pretty new to Go and Gogland. I just downloaded 'go1.8.3.windows-amd64.msi', installed it in C Drive and then started writing my programs in a notepad and then finally running it from a terminal.</p>\n\n<p>I am facing some issues with Gogland. I have intelliJ IDEA Ultimate But I have been asked to use Gogland. I do not know whether this is the correct decision.\nYou may want to advise  me on the same.\nI just created a new project, gave it a name and added a go file into it which has simple helloworld code.\nBut it shows me an error \"GOPATH is empty\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/i58Px.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/i58Px.png\" alt=\"Gogland editor\"></a></p>\n\n<p>As you could see the message at the top, just above the line package myfirstproject.</p>\n\n<p>How to resolve it? Do I need to do something with environment variables. The PATH environment variable is already set to 'C:\\Go\\bin'.</p>\n\n<p>When I click on the error message it asks me to configure GOPATH.</p>\n\n<p><a href=\"https://i.stack.imgur.com/24kMg.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/24kMg.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1497277574, "post_id": 44501660, "comment_id": 75997443, "body": "I won&#39;t create a new answer since JimB has already answered this, but I would suggest you check out the GoBlog on slices: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8149403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ba80ecaefcd743646a879f95584b25?s=128&d=identicon&r=PG&f=1", "display_name": "Los Compie", "link": "https://stackoverflow.com/users/8149403/los-compie"}, "edited": false, "score": 0, "creation_date": 1497277310, "post_id": 44501756, "comment_id": 75997247, "body": "Hi I want to initialise it but without knowing the length, is that possible?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 13, "user_id": 8149403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ba80ecaefcd743646a879f95584b25?s=128&d=identicon&r=PG&f=1", "display_name": "Los Compie", "link": "https://stackoverflow.com/users/8149403/los-compie"}, "edited": false, "score": 1, "creation_date": 1497277595, "post_id": 44501756, "comment_id": 75997457, "body": "@LosCompie: a slice must have a length - you can set it to 0 if you&#39;d like, but there&#39;s usually no reason to do so since a nil slice is valid in most cases."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1497277244, "creation_date": 1497277244, "answer_id": 44501756, "question_id": 44501660, "link": "https://stackoverflow.com/questions/44501660/create-list-of-list-in-go-language/44501756#44501756", "title": "Create list of list in go language", "body": "<p>If you don't want to initialize the slice, don't use <code>make</code></p>\n\n<pre><code>var result [][]SyntaxCommand\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8149403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ba80ecaefcd743646a879f95584b25?s=128&d=identicon&r=PG&f=1", "display_name": "Los Compie", "link": "https://stackoverflow.com/users/8149403/los-compie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1311, "favorite_count": 0, "accepted_answer_id": 44501756, "answer_count": 1, "score": 0, "last_activity_date": 1497277244, "creation_date": 1497277009, "question_id": 44501660, "link": "https://stackoverflow.com/questions/44501660/create-list-of-list-in-go-language", "title": "Create list of list in go language", "body": "<p>Hi I try to create slice of slice of SyntaxCommand with undetermine length</p>\n\n<pre><code>var result = make([][]SyntaxCommand)\nresult = append(result, []SyntaxCommand{})\ntemp := SyntaxCommand{}\nresult = append(result[len(result)-1], temp)\n</code></pre>\n\n<p>but i encounter error</p>\n\n<pre><code>missing len argument to make([][]SyntaxCommand)\ntemp = SyntaxCommand{}\n</code></pre>\n\n<p>How to easily make a list of list of object that is nullable? Then add new list to the end, and an object to the last list with non undetermined length?</p>\n"}, {"tags": ["node.js", "encryption", "go", "cryptography", "aes"], "comments": [{"owner": {"reputation": 2938, "user_id": 398713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6f13f8edd8b584fd06af03fb811c8b87?s=128&d=identicon&r=PG", "display_name": "GPX", "link": "https://stackoverflow.com/users/398713/gpx"}, "edited": false, "score": 0, "creation_date": 1497268663, "post_id": 44498745, "comment_id": 75990784, "body": "How is this &quot;buffer&quot; shared between Node and Go?"}, {"owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "reply_to_user": {"reputation": 2938, "user_id": 398713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6f13f8edd8b584fd06af03fb811c8b87?s=128&d=identicon&r=PG", "display_name": "GPX", "link": "https://stackoverflow.com/users/398713/gpx"}, "edited": false, "score": 0, "creation_date": 1497268783, "post_id": 44498745, "comment_id": 75990875, "body": "@GPX It&#39;s not. A cookie is encrypted like this in nodejs and I need to decrypt it in golang so I can read data stored in it."}, {"owner": {"reputation": 2938, "user_id": 398713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6f13f8edd8b584fd06af03fb811c8b87?s=128&d=identicon&r=PG", "display_name": "GPX", "link": "https://stackoverflow.com/users/398713/gpx"}, "edited": false, "score": 0, "creation_date": 1497268861, "post_id": 44498745, "comment_id": 75990928, "body": "A cookie&#39;s value is essentially a string. What is its length?"}, {"owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "reply_to_user": {"reputation": 2938, "user_id": 398713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6f13f8edd8b584fd06af03fb811c8b87?s=128&d=identicon&r=PG", "display_name": "GPX", "link": "https://stackoverflow.com/users/398713/gpx"}, "edited": false, "score": 1, "creation_date": 1497269159, "post_id": 44498745, "comment_id": 75991124, "body": "Don&#39;t know it&#39;s exact length. But here is a program to help understand my problem. <a href=\"https://play.golang.org/p/SoXOz3XIPK\" rel=\"nofollow noreferrer\">play.golang.org/p/SoXOz3XIPK</a>"}, {"owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "reply_to_user": {"reputation": 2938, "user_id": 398713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6f13f8edd8b584fd06af03fb811c8b87?s=128&d=identicon&r=PG", "display_name": "GPX", "link": "https://stackoverflow.com/users/398713/gpx"}, "edited": false, "score": 0, "creation_date": 1497269192, "post_id": 44498745, "comment_id": 75991152, "body": "cipherText is cookie&#39;s Content. encKey is the encryption Key iv is initialization vector"}, {"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 2, "creation_date": 1497273168, "post_id": 44498745, "comment_id": 75994117, "body": "@IshanJain, you should use <code>hex.DecodeString</code> in your Go program with hex values like in <a href=\"https://golang.org/src/crypto/cipher/example_test.go\" rel=\"nofollow noreferrer\">golang.org/src/crypto/cipher/example_test.go</a>"}, {"owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "reply_to_user": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1497278048, "post_id": 44498745, "comment_id": 75997783, "body": "@osgx Solved the problem. Thank you so much."}], "answers": [{"comments": [{"owner": {"reputation": 3422, "user_id": 1523785, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b28dda5cffe5812e52a6388c5e4ce9f9?s=128&d=identicon&r=PG", "display_name": "hatellla", "link": "https://stackoverflow.com/users/1523785/hatellla"}, "edited": false, "score": 0, "creation_date": 1512770691, "post_id": 44501961, "comment_id": 82406228, "body": "what was your node js equivalent code? I am facing the similar problem. Can you please share your node js code as well which is encrypting the text"}, {"owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "reply_to_user": {"reputation": 3422, "user_id": 1523785, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b28dda5cffe5812e52a6388c5e4ce9f9?s=128&d=identicon&r=PG", "display_name": "hatellla", "link": "https://stackoverflow.com/users/1523785/hatellla"}, "edited": false, "score": 0, "creation_date": 1512780457, "post_id": 44501961, "comment_id": 82409042, "body": "@hatellla The cookies were encrypted with <a href=\"https://npm.im/client-sessions\" rel=\"nofollow noreferrer\">client-sessions</a> npm module. All the arguments were similar to one in their <code>basic usage</code> example."}], "tags": [], "owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "is_accepted": true, "score": 4, "last_activity_date": 1497292376, "last_edit_date": 1497292376, "creation_date": 1497277770, "answer_id": 44501961, "question_id": 44498745, "link": "https://stackoverflow.com/questions/44498745/how-do-i-decrypt-an-aes256-bit-cipher-in-golang-that-was-encrypted-in-nodejs/44501961#44501961", "title": "How do I decrypt an AES256 bit cipher in golang that was encrypted in nodejs?", "body": "<p>I solved this problem with help from @osgx</p>\n\n<p>These are the things that I needed to change to decrypt correctly. </p>\n\n<ol>\n<li><p>Decode all hex strings that I was using. </p></li>\n<li><p>I checked nodejs documentation and the cipher methods/algorithms use similar naming scheme as <code>openssl</code>. So, I ran this command <code>openssl list-cipher-algorithms | grep \"AES256\"</code>and I got an output like this, <code>AES256 =&gt; AES-256-CBC</code> which means that, if I am using <code>aes256</code> in nodejs, It'll really be doing <code>aes-256-cbc</code>. Then I checked my golang code and I was using <code>aes-256-cfb</code> which is wrong. So, I changed that and used a cbc decrypter. </p></li>\n</ol>\n\n<p>Changing these two things gives proper results. </p>\n\n<p>Thank you so much for the help @osgx.</p>\n\n<p>My updated code is:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"encoding/hex\"\n    \"fmt\"\n\n)\n\nfunc main() {\n\n    encKey := \"c38036f65157cb6db0e8fd855aa28ada074be71917d1c8eedc2ae4d85e3c9da6\"\n    iv := \"79b67e539e7fcaefa7abf167de5c06ed\"\n    cipherText := \"c02eccfc514a0b7fae830586dd56e0fcebb81fc49f41fa6dedf099c3645793bef7ec7075eca30063f9c0ef395d5ee2d44e4f3490114280abb7cf86d6eb525e2ec9bd2b781388986480f8b3df95f7b10e\"\n\n    encKeyDecoded, err := hex.DecodeString(encKey)\n    if err != nil {\n        panic(err)\n    }\n    cipherTextDecoded, err := hex.DecodeString(cipherText)\n    if err != nil {\n        panic(err)\n    }\n    ivDecoded, err := hex.DecodeString(iv)\n    if err != nil {\n        panic(err)\n    }\n    block, err := aes.NewCipher([]byte(encKeyDecoded))\n    if err != nil {\n        panic(err)\n    }\n\n    mode := cipher.NewCBCDecrypter(block, []byte(ivDecoded))\n\n    mode.CryptBlocks([]byte(cipherTextDecoded), []byte(cipherTextDecoded))\n\n    fmt.Println(string(cipherTextDecoded))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Zv24WoKtBY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Zv24WoKtBY</a></p>\n"}], "owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2001, "favorite_count": 1, "accepted_answer_id": 44501961, "answer_count": 1, "score": -1, "last_activity_date": 1497308225, "creation_date": 1497268221, "last_edit_date": 1497308225, "question_id": 44498745, "link": "https://stackoverflow.com/questions/44498745/how-do-i-decrypt-an-aes256-bit-cipher-in-golang-that-was-encrypted-in-nodejs", "title": "How do I decrypt an AES256 bit cipher in golang that was encrypted in nodejs?", "body": "<p>I encrypted a string in Node.js like this. </p>\n\n<pre><code>var cipher = crypto.createCipheriv(\n\"aes256\",\n\"&lt;A Buffer of length 32&gt;\",\n\"79b67e539e7fcaefa7abf167de5c06ed\"  \n);\n</code></pre>\n\n<p>I noticed that a buffer in nodejs is like hex but every 2 consecutive characters are paired. So, It's length is half of whatever will come out if I convert it to a hex. </p>\n\n<p>Example: </p>\n\n<p>Buffer:</p>\n\n<pre><code>&lt;Buffer c3 80 36 f6 51 57 cb 6d b0 e8 fd 85 5a a2 8a da 07 4b e7 19 17 d1 c8 ee dc 2a e4 d8 5e 3c 9d a6&gt;\n</code></pre>\n\n<p>Hex:</p>\n\n<pre><code>c38036f65157cb6db0e8fd855aa28ada074be71917d1c8eedc2ae4d85e3c9da6\n</code></pre>\n\n<p>Now, The key I use in aes256 can not be of length 64. Here, Buffer's length is 32 and hex's length is 64. </p>\n\n<p>I want to decrypt this cipher in golang and I'll have to use this key and iv to decrypt it. </p>\n\n<p>aes in golang takes a length depending upon the size of key and when it sees a key of length 64 it throws an error that says, <code>Invalid key length</code>.</p>\n\n<p>How do I decrypt it in golang? There is my current program in go: <a href=\"https://play.golang.org/p/SoXOz3XIPK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/SoXOz3XIPK</a></p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n\n    encKey := \"c38036f65157cb6db0e8fd855aa28ada074be71917d1c8eedc2ae4d85e3c9da6\"\n    iv := \"79b67e539e7fcaefa7abf167de5c06ed\"\n    cipherText := \"c02eccfc514a0b7fae830586dd56e0fcebb81fc49f41fa6dedf099c3645793bef7ec7075eca30063f9c0ef395d5ee2d44e4f3490114280abb7cf86d6eb525e2ec9bd2b781388986480f8b3df95f7b10e\"\n\n    block, err := aes.NewCipher([]byte(encKey))\n    if err != nil {\n        log.Fatalf(\"%s\", err)\n    }\n\n    decrypter := cipher.NewCFBDecrypter(block, []byte(iv))\n\n    decrypted := make([]byte, 1000)\n    decrypter.XORKeyStream(decrypted, []byte(cipherText))\n\n    fmt.Printf(\"%s\\n\", string(decrypted))\n\n}\n</code></pre>\n"}, {"tags": ["mysql", "go"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8147966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1579c255664ef38c66bafaf9774dc825?s=128&d=identicon&r=PG&f=1", "display_name": "Antony360", "link": "https://stackoverflow.com/users/8147966/antony360"}, "is_accepted": false, "score": 0, "last_activity_date": 1497271241, "creation_date": 1497271241, "answer_id": 44499752, "question_id": 44498738, "link": "https://stackoverflow.com/questions/44498738/retrieving-datetime-from-mysql-in-time-time-in-golang/44499752#44499752", "title": "retrieving datetime from mysql in time.time in golang", "body": "<p><code>time.Time</code> is a nullable type. You got to anticipate that and use somethink like the pq package and the <code>NullTime</code> type instead of <code>time.Time</code>.\ncf : <a href=\"https://godoc.org/github.com/lib/pq#NullTime\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/lib/pq#NullTime</a></p>\n\n<p><code>pq.NullTime</code> is a structure :</p>\n\n<pre><code>type NullTime struct {\n    Time  time.Time\n    Valid bool // Valid is true if Time is not NULL\n}\n</code></pre>\n\n<p>If <code>Valid</code> is <code>True</code> then you'll got a result in <code>Time</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 3682683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc85c7108502ef625fa844a9bfa54d63?s=128&d=identicon&r=PG&f=1", "display_name": "kakkoko", "link": "https://stackoverflow.com/users/3682683/kakkoko"}, "is_accepted": false, "score": 1, "last_activity_date": 1497326601, "creation_date": 1497326601, "answer_id": 44512174, "question_id": 44498738, "link": "https://stackoverflow.com/questions/44498738/retrieving-datetime-from-mysql-in-time-time-in-golang/44512174#44512174", "title": "retrieving datetime from mysql in time.time in golang", "body": "<p>You must declare <code>DateType.String()</code> method like this:</p>\n\n<pre><code>func (t DateType) String() string {\n    return time.Time(t).String()\n}\n</code></pre>\n\n<p>From <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">Language Specification</a>:</p>\n\n<blockquote>\n  <p>The declared type does not inherit any methods bound to the existing type</p>\n</blockquote>\n"}], "owner": {"reputation": 51, "user_id": 8148655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a332a2252f67d949deefffb77e652b7?s=128&d=identicon&r=PG&f=1", "display_name": "ocuparedu", "link": "https://stackoverflow.com/users/8148655/ocuparedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4353, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1497326601, "creation_date": 1497268193, "question_id": 44498738, "link": "https://stackoverflow.com/questions/44498738/retrieving-datetime-from-mysql-in-time-time-in-golang", "title": "retrieving datetime from mysql in time.time in golang", "body": "<p>i have stored on my database (mySQL) this datatime field, last_activity: <code>2017-06-12 11:07:09</code></p>\n\n<p>im using the param <code>parseTime=True</code> on my OpenDB</p>\n\n<p>the problem is that the output is: <code>last activity: {63632862429 0 &lt;nil&gt;}</code>\ninstead of <code>2017-06-12 11:07:09</code></p>\n\n<p>what am i doing wrong?</p>\n\n<p>thanks</p>\n\n<pre><code>type DateType time.Time\n\ntype User struct {\n    LastActivity DateType\n}\n\n\nfunc (stUser *User) GetUserDataByLogin(login string) {\n\ndb := OpenDB()\n\ndefer db.Close()\n\n// Test the connection to the database\nerr := db.Ping()\ncheckErr(err)\n\nerr = db.QueryRow(\"SELECT  last_activity FROM users WHERE login = ?\", login).Scan(&amp;stUser.LastActivity)\n\nif err != nil {\n    if err == sql.ErrNoRows {\n        // there were no rows, but otherwise no error occurred\n    } else {\n        log.Fatal(err)\n    }\n}\n\nfmt.Println(\"last activity:\", stUser.LastActivity)\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["email", "go", "attachment"], "comments": [{"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1497263392, "post_id": 44496434, "comment_id": 75987380, "body": "Maybe <a href=\"https://godoc.org/github.com/veqryn/go-email/email#Message\" rel=\"nofollow noreferrer\">this library</a> will help ? I think it&#39;s incomplete and abandoned though."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1497278845, "post_id": 44496434, "comment_id": 75998318, "body": "We use this <code>gopkg.in&#47;gomail.v2</code> for building mime mails. Did not test deconstructing them."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 9049757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37980a4bce6e06cd88c3f1fbe2fe2d30?s=128&d=identicon&r=PG&f=1", "display_name": "kudo28", "link": "https://stackoverflow.com/users/9049757/kudo28"}, "is_accepted": false, "score": 0, "last_activity_date": 1522228895, "creation_date": 1522228895, "answer_id": 49530675, "question_id": 44496434, "link": "https://stackoverflow.com/questions/44496434/extracting-attachment-from-email-file-using-golang/49530675#49530675", "title": "Extracting attachment from email file using GOLANG", "body": "<p>I think firstly you should find the boundary of: </p>\n\n<blockquote>\n  <p>Content-Type: multipart/mixed; boundary={sample-boundary}</p>\n</blockquote>\n\n<p>Then you split the email by that <code>sample-boundary</code>.</p>\n\n<p>And finally you get the base64 encoding part of attachment. </p>\n\n<p>I'm current working on this. I'll be back when I'm done.</p>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 6146337, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207160730031528/picture?type=large", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6146337/sebastian"}, "is_accepted": false, "score": 2, "last_activity_date": 1564516334, "creation_date": 1564516334, "answer_id": 57279109, "question_id": 44496434, "link": "https://stackoverflow.com/questions/44496434/extracting-attachment-from-email-file-using-golang/57279109#57279109", "title": "Extracting attachment from email file using GOLANG", "body": "<p>I found a solution to this that uses the parsemail function from DusanKasan</p>\n\n<pre><code>import (\n    \"github.com/DusanKasan/parsemail\"\n)\n\nfunc readEmail() error {\n    b := getYourEmail()\n    email, err := parsemail.Parse(bytes.NewBuffer(b))\n    if err != nil{\n        return err\n    }\n    for _, a := range email.Attachments{\n        // do stuff with attachment\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5589648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kAceB.png?s=128&g=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/5589648/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1641, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1564516334, "creation_date": 1497261095, "question_id": 44496434, "link": "https://stackoverflow.com/questions/44496434/extracting-attachment-from-email-file-using-golang", "title": "Extracting attachment from email file using GOLANG", "body": "<p>I have been working on parsing email using golang. I am now in the part of extracting the attachments. I have looked into golang lib MIME and MIME/multipart. But it does not have any methods or function to do this.</p>\n\n<p>What specifically I want to do is: Example</p>\n\n<p>I have an email file with attachments file1.txt, file2.pdf, and file3.png. I have successfully parsed the email body. Now I want to extract the attachment and save them on a separate directory. I have searched all part of golang including MIME and MIME/multipart. They seem to not have this functionality. Can golang do this? if Yes any hint or clue please.</p>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8147966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1579c255664ef38c66bafaf9774dc825?s=128&d=identicon&r=PG&f=1", "display_name": "Antony360", "link": "https://stackoverflow.com/users/8147966/antony360"}, "edited": false, "score": 0, "creation_date": 1497268586, "post_id": 44498026, "comment_id": 75990735, "body": "So finally that confirms my thoughts, that&#39;s can&#39;t be dynamic ... Thank you icza :-)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1, "user_id": 8147966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1579c255664ef38c66bafaf9774dc825?s=128&d=identicon&r=PG&f=1", "display_name": "Antony360", "link": "https://stackoverflow.com/users/8147966/antony360"}, "edited": false, "score": 0, "creation_date": 1497268669, "post_id": 44498026, "comment_id": 75990789, "body": "@Antony360 How could it be dynamic? What would be the type of the result? <code>interface{}</code>? Then you&#39;re back at the beginning."}, {"owner": {"reputation": 1, "user_id": 8147966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1579c255664ef38c66bafaf9774dc825?s=128&d=identicon&r=PG&f=1", "display_name": "Antony360", "link": "https://stackoverflow.com/users/8147966/antony360"}, "edited": false, "score": 0, "creation_date": 1497269776, "post_id": 44498026, "comment_id": 75991540, "body": "I work on a bdd builder (dbr). I have to use special variables type to store values from the bdd. I call them &quot;nillables type&quot;. For example nillable type is something like <code>dbr.NullInt64</code>, it&#39;s a structure containing an <code>int64</code> variable and a <code>bool</code> variable named <code>Valid</code> (will be <code>true</code> if the <code>int64</code> variable&#39;s not <code>NULL</code>). (cf: <a href=\"https://github.com/gocraft/dbr/blob/master/types.go\" rel=\"nofollow noreferrer\">github.com/gocraft/dbr/blob/master/types.go</a>)"}, {"owner": {"reputation": 1, "user_id": 8147966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1579c255664ef38c66bafaf9774dc825?s=128&d=identicon&r=PG&f=1", "display_name": "Antony360", "link": "https://stackoverflow.com/users/8147966/antony360"}, "edited": false, "score": 0, "creation_date": 1497269780, "post_id": 44498026, "comment_id": 75991547, "body": "To give you an example, if I want to get an <code>int</code> value in the bdd I got to declare a variable with the <code>dbr.NullInt64</code> type (cause there is not <code>dbr.NullInt</code>). What I actually do is to create dynamicly a <code>dbr.NullInt64</code> variable when there is an <code>int</code> variable then I store the <code>int</code> value into this <code>dbr.NullInt64</code> and my desire is to finally cast it into its original type."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1497282905, "last_edit_date": 1497282905, "creation_date": 1497265966, "answer_id": 44498026, "question_id": 44496132, "link": "https://stackoverflow.com/questions/44496132/how-to-cast-a-reflect-value-by-its-type-when-created-by-reflect-new/44498026#44498026", "title": "How to cast a reflect.Value by its type when created by reflect.New", "body": "<p>You can't make it dynamic, because you are actually converting to a <em>concrete</em> type (what would be the type of the result if it would be dynamic? <code>interface{}</code>? you'd be back at the start).</p>\n\n<p>You may use <a href=\"https://golang.org/pkg/reflect/#Value.Interface\" rel=\"nofollow noreferrer\"><code>Value.Interface()</code></a> and a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>.</p>\n\n<p>For example:</p>\n\n<pre><code>var i int32 = 3\n\nv := reflect.ValueOf(i)\n\nx := v.Interface().(int32)\nfmt.Printf(\"%T %v\", x, x)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/MJxmdihKg1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>int32 3\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8147966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1579c255664ef38c66bafaf9774dc825?s=128&d=identicon&r=PG&f=1", "display_name": "Antony360", "link": "https://stackoverflow.com/users/8147966/antony360"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2356, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497282905, "creation_date": 1497260257, "question_id": 44496132, "link": "https://stackoverflow.com/questions/44496132/how-to-cast-a-reflect-value-by-its-type-when-created-by-reflect-new", "title": "How to cast a reflect.Value by its type when created by reflect.New", "body": "<p>I'm actually trying some black magic using reflection in golang :P</p>\n\n<p>I got something like this :</p>\n\n<pre><code>  var _int int\n  var _int32 int32\n  var _int64 int64\n  var _string string\n\n    var nilablesIndex map[int]reflect.Value\n    var nilables = map[string]reflect.Type {\n           \"int32\":     reflect.TypeOf(_int32)},\n           \"int64\":     reflect.TypeOf(_int64)},\n           \"int\":       reflect.TypeOf(_int)},\n           \"string\":    reflect.TypeOf(_string)},\n        }\nnilablesIndex[len(m) - 1] = reflect.New(nilables[field.Type.String()][1])\n</code></pre>\n\n<p>To summarize, I have at this moment a reflect.Value created by <code>reflect.New(nilables[field.Type.String()][1])</code></p>\n\n<p>That I want is to cast this variable by its original type.</p>\n\n<p>Example : If <code>nilablesIndex[0]</code> is a <code>reflect.Type int32</code>, I want to cast it to type <code>int32</code>.</p>\n\n<p>Is it possible ? </p>\n\n<p>Thank you :)</p>\n"}, {"tags": ["json", "go", "marshalling"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 7579751, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9d4b6128dbd1fa0234d6ef41d4330231?s=128&d=identicon&r=PG&f=1", "display_name": "Foudel", "link": "https://stackoverflow.com/users/7579751/foudel"}, "edited": false, "score": 0, "creation_date": 1497259534, "post_id": 44495620, "comment_id": 75984881, "body": "thank a lot but I have another problem, i will have more than one key and value and I would like to use json.marshalIdent inside a loop, can you modify the code ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 187, "user_id": 7579751, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9d4b6128dbd1fa0234d6ef41d4330231?s=128&d=identicon&r=PG&f=1", "display_name": "Foudel", "link": "https://stackoverflow.com/users/7579751/foudel"}, "edited": false, "score": 0, "creation_date": 1497259627, "post_id": 44495620, "comment_id": 75984929, "body": "@Foudel If you have a specific problem, include that in the question. I don&#39;t know your code. Also note that you can pass slices or structs that contain slices to <code>json.Marshal()</code>, and they will be properly marshaled into JSON arrays. You don&#39;t need to do that &quot;manually&quot;."}, {"owner": {"reputation": 187, "user_id": 7579751, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9d4b6128dbd1fa0234d6ef41d4330231?s=128&d=identicon&r=PG&f=1", "display_name": "Foudel", "link": "https://stackoverflow.com/users/7579751/foudel"}, "edited": false, "score": 0, "creation_date": 1497259891, "post_id": 44495620, "comment_id": 75985093, "body": "have changed the code actually i am never used go I need only this small modif once forever."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 187, "user_id": 7579751, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9d4b6128dbd1fa0234d6ef41d4330231?s=128&d=identicon&r=PG&f=1", "display_name": "Foudel", "link": "https://stackoverflow.com/users/7579751/foudel"}, "edited": false, "score": 0, "creation_date": 1497260010, "post_id": 44495620, "comment_id": 75985156, "body": "@Foudel And what do you want the output to be? A series of (independent) JSON objects, or a JSON array of key-value pairs?"}, {"owner": {"reputation": 187, "user_id": 7579751, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9d4b6128dbd1fa0234d6ef41d4330231?s=128&d=identicon&r=PG&f=1", "display_name": "Foudel", "link": "https://stackoverflow.com/users/7579751/foudel"}, "edited": false, "score": 0, "creation_date": 1497260204, "post_id": 44495620, "comment_id": 75985290, "body": "json array of key-values because it is needed to map to values to another keys which are the same , the whole process is that i will get those values and from one CF APP and then copy them to the keys of a new CF APP"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 187, "user_id": 7579751, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9d4b6128dbd1fa0234d6ef41d4330231?s=128&d=identicon&r=PG&f=1", "display_name": "Foudel", "link": "https://stackoverflow.com/users/7579751/foudel"}, "edited": false, "score": 1, "creation_date": 1497260897, "post_id": 44495620, "comment_id": 75985757, "body": "@Foudel Then simply build a slice inside the loop (e.g. using the builtin <code>append()</code> function), then after the <code>for</code> loop pass the slice to <code>json.MarshalIndent()</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1497258783, "creation_date": 1497258783, "answer_id": 44495620, "question_id": 44495489, "link": "https://stackoverflow.com/questions/44495489/what-is-the-difference-between-json-marshal-and-json-marshalindent-using-go/44495620#44495620", "title": "What is the difference between json.Marshal and json.MarshalIndent using Go?", "body": "<p>I think the doc is pretty clear on this. Both <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"noreferrer\"><code>json.Marshal()</code></a>\nand <a href=\"https://golang.org/pkg/encoding/json/#MarshalIndent\" rel=\"noreferrer\"><code>json.MarshalIndent()</code></a> produces a JSON text result (in the form of a <code>[]byte</code>), but while the former does a compact output without indentation, the latter applies (somewhat customizable) indent. Quoting from doc of <code>json.MarshalIndent()</code>:</p>\n\n<blockquote>\n  <p>MarshalIndent is like Marshal but applies Indent to format the output.</p>\n</blockquote>\n\n<p>See this simple example:</p>\n\n<pre><code>type Entry struct {\n    Key string `json:\"key\"`\n}\n\ne := Entry{Key: \"value\"}\nres, err := json.Marshal(e)\nfmt.Println(string(res), err)\n\nres, err = json.MarshalIndent(e, \"\", \"  \")\nfmt.Println(string(res), err)\n</code></pre>\n\n<p>The output is (try it on the <a href=\"https://play.golang.org/p/ASeuLtLWa0\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\"key\":\"value\"} &lt;nil&gt;\n{\n  \"key\": \"value\"\n} &lt;nil&gt;\n</code></pre>\n\n<p>There is also <a href=\"https://golang.org/pkg/encoding/json/#Encoder\" rel=\"noreferrer\"><code>json.Encoder</code></a>:</p>\n\n<pre><code>type Entry struct {\n    Key string `json:\"key\"`\n}\ne := Entry{Key: \"value\"}\n\nenc := json.NewEncoder(os.Stdout)\nif err := enc.Encode(e); err != nil {\n    panic(err)\n}\n\nenc.SetIndent(\"\", \"  \")\nif err := enc.Encode(e); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Output (try this one on the <a href=\"https://play.golang.org/p/v1s9YkwA8w\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{\"key\":\"value\"}\n{\n  \"key\": \"value\"\n}\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 7579751, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9d4b6128dbd1fa0234d6ef41d4330231?s=128&d=identicon&r=PG&f=1", "display_name": "Foudel", "link": "https://stackoverflow.com/users/7579751/foudel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6886, "favorite_count": 1, "accepted_answer_id": 44495620, "answer_count": 1, "score": 0, "last_activity_date": 1497263307, "creation_date": 1497258426, "last_edit_date": 1497263307, "question_id": 44495489, "link": "https://stackoverflow.com/questions/44495489/what-is-the-difference-between-json-marshal-and-json-marshalindent-using-go", "title": "What is the difference between json.Marshal and json.MarshalIndent using Go?", "body": "<p>I would like to get an output of a CF command in JSON format but I am not sure what to use either <code>json.Marshal</code> or <code>json.MarshalIndent</code>.</p>\n\n<p>The output I need is like this:</p>\n\n<pre><code>{\n    \"key1\": \"value1\",\n     ....\n    \"keyn\": \"valuen\",\n}\n</code></pre>\n\n<p>This is the old example but it is not the desired output:</p>\n\n<pre><code>cmd.ui.Say(terminal.EntityNameColor(T(\"User-Provided:\")))   \n  for _, key := range keys {        \n         // cmd.ui.Say(\"%s: %v\", key, envVars[key])\n         here needed a new one with json.marshalIdent\n }\n</code></pre>\n\n<p>I never used go so I really do not know which one to use and how.</p>\n"}, {"tags": ["go", "goofys"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497272012, "post_id": 44493165, "comment_id": 75993251, "body": "The install is redundant. <code>go get</code> will install the binary if the referenced package is installable."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497286072, "post_id": 44493165, "comment_id": 76002866, "body": "@Adrian that&#39;s true. Actually <code>kahing&#47;goofys</code> requires <code>go install</code> otherwise it won&#39;t install."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497287158, "post_id": 44493165, "comment_id": 76003438, "body": "That doesn&#39;t make any sense... If go get won&#39;t install it, neither will go install. Is there a different sub package that needs to be installed?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497290636, "post_id": 44493165, "comment_id": 76005211, "body": "@Adrian Yep, I had a same doubt then I gave it try; go get didn&#39;t produce the binary in the <code>bin</code> directory. I have not analyzed the package, may be you can try to analysis."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497292183, "post_id": 44493165, "comment_id": 76006037, "body": "<code>go get</code> worked fine for me, it installed the binary in the correct location with no additional steps. The <code>go install</code> second step is unnecessary. Make sure you&#39;re not passing <code>-d</code> to <code>go install</code>, which causes it not to install the binary."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497292589, "post_id": 44493165, "comment_id": 76006229, "body": "I know, I have not passed <code>-d</code> argument. It didn&#39;t work for me, so I have added that step. Anyway I have update the answer with notes."}], "tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 2, "last_activity_date": 1497292513, "last_edit_date": 1497292513, "creation_date": 1497250849, "answer_id": 44493165, "question_id": 44492930, "link": "https://stackoverflow.com/questions/44492930/how-to-update-go-application-in-amazon-linux/44493165#44493165", "title": "How to update Go application in Amazon Linux", "body": "<p>Just run, <code>-u</code> is used for update.</p>\n\n<pre><code>go get -u github.com/kahing/goofys\n</code></pre>\n\n<p>Then run (optional step, if you see a binary <code>goofys</code> in <code>$GOPATH/bin</code>; go install is not required. See comments why)</p>\n\n<pre><code>go install github.com/kahing/goofys\n</code></pre>\n"}], "owner": {"reputation": 1463, "user_id": 279205, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa08ac8fe65a64f58c3846190a7002ce?s=128&d=identicon&r=PG", "display_name": "Maca", "link": "https://stackoverflow.com/users/279205/maca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 44493165, "answer_count": 1, "score": 1, "last_activity_date": 1588151001, "creation_date": 1497249939, "last_edit_date": 1588151001, "question_id": 44492930, "link": "https://stackoverflow.com/questions/44492930/how-to-update-go-application-in-amazon-linux", "title": "How to update Go application in Amazon Linux", "body": "<p>I am not familiar with Go. I want to update this application <a href=\"https://github.com/kahing/goofys\" rel=\"nofollow noreferrer\">https://github.com/kahing/goofys</a> to the recent version(right now its v0.0.10).\n  I tried</p>\n\n<pre><code>$ go get github.com/kahing/goofys\n\n$ go install github.com/kahing/goofys\n</code></pre>\n\n<p>But the version does not change. I need help.</p>\n"}, {"tags": ["angular", "http", "go"], "comments": [{"owner": {"reputation": 20547, "user_id": 326904, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a47a7bf8d53bc5ebcaa458b1a059958b?s=128&d=identicon&r=PG&f=1", "display_name": "SolidSnake", "link": "https://stackoverflow.com/users/326904/solidsnake"}, "edited": false, "score": 0, "creation_date": 1497234615, "post_id": 44490565, "comment_id": 75975234, "body": "this might be not related but you need to remove the comma at the end of &#39;Authorization&#39;: auth,"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7112693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/17e9776c22693642caf2019fc71e1371?s=128&d=identicon&r=PG&f=1", "display_name": "fabulias", "link": "https://stackoverflow.com/users/7112693/fabulias"}, "edited": false, "score": 0, "creation_date": 1497237370, "post_id": 44490652, "comment_id": 75975760, "body": "Thanks bro, my problem is almost solved, now that my authorization header manages to get some signs at the beginning and the end that are the following.  I attached my request from Postman and the one from the web App.  ANGULAR WEB APP Bearer &quot;\\&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTk2MTUy&zwnj;&#8203;MTAsImlhdCI6MTQ5NzAy&zwnj;&#8203;MzIxMCwibWFpbCI6InNl&zwnj;&#8203;bGxlciJ9.nFV5JwB5lcN&zwnj;&#8203;3e8CuMbNNx9Y6n1tW4oB&zwnj;&#8203;T-5Eh8H5-YQ4\\&quot;&quot;  POSTMAN Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTkzODIzMjk&zwnj;&#8203;sImlhdCI6MTQ5Njc5MDM&zwnj;&#8203;yOSwibWFpbCI6ImFkbWl&zwnj;&#8203;uIn0.v3GSiAIq6Bs5w3N&zwnj;&#8203;PfjWT1kJF2Wv6zRrkSQY&zwnj;&#8203;7hVDe7qQ"}, {"owner": {"reputation": 113065, "user_id": 1850609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X0C56.jpg?s=128&g=1", "display_name": "acdcjunior", "link": "https://stackoverflow.com/users/1850609/acdcjunior"}, "reply_to_user": {"reputation": 101, "user_id": 7112693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/17e9776c22693642caf2019fc71e1371?s=128&d=identicon&r=PG&f=1", "display_name": "fabulias", "link": "https://stackoverflow.com/users/7112693/fabulias"}, "edited": false, "score": 0, "creation_date": 1497238007, "post_id": 44490652, "comment_id": 75975902, "body": "What do you mean? What is the current problem exactly?"}, {"owner": {"reputation": 101, "user_id": 7112693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/17e9776c22693642caf2019fc71e1371?s=128&d=identicon&r=PG&f=1", "display_name": "fabulias", "link": "https://stackoverflow.com/users/7112693/fabulias"}, "edited": false, "score": 0, "creation_date": 1497238481, "post_id": 44490652, "comment_id": 75975993, "body": "When I build my header Authorization in angular i see Bearer &lt;token&gt; in terminal, but when I see my header in backend (go) appears this characters &quot;\\&quot;, \\&quot;&quot; and i don&#39;t continue :("}], "tags": [], "owner": {"reputation": 113065, "user_id": 1850609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X0C56.jpg?s=128&g=1", "display_name": "acdcjunior", "link": "https://stackoverflow.com/users/1850609/acdcjunior"}, "is_accepted": true, "score": 0, "last_activity_date": 1497235524, "last_edit_date": 1497235524, "creation_date": 1497234856, "answer_id": 44490652, "question_id": 44490565, "link": "https://stackoverflow.com/questions/44490565/headers-http-are-not-delivered-to-my-api/44490652#44490652", "title": "Headers http are not delivered to my API", "body": "<p>Instead of </p>\n\n<pre><code>const options = new RequestOptions(headers);\n</code></pre>\n\n<p>Do:</p>\n\n<pre><code>const options = new RequestOptions({ headers: headers });\n</code></pre>\n\n<p>The <a href=\"https://github.com/angular/angular/blob/4.0.0/packages/http/src/base_request_options.ts#L84\" rel=\"nofollow noreferrer\">constructor for <code>RequestOptions</code></a> requires a <code>RequestOptionsArgs</code>, not a <code>Headers</code>.</p>\n\n<hr>\n\n<p>Also, it seems you are not quite understanding CORS. You don't really need to send any header from the front-end to the back end (the browser will append what you need automatically when it notices it is a CORS request). Those headers (<code>Access-Control-Allow-Origin</code>) should be sent by the server only.</p>\n\n<p>For your back-end, here's an improved suggestion (should handle most cases):</p>\n\n<pre><code>func Cors() gin.HandlerFunc {\n    log.Println(\"CORS Middleware\")\n    return func(c *gin.Context) {\n        c.Writer.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n        c.Writer.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS, PUT, DELETE, UPDATE\")\n        c.Writer.Header().Set(\"Access-Control-Allow-Headers\", \"Origin, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization\")\n        c.Writer.Header().Set(\"Access-Control-Expose-Headers\", \"Content-Length\")\n        c.Writer.Header().Set(\"Access-Control-Allow-Credentials\", \"true\")\n        c.Writer.Header().Set(\"Access-Control-Max-Age\", \"86400\")\n        // c.Writer.Header().Set(\"Content-Type\", \"application/json\") // uncomment if needed\n\n         if c.Request.Method == \"OPTIONS\" {\n             fmt.Println(\"OPTIONS\")\n             c.AbortWithStatus(200)\n         } else {\n             c.Next()\n         }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7112693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/17e9776c22693642caf2019fc71e1371?s=128&d=identicon&r=PG&f=1", "display_name": "fabulias", "link": "https://stackoverflow.com/users/7112693/fabulias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 44490652, "answer_count": 1, "score": 0, "last_activity_date": 1497235739, "creation_date": 1497234152, "question_id": 44490565, "link": "https://stackoverflow.com/questions/44490565/headers-http-are-not-delivered-to-my-api", "title": "Headers http are not delivered to my API", "body": "<p>I am developing an API restful in Go and my frontend in Angular (no AngularJS), but when I call my API from my Web App in Angular I do not see my headers in my backend, in special case my authorization header, because my API has authentication based in JWT.</p>\n\n<p>Also I want to mention that I am using Postman and Go Request client to test my app and my headers are delivered in my API without problems.</p>\n\n<p>Attached below is the CORS of my backend and the API call from my frontend.</p>\n\n<p>My backend:</p>\n\n<pre><code>func Cors() gin.HandlerFunc {\n    log.Println(\"CORS Middleware\")\n    return func(c *gin.Context) {\n        c.Writer.Header().Add(\"Access-Control-Allow-Origin\", \"*\")\n        c.Next()\n    }\n}\n</code></pre>\n\n<p>My Frontend:</p>\n\n<pre><code>getData() {\n\nconst auth = `Bearer ${this.token}`;\n\nconst headers = new Headers({\n  'Access-Control-Allow-Origin': '*',\n  'Accept': 'application/json',\n  'Authorization': auth,\n});\n\nconst options = new RequestOptions(headers);\n\nconsole.log(headers); //Here I can see \n\nconst products = this.http.get('localhost:8000/api/products', options )\n                .subscribe((response: Response) =&gt; {\n                  this.data = response.json();\n                });\nreturn products;\n}\n</code></pre>\n\n<p>Thanks and sorry for my english, I think that my CORS causes problems.</p>\n"}, {"tags": ["macos", "debugging", "go", "permissions", "delve"], "comments": [{"owner": {"reputation": 476, "user_id": 144411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6fbd05e123ff2bb1d34de48424ddc1?s=128&d=identicon&r=PG", "display_name": "ivanjovanovic", "link": "https://stackoverflow.com/users/144411/ivanjovanovic"}, "edited": false, "score": 2, "creation_date": 1497222820, "post_id": 44489499, "comment_id": 75973237, "body": "Does it need to connect to port below 1024 (for which you need sudo). Maybe you can debug it with higher port and run in &quot;production&quot; on the lower port?"}, {"owner": {"reputation": 3, "user_id": 5990974, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206003090256192/picture?type=large", "display_name": "Justin Madison", "link": "https://stackoverflow.com/users/5990974/justin-madison"}, "reply_to_user": {"reputation": 476, "user_id": 144411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6fbd05e123ff2bb1d34de48424ddc1?s=128&d=identicon&r=PG", "display_name": "ivanjovanovic", "link": "https://stackoverflow.com/users/144411/ivanjovanovic"}, "edited": false, "score": 0, "creation_date": 1497224593, "post_id": 44489499, "comment_id": 75973524, "body": "Thank you so much.  That is a great idea.  I did not know about the 1024 cutoff."}, {"owner": {"reputation": 476, "user_id": 144411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6fbd05e123ff2bb1d34de48424ddc1?s=128&d=identicon&r=PG", "display_name": "ivanjovanovic", "link": "https://stackoverflow.com/users/144411/ivanjovanovic"}, "edited": false, "score": 1, "creation_date": 1497269936, "post_id": 44489499, "comment_id": 75991664, "body": "Ports below 1024 are system related and using them, unless you really want to is not advisable. As it is not advisable to run your application in production as root user, that way you expose yourself to a lot of vulnerabilities that you don&#39;t have to."}, {"owner": {"reputation": 1641, "user_id": 3828156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scFYI.jpg?s=128&g=1", "display_name": "chendesheng", "link": "https://stackoverflow.com/users/3828156/chendesheng"}, "edited": false, "score": 0, "creation_date": 1497571271, "post_id": 44489499, "comment_id": 76146298, "body": "You can try to start vscode with sudo"}], "owner": {"reputation": 3, "user_id": 5990974, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206003090256192/picture?type=large", "display_name": "Justin Madison", "link": "https://stackoverflow.com/users/5990974/justin-madison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497221876, "creation_date": 1497221876, "question_id": 44489499, "link": "https://stackoverflow.com/questions/44489499/debugging-go-code-in-visual-code-on-os-x", "title": "debugging go code in visual code on OS X", "body": "<p>I have an app that requires sudo privilege to run as it connect to a port.  I run it from the command prompt with the command.   sudo go run appname.go.   </p>\n\n<p>How can I run the app using the debugger using visual code with the delve debugger?  I can run and trace it fine until it reaches the point where it attempts to open the port and then it exits with the permissions denied error.</p>\n"}, {"tags": ["image", "go", "binary"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497220223, "post_id": 44488888, "comment_id": 75972773, "body": "It think it is not related to opening file in <code>&quot;rb&quot;</code> mode. It may caused by the pixel format in the image.  It is hard to find what was not working in your code without the input file <code>image.jpg</code>"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497220921, "post_id": 44488888, "comment_id": 75972902, "body": "@putu I&#39;ll remedy that.. all I know for sure that is in python image.open is a slightly beefy wrapper for open(&quot;file&quot;, &quot;rb&quot;) and when I read the data opened by python it looks correct."}], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1497224747, "post_id": 44489637, "comment_id": 75973551, "body": "Your solution, while providing binary data of the file, isn&#39;t quite what i&#39;m looking for.  If you examine the first image in the post, that is the binary data returned from the site and from python&#39;s Pillow image.open() function. If you run your code against the image I gave you you&#39;ll see that the output is extremely different, but no different then the other methods i mentioned I tried. I&#39;ve updated the nature of the question as I think it may be more precise and added some more information, however I do like your solution in terms of efficiency for other applications :-), so ++ for that"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1497227234, "post_id": 44489637, "comment_id": 75973949, "body": "@reticentroot: See my revised answer."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1497229081, "post_id": 44489637, "comment_id": 75974261, "body": "This is closer, but shares the same faults as the example code in my post (but faster). The expected output should be about 4kb, whereas ours is closer to 4mb.  The 0 groupings are messy and much too large (00110.. vs just 0).  I don&#39;t know if you&#39;ve run this code against the same image i am posted, I&#39;ve provide an example image of what I expect and what i&#39;m getting,  our codes provide the same output. The site I provided outputs the correct binary, as well as the two of python lines I provided. At this point I&#39;m not sure Go&#39;s image library is capable of processing the image in the way I want."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1497229237, "post_id": 44489637, "comment_id": 75974285, "body": "I noticed that you used the formula listed on the site. I&#39;ve tried that as well. I  also noticed that on the site there is a checkbox for REDUCE THE SIZE (HEIGHT/WEIGHT) OF THE PICTURE, I believe that the Pillow module and this site are doing similar things to achieve the desired effect. When that box is unchecked it is closer to what our code is outputting. Still i like the speed of your example and could be a good starting point is reversing what Pillow is doing. It&#39;s not the the answer I was hopping for,  but its a good answer and a good direction. If you think of anything else plea add on."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 3, "creation_date": 1497236723, "post_id": 44489637, "comment_id": 75975642, "body": "@reticentroot: The conversion from <code>RGB</code> to binary image should be: <code>float64((r+g+b))&#47;(3*65535)</code> since in <code>Go</code> each RGB color component is represented as 16-bit unsigned. To get similar result, resize (e.g. using <a href=\"https://github.com/nfnt/resize\" rel=\"nofollow noreferrer\">https://github.com/nfnt/resize</a>) the image (to WxH = 100x44) before converting it to binary."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497237127, "post_id": 44489637, "comment_id": 75975714, "body": "@putu thanks between that and Peter&#39;s solution I think all should be well."}, {"owner": {"reputation": 121, "user_id": 6466201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c7p3U.jpg?s=128&g=1", "display_name": "Cerberus", "link": "https://stackoverflow.com/users/6466201/cerberus"}, "edited": false, "score": 0, "creation_date": 1542315631, "post_id": 44489637, "comment_id": 93535994, "body": "While @peterSO &#39;s answer is kinda what I would&#39;ve answered, maybe the problem with messy grouping you have between 0s and 1s will be fixed by fixing an evenly size for every runes, try : <code>go get golang.org&#47;x&#47;text</code> then <code>package main  import ( \t&quot;fmt&quot;  \t&quot;golang.org&#47;x&#47;text&#47;width&quot; )  func main() { \tstr := width.Widen.String(&quot;0000101110100011001&quot;) \tfmt.Println(str) }</code> ...and maybe the output size could be solutioned by comparing 8&#178; pixels? Just an idea if you don&#39;t need the exact match..."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1497228341, "last_edit_date": 1497228341, "creation_date": 1497223459, "answer_id": 44489637, "question_id": 44488888, "link": "https://stackoverflow.com/questions/44488888/how-to-open-a-image-in-go-to-get-binary-data-of-black-and-white-pixels/44489637#44489637", "title": "How to open a image in Go to get binary data of black and white pixels?", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"image\"\n    \"os\"\n\n    _ \"image/jpeg\"\n)\n\nfunc main() {\n    fName := \"ggk3Z.jpg\"\n    f, err := os.Open(fName)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n    defer f.Close()\n    img, _, err := image.Decode(f)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n\n    // http://www.dcode.fr/binary-image\n    var txt bytes.Buffer\n    bounds := img.Bounds()\n    for y := bounds.Min.Y; y &lt; bounds.Max.Y; y++ {\n        for x := bounds.Min.X; x &lt; bounds.Max.X; x++ {\n            r, g, b, _ := img.At(x, y).RGBA()\n            bin := \"0\"\n            if float64((r+g+b))/3 &gt; 0.5 {\n                bin = \"1\"\n            }\n            txt.WriteString(bin)\n        }\n        txt.WriteString(\"\\n\")\n    }\n    fmt.Fprint(os.Stdout, txt.String())\n}\n</code></pre>\n"}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2293, "favorite_count": 0, "accepted_answer_id": 44489637, "answer_count": 1, "score": 2, "last_activity_date": 1497228341, "creation_date": 1497216055, "last_edit_date": 1497224878, "question_id": 44488888, "link": "https://stackoverflow.com/questions/44488888/how-to-open-a-image-in-go-to-get-binary-data-of-black-and-white-pixels", "title": "How to open a image in Go to get binary data of black and white pixels?", "body": "<p>I've been trying for sometime to open an image in binary mode with Go.  In Python I'd use the Pillow and image.open() (rb mode). Example.</p>\n\n<pre><code>img = Image.open(\"PNG.png\")\npix = img.getdata()  #where 0 is black and 1 is white pixel\n</code></pre>\n\n<p>That would open the image with very clean binary of white and black dots like the image below. <a href=\"https://i.stack.imgur.com/x8wS7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x8wS7.png\" alt=\"Example\"></a>  In go I've tried <code>os.Open(file.jpg)</code> to open the file.. I've tried decoding it with <code>image.Decode()</code>, I've loaded the file into <code>bytes.Buffer</code>, I've tried <code>fmt.Sprintf(\"%b\", data)</code>, all of the solutions give a byte array.  Converting that byte array to binary looks nothing like the image above.  I've also tried <code>encoding/binary</code> and its the same story with just getting bytes and the binary generated isn't what i want...</p>\n\n<p>Most recently I've tried this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"image\"\n    \"image/jpeg\"\n    \"io\"\n    \"log\"\n    \"os\"\n)\n\n// Pixel struct example\ntype Pixel struct {\n    R int\n    G int\n    B int\n    A int\n}\n\nfunc main() {\n    // You can register another format here\n    image.RegisterFormat(\"jpg\", \"jpg\", jpeg.Decode, jpeg.DecodeConfig)\n\n    file, err := os.Open(\"/Users/marcsantiago/Desktop/2033bb1b194adace86f99c7bb7d72e81.jpg\")\n\n    if err != nil {\n        log.Fatalln(\"Error: File could not be opened\")\n\n    }\n\n    defer file.Close()\n\n    pixels, err := getPixels(file)\n\n    if err != nil {\n        log.Fatalln(\"Error: Image could not be decoded\")\n    }\n    black := Pixel{0, 0, 0, 255}\n\n    for i := range pixels {\n        if pixels[i] == black {\n            fmt.Print(\"0\")\n        } else {\n            fmt.Print(\"1\")\n        }\n\n    }\n}\n\nfunc getPixels(file io.Reader) ([]Pixel, error) {\n    img, _, err := image.Decode(file)\n\n    if err != nil {\n        return nil, err\n    }\n\n    bounds := img.Bounds()\n    width, height := bounds.Max.X, bounds.Max.Y\n\n    var pixels []Pixel\n    for y := 0; y &lt; height; y++ {\n        for x := 0; x &lt; width; x++ {\n            pixels = append(pixels, rgbaToPixel(img.At(x, y).RGBA()))\n        }\n    }\n    return pixels, nil\n}\n\n// img.At(x, y).RGBA() returns four uint32 values; we want a Pixel\nfunc rgbaToPixel(r uint32, g uint32, b uint32, a uint32) Pixel {\n    return Pixel{int(r / 257), int(g / 257), int(b / 257), int(a / 257)}\n}\n</code></pre>\n\n<p>So that I can compare the binary against what I expect I converted the rgba to 1 and 0s where 0 == black... it still doesn't match up not even close. Example <a href=\"https://i.stack.imgur.com/Zf5hn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zf5hn.png\" alt=\"enter image description here\"></a></p>\n\n<p>Help please.  I'm out of ideas. PS. This site <a href=\"http://www.dcode.fr/binary-image\" rel=\"nofollow noreferrer\">http://www.dcode.fr/binary-image</a>, also opens the image and generates the data I'm expecting. </p>\n\n<p><strong>UPDATE:</strong>\nThis is the image i'm working with.. <a href=\"https://i.stack.imgur.com/ggk3Z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ggk3Z.jpg\" alt=\"Image to decode\"></a></p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 409, "user_id": 3152168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32de182081b9b54fd383d40fef3e079b?s=128&d=identicon&r=PG", "display_name": "AniSkywalker", "link": "https://stackoverflow.com/users/3152168/aniskywalker"}, "edited": false, "score": 3, "creation_date": 1497216426, "post_id": 44488526, "comment_id": 75971911, "body": "I believe you need to implement <code>encoding.TextMarshaler&#47;TextUnmarshaler</code> for JSON keys. <a href=\"https://github.com/golang/go/issues/12146\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/12146</a>"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1497233539, "post_id": 44488526, "comment_id": 75975077, "body": "may you share who your json document looks like ? also JSON objects don&#39;t accept number as key only strings"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1497237975, "post_id": 44488526, "comment_id": 75975896, "body": "@YandryPozo as pointed by @AniSkywalker, the code in question will work if <code>Priority</code> implements <code>TextUnmarshaler</code> interface, see <a href=\"https://play.golang.org/p/Siy6xdsDys\" rel=\"nofollow noreferrer\">Working example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2442, "user_id": 2992311, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4d9ba0fd9746a312062ce02e6561c3ac?s=128&d=identicon&r=PG&f=1", "display_name": "DenLilleMand", "link": "https://stackoverflow.com/users/2992311/denlillemand"}, "edited": false, "score": 1, "creation_date": 1497478799, "post_id": 44496638, "comment_id": 76101710, "body": "it is a good suggestion, but it is a open source project i am committing to, and the code uses the priorities as ints, i totally agree that using the string as index in my example would be perfectly agreeable."}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": false, "score": 1, "last_activity_date": 1497261599, "creation_date": 1497261599, "answer_id": 44496638, "question_id": 44488526, "link": "https://stackoverflow.com/questions/44488526/trying-to-unmarshal-a-mapprioritystring/44496638#44496638", "title": "Trying to Unmarshal a map[Priority]string", "body": "<p>As <code>AniSkywalker</code> and <code>putu</code> have mentioned in the comments, you could impliment <a href=\"https://golang.org/pkg/encoding/#TextUnmarshaler\" rel=\"nofollow noreferrer\"><code>encoding.TextUnmarshaler</code></a>.</p>\n\n<p>However I think in your case since you need to use <code>Priority</code> as a json map key, it's much easier to just use Priority as a type string.</p>\n\n<pre><code>type Priority string\n\nconst (\n    VERYLOW = \"verylow\"\n    LOW = \"low\"\n    MEDIUM = \"medium\"\n    HIGH = \"high\"\n    VERYHIGH = \"veryhigh\" )\n</code></pre>\n\n<p>This way you can discard the use of the following as well.</p>\n\n<pre><code>const (\n    verylow  = \"verylow\"\n    low      = \"low\"\n    medium   = \"medium\"\n    high     = \"high\"\n    veryhigh = \"veryhigh\"\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2442, "user_id": 2992311, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4d9ba0fd9746a312062ce02e6561c3ac?s=128&d=identicon&r=PG&f=1", "display_name": "DenLilleMand", "link": "https://stackoverflow.com/users/2992311/denlillemand"}, "is_accepted": true, "score": 0, "last_activity_date": 1497478752, "creation_date": 1497478752, "answer_id": 44555600, "question_id": 44488526, "link": "https://stackoverflow.com/questions/44488526/trying-to-unmarshal-a-mapprioritystring/44555600#44555600", "title": "Trying to Unmarshal a map[Priority]string", "body": "<p>I updated my code, as per the comment from @AniSkywalker to the following code, using the UnmarshalText:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Priority int\n\nconst (\n    VERYLOW = Priority(iota)\n    LOW\n    MEDIUM\n    HIGH\n    VERYHIGH\n)\n\nconst (\n    verylow  = \"verylow\"\n    low      = \"low\"\n    medium   = \"medium\"\n    high     = \"high\"\n    veryhigh = \"veryhigh\"\n\n    // ANSI color constants.\n    RESET      = \"\\x1b[0m\"\n    BRIGHT     = \"\\x1b[1m\"\n    DIM        = \"\\x1b[2m\"\n    UNDERSCORE = \"\\x1b[4m\"\n    BLINK      = \"\\x1b[5m\"\n    REVERSE    = \"\\x1b[7m\"\n    HIDDEN     = \"\\x1b[8m\"\n    FGBLACK    = \"\\x1b[30m\"\n    FGRED      = \"\\x1b[31m\"\n    FGGREEN    = \"\\x1b[32m\"\n    FGYELLOW   = \"\\x1b[33m\"\n    FGBLUE     = \"\\x1b[34m\"\n    FGMAGENTA  = \"\\x1b[35m\"\n    FGCYAN     = \"\\x1b[36m\"\n    FGWHITE    = \"\\x1b[37m\"\n    BGBLACK    = \"\\x1b[40m\"\n    BGRED      = \"\\x1b[41m\"\n    BGGREEN    = \"\\x1b[42m\"\n    BGYELLOW   = \"\\x1b[43m\"\n    BGBLUE     = \"\\x1b[44m\"\n    BGMAGENTA  = \"\\x1b[45m\"\n    BGCYAN     = \"\\x1b[46m\"\n    BGWHITE    = \"\\x1b[47m\"\n\n    TITLE_COLOUR = BRIGHT + FGGREEN\n    NUMBER_COLOR = FGGREEN\n\n    //color constants\n    BLACK         = \"BLACK\"\n    RED           = \"RED\"\n    GREEN         = \"GREEN\"\n    YELLOW        = \"YELLOW\"\n    BLUE          = \"BLUE\"\n    MAGENTA       = \"MAGENTA\"\n    CYAN          = \"CYAN\"\n    WHITE         = \"WHITE\"\n    BRIGHTBLACK   = \"BRIGHTBLACK\"\n    BRIGHTRED     = \"BRIGHTRED\"\n    BRIGHTGREEN   = \"BRIGHTGREEN\"\n    BRIGHTYELLOW  = \"BRIGHTYELLOW\"\n    BRIGHTBLUE    = \"BRIGHTBLUE\"\n    BRIGHTMAGENTA = \"BRIGHTMAGENTA\"\n    BRIGHTCYAN    = \"BRIGHTCYAN\"\n    BRIGHTWHITE   = \"BRIGHTWHITE\"\n    NOCOLOR       = \"\"\n)\n\ntype Config struct {\n    Name     string\n    FGColors map[Priority]string\n}\n\ntype MarshalableConfig struct {\n    Name     string\n    FGColors map[string]string\n}\n\nvar priorityMapFromString = map[string]Priority{\n    veryhigh: VERYHIGH,\n    high:     HIGH,\n    medium:   MEDIUM,\n    low:      LOW,\n    verylow:  VERYLOW,\n}\n\nvar priorityToString = map[Priority]string{\n    VERYHIGH: veryhigh,\n    HIGH:     high,\n    MEDIUM:   medium,\n    VERYLOW:  verylow,\n    LOW:      low,\n}\n\nfunc (p Priority) String() string {\n    return priorityToString[p]\n}\n\nfunc PriorityFromString(priority string) Priority {\n    if p, ok := priorityMapFromString[priority]; ok {\n        return p\n    }\n    return MEDIUM\n}\n\nfunc (priority *Priority) UnmarshalText(data []byte) error {\n    *priority = PriorityFromString(string(data))\n    return nil\n}\n\nfunc main() {\n    fgColors := map[string]string{\n        verylow:  RED,\n        low:      BLUE,\n        medium:   GREEN,\n        high:     BRIGHTBLUE,\n        veryhigh: BRIGHTMAGENTA,\n    }\n\n    m := MarshalableConfig{\"Alice\", fgColors}\n    b, err := json.Marshal(m)\n    if err != nil {\n        panic(err)\n    }\n\n    emptyConfig := Config{}\n    err = json.Unmarshal(b, &amp;emptyConfig)\n    if err != nil {\n        fmt.Printf(\"Got a error from unmarshalling: %+v \\n\", err)\n        panic(err)\n    }\n    fmt.Printf(\"%+v \\n\", emptyConfig)\n    var x interface{} = emptyConfig.FGColors[VERYHIGH]\n    fmt.Println(x.(string))\n\n}\n</code></pre>\n"}], "owner": {"reputation": 2442, "user_id": 2992311, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4d9ba0fd9746a312062ce02e6561c3ac?s=128&d=identicon&r=PG&f=1", "display_name": "DenLilleMand", "link": "https://stackoverflow.com/users/2992311/denlillemand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 44555600, "answer_count": 2, "score": 0, "last_activity_date": 1497478752, "creation_date": 1497213358, "last_edit_date": 1497216804, "question_id": 44488526, "link": "https://stackoverflow.com/questions/44488526/trying-to-unmarshal-a-mapprioritystring", "title": "Trying to Unmarshal a map[Priority]string", "body": "<p>I have been playing around with the Golang json package, and been running into a issue, i am simply trying to unmarshal a <code>map[string]string</code> into <code>map[Priority]string</code> the easiest way, but it seems like my UnmarshalJSON isn't even running, the following is my code, i would've like to made a playground where it could run, but i am using the OS package so:</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n)\n\ntype Priority int\n\nconst (\n    VERYLOW = Priority(iota)\n    LOW\n    MEDIUM\n    HIGH\n    VERYHIGH\n)\n\nconst (\n    verylow  = \"verylow\"\n    low      = \"low\"\n    medium   = \"medium\"\n    high     = \"high\"\n    veryhigh = \"veryhigh\"\n\n    // ANSI color constants.\n    RESET      = \"\\x1b[0m\"\n    BRIGHT     = \"\\x1b[1m\"\n    DIM        = \"\\x1b[2m\"\n    UNDERSCORE = \"\\x1b[4m\"\n    BLINK      = \"\\x1b[5m\"\n    REVERSE    = \"\\x1b[7m\"\n    HIDDEN     = \"\\x1b[8m\"\n    FGBLACK    = \"\\x1b[30m\"\n    FGRED      = \"\\x1b[31m\"\n    FGGREEN    = \"\\x1b[32m\"\n    FGYELLOW   = \"\\x1b[33m\"\n    FGBLUE     = \"\\x1b[34m\"\n    FGMAGENTA  = \"\\x1b[35m\"\n    FGCYAN     = \"\\x1b[36m\"\n    FGWHITE    = \"\\x1b[37m\"\n    BGBLACK    = \"\\x1b[40m\"\n    BGRED      = \"\\x1b[41m\"\n    BGGREEN    = \"\\x1b[42m\"\n    BGYELLOW   = \"\\x1b[43m\"\n    BGBLUE     = \"\\x1b[44m\"\n    BGMAGENTA  = \"\\x1b[45m\"\n    BGCYAN     = \"\\x1b[46m\"\n    BGWHITE    = \"\\x1b[47m\"\n\n    TITLE_COLOUR = BRIGHT + FGGREEN\n    NUMBER_COLOR = FGGREEN\n\n    //color constants\n    BLACK         = \"BLACK\"\n    RED           = \"RED\"\n    GREEN         = \"GREEN\"\n    YELLOW        = \"YELLOW\"\n    BLUE          = \"BLUE\"\n    MAGENTA       = \"MAGENTA\"\n    CYAN          = \"CYAN\"\n    WHITE         = \"WHITE\"\n    BRIGHTBLACK   = \"BRIGHTBLACK\"\n    BRIGHTRED     = \"BRIGHTRED\"\n    BRIGHTGREEN   = \"BRIGHTGREEN\"\n    BRIGHTYELLOW  = \"BRIGHTYELLOW\"\n    BRIGHTBLUE    = \"BRIGHTBLUE\"\n    BRIGHTMAGENTA = \"BRIGHTMAGENTA\"\n    BRIGHTCYAN    = \"BRIGHTCYAN\"\n    BRIGHTWHITE   = \"BRIGHTWHITE\"\n    NOCOLOR       = \"\"\n)\n\ntype Config struct {\n    Name     string\n    FGColors map[Priority]string\n}\n\ntype MarshalableConfig struct {\n    Name     string\n    FGColors map[string]string\n}\n\nvar priorityMapFromString = map[string]Priority{\n    veryhigh: VERYHIGH,\n    high:     HIGH,\n    medium:   MEDIUM,\n    low:      LOW,\n    verylow:  VERYLOW,\n}\n\nvar priorityToString = map[Priority]string{\n    VERYHIGH: veryhigh,\n    HIGH:     high,\n    MEDIUM:   medium,\n    VERYLOW:  verylow,\n    LOW:      low,\n}\n\nfunc (p Priority) String() string {\n    return priorityToString[p]\n}\n\nfunc PriorityFromString(priority string) Priority {\n    if p, ok := priorityMapFromString[priority]; ok {\n        return p\n    }\n    return MEDIUM\n}\n\nfunc (priority *Priority) UnmarshalJSON(data []byte) error {\n    var s string\n    if err := json.Unmarshal(data, &amp;s); err != nil {\n        return err\n    }\n    *priority = PriorityFromString(s)\n    return nil\n}\n\nfunc main() {\n    fgColors := map[string]string{\n        verylow:  RED,\n        low:      BLUE,\n        medium:   GREEN,\n        high:     BRIGHTBLUE,\n        veryhigh: BRIGHTMAGENTA,\n    }\n\n    m := MarshalableConfig{\"Alice\", fgColors}\n    b, err := json.Marshal(m)\n    if err != nil {\n        panic(err)\n    }\n    file, err := os.Create(\"testfile.json\")\n    if err != nil {\n        panic(err)\n    }\n    file.Write(b)\n\n    emptyConfig := Config{}\n    err = json.Unmarshal(b, &amp;emptyConfig)\n    if err != nil {\n        fmt.Printf(\"Got a error from unmarshalling: %+v \\n\", err)\n        panic(err)\n    }\n    fmt.Printf(\"%+v \\n\", emptyConfig)\n    var x interface{} = emptyConfig.FGColors[VERYHIGH]\n    fmt.Println(x.(string))\n\n}\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>json: cannot unmarshal number high into Go value of type main.Priority  \n</code></pre>\n\n<p>So the impression i get is that it never calls my UnmarshalJSON method on the priority, and i don't know if thats the way its suppose to work anyway now that i have nested the Priority type inside of the map. </p>\n\n<p>So i thouth maybe i have to do a alias type for the whole map like:</p>\n\n<pre><code>type FGColor map[Priority]string \n</code></pre>\n\n<p>and implement unmarshal on that instead, but that doesn't seem logical, because nested structs would be a nightmare to unmarshal  i would think. </p>\n\n<p>What am i doing wrong??</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7220, "user_id": 4671754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeNSv.jpg?s=128&g=1", "display_name": "Bassie", "link": "https://stackoverflow.com/users/4671754/bassie"}, "edited": false, "score": 0, "creation_date": 1497214651, "post_id": 44488012, "comment_id": 75971506, "body": "What is the package name of <code>file1</code>, <code>2</code> and <code>3</code>?"}, {"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "reply_to_user": {"reputation": 7220, "user_id": 4671754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeNSv.jpg?s=128&g=1", "display_name": "Bassie", "link": "https://stackoverflow.com/users/4671754/bassie"}, "edited": false, "score": 1, "creation_date": 1497214859, "post_id": 44488012, "comment_id": 75971560, "body": "@Bassie their package name is bcns and my folder is also named bcns"}, {"owner": {"reputation": 7220, "user_id": 4671754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeNSv.jpg?s=128&g=1", "display_name": "Bassie", "link": "https://stackoverflow.com/users/4671754/bassie"}, "edited": false, "score": 0, "creation_date": 1497215457, "post_id": 44488012, "comment_id": 75971685, "body": "Are you able to post the code? At leas the bit in <code>main.go</code> where you are now seeing the <code>imported and not used</code> error, and the definition of the function that fails"}, {"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "reply_to_user": {"reputation": 7220, "user_id": 4671754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeNSv.jpg?s=128&g=1", "display_name": "Bassie", "link": "https://stackoverflow.com/users/4671754/bassie"}, "edited": false, "score": 1, "creation_date": 1497215962, "post_id": 44488012, "comment_id": 75971804, "body": "@Bassie Okay. I had forgot to make the function names uppercase in order to be exportable."}, {"owner": {"reputation": 7220, "user_id": 4671754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeNSv.jpg?s=128&g=1", "display_name": "Bassie", "link": "https://stackoverflow.com/users/4671754/bassie"}, "edited": false, "score": 0, "creation_date": 1497216139, "post_id": 44488012, "comment_id": 75971847, "body": "Nice, glad you found the solution"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "reply_to_user": {"reputation": 7220, "user_id": 4671754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/OeNSv.jpg?s=128&g=1", "display_name": "Bassie", "link": "https://stackoverflow.com/users/4671754/bassie"}, "edited": false, "score": 0, "creation_date": 1497213796, "post_id": 44488092, "comment_id": 75971262, "body": "my bad, do not include the src in the path, just import &quot;project/folder&quot;"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "is_accepted": true, "score": 2, "last_activity_date": 1497213803, "last_edit_date": 1497213803, "creation_date": 1497210515, "answer_id": 44488092, "question_id": 44488012, "link": "https://stackoverflow.com/questions/44488012/importing-from-directory-in-windows/44488092#44488092", "title": "Importing from directory in Windows", "body": "<p>Include the full import path from your go source folder so something like this :</p>\n\n<pre><code>import(\n    \"fmt\"\n    \"project/folder\"\n)\n</code></pre>\n\n<p>I also highly recommend you restructure your GOPATH directory for organisation purposes so you can find importing your own projects much easier. <a href=\"https://astaxie.gitbooks.io/build-web-application-with-golang/en/01.2.html\" rel=\"nofollow noreferrer\">https://astaxie.gitbooks.io/build-web-application-with-golang/en/01.2.html</a></p>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 44488092, "answer_count": 1, "score": 1, "last_activity_date": 1497216242, "creation_date": 1497210054, "last_edit_date": 1497216242, "question_id": 44488012, "link": "https://stackoverflow.com/questions/44488012/importing-from-directory-in-windows", "title": "Importing from directory in Windows", "body": "<p>My <code>GOPATH</code> is <code>C:\\src\\go</code>, and I have a project which has the following directory structure:</p>\n\n<pre><code>C:\\src\\go\\src\\project\\\n                      main.go\n                      folder\\\n                             file1.go\n                             file2.go\n                             file3.go\n</code></pre>\n\n<p>Where <code>file1.go, file2.go, file3.go</code> has one package name, and <code>main.go</code> has package name of main and the main method. In <code>main.go</code> I did something like this:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"./folder\"\n)\n</code></pre>\n\n<p>But then, I run from command line <code>go run main.go</code> and I get an error messages that the functions are undefined, because the package is not loaded correctly, in fact for the package load error I get: </p>\n\n<pre><code>.\\main.go:5: imported and not used: \"_/C_/src/go/src/project/folder\"\n</code></pre>\n\n<p>where as can be seen the path is not quite correct. Any ideas how to do this import in Windows?</p>\n"}, {"tags": ["string", "go", "type-conversion", "rune"], "answers": [{"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1497210562, "post_id": 44488000, "comment_id": 75970209, "body": "Ooops, I had it backwards"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1497212377, "last_edit_date": 1497212377, "creation_date": 1497210010, "answer_id": 44488000, "question_id": 44487910, "link": "https://stackoverflow.com/questions/44487910/does-accessing-elements-of-string-as-byte-perform-conversion/44488000#44488000", "title": "Does accessing elements of string as byte perform conversion?", "body": "<p><code>string</code> values in Go store the UTF-8 encoded bytes of the text, not its characters or <code>rune</code>s.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"nofollow noreferrer\">Indexing</a> a <code>string</code> indexes its bytes: <code>str[i]</code> is of type <code>byte</code> (or <code>uint8</code>, its an alias). Also a <code>string</code> is in effect a read-only slice of bytes (with some syntactic sugar). Indexing a <code>string</code> does not require converting it to a slice.</p>\n\n<p>When you use <code>for ... range</code> on a <code>string</code>, that iterates over the <code>rune</code>s of the <code>string</code>, not its bytes!</p>\n\n<p>So if you want to iterate over the <code>runes</code> (characters), you must use a <code>for ... range</code> but without a conversion to <code>[]byte</code>, as the first form will not work with <code>string</code> values containing multi(UTF-8)-byte characters. \nThe <a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">spec allows you</a> to <code>for ... range</code> on a <code>string</code> value, and the 1st iteration value will be the byte-index of the current character, the 2nd value will be the current character value of type <code>rune</code> (which is an alias to <code>int32</code>):</p>\n\n<blockquote>\n  <p>For a string value, the \"range\" clause iterates over the Unicode code points in the string starting at byte index 0. On successive iterations, the index value will be the index of the first byte of successive UTF-8-encoded code points in the string, and the second value, of type rune, will be the value of the corresponding code point. If the iteration encounters an invalid UTF-8 sequence, the second value will be 0xFFFD, the Unicode replacement character, and the next iteration will advance a single byte in the string.</p>\n</blockquote>\n\n<p>Simple example:</p>\n\n<pre><code>s := \"Hi \u4e16\u754c\"\nfor i, c := range s {\n    fmt.Printf(\"Char pos: %d, Char: %c\\n\", i, c)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/PzMrUDzixf\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Char pos: 0, Char: H\nChar pos: 1, Char: i\nChar pos: 2, Char:  \nChar pos: 3, Char: \u4e16\nChar pos: 6, Char: \u754c\n</code></pre>\n\n<p>Must read blog post for you:</p>\n\n<p><a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">The Go Blog: Strings, bytes, runes and characters in Go</a></p>\n\n<hr>\n\n<p>Note: If you must iterate over the <em>bytes</em> of a <code>string</code> (and not its characters), using a <code>for ... range</code> with a converted <code>string</code> like your second example does not make a copy, it's optimized away. For details, see <a href=\"https://stackoverflow.com/questions/43470284/golang-bytestring-vs-bytestring/43470344#43470344\">golang: []byte(string) vs []byte(*string)</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 0, "creation_date": 1497210716, "post_id": 44488037, "comment_id": 75970265, "body": "The first part about []byte/string is not true per se. The compiler performs escape analysis and some extra optimizations around []byte/string to avoid some allocations. If you compile your first snippet with &#39;-gcflags &quot;-m -m&quot;&#39; you will see that this case won&#39;t allocate since str2 is only used in the loop and does not escape."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 0, "creation_date": 1497210807, "post_id": 44488037, "comment_id": 75970298, "body": "@nussjustin Yeah. Writing it as <code>for ... range []byte(str)</code> makes the optimization more obvious."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497212442, "post_id": 44488037, "comment_id": 75970845, "body": "In general converting <code>string</code> to <code>[]byte</code> does make a copy, but if used in a <code>for ... range</code>, it won&#39;t. It is optimized away by the compiler. For details see this <a href=\"https://stackoverflow.com/questions/43470284/golang-bytestring-vs-bytestring/43470344#43470344\">answer</a>."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 1, "last_activity_date": 1497215347, "last_edit_date": 1497215347, "creation_date": 1497210231, "answer_id": 44488037, "question_id": 44487910, "link": "https://stackoverflow.com/questions/44487910/does-accessing-elements-of-string-as-byte-perform-conversion/44488037#44488037", "title": "Does accessing elements of string as byte perform conversion?", "body": "<blockquote>\n  <p><em>Which one of the following methods are better performance-wise?</em></p>\n</blockquote>\n\n<p>Definitely not this.</p>\n\n<pre><code>str := \"large text\"\nstr2 := []byte(str)\nfor _, s := range str2 {\n  // use s\n}\n</code></pre>\n\n<p>Strings are immutable. <code>[]byte</code> is mutable. That means <code>[]byte(str)</code> makes a copy. So the above will copy the entire string. I've found being unaware of when strings are copied to be a major source of performance problems for large strings.</p>\n\n<p>If <code>str2</code> is never altered, the compiler <em>may</em> optimize away the copy. For this reason, it's better to write the above like so to ensure the byte array is never altered.</p>\n\n<pre><code>str := \"large text\"\nfor _, s := range []byte(str) {\n  // use s\n}\n</code></pre>\n\n<p>That way there's no <code>str2</code> to possibly be modified later and ruin the optimization.</p>\n\n<p>But this is a bad idea because it will corrupt any multi-byte characters. See below.</p>\n\n<hr>\n\n<p>As for the byte/rune conversion, performance is not a consideration as they are not equivalent. <code>c</code> will be a rune, and <code>str[i]</code> will be a byte. If your string contains multi-byte characters, you have to use runes.</p>\n\n<p>For example...</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n)\n\nfunc main() {\n    str := \"snow \u2603 man\"\n    for i, c := range str {\n        fmt.Printf(\"c:%c str[i]:%c\\n\", c, str[i])\n    }\n}\n\n$ go run ~/tmp/test.go\nc:s str[i]:s\nc:n str[i]:n\nc:o str[i]:o\nc:w str[i]:w\nc:  str[i]: \nc:\u2603 str[i]:\u00e2\nc:  str[i]: \nc:m str[i]:m\nc:a str[i]:a\nc:n str[i]:n\n</code></pre>\n\n<p>Note that using <code>str[i]</code> corrupts the multi-byte Unicode snowman, it only contains the first byte of the multi-byte character.</p>\n\n<p>There's no performance difference anyway as <code>range str</code> already must do the work to go character-by-character, not byte by byte.</p>\n"}], "owner": {"reputation": 1485, "user_id": 2229960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/62652e679c426edd1a718d4dd9de6d66?s=128&d=identicon&r=PG", "display_name": "Eissa N.", "link": "https://stackoverflow.com/users/2229960/eissa-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 44488037, "answer_count": 2, "score": 2, "last_activity_date": 1497215347, "creation_date": 1497209481, "last_edit_date": 1497211135, "question_id": 44487910, "link": "https://stackoverflow.com/questions/44487910/does-accessing-elements-of-string-as-byte-perform-conversion", "title": "Does accessing elements of string as byte perform conversion?", "body": "<p>In Go, to access elements of a <code>string</code>, we can write:</p>\n\n<pre><code>str := \"text\"\nfor i, c := range str {\n  // str[i] is of type byte\n  // c is of type rune\n}\n</code></pre>\n\n<p>When accessing <code>str[i]</code> does Go perform a conversion from <code>rune</code> to <code>byte</code>? I would guess the answer is yes, but I am not sure. If so, then, which one of the following methods are better performance-wise? Is one preferred over another (in terms of best practice, for example)?</p>\n\n<pre><code>str := \"large text\"\nfor i := range str {\n  // use str[i]\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>str := \"large text\"\nstr2 := []byte(str)\nfor _, s := range str2 {\n  // use s\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1497210526, "post_id": 44488033, "comment_id": 75970197, "body": "I have tried it. But it is not working. I am not getting which go routine is creating deadlock and why?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 1, "creation_date": 1497210764, "post_id": 44488033, "comment_id": 75970279, "body": "In go, non buffered channels will block until something happens on the other end of the channel, regardless of whether you&#39;re sending or receiving. So for your case make your channels buffered and this should help. <a href=\"https://tour.golang.org/concurrency/3\" rel=\"nofollow noreferrer\">tour.golang.org/concurrency/3</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8067560"}, "is_accepted": false, "score": 1, "last_activity_date": 1497210218, "creation_date": 1497210218, "answer_id": 44488033, "question_id": 44487887, "link": "https://stackoverflow.com/questions/44487887/go-lang-multiplexing-all-goroutines-are-asleep-deadlock/44488033#44488033", "title": "Go lang multiplexing all goroutines are asleep - deadlock", "body": "<p>You cannot stop a goroutine by itself, I suggest signaling the goroutine to quit with something along these lines: </p>\n\n<pre><code>stop := make(chan bool)\ngo func() {\n    for {\n        select {\n        case &lt;- stop:\n            return\n        default:\n            // Do other stuff\n        }\n    }\n}()\n\n// Do stuff\n\n// Quit goroutine\nstop&lt;- true\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1497212557, "post_id": 44488215, "comment_id": 75970876, "body": "You are right I can go with Select rather than wait for routines not knowing which is in pipeline. But I wants to know the exact reason of why it is creating deadlock. My main concern was the reason behind my code not working."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1497217523, "post_id": 44488215, "comment_id": 75972174, "body": "Yeah I have also done it. Since I go through my code again and found I have not used go routine to send value to channel in side boring function. thanks for teh update"}], "tags": [], "owner": {"reputation": 905, "user_id": 3781709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4fa60c6b287ee4f006d6c4e320daf5?s=128&d=identicon&r=PG", "display_name": "Pradip Patil", "link": "https://stackoverflow.com/users/3781709/pradip-patil"}, "is_accepted": true, "score": 2, "last_activity_date": 1497216364, "last_edit_date": 1497216364, "creation_date": 1497211304, "answer_id": 44488215, "question_id": 44487887, "link": "https://stackoverflow.com/questions/44487887/go-lang-multiplexing-all-goroutines-are-asleep-deadlock/44488215#44488215", "title": "Go lang multiplexing all goroutines are asleep - deadlock", "body": "<p>Instead of wait groups, you can use <code>select</code>: <a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency/5</a></p>\n\n<blockquote>\n  <p>The <code>select</code> statement lets a goroutine wait on multiple communication\n  operations.</p>\n  \n  <p>A <code>select</code> blocks until one of its cases can run, then it executes that\n  case. It chooses one at random if multiple are ready.</p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc main() {\n    final := talk(boring(\"Joe\"), boring(\"Ann\"))\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(&lt;-final)\n    }\n    fmt.Println(\"You are both boring I'm leaving\")\n}\n\nfunc talk(input1, input2 &lt;-chan string) &lt;-chan string {\n    c := make(chan string)\n    go func() {\n        for {\n            select {\n            case s := &lt;-input1:\n                c &lt;- s\n            case s := &lt;-input2:\n                c &lt;- s\n            }\n        }\n    }()\n    return c\n}\n\nfunc boring(msg string) &lt;-chan string {\n    c := make(chan string)\n    go func() {\n        for i := 0; i &lt; 5; i++ {\n            c &lt;- fmt.Sprintf(\"%s: %d\", msg, i)\n            time.Sleep(time.Duration(rand.Intn(1e3)) * time.Millisecond)\n        }\n    }()\n    return c\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/sDvYssPIjP\" rel=\"nofollow noreferrer\">Try it on Playground</a></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>In your given example, <code>boring</code> function doesn't use goroutine for repeated send over channel which will block forever, because:\n<a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency/2</a></p>\n\n<blockquote>\n  <p>By default, sends and receives block until the other side is ready.\n  This allows goroutines to synchronize without explicit locks or\n  condition variables.</p>\n</blockquote>\n\n<p>Also, <code>wg.Done()</code> needs to be part of goroutine.</p>\n\n<p>I got it working by doing above changes: <a href=\"https://play.golang.org/p/YN0kfBO6iT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/YN0kfBO6iT</a></p>\n"}], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 44488215, "answer_count": 2, "score": 1, "last_activity_date": 1525085882, "creation_date": 1497209352, "last_edit_date": 1525085882, "question_id": 44487887, "link": "https://stackoverflow.com/questions/44487887/go-lang-multiplexing-all-goroutines-are-asleep-deadlock", "title": "Go lang multiplexing all goroutines are asleep - deadlock", "body": "<p>I wants to create a fan-in function using multiple go routines returning channel here is my code.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\nvar wg, wg2 sync.WaitGroup\n\nfunc main() {\n    final := talk(boring(\"Joe\"), boring(\"Ann\"))\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(&lt;-final)\n    }\n    fmt.Println(\"You are both boring I'm leaving\")\n}\n\nfunc talk(input1, input2 &lt;-chan string) &lt;-chan string {\n    out := make(chan string)\n    go func() {\n        wg.Add(1)\n        for {\n            out &lt;- &lt;-input1\n        }\n    }()\n    go func() {\n        wg.Add(1)\n        for {\n            out &lt;- &lt;-input2\n        }\n    }()\n    wg.Done()\n    close(out)\n    return out\n}\n\nfunc boring(msg string) &lt;-chan string {\n    c := make(chan string)\n    for i := 0; i &lt; 5; i++ {\n        c &lt;- fmt.Sprintf(\"%s%d\\n\", msg, i)\n        time.Sleep(time.Duration(rand.Intn(1e3)) * time.Millisecond)\n    }\n    return c\n}\n</code></pre>\n\n<p>But I got an error after running above code</p>\n\n<blockquote>\n  <p>all goroutines are asleep - deadlock</p>\n</blockquote>\n\n<p>I have tried to close channels but still it is giving me the error. I have tried to assign boring returned channels to Joe and Ann and then pass those channels to talk function for multiplexing still no success. I am new to go learning channels not clear on this concept. </p>\n"}, {"tags": ["function", "go", "parameter-passing", "mutability"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497204414, "post_id": 44486749, "comment_id": 75968157, "body": "1) <a href=\"https://stackoverflow.com/questions/39605295/why-is-a-map-value-in-one-function-affected-by-an-entry-to-the-map-in-another-fu/39605565#39605565\">Why is a map value in one function affected by an entry to the map in another function?</a>; and 2) <a href=\"https://stackoverflow.com/questions/28930416/why-cant-go-iterate-maps-in-insertion-order/28931555#28931555\">Why can&#39;t Go iterate maps in insertion order?</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1497205139, "post_id": 44486749, "comment_id": 75968391, "body": "Go has no notion of &quot;pass by reference&quot; so your question makes no sense. Stop thinking about pointers as &quot;pass by reference&quot;. It&#39;s not."}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497207365, "post_id": 44486854, "comment_id": 75969184, "body": "It&#39;s an implementation detail, but if you&#39;re writing about it, passing a map value is actually passing / copying a single <b>pointer</b> to a <code>runtime.hmap</code> value. Passing a copy of the header would be bad as not all fields are pointers (and modifying e.g. the <code>count</code> field \u2013 which is the length \u2013 would not be reflected at the caller)."}], "tags": [], "owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "is_accepted": true, "score": 3, "last_activity_date": 1497213758, "last_edit_date": 1497213758, "creation_date": 1497203100, "answer_id": 44486854, "question_id": 44486749, "link": "https://stackoverflow.com/questions/44486749/strange-mutation-of-map-when-passed-value-vs-when-passed-by-reference-golang/44486854#44486854", "title": "Strange mutation of map when passed value vs when passed by reference (Golang)", "body": "<p>There is no such thing as passing by reference in Go. Whenever you pass anything (pointer, slice header, map) it is always passed by value. The question is what exactly is being passed by value (i.e. what is the actual <code>value</code> of the type).  </p>\n\n<p>When u pass a map, you pass a copy of <strong>the pointer</strong> to its header, which contains a set pointers to the buckets, as in the implementation of the HashTable. <a href=\"https://github.com/golang/go/blob/master/src/runtime/hashmap.go#L106\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/runtime/hashmap.go#L106</a> </p>\n\n<p>Therefore it rarely makes sense to pass a pointer to the map, because the operation of copying a map header pointer is extremely cheap. </p>\n\n<p>Now why the order is different, this is simply due to internal implementation of the map, ranging over the keys occurs in a random fashion. Again this is just an implementation details. </p>\n\n<p><strong>EDIT:</strong> </p>\n\n<p>As @icza correctly pointed out, passing a map is actually passing a copy of a <em>pointer</em> to the map header, not the map header itself. Sorry for the confusion</p>\n"}], "owner": {"reputation": 1, "user_id": 8145269, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GluFliSVRmc/AAAAAAAAAAI/AAAAAAAAAVo/XRNzcEwteYg/photo.jpg?sz=128", "display_name": "Pavel Shibaev", "link": "https://stackoverflow.com/users/8145269/pavel-shibaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 44486854, "answer_count": 1, "score": -2, "last_activity_date": 1497213758, "creation_date": 1497202448, "question_id": 44486749, "link": "https://stackoverflow.com/questions/44486749/strange-mutation-of-map-when-passed-value-vs-when-passed-by-reference-golang", "title": "Strange mutation of map when passed value vs when passed by reference (Golang)", "body": "<p>In the <strong>first case</strong> I pass a map to by value:\npackage main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"time\"\n)\n\nfunc timeMap(z map[string]interface{}) {\n    z[\"updated_at\"] = time.Now()\n}\n\nfunc main() {\n    foo := map[string]interface{}{\n        \"Matt\": 42,\n    }\n    timeMap(foo)\n    fmt.Println(foo)\n}\n</code></pre>\n\n<p>The output is a muted map: </p>\n\n<pre><code>map[updated_at:2009-11-10 23:00:00 +0000 UTC Matt:42]\n</code></pre>\n\n<p>In <strong>the second case</strong> the code is almost identical but for passing by reference:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc timeMap(z *map[string]interface{}) {\n    (*z)[\"updated_at\"] = time.Now()\n}\n\nfunc main() {\n    foo := map[string]interface{}{\n        \"Matt\": 42,\n    }\n    timeMap(&amp;foo)\n    fmt.Println(foo)\n}\n</code></pre>\n\n<p>Obviously, the result differs:</p>\n\n<pre><code>map[Matt:42 updated_at:2009-11-10 23:00:00 +0000 UTC]\n</code></pre>\n\n<p>My expectations were the following:</p>\n\n<ul>\n<li>when passing by value map is <strong>not</strong> muted</li>\n<li>When passing by reference map is muted like in the <strong>second</strong> case.\nHowever, in the <strong>first</strong> case map was muted but in the reverse order (compared to the <strong>second</strong> case).</li>\n</ul>\n\n<p><strong><em>Why does it happen so?</em></strong></p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1497181439, "post_id": 44483409, "comment_id": 75960957, "body": "You are confusing arrays and slices, which are two different kinds of types in Go. I would suggest first reading the following Go blog post on the subject: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}, {"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1497181636, "post_id": 44483409, "comment_id": 75961007, "body": "@TimCooper Yes, I read a bit. And I see they mean different things in Go. But, still I don&#39;t know how can I make Go not complain for something like I have above."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1497182189, "creation_date": 1497182189, "answer_id": 44483576, "question_id": 44483409, "link": "https://stackoverflow.com/questions/44483409/how-to-work-around-go-array-sizes-in-functions/44483576#44483576", "title": "How to work around Go array sizes in functions", "body": "<p>Your <code>cmplt</code> is expecting a <code>uint64</code> slice, and not a 3 element array. <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">Taking a slice</a> of <code>table[i]</code> will fix the error:</p>\n\n<pre><code>cmplt(in, table[i][:])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "is_accepted": false, "score": 0, "last_activity_date": 1497203902, "creation_date": 1497203902, "answer_id": 44487001, "question_id": 44483409, "link": "https://stackoverflow.com/questions/44483409/how-to-work-around-go-array-sizes-in-functions/44487001#44487001", "title": "How to work around Go array sizes in functions", "body": "<p>From what I see the best solution is to change your <code>cmplt</code> function definition to accept arrays: </p>\n\n<p><code>func cmplt(a, b [3]uint64) uint64 {</code></p>\n\n<p>In your code you any way rely on the size of the underlying array, hence make sure to specify your function dependencies as clear as possible </p>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 44483576, "answer_count": 2, "score": -1, "last_activity_date": 1497203902, "creation_date": 1497181195, "last_edit_date": 1497183766, "question_id": 44483409, "link": "https://stackoverflow.com/questions/44483409/how-to-work-around-go-array-sizes-in-functions", "title": "How to work around Go array sizes in functions", "body": "<p>I just started using Go, and one thing that makes me nervous is that if I define a function that accepts an array, and then pass an array to a function with a specific size, VS Code complains about it.</p>\n\n<p>For example, I have something like this:</p>\n\n<pre><code>func cmplt(a, b []uint64) uint64 {\n    var r, m, i uint64\n    r = 0\n    m = 0\n\n    for i = 2; i &gt;= 0; i-- {\n        r |= LtUint64(a[i], b[i]) &amp; ^m\n        m |= MaskUint64(NeUint64(a[i], b[i]))\n    }\n\n    return r &amp; 1\n}\n</code></pre>\n\n<p>And then I call this function inside another function as:</p>\n\n<pre><code>func singleSample(in []uint64) uint64 {\n    var i, index uint64\n    index = 0\n\n    for i = 0; i &lt; 52; i++ {\n        index = SelectUint64(index, i+1, cmplt(in, table[i]))\n    }\n\n    return index\n}\n</code></pre>\n\n<p>where <code>table</code> has type <code>[52][3]uint64</code>. I get an error message saying: <code>cannot use table (type [3]uint64) as []uint64 in argument to cmplt</code>.</p>\n\n<p>Is there any way in Go to workaround this, instead of specifically specifying the array size in function parameter?</p>\n"}, {"tags": ["go", "random"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1497177016, "post_id": 44482738, "comment_id": 75959790, "body": "You can&#39;t figure out how to convert 8 random bytes into a random 64-bit integer?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1497179255, "post_id": 44482738, "comment_id": 75960387, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39756133/how-do-you-generate-a-random-uint64-in-go/39756320#39756320\">How do you generate a random uint64 in Go?</a>"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1497180875, "post_id": 44482738, "comment_id": 75960802, "body": "Not a duplicate, @icza. He wants to use cryptographic randomness."}], "answers": [{"comments": [{"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 0, "creation_date": 1497177420, "post_id": 44482777, "comment_id": 75959890, "body": "Thanks. Didn&#39;t know for the binary encoding package."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1497176933, "creation_date": 1497176933, "answer_id": 44482777, "question_id": 44482738, "link": "https://stackoverflow.com/questions/44482738/random-64-bit-integer-from-crypto-rand/44482777#44482777", "title": "Random 64-bit integer from crypto/rand", "body": "<p>You can generate a random number with <a href=\"https://godoc.org/crypto/rand#Read\" rel=\"nofollow noreferrer\"><code>crypto.Rand</code></a>, and then convert those bytes to an int64 using the <a href=\"https://godoc.org/encoding/binary\" rel=\"nofollow noreferrer\"><code>binary</code></a> package:</p>\n\n<pre><code>func randint64() (int64, error) {\n    var b [8]byte\n    if _, err := rand.Read(b[:]); err != nil {\n        return 0, err\n    }\n    return int64(binary.LittleEndian.Uint64(b[:])), nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/2Q8tvttqbJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2Q8tvttqbJ</a> (result is cached)</p>\n\n<p>If you look at the <a href=\"https://golang.org/src/encoding/binary/binary.go#L75\" rel=\"nofollow noreferrer\">source code for <code>LittleEndian.Uint64</code></a>, you can see it's simply performing a few bit operations on the data; something that you could implemented for yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 2603, "user_id": 3316017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bf4a9d9edd876d5c65751819a7257c?s=128&d=identicon&r=PG&f=1", "display_name": "Kishan B", "link": "https://stackoverflow.com/users/3316017/kishan-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1557022628, "creation_date": 1557022628, "answer_id": 55988313, "question_id": 44482738, "link": "https://stackoverflow.com/questions/44482738/random-64-bit-integer-from-crypto-rand/55988313#55988313", "title": "Random 64-bit integer from crypto/rand", "body": "<p>You also use <code>rand.Int</code> in <code>crypto/rand</code> package</p>\n\n<pre><code>func randint64() (int64, error) {\n    val, err := rand.Int(rand.Reader, big.NewInt(int64(math.MaxInt64)))\n    if err != nil {\n        return 0, err\n    }\n    return val.Int64(), nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/fqoQxpmjOSu\" rel=\"nofollow noreferrer\">https://play.golang.org/p/fqoQxpmjOSu</a></p>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1706, "favorite_count": 0, "accepted_answer_id": 44482777, "answer_count": 2, "score": 1, "last_activity_date": 1557022628, "creation_date": 1497176684, "last_edit_date": 1497179004, "question_id": 44482738, "link": "https://stackoverflow.com/questions/44482738/random-64-bit-integer-from-crypto-rand", "title": "Random 64-bit integer from crypto/rand", "body": "<p>I want to generate 64-bit random integer using the secure <code>crypto/rand</code> package. I found this online:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/rand\"\n    \"encoding/base64\"\n)\n\n// GenerateRandomBytes returns securely generated random bytes.\n// It will return an error if the system's secure random\n// number generator fails to function correctly, in which\n// case the caller should not continue.\nfunc GenerateRandomBytes(n int) ([]byte, error) {\n    b := make([]byte, n)\n    _, err := rand.Read(b)\n    // Note that err == nil only if we read len(b) bytes.\n    if err != nil {\n        return nil, err\n    }\n\n    return b, nil\n}\n</code></pre>\n\n<p>But it seems to generate random bytes instead. I want a random 64-bit int. Namely, I want something like <code>var i uint64 = rand()</code>. Any ideas how to achieve this?</p>\n"}, {"tags": ["go", "gopath"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7007704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/214c79258c549c37b83999749d00ce3b?s=128&d=identicon&r=PG&f=1", "display_name": "Ksoze", "link": "https://stackoverflow.com/users/7007704/ksoze"}, "edited": false, "score": 0, "creation_date": 1497202366, "post_id": 44482948, "comment_id": 75967451, "body": "You are  right, I&#39;ve installed VSC. Thank you for explanation and advises."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 1, "last_activity_date": 1497178050, "creation_date": 1497178050, "answer_id": 44482948, "question_id": 44482683, "link": "https://stackoverflow.com/questions/44482683/wy-my-gopath-src-contains-few-directories-just-after-installed/44482948#44482948", "title": "Wy my GOPATH/src contains few directories just after installed?", "body": "<p>I think you not only installed the <code>Golang</code> but also install/configure <code>Visual Studio Code</code> IDE with Go Extension. Those <em>alien</em> repositories were created when the extension installs needed tools. The full list of tools can be found <a href=\"https://github.com/Microsoft/vscode-go/wiki/Go-tools-that-the-Go-extension-depends-on\" rel=\"nofollow noreferrer\">here</a>. Or probably other similar IDE/extension which depends on those tools.</p>\n\n<ol>\n<li>Yes you can clear the sources, since the IDE depends only on the compiled binary, and the sources are only needed during compilation.</li>\n<li>Same as (1). Refers to <a href=\"https://github.com/golang/go/wiki/SubRepositories\" rel=\"nofollow noreferrer\">Golang SubRepositories</a></li>\n<li>Same as (1)</li>\n<li>For now, you can clear the content of <code>pkg</code> directory but don't remove the directory. In the future, when you install some packages/libraries, the compiled version may be created under the directories, so don't remove it. For <code>bin</code> directory, don't remove the files inside it, because the IDE (Go Extension) depends on them. </li>\n</ol>\n\n<p>But, since I don't know exactly what else you've done, I think before you completely remove them, try just to move them outside your <code>GOPATH</code> or take a backup and see whether your <code>dev environment</code> works as expected. </p>\n"}], "owner": {"reputation": 47, "user_id": 7007704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/214c79258c549c37b83999749d00ce3b?s=128&d=identicon&r=PG&f=1", "display_name": "Ksoze", "link": "https://stackoverflow.com/users/7007704/ksoze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 44482948, "answer_count": 1, "score": 0, "last_activity_date": 1497178050, "creation_date": 1497176276, "question_id": 44482683, "link": "https://stackoverflow.com/questions/44482683/wy-my-gopath-src-contains-few-directories-just-after-installed", "title": "Wy my GOPATH/src contains few directories just after installed?", "body": "<p>I've just installed Golang on my machine, and I set up GOPATH.\nBut when I navigate to my go/src I see that src folder contains <code>./sourcegraph.com</code>, <code>./golang.org</code>  and  <code>./github.com</code>. Also <code>GOPATH/bin</code> and <code>GOPATH/pkg</code> also no empty.\nSo I have several questions: </p>\n\n<p>1) I know how to use <code>./github.com</code> folder for pushing my code to github, but why it contains , from box, some other not mine projects inside such as <code>acroca, cweil ... and other</code> ? Can I clear this folder?  </p>\n\n<p>2) What I should do with <code>golang.org</code> folder, can I remove it ?</p>\n\n<p>3) What I should do with <code>sourcegraph.com</code> folder, can I remove it ?</p>\n\n<p>4) Can I clear <code>bin</code> and <code>pkg</code> from preinstalled binaries and packages?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "edited": false, "score": 0, "creation_date": 1497203025, "post_id": 44482304, "comment_id": 75967679, "body": "I think the default will run a couple times before the actual message is received, but since it is wrap in a for loop this means that eventually the receive case should be triggered?"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "reply_to_user": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "edited": false, "score": 1, "creation_date": 1497211035, "post_id": 44482304, "comment_id": 75970392, "body": "That&#39;s right. But it seems that Playground enforces timeouts on goroutines. Here&#39;s what the about page states: <code>There are also limits on execution time and on CPU and memory usage</code>"}], "tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": true, "score": 2, "last_activity_date": 1497173825, "last_edit_date": 1497173825, "creation_date": 1497173391, "answer_id": 44482304, "question_id": 44481659, "link": "https://stackoverflow.com/questions/44481659/why-does-this-golang-program-hang-in-playground-when-using-for-loop-with-select/44482304#44482304", "title": "Why does this golang program hang in playground when using for loop with select?", "body": "<p>You should remove the <code>default</code> clauses from the <code>select</code> statements. </p>\n\n<p>Since your <code>select</code> statement is within a <code>for</code> loop and the <code>default</code> clause prevents it from blocking, the loop has to go through a lot of cycles before any message will be received. </p>\n\n<p>Looks like Playground detects it and stops the program.</p>\n"}, {"tags": [], "owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "is_accepted": false, "score": 1, "last_activity_date": 1497175447, "creation_date": 1497175447, "answer_id": 44482565, "question_id": 44481659, "link": "https://stackoverflow.com/questions/44481659/why-does-this-golang-program-hang-in-playground-when-using-for-loop-with-select/44482565#44482565", "title": "Why does this golang program hang in playground when using for loop with select?", "body": "<p>As @dev.bmax already mentioned, you use <code>default</code> in a wrong way.\nCheck this small <a href=\"https://tour.golang.org/concurrency/6\" rel=\"nofollow noreferrer\">article</a> about using <code>default</code> keyword.</p>\n\n<p>Also, try to add <code>runtime.GOMAXPROCS(4)</code> on the beginning of your program, run few times and check output to see, how it's working:</p>\n\n<p><a href=\"https://play.golang.org/p/TLDHNg6urB\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TLDHNg6urB</a></p>\n\n<p>Here's correct example for you:</p>\n\n<p><a href=\"https://play.golang.org/p/bc0TGdmx1Y\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bc0TGdmx1Y</a></p>\n\n<p>Note, that in this case you should use different channels for stopping additional and main goroutines.</p>\n"}], "owner": {"reputation": 527, "user_id": 3591466, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/977d21dd4dde36df3ae73e9bef6ecf49?s=128&d=identicon&r=PG&f=1", "display_name": "user3591466", "link": "https://stackoverflow.com/users/3591466/user3591466"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 44482304, "answer_count": 2, "score": 0, "last_activity_date": 1497175447, "creation_date": 1497168284, "question_id": 44481659, "link": "https://stackoverflow.com/questions/44481659/why-does-this-golang-program-hang-in-playground-when-using-for-loop-with-select", "title": "Why does this golang program hang in playground when using for loop with select?", "body": "<p>Consider this <a href=\"https://play.golang.org/p/tBfQL0MLnR\" rel=\"nofollow noreferrer\">playground</a></p>\n\n<pre><code>    messages := make(chan int, 1)\n    done := make(chan bool)\n    go func() {\n        for {\n        select {\n            case msg := &lt;- messages:\n                fmt.Println(\"receiver one\", msg)\n            case signal := &lt;-done :\n                fmt.Println(signal)\n                return\n            default:\n                fmt.Println(\"no message received\")\n        } \n        }\n    }()\n    go func() {\n        for {\n        select {\n            case msg := &lt;- messages:\n                fmt.Println(\"receiver two\", msg)\n            case signal := &lt;-done :\n                fmt.Println(signal)\n                return\n            default:\n                fmt.Println(\"no message received\")\n        } \n        }\n    }()\n    go func() {\n       for i := 0; i &lt; 2; i++ {\n           messages&lt;-i\n       }\n       done&lt;-true\n       done&lt;-true\n       done&lt;-true\n    }()\n\n    &lt;-done\n</code></pre>\n\n<p>I am trying to simulate communicate from one thread to two other thread, but it seems like the above code is running fine in my local but not in playground.</p>\n\n<p>Is there a trick to make the program work?</p>\n"}, {"tags": ["dictionary", "go", "struct", "append", "slice"], "comments": [{"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1497162724, "post_id": 44480989, "comment_id": 75956598, "body": "Is your intention to have a map that maps X to a slice of A? letSee := make(map[X][]A)"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1497164134, "last_edit_date": 1497164134, "creation_date": 1497162826, "answer_id": 44481041, "question_id": 44480989, "link": "https://stackoverflow.com/questions/44480989/first-argument-to-append-must-be-slice-have-struct-golang-map/44481041#44481041", "title": "First argument to append must be slice; have struct - golang map", "body": "<p>If in a map you want to store multiple values associated with the same key, the value type must be suitable for that. A struct isn't, but a <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">slice</a> is a perfect choice.</p>\n\n<p>So change your value type to <code>[]A</code>:</p>\n\n<pre><code>letSee := map[X][]A{}\nletSee[X{1}] = []A{A{\"T\", B{\"T1\", C{\"T11\", \"T12\"}}}}\nletSee[X{1}] = append(letSee[X{1}], A{\"L\", B{\"L1\", C{\"L11\", \"L12\"}}})\n\nfmt.Printf(\"%+v\", letSee)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/g1-aWge1IA\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[{key:1}:[{value1:T value2:{value3:T1 value4:{value5:T11 value6:T12}}}\n    {value1:L value2:{value3:L1 value4:{value5:L11 value6:L12}}}]]\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6767485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J7RXV.jpg?s=128&g=1", "display_name": "Raihan Wadud", "link": "https://stackoverflow.com/users/6767485/raihan-wadud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 0, "accepted_answer_id": 44481041, "answer_count": 1, "score": 0, "last_activity_date": 1497164134, "creation_date": 1497162345, "last_edit_date": 1497164074, "question_id": 44480989, "link": "https://stackoverflow.com/questions/44480989/first-argument-to-append-must-be-slice-have-struct-golang-map", "title": "First argument to append must be slice; have struct - golang map", "body": "<p>Can't seem to use <code>append</code> for this case. Any help would be appreciated.</p>\n\n<p>First argument to <code>append</code> must be slice:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype C struct {\n    value5 string\n    value6 string\n}\n\ntype B struct {\n    value3  string\n    value4  C\n}\n\ntype A struct {\n    value1 string\n    value2 B\n}\n\ntype X struct{\n    key     int\n}\nfunc main() {\n\n    letSee := map[X]A{}\n    letSee[X{1}]=A{\"T\",B{\"T1\",C{\"T11\",\"T12\"}}}\n    letSee[X{1}]=append(letSee[X{1}], A{\"L\",B{\"L1\",C{\"L11\",\"L12\"}}})\n\n    fmt.Println(letSee)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/R4gDO9MPBS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/R4gDO9MPBS</a></p>\n"}, {"tags": ["go", "struct", "deadlock", "channel", "goroutine"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497158212, "post_id": 44480524, "comment_id": 75955838, "body": "<a href=\"https://golang.org/ref/spec#ChannelType\" rel=\"nofollow noreferrer\">Channel</a> is used when communicating between concurrent functions. In your sample, write and read operation are not concurrent, thus resulting deadlock. Perform read or write inside a <code>goroutine</code> , e.g. <code>go func() { c &lt;- name{&quot;sfsaf&quot;, 1} }()</code>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1497158464, "post_id": 44480524, "comment_id": 75955868, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36505012/go-fatal-error-all-goroutines-are-asleep-deadlock\" title=\"go fatal error all goroutines are asleep deadlock\">stackoverflow.com/questions/36505012/&hellip;</a>."}, {"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1497159724, "post_id": 44480524, "comment_id": 75956056, "body": "@CeriseLim&#243;n It&#39;s not a duplicate question. That one didn&#39;t show how to use <code>make(chan somestruct)</code> ."}, {"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497159852, "post_id": 44480524, "comment_id": 75956081, "body": "@putu Thanks , I will try. What do you think of <code>make(chan non-empty-struct)</code>"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1497160471, "post_id": 44480524, "comment_id": 75956194, "body": "There is no reason to <code>close</code> the channel, unless you are signaling your receive that there will be no more values (e.g. with a <code>for range</code> loop).  See my answer posted below, updated with more details on how to use channels."}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1497165316, "post_id": 44480524, "comment_id": 75957128, "body": "If you add a capacity to the channel, e.g. <code>make(chan name, 10)</code>, then you can send an element without having a goroutine waiting. It will be put in a queue."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1497238272, "post_id": 44480524, "comment_id": 75975957, "body": "That&#39;s a good point @md2perpe, and one I forgot to mention in my answer: buffered channels."}, {"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "reply_to_user": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1498561462, "post_id": 44480524, "comment_id": 76537788, "body": "@md2perpe good idea"}], "answers": [{"comments": [{"owner": {"reputation": 1290, "user_id": 3741686, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OBCXg.jpg?s=128&g=1", "display_name": "Davood Falahati", "link": "https://stackoverflow.com/users/3741686/davood-falahati"}, "edited": false, "score": 0, "creation_date": 1556543582, "post_id": 44480736, "comment_id": 98463888, "body": "Thanks for answer. I wonder how to get an element of struct. In this example, I want to get &lt;-c.age which leads to this error : c.name undefined (type chan name has no field or method age)"}, {"owner": {"reputation": 1290, "user_id": 3741686, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OBCXg.jpg?s=128&g=1", "display_name": "Davood Falahati", "link": "https://stackoverflow.com/users/3741686/davood-falahati"}, "edited": false, "score": 1, "creation_date": 1556543849, "post_id": 44480736, "comment_id": 98464021, "body": "I got it, one should use (&lt;-c).age to get the certain element of the struct"}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 13, "last_activity_date": 1549509723, "last_edit_date": 1549509723, "creation_date": 1497159569, "answer_id": 44480736, "question_id": 44480524, "link": "https://stackoverflow.com/questions/44480524/can-i-use-makechan-somestruct-in-go/44480736#44480736", "title": "Can I use make(chan someStruct) in go?", "body": "<p>Yes you can pass structs. But that's not the problem in your OP. </p>\n\n<p>You sent a value on a channel, when there was no receiver ready to receive.  That is what caused your deadlock.</p>\n\n<p>Channels expect the <code>receiver</code> to be blocking, waiting for the <code>sender</code>.  This is done with Goroutines.  </p>\n\n<p>Therefore, wrap your sender in a goroutine, which will not execute right away. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype name struct {\n    name string\n    age  int\n}\n\nfunc main() {\n    c := make(chan name)\n\n    go func() {\n        c &lt;- name{\"sfsaf\", 1}\n        close(c)\n    }()\n\n    for n := range c {\n        fmt.Println(n)\n    }\n\n    fmt.Println(\"channel was closed (all done!).\")\n}\n</code></pre>\n\n<p>See it in the playground: <a href=\"https://play.golang.org/p/uaSuCaB4Ms\" rel=\"noreferrer\">https://play.golang.org/p/uaSuCaB4Ms</a></p>\n\n<p>This works because the sender's goroutine is not executing yet.  Not until the current goroutine executing gets blocked.  </p>\n\n<p>And we get blocked on the <code>for n := range c</code> loop.  This is the receiver, sitting and waiting for values.  (It is a common pattern to use the for loop to iterate over channel values as it will sit and block, waiting for values).</p>\n\n<p>So now that we are blocked waiting to receive values in the <code>for</code> loop, the inline gorouting will now execute, to send our value on the channel.</p>\n\n<p>In addition, we follow safe practices and tidy up after ourselves and <code>close(c)</code> the channel, signalling the <code>for</code> loop or <code>select</code> statement that there will be no more values sent.  <strong><em>The sender always closes, never the receiver</em></strong>. This is the pattern the <code>for</code> range loop uses to exit the for loop, and continue executing the rest of your code.</p>\n\n<hr>\n\n<p>As a side note, you did well by passing the value of the struct - not a pointer.</p>\n\n<p>If you passed a pointer, you'd have to implement some mutex lock around the object to prevent a R/W panic.</p>\n\n<p><em><a href=\"https://blog.golang.org/share-memory-by-communicating\" rel=\"noreferrer\">Do not communicate by sharing memory; instead, share memory by communicating.</a></em></p>\n\n<p>Stick to passing values, not pointers, around your channels and goroutines and reap the benefits.</p>\n"}], "owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18032, "favorite_count": 3, "accepted_answer_id": 44480736, "answer_count": 1, "score": 8, "last_activity_date": 1549509723, "creation_date": 1497157202, "question_id": 44480524, "link": "https://stackoverflow.com/questions/44480524/can-i-use-makechan-somestruct-in-go", "title": "Can I use make(chan someStruct) in go?", "body": "<p>for example:</p>\n\n<pre><code>type name struct {\n    name string\n    age int\n}\n\nfunc main() {\n      c := make(chan name)\n\n      c &lt;- name{\"sfsaf\", 1}\n      a, b := &lt;- c\n\n      close(c)\n}\n</code></pre>\n\n<p>The result:</p>\n\n<blockquote>\n  <p>fatal error: all goroutines are asleep - deadlock!</p>\n</blockquote>\n\n<p>I want to pass values through channel. What should I do?</p>\n"}, {"tags": ["json", "go", "struct", "interface"], "comments": [{"owner": {"reputation": 499, "user_id": 7730162, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43721979c3f04476bf912977953a64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Jolly23", "link": "https://stackoverflow.com/users/7730162/jolly23"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1497159012, "post_id": 44480023, "comment_id": 75955939, "body": "Great, it solves the problem. Thank you."}], "owner": {"reputation": 499, "user_id": 7730162, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43721979c3f04476bf912977953a64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Jolly23", "link": "https://stackoverflow.com/users/7730162/jolly23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "closed_date": 1497162549, "answer_count": 0, "score": 1, "last_activity_date": 1497150395, "creation_date": 1497150395, "question_id": 44480023, "link": "https://stackoverflow.com/questions/44480023/how-can-i-user-struct-and-interface-to-get-different-json-construction-in-golang", "closed_reason": "Duplicate", "title": "How can I user struct and interface to get different json construction in Golang", "body": "<h3>It can gets different json construction:</h3>\n\n<h3>type 1:</h3>\n\n<pre><code>{\"errcode\": 0, \"errmsg\": \"OK\", \"data\": {\"name\": \"Jolly\", \"age\": 19}}\n</code></pre>\n\n<h3>type 2:</h3>\n\n<pre><code>{\"errcode\": 0, \"errmsg\": \"OK\", \"data\": {\"friend\": \"Lisa\", \"country\": \"US\"}}\n</code></pre>\n\n<p>I knew I can get those by define 4 structs like:</p>\n\n<pre><code>type Base1 struct {\n    ErrCode int    `json:\"errcode\"`\n    ErrMsg  string `json:\"errmsg\"`\n    Data    Person `json:\"data\"`\n}\ntype Person struct {\n    Age   int    `json:\"age\"`\n    Name  string `json:\"name\"`\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type Base2 struct {\n    ErrCode int    `json:\"errcode\"`\n    ErrMsg  string `json:\"errmsg\"`\n    Data    Info   `json:\"data\"`\n}\ntype Info struct {\n    Friend   string    `json:\"friend\"`\n    Country  string    `json:\"country\"`\n}\n</code></pre>\n\n<p>If I want to load json 1, just type <code>data := Base1{}</code></p>\n\n<p>If I want to load json 2, just type <code>data := Base2{}</code></p>\n\n<p>But I want to know how can I get them by 3 structs and using interface, because I have lots of APIs that provide json construction, their first layer all same as struct <code>Base</code> </p>\n\n<p>like </p>\n\n<pre><code>type Base struct {\n    ErrCode int         `json:\"errcode\"`\n    ErrMsg  string      `json:\"errmsg\"`\n    Data    interface   `json:\"data\"`\n}\n</code></pre>\n\n<p>How to write the <code>data := Base{...}</code> and let it become struct Base1, Base2</p>\n"}, {"tags": ["docker", "go", "build", "docker-compose", "build-time"], "comments": [{"owner": {"reputation": 1309, "user_id": 1355754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5adff32cccbc9443a57e12ec7f84b6f?s=128&d=identicon&r=PG", "display_name": "Claudio", "link": "https://stackoverflow.com/users/1355754/claudio"}, "edited": false, "score": 0, "creation_date": 1560715401, "post_id": 44479847, "comment_id": 99817363, "body": "Another thing you can try to speed up your builds is to copy over intermediary build artifacts from previous Docker builds, using <code>COPY --from</code>. You can have a look at my article about <a href=\"https://medium.com/swlh/incremental-docker-builds-for-monolithic-codebases-2dae3ea950e\" rel=\"nofollow noreferrer\">Efficient Docker builds for large monorepos</a>, which also covers reducing image size using multi-stage builds, and making good use of the Docker build cache."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 11546838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-W_zr-F1dDsI/AAAAAAAAAAI/AAAAAAAAAI8/hVfGJ08Mw50/photo.jpg?sz=128", "display_name": "tsm", "link": "https://stackoverflow.com/users/11546838/tsm"}, "edited": false, "score": 1, "creation_date": 1605680650, "post_id": 44480085, "comment_id": 114722351, "body": "I came across this comment about fresh. Can you elaborate on how you would setup fresh?"}], "tags": [], "owner": {"reputation": 24981, "user_id": 1094246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda38b3b4f0bd9b57759601a3652e520?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1094246/robert"}, "is_accepted": true, "score": 11, "last_activity_date": 1618755289, "last_edit_date": 1618755289, "creation_date": 1497151278, "answer_id": 44480085, "question_id": 44479847, "link": "https://stackoverflow.com/questions/44479847/how-to-rebuild-go-project-efficiently-while-using-docker-compose/44480085#44480085", "title": "How to rebuild go project efficiently while using Docker Compose?", "body": "<p>You have asked a good question.</p>\n<p>The command's order in the Dockerfile really matters. Put first the things that don't change frequently, and later those that are most likely to change in every build:</p>\n<pre><code>FROM golang:1.8\n\nRUN go get -d -v ./...\nRUN go install -v ./...\n\nCOPY . /go/src/github.com/codeblooded/test1\nWORKDIR /go/src/github.com/codeblooded/test1\n\nRUN echo $PATH\n\nRUN go build -o test1 .\nCMD [&quot;test1&quot;]\nEXPOSE 3470\n</code></pre>\n<p>When a layer change regarding the previous build, docker discards the following cached layers and runs them again, sometimes wasting your time.</p>\n<p>Pay attention to the &quot;Using cache&quot; sentence that docker outputs in each layer that is re-used from the previous build.</p>\n<p>Another recommendation, for your dev work, use <a href=\"https://github.com/pilu/fresh\" rel=\"nofollow noreferrer\">fresh</a> to re-build your go app automatically every time you change the code. Just install it in the container and simply using <code>command: fresh</code> in your docker-compose.yml</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 8397052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pIb5m.jpg?s=128&g=1", "display_name": "Mat&#237;as Sueiro", "link": "https://stackoverflow.com/users/8397052/mat%c3%adas-sueiro"}, "is_accepted": false, "score": 2, "last_activity_date": 1501594971, "creation_date": 1501594971, "answer_id": 45439591, "question_id": 44479847, "link": "https://stackoverflow.com/questions/44479847/how-to-rebuild-go-project-efficiently-while-using-docker-compose/45439591#45439591", "title": "How to rebuild go project efficiently while using Docker Compose?", "body": "<p>And if you want to improve your Docker impl, you can make a smaller image. I suggest \"multi-stage builds\" to do that</p>\n\n<blockquote>\n  <p>The image size for this build is like 600mb</p>\n</blockquote>\n\n<pre><code>FROM golang:1.8\n\nRUN go get -d -v ./...\nRUN go install -v ./...\n\nCOPY . /go/src/github.com/codeblooded/test1\nWORKDIR /go/src/github.com/codeblooded/test1\n\nRUN echo $PATH\n\nRUN go build -o test1 .\nCMD [\"test1\"]\nEXPOSE 3470\n</code></pre>\n\n<blockquote>\n  <p>Using multi-stage builds, the image weight is the size of the binary and a scratch</p>\n</blockquote>\n\n<pre><code>FROM golang:1.8 as builder\n\nRUN go get -d -v ./...\nRUN go install -v ./...\n\nCOPY . /go/src/github.com/codeblooded/test1\n\nWORKDIR /go/src/github.com/codeblooded/test1\n\nRUN echo $PATH\nRUN CGO_ENABLED=0 GOOS=linux go build -o test1 .\n\n\nFROM alpine:latest\n\nRUN apk --no-cache add ca-certificates\n\nWORKDIR /go/src/github.com/codeblooded/\n\nCOPY --from=builder /go/src/github.com/codeblooded/test1 .\n\nCMD [\"test1\"]\n\nEXPOSE 3470\n</code></pre>\n\n<p>Using multi-stage builds you are using a heavy image for build the app and another really smaller for run your app.</p>\n"}], "owner": {"reputation": 664, "user_id": 822315, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b4f8fcf125c614e12c16106443e7ba7c?s=128&d=identicon&r=PG", "display_name": "codeblooded", "link": "https://stackoverflow.com/users/822315/codeblooded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3118, "favorite_count": 3, "accepted_answer_id": 44480085, "answer_count": 2, "score": 11, "last_activity_date": 1618755289, "creation_date": 1497148126, "question_id": 44479847, "link": "https://stackoverflow.com/questions/44479847/how-to-rebuild-go-project-efficiently-while-using-docker-compose", "title": "How to rebuild go project efficiently while using Docker Compose?", "body": "<p>This may be a stupid question, but I'm new to using Docker-compose. So far, I love it... but I'm having some long build times. I have a project with several dependencies, and I need to obviously rebuild the source every time I make a change. Right now, I'm calling <code>docker-compose build</code> to rebuild the container, followed by a <code>docker-compose up</code>. The problem is:</p>\n\n<ol>\n<li><p>It's rebuilding the entire container for every change I make to the source code (which takes a long time -- fetching dependencies/etc). This is significantly slowing me down.</p></li>\n<li><p>I really feel like I should just be able to run a command on the container to rebuild and then re-run the executable, like-so: <pre>\ndocker-compose run web go build .\ndocker-compose run web ./app</pre> or <pre>\ndocker-compose run web go build .\ndocker-compose restart\n</pre>  This should work because I'm using a volume to share code amongst the host and container. There shouldn't be a need to refetch all the dependencies. Shouldn't it use the freshly built executable? However, this does not reflect the built changes and port forwarding appears to break.</p></li>\n</ol>\n\n<p>For reference, here is my <em>Dockerfile</em>:</p>\n\n<pre><code>FROM golang:1.8\n\nCOPY . /go/src/github.com/codeblooded/test1\nWORKDIR /go/src/github.com/codeblooded/test1\n\nRUN echo $PATH\nRUN go get -d -v ./...\nRUN go install -v ./...\n\nRUN go build -o test1 .\nCMD [\"test1\"]\nEXPOSE 3470\n</code></pre>\n\n<p>And my <em>docker-compose.yml</em> file:</p>\n\n<pre><code>version: '3'\nservices:\n  postgres:\n    image: postgres\n    volumes:\n      - ./db/data/psql:/var/lib/postgresql/data\n      - ./db/schema:/db/schema\n  redis:\n    image: redis\n    volumes:\n      - ./db/data/redis:/data\n  server:\n    build: .\n    command: test1\n    volumes:\n      - .:/go/src/github.com/codeblooded/test1\n    ports:\n      - \"3470:3470\"\n    depends_on:\n      - postgres\n      - redis\n</code></pre>\n\n<p>Is there something I'm missing?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1497164909, "post_id": 44478956, "comment_id": 75957044, "body": "Shouldn&#39;t <code>k++</code> be last in the block instead of first?"}], "tags": [], "owner": {"reputation": 2384, "user_id": 3553432, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fb2106952e54afdb0d370799f988ba25?s=128&d=identicon&r=PG", "display_name": "nikoss", "link": "https://stackoverflow.com/users/3553432/nikoss"}, "is_accepted": true, "score": 1, "last_activity_date": 1497225755, "last_edit_date": 1497225755, "creation_date": 1497136602, "answer_id": 44478956, "question_id": 44478920, "link": "https://stackoverflow.com/questions/44478920/multiple-variables-in-multiple-for-loops-in-go/44478956#44478956", "title": "Multiple variables in multiple for loops in Go", "body": "<p>when you increment both j and k on the last loop go doesn't like it</p>\n\n<p>so try to change your code to </p>\n\n<pre><code>func naive(z, x, y []uint32, n int) {\n    var i, j, k int\n    var A, B uint32\n\n    for i = 0; i &lt; n; i++ {\n        B = 0\n\n        for j = 1; j &lt;= i; j++ {\n            muladd(x[j], y[i-j], &amp;A)\n        }\n\n        for k = 1; j &lt; n; j++ {\n            muladd(x[j], y[n-k], &amp;B)\n            k++\n        }\n    }\n}\n</code></pre>\n\n<p>pay attention to the last loop I just moved the <code>k++</code> statement inside the loop</p>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 44478956, "answer_count": 1, "score": 0, "last_activity_date": 1497225755, "creation_date": 1497136198, "question_id": 44478920, "link": "https://stackoverflow.com/questions/44478920/multiple-variables-in-multiple-for-loops-in-go", "title": "Multiple variables in multiple for loops in Go", "body": "<p>I have two for loops with two different set of variables, where I also reuse one variable from one loop in the next. The code looks roughly like this:</p>\n\n<pre><code>func naive(z, x, y []uint32, n int) {\n    var i, j, k int\n    var A, B uint32\n\n    for i = 0; i &lt; n; i++ {\n        B = 0\n\n        for j = 1; j &lt;= i; j++ {\n            muladd(x[j], y[i - j], &amp;A)\n        }\n\n        for k = 1; j &lt; n; j++, k++ {\n            muladd(x[j], y[n - k], &amp;B)\n        }\n    }\n}\n</code></pre>\n\n<p>But I get an error message at the second for loop. It says <code>missing { after for clause</code>. Any ideas how to solve it?</p>\n"}, {"tags": ["shell", "go", "gcloud"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497135028, "post_id": 44478623, "comment_id": 75952578, "body": "Your code is correct, may be <code>gcloud</code> output is going to stderr, can you try <code>CombinedOutput()</code> instead <code>Output()</code>?"}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497174439, "post_id": 44478623, "comment_id": 75959192, "body": "@jeevatkm i&#39;ve edited seems not working :/"}], "answers": [{"tags": [], "owner": {"reputation": 152, "user_id": 6233736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NP_6VGrjsLw/AAAAAAAAAAI/AAAAAAAABz4/wDWntbsnzfw/photo.jpg?sz=128", "display_name": "Rodney Jonace", "link": "https://stackoverflow.com/users/6233736/rodney-jonace"}, "is_accepted": false, "score": 0, "last_activity_date": 1497138411, "creation_date": 1497138411, "answer_id": 44479129, "question_id": 44478623, "link": "https://stackoverflow.com/questions/44478623/how-to-get-the-result-of-a-gcloud-command-in-golang/44479129#44479129", "title": "How to get the result of a gcloud command in golang?", "body": "<p>That message is printed to stderr, not stdout.</p>\n"}, {"tags": [], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "is_accepted": true, "score": 1, "last_activity_date": 1497205626, "creation_date": 1497205626, "answer_id": 44487252, "question_id": 44478623, "link": "https://stackoverflow.com/questions/44478623/how-to-get-the-result-of-a-gcloud-command-in-golang/44487252#44487252", "title": "How to get the result of a gcloud command in golang?", "body": "<p>Found it why your snippet doesn't work as expected.</p>\n\n<p>Typically <code>CombinedOutput()</code> and <code>Output()</code> returns the result after completion of given command.</p>\n\n<p>Here <code>gcloud</code> command didn't finish the execution, so we have to read it realtime. I have tested the below code snippet, it works.</p>\n\n<pre><code>cmd := exec.Command(\"bash\", \"-c\", \"gcloud auth application-default login\")\nstderr, err := cmd.StderrPipe()\nif err != nil {\n    log.Fatal(err)\n}\n\n// Start command\nif err = cmd.Start(); err != nil {\n    log.Fatal(err)\n}\n\n// prevent main() to exit before cmd completes\ndefer cmd.Wait()\n\n// read cmd output and send it to stdout\n// repalce os.Stderr as per your need\ngo io.Copy(os.Stdout, stderr)\n\nfmt.Println(\"Standby to read...\")\nfmt.Println()\n</code></pre>\n\n<p>This is just an approach, implement yours. Good luck!</p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 44487252, "answer_count": 2, "score": 1, "last_activity_date": 1616076071, "creation_date": 1497133351, "last_edit_date": 1497174414, "question_id": 44478623, "link": "https://stackoverflow.com/questions/44478623/how-to-get-the-result-of-a-gcloud-command-in-golang", "title": "How to get the result of a gcloud command in golang?", "body": "<p>Here is my code  :</p>\n\n<pre><code>package main\n\nimport (\n    \"os/exec\"\n    \"log\"\n    \"fmt\"\n)\n\nfunc main() {\n    out, err := exec.Command(\"bash\", \"-c\", \"gcloud auth application-default login\").Output()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"The output is %s\\n\", out)\n}\n</code></pre>\n\n<p>When i exec this code it opens me my browser with the good url ...\nBut i would like to get the url.</p>\n\n<p>When i type this command  : </p>\n\n<pre><code>gcloud auth application-default login\n</code></pre>\n\n<p>in my shell i have  :</p>\n\n<pre><code>Your browser has been opened to visit:\n\n    https://accounts.google.com/o/oauth2/auth?redirect_uri=h***********************************\n</code></pre>\n\n<p>And that's the text that i would like to get with the Out in my program.</p>\n\n<p>Any idea how to get it ?</p>\n\n<p>edit here are 3 thigns that i've tested with no sucess </p>\n\n<pre><code>/*\nout, err := exec.Command(\"bash\", \"-c\", \"gcloud auth application-default login\").CombinedOutput()\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Printf(\"The output is %s\\n\", out)\n\n*/\n\ncmd := exec.Command(\"bash\", \"-c\", \"gcloud auth application-default login\")\ncmdReader, err := cmd.StderrPipe()\nif err != nil {\n    fmt.Fprintln(os.Stderr, \"Error creating StdoutPipe for Cmd\", err)\n    os.Exit(1)\n}\n\nscanner := bufio.NewScanner(cmdReader)\n        go func() {\n    for scanner.Scan() {\n        fmt.Printf(\" out | %s\\n\", scanner.Text())\n    }\n\n}()\n\n\n\nout, err := exec.Command(\"bash\", \"-c\", \"gcloud auth application-default login\").Output()\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Printf(\"The date is %s\\n\", out)\n</code></pre>\n\n<p>Regards and Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1890, "user_id": 1694885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1T2T.png?s=128&g=1", "display_name": "syllabix", "link": "https://stackoverflow.com/users/1694885/syllabix"}, "edited": false, "score": 1, "creation_date": 1497128287, "post_id": 44477897, "comment_id": 75951158, "body": "you are getting a type error because you are trying to take an an expression that evaluates to a <code>bool</code> (a == 0xFFFFFFFF) and add it to a value of type <code>unit32</code>. I do not use C frequently, so pardon a potentially naive question - but why are you trying to add a boolean to an unsigned integer?"}], "answers": [{"comments": [{"owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 0, "creation_date": 1497129418, "post_id": 44478116, "comment_id": 75951459, "body": "Thank you. It&#39;s not my code actually, but they have a few macros that do similar things. Another one being <code>#define modsub(c, a, b) c = (a - b) - (b &gt; a)</code>."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "edited": false, "score": 0, "creation_date": 1497130534, "post_id": 44478116, "comment_id": 75951696, "body": "@typos In C that&#39;s legal because there is no true boolean. Comparison returns the integers 1 or 0. Go has a true boolean type and will not cast it to integer, so that isn&#39;t going to work. <code>if b &gt; a { c-- }</code> will work... buuut avoid a rote translation. Modifying a variable inside a macro, or a pointer inside a function, makes the code <i>very</i> hard to understand. That macro would be better written as <code>#define modsub(a, b) (a - b) - (b &gt; a)</code> and used as <code>c = modsub(x, y)</code>. The Go functions should also return their value rather than assign the result to a pointer. Finally, Go will inline functions."}], "tags": [], "owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "is_accepted": true, "score": 2, "last_activity_date": 1497129049, "creation_date": 1497129049, "answer_id": 44478116, "question_id": 44477897, "link": "https://stackoverflow.com/questions/44477897/mismatch-types-uint32-and-bool-in-go/44478116#44478116", "title": "Mismatch types uint32 and bool in Go", "body": "<p>So your C <code>normalize</code> macro assigns <code>c</code> to <code>a</code> if <code>a</code> is not equal to <code>0xffffffff</code>, or to <code>0</code> otherwise. I'm not sure what kind of normalization it is, but it's not my concern now.</p>\n\n<p>So given the Go function signature you provided, this would work:</p>\n\n<pre><code>func normalize(a uint32, c *uint32) {\n    if a != 0xffffffff {\n        *c = a\n    } else {\n        *c = 0\n    }\n}\n</code></pre>\n\n<p>However, I'm not sure why not just return a value instead of writing it via <code>c</code> pointer?</p>\n\n<pre><code>func normalize(a uint32) {\n    if a != 0xffffffff {\n        return a\n    }\n    return 0\n}\n</code></pre>\n\n<p>Side note: the same applies to your C macro. By the way, the macro evaluates <code>a</code> twice, this might come as a surprise if you ever pass some function with side effects as <code>a</code>. Any reason not to use (inline) function instead of a macro, or at least make it so that it evaluates to a new value, instead of assigning <code>c</code> to it?</p>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 1, "accepted_answer_id": 44478116, "answer_count": 1, "score": 0, "last_activity_date": 1497129049, "creation_date": 1497127512, "question_id": 44477897, "link": "https://stackoverflow.com/questions/44477897/mismatch-types-uint32-and-bool-in-go", "title": "Mismatch types uint32 and bool in Go", "body": "<p>I have a C macro defined like this:</p>\n\n<pre><code>#define normalize(c, a) c = (a) + ((a) == 0xFFFFFFFF)\n</code></pre>\n\n<p>I was rewriting it in Go, and as long as I know there is no such things as C macros in Go. Therefore, I created a normal function:</p>\n\n<pre><code>func normalize(a uint32, c *uint32) {\n    *c = a + (a == 0xFFFFFFFF)\n}\n</code></pre>\n\n<p>The problem is that this gives me a type mismatch error. Any ideas how to fix it?</p>\n"}, {"tags": ["go", "build"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1497199147, "last_edit_date": 1497199147, "creation_date": 1497119448, "answer_id": 44476728, "question_id": 44476388, "link": "https://stackoverflow.com/questions/44476388/if-i-import-fmt-at-the-top-of-2-files-in-the-same-go-package-will-it-compile/44476728#44476728", "title": "If I import &quot;fmt&quot; at the top of 2 files in the same Go package, will it compile it twice?", "body": "<p>No, that would be a really poor design (<em>read exception at the end</em>). By the way, it is very easy to check this, create a package named <code>a</code>, consisting of 2 files: <code>aa.go</code> and <code>ab.go</code>. Have both import <code>fmt</code>. Produce the executable (e.g. <code>go build</code>, must called on the <code>main</code> package) and check its size. Now move all code from <code>ab.go</code> that uses the <code>fmt</code> package to <code>aa.go</code>, and remove the <code>fmt</code> import from <code>ab.go</code>. Produce the executable again. They will have the same size.</p>\n\n<p>Packages are identified by their full path. No matter how many <em>files</em> (of the same package) or how many (different) <em>packages</em> refer to a package, the package will only be included once in the final executable binary.</p>\n\n<p>Also note that not everything will be included from used packages in the executable binary. Certain things that are not used / referred to may be excluded. For details see <a href=\"https://stackoverflow.com/questions/38875016/splitting-client-server-code/38875901#38875901\">Splitting client/server code</a>; and <a href=\"https://stackoverflow.com/questions/42825926/how-to-remove-unused-code-at-compile-time?noredirect=1&amp;lq=1\">How to remove unused code at compile time?</a></p>\n\n<p>There is one exception though, which is the <a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">plugins</a> introduced in Go 1.8. Packages referred to by plugins will be included in the compiled plugin \u2013they have to be\u2013, because the plugin has no guarantee what packages will be available in the executable binary that will load it. So if the <code>fmt</code> package is referred to by package <code>main</code>, and also by a plugin, the code of the <code>fmt</code> package will be included in both (in the executable binary and in the compiled plugin). It should be noted that even though the <code>fmt</code> package's code will be present twice (once in the executable and once in the plugin), there will still be only one \"instance\" of the package in the runtime (in memory) (e.g. its global variables will have one instance, and it will only be initialized once).</p>\n\n<p>An \"edge\" case is <a href=\"https://golang.org/cmd/go/#hdr-Vendor_Directories\" rel=\"nofollow noreferrer\">vendored packages</a>. If a package is vendored in a <code>vendor</code> folder, and a package refers to this vendored package, that is considered distinct from the original (that is vendored), and if the original is also referred to by another package, both will be included in the executable binary (but they are not considered the same, the full path of the vendored is different from the full path of the original).</p>\n"}], "owner": {"reputation": 259, "user_id": 6398020, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2fc9cc1619a0b712df3032f6b9772c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio", "link": "https://stackoverflow.com/users/6398020/mauricio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 44476728, "answer_count": 1, "score": 1, "last_activity_date": 1497199147, "creation_date": 1497117303, "last_edit_date": 1497119637, "question_id": 44476388, "link": "https://stackoverflow.com/questions/44476388/if-i-import-fmt-at-the-top-of-2-files-in-the-same-go-package-will-it-compile", "title": "If I import &quot;fmt&quot; at the top of 2 files in the same Go package, will it compile it twice?", "body": "<p>I'm using go 1.6 (I need to update). Let's say I have 2 files in a package, and I'm using the <code>fmt</code> package in both of them. You have to explicitly import <code>fmt</code> in both of those files, or the compiler throws and error, so does that mean it stores the <code>fmt</code> binary in my executable twice?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497148491, "post_id": 44475923, "comment_id": 75954504, "body": "No, I don&#39;t think that GC will reclaim the memory. <code>const char *p</code> in <code>GoString</code> definition implies that the pointer won&#39;t be modified (nor freed) by Go side."}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 2774002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntpn9.gif?s=128&g=1", "display_name": "Ian Lance Taylor", "link": "https://stackoverflow.com/users/2774002/ian-lance-taylor"}, "is_accepted": true, "score": 3, "last_activity_date": 1497154721, "creation_date": 1497154721, "answer_id": 44480324, "question_id": 44475923, "link": "https://stackoverflow.com/questions/44475923/making-a-go-string-in-c-with-cgo/44480324#44480324", "title": "Making a go string in C with cgo", "body": "<p>Go's garbage collector will not try to reclaim memory allocated using the C memory allocator.  What you are describing should be safe.  Of course, you may not be able to free the C memory, because you don't know when Go will be done with it.</p>\n"}], "owner": {"reputation": 16661, "user_id": 499163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/3TpUO.jpg?s=128&g=1", "display_name": "Romain Francois", "link": "https://stackoverflow.com/users/499163/romain-francois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 44480324, "answer_count": 1, "score": 1, "last_activity_date": 1497161414, "creation_date": 1497114359, "last_edit_date": 1497161414, "question_id": 44475923, "link": "https://stackoverflow.com/questions/44475923/making-a-go-string-in-c-with-cgo", "title": "Making a go string in C with cgo", "body": "<p>I'm trying to make a go string from C. I have the pointer and the length, so if I was doing it from go, I could call the <code>C.GoStringN</code> function. </p>\n\n<p><code>cgo</code> generates the <code>GoString</code> struct, so I was wondering if I could use it directly: </p>\n\n<pre><code>// struct generated by cgo\ntypedef struct { const char *p; GoInt n; } GoString;\n\n// I have s and n from somewhere else, can I do this ?\nconst char* s = ... ; // I own this and dont want go to free it\nint n = ... ;\n\nGoString st = {s, n } ;\n</code></pre>\n\n<p>I'm using this in <a href=\"https://github.com/rstats-go/_playground_string/blob/master/src/go/src/main/main.c#L13\" rel=\"nofollow noreferrer\">here</a> to make a go string out of a <code>char*</code> whose lifetime I control. The <code>GoString</code> is then used as an argument to a go function: </p>\n\n<pre><code>//export Nbytes\nfunc Nbytes(s string) int {\n  ...\n}\n</code></pre>\n\n<p>Will go's garbage collector attempt to reclaim the memory ?</p>\n"}, {"tags": ["javascript", "file", "http", "typescript", "go"], "comments": [{"owner": {"reputation": 885, "user_id": 990212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4e9e0cbad55fb36be31c38b79562f0?s=128&d=identicon&r=PG", "display_name": "Yadvendar", "link": "https://stackoverflow.com/users/990212/yadvendar"}, "edited": false, "score": 0, "creation_date": 1497117096, "post_id": 44475783, "comment_id": 75948013, "body": "After setting <code>ReadTimeout</code> to <code>5 mins</code>, are you able to transfer <code>1.7GB</code> file before timing out there?"}, {"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "reply_to_user": {"reputation": 885, "user_id": 990212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4e9e0cbad55fb36be31c38b79562f0?s=128&d=identicon&r=PG", "display_name": "Yadvendar", "link": "https://stackoverflow.com/users/990212/yadvendar"}, "edited": false, "score": 0, "creation_date": 1497118635, "post_id": 44475783, "comment_id": 75948473, "body": "The error appears within ~10 seconds of starting the transfer. Its done on lo so I don&#39;t think timeout is the problem, I just set it at 5 mins to get it out of the way."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1497123120, "post_id": 44475783, "comment_id": 75949776, "body": "It seems content is not sent to server. Test the server separately. please have a look <a href=\"https://stackoverflow.com/a/33809474\">stackoverflow.com/a/33809474</a> and try it."}, {"owner": {"reputation": 19204, "user_id": 638471, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vSVkO.png?s=128&g=1", "display_name": "vbence", "link": "https://stackoverflow.com/users/638471/vbence"}, "edited": false, "score": 0, "creation_date": 1497135115, "post_id": 44475783, "comment_id": 75952592, "body": "Two troubleshooting tips: You can try to upload the data with a different client. Wireshark will tell you which side dropped the connection."}, {"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1497220588, "post_id": 44475783, "comment_id": 75972838, "body": "Ok, so, apparently the problem is (quite obviously now that I think about it), here: formData.append(&#39;file&#39;, (&lt;HTMLInputElement&gt;document.getElementById(&#39;file&#39;)).files[0]&zwnj;&#8203;);"}, {"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1497220643, "post_id": 44475783, "comment_id": 75972849, "body": "However javascript gives no error message whatsoever and the request fails with no status or response text, so this is just sepculating, but I assume the problem is V8 not being allowed to read 1.6gb into memory. I&#39;ll have to try and take a look at the poorly docuemnted file reader api now... :/"}], "answers": [{"tags": [], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "is_accepted": true, "score": 0, "last_activity_date": 1497222671, "creation_date": 1497222671, "answer_id": 44489565, "question_id": 44475783, "link": "https://stackoverflow.com/questions/44475783/golang-net-http-uploading-large-files-undefined-errors/44489565#44489565", "title": "Golang net/http uploading large files, undefined errors", "body": "<p>OK, so, to answer my own question in case this stuff comes up again.</p>\n\n<p>The problem is poorly javascript side and I'm afraid it has to do with the fact that the web apis for form&amp;files aren't really up to scruff.</p>\n\n<p>This is the solution I came up with javascript side:</p>\n\n<pre><code>const uploadFile = (form_id: string) =&gt; {\n    const uploadForm: HTMLFormElement = &lt;HTMLFormElement&gt;document.getElementById(form_id);\n    document.getElementById(\"submit_form\").addEventListener(\"click\", function(e) {\n        e.preventDefault()\n\n        let reader: FileReader = new FileReader();\n        reader.readAsArrayBuffer((&lt;HTMLInputElement&gt;document.getElementById('file')).files[0]);\n\n        reader.onload = function(evt) {\n\n            const formData = new FormData(uploadForm);\n            const isPublic: boolean = (&lt;HTMLInputElement&gt;document.getElementById('public_switch')).checked;\n            formData.append('file', (&lt;any&gt;evt.target).result);\n            formData.append('compression', (&lt;HTMLInputElement&gt;document.getElementById('compression')).value);\n            formData.append('public', String(isPublic));\n            const xhr = new XMLHttpRequest();\n            xhr.open(\"POST\", \"/upload/\");\n            xhr.send(formData);\n            xhr.onreadystatechange = function() {\n                console.log(xhr.responseText + '  \\n status is: ' + xhr.statusText);\n            }\n\n        };\n    });\n\n}\n</code></pre>\n\n<p>Quite simple really, but it took a long time to find since in the typical javascipt-community spirit all online examples are cluttered with shit.</p>\n\n<p>The handling of large files should be done using a FileReader object which is basically called as such:</p>\n\n<pre><code> let reader = new FileReader();\n        reader.readAsArrayBuffer(dom_element_with_file_input.files[0]);\n</code></pre>\n\n<p>Then its used much like any other async web api:</p>\n\n<pre><code>    reader.onload = function(e) {\nconst your_file = e.target.result\n    }\n</code></pre>\n\n<p>The variable 'your_file' is then used for whatever you want to do with the file. In my case it was appending to form data which is done like this:</p>\n\n<pre><code>        reader.onload = function(e) {\n    const your_file = e.target.result\nconst formData = new FormData(dom_element_of_type_form);\nformData.append('my_file', your_file);\nformData.append('other_stuff', 'a string with metadata');\n        }\n</code></pre>\n\n<p>I'm leaving this as an example since I could not actually find any so post with a clear example of the file Reader API, expect for ones cluttered in literally hundreds of lines of code. The example I followed almost to the T is the one here:</p>\n\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications</a>. But I used 'readAsArrayBuffer' instead for speed purposes.</p>\n\n<p>One last note is that the reader API seems to be very slow and consumes a lot of ressource, which means that for arbitrary file sizes browser may simply crash, I had this problem with chromioum and I still can't fix it, so I'm open to suggestions, if I find a fix for browser crashes (or at least a way to handle them gracefully) I will update the question and mark it as the answer, in the meanwhile if anyone find a duplicate of my answer or a way to fix the browser crashes please tell me.</p>\n"}], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 44489565, "answer_count": 1, "score": 1, "last_activity_date": 1497222671, "creation_date": 1497113446, "question_id": 44475783, "link": "https://stackoverflow.com/questions/44475783/golang-net-http-uploading-large-files-undefined-errors", "title": "Golang net/http uploading large files, undefined errors", "body": "<p>I'm having an error that is rather hard to debug when uploading large files to a server made using golang's default net/http package. The upload code looks like this:</p>\n\n<pre><code>    uploadForm.onsubmit = () =&gt; {\n        const formData = new FormData(uploadForm);\n        const isPublic : boolean = (&lt;HTMLInputElement&gt;document.getElementById('public_switch')).checked;\n        formData.append('file', (&lt;HTMLInputElement&gt;document.getElementById('file')).files[0]);\n        formData.append('compression', (&lt;HTMLInputElement&gt;document.getElementById('compression')).value);\n        formData.append('public', String(isPublic));\n        const xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", \"/upload/\");\n        xhr.send(formData);\n        xhr.onreadystatechange = function() {\n            console.log(xhr.responseText);\n        }\n    }\n</code></pre>\n\n<p>I have a server written in golang which I start as follows:</p>\n\n<pre><code>var server = &amp;http.Server{\n    Addr:         \":\" + Configuration.Port,\n    ReadTimeout:  300 * time.Second,\n    WriteTimeout: 300 * time.Second,\n    ReadHeaderTimeout: 300 * time.Second,\n    MaxHeaderBytes: 500000000}\n\nhttp.HandleFunc(\"/upload/\", uploadFile)\n\nserver.ListenAndServe()\n</code></pre>\n\n<p>Finally I accept the and parse the file using the following code</p>\n\n<pre><code>func uploadFile(w http.ResponseWriter, r *http.Request) {\n    //Parsing the upload arguments into the values we shall be working with\n    r.ParseMultipartForm(5000000000000000)\n\n    file, _, err := r.FormFile(\"file\")\n    //etc\n</code></pre>\n\n<p>Now, the code itself fails at 'r.FormFile(\"file\")' with the very descriptive error message: \"multipart: NextPart: EOF\"</p>\n\n<p>Is there some sort of setting on file limit or timeouts which I might not be setting either in the go code or in javascript ? The file I'm trying to upload is ~1.7GB so clearly fits within the limits supported by http.</p>\n\n<p>Any idea how I could debug this issue a bit better without having to delve into FormFile or capture the request itself ? The code works just fine with smaller files ( a few Mb's).</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1497121622, "post_id": 44475474, "comment_id": 75949379, "body": "Have a look at PriorityQueue: <a href=\"https://golang.org/pkg/container/heap/#example__priorityQueue\" rel=\"nofollow noreferrer\">golang.org/pkg/container/heap/#example__priorityQueue</a>"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1497123192, "post_id": 44475474, "comment_id": 75949798, "body": "What if you have each goroutine sort its own output and then merge the results? You might get some improvement because the sorting would be done (somewhat) in parallel. You could also try radix sort to see if that gives you better performance than a typical O(N*log(N)) sort."}], "answers": [{"tags": [], "owner": {"reputation": 1890, "user_id": 1694885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1T2T.png?s=128&g=1", "display_name": "syllabix", "link": "https://stackoverflow.com/users/1694885/syllabix"}, "is_accepted": true, "score": 3, "last_activity_date": 1497127536, "last_edit_date": 1497127536, "creation_date": 1497127169, "answer_id": 44477842, "question_id": 44475474, "link": "https://stackoverflow.com/questions/44475474/golang-order-output-of-go-routines/44477842#44477842", "title": "Golang order output of go routines", "body": "<p>One thing to consider before getting into the answer is your example code will not compile. To define a type of struct in Go, you would need to change your syntax to </p>\n\n<pre><code>type output struct {\n    index       int\n    description string\n}\n</code></pre>\n\n<p>In terms of a potential solution to your problem - if you already reliably have unique index's as well as the expected count of the result set - you should not have to do any sorting at all. Instead synchronize the go routines over a channel and insert the output in an allocated slice at the respective index. You can then iterate over that slice to write the contents to a file. For example:</p>\n\n<pre><code>ch := make(chan output) //each go routine will write to this channel\nwg := new(sync.WaitGroup) //wait group to sync all go routines\n\n//execute 16 goroutines \nfor i := 0; i &lt; 16; i++ {\n    wg.Add(1)\n    go worker(ch, wg) //this is expecting each worker func to call wg.Done() when completing its portion of work\n}\n\n//create a \"quit\" channel that will be used to signal to the select statement below that your go routines are all done\nquit := make(chan bool)\ngo func() {\n    wg.Wait()\n    quit &lt;- true\n}()\n\n//initialize a slice with length and capacity to 1mil, the expected result size mentioned in your question\nsorted := make([]string, 1000000, 1000000)\n\n//use the for loop, select pattern to sync the results from your 16 go routines and insert them into the sorted slice\nfor {\n    select {\n        case output := &lt;-ch:\n            //this is not robust - check notes below example\n            sorted[output.index] = output.description\n        case &lt;-quit:\n            //implement a function you could pass the sorted slice to that will write the results\n            // Ex:  writeToFile(sorted)\n            return\n    }\n}\n</code></pre>\n\n<p>A couple notes on this solution: it is dependent upon you knowing the size of the expected result set. If you do not know what the size of the result set is - in the select statement you will need to check if the index is read from <code>ch</code> exceeds the length of the <code>sorted</code> slice and allocate additional space before inserting our you program will crash as a result of an out of bounds error</p>\n"}, {"tags": [], "owner": {"reputation": 815, "user_id": 251332, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d05b405753de7e78933bfa82a4e9d7a4?s=128&d=identicon&r=PG", "display_name": "tejzpr", "link": "https://stackoverflow.com/users/251332/tejzpr"}, "is_accepted": false, "score": 0, "last_activity_date": 1615743031, "creation_date": 1615743031, "answer_id": 66627555, "question_id": 44475474, "link": "https://stackoverflow.com/questions/44475474/golang-order-output-of-go-routines/66627555#66627555", "title": "Golang order output of go routines", "body": "<p>You could use the module Ordered-concurrently to merge your inputs and then print them in order.</p>\n<p><a href=\"https://github.com/tejzpr/ordered-concurrently\" rel=\"nofollow noreferrer\">https://github.com/tejzpr/ordered-concurrently</a></p>\n<p>Example - <a href=\"https://play.golang.org/p/hkcIuRHj63h\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hkcIuRHj63h</a></p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    concurrently &quot;github.com/tejzpr/ordered-concurrently/v2&quot;\n    &quot;log&quot;\n    &quot;math/rand&quot;\n    &quot;time&quot;\n)\n\ntype loadWorker int\n\n// The work that needs to be performed\n// The input type should implement the WorkFunction interface\nfunc (w loadWorker) Run() interface{} {\n    time.Sleep(time.Millisecond * time.Duration(rand.Intn(10)))\n    return w\n}\n\nfunc main() {\n    max := 10\n    inputChan := make(chan concurrently.WorkFunction)\n    output := concurrently.Process(inputChan, &amp;concurrently.Options{PoolSize: 10, OutChannelBuffer: 10})\n    go func() {\n        for work := 0; work &lt; max; work++ {\n            inputChan &lt;- loadWorker(work)\n        }\n        close(inputChan)\n    }()\n    for out := range output {\n        log.Println(out.Value)\n    }\n}\n\n</code></pre>\n<p>Disclaimer: I'm the module creator</p>\n"}], "owner": {"reputation": 37, "user_id": 4364069, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/44a15ae61bc2f2630f2c49592ebda7c1?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyCoder", "link": "https://stackoverflow.com/users/4364069/geekycoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "accepted_answer_id": 44477842, "answer_count": 2, "score": 0, "last_activity_date": 1615743031, "creation_date": 1497111329, "question_id": 44475474, "link": "https://stackoverflow.com/questions/44475474/golang-order-output-of-go-routines", "title": "Golang order output of go routines", "body": "<p>I have 16 go routines which return output , which is typically a struct.</p>\n\n<pre><code>struct output{\nindex int,\ndescription string,\n}\n</code></pre>\n\n<p>Now all these 16 go routines run in parallel, and the total expected output structs from all the go routines is expected to be a million. I have used the basic sorting of go lang it is very expensive to do that, could some one help me with the approach to take to sort the output based on the index and I need to write the \"description\" field on to a file based on the order of index.</p>\n\n<p>For instance ,\nif a go routine gives output as {2, \"Hello\"},{9,\"Hey\"},{4,\"Hola\"}, my output file should contain \nHello\nHola\nHey</p>\n\n<p>All these go routines run in parallel and I have no control on the order of execution , hence I am passing the index to finally order the output.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497104434, "post_id": 44473803, "comment_id": 75944300, "body": "Move the statements that creating csv file <code>marks.csv</code> i.e. <code>csvfile, err ... defer...</code> out of <code>for</code> loop, e.g. after calling <code>compute(start)</code>."}, {"owner": {"reputation": 21, "user_id": 6649089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00feea639ca8ba7e0c4b20f23c6f7a03?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy", "link": "https://stackoverflow.com/users/6649089/nancy"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497105456, "post_id": 44473803, "comment_id": 75944606, "body": "no doesn&#39;t help, values are in (key.fname, key.marks, key.lname, key.remarks), the values generated and printed by the program are correct, only thing is that i need to save it successfully in csv ."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497106196, "post_id": 44473803, "comment_id": 75944804, "body": "Probably it was not clear from my first comment. You need to move the statements (6 lines) <code>csvfile, err := os.Create(&quot;marks.csv&quot;) ... defer csvfile.Close()</code> out of for loop. The other statements (from <code>records := ...</code>) should be left as is."}, {"owner": {"reputation": 21, "user_id": 6649089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00feea639ca8ba7e0c4b20f23c6f7a03?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy", "link": "https://stackoverflow.com/users/6649089/nancy"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497108378, "post_id": 44473803, "comment_id": 75945410, "body": "it works for page=1,when we go to page=2 it replaces the csv with all values of page=2,it should add rather than deleting previous values ."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497139643, "post_id": 44473803, "comment_id": 75953341, "body": "To save all the marks into a same file, open the CSV file with <code>os.O_APPEND</code> mode (as mentioned in the answer). But, please notes that whenever a visitor visits a page, the marks will be added to the CSV file, resulting duplicates marks in the file, e.g. when visitor access page 1 twice, marks from 10 students from page 1 will be added twice to the CSV file."}, {"owner": {"reputation": 21, "user_id": 6649089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00feea639ca8ba7e0c4b20f23c6f7a03?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy", "link": "https://stackoverflow.com/users/6649089/nancy"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497170223, "post_id": 44473803, "comment_id": 75958240, "body": "hmm,could we save result from each page in different CSV,like - 1.)Visitor visits page 1 Marks for 10 students saved in CSV in marks1.csv , 2.)Visitor visits page 2 Marks for 10 students saved in CSV in marks2.csv and so on ..."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1497179111, "post_id": 44473803, "comment_id": 75960337, "body": "Yes you can (if that is what you want and meets your requirement). Just create the CSV file with <code>os.Create(fmt.Sprintf(&quot;marks%d.csv&quot;, thePageNumber))</code>. Change <code>thePageNumber</code> with a value extracted from <code>page</code> (we don&#39;t know the exact type of this variable)."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6649089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00feea639ca8ba7e0c4b20f23c6f7a03?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy", "link": "https://stackoverflow.com/users/6649089/nancy"}, "edited": false, "score": 0, "creation_date": 1497170290, "post_id": 44475423, "comment_id": 75958252, "body": "that will append the results in same CSV,could we save result from each page in different CSV,like - 1.)Visitor visits page 1 Marks for 10 students are saved in CSV in marks1.csv , 2.)Visitor visits page 2 Marks for 10 students saved in CSV in marks2.csv and so on ..."}], "tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": false, "score": 0, "last_activity_date": 1497110955, "creation_date": 1497110955, "answer_id": 44475423, "question_id": 44473803, "link": "https://stackoverflow.com/questions/44473803/write-save-data-in-csv-using-go-language/44475423#44475423", "title": "Write/Save data in CSV using GO language", "body": "<p>The basic problem is that you are calling <a href=\"https://golang.org/pkg/os/#Create\" rel=\"nofollow noreferrer\">os.Create</a>. The documentation for <a href=\"https://golang.org/pkg/os/#Create\" rel=\"nofollow noreferrer\">os.Create</a> says</p>\n\n<blockquote>\n  <p>Create creates the named file with mode 0666 (before umask), <strong>truncating it if it already exists</strong>. If successful, methods on the returned File can be used for I/O; the associated file descriptor has mode O_RDWR. If there is an error, it will be of type *PathError.</p>\n</blockquote>\n\n<p>So each call to <a href=\"https://golang.org/pkg/os/#Create\" rel=\"nofollow noreferrer\">os.Create</a> will remove all content from the file you passed. Instead what you want is probably <a href=\"https://golang.org/pkg/os/#OpenFile\" rel=\"nofollow noreferrer\">os.OpenFile</a> with the <a href=\"https://golang.org/pkg/os/#O_CREATE\" rel=\"nofollow noreferrer\">os.O_CREATE</a>, <a href=\"https://golang.org/pkg/os/#O_WRONLY\" rel=\"nofollow noreferrer\">os.O_WRONLY</a> and <a href=\"https://golang.org/pkg/os/#O_APPEND\" rel=\"nofollow noreferrer\">os.O_APPEND</a> flags. This will make sure that the file will be created, if it doesn't exists, but won't truncate it.</p>\n\n<p>But there is another problem in your code. You are calling <code>defer csvfile.Close()</code> <strong>inside the loop</strong>. A deferred function will only be executed once <strong>the function returns</strong> and not after the loop iteration. This can lead to problems, especially since you are opening the same file over and over again.</p>\n\n<p>Instead you should open the file once before the loop so that you only need to close it once. Like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n)\n\nfunc PageRequest(w http.ResponseWriter, r *http.Request) {\n    // Default page number is 1\n    if len(r.URL.Path) &lt;= 1 {\n        r.URL.Path = \"/1\"\n    }\n\n    // Page number is not negative or 0\n    page.Abs(page)\n    if page.Cmp(one) == -1 {\n        page.SetInt64(1)\n    }\n\n    // Page header\n    fmt.Fprintf(w, PageHeader, pages, previous, next)\n\n    // Save in csv\n    csvfile, err := os.OpenFile(\"marks.csv\", os.O_WRONLY|os.O_CREATE|os.O_APPEND, 0666)\n    if err != nil {\n        fmt.Println(\"Error:\", err)\n        return\n    }\n    defer csvfile.Close()\n\n    writer := csv.NewWriter(csvfile)\n    defer writer.Flush()\n\n    // Marks for UID\n    UID, length := compute(start)\n    for i := 0; i &lt; length; i++ {\n        key := UID[i]\n\n        fmt.Fprintf(w, key.fname, key.marks, key.lname, key.remarks)\n\n        records := [][]string{{key.fname, key.marks, key.lname, key.remarks}}\n\n        for _, record := range records {\n            err := writer.Write(record)\n            if err != nil {\n                fmt.Println(\"Error:\", err)\n                return\n            }\n        }\n    }\n\n    // Page Footer\n    fmt.Fprintf(w, PageFooter, previous, next)\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6649089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00feea639ca8ba7e0c4b20f23c6f7a03?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy", "link": "https://stackoverflow.com/users/6649089/nancy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 560, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497110955, "creation_date": 1497101103, "last_edit_date": 1497105482, "question_id": 44473803, "link": "https://stackoverflow.com/questions/44473803/write-save-data-in-csv-using-go-language", "title": "Write/Save data in CSV using GO language", "body": "<p>I am trying to write Student Marks to a csv file in GO .</p>\n\n<p>It is printing the desired 10 result per page with <code>Println</code> but is saving only the last value (not all 10) in csv .</p>\n\n<p>This is what I am doing </p>\n\n<ol>\n<li><p>Visitor visits <code>studentmarks.com/page=1</code>\nMarks for 10 students are displayed and it is also saved in CSV</p></li>\n<li><p>Visitor clicks next page and he is navigated to <code>studentmarks.com/page=2</code>\nMarks for another 10 students are displayed and it is also saved in subsequent column/rows in the CSV</p></li>\n</ol>\n\n<p>and so on</p>\n\n<p><code>fmt.Fprintf(w, KeyTemplate, key.fname, key.marks, key.lname )</code> is working fine and displays all 10 results per page but I am unable to save all 10 results in the CSV (with my current code, only the last result is saved).</p>\n\n<p>Here is my snippet of the code that is responsible for printing and saving the results.</p>\n\n<pre><code>func PageRequest(w http.ResponseWriter, r *http.Request) {\n    // Default page number is 1\n    if len(r.URL.Path) &lt;= 1 {\n        r.URL.Path = \"/1\"\n    }\n\n    // Page number is not negative or 0\n    page.Abs(page)\n    if page.Cmp(one) == -1 {\n        page.SetInt64(1)\n    }\n\n\n\n    // Page header\n    fmt.Fprintf(w, PageHeader, pages, previous, next)\n\n    // Marks for UID\n    UID, length := compute(start)\n    for i := 0; i &lt; length; i++ {\n        key := UID[i]\n\n\n        fmt.Fprintf(w, key.fname, key.marks, key.lname, key.remarks)\n\n\n      // Save in csv\n\n csvfile, err := os.Create(\"marks.csv\")\n          if err != nil {\n                  fmt.Println(\"Error:\", err)\n                  return\n          }\n          defer csvfile.Close()\n\n          records := [][]string{{key.fname, key.marks, key.lname, , key.remarks}}\n\n          writer := csv.NewWriter(csvfile)\n          for _, record := range records {\n                  err := writer.Write(record)\n                  if err != nil {\n                          fmt.Println(\"Error:\", err)\n                          return\n                  }\n          }\n          writer.Flush()\n\n\n    // Page Footer\n    fmt.Fprintf(w, PageFooter, previous, next)\n}\n</code></pre>\n\n<p>How can I print and save (in csv) all the 10 results using go language?</p>\n"}, {"tags": ["go", "variadic-functions"], "answers": [{"comments": [{"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1497100272, "post_id": 44473580, "comment_id": 75942904, "body": "But the problem is that I will get &#39;out of index&#39; in myvariadic func in case of more than 1 argument because ip[1] will not exists"}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 1, "last_activity_date": 1497099939, "last_edit_date": 1497099939, "creation_date": 1497099631, "answer_id": 44473580, "question_id": 44473471, "link": "https://stackoverflow.com/questions/44473471/better-way-to-deal-with-arguments-in-my-golang-variadic-function/44473580#44473580", "title": "Better way to deal with arguments in my golang variadic function", "body": "<p>You don't need to <em>initialize</em> at all.  All primitive types are initialized to their default values in Go.</p>\n\n<p>IOW, this is true.</p>\n\n<pre><code>a := \"\"\nvar b string\nfmt.Println(a == b)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/hwQmU4Myrp\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hwQmU4Myrp</a></p>\n\n<p>Therefore, you inferred assignment of <code>ip2 := \"\"</code> is already the most succinct version you can type.  </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 1, "creation_date": 1497103799, "post_id": 44474226, "comment_id": 75944083, "body": "Remove the <code>:</code> in <code>ip2 :=</code> else you&#39;ll be creating a variable with the same name in an inner scope. Good answer otherwise :)"}, {"owner": {"reputation": 1769, "user_id": 3151330, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/osBeZ.jpg?s=128&g=1", "display_name": "manikawnth", "link": "https://stackoverflow.com/users/3151330/manikawnth"}, "edited": false, "score": 1, "creation_date": 1497104283, "post_id": 44474226, "comment_id": 75944249, "body": "Yeah.. my bad.. :)"}], "tags": [], "owner": {"reputation": 1769, "user_id": 3151330, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/osBeZ.jpg?s=128&g=1", "display_name": "manikawnth", "link": "https://stackoverflow.com/users/3151330/manikawnth"}, "is_accepted": false, "score": 2, "last_activity_date": 1497104310, "last_edit_date": 1497104310, "creation_date": 1497103562, "answer_id": 44474226, "question_id": 44473471, "link": "https://stackoverflow.com/questions/44473471/better-way-to-deal-with-arguments-in-my-golang-variadic-function/44474226#44474226", "title": "Better way to deal with arguments in my golang variadic function", "body": "<p>Declare all locals up front and remove <code>else</code>. This is the only other way I could think of:</p>\n\n<pre><code>func myvariadic(ip ...string) {\n    ip1 := ip[0]\n    var ip2 string\n    if len(ip) &gt; 1 { \n        ip2 = ip[1] \n    }\n\n    fmt.Println(ip1,ip2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1497107453, "last_edit_date": 1497107453, "creation_date": 1497107034, "answer_id": 44474781, "question_id": 44473471, "link": "https://stackoverflow.com/questions/44473471/better-way-to-deal-with-arguments-in-my-golang-variadic-function/44474781#44474781", "title": "Better way to deal with arguments in my golang variadic function", "body": "<p>You may simply use:</p>\n\n<pre><code>func myvariadic(ip ...string) {\n    ip1, ip2 := ip[0], \"\"\n    if len(ip) &gt; 1 {\n        ip2 = ip[1]\n    }\n    fmt.Println(ip1, ip2)\n}\n</code></pre>\n\n<p>But don't forget that variadic functions may be called with 0 arguments specified / passed as the value for the variadic parameter. What this means is that it is also legal (not a compile-time error) to call <code>myvariadic()</code> with zero arguments, and then even <code>ip[0]</code> will cause a runtime panic.</p>\n\n<p>If your function must receive at least one string and optionally a second, you should change the signature of your function to this:</p>\n\n<pre><code>func myvariadic(ip1 string, ips ...string) {\n    ip2 := \"\"\n    if len(ips) &gt; 1 {\n        ip2 = ips[1]\n    }\n    fmt.Println(ip1, ip2)\n}\n</code></pre>\n\n<p>What this guarantees is that 1 <code>string</code> will surely be passed (else it would be a compile-time error). This is also more efficient if only one argument is passed, as no slice allocation will be needed (<code>nil</code> will be used for <code>ips</code>). See more details on this here: <a href=\"https://stackoverflow.com/questions/37270743/is-it-possible-to-trigger-compile-time-error-with-custom-library-in-golang/37271129#37271129\">Is it possible to trigger compile time error with custom library in golang?</a></p>\n\n<p>If parameters are always 1 or 2 <code>string</code> values, I'm not sure variadic parameters is justified at all, you may simply use:</p>\n\n<pre><code>func myNonVariadic(ip1, ip2 string) {\n    fmt.Println(ip1, ip2)\n}\n</code></pre>\n\n<p>And simply pass the empty string <code>\"\"</code> at the caller if <code>ip2</code> is not available.</p>\n\n<p>If you still want to stick to variadic function, another option would be to not introduce <code>ip1</code> and <code>ip2</code> inside the function, but simply use <code>ip[0]</code> and <code>ip[1]</code>. And to avoid runtime panic if less than 2 arguments is passed, you may append an empty string yourself, e.g.:</p>\n\n<pre><code>func myvariadic(ip ...string) {\n    if len(ip) &lt; 2 {\n        ip = append(ip, \"\")\n    }\n    fmt.Println(ip[0], ip[1])\n}\n</code></pre>\n\n<p>And the version that also deals with 0 arguments:</p>\n\n<pre><code>func myvariadic(ip ...string) {\n    for len(ip) &lt; 2 {\n        ip = append(ip, \"\")\n    }\n    fmt.Println(ip[0], ip[1])\n}\n</code></pre>\n\n<p>This latter version makes sure the <code>ip</code> variable (of slice type) will have at least 2 elements, even if 0 is passed.</p>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1399, "favorite_count": 0, "accepted_answer_id": 44474781, "answer_count": 3, "score": 1, "last_activity_date": 1497107490, "creation_date": 1497098894, "last_edit_date": 1497107490, "question_id": 44473471, "link": "https://stackoverflow.com/questions/44473471/better-way-to-deal-with-arguments-in-my-golang-variadic-function", "title": "Better way to deal with arguments in my golang variadic function", "body": "<p>Is there a shorter way to initialize <code>ip2</code> to empty string if there is only one argument in my variadic function below?</p>\n\n<pre><code>func myvariadic(ip ...string) {\n    ip1 := ip[0]\n    if len(ip) &gt; 1 { \n        ip2 := ip[1] \n    } else {\n        ip2 := \"\"\n        ///...\n    }\n</code></pre>\n"}, {"tags": ["linux", "bash", "go", "ssh"], "comments": [{"owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "edited": false, "score": 1, "creation_date": 1497087208, "post_id": 44471749, "comment_id": 75939064, "body": "Use <code>expect</code>: <a href=\"https://linux.die.net/man/1/expect\" rel=\"nofollow noreferrer\">linux.die.net/man/1/expect</a>"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "reply_to_user": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "edited": false, "score": 1, "creation_date": 1497087397, "post_id": 44471749, "comment_id": 75939113, "body": "It&#39;d be good if my solution could be solved without any dependencies on the ssh remote machine."}, {"owner": {"reputation": 12620, "user_id": 4687135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/386484f527a8df3c1fdd3e2dde112533?s=128&d=identicon&r=PG", "display_name": "Eric Renouf", "link": "https://stackoverflow.com/users/4687135/eric-renouf"}, "edited": false, "score": 0, "creation_date": 1497091764, "post_id": 44471749, "comment_id": 75940327, "body": "If possible, you could make <code>sudo</code> not require a password, at least for that command.  You can see <a href=\"https://askubuntu.com/questions/470383/how-to-avoid-prompt-password-for-sudo\">this question on a sister site</a> to see how to include the password in your script and have <code>sudo</code> use it--though this then puts your password in plain text in your code of course"}], "answers": [{"tags": [], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "is_accepted": true, "score": 6, "last_activity_date": 1497275948, "creation_date": 1497275948, "answer_id": 44501303, "question_id": 44471749, "link": "https://stackoverflow.com/questions/44471749/golang-enter-ssh-sudo-password-on-prompt-or-exit/44501303#44501303", "title": "Golang Enter SSH Sudo Password on Prompt (or exit)", "body": "<p>I managed to fix this issue by making use of the <code>session.StdoutPipe()</code> and <code>session.StdinPipe()</code>. I wrote a go routine which scans each byte and checks if the last written line starts with <code>\"[sudo] password for \"</code> and ends with <code>\": \"</code>. It will write the <code>password + \"\\n\"</code> to the <code>session.StdinPipe()</code> which continues execution of the script.</p>\n\n<p><strong>Here's all of the code I have for this.</strong></p>\n\n<pre><code>package ssh\n\nimport (\n    \"bufio\"\n    \"io\"\n    \"log\"\n    \"net\"\n    \"strings\"\n\n    \"golang.org/x/crypto/ssh\"\n)\n\ntype Connection struct {\n    *ssh.Client\n    password string\n}\n\nfunc Connect(addr, user, password string) (*Connection, error) {\n    sshConfig := &amp;ssh.ClientConfig{\n        User: user,\n        Auth: []ssh.AuthMethod{\n            ssh.Password(password),\n        },\n        HostKeyCallback: ssh.HostKeyCallback(func(hostname string, remote net.Addr, key ssh.PublicKey) error { return nil }),\n    }\n\n    conn, err := ssh.Dial(\"tcp\", addr, sshConfig)\n    if err != nil {\n        return nil, err\n    }\n\n    return &amp;Connection{conn, password}, nil\n\n}\n\nfunc (conn *Connection) SendCommands(cmds ...string) ([]byte, error) {\n    session, err := conn.NewSession()\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer session.Close()\n\n    modes := ssh.TerminalModes{\n        ssh.ECHO:          0,     // disable echoing\n        ssh.TTY_OP_ISPEED: 14400, // input speed = 14.4kbaud\n        ssh.TTY_OP_OSPEED: 14400, // output speed = 14.4kbaud\n    }\n\n    err = session.RequestPty(\"xterm\", 80, 40, modes)\n    if err != nil {\n        return []byte{}, err\n    }\n\n    in, err := session.StdinPipe()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    out, err := session.StdoutPipe()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    var output []byte\n\n    go func(in io.WriteCloser, out io.Reader, output *[]byte) {\n        var (\n            line string\n            r    = bufio.NewReader(out)\n        )\n        for {\n            b, err := r.ReadByte()\n            if err != nil {\n                break\n            }\n\n            *output = append(*output, b)\n\n            if b == byte('\\n') {\n                line = \"\"\n                continue\n            }\n\n            line += string(b)\n\n            if strings.HasPrefix(line, \"[sudo] password for \") &amp;&amp; strings.HasSuffix(line, \": \") {\n                _, err = in.Write([]byte(conn.password + \"\\n\"))\n                if err != nil {\n                    break\n                }\n            }\n        }\n    }(in, out, &amp;output)\n\n    cmd := strings.Join(cmds, \"; \")\n    _, err = session.Output(cmd)\n    if err != nil {\n        return []byte{}, err\n    }\n\n    return output, nil\n}\n</code></pre>\n\n<p><strong>And an example of how you could use it.</strong></p>\n\n<pre><code>// ssh refers to the custom package above\nconn, err := ssh.Connect(\"0.0.0.0:22\", \"username\", \"password\")\nif err != nil {\n    log.Fatal(err)\n}\n\noutput, err := conn.SendCommands(\"sleep 2\", \"echo Hello!\")\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Println(string(output))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 3659453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7152e604d857f7852f3c73cd6a96a324?s=128&d=identicon&r=PG&f=1", "display_name": "feiyuw", "link": "https://stackoverflow.com/users/3659453/feiyuw"}, "is_accepted": false, "score": 1, "last_activity_date": 1550475979, "last_edit_date": 1550475979, "creation_date": 1550474038, "answer_id": 54742084, "question_id": 44471749, "link": "https://stackoverflow.com/questions/44471749/golang-enter-ssh-sudo-password-on-prompt-or-exit/54742084#54742084", "title": "Golang Enter SSH Sudo Password on Prompt (or exit)", "body": "<p>A work around is converting <code>sudo [cmd]</code> to <code>echo [password] | sudo -S [cmd]</code>, it is not good, but working for me.</p>\n"}, {"comments": [{"owner": {"reputation": 114, "user_id": 6112580, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cOg1T0rjzr4/AAAAAAAAAAI/AAAAAAAABR0/LCBWRgtmh7w/photo.jpg?sz=128", "display_name": "Eric Zhou", "link": "https://stackoverflow.com/users/6112580/eric-zhou"}, "edited": false, "score": 0, "creation_date": 1552632588, "post_id": 55056091, "comment_id": 97092191, "body": "since you code has no BREAK in you go func for loop, you should add <a href=\"https://stackoverflow.com/questions/6807590/how-to-stop-a-goroutine\">goroutine quit</a>"}], "tags": [], "owner": {"reputation": 31, "user_id": 11168637, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lP-92KUxySU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdCkZgcjVqdbNfojOI0jsfFocxm4A/mo/photo.jpg?sz=128", "display_name": "Yanan Xu", "link": "https://stackoverflow.com/users/11168637/yanan-xu"}, "is_accepted": false, "score": 3, "last_activity_date": 1552013952, "creation_date": 1552013952, "answer_id": 55056091, "question_id": 44471749, "link": "https://stackoverflow.com/questions/44471749/golang-enter-ssh-sudo-password-on-prompt-or-exit/55056091#55056091", "title": "Golang Enter SSH Sudo Password on Prompt (or exit)", "body": "<p>This is an issue that output stream can't be fully captured for @acidic's code.\nThe updated code is as following </p>\n\n<pre><code>package main\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"net\"\n    \"strings\"\n\n    \"golang.org/x/crypto/ssh\"\n)\n\ntype Connection struct {\n    *ssh.Client\n    password string\n}\n\nfunc Connect(addr, user, password string) (*Connection, error) {\n    sshConfig := &amp;ssh.ClientConfig{\n        User: user,\n        Auth: []ssh.AuthMethod{\n            ssh.Password(password),\n        },\n        HostKeyCallback: ssh.HostKeyCallback(func(hostname string, remote net.Addr, key ssh.PublicKey) error { return nil }),\n    }\n\n    conn, err := ssh.Dial(\"tcp\", addr, sshConfig)\n    if err != nil {\n        return nil, err\n    }\n\n    return &amp;Connection{conn, password}, nil\n\n}\n\nfunc (conn *Connection) SendCommands(cmds string) ([]byte, error) {\n    session, err := conn.NewSession()\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer session.Close()\n\n    modes := ssh.TerminalModes{\n        ssh.ECHO:          0,     // disable echoing\n        ssh.TTY_OP_ISPEED: 14400, // input speed = 14.4kbaud\n        ssh.TTY_OP_OSPEED: 14400, // output speed = 14.4kbaud\n    }\n\n    err = session.RequestPty(\"xterm\", 80, 40, modes)\n    if err != nil {\n        return []byte{}, err\n    }\n\n    stdoutB := new(bytes.Buffer)\n    session.Stdout = stdoutB\n    in, _ := session.StdinPipe()\n\n    go func(in io.Writer, output *bytes.Buffer) {\n        for {\n            if strings.Contains(string(output.Bytes()), \"[sudo] password for \") {\n                _, err = in.Write([]byte(conn.password + \"\\n\"))\n                if err != nil {\n                    break\n                }\n                fmt.Println(\"put the password ---  end .\")\n                break\n            }\n        }\n    }(in, stdoutB)\n\n    err = session.Run(cmds)\n    if err != nil {\n        return []byte{}, err\n    }\n    return stdoutB.Bytes(), nil\n}\n\nfunc main() {\n    // ssh refers to the custom package above\n    conn, err := Connect(\"0.0.0.0:22\", \"username\", \"password\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    output, err := conn.SendCommands(\"sudo docker ps\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(output))\n\n}\n</code></pre>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5150, "favorite_count": 0, "accepted_answer_id": 44501303, "answer_count": 3, "score": 2, "last_activity_date": 1552013952, "creation_date": 1497087033, "last_edit_date": 1497088175, "question_id": 44471749, "link": "https://stackoverflow.com/questions/44471749/golang-enter-ssh-sudo-password-on-prompt-or-exit", "title": "Golang Enter SSH Sudo Password on Prompt (or exit)", "body": "<p>I'm trying to run a script via the <a href=\"https://godoc.org/golang.org/x/crypto/ssh\" rel=\"nofollow noreferrer\">SSH package</a> in my Go program (so far I've had success).</p>\n\n<p>My issue is, the script attempts to run a command with sudo if the user has sudo privileges, and this causes the bash script to pause until a password is entered by the user.</p>\n\n<p>For example:</p>\n\n<pre><code>[ERROR ] Install cs-server: Checking dependencies: missing: lib32gcc1\n# It attempts to install the missing dependencies with sudo but pauses here\n[sudo] password for guest: \n</code></pre>\n\n<p>In my Go program, I have written something that looks similar to this:</p>\n\n<pre><code>// Connect to SSH and retreive session...\n\nout, err := session.StdoutPipe()\nif err != nil {\n    log.Fatal(err)\n}\n\ngo func(out io.Reader) {\n    r := bufio.NewScanner(out)\n    for r.Scan() {\n        fmt.Println(r.Text())\n    }\n}(out)\n\n// Execute ssh command...\n</code></pre>\n\n<p>And I receive the exact same output as the example above, only in this case, I don't even see the line <code>[sudo] password for guest:</code>... it only prints up to <code>[ERROR ] Install cs-server: Checking dependencies: missing: lib32gcc1</code> and pauses forever.</p>\n\n<p>How can I bypass this pause? My options are to either enter the password from my Go program automatically, or end the ssh execution and just receive the output.</p>\n"}, {"tags": ["spring-mvc", "go"], "answers": [{"comments": [{"owner": {"reputation": 12885, "user_id": 363603, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a17548ea579a54c180a7d37a7818501a?s=128&d=identicon&r=PG", "display_name": "u123", "link": "https://stackoverflow.com/users/363603/u123"}, "edited": false, "score": 0, "creation_date": 1497092442, "post_id": 44471803, "comment_id": 75940536, "body": "Not sure I understand the last part, you suggest that I use spring for the web application and then Go for the web server?"}, {"owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "reply_to_user": {"reputation": 12885, "user_id": 363603, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a17548ea579a54c180a7d37a7818501a?s=128&d=identicon&r=PG", "display_name": "u123", "link": "https://stackoverflow.com/users/363603/u123"}, "edited": false, "score": 1, "creation_date": 1497093638, "post_id": 44471803, "comment_id": 75940920, "body": "Sorry for misunderstanding. I mean, that you can use Spring for entire web application and Go for some parts of it. Then, you can reverse traffic from front-end nginx to back-end Spring/Go. For example, Go can deal very well with high concurrency requests processing and with long living connections (WebSockets, long polling requests and so on). But keep in mind, that Java also can do all that things perfectly well. Check Netty and Vert.x frameworks. Also, read about microservice architecture."}], "tags": [], "owner": {"reputation": 887, "user_id": 8099995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WLnoV.png?s=128&g=1", "display_name": "berserkk", "link": "https://stackoverflow.com/users/8099995/berserkk"}, "is_accepted": false, "score": 2, "last_activity_date": 1497089076, "last_edit_date": 1497089076, "creation_date": 1497087458, "answer_id": 44471803, "question_id": 44471389, "link": "https://stackoverflow.com/questions/44471389/java-spring-combined-with-a-go-web-server/44471803#44471803", "title": "Java spring combined with a Go web server?", "body": "<blockquote>\n  <p>Would it make sense to use Go as the Web Server for handling traffic/request and have Spring behind for the actual building of the back-end/MVC?</p>\n</blockquote>\n\n<p>No, I don't think so. It's better to take <code>nginx</code> and have Tomcat server with Spring application behind it.</p>\n\n<blockquote>\n  <p>Or would you typically needs to make a decision between either Go or Spring?</p>\n</blockquote>\n\n<p>Yes, choose what's better for your current task. You can use Spring for the entire web application, Go for some parts, etc.</p>\n"}], "owner": {"reputation": 12885, "user_id": 363603, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a17548ea579a54c180a7d37a7818501a?s=128&d=identicon&r=PG", "display_name": "u123", "link": "https://stackoverflow.com/users/363603/u123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "closed_date": 1497236530, "answer_count": 1, "score": -1, "last_activity_date": 1497093616, "creation_date": 1497084658, "question_id": 44471389, "link": "https://stackoverflow.com/questions/44471389/java-spring-combined-with-a-go-web-server", "closed_reason": "Opinion-based", "title": "Java spring combined with a Go web server?", "body": "<p>I am looking at using Go for my web server:</p>\n\n<p><a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">https://golang.org/doc/articles/wiki/</a></p>\n\n<p>I was actually going for:</p>\n\n<p><a href=\"https://spring.io/\" rel=\"nofollow noreferrer\">https://spring.io/</a></p>\n\n<p>since it comes with tons of modules for a web server, like security, data, etc.</p>\n\n<p>Would it make sense to use Go as the Web Server for handling traffic/request and have Spring behind for the actual building of the back-end/MVC?</p>\n\n<p>Or would you typically needs to make a decision between either Go or Spring?</p>\n"}, {"tags": ["inheritance", "go", "data-structures", "collections", "embedding"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497195645, "post_id": 44470806, "comment_id": 75965213, "body": "The absolute best possible advice I can give, and I cannot say this strongly enough: <i>write Go like Go.</i> Do not try to emulate patterns you&#39;ve used in other languages. That way leads only to madness."}], "answers": [{"comments": [{"owner": {"reputation": 487, "user_id": 3004786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mQ3jy.jpg?s=128&g=1", "display_name": "huehnerhose", "link": "https://stackoverflow.com/users/3004786/huehnerhose"}, "edited": false, "score": 0, "creation_date": 1497167539, "post_id": 44472826, "comment_id": 75957619, "body": "Thanks for the input! I fear we are on different pages at some point.  I tried to condense the Source for the post, but now I think this complicated things. <a href=\"https://github.com/huehnerhose/learning_go/tree/mocked_version\" rel=\"nofollow noreferrer\">Full Code</a> My current problem is <a href=\"https://github.com/huehnerhose/learning_go/blob/mocked_version/datastructures/collection.go#L18\" rel=\"nofollow noreferrer\">here</a>. I want a generic get(byId) on my &quot;collection&quot;. And I don&#39;t get rid of the feeling of working &quot;against the principals of go&quot; here"}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "reply_to_user": {"reputation": 487, "user_id": 3004786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mQ3jy.jpg?s=128&g=1", "display_name": "huehnerhose", "link": "https://stackoverflow.com/users/3004786/huehnerhose"}, "edited": false, "score": 0, "creation_date": 1497174678, "post_id": 44472826, "comment_id": 75959251, "body": "I suggest you try asking in Go Slack channel, what you did is far away from idiomatic go and it&#39;s principals. You have a higher chance to be set in correct direction if you ask around in that channel."}], "tags": [], "owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "is_accepted": false, "score": 0, "last_activity_date": 1497094736, "last_edit_date": 1497094736, "creation_date": 1497094294, "answer_id": 44472826, "question_id": 44470806, "link": "https://stackoverflow.com/questions/44470806/golang-inheritance-to-implement-backbone-like-collection-model/44472826#44472826", "title": "golang inheritance to implement backbone like collection / model", "body": "<p>You are pretty close to getting it right, but you have mixed up multiple different things. </p>\n\n<p>Complete example: <a href=\"https://play.golang.org/p/wpj82QRVUP\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wpj82QRVUP</a></p>\n\n<ol>\n<li>Type embedding</li>\n</ol>\n\n<p>So you have two models <code>User</code>, <code>Address</code> and they both share common fields and maybe methods. This is a good reason to create a common struct for both: <code>Model</code>, as shown in the link above. <strong>All three structs are of different types</strong>. </p>\n\n<ol start=\"2\">\n<li>Collections </li>\n</ol>\n\n<p>You can have a collection of interfaces or collection of defined types. So when to use which? </p>\n\n<p>If you have a collection of addresses, defined the type of follows: \n<code>type AddrCollection []*Address</code>. And then implement whatever method you want on <code>AddrCollection</code> type. </p>\n\n<p>If you have a collection of models, similarly define <code>type ModelCollection []*Model</code>, but then passing <code>Address</code> to the <code>ModelCollection</code> would require to \"extract\" the embedded type. </p>\n\n<p>If you have a collection of something, then define a collection of interfaces (<code>DescriberCollection</code> in the example), but then you would not have <code>GetByAddress()</code> defined on it, and it would only exist in <code>AddrCollection</code></p>\n\n<ol start=\"3\">\n<li>Interfaces </li>\n</ol>\n\n<p>They have no fields they only define method signatures to be implemented. In Go interfaces are normally accepted and never returned, that gives u a benefit to have clean and goal-oriented design. Interfaces is a way to allow other users (or other packages) to use your packages/libraries in a way that they do not need to implement your types, but rather a certain methods. They can reuse your defined types, or they can plug-in their own implementations of the interface. So what is an interface, it is a way of saying: <strong>here are the set of method signatures, as long as you implement them you can use my package</strong> </p>\n"}, {"tags": [], "owner": {"reputation": 487, "user_id": 3004786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mQ3jy.jpg?s=128&g=1", "display_name": "huehnerhose", "link": "https://stackoverflow.com/users/3004786/huehnerhose"}, "is_accepted": true, "score": 0, "last_activity_date": 1497878941, "creation_date": 1497878941, "answer_id": 44631932, "question_id": 44470806, "link": "https://stackoverflow.com/questions/44470806/golang-inheritance-to-implement-backbone-like-collection-model/44631932#44631932", "title": "golang inheritance to implement backbone like collection / model", "body": "<p>Ok, looks like I really didn't understand the go-way of doing this. </p>\n\n<p>The buzzwords that helped me to move on:</p>\n\n<ul>\n<li>ORM</li>\n<li>go generate</li>\n</ul>\n\n<p>Projects that look like solving my issue:</p>\n\n<ul>\n<li><a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow noreferrer\">GORM</a></li>\n<li><a href=\"https://github.com/vattle/sqlboiler\" rel=\"nofollow noreferrer\">SQLBoiler</a></li>\n</ul>\n\n<p>Thanks for the answers, anyway!</p>\n"}], "owner": {"reputation": 487, "user_id": 3004786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mQ3jy.jpg?s=128&g=1", "display_name": "huehnerhose", "link": "https://stackoverflow.com/users/3004786/huehnerhose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "accepted_answer_id": 44631932, "answer_count": 2, "score": 1, "last_activity_date": 1497878941, "creation_date": 1497080177, "question_id": 44470806, "link": "https://stackoverflow.com/questions/44470806/golang-inheritance-to-implement-backbone-like-collection-model", "title": "golang inheritance to implement backbone like collection / model", "body": "<p>I am looking into golang as my new goto language for my web-backend. My current language there is PHP, where I implemented a datastructure resembling the Backbone Collection/Model structure. </p>\n\n<h1>excursus Collection / Model</h1>\n\n<p>This means I have a <code>Collection</code> containing multiple <code>Models</code>. <code>Models</code> have an <code>attributes</code> dictionary for storing the actual \"public data\". <code>Collections</code> have multiple convenience methods operating on the array of <code>Models</code> (sort, getByIndex, getByMatchingParameter, etc). <code>Models</code> also have their share of convenience methods.</p>\n\n<p>In daily life there will be 90% of \"things\" that are represented the same way. For example I can store an <code>Address</code> the same way I store my <code>User</code>. Having an <code>AddressesCollection</code> containing my <code>Addresses</code> I can simply ask my <code>AddressesCollection</code> to give me all <code>AddressModels</code> where <code>city=Berlin</code>. And implementing this matching in my base class I can do the logically same thing on my <code>UserCollection</code> giving me all my Users which are deactivated by <code>deactivated=true</code>.</p>\n\n<p>But sometimes (10%) I need a special method. <code>getGeoData</code> for <code>Addresses</code> for example. Now, in my oop-world, I can simply create a new class extending my <code>BaseModel</code> adding my method and use my extended class everywhere where my base class was used. </p>\n\n<h1>My \"i simply don't get it\"</h1>\n\n<p>How does this work in Go. I read a lot introductions into embedding / composition. But simply do not get my head around this. </p>\n\n<p>This is where I stand, keep in mind this is my playground for learning the \"inheritance\" concept, not for having a production ready Collection / Model implementation. </p>\n\n<p><a href=\"https://play.golang.org/p/clrGldR46j\" rel=\"nofollow noreferrer\">GoPlayground</a></p>\n\n<p>What I get is that I haven't \"understood\" how to write a \"generic\" method accepting not-quite-inherited types. I have the feeling that I have to use an interface there somewhere to get this \"inheritance\"/\"extended class\" feeling. But my current use of this is... well... </p>\n\n<p>But maybe I am completely wrong in my concept of implementing my desired structure that way in go at all? Maybe there is a much more elegant way. Any hints greatly appreciated!</p>\n"}, {"tags": ["linux", "windows", "go", "ide"], "comments": [{"owner": {"reputation": 1511, "user_id": 495504, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ee8d8278b0394be64c52abc8d7c4ca17?s=128&d=identicon&r=PG", "display_name": "Eric Pauley", "link": "https://stackoverflow.com/users/495504/eric-pauley"}, "edited": false, "score": 0, "creation_date": 1497068065, "post_id": 44469082, "comment_id": 75934979, "body": "You may need a space after the command line for build: <code>&#47;&#47; +build</code>. Otherwise you may consider using filenames to limit build which more IDEs might respect. See <a href=\"https://golang.org/pkg/go/build/#hdr-Go_Path\" rel=\"nofollow noreferrer\">golang.org/pkg/go/build/#hdr-Go_Path</a>"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 1511, "user_id": 495504, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ee8d8278b0394be64c52abc8d7c4ca17?s=128&d=identicon&r=PG", "display_name": "Eric Pauley", "link": "https://stackoverflow.com/users/495504/eric-pauley"}, "edited": false, "score": 0, "creation_date": 1497108204, "post_id": 44469082, "comment_id": 75945351, "body": "I&#39;m pretty sure that missing space is just a typo in the question but for good measure I&#39;ll have another go at marking everything with with windows build flag again and report back. Im not sure I understand the suggestion on filenames, would be helpul if you could eleborate"}, {"owner": {"reputation": 1511, "user_id": 495504, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ee8d8278b0394be64c52abc8d7c4ca17?s=128&d=identicon&r=PG", "display_name": "Eric Pauley", "link": "https://stackoverflow.com/users/495504/eric-pauley"}, "edited": false, "score": 0, "creation_date": 1497116997, "post_id": 44469082, "comment_id": 75947987, "body": "Please see the link I put: If a file&#39;s name, after stripping the extension and a possible _test suffix, matches any of the following patterns:      *_GOOS     *_GOARCH     *_GOOS_GOARCH"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1497064643, "creation_date": 1497063422, "last_edit_date": 1497064643, "question_id": 44469082, "link": "https://stackoverflow.com/questions/44469082/ide-and-tooling-issues-developing-for-windows-from-linux", "title": "IDE and tooling issues developing for windows from linux", "body": "<p>I am trying to develop a simple windows GUI in go (first attempt).</p>\n\n<p>After considering a few packages to get me started, I landed on this <a href=\"https://github.com/lxn/walk\" rel=\"nofollow noreferrer\">https://github.com/lxn/walk</a> and it seemed ideal. I cross-compiled from my ubuntu laptop and the provided demo worked on all target platforms (win7/8/10)</p>\n\n<p>The problems came when I tried to start developing from my linux laptop - initially in atom, but I've since tried with sublime, emacs and phpstorm and noticed an issue with go get (so I'm guessing it's the underlying go tooling that's failing)</p>\n\n<p>The first error I'm seeing is:</p>\n\n<blockquote>\n  <p>/../github.com/lxn/walk/tooltiperrorpresenter.go:8: undefined: ToolTip</p>\n</blockquote>\n\n<p>This affects development across all affected IDEs tested:</p>\n\n<ul>\n<li>disables autocomplete </li>\n<li>halts linting </li>\n<li>cant test</li>\n<li>gofmt worked in some (perhaps tool ordering)\naffecting any file referencing this lib.</li>\n</ul>\n\n<p>And this is the first of many errors which seem to be due to the library importing its internal <code>win</code> package which contains files which are marked with the flag:</p>\n\n<pre><code>// +build windows\n</code></pre>\n\n<p>I cunningly decided to start ripping out these tags from the lib - hoping that would at least allow me to get on with development, but then I started seeing new errors regarding too many arguments being passed to syscalls in the win package - presumably because the different platforms (win/nix) have different numbers of parameters in those syscalls.</p>\n\n<p>I then tried marking <strong>everything</strong> with the <code>//+build windows</code> flag, but the parade of errors remained unchanged.</p>\n\n<p>I found some issues on the project github which are related:\n<a href=\"https://github.com/lxn/win/issues/26\" rel=\"nofollow noreferrer\">https://github.com/lxn/win/issues/26</a> : <code>no buildable Go source files</code>\nand there are solutions for \"go getting\" the files but none so far for my IDE woes.</p>\n\n<p>I've also seen this type of issue in some other windows specific go libraries so I don't think it's an issue for the package author. But I would be interested to hear any solutions from a code architecture perspective if they exist</p>\n\n<p>I haven't actually tried doing this from a windows VM yet (I presume that would solve the issue from my end) - but its a bit of a jarring solution as I'm already juggling vms to test the app so I'm keen to find another way.</p>\n\n<p><strong>TLDR:</strong></p>\n\n<blockquote>\n  <p>Do I have to work from Windows machine / vm in order to have a fully\n  functional IDE when developing for windows from linux or is there a way to satisfy the go tooling</p>\n</blockquote>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 2126218, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/600beb8d18f926727bec4e9b37e6cda3?s=128&d=identicon&r=PG", "display_name": "jsm1th", "link": "https://stackoverflow.com/users/2126218/jsm1th"}, "edited": false, "score": 0, "creation_date": 1497075375, "post_id": 44469062, "comment_id": 75936272, "body": "Nice this will do for now. Just wasn&#39;t sure if go had something built in I could use."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 2, "last_activity_date": 1497063217, "creation_date": 1497063217, "answer_id": 44469062, "question_id": 44468995, "link": "https://stackoverflow.com/questions/44468995/keep-prompt-window-open-when-running-exe-windows/44469062#44469062", "title": "Keep prompt window open when running .exe (windows)", "body": "<p>One trick is by waiting user input at the end of your application. Once user press any key, exit the application. The snippet:</p>\n\n<pre><code>func main() {\n    //Your original code...\n\n    fmt.Printf(\"Press any key to exit...\")\n    b := make([]byte, 1)\n    os.Stdin.Read(b)\n}\n</code></pre>\n"}], "owner": {"reputation": 359, "user_id": 2126218, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/600beb8d18f926727bec4e9b37e6cda3?s=128&d=identicon&r=PG", "display_name": "jsm1th", "link": "https://stackoverflow.com/users/2126218/jsm1th"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 0, "accepted_answer_id": 44469062, "answer_count": 1, "score": 0, "last_activity_date": 1497063230, "creation_date": 1497062323, "question_id": 44468995, "link": "https://stackoverflow.com/questions/44468995/keep-prompt-window-open-when-running-exe-windows", "title": "Keep prompt window open when running .exe (windows)", "body": "<p>I have a quick script that is scraping some data from a text file and outputting some summarized results to the user. When this is ran on windows by double clicking the executable it just runs real fast and closes the command prompt and the results of the program cannot be seen. I know I can go into command prompt and run it from there. But, is there anything I can do for when a user double clicks the .exe file to run it to keep that window open so results can be seen?</p>\n"}, {"tags": ["go", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 1511, "user_id": 495504, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ee8d8278b0394be64c52abc8d7c4ca17?s=128&d=identicon&r=PG", "display_name": "Eric Pauley", "link": "https://stackoverflow.com/users/495504/eric-pauley"}, "is_accepted": false, "score": 1, "last_activity_date": 1497067755, "creation_date": 1497067755, "answer_id": 44469403, "question_id": 44468499, "link": "https://stackoverflow.com/questions/44468499/where-can-i-find-google-cloud-compute-golang-sdk-for-compute-service-account-et/44469403#44469403", "title": "Where can I find Google Cloud Compute golang sdk for Compute, Service account etc", "body": "<p>Here's the official docs with install instructions:</p>\n\n<p><a href=\"https://cloud.google.com/compute/docs/api/libraries#google_apis_go_client_library\" rel=\"nofollow noreferrer\">https://cloud.google.com/compute/docs/api/libraries#google_apis_go_client_library</a></p>\n"}], "owner": {"reputation": 1, "user_id": 2438325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7a778dad32f799c9d2d3d17ee650f8?s=128&d=identicon&r=PG", "display_name": "user2438325", "link": "https://stackoverflow.com/users/2438325/user2438325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1497073441, "answer_count": 1, "score": -2, "last_activity_date": 1497067755, "creation_date": 1497056394, "question_id": 44468499, "link": "https://stackoverflow.com/questions/44468499/where-can-i-find-google-cloud-compute-golang-sdk-for-compute-service-account-et", "closed_reason": "Not suitable for this site", "title": "Where can I find Google Cloud Compute golang sdk for Compute, Service account etc", "body": "<p>Looking for golang sdk for Google Cloud Compute. \nThere are thousands of links, Which one is the official golang sdk for google cloud platform for compute , network, service account auth etc?</p>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 1, "creation_date": 1497095384, "post_id": 44468091, "comment_id": 75941472, "body": "note that even though this is correct, OP&#39;s code and even intention seem utterly suspicious and wrong and would not pass any sane code review"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 5953, "user_id": 1366624, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/a2eEo.jpg?s=128&g=1", "display_name": "lxe", "link": "https://stackoverflow.com/users/1366624/lxe"}, "edited": false, "score": 0, "creation_date": 1497441774, "post_id": 44468091, "comment_id": 76078994, "body": "@lxe: Remember to <a href=\"https://stackoverflow.com/help/accepted-answer\">mark this answer as accepted</a> if it answered your question."}, {"owner": {"reputation": 5953, "user_id": 1366624, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/a2eEo.jpg?s=128&g=1", "display_name": "lxe", "link": "https://stackoverflow.com/users/1366624/lxe"}, "reply_to_user": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1497477036, "post_id": 44468091, "comment_id": 76101012, "body": "@Yerken how so?"}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1497481174, "post_id": 44468091, "comment_id": 76102408, "body": "because <code>DoThing</code> is nothing more than just unmarshaling into struct, and can be written as simple as:   ```     json.Unmarshal(somelibrary.JsonData, myStructPtr) ```"}, {"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 0, "creation_date": 1497481462, "post_id": 44468091, "comment_id": 76102506, "body": "reflect package is a low level package which is relatively slow comparing to other std libs because it does quite a lot of allocations. There are rarely any good reasons to use it and its prone to panics if used without care. For example Tim&#39;s code will panic on tons of different cases"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1497052225, "creation_date": 1497052225, "answer_id": 44468091, "question_id": 44468048, "link": "https://stackoverflow.com/questions/44468048/go-reflection-get-correct-struct-type-of-interface/44468091#44468091", "title": "go reflection: get correct struct type of interface", "body": "<p>Yes, this is possible. Here is your code updated:</p>\n\n<pre><code>func DoThing(fn interface{}) {\n    // Get first arg of the function\n    firstArg := reflect.TypeOf(fn).In(0)\n\n    // Get the PtrTo to the first function parameter\n    structPtr := reflect.New(firstArg)\n\n    // Convert to Interface\n    // Note that I can't assert this to .(myStruct) type\n    instance := structPtr.Interface()\n\n    // Unmarshal the JSON\n    json.Unmarshal(jsonData, instance)\n\n    // Call the function\n    vfn := reflect.ValueOf(fn)\n    vfn.Call([]reflect.Value{structPtr.Elem()})\n}\n</code></pre>\n\n<p>Changes made:</p>\n\n<ol>\n<li>Pass <code>structPtr</code> (a pointer) to <code>json.Unmarshal</code>; pass a value and you will not see the changes</li>\n<li>Remove taking the address of <code>instance</code> when passing to <code>json.Unmarshal</code>; <a href=\"https://golang.org/doc/faq#pointer_to_interface\" rel=\"nofollow noreferrer\">there is usually never a good reason to have a pointer to an interface</a></li>\n<li>Use <code>structPtr</code> instead of <code>instance</code> when calling <code>fn</code></li>\n</ol>\n\n<p><a href=\"https://play.golang.org/p/POmOyQBJYC\" rel=\"nofollow noreferrer\">https://play.golang.org/p/POmOyQBJYC</a></p>\n"}], "owner": {"reputation": 5953, "user_id": 1366624, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/a2eEo.jpg?s=128&g=1", "display_name": "lxe", "link": "https://stackoverflow.com/users/1366624/lxe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2219, "favorite_count": 0, "accepted_answer_id": 44468091, "answer_count": 1, "score": 2, "last_activity_date": 1497052331, "creation_date": 1497051901, "last_edit_date": 1497052331, "question_id": 44468048, "link": "https://stackoverflow.com/questions/44468048/go-reflection-get-correct-struct-type-of-interface", "title": "go reflection: get correct struct type of interface", "body": "<p>Consider this:</p>\n\n<pre><code>type myStruct struct {\n    Foo string `json:\"foo\"`\n}\n\nfunc main() {\n    somelibrary.DoThing(func(thing myStruct) {\n        // myStruct should contain unmarshaled JSON\n        // provided by somelibrary\n\n        fmt.Printf(\"%v\\n\", thing)\n    })\n}\n</code></pre>\n\n<p>I'm new to Go, so I fear this might not be idiomatic code. I'd like to implement <code>somelibrary.DoThing</code> so it correctly infers the struct type from the function argument via reflection, if it's possible. Here's what I have:</p>\n\n<pre><code>const jsonData := []byte{`{\"foo\": \"bar\"}`}\n\nfunc DoThing(fn interface{}) {\n    // Get first arg of the function\n    firstArg := reflect.TypeOf(fn).In(0)\n    structPtr := reflect.New(firstArg)\n\n    // Convert to Interface\n    // Note that I can't assert this to .(myStruct) type\n    instance := structPtr.Elem().Interface()\n\n    // Unmarshal the JSON\n    json.Unmarshal(jsonData, &amp;instance)\n\n    // Call the function\n    vfn := reflect.ValueOf(fn)\n    vfn.Call([]reflect.Value{reflect.ValueOf(instance)})\n}\n</code></pre>\n\n<p>Without knowing the struct type beforehand, json.Unmarshal just assumes that <code>instance</code> is <code>map[string]interface{}</code>, so I get a panic when calling <code>vfn.Call(...)</code>:</p>\n\n<pre><code>panic: reflect: Call using map[string]interface {} as type main.myStruct\n</code></pre>\n\n<p>Is it possible to convert the <code>instance</code> interface into the correct type? In other words, can I do type type assertion by passing a string (or using some reflection method) instead of having the type available to the program as a symbol?</p>\n"}, {"tags": ["ssl", "go", "tls1.2", "gnutls", "openvas"], "comments": [{"owner": {"reputation": 1511, "user_id": 495504, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ee8d8278b0394be64c52abc8d7c4ca17?s=128&d=identicon&r=PG", "display_name": "Eric Pauley", "link": "https://stackoverflow.com/users/495504/eric-pauley"}, "edited": false, "score": 1, "creation_date": 1497052627, "post_id": 44467646, "comment_id": 75932889, "body": "Please consider adding some sample code of what you&#39;re doing instead of just describing it. Often times mistakes lie in subtle implementation problems which are much easier to troubleshoot if you post your code."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1497081351, "post_id": 44467646, "comment_id": 75937612, "body": "Please provide a URL for the server, and some code to go with it. GnuTLS&#39;s ASN.1 parser is very strict. I seem to recall a way to make it relax during parsing, but it escapes me at the moment. You might be able to find the reference to the problem and solution; or maybe switch to another library."}], "owner": {"reputation": 53, "user_id": 8139532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187d3b35488579d0afdca17a53da009f?s=128&d=identicon&r=PG&f=1", "display_name": "gbatt", "link": "https://stackoverflow.com/users/8139532/gbatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1497086330, "creation_date": 1497048523, "last_edit_date": 1497086330, "question_id": 44467646, "link": "https://stackoverflow.com/questions/44467646/openvas-go-tls-certificate-error", "title": "OpenVAS Go TLS Certificate Error", "body": "<p>I'm currently developing a custom scanner in go for OpenVAS. Problem is that the handshake with my custom server fails.</p>\n\n<p>I traced the problem down to error <code>-73</code>: <code>GNUTLS_E_ASN1_TAG_ERROR</code> from <code>gnutls_handshake</code>, but I can't find any resources on that problem. I read something about the certificates being incorrect then but I can't do anything other than regenerating the OpenVAS certificates. The tls functionality in the go server just uses a simple <code>ListenAndServeTLS</code> and gets the server cert and key.</p>\n\n<p>edit:\nSo this is the relevant network part on the custom scanner:</p>\n\n<pre><code>var (\n    port = \":1234\"\n    cert = \"/usr/local/var/lib/openvas/CA/servercert.pem\"\n    ca   = \"/usr/local/var/lib/openvas/CA/cacert.pem\"\n    key  = \"/usr/local/var/lib/openvas/private/CA/serverkey.pem\"\n)\n\n    func start_server() {\n\n    ca_file, err := ioutil.ReadFile(ca)\n\n    if err != nil {\n        panic(err)\n    }\n\n    blocks, _ := pem.Decode( ca_file )\n    ca, err := x509.ParseCertificate(blocks.Bytes)\n\n    if err != nil {\n        panic(err)\n    }\n\n    priv_file, _ := ioutil.ReadFile(key)\n    blocks2, _ := pem.Decode( priv_file )\n\n    priv, err := x509.ParsePKCS1PrivateKey(blocks2.Bytes)\n\n    if err != nil {\n        panic(err)\n    }\n\n    pool := x509.NewCertPool()\n    pool.AddCert(ca)\n\n    cert := tls.Certificate{\n        Certificate: [][]byte{ca_file},\n        PrivateKey:  priv,\n    }\n\n    config := tls.Config{\n        ClientAuth:   tls.RequireAndVerifyClientCert,\n        Certificates: []tls.Certificate{cert},\n        ClientCAs:    pool,\n    }\n    config.Rand = rand.Reader\n    service := \"0.0.0.0\" + port\n    listener, err := tls.Listen(\"tcp\", service, &amp;config)\n\n    if err != nil {\n        log.Fatalf(\"server: listen: %s\", err)\n    }\n    log.Print(\"server: listening\")\n\n    for {\n        conn, err := listener.Accept()\n        if err != nil {\n            log.Printf(\"server: accept: %s\", err)\n            break\n        }\n\n        defer conn.Close()\n        log.Printf(\"server: accepted from %s\", conn.RemoteAddr())\n        go handle(conn)\n    }\n}\n</code></pre>\n\n<p>func handle(conn net.Conn) {</p>\n\n<pre><code>str := \"Hello\"\n\ndefer conn.Close()\n\nbuf := make([]byte, 512)\nfor {\n    log.Print(\"server: conn: waiting\")\n    conn.Write( ([]byte)(str) )\n    n, err := conn.Read(buf)\n    if err != nil {\n        if err != nil {\n            fmt.Println (err)\n        }\n        break\n    }\n\n    tlscon, ok := conn.(*tls.Conn)\n    if ok {\n        state := tlscon.ConnectionState()\n        sub := state.PeerCertificates[0].Subject\n        log.Println(sub)\n    }\n\n    log.Printf(\"server: conn: echo %q\\n\", string(buf[:n]))\n    n, err = conn.Write(buf[:n])\n\n    n, err = conn.Write(buf[:n])\n    log.Printf(\"server: conn: wrote %d bytes\", n)\n\n    if err != nil {\n        log.Printf(\"server: write: %s\", err)\n        break\n    }\n}\nlog.Println(\"server: conn: closed\")\n</code></pre>\n\n<p>}</p>\n\n<p>func main() {</p>\n\n<pre><code>start_server()\n</code></pre>\n\n<p>}</p>\n\n<p>It's taken from an example but it didn't work properly at first ( there was no decode before parsecertificates). Maybe the certificate is mal-formatted now because of that? Before adding the two decodes I had a similar error about the asn1 tags not matching. So also an asn1 error. I thought of generating my own certificate but I don't know if this will not break OpenVAS for the other scanners. I had the same results when just using listenandservetls from go. The error is definitely produced in gnutls_handshake. It's frustrating that I only get an error code from that.</p>\n"}, {"tags": ["go", "sqlite"], "comments": [{"owner": {"reputation": 673, "user_id": 921051, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/09bf092eb87afa75958cdc6624bd5b54?s=128&d=identicon&r=PG", "display_name": "Steffen", "link": "https://stackoverflow.com/users/921051/steffen"}, "edited": false, "score": 0, "creation_date": 1497045834, "post_id": 44467219, "comment_id": 75931276, "body": "This might be related. But the bug should be fixed <a href=\"https://stackoverflow.com/questions/29452538/convert-blob-to-image-in-go\" title=\"convert blob to image in go\">stackoverflow.com/questions/29452538/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 673, "user_id": 921051, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/09bf092eb87afa75958cdc6624bd5b54?s=128&d=identicon&r=PG", "display_name": "Steffen", "link": "https://stackoverflow.com/users/921051/steffen"}, "is_accepted": true, "score": 1, "last_activity_date": 1497128577, "creation_date": 1497128577, "answer_id": 44478060, "question_id": 44467219, "link": "https://stackoverflow.com/questions/44467219/insert-byte-slice-into-sqlite-blob/44478060#44478060", "title": "Insert byte slice into sqlite blob", "body": "<p>I found the problem. It sat before the monitor.The data was inserted actually. Sqlite client handles the blob as text and terminates printing at the \"0\". Inspecting the database with sqlitebrowser showed the complete entry. </p>\n"}], "owner": {"reputation": 673, "user_id": 921051, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/09bf092eb87afa75958cdc6624bd5b54?s=128&d=identicon&r=PG", "display_name": "Steffen", "link": "https://stackoverflow.com/users/921051/steffen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1417, "favorite_count": 0, "accepted_answer_id": 44478060, "answer_count": 1, "score": 1, "last_activity_date": 1497128577, "creation_date": 1497045279, "question_id": 44467219, "link": "https://stackoverflow.com/questions/44467219/insert-byte-slice-into-sqlite-blob", "title": "Insert byte slice into sqlite blob", "body": "<p>I try to insert a slice of bytes into a sqlite3 database, using github.com/mattn/go-sqlite3. </p>\n\n<p>Data:</p>\n\n<pre><code>thmbnail := [255 216 255 219 0 132 ...]\n</code></pre>\n\n<p>Create statement:</p>\n\n<pre><code>sqlStmt := `\ncreate table result (id INTEGER NOT NULL PRIMARY KEY, fname TEXT, path TEXT, \nsize INTEGER, fMDate TEXT, fUUID TEXT, fSHA1 TEXT, fPRONOM TEXT, fNSRL INTEGER, fTHMB BLOB);\npragma journal_mode=WAL;\ndelete from result;\n`\n</code></pre>\n\n<p>Insert:</p>\n\n<pre><code>func addEntryDB(stmt *sql.Stmt, entry fileMD) {\n\n    _, err := stmt.Exec(nil, entry.fName, entry.fPath, entry.fSize, entry.fMDate,\n    entry.fUUID, entry.fSHA1, entry.fPRONOM, entry.fNSRL, entry.fTHMB)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Problem: Only the first four bytes of thmbnail are inserted. I suppose this might be related to the 0 byte on the fifth position. </p>\n\n<p>How can the whole []byte be inserted?</p>\n"}, {"tags": ["javascript", "git", "go", "multiplayer"], "comments": [{"owner": {"reputation": 188, "user_id": 4611395, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/THoCA.jpg?s=128&g=1", "display_name": "Felipe Umpierre", "link": "https://stackoverflow.com/users/4611395/felipe-umpierre"}, "edited": false, "score": 2, "creation_date": 1497046590, "post_id": 44467121, "comment_id": 75931481, "body": "Have you tried to access by <code>localhost:9091</code> as shown <a href=\"https://github.com/jbowens/codenames/blob/master/cmd/codenames/main.go#L14\" rel=\"nofollow noreferrer\">here</a>?"}, {"owner": {"reputation": 11, "user_id": 8139407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yswrjPrIKQM/AAAAAAAAAAI/AAAAAAAAAeo/JzvgQcVk7n8/photo.jpg?sz=128", "display_name": "Kevin A", "link": "https://stackoverflow.com/users/8139407/kevin-a"}, "reply_to_user": {"reputation": 188, "user_id": 4611395, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/THoCA.jpg?s=128&g=1", "display_name": "Felipe Umpierre", "link": "https://stackoverflow.com/users/4611395/felipe-umpierre"}, "edited": false, "score": 0, "creation_date": 1497047958, "post_id": 44467121, "comment_id": 75931830, "body": "Yeah that&#39;s what I tried but I feel like there might be something wrong with the code because if you run main.go right after running it says it can&#39;t find one of the txt files with the words (game-id-words.txt)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1497195464, "post_id": 44467121, "comment_id": 75965152, "body": "What repository?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7160779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a153734d96696c87410ed8a5fb526e42?s=128&d=identicon&r=PG&f=1", "display_name": "willxm", "link": "https://stackoverflow.com/users/7160779/willxm"}, "is_accepted": false, "score": -4, "last_activity_date": 1497061409, "creation_date": 1497061409, "answer_id": 44468927, "question_id": 44467121, "link": "https://stackoverflow.com/questions/44467121/how-to-run-this-go-application-locally/44468927#44468927", "title": "How to run this Go application locally?", "body": "<p>Set gopath and goroot then install dependencies.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8139407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yswrjPrIKQM/AAAAAAAAAAI/AAAAAAAAAeo/JzvgQcVk7n8/photo.jpg?sz=128", "display_name": "Kevin A", "link": "https://stackoverflow.com/users/8139407/kevin-a"}, "edited": false, "score": 0, "creation_date": 1497105444, "post_id": 44469349, "comment_id": 75944602, "body": "THANK YOU! I just moved the codenames.exe that I got from the go build to the root and when I ran it, it worked!! :)"}], "tags": [], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "is_accepted": true, "score": 2, "last_activity_date": 1497067098, "creation_date": 1497067098, "answer_id": 44469349, "question_id": 44467121, "link": "https://stackoverflow.com/questions/44467121/how-to-run-this-go-application-locally/44469349#44469349", "title": "How to run this Go application locally?", "body": "<p>I'm guessing you are just typing <code>go build</code> from the <code>cmd/codenames</code> directory, creating a binary called 'codenames' in that directory and running from there. </p>\n\n<p>Unfortunately the app is hard-coded to look for its assets in a ./assets/ directory relative to the binary. </p>\n\n<p>So you want your binary in the root of the app: </p>\n\n<p>i.e</p>\n\n<ul>\n<li>from the <code>cmd/codenames</code> directory <code>go build -o ../../run-me-from-here</code>  </li>\n<li><p>then from the root of the app <code>./run-me-from-here</code></p>\n\n<p>.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8139407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yswrjPrIKQM/AAAAAAAAAAI/AAAAAAAAAeo/JzvgQcVk7n8/photo.jpg?sz=128", "display_name": "Kevin A", "link": "https://stackoverflow.com/users/8139407/kevin-a"}, "edited": false, "score": 0, "creation_date": 1497105319, "post_id": 44472962, "comment_id": 75944565, "body": "Yeah that&#39;s what you do to get the project files locally. I&#39;m having trouble getting the app up and running since there seems to be a problem with how the code is written. If you can figure out how to run the code on your machine then please let me know what you did :)"}], "tags": [], "owner": {"reputation": 15, "user_id": 724226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61ff98fdaa969f60be8cfd328a3a7a2?s=128&d=identicon&r=PG", "display_name": "d_turner", "link": "https://stackoverflow.com/users/724226/d-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1497095182, "creation_date": 1497095182, "answer_id": 44472962, "question_id": 44467121, "link": "https://stackoverflow.com/questions/44467121/how-to-run-this-go-application-locally/44472962#44472962", "title": "How to run this Go application locally?", "body": "<p>Running them locally is very easy in go</p>\n\n<p>I usually run go get while in my local go directory. </p>\n\n<p>Go get <a href=\"https://github.com/jbowens/codenames\" rel=\"nofollow noreferrer\">https://github.com/jbowens/codenames</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8139407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yswrjPrIKQM/AAAAAAAAAAI/AAAAAAAAAeo/JzvgQcVk7n8/photo.jpg?sz=128", "display_name": "Kevin A", "link": "https://stackoverflow.com/users/8139407/kevin-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1971, "favorite_count": 0, "accepted_answer_id": 44469349, "answer_count": 3, "score": -1, "last_activity_date": 1546010757, "creation_date": 1497044751, "last_edit_date": 1546010757, "question_id": 44467121, "link": "https://stackoverflow.com/questions/44467121/how-to-run-this-go-application-locally", "title": "How to run this Go application locally?", "body": "<p>I want to be able to run the application from the repository <a href=\"https://github.com/jbowens/codenames\" rel=\"nofollow noreferrer\">https://github.com/jbowens/codenames</a> locally on my machine. Is it possible? </p>\n\n<p>Steps I've tried: </p>\n\n<ul>\n<li>Installed Go. Added PATH variable.</li>\n<li>Cloned the repository to my machine in the right go path location.</li>\n<li>Opened command prompt and ran the command \"go run main.go\" from the \"cmd\" folder</li>\n</ul>\n\n<p>I really don't know anything about Go so maybe I just have to run another command or install dependencies or whatever. If someone could figure this out I would be super happy! This is an awesome game I would like to play from my machine.</p>\n"}]