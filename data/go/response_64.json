[{"tags": ["macos", "go", "docker"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459399131, "post_id": 36321618, "comment_id": 60271321, "body": "Copying the link from your comment on my (now) deleted answer:  Issue is filed in github here: <a href=\"https://github.com/willnorris/imageproxy/issues/57\" rel=\"nofollow noreferrer\">github.com/willnorris/imageproxy/issues/57</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6784, "user_id": 1060489, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/23b9bf4ad2e374e31178f0eea3bbc0ea?s=128&d=identicon&r=PG", "display_name": "metalaureate", "link": "https://stackoverflow.com/users/1060489/metalaureate"}, "is_accepted": true, "score": 1, "last_activity_date": 1459440313, "creation_date": 1459440313, "answer_id": 36338412, "question_id": 36321618, "link": "https://stackoverflow.com/questions/36321618/go-imageproxy-inaccessible-from-docker-container/36338412#36338412", "title": "Go imageproxy inaccessible from docker container", "body": "<p>From noogen <a href=\"https://github.com/willnorris/imageproxy/issues/57\" rel=\"nofollow\">https://github.com/willnorris/imageproxy/issues/57</a></p>\n\n<p>Was able to reproduce this with the 'willnorris/imageproxy' version. I can curl port 8080 inside of the container but not from the host.</p>\n\n<p>The default configuration binds to 127.0.0.1 (should be 0.0.0.0) because of this line: imageproxy (version HEAD) listening on localhost:8080</p>\n\n<p>localhost in the imageproxy docker container (cat /etc/hosts) is map to 127.0.0.1</p>\n\n<p>Change the Dockerfile line 8 to:\nENTRYPOINT [\"/go/bin/imageproxy\", \"-addr 0.0.0.0:8080\"]</p>\n"}], "owner": {"reputation": 6784, "user_id": 1060489, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/23b9bf4ad2e374e31178f0eea3bbc0ea?s=128&d=identicon&r=PG", "display_name": "metalaureate", "link": "https://stackoverflow.com/users/1060489/metalaureate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 36338412, "answer_count": 1, "score": 0, "last_activity_date": 1459440313, "creation_date": 1459380828, "last_edit_date": 1459381225, "question_id": 36321618, "link": "https://stackoverflow.com/questions/36321618/go-imageproxy-inaccessible-from-docker-container", "title": "Go imageproxy inaccessible from docker container", "body": "<p>I am trying to deploy the excellent Go image proxy server <a href=\"https://github.com/willnorris/imageproxy\" rel=\"nofollow\">https://github.com/willnorris/imageproxy</a> on Mac OSX as docker container via Docker Cloud. </p>\n\n<p>I cannot make the container accessible to my browser</p>\n\n<p><code>docker run -i -t -p 8080:8080 willnorris/imageproxy:latest  /go/bin/imageproxy -addr 0.0.0.0:8080</code></p>\n\n<p>should expose the server at <code>docker-machine ip [vmname]</code>, in this case 192.168.56.100</p>\n\n<p>I verified my setup by running a vanilla Express server in the same way.</p>\n\n<p>Would anyone know what is up with the dockerization of this service? <a href=\"https://hub.docker.com/r/willnorris/imageproxy/\" rel=\"nofollow\">https://hub.docker.com/r/willnorris/imageproxy/</a></p>\n"}, {"tags": ["http", "curl", "file-upload", "go"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459378322, "post_id": 36320947, "comment_id": 60265530, "body": "Code demonstrating what you&#39;re doing in the client?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459381179, "post_id": 36320947, "comment_id": 60266504, "body": "I don&#39;t see anything obvious in the code; have you captured the actual POST request/response with an interceptor like charles, or with tcpdump, and compared it with the request/response generated by curl?"}, {"owner": {"reputation": 39, "user_id": 4859990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5aaab95c77b2755f7f0bd022ec7f368?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet", "link": "https://stackoverflow.com/users/4859990/puneet"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459385044, "post_id": 36320947, "comment_id": 60267658, "body": "Thanks for your help. I checked the header and Content-Type is set as application/octet-stream."}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 4859990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5aaab95c77b2755f7f0bd022ec7f368?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet", "link": "https://stackoverflow.com/users/4859990/puneet"}, "is_accepted": true, "score": 0, "last_activity_date": 1459385263, "creation_date": 1459385263, "answer_id": 36322315, "question_id": 36320947, "link": "https://stackoverflow.com/questions/36320947/go-http-file-upload/36322315#36322315", "title": "Go: http file upload", "body": "<p>Finally I checked the code for CreateFormFile and the Content-Type is hard coded to application/octet-stream with the mime header. I reimplemented the same method on my own and it works.</p>\n\n<pre><code>func CreateFormFile(w *multipart.Writer, fieldname string, filename string)     (io.Writer, error) {\n    h := make(textproto.MIMEHeader)\n    h.Set(\"Content-Disposition\", fmt.Sprintf(`form-data; name=\"%s\";  filename=\"%s\"`, escapeQuotes(fieldname), escapeQuotes(filename)))\n    h.Set(\"Content-Type\", \"image/jpeg\")\n    return w.CreatePart(h)\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4859990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5aaab95c77b2755f7f0bd022ec7f368?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet", "link": "https://stackoverflow.com/users/4859990/puneet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 36322315, "answer_count": 1, "score": 0, "last_activity_date": 1459896746, "creation_date": 1459377258, "last_edit_date": 1459896746, "question_id": 36320947, "link": "https://stackoverflow.com/questions/36320947/go-http-file-upload", "title": "Go: http file upload", "body": "<p>I am trying to upload a file as an attachment from a client written in Go.\nI am using http multipart CreateFormFile. When I do this, it sends the data in body to the server which server rejects.</p>\n\n<pre><code>file, err := os.Open(*img.Filepath)\nif err != nil {\n    return err\n}\n\ndefer file.Close()\n\nbody := &amp;bytes.Buffer{}\nwriter := multipart.NewWriter(body)\npart, err := writer.CreateFormFile(\"asset\", filepath.Base(*img.Filepath))\nif err != nil {\n    return err\n}\n_, err = io.Copy(part, file)\nif err != nil {\n    return err\n}\n\ncontentType := writer.FormDataContentType()\nerr = writer.Close()\nif err != nil {\n    return err\n}\n\nrequest, err := http.NewRequest(\"POST\", API_URL, body)\nif err != nil {\n    return err\n}\n\nrequest.Header.Set(\"Content-Type\", contentType)\n\nvalues := request.URL.Query()\nvalues.Add(\"filename\", util.GetFileNameWithoutExtension(*img.FileName))\nrequest.URL.RawQuery = values.Encode()\nclient := &amp;http.Client{}\nresp, err := client.Do(request)\nif err != nil {\n    return err\n} else {\n    respBody := &amp;bytes.Buffer{}\n    _, err = respBody.ReadFrom(resp.Body)\n    if err != nil {\n        return err\n    }\n    resp.Body.Close()\n}\n</code></pre>\n\n<p>When I try the same using curl it works\ncurl -X POST -F \"<strong>asset=@filepath</strong>\" \"<a href=\"http://localhost/api/v1/xyz?filename=filename\" rel=\"nofollow\">http://localhost/api/v1/xyz?filename=filename</a>\"</p>\n\n<p>How can I implement key=@val functionality with Go?</p>\n"}, {"tags": ["networking", "go", "tcp", "chat"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "edited": false, "score": 0, "creation_date": 1459376787, "post_id": 36320367, "comment_id": 60264965, "body": "Would I still need my listenConnection() function if I used channels?  And would I need to change my client programs at all?"}, {"owner": {"reputation": 4956, "user_id": 4356889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Le2lz.png?s=128&g=1", "display_name": "szym", "link": "https://stackoverflow.com/users/4356889/szym"}, "reply_to_user": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "edited": false, "score": 0, "creation_date": 1459377618, "post_id": 36320367, "comment_id": 60265293, "body": "You don&#39;t need <code>listenConnection</code> if you handle exactly one client per listener at a time. The client is fine, assuming you are aware that TCP is a streaming protocol and non-delimited Read/Write protocol only works for short messages with significant delay between them."}, {"owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "edited": false, "score": 0, "creation_date": 1459380471, "post_id": 36320367, "comment_id": 60266263, "body": "So I need to make a string channel.  Then, I need to modify acceptLoop() to take a string channel in addition to the listener.  AcceptLoop will then listen to connections and pass the strings back and forth.  Is this correct?  On another note, I think the string channel may need to be a []byte channel instead as this is how the channels send messages."}, {"owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "edited": false, "score": 0, "creation_date": 1459381156, "post_id": 36320367, "comment_id": 60266496, "body": "I meant that is how the connections send messages."}, {"owner": {"reputation": 4956, "user_id": 4356889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Le2lz.png?s=128&g=1", "display_name": "szym", "link": "https://stackoverflow.com/users/4356889/szym"}, "reply_to_user": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "edited": false, "score": 0, "creation_date": 1459382072, "post_id": 36320367, "comment_id": 60266802, "body": "You can certainly pass <code>[]byte</code> via channel. You should think of the <code>acceptLoop</code> as a client handler: it waits for a client connection, then it handles the connection by reading, relaying (via channel) and writing back."}, {"owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "edited": false, "score": 0, "creation_date": 1459382725, "post_id": 36320367, "comment_id": 60266985, "body": "I&#39;m having a problem when I try to compile. I get some errors on the &quot;relay &lt;- conn.Read()&quot; line.  They says &quot;not enough arguments in call to conn.Read&quot; and &quot;multiple-value conn.Read() in single-value context&quot;.  Would you happen to know what could be going on here?  Thank you very much for your help by the way.  I greatly appreciate it!"}, {"owner": {"reputation": 4956, "user_id": 4356889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Le2lz.png?s=128&g=1", "display_name": "szym", "link": "https://stackoverflow.com/users/4356889/szym"}, "reply_to_user": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "edited": false, "score": 0, "creation_date": 1459386985, "post_id": 36320367, "comment_id": 60268121, "body": "As I said, this is pseudo-code. Youl&#39;ll have to make sure to declare types, pass proper arguments and allocate all the supporting variables."}], "tags": [], "owner": {"reputation": 4956, "user_id": 4356889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Le2lz.png?s=128&g=1", "display_name": "szym", "link": "https://stackoverflow.com/users/4356889/szym"}, "is_accepted": false, "score": 0, "last_activity_date": 1459387005, "last_edit_date": 1459387005, "creation_date": 1459374577, "answer_id": 36320367, "question_id": 36320044, "link": "https://stackoverflow.com/questions/36320044/accepting-a-message-before-writing-one/36320367#36320367", "title": "Accepting a Message Before Writing One", "body": "<p>Right now your <code>Server</code> is just an echo. It responds with the message received from the client.</p>\n\n<p>If you want to relay the message between two clients, the first thing you need to figure out is what should happen if 3 clients connect (2 to the first port, 1 to the other)?</p>\n\n<p>If you expect to have just one client connected to each port you could do something like this (<strong>pseudo</strong>-go-code):</p>\n\n<pre><code>func main() {\n  // ...\n  # Channels must be buffered or else clients will deadlock.\n  relay := make(chan string, 1)\n  go acceptLoop(listener1, relay)\n  acceptLoop(listener2, relay)\n}\n\nfunc acceptLoop(l, relay) {\n  for {\n    conn := l.Accept()\n    for {\n       relay &lt;- conn.Read()\n       conn.Write(&lt;-relay)\n    }\n} \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459387005, "creation_date": 1459373172, "question_id": 36320044, "link": "https://stackoverflow.com/questions/36320044/accepting-a-message-before-writing-one", "title": "Accepting a Message Before Writing One", "body": "<p>I have a server that listens to 2 ports and transfers messages between the 2 ports.  The only problem is that each client (or each port) has to submit a message before they can receive the previous message that the other port sent.  For example, if client 1 says \"hello\", client 2 will not receive the message unless he sends a message first.</p>\n\n<p>I want to find a way to make it so that each client will have to receive the previous message before being able to send a new one.  (Since Client 1 will not have anything to receive until Client 2 says something, I am planning to send it a string that has placeholder text.)</p>\n\n<p>Can anyone help me with how to go about this?  I try putting my listening code and my code for writing a message for each client into their own go routines, but that did not do the job.  Any help will be appreciated.</p>\n\n<p>Here is my code:</p>\n\n<h1>Server</h1>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n)\n\nvar message string = \"Client 2 is receiving your message\"\n\nfunc main() {\n    fmt.Println(\"The server is listening on Port 3000 and 8080\")\n    //Set up listeners for the ports each client is using\n    listener, err := net.Listen(\"tcp\", \"localhost:3000\")\n    if err != nil {\n        log.Fatal(err) \n    }\n    listener2, err := net.Listen(\"tcp\", \"localhost:8080\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    go acceptLoop(listener)\n    acceptLoop(listener2)  // run in the main goroutine\n}\n\nfunc acceptLoop(l net.Listener) {\n    defer l.Close()\n    for {\n            c, err := l.Accept()\n            if err != nil {\n                log.Fatal(err)\n            }\n            fmt.Println(\"New connection found!\")\n            go listenConnection(c)\n    }\n}\n\nfunc listenConnection(conn net.Conn) {\n        fmt.Println(\"Yay\")\n        for {\n                buffer := make([]byte, 1400)\n                dataSize, err := conn.Read(buffer)\n                if err != nil {\n                    fmt.Println(\"Connection has closed\")\n                    return\n                }\n\n                //This is the message you received\n                data := buffer[:dataSize]\n                fmt.Print(\"Received message: \", string(data))\n\n                // Send the message back\n                _, err = conn.Write([]byte(message))\n                if err != nil {\n                        log.Fatalln(err)\n                }\n                fmt.Print(\"Message sent: \", string(data))\n                message = string(data)\n        }\n}\n</code></pre>\n\n<h1>Client 1</h1>\n\n<pre><code>    package main\n\nimport (\n        \"fmt\"\n        \"log\"\n        \"net\"\n        \"bufio\"\n        \"os\"\n)\n\nfunc main() {\n        conn, err := net.Dial(\"tcp\", \"localhost:3000\")\n        if err != nil {\n                log.Fatalln(err)\n        }\n\nfor {\n        reader := bufio.NewReader(os.Stdin)\n        fmt.Print(\"Enter text: \")\n        text, _ := reader.ReadString('\\n')\n\n        _, err = conn.Write([]byte(text))\n        if err != nil {\n                log.Fatalln(err)\n        }\n\n        for {\n                buffer := make([]byte, 1400)\n                dataSize, err := conn.Read(buffer)\n                if err != nil {\n                        fmt.Println(\"The connection has closed!\")\n                        return\n                }\n\n                data := buffer[:dataSize]\n                fmt.Println(\"Received message: \", string(data))\n                break\n        }\n\n    }\n}\n</code></pre>\n\n<p>My second client is the same as my first except \"localhost:3000\" is replaced with \"localhost:8080\".</p>\n\n<p>I will appreciate any help!  I'm fairly new to networking and Go, so any tips will be great.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1459372668, "post_id": 36319918, "comment_id": 60263138, "body": "It uses the newline to delimit multiple objects. Marshal only encodes a single object"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459372961, "post_id": 36319918, "comment_id": 60263269, "body": "Right! That&#39;s the answer!"}, {"owner": {"reputation": 1436, "user_id": 383214, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/306b63b79c78a1b67e1789790ad2db86?s=128&d=identicon&r=PG", "display_name": "sheerun", "link": "https://stackoverflow.com/users/383214/sheerun"}, "edited": false, "score": 0, "creation_date": 1488134652, "post_id": 36319918, "comment_id": 72085688, "body": "it dosn&#39;t use it to delimit multiple object as you can set something like <code>encoder.SetIndent(&quot;&quot;, &quot;  &quot;)</code> and you get new lines all over the place.."}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 2441491, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ETPgo.png?s=128&g=1", "display_name": "Tyranteon", "link": "https://stackoverflow.com/users/2441491/tyranteon"}, "edited": false, "score": 0, "creation_date": 1497014337, "post_id": 36320146, "comment_id": 75913938, "body": "Isn&#39;t the usual way of delimiting the stream to return <code>io.EOF</code> as error? Using <code>\\n</code> doesn&#39;t seem to be useful here."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 441, "user_id": 2441491, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ETPgo.png?s=128&g=1", "display_name": "Tyranteon", "link": "https://stackoverflow.com/users/2441491/tyranteon"}, "edited": false, "score": 0, "creation_date": 1497019592, "post_id": 36320146, "comment_id": 75917942, "body": "<code>io.EOF</code> typically indicates the end of all data, that nothing else is ever going to be sent."}, {"owner": {"reputation": 441, "user_id": 2441491, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ETPgo.png?s=128&g=1", "display_name": "Tyranteon", "link": "https://stackoverflow.com/users/2441491/tyranteon"}, "edited": false, "score": 0, "creation_date": 1497116818, "post_id": 36320146, "comment_id": 75947933, "body": "This isn&#39;t true for the gzipWriter however; it sends io.EOF whenever you flush."}, {"owner": {"reputation": 441, "user_id": 2441491, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ETPgo.png?s=128&g=1", "display_name": "Tyranteon", "link": "https://stackoverflow.com/users/2441491/tyranteon"}, "edited": false, "score": 0, "creation_date": 1497535562, "post_id": 36320146, "comment_id": 76127956, "body": "Well, you can still keep Reading from the gzip stream though even through a Flush."}], "tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 9, "last_activity_date": 1459374709, "last_edit_date": 1459374709, "creation_date": 1459373607, "answer_id": 36320146, "question_id": 36319918, "link": "https://stackoverflow.com/questions/36319918/why-does-json-encoder-add-an-extra-line/36320146#36320146", "title": "Why does json.Encoder add an extra line?", "body": "<p>Because they explicitly added a new line character when using <code>Encoder.Encode</code>.  Here's the source code to that func, and it actually states it adds a newline character in the documentation (see comment, which is the documentation):</p>\n\n<p><a href=\"https://golang.org/src/encoding/json/stream.go?s=4272:4319#L173\" rel=\"noreferrer\">https://golang.org/src/encoding/json/stream.go?s=4272:4319#L173</a></p>\n\n<pre><code>// Encode writes the JSON encoding of v to the stream,\n// followed by a newline character.\n//\n// See the documentation for Marshal for details about the\n// conversion of Go values to JSON.\nfunc (enc *Encoder) Encode(v interface{}) error {\n    if enc.err != nil {\n        return enc.err\n    }\n    e := newEncodeState()\n    err := e.marshal(v)\n    if err != nil {\n        return err\n    }\n\n    // Terminate each value with a newline.\n    // This makes the output look a little nicer\n    // when debugging, and some kind of space\n    // is required if the encoded value was a number,\n    // so that the reader knows there aren't more\n    // digits coming.\n    e.WriteByte('\\n')\n\n    if _, err = enc.w.Write(e.Bytes()); err != nil {\n        enc.err = err\n    }\n    encodeStatePool.Put(e)\n    return err\n}\n</code></pre>\n\n<p>Now, why did the Go developers do it other than \"makes the output look a little nice\"?  One answer:</p>\n\n<h3>Streaming</h3>\n\n<p>The go json <code>Encoder</code> is optimized for streaming (e.g. MB/GB/PB of json data).  It is typical that when streaming you need a way to deliminate when your stream has completed.  In the case of <code>Encoder.Encode()</code>, that is a <code>\\n</code> newline character.  Sure, you can certainly write to a buffer.  But you can also write to an io.Writer which would stream the block of <code>v</code>.</p>\n\n<p>This is opposed to the use of <code>json.Marshal</code> which is generally discouraged if your input is from an untrusted (and unknown limited) source (e.g. an ajax POST method to your web service - what if someone posts a 100MB json file?).  And, <code>json.Marshal</code> would be a final complete set of json - e.g. you wouldn't expect to concatenate a few 100 <code>Marshal</code> entries together.  You'd use Encoder.Encode() for that to build a large set and write to the buffer, stream, file, io.Writer, etc.</p>\n\n<p>Whenever in doubt if it's a bug, I always lookup the source - that's one of the advantages to Go, it's source and compiler is just pure Go.  Within [n]vim I use <code>\\gb</code> to open the source definition in a browser with <a href=\"https://github.com/eduncan911/dotfiles/blob/master/.vimrc\" rel=\"noreferrer\">my <code>.vimrc</code> settings</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1459373626, "creation_date": 1459373626, "answer_id": 36320150, "question_id": 36319918, "link": "https://stackoverflow.com/questions/36319918/why-does-json-encoder-add-an-extra-line/36320150#36320150", "title": "Why does json.Encoder add an extra line?", "body": "<p>The <a href=\"https://godoc.org/encoding/json#Encoder\" rel=\"nofollow\">Encoder</a> writes a stream of values. The extra whitespace is a delimiter between the values.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4408, "favorite_count": 3, "answer_count": 2, "score": 9, "last_activity_date": 1459374709, "creation_date": 1459372614, "last_edit_date": 1459373940, "question_id": 36319918, "link": "https://stackoverflow.com/questions/36319918/why-does-json-encoder-add-an-extra-line", "title": "Why does json.Encoder add an extra line?", "body": "<p><a href=\"https://golang.org/pkg/encoding/json/#NewEncoder\" rel=\"noreferrer\"><code>json.Encoder</code></a> seems to behave slightly different than <code>json.Marshal</code>. Specifically it adds a new line at the end of the encoded value. Any idea why is that? It looks like a bug to me.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/json\"\nimport \"bytes\"\n\nfunc main() {\n    var v string\n    v = \"hello\"\n    buf := bytes.NewBuffer(nil)\n    json.NewEncoder(buf).Encode(v)\n    b, _ := json.Marshal(&amp;v)\n\n    fmt.Printf(\"%q, %q\", buf.Bytes(), b)\n}\n</code></pre>\n\n<p>This outputs</p>\n\n<pre><code>\"\\\"hello\\\"\\n\", \"\\\"hello\\\"\"\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/r0Hwtnd03j\" rel=\"noreferrer\"><kbd>Try it in the Playground</kbd></a></p>\n"}, {"tags": ["go", "google-bigquery"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 3077252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/VGpj1.jpg?s=128&g=1", "display_name": "Reza Shahbazi", "link": "https://stackoverflow.com/users/3077252/reza-shahbazi"}, "edited": false, "score": 0, "creation_date": 1459403165, "post_id": 36321203, "comment_id": 60272755, "body": "Jeremy, do you have any code sample or gist? that will be very helpful"}], "tags": [], "owner": {"reputation": 5861, "user_id": 1375400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qAlJ1.jpg?s=128&g=1", "display_name": "Jeremy Condit", "link": "https://stackoverflow.com/users/1375400/jeremy-condit"}, "is_accepted": false, "score": 0, "last_activity_date": 1459378635, "creation_date": 1459378635, "answer_id": 36321203, "question_id": 36319549, "link": "https://stackoverflow.com/questions/36319549/insert-data-to-nested-fields-of-a-table-at-google-bigquery/36321203#36321203", "title": "Insert data to nested fields of a table at Google BigQuery", "body": "<p>You need to construct a nested object client-side, instead of using dotted notation inside the key for your jsonRow.</p>\n"}, {"tags": [], "owner": {"reputation": 551, "user_id": 2917058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d070b684ae0c40fb051bfdd14bc954cd?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Chen", "link": "https://stackoverflow.com/users/2917058/sean-chen"}, "is_accepted": false, "score": 1, "last_activity_date": 1459552634, "creation_date": 1459552634, "answer_id": 36367271, "question_id": 36319549, "link": "https://stackoverflow.com/questions/36319549/insert-data-to-nested-fields-of-a-table-at-google-bigquery/36367271#36367271", "title": "Insert data to nested fields of a table at Google BigQuery", "body": "<p>You actually need to construct an object structure that matches the structure of your schema.</p>\n\n<p>The confusion here is that the line:</p>\n\n<pre><code>jsonRow[\"geo_location.City.Names.en\"] = bigquery.JsonValue(\"Irvine\")\n</code></pre>\n\n<p>Doesn't create an object structure that you're expecting. The json object you've made actually looks like this:</p>\n\n<pre><code>{\n  \"geo_location.City.Names.en\": \"Irvine\"\n}\n</code></pre>\n\n<p>Whereas you want something that looks like:</p>\n\n<pre><code>{\n  \"geo_location\": {\n    \"City\": {\n      \"Names\": {\n        \"en\": \"Irvine\"\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>So your code should look something like:</p>\n\n<pre><code>// Probably not valid code. Just guessing.\njsonRow[\"geo_location\"] = bigquery.JsonObject()\njsonRow[\"geo_location\"][\"City\"] = bigquery.JsonObject()\njsonRow[\"geo_location\"][\"City\"][\"Names\"] = bigquery.JsonObject()\njsonRow[\"geo_location\"][\"City\"][\"Names\"][\"en\"] = bigquery.JsonValue(\"Irvine\")\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 301, "user_id": 3077252, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/VGpj1.jpg?s=128&g=1", "display_name": "Reza Shahbazi", "link": "https://stackoverflow.com/users/3077252/reza-shahbazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1026, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1459552634, "creation_date": 1459371350, "question_id": 36319549, "link": "https://stackoverflow.com/questions/36319549/insert-data-to-nested-fields-of-a-table-at-google-bigquery", "title": "Insert data to nested fields of a table at Google BigQuery", "body": "<p>I have a table in Cloud BigQuery, but the <em>service.Tabledata.InsertAll</em> call does insert data to the nested fields.</p>\n\n<pre><code>// works\n jsonRow[\"name\"] = bigquery.JsonValue(\"Name\")\n\n// doesn't work\njsonRow[\"geo_location.City.Names.en\"] = bigquery.JsonValue(\"Irvine\")\n\nrows[index] = new(bigquery.TableDataInsertAllRequestRows)\nrows[index].Json = jsonRow\ninsertRequest := &amp;bigquery.TableDataInsertAllRequest{Rows: rows}\ninsertRequest.IgnoreUnknownValues = true\n\ncall := service.Tabledata.InsertAll(project, dataset, \"analytics_events\", insertRequest)\n\nif res, err := call.Do(); err!=nil{\n   Log.Fatal(\"Unable to Insert to BigQuery \", err)\n   return err\n}\n</code></pre>\n"}, {"tags": ["mysql", "database", "go", "web", "nosql"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1459368261, "post_id": 36318435, "comment_id": 60260617, "body": "the first can be done extremely fast by redis, but the second isn&#39;t (unless you re-index every suffix)"}, {"owner": {"reputation": 286, "user_id": 1056064, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebc72f09231eb2b700ab7e36657018aa?s=128&d=identicon&r=PG&f=1", "display_name": "victoroux", "link": "https://stackoverflow.com/users/1056064/victoroux"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1459368973, "post_id": 36318435, "comment_id": 60261030, "body": "I&#39;m pretty sure most key value no-SQL searches would be quite fast for the first scenario, it really is the second one that is causing trouble for us"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1459370834, "post_id": 36318435, "comment_id": 60262103, "body": "since the data is so small, just create a redis sorted set with all the suffixes (i.e. if you have the word <code>hello</code>, insert <code>hello, ello, llo, lo, o</code>), and then search it with ZRANGEBYLEX. it&#39;s primitive but it will work."}, {"owner": {"reputation": 286, "user_id": 1056064, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebc72f09231eb2b700ab7e36657018aa?s=128&d=identicon&r=PG&f=1", "display_name": "victoroux", "link": "https://stackoverflow.com/users/1056064/victoroux"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1459371327, "post_id": 36318435, "comment_id": 60262387, "body": "yea, we tried this and it increased the database from around 50MB to 1+ GB. Perhaps we can re-try with some different methods... thank you as always :)"}], "owner": {"reputation": 286, "user_id": 1056064, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebc72f09231eb2b700ab7e36657018aa?s=128&d=identicon&r=PG&f=1", "display_name": "victoroux", "link": "https://stackoverflow.com/users/1056064/victoroux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 569, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504508931, "creation_date": 1459367544, "last_edit_date": 1506103282, "question_id": 36318435, "link": "https://stackoverflow.com/questions/36318435/fastest-nosql-wildcard-search-dbms", "title": "Fastest NoSQL wildcard search DBMS?", "body": "<p>This is not a subjective question. I'd like to know objectively, what is the fastest at searching both:</p>\n\n<ol>\n<li>\"search string\" + wildcard</li>\n<li>wildcard + \"search string\" + wildcard</li>\n</ol>\n\n<p>Constraints:</p>\n\n<ul>\n<li>Limit to first 20 results (1 preferred over 2, aka run \"search string\" + wildcard before wc+ss+wc and only if 20 results not found for first)</li>\n<li>100,000 rows in db (non-changing)</li>\n</ul>\n\n<p>This database would be very heavily used for searching only. Trying to switch from MySQL to a single file that can be implemented more easily in an executable or towards mobile development. If MySQL servers can be packaged that would work too, but from what I can tell that is a whole complex mess of it's own.</p>\n\n<p>Do these features exist in somewhat reasonable performance in any database not requiring a server? So far we are working with key value store and trying to create multiple databases to parse search queries, but obviously that takes up a lot of hard drive space.</p>\n\n<p>With MySQL our queries are max 0.05s (best 0.03s) using an index. With Go's BoltDB Key=>Value we're hitting max of 3.5s (as it has to query every single key to check for a match) -- so if there is a way to decrease this greatly we're really interested in finding out!</p>\n"}, {"tags": ["go", "closures", "fibonacci"], "comments": [{"owner": {"reputation": 308, "user_id": 2036327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ANfFS.jpg?s=128&g=1", "display_name": "tur", "link": "https://stackoverflow.com/users/2036327/tur"}, "edited": false, "score": 2, "creation_date": 1459367292, "post_id": 36318171, "comment_id": 60260087, "body": "Well, that&#39;s the whole point of a closure. I can recommend reading <a href=\"http://stackoverflow.com/questions/111102/how-do-javascript-closures-work?rq=1\">this</a> (it&#39;s for Javascript, not Go, but that shouldn&#39;t really matter here)."}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1459367408, "creation_date": 1459367408, "answer_id": 36318391, "question_id": 36318171, "link": "https://stackoverflow.com/questions/36318171/why-are-variables-in-closure-not-forgotten/36318391#36318391", "title": "Why are variables in closure not forgotten?", "body": "<p><code>first</code>, and <code>second</code> are variables in the <code>fibonacci()</code> func, that were 'closed over' by the returned <code>func() int</code> that was returned from <code>fibonacci()</code>.</p>\n\n<p>So they are in the closure associated with <code>f</code>, so <code>f</code> has access to those variables as long as it exists.</p>\n\n<p>See <a href=\"https://tour.golang.org/moretypes/22\" rel=\"nofollow\">this</a> Go Tour slide (and the ones around it) for some explanation of Go closures.</p>\n"}], "owner": {"reputation": 5926, "user_id": 3128156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/h3FIS.jpg?s=128&g=1", "display_name": "Sahand", "link": "https://stackoverflow.com/users/3128156/sahand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 36318391, "answer_count": 1, "score": 0, "last_activity_date": 1459367408, "creation_date": 1459366723, "question_id": 36318171, "link": "https://stackoverflow.com/questions/36318171/why-are-variables-in-closure-not-forgotten", "title": "Why are variables in closure not forgotten?", "body": "<p>The following code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n// fibonacci is a function that returns\n// a function that returns an int.\n\nfunc fibonacci() func() int {\n    first, second := 0, 1\n\n    return func() int {\n        // return next fibonacci number here.\n        first, second = second, first+second\n        return  first\n    }   \n}\n\nfunc main() {\n    f := fibonacci()\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(f())\n    }\n}\n</code></pre>\n\n<p>returns 10 numbers of the fibonacci sequence. What's confusing to me is why is works. It seems like the values first and second are somehow <strong>saved</strong> in memory, since each time the code is executed, a new fibonacci number in sequence with the previous one is returned. I thought that functions lost their remembered variables when they were done executing. What is going on here?</p>\n"}, {"tags": ["amazon-web-services", "ssl", "go", "x509", "aws-api-gateway"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 3, "creation_date": 1459363744, "post_id": 36317044, "comment_id": 60257853, "body": "Did you load your self signed cert and mark it as <code>IsCA</code>, like <a href=\"http://stackoverflow.com/questions/22666163/golang-tls-with-selfsigned-certificate\" title=\"golang tls with selfsigned certificate\">stackoverflow.com/questions/22666163/&hellip;</a>"}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1459365183, "post_id": 36317044, "comment_id": 60258767, "body": "Is the certificate coming from client the root certificate or the child?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1459369250, "post_id": 36317044, "comment_id": 60261190, "body": "This key <i>cant</i> be verified by itself: from the <a href=\"https://tools.ietf.org/html/rfc5280#section-4.2.1.9\" rel=\"nofollow noreferrer\">RFC</a> &quot;If the basic constraints extension is not present in a    version 3 certificate, or the extension is present but the cA boolean    is not asserted, then the certified public key MUST NOT be used to    verify certificate signatures&quot;"}, {"owner": {"reputation": 1737, "user_id": 657111, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d89953759285d6347a0873cf4d8efbc2?s=128&d=identicon&r=PG", "display_name": "Derek Shockey", "link": "https://stackoverflow.com/users/657111/derek-shockey"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459379831, "post_id": 36317044, "comment_id": 60266045, "body": "@JohnWeldon Thanks! I&#39;d seen that question but it&#39;s talking about generating the certificate\u2014I hadn&#39;t considered modifying the client certificate after I loaded it. It was a little more complicated than just IsCA, but you led me to it."}], "answers": [{"tags": [], "owner": {"reputation": 1737, "user_id": 657111, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d89953759285d6347a0873cf4d8efbc2?s=128&d=identicon&r=PG", "display_name": "Derek Shockey", "link": "https://stackoverflow.com/users/657111/derek-shockey"}, "is_accepted": true, "score": 6, "last_activity_date": 1459380251, "creation_date": 1459380251, "answer_id": 36321501, "question_id": 36317044, "link": "https://stackoverflow.com/questions/36317044/how-can-i-make-go-accept-a-self-signed-certificate-for-tls-client-authentication/36321501#36321501", "title": "How can I make Go accept a self-signed certificate for TLS client authentication?", "body": "<p>@JohnWeldon's comment led me to the solution, which is that I need to modify the client Certificate struct after I load it. This requires decoding the PEM and parsing out the certificate. For the API Gateway client certificate, I had to set <code>BasicConstraintsValid</code> and <code>IsCA</code> to true and <code>KeyUsage</code> to <code>KeyUsageCertSign</code>; for my locally generated cert I only needed the latter two. Modifying the <code>enableClientAuth()</code> func in my question:</p>\n\n<pre><code>func enableClientAuth(server *http.Server, clientCertFile string) error {\n    pemBytes, err := ioutil.ReadFile(clientCertFile)\n    if err != nil {\n        return err\n    }\n\n    pemBlock, _ := pem.Decode(pemBytes)\n    clientCert, err := x509.ParseCertificate(pemBlock.Bytes)\n    if err != nil {\n        return err\n    }\n\n    clientCert.BasicConstraintsValid = true\n    clientCert.IsCA = true\n    clientCert.KeyUsage = x509.KeyUsageCertSign\n\n    caCertPool := x509.NewCertPool()\n    caCertPool.AddCert(clientCert)\n\n    tlsConfig := &amp;tls.Config{\n        ClientAuth: tls.RequireAndVerifyClientCert,\n        ClientCAs:  caCertPool,\n    }\n    tlsConfig.BuildNameToCertificate()\n    server.TLSConfig = tlsConfig\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 1737, "user_id": 657111, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d89953759285d6347a0873cf4d8efbc2?s=128&d=identicon&r=PG", "display_name": "Derek Shockey", "link": "https://stackoverflow.com/users/657111/derek-shockey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2560, "favorite_count": 1, "accepted_answer_id": 36321501, "answer_count": 1, "score": 5, "last_activity_date": 1459380251, "creation_date": 1459363037, "question_id": 36317044, "link": "https://stackoverflow.com/questions/36317044/how-can-i-make-go-accept-a-self-signed-certificate-for-tls-client-authentication", "title": "How can I make Go accept a self-signed certificate for TLS client authentication?", "body": "<p>I'm working with AWS API Gateway and a Go back end. In order to ensure all connections are going through API Gateway, I need to use TLS client authentication (aka two-way authentication, mutual authentication).</p>\n\n<p>In principle, this works with something like:</p>\n\n<pre><code>func enableClientAuth(server *http.Server, clientCertFile string) error {\n    clientCert, err := ioutil.ReadFile(clientCertFile)\n    if err != nil {\n        return err\n    }\n    caCertPool := x509.NewCertPool()\n    caCertPool.AppendCertsFromPEM(clientCert)\n\n    tlsConfig := &amp;tls.Config{\n        ClientAuth: tls.RequireAndVerifyClientCert,\n        ClientCAs:  caCertPool,\n    }\n    tlsConfig.BuildNameToCertificate()\n    server.TLSConfig = tlsConfig\n    return nil\n}\n</code></pre>\n\n<p>The problem I'm having is this error:</p>\n\n<blockquote>\n  <p>tls: failed to verify client's certificate: x509: certificate signed by unknown authority (possibly because of \"x509: invalid signature: parent certificate cannot sign this kind of certificate\" while trying to verify candidate authority certificate \"ApiGateway\")</p>\n</blockquote>\n\n<p>This seems to be because the client certificate is self-signed, but is not a CA certificate, Go will not accept the signature. (Doesn't this defeat the purpose of a self-signed certificate? Most self-signed certs I have seen are not CA certs.) Unfortunately, I have no control over how the client certificate is generated or sent; it is all done by AWS. Is there something I can do to get a certificate in the ClientCAs cert pool that will cause Go to accept the API Gateway client certificate?</p>\n\n<p>Example client certificate:</p>\n\n<pre><code>-----BEGIN CERTIFICATE-----\nMIIC6DCCAdCgAwIBAgIISIIYdm+rIgMwDQYJKoZIhvcNAQELBQAwNDELMAkGA1UE\nBhMCVVMxEDAOBgNVBAcTB1NlYXR0bGUxEzARBgNVBAMTCkFwaUdhdGV3YXkwHhcN\nMTYwMzMwMTgxNTE4WhcNMTcwMzMwMTgxNTE4WjA0MQswCQYDVQQGEwJVUzEQMA4G\nA1UEBxMHU2VhdHRsZTETMBEGA1UEAxMKQXBpR2F0ZXdheTCCASIwDQYJKoZIhvcN\nAQEBBQADggEPADCCAQoCggEBALVVG0Ng8IbDy0tdw2yp2GHXYV8jDPJxsRXAstZ+\n5N4ngG/ySPyv1i2OOvzKqUNzyKptsUbgtG/0XDWRI0qDATrsxXH6xy8lBeRZHNi4\nko6EP9BevyxB5YtoKqEoXbKAn4/hNWmac8tnENkLww0qFpPOhtxb0B2DHv+lkqZo\nqBBBBZQ5Dal95h0cpUwoLRr5w3HsYzPcX1OUtQ/5cH0M0p/XvkB4jrZxsh1aQGsf\nB9+temIJJtKvmmZ0C/dZ+neJhA+I526eUENeqmm5R1irM7sj4FDaU4bLR+L/+R6s\nKtDLT4jPqf5vFYfMuEmyk4b5TBATJxAA47Y+gRFRe6Aon0ECAwEAATANBgkqhkiG\n9w0BAQsFAAOCAQEAmFdXuy5Y6zdrIZHd7XCt/Q6jsU3hFGaEGRbDEFBwh6ixz58e\n1egiUnIeUWZTFSzjQSY3IhYE7dvW+BVkjdLybhB3rim29Fb67AkBtRmQOLnHz426\nbflOG46BSwNTvIEytOr0O6ds49bD34UrHELUCGmHJqIhBSrVCFOCwlf/Mksw9jxD\nxo/YmJe2R4xNklvxWiFHOXrnGwrJ9yaWeQnCkRZBzfFLSZ26/fBnbkYUGn0lmtoB\ne/rg/rgpwufbkhXA6CFX7adnLUKWqZgbmL5dpvLu9vB34ebfo4vE+o7AsgdloHBV\nobcSyrLbZp25k/SlbOhSAqjjW1NaF+YypTxHFA==\n-----END CERTIFICATE-----\n</code></pre>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459362820, "post_id": 36316752, "comment_id": 60257277, "body": "Why is the ServeMux redirection a GET? Why doesnt it use the method of the original request? And more importantly, is there a way to make this redirection execute a POST?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459365144, "post_id": 36316752, "comment_id": 60258746, "body": "@dopatraman See edited answer (actually added it to the answer as it&#39;s informative to others as well)."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459365565, "post_id": 36316752, "comment_id": 60258991, "body": "Thank you. If you add this answer to this thread as well (<a href=\"http://stackoverflow.com/questions/36295758/http-post-method-is-actally-sending-a-get\" title=\"http post method is actally sending a get\">stackoverflow.com/questions/36295758/&hellip;</a>) I&#39;ll mark it correct as well."}, {"owner": {"reputation": 1158, "user_id": 9545222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d28620c1afdcb27110f4ddbb66a746?s=128&d=identicon&r=PG&f=1", "display_name": "RockingDice", "link": "https://stackoverflow.com/users/9545222/rockingdice"}, "edited": false, "score": 0, "creation_date": 1565016674, "post_id": 36316752, "comment_id": 101208982, "body": "My situation is a typo of doubled dash &#39;hostname//path&#39;, it redirects to the &#39;hostname/path&#39;, which leads to this issue."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1459366149, "last_edit_date": 1491982282, "creation_date": 1459362213, "answer_id": 36316752, "question_id": 36316429, "link": "https://stackoverflow.com/questions/36316429/go-web-server-is-automatically-redirecting-post-requests/36316752#36316752", "title": "Go web server is automatically redirecting POST requests", "body": "<p>The explanation is simple: because you used the <code>\"/myurl/\"</code> path when you registered your <code>PHandler</code> (note the trailing slash <code>/</code>!) but you directed your browser to <code>/myurl</code> (note there is no trailing slash). And by default the <code>http</code> package implementation will perform (send back) a redirect request so if the browser follows it (it will), the new URL will match the registered path.</p>\n\n<p>This is documented at type <a href=\"https://golang.org/pkg/net/http/#ServeMux\" rel=\"noreferrer\"><code>http.ServeMux</code></a>:</p>\n\n<blockquote>\n  <p><strong>If a subtree has been registered and a request is received naming the subtree root without its trailing slash, ServeMux redirects that request to the subtree root (adding the trailing slash).</strong> This behavior can be overridden with a separate registration for the path without the trailing slash. For example, registering \"/images/\" causes ServeMux to redirect a request for \"/images\" to \"/images/\", unless \"/images\" has been registered separately.</p>\n</blockquote>\n\n<p>Should you direct your browser directly to <code>/myurl/</code>, you would not experience a redirect.</p>\n\n<p>Or if you don't need to handle a rooted subtree but only a single path (e.g. <code>/myurl</code>), then register your handler only to this single path:</p>\n\n<pre><code>http.HandleFunc(\"/myurl\", PHandler)\n</code></pre>\n\n<p>And then of course direct your browser to <code>/myurl</code>, and you will not experience any redirect either.</p>\n\n<p>...Or as the documentation suggests: register both paths to your handler if you really need it:</p>\n\n<pre><code>http.HandleFunc(\"/myurl\", PHandler)\nhttp.HandleFunc(\"/myurl/\", PHandler)\n</code></pre>\n\n<p>And now no matter which path you call (<code>/myurl</code> or <code>/myurl/</code>), both will result in calling your handler without any redirection taking place.</p>\n\n<p><strong>Notes:</strong></p>\n\n<p>In your situation when a redirect was sent back to the browser, the browser will not repeat the POST request (but rather just a \"simple\" GET request).</p>\n\n<p>Generally speaking a browser will not send POST data to a redirect URL because the browser is not qualified to decide if you're willing to send the same data to the new URL what you intended to send to the original URL (think about passwords, credit card numbers and other sensitive data). But don't try to circumvent it, simply use registered path of your handler to POST to, or any of the other tips mentioned above.</p>\n\n<p>You can read more on the subject here:</p>\n\n<p><a href=\"https://softwareengineering.stackexchange.com/questions/99894/why-doesnt-http-have-post-redirect\">Why doesn't HTTP have POST redirect?</a></p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2756, "favorite_count": 0, "accepted_answer_id": 36316752, "answer_count": 1, "score": 5, "last_activity_date": 1459491675, "creation_date": 1459361188, "last_edit_date": 1495542877, "question_id": 36316429, "link": "https://stackoverflow.com/questions/36316429/go-web-server-is-automatically-redirecting-post-requests", "title": "Go web server is automatically redirecting POST requests", "body": "<p>I've been trying to solve a <a href=\"https://stackoverflow.com/questions/36295758/http-post-method-is-actally-sending-a-get\">weird problem</a> for quite some time now. After stepping through lots of angular code, I noticed something weird while logging requests to my server through Charles.</p>\n\n<p>When I post to a url <code>/myurl</code> the request never actually hits my server. Instead, it gets a 301 response and THEN a GET request hite my server. </p>\n\n<p>This is incredibly puzzling. Has anyone else run into this problem? I've uploaded a screenshot of my Charles log incase you are interested.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sCQy2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sCQy2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Just as a reference, this is what my server looks like:</p>\n\n<pre><code>type FormStruct struct {\n    Test string\n}\n\nfunc PHandler(w http.ResponseWriter, r *http.Request) {\n    var t FormStruct\n\n    req, _ := httputil.DumpRequest(r, true)\n\n    log.Println(string(req))\n    log.Println(r.Method) // GET\n    log.Println(r.Body)\n\n    decoder := json.NewDecoder(r.Body)\n    err := decoder.Decode(&amp;t)\n    log.Println(\"Decoding complete\")\n    if err != nil {\n        log.Println(\"Error\")\n        panic(err.Error()+\"\\n\\n\")\n    }\n    log.Println(t.Test)\n\n    w.Write([]byte(\"Upload complete, no errors\"))\n}\n\nfunc main() {\n    http.HandleFunc(\"/myurl/\", PHandler)    \n    fmt.Println(\"Go Server listening on port 8001\")\n    http.ListenAndServe(\":8001\", nil)\n}\n</code></pre>\n"}, {"tags": ["ajax", "node.js", "express", "go", "request"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459361530, "post_id": 36316318, "comment_id": 60256355, "body": "I think I misunderstood the question.  Are you looking for equivalent Go code for the server handler of the POST, or for Go code demonstrating a client response?"}, {"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459361788, "post_id": 36316318, "comment_id": 60256532, "body": "@JohnWeldon Go code for server handler of the POST which includes getting body of the request message. I edited the question to make it clearer"}], "answers": [{"comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1459362705, "post_id": 36316861, "comment_id": 60257197, "body": "Yes, that works fine too.. I just munged some existing sample code for this example."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1459362555, "creation_date": 1459362555, "answer_id": 36316861, "question_id": 36316318, "link": "https://stackoverflow.com/questions/36316318/go-how-to-get-request-message-body-content/36316861#36316861", "title": "go - How to get request message body content?", "body": "<p><a href=\"https://play.golang.org/p/eI6YTlGaDo\" rel=\"nofollow\">Here</a> is a simple example of an http handler:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", Handler)\n    http.ListenAndServe(\":8080\", nil)\n    // Running in playground will fail but this will start a server locally\n}\n\ntype Payload struct {\n    ArbitraryValue string `json:\"arbitrary\"`\n    AnotherInt     int    `json:\"another\"`\n}\n\nfunc Handler(w http.ResponseWriter, r *http.Request) {\n    body, err := ioutil.ReadAll(r.Body)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    url := r.URL\n    // Do something with Request URL\n    fmt.Fprintf(w, \"The URL is %q\", url)\n\n    payload := Payload{}\n    err = json.NewDecoder(bytes.NewReader(body)).Decode(&amp;payload)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    // Do something with payload\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1459364437, "creation_date": 1459364437, "answer_id": 36317470, "question_id": 36316318, "link": "https://stackoverflow.com/questions/36316318/go-how-to-get-request-message-body-content/36317470#36317470", "title": "go - How to get request message body content?", "body": "<p>If the request body is URL encoded, then use <a href=\"https://godoc.org/net/http#Request.FormValue\" rel=\"nofollow\">r.FormValue(\"url\")</a> to get the \"url\" value from the request.</p>\n\n<p>If the request body is JSON, then use the <a href=\"https://godoc.org/encoding/json#Decoder\" rel=\"nofollow\">JSON decoder</a> to parse the <a href=\"https://godoc.org/net/http#Request.Body\" rel=\"nofollow\">request body</a> to a value typed to match the shape of the JSON.</p>\n\n<pre><code>var data struct {\n   URL string\n}\nif err := json.NewDecoder(r.Body).Decode(&amp;data); err != nil {\n    // handle error\n}\n// data.URL is \"url\" member of the posted JSON object.\n</code></pre>\n"}], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 36316861, "answer_count": 2, "score": -1, "last_activity_date": 1459364437, "creation_date": 1459360889, "last_edit_date": 1459361825, "question_id": 36316318, "link": "https://stackoverflow.com/questions/36316318/go-how-to-get-request-message-body-content", "title": "go - How to get request message body content?", "body": "<p>My client code sends an AJAX request to server, containing a message</p>\n\n<p>How could I read data from that request message body. In Express of NodeJS, I use this:</p>\n\n<pre><code>    app.post('/api/on', auth.isLoggedIn, function(req, res){\n                res.setHeader('Access-Control-Allow-Origin', '*');\n                res.setHeader('Access-Control-Allow-Methods', 'POST');\n                res.setHeader('Access-Control-Allow-Headers', 'Content-Type');\n\n                var url = req.body.url;\n                // Later process\n}\n</code></pre>\n\n<p>What is the <code>url = req.body.url</code> equivalent in Go?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 5, "last_activity_date": 1459355876, "last_edit_date": 1459355876, "creation_date": 1459355241, "answer_id": 36314561, "question_id": 36314495, "link": "https://stackoverflow.com/questions/36314495/go-language-type-xxx-is-not-an-expression/36314561#36314561", "title": "Go language: Type XXX is not an expression", "body": "<p>You're declaring <code>matrix</code> as a type, but using it as a variable. </p>\n\n<p>try:</p>\n\n<pre><code>var matrix [][]uint8\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5926, "user_id": 3128156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/h3FIS.jpg?s=128&g=1", "display_name": "Sahand", "link": "https://stackoverflow.com/users/3128156/sahand"}, "edited": false, "score": 0, "creation_date": 1459357910, "post_id": 36315385, "comment_id": 60254188, "body": "Very helpful! Thanks!"}], "tags": [], "owner": {"reputation": 397892, "user_id": 95592, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/utY5u.jpg?s=128&g=1", "display_name": "Matthew Rankin", "link": "https://stackoverflow.com/users/95592/matthew-rankin"}, "is_accepted": true, "score": 4, "last_activity_date": 1459357916, "last_edit_date": 1459357916, "creation_date": 1459357757, "answer_id": 36315385, "question_id": 36314495, "link": "https://stackoverflow.com/questions/36314495/go-language-type-xxx-is-not-an-expression/36315385#36315385", "title": "Go language: Type XXX is not an expression", "body": "<p>While you can use <code>var matrix [][]uint8</code>, I'd recommend using the built-in <code>make</code> function since you know the desired lengths\u2014<code>dx</code> for the outer slice and <code>dy</code> for the inner slice. The <a href=\"https://golang.org/doc/effective_go.html#two_dimensional_slices\" rel=\"nofollow\">Two-dimensional slices</a> section of <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow\">Effective Go</a> gives an example of using <code>make</code> to allocate a two-dimensional slice. Below is an example for your <code>Pic</code> function.</p>\n\n<pre><code>func Pic(dx, dy int) [][]uint8 {\n    matrix := make([][]uint8, dx)\n\n    for i := 0; i &lt; dx; i++ {\n        matrix[i] = make([]uint8, dy)\n        for j := 0; j &lt; dy; j++ {\n            matrix[i][j] = Z(i, j)\n        }\n    }\n    return matrix\n}\n</code></pre>\n"}], "owner": {"reputation": 5926, "user_id": 3128156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/h3FIS.jpg?s=128&g=1", "display_name": "Sahand", "link": "https://stackoverflow.com/users/3128156/sahand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11490, "favorite_count": 0, "accepted_answer_id": 36315385, "answer_count": 2, "score": 4, "last_activity_date": 1459357916, "creation_date": 1459355068, "question_id": 36314495, "link": "https://stackoverflow.com/questions/36314495/go-language-type-xxx-is-not-an-expression", "title": "Go language: Type XXX is not an expression", "body": "<p>I have written a function:</p>\n\n<pre><code>func Pic(dx, dy int) [][]uint8 {\n    type matrix [][]uint8 \n\n    for i := 0; i &lt; dx; i++ { // fills up the matrix with z's in their right places.\n        for j := 0; j &lt; dy; j++ {\n            matrix[i][j] = Z(i,j)\n        }\n    }\n\n    return matrix\n}\n</code></pre>\n\n<p>that is supposed to fill up a matrix with z values for each x and y value and return it. As I want to have different dimensions for the matrix depending of parameters to the Pic function, I create a slice i line 2. Then in my for loops i fill the matrix up.</p>\n\n<p>I get an error upon running this code: <code>type matrix is not an expression</code> for the <code>matrix[i][j] = Z(i,j)</code> line. What am I doing wrong? Should matrix[i][j] evaluate to an expression? Why should it, when I want to put something there (it's empty/non-existent now!) ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1570689513, "post_id": 36311280, "comment_id": 102993674, "body": "Thank you :) I thought we had to write a custom Error function everytime we need to return an error. <a href=\"https://tour.golang.org/methods/19\" rel=\"nofollow noreferrer\">tour.golang.org/methods/19</a>"}], "tags": [], "owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "is_accepted": true, "score": 19, "last_activity_date": 1516800799, "last_edit_date": 1516800799, "creation_date": 1459346783, "answer_id": 36311280, "question_id": 36311182, "link": "https://stackoverflow.com/questions/36311182/force-return-error-in-golang/36311280#36311280", "title": "Force return error in golang", "body": "<p>you can return errors like this:</p>\n\n<pre><code>func ReturnError() (string, error){       \n      return \"\", fmt.Errorf(\"this is an %s error\", \"internal server\")\n      // or\n      return \"\", errors.New(\"this is an error\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": false, "score": 10, "last_activity_date": 1459346809, "creation_date": 1459346809, "answer_id": 36311290, "question_id": 36311182, "link": "https://stackoverflow.com/questions/36311182/force-return-error-in-golang/36311290#36311290", "title": "Force return error in golang", "body": "<p>You can use the <code>errors</code> package.</p>\n\n<pre><code>import \"errors\"\n\n// [ ... ]\n\nfunc failFunc() error {\n    return errors.New(\"Error message\")\n}\n</code></pre>\n\n<p>Here's the godoc: <a href=\"https://godoc.org/errors\">https://godoc.org/errors</a></p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5160, "favorite_count": 1, "accepted_answer_id": 36311280, "answer_count": 2, "score": 9, "last_activity_date": 1516800799, "creation_date": 1459346572, "question_id": 36311182, "link": "https://stackoverflow.com/questions/36311182/force-return-error-in-golang", "title": "Force return error in golang", "body": "<p>I want to test how certain code handles errors.</p>\n\n<p>I want a function to return an error.</p>\n\n<p>I have tried typing <code>return 0/0</code> but then my application won't build</p>\n\n<p>How can I force return an error?</p>\n"}, {"tags": ["scala", "reflection", "go", "types"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1459346675, "post_id": 36311041, "comment_id": 60245726, "body": "Your presumption is incorrect, there are no hidden fields in a Go struct. All types are known to the compiler at compile time."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1459349444, "post_id": 36311041, "comment_id": 60248056, "body": "Go, in simple terms: when you call <code>printTypeOf(x)</code>, x is wrapped in an interface value. This value has the &quot;hidden field&quot; you were thinking about."}, {"owner": {"reputation": 159, "user_id": 2850249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/940d62ca92db1c3a888b2f9bb64b473b?s=128&d=identicon&r=PG&f=1", "display_name": "user2850249", "link": "https://stackoverflow.com/users/2850249/user2850249"}, "edited": false, "score": 0, "creation_date": 1459801177, "post_id": 36311041, "comment_id": 60439991, "body": "Given that it is wrapped, that makes sense"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 2850249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/940d62ca92db1c3a888b2f9bb64b473b?s=128&d=identicon&r=PG&f=1", "display_name": "user2850249", "link": "https://stackoverflow.com/users/2850249/user2850249"}, "edited": false, "score": 0, "creation_date": 1459801084, "post_id": 36312517, "comment_id": 60439953, "body": "Ok I can see how that works for interface{} types in Go and objects in Scala. Just use the correct offset and get the type information. But if I pass a plain old integer represented by the byte 11010110, how does it know that I meant it as an integer, rather than a pointer or a character and to box it with a pointer to the integer type."}, {"owner": {"reputation": 159, "user_id": 2850249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/940d62ca92db1c3a888b2f9bb64b473b?s=128&d=identicon&r=PG&f=1", "display_name": "user2850249", "link": "https://stackoverflow.com/users/2850249/user2850249"}, "edited": false, "score": 0, "creation_date": 1459801125, "post_id": 36312517, "comment_id": 60439966, "body": "In other words, how does Scala box 11010110 to an Integer class with a value field of 214 rather than a Character class with value &#214;?"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 159, "user_id": 2850249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/940d62ca92db1c3a888b2f9bb64b473b?s=128&d=identicon&r=PG&f=1", "display_name": "user2850249", "link": "https://stackoverflow.com/users/2850249/user2850249"}, "edited": false, "score": 0, "creation_date": 1459808129, "post_id": 36312517, "comment_id": 60443240, "body": "&quot;But if I pass a plain old integer represented by the byte 11010110, how does it know that I meant it as an integer&quot; By its static type. If that&#39;s <code>Int</code>, it&#39;s boxed to <code>Integer</code>, if <code>Char</code> to <code>Character</code>, etc. And if <code>Any</code>, it&#39;s already boxed."}, {"owner": {"reputation": 159, "user_id": 2850249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/940d62ca92db1c3a888b2f9bb64b473b?s=128&d=identicon&r=PG&f=1", "display_name": "user2850249", "link": "https://stackoverflow.com/users/2850249/user2850249"}, "edited": false, "score": 0, "creation_date": 1459849675, "post_id": 36312517, "comment_id": 60459892, "body": "Ah ok, that makes sense since in my scala example, ab get&#39;s matched on it&#39;s static type rather than dynamic type. But isn&#39;t the static type only known at compile time, whilst these reflection feature work in the runtime?"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 159, "user_id": 2850249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/940d62ca92db1c3a888b2f9bb64b473b?s=128&d=identicon&r=PG&f=1", "display_name": "user2850249", "link": "https://stackoverflow.com/users/2850249/user2850249"}, "edited": false, "score": 0, "creation_date": 1459853760, "post_id": 36312517, "comment_id": 60462975, "body": "No, it is matching on runtime type. My point is that if you have a &quot;plain old integer&quot;, it&#39;s static (and runtime) type is <i>always</i> <code>Int</code>. So the compiler knows how to box it."}, {"owner": {"reputation": 159, "user_id": 2850249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/940d62ca92db1c3a888b2f9bb64b473b?s=128&d=identicon&r=PG&f=1", "display_name": "user2850249", "link": "https://stackoverflow.com/users/2850249/user2850249"}, "edited": false, "score": 0, "creation_date": 1459949324, "post_id": 36312517, "comment_id": 60517909, "body": "Ah so the boxing is done by the compiler. So when you give an integer to a function, the compiler inserts a conversion to a interface{} type or Integer type. That makes sense, thanks."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": true, "score": 2, "last_activity_date": 1459405633, "last_edit_date": 1459405633, "creation_date": 1459349680, "answer_id": 36312517, "question_id": 36311041, "link": "https://stackoverflow.com/questions/36311041/how-do-programs-know-the-types-at-runtimes-of-primitives-statically-typed-langua/36312517#36312517", "title": "How do programs know the types at runtimes of primitives statically typed languages", "body": "<p>In Scala, each object has a pointer to its class. When you call <code>thing</code> with a primitive argument (<code>Int</code>, <code>Char</code>, etc.), it's automatically boxed to an object (<code>java.lang.Integer</code>, <code>java.lang.Character</code>, etc.). The match against <code>Int</code> in your code is actually translated to a match against <code>Integer</code>. </p>\n\n<p>In Go, the type isn't stored in structs, but in interface values:</p>\n\n<blockquote>\n  <p><a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\">Interface values are represented as a two-word pair giving a pointer to information about the type stored in the interface and a pointer to the associated data. Assigning b to an interface value of type Stringer sets both words of the interface value.</a> </p>\n</blockquote>\n\n<p>So when you call <code>printTypeOf(whatever)</code>, <code>whatever</code> is converted to <code>interface {}</code> and its type is stored in this new value along with <code>whatever</code> itself.</p>\n"}], "owner": {"reputation": 159, "user_id": 2850249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/940d62ca92db1c3a888b2f9bb64b473b?s=128&d=identicon&r=PG&f=1", "display_name": "user2850249", "link": "https://stackoverflow.com/users/2850249/user2850249"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 36312517, "answer_count": 1, "score": 3, "last_activity_date": 1459405633, "creation_date": 1459346274, "question_id": 36311041, "link": "https://stackoverflow.com/questions/36311041/how-do-programs-know-the-types-at-runtimes-of-primitives-statically-typed-langua", "title": "How do programs know the types at runtimes of primitives statically typed languages", "body": "<p>Both Go and Scala provide ways of checking types at runtime:</p>\n\n<p>Scala:</p>\n\n<pre><code>class A\nclass B extends A\n\nval a: A = new A // static type: A dynamic type: A\nval ab: A = new B // static type: A dynamic type: B\nval b: B = new B // static type: B dynamic type: B\n\ndef thing(x: Any): String = x match {\n    case t: Int =&gt; \"Int\"\n    case t: A =&gt; \"A\"\n    case t: B =&gt; \"B\"\n    case t: String =&gt; \"String\"\n    case _ =&gt; \"unknown type\"\n}\n</code></pre>\n\n<p>Go: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nstruct A {\n    field1 int\n    field2 string\n}\n\nfunc printTypeOf(t interface{}) {\n    fmt.Println(reflect.TypeOf(t))\n}\n\nfunc main() {\n    i := 234234 // int\n    s := \"hello world\" // string\n    p := &amp;A{3234234, \"stuff\"} // *A\n\n    fmt.Print(\"The type of i is: \")\n    printTypeOf(i)\n    fmt.Print(\"The type of s is: \")\n    printTypeOf(s)\n    fmt.Print(\"The type of p is: \") // pass a pointer\n    printTypeOf(p)\n    fmt.Print(\"The type of the reference of p is: \") // pass a value\n    printTypeOf(*p)\n}\n</code></pre>\n\n<p>How exactly does this work internally? I presume for structs and classes, the type of the object is stored in a hidden field (so the structure in golang is really struct { field1 int field2 string type type }. But how on earth can function be given 11010110 and know whether it's a pointer to memory address at 214, the integer 214 or the character \u00d6? Are all values secretly passed with a byte which represents its type? </p>\n"}, {"tags": ["go", "reflection", "go-reflect"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1459345303, "post_id": 36310538, "comment_id": 60244520, "body": "reflect.TypeOf(A{}) tell you it is main.A"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1459345335, "post_id": 36310538, "comment_id": 60244546, "body": "<code>reflect.TypeOf(A{}).String()</code> =&gt; <code>main.A</code>. <code>reflect.TypeOf([]byte{}).String()</code> =&gt; <code>[]uint8</code>"}, {"owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 0, "creation_date": 1459345854, "post_id": 36310538, "comment_id": 60244973, "body": "<code>reflect.TypeOf(A{}).Kind() == reflect.Slice</code>. I need to know that it&#39;s a wrapper/custom type, and not a naked <code>[]byte</code> type."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459346229, "post_id": 36310538, "comment_id": 60245312, "body": "<code>&quot;main.A&quot;</code> <i>is</i> a custom/wrapper type, this <code>string</code> is not equal to <code>&quot;[]uint8&quot;</code>, is it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1459346471, "post_id": 36310538, "comment_id": 60245537, "body": "Also <code>Type.Name()</code> only returns a value for named types."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1459353438, "post_id": 36310538, "comment_id": 60251204, "body": "also <code>Type.PkgPath()</code> should return an empty string for built in types."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 17, "last_activity_date": 1471849094, "last_edit_date": 1471849094, "creation_date": 1463555340, "answer_id": 37292523, "question_id": 36310538, "link": "https://stackoverflow.com/questions/36310538/identify-non-builtin-types-using-reflect/37292523#37292523", "title": "Identify non builtin-types using reflect", "body": "<h2>Some background</h2>\n\n<p>First let's clear some things related to types. Quoting from <a href=\"https://golang.org/ref/spec#Types\" rel=\"noreferrer\">Spec: Types:</a></p>\n\n<blockquote>\n  <p>A type determines the set of values and operations specific to values of that type. Types may be <em>named</em> or <em>unnamed</em>. Named types are specified by a (possibly <a href=\"https://golang.org/ref/spec#Qualified_identifiers\" rel=\"noreferrer\">qualified</a>) <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"noreferrer\">type name</a>; unnamed types are specified using a <em>type literal</em>, which composes a new type from existing types.</p>\n</blockquote>\n\n<p>So there are (predeclared) <em>named types</em> such as <code>string</code>, <code>int</code> etc, and you may also create new named types using <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"noreferrer\">type declarations</a> (which involves the <code>type</code> keyword) such as <code>type MyInt int</code>. And there are <em>unnamed types</em> which are the result of a <em>type literal</em> (applied to / including named or unnamed types) such as <code>[]int</code>, <code>struct{i int}</code>, <code>*int</code> etc. </p>\n\n<p>You can get the name of a named type using the <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"noreferrer\"><code>Type.Name()</code></a> method, which <em>\"returns an empty string for unnamed types\"</em>:</p>\n\n<pre><code>var i int = 2\nfmt.Printf(\"%q\\n\", reflect.TypeOf(\"abc\").Name())              // Named: \"string\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf(int(2)).Name())             // Named: \"int\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf([]int{}).Name())            // Unnamed: \"\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf(struct{ i int }{}).Name())  // Unnamed: \"\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf(&amp;struct{ i int }{}).Name()) // Unnamed: \"\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf(&amp;i).Name())                 // Unnamed: \"\"\n</code></pre>\n\n<p>There are types which are predeclared and are ready for you to use them (either <em>as-is</em>, or in type literals):</p>\n\n<blockquote>\n  <p>Named instances of the boolean, numeric, and string types are <a href=\"https://golang.org/ref/spec#Predeclared_identifiers\" rel=\"noreferrer\">predeclared</a>. Composite types\u2014array, struct, pointer, function, interface, slice, map, and channel types\u2014may be constructed using type literals.</p>\n</blockquote>\n\n<p>Predeclared types are:</p>\n\n<pre><code>bool byte complex64 complex128 error float32 float64\nint int8 int16 int32 int64 rune string\nuint uint8 uint16 uint32 uint64 uintptr\n</code></pre>\n\n<p>You may use <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"noreferrer\"><code>Type.PkgPath()</code></a> to get a <em>named</em> type's package path, which <em>\"if the type was predeclared (<code>string</code>, <code>error</code>) or unnamed (<code>*T</code>, <code>struct{}</code>, <code>[]int</code>), the package path will be the empty string\"</em>:</p>\n\n<pre><code>fmt.Printf(\"%q\\n\", reflect.TypeOf(\"abc\").PkgPath())    // Predeclared: \"\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf(A{}).PkgPath())      // Named: \"main\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf([]byte{}).PkgPath()) // Unnamed: \"\"\n</code></pre>\n\n<p>So you have 2 tools available to you: <code>Type.Name()</code> to tell if the type is a <em>named</em> type, and <code>Type.PkgPath()</code> to tell if the type is <strong>not predeclared</strong> and is a <strong>named type</strong>.</p>\n\n<p>But care must be taken. If you use your own, named type in a type literal to construct a new type (e.g. <code>[]A</code>), that will be an unnamed type (if you don't use the <code>type</code> keyword to construct a new, named type):</p>\n\n<pre><code>type ASlice []A\n\nfmt.Printf(\"%q\\n\", reflect.TypeOf([]A{}).PkgPath())    // Also unnamed: \"\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf(ASlice{}).PkgPath()) // Named: \"main\"\n</code></pre>\n\n<p>What can you do in such cases? You may use <code>Type.Elem()</code> to get the type's element type, if type's <a href=\"https://golang.org/pkg/reflect/#Kind\" rel=\"noreferrer\"><code>Kind</code></a> is <code>Array</code>, <code>Chan</code>, <code>Map</code>, <code>Ptr</code>, or <code>Slice</code> (else <code>Type.Elem()</code> panics):</p>\n\n<pre><code>fmt.Printf(\"%q\\n\", reflect.TypeOf([]A{}).Elem().Name())    // Element type: \"A\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf([]A{}).Elem().PkgPath()) // Which is named, so: \"main\"\n</code></pre>\n\n<h2>Summary</h2>\n\n<p><code>Type.PkgPath()</code> can be used to \"filter out\" predeclared and unnamed types. If <code>PkgPath()</code> returns a non-empty string, you can be sure it's a \"custom\" type. If it returns an empty string, it still may be an unnamed type (in which case <code>Type.Name()</code> returns <code>\"\"</code>) constructed from a \"custom\" type; for that you may use <code>Type.Elem()</code> to see if it is constructed from a \"custom\" type, which may have to be applied <em>recursively</em>:</p>\n\n<pre><code>// [][]A -&gt; Elem() -&gt; []A which is still unnamed: \"\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf([][]A{}).Elem().PkgPath())\n\n// [][]A -&gt; Elem() -&gt; []A -&gt; Elem() -&gt; A which is named: \"main\"\nfmt.Printf(\"%q\\n\", reflect.TypeOf([][]A{}).Elem().Elem().PkgPath())\n</code></pre>\n\n<p>Try all the examples on the <a href=\"https://play.golang.org/p/TX7qAwuB2C\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<h3>Special case #1: Anonymous struct types</h3>\n\n<p>There is also the case of an anonymous struct type which is unnamed, but it may have a field of a \"custom\" type. This case can be handled by iterating over the fields of the struct type and performing the same check on each field, and if any of them is found to be a \"custom\" type, we can claim the whole struct type to be \"custom\".</p>\n\n<h3>Special case #2: Map types</h3>\n\n<p>In case of maps we may consider an unnamed map type \"custom\" if any of its key or value type is \"custom\".</p>\n\n<p>The value type of a map can be queried with the above mentioned <code>Type.Elem()</code> method, and the key type of a map can be queried with the <code>Type.Key()</code> method - we also have to check this in case of maps.</p>\n\n<h2>Example implementation</h2>\n\n<pre><code>func isCustom(t reflect.Type) bool {\n    if t.PkgPath() != \"\" {\n        return true\n    }\n\n    if k := t.Kind(); k == reflect.Array || k == reflect.Chan || k == reflect.Map ||\n        k == reflect.Ptr || k == reflect.Slice {\n        return isCustom(t.Elem()) || k == reflect.Map &amp;&amp; isCustom(t.Key())\n    } else if k == reflect.Struct {\n        for i := t.NumField() - 1; i &gt;= 0; i-- {\n            if isCustom(t.Field(i).Type) {\n                return true\n            }\n        }\n    }\n\n    return false\n}\n</code></pre>\n\n<p>Testing it (try it on the <a href=\"https://play.golang.org/p/4k4FEf0RFy\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>type K int\nvar i int = 2\nfmt.Println(isCustom(reflect.TypeOf(\"\")))                // false\nfmt.Println(isCustom(reflect.TypeOf(int(2))))            // false\nfmt.Println(isCustom(reflect.TypeOf([]int{})))           // false\nfmt.Println(isCustom(reflect.TypeOf(struct{ i int }{}))) // false\nfmt.Println(isCustom(reflect.TypeOf(&amp;i)))                // false\nfmt.Println(isCustom(reflect.TypeOf(map[string]int{})))  // false\nfmt.Println(isCustom(reflect.TypeOf(A{})))               // true\nfmt.Println(isCustom(reflect.TypeOf(&amp;A{})))              // true\nfmt.Println(isCustom(reflect.TypeOf([]A{})))             // true\nfmt.Println(isCustom(reflect.TypeOf([][]A{})))           // true\nfmt.Println(isCustom(reflect.TypeOf(struct{ a A }{})))   // true\nfmt.Println(isCustom(reflect.TypeOf(map[K]int{})))       // true\nfmt.Println(isCustom(reflect.TypeOf(map[string]K{})))    // true\n</code></pre>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1983, "favorite_count": 3, "accepted_answer_id": 37292523, "answer_count": 1, "score": 10, "last_activity_date": 1471850651, "creation_date": 1459345066, "last_edit_date": 1471850651, "question_id": 36310538, "link": "https://stackoverflow.com/questions/36310538/identify-non-builtin-types-using-reflect", "title": "Identify non builtin-types using reflect", "body": "<p>I need to differentiate such types as</p>\n\n<pre><code>type A []byte\n</code></pre>\n\n<p>from a <code>[]byte</code>. Using <code>reflect</code>, <code>reflect.TypeOf(A{}).Kind</code> tells me that it is a <code>Slice</code> of <code>byte</code>. How can I differentiate <code>[]byte{}</code> from <code>A{}</code>, without having a bounded list of types to check for?</p>\n\n<p>Are there new ways to do it in newer versions of Go?</p>\n"}, {"tags": ["oop", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1459344164, "post_id": 36309866, "comment_id": 60243562, "body": "There is no inheritance in Go. Some related / possible duplicates: <a href=\"http://stackoverflow.com/questions/21251242/is-it-possible-to-call-overridden-method-from-parent-struct-in-golang\">one</a>, <a href=\"http://stackoverflow.com/questions/30622605/can-embedded-struct-method-have-knowledge-of-parent-child\">two</a>, <a href=\"http://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method\">three</a>, <a href=\"http://stackoverflow.com/questions/29144622/what-is-the-idiomatic-way-in-go-to-create-a-complex-hierarchy-of-structs\">four</a>"}, {"owner": {"reputation": 119, "user_id": 5083152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54baa37686a11a6b706ea0736fa0303?s=128&d=identicon&r=PG", "display_name": "co11ter", "link": "https://stackoverflow.com/users/5083152/co11ter"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459410737, "post_id": 36309866, "comment_id": 60277046, "body": "The question what to replace it with?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459410965, "post_id": 36309866, "comment_id": 60277201, "body": "Please read through all the linked questions+answers, they should give you some ideas."}, {"owner": {"reputation": 119, "user_id": 5083152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54baa37686a11a6b706ea0736fa0303?s=128&d=identicon&r=PG", "display_name": "co11ter", "link": "https://stackoverflow.com/users/5083152/co11ter"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459411432, "post_id": 36309866, "comment_id": 60277506, "body": "I read it, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 5083152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54baa37686a11a6b706ea0736fa0303?s=128&d=identicon&r=PG", "display_name": "co11ter", "link": "https://stackoverflow.com/users/5083152/co11ter"}, "edited": false, "score": 0, "creation_date": 1459346074, "post_id": 36310208, "comment_id": 60245169, "body": "But i can&#39;t use it like <code>MyChildInstance.JustPrint()</code>, only <code>JustPrint(MyChildInstance)</code>..."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1459345102, "last_edit_date": 1459345102, "creation_date": 1459344254, "answer_id": 36310208, "question_id": 36309866, "link": "https://stackoverflow.com/questions/36309866/go-oop-realization/36310208#36310208", "title": "Go OOP realization", "body": "<pre><code>//It's called interface\ntype Parent interface{\n    doSomething() string\n}\n//Use interface before defining implementation\nfunc JustPrint(p Parent){\n    fmt.Println(p.doSomething())\n}\n//Define MyChild\ntype MyChild SomeType\n//You do not have to implement interface explicitly\n//Just to define method needed would be enough\nfunc (mc MyChild) doSomething() string{\n    return \"Test\"\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 3, "last_activity_date": 1459353259, "creation_date": 1459353259, "answer_id": 36313912, "question_id": 36309866, "link": "https://stackoverflow.com/questions/36309866/go-oop-realization/36313912#36313912", "title": "Go OOP realization", "body": "<p>As @icza said, there's no inheritance in Go (which is a sweet spot). The closest would be embedding a Parent's type.</p>\n\n<pre><code>type Parent struct {}\nfunc (p *Parent) doSomething() {\n    fmt.Println(\"Test\")\n}\n\ntype MyChild struct {\n    Parent\n}\n\nfunc main() {\n    child := &amp;MyChild{}\n    child.doSomething() // print \"Test\"\n}\n</code></pre>\n\n<p>Check out <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#embedding</a></p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 5960551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194f7a699056272e814acac336a3ed2b?s=128&d=identicon&r=PG", "display_name": "carlosdavidepto", "link": "https://stackoverflow.com/users/5960551/carlosdavidepto"}, "is_accepted": false, "score": 1, "last_activity_date": 1459470040, "creation_date": 1459470040, "answer_id": 36346010, "question_id": 36309866, "link": "https://stackoverflow.com/questions/36309866/go-oop-realization/36346010#36346010", "title": "Go OOP realization", "body": "<p>I believe what you are trying to accomplish, in the end, is something akin to the \"Template method\" design pattern: </p>\n\n<blockquote>\n  <p>In software engineering, the template method pattern is a behavioral\n  design pattern that defines the program skeleton of an algorithm in a\n  method, called template method, which defers some steps to subclasses.</p>\n</blockquote>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Template_method_pattern\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Template_method_pattern</a></p>\n\n<p>AFAIK, the only correct way to achieve something like this in Go is to use interfaces as @pie-o-pah and @icza have said. I say \"something like\", because you cannot define methods with interfaces as receivers (i.e. there is no such thing as partially abstract type in Go).</p>\n\n<p>A correct implementation would look like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n// --------------------------\n\n// define your purely abstract type as an interface\ntype MyParent interface {\n    doSomething() string\n}\n\n// define a function (your template method) which operates\n// on that interface; an interface cannot be a function receiver,\n// but it can always be a parameter\nfunc internal(m MyParent) string {\n    return m.doSomething()\n}\n\n// define the implementation\ntype MyChild struct {}\n\n// implement the methods for the interface\nfunc (m *MyChild) doSomething() string {\n    return \"Test\"\n}\n\n// in Go any type which implements all methods in a given interface\n// implements that interface implicitly, but you can \"force\" the\n// compiler to check that for you using the following trick\n// (basically try to assign a an instance of the interface to a variable,\n// then discard it)\nvar _ MyParent = (*MyChild)(nil)\n\n// -------------------------------\n\n// test code\nfunc main() {\n  m := &amp;MyChild{}\n  fmt.Println(m.doSomething())\n  fmt.Println(internal(m))\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 5083152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54baa37686a11a6b706ea0736fa0303?s=128&d=identicon&r=PG", "display_name": "co11ter", "link": "https://stackoverflow.com/users/5083152/co11ter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1459896189, "creation_date": 1459343411, "last_edit_date": 1459896189, "question_id": 36309866, "link": "https://stackoverflow.com/questions/36309866/go-oop-realization", "title": "Go OOP realization", "body": "<p>How should this code snippet look like in Go? How can I access to method of child class from parent class when child class is not defined yet?</p>\n\n<pre><code>class Parent {\n\nabstract class MyParent {\n   abstract function doSomething();\n\n   function internal() {\n       return static::doSomething();\n   }\n}\n\nclass MyChild extends MyParent {\n   function doSomething() {\n       return 'Test';\n   }\n}\n</code></pre>\n"}, {"tags": ["arrays", "go", "initialization", "slice"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1459325991, "post_id": 36302441, "comment_id": 60230496, "body": "Ok, so spare arrays. Has anybody used/seen this in the wild? Seems like a good thing on paper, but not in practice (except for pub quizzes of course)."}], "answers": [{"comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1459325884, "post_id": 36302603, "comment_id": 60230438, "body": "You were first, but I will accept icza&#39;s answer since it is more comprehensive. You have my upvote though."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1459328571, "post_id": 36302603, "comment_id": 60232125, "body": "@RickyA it&#39;s cool, icza&#39;s answers are always comprehensive and educational, and indeed he gave a much better answer."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 3, "last_activity_date": 1459323820, "creation_date": 1459323820, "answer_id": 36302603, "question_id": 36302441, "link": "https://stackoverflow.com/questions/36302441/keyed-items-in-golang-array-initialization/36302603#36302603", "title": "Keyed items in golang array initialization", "body": "<p>If your array indices are sparse, it's shorter than doing <code>{1,0,0,0,0,2,0,0,0,0,3}</code> etc, and it's shorter than multiple assignment lines, so I'm guessing that's the use case. </p>\n\n<p>I've never seen this syntax used before anywhere.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1459330298, "last_edit_date": 1592644375, "creation_date": 1459324657, "answer_id": 36302875, "question_id": 36302441, "link": "https://stackoverflow.com/questions/36302441/keyed-items-in-golang-array-initialization/36302875#36302875", "title": "Keyed items in golang array initialization", "body": "<p>In <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literals</a> the key (index in case of array and slice literals) can be optionally provided.</p>\n<blockquote>\n<p>For array and slice literals the following rules apply:</p>\n<ul>\n<li>Each element has an associated integer index marking its position in the array.</li>\n<li>An element with a key uses the key as its index; the key must be a constant integer expression.</li>\n<li>An element without a key uses the previous element's index plus one. If the first element has no key, its index is zero.</li>\n</ul>\n</blockquote>\n<p>Elements get the zero value of the element type whose value is not specified.</p>\n<p>You can use this to:</p>\n<ul>\n<li><p>more compactly initialize arrays and slices if the array/slice has many zero values and just a few non-zero values</p>\n</li>\n<li><p>skip (&quot;jump over&quot;) contiguous parts when enumerating elements, and the skipped elements will be initialized with the zero values</p>\n</li>\n<li><p>specify the first couple of elements, and still specify the length (max index + 1) you want the array/slice to have:</p>\n<pre><code>  a := []int{10, 20, 30, 99:0} // Specify first 3 elements and set length to 100\n</code></pre>\n</li>\n</ul>\n<p>The spec also contains an example: create an array which tells if a character is a vowel. This is a very compact and talkative way to initialize the array:</p>\n<pre><code>// vowels[ch] is true if ch is a vowel\nvowels := [128]bool{'a': true, 'e': true, 'i': true, 'o': true, 'u': true, 'y': true}\n</code></pre>\n<p>Another example: let's create a slice which tells if a day is weekend; Monday being 0, Tuesday being 1, ... and Sunday being 6:</p>\n<pre><code>weekend := []bool{5: true, 6: true} // The rest will be false\n</code></pre>\n<p>Or even better, you can even omit the 2nd index (<code>6</code>) as it will be implicitly <code>6</code> (previous +1):</p>\n<pre><code>weekend := []bool{5: true, true} // The rest will be false\n</code></pre>\n"}], "owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1799, "favorite_count": 2, "accepted_answer_id": 36302875, "answer_count": 2, "score": 5, "last_activity_date": 1459348075, "creation_date": 1459323310, "last_edit_date": 1459348075, "question_id": 36302441, "link": "https://stackoverflow.com/questions/36302441/keyed-items-in-golang-array-initialization", "title": "Keyed items in golang array initialization", "body": "<p>In a <a href=\"https://twitter.com/davecheney/status/508076305003196416\" rel=\"nofollow\">pub quiz</a> by Dave Cheney I came across the following construct:</p>\n\n<pre><code>a := [...]int{5, 4: 1, 0, 2: 3, 2, 1: 4}\nfmt.Println(a)\n\n&gt;&gt; [5 4 3 2 1 0]\n</code></pre>\n\n<p>(<a href=\"http://play.golang.org/p/ibk35Rb-UW\" rel=\"nofollow\">Playground Link</a>)</p>\n\n<p>It seems you can use keys in the initialization fields of an array (<code>4: 1, 0</code> means set element at index 4 to 1, element at index 5 to 0). I have never seen something like this before. What is its use case? Why not set the particular index directly?</p>\n"}, {"tags": ["string", "go", "writer"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 3, "creation_date": 1459328007, "post_id": 36302351, "comment_id": 60231741, "body": "Why don&#39;t use fmt.Sprintf()?"}], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1459323341, "post_id": 36302391, "comment_id": 60228929, "body": "Could you give me an example of how I could use a variable with a type of string in the function fmt.Fprintf() please. :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 81, "last_activity_date": 1521451742, "last_edit_date": 1521451742, "creation_date": 1459323203, "answer_id": 36302391, "question_id": 36302351, "link": "https://stackoverflow.com/questions/36302351/golang-convert-string-to-io-writer/36302391#36302391", "title": "Golang Convert String to io.Writer?", "body": "<p>You can't write into a <code>string</code>, <code>string</code>s in Go are immutable.</p>\n\n<p>The best alternatives are the <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"noreferrer\"><code>bytes.Buffer</code></a> and since Go 1.10 the faster <a href=\"https://golang.org/pkg/strings/#Builder\" rel=\"noreferrer\"><code>strings.Builder</code></a> types: they implement <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"noreferrer\"><code>io.Writer</code></a> so you can write into them, and you can obtain their content as a <code>string</code> with <a href=\"https://golang.org/pkg/bytes/#Buffer.String\" rel=\"noreferrer\"><code>Buffer.String()</code></a> and <a href=\"https://golang.org/pkg/strings/#Builder.String\" rel=\"noreferrer\"><code>Builder.String()</code></a>, or as a byte slice with <a href=\"https://golang.org/pkg/bytes/#Buffer.Bytes\" rel=\"noreferrer\"><code>Buffer.Bytes()</code></a>.</p>\n\n<p>You can also have a <code>string</code> as the initial content of the buffer if you create the buffer with <a href=\"https://golang.org/pkg/bytes/#NewBufferString\" rel=\"noreferrer\"><code>bytes.NewBufferString()</code></a>:</p>\n\n<pre><code>s := \"Hello\"\nbuf := bytes.NewBufferString(s)\nfmt.Fprint(buf, \", World!\")\nfmt.Println(buf.String())\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/1t1WbejN0c\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Hello, World!\n</code></pre>\n\n<p>If you want to append a variable of type <code>string</code> (or any value of <code>string</code> type), you can simply use <a href=\"https://golang.org/pkg/bytes/#Buffer.WriteString\" rel=\"noreferrer\"><code>Buffer.WriteString()</code></a> (or <a href=\"https://golang.org/pkg/strings/#Builder.WriteString\" rel=\"noreferrer\"><code>Builder.WriteString()</code></a>):</p>\n\n<pre><code>s2 := \"to be appended\"\nbuf.WriteString(s2)\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>fmt.Fprint(buf, s2)\n</code></pre>\n\n<p>Also note that if you just want to concatenate 2 <code>string</code>s, you don't need to create a buffer and use <a href=\"https://golang.org/pkg/fmt/#Fprintf\" rel=\"noreferrer\"><code>fmt.Fprintf()</code></a>, you can simply use the <code>+</code> operator to concatenate them:</p>\n\n<pre><code>s := \"Hello\"\ns2 := \", World!\"\n\ns3 := s + s2  // \"Hello, World!\"\n</code></pre>\n\n<p>Also see: <a href=\"https://stackoverflow.com/questions/11123865/golang-format-a-string-without-printing/31742265#31742265\">Golang: format a string without printing?</a></p>\n\n<p>It may also be of interest: <a href=\"https://stackoverflow.com/questions/37863374/whats-the-difference-between-responsewriter-write-and-io-writestring/37872799#37872799\">What&#39;s the difference between ResponseWriter.Write and io.WriteString?</a></p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 6543306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wZ1eYjiIBF0/AAAAAAAAAAI/AAAAAAAAIAI/wZQES45k9xA/photo.jpg?sz=128", "display_name": "Sidharth J", "link": "https://stackoverflow.com/users/6543306/sidharth-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1565728489, "creation_date": 1565728489, "answer_id": 57484965, "question_id": 36302351, "link": "https://stackoverflow.com/questions/36302351/golang-convert-string-to-io-writer/57484965#57484965", "title": "Golang Convert String to io.Writer?", "body": "<p>Use <code>bytes.Buffer</code> which implements the <code>Write()</code> method.</p>\n\n<pre><code>import \"bytes\"\n\nwriter := bytes.NewBufferString(\"your string\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 1, "last_activity_date": 1619199740, "last_edit_date": 1619199740, "creation_date": 1617387083, "answer_id": 66923505, "question_id": 36302351, "link": "https://stackoverflow.com/questions/36302351/golang-convert-string-to-io-writer/66923505#66923505", "title": "Golang Convert String to io.Writer?", "body": "<p>I saw the other answer mention <code>strings.Builder</code>, but I didnt see an example. So\nhere you go:</p>\n<pre><code>package main\n\nimport (\n   &quot;fmt&quot;\n   &quot;strings&quot;\n)\n\nfunc main() {\n   b := new(strings.Builder)\n   fmt.Fprint(b, &quot;south north&quot;)\n   println(b.String())\n}\n</code></pre>\n<p><a href=\"https://golang.org/pkg/strings#Builder\" rel=\"nofollow noreferrer\">https://golang.org/pkg/strings#Builder</a></p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44627, "favorite_count": 12, "accepted_answer_id": 36302391, "answer_count": 3, "score": 39, "last_activity_date": 1619199740, "creation_date": 1459323061, "last_edit_date": 1486559600, "question_id": 36302351, "link": "https://stackoverflow.com/questions/36302351/golang-convert-string-to-io-writer", "title": "Golang Convert String to io.Writer?", "body": "<p>Is it possible to convert a <code>string</code> to an <code>io.Writer</code> type in Golang?</p>\n\n<p>I will be using this string in <code>fmt.Fprintf()</code> but I am unable to convert the type.</p>\n"}, {"tags": ["go", "yacc", "backwards-compatibility"], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1459334471, "post_id": 36303971, "comment_id": 60236430, "body": "I tried your solution. But it didn&#39;t work. What I really wanted is yyVAL.some_x. When I tried your solution like $$VAL.some_x, it was replaced as yyVAL.some_type_of_nonterminal.some_x(in generated y.go). But some_x is a field in yyVAL. [some_type_of_nonterminal is the type of non terminal for which I have written a rule and used the mentioned expression(yyVAL.some_x) in the action block."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1459339972, "post_id": 36303971, "comment_id": 60240293, "body": "What I meant to say is that after reading the code I think we&#39;re supposed to use <code>yyVAL</code> (which in the source code is represnted as <code>$$VAL</code>). Not <code>$$VAL</code> or <code>yylval</code> directly."}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1459408801, "post_id": 36303971, "comment_id": 60275800, "body": "So, you mean that the variable yylval in yacc file has to be changed to yyVAL for Go 1.6. If that is what you mean, please mention your say about this promise &#39;<a href=\"https://golang.org/doc/go1compat\" rel=\"nofollow noreferrer\">golang.org/doc/go1compat</a>&#39;."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 0, "last_activity_date": 1459418888, "last_edit_date": 1459418888, "creation_date": 1459327904, "answer_id": 36303971, "question_id": 36301637, "link": "https://stackoverflow.com/questions/36301637/backward-compatibility-for-yacc-in-go-1-5-and-1-6/36303971#36303971", "title": "backward compatibility for yacc in Go 1.5 and 1.6", "body": "<p>You are most probably seeing the changes made in <a href=\"https://github.com/golang/go/commit/adf4c38b6ec08bcdeed09cdc733fa6014f0500c9\" rel=\"nofollow\">this commit</a>. But according to the code you were supposed to be using <code>$$VAL</code> (i.e. <code>yyVAL</code>) all along. In Go 1.6 the same value should be accessible through <code>$$rcvr.lval</code> as well.</p>\n\n<p>Anywho, glad you solved it.</p>\n\n<p>Edit:</p>\n\n<p>To clarify, I <em>presume</em> that even in Go 1.5 or lower we were supposed to use <code>yyVAL</code> and not <code>yylval</code>. In consequence, I am implying that the documentation you linked in your question is probably wrong and the bug lays there. However you are 100% correct that if this is not the case, then the Go 1 promise was broken and it should be rectified.</p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459418888, "creation_date": 1459320651, "question_id": 36301637, "link": "https://stackoverflow.com/questions/36301637/backward-compatibility-for-yacc-in-go-1-5-and-1-6", "title": "backward compatibility for yacc in Go 1.5 and 1.6", "body": "<blockquote>\n  <p>Lex should return the token identifier, and place other token\n  information in lval (which replaces the usual yylval).</p>\n</blockquote>\n\n<p>The above text taken from the go <a href=\"https://golang.org/cmd/yacc/\" rel=\"nofollow\">document.</a></p>\n\n<p>I used the variable(yylval) in the action part of grammar rules in the yacc file(some.y file). The code worked in Go 1.5. But the same code didn't compile in Go 1.6. When I checked the generated y.go file(from the 'go yacc tool some.y' command), Go creates different variable names in different version.</p>\n\n<pre><code>var yylval yySymType //in G0 1.5\nvar yyVAL yySymType //in Go 1.6\n</code></pre>\n\n<p>Is this against backward compatibility? or Go doesn't guarantee backward compatibility for the variable? or Is usage of yylval variable is wrong?</p>\n\n<p>Code worked well after replacing the varibale name yylval with yyVAL.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1459319155, "post_id": 36301123, "comment_id": 60226616, "body": "You showed your <code>go env</code> with some user, then you do <code>go get</code> with another user (<code>sudo -E go get</code>) which might have different <code>go env</code>."}, {"owner": {"reputation": 1, "user_id": 4409495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d61eb69dab0d55fb109a87d623c5a6?s=128&d=identicon&r=PG", "display_name": "Purandar", "link": "https://stackoverflow.com/users/4409495/purandar"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459351168, "post_id": 36301123, "comment_id": 60249375, "body": "Thanks @icza for quick response."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4409495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d61eb69dab0d55fb109a87d623c5a6?s=128&d=identicon&r=PG", "display_name": "Purandar", "link": "https://stackoverflow.com/users/4409495/purandar"}, "edited": false, "score": 0, "creation_date": 1459351084, "post_id": 36310154, "comment_id": 60249305, "body": "Thanks @Hugo.  I was able to solve this without having to use sudo, so that it run go get as stack user.  Earlier I was having permission issue thats the reason I used sudo -E to preserve environment variables, but that changes the user to root with env preserved as you guys mentioned.  I changed the ownership of folder pointed by GOPATH to stack and it worked fine."}], "tags": [], "owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "is_accepted": false, "score": 0, "last_activity_date": 1459344129, "last_edit_date": 1492086987, "creation_date": 1459344129, "answer_id": 36310154, "question_id": 36301123, "link": "https://stackoverflow.com/questions/36301123/unable-to-get-go-package-installed/36310154#36310154", "title": "Unable to get go package installed", "body": "<p><code>sudo -E</code> changes you to root and preserves the environment variables. In this case, these are the env variables of the shell and not of <code>go</code>.</p>\n\n<p>You can read more about how sudo -E works <a href=\"https://unix.stackexchange.com/questions/178303/how-does-sudo-e-work-here\">here</a></p>\n\n<p>Since your <code>GOTOOLDIR=\"/home/stack/go/pkg/tool/linux_amd64\"</code> shows that it is installed for the user <code>stack</code> (probably) - you have to use <code>go get</code> as user <code>stack</code></p>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 0, "last_activity_date": 1459354039, "creation_date": 1459354039, "answer_id": 36314163, "question_id": 36301123, "link": "https://stackoverflow.com/questions/36301123/unable-to-get-go-package-installed/36314163#36314163", "title": "Unable to get go package installed", "body": "<p><a href=\"https://github.com/tools/godep\" rel=\"nofollow\">Godep and vendor</a> is worth looking into. Just like package managers like npm and pip, working with dependencies within the project directory prevent you from version clashes and avoid using <code>$GOPATH</code>.</p>\n\n<p>A simpler alternative is <a href=\"https://glide.sh/\" rel=\"nofollow\">Glide</a>. It greatly simplifies dependency management and works very similar to <code>Godep</code> with <code>glide.yaml</code> and <code>glide.lock</code> files to control dependencies and their versions instead of <code>Godep.json</code>.</p>\n\n<p>If you've worked with <code>npm</code> or <code>cargo</code>, it's very similar:</p>\n\n<pre><code># Create manifest\n$ glide init\n\n# Get packages\n$ glide get path/to/package\n\n# Update package\n$ glide update\n\n# Remove package\n$ glide remove path/to/package\n</code></pre>\n\n<p>Packages are saved to <code>vendor/</code> just like Godep does (in default Go 1.6 any way).</p>\n"}], "owner": {"reputation": 1, "user_id": 4409495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d61eb69dab0d55fb109a87d623c5a6?s=128&d=identicon&r=PG", "display_name": "Purandar", "link": "https://stackoverflow.com/users/4409495/purandar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1459354039, "creation_date": 1459318756, "last_edit_date": 1459318844, "question_id": 36301123, "link": "https://stackoverflow.com/questions/36301123/unable-to-get-go-package-installed", "title": "Unable to get go package installed", "body": "<p>Go Environment:</p>\n\n<pre><code>$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/stack/mygo\"\nGORACE=\"\"\nGOROOT=\"/home/stack/go\"\nGOTOOLDIR=\"/home/stack/go/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Go version:</p>\n\n<pre><code>$ go version\ngo version go1.6 linux/amd64\n</code></pre>\n\n<p>Error while running:</p>\n\n<pre><code>$ sudo -E  go get -u golang.org/x/crypto/ssh\npackage golang.org/x/crypto/ssh\n    imports bufio: unrecognized import path \"bufio\"\npackage golang.org/x/crypto/ssh\n    imports bytes: unrecognized import path \"bytes\"\npackage golang.org/x/crypto/ssh\n    imports crypto: unrecognized import path \"crypto\"\npackage golang.org/x/crypto/ssh\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1459346647, "post_id": 36300515, "comment_id": 60245702, "body": "are you using linux or windows?"}, {"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "reply_to_user": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1459351168, "post_id": 36300515, "comment_id": 60249374, "body": "@codefreak I am using Linux."}, {"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 1, "creation_date": 1459417040, "post_id": 36300515, "comment_id": 60281368, "body": "You can use a linux cmd utility for doc 2 pdf see <a href=\"http://stackoverflow.com/questions/21203626/is-there-any-gnu-linux-command-line-utility-that-converts-docx-files-to-pdf\" title=\"is there any gnu linux command line utility that converts docx files to pdf\">stackoverflow.com/questions/21203626/&hellip;</a>. Once installed and working, you can call that utility by executing os.Exec function."}], "answers": [{"comments": [{"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1459351238, "post_id": 36310261, "comment_id": 60249430, "body": "Thanks. But I am using Linux. Any other options?"}], "tags": [], "owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "is_accepted": false, "score": 2, "last_activity_date": 1459344403, "creation_date": 1459344403, "answer_id": 36310261, "question_id": 36300515, "link": "https://stackoverflow.com/questions/36300515/golang-packages-for-doc-to-docx-and-docx-to-pdf-convertion/36310261#36310261", "title": "Golang packages for doc to docx and docx to pdf convertion?", "body": "<p>This will work over windows, as it is using the windows functions</p>\n\n<p><a href=\"https://github.com/piaobocpp/doc2pdf-go\" rel=\"nofollow\">https://github.com/piaobocpp/doc2pdf-go</a></p>\n"}, {"comments": [{"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1459485908, "post_id": 36333165, "comment_id": 60317466, "body": "If you are not using Libreoffice then arg0 may change accordingly. For example, <b>oowriter</b> or <b>sowriter</b> for OpenOffice. Check <b>oowriter --help</b> in terminal for the invisibility command(Not sure about others having one.)."}, {"owner": {"reputation": 7356, "user_id": 4732175, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/w2Po6.jpg?s=128&g=1", "display_name": "Zhang Buzz", "link": "https://stackoverflow.com/users/4732175/zhang-buzz"}, "edited": false, "score": 0, "creation_date": 1544315140, "post_id": 36333165, "comment_id": 94233148, "body": "For arg0, I am using &quot;soffice&quot;, also, you may need to add arg4 and arg5 of &quot;--outdir&quot; in case you need to save file in other position."}, {"owner": {"reputation": 390, "user_id": 877341, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a076bac7b3c3c9d3c13e8e72bcc2dc8?s=128&d=identicon&r=PG", "display_name": "blackhawk4152", "link": "https://stackoverflow.com/users/877341/blackhawk4152"}, "edited": false, "score": 0, "creation_date": 1587062125, "post_id": 36333165, "comment_id": 108368955, "body": "On Fedora 31 it was <code>libreoffice</code> instead of lowriter"}], "tags": [], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "is_accepted": true, "score": 2, "last_activity_date": 1459485710, "last_edit_date": 1459485710, "creation_date": 1459426405, "answer_id": 36333165, "question_id": 36300515, "link": "https://stackoverflow.com/questions/36300515/golang-packages-for-doc-to-docx-and-docx-to-pdf-convertion/36333165#36333165", "title": "Golang packages for doc to docx and docx to pdf convertion?", "body": "<p>As I am using linux ubuntu OS Hugo's answer didn't help me(But I recommend it for the windows users). But it gave me an idea about how to solve this problem. codefreak's comment on the question gave me a clear picture. I used both of their advice and result was the use of LibreOffice for the convertion.</p>\n\n<pre><code>arg0 := \"lowriter\"\narg1 := \"--invisible\" //This command is optional, it will help to disable the splash screen of LibreOffice.\narg2 := \"--convert-to\"\narg3 := \"pdf:writer_pdf_Export\"\npath := \"/home/user/Test.docx\"\nnout, err := exec.Command(arg0,arg1,arg2,arg3,path).Output()\n</code></pre>\n\n<p>This code will call LibreOffice and convert .docx file into .pdf. This is the easiest method as far as I know. Please post other answers which may help future readers.</p>\n"}], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5456, "favorite_count": 0, "closed_date": 1460241810, "accepted_answer_id": 36333165, "answer_count": 2, "score": 2, "last_activity_date": 1459485710, "creation_date": 1459316259, "question_id": 36300515, "link": "https://stackoverflow.com/questions/36300515/golang-packages-for-doc-to-docx-and-docx-to-pdf-convertion", "closed_reason": "Not suitable for this site", "title": "Golang packages for doc to docx and docx to pdf convertion?", "body": "<p>I am writing a web application in Golang, in which user can upload a doc or docx file. Some of the file contents will be changed according to a predefined format. Later user can download the changed file either in docx or in pdf format. Now my application accepts only docx file, change the file according to predefined format and let the user download it back in docx format itself. Are there any packages available in golang to convert doc to docx and docx to pdf?</p>\n"}, {"tags": ["google-app-engine", "templates", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459321339, "post_id": 36299919, "comment_id": 60227752, "body": "This is a non-trivial problem to solve securely, but take a look at <a href=\"https://github.com/microcosm-cc/bluemonday\" rel=\"nofollow noreferrer\">github.com/microcosm-cc/bluemonday</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459321965, "post_id": 36299919, "comment_id": 60228090, "body": "Easier and more secure would be not to use HTML syntax for formatting, but some other syntax like wiki or phpBB, and convert that to HTML when you want to render it. Might be even easier/friendlier to the users."}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459313280, "creation_date": 1459313280, "question_id": 36299919, "link": "https://stackoverflow.com/questions/36299919/allowing-some-html-tags-from-user-input-using-html-template-in-go", "title": "Allowing some html tags from user input using html/template in Go", "body": "<p>I am using Go html/template package for rendering user inputs received from HTML form. As the package html/template is preventing script injection from user inputs, all the html tags will be converted into their &amp;...; formats.</p>\n\n<p>However, I am planning to use WYSIWYG input field which allows users to input some styling tags such as the &lt; strong > tag. I am using template function solution.</p>\n\n<pre><code>funcs := template.FuncMap{\n    \"marktag\": func(text string) template.HTML {\n        output := strings.Replace(template.HTMLEscapeString(text), \"&amp;lt;strong&amp;gt;\", \"&lt;strong&gt;\", -1)\n        output = strings.Replace(output, \"&amp;lt;/strong&amp;gt;\", \"&lt;/strong&gt;\", -1)\n        return template.HTML(output)\n    },\n}\n</code></pre>\n\n<p>Which works OK. However, I have to call strings.Replace(..) function many times if I need to convert the other tags too such as</p>\n\n<pre><code>&lt;ul&gt;&lt;li&gt;&lt;/li&gt;&lt;/ul&gt;\n&lt;emphasize&gt;&lt;/emphasize&gt;\n&lt;code&gt;&lt;/code&gt;\n</code></pre>\n\n<p>and so on</p>\n\n<p>Furhermore, I found it hard to deal with the css style like</p>\n\n<pre><code>&lt;p style=\"color: #343434\"&gt;&lt;/p&gt;\n</code></pre>\n\n<p>Now I have to check for </p>\n\n<pre><code>&lt;p\n</code></pre>\n\n<p>as well. Is there any ideal solution to this problem?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 851, "user_id": 4166289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f96b02abcdd3e36aec9eaa6cb8ba47b?s=128&d=identicon&r=PG&f=1", "display_name": "instantaphex", "link": "https://stackoverflow.com/users/4166289/instantaphex"}, "edited": false, "score": 0, "creation_date": 1459314335, "post_id": 36300055, "comment_id": 60224456, "body": "Thanks!  I wasn&#39;t sure how to check and handle that unmarshal."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1459313923, "creation_date": 1459313923, "answer_id": 36300055, "question_id": 36299902, "link": "https://stackoverflow.com/questions/36299902/golang-unmarshal-json-object-results-in-empty-map/36300055#36300055", "title": "Golang: Unmarshal JSON Object results in empty map", "body": "<p>Check and handle the error returned from <code>json.Unmarshal([]byte(buff), &amp;s)</code>.  You will find that there's an invalid character '{' after array element at offset 1685.</p>\n\n<p><a href=\"http://play.golang.org/p/xIIHcBOYzJ\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 851, "user_id": 4166289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f96b02abcdd3e36aec9eaa6cb8ba47b?s=128&d=identicon&r=PG&f=1", "display_name": "instantaphex", "link": "https://stackoverflow.com/users/4166289/instantaphex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "accepted_answer_id": 36300055, "answer_count": 1, "score": -1, "last_activity_date": 1459313935, "creation_date": 1459313181, "question_id": 36299902, "link": "https://stackoverflow.com/questions/36299902/golang-unmarshal-json-object-results-in-empty-map", "title": "Golang: Unmarshal JSON Object results in empty map", "body": "<p>I've been stuck trying to unmarshal a json object.  I am not getting any errors but I am getting an empty map afterwards.  I'm new to go so I'm still trying to wrap my head around some of the language constructs.  </p>\n\n<p>Here is what my data source looks like</p>\n\n<pre><code>{ \n    \"animationStates\": {\n        \"idle\": {\n            \"numFrames\": 4,\n            \"frames\": [\n                {\n                    \"frame\": {\"x\":43,\"y\":106,\"w\":12,\"h\":15},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":1,\"y\":143,\"w\":12,\"h\":14},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":71,\"y\":132,\"w\":12,\"h\":14},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":15,\"y\":126,\"w\":12,\"h\":15},\n                    \"rotated\": true \n                }\n            ]\n        },\n        \"run\": {\n            \"numFrames\": 10,\n            \"frames\": [\n                {\n                    \"frame\": {\"x\":73,\"y\":82,\"w\":12,\"h\":15},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":29,\"y\":125,\"w\":12,\"h\":15},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":33,\"y\":36,\"w\":12,\"h\":16},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":1,\"y\":107,\"w\":12,\"h\":16},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":1,\"y\":89,\"w\":12,\"h\":16},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":17,\"y\":54,\"w\":12,\"h\":16},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":1,\"y\":125,\"w\":12,\"h\":16},\n                    \"rotated\": false\n                }\n                {\n                    \"frame\": {\"x\":15,\"y\":143,\"w\":12,\"h\":14},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":29,\"y\":142,\"w\":12,\"h\":14},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":72,\"y\":99,\"w\":12,\"h\":15},\n                    \"rotated\": false\n                }\n            ]\n        },\n        \"roll\": {\n            \"numFrames\": 5,\n            \"frames\": [\n                {\n                    \"frame\": {\"x\":71,\"y\":116,\"w\":12,\"h\":14},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":71,\"y\":148,\"w\":12,\"h\":10},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":73,\"y\":47,\"w\":12,\"h\":15},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":57,\"y\":147,\"w\":12,\"h\":11},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":29,\"y\":108,\"w\":12,\"h\":15},\n                    \"rotated\": false\n                }\n            ]\n        },\n        \"jump\": {\n            \"numFrames\": 1,\n            \"frames\": [\n                {\n                    \"frame\": {\"x\":45,\"y\":54,\"w\":12,\"h\":16},\n                    \"rotated\": false\n                }\n            ]\n        },\n        \"fall\": {\n            \"numFrames\": 1,\n            \"frames\": [\n                {\n                    \"frame\": {\"x\":29,\"y\":90,\"w\":12,\"h\":16},\n                    \"rotated\": false\n                }\n            ]\n        },\n        \"shoot\": {\n            \"numFrames\": 5,\n            \"frames\": [\n                {\n                    \"frame\": {\"x\":37,\"y\":1,\"w\":14,\"h\":15},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":17,\"y\":37,\"w\":14,\"h\":15},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":1,\"y\":37,\"w\":14,\"h\":16},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":19,\"y\":19,\"w\":14,\"h\":15},\n                    \"rotated\": false\n                },\n                {\n                    \"frame\": {\"x\":1,\"y\":55,\"w\":14,\"h\":15},\n                    \"rotated\": false\n                }\n            ]\n        }\n    }\n}\n</code></pre>\n\n<p>and here is the code that I'm using to unmarshal</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"io/ioutil\"\n)\n\ntype AnimationFrame struct {\n    Frame struct {\n        X int `json:\"x\"`\n        Y int `json:\"y\"`\n        W int `json:\"w\"`\n        H int `json:\"h\"`\n    } `json:\"frame\"`\n    Rotated bool `json:\"rotated\"`\n}\n\ntype Animation struct {\n    NumFrames int `json:\"numFrames\"`\n    Frames []AnimationFrame `json:\"frames\"` \n} \n\ntype StateList struct {\n    Actions map[string]Animation `json:\"animationStates\"`\n}\n\nfunc NewAnimation (file string) *StateList {\n    list := make(map[string]Animation)\n    s := &amp;StateList{list}\n    buff, err := ioutil.ReadFile(file)\n    check(err)\n    json.Unmarshal([]byte(buff), &amp;s)\n    return s \n}\n\nfunc check (e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n</code></pre>\n\n<p>Does anyone see what I'm doing wrong?  Thanks.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 7, "last_activity_date": 1459313729, "creation_date": 1459313729, "answer_id": 36300006, "question_id": 36299867, "link": "https://stackoverflow.com/questions/36299867/golang-best-way-to-unmarshal-following-json-with-string-as-keys/36300006#36300006", "title": "Golang : best way to unmarshal following json with string as keys", "body": "<p>I would make the <code>locations</code> a map (although you have it called <code>cities</code> in the JSON):</p>\n\n<pre><code>type MyJsonName struct {\n        APIName   string `json:\"api_name\"`\n        APIType   string `json:\"api_type\"`\n        Locations map[string]struct {\n                Lat  string\n                Long string\n        } `json:\"locations\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 2792, "user_id": 140029, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1eed6228fb31fa03d86809e7794b8ef3?s=128&d=identicon&r=PG", "display_name": "Pankaj Khairnar", "link": "https://stackoverflow.com/users/140029/pankaj-khairnar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 36300006, "answer_count": 1, "score": 1, "last_activity_date": 1459355542, "creation_date": 1459313003, "last_edit_date": 1459355542, "question_id": 36299867, "link": "https://stackoverflow.com/questions/36299867/golang-best-way-to-unmarshal-following-json-with-string-as-keys", "title": "Golang : best way to unmarshal following json with string as keys", "body": "<p>I have json like </p>\n\n<pre><code>{\n  \"api_type\" : \"abc\",\n  \"api_name\" : \"xyz\",\n  \"cities\" : {\n    \"new_york\" : {\n        \"lat\":\"40.730610\",\n        \"long\":\"-73.935242\"\n    },\n    \"london\" : {\n        \"lat\":\"51.508530\",\n        \"long\":\"-0.076132\"\n    },\n    \"amsterdam\" : {\n        \"lat\":\"52.379189\",\n        \"long\":\"4.899431\"\n    }\n\n    //cities can be multiple\n  }\n}\n</code></pre>\n\n<p>I can use following struct to unmarshal </p>\n\n<pre><code>type MyJsonName struct {\n    APIName   string `json:\"api_name\"`\n    APIType   string `json:\"api_type\"`\n    Locations struct {\n        Amsterdam struct {\n            Lat  string `json:\"lat\"`\n            Long string `json:\"long\"`\n        } `json:\"amsterdam\"`\n        London struct {\n            Lat  string `json:\"lat\"`\n            Long string `json:\"long\"`\n        } `json:\"london\"`\n        NewYork struct {\n            Lat  string `json:\"lat\"`\n            Long string `json:\"long\"`\n        } `json:\"new_york\"`\n    } `json:\"locations\"`\n}\n</code></pre>\n\n<p>but my city names and numbers will be different in each response, what is a best way unmarshal this type of json where keys can be string which varies. </p>\n"}, {"tags": ["bash", "go", "environment-variables", "ubuntu-14.04", ".profile"], "comments": [{"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1459310411, "post_id": 36299375, "comment_id": 60223127, "body": "<a href=\"http://stackoverflow.com/a/21012349/2020002\">stackoverflow.com/a/21012349/2020002</a> worked for me, have you tried it?"}, {"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 2, "creation_date": 1459310555, "post_id": 36299375, "comment_id": 60223169, "body": "And I would suggest removing <code>GOROOT</code>"}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "reply_to_user": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1459310918, "post_id": 36299375, "comment_id": 60223286, "body": "@OliverQueen , doesn&#39;t work in my case, gives me the following error ( go: cannot find GOROOT directory: /usr/lib/go )"}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "reply_to_user": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1459310956, "post_id": 36299375, "comment_id": 60223295, "body": "@OliverQueen I tried it both the ways, leaving the GoRoot, and removing it."}, {"owner": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1459310985, "post_id": 36299375, "comment_id": 60223304, "body": "did you restart the terminal after removing GOROOT?"}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "reply_to_user": {"reputation": 6198, "user_id": 2020002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t9iFY.jpg?s=128&g=1", "display_name": "Derek Pollard", "link": "https://stackoverflow.com/users/2020002/derek-pollard"}, "edited": false, "score": 0, "creation_date": 1459311145, "post_id": 36299375, "comment_id": 60223345, "body": "@OliverQueen, yes, I even restarted the computer."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 1, "creation_date": 1459311174, "post_id": 36299375, "comment_id": 60223358, "body": "Can you show the output of the command <code>go env</code> and <code>go version</code>?"}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459311768, "post_id": 36299375, "comment_id": 60223547, "body": "I&#39;m gonna edit the question with the information."}], "answers": [{"comments": [{"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 1, "creation_date": 1459311474, "post_id": 36299472, "comment_id": 60223446, "body": "When I remove $GOROOT variable it gives me the following error  ( go: cannot find GOROOT directory: /usr/lib/go )"}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459311539, "post_id": 36299472, "comment_id": 60223471, "body": "I have installed it to the default location /usr/local/go, as suggested by golang.org"}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459311596, "post_id": 36299472, "comment_id": 60223492, "body": "I removed the previous installation of go and all of its variables from the .profile and .bashrc, than installed the new one to usr/local/go and set the variables as said in the question"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459311657, "post_id": 36299472, "comment_id": 60223507, "body": "@Bangash : Provide the output of <code>go env</code> or nobody will be able to help you."}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459311795, "post_id": 36299472, "comment_id": 60223554, "body": "yes, I&#39;m gonna edit the question with the go env&#39;s output."}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459312328, "post_id": 36299472, "comment_id": 60223726, "body": "I edited the question, would you please look at it again."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459312804, "post_id": 36299472, "comment_id": 60223884, "body": "ah.. what is the output of <code>type go</code>?"}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459312953, "post_id": 36299472, "comment_id": 60223935, "body": "Its ( go is hashed (/usr/bin/go) )"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459313003, "post_id": 36299472, "comment_id": 60223951, "body": "so, you need to fix your PATH so that /usr/local/go/bin appears before /usr/bin, or you need to remove the go in /usr/bin"}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459313195, "post_id": 36299472, "comment_id": 60224020, "body": "Which of these files should I delete ? (its a screenshot from /usr/bin) <a href=\"http://i.imgur.com/Vhhs3zf.png?1\" rel=\"nofollow noreferrer\">i.imgur.com/Vhhs3zf.png?1</a>"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459313348, "post_id": 36299472, "comment_id": 60224087, "body": "<code>go</code>  that&#39;s the only one."}, {"owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459313444, "post_id": 36299472, "comment_id": 60224116, "body": "The shortcut / link ?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "edited": false, "score": 0, "creation_date": 1459313465, "post_id": 36299472, "comment_id": 60224121, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/107681/discussion-between-john-weldon-and-bangash\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 4, "last_activity_date": 1459323832, "last_edit_date": 1459323832, "creation_date": 1459310681, "answer_id": 36299472, "question_id": 36299375, "link": "https://stackoverflow.com/questions/36299375/how-do-i-fix-my-goroot-and-gopath-variables-to-run-go/36299472#36299472", "title": "How do I fix my GOROOT and GOPATH variables to run go?", "body": "<p>You should generally never have to set <code>$GOROOT</code> unless you know why you're setting it.</p>\n\n<p>This assumes a 'normal' installation of Go.  If you've moved the go binary around, or deleted pkg or src folders, your mileage may vary.</p>\n\n<p>Also, make sure an older version of go is not found in your $PATH before the version you intend to use.</p>\n\n<p>In this case @Bangash had to delete the old /usr/bin/go and add /usr/local/go/bin to his PATH environment variable.</p>\n\n<p><a href=\"https://golang.org/doc/install/source#environment\" rel=\"nofollow\">Usually people use $GOROOT</a> when switching between multiple versions of go.</p>\n\n<p>Please read comments as well as chat for the solution.</p>\n"}], "owner": {"reputation": 1102, "user_id": 1954881, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9Wpxg.jpg?s=128&g=1", "display_name": "Bangash", "link": "https://stackoverflow.com/users/1954881/bangash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14627, "favorite_count": 1, "accepted_answer_id": 36299472, "answer_count": 1, "score": 3, "last_activity_date": 1459323832, "creation_date": 1459310127, "last_edit_date": 1459312766, "question_id": 36299375, "link": "https://stackoverflow.com/questions/36299375/how-do-i-fix-my-goroot-and-gopath-variables-to-run-go", "title": "How do I fix my GOROOT and GOPATH variables to run go?", "body": "<h2>Operating system: Ubuntu 14.04</h2>\n\n<h2>lines in the .bashrc (tried both of the following)</h2>\n\n<pre><code># GoPath (without goroot)\nexport GOPATH=$HOME/gowork\n</code></pre>\n\n<p>...</p>\n\n<pre><code># GoPath (with goroot)\nexport GOROOT=/usr/local/go\nexport GOPATH=$HOME/gowork\n</code></pre>\n\n<p>Note: I tried to set the above environment variables, first in .profile and then in .bashrc as suggested by different people in a different way.</p>\n\n<h2>Tried to run the following code</h2>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello World!\")\n}\n</code></pre>\n\n<h2>Error message in the terminal</h2>\n\n<pre><code>go run helloworld.go \nhelloworld.go:3:8: cannot find package \"fmt\" in any of:\n    /usr/local/go/src/pkg/fmt (from $GOROOT)\n    /home/arif/gowork/src/fmt (from $GOPATH)\npackage runtime: cannot find package \"runtime\" in any of:\n    /usr/local/go/src/pkg/runtime (from $GOROOT)\n    /home/arif/gowork/src/runtime (from $GOPATH)\n</code></pre>\n\n<h1>edit</h1>\n\n<h2>go env output</h2>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/arif/gowork\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<h2>go version output</h2>\n\n<pre><code>go version go1.3.3 linux/amd64\n</code></pre>\n\n<h1>A hint</h1>\n\n<p>I remember that the tar I installed from was go1.6.linux-amd64.tar.gz, which means the go version 1.6 should be shown but my terminal is outputting 1.3.3.</p>\n"}, {"tags": ["database", "go", "boltdb"], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "edited": false, "score": 0, "creation_date": 1459351959, "post_id": 36299675, "comment_id": 60250073, "body": "Thank you so much!"}, {"owner": {"reputation": 375, "user_id": 97394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c76488dff9b5d9a872dff88f008f88e?s=128&d=identicon&r=PG", "display_name": "Ben Johnson", "link": "https://stackoverflow.com/users/97394/ben-johnson"}, "edited": false, "score": 1, "creation_date": 1459462270, "post_id": 36299675, "comment_id": 60311197, "body": "You may want to add a *bolt.DB variable to an http.Handler implementation instead of a global variable so you can test it easier (and in parallel)."}, {"owner": {"reputation": 375, "user_id": 97394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c76488dff9b5d9a872dff88f008f88e?s=128&d=identicon&r=PG", "display_name": "Ben Johnson", "link": "https://stackoverflow.com/users/97394/ben-johnson"}, "edited": false, "score": 2, "creation_date": 1459462385, "post_id": 36299675, "comment_id": 60311239, "body": "Also, it can handle high parallel read concurrency great but writes will be serialized. As long as your 1000 requests aren&#39;t all doing writes (or they&#39;re doing small writes) you should be fine."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 6, "last_activity_date": 1459311879, "creation_date": 1459311879, "answer_id": 36299675, "question_id": 36298925, "link": "https://stackoverflow.com/questions/36298925/boltdb-performance-as-a-backend-db/36299675#36299675", "title": "BoltDB performance as a backend DB", "body": "<p>A1. Yes, we use it with way more than 1000 concurrent connections.</p>\n\n<p>A2. Yes, bolt is thread safe, when you call db.Update, it will lock the database, so you know you data will always be consistent.</p>\n\n<p>Also a hint, never do any heavy lifting inside the update func.</p>\n"}], "owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1788, "favorite_count": 1, "accepted_answer_id": 36299675, "answer_count": 1, "score": 7, "last_activity_date": 1459311879, "creation_date": 1459307393, "question_id": 36298925, "link": "https://stackoverflow.com/questions/36298925/boltdb-performance-as-a-backend-db", "title": "BoltDB performance as a backend DB", "body": "<p>I am thinking about using BoltDB as a backend main DB and have few question with my Go code; also need your opinion of using BoltDB as a main backend DB.</p>\n\n<ol>\n<li>I am using Go's net/http, and use boltDb as global variable.</li>\n<li>When the program starts, it will read BoltDB and the file is open until the program terminates. </li>\n<li>When requests(http) are sent to the program, it will access BoltDB. (HandleFunc)</li>\n<li>I didn't use any channel.</li>\n</ol>\n\n<p>Q1. Most important question, is BoltDB capable for production with 1000 concurrent connection?\nQ2. If there were concurrent writing queries, will BoltDB automatically process one by one?</p>\n\n<p>Thank you so much. I am new to Go and BoltDB and I am wondering if I am using right DB with right way.</p>\n"}, {"tags": ["forms", "http", "go"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459529495, "post_id": 36297801, "comment_id": 60342880, "body": "This is not clear to me. You mention interacting with buttons but also working from the linux command line. Do you want to run a command and order a pizza or do you want a GUI? If its the former this is a simple matter of making an http request isn&#39;t it?"}, {"owner": {"reputation": 343, "user_id": 6058631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/80f2cff0a0888497bd7ef323cbc1d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "XXX", "link": "https://stackoverflow.com/users/6058631/xxx"}, "reply_to_user": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 1, "creation_date": 1459537619, "post_id": 36297801, "comment_id": 60347392, "body": "i want to order a pizza from the command line"}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 6058631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/80f2cff0a0888497bd7ef323cbc1d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "XXX", "link": "https://stackoverflow.com/users/6058631/xxx"}, "edited": false, "score": 0, "creation_date": 1459300839, "post_id": 36297962, "comment_id": 60220468, "body": "Whoa. I am not trying to make a web scraper, I want to fill out the form from the linux command line."}], "tags": [], "owner": {"reputation": 10323, "user_id": 1220355, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb2525ec6155e479bdefe9ed6c437d07?s=128&d=identicon&r=PG", "display_name": "Anthony E", "link": "https://stackoverflow.com/users/1220355/anthony-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1459300653, "creation_date": 1459300653, "answer_id": 36297962, "question_id": 36297801, "link": "https://stackoverflow.com/questions/36297801/send-variable-to-3rd-party-online-form/36297962#36297962", "title": "Send variable to 3rd party online form", "body": "<p>I assume you mean pipe information originating from your backend to another site on behalf of a user? </p>\n\n<p>The standard way of passing information between domains is via HTTP params, usually via a GET request, but this capability would need to be supported by established protocols the remote site. You can also use an iframe to embed the page of another site onto your page, however, you wouldn't be able to remotely interact, call JS code, or even query the page at all. Cross-domain security safeguards justifiably prohibit such capability, and generally speaking, interacting on behalf of the user via their browser is also restricted for security reasons. </p>\n\n<p>However, if you're looking to emulate user behavior such as with a bot or web scraper from your own host or browser then that's a different story. There are tons of frameworks provide rich capability for interacting with a page. I'd recommend checking out Selenium, which acts as a virtual browser. There are also tons of libraries in Python for processing data from HTML and structured data. You might want to check out Beatiful Soup and Scrapy.</p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 1, "last_activity_date": 1460316408, "last_edit_date": 1460316408, "creation_date": 1459665393, "answer_id": 36382347, "question_id": 36297801, "link": "https://stackoverflow.com/questions/36297801/send-variable-to-3rd-party-online-form/36382347#36382347", "title": "Send variable to 3rd party online form", "body": "<p>This is how you post any form values onto an online form. Provided you know the POST endpoint of the service.</p>\n\n<pre><code>func main():\n\n   resp, err := http.PostForm(targetPostUrlHere,\n    url.Values{\"Service_Type\": {\"Delivery\"}, \n        \"Address_Type_Select\": {\"House\"}, \n        \"Street\": {\"123 E 24th St\"}, \n        \"Address_Line_2\": {\"4D\"}, \n        \"City\": {\"New York\"},\n        \"Region\": {\"NY\"},\n        \"Postal_Code\": {\"10027\"}})\n\n}\n</code></pre>\n\n<p>**Note: The field keys and values are guesstimates. You must inspect the actual key names expected in the form.</p>\n\n<p>In your case, <a href=\"https://www.dominos.com/en/pages/order/\" rel=\"nofollow\">https://www.dominos.com/en/pages/order/</a> is an endpoint for the form page. Once the form is filled and submitted, the information is submitted using POST method akin to the code afore-mentioned to a dedicated CREATE endpoint (C in the <a href=\"https://en.wikipedia.org/wiki/Create,_read,_update_and_delete\" rel=\"nofollow\">CRUD</a>), which normally can be found in the <code>&lt;form&gt;</code> html tag.</p>\n\n<pre><code>&lt;form action=\"posttargetendpoint\" method=\"POST\"&gt;...&lt;/form&gt;\n</code></pre>\n\n<p>Once the POST operation is successful, usually a web service would redirect you to another page. In your case, it is <a href=\"https://www.dominos.com/en/pages/order/#/section/Food/category/AllEntrees/\" rel=\"nofollow\">https://www.dominos.com/en/pages/order/#/section/Food/category/AllEntrees/</a></p>\n\n<p>However, any good web service wouldn't expose the POST endpoint in the clear since it is the vulnerable point of attack. You're welcome to find out by inspect he Domino's page source and adjust the field values in the Go code accordingly.</p>\n\n<p>Now to make a command line prompt to wrap around the <code>PostForm</code> code, I suggest you look into <a href=\"https://github.com/codegangsta/cli\" rel=\"nofollow\">https://github.com/codegangsta/cli</a> which is a very nice package for creating quick command line app. </p>\n"}], "owner": {"reputation": 343, "user_id": 6058631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/80f2cff0a0888497bd7ef323cbc1d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "XXX", "link": "https://stackoverflow.com/users/6058631/xxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 36382347, "answer_count": 2, "score": -2, "last_activity_date": 1460316408, "creation_date": 1459299547, "last_edit_date": 1459538703, "question_id": 36297801, "link": "https://stackoverflow.com/questions/36297801/send-variable-to-3rd-party-online-form", "title": "Send variable to 3rd party online form", "body": "<p>In golang, is there a way to pipe a variable to part of a web form?<br>\n For example, sending <code>\"123 Random St.\"</code> to the <code>Street address</code> part of <a href=\"https://www.dominos.com/en/pages/order/#/locations/search/\" rel=\"nofollow\">https://www.dominos.com/en/pages/order/#/locations/search/</a>  and so on?    I found <code>pizza_party*</code>, but the <code>GUI</code> used is no longer available, I have also found <code>pizzadash**</code>, but this uses a credit card where I want to use cash. I even found a list of golang ones, but the links that they use doesn't work anymore.<code>***</code><br>\nTherefore, my goal is so: <code>order a pizza in golang through the dominos website API!</code></p>\n\n<p>NOTE: Please suggest a package or function <strong>with example</strong>!</p>\n\n<p>NOTE: I do not want to make a web scraper/data getter.</p>\n\n<p>NOTE: Your answer must work on <strong>at least</strong> one box of my linked website.</p>\n\n<p>NOTE: I want to fill out links similar to the provided link from the linux command line.</p>\n\n<p><code>*</code><a href=\"https://github.com/coryarcangel/Pizza-Party-0.1.b\" rel=\"nofollow\">https://github.com/coryarcangel/Pizza-Party-0.1.b</a><br>\n<code>**</code><a href=\"https://github.com/bhberson/pizzadash\" rel=\"nofollow\">https://github.com/bhberson/pizzadash</a><br>\n<code>***</code><a href=\"https://golanglibs.com/top?q=pizza\" rel=\"nofollow\">https://golanglibs.com/top?q=pizza</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1459300144, "post_id": 36297377, "comment_id": 60220296, "body": "I don&#39;t see a difference between this question and the question you linked. Call <a href=\"https://godoc.org/net/http#SetCookie\" rel=\"nofollow noreferrer\">http.SetCookie</a> to set a cookie on a response. Most applications should set the cookie path. Use <a href=\"https://godoc.org/net/http#Request.Cookie\" rel=\"nofollow noreferrer\">Request.Cookie</a> to get a cookie from a request.  The Name and Value fields are the only fields set in these cookies (because that&#39;s all the client sends).  Because browser clients do not send expired cookies, there&#39;s usually not a reason for the server to know the expiration time."}, {"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1459303667, "post_id": 36297377, "comment_id": 60221199, "body": "oh~~~ so do you mean that if a cookie with expire=10 seconds is sent to client with SetCookie, the timer is on and client cookie will expire after 10 seconds? And after 10 seconds the client no longer carry this cookie to do request? If it&#39;s true it makes a lot of sense~"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1459305940, "post_id": 36297377, "comment_id": 60221875, "body": "Browsers do not send cookies after the cookie has expired, but do not depend on this for security."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1459305969, "post_id": 36297377, "comment_id": 60221889, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/29595154/cant-get-cookie-expiration-time-in-golang\">Can&#39;t get cookie expiration time in golang</a>"}, {"owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1459306662, "post_id": 36297377, "comment_id": 60222086, "body": "Thanks for your answer, really helped."}], "answers": [{"tags": [], "owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "is_accepted": false, "score": -1, "last_activity_date": 1541677280, "creation_date": 1541677280, "answer_id": 53207030, "question_id": 36297377, "link": "https://stackoverflow.com/questions/36297377/golang-setcookie-doesnt-update-expiration/53207030#53207030", "title": "Golang: SetCookie doesn&#39;t update expiration", "body": "<p>You should request the cookie with name \"Expiry\" and you'll get the expiry you have set</p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 800, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1541677280, "creation_date": 1459296682, "last_edit_date": 1495539906, "question_id": 36297377, "link": "https://stackoverflow.com/questions/36297377/golang-setcookie-doesnt-update-expiration", "title": "Golang: SetCookie doesn&#39;t update expiration", "body": "<p>I have the following code and works fine:</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/\", samplePage)\n    _ = http.ListenAndServe(\":8080\", nil)\n}\n\nfunc samplePage(w http.ResponseWriter, r *http.Request) {\n    expiration := time.Now().Add(time.Hour)\n    cookie := http.Cookie{Name: \"username\", Value: \"XXX\", Expires: expiration}\n    http.SetCookie(w, &amp;cookie)\n\n    fmt.Fprintln(w, cookie.Value)\n    fmt.Fprintln(w, cookie.Expires)\n}  \n</code></pre>\n\n<p>It gives me</p>\n\n<pre><code>XXX\n2016-03-29 17:57:02.7077906 -0700 PDT\n</code></pre>\n\n<p>However, if I print the following, it doesn't work:</p>\n\n<pre><code>cookie2, err := r.Cookie(\"username\")\ncheckErr(err) //no error is found\nfmt.Fprintln(w, cookie2.Value)\nfmt.Fprintln(w, cookie2.Expires)\n</code></pre>\n\n<p>This gives me</p>\n\n<pre><code>XXX\n0001-01-01 00:00:00 +0000 UTC\n</code></pre>\n\n<p>Looks like the \"Value\" works but \"Expires\" doesn't. I would like to use Cookie for user login. Could anyone tell me how to make \"cookie2\" work?</p>\n\n<p>p.s. I also found the following question: <a href=\"https://stackoverflow.com/questions/29595154/cant-get-cookie-expiration-time-in-golang\">Can&#39;t get cookie expiration time in golang</a> It is very similar to my problem but the answer says we cannot use cookie in this way. If this is true then may I know how everyone is using cookie?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["postgresql", "go", "pq"], "comments": [{"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 1, "creation_date": 1459290177, "post_id": 36295883, "comment_id": 60217283, "body": "Your statement does not return any rows. Try Exec. Q is the protocol  identifier sent to the backend for a query, for an execute it sends E."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459303954, "post_id": 36295883, "comment_id": 60221282, "body": "You&#39;re ignoring the error returns from <code>db.Begin()</code> and <code>txn.Query()</code>; possibly one of those has an error that may shed some light on the issue before the <code>txn.Commit()</code>"}, {"owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "reply_to_user": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1459307150, "post_id": 36295883, "comment_id": 60222224, "body": "@DmitriGoldring, Thanks! That solved it."}], "answers": [{"tags": [], "owner": {"reputation": 385, "user_id": 671006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f05d597cc06068b0f1d745d1a11cd6df?s=128&d=identicon&r=PG", "display_name": "KilledKenny", "link": "https://stackoverflow.com/users/671006/killedkenny"}, "is_accepted": false, "score": 11, "last_activity_date": 1461678730, "creation_date": 1461678730, "answer_id": 36866993, "question_id": 36295883, "link": "https://stackoverflow.com/questions/36295883/golang-postgres-commit-unknown-command-error/36866993#36866993", "title": "Golang postgres Commit unknown command error?", "body": "<p>To start of i agree whit Dmitri from the comments, in this case you should probably use Exec.</p>\n\n<p>However after receiving this same issue I started digging:</p>\n\n<p><a href=\"https://golang.org/pkg/database/sql/#Tx.Query\" rel=\"noreferrer\">Query</a> returns 2 arguments a Rows pointer and an error. What you always have to do with a Rows object is to close it when you are don with it:</p>\n\n<pre><code>// Fixed\ntxn, _ := db.Begin()\nrows, _ := txn.Query(\"UPDATE t_name SET a = $1\", 1)\n//Read out rows\nrows.Close() //&lt;- This will solve the error\nerr := txn.Commit()\n</code></pre>\n\n<p>I was however unable to see any difference in the traffic to the database when using <code>rows.Close()</code> witch indicates to me that this might be a bug in <code>pq</code>.</p>\n"}], "owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2210, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1461678730, "creation_date": 1459288784, "question_id": 36295883, "link": "https://stackoverflow.com/questions/36295883/golang-postgres-commit-unknown-command-error", "title": "Golang postgres Commit unknown command error?", "body": "<p>Using <code>postgres 9.3</code>, <code>go 1.6</code></p>\n\n<p>I've been trying to use transactions with the <code>go</code> <code>pq</code> library.</p>\n\n<pre><code>// Good\ntxn, _ := db.Begin()\ntxn.Query(\"UPDATE t_name SET a = 1\")\nerr := txn.Commit() // err is nil\n\n// Bad\ntxn, _ := db.Begin()\ntxn.Query(\"UPDATE t_name SET a = $1\", 1)\nerr := txn.Commit() // Gives me a \"unexpected command tag Q\" error\n// although the data is committed\n</code></pre>\n\n<p>For some reason, when I execute a <code>Query</code> with parameters, I always get an <code>unexpected command tag Q</code> error from the <code>Commit()</code>.  What is this error (what is Q?) and why am I getting it?</p>\n\n<p>I believe <a href=\"https://github.com/lib/pq/blob/fde2b33cb1c820fbd3ff19eb9414be2d86b1bd12/conn.go#L557\" rel=\"noreferrer\">this</a> is where the error is created.</p>\n"}, {"tags": ["angularjs", "http", "go", "angular-http"], "comments": [{"owner": {"reputation": 6310, "user_id": 1654231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92569ddbf8ac47f66b2980ca7f69df0d?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/1654231/stuart"}, "edited": false, "score": 0, "creation_date": 1459288588, "post_id": 36295758, "comment_id": 60216678, "body": "Is the URL / controller action you are POSTing to actually expecting a POST?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 6310, "user_id": 1654231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92569ddbf8ac47f66b2980ca7f69df0d?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/1654231/stuart"}, "edited": false, "score": 0, "creation_date": 1459288792, "post_id": 36295758, "comment_id": 60216753, "body": "Yes. But even if it wasnt, the request is logged as a GET even before it gets to the server."}, {"owner": {"reputation": 548, "user_id": 1971120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914a557fed3d8a353e2f7fcb376e2356?s=128&d=identicon&r=PG", "display_name": "germanio", "link": "https://stackoverflow.com/users/1971120/germanio"}, "edited": false, "score": 0, "creation_date": 1459288956, "post_id": 36295758, "comment_id": 60216819, "body": "that&#39;s weird... have you tried using $resource instead? at least to see what happens..."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 548, "user_id": 1971120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914a557fed3d8a353e2f7fcb376e2356?s=128&d=identicon&r=PG", "display_name": "germanio", "link": "https://stackoverflow.com/users/1971120/germanio"}, "edited": false, "score": 0, "creation_date": 1459291311, "post_id": 36295758, "comment_id": 60217699, "body": "@germanio see my update"}, {"owner": {"reputation": 7035, "user_id": 3088642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c4a79fac3b6fb32888fb3f89d2946ef3?s=128&d=identicon&r=PG&f=1", "display_name": "Gremash", "link": "https://stackoverflow.com/users/3088642/gremash"}, "edited": false, "score": 0, "creation_date": 1459291630, "post_id": 36295758, "comment_id": 60217824, "body": "That is weird. Have you tried saving your post object as a variable and then calling $http(postVar).then.... and using the debugger in the console?"}, {"owner": {"reputation": 7035, "user_id": 3088642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c4a79fac3b6fb32888fb3f89d2946ef3?s=128&d=identicon&r=PG&f=1", "display_name": "Gremash", "link": "https://stackoverflow.com/users/3088642/gremash"}, "edited": false, "score": 0, "creation_date": 1459291852, "post_id": 36295758, "comment_id": 60217908, "body": "Also, have you debugged your server and verified that it is actually a get and not a post hitting your server? What do the headers look like server side?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 7035, "user_id": 3088642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c4a79fac3b6fb32888fb3f89d2946ef3?s=128&d=identicon&r=PG&f=1", "display_name": "Gremash", "link": "https://stackoverflow.com/users/3088642/gremash"}, "edited": false, "score": 0, "creation_date": 1459293201, "post_id": 36295758, "comment_id": 60218376, "body": "@Gremash yes to both. Please see my update."}, {"owner": {"reputation": 548, "user_id": 1971120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914a557fed3d8a353e2f7fcb376e2356?s=128&d=identicon&r=PG", "display_name": "germanio", "link": "https://stackoverflow.com/users/1971120/germanio"}, "edited": false, "score": 0, "creation_date": 1459294011, "post_id": 36295758, "comment_id": 60218612, "body": "cool, so that is actually what your server is receiving. How about what the browser is sending? (use dev tools, network tab)... both front and backend are served from the same host:port right? (CORS?)"}, {"owner": {"reputation": 548, "user_id": 1971120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/914a557fed3d8a353e2f7fcb376e2356?s=128&d=identicon&r=PG", "display_name": "germanio", "link": "https://stackoverflow.com/users/1971120/germanio"}, "edited": false, "score": 0, "creation_date": 1459294177, "post_id": 36295758, "comment_id": 60218667, "body": "Accept: and Content-Type: are the ones expected right?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459297161, "post_id": 36295758, "comment_id": 60219548, "body": "so here&#39;s something else weird i noticed. I set the <code>content-type</code> to multipart, but it is not appearing in the request. I thought that was an issue, just one not necessarily related to the method... thoughts?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459297174, "post_id": 36295758, "comment_id": 60219552, "body": "Also, yes both client and server are set to the same host and port."}, {"owner": {"reputation": 417, "user_id": 3791775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a119733b868087cff3817e9363d10e?s=128&d=identicon&r=PG&f=1", "display_name": "user3791775", "link": "https://stackoverflow.com/users/3791775/user3791775"}, "edited": false, "score": 0, "creation_date": 1459299619, "post_id": 36295758, "comment_id": 60220159, "body": "It seems to me the server is culprit, not your request"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 417, "user_id": 3791775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a119733b868087cff3817e9363d10e?s=128&d=identicon&r=PG&f=1", "display_name": "user3791775", "link": "https://stackoverflow.com/users/3791775/user3791775"}, "edited": false, "score": 0, "creation_date": 1459305348, "post_id": 36295758, "comment_id": 60221686, "body": "@user3791775 please elaborate. how so?"}, {"owner": {"reputation": 3096, "user_id": 5860845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UXlEK.jpg?s=128&g=1", "display_name": "Stepan Kasyanenko", "link": "https://stackoverflow.com/users/5860845/stepan-kasyanenko"}, "edited": false, "score": 0, "creation_date": 1459314366, "post_id": 36295758, "comment_id": 60224464, "body": "Maybe you used <code>$interceptor</code> for <code>$http</code>?"}, {"owner": {"reputation": 46815, "user_id": 5535245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnjcO.jpg?s=128&g=1", "display_name": "georgeawg", "link": "https://stackoverflow.com/users/5535245/georgeawg"}, "edited": false, "score": 1, "creation_date": 1459318971, "post_id": 36295758, "comment_id": 60226516, "body": "&quot;GET&quot; is the default when there is no method specified in the config object. Look for a request interceptor that is broken and returning an undefined config object."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 46815, "user_id": 5535245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnjcO.jpg?s=128&g=1", "display_name": "georgeawg", "link": "https://stackoverflow.com/users/5535245/georgeawg"}, "edited": false, "score": 0, "creation_date": 1459349887, "post_id": 36295758, "comment_id": 60248398, "body": "@georgeawg Please see my updates"}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1459351617, "post_id": 36295758, "comment_id": 60249752, "body": "EOF on client side would mean server has closed the connection. In this case might say that client has closed the connection. Could you put the full logs from server?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1459351949, "post_id": 36295758, "comment_id": 60250059, "body": "@Grif-fin please see updates"}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1459352247, "post_id": 36295758, "comment_id": 60250305, "body": "Please try and put a condition (if r.Method == &quot;POST&quot; {...}) to only process the POST before:  decoder := json.NewDecoder(r.Body)  And ignore any GETs. It looks like client is sending a GET first and a POST is about to come but your server crashes because it tries to decode the GET."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459352443, "post_id": 36295758, "comment_id": 60250467, "body": "The POST is never logged."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1459352502, "post_id": 36295758, "comment_id": 60250511, "body": "Could be because it never arrives? Try commenting out the &#39;panic()&#39; and instead &#39;return&#39; as a test"}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459352568, "post_id": 36295758, "comment_id": 60250559, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/107756/discussion-between-grif-fin-and-dopatraman\">continue this discussion in chat</a>."}, {"owner": {"reputation": 648, "user_id": 1981061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf8c5be4f273295132879954ce1e7b11?s=128&d=identicon&r=PG", "display_name": "Griffin", "link": "https://stackoverflow.com/users/1981061/griffin"}, "edited": false, "score": 0, "creation_date": 1459363952, "post_id": 36295758, "comment_id": 60257973, "body": "I think as you have got your answer from <a href=\"http://stackoverflow.com/questions/36316429/go-web-server-is-automatically-redirecting-post-requests\">here</a> worth sharing it."}, {"owner": {"reputation": 388, "user_id": 6022278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/egKyY.jpg?s=128&g=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/6022278/frank"}, "edited": false, "score": 0, "creation_date": 1588390932, "post_id": 36295758, "comment_id": 108883260, "body": "I had this same problem when mistakenly adding double slash to my request URL e.g. <code>localhost:5432&#47;&#47;register</code> instead of <code>localhost:5432&#47;register</code>"}], "answers": [{"comments": [{"owner": {"reputation": 676, "user_id": 1433073, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d608ff0f39c72531a0e3c4260cc29bf8?s=128&d=identicon&r=PG", "display_name": "Arco Voltaico", "link": "https://stackoverflow.com/users/1433073/arco-voltaico"}, "edited": false, "score": 0, "creation_date": 1524514278, "post_id": 36317880, "comment_id": 86994870, "body": "It happened to me when I forgot to update from http to https"}, {"owner": {"reputation": 182, "user_id": 972053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25ef9cfd6f427a8c71d06f3432d91ecd?s=128&d=identicon&r=PG", "display_name": "Miguel Suarez", "link": "https://stackoverflow.com/users/972053/miguel-suarez"}, "edited": false, "score": 1, "creation_date": 1544802245, "post_id": 36317880, "comment_id": 94417108, "body": "This happened to me when I had a trailing slash in the POST URL, check <a href=\"https://stackoverflow.com/a/39892290/972053\">this answer</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1459365824, "last_edit_date": 1495540036, "creation_date": 1459365824, "answer_id": 36317880, "question_id": 36295758, "link": "https://stackoverflow.com/questions/36295758/http-post-method-is-actally-sending-a-get/36317880#36317880", "title": "$http.post() method is actally sending a GET", "body": "<p>This is due to a security consideration.</p>\n\n<p>In your situation when a redirect is sent back from the server to the browser, the browser will not repeat the POST request (but rather just a \"simple\" GET request).</p>\n\n<p>Generally speaking a browser will not send POST data to a redirect URL because the browser is not qualified to decide if you're willing to send the same data to the new URL what you intended to send to the original URL (think about passwords, credit card numbers and other sensitive data). But don't try to circumvent it, simply use registered path of your handler to POST to, or any of the other tips mentioned in the linked answer.</p>\n\n<p>For context see question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36316429/go-web-server-is-automatically-redirecting-post-requests\">Go web server is automatically redirecting POST requests</a></p>\n\n<p>You can read more on the subject here:</p>\n\n<p><a href=\"https://softwareengineering.stackexchange.com/questions/99894/why-doesnt-http-have-post-redirect\">Why doesn't HTTP have POST redirect?</a></p>\n"}, {"comments": [{"owner": {"reputation": 1425, "user_id": 6304349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c4a1ce11469805ba79d576fa2f013c?s=128&d=identicon&r=PG", "display_name": "dorukayhan", "link": "https://stackoverflow.com/users/6304349/dorukayhan"}, "edited": false, "score": 2, "creation_date": 1476055068, "post_id": 39949413, "comment_id": 67179223, "body": "While this code may solve the asker&#39;s problem, it would be preferable to explain how it works and what are the differences between it and what the asker has tried (if (s)he has tried anything at all)."}], "tags": [], "owner": {"reputation": 1, "user_id": 6776683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0b99d43208a25d60f01fac86296833?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/6776683/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1476054355, "creation_date": 1476054355, "answer_id": 39949413, "question_id": 36295758, "link": "https://stackoverflow.com/questions/36295758/http-post-method-is-actally-sending-a-get/39949413#39949413", "title": "$http.post() method is actally sending a GET", "body": "<p>This code actually send GET to server</p>\n\n<pre><code>$http({\n            method: 'POST',            \n            params: {\n                LoginForm_Login: userData.username,\n                LoginForm_Password: userData.password\n            },\n            url: YOURURL\n        }).then(\n</code></pre>\n\n<p>You need to use transformRequest, sample below actually send POST</p>\n\n<pre><code>$http({\n            method: 'POST',\n            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n            transformRequest: function (obj) {\n                var str = [];\n                for (var p in obj)\n                    str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(obj[p]));\n                return str.join(\"&amp;\");\n            },\n            data: {\n                LoginForm_Login: userData.username,\n                LoginForm_Password: userData.password\n            },\n            url: YOURURL\n        }).then(\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5760, "favorite_count": 0, "accepted_answer_id": 36317880, "answer_count": 2, "score": 10, "last_activity_date": 1506554279, "creation_date": 1459288269, "last_edit_date": 1495540480, "question_id": 36295758, "link": "https://stackoverflow.com/questions/36295758/http-post-method-is-actally-sending-a-get", "title": "$http.post() method is actally sending a GET", "body": "<h2>NOTE:</h2>\n\n<p>I've found a possibly related issue that warrants a new question <a href=\"https://stackoverflow.com/questions/36316429/go-web-server-is-automatically-redirecting-post-requests\">here</a></p>\n\n<hr>\n\n<p>This is a weird problem. I've been using angular over the course of 2 years and have never run into this problem.</p>\n\n<p>I'm using angular v1.5.0. I'm making a post request like this:</p>\n\n<pre><code>$http({\n    method: \"POST\",\n    url: \"/myurl\",\n    data: {\n        file: myFile // This is just an object\n    }\n});\n</code></pre>\n\n<p>Run-of-the-mill POST request right? Get this. I look in the console and the Network tab logs the request as a GET. Bizarre. So I've jiggered the code to work like this:</p>\n\n<pre><code>$http.post(\"/myurl\", {file: myFile});\n</code></pre>\n\n<p>Same thing. After stepping through the <code>$http</code> service code I'm confident that the headers are being set properly. Has anyone else run into this problem?</p>\n\n<h1>Update</h1>\n\n<p>Taking <a href=\"https://stackoverflow.com/users/1971120/germanio\">germanio</a>'s advice, i've tried using the <code>$resource</code> service instead:</p>\n\n<pre><code>promise = $resource(\"/upload\").save()\n</code></pre>\n\n<p>(this returns an error for another reason, it still executes the POST properly). I'm having the same problem: the request is logged as a GET in the console. </p>\n\n<p>Here are the headers of the request when it gets to my server:</p>\n\n<pre><code>GET /myurl/ HTTP/1.1\nHost: localhost:8001\nAccept: application/json, text/plain, */*\nAccept-Encoding: gzip, deflate, sdch\nAccept-Language: en-US,en;q=0.8\nCache-Control: no-cache\nConnection: keep-alive\nPragma: no-cache\nReferer: http://localhost:8001/myurl/\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36\n</code></pre>\n\n<h1>Update 2</h1>\n\n<p>As per <a href=\"https://stackoverflow.com/users/5535245/georgeawg\">georgeawg</a>'s suggestion I've used an interceptor to log the request at its various stages. Here is the interceptor code:</p>\n\n<pre><code>$httpProvider.interceptors.push(function() {\n    return {\n        request: function(config) {\n            console.log(config);\n            return config;\n        }\n    }\n}\n</code></pre>\n\n<p>Having run this code I get this logged:</p>\n\n<pre><code>data:Object // contains file object\nheaders: Object // has Content-Type set to multipart\nmethod:\"POST\" // ???\nurl :\"/myurl\n</code></pre>\n\n<p>So this means the request is being sent as a POST from within Angular, but it is still logged as a GET both in the browser and on my server. I think there is something low level at work here about the HTTP protocol that I dont understand. </p>\n\n<p>Is the request sent to the server before it is actually logged in the browser? If so, that might atleast point to my server as the culprit.</p>\n\n<p>In the hopes of finding out whats going on, here is my server code:</p>\n\n<pre><code>type FormStruct struct {\n    Test string\n}\n\nfunc PHandler(w http.ResponseWriter, r *http.Request) {\n    var t FormStruct\n\n    req, _ := httputil.DumpRequest(r, true)\n\n    log.Println(string(req))\n    log.Println(r.Method) // GET\n    log.Println(r.Body)\n\n    decoder := json.NewDecoder(r.Body)\n    err := decoder.Decode(&amp;t)\n    log.Println(\"Decoding complete\")\n    if err != nil {\n        log.Println(\"Error\")\n        panic(err.Error()+\"\\n\\n\")\n    }\n    log.Println(t.Test)\n\n    w.Write([]byte(\"Upload complete, no errors\"))\n}\n\nfunc main() {\n    http.HandleFunc(\"/myurl/\", PHandler)    \n    fmt.Println(\"Go Server listening on port 8001\")\n    http.ListenAndServe(\":8001\", nil)\n}\n</code></pre>\n\n<p>My server throws an EOF error when it receives the request:</p>\n\n<pre><code>2016/03/30 10:51:37 http: panic serving [::1]:52039: EOF\n</code></pre>\n\n<p>Not sure what an EOF would even mean in this context.</p>\n\n<h1>Update 3</h1>\n\n<p>By the suggestion of another use, I tried using POSTMAN to hit my server with a fake POST request. The server receives the request properly. This means to me that there is something up with how angular is making the POST request. Please help.</p>\n\n<p>Any ideas?</p>\n\n<p>Full server logs:</p>\n\n<pre><code>Go Server listening on port 8001\n\n2016/03/30 11:13:08 GET /myurl/ HTTP/1.1\nHost: localhost:8001\nAccept: */*\nAccept-Encoding: gzip, deflate, sdch\nAccept-Language: en-US,en;q=0.8\nCache-Control: no-cache\nConnection: keep-alive\nContent-Type: application/json\nPostman-Token: 33d3de90-907e-4350-c703-6c57a4ce4ac0\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36\nX-Xsrf-Token: null\n\n\n2016/03/30 11:13:08 GET\n2016/03/30 11:13:08 {}\n2016/03/30 11:13:08 Decoding complete\n2016/03/30 11:13:08 Error\n2016/03/30 11:13:08 http: panic serving [::1]:52228: EOF\n\n\ngoroutine 5 [running]:\nnet/http.(*conn).serve.func1(0xc820016180)\n    /usr/local/Cellar/go/1.6/libexec/src/net/http/server.go:1389 +0xc1\npanic(0x3168c0, 0xc82000b1a0)\n    /usr/local/Cellar/go/1.6/libexec/src/runtime/panic.go:426 +0x4e9\nroutes.FUPHandler(0x1055870, 0xc820061ee0, 0xc820104000)\n    /Users/projectpath/routes.go:42 +0x695\nnet/http.HandlerFunc.ServeHTTP(0x4e7e20, 0x1055870, 0xc820061ee0, 0xc820104000)\n    /usr/local/Cellar/go/1.6/libexec/src/net/http/server.go:1618 +0x3a\nnet/http.(*ServeMux).ServeHTTP(0xc820014b40, 0x1055870, 0xc820061ee0, 0xc820104000)\n    /usr/local/Cellar/go/1.6/libexec/src/net/http/server.go:1910 +0x17d\nnet/http.serverHandler.ServeHTTP(0xc820016100, 0x1055870, 0xc820061ee0, 0xc820104000)\n    /usr/local/Cellar/go/1.6/libexec/src/net/http/server.go:2081 +0x19e\nnet/http.(*conn).serve(0xc820016180)\n    /usr/local/Cellar/go/1.6/libexec/src/net/http/server.go:1472 +0xf2e\ncreated by net/http.(*Server).Serve\n    /usr/local/Cellar/go/1.6/libexec/src/net/http/server.go:2137 +0x44e\n</code></pre>\n\n<h1>Update 4</h1>\n\n<p>I stumbled onto something interesting:</p>\n\n<p>Charles logs a POST request when I post to <code>myurl</code>, but the response status is 301. After the POST a GET is logged. This is the GET that is hitting my server.</p>\n\n<p>My server, as you can see above, does not do any sort of redirection. How is the 301 happening?</p>\n"}, {"tags": ["email", "parsing", "go", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 583, "user_id": 1840094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf16b9a48f387c59fd5b6a4e412c027?s=128&d=identicon&r=PG", "display_name": "sethammons", "link": "https://stackoverflow.com/users/1840094/sethammons"}, "is_accepted": false, "score": 0, "last_activity_date": 1459290551, "creation_date": 1459290551, "answer_id": 36296251, "question_id": 36295343, "link": "https://stackoverflow.com/questions/36295343/parsing-email-message-headers-in-go/36296251#36296251", "title": "Parsing email message headers in Go", "body": "<p>Check out <a href=\"https://github.com/sendgrid/go-gmime\" rel=\"nofollow\">https://github.com/sendgrid/go-gmime</a> (disclaimer, I work with SendGrid, but did not put together anything in the lib)</p>\n"}, {"comments": [{"owner": {"reputation": 10110, "user_id": 130024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2353857b3f577eb4e3840111ca9a7ecb?s=128&d=identicon&r=PG", "display_name": "astropanic", "link": "https://stackoverflow.com/users/130024/astropanic"}, "edited": false, "score": 0, "creation_date": 1459367223, "post_id": 36309240, "comment_id": 60260047, "body": "Although this not fixes the problem 100% (you will indent all further lines from the message body) I accept this message, because it makes the most sense to reformat the message in front before parsing. Thanks for the sugestion."}, {"owner": {"reputation": 1175, "user_id": 118015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9358fac88a1320409e7842a71dde5fcf?s=128&d=identicon&r=PG", "display_name": "Giovanni Bajo", "link": "https://stackoverflow.com/users/118015/giovanni-bajo"}, "reply_to_user": {"reputation": 10110, "user_id": 130024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2353857b3f577eb4e3840111ca9a7ecb?s=128&d=identicon&r=PG", "display_name": "astropanic", "link": "https://stackoverflow.com/users/130024/astropanic"}, "edited": false, "score": 0, "creation_date": 1459455922, "post_id": 36309240, "comment_id": 60307930, "body": "it wasn&#39;t 100% clear from your original message that the code needed to handle a full MIME message including the body. It&#39;s easy to fix it though: just stop indenting when you see an empty line. See: <a href=\"http://play.golang.org/p/Z_9wWW24_x\" rel=\"nofollow noreferrer\">play.golang.org/p/Z_9wWW24_x</a>"}, {"owner": {"reputation": 10110, "user_id": 130024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2353857b3f577eb4e3840111ca9a7ecb?s=128&d=identicon&r=PG", "display_name": "astropanic", "link": "https://stackoverflow.com/users/130024/astropanic"}, "edited": false, "score": 0, "creation_date": 1459455976, "post_id": 36309240, "comment_id": 60307959, "body": "I just wanted to bring clear what I want to achieve with this simple example. Your second suggestion will not work for multipart MIME messages, but I got the idea."}, {"owner": {"reputation": 88, "user_id": 814410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b6241b51f1864a1d40c375aca37608?s=128&d=identicon&r=PG", "display_name": "Celeb", "link": "https://stackoverflow.com/users/814410/celeb"}, "edited": false, "score": 0, "creation_date": 1463499258, "post_id": 36309240, "comment_id": 62086408, "body": "I wanted to ask for a clarification in this regard. According to <a href=\"https://tools.ietf.org/html/rfc5322#section-2.2.3\" rel=\"nofollow noreferrer\">tools.ietf.org/html/rfc5322#section-2.2.3</a> folding with CRLF may occur in headers, am i reading this incorrectly ( because if stdlib of go does not support i think i might )."}], "tags": [], "owner": {"reputation": 1175, "user_id": 118015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9358fac88a1320409e7842a71dde5fcf?s=128&d=identicon&r=PG", "display_name": "Giovanni Bajo", "link": "https://stackoverflow.com/users/118015/giovanni-bajo"}, "is_accepted": true, "score": 1, "last_activity_date": 1459341779, "creation_date": 1459341779, "answer_id": 36309240, "question_id": 36295343, "link": "https://stackoverflow.com/questions/36295343/parsing-email-message-headers-in-go/36309240#36309240", "title": "Parsing email message headers in Go", "body": "<p>Given that the message is malformed, I would fix it through a separate piece of code that reformats the message:</p>\n\n<pre><code>func fixBrokenMime(r_ io.Reader, w io.WriteCloser) {\n    r := bufio.NewScanner(bufio.NewReader(r_))\n    for r.Scan() {\n        line := r.Text()\n        if len(line) &gt; 0 &amp;&amp; line[0] != ' ' &amp;&amp; strings.IndexByte(line, ':') &lt; 0 {\n            line = \" \" + line\n        }\n        w.Write([]byte(line+\"\\n\"))\n    }\n    w.Close()\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/OZsXT7pmtN\" rel=\"nofollow\">http://play.golang.org/p/OZsXT7pmtN</a></p>\n\n<p>Obviously, you may want a different heuristic. I assumed that a line that is not indented and doesn't contain \":\", must be indented.</p>\n"}], "owner": {"reputation": 10110, "user_id": 130024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2353857b3f577eb4e3840111ca9a7ecb?s=128&d=identicon&r=PG", "display_name": "astropanic", "link": "https://stackoverflow.com/users/130024/astropanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1570, "favorite_count": 0, "accepted_answer_id": 36309240, "answer_count": 2, "score": 0, "last_activity_date": 1527120710, "creation_date": 1459286588, "last_edit_date": 1459290740, "question_id": 36295343, "link": "https://stackoverflow.com/questions/36295343/parsing-email-message-headers-in-go", "title": "Parsing email message headers in Go", "body": "<p>How I can read some headers from an email message in Go?</p>\n\n<p>Usually I would use <a href=\"https://golang.org/src/net/textproto/reader.go?s=12179:12232#L458\" rel=\"nofollow\">ReadMIMEHeader()</a>, but sadly not everybody has read all the relevant RFCs and for some messages I get output like:</p>\n\n<blockquote>\n  <p>malformed MIME header line: name=\"7DDA4_foo_9E5D72.zip\"</p>\n</blockquote>\n\n<p>I narrowed the culprit to be </p>\n\n<pre><code>Content-Type: application/x-zip-compressed; x-unix-mode=0600;\nname=\"7DDA4_foo_9E5D72.zip\"\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>Content-Type: application/x-zip-compressed; x-unix-mode=0600; \n  name=\"7DDA4_foo_9E5D72.zip\"\n</code></pre>\n\n<p>in the source of the message.</p>\n\n<p><a href=\"http://play.golang.org/p/y4OS532H1J\" rel=\"nofollow\">Go Playground example</a></p>\n\n<p><strong>What is the correct way of parsing the headers correctly, regardless if indented or not?</strong></p>\n"}, {"tags": ["go", "cross-compiling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459287609, "post_id": 36295294, "comment_id": 60216209, "body": "Go is trying to avoid putting incompatible binaries in your PATH. What&#39;s wrong with having it in the bin/linux_386 directory?"}, {"owner": {"reputation": 11, "user_id": 5923235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2032e4c30fa077d3f1c244a3adf4ad0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Johnson", "link": "https://stackoverflow.com/users/5923235/kevin-johnson"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459288456, "post_id": 36295294, "comment_id": 60216614, "body": "I have two ways to build the executable.  One inside the 32 bit sandbox uses the 32 bit version of go.  One outside the sandbox uses the 64 bit version of go that cross compiles.  I want both to put the executable in the same location."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459352144, "post_id": 36297297, "comment_id": 60250220, "body": "Also adding the <code>-i</code> option will install out of date dependencies, basically giving you the behavior of <code>go install</code>"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1459296264, "creation_date": 1459296264, "answer_id": 36297297, "question_id": 36295294, "link": "https://stackoverflow.com/questions/36295294/golang-1-6-cross-compile/36297297#36297297", "title": "golang 1.6 cross compile", "body": "<p>You can't with go install, however you can do it manually:</p>\n\n<pre><code> go build -o $GOPATH/bin/&lt;exe&gt; $GOPATH/src/your/&lt;pkg&gt;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5923235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2032e4c30fa077d3f1c244a3adf4ad0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Johnson", "link": "https://stackoverflow.com/users/5923235/kevin-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 36297297, "answer_count": 1, "score": 0, "last_activity_date": 1459296264, "creation_date": 1459286421, "last_edit_date": 1459291196, "question_id": 36295294, "link": "https://stackoverflow.com/questions/36295294/golang-1-6-cross-compile", "title": "golang 1.6 cross compile", "body": "<p>In golang 1.6, when I cross compile from my 64-bit arch to 32-bit for Linux, the <code>go install</code> command puts the executable in <code>bin/linux_386/&lt;exe&gt;</code>.</p>\n\n<p>Is there a way to put it into <code>bin/</code> instead?  If I build in the 32-bit environment, then it will go in <code>bin/</code>.  I want the exe to go into the same location regardless of if I cross compile to 32-bit outside the sandbox, or natively compile inside the 32-bit sandbox.</p>\n\n<p>My workaround right now is to soft link the <code>linux_386</code> dir to <code>.</code>, as in <code>ln -s . linux_386</code>.</p>\n"}, {"tags": ["methods", "go"], "answers": [{"tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": true, "score": 7, "last_activity_date": 1459281101, "creation_date": 1459281101, "answer_id": 36293863, "question_id": 36293654, "link": "https://stackoverflow.com/questions/36293654/why-can-methods-in-go-only-be-declared-on-types-defined-in-the-same-package/36293863#36293863", "title": "Why can methods in Go only be declared on types defined in the same package?", "body": "<p>The reason is that if you could define methods on other packages' types, you could modify the behavior of other packages. This is because the method set of a given type can have an effect on how values of that type are used.</p>\n\n<p>Consider, for example, the <code>fmt.Println</code> function. When you pass an argument to <code>fmt.Println</code>, it will print a string representation of that value based on a set of rules. One of those rules is that if the type of the value has a <code>String() string</code> method (that is, it implements the <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"noreferrer\"><code>fmt.Stringer</code></a> interface), then that method will be called in order to obtain the string representation of the value.</p>\n\n<p>Thus, imagine that we have a package, <code>foo</code>, and that package has a type, <code>FooInt</code>, defined as follows:</p>\n\n<pre><code>type FooInt int\n</code></pre>\n\n<p>Now imagine that this package also has a function, <code>PrintFooInt</code>:</p>\n\n<pre><code>func PrintFooInt(f FooInt) { fmt.Println(f) }\n</code></pre>\n\n<p>This will print the integer value of <code>f</code>. But let's say that you (in a different package, say <code>main</code>) were able to add methods to <code>FooInt</code>. Then you could do this:</p>\n\n<pre><code>func (f FooInt) String() string { return \"foobar!\" }\n</code></pre>\n\n<p>This would actually change the behavior of <code>foo.PrintFooInt</code>, which shouldn't be possible from outside the package.</p>\n"}], "owner": {"reputation": 3442, "user_id": 5951320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aZ8G2.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5951320/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 36293863, "answer_count": 1, "score": 3, "last_activity_date": 1459281101, "creation_date": 1459280431, "question_id": 36293654, "link": "https://stackoverflow.com/questions/36293654/why-can-methods-in-go-only-be-declared-on-types-defined-in-the-same-package", "title": "Why can methods in Go only be declared on types defined in the same package?", "body": "<p>The <a href=\"https://tour.golang.org/methods/3\" rel=\"nofollow\">Go Tour</a> says the following:</p>\n\n<blockquote>\n  <p>You can only declare a method with a receiver whose type is defined in the same package as the method. You cannot declare a method with a receiver whose type is defined in another package (which includes the built-in types such as int).</p>\n</blockquote>\n\n<p>Is there a reason for this other than avoiding everyone building their own methods off <code>int</code> and <code>string</code>? I've Googled around, but can't find anything referencing it.</p>\n"}, {"tags": ["go", "reactjs", "routing", "react-router"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1459279897, "post_id": 36293338, "comment_id": 60212101, "body": "Your <code>Render</code> method is never going to write anything but the index, you have it hard coded."}, {"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1459280340, "post_id": 36293338, "comment_id": 60212398, "body": "no my index.html is juste a file a with a div with id=&quot;app&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 0, "creation_date": 1459328801, "post_id": 36294675, "comment_id": 60232284, "body": "yes I &#39;ve realized my mistake after posting this message. I have forgot this line &quot;{this.props.children}&quot;. Thank&#39;s a lot for your help :)"}], "tags": [], "owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "is_accepted": true, "score": 1, "last_activity_date": 1459284043, "creation_date": 1459284043, "answer_id": 36294675, "question_id": 36293338, "link": "https://stackoverflow.com/questions/36293338/react-router-with-child-in-go-how-does-it-work/36294675#36294675", "title": "React-Router with child in Go how does it work?", "body": "<p>This isn't a go question, but a react question, you need to render the App component's children in order for the other two components to display, a la this code snippet taken from the docs for React Router (<a href=\"https://github.com/reactjs/react-router/blob/master/docs/API.md#props-2\" rel=\"nofollow\">https://github.com/reactjs/react-router/blob/master/docs/API.md#props-2</a>):</p>\n\n<pre><code>const routes = (\n  &lt;Route component={App}&gt;\n    &lt;Route path=\"groups\" component={Groups} /&gt;\n    &lt;Route path=\"users\" component={Users} /&gt;\n  &lt;/Route&gt;\n)\n\nclass App extends React.Component {\n  render () {\n    return (\n      &lt;div&gt;\n        {/* this will be either &lt;Users&gt; or &lt;Groups&gt; */}\n        {this.props.children}\n      &lt;/div&gt;\n    )\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 36294675, "answer_count": 1, "score": 1, "last_activity_date": 1459828789, "creation_date": 1459279400, "last_edit_date": 1459828789, "question_id": 36293338, "link": "https://stackoverflow.com/questions/36293338/react-router-with-child-in-go-how-does-it-work", "title": "React-Router with child in Go how does it work?", "body": "<p>I'm trying to use react-router with a server in Go.</p>\n\n<p>I did some tests but I can not do what I want.</p>\n\n<p>My react components :</p>\n\n<pre><code>var App = React.createClass({\n    render: function(){\n        return (\n            &lt;div&gt;\n            &lt;h2&gt;App&lt;/h2&gt;\n            &lt;li&gt;&lt;Link to=\"/page1\"&gt;Page 1&lt;/Link&gt;&lt;/li&gt;\n            &lt;li&gt;&lt;Link to=\"/page2\"&gt;Page 2&lt;/Link&gt;&lt;/li&gt;\n            &lt;/div&gt;\n        )\n    }\n})\n\nvar Page1 = React.createClass({\n    render: function(){\n        return (\n            &lt;div&gt;\n            &lt;h2&gt;Page 1&lt;/h2&gt;\n            &lt;li&gt;&lt;Link to=\"/page2\"&gt;Page 2&lt;/Link&gt;&lt;/li&gt;\n            &lt;/div&gt;\n\n        )\n    }\n})\n\nvar Page2 = React.createClass({\n    render: function(){\n        return (\n            &lt;div&gt;\n            &lt;h2&gt;Page 2&lt;/h2&gt;\n            &lt;li&gt;&lt;Link to=\"/page1\"&gt;Page 1&lt;/Link&gt;&lt;/li&gt;\n            &lt;/div&gt;\n\n        )\n    }\n})\n</code></pre>\n\n<p>My react routing :</p>\n\n<pre><code>   ReactDOM.render((&lt;Router history={browserHistory}&gt;\n    &lt;Route path=\"/\" component={App}&gt;\n      &lt;Route path=\"page1\" component={Page1} /&gt;\n      &lt;Route path=\"page2\" component={Page2} /&gt;\n    &lt;/Route&gt;\n  &lt;/Router&gt;), document.getElementById('app'))\n</code></pre>\n\n<p>my go server :</p>\n\n<pre><code>func Render(c web.C, w http.ResponseWriter, r *http.Request) {\n        RenderHTMLPage(w, \"index.html\")\n}\n\nfunc main() {\n        goji.Get(\"/page1\", Render)\n        goji.Get(\"/page2\", Render)\n        goji.Get(\"/\", Render)\n        goji.Serve()\n    }\n</code></pre>\n\n<p>My problem is when i click on Link in 'App' Component, for example :</p>\n\n<pre><code>&lt;li&gt;&lt;Link to=\"/page1\"&gt;Page 1&lt;/Link&gt;&lt;/li&gt;\n</code></pre>\n\n<p>url changes like that </p>\n\n<blockquote>\n  <p><a href=\"http://localhost:8000/page1\" rel=\"nofollow\">http://localhost:8000/page1</a></p>\n</blockquote>\n\n<p>But actual component is already App and not Page1, so url changes but not component.\nAnd if i load directly url, i have the same result.</p>\n\n<p>Does anyone help me ?\nThank's :)</p>\n"}, {"tags": ["go", "jwt", "token", "logout", "jwt-go"], "comments": [{"owner": {"reputation": 873, "user_id": 307862, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/722274c13fd9a66e3d1fc70dca23c0a7?s=128&d=identicon&r=PG", "display_name": "anthony", "link": "https://stackoverflow.com/users/307862/anthony"}, "edited": false, "score": 0, "creation_date": 1459283244, "post_id": 36292900, "comment_id": 60214072, "body": "JWT logouts are generally done on the client side. Issuing an &quot;empty&quot; token could serve to do the same thing."}, {"owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "edited": false, "score": 1, "creation_date": 1459284387, "post_id": 36292900, "comment_id": 60214653, "body": "a couple of things, it&#39;s a pretty bad idea to store a password in a jwt token, though they&#39;re signed they can still be easily base64 decoded. For the rest of the question, generally this is something fairly easy to solve with a session id that you expire server-side when you want to invalidate the token."}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "edited": false, "score": 0, "creation_date": 1459339390, "post_id": 36292900, "comment_id": 60239891, "body": "Ok I will change that, thank for your messages ;)"}], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 4, "last_activity_date": 1459287919, "creation_date": 1459287919, "answer_id": 36295670, "question_id": 36292900, "link": "https://stackoverflow.com/questions/36292900/golang-and-jwt-simple-logout/36295670#36295670", "title": "Golang and JWT - Simple Logout", "body": "<p>First: Don't (ever) put sensitive credentials in the token. They are not encrypted, and you shouldn't need to do that. </p>\n\n<p>To note:</p>\n\n<ul>\n<li>JWTs are stateless: you issue one, and it lives as long as you have allowed/are validating against on the server.</li>\n<li>You could issue a new JWT with an expiry of 'now', but the old JWT would still be valid (i.e. a security risk).</li>\n<li>Read through <a href=\"http://jwt.io/introduction/\" rel=\"nofollow\">http://jwt.io/introduction/</a></li>\n</ul>\n\n<p>If you need control over expiring access tokens after issuance, then you should implement a server-side scheme, which would allow you to expire tokens directly. The user would only hold an ID that references the server-side store.</p>\n"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3517, "favorite_count": 1, "accepted_answer_id": 36295670, "answer_count": 1, "score": 1, "last_activity_date": 1588106884, "creation_date": 1459277947, "last_edit_date": 1588106884, "question_id": 36292900, "link": "https://stackoverflow.com/questions/36292900/golang-and-jwt-simple-logout", "title": "Golang and JWT - Simple Logout", "body": "<p>I'm currently working on an API and after a bit of time, I now understand how to use JWT in Go to get a token. With this token, I can keep a user connected but, how can I logout from the client application?</p>\n\n<p>Here is my <code>token.go</code> code:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/dgrijalva/jwt-go\"\n    \"time\"\n)\n\nconst (\n    tokenEncodeString = \"something\"\n)\n\nfunc createToken(user User) (string, error) {\n    // create the token                                                                                                                                                                                  \n    token := jwt.New(jwt.SigningMethodHS256)\n\n    // set some claims                                                                                                                                                                                   \n    token.Claims[\"username\"] = user.Username;\n    token.Claims[\"password\"] = user.Password;\n    token.Claims[\"exp\"] = time.Now().Add(time.Hour * 72).Unix()\n\n    //Sign and get the complete encoded token as string                                                                                                                                                  \n    return (token.SignedString([]byte(tokenEncodeString)))\n}\n\nfunc parseToken(unparsedToken string) (bool, string) {\n    token, err := jwt.Parse(unparsedToken, func(token *jwt.Token) (interface{}, error) {\n            return []byte(tokenEncodeString), nil\n    })\n\n    if err == nil &amp;&amp; token.Valid {\n            return true, unparsedToken\n    } else {\n            return false, \"\"\n    }\n}\n</code></pre>\n\n<p>After research, I found out that I can use a black list, but I really want to know if it's possible with something easier, like the code above.</p>\n\n<p>I also want to find a solution that works with the memory used by the JWT process. Someone who disconnects/connects himself all the time has to have only one token for each session, not one for him and a hundred in a given black list.</p>\n"}, {"tags": ["google-app-engine", "go", "deployment"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1459273489, "last_edit_date": 1459273489, "creation_date": 1459273135, "answer_id": 36291311, "question_id": 36291105, "link": "https://stackoverflow.com/questions/36291105/difference-between-goapp-deploy-and-appcf-py-to-deploy-my-app-on-google-app/36291311#36291311", "title": "Difference between &#39;goapp deploy&#39; and &#39;appcf.py&#39; to deploy my app on Google App Engine?", "body": "<p>Documented in <a href=\"https://cloud.google.com/appengine/docs/go/tools/uploadinganapp\" rel=\"nofollow\">Uploading, Downloading, and Managing a Go App</a>:</p>\n\n<blockquote>\n  <p><code>goapp deploy</code> wraps the <code>appcfg.py</code> python tool provided in the SDK. You can also invoke this tool directly if you need greater control over the deployment.</p>\n</blockquote>\n\n<p><code>goapp deploy</code> is equivalent to <code>appcfg.py update myapp/</code>.</p>\n\n<p>These commands get application ID and other configuration from <code>app.yaml</code> automatically. You can use <code>-application</code> param of <code>goapp</code>, or <code>-A</code> of <code>appcfg.py</code> to override the application ID.</p>\n\n<hr>\n\n<p>So <code>goapp deploy</code> calls <code>appcfg.py</code> under the hood, it is a convenient method to hide <code>appcfg.py</code>.</p>\n\n<pre><code>goapp deploy -application &lt;YOUR_PROJECT_ID&gt; myapp/\n</code></pre>\n\n<p>Deploys the application located in the <code>myapp</code> folder. Configuration will be read from the <code>app.yaml</code> file that must be at <code>myapp/app.yaml</code>. The command also overrides the application ID (if present in <code>app.yaml</code>), and <code>&lt;YOUR_PROJECT_ID&gt;</code> will be used instead.</p>\n\n<pre><code>appcfg.py -A &lt;YOUR_PROJECT_ID&gt; -V v1 update myapp/\n</code></pre>\n\n<p>This also deploys the application, but the <code>-V</code> overrides the version that may be present in <code>myapp/app.yaml</code>, and will use the version <code>v1</code>. <code>-A</code> is used to override the ID from <code>app.yaml</code>, will be <code>&lt;YOUR_PROJECT_ID&gt;</code> in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "is_accepted": false, "score": 1, "last_activity_date": 1459273342, "creation_date": 1459273342, "answer_id": 36291387, "question_id": 36291105, "link": "https://stackoverflow.com/questions/36291105/difference-between-goapp-deploy-and-appcf-py-to-deploy-my-app-on-google-app/36291387#36291387", "title": "Difference between &#39;goapp deploy&#39; and &#39;appcf.py&#39; to deploy my app on Google App Engine?", "body": "<p><code>goapp</code> is a general tool for the whole Go-on-App-Engine workflow from build to deployment; you can use the same tool to install dependences (<code>get</code>), <code>build</code> your app, run locally (<code>serve</code>) and then <code>deploy</code> it (as well as run tests, format code, etc).</p>\n\n<p>Some of these wrap other tools: <code>goapp fmt</code> probably just wraps <code>gofmt</code>, whilst <code>goapp deploy</code> just wraps <code>appcfg.py update</code> (see <a href=\"https://cloud.google.com/appengine/docs/go/tools/uploadinganapp#Go_Uploading_the_app\" rel=\"nofollow\">docs</a>)</p>\n"}], "owner": {"reputation": 642, "user_id": 5610194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a3d84aa41bb9750ab3f01941f2cddfbc?s=128&d=identicon&r=PG&f=1", "display_name": "void42", "link": "https://stackoverflow.com/users/5610194/void42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 36291311, "answer_count": 2, "score": 1, "last_activity_date": 1459292108, "creation_date": 1459272511, "last_edit_date": 1459292108, "question_id": 36291105, "link": "https://stackoverflow.com/questions/36291105/difference-between-goapp-deploy-and-appcf-py-to-deploy-my-app-on-google-app", "title": "Difference between &#39;goapp deploy&#39; and &#39;appcf.py&#39; to deploy my app on Google App Engine?", "body": "<p>I don't understand the difference between</p>\n\n<pre><code>goapp deploy -application &lt;YOUR_PROJECT_ID&gt; myapp/\n</code></pre>\n\n<p>and</p>\n\n<pre><code>appcfg.py -A &lt;YOUR_PROJECT_ID_&gt; -V v1 update myapp/\n</code></pre>\n\n<p>when trying to deploy my app in google app engine. Can somebody enlighten me please?</p>\n"}, {"tags": ["go", "module"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1459269016, "post_id": 36289953, "comment_id": 60205268, "body": "A packages named <code>routes</code> must be in the directory <code>~&#47;server&#47;src&#47;routes</code>. You can&#39;t have multiple packages in a single directory."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 4, "creation_date": 1459269235, "post_id": 36289953, "comment_id": 60205451, "body": "Also read: <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#Workspaces</a> in full - import paths are covered here (via golang.org -&gt; Docs)."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459269284, "post_id": 36289953, "comment_id": 60205477, "body": "This sounds absurd to me. Why does go enforce an arbitrary project structure?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1459269369, "post_id": 36289953, "comment_id": 60205535, "body": "It makes it easier to reason about others&#39;s code: for any given directory, you can know that all Go source code within it is the same package. There&#39;s rarely deeply nested directories with hundreds of single-file modules in Go."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1459269517, "post_id": 36289953, "comment_id": 60205632, "body": "@dopatraman The Go Programming Language does not enforce any structure.  You can choose to run the compilers and linkers directly with any file structure you want.  The Go Tool does impose structure so it can do its job with no configuration expect the path to the workspace."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1459269820, "post_id": 36289953, "comment_id": 60205832, "body": "Read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>. The document covers the scenario you are asking about."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 1, "creation_date": 1459270601, "post_id": 36289953, "comment_id": 60206353, "body": "why was this downvoted??????? The golang docs are piss poor in this regard. thats why i had to resort to SO."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1459270978, "post_id": 36289953, "comment_id": 60206589, "body": "@dopatraman: what isn&#39;t clear in the documentation that people have linked to? <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a> explains exactly how GOPATH is structured, and how to structure your project to work with the Go tools."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 2, "creation_date": 1459270987, "post_id": 36289953, "comment_id": 60206593, "body": "I don&#39;t think the question should be downvoted, but the Go docs are actually very good in this regard."}], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459269336, "post_id": 36290077, "comment_id": 60205513, "body": "Why does the go compiler look for a <code>src</code> directory? The error i got mentioned ` ~/server/src/routes`"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1459269413, "post_id": 36290077, "comment_id": 60205560, "body": "Your <code>GOPATH</code> is likely set to <code>~&#47;server</code>."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459269436, "post_id": 36290077, "comment_id": 60205572, "body": "If you paste the exact error message I might be able to elaborate... it sounds like your GOPATH is set to <code>~&#47;server</code> maybe? or <code>.</code>"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459269467, "post_id": 36290077, "comment_id": 60205594, "body": "yes, but if thats the case, why does it look for <code>src&#47;</code>?? Also, how would placing my module in a <code>routes&#47;</code> directory solve the problem if the compiler looks for a <code>src&#47;</code> dir at the top level?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459269497, "post_id": 36290077, "comment_id": 60205618, "body": "Can you provide the output of <code>go env</code> ?"}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 4, "last_activity_date": 1459270865, "last_edit_date": 1459270865, "creation_date": 1459269298, "answer_id": 36290077, "question_id": 36289953, "link": "https://stackoverflow.com/questions/36289953/cannot-import-custom-go-module/36290077#36290077", "title": "Cannot import custom go module", "body": "<p>The \"<a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">How To Write Go Code</a>\" article is the recommended starting point right on the <a href=\"https://golang.org/doc/install\" rel=\"nofollow\">Getting Started</a> page which explains this. (thanks @elithrar)</p>\n\n<p>Peter Bourgon has a <a href=\"https://peter.bourgon.org/go-in-production/#repository-structure\" rel=\"nofollow\">good write up</a> on well structured Go applications.</p>\n\n<p>You should either have the <code>routes</code> package in a <code>routes</code> folder, or if your main package is in the routes folder you can have a <code>lib</code> folder within that folder with your actual <code>routes</code> package.</p>\n\n<p>The reason for the folder structure is due to how go <code>import</code> statements work.  It would be ambiguous to enable multiple packages in the same folder given the way imports work.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1459273030, "creation_date": 1459273030, "answer_id": 36291286, "question_id": 36289953, "link": "https://stackoverflow.com/questions/36289953/cannot-import-custom-go-module/36291286#36291286", "title": "Cannot import custom go module", "body": "<p>Move the routes package to <code>/Users/me/server/src/routes</code> and you should be good to go.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 36291286, "answer_count": 2, "score": -3, "last_activity_date": 1459273030, "creation_date": 1459268929, "last_edit_date": 1592644375, "question_id": 36289953, "link": "https://stackoverflow.com/questions/36289953/cannot-import-custom-go-module", "title": "Cannot import custom go module", "body": "<p>Here is my main file (server.go):</p>\n<pre><code>package main\n\nimport (\n    &quot;net/http&quot;\n    &quot;routes&quot;\n)\n\nfunc main() {\n    http.HandleFunc(&quot;/&quot;, routes.Handler)\n    http.ListenAndServe(&quot;:8000&quot;, nil)\n}\n</code></pre>\n<p>My routes module is in the same directory:</p>\n<pre><code>package routes\n\nfunc Handler(w http.ResponseWriter, r *http.Request) {\n    // stuff...\n}\n</code></pre>\n<p>When I run <code>go run server.go</code> I get this error:</p>\n<pre><code>server.go:6:5: cannot find package &quot;routes&quot; in any of:\n    /usr/local/Cellar/go/1.6/libexec/src/routes (from $GOROOT)\n    ~/server/src/routes (from $GOPATH)\n</code></pre>\n<p>When I place the code in <code>routes.go</code> into my <code>server.go</code> file, it runs fine. I cannot import the module. I have tried setting the <code>$GOPATH</code> variable to my current directory, I've tried rearranging my project directory to mimic the one <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">here</a>. I'm running out of options. It is strange that a language with such wide adoption has such poor documentation on how to do something that is relatively easy in almost every other language. Please help me figure out what I'm doing wrong.</p>\n<h1>UPDATE:</h1>\n<p>This is the output of <code>go env</code></p>\n<pre><code>GOARCH=&quot;amd64&quot;\nGOBIN=&quot;&quot;\nGOEXE=&quot;&quot;\nGOHOSTARCH=&quot;amd64&quot;\nGOHOSTOS=&quot;darwin&quot;\nGOOS=&quot;darwin&quot;\nGOPATH=&quot;/Users/me/server&quot;\nGORACE=&quot;&quot;\nGOROOT=&quot;/usr/local/Cellar/go/1.6/libexec&quot;\nGOTOOLDIR=&quot;/usr/local/Cellar/go/1.6/libexec/pkg/tool/darwin_amd64&quot;\nGO15VENDOREXPERIMENT=&quot;1&quot;\nCC=&quot;clang&quot;\nGOGCCFLAGS=&quot;-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common&quot;\nCXX=&quot;clang++&quot;\nCGO_ENABLED=&quot;1&quot;\n</code></pre>\n"}, {"tags": ["go", "enums", "iota"], "comments": [{"owner": {"reputation": 21272, "user_id": 52277, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/67498fd0e17d27cb9be0c107f306e378?s=128&d=identicon&r=PG", "display_name": "Michael Freidgeim", "link": "https://stackoverflow.com/users/52277/michael-freidgeim"}, "edited": false, "score": 0, "creation_date": 1616934975, "post_id": 36288890, "comment_id": 118152556, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/14426366/what-is-an-idiomatic-way-of-representing-enums-in-go\">What is an idiomatic way of representing enums in Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1459270158, "post_id": 36289084, "comment_id": 60206060, "body": "Or without syntax just &quot;const Stage1 = 1; varOfTypeFeeStage = Stage1&quot; can also work in certain circumstances."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 8, "last_activity_date": 1459266885, "last_edit_date": 1459266885, "creation_date": 1459266533, "answer_id": 36289084, "question_id": 36288890, "link": "https://stackoverflow.com/questions/36288890/enums-for-custom-types-in-go/36289084#36289084", "title": "ENUMs for custom types in GO", "body": "<p>There's no way beyond either using <code>iota</code> and automatic enums, or doing the most straightforward thing:</p>\n\n<pre><code>const(\n     Stage1 FeeStage = 1\n     Stage2 FeeStage = 2\n\n     // or another syntax with same results\n     Stage3 = FeeStage(2)\n)\n</code></pre>\n\n<p>which IMHO is less cumbersome than doing stuff like <code>iota + 5</code> which as you said is really bad.</p>\n\n<p>I usually either use iota if the value is not important beyond the context of the program, or explicit typing if I need the values to be used in a protocol or something. </p>\n\n<p>Though I have to say sometimes just using ints or strings is good enough, it depends on the context. See for example the <a href=\"https://golang.org/src/net/http/status.go\" rel=\"noreferrer\">http status codes in the standard library</a>. They don't have a special type. </p>\n"}, {"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 2, "last_activity_date": 1459266640, "creation_date": 1459266640, "answer_id": 36289124, "question_id": 36288890, "link": "https://stackoverflow.com/questions/36288890/enums-for-custom-types-in-go/36289124#36289124", "title": "ENUMs for custom types in GO", "body": "<p>You should maybe clarify what you're actually wanting to do with enumerated constants, but it looks like you're trying to assign arbitrary values to your custom type.</p>\n\n<p>Using <code>iota</code> doesn't need to be cumbersome if you structure your constants and the initialization to be ordered and to follow a pattern.  <a href=\"https://golang.org/doc/effective_go.html#constants\" rel=\"nofollow\">Effective Go</a> has a section on this too.</p>\n\n<p>You can create fairly complicated patterns for enumerated constants, which doesn't have to be error-prone and cumbersome.</p>\n"}, {"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1459275497, "post_id": 36291819, "comment_id": 60209397, "body": "that&#39;s a nice touch, but feels less readable to me personally - I think 2-3 consts is the limit for this being useful. and at 2-3 it&#39;s really nothing repeating the type. but it&#39;s a matter of taste. anyways, great answer!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1459276002, "post_id": 36291819, "comment_id": 60209677, "body": "@Not_a_Golfer I agree. I wouldn&#39;t use it myself, I would put it in 3 lines. But it&#39;s a possibility."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1459288779, "last_edit_date": 1459288779, "creation_date": 1459274563, "answer_id": 36291819, "question_id": 36288890, "link": "https://stackoverflow.com/questions/36288890/enums-for-custom-types-in-go/36291819#36291819", "title": "ENUMs for custom types in GO", "body": "<p>Actually there's a way. But let's clear some things first.</p>\n\n<p>In <a href=\"https://golang.org/ref/spec#Constant_declarations\" rel=\"nofollow\">constant declarations</a>, if the type is present, the constant will take the specified type:</p>\n\n<pre><code>const n int64 = 3 // n will be a typed constant, its type will be int64\n</code></pre>\n\n<p>If the type is omitted, the constant will take the type of the expression:</p>\n\n<pre><code>const x = int16(3) // x will be a typed constant, its type will be int16\n</code></pre>\n\n<p>If the expression is an untyped constant, the declared constant will remain untyped constant:</p>\n\n<pre><code>const i = 1 // i will be an untyped integer constant\n</code></pre>\n\n<p>Note that if you try to print <code>i</code>'s type (e.g. with <code>fmt.Printf(\"%T\", i)</code>, you will see <code>int</code>, and that's because when passing a constant to a function or when assigning it to a variable, it has to be converted to an actual type, and the default type will be used (because <code>fmt.Println()</code> has arguments type of <code>interface{}</code>) - which is <code>int</code> for an untyped integer constant.</p>\n\n<p>Within a parenthesized <code>const</code> declaration list the expression list may be omitted from declarations (except at the first). If the expression is missing, the previous non-empty expression will be used (textual substitution).</p>\n\n<p>So when you do this:</p>\n\n<pre><code>const(\n    Stage1 FeeStage = iota\n    Stage2 \n    Stage3\n)\n</code></pre>\n\n<p>It means:</p>\n\n<pre><code>const (\n    Stage1 FeeStage = iota\n    Stage2 FeeStage = iota\n    Stage3 FeeStage = iota\n)\n</code></pre>\n\n<p>Which results in 3 new constants: <code>Stage1</code>, <code>Stage2</code> and <code>Stage3</code>, all being of type <code>FreeStage</code>.</p>\n\n<p>Your second example:</p>\n\n<pre><code>const (\n    Stage1 FeeStage = iota           // 0\n    Stage2          = iota + 6       // 7\n    Stage3          = (iota - 3) * 5 // -5\n)\n</code></pre>\n\n<p>Since you didn't omit the expressions, <strong>ONLY</strong> your first constant <code>Stage1</code> will be a typed constant (of type <code>FreeStage</code>), the rest will be untyped constants! So this doesn't even qualify (doesn't comply with your requirements)!</p>\n\n<p>And now to your point: you want something like this:</p>\n\n<pre><code>const(\n    Stage1 FeeStage = 1\n    Stage2          = 2\n    Stage3          = 2\n)\n</code></pre>\n\n<p>As stated above, if you leave out the type, <code>Stage2</code> and <code>Stage3</code> will be untyped constants. So type must be specified, you may take advantage of the fact that a const specification is:</p>\n\n<pre><code>ConstSpec      = IdentifierList [ [ Type ] \"=\" ExpressionList ] .\n</code></pre>\n\n<p>You may specify an identifier <em>list</em>:</p>\n\n<pre><code>const(\n    Stage1, Stage2, Stage3 FeeStage = 1, 2, 2\n)\n</code></pre>\n\n<p>Is this more readable? Maybe if there are a few constants only. If there are many, use Not_a_Golfer's recommendation:</p>\n\n<pre><code>const(\n    Stage1 FeeStage = 1\n    Stage2 FeeStage = 2\n    Stage3 FeeStage = 2\n)\n</code></pre>\n"}], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4164, "favorite_count": 0, "accepted_answer_id": 36289084, "answer_count": 3, "score": 4, "last_activity_date": 1536322176, "creation_date": 1459265974, "last_edit_date": 1536322176, "question_id": 36288890, "link": "https://stackoverflow.com/questions/36288890/enums-for-custom-types-in-go", "title": "ENUMs for custom types in GO", "body": "<p>I am trying to generate an enum for a type I defined</p>\n\n<pre><code>type FeeStage int\n</code></pre>\n\n<p>From <a href=\"https://stackoverflow.com/questions/14426366/what-is-an-idiomatic-way-of-representing-enums-in-golang\">this</a> I learned that I can use iota to create an enum based on this type</p>\n\n<pre><code>const(\n     Stage1 FeeStage = iota\n     Stage2 \n     Stage3\n)\n</code></pre>\n\n<p>However, manipulating the actual values of the enum is rather cumbersome and error prone</p>\n\n<pre><code>const(\n     Stage1 FeeStage = iota           // 0\n     Stage2          = iota + 6       // 7\n     Stage3          = (iota - 3) * 5 // -5\n)\n</code></pre>\n\n<p>Is there a way to automatically convert a list of ENUMs with custom values to a certain type. This is what I was using before but only converts the first member of the constant to the custom type.</p>\n\n<pre><code>const(\n     Stage1 FeeStage = 1\n     Stage2          = 2\n     Stage3          = 2\n)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/J8s6uchndh\" rel=\"nofollow noreferrer\">Here</a> is a playground with a similar result</p>\n"}, {"tags": ["mysql", "validation", "date", "go", "time"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 4, "creation_date": 1459265262, "post_id": 36288126, "comment_id": 60202793, "body": "Call time.Parse with a layout string such as &quot;2006-01-02 15:04:05.999&quot; on your time string. If that results in a valid time.Time value and no error then you&#39;re string should work in the db. I don&#39;t use MySQL but between PostgreSQL and Go you can pass around timestamps and time.Time values without converting to strings... so maybe that simplifies your problem. Covert the string in Go using time.Parse and then write the time.Time value to the db."}, {"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1459323454, "post_id": 36288126, "comment_id": 60228992, "body": "Thanks @Snowman. This is exactly what I was looking for..."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1459343448, "post_id": 36288126, "comment_id": 60242995, "body": "glad to help. I posted that comment as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 0, "creation_date": 1459264515, "post_id": 36288226, "comment_id": 60202247, "body": "Thanks for the quick response, but I want to do the check inside Go code."}], "tags": [], "owner": {"reputation": 5667, "user_id": 5875887, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/3fQa0.jpg?s=128&g=1", "display_name": "Dylan Su", "link": "https://stackoverflow.com/users/5875887/dylan-su"}, "is_accepted": false, "score": 2, "last_activity_date": 1459264243, "creation_date": 1459264243, "answer_id": 36288226, "question_id": 36288126, "link": "https://stackoverflow.com/questions/36288126/golang-how-to-validate-a-mysql-timestamp-string/36288226#36288226", "title": "Golang: How to validate a MySQL timestamp string", "body": "<p>You can use <code>TIMESTAMP()</code> to convert the string to <code>timestamp</code>. If it can be converted to a valid timestamp, it is valid. If converted to <code>NULL</code>, then it is not a void timestamp string.</p>\n\n<p>Use:</p>\n\n<pre><code>TIMESTAMP('2016-03-28 12:17:30.022') IS NOT NULL\n</code></pre>\n\n<h1>Demo</h1>\n\n<pre><code>mysql&gt; select TIMESTAMP('2016-03-28 12:17:30.022'), TIMESTAMP('2016-03-28 12:17:300.022');\n+--------------------------------------+---------------------------------------+\n| TIMESTAMP('2016-03-28 12:17:30.022') | TIMESTAMP('2016-03-28 12:17:300.022') |\n+--------------------------------------+---------------------------------------+\n| 2016-03-28 12:17:30.022              | NULL                                  |\n+--------------------------------------+---------------------------------------+\n1 row in set, 1 warning (0.00 sec)\n\nmysql&gt; select TIMESTAMP('2016-03-28 12:17:30.022') IS NOT NULL, TIMESTAMP('2016-03-28 12:17:300.022') IS NOT NULL;\n+--------------------------------------------------+---------------------------------------------------+\n| TIMESTAMP('2016-03-28 12:17:30.022') IS NOT NULL | TIMESTAMP('2016-03-28 12:17:300.022') IS NOT NULL |\n+--------------------------------------------------+---------------------------------------------------+\n|                                                1 |                                                 0 |\n+--------------------------------------------------+---------------------------------------------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "is_accepted": false, "score": 1, "last_activity_date": 1459326573, "last_edit_date": 1495541272, "creation_date": 1459323337, "answer_id": 36302449, "question_id": 36288126, "link": "https://stackoverflow.com/questions/36288126/golang-how-to-validate-a-mysql-timestamp-string/36302449#36302449", "title": "Golang: How to validate a MySQL timestamp string", "body": "<p>As @Snowman pointed out in his comment, one solution is by using a layout string and <code>time.Parse()</code></p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"time\"\n)\n\nfunc main() {\n\n  timestamp    := \"2016-03-28 11:50:50.476\"\n  const layout  = \"2006-01-02 03:04:05.999\"\n\n  _, error := time.Parse(layout, timestamp)\n\n  if error != nil {\n    fmt.Println(error)\n  } else {\n    fmt.Println(\"valid!\")\n  }\n}\n</code></pre>\n\n<p><strong>Demo:</strong> <a href=\"https://play.golang.org/p/6bcciN_OAb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6bcciN_OAb</a>\n<br> Also check: <a href=\"https://stackoverflow.com/questions/6589636/date-parsing-in-go\">Date parsing in Go</a></p>\n"}, {"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": true, "score": 6, "last_activity_date": 1459343345, "creation_date": 1459343345, "answer_id": 36309832, "question_id": 36288126, "link": "https://stackoverflow.com/questions/36288126/golang-how-to-validate-a-mysql-timestamp-string/36309832#36309832", "title": "Golang: How to validate a MySQL timestamp string", "body": "<p>Call time.Parse with a layout string such as \"2006-01-02 15:04:05.999\"\non your time string. If that results in a valid time.Time value and no error then your string should work in the db. </p>\n\n<pre><code>timeStamp, err := time.Parse(\"2006-01-02 15:04:05.999\", yourTimeString)\n    if err != nil {\n        // do something with err...\n    }\n// do something with timeStamp...\n</code></pre>\n\n<p>I don't use MySQL but between PostgreSQL and Go you can pass around timestamps and time.Time values without converting to strings... so maybe that simplifies your problem. Covert the string in Go using time.Parse and then write the time.Time value to the db.</p>\n"}], "owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3670, "favorite_count": 0, "accepted_answer_id": 36309832, "answer_count": 3, "score": 2, "last_activity_date": 1504684813, "creation_date": 1459264036, "last_edit_date": 1504684813, "question_id": 36288126, "link": "https://stackoverflow.com/questions/36288126/golang-how-to-validate-a-mysql-timestamp-string", "title": "Golang: How to validate a MySQL timestamp string", "body": "<p>How can we check that a string considered to be a MySQL TIMESTAMP is actually valid? The format used is:</p>\n\n<p><code>YYYY-MM-DD HH:MM:SS[.fraction]</code> where \"fraction\" has 3 digits.</p>\n\n<p>For example <code>2016-03-28 12:17:30.022</code> should be valid. Preferably I would like to avoid regex and use <code>time.Parse()</code> but any other suggestion is welcome.</p>\n"}, {"tags": ["go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "edited": false, "score": 0, "creation_date": 1459263554, "post_id": 36287515, "comment_id": 60201538, "body": "I forgot to mention that I am using <a href=\"https://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/net/websocket</a> not gorilla"}, {"owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "edited": false, "score": 0, "creation_date": 1459263754, "post_id": 36287515, "comment_id": 60201682, "body": "Oh, that is a shame. Could you add this edit to your message so I could accept it as an answer?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1459263789, "last_edit_date": 1459263789, "creation_date": 1459262393, "answer_id": 36287515, "question_id": 36287397, "link": "https://stackoverflow.com/questions/36287397/close-websocket-connection-with-a-message/36287515#36287515", "title": "Close Websocket connection with a message", "body": "<p>Send a <a href=\"https://godoc.org/github.com/gorilla/websocket#FormatCloseMessage\" rel=\"nofollow\">close message</a> before closing the connection:</p>\n\n<pre><code> cm := websocket.FormatCloseMessage(websocket.CloseNormalClosure, \"add your message here\")\n if err := c.WriteMessage(websocket.CloseMessage, cm); err != nil {\n     // handle error\n }\n c.Close()\n</code></pre>\n\n<p>It is not possible to specify the close message with the golang.org/x/net/websocket package.</p>\n"}], "owner": {"reputation": 4705, "user_id": 562465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f01d5241604fe5419279afc0d11e739d?s=128&d=identicon&r=PG", "display_name": "Rob Fox", "link": "https://stackoverflow.com/users/562465/rob-fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1337, "favorite_count": 0, "accepted_answer_id": 36287515, "answer_count": 1, "score": 1, "last_activity_date": 1459263789, "creation_date": 1459262079, "last_edit_date": 1459263597, "question_id": 36287397, "link": "https://stackoverflow.com/questions/36287397/close-websocket-connection-with-a-message", "title": "Close Websocket connection with a message", "body": "<p>How is it possible to close a websocket connection and pass it a message / code?</p>\n\n<p>The docs only define <code>func (ws *Conn) Close() error</code> without any arguments</p>\n\n<p>I would like to receive the event from JavaScript like this:</p>\n\n<pre><code>websocket.onclose = function(event) {\n  console.log(event);\n};\n</code></pre>\n\n<p>I am using <a href=\"https://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow\">golang.org/x/net/websocket</a></p>\n"}, {"tags": ["javascript", "go", "merge", "rethinkdb", "nosql"], "answers": [{"tags": [], "owner": {"reputation": 554, "user_id": 595810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3772bef568ee12d860832bb2fa113745?s=128&d=identicon&r=PG", "display_name": "Daniel Cannon", "link": "https://stackoverflow.com/users/595810/daniel-cannon"}, "is_accepted": false, "score": 1, "last_activity_date": 1459292622, "creation_date": 1459292622, "answer_id": 36296675, "question_id": 36287265, "link": "https://stackoverflow.com/questions/36287265/go-merge-in-go-rethinkdb/36296675#36296675", "title": "go - Merge in Go RethinkDB", "body": "<p>Copied my answer from <a href=\"https://github.com/dancannon/gorethink/issues/291\" rel=\"nofollow\">https://github.com/dancannon/gorethink/issues/291</a></p>\n\n<p>You should be able to convert your JS query to Go by using the subquery without calling <code>Run</code>. For example:</p>\n\n<pre><code>r.Table(table)\n.Filter(map[string]interface{}{\"idUser\": idU})\n.OrderBy(r.Desc(\"created_at\"))\n.Merge(func(quote r.Term){\n    article := r.Table(\"article\").Get(quote.Field(\"idArticle\"))\n    return map[string]interface{}{\n        \"tags\": map[string]interface{}{\n            \"keywords\": article(\"keywords\"),\n        },\n    }\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "is_accepted": true, "score": 0, "last_activity_date": 1459308221, "creation_date": 1459308221, "answer_id": 36299067, "question_id": 36287265, "link": "https://stackoverflow.com/questions/36287265/go-merge-in-go-rethinkdb/36299067#36299067", "title": "go - Merge in Go RethinkDB", "body": "<p>Thank you very much. I managed to solve the panicking error</p>\n\n<p>True answer is:</p>\n\n<pre><code>result,err:=r.Table(\"quote\").Filter(r.Row.Field(\"idUser\").Eq(idUser)).\n        OrderBy(r.Desc(\"created_at\")).\n        Merge(func(quote r.Term) interface{}{\n            fmt.Println(quote.Field(\"idArticle\"))\n            article:=r.Table(\"article\").Get(quote.Field(\"idArticle\"))\n            return map[string]interface{}{\n                \"tags\":map[string]interface{}{\n                    \"keywords\":article.Field(\"keywords\"),\n                },\n            }\n        }).\n        Run(config.Connection())\n</code></pre>\n\n<p>I got panicked because of last night's statement of returned address for cursor result:\nIt was:\n<code>var all map[string]interface{}</code>\nWhile it should be:\n<code>var all []interface{}</code>\nThen it panicked in <code>err=result.All(&amp;all)</code></p>\n"}], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "accepted_answer_id": 36299067, "answer_count": 2, "score": 0, "last_activity_date": 1504509257, "creation_date": 1459261746, "last_edit_date": 1506103282, "question_id": 36287265, "link": "https://stackoverflow.com/questions/36287265/go-merge-in-go-rethinkdb", "title": "go - Merge in Go RethinkDB", "body": "<p>I've been struggling to get used to <code>Merge</code> of <code>gorethink</code> (RethinkDB's driver in Go)</p>\n\n<pre><code>result,err:=r.Table(\"quote\").GetAllByIndex(\"idUser\",idUser).\n        OrderBy(r.Desc(\"created_at\")).Merge(func(row r.Term) interface{}{\n            res,_:=r.Table(\"article\").Get(row.Field(\"idArticle\")).Run(session)\n            // TODO\n            return map[string]interface{}{\n                // TODO\n            }\n        }).Run(session)\n</code></pre>\n\n<p>I have 3 collections: <code>article</code>, <code>quote</code>, and <code>user</code></p>\n\n<p>With the above function I intend to:</p>\n\n<ul>\n<li>Query all quote documents by idUser</li>\n<li>With each quote I get, I want to use its respective idArticle field to query in article collection</li>\n<li>After getting the appropriate document using idArticle, I use it to query that document's keywords fields</li>\n<li>Finally, I merge keywords array to each quote document</li>\n</ul>\n\n<p>In JavaScript API for RethinkDB, I implemented like this:</p>\n\n<pre><code>findAllByUser = function(idU){\n        return r.table(table)\n        .filter({idUser: idU})\n        .orderBy(r.desc('created_at'))\n        .merge(function(quote){\n            var article = r.table('article').get(quote('idArticle'));\n            return {\n                tags: {keywords: article('keywords')}\n            }\n        })\n        .run(connection)\n        .then(function(result){\n            return result.toArray();\n        });\n    }\n</code></pre>\n\n<p>But I still haven't managed to do the same in gorethink. How can I get the value of <code>Term</code> <code>row.Field(\"idArticle\")</code> and use it for later queries and <code>Merge</code>?</p>\n"}, {"tags": ["arrays", "pointers", "go", "struct", "slice"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1459260032, "post_id": 36286331, "comment_id": 60198811, "body": "<i>&quot;I want to make a function on a struct which possess a slice.&quot;</i> But your receiver is not a <code>struct</code>, it&#39;s a <code>*CampaignIndexMemory</code>, i.e. a pointer to a slice of <code>CampaignIndex</code>es."}, {"owner": {"reputation": 99, "user_id": 6077258, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-M_m1jAgxY80/AAAAAAAAAAI/AAAAAAAAABk/5BaP46al-xs/photo.jpg?sz=128", "display_name": "J&#233;r&#233;my Bricout", "link": "https://stackoverflow.com/users/6077258/j%c3%a9r%c3%a9my-bricout"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1459260714, "post_id": 36286331, "comment_id": 60199330, "body": "I just transformed my type into struct and it works well. Thanks. This is my new code :         type CampaignIndexMemory struct {indexes []CampaignIndex}  And I just have to replace all my c[i] by c.indexes[i]"}], "answers": [{"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": false, "score": 0, "last_activity_date": 1459260809, "creation_date": 1459260809, "answer_id": 36286899, "question_id": 36286331, "link": "https://stackoverflow.com/questions/36286331/go-interface-slice-and-pointer/36286899#36286899", "title": "Go interface slice and pointer", "body": "<p>Methods are defined on types. <code>CampaignIndexMemory</code> is not a <code>struct</code> but a <code>type</code>. The type is \"slice of <code>CampaignIndex</code>\".</p>\n\n<p>From <a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"nofollow\">documentation about slices</a></p>\n\n<blockquote>\n  <p>Slices hold references to an underlying array, and if you assign one\n  slice to another, both refer to the same array. If a function takes a\n  slice argument, changes it makes to the elements of the slice will be\n  visible to the caller, analogous to passing a pointer to the\n  underlying array.</p>\n</blockquote>\n\n<p>Which implies your receiver for method <code>setCampaignIndex</code> could be a <code>slice</code> rather than a pointer to a slice. The changes will be applied to the caller.</p>\n\n<pre><code>func (c CampaignIndexMemory) setCampaignIndex(object CampaignIndex) {\n</code></pre>\n\n<p>Pointers to a slice points to the <a href=\"https://golang.org/pkg/reflect/#SliceHeader\" rel=\"nofollow\">slice header</a> so I guess the error you got is because slice header does not contain a <code>Object</code> field.</p>\n"}], "owner": {"reputation": 99, "user_id": 6077258, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-M_m1jAgxY80/AAAAAAAAAAI/AAAAAAAAABk/5BaP46al-xs/photo.jpg?sz=128", "display_name": "J&#233;r&#233;my Bricout", "link": "https://stackoverflow.com/users/6077258/j%c3%a9r%c3%a9my-bricout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459260809, "creation_date": 1459259400, "question_id": 36286331, "link": "https://stackoverflow.com/questions/36286331/go-interface-slice-and-pointer", "title": "Go interface slice and pointer", "body": "<p>I want to make a function on a struct which possess a slice.\nMy problem is : I want to use a pointer argument because I have to modify my struct content.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>type CampaignIndexMemory []CampaignIndex\n\ntype CampaignIndex struct {\n    Objects []CampaignIndexObject\n}\n\ntype CampaignIndexObject struct {\n    //They don't really care about us\n}\n\nfunc (c *CampaignIndexMemory) setCampaignIndex(object CampaignIndex) {\n\n    valueSet := false\n    for i,_ := range c {\n        if c[i].Objects[0].ID == object.Objects[0].ID {\n            c[i] = object\n            valueSet = false\n            break\n        }\n    }\n    if valueSet {\n        c = append(c, object)\n    }\n}\n</code></pre>\n\n<p>I'm from the Java world (I'm deeply sorry) so maybe my way of proceeding wrong.</p>\n\n<p>With this code, the compilation is in error and says \"unresolved reference\" on my \"Objects\" attribute.</p>\n\n<p>My question is simple : What's going on ?</p>\n\n<p>Thanks for your help, your time and your kindness :)</p>\n"}, {"tags": ["memory", "time", "go", "sleep"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1459257973, "post_id": 36283788, "comment_id": 60197178, "body": "Time.Sleep does not &quot;increase memory&quot;. Memory consumption or usage, what actually is used, when or what memory is released or returned to the OS is very complicated."}, {"owner": {"reputation": 1, "user_id": 3283107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe771dd760a4da99a783b9797bd2ba6?s=128&d=identicon&r=PG&f=1", "display_name": "user3283107", "link": "https://stackoverflow.com/users/3283107/user3283107"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1459275766, "post_id": 36283788, "comment_id": 60209549, "body": "Using time.Timer did the trick. I believe you when you say it&#39;s complicated."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1459276612, "post_id": 36283788, "comment_id": 60210040, "body": "Just watch the output of gctrace to see what the GC is doing. Sleep requires a small allocation, and those eventually need to be cleaned up. If you&#39;re doing any real &quot;work&quot;, it probably requires some allocations which need to be clean up. The GC isn&#39;t instantaneous, it waits until some threshold is reached before it is run, and hence the heap grows somewhat before leveling off."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3283107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe771dd760a4da99a783b9797bd2ba6?s=128&d=identicon&r=PG&f=1", "display_name": "user3283107", "link": "https://stackoverflow.com/users/3283107/user3283107"}, "edited": false, "score": 0, "creation_date": 1459254439, "post_id": 36284059, "comment_id": 60194315, "body": "removing the <code>default:</code> and using instead <code>case &lt;-time.After(time.Millisecond * 10):</code> still increase the mem usage over time. I guess it&#39;s something internal to the time pkg."}], "tags": [], "owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "is_accepted": false, "score": -1, "last_activity_date": 1459253860, "creation_date": 1459253860, "answer_id": 36284059, "question_id": 36283788, "link": "https://stackoverflow.com/questions/36283788/go-time-sleep-and-memory-usage/36284059#36284059", "title": "Go: time.sleep and memory usage", "body": "<p>You can implement a timeout using a <code>select</code> and receive from <code>&lt;-time.After()</code>:</p>\n\n<pre><code>select {\n  case res := &lt;-c:\n    fmt.Println(\"do some work\")\n  case &lt;-time.After(time.Second * 1):\n    fmt.Println(\"timeout\")\n}\n</code></pre>\n\n<p>In case you want to understand how your program is utilizing memory you can do profiling. <a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"nofollow\">Here</a> is a nice article about this topic.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3283107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe771dd760a4da99a783b9797bd2ba6?s=128&d=identicon&r=PG&f=1", "display_name": "user3283107", "link": "https://stackoverflow.com/users/3283107/user3283107"}, "is_accepted": true, "score": -2, "last_activity_date": 1459266694, "creation_date": 1459266694, "answer_id": 36289148, "question_id": 36283788, "link": "https://stackoverflow.com/questions/36283788/go-time-sleep-and-memory-usage/36289148#36289148", "title": "Go: time.sleep and memory usage", "body": "<p>After some time researching, I achieved it with the following code.</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n)\n\nfunc main() {\n    c := make(chan bool)\n    timer := time.NewTimer(0)\n    for {\n        select {\n        case &lt;-c:\n        default:\n            timer.Reset(time.Millisecond * 1)\n            &lt;-timer.C\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3283107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe771dd760a4da99a783b9797bd2ba6?s=128&d=identicon&r=PG&f=1", "display_name": "user3283107", "link": "https://stackoverflow.com/users/3283107/user3283107"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 36289148, "answer_count": 2, "score": -3, "last_activity_date": 1459275654, "creation_date": 1459253070, "last_edit_date": 1459275654, "question_id": 36283788, "link": "https://stackoverflow.com/questions/36283788/go-time-sleep-and-memory-usage", "title": "Go: time.sleep and memory usage", "body": "<p>When running the code below, the program starts at around 1.5M and then gradually grows until 6.4M. I'm wondering why. \nRemoving <em>time.sleep</em> fixes the issue.</p>\n\n<p>Is there a way to use the for-select pattern with a default and sleep some time in the default without any mem change?</p>\n\n<p>Calling <em>runtime.GC()</em> after the sleep does fix the issue. Can we achieve the same thing without having to call the GC ?</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n)\n\nfunc main() {\n    c := make(chan struct{})\n    for {\n        select {\n        case &lt;-c:\n            //some work\n        default:\n            //some work\n            time.Sleep(time.Millisecond * 1)\n        }\n    }\n}\n</code></pre>\n\n<p>Same with :</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n)\n\nfunc main() {\n    c := make(chan struct{})\n    for {\n        select {\n        case &lt;-c:\n        case &lt;-time.After(time.Millisecond * 10):\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>After some time researching, I achieved it with the following code. Still wonder why time.sleep increases mem usage?</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n)\n\nfunc main() {\n    c := make(chan bool)\n    timer := time.NewTimer(0)\n    for {\n        select {\n        case &lt;-c:\n        default:\n            timer.Reset(time.Millisecond * 1)\n            &lt;-timer.C\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "developer-tools"], "comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 2, "creation_date": 1459252538, "post_id": 36283459, "comment_id": 60192892, "body": "Starting with Go 1.6 the traceback is shorter by default, are you using Go 1.6? <a href=\"https://tip.golang.org/pkg/runtime/debug/#SetTraceback\" rel=\"nofollow noreferrer\">tip.golang.org/pkg/runtime/debug/#SetTraceback</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1459255901, "post_id": 36283459, "comment_id": 60195470, "body": "Besides using the shorter tracebacks in go1.6, why are you panicking so often that this is an issue? (you can also just output to a file and read the top of the file if you want)"}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 1034255, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08361c2fe2bb01912c7a64ac848db2fd?s=128&d=identicon&r=PG", "display_name": "jupp0r", "link": "https://stackoverflow.com/users/1034255/jupp0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1459315201, "creation_date": 1459315201, "answer_id": 36300300, "question_id": 36283459, "link": "https://stackoverflow.com/questions/36283459/avoiding-scrolling-up-when-developing-in-go/36300300#36300300", "title": "Avoiding scrolling up when developing in Go", "body": "<p>You can pipe the output of your program to a file</p>\n\n<pre><code>./program 2&gt;&amp;1 &gt; log.txt\n</code></pre>\n\n<p>or to a program that lets you view the buffer head first</p>\n\n<pre><code>./program 2&gt;&amp;1 | less\n</code></pre>\n\n<p>The <code>2&gt;&amp;1</code> part combines stdout and stderr, so you get regular program output and error messages in the same buffer.</p>\n"}], "owner": {"reputation": 8224, "user_id": 985383, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/anF0k.png?s=128&g=1", "display_name": "piggyback", "link": "https://stackoverflow.com/users/985383/piggyback"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1459335725, "answer_count": 1, "score": 0, "last_activity_date": 1459315201, "creation_date": 1459252230, "question_id": 36283459, "link": "https://stackoverflow.com/questions/36283459/avoiding-scrolling-up-when-developing-in-go", "closed_reason": "Opinion-based", "title": "Avoiding scrolling up when developing in Go", "body": "<p>Iam writing go and I am having 300 go routines running at the same time.</p>\n\n<p>When one of them crashes the print log becomes incredibly long and I endup scrolling up every time (I only need to see the last line of my log and the first go routine failing).</p>\n\n<p>How are you making your developer experience nicer in go?</p>\n"}, {"tags": ["mysql", "logging", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 1307077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fdb213b33de26b2af73bf35352e7e1?s=128&d=identicon&r=PG", "display_name": "Drunk_Debugger", "link": "https://stackoverflow.com/users/1307077/drunk-debugger"}, "is_accepted": false, "score": 1, "last_activity_date": 1459246924, "creation_date": 1459246924, "answer_id": 36281571, "question_id": 36281394, "link": "https://stackoverflow.com/questions/36281394/golang-gorm-access-the-underlying-mysql-query/36281571#36281571", "title": "golang gorm Access the underlying mysql query", "body": "<p>You can pass your own logger to gorm using gorm.SetLogger method. It uses the Print method of the logger to print logs as well as SQL queries. The log level of Print method for any logger(logrus/go's inbuild logger) is generally set to INFO. While passing the logger to gorm, if you set the log level to anything below or equal to INFO(DEBUG/INFO) you can see the sql queries and other logs by gorm</p>\n\n<p>Also you can parse the log level from a config file where you can set it based on environment</p>\n"}, {"tags": [], "owner": {"reputation": 1037, "user_id": 2730407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ea8cbda44bec55c4db6250eff89bbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Ronna", "link": "https://stackoverflow.com/users/2730407/ronna"}, "is_accepted": true, "score": 55, "last_activity_date": 1459251590, "creation_date": 1459251590, "answer_id": 36283242, "question_id": 36281394, "link": "https://stackoverflow.com/questions/36281394/golang-gorm-access-the-underlying-mysql-query/36283242#36283242", "title": "golang gorm Access the underlying mysql query", "body": "<p>This will do the trick:</p>\n\n<pre><code>db, err:= Open(dbType, connectionDSN);\ndb.LogMode(true)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 1, "last_activity_date": 1614253948, "creation_date": 1614253948, "answer_id": 66367950, "question_id": 36281394, "link": "https://stackoverflow.com/questions/36281394/golang-gorm-access-the-underlying-mysql-query/66367950#66367950", "title": "golang gorm Access the underlying mysql query", "body": "<p>In GORM v1:</p>\n<pre><code>db, err:= Open(dbType, connectionDSN);\ndb.LogMode(true)\n</code></pre>\n<p>In GORM v2, use the <a href=\"https://gorm.io/docs/logger.html\" rel=\"nofollow noreferrer\"><code>Logger</code></a> interface:</p>\n<pre><code>db, err := gorm.Open(mysql.Open(connectionDSN), &amp;gorm.Config{\n    Logger: logger.Default.LogMode(logger.Info),\n})\n</code></pre>\n<p>Note: this is not specific to MySQL and will work with any other DB driver (e.g. Postgres, SQLite, etc.).</p>\n"}], "owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17375, "favorite_count": 7, "accepted_answer_id": 36283242, "answer_count": 3, "score": 34, "last_activity_date": 1614253948, "creation_date": 1459246492, "question_id": 36281394, "link": "https://stackoverflow.com/questions/36281394/golang-gorm-access-the-underlying-mysql-query", "title": "golang gorm Access the underlying mysql query", "body": "<p>Is there a way to get the sql query log from <a href=\"https://github.com/jinzhu/gorm\" rel=\"noreferrer\">https://github.com/jinzhu/gorm</a>?</p>\n\n<p>e.g. in dev environment, it would be useful to be able to log to the console the mysql queries that have been called.</p>\n\n<p>e.g. how to get the underlying sql query log for the following queries:</p>\n\n<pre><code>gorm.Find(&amp;todos)\ngorm.Preload(\"User\").Find(&amp;todos)\n</code></pre>\n\n<p>I am aware that I can call:</p>\n\n<pre><code>gorm.Debug().Find(&amp;todos)\ngorm.Debug().Preload(\"User\").Find(&amp;todos)\n</code></pre>\n\n<p>but I would like to only call <code>Debug()</code> if in dev envrionment and not in production</p>\n"}, {"tags": ["go", "build", "blockchain", "hyperledger"], "comments": [{"owner": {"reputation": 248, "user_id": 5510414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CyqIu.png?s=128&g=1", "display_name": "Will_Z", "link": "https://stackoverflow.com/users/5510414/will-z"}, "edited": false, "score": 0, "creation_date": 1459242981, "post_id": 36280024, "comment_id": 60186421, "body": "there is noting under /home/vagrant/go.what should $GOPATH be?"}, {"owner": {"reputation": 121, "user_id": 10059436, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Pz5qoM4kyo0/AAAAAAAAAAI/AAAAAAAAEaE/nPkraLHg4FA/photo.jpg?sz=128", "display_name": "Pronoy Chaudhuri", "link": "https://stackoverflow.com/users/10059436/pronoy-chaudhuri"}, "edited": false, "score": 0, "creation_date": 1531429158, "post_id": 36280024, "comment_id": 89605366, "body": "this is a very interesting problem"}], "answers": [{"comments": [{"owner": {"reputation": 248, "user_id": 5510414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CyqIu.png?s=128&g=1", "display_name": "Will_Z", "link": "https://stackoverflow.com/users/5510414/will-z"}, "edited": false, "score": 0, "creation_date": 1459247527, "post_id": 36281353, "comment_id": 60189527, "body": "yes. you are correct. it is necessary to Configure RocksDB related deps and flags for RocksDB."}, {"owner": {"reputation": 21, "user_id": 1307077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fdb213b33de26b2af73bf35352e7e1?s=128&d=identicon&r=PG", "display_name": "Drunk_Debugger", "link": "https://stackoverflow.com/users/1307077/drunk-debugger"}, "reply_to_user": {"reputation": 248, "user_id": 5510414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CyqIu.png?s=128&g=1", "display_name": "Will_Z", "link": "https://stackoverflow.com/users/5510414/will-z"}, "edited": false, "score": 0, "creation_date": 1459248703, "post_id": 36281353, "comment_id": 60190294, "body": "Yes. Or you can install gorocksdb with all the libraries embedded using &#39;go get -tags=embed github.com/tecbot/gorocksdb&#39;  Check here <a href=\"https://github.com/tecbot/gorocksdb#install\" rel=\"nofollow noreferrer\">github.com/tecbot/gorocksdb#install</a>"}], "tags": [], "owner": {"reputation": 21, "user_id": 1307077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fdb213b33de26b2af73bf35352e7e1?s=128&d=identicon&r=PG", "display_name": "Drunk_Debugger", "link": "https://stackoverflow.com/users/1307077/drunk-debugger"}, "is_accepted": false, "score": 1, "last_activity_date": 1459246380, "creation_date": 1459246380, "answer_id": 36281353, "question_id": 36280024, "link": "https://stackoverflow.com/questions/36280024/go-build-fail-fatal-error-rocksdb-c-h/36281353#36281353", "title": "Go build fail, fatal error: rocksdb/c.h", "body": "<p>Looks like you haven't installed rocksdb library</p>\n"}, {"tags": [], "owner": {"reputation": 248, "user_id": 5510414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CyqIu.png?s=128&g=1", "display_name": "Will_Z", "link": "https://stackoverflow.com/users/5510414/will-z"}, "is_accepted": true, "score": 0, "last_activity_date": 1459252420, "last_edit_date": 1459252420, "creation_date": 1459247480, "answer_id": 36281767, "question_id": 36280024, "link": "https://stackoverflow.com/questions/36280024/go-build-fail-fatal-error-rocksdb-c-h/36281767#36281767", "title": "Go build fail, fatal error: rocksdb/c.h", "body": "<p>I followed here and it is done.\n<a href=\"https://github.com/openblockchain/obc-peer/issues/885\" rel=\"nofollow\">https://github.com/openblockchain/obc-peer/issues/885</a></p>\n\n<p>Configure RocksDB related deps</p>\n\n<pre><code>sudo apt-get install -y libsnappy-dev\nsudo apt-get install -y zlib1g-dev\nsudo apt-get install -y libbz2-dev\n</code></pre>\n\n<p>Run go install - CGO flags for RocksDB</p>\n\n<pre><code>cd $GOPATH/src/github.com/openblockchain/obc-peer\nCGO_CFLAGS=\"-I/opt/rocksdb/include\" CGO_LDFLAGS=\"-L/opt/rocksdb -lrocksdb -lstdc++ -lm -lz -lbz2 -lsnappy\" go install\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1758, "user_id": 4627552, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/PKXU2.jpg?s=128&g=1", "display_name": "Clyde D&#39;Cruz", "link": "https://stackoverflow.com/users/4627552/clyde-dcruz"}, "is_accepted": false, "score": 0, "last_activity_date": 1462185756, "creation_date": 1462185756, "answer_id": 36980526, "question_id": 36280024, "link": "https://stackoverflow.com/questions/36280024/go-build-fail-fatal-error-rocksdb-c-h/36980526#36980526", "title": "Go build fail, fatal error: rocksdb/c.h", "body": "<p>You need to set LD_LIBRARY_PATH using </p>\n\n<pre><code>export LD_LIBRARY_PATH=/opt/rocksdb\n</code></pre>\n\n<p>before executing </p>\n\n<pre><code>CGO_CFLAGS=\"-I/opt/rocksdb/include\" CGO_LDFLAGS=\"-L/opt/rocksdb -lrocksdb -lstdc++ -lm -lz -lbz2 -lsnappy\" go install\n</code></pre>\n"}], "owner": {"reputation": 248, "user_id": 5510414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CyqIu.png?s=128&g=1", "display_name": "Will_Z", "link": "https://stackoverflow.com/users/5510414/will-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2219, "favorite_count": 1, "accepted_answer_id": 36281767, "answer_count": 3, "score": 1, "last_activity_date": 1462346681, "creation_date": 1459242783, "last_edit_date": 1462346681, "question_id": 36280024, "link": "https://stackoverflow.com/questions/36280024/go-build-fail-fatal-error-rocksdb-c-h", "title": "Go build fail, fatal error: rocksdb/c.h", "body": "<p>I am testing on project <a href=\"https://github.com/openblockchain/obc-peer\" rel=\"nofollow\">obc-peer</a>.</p>\n\n<p>I am confused where should I get about github.com/**** , golang.org/**** , google.golang.org/**** , google/****.\nAm I wrong about $GOPATH ?</p>\n\n<p>Here is the log of go build and go env:</p>\n\n<p>Hope someone can help me on it......Gods</p>\n\n<pre><code>vagrant@vagrant-ubuntu-trusty-64:/opt/gopath$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/opt/gopath\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nvagrant@vagrant-ubuntu-trusty-64:/opt/gopath/src/github.com/openblockchain/obc-peer$ go build\n# github.com/openblockchain/obc-peer/vendor/github.com/tecbot/gorocksdb\nvendor/github.com/tecbot/gorocksdb/backup.go:4:24: fatal error: rocksdb/c.h: No such file or directory\n // #include \"rocksdb/c.h\"\n                        ^\ncompilation terminated.\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3757, "user_id": 347898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9c12bab3f0644ec52831b8b7d5c0a6?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/347898/jan"}, "edited": false, "score": 0, "creation_date": 1459328694, "post_id": 36281407, "comment_id": 60232208, "body": "Thanks, I was afraid of that. It is unfortunate, as this is a natural phenomena as software grows, and coming out with a new version (breaking the API) is too costly a solution in many cases, including mine."}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1459335848, "post_id": 36281407, "comment_id": 60237396, "body": "wouldn&#39;t <code>type MyType foo.MyType</code> and <code>type OtherType bar.OtherType</code> mostly work? Although I can see that interfering badly with methods. Hm."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1459338608, "post_id": 36281407, "comment_id": 60239346, "body": "@Vatine Yes: all methods are lost. Additionally: type switches and type asserts would fail and reflection might break. So: No, this doesn&#39;t &quot;mostly work&quot;."}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1459353434, "post_id": 36281407, "comment_id": 60251200, "body": "So just even function assignment probably won&#39;t work, in a lot of cases. Although very thing shims MIGHT work."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 6, "last_activity_date": 1459246521, "creation_date": 1459246521, "answer_id": 36281407, "question_id": 36279718, "link": "https://stackoverflow.com/questions/36279718/how-to-split-a-large-package-without-breaking-client-code/36281407#36281407", "title": "How to split a large package without breaking client code?", "body": "<p>Creating an alias package is the only way.\nBut your attempt probably won't work: It works only for functions and variables and consts but not for types. For types you have to duplicate the type in foobar.</p>\n\n<p>I wouldn't do this. Just have foobar around in version 1 and start anew with foo and bar (maybe directly in version 2).</p>\n"}], "owner": {"reputation": 3757, "user_id": 347898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9c12bab3f0644ec52831b8b7d5c0a6?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/347898/jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 36281407, "answer_count": 1, "score": 2, "last_activity_date": 1459246521, "creation_date": 1459241936, "question_id": 36279718, "link": "https://stackoverflow.com/questions/36279718/how-to-split-a-large-package-without-breaking-client-code", "title": "How to split a large package without breaking client code?", "body": "<p>Let's say I have a library package called <strong>foobar</strong>.</p>\n\n<p>Over time it became big and heavy. </p>\n\n<p>Fortunately it's separable, I managed to split its functionality into two separate packages <strong>foo</strong> and <strong>bar</strong> -- most clients will only need to use one or the other.</p>\n\n<p>Since my library is already in use by many clients, for compatibility I still want to maintain a <strong>foobar</strong> package as a proxy to the current functionality found in both <strong>foo</strong> and <strong>bar</strong>.</p>\n\n<p>How does one achieve this in Go ?</p>\n\n<p>One way that comes to mind is to create aliases in <strong>foobar</strong> for each struct/function in <strong>foo</strong> and <strong>bar</strong>. So if <strong>foo</strong> defines <code>F()</code> and <strong>bar</strong> defines <code>B()</code>, I would have in <strong>foobar</strong>:</p>\n\n<pre><code>var (\n  F = foo.F\n  B = bar.B\n)\n</code></pre>\n\n<p>But I am hoping for an easier/cleaner way.</p>\n"}, {"tags": ["xml", "go", "xml-parsing", "openstreetmap"], "answers": [{"comments": [{"owner": {"reputation": 12296, "user_id": 461597, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7fa573d21875f5b980a2d81c695c71f3?s=128&d=identicon&r=PG", "display_name": "Unapiedra", "link": "https://stackoverflow.com/users/461597/unapiedra"}, "edited": false, "score": 0, "creation_date": 1459243948, "post_id": 36280129, "comment_id": 60187056, "body": "For future reference the documentation about this is here: <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshaler\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/xml/#Unmarshaler</a>"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 3, "last_activity_date": 1459243087, "creation_date": 1459243087, "answer_id": 36280129, "question_id": 36279414, "link": "https://stackoverflow.com/questions/36279414/parsing-sub-elements-attribute-directly-into-go-struct/36280129#36280129", "title": "Parsing sub-element&#39;s attribute directly into Go struct", "body": "<p>In short, you can't do that directly. The common pattern to bypass the XML structure is to implement the <code>xml.Unmarshaler</code> interface. Here is an example:</p>\n\n<pre><code>type Way struct {\n    ID    int \n    Nodes []int\n}\n\nfunc (w *Way) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    var payload struct {\n        ID    int `xml:\"id,attr\"`\n        Nodes []struct {\n            Ref int `xml:\"ref,attr\"`\n        } `xml:\"nd\"`\n    }   \n\n    err := d.DecodeElement(&amp;payload, &amp;start)\n    if err != nil {\n        return err \n    }   \n\n    w.ID = payload.ID\n    w.Nodes = make([]int, 0, len(payload.Nodes))\n\n    for _, node := range payload.Nodes {\n        w.Nodes = append(w.Nodes, node.Ref)\n    }   \n\n    return nil \n}\n</code></pre>\n\n<p>Here, the <code>payload</code> variable is modeled after your XML data, while the <code>Way</code> struct is modeled as you want it to be. Once the payload is decoded, you can use it to initialize the <code>Way</code> variable as you want\u2026</p>\n\n<p><em>Side note:</em> <code>// Why can't I return nil, err?</code></p>\n\n<p>You can't return <code>nil</code> because <code>Way</code> isn't either a pointer or an interface, thus <code>nil</code> isn't a valid value for it.</p>\n"}], "owner": {"reputation": 12296, "user_id": 461597, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7fa573d21875f5b980a2d81c695c71f3?s=128&d=identicon&r=PG", "display_name": "Unapiedra", "link": "https://stackoverflow.com/users/461597/unapiedra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 36280129, "answer_count": 1, "score": 1, "last_activity_date": 1459243087, "creation_date": 1459241016, "last_edit_date": 1459242054, "question_id": 36279414, "link": "https://stackoverflow.com/questions/36279414/parsing-sub-elements-attribute-directly-into-go-struct", "title": "Parsing sub-element&#39;s attribute directly into Go struct", "body": "<p>In parsing XML with Go, how can I read a nested element's attribute directly into my struct?</p>\n\n<p>My XML looks like this below. It is part of the OpenStreetMap format:</p>\n\n<pre><code>&lt;way id=\"123\" &gt;\n        &lt;nd ref=\"101\"/&gt;\n        &lt;!-- Lots of nd elements repeated --&gt;\n        &lt;nd ref=\"109\"/&gt;\n&lt;/way&gt;\n</code></pre>\n\n<p>I have </p>\n\n<pre><code>type Way struct {\n    Nodes []NodeRef `xml:\"nd\"`\n}\n</code></pre>\n\n<p>with </p>\n\n<pre><code>type NodeRef struct {\n    Ref int `xml:\"ref,attr\"`\n}\n</code></pre>\n\n<p>but I would like to be able to do </p>\n\n<pre><code>type Way struct {\n    Nodes []int `???`\n}\n</code></pre>\n\n<p>directly.</p>\n\n<p>The documentation on <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow\">Unmarshalling</a> didn't help me. I've tried using <code>xml:\"nd&gt;ref,attr\"</code> but that fails with \"chain not valid with attr flag\".</p>\n\n<p>Please see the below example code. <a href=\"http://play.golang.org/p/HHO7SbTVcn\" rel=\"nofollow\">Run the code in Go Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    data := `\n        &lt;way id=\"5090250\" &gt;\n        &lt;nd ref=\"822403\"/&gt;\n        &lt;nd ref=\"21533912\"/&gt;\n        &lt;nd ref=\"821601\"/&gt;\n        &lt;nd ref=\"21533910\"/&gt;\n        &lt;nd ref=\"135791608\"/&gt;\n        &lt;nd ref=\"333725784\"/&gt;\n        &lt;nd ref=\"333725781\"/&gt;\n        &lt;nd ref=\"333725774\"/&gt;\n        &lt;nd ref=\"333725776\"/&gt;\n        &lt;nd ref=\"823771\"/&gt;\n      &lt;/way&gt;\n    `\n\n    r := strings.NewReader(data)\n    way, err := ReadWay(r)\n    if err != nil {\n        fmt.Println(\"Could not read\", err)\n        os.Exit(1)\n    }\n\n    fmt.Println(way)\n}\n\n// I'd like to get rid of this nested struct.\ntype NodeRef struct {\n    Ref int `xml:\"ref,attr\"`\n}\n\ntype Way struct {\n    ID int `xml:\"id,attr\"`\n    // How can I write all &lt;nd ref=\"123\"/&gt; directly into Nodes []int?\n    Nodes []NodeRef `xml:\"nd\"`\n}\n\nfunc ReadWay(reader io.Reader) (Way, error) {\n    var way Way\n    if err := xml.NewDecoder(reader).Decode(&amp;way); err != nil {\n        return way, err // Why can't I return nil, err?\n    }\n    return way, nil\n}\n</code></pre>\n"}, {"tags": ["go", "docker", "busybox", "alpine"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 4, "creation_date": 1459240937, "post_id": 36279253, "comment_id": 60185057, "body": "Does adding CGO_ENABLED=0 help?"}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1459241052, "post_id": 36279253, "comment_id": 60185140, "body": "Magic, it does. Could you please elaborate in an answer and I will accept."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1459241861, "post_id": 36279253, "comment_id": 60185655, "body": "Could you please try <code>go build -tags netgo -a -v std</code> with CGO_ENABLED=1? I think it could be issues with the net package, causing dynamic linking."}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1459242312, "post_id": 36279253, "comment_id": 60185951, "body": "As you suggested this helped <code>CGO_ENABLED=1 go build -tags netgo -a -v</code>. If I understand correctly in contrast to CGO_ENABLED=0 this will also preserve the TLS functionality in the net package, which otherwise would be lost, is that right? Can I see somehow what is linked into the binary statically and what is left for dynamic linking?"}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 2, "creation_date": 1459242585, "post_id": 36279253, "comment_id": 60186126, "body": "By default CGO can be used for the net package - using the above tag or CGO_ENABLED=0 forces the Go std implementation for lookups to be used - what you can do is do: <code>ldd output.bin</code> on each build variant to see if they&#39;re truly statically compiled or if there&#39;s any dynamic linking going on."}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1459243060, "post_id": 36279253, "comment_id": 60186478, "body": "Cool, thanks a lot for help and explanation!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459256232, "post_id": 36279253, "comment_id": 60195710, "body": "When you use CGO, the binary is linked against glibc, but alpine uses musl libc. (also, the tls package doesn&#39;t use cgo, except to get root certs on darwin)"}, {"owner": {"reputation": 2354, "user_id": 1563673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6338adc53993aa3e27054370489014d9?s=128&d=identicon&r=PG", "display_name": "sheldonk", "link": "https://stackoverflow.com/users/1563673/sheldonk"}, "edited": false, "score": 0, "creation_date": 1459286811, "post_id": 36279253, "comment_id": 60215855, "body": "This seems similar to the issue that I had and solved here: <a href=\"http://stackoverflow.com/questions/34729748/installed-go-binary-not-found-in-path-on-alpine-linux-docker/35613430#35613430\" title=\"installed go binary not found in path on alpine linux docker\">stackoverflow.com/questions/34729748/&hellip;</a>"}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "reply_to_user": {"reputation": 2354, "user_id": 1563673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6338adc53993aa3e27054370489014d9?s=128&d=identicon&r=PG", "display_name": "sheldonk", "link": "https://stackoverflow.com/users/1563673/sheldonk"}, "edited": false, "score": 0, "creation_date": 1459290331, "post_id": 36279253, "comment_id": 60217338, "body": "@sheldonk Thanks for the tip. I will give it a try even though linking everything statically would be my preference."}, {"owner": {"reputation": 2354, "user_id": 1563673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6338adc53993aa3e27054370489014d9?s=128&d=identicon&r=PG", "display_name": "sheldonk", "link": "https://stackoverflow.com/users/1563673/sheldonk"}, "edited": false, "score": 0, "creation_date": 1459292879, "post_id": 36279253, "comment_id": 60218281, "body": "There are also some alpine glibc base images that you could try out that should solve your issue"}], "answers": [{"comments": [{"owner": {"reputation": 2233, "user_id": 1353666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1930c46c80d944a690fb138cf1732906?s=128&d=identicon&r=PG", "display_name": "Vlad A. Ionescu", "link": "https://stackoverflow.com/users/1353666/vlad-a-ionescu"}, "edited": false, "score": 4, "creation_date": 1461247427, "post_id": 36308464, "comment_id": 61121212, "body": "<code>CGO_ENABLED=0</code> also fixed my problem: Trying to run alpine-built go program on non-alpine docker. The error in my case just said <code>docker: Error response from daemon: Container command not found or does not exist..</code>"}, {"owner": {"reputation": 584, "user_id": 1142314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7270b98811d8bfc5c887e354029b751?s=128&d=identicon&r=PG", "display_name": "Ben Elgar", "link": "https://stackoverflow.com/users/1142314/ben-elgar"}, "edited": false, "score": 0, "creation_date": 1523886673, "post_id": 36308464, "comment_id": 86732750, "body": "For anyone using Bazel, the above can be accomplished with the <code>--features=static --features=pure</code> flags."}, {"owner": {"reputation": 308, "user_id": 21958, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/45f753cb5a80e3c80e2c9e8a49e61282?s=128&d=identicon&r=PG", "display_name": "Kyle Gibbons", "link": "https://stackoverflow.com/users/21958/kyle-gibbons"}, "edited": false, "score": 0, "creation_date": 1543102516, "post_id": 36308464, "comment_id": 93797947, "body": "Thanks for this answer, took a lot of Googling to find."}, {"owner": {"reputation": 2745, "user_id": 7159205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6582280ec3cc9a9d0edfa0291748a823?s=128&d=identicon&r=PG&f=1", "display_name": "g10guang", "link": "https://stackoverflow.com/users/7159205/g10guang"}, "edited": false, "score": 0, "creation_date": 1555644032, "post_id": 36308464, "comment_id": 98188242, "body": "I think another optional solution is copy source code into image and exec go build in image."}, {"owner": {"reputation": 5514, "user_id": 3229128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HOXae.jpg?s=128&g=1", "display_name": "Naren Yellavula", "link": "https://stackoverflow.com/users/3229128/naren-yellavula"}, "edited": false, "score": 0, "creation_date": 1577645669, "post_id": 36308464, "comment_id": 105215608, "body": "CGO_ENABLED=0 should fix the problem.  This condition is important too, GOARCH=amd64"}, {"owner": {"reputation": 395, "user_id": 733880, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1d9a1a77a93e3338a009e9b28b78cd7?s=128&d=identicon&r=PG", "display_name": "Stephen Smith", "link": "https://stackoverflow.com/users/733880/stephen-smith"}, "edited": false, "score": 0, "creation_date": 1599848380, "post_id": 36308464, "comment_id": 112912431, "body": "It would be great if this answer also included what possible issues the 2 solutions could cause. Are either of them pretty much guaranteed to be safe? Or could they cause other runtime issues when the program tries to execute some of the related code? I&#39;m building someone else&#39;s project as a component of my code, so I don&#39;t have a ton of insight into the related code that could rely on CGO."}], "tags": [], "owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "is_accepted": true, "score": 98, "last_activity_date": 1459340080, "last_edit_date": 1459340080, "creation_date": 1459339777, "answer_id": 36308464, "question_id": 36279253, "link": "https://stackoverflow.com/questions/36279253/go-compiled-binary-wont-run-in-an-alpine-docker-container-on-ubuntu-host/36308464#36308464", "title": "Go-compiled binary won&#39;t run in an alpine docker container on Ubuntu host", "body": "<p>By default, if using the <code>net</code> package a build will likely produce a binary with some dynamic linking, e.g. to libc. You can inspect dynamically vs. statically link by viewing the result of <code>ldd output.bin</code></p>\n\n<p>There are two solutions I've come across:</p>\n\n<ul>\n<li>Disable CGO, via <code>CGO_ENABLED=0</code></li>\n<li>Force the use of the Go implementation of net dependencies, netgo via <code>go build -tags netgo -a -v</code>, this is implemented for a certain platforms</li>\n</ul>\n\n<p>From <a href=\"https://golang.org/doc/go1.2\">https://golang.org/doc/go1.2</a>:</p>\n\n<blockquote>\n  <p>The net package requires cgo by default because the host operating system must in general mediate network call setup. On some systems, though, it is possible to use the network without cgo, and useful to do so, for instance to avoid dynamic linking. The new build tag netgo (off by default) allows the construction of a net package in pure Go on those systems where it is possible.</p>\n</blockquote>\n\n<p>The above assumes that the only CGO dependency is the standard library's <code>net</code> package.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 7844590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/741f44976ebe044cabacb44d6a00c56a?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert Szydlik", "link": "https://stackoverflow.com/users/7844590/norbert-szydlik"}, "is_accepted": false, "score": 9, "last_activity_date": 1499197273, "creation_date": 1499197273, "answer_id": 44913136, "question_id": 36279253, "link": "https://stackoverflow.com/questions/36279253/go-compiled-binary-wont-run-in-an-alpine-docker-container-on-ubuntu-host/44913136#44913136", "title": "Go-compiled binary won&#39;t run in an alpine docker container on Ubuntu host", "body": "<p>Go compiler from your build machine probably links your binary with libraries on different location than in Alpine. In my case it was compiled with dependencies under /lib64 but Alpine does not use that folder.</p>\n\n<pre><code>FROM alpine:edge AS build\nRUN apk update\nRUN apk upgrade\nRUN apk add --update go=1.8.3-r0 gcc=6.3.0-r4 g++=6.3.0-r4\nWORKDIR /app\nENV GOPATH /app\nADD src /app/src\nRUN go get server # server is name of our application\nRUN CGO_ENABLED=1 GOOS=linux go install -a server\n\nFROM alpine:edge\nWORKDIR /app\nRUN cd /app\nCOPY --from=build /app/bin/server /app/bin/server\nCMD [\"bin/server\"]\n</code></pre>\n\n<p>I'm working on article about this issue. You can find draft with this solution here <a href=\"http://kefblog.com/2017-07-04/Golang-ang-docker\" rel=\"noreferrer\">http://kefblog.com/2017-07-04/Golang-ang-docker</a> .</p>\n"}, {"comments": [{"owner": {"reputation": 972, "user_id": 711104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a496ed94492b870a5317af2b39956a9?s=128&d=identicon&r=PG", "display_name": "xsor", "link": "https://stackoverflow.com/users/711104/xsor"}, "edited": false, "score": 1, "creation_date": 1537997894, "post_id": 50861580, "comment_id": 91992530, "body": "help me to run CGO in my Alpine image"}, {"owner": {"reputation": 22021, "user_id": 2236219, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a10f1a3257dce18a4b77dcbf1e7041e6?s=128&d=identicon&r=PG", "display_name": "Manwal", "link": "https://stackoverflow.com/users/2236219/manwal"}, "edited": false, "score": 1, "creation_date": 1559301385, "post_id": 50861580, "comment_id": 99386696, "body": "Saved a lot of time. +1"}, {"owner": {"reputation": 880, "user_id": 6632214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7a11555b6759a1bd6c0205720f6dda?s=128&d=identicon&r=PG", "display_name": "TheDiveO", "link": "https://stackoverflow.com/users/6632214/thediveo"}, "edited": false, "score": 2, "creation_date": 1559392436, "post_id": 50861580, "comment_id": 99410793, "body": "Unfortunately, this doesn&#39;t work for me,  and gives <code>error relocating ...: fprintf chk: symbol not found</code>"}, {"owner": {"reputation": 2547, "user_id": 6387370, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/CpJXI.png?s=128&g=1", "display_name": "zakaria amine", "link": "https://stackoverflow.com/users/6387370/zakaria-amine"}, "edited": false, "score": 1, "creation_date": 1559411936, "post_id": 50861580, "comment_id": 99415504, "body": "you need to build and run in the same environment. e.g if you build the binary in your local machine and run it inside docker, it may cause the issue"}, {"owner": {"reputation": 1887, "user_id": 535827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2bfd3338a6df22cd3acae823b10d473b?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/535827/brandon"}, "edited": false, "score": 1, "creation_date": 1564121974, "post_id": 50861580, "comment_id": 100933414, "body": "I am running someone else&#39;s go binary in an Alpine docker container, and I don&#39;t want to recompile it myself.  I&#39;d rather use the publicly available binary.  This solution fixes the issue and lets me run the go binary in an Alpine docker container"}], "tags": [], "owner": {"reputation": 2547, "user_id": 6387370, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/CpJXI.png?s=128&g=1", "display_name": "zakaria amine", "link": "https://stackoverflow.com/users/6387370/zakaria-amine"}, "is_accepted": false, "score": 71, "last_activity_date": 1530266285, "last_edit_date": 1530266285, "creation_date": 1528991838, "answer_id": 50861580, "question_id": 36279253, "link": "https://stackoverflow.com/questions/36279253/go-compiled-binary-wont-run-in-an-alpine-docker-container-on-ubuntu-host/50861580#50861580", "title": "Go-compiled binary won&#39;t run in an alpine docker container on Ubuntu host", "body": "<p>I had the same issue with a go binary, and I got it to work after adding this to my docker file:</p>\n\n<p><code>\nRUN apk add --no-cache \\\n        libc6-compat\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 2053, "user_id": 997063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tsk8p.png?s=128&g=1", "display_name": "msiemens", "link": "https://stackoverflow.com/users/997063/msiemens"}, "is_accepted": false, "score": 5, "last_activity_date": 1569934355, "creation_date": 1569934355, "answer_id": 58185179, "question_id": 36279253, "link": "https://stackoverflow.com/questions/36279253/go-compiled-binary-wont-run-in-an-alpine-docker-container-on-ubuntu-host/58185179#58185179", "title": "Go-compiled binary won&#39;t run in an alpine docker container on Ubuntu host", "body": "<p>What did the trick for me was enabling static linking in the linker options:</p>\n\n<pre><code>$ go build -ldflags '-linkmode external -w -extldflags \"-static\"'\n</code></pre>\n\n<p>The <code>-linkmode</code> option tells Go to use the external linker, the <code>-extldflags</code> option sets options to pass to the linker and the <code>-w</code> flag disables DWARF debug info to improve binary size.</p>\n\n<p>See <code>go tool link</code> and <a href=\"https://dominik.honnef.co/posts/2015/06/statically_compiled_go_programs__always__even_with_cgo__using_musl/\" rel=\"noreferrer\">Statically compiled Go programs, always, even with cgo, using musl\n</a> for more details</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7715797, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-54YCxChjriA/AAAAAAAAAAI/AAAAAAAABqo/gJ_lUZ0yBWA/photo.jpg?sz=128", "display_name": "varunrocks6", "link": "https://stackoverflow.com/users/7715797/varunrocks6"}, "is_accepted": false, "score": 1, "last_activity_date": 1603899030, "creation_date": 1603899030, "answer_id": 64576114, "question_id": 36279253, "link": "https://stackoverflow.com/questions/36279253/go-compiled-binary-wont-run-in-an-alpine-docker-container-on-ubuntu-host/64576114#64576114", "title": "Go-compiled binary won&#39;t run in an alpine docker container on Ubuntu host", "body": "<p>While executing a go binary inside a debian docker container, faced this issue:\n<code>/bin/bash: line 10: /my/go/binary: No such file or directory</code></p>\n<p>The binary was built by using docker-in-docker (dind) from an alpine container using command:\n<code>GOOS=linux GOARCH=amd64 go build</code></p>\n<p>Fixed it by using following env while building the binary:\n<code>CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build</code></p>\n"}, {"tags": [], "owner": {"reputation": 170, "user_id": 4280003, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bce0b27536e6ef7d38bf768437074fb3?s=128&d=identicon&r=PG&f=1", "display_name": "sirius", "link": "https://stackoverflow.com/users/4280003/sirius"}, "is_accepted": false, "score": 1, "last_activity_date": 1613119012, "creation_date": 1613119012, "answer_id": 66168593, "question_id": 36279253, "link": "https://stackoverflow.com/questions/36279253/go-compiled-binary-wont-run-in-an-alpine-docker-container-on-ubuntu-host/66168593#66168593", "title": "Go-compiled binary won&#39;t run in an alpine docker container on Ubuntu host", "body": "<p>I had an app that required <code>CGO_ENABLED=1</code>.</p>\n<p>The fix for me to run the compiled go binary in a debian-slim container was to build the binary using <code>RUN GOOS=linux GOARCH=amd64 CGO_ENABLED=1 go build -o goapp</code></p>\n<p>And run the following commands in the debian slim</p>\n<pre><code>RUN apt-get update &amp;&amp; apt-get install -y musl-dev\nRUN ln -s /usr/lib/x86_64-linux-musl/libc.so /lib/libc.musl-x86_64.so.1\n</code></pre>\n<p>Made me able to run the goapp afterwards</p>\n<p>TIP: <code>ldd goapp</code> showed that libc.musl-x86_64 was missing in the container.</p>\n"}], "owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36000, "favorite_count": 27, "accepted_answer_id": 36308464, "answer_count": 6, "score": 88, "last_activity_date": 1613119012, "creation_date": 1459240469, "question_id": 36279253, "link": "https://stackoverflow.com/questions/36279253/go-compiled-binary-wont-run-in-an-alpine-docker-container-on-ubuntu-host", "title": "Go-compiled binary won&#39;t run in an alpine docker container on Ubuntu host", "body": "<p>Given a binary, compiled with Go using <code>GOOS=linux</code> and <code>GOARCH=amd64</code>, deployed to a <code>docker</code> container based on <code>alpine:3.3</code>, the binary will not run if the docker engine host is Ubuntu (15.10):</p>\n\n<pre><code>sh: /bin/artisan: not found\n</code></pre>\n\n<p>This same binary (compiled for the same OS and arch) will <strong>run just fine</strong> if the docker engine host is <code>busybox</code> (which is the base for <code>alpine</code>) deployed within a VirtualBox VM on Mac OS X.</p>\n\n<p>This same binary will also run perfectly fine if the container is based on one of Ubuntu images.</p>\n\n<p><strong>Any idea what this binary is missing?</strong></p>\n\n<p>This is what I've done to reproduce (successful run in VirtualBox/busybox on OS X not shown):</p>\n\n<p>Build (building explicitly with flags even though the arch matches):</p>\n\n<pre><code>\u279c  artisan git:(master) \u2717 GOOS=linux GOARCH=amd64 go build\n</code></pre>\n\n<p>Check it can run on the host:</p>\n\n<pre><code>\u279c  artisan git:(master) \u2717 ./artisan \n10:14:04.925 [ERROR] artisan: need a command, one of server, provision or build \n</code></pre>\n\n<p>Copy to docker dir, build, run:</p>\n\n<pre><code>\u279c  artisan git:(master) \u2717 cp artisan docker/build/bin/        \n\u279c  artisan git:(master) \u2717 cd docker \n\u279c  docker git:(master) \u2717 cat Dockerfile \nFROM docker:1.10\nCOPY build/ /\n\u279c  docker git:(master) \u2717 docker build -t artisan .\nSending build context to Docker daemon 10.15 MB\nStep 1 : FROM docker:1.10\n...\n\u279c  docker git:(master) \u2717 docker run -it artisan sh\n/ # /bin/artisan \nsh: /bin/artisan: not found\n</code></pre>\n\n<p>Now changing the image base to <code>phusion/baseimage</code>:</p>\n\n<pre><code>\u279c  docker git:(master) \u2717 cat Dockerfile \n#FROM docker:1.10\nFROM phusion/baseimage\nCOPY build/ /\n\u279c  docker git:(master) \u2717 docker build -t artisan .\nSending build context to Docker daemon 10.15 MB\nStep 1 : FROM phusion/baseimage\n...\n\u279c  docker git:(master) \u2717 docker run -it artisan sh\n# /bin/artisan\n08:16:39.424 [ERROR] artisan: need a command, one of server, provision or build \n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "edited": false, "score": 0, "creation_date": 1459237669, "post_id": 36278207, "comment_id": 60183103, "body": "Ok., I got it now. Thanks.   So since i =1 and 1 is an integer, i will get integer as datatype. But another doubt is integer itself has int8, int16, int 64 as sub types ryt? So  will i take int8 as default here?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "edited": false, "score": 0, "creation_date": 1459237757, "post_id": 36278207, "comment_id": 60183150, "body": "@HariKrishnan This expression: <code>1</code> is an <b>untyped</b> constant. If an expression is an untyped constant (and <b>not</b> a typed constant), then its <b>default type</b> is used which is <code>int</code> for untyped integer constants, as stated by the spec. If a <b>typed</b> constant is used, then obviously the type of the typed constant is used."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1584622572, "last_edit_date": 1584622572, "creation_date": 1459237028, "answer_id": 36278207, "question_id": 36278121, "link": "https://stackoverflow.com/questions/36278121/defining-a-variable-in-go-programming-language/36278207#36278207", "title": "Defining a variable in Go programming language", "body": "<p>The first one <code>i := 1</code> is called <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a>. It is a shorthand for regular <a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">variable declaration</a> with initializer expressions but no types:</p>\n\n<pre><code>var IdentifierList = ExpressionList\n</code></pre>\n\n<p>You don't specify the type of <code>i</code>, but <code>i</code> will have a type based on certain rules. Its type will be automatically inferred. In this case it will be of type <code>int</code> because the initializer expression <code>1</code> is an untyped integer constant whose default type is <code>int</code>, so when a type is needed (e.g. it is used in a short variable declaration), <code>int</code> type will be deduced.</p>\n\n<p>So Go is statically typed. That means variables will have a static type and values stored in them at runtime will always be of that type. Being statically typed does not mean <em>you</em> have to explicitly specify the static type, it just means variables must have a static type - decided at compile time - which condition is met even if you use short variable declaration and you don't specify it.</p>\n\n<p>Note that you can also omit the type if you declare a variable with the <code>var</code> keyword:</p>\n\n<pre><code>var i = 1\n</code></pre>\n\n<p>In which case the type will also be deduced from the type of the initializer expression.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">Spec: Variable declaration:</a></p>\n\n<blockquote>\n  <p>If a type is present, each variable is given that type. Otherwise, each variable is given the type of the corresponding initialization value in the assignment. If that value is an untyped constant, it is first <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">converted</a> to its <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">default type</a>; if it is an untyped boolean value, it is first converted to type <code>bool</code>. The predeclared value <code>nil</code> cannot be used to initialize a variable with no explicit type.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1459237039, "creation_date": 1459237039, "answer_id": 36278210, "question_id": 36278121, "link": "https://stackoverflow.com/questions/36278121/defining-a-variable-in-go-programming-language/36278210#36278210", "title": "Defining a variable in Go programming language", "body": "<p>Go is designed with ease of use in mind. So new variables are able to get an implicit type of the right side using the <code>:=</code> operator. Also the constant <code>1</code> for example has an implicit type in go.</p>\n"}], "owner": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 36278207, "answer_count": 2, "score": 1, "last_activity_date": 1584622572, "creation_date": 1459236789, "question_id": 36278121, "link": "https://stackoverflow.com/questions/36278121/defining-a-variable-in-go-programming-language", "title": "Defining a variable in Go programming language", "body": "<p>I am learning Go language and comes across seeing this type of variable declaration:</p>\n\n<pre><code>i:=1;\n</code></pre>\n\n<p>But it says that Go has static variables. i,e variables should be defined in some  way like this</p>\n\n<pre><code>var i int=1;\n</code></pre>\n\n<p>So what is the difference between these two methods? In the first one we don't need to indicate the data type. Why is it so?  </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4963, "user_id": 3556378, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/52d7bb9f9cf9b3a2690d6d51adcadfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/3556378/ash"}, "edited": false, "score": 0, "creation_date": 1459225838, "post_id": 36275290, "comment_id": 60177580, "body": "Thanks, I&#39;ll mark this as the solution tomorrow if there are no better answers provided (in-case there are any other methods people use)."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1459224751, "creation_date": 1459224751, "answer_id": 36275290, "question_id": 36274555, "link": "https://stackoverflow.com/questions/36274555/problems-with-template-parsefiles/36275290#36275290", "title": "Problems with template.ParseFiles", "body": "<p>There is no standard method to include static resources for a compiled program; however <a href=\"http://12factor.net/config\" rel=\"nofollow\">one</a> common convention is to store configuration in environment variables.</p>\n\n<p>For example, when running your app, put the expected environment variable in the environment:</p>\n\n<pre><code>$&gt; TEMPLATE_VIEWS=/var/local/app/views myapp\n</code></pre>\n\n<p>And in your code you would find the folder:</p>\n\n<pre><code>func loginHandler(w http.ResponseWriter, r *http.Request) {\n    t, err := template.ParseFiles(filepath.Join(os.Getenv(\"TEMPLATE_VIEWS\"), \"login.html\"))\n    if err != nil {\n        fmt.Fprintf(w, \"503 - Error\")\n        fmt.Println(err)\n    } else {\n        t.Execute(w, nil)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 4963, "user_id": 3556378, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/52d7bb9f9cf9b3a2690d6d51adcadfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/3556378/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 36275290, "answer_count": 1, "score": 0, "last_activity_date": 1459224751, "creation_date": 1459220123, "question_id": 36274555, "link": "https://stackoverflow.com/questions/36274555/problems-with-template-parsefiles", "title": "Problems with template.ParseFiles", "body": "<p>I have the following http.Handle function (simplified): </p>\n\n<pre><code>func loginHandler(w http.ResponseWriter, r *http.Request) {\n\n        cwd, _ := os.Getwd()\n        t, err := template.ParseFiles(filepath.Join(cwd, \"./views/login.html\"))\n\n        if err != nil {\n            fmt.Fprintf(w, \"503 - Error\")\n            fmt.Println(err)\n        } else {\n            t.Execute(w, nil)\n        }\n\n}\n</code></pre>\n\n<p>It works as intended when using <code>go build main.go</code>, however - after running <code>go install</code>, I get an error that it can't find the file (as it is now compiled to <code>/bin/&lt;appname&gt;</code> (where there is no views folder). Apart from adding a views folder to the <code>/bin</code> directory or hardcoding the path, how can I get the <code>template.ParseFiles()</code> to find the correct path?</p>\n\n<p>Is there some standard method to include 'static' resources to be used for the comiled program?</p>\n"}, {"tags": ["javascript", "angularjs", "go", "pusher"], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "is_accepted": true, "score": 0, "last_activity_date": 1459232679, "creation_date": 1459232679, "answer_id": 36276917, "question_id": 36274476, "link": "https://stackoverflow.com/questions/36274476/pusher-presence-cant-get-members-using-angularjs-and-golang/36276917#36276917", "title": "pusher presence can&#39;t get members using angularjs and golang", "body": "<p>NVM, solved the problem.. it's missing in the docs for Go examples to return it in <code>jsonp</code> with callback func. response should have something like this...</p>\n\n<pre><code>Pusher.auth_callbacks['1']({auth: \"7d6e393c49c579c43a0c:33a442fcc9d3bf67febfeeb59e5a8e4f0364901069534cdef006b0b047df9f75\",\u2026});\nauth:\"7d6e393c49c579c43a0c:33a442fcc9d3bf67febfeeb59e5a8e4f0364901069534cdef006b0b047df9f75\"\nchannel_data :\"{\"user_id\":\"56fa1231cc1cb48a1cdb243c\",\"user_info\":{\"twitter\":\"pusher\"}}\"\n</code></pre>\n"}], "owner": {"reputation": 1763, "user_id": 1175415, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9d2e16819b10749cd775f0dfc5db1635?s=128&d=identicon&r=PG", "display_name": "Hokutosei", "link": "https://stackoverflow.com/users/1175415/hokutosei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 36276917, "answer_count": 1, "score": 0, "last_activity_date": 1459232679, "creation_date": 1459219560, "last_edit_date": 1459220888, "question_id": 36274476, "link": "https://stackoverflow.com/questions/36274476/pusher-presence-cant-get-members-using-angularjs-and-golang", "title": "pusher presence can&#39;t get members using angularjs and golang", "body": "<p>I am trying to use the examples from <a href=\"https://pusher.com/docs/client_api_guide/client_presence_channels\" rel=\"nofollow\">here</a> so far this is what I have setup</p>\n\n<p>// angularjs\n</p>\n\n<pre><code>    // JS\n    var presenceClient = new Pusher('API_KEY', {\n        authEndpoint: apiServer + \"/presence_auth\",\n        authTransport: 'jsonp',\n        encrypted: true            \n    })\n\n\n    var c = pusher.subscribe(\"presence-testchan\")\n    Utils.log(c.members.count) // 0\n    Utils.log(\"000============\")    \n    c.bind('pusher:subscription_succeeded', function(members) {\n        Utils.log(\"succeeded?\")\n        Utils.log(members)\n    })\n</code></pre>\n\n<p>// golang and the presence endpoint</p>\n\n<pre><code>func Presence(w http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n    params, _ := GetBytes(r.URL.String())\n\n    presenceData := pusher.MemberData{\n        UserId: database.GenerateStrObjID(),\n        UserInfo: map[string]string{\n            \"twitter\": \"pusher\",\n        },\n    }\n    response, err := PusherClient.AuthenticatePresenceChannel(params, presenceData)\n\n    if err != nil {\n        panic(err)\n    }\n\n    respondToJSON(w, string(response))\n}\n\n\nfunc respondToJSON(w http.ResponseWriter, data interface{}) {\n\n    r := render.New()\n    r.JSON(w, http.StatusOK, data)\n}\n</code></pre>\n\n<p>I guess that is the basic form. but I don't get any members count?. I can get a response from the API with </p>\n\n<pre><code>\"{\\\"auth\\\":\\\"7d6e393c49c579c43a0c:6cd45662ef57fbc3ab16d8052c43bf95e7415846f736c2499bac7628ca3b75bc\\\",\\\"channel_data\\\":\\\"{\\\\\\\"user_id\\\\\\\":\\\\\\\"56f9e5ffcc1cb466a624a3cf\\\\\\\",\\\\\\\"user_info\\\\\\\":{\\\\\\\"twitter\\\\\\\":\\\\\\\"pusher\\\\\\\"}}\\\"}\"\n</code></pre>\n\n<p>but has error</p>\n\n<pre><code>Uncaught SyntaxError: Unexpected token :\n</code></pre>\n\n<p>Am I missing something or my setup is wrong? </p>\n"}, {"tags": ["go", "warnings", "suppress-warnings"], "comments": [{"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 3, "creation_date": 1485277072, "post_id": 36273920, "comment_id": 70854568, "body": "I think this is a bug in &quot;go vet&quot;. There is no ambiguity in this case (only one member) and &quot;go vet&quot; should not report this as a problem. Same with multiple members that have incompatible types."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 22, "last_activity_date": 1459215876, "creation_date": 1459215876, "answer_id": 36274001, "question_id": 36273920, "link": "https://stackoverflow.com/questions/36273920/disable-go-vet-checks-for-composite-literal-uses-unkeyed-fields/36274001#36274001", "title": "Disable go vet checks for &quot;composite literal uses unkeyed fields&quot;", "body": "<blockquote>\n<pre><code>$ go doc cmd/vet\n</code></pre>\n  \n  <p>By default all checks are performed. If any flags are explicitly set\n  to true, only those tests are run. Conversely, if any flag is\n  explicitly set to false, only those tests are disabled. Thus\n  -printf=true runs the printf check, -printf=false runs all checks except the printf check.</p>\n\n<pre><code>Unkeyed composite literals\n\nFlag: -composites\n\nComposite struct literals that do not use the field-keyed syntax.\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 18, "creation_date": 1485277059, "post_id": 36274238, "comment_id": 70854559, "body": "This is not a fix because there is no bug. This is a workaround for a bug in &quot;go vet&quot; that is overly religious on this matter."}, {"owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "edited": false, "score": 4, "creation_date": 1497826640, "post_id": 36274238, "comment_id": 76226441, "body": "As far as I know using unkeyed fields not only just fine, but very common practice for embedded types."}, {"owner": {"reputation": 1617, "user_id": 6174577, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f31e03bb70b0cebb89f1e0b81efd485?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Mok", "link": "https://stackoverflow.com/users/6174577/ka-mok"}, "edited": false, "score": 1, "creation_date": 1505941025, "post_id": 36274238, "comment_id": 79624032, "body": "I don&#39;t understand what the warning is trying to prevent. Can someone explain? Why do you need a key there? My struct only has one parameter."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 1617, "user_id": 6174577, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f31e03bb70b0cebb89f1e0b81efd485?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Mok", "link": "https://stackoverflow.com/users/6174577/ka-mok"}, "edited": false, "score": 13, "creation_date": 1506026797, "post_id": 36274238, "comment_id": 79665942, "body": "@KaMok mainly because say few weeks/months later you add a field to the struct, then everything that used the unkeyed initialization would break."}, {"owner": {"reputation": 3641, "user_id": 3139595, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/r1GRx.png?s=128&g=1", "display_name": "Edwin O.", "link": "https://stackoverflow.com/users/3139595/edwin-o"}, "edited": false, "score": 0, "creation_date": 1519754479, "post_id": 36274238, "comment_id": 85035054, "body": "you are a star my friend!"}, {"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "edited": false, "score": 0, "creation_date": 1562481690, "post_id": 36274238, "comment_id": 100382372, "body": "There <i>are</i> times where unekeyed is a good idea. If you use keyed, and a few weeks/months later you add a field to the struct, you might want your initialisation code to break to see where you need to update your initialisation code."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 45, "last_activity_date": 1534421247, "last_edit_date": 1534421247, "creation_date": 1459217708, "answer_id": 36274238, "question_id": 36273920, "link": "https://stackoverflow.com/questions/36273920/disable-go-vet-checks-for-composite-literal-uses-unkeyed-fields/36274238#36274238", "title": "Disable go vet checks for &quot;composite literal uses unkeyed fields&quot;", "body": "<p>You can disable it or you can fix the code instead:</p>\n\n<pre><code>a := A{B: b}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/mW03O0Rl5I\" rel=\"noreferrer\"><kbd>playground</kbd></a></p>\n"}, {"tags": [], "owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "is_accepted": false, "score": 2, "last_activity_date": 1554311415, "creation_date": 1554311415, "answer_id": 55500683, "question_id": 36273920, "link": "https://stackoverflow.com/questions/36273920/disable-go-vet-checks-for-composite-literal-uses-unkeyed-fields/55500683#55500683", "title": "Disable go vet checks for &quot;composite literal uses unkeyed fields&quot;", "body": "<pre><code>go tool vet -composites=false .\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 399, "user_id": 6469488, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MAIzo.png?s=128&g=1", "display_name": "cruise_lab", "link": "https://stackoverflow.com/users/6469488/cruise-lab"}, "edited": false, "score": 0, "creation_date": 1595267578, "post_id": 57382996, "comment_id": 111409745, "body": "Hi, does this work on VSCode as well? Or do I need to do something else?"}, {"owner": {"reputation": 4635, "user_id": 1411589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2a6b1a1c31198db776d76af7f04c1bbd?s=128&d=identicon&r=PG", "display_name": "deepakssn", "link": "https://stackoverflow.com/users/1411589/deepakssn"}, "reply_to_user": {"reputation": 399, "user_id": 6469488, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MAIzo.png?s=128&g=1", "display_name": "cruise_lab", "link": "https://stackoverflow.com/users/6469488/cruise-lab"}, "edited": false, "score": 0, "creation_date": 1606794917, "post_id": 57382996, "comment_id": 115063628, "body": "@cruise_lab added a post as I had to go through few steps for VS Code"}], "tags": [], "owner": {"reputation": 1035, "user_id": 683947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a3f4f8e13e0660f1123a096ceae939c?s=128&d=identicon&r=PG", "display_name": "tantrix", "link": "https://stackoverflow.com/users/683947/tantrix"}, "is_accepted": false, "score": 2, "last_activity_date": 1565120703, "creation_date": 1565120703, "answer_id": 57382996, "question_id": 36273920, "link": "https://stackoverflow.com/questions/36273920/disable-go-vet-checks-for-composite-literal-uses-unkeyed-fields/57382996#57382996", "title": "Disable go vet checks for &quot;composite literal uses unkeyed fields&quot;", "body": "<p>You can disable it with the <code>-composites=false</code> flag: e.g.,</p>\n\n<pre><code>go vet -composites=false .\n</code></pre>\n\n<p>NB: <code>go tool vet</code> is deprecated</p>\n"}, {"tags": [], "owner": {"reputation": 4635, "user_id": 1411589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2a6b1a1c31198db776d76af7f04c1bbd?s=128&d=identicon&r=PG", "display_name": "deepakssn", "link": "https://stackoverflow.com/users/1411589/deepakssn"}, "is_accepted": false, "score": 1, "last_activity_date": 1606794854, "creation_date": 1606794854, "answer_id": 65084500, "question_id": 36273920, "link": "https://stackoverflow.com/questions/36273920/disable-go-vet-checks-for-composite-literal-uses-unkeyed-fields/65084500#65084500", "title": "Disable go vet checks for &quot;composite literal uses unkeyed fields&quot;", "body": "<p>If you are using VS code, you have to manually set the flag under settings</p>\n<p><code>settings &gt; Extensions &gt; Go</code></p>\n<p>Scroll down to &quot;Vet Flags&quot; section</p>\n<p><a href=\"https://i.stack.imgur.com/tchbQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tchbQ.png\" alt=\"enter image description here\" /></a></p>\n<p>Add Item and add the flag</p>\n<pre><code>-composites=false .\n</code></pre>\n<p>Click ok.</p>\n<p>Save one of your files again or restart VS code to see the effect.</p>\n"}, {"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 1, "last_activity_date": 1614612599, "creation_date": 1614612599, "answer_id": 66424929, "question_id": 36273920, "link": "https://stackoverflow.com/questions/36273920/disable-go-vet-checks-for-composite-literal-uses-unkeyed-fields/66424929#66424929", "title": "Disable go vet checks for &quot;composite literal uses unkeyed fields&quot;", "body": "<p>If you're using the language server.</p>\n<p><a href=\"https://blog.golang.org/gopls-vscode-go\" rel=\"nofollow noreferrer\"><code>Gopls on by default in the VS Code Go extension</code></a></p>\n<p><code>gopls</code> <em>does</em> vet check by <a href=\"https://github.com/golang/tools/blob/master/gopls/doc/analyzers.md\" rel=\"nofollow noreferrer\">default.</a></p>\n<pre><code>&quot;gopls&quot;: {\n     &quot;analyses&quot;: { &quot;composites&quot;: false }\n },\n</code></pre>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23923, "favorite_count": 6, "accepted_answer_id": 36274001, "answer_count": 6, "score": 23, "last_activity_date": 1614612599, "creation_date": 1459215221, "last_edit_date": 1459216164, "question_id": 36273920, "link": "https://stackoverflow.com/questions/36273920/disable-go-vet-checks-for-composite-literal-uses-unkeyed-fields", "title": "Disable go vet checks for &quot;composite literal uses unkeyed fields&quot;", "body": "<p>I'm running go vet on my CI tool, and started getting the error:</p>\n\n<pre><code>composite literal uses unkeyed fields\n</code></pre>\n\n<p>Because I'm instantiating</p>\n\n<pre><code>type A struct {\n   *B\n}\n</code></pre>\n\n<p>like this:</p>\n\n<pre><code>A{b} // b is of type *B\n</code></pre>\n\n<p>I don't care for this warning, and want to disable it on my go vet checks. How do I do this?</p>\n"}, {"tags": ["go", "concurrency", "channel"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1459207167, "creation_date": 1459207167, "answer_id": 36272827, "question_id": 36272673, "link": "https://stackoverflow.com/questions/36272673/go-blocking-from-receiving-channel/36272827#36272827", "title": "Go blocking from receiving channel", "body": "<p>I think it's because your <code>escape1</code> for loop wraps the <code>for scanner.Scan()</code> loop.</p>\n\n<p>When I remove that outer for loop it works fine for me: <a href=\"https://play.golang.org/p/NU3m3Deil7\" rel=\"nofollow\">https://play.golang.org/p/NU3m3Deil7</a></p>\n\n<pre><code>func main() {\n    var (\n        donec  = make(chan struct{})\n        stream = make(chan string, 5000)\n        exitc  = make(chan struct{})\n    )\n    go func() {\n        scanner := bufio.NewScanner(strings.NewReader(lines))\n    escape1:\n        for scanner.Scan() {\n            select {\n            case &lt;-donec:\n                fmt.Println(\"escape1\")\n                close(stream)\n                break escape1\n            default:\n                stream &lt;- scanner.Text()\n            }\n        }\n\n        close(exitc)\n        fmt.Println(\"scan done\")\n        return\n    }()\n\nescape2:\n    for {\n        select {\n        case txt, ok := &lt;-stream:\n            if !ok {\n                fmt.Println(\"stream closed!\")\n            }\n            fmt.Println(txt)\n            if strings.Contains(txt, \"line5\") {\n                close(donec)\n                &lt;-exitc\n                break escape2\n            }\n        }\n    }\n    fmt.Println(\"done....\")\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 36272827, "answer_count": 1, "score": 1, "last_activity_date": 1459207167, "creation_date": 1459206215, "question_id": 36272673, "link": "https://stackoverflow.com/questions/36272673/go-blocking-from-receiving-channel", "title": "Go blocking from receiving channel", "body": "<p>I have the following go code to wait for streams. The expected output is:</p>\n\n<pre><code>line1\nline2\nline3\nline4\nline5\nescape1\nscan done\ndone....\n</code></pre>\n\n<p>But after <code>line5</code>, my code keeps hanging.</p>\n\n<pre><code>var lines = `\nline1\nline2\nline3\nline4\nline5\nline6\nline7\n`\n\nfunc main() {\n    var (\n        donec  = make(chan struct{})\n        stream = make(chan string, 5000)\n        exitc  = make(chan struct{})\n    )\n    go func() {\n        scanner := bufio.NewScanner(strings.NewReader(lines))\n    escape1:\n        for {\n            for scanner.Scan() {\n                select {\n                case &lt;-donec:\n                    fmt.Println(\"escape1\")\n                    close(stream)\n                    break escape1\n                default:\n                    stream &lt;- scanner.Text()\n                }\n            }\n        }\n        close(exitc)\n        fmt.Println(\"scan done\")\n        return\n    }()\n\nescape2:\n    for {\n        select {\n        case txt, ok := &lt;-stream:\n            if !ok {\n                fmt.Println(\"stream closed!\")\n            }\n            fmt.Println(txt)\n            if strings.Contains(txt, \"line5\") {\n                close(donec)\n                &lt;-exitc\n                break escape2\n            }\n        }\n    }\n    fmt.Println(\"done....\")\n}\n</code></pre>\n\n<p>Think I am doing everything right. Could anybody help me debug this hanging code? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459203799, "post_id": 36271636, "comment_id": 60171360, "body": "Have you tried the heroku documentation? <a href=\"https://devcenter.heroku.com/articles/getting-started-with-go#introduction\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/&hellip;</a>"}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1459209228, "post_id": 36271636, "comment_id": 60173204, "body": "Consider cross compiling locally with go and uploading the binary to the dyno. I.e. make the dyno run a shell command to start the binary. It&#39;s much simpler and more flexible."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1459290955, "last_edit_date": 1459290955, "creation_date": 1459216599, "answer_id": 36274097, "question_id": 36271636, "link": "https://stackoverflow.com/questions/36271636/how-can-i-deploy-my-go-app-app-to-heroku-using-godep/36274097#36274097", "title": "how can i deploy my Go app app to heroku using Godep?", "body": "<p>Have you tried anything yet? </p>\n\n<p>If not, try starting with <a href=\"https://devcenter.heroku.com/articles/getting-started-with-go#introduction\" rel=\"nofollow\">the tutorial</a>. You'll need to install the <a href=\"https://toolbelt.heroku.com/\" rel=\"nofollow\">Heroku Toolbelt</a> as part of this. Then just follow instructions for pushing your app to Heroku.</p>\n\n<p>Heroku naturally knows how to deploy go apps based on the presence of Godeps/Godeps.json at the root of your repository.</p>\n\n<p>Also make sure your project's <code>Procfile</code> contains:</p>\n\n<pre><code>web: NAME_OF_YOUR_BINARY\n</code></pre>\n\n<p>For example, if your main is in <code>$PROJECT/cmd/myapp</code>, then <code>Procfile</code> would be:</p>\n\n<pre><code>web: myapp\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5895067, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/432c26e117b9272658291dfab8b09d74?s=128&d=identicon&r=PG&f=1", "display_name": "ADF programmer", "link": "https://stackoverflow.com/users/5895067/adf-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459290955, "creation_date": 1459201021, "question_id": 36271636, "link": "https://stackoverflow.com/questions/36271636/how-can-i-deploy-my-go-app-app-to-heroku-using-godep", "title": "how can i deploy my Go app app to heroku using Godep?", "body": "<p>I work on windows 32bit and i have a project with golang so how can i deploy it on heroku ?</p>\n\n<blockquote>\n  <p>my go env  = set GOARCH=386\n  set GOBIN=\n  set GOEXE=.exe\n  set GOHOSTARCH=386\n  set GOHOSTOS=windows\n  set GOOS=windows\n  set GOPATH=C:\\Go\\bin\n  set GORACE=\n  set GOROOT=C:\\Go\n  set GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_386\n  set GO15VENDOREXPERIMENT=1\n  set CC=gcc\n  set GOGCCFLAGS=-m32 -mthreads -fmessage-length=0\n  set CXX=g++\n  set CGO_ENABLED=1   </p>\n</blockquote>\n"}, {"tags": ["networking", "go", "tcp", "chat"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1459201068, "post_id": 36271156, "comment_id": 60170302, "body": "Why? You can have as many clients as you like with a single port. Don&#39;t waste them, they are a finite resource."}, {"owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1459202972, "post_id": 36271156, "comment_id": 60171047, "body": "I wanted to let the 2 clients see the messages form each other, and I thought the only way to do that would be with 2 ports.  I&#39;m fairly new to networking and Golang, so I don&#39;t really know the best way to do things.  Is there a way to make 2 client programs communicate while just using 1 port?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1459203070, "post_id": 36271156, "comment_id": 60171084, "body": "You&#39;re already doing it."}, {"owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1459203785, "post_id": 36271156, "comment_id": 60171352, "body": "Let me word that a little better.  I want the message form client 1 to be sent to client 2 through the server and vice-versa.  Could I do that with one port?  Currently, client 1 can only read its own messages that the server echoes back at it.  It cannot communicate with other clients at all."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1459207505, "post_id": 36271156, "comment_id": 60172664, "body": "I recommend that you go through the <a href=\"http://whispering-gophers.appspot.com/talk.slide#1\" rel=\"nofollow noreferrer\">whispering gophers tutorial</a>.  It covers everything you need to know for sending messages between clients."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "edited": false, "score": 0, "creation_date": 1459203433, "post_id": 36271499, "comment_id": 60171217, "body": "Thanks!  This should help me quite a bit.  I thought I would be able to do it using Go routines, but I could not figure out how at all.  I plan to take care of errors soon, so don&#39;t worry about those!  Thanks again!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 7, "last_activity_date": 1459200831, "last_edit_date": 1459200831, "creation_date": 1459200482, "answer_id": 36271499, "question_id": 36271156, "link": "https://stackoverflow.com/questions/36271156/listen-to-2-ports-on-1-server/36271499#36271499", "title": "Listen to 2 Ports on 1 Server", "body": "<p>The server code in the question handles multiple clients on the same port.  </p>\n\n<p>To work with two ports, create two listeners and run the accept loops for these listeners in separate goroutines:</p>\n\n<pre><code>func main() {\n    fmt.Println(\"The server is listening on Port 3000\")\n    listener, err := net.Listen(\"tcp\", \"localhost:3000\")\n    if err != nil {\n        log.Fatal(err) \n    }\n    listener2, err := net.Listen(\"tcp\", \"localhost:8080\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    go acceptLoop(listener)\n    acceptLoop(listener2)  // run in the main goroutine\n}\n\nfunc acceptLoop(l net.Listener) {\n    defer l.Close()\n    for {\n            c, err := l.Accept()\n            if err != nil {\n                log.Fatal(err)\n            }\n            fmt.Println(\"New connection found!\")\n            go listenConnection(c)\n    }\n}\n</code></pre>\n\n<p>Also, don't ignore errors. The code in this answer handles errors by calling log.Fatal. That may or may not be appropriate for your application.</p>\n"}], "owner": {"reputation": 21, "user_id": 6126174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58901df178aac4c3b2799158652e73?s=128&d=identicon&r=PG&f=1", "display_name": "user6126174", "link": "https://stackoverflow.com/users/6126174/user6126174"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459200831, "creation_date": 1459199023, "last_edit_date": 1459199513, "question_id": 36271156, "link": "https://stackoverflow.com/questions/36271156/listen-to-2-ports-on-1-server", "title": "Listen to 2 Ports on 1 Server", "body": "<p>I am trying to modify my echo server program in order to create a chat client.  Currently, I have my server listening to a port when I start up my client.  Then, the client can type and send a message to the server and the server will echo it back.</p>\n\n<p>However, I would like to be able to connect 2 clients to 2 different ports and let the clients send messages to each other over the server.  Is there any way I could do this?  I am assuming that the first step would be to listen to 2 ports instead of one.</p>\n\n<p>Here is what I have so far.</p>\n\n<p>Server:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"log\"\n        \"net\"\n)\n\nfunc main() {\n        fmt.Println(\"The server is listening on Port 3000\")\n        listener, _ := net.Listen(\"tcp\", \"localhost:3000\")\n        //listener2, _ := net.Listen(\"tcp\", \"localhost:8080\")\n\n        defer listener.Close()\n        //defer listener2.Close()\n\n        // Listen for connections\n        for {\n                conn, _ := listener.Accept()\n                //conn2, _ := listener2.Accept()\n                fmt.Println(\"New connection found!\")\n\n                go listenConnection(conn)\n                //go listenConnection(conn2)\n        }\n}\n\n//Listen for messages and reply\nfunc listenConnection(conn net.Conn) {\n        fmt.Println(\"Yay\")\n        for {\n                buffer := make([]byte, 1400)\n                dataSize, err := conn.Read(buffer)\n                if err != nil {\n                    fmt.Println(\"Connection has closed\")\n                    return\n                }\n\n                //This is the message you received\n                data := buffer[:dataSize]\n                fmt.Print(\"Received message: \", string(data))\n\n                // Send the message back\n                _, err = conn.Write(data)\n                if err != nil {\n                        log.Fatalln(err)\n                }\n                fmt.Print(\"Message sent: \", string(data))\n        }\n}\n</code></pre>\n\n<p>Client:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"log\"\n        \"net\"\n        \"bufio\"\n        \"os\"\n)\n\nfunc main() {\n        conn, err := net.Dial(\"tcp\", \"localhost:3000\")\n        if err != nil {\n                log.Fatalln(err)\n        }\n\nfor {\n        reader := bufio.NewReader(os.Stdin)\n        fmt.Print(\"Enter text: \")\n        text, _ := reader.ReadString('\\n')\n\n        _, err = conn.Write([]byte(text))\n        if err != nil {\n                log.Fatalln(err)\n        }\n\n        for {\n                buffer := make([]byte, 1400)\n                dataSize, err := conn.Read(buffer)\n                if err != nil {\n                        fmt.Println(\"The connection has closed!\")\n                        return\n                }\n\n                data := buffer[:dataSize]\n                fmt.Println(\"Received message: \", string(data))\n                break\n        }\n\n    }\n}\n</code></pre>\n\n<p>Is there any way to listen to 2 clients (ports) on 1 server and let them communicate?  Is it possible to do this with both clients on the same port?  I tried adding another listener in the Server program, but I commented those lines out for now as they did not work.  I will appreciate any help!</p>\n"}, {"tags": ["go", "internationalization"], "comments": [{"owner": {"reputation": 842, "user_id": 1198986, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6af477723fb832487f84973e990d2466?s=128&d=identicon&r=PG", "display_name": "libertylocked", "link": "https://stackoverflow.com/users/1198986/libertylocked"}, "edited": false, "score": 0, "creation_date": 1459195009, "post_id": 36269927, "comment_id": 60167218, "body": "<a href=\"http://stackoverflow.com/questions/7585362/how-to-handle-i18n-in-go\" title=\"how to handle i18n in go\">stackoverflow.com/questions/7585362/how-to-handle-i18n-in-go</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1459200718, "post_id": 36269927, "comment_id": 60170129, "body": "Related, read this blog post: <a href=\"http://blog.golang.org/matchlang\" rel=\"nofollow noreferrer\">Language and Locale Matching in Go</a>"}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1459202426, "post_id": 36269927, "comment_id": 60170867, "body": "I also find a gotcha with the last mentioned library i18n. Usually the library is executed from function template.Execute.That looks fine, but before using we have to call func (*Template) Funcs and this is a problem. Usually we parse template just one, but it is not safe to call Funcs from different goroutines without any sync mechanism."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1459202801, "post_id": 36269927, "comment_id": 60171001, "body": "The simplest would be sent language as template argument, but that is terrible - it forces some work in each template and each calling T. Yuck"}], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1459194426, "creation_date": 1459194426, "question_id": 36269927, "link": "https://stackoverflow.com/questions/36269927/libraries-for-localization-in-go", "title": "libraries for localization in go", "body": "<p>Do you have experience with localization (or i18n, l10n) with go? I thought, that I could read preferences sent by browser and provide response accoring to request. But I found only few attempts to something like this. Please sent me, if I'm wrong in some ideas.</p>\n\n<p><a href=\"https://godoc.org/golang.org/x/text/message\" rel=\"nofollow\">https://godoc.org/golang.org/x/text/message</a> looks very complicated, documentation is disarranged and sometimes obsolete. It looks that is used only by very small group of people.</p>\n\n<p><a href=\"https://github.com/gosexy/gettext\" rel=\"nofollow\">https://github.com/gosexy/gettext</a> looks interesting, but if I understand well problem is in call SetLocale. That does not allow me to use two goroutines with different language at the same time if I don't want to synchronize goroutines very often.</p>\n\n<p><a href=\"https://godoc.org/github.com/nicksnyder/go-i18n/i18n\" rel=\"nofollow\">https://godoc.org/github.com/nicksnyder/go-i18n/i18n</a> (or something based on this) looks that it should work. I'm going to play with this library, because it looks like the most usable.</p>\n"}, {"tags": ["arrays", "go", "hex", "byte", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1540319840, "last_edit_date": 1540319840, "creation_date": 1459189255, "answer_id": 36268444, "question_id": 36267968, "link": "https://stackoverflow.com/questions/36267968/get-golang-flags-as-byte-array/36268444#36268444", "title": "Get Golang flags as byte array", "body": "<p><code>\"\\x41BC\"</code> is a quoted string. The <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\"><code>flag</code></a> package does not do any unquoting, it will just hand you over the arguments that were specified when starting your application. You can use the <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"nofollow noreferrer\"><code>strconv.Unquote()</code></a> and <a href=\"https://golang.org/pkg/strconv/#UnquoteChar\" rel=\"nofollow noreferrer\"><code>strconv.UnquoteChar()</code></a> functions to unquote them.</p>\n\n<p>One thing you should be aware of is that <code>strconv.Unquote()</code> can only unquote strings that are in quotes (e.g. start and end with a quote char <code>\"</code> or a back quote char <code>`</code>),  so we have to manually append that.</p>\n\n<p>See this example:</p>\n\n<pre><code>s := `\\x41BC`\nfmt.Println(s)\ns2, err := strconv.Unquote(`\"` + s + `\"`)\nif err != nil {\n    panic(err)\n}\nfmt.Println(s2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/SVcrEE2gl0\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\\x41BC\nABC\n</code></pre>\n\n<p>So if you want to be able to provide quoted strings as command line arguments and still have the unquoted values, you have to unquote them with <code>strconv.Unquote()</code> after calling <a href=\"https://golang.org/pkg/flag/#Parse\" rel=\"nofollow noreferrer\"><code>flag.Parse()</code></a>, for example:</p>\n\n<pre><code>var param string\nflag.StringVar(&amp;param, \"param\", \"\", \"the param with hex chars\")\n\nflag.Parse()\nvar err error\nparam, err = strconv.Unquote(`\"` + param + `\"`)\nif err != nil {\n    panic(err) // handle error\n}\n// param now contains the unquoted argument value\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 422959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4217340c86093c3da686bc9d6f2295f?s=128&d=identicon&r=PG", "display_name": "turkishweb", "link": "https://stackoverflow.com/users/422959/turkishweb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 36268444, "answer_count": 1, "score": 0, "last_activity_date": 1540319840, "creation_date": 1459187794, "last_edit_date": 1459271508, "question_id": 36267968, "link": "https://stackoverflow.com/questions/36267968/get-golang-flags-as-byte-array", "title": "Get Golang flags as byte array", "body": "<p>I am using <code>flag</code> package to read all the parameters I am passing to my Golang program. The problem is that if I pass an argument such as <code>\"\\x41BC\"</code>, it is not read as a 3 byte array (with chars <code>'A'</code>, <code>'B'</code> and <code>'C'</code>), but as a 6 byte array (<code>'\\'</code>, <code>'x'</code>, <code>'4'</code>, <code>'1'</code>, <code>'B'</code>, <code>'C'</code>).</p>\n\n<p>If it could be useful to answer, I am reading that string using:</p>\n\n<pre><code>flag.StringVar(&amp;param, \"param\", \"\", \"the param with hex chars\")\n</code></pre>\n\n<p>Is there a way to avoid this?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["swift", "go", "programming-languages", "llvm"], "comments": [{"owner": {"reputation": 5927, "user_id": 488035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85034ef64232dfcb7cf269e8d30b17a5?s=128&d=identicon&r=PG", "display_name": "Lachezar", "link": "https://stackoverflow.com/users/488035/lachezar"}, "edited": false, "score": 0, "creation_date": 1459173283, "post_id": 36263667, "comment_id": 60155579, "body": "Without being too profecient in the topic, Apple&#39;s standard library is designed around NeXTSTEP&#39;s system calls and simply put someone needs to rewrite it to be completely compatible with Linux/Unix. I suspect that Go/Rust relies on Unix compatible libraries which are capable of running on OSX."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 4, "creation_date": 1459173390, "post_id": 36263667, "comment_id": 60155646, "body": "Go repeats system specific code in separate files, and adds the platform as a suffix, e.g. <code>tcp_linux.go</code>. Upon build only the relevant platform&#39;s files are built."}], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 9, "last_activity_date": 1459208209, "last_edit_date": 1459208209, "creation_date": 1459183485, "answer_id": 36266749, "question_id": 36263667, "link": "https://stackoverflow.com/questions/36263667/how-to-programming-languages-implement-cross-platform-features/36266749#36266749", "title": "How to programming languages implement cross platform features?", "body": "<p>The question may be closed as \"too broad.\"  But... Since you tagged it with Go, I'll answer it in regards to Go.</p>\n\n<p>GoLang has a compiler for each platform.  The Go runtime tools (<code>go build</code>, etc) are built specific to each platform from the same common source code/repo.  You can see all the platforms supported with 1.6:</p>\n\n<p><a href=\"https://github.com/golang/go/tree/release-branch.go1.6/src/runtime\" rel=\"nofollow\">https://github.com/golang/go/tree/release-branch.go1.6/src/runtime</a></p>\n\n<p>(Take note of the <code>_linux_amd64.go</code> type suffixes.  More on this in a bit.)</p>\n\n<p>Now, how does one compile code to specific platforms?  This is where each language has its own specific directives for each platform (if it is a cross-platform language).  In previous Go (1.4 and earlier), the runtime code was written in C with platform-specific C directives, similar to what you've already eluded to:</p>\n\n<pre><code>#if os(Linux)\nimport Glibc\n#else\nimport Darwin.C\n#endif\n</code></pre>\n\n<p>It was ugly...  Well, Go actually had some clean cross-compiling C code with tricks like that above more abstracted and manageable.  But my old cross-compiled C code was, well, ugly like that.  </p>\n\n<p>But since Go 1.5, Go is now written in Go.  What this means is: <strong><em>a Go runtime is used to compile Go's source code into a Go runtime.</em></strong>  This means the Go language uses its own platform-specific directives to compile its own platform specific runtime.  </p>\n\n<h1>How Go specifies a platform</h1>\n\n<p>So how does Go specify different platform-specific code?  There are two different ways:</p>\n\n<ul>\n<li>build flags</li>\n<li>file suffixes</li>\n</ul>\n\n<p>There are ups and downs to each.  <a href=\"http://dave.cheney.net/2013/10/12/how-to-use-conditional-compilation-with-the-go-build-tool\" rel=\"nofollow\">As stated by Dave Cheney himself</a>:</p>\n\n<blockquote>\n  <p>In general, when choosing between a build tag or a file suffix, you\n  should choose a file suffix when there is an exact match between the\n  platform or architecture and the file you want to include.</p>\n</blockquote>\n\n<pre><code>mypkg_linux.go         // only builds on linux systems\nmypkg_windows_amd64.go // only builds on windows 64bit platforms\n</code></pre>\n\n<blockquote>\n  <p>Conversely if your file is applicable to more than one platform or\n  architecture, or you need to exclude a specific platform, a build tag\n  should be used. eg,</p>\n</blockquote>\n\n<pre><code>% grep '+build' $HOME/go/src/pkg/os/exec/lp_unix.go \n// +build darwin dragonfly freebsd linux netbsd openbsd\n</code></pre>\n\n<blockquote>\n  <p>builds on all unix like platforms.</p>\n</blockquote>\n\n<pre><code>% grep '+build' $HOME/go/src/pkg/os/types_notwin.go  // +build\n!windows\n</code></pre>\n\n<blockquote>\n  <p>builds on all platforms except Windows.</p>\n</blockquote>\n\n<h1>How to write Go code for cross-platform</h1>\n\n<p>If you were looking for a pattern on how to write Go code for cross-platform, here's my pattern.  Your mileage may vary.</p>\n\n<p>I personally try to stick to file suffixes myself as it makes it easier to denote what files support what platform by just viewing the list of files. </p>\n\n<p>First, start with an interface for your API.  <a href=\"https://talks.golang.org/2014/names.slide#14\" rel=\"nofollow\">Be sure to follow Go's naming convention</a> if for a single purpose.</p>\n\n<p><a href=\"https://github.com/eduncan911/go/blob/557c00ca37a00cd55a11ee79740f816b3d11b61c/pkg/cmd/shell.go\" rel=\"nofollow\"><code>shell.go</code></a></p>\n\n<pre><code>package cmd\n\n// osshell is a global variable that is implement on a per-OS basis.\nvar osshell shell\n\n// shell is the interface to an OS-agnostic shell to call commands.\ntype shell interface {\n    // Exec executes the command with the system's configured osshell.\n    Exec(command string) (string, error)\n}\n\n// Exec executes the command with the system's configured osshell.\nfunc Exec(command string) (string, error) {\n    return osshell.Exec(command)\n}\n</code></pre>\n\n<p>Since I am not exporting the interface, I didn't suffix with 'er'.  Eh, now that I think about it I should have.  :)</p>\n\n<p>Now, implement a Unix version that calls <code>sh</code>:</p>\n\n<p><a href=\"https://github.com/eduncan911/go/blob/557c00ca37a00cd55a11ee79740f816b3d11b61c/pkg/cmd/shell_unix.go\" rel=\"nofollow\"><code>shell_unix.go</code></a></p>\n\n<pre><code>package cmd\n\nimport (\n    \"bytes\"\n    \"os/exec\"\n)\n\nfunc init() {\n    osshell = &amp;unixshell{}\n}\n\ntype unixshell struct {\n}\n\nfunc (s *unixshell) Exec(command string) (string, error) {\n    cmd := exec.Command(\"sh\", \"-c\", command)\n    var buf bytes.Buffer\n    cmd.Stderr = &amp;buf\n    cmd.Stdout = &amp;buf\n\n    // assign return vars\n    err := cmd.Run()\n    out := buf.String()\n    return out, err\n}\n</code></pre>\n\n<p>When compiling this package for a Unix operating system, it will use this file with the suffix <code>_unix.go</code>.  Then, when the executable actually runs, the <code>init()</code> is called and wires up the <code>unixshell{}</code> struct implementation.  </p>\n\n<p>This all comes together to allow you to write a platform-agnostic program that consumes this package and to access shell commands like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"github.com/eduncan911/go/pkg/cmd\"\n)\n\nfunc main() {\n\n    output, err := cmd.Exec(\"echo 'Hello World!'\")\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    fmt.Println(output)\n}\n</code></pre>\n\n<p>And now run it:</p>\n\n<pre><code>$ go get github.com/eduncan911/go/pkg/cmd\n$ go run main.go\nHello World!\n</code></pre>\n\n<p>(Disclaimer, I only have a unix version implemented for that cmd.  I'll throw up some powershell version the next time I am on Windows to test it.)</p>\n\n<p>GoLang's ease of cross-platform development is exactly why I switched to Go for my primary development language as I have several side projects I'd like to be cross-platform.</p>\n"}], "owner": {"reputation": 95, "user_id": 3948713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ad4c23d29db1ac1a6c7c6a6a5d67f6?s=128&d=identicon&r=PG&f=1", "display_name": "J0-nas", "link": "https://stackoverflow.com/users/3948713/j0-nas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "closed_date": 1459183891, "answer_count": 1, "score": 0, "last_activity_date": 1459208209, "creation_date": 1459172756, "question_id": 36263667, "link": "https://stackoverflow.com/questions/36263667/how-to-programming-languages-implement-cross-platform-features", "closed_reason": "Needs more focus", "title": "How to programming languages implement cross platform features?", "body": "<p>This is more of a general question that bugs me ever since Swift became open source and the linux port lacked feeatures.</p>\n\n<p>There are many cross platform programming languages. Lets take Go for example. The (awesome) Go standard library has many packages. Some are helpful structs and functions based on primitive data types. But others implement I/O, networking, os, and sync.</p>\n\n<p>How does this compare to Swift and the LLVM compiler infastructure? </p>\n\n<p>For clang I think there exists e.g. cross platform concurrency, and we can cross compile. But for Swift there are platform differences where the Mac version depends on \"Darwin.C\" and the Linux one on \"Glibc\". This results in some awkward code snippets:</p>\n\n<pre><code>#if os(Linux)\nimport Glibc\n#else\nimport Darwin.C\n#endif\n</code></pre>\n\n<p>...</p>\n\n<pre><code>#if os(Linux)\n            let j = Int(random() % (count - i)))) + i\n#else\n            let j = Int(arc4random_uniform(UInt32(count - i))) + i\n#endif\n</code></pre>\n\n<p>Does Swift/LLVM handle these platform specific features always on the front end of the compiler such that they depend on c libraries? Or do/will they implement them as part of the compiler?</p>\n\n<p>I read that the Go/Rust compiler is itself written in Go/Rust. This leads me to believe that the compiler is implemented differently for each OS to feature concurrenty, networking - is independent of c libraries.</p>\n\n<p>Is that so? Or are some programming language just better at hiding their dependencies?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "is_accepted": true, "score": 4, "last_activity_date": 1459188489, "last_edit_date": 1459188489, "creation_date": 1459171137, "answer_id": 36263235, "question_id": 36262977, "link": "https://stackoverflow.com/questions/36262977/issue-with-serialization-and-deserialization-of-map-in-go-lang/36263235#36263235", "title": "Issue with serialization and deserialization of map in go lang", "body": "<p>Decoding is a process that requires the encoded information which will be in buffer used for encoding. Pass that to the decoder.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/gob\"\n    \"fmt\"\n)\n\nfunc main() {\n    org := map[string]string{\"hello\": \"world\"}\n    buf := store(org)\n\n    loadedMap := make(map[string]string)\n    load(&amp;loadedMap, buf)\n\n    fmt.Println(loadedMap)\n}\n\nfunc store(data interface{}) *bytes.Buffer {\n    m := new(bytes.Buffer)\n    enc := gob.NewEncoder(m)\n\n    err := enc.Encode(data)\n    if err != nil {\n        panic(err)\n    }\n    return m\n}\n\nfunc load(e interface{}, buf *bytes.Buffer) {\n    dec := gob.NewDecoder(buf)\n\n    err := dec.Decode(e)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 36263235, "answer_count": 1, "score": 1, "last_activity_date": 1459188489, "creation_date": 1459170242, "last_edit_date": 1459183753, "question_id": 36262977, "link": "https://stackoverflow.com/questions/36262977/issue-with-serialization-and-deserialization-of-map-in-go-lang", "title": "Issue with serialization and deserialization of map in go lang", "body": "<p>I am doing the basic serialization and deserialization of map as suggested <a href=\"http://play.golang.org/p/F01xZlCIQM\" rel=\"nofollow\">in this example</a>. But I get the following error:</p>\n\n<pre><code>panic: EOF\n\ngoroutine 1 [running]:\nmain.load(0x81147e0, 0x1840a378)\n    /home/naresh/Desktop/Work/GoEventHandler/test.go:39 +0x2cf\nmain.main()\n    /home/naresh/Desktop/Work/GoEventHandler/test.go:16 +0xe5\nexit status 2\n</code></pre>\n\n<p>Can anyone tell me what I am doing wrong in the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"bytes\"\n    \"encoding/gob\"\n)\n\nfunc main() {   \n    org := map[string]string{\"hello\": \"world\"}\n    store(org)\n\n    var loadedMap map[string]string\n    load(&amp;loadedMap)\n\n    fmt.Println(loadedMap)   \n}\n\nfunc store(data interface{}) {\n    m := new(bytes.Buffer) \n    enc := gob.NewEncoder(m)\n\n    err := enc.Encode(data)\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc load(e interface{}) {        \n    p := new(bytes.Buffer) \n    dec := gob.NewDecoder(p)\n\n    err := dec.Decode(e)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1459169421, "post_id": 36262533, "comment_id": 60153343, "body": "The Go tools only allow a 1 directory per package, and vice versa. Why do you need multiple directories?"}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 0, "last_activity_date": 1459187239, "last_edit_date": 1459187239, "creation_date": 1459182777, "answer_id": 36266559, "question_id": 36262533, "link": "https://stackoverflow.com/questions/36262533/beego-framework-api-project-can-i-have-folder-structure-in-controller-folder/36266559#36266559", "title": "Beego framework - api project - can I have folder structure in controller folder", "body": "<p>I suspect you don't have the initialization code for your other controller packages.</p>\n\n<p>For example, if you have a <code>UserController</code> in an <code>admin</code> package, like <code>admin.UserController</code>, you should also have one <code>init()</code> func in that <code>admin</code> package, that looks something like:</p>\n\n<pre><code>func init() {\n    beego.Router(\"/admin/user\", &amp;admin.UserController{})\n    // any other controllers register here ...\n}\n</code></pre>\n\n<p>Also, make sure to import the controller package in your main package, probably as an underscore import if there is nothing directly using it:</p>\n\n<pre><code>import (\n    _ \"github.com/foo/bar/controllers/admin\"\n)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2307796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7bc39aea9ef406e667fd91d5ddcc43e?s=128&d=identicon&r=PG", "display_name": "pudlo.damian", "link": "https://stackoverflow.com/users/2307796/pudlo-damian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459187239, "creation_date": 1459168865, "question_id": 36262533, "link": "https://stackoverflow.com/questions/36262533/beego-framework-api-project-can-i-have-folder-structure-in-controller-folder", "title": "Beego framework - api project - can I have folder structure in controller folder", "body": "<p>I want to group my controllers in some folder structure. </p>\n\n<p>Application works if controllers are directly in 'controllers' folder. </p>\n\n<p>Once I move controller to some controllers sub folder, router is not loading controller at all. (there's not compile errors) </p>\n\n<p>Can anyone help me with that ?</p>\n"}, {"tags": ["networking", "go"], "answers": [{"tags": [], "owner": {"reputation": 595, "user_id": 5443590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c3c26c54f6d700cd85d73e1f0cc4b5f?s=128&d=identicon&r=PG&f=1", "display_name": "GKV", "link": "https://stackoverflow.com/users/5443590/gkv"}, "is_accepted": false, "score": 3, "last_activity_date": 1466060237, "last_edit_date": 1466060237, "creation_date": 1460353593, "answer_id": 36540668, "question_id": 36262078, "link": "https://stackoverflow.com/questions/36262078/how-to-get-network-speed-in-linux-using-golang/36540668#36540668", "title": "How to get network Speed in linux using golang", "body": "<pre><code>I am using CGO to get network speed.\npackage main\n\n\n/*\n#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;linux/sockios.h&gt;\n#include &lt;linux/if.h&gt;\n#include &lt;linux/ethtool.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint get_interface_speed(char *ifname){\n    int sock;\n    struct ifreq ifr;\n    struct ethtool_cmd edata;\n    int rc;\n    sock = socket(AF_INET, SOCK_STREAM, 0);\n    // string copy first argument into struct\n    strncpy(ifr.ifr_name, ifname, sizeof(ifr.ifr_name));\n    ifr.ifr_data = &amp;edata;\n    // set some global options from ethtool API\n    edata.cmd = ETHTOOL_GSET;\n    // issue ioctl\n    rc = ioctl(sock, SIOCETHTOOL, &amp;ifr);\n\n    close(sock);\n\n    if (rc &lt; 0) {\n        perror(\"ioctl\");        // lets not error out here\n        // make sure to zero out speed\n        return 0;\n    }\n\n    return edata.speed;\n}\n*/\nimport \"C\"\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    ifname := []byte(\"eth0\\x00\")// interface name eth0,eth1,wlan0 etc.\n    sp := C.get_interface_speed((*C.char)(unsafe.Pointer(&amp;ifname[0])))\n    fmt.Println(sp)\n}\n\nPlease give some suggestion .\n</code></pre>\n"}], "owner": {"reputation": 595, "user_id": 5443590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c3c26c54f6d700cd85d73e1f0cc4b5f?s=128&d=identicon&r=PG&f=1", "display_name": "GKV", "link": "https://stackoverflow.com/users/5443590/gkv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2014, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1466060237, "creation_date": 1459167247, "last_edit_date": 1459168587, "question_id": 36262078, "link": "https://stackoverflow.com/questions/36262078/how-to-get-network-speed-in-linux-using-golang", "title": "How to get network Speed in linux using golang", "body": "<p>guys  i am reading <strong>/proc/net/dev</strong> for received and transmitted bytes \n     i am able to calculate in_traffic ,out_traffic but Speed not able to find </p>\n\n<p>delta_time is difference b/w last checked unix time and current unix time</p>\n\n<pre><code>in_traffic = ( ( (new_inbytes - prev_inbytes) * 8 ) /  (delta_time) )\nout_traffic = ( ( (new_outbytes -  prev_outbytes) * 8) / (delta_time))\n\nif speed &gt; 0{\n        in_utilization = in_traffic / (speed * 10000)\n        out_utilization = out_traffic / (speed * 10000)\n    }   \n</code></pre>\n\n<p>please help,\nthanks </p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1459169360, "post_id": 36261502, "comment_id": 60153314, "body": "Check this out. <a href=\"http://stackoverflow.com/questions/13107958/what-exactly-does-runtime-gosched-do\">related question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1521, "user_id": 1802425, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7499715a96ce8bc0ba9c3e4586248f75?s=128&d=identicon&r=PG", "display_name": "xaxa", "link": "https://stackoverflow.com/users/1802425/xaxa"}, "edited": false, "score": 0, "creation_date": 1459179209, "post_id": 36262531, "comment_id": 60158774, "body": "if I have enough cores and the execution flow meets <code>Gosched()</code> there may actually be no waiting, did I get it right? So <code>Gosched()</code> is a kind of saying &quot;if you can continue running otherwise you may switch to another goroutine here&quot;?"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 1521, "user_id": 1802425, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7499715a96ce8bc0ba9c3e4586248f75?s=128&d=identicon&r=PG", "display_name": "xaxa", "link": "https://stackoverflow.com/users/1802425/xaxa"}, "edited": false, "score": 0, "creation_date": 1459180499, "post_id": 36262531, "comment_id": 60159513, "body": "I think it will always pause the current goroutine. And pick a waiting goroutine to execute. If the only waiting goroutine is the one it just paused, then it will be picked again. So basically what you said."}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 3, "last_activity_date": 1459169884, "last_edit_date": 1459169884, "creation_date": 1459168857, "answer_id": 36262531, "question_id": 36261502, "link": "https://stackoverflow.com/questions/36261502/goroutine-example-explaination-needed/36262531#36262531", "title": "Goroutine example explaination needed", "body": "<p>First output is the one that will be generated by a single core machine. The second could be generated by a multicore one.</p>\n\n<p><code>say</code> is a function with a for loop inside, that iterates 5 times. It indeed is an ordinary function but there is a call to <code>Gosched</code> in it. What <code>Gosched</code> does is, it tell the runtime to pause executing the current goroutine and instead start another waiting goroutine. This is called <em>yielding</em>.</p>\n\n<p><strong>Explaining first output</strong></p>\n\n<p>This is the output you can expect to get in a single core machine. Going step by step,</p>\n\n<p><code>go say(\"world\")</code></p>\n\n<p>At this step the runtime starts executing the <code>say(\"world\")</code> call on a seperate goroutine and continue the main goroutine. But the machine only has a single core. So both goroutines cannot run parrallely. The new goroutine (say <code>gr A</code>) has to wait until the running main goroutine(say <code>gr B</code>) finishes or <em>pauses</em>(yeilds). So it waits. Main goroutine starts executing <code>say(\"hello\")</code></p>\n\n<p>Now while going through the <code>say</code> function of <code>gr B</code> runtime meets <code>runtime.Gosched()</code> </p>\n\n<p>The <code>Gosched</code> call is like <em>pausing</em>. It tells the runtime to pause me and shedule an other goroutine that is waiting. So the runtime schedules the <code>gr A</code>. It begins from where it was waiting, which is,</p>\n\n<p><code>say(\"world\")</code></p>\n\n<p>Now <code>gr A</code> executes until it meets its own <code>runtime.Gosched()</code>. <code>gr A</code> pauses. <code>gr B</code> wakes up and start running from where it left. The statement after <code>runtime.Gosched()</code> is to print \"hello\". So \"hello\" is printed. <code>gr B</code> continues and enters the next iteration of its for loop. Meets <code>Gosched</code>. Pauses. <code>gr A</code> restarts. Prints \"world\". I think you can see how this goes on for 5 times until it prints the given output.</p>\n\n<p><strong>Explaining the second output</strong></p>\n\n<p>If your machine has more than one core, the goroutines can run in parallel. Yours is an output you get when it does.</p>\n\n<p>Now when <code>go say(\"world\")</code> is called <code>gr A</code> does not have to wait until <code>gr B</code> finishes. It can immediately start on an other core. So when <code>Gosched</code> is called there could be no waiting goroutines. If the current one pauses it will immediately start on a different core.</p>\n\n<p>So in a multicore machine you can't guarantee the order the words are printed. If you run the program many times I think you will see other orders as well.</p>\n\n<p>You can set GOMAXPROCs to 1 and see how the program would run on a single core machine.</p>\n\n<pre><code>func main() {\n    runtime.GOMAXPROCS(1)\n\n    go say(\"world\") // create a new goroutine\n    say(\"hello\")    // current goroutine\n}\n</code></pre>\n\n<p>Then you will see the first output.</p>\n"}], "owner": {"reputation": 1521, "user_id": 1802425, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7499715a96ce8bc0ba9c3e4586248f75?s=128&d=identicon&r=PG", "display_name": "xaxa", "link": "https://stackoverflow.com/users/1802425/xaxa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 2, "accepted_answer_id": 36262531, "answer_count": 1, "score": 2, "last_activity_date": 1459169884, "creation_date": 1459164932, "question_id": 36261502, "link": "https://stackoverflow.com/questions/36261502/goroutine-example-explaination-needed", "title": "Goroutine example explaination needed", "body": "<p>I've just started to learn Go and follow a tutorial which contains the following example on goroutines:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 5; i++ {\n        runtime.Gosched()\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    go say(\"world\") // create a new goroutine\n    say(\"hello\")    // current goroutine\n}\n</code></pre>\n\n<p>it states that \"<strong>runtime.Gosched()</strong> <em>means let the CPU execute other goroutines, and come back at some point.</em>\". The following output is given below the example:</p>\n\n<pre><code>hello\nworld\nhello\nworld\nhello\nworld\nhello\nworld\nhello\n</code></pre>\n\n<p>However when I run this example on my machine with <code>go run</code> I get</p>\n\n<pre><code>hello\nworld\nworld\nworld\nworld\nworld\nhello\nhello\nhello\nhello\n</code></pre>\n\n<p>my version of Go is <code>go version go1.6 darwin/amd64</code>.</p>\n\n<p>Actually I don't understand either result! Why isn't it just</p>\n\n<pre><code>hello\n</code></pre>\n\n<p>? As I understand Go programs quit after the last statement of the program is executed, so I'd think that after <code>say()</code> is run as a goroutine and its execution is delayed, the program executes next <code>say()</code> as an ordinary function, print \"hello\" and then exit.</p>\n\n<p>So which result is the correct one and why?</p>\n"}, {"tags": ["xml", "go", "marshalling"], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 18763, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/78QOw.jpg?s=128&g=1", "display_name": "wbg", "link": "https://stackoverflow.com/users/18763/wbg"}, "edited": false, "score": 0, "creation_date": 1459186320, "post_id": 36262495, "comment_id": 60162344, "body": "Thanks for the answer. I was hoping to avoid doing this, as almost every value is a string, so the API would be a repellent mess of pointers to strings. I think I&#39;m going to have to generate the XML &quot;by hand&quot;."}], "tags": [], "owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "is_accepted": false, "score": 1, "last_activity_date": 1459169317, "last_edit_date": 1459169317, "creation_date": 1459168744, "answer_id": 36262495, "question_id": 36261195, "link": "https://stackoverflow.com/questions/36261195/optional-omitempty-when-marshalling-xml/36262495#36262495", "title": "Optional &quot;omitempty&quot; when marshalling XML?", "body": "<p>You can use pointers in the struct you are going to marshal. In case the pointer is <code>nil</code> the field will be omitted. In case it is pointing to a string it will be rendered (even if the string is empty).</p>\n\n<p><a href=\"http://play.golang.org/p/w6wUDSmwbo\" rel=\"nofollow\">Play</a></p>\n\n<pre><code>type Address struct {\n    City *string\n}\n\ncity1 := \"NYC\"\ncity2 := \"\"\naddress1 := Address{&amp;city1}\naddress2 := Address{&amp;city2}\naddress3 := Address{nil}\n\nenc := xml.NewEncoder(os.Stdout)\n\nenc.Encode(address1) // &lt;Address&gt;&lt;City&gt;NYC&lt;/City&gt;&lt;/Address&gt;\nenc.Encode(address2) // &lt;Address&gt;&lt;City&gt;&lt;/City&gt;&lt;/Address&gt;\nenc.Encode(address3) // &lt;Address&gt;&lt;/Address&gt;\n</code></pre>\n"}], "owner": {"reputation": 1024, "user_id": 18763, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/78QOw.jpg?s=128&g=1", "display_name": "wbg", "link": "https://stackoverflow.com/users/18763/wbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459169317, "creation_date": 1459163700, "question_id": 36261195, "link": "https://stackoverflow.com/questions/36261195/optional-omitempty-when-marshalling-xml", "title": "Optional &quot;omitempty&quot; when marshalling XML?", "body": "<p>I'm trying to generate XML for the Alfred 2 application. Looks kinda like this:</p>\n\n<pre><code>&lt;items&gt;\n    &lt;item autocomplete=\"My Thing\"&gt;\n        &lt;title&gt;My Thing&lt;/title&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;title&gt;My Other Thing&lt;/title&gt;\n    &lt;/item&gt;\n    &lt;item autocomplete=\"\"&gt;\n        &lt;title&gt;My Third Thing&lt;/title&gt;\n    &lt;/item&gt;\n&lt;/items&gt;\n</code></pre>\n\n<p>The specific challenge I'm facing is that Alfred behaves differently if the <code>autocomplete</code> attribute on <code>item</code> is missing than if it is set to an empty string.</p>\n\n<p>As a result, I'd like to be able to offer both possibilities: omit the attribute by default (<code>omitempty</code>), but offer the possibility to force it to be set to an empty string (<em>not</em> <code>omitempty</code>).</p>\n\n<p>How could I go about doing this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1459165616, "last_edit_date": 1459165616, "creation_date": 1459165268, "answer_id": 36261589, "question_id": 36260994, "link": "https://stackoverflow.com/questions/36260994/golang-index-out-of-range/36261589#36261589", "title": "Golang index out of range", "body": "<p>You need to make the slices for both dimensions, dy and dx, of the picture. For example,</p>\n\n<pre><code>package main\n\nimport \"golang.org/x/tour/pic\"\n\nfunc Pic(dx, dy int) [][]uint8 {\n    p := make([][]uint8, dy)\n    for i := range p {\n        p[i] = make([]uint8, dx)\n        for j := range p[i] {\n            p[i][j] = uint8(i * j)\n        }\n    }\n    return p\n}\n\nfunc main() {\n    pic.Show(Pic)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1396, "user_id": 1147648, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8cnlR.jpg?s=128&g=1", "display_name": "FZE", "link": "https://stackoverflow.com/users/1147648/fze"}, "is_accepted": false, "score": 0, "last_activity_date": 1459165891, "creation_date": 1459165891, "answer_id": 36261734, "question_id": 36260994, "link": "https://stackoverflow.com/questions/36260994/golang-index-out-of-range/36261734#36261734", "title": "Golang index out of range", "body": "<p>The problem in your code you are looping in wrong size in the second loop.\nyour second range must be sieze of <code>s1[i]</code> not <code>s1</code> because the second loop processes on inner dimension.</p>\n\n<pre><code>for i := range s1{\n    fmt.Printf(\"%d\\n\",i)\n    s1[i] = make ([] uint8, dy)\n    for j := range s1[i] {\n        fmt.Printf(\"%d\\n\",j)\n        s1[i][j] = dx8\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5739130, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f019a2cde05dc1b7585530a341841f80?s=128&d=identicon&r=PG&f=1", "display_name": "dbaus", "link": "https://stackoverflow.com/users/5739130/dbaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1459166775, "creation_date": 1459163016, "last_edit_date": 1459166775, "question_id": 36260994, "link": "https://stackoverflow.com/questions/36260994/golang-index-out-of-range", "title": "Golang index out of range", "body": "<p>I'm trying to make a simply example of Golang. The example it's in te 36\u00ba page of the tour of golang.\nThis is my code:</p>\n\n<pre><code>package main\n\nimport \"code.google.com/p/go-tour/pic\"\nimport \"fmt\"\n\nfunc Pic(dx, dy int) [][]uint8 {\n    dx8 := uint8(dx)\n\n    s1 := make ([][] uint8, dy)\n    fmt.Printf(\"%d\\n\", len(s1), cap(s1))\n\n    for i := range s1{\n        fmt.Printf(\"%d\\n\",i)\n        for j := range s1 {\n            fmt.Printf(\"%d\\n\",j)\n            s1[i][j] = dx8    \n        }\n    }\n\n    return s1\n}\n\nfunc main() {\n    pic.Show(Pic)\n}\n</code></pre>\n\n<p>And the error I got:</p>\n\n<pre><code>    256\n%!(EXTRA int=256)0\n0\npanic: runtime error: index out of range\n\ngoroutine 1 [running]:\npanic(0x18b820, 0x1040a010)\n    /usr/local/go/src/runtime/panic.go:464 +0x700\nmain.Pic(0x100, 0x100, 0x0, 0x0, 0x0, 0x0)\n    /tmp/sandbox716191956/main.go:17 +0x4e0\ncode.google.com/p/go-tour/pic.Show(0x1d7988, 0x104000e0)\n    /go/src/code.google.com/p/go-tour/pic/pic.go:20 +0x60\nmain.main()\n    /tmp/sandbox716191956/main.go:26 +0x20\n\nProgram exited.\n</code></pre>\n\n<p>I only want to return a bidimensial slice which <code>Show</code> function uses.</p>\n"}, {"tags": ["go", "ide", "nim-lang", "liclipse"], "comments": [{"owner": {"reputation": 1321, "user_id": 2422432, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d4d98d22353178cf1266cb450edb957?s=128&d=identicon&r=PG", "display_name": "vktec", "link": "https://stackoverflow.com/users/2422432/vktec"}, "edited": false, "score": 0, "creation_date": 1467207940, "post_id": 36260545, "comment_id": 63636803, "body": "Does it not syntax highlight Nim or Go code? Or are you looking for other features (eg. code completion)?"}], "answers": [{"tags": [], "owner": {"reputation": 23516, "user_id": 110451, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70fc26faedcbfc82344a0b347053aaa0?s=128&d=identicon&r=PG", "display_name": "Fabio Zadrozny", "link": "https://stackoverflow.com/users/110451/fabio-zadrozny"}, "is_accepted": false, "score": 0, "last_activity_date": 1496336566, "creation_date": 1496336566, "answer_id": 44313315, "question_id": 36260545, "link": "https://stackoverflow.com/questions/36260545/how-to-enable-any-language-other-than-python/44313315#44313315", "title": "How to enable any language other than Python?", "body": "<p>LiClipse has a lightweight editor for those languages (which provides basic syntax highlighting, outline, comment/uncomment and basic code-completion -- i.e.: based on templates), so, if that's enough for you, you should be able to just open the file you want and use the provided editor.</p>\n\n<p>Now, if you require more features for some given language, you can still install another more full-featured plugin to edit it.</p>\n\n<p>Related to the perspective, you should be able to use the Resource Perspective for any language.</p>\n"}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1496336566, "creation_date": 1459161315, "question_id": 36260545, "link": "https://stackoverflow.com/questions/36260545/how-to-enable-any-language-other-than-python", "title": "How to enable any language other than Python?", "body": "<p>I recently found out about liclipse and was very excited about its concept (lite eclipse) especially when newly installed Liclipse managed to start up in 5 seconds. But it seems I cannot find how to use it for any of languages listed on the website as it comes only with PyDev perspective and several other Python-related things (e.g. PyDev), but since I am not a Python developer and was looking for nim and Go support I started exploring their documentation but had no success.</p>\n\n<p>So my question is if I should install the plugins for languages I want (e.g. like in standard Eclipse) but that would be odd since Liclipse says it supports those languages out-of-the-box.</p>\n\n<p>I downloaded the latest version of Liclipse from their website and am on Win32 p;latform if it changes anything.</p>\n"}, {"tags": ["json", "rest", "go"], "comments": [{"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1459148987, "post_id": 36257576, "comment_id": 60144079, "body": "try fmt.Println(&quot;response Body:&quot;, string(body[:])) instead of string(body)"}, {"owner": {"reputation": 174, "user_id": 3996094, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3KKPC.jpg?s=128&g=1", "display_name": "RandomAndy", "link": "https://stackoverflow.com/users/3996094/randomandy"}, "reply_to_user": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1459149099, "post_id": 36257576, "comment_id": 60144118, "body": "It&#39;s the same result: <code>response Body: {&quot;foo&quot;:&quot;bar&quot;}null</code>"}, {"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 1, "creation_date": 1459149747, "post_id": 36257576, "comment_id": 60144374, "body": "May be if err := json.NewEncoder(w).Encode(err) is printing null when err is null"}, {"owner": {"reputation": 174, "user_id": 3996094, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3KKPC.jpg?s=128&g=1", "display_name": "RandomAndy", "link": "https://stackoverflow.com/users/3996094/randomandy"}, "reply_to_user": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1459150646, "post_id": 36257576, "comment_id": 60144749, "body": "That&#39;s it! <code>err</code> is nil, so it encodes the actual JSON plus err. I&#39;m just wondering how to do it correctly then?"}, {"owner": {"reputation": 174, "user_id": 3996094, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3KKPC.jpg?s=128&g=1", "display_name": "RandomAndy", "link": "https://stackoverflow.com/users/3996094/randomandy"}, "reply_to_user": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1459151136, "post_id": 36257576, "comment_id": 60144950, "body": "Got it: So instead of adding the JSON payload to the <code>ResponseWriter</code> via <code>w.Write(myJsonStruct)</code>, I&#39;m passing it now directly to Encode(), which then encodes it perfectly."}, {"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1459151714, "post_id": 36257576, "comment_id": 60145163, "body": "Glad that it worked :) I am adding it as answer"}, {"owner": {"reputation": 174, "user_id": 3996094, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3KKPC.jpg?s=128&g=1", "display_name": "RandomAndy", "link": "https://stackoverflow.com/users/3996094/randomandy"}, "reply_to_user": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 0, "creation_date": 1459160330, "post_id": 36257576, "comment_id": 60148781, "body": "Just realised that I didn&#39;t say thanks: So thanks! ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "is_accepted": true, "score": 1, "last_activity_date": 1459151832, "creation_date": 1459151832, "answer_id": 36258249, "question_id": 36257576, "link": "https://stackoverflow.com/questions/36257576/invalid-null-added-to-http-response-json-body-when-reading-with-ioutil-in-golang/36258249#36258249", "title": "Invalid null added to HTTP response JSON body when reading with ioutil in golang", "body": "<p><code>if err := json.NewEncoder(w).Encode(err)</code> is printing null when err is nil. Pass response to encode and make err part of it so only one json structure is printed.</p>\n"}], "owner": {"reputation": 174, "user_id": 3996094, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3KKPC.jpg?s=128&g=1", "display_name": "RandomAndy", "link": "https://stackoverflow.com/users/3996094/randomandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 36258249, "answer_count": 1, "score": 1, "last_activity_date": 1459151832, "creation_date": 1459148529, "question_id": 36257576, "link": "https://stackoverflow.com/questions/36257576/invalid-null-added-to-http-response-json-body-when-reading-with-ioutil-in-golang", "title": "Invalid null added to HTTP response JSON body when reading with ioutil in golang", "body": "<p>So this one is driving me insane. I'm not even sure if the title is 100% correct because I'm having some trouble to narrow the issue down to one specific part.</p>\n\n<p>I have two applications that talk to each other via REST. One accepts the HTTP GET request from the other app, and answers with some JSON. For the HTTP router I use Gorilla/mux btw. So far so good.</p>\n\n<p>My first application (let's call it <code>FooReader</code>), is calling my second application (let's call it <code>FooWriter</code>) via HTTP GET:</p>\n\n<pre><code>req, err := http.NewRequest(\"GET\", url, nil)\nreq.Header.Set(\"uuid\", \"my uuid\")\nreq.Header.Set(\"api_token\", \"my token\")\nreq.Header.Set(\"Content-Type\", \"application/json\")\n\nclient := &amp;http.Client{}\nresp, err := client.Do(req)\nif err != nil {\n    ...\n}\ndefer resp.Body.Close()\n</code></pre>\n\n<p>This works just fine. As you can see I'm sending some additional stuff in the header, that's why I'm not using <code>http.Get()</code>. (Is there a better way to do this?)</p>\n\n<p>Now <code>FooWriter</code> receives that request and processes it:</p>\n\n<pre><code>...\nvar successJSON = \"{\\\"foo\\\":\\\"bar\\\"}\"\nw.Header().Set(\"Content-Type\", \"application/json; charset=UTF-8\")\nw.Write([]byte(successJSON))\nw.WriteHeader(200)\n\nif err := json.NewEncoder(w).Encode(err); err != nil {\n    ...\n}\n</code></pre>\n\n<p>Back in <code>FooReader</code> I now receive the response from <code>FooWriter</code> and read it (I've added the Do() call again for clarity):</p>\n\n<pre><code>resp, err := client.Do(req)\nif err != nil {\n    ...\n}\ndefer resp.Body.Close()\n\nfmt.Println(\"response Code:\", resp.StatusCode)\n\nbody, err := ioutil.ReadAll(io.LimitReader(resp.Body, 1048576))\nif err != nil {\n    ...\n}\n\nfmt.Println(\"response Body:\", string(body))\n</code></pre>\n\n<p>Now comes the weird part: When I print the response body like I do in the last line, there is an additional <code>null</code> added to the original JSON string:</p>\n\n<pre><code>response Code: 200\nresponse Body: {\"foo\":\"bar\"}null\n</code></pre>\n\n<p>My guess is that there is some <code>nil</code> thrown in there before the JSON decoding, but I just can't find it.\nAlso I'm guessing that the issue has to be on the <code>FooReader</code> side, because I'm using the exact same code on <code>FooWriter</code> side on some other part of the application, which works fine.</p>\n\n<p>Did I miss anything? Any help is much appreciated!</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 1, "creation_date": 1459143937, "post_id": 36256582, "comment_id": 60142386, "body": "Isn&#39;t it the &quot;default&quot; case to simply use the struct&#39;s field name and the  bson:json representation is an override? Pretty sure it is. At any rate, you seem to be missing the difference betwen your struct and the storage. Whilst the details are there to &quot;marshal&quot; a BSON document into your struct, there is not a &quot;query mechanism&quot;  to &quot;construct&quot; a query based on your struct. Not by directlt using <code>.Find()</code> anyway. If you feel so inclined to write such a library then by all means go ahead. The .NET driver has functions like this, but generally most lower level drivers do not."}, {"owner": {"reputation": 1973, "user_id": 2056426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ge8I5.png?s=128&g=1", "display_name": "delos", "link": "https://stackoverflow.com/users/2056426/delos"}, "reply_to_user": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1459144241, "post_id": 36256582, "comment_id": 60142463, "body": "My bad, I didn&#39;t mean the <code>.Find</code> method specifically, just if there&#39;s a tool I&#39;m missing which finds the struct&#39;s current <code>bson:json</code> name and uses that for the query. You&#39;re right, it is an override to rename it, I&#39;m sticking to a convention with project partner to keep json variables snake case for when it&#39;s marshalled."}, {"owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1459144757, "post_id": 36256582, "comment_id": 60142610, "body": "See but there&#39;s the thing. The <code>mgo</code> driver does not do that. And if you are then actually asking for a recommendation on a tool or library, then that&#39;s off-topic here. So the driver only understand the bson document you explicitly give it as far as any &quot;query&quot; or &quot;update&quot; or whater. So just BSON only. Your project requirements are of course your own, so it&#39;s your choice here that is creating a mismatch. But you still need to create the BSON since the &quot;struct&quot; is not the query. You want a LINQ for Go. But here is not the place to ask."}, {"owner": {"reputation": 1973, "user_id": 2056426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ge8I5.png?s=128&g=1", "display_name": "delos", "link": "https://stackoverflow.com/users/2056426/delos"}, "reply_to_user": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1459144875, "post_id": 36256582, "comment_id": 60142642, "body": "Wasn&#39;t asking for a recommendation, just if there&#39;s something I was missing in the Go standard library, or <code>mgo</code> itself. Thanks for the advice, if you turn your response into an answer, I&#39;ll mark it as chosen."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1515943017, "post_id": 36256582, "comment_id": 83484401, "body": "My 2 cents on this: of course, nobody stops you from adding a service layer which does what you describe. If you feel adventurous, make it generic and publish it."}], "owner": {"reputation": 1973, "user_id": 2056426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ge8I5.png?s=128&g=1", "display_name": "delos", "link": "https://stackoverflow.com/users/2056426/delos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 951, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1459143318, "creation_date": 1459143318, "question_id": 36256582, "link": "https://stackoverflow.com/questions/36256582/golang-mgo-json-string-name-consistency", "title": "Golang mgo json string name consistency", "body": "<p>Let's say we have a Go struct like so</p>\n\n<pre><code>type Person struct {\n    Name string `json:\"name\" bson:\"name\"`\n}\n</code></pre>\n\n<p>Whenever I want to search a field for this person, in the Mongo module <code>mgo</code>, I do something like <code>userCollection.Find(bson.M{\"name\" : \"John\"})</code></p>\n\n<p>What I want to know is, is there a way to call <code>Find</code> like above, but where I don't need to type out the string field that I'm looking for (<code>\"name\"</code> in this case). I want to avoid this because if I change the <code>bson</code> field name in the struct, I'll have to comb through the code base and change it everywhere.</p>\n\n<p>Aside from having global constants everywhere for every struct's field, is there a way to call <code>mgo</code> using the struct's own field?</p>\n\n<p>For instance, something which can be called <code>userCollection.Find(bson.M{Person.Name : \"John\"})</code>, which will automatically find <code>Person.Name</code> field in the struct (which is <code>\"name\"</code> in this case) and perform the query.</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "edited": false, "score": 3, "creation_date": 1459152195, "post_id": 36256230, "comment_id": 60145334, "body": "what does your code look like when you add  <code>_ &quot;github.com&#47;go-sql-driver&#47;mysql&quot;</code>? It shouldn&#39;t give imported and not used when you put underscore before package name."}], "answers": [{"tags": [], "owner": {"reputation": 24240, "user_id": 495935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d310e51ac60b2a54b68b96e90593277b?s=128&d=identicon&r=PG", "display_name": "Surreal Dreams", "link": "https://stackoverflow.com/users/495935/surreal-dreams"}, "is_accepted": false, "score": 11, "last_activity_date": 1459180090, "creation_date": 1459180090, "answer_id": 36265793, "question_id": 36256230, "link": "https://stackoverflow.com/questions/36256230/connection-fails-with-mysql-using-golang/36265793#36265793", "title": "Connection fails with mysql using GoLang", "body": "<p>Try it again, but look for my NOTEs:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n)\n// NOTE - I removed the import for \"fmt\" because it was unused.\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"astaxie:astaxie@/test?charset=utf8\")\n    checkErr(err);\n    err=db.Ping();\n    // NOTE - the above line will trigger an error because err is unused.\n}\n</code></pre>\n\n<p>I added the import for the MySQL driver and removed \"fmt\" because it was unused.   This may be the cause of your \"imported and not used\" error.</p>\n"}, {"comments": [{"owner": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "edited": false, "score": 0, "creation_date": 1515272407, "post_id": 43810534, "comment_id": 83240817, "body": "Why do we need this driver?"}, {"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "reply_to_user": {"reputation": 1369, "user_id": 6525347, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4NZOi.gif?s=128&g=1", "display_name": "thelearner", "link": "https://stackoverflow.com/users/6525347/thelearner"}, "edited": false, "score": 1, "creation_date": 1515381022, "post_id": 43810534, "comment_id": 83265630, "body": "Because <code>database&#47;sql</code> does not provide an implementation for specific sql databases, only a generic interface -- the driver implements the logic that interfaces with the specific database, in this case mysql (handling connections to the database, executing queries, preparing statements, etc)"}], "tags": [], "owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "is_accepted": false, "score": 26, "last_activity_date": 1494004582, "creation_date": 1494004582, "answer_id": 43810534, "question_id": 36256230, "link": "https://stackoverflow.com/questions/36256230/connection-fails-with-mysql-using-golang/43810534#43810534", "title": "Connection fails with mysql using GoLang", "body": "<p>For others coming to this page as a result of the error <em>sql: unknown driver \"mysql\" (forgotten import?)</em>, the <code>database/sql</code> package must be used in conjunction with a <strong>database driver</strong>. That means in addition to importing the <code>database/sql</code> package, <strong>you need to import a database driver</strong>.</p>\n\n<p>For example, for mysql, you could use the package <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"noreferrer\">go-sql-driver</a>. Typically, you import this package using the underscore <code>_</code> notation, meaning it is imported for its side effects only:</p>\n\n<pre><code>import _ \"github.com/go-sql-driver/mysql\"\n</code></pre>\n\n<p>You can read more about this and find a list of SQL drivers below:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/database/sql/\" rel=\"noreferrer\">https://golang.org/pkg/database/sql/</a></li>\n<li><a href=\"https://github.com/golang/go/wiki/SQLDrivers\" rel=\"noreferrer\">https://github.com/golang/go/wiki/SQLDrivers</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 4699404, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9IcJBKm_pRU/AAAAAAAAAAI/AAAAAAAAAHU/Y3-F2bEoXWQ/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u0410\u0432\u0435\u0440\u044c\u044f\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/4699404/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%90%d0%b2%d0%b5%d1%80%d1%8c%d1%8f%d0%bd%d0%be%d0%b2"}, "is_accepted": false, "score": 0, "last_activity_date": 1537723566, "last_edit_date": 1537723566, "creation_date": 1537723025, "answer_id": 52468489, "question_id": 36256230, "link": "https://stackoverflow.com/questions/36256230/connection-fails-with-mysql-using-golang/52468489#52468489", "title": "Connection fails with mysql using GoLang", "body": "<p>Try to recheck the location of the packages. I made such a mistake when I manually added this package to the project. It is best to clean GOROOT and GOPATH from this package and reinstall/reconnect it as indicated in the source:\n<a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql</a></p>\n"}], "owner": {"reputation": 708, "user_id": 5938492, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4b3d66b498065d5a9d5b6b61108b922c?s=128&d=identicon&r=PG&f=1", "display_name": "Mr x", "link": "https://stackoverflow.com/users/5938492/mr-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11769, "favorite_count": 1, "answer_count": 3, "score": 11, "last_activity_date": 1537723566, "creation_date": 1459141147, "question_id": 36256230, "link": "https://stackoverflow.com/questions/36256230/connection-fails-with-mysql-using-golang", "title": "Connection fails with mysql using GoLang", "body": "<p>I am trying to connect the MySql DB using Go Language and gives me following error.</p>\n\n<pre><code>sql: unknown driver \"mysql\" (forgotten import?)\n</code></pre>\n\n<p>My Code</p>\n\n<pre><code>package main\n\n    import (\n        \"database/sql\"\n        \"fmt\"\n    )\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"astaxie:astaxie@/test?charset=utf8\")\n    checkErr(err);\n    err=db.Ping();\n}\n</code></pre>\n\n<p>Also when I import</p>\n\n<pre><code>        _ \"github.com/go-sql-driver/mysql\"\n</code></pre>\n\n<p>I am getting error of</p>\n\n<pre><code>imported and not used\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 6, "creation_date": 1459128911, "post_id": 36254578, "comment_id": 60139054, "body": "ServeHTTP is a method on type *myHandler. See <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">tour.golang.org/methods/1</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24240, "user_id": 495935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d310e51ac60b2a54b68b96e90593277b?s=128&d=identicon&r=PG", "display_name": "Surreal Dreams", "link": "https://stackoverflow.com/users/495935/surreal-dreams"}, "edited": false, "score": 0, "creation_date": 1459180340, "post_id": 36261174, "comment_id": 60159435, "body": "@dopatraman - Note that in this case that the method has no return type.  Functions can return zero, one or many values."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 2, "last_activity_date": 1459163614, "creation_date": 1459163614, "answer_id": 36261174, "question_id": 36254578, "link": "https://stackoverflow.com/questions/36254578/declaring-servehttp-method-of-go-server/36261174#36261174", "title": "Declaring ServeHTTP method of go server", "body": "<p>In the following method declaration</p>\n\n<pre><code>func (*myHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n</code></pre>\n\n<p><code>myHandler</code> is the receiver of the method. This is explained in the Go documentation about <a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow\">method definition</a>:</p>\n\n<blockquote>\n  <p>A method is a function with a <em>receiver</em>. A method declaration binds an identifier, the method name, to a method, and associates the method with the receiver's base type.</p>\n  \n  <p>The receiver is specified via an extra parameter section preceding the method name. That parameter section must declare a single non-variadic parameter, the receiver. Its type must be of the form T or *T (possibly using parentheses) where T is a type name. The type denoted by T is called the receiver base type; it must not be a pointer or interface type and it must be declared in the same package as the method. The method is said to be bound to the base type and the method name is visible only within selectors for type T or *T.</p>\n</blockquote>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459163614, "creation_date": 1459127970, "question_id": 36254578, "link": "https://stackoverflow.com/questions/36254578/declaring-servehttp-method-of-go-server", "title": "Declaring ServeHTTP method of go server", "body": "<p>I'm following the guide to writing a Go server <a href=\"http://thenewstack.io/building-a-web-server-in-go/\" rel=\"nofollow\">here</a>.</p>\n\n<p>I dont understand the following block:</p>\n\n<pre><code>func (*myHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n  //    ^^^^^ What does this do?\n</code></pre>\n\n<p>It doesnt look like a return type. In Go, my understanding is that return types follow the parameters of a function. Like this function that returns an integer:</p>\n\n<pre><code>func hello(s String) int {}\n</code></pre>\n\n<p>So what does the <code>(*myHandler)</code> in the ServeHTTP declaration do?</p>\n"}, {"tags": ["forms", "go", "upload"], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 4, "last_activity_date": 1459141198, "last_edit_date": 1495539906, "creation_date": 1459141198, "answer_id": 36256240, "question_id": 36254522, "link": "https://stackoverflow.com/questions/36254522/golang-which-function-for-uploading-large-files/36256240#36256240", "title": "golang - which function for uploading large files", "body": "<p><a href=\"https://golang.org/pkg/net/http/#Request.ParseMultipartForm\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Request.ParseMultipartForm</a></p>\n\n<blockquote>\n  <p>ParseMultipartForm parses a request body as multipart/form-data. <strong>The whole request body is parsed and up to a total of maxMemory bytes of its file parts are stored in memory, with the remainder stored on disk in temporary files.</strong> ParseMultipartForm calls ParseForm if necessary. After one call to ParseMultipartForm, subsequent calls have no effect.</p>\n</blockquote>\n\n<p>You can therefore control the maximum memory usage by calling <code>r.ParseMultipartForm(max)</code>, and you can control the total amount read from the request by using <a href=\"https://golang.org/pkg/net/http/#MaxBytesReader\" rel=\"nofollow noreferrer\"><code>http.MaxBytesReader</code></a>.</p>\n\n<p>Also see this answer: <a href=\"https://stackoverflow.com/a/28292505/556573\">https://stackoverflow.com/a/28292505/556573</a></p>\n"}], "owner": {"reputation": 1095, "user_id": 1602464, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1d99b12415bcd3046d9ebebeaf51a113?s=128&d=identicon&r=PG", "display_name": "Carlo", "link": "https://stackoverflow.com/users/1602464/carlo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4281, "favorite_count": 0, "accepted_answer_id": 36256240, "answer_count": 1, "score": 0, "last_activity_date": 1459141198, "creation_date": 1459127426, "question_id": 36254522, "link": "https://stackoverflow.com/questions/36254522/golang-which-function-for-uploading-large-files", "title": "golang - which function for uploading large files", "body": "<p>In go there are different ways to read a file sent with a multipart form</p>\n\n<p><code>r.FormFile(\"file\")</code></p>\n\n<p><code>r.MultipartReader()</code></p>\n\n<p><code>r.ParseMultipartForm(size)</code></p>\n\n<p>and I partially understand the difference between them, however which is it the best for handling large files (~1GB)?</p>\n\n<p>And, which is the one that uses less memory?</p>\n"}, {"tags": ["go", "slice", "equality"], "comments": [{"owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "edited": false, "score": 0, "creation_date": 1459118468, "post_id": 36253509, "comment_id": 60136793, "body": "reversing will give you false positives for palindrome slices."}], "answers": [{"comments": [{"owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "edited": false, "score": 0, "creation_date": 1459118443, "post_id": 36253537, "comment_id": 60136787, "body": "This is the simplist I can think of. I like how it also works for empty slices. One improvement I would suggest is to allow it to work for any type, not just strings."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 13, "last_activity_date": 1459118459, "last_edit_date": 1459118459, "creation_date": 1459118327, "answer_id": 36253537, "question_id": 36253509, "link": "https://stackoverflow.com/questions/36253509/check-if-all-items-in-a-slice-are-equal/36253537#36253537", "title": "Check if all items in a slice are equal", "body": "<p>I am not sure what your though process was for reversing the slice was, but that would be unnecessary. The simplest algorithm would be to check to see if all elements after the the first are equal to the first:</p>\n\n<pre><code>func allSameStrings(a []string) bool {\n    for i := 1; i &lt; len(a); i++ {\n        if a[i] != a[0] {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 6058631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/80f2cff0a0888497bd7ef323cbc1d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "XXX", "link": "https://stackoverflow.com/users/6058631/xxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3750, "favorite_count": 1, "accepted_answer_id": 36253537, "answer_count": 1, "score": 4, "last_activity_date": 1527026148, "creation_date": 1459118111, "last_edit_date": 1527026148, "question_id": 36253509, "link": "https://stackoverflow.com/questions/36253509/check-if-all-items-in-a-slice-are-equal", "title": "Check if all items in a slice are equal", "body": "<p>I need to create a function that:</p>\n\n<pre><code>returns true if all elements in a slice are equal (they will all be the same type)\nreturns false if any elements in a slice are different\n</code></pre>\n\n<p>The only way I can think of doing it is to reverse the slice, and compare the slice and the reversed slice.</p>\n\n<p>Is there a better way to do this thats good syntax and more efficient?</p>\n"}, {"tags": ["html", "forms", "go", "html-lists"], "comments": [{"owner": {"reputation": 517, "user_id": 4253002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oh2x3.jpg?s=128&g=1", "display_name": "Pepijn van Leeuwen", "link": "https://stackoverflow.com/users/4253002/pepijn-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1459120976, "post_id": 36253370, "comment_id": 60137405, "body": "<code>r.FormValue</code> expects a HTML form value. I don&#39;t see a <code>&lt;form&gt;</code> tag in your HTML."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 517, "user_id": 4253002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oh2x3.jpg?s=128&g=1", "display_name": "Pepijn van Leeuwen", "link": "https://stackoverflow.com/users/4253002/pepijn-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1459125789, "post_id": 36253370, "comment_id": 60138406, "body": "@PepijnvanLeeuwen - I updated with the form. This is the part of the large form, so I missed to add it before"}, {"owner": {"reputation": 517, "user_id": 4253002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oh2x3.jpg?s=128&g=1", "display_name": "Pepijn van Leeuwen", "link": "https://stackoverflow.com/users/4253002/pepijn-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1459126577, "post_id": 36253370, "comment_id": 60138543, "body": "It seems that the jQuery plugin adds a hidden input type, i.e. <code>&lt;input type=&quot;hidden&quot; value=&quot;testvalue&quot; name=&quot;tags&quot; class=&quot;tagit-hidden-field&quot;&gt;</code>. Use &#39;Inspect element&#39; to verify that the <code>name</code> attribute matches your Go code. Examples I used: <a href=\"https://aehlke.github.io/tag-it/examples.html\" rel=\"nofollow noreferrer\">aehlke.github.io/tag-it/examples.html</a>"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 517, "user_id": 4253002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oh2x3.jpg?s=128&g=1", "display_name": "Pepijn van Leeuwen", "link": "https://stackoverflow.com/users/4253002/pepijn-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1459127302, "post_id": 36253370, "comment_id": 60138694, "body": "@PepijnvanLeeuwen - I updated the question with inspect element output. But I dont see any hidden field :("}, {"owner": {"reputation": 517, "user_id": 4253002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oh2x3.jpg?s=128&g=1", "display_name": "Pepijn van Leeuwen", "link": "https://stackoverflow.com/users/4253002/pepijn-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1459128083, "post_id": 36253370, "comment_id": 60138866, "body": "Remove <code>itemName: &quot;teamId&quot;,</code> from the options and in Go, see if you get a value by using <code>r.FormValue(&quot;teamName&quot;)</code>. If that doesn&#39;t work, remove all options but <code>fieldName</code> and <code>availableTags</code>. More info about options: <a href=\"https://github.com/aehlke/tag-it#options\" rel=\"nofollow noreferrer\">github.com/aehlke/tag-it#options</a>"}], "answers": [{"tags": [], "owner": {"reputation": 517, "user_id": 4253002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oh2x3.jpg?s=128&g=1", "display_name": "Pepijn van Leeuwen", "link": "https://stackoverflow.com/users/4253002/pepijn-van-leeuwen"}, "is_accepted": true, "score": 4, "last_activity_date": 1459129647, "last_edit_date": 1459129647, "creation_date": 1459129174, "answer_id": 36254711, "question_id": 36253370, "link": "https://stackoverflow.com/questions/36253370/how-to-get-form-value-of-ul-in-golang/36254711#36254711", "title": "How to get form value of &lt;ul&gt; in golang?", "body": "<p>Found the problem: you expected a single field but you didn't specify it in the <a href=\"https://github.com/aehlke/tag-it#options\" rel=\"nofollow\">options</a> of <code>tag-it</code>. Use it as following (added some comments for clarity):</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n    $(\"#myTags\").tagit();\n    var tagsArray = [\"C\", \"C++\", \"Go\", \"Ruby\"];\n    $(\"#tags\").tagit({\n        fieldName: \"teamName\", // The name of the hidden input field\n        availableTags: tagsArray,\n        allowSpaces:true,\n        caseSensitive:false,\n        removeConfirmation:true,\n        placeholderText:\"Tags\",\n        tagLimit: 5,\n        allowDuplicates: false,\n        singleField: true, // Use a hidden input element with the fieldName name\n        singleFieldDelimiter: ',', // Optional, default value is same.\n        onlyAvailableTags: false\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>During runtime (and entering tags) a hidden <code>&lt;input&gt;</code> will be used, with the tag that you specified in the <code>tag-it</code> options.</p>\n\n<pre><code>&lt;input type=\"hidden\" style=\"display:none;\" value=\"Go,another value,C\" name=\"teamName\"&gt;\n</code></pre>\n\n<p>In Go, handle it as following (you missed the <code>%s</code> in <code>Printf</code>):</p>\n\n<pre><code>tags := r.FormValue(\"teamName\")\nlog.Printf(\"Tags: %s\", tags)\n</code></pre>\n\n<p>You can then split the tags with <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\"><code>strings.Split</code></a>.</p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 36254711, "answer_count": 1, "score": 1, "last_activity_date": 1459684870, "creation_date": 1459117179, "last_edit_date": 1459684870, "question_id": 36253370, "link": "https://stackoverflow.com/questions/36253370/how-to-get-form-value-of-ul-in-golang", "title": "How to get form value of &lt;ul&gt; in golang?", "body": "<p>In my use case I am using tag <a href=\"https://github.com/aehlke/tag-it\" rel=\"nofollow\">tag-it</a> to get tags from user. I am getting the tags input in html <code>&lt;ul&gt;</code> form. I am using golang in server side. </p>\n\n<p>html:</p>\n\n<pre><code>   &lt;form class=\"comment-form\" action=\"/add/\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\n    &lt;div class=\"form-input\"&gt;\n      &lt;label for=\"tags_label\"&gt;Tags&lt;/label&gt;\n      &lt;ul id=\"tags\"&gt;\n        &lt;script type=\"text/javascript\"&gt;\n          $(\"#myTags\").tagit();\n          var tagsArray = [\"C\", \"C++\", \"Go\", \"Ruby\"];\n          $(\"#tags\").tagit({\n              itemName: \"teamId\",\n              fieldName: \"teamName\",\n              availableTags: tagsArray,\n              allowSpaces:true,\n              caseSensitive:false,\n              removeConfirmation:true,\n              placeholderText:\"Tags\",\n              tagLimit: 5,\n              allowDuplicates: false,\n              singleFieldDelimiter: ',',\n              onlyAvailableTags: false\n          });\n        &lt;/script&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n   &lt;/form&gt;\n</code></pre>\n\n<p>and in server end I am trying to get the value like below similar to other fields in the form,</p>\n\n<pre><code>tags            := r.FormValue(\"tags\")\nlog.Printf(\"Tags : \", tags)\n</code></pre>\n\n<p>But it is not working.  Could someone help me with this?</p>\n\n<p><strong>EDIT:</strong>\nWhen I inspect the element this is what I see,</p>\n\n<pre><code>&lt;div class=\"form-input\"&gt;\n    &lt;label for=\"tags_label\"&gt;Tags&lt;/label&gt;\n    &lt;ul id=\"tags\" class=\"tagit ui-widget ui-widget-content ui-corner-all\"&gt;\n        &lt;script type=\"text/javascript\"&gt;\n            $(\"#myTags\").tagit();\n            var tagsArray = [\"C\", \"C++\", \"Go\", \"Ruby\"];\n            $(\"#tags\").tagit({\n                    itemName: \"teamId\",\n                    fieldName: \"teamName\",\n                    availableTags: tagsArray,\n                    allowSpaces:true,\n                    caseSensitive:false,\n                    removeConfirmation:true,\n                    placeholderText:\"Tags\",\n                    tagLimit: 5,\n                    allowDuplicates: false,\n                    singleFieldDelimiter: ',',\n                    onlyAvailableTags: false\n            });\n        &lt;/script&gt;&lt;li class=\"tagit-new\"&gt;&lt;input type=\"text\" class=\"ui-widget-content ui-autocomplete-input\" placeholder=\"Tags\" autocomplete=\"off\" role=\"textbox\" aria-autocomplete=\"list\" aria-haspopup=\"true\"&gt;&lt;/li&gt;\n    &lt;/ul&gt;                                            \n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1459122624, "creation_date": 1459122624, "answer_id": 36254035, "question_id": 36251753, "link": "https://stackoverflow.com/questions/36251753/go-database-sql-changing-case-of-table-name/36254035#36254035", "title": "Go database/sql Changing Case of Table Name", "body": "<p>Try using the <code>QuoteIdentifier</code> function in <code>github.com/lib/pq</code> to quote your table name: </p>\n\n<p><a href=\"https://godoc.org/github.com/lib/pq#QuoteIdentifier\" rel=\"nofollow\">https://godoc.org/github.com/lib/pq#QuoteIdentifier</a></p>\n"}], "owner": {"reputation": 9243, "user_id": 1318181, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1ZfAE.png?s=128&g=1", "display_name": "kylieCatt", "link": "https://stackoverflow.com/users/1318181/kyliecatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 36254035, "answer_count": 1, "score": 1, "last_activity_date": 1459125065, "creation_date": 1459107525, "last_edit_date": 1459125065, "question_id": 36251753, "link": "https://stackoverflow.com/questions/36251753/go-database-sql-changing-case-of-table-name", "title": "Go database/sql Changing Case of Table Name", "body": "<p>I am trying to query a database using <code>database/sql</code> and the <code>github.com/lib/pq</code> Postgres driver. The error I'm encountering is:</p>\n\n<pre><code>pq: relation \"itemprices_itemsale\" does not exist\n</code></pre>\n\n<p>However looking at my query:</p>\n\n<pre><code>rows, err := db.Query(\"SELECT * FROM \\\"itemPrices_itemsale\\\" LIMIT 10\")\n</code></pre>\n\n<p>You'll notice the capital 'P' in the table name. I've learned form poking around that Postgres will fold names in to lowercase if they are not quoted. I have quoted my table name so I'm not quite sure why this is happening. I'm fairly certain this is the issue as I'm able to query the table using that table name from a similar Python program and everything is working as expected.</p>\n\n<p>Update:\nUsing @JohnWeldon's suggestion:</p>\n\n<pre><code>var table = \"itemPrices_itemsale\"\nrows, err := db.Query(fmt.Sprintf(\"SELECT * FROM %s LIMIT 10\", pq.QuoteIdentifier(table)))\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": false, "score": 4, "last_activity_date": 1459121896, "creation_date": 1459121896, "answer_id": 36253946, "question_id": 36251743, "link": "https://stackoverflow.com/questions/36251743/render-a-partial-template-with-passed-parameters/36253946#36253946", "title": "Render a partial template with passed parameters", "body": "<p>The <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow\">documentation</a> states that the <code>template</code> directive has two forms:</p>\n\n<blockquote>\n  <p><code>{{template \"name\"}}</code><br>\n  The template with the specified name is executed\n  with nil data.</p>\n  \n  <p><strong><code>{{template \"name\" pipeline}}</code></strong><br>\n  The template with the specified name is\n  <strong>executed with dot set to the value of the pipeline.</strong></p>\n</blockquote>\n\n<p>The latter accepts a pipeline statement which's value is then set to the <code>dot</code> value in the executed template. So calling</p>\n\n<pre><code>{{template \"partial1\" \"string1\"}}\n</code></pre>\n\n<p>will set <code>{{.}}</code> to <code>\"string1\"</code> in the <code>partial1</code> template. So while there is no way to set the name <code>foo</code> in the partial, you can pass parameters and they will appear in <code>.</code>. Example:</p>\n\n<h3>template.html</h3>\n\n<pre><code>&lt;div&gt;\n  {{ template \"partial1.html\" \"muh\"}} // how do I pass foo param here??\n&lt;/div&gt;\n</code></pre>\n\n<h3>partial1.html</h3>\n\n<pre><code>{{if eq . \"muh\"}}\nblep\n{{else}}\nmoep\n{{end}}\n</code></pre>\n\n<h3>main.go</h3>\n\n<pre><code>import (\n    \"html/template\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    t,err := template.ParseFiles(\"template.html\", \"partial1.html\")\n\n    if err != nil { panic(err) }\n\n    fmt.Println(t.Execute(os.Stdout, nil))\n}\n</code></pre>\n\n<p>Running this program will print the template's contents with <code>blep</code> from the partial. Changing the passed value will change this behaviour.</p>\n\n<p>You can also assign variables, so assigning <code>.</code> to <code>foo</code> is possible in the partial:</p>\n\n<pre><code>{{ $foo := . }}\n</code></pre>\n"}], "owner": {"reputation": 6682, "user_id": 1574104, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/685bf9f1f469f90c37687d7e715ed964?s=128&d=identicon&r=PG", "display_name": "WebQube", "link": "https://stackoverflow.com/users/1574104/webqube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2339, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1459128914, "creation_date": 1459107408, "last_edit_date": 1459128914, "question_id": 36251743, "link": "https://stackoverflow.com/questions/36251743/render-a-partial-template-with-passed-parameters", "title": "Render a partial template with passed parameters", "body": "<p>I know rendering a partial template with additional parameters is possible in Ruby, how can I do it in Go?</p>\n\n<p>I have a partial template <code>_partial1.tmpl</code>:</p>\n\n<pre><code>&lt;div&gt;\ntext1\n{{if foo}}\n   text2\n{{end}}\n&lt;/div&gt;\n</code></pre>\n\n<p>using it from the parent template <code>parent.tmpl</code>:</p>\n\n<pre><code>&lt;div&gt;\n  {{ template \"partial1\",  }} // how do I pass foo param here?? \n&lt;/div&gt;  \n</code></pre>\n\n<p>How do I pass the parameter <code>foo</code> to the partial? </p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 81656, "user_id": 8446, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8f9c683775bfbe76ed4855a19b73dc81?s=128&d=identicon&r=PG", "display_name": "Roger Lipscombe", "link": "https://stackoverflow.com/users/8446/roger-lipscombe"}, "edited": false, "score": 4, "creation_date": 1459102658, "post_id": 36250862, "comment_id": 60131423, "body": "Maps in Go have no defined ordering. In fact, it&#39;s explicitly randomised when iterating: <a href=\"http://blog.golang.org/go-maps-in-action#TOC_7\" rel=\"nofollow noreferrer\">blog.golang.org/go-maps-in-action#TOC_7</a>."}, {"owner": {"reputation": 6075, "user_id": 1191620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0116c0a6ef4ebfa0eb37747b613c61?s=128&d=identicon&r=PG", "display_name": "hasanyasin", "link": "https://stackoverflow.com/users/1191620/hasanyasin"}, "edited": false, "score": 0, "creation_date": 1459103199, "post_id": 36250862, "comment_id": 60131597, "body": "Try github.com/kylelemons/go-gypsy/yaml instead."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 6075, "user_id": 1191620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0116c0a6ef4ebfa0eb37747b613c61?s=128&d=identicon&r=PG", "display_name": "hasanyasin", "link": "https://stackoverflow.com/users/1191620/hasanyasin"}, "edited": false, "score": 0, "creation_date": 1459103832, "post_id": 36250862, "comment_id": 60131813, "body": "@hasanyasin That looks like it will have the same problem because its Map is represented as a <code>map[string]Node</code> internally."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1459104087, "post_id": 36250862, "comment_id": 60131926, "body": "This is not a documented feature, just how the implementation worked out, but it looks like if you use a <code>struct</code>, output is currently in the order in which the fields are declared. <a href=\"http://play.golang.org/p/q9NgT177g2\" rel=\"nofollow noreferrer\">Here&#39;s code</a>--won&#39;t work in the (library-free) Playground env., naturally. If you know your fields up-front so you can put them in a <code>struct</code>, and you only care about the ordering for aesthetic reasons (i.e., your system won&#39;t break if you upgrade go-yaml and the ordering changes), maybe that&#39;s enough for now."}, {"owner": {"reputation": 6075, "user_id": 1191620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0116c0a6ef4ebfa0eb37747b613c61?s=128&d=identicon&r=PG", "display_name": "hasanyasin", "link": "https://stackoverflow.com/users/1191620/hasanyasin"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1459109630, "post_id": 36250862, "comment_id": 60133847, "body": "@twotwotwo sorry for not being specific. Instead of Parse, I use ReadFile and then walk on the tree. This is much better than flushing all the document into Go without any control over it."}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 0, "last_activity_date": 1459186361, "creation_date": 1459186361, "answer_id": 36267521, "question_id": 36250862, "link": "https://stackoverflow.com/questions/36250862/how-to-produce-yaml-with-keys-in-insertion-order-go/36267521#36267521", "title": "How to produce YAML with keys in insertion order Go?", "body": "<p>Go maps do not keep track of order of insertion.  In order to do this you'd have to implement your own mechanism for reading in the keys and storing the order.</p>\n"}], "owner": {"reputation": 1, "user_id": 6121404, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MrDERcrvH3c/AAAAAAAAAAI/AAAAAAAAAAw/_MnHeWxXkSg/photo.jpg?sz=128", "display_name": "Niger Little-Poole", "link": "https://stackoverflow.com/users/6121404/niger-little-poole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459186361, "creation_date": 1459102529, "question_id": 36250862, "link": "https://stackoverflow.com/questions/36250862/how-to-produce-yaml-with-keys-in-insertion-order-go", "title": "How to produce YAML with keys in insertion order Go?", "body": "<p>I'm using <a href=\"https://github.com/go-yaml/yaml\" rel=\"nofollow\">Go-Yaml</a> to serialize some maps to YAML. Is there a way to ensure the serialized YAML is writen with the keys in the order they were inserted into the Go Map? Or will it be necessary to reimplement the Marshal interface myself?</p>\n"}, {"tags": ["http", "go", "mux"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459092566, "post_id": 36248946, "comment_id": 60127809, "body": "(I also wanted to say that this is a good question, and a useful one for others in the future, since it has come up before)"}, {"owner": {"reputation": 3732, "user_id": 1493365, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a1c605226f3799430016e619bc331b8d?s=128&d=identicon&r=PG", "display_name": "Matt3o12", "link": "https://stackoverflow.com/users/1493365/matt3o12"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459092725, "post_id": 36248946, "comment_id": 60127856, "body": "elithrar: that&#39;s why I asked it here. I couldn&#39;t find anything on Google. Imo, <code>http.HandleFunc</code> and <code>http.Handle</code> should be deprecated, then. Using a <code>Mux</code> and <code>Server</code> only adds 2 more lines and ambiguity is always bad, especially if the more obvious way is the &quot;bad way&quot;."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459093143, "post_id": 36248946, "comment_id": 60127983, "body": "The Go1 compatibility promise doesn&#39;t allow removal, so we&#39;re &#39;stuck&#39; with them until &quot;2.0&quot; (which is a long way off - years)."}, {"owner": {"reputation": 3732, "user_id": 1493365, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a1c605226f3799430016e619bc331b8d?s=128&d=identicon&r=PG", "display_name": "Matt3o12", "link": "https://stackoverflow.com/users/1493365/matt3o12"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459093341, "post_id": 36248946, "comment_id": 60128057, "body": "elithrar: I can&#39;t find anything about deprecation in the compatibility promise. It would still be available and work as it does now (at least until 2.0) but beginners will stay away from it."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459093821, "post_id": 36248946, "comment_id": 60128247, "body": "The only way to deprecate is a documentation note. Go doesn&#39;t have the concept of &quot;warnings&quot; (from the compiler), so the effectiveness would be pretty minimal. You&#39;re welcome to propose adding documentation to these methods on golang-dev."}, {"owner": {"reputation": 3732, "user_id": 1493365, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a1c605226f3799430016e619bc331b8d?s=128&d=identicon&r=PG", "display_name": "Matt3o12", "link": "https://stackoverflow.com/users/1493365/matt3o12"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459093965, "post_id": 36248946, "comment_id": 60128303, "body": "I will do! I think do a documentation note would do a lot! The first thing I did when I notice there are two methods was reading the docs again."}], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 7, "last_activity_date": 1459092263, "creation_date": 1459092263, "answer_id": 36249058, "question_id": 36248946, "link": "https://stackoverflow.com/questions/36248946/should-i-use-servemux-or-http-directly-in-golang/36249058#36249058", "title": "Should I use ServeMux or http directly in golang", "body": "<p>You're on the right track: you should prefer to instantiate your own <code>ServeMux</code>, for the reasons you've outlined.</p>\n\n<p>Using <code>DefaultServeMux</code> also runs the risk of exposing profiling endpoints when using <a href=\"https://golang.org/pkg/net/http/pprof/\" rel=\"noreferrer\"><code>net/http/pprof</code></a>, since those are attached to the DefaultServeMux.</p>\n\n<p><code>http.Handle|HandleFunc</code> are convenience methods, and perhaps useful for keeping the boilerplate in example code down, but creating a ServeMux gives you the ability to wrap it, nest it within another, export it from a constructor, etc.</p>\n"}], "owner": {"reputation": 3732, "user_id": 1493365, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a1c605226f3799430016e619bc331b8d?s=128&d=identicon&r=PG", "display_name": "Matt3o12", "link": "https://stackoverflow.com/users/1493365/matt3o12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2829, "favorite_count": 1, "accepted_answer_id": 36249058, "answer_count": 1, "score": 14, "last_activity_date": 1459192166, "creation_date": 1459091579, "last_edit_date": 1459192166, "question_id": 36248946, "link": "https://stackoverflow.com/questions/36248946/should-i-use-servemux-or-http-directly-in-golang", "title": "Should I use ServeMux or http directly in golang", "body": "<p>I was wondering if I should create a new ServeMux and register it to the <code>http.Server</code> or should I invoke <code>http.HandleFunc</code> and <code>http.Handler</code> directly? </p>\n\n<p>I think the route with a ServeMux is better because <code>http.HandleFunc</code> obviously messes with the global state of the HTTP package, which is considered bad practice in Go. However, in many tutorials, even the official ones, I often see the <code>http.HandleFunc</code> route being used.</p>\n\n<p>This makes me wonder: why should one use <code>http.HandleFunc</code> when there is a <code>ServeMux</code>? I know that ServeMux has some advantages (e.g. you can nest it without repeating the prefix all the time) but I wonder why I should ever choose <code>http.HandleFunc</code> over Multiplexer, especially since <code>HandleFunc</code> uses a <code>ServeMux</code> internally.</p>\n\n<p>Edit: as promised in the comments, I've asked to deprecate the additional (and useless IMO functions) on <a href=\"https://groups.google.com/forum/#!forum/golang-dev\" rel=\"noreferrer\">Golang-dev</a> and they said no (well, on person said no). <a href=\"https://groups.google.com/d/msg/golang-dev/UOY45GtVp4I/XhIigo9OBwAJ\" rel=\"noreferrer\">Here is the link.</a></p>\n"}, {"tags": ["ajax", "http", "curl", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1459089091, "post_id": 36248468, "comment_id": 60126577, "body": "Have you tried sending as POST?"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1459089470, "post_id": 36248468, "comment_id": 60126712, "body": "@Not_a_Golfer -  POST is working fine with <code>r.Form</code>. Is it not possible to send data in GET?[it might not be a good practice though]."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459089526, "post_id": 36248468, "comment_id": 60126729, "body": "An http GET request with a body is unusual. I think against the spec as well. So I think your browser is not allowing it. Yes its not a good practice. Use POST."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459089958, "post_id": 36248468, "comment_id": 60126909, "body": "@ArunaHerath - Hmmm. if I want to get some values through an API by passing some id etc. I need to add the id in the input right."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459090537, "post_id": 36248468, "comment_id": 60127117, "body": "You either POST (with data in the body), or GET (potentially with a header containing your credentials to authenticate with). You can&#39;t GET with a body."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459090623, "post_id": 36248468, "comment_id": 60127151, "body": "@DineshAppavoo Use URL query params"}], "answers": [{"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 2, "last_activity_date": 1459092563, "creation_date": 1459092563, "answer_id": 36249110, "question_id": 36248468, "link": "https://stackoverflow.com/questions/36248468/how-to-get-the-data-from-http-request-in-a-standard-way-in-golang/36249110#36249110", "title": "How to get the data from http request in a standard way in golang?", "body": "<p>Sending a meaningful body with a GET request is disallowed by the spec. So your browser is probably sending an empty body. You can use POST instead. Its unsurprising that <code>r.ParseForm()</code> is not working because it expects the body to be encoded by <code>application/x-www-form-urlencoded</code>. Not <code>json</code>.</p>\n\n<p>If GET is more appropriate to send the user inputs to your server's request handlers you can use url query parameters.</p>\n\n<p>Quoting JQuery.ajax() <a href=\"http://api.jquery.com/jquery.ajax/\" rel=\"nofollow\">docs</a> for <strong>data</strong> parameter,</p>\n\n<blockquote>\n  <p>Data to be sent to the server. It is converted to a query string, if\n  not already a string. It's appended to the url for GET-requests. See\n  processData option to prevent this automatic processing. Object must\n  be Key/Value pairs.</p>\n</blockquote>\n\n<p>So you can do,</p>\n\n<pre><code>$.ajax({\n  type: \"GET\",\n  url: \"http://localhost:8081/api/services/test/\",\n  data: {AppName: \"Proline\", Properties:null, Object: \"\"}, // An object, not a string.\n  contentType: \"application/json; charset=utf-8\",\n  dataType: \"json\",\n  success: function(data){alert(data)}\n})\n</code></pre>\n\n<p>An in the server,</p>\n\n<pre><code>params := r.URL.Query()\nparams.Get('AppName') // returns 'Proline'\n</code></pre>\n\n<p>See docs: <a href=\"https://golang.org/pkg/net/url/#URL.Query\" rel=\"nofollow\">https://golang.org/pkg/net/url/#URL.Query</a></p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2699, "favorite_count": 0, "accepted_answer_id": 36249110, "answer_count": 1, "score": 0, "last_activity_date": 1459092563, "creation_date": 1459088839, "question_id": 36248468, "link": "https://stackoverflow.com/questions/36248468/how-to-get-the-data-from-http-request-in-a-standard-way-in-golang", "title": "How to get the data from http request in a standard way in golang?", "body": "<p>I am trying to get the data from http request in golang. I am using net/http package. In my server handler I am trying to get the data from r.Body</p>\n\n<pre><code>body, err := ioutil.ReadAll(r.Body)\nif err != nil {\n    log.Printf(\"FATAL IO reader issue %s \", err.Error())\n}\n</code></pre>\n\n<p>it works fine when I curl the service with some input data.</p>\n\n<pre><code>curl --data '{\"AppName\":\"Proline\",\"Properties\":null,\"Object\":\"\",\"Timestamp\":\"2016:03:27 00:08:11\"}' -XGET http://localhost:8081/api/services/test/\n</code></pre>\n\n<p>But when I try to call this service from ajax call r.Body is empty. </p>\n\n<pre><code>requestJSON = '{\"AppName\":\"Proline\",\"Properties\":null,\"Object\":\"\",\"Timestamp\":\"2016:03:27 00:08:11\"}'\n$.ajax({\n  type: \"GET\",\n  url: \"http://localhost:8081/api/services/test/\",\n  data: requestJSON,\n  contentType: \"application/json; charset=utf-8\",\n  dataType: \"json\",\n  success: function(data){alert(data);},\n  failure: function(errMsg) {\n      alert(errMsg);\n  }\n});\n</code></pre>\n\n<p>So I changed to read the input data from <code>r.Form</code></p>\n\n<pre><code>r.ParseForm()\nvar body []byte\nfor key, _ := range r.Form {\n    body = []byte(key)\n    break\n}\n</code></pre>\n\n<p>But now the curl request fails. Is there a standard way to retrieve input data from http request in golang?  I am using Go 1.6. Could someone help me with this?</p>\n"}, {"tags": ["go", "middleware"], "answers": [{"comments": [{"owner": {"reputation": 1790, "user_id": 2784487, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DYu2h.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/2784487/jack"}, "edited": false, "score": 0, "creation_date": 1459077984, "post_id": 36246728, "comment_id": 60123271, "body": "But is there a pragmatic way to do this for each function that is in echo/middleware? tbh, as you say, if this is the only route i can take it&#39;s probably best i just rename my pkg."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 1, "last_activity_date": 1459077575, "creation_date": 1459077575, "answer_id": 36246728, "question_id": 36246285, "link": "https://stackoverflow.com/questions/36246285/go-how-to-handle-package-collisions-without-renaming/36246728#36246728", "title": "Go: How to Handle Package Collisions without Renaming?", "body": "<p>Your import solution doesn't work because even if the echo <code>middleware</code> package is imported without identifier, its exported identified aren't part of your <code>middleware</code> package. The dot import is simply a syntaxic sugar\u2026 one that's not recommended to use by the way.</p>\n\n<p>If you really don't want to use the package renaming (which is the better solution IMHO), you can define your own methods to create the middlewares in your package.</p>\n\n<pre><code>package middleware\n\nimport \"github.com/labstack/echo\"\nimport \"github.com/labstack/echo/middleware\"\n\nfunc Logger () echo.MiddlewareFunc {\n    return middleware.Logger()\n}\n</code></pre>\n\n<p>This would effectively remove the need for the <code>echo/middleware</code> package in you main code, at the cost of duplicate code that's not really needed.</p>\n"}], "owner": {"reputation": 1790, "user_id": 2784487, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DYu2h.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/2784487/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 3, "accepted_answer_id": 36246728, "answer_count": 1, "score": 2, "last_activity_date": 1459077575, "creation_date": 1459074247, "last_edit_date": 1459074926, "question_id": 36246285, "link": "https://stackoverflow.com/questions/36246285/go-how-to-handle-package-collisions-without-renaming", "title": "Go: How to Handle Package Collisions without Renaming?", "body": "<p>I'm trying to solve a package collision without renaming, as i don't think it's particularly elegant. So at the moment I have my own middleware which just handles database connections, but I also use middleware from Echo. Echo uses <em>middleware</em> as their middleware's package name too. </p>\n\n<p>So the solution i'm trying to implement is one in which would extend Echo's package. But i'm not having any success and have not found any info on doing this.</p>\n\n<p>See echo middleware here: <a href=\"https://github.com/labstack/echo/tree/master/middleware\" rel=\"nofollow\">https://github.com/labstack/echo/tree/master/middleware</a></p>\n\n<h2>main.go</h2>\n\n<pre><code>package main\n\n\nimport (\n    \"github.com/facebookgo/grace/gracehttp\"\n    \"github.com/labstack/echo\"\n    \"github.com/labstack/echo/engine/standard\"\n    \"gitlab.com/project/middleware\" //This is the middleware repository\n    \"github.com/asaskevich/govalidator\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n    \"encoding/json\"\n    \"log\"\n)\n\n\nfunc main() {\n    e := echo.New()\n\n    e.Use(middleware.Db()) //Custom middleware\n    e.Use(middleware.Logger()) //Echo middleware\n    e.Use(middleware.Recover()) //Echo middleware\n\n    //Compile fails because Logger and Recover are not being exported.\n\n    e.Post(\"/\", createUser())\n    e.Get(\"/\", getUser())\n    e.Put(\"/\", updateUser())\n    e.Delete(\"/\", removeUser())\n\n    s := standard.New(\":3000\")\n    s.SetHandler(e)\n    gracehttp.Serve(s.Server)\n}\n</code></pre>\n\n<h2>Middleware structure</h2>\n\n<pre><code>\u251c\u2500\u2500 middleware\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 db.go //Custom middleware\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 echo.go //Echo middleware\n</code></pre>\n\n<p>So <em>db.go</em> and <em>echo.go</em> are both packaged as <em>middleware</em>, but I'm not able to 'export' the functions from the Echo package which is imported.</p>\n\n<h2>echo.go</h2>\n\n<pre><code>package middleware\n\nimport (\n    . \"github.com/labstack/echo/middleware\"\n)\n\n//Stop compiler errors\n//Echo middleware is usually accessed with middleware.Logger\n//But by using the preceding dot, you can drop the prefix\nvar _ = Logger()\n</code></pre>\n\n<p>GO's compiling fails because <em>Logger()</em> and <em>Recover()</em> function are not exported despite being capitalised - whereas Db() from the <em>db.go</em> package is exported.</p>\n"}, {"tags": ["jquery", "json", "ajax", "curl", "go"], "comments": [{"owner": {"reputation": 2400, "user_id": 2260345, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YrS1i.jpg?s=128&g=1", "display_name": "Mir Gulam Sarwar", "link": "https://stackoverflow.com/users/2260345/mir-gulam-sarwar"}, "edited": false, "score": 1, "creation_date": 1459072824, "post_id": 36246010, "comment_id": 60121888, "body": "I think you don&#39;t need to stringify, you are actually stringifying 2 times"}, {"owner": {"reputation": 8782, "user_id": 500729, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8243f269b9ecfbf1e2c8df8d9d8607d4?s=128&d=identicon&r=PG", "display_name": "slash197", "link": "https://stackoverflow.com/users/500729/slash197"}, "reply_to_user": {"reputation": 2400, "user_id": 2260345, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YrS1i.jpg?s=128&g=1", "display_name": "Mir Gulam Sarwar", "link": "https://stackoverflow.com/users/2260345/mir-gulam-sarwar"}, "edited": false, "score": 0, "creation_date": 1459073086, "post_id": 36246010, "comment_id": 60121965, "body": "Like @Mir said, <code>requestJSON</code> is already a string"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 8782, "user_id": 500729, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8243f269b9ecfbf1e2c8df8d9d8607d4?s=128&d=identicon&r=PG", "display_name": "slash197", "link": "https://stackoverflow.com/users/500729/slash197"}, "edited": false, "score": 0, "creation_date": 1459073407, "post_id": 36246010, "comment_id": 60122068, "body": "@slash197 - I tried without JSON.stringify but it didnt help :( ."}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 8782, "user_id": 500729, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8243f269b9ecfbf1e2c8df8d9d8607d4?s=128&d=identicon&r=PG", "display_name": "slash197", "link": "https://stackoverflow.com/users/500729/slash197"}, "edited": false, "score": 0, "creation_date": 1459074323, "post_id": 36246010, "comment_id": 60122322, "body": "@slash197 -  I updated the question since that redirects to JSON.stringify issue. I changed JSON.stringify(requestJSON) to requestJSON."}, {"owner": {"reputation": 2400, "user_id": 2260345, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YrS1i.jpg?s=128&g=1", "display_name": "Mir Gulam Sarwar", "link": "https://stackoverflow.com/users/2260345/mir-gulam-sarwar"}, "edited": false, "score": 0, "creation_date": 1459076241, "post_id": 36246010, "comment_id": 60122843, "body": "@DineshAppavoo from your update code, u need stringfy"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 2400, "user_id": 2260345, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YrS1i.jpg?s=128&g=1", "display_name": "Mir Gulam Sarwar", "link": "https://stackoverflow.com/users/2260345/mir-gulam-sarwar"}, "edited": false, "score": 0, "creation_date": 1459076526, "post_id": 36246010, "comment_id": 60122926, "body": "@Mir - I tried \t<code>data: JSON.stringify(requestJSON)</code> ,  <code>data: JSON.stringify({&quot;Method&quot;:&quot;GET&quot;,&quot;AppName&quot;:&quot;howti&quot;,&quot;ServiceURL&zwnj;&#8203;&quot;:&quot;http:&#47;&#47;localhost:&zwnj;&#8203;8081&#47;api&#47;services&#47;ta&zwnj;&#8203;gs&#47;&quot;,&quot;Properties&quot;:nu&zwnj;&#8203;ll,&quot;Object&quot;:&quot;&quot;,&quot;Time&zwnj;&#8203;stamp&quot;:&quot;2016:03:27 00:08:11&quot;})</code>  and  <code>data: JSON.stringify(&#39;{&quot;Method&quot;:&quot;GET&quot;,&quot;AppName&quot;:&quot;howti&quot;,&quot;ServiceUR&zwnj;&#8203;L&quot;:&quot;http:&#47;&#47;localhost&zwnj;&#8203;:8081&#47;api&#47;services&#47;t&zwnj;&#8203;ags&#47;&quot;,&quot;Properties&quot;:n&zwnj;&#8203;ull,&quot;Object&quot;:&quot;&quot;,&quot;Tim&zwnj;&#8203;estamp&quot;:&quot;2016:03:27 00:08:11&quot;}&#39;)</code> .  But nothing helped. [In all cases I used JSON.stringify only once. I removed in other places]"}], "answers": [{"tags": [], "owner": {"reputation": 2400, "user_id": 2260345, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YrS1i.jpg?s=128&g=1", "display_name": "Mir Gulam Sarwar", "link": "https://stackoverflow.com/users/2260345/mir-gulam-sarwar"}, "is_accepted": false, "score": 0, "last_activity_date": 1459076394, "last_edit_date": 1459076394, "creation_date": 1459073141, "answer_id": 36246121, "question_id": 36246010, "link": "https://stackoverflow.com/questions/36246010/how-to-make-ajax-call-with-input-json-data-in-jquery-and-golang/36246121#36246121", "title": "How to make ajax call with input json data in Jquery and golang?", "body": "<p>Your data is already stringified in console.log  </p>\n\n<pre><code> time = new Date($.now());\n    requestJSON = '{\"Method\":\"GET\",\"AppName\":\"Proline\",\"ServiceURL\":\"http://localhost:8081/api/services/tags/\",\"Properties\":null,\"Object\":\"\",\"Timestamp\":\"'+time+'\"}'\n    $.ajax({\n      type: \"GET\",\n      url: \"http://localhost:8081/api/services/tags/\",\n      data:JSON.stringify(requestJSON),\n      contentType: \"application/json; charset=utf-8\",\n      dataType: \"json\",\n      success: function(data){alert(data);},\n      failure: function(errMsg) {\n          alert(errMsg);\n      }\n    });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "is_accepted": true, "score": 0, "last_activity_date": 1459085947, "last_edit_date": 1495540783, "creation_date": 1459085947, "answer_id": 36247970, "question_id": 36246010, "link": "https://stackoverflow.com/questions/36246010/how-to-make-ajax-call-with-input-json-data-in-jquery-and-golang/36247970#36247970", "title": "How to make ajax call with input json data in Jquery and golang?", "body": "<p>The issue was the call is not sending the request data in body [But somehow <code>curl</code> works fine]. When I try to get the <code>body, err := ioutil.ReadAll(r.Body)</code> it gave empty value. So I changed to get from <code>r.Form</code></p>\n\n<pre><code>r.ParseForm()\nvar body []byte\nfor key, _ := range r.Form {\n    body = []byte(key)\n    break\n}\n</code></pre>\n\n<p><code>r.Form</code> gives a map. So I am iterating through the map and getting the req data. This <a href=\"https://stackoverflow.com/questions/27664192/golang-net-http-request-body-always-empty\">SO post</a> gave the solution.   May be helpful to others :)</p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2253, "favorite_count": 0, "accepted_answer_id": 36247970, "answer_count": 2, "score": 0, "last_activity_date": 1459085947, "creation_date": 1459072408, "last_edit_date": 1459085455, "question_id": 36246010, "link": "https://stackoverflow.com/questions/36246010/how-to-make-ajax-call-with-input-json-data-in-jquery-and-golang", "title": "How to make ajax call with input json data in Jquery and golang?", "body": "<p>I am trying to make an ajax call in Jquery but I am getting empty response. But when I try to do the same through curl I am succeeding. Here is my JS,</p>\n\n<pre><code>time = new Date($.now());\nrequestJSON = '{\"Method\":\"GET\",\"AppName\":\"Proline\",\"ServiceURL\":\"http://localhost:8081/api/services/tags/\",\"Properties\":null,\"Object\":\"\",\"Timestamp\":\"'+time+'\"}'\n$.ajax({\n  type: \"GET\",\n  url: \"http://localhost:8081/api/services/tags/\",\n  // The key needs to match your method's input parameter (case-sensitive).\n  data: requestJSON,\n  contentType: \"application/json; charset=utf-8\",\n  dataType: \"json\",\n  success: function(data){alert(data);},\n  failure: function(errMsg) {\n      alert(errMsg);\n  }\n});\n</code></pre>\n\n<p>I also tried <code>dataType: \"jsonp\"</code> but no luck. </p>\n\n<p>And the curl command is here,</p>\n\n<pre><code>curl --data '{\"Method\":\"GET\",\"AppName\":\"Proline\",\"ServiceURL\":\"http://localhost:8081/api/services/tags/\",\"Properties\":null,\"Object\":\"\",\"Timestamp\":\"2016:03:27 00:08:11\"}'\n-X GET http://localhost:8081/api/services/tags/\n</code></pre>\n\n<p>I have the server code in golang. I already set the header to <code>Access-Control-Allow-Headers:*</code>. Here is my server handler. </p>\n\n<pre><code> func tagsHandler(w http.ResponseWriter, r *http.Request, extra []string) {\n    if origin := r.Header.Get(\"Origin\"); origin != \"\" {\n            w.Header().Set(\"Access-Control-Allow-Origin\", origin)\n            w.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS, PUT, DELETE\")\n            w.Header().Set(\"Access-Control-Allow-Headers\",\n                    \"*\")\n    }\n    // Stop here if its Preflighted OPTIONS request\n    if r.Method == \"OPTIONS\" {\n            return\n    }\n    var response []byte\n    body, err := ioutil.ReadAll(r.Body)\n    if err != nil {\n        log.Printf(\"FATAL IO reader issue %s \", err.Error())\n    }\n    log.Printf(\"Body : %s \", string(body))\n    method    := r.Method\n    log.Printf(\"tagsHandler() :: service method %s \", method)\n    if method == HTTP_VERB_POST {\n                response = tagslogic.PostTag(body)\n    } else if method == HTTP_VERB_GET {\n                response = tagslogic.GetTags(body)\n    } else if method == HTTP_VERB_PUT {\n                response = tagslogic.PutTag(body)\n    } else if method == HTTP_VERB_DEL {\n            response = tagslogic.DelTag(body)\n        }\n    w.Write(response)\n}\n</code></pre>\n\n<p>To be specific I am getting empty request body in server side.\ncould someone help me with this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1459161710, "last_edit_date": 1459161710, "creation_date": 1459093787, "answer_id": 36249321, "question_id": 36245781, "link": "https://stackoverflow.com/questions/36245781/extracting-data-from-file-using-golang/36249321#36249321", "title": "extracting data from file using golang", "body": "<p>Perhaps, something like this?</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"strings\"\n    \"time\"\n)\n\ntype Match struct {\n    Date       time.Time\n    Opponents  string\n    Venue      string\n    Type       string\n    Result     string\n    Scorers    string\n    Attendance string\n}\n\nvar fmtMatchDate = \"Mon 02 Jan 2006\"\n\nfunc (m Match) String() string {\n    var s string\n    s += fmt.Sprint(m.Date.Format(fmtMatchDate), \"\\n\")\n    s += fmt.Sprint(\n        m.Opponents, \"\\n\",\n        m.Venue, \"\\n\",\n        m.Type, \"\\n\",\n        m.Result, \"\\n\",\n    )\n    if len(m.Scorers) &gt; 0 {\n        s += fmt.Sprint(\n            m.Scorers, \"\\n\",\n        )\n    }\n    if len(m.Attendance) &gt; 0 {\n        s += fmt.Sprint(\n            m.Attendance, \"\\n\",\n        )\n    }\n    return s\n}\n\nfunc ParseMatch(lines []string) (Match, error) {\n    // TODO: Implement a better parser.\n    var m Match\n    for i, line := range lines {\n        line = strings.TrimSpace(line)\n        switch i {\n        case 0:\n            date, err := time.Parse(fmtMatchDate, line)\n            if err != nil {\n                return Match{}, err\n            }\n            m.Date = date\n        case 1:\n            m.Opponents = line\n        case 2:\n            m.Venue = line\n        case 3:\n            m.Type = line\n        case 4:\n            m.Result = line\n        case 5:\n            m.Scorers = line\n        case 6:\n            m.Attendance = line\n        default:\n        }\n    }\n    return m, nil\n}\n\nfunc main() {\n    f, err := os.Open(\"match.txt\")\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n    var lines []string\n    snr := bufio.NewScanner(f)\n    for snr.Scan() {\n        line := snr.Text()\n        if _, err = time.Parse(fmtMatchDate, strings.TrimSpace(line)); err == nil {\n            if len(lines) &gt; 0 {\n                m, err := ParseMatch(lines)\n                if err != nil {\n                    fmt.Fprintln(os.Stderr, err)\n                } else {\n                    fmt.Print(m)\n                }\n            }\n            lines = lines[:0]\n        }\n        lines = append(lines, line)\n    }\n    if len(lines) &gt; 0 {\n        m, err := ParseMatch(lines)\n        if err != nil {\n            fmt.Fprintln(os.Stderr, err)\n        } else {\n            fmt.Print(m)\n        }\n    }\n    if err := snr.Err(); err != nil {\n        if err != io.EOF {\n            fmt.Fprintln(os.Stderr, err)\n            os.Exit(1)\n        }\n    }\n}\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>$ cat match.txt\nSat 08 Aug 2015\nNorwich City\nA\nLeague\n    W 3-1\n    Zaha 38; Delaney 48; Cabaye 90\n    27,036\nSun 16 Aug 2015\nArsenal\nH\nLeague\n    L 1-2\nSat 29 Aug 2015\nChelsea\nA\nLeague\n    W 2-1\n    Sako 64; Ward 80\n    41,581\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run match.go\nSat 08 Aug 2015\nNorwich City\nA\nLeague\nW 3-1\nZaha 38; Delaney 48; Cabaye 90\n27,036\nSun 16 Aug 2015\nArsenal\nH\nLeague\nL 1-2\nSat 29 Aug 2015\nChelsea\nA\nLeague\nW 2-1\nSako 64; Ward 80\n41,581\n$\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 1638680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3daa6d9e1fd176087a06f2bac4475895?s=128&d=identicon&r=PG", "display_name": "dgm", "link": "https://stackoverflow.com/users/1638680/dgm"}, "is_accepted": false, "score": 0, "last_activity_date": 1459161890, "last_edit_date": 1459161890, "creation_date": 1459104074, "answer_id": 36251146, "question_id": 36245781, "link": "https://stackoverflow.com/questions/36245781/extracting-data-from-file-using-golang/36251146#36251146", "title": "extracting data from file using golang", "body": "<p>I am not a great fan of regex as it tends to complicate things when you, or someone else, goes back to it in 6 months. I would read the the file into a slice of lines, and use an offset as the way of getting the lines to test.</p>\n\n<pre><code>func main() {\n    var (\n        dayName    string\n        month      string\n        name       string\n        A          string\n        league     string\n        score      string\n        scorers    string\n        attendance string\n        day        int\n        year       int\n        err        error\n    )\n    data, errRead := ioutil.ReadFile(fileName)\n    if errRead != nil {\n        return\n    }\n\n    //  get the files as a block of text\n    theText := string(data)\n    //  make the line endings consistent\n    theText = strings.Replace(theText, \"\\r\\n\", \"\\r\", -1)\n    theText = strings.Replace(theText, \"\\n\", \"\\r\", -1)\n    //  split it into a set of lines\n    lines := strings.Split(theText, \"\\r\")\n    numLines := len(lines)\n    i := 0\n    for i &lt; numLines {\n        //      at this point we should have your test line\n        theLine := lines[i]\n        i++\n        //      give each line a consistent spacing, you never know what state it is in\n        theLine = strings.Replace(theLine, \"  \", \" \", -1)\n        parts := strings.Split(theLine, \" \")\n        if len(parts) == 4 {\n            //         At least the line has the four date parts\n            dayName := parts[0]\n            day, err = strconv.Atoi(parts[1])\n            if err == nil {\n                //             We have a number for the day\n                month := parts[2]\n                year, err = strconv.Atoi(parts[3])\n                if err == nil {\n                    //                 We have a number for the year\n                    //                 the next five lines are your data\n                    name = lines[i]\n                    A = lines[i+1]\n                    league = lines[i+2]\n                    score = lines[i+3]\n                    scorers = lines[i+4]\n                    attendance = lines[i+5]\n                    i += 6\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>For the score etc you will have to parse it yourself, but this will be fairly trivial. You also need to remember that when getting data from someone else they may not always be as consistent as you would wish.</p>\n"}, {"tags": [], "owner": {"reputation": 1599, "user_id": 425810, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/510d3b22f788b849e098f53676ee282f?s=128&d=identicon&r=PG", "display_name": "Maleck13", "link": "https://stackoverflow.com/users/425810/maleck13"}, "is_accepted": false, "score": 2, "last_activity_date": 1459364795, "creation_date": 1459364795, "answer_id": 36317563, "question_id": 36245781, "link": "https://stackoverflow.com/questions/36245781/extracting-data-from-file-using-golang/36317563#36317563", "title": "extracting data from file using golang", "body": "<p>Not sure if I have missed something but would something like this suffice:</p>\n\n<pre><code>package main\n\nimport (\n\"regexp\"\n\"os\"\n\"log\"\n\"bufio\"\n\"fmt\"\n)\n\nfunc main() {\n\nr, _ := regexp.Compile(\"[aA-zZ]{3}\\\\s[0-9]{2}\\\\s[aA-zZ]{3}\\\\s[0-9]{4}\")\n\nfile, err := os.Open(\"/tmp/test.txt\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer file.Close()\nscanner := bufio.NewScanner(file)\nfor scanner.Scan() {\n\n    if r.MatchString(scanner.Text()) {\n        fmt.Println(scanner.Text())\n        for i :=0; i &lt; 5; i++{\n           scanner.Scan()\n            fmt.Println(scanner.Text())\n        }\n\n    }\n\n    if err := scanner.Err(); err != nil {\n        log.Fatal(err)\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6120073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M4yYe.jpg?s=128&g=1", "display_name": "Abdul", "link": "https://stackoverflow.com/users/6120073/abdul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1806, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1459364795, "creation_date": 1459070584, "last_edit_date": 1459072862, "question_id": 36245781, "link": "https://stackoverflow.com/questions/36245781/extracting-data-from-file-using-golang", "title": "extracting data from file using golang", "body": "<p>I am trying to extract lines from a file if a condition is met.</p>\n\n<p>The data in the file look like this :</p>\n\n<pre><code>Sat 08 Aug 2015\nNorwich City\nA\nLeague\n    W 3-1\n    Zaha 38; Delaney 48; Cabaye 90\n    27,036\n</code></pre>\n\n<p>If the  pattern of the date is matched, I want to print the following five lines.</p>\n\n<p>My code is,</p>\n\n<pre><code>func main() {\n\n    r, _ := regexp.Compile(\"[aA-zZ]{3}\\\\s[0-9]{2}\\\\s[aA-zZ]{3}\\\\s[0-9]{4}\")\n\n    file, err := os.Open(\"test.txt\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer file.Close()\n\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n\n        if r.MatchString(scanner.Text()) {\n\n            fmt.Println(scanner.Text())\n\n            // here how do i capture the following 5 lines\n\n        }\n\n        if err := scanner.Err(); err != nil {\n            log.Fatal(err)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1584071246, "post_id": 36245061, "comment_id": 107330020, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/a/60663003\">Ensure a type implements an interface at compile time in Go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "is_accepted": true, "score": 5, "last_activity_date": 1459096557, "last_edit_date": 1459096557, "creation_date": 1459064865, "answer_id": 36245062, "question_id": 36245061, "link": "https://stackoverflow.com/questions/36245061/what-does-rawmessagenil-mean/36245062#36245062", "title": "What does `(*RawMessage)(nil)` mean?", "body": "<p>Ok, I figured it out. It creates a new <code>*RawMessage</code> (pointer to <code>RawMessage</code>) that is <code>nil</code> by casting <code>nil</code> to <code>*RawMessage</code>. I would have expected </p>\n\n<pre><code>*RawMessage(nil)\n</code></pre>\n\n<p>but <strong>that doesn't work</strong> because the <strike>cast</strike> conversion seems to take precedence over the pointer operator, so it would become a dereference.</p>\n"}], "owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "accepted_answer_id": 36245062, "answer_count": 1, "score": 3, "last_activity_date": 1459096557, "creation_date": 1459064865, "question_id": 36245061, "link": "https://stackoverflow.com/questions/36245061/what-does-rawmessagenil-mean", "title": "What does `(*RawMessage)(nil)` mean?", "body": "<p>The section <a href=\"https://golang.org/doc/effective_go.html#blank_implements\" rel=\"nofollow\">Interface checks from Effective Go</a> recommends</p>\n\n<pre><code>var _ json.Marshaler = (*RawMessage)(nil)\n</code></pre>\n\n<p>as a compile-time check that <code>RawMessage</code> implements <code>Marshaler</code>.</p>\n\n<p>I get how the assignment does the type check but what does the right side actually mean?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459062755, "post_id": 36244767, "comment_id": 60119568, "body": "You could use a <a href=\"http://stackoverflow.com/questions/7933460/how-do-you-write-multiline-strings-in-go\">multiline string</a>?"}, {"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "reply_to_user": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459063077, "post_id": 36244767, "comment_id": 60119621, "body": "You mean to declare a variable as multiline string?"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 1, "creation_date": 1459063312, "post_id": 36244767, "comment_id": 60119665, "body": "yeah, declare the query as a multiline string literal."}, {"owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "reply_to_user": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459064329, "post_id": 36244767, "comment_id": 60119876, "body": "Thank you! First step to understand. Any example?"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1459064719, "post_id": 36244767, "comment_id": 60119957, "body": "I posted an answer with a simple example."}], "answers": [{"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 17, "last_activity_date": 1459065018, "last_edit_date": 1459065018, "creation_date": 1459064684, "answer_id": 36245043, "question_id": 36244767, "link": "https://stackoverflow.com/questions/36244767/long-queries-in-golang/36245043#36245043", "title": "Long queries in golang", "body": "<p>You can declare the query as a multiline string literal.</p>\n\n<pre><code>query := `\n  SELECT * FROM foo\n  UNION ALL\n  SELECT * FROM bar\n  UNION ALL\n  SELECT * FROM other`\n</code></pre>\n\n<p>And use it with <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"noreferrer\">DB.Query</a>.</p>\n\n<pre><code>rows, err := db.Query(query)\n</code></pre>\n\n<p>There are many different <a href=\"https://github.com/golang/go/wiki/SQLDrivers\" rel=\"noreferrer\">drivers</a> for many different sql databases you can use. They all would give you a <a href=\"https://golang.org/pkg/database/sql/#DB\" rel=\"noreferrer\">DB</a> object to work with. So you can use <a href=\"https://golang.org/pkg/database/sql/#DB.Prepare\" rel=\"noreferrer\">DB.Prepare</a>, DB.Query appropriately. Check docs of <a href=\"https://golang.org/pkg/database/sql\" rel=\"noreferrer\">database/sql</a> package for more info.</p>\n"}, {"tags": [], "owner": {"reputation": 3795, "user_id": 3135983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f63f04e7a6fb5c6d6349963a016fcbc7?s=128&d=identicon&r=PG&f=1", "display_name": "Keyur", "link": "https://stackoverflow.com/users/3135983/keyur"}, "is_accepted": false, "score": 0, "last_activity_date": 1542070937, "creation_date": 1542070937, "answer_id": 53272279, "question_id": 36244767, "link": "https://stackoverflow.com/questions/36244767/long-queries-in-golang/53272279#53272279", "title": "Long queries in golang", "body": "<p>There are two methods for this </p>\n\n<p><strong>1. Using backquote:</strong>\nUse <strong>(backquote\\backtick)</strong> which is with symbol <strong>`</strong> in keyboard.\nSo that your query will look like </p>\n\n<pre><code>query := `INSERT INTO Customers (CustomerName, ContactName, Address, City, PostalCode, Country)\n          VALUES ('Cardinal', 'Tom B. Erichsen', 'Skagen 21', 'Stavanger', '4006', 'Norway');`\n</code></pre>\n\n<p><strong>2. Using string concatenation:</strong>\n Use string concatenation characters between lines So that your query will look like</p>\n\n<pre><code>query :=\"INSERT INTO Customers (CustomerName, ContactName, Address, City, PostalCode, Country)\"+\n        \"VALUES ('Cardinal', 'Tom B. Erichsen', 'Skagen 21', 'Stavanger', '4006', 'Norway');\"\n</code></pre>\n\n<p>I prefer the 1st one :)</p>\n"}], "owner": {"reputation": 1378, "user_id": 3496776, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0b93e9de0f94f4c49617f50d5fd7e63f?s=128&d=identicon&r=PG&f=1", "display_name": "sibert", "link": "https://stackoverflow.com/users/3496776/sibert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7544, "favorite_count": 1, "accepted_answer_id": 36245043, "answer_count": 2, "score": 7, "last_activity_date": 1542070937, "creation_date": 1459062325, "question_id": 36244767, "link": "https://stackoverflow.com/questions/36244767/long-queries-in-golang", "title": "Long queries in golang", "body": "<p>This is a question based on absolute no knowledge of golang and the aim is to find if there is a way to make long queries readable. </p>\n\n<p>My attempt is to put the sql text in a variable and then execute the variable.</p>\n\n<p>Pseudocode (no real code):</p>\n\n<pre><code>var query = \nSELECT * FROM foo\nUNION ALL\nSELECT * FROM bar\nUNION ALL\nSELECT * FROM other\n...\n\ndb.prepare (var query)\ndb.query (var query)\n</code></pre>\n\n<p>This is maybe a dumb question, but I have searched and found no clue how to make long queries more \"readable\" in go. Most examples are based on \"hello world\" level. In the real world queries can be quite long.</p>\n\n<p>TIA,</p>\n"}, {"tags": ["go", "type-assertion"], "comments": [{"owner": {"reputation": 1060, "user_id": 1727288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f87f7fef5f4704e31d3ebf93b33f8f?s=128&d=identicon&r=PG", "display_name": "bain", "link": "https://stackoverflow.com/users/1727288/bain"}, "edited": false, "score": 0, "creation_date": 1568286754, "post_id": 36244725, "comment_id": 102230847, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19741174/go-what-does-range-or-map-return\">Go: What does range or map return?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 5, "last_activity_date": 1459077902, "creation_date": 1459077902, "answer_id": 36246784, "question_id": 36244725, "link": "https://stackoverflow.com/questions/36244725/why-map-and-type-assertion-can-return-1-or-2-values/36246784#36246784", "title": "Why map and type assertion can return 1 or 2 values?", "body": "<p>Map and type assertions can do this because they are not functions, but structures of the language. The behavior is described in the spec</p>\n\n<blockquote>\n  <p>An index expression on a map a of type map[K]V used in an assignment\n  or initialization of the special form</p>\n\n<pre><code>v, ok = a[x]\nv, ok := a[x]\nvar v, ok = a[x]\n</code></pre>\n  \n  <p>yields an additional untyped boolean value. The value of ok is true if\n  the key x is present in the map, and false otherwise.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>A type assertion used in an assignment or initialization of the\n  special form</p>\n\n<pre><code>v, ok = x.(T)\nv, ok := x.(T)\nvar v, ok = x.(T)\n</code></pre>\n  \n  <p>yields an additional untyped boolean value. The value of ok is true if\n  the assertion holds. Otherwise it is false and the value of v is the\n  zero value for type T. No run-time panic occurs in this case.</p>\n</blockquote>\n\n<p>It is not something that can be done on general functions, hence the <code>Must</code> pattern that explicitely reproduce the same behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 14728, "user_id": 2142577, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/820c611835bb6eea4851c318a3b73345?s=128&d=identicon&r=PG", "display_name": "laike9m", "link": "https://stackoverflow.com/users/2142577/laike9m"}, "edited": false, "score": 3, "creation_date": 1497196456, "post_id": 36247163, "comment_id": 75965487, "body": "&quot;Maps, type assertions, and the for statement with a range clause are special features of the Go programming language.&quot; Is it in the spec?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1459088120, "last_edit_date": 1459088120, "creation_date": 1459080657, "answer_id": 36247163, "question_id": 36244725, "link": "https://stackoverflow.com/questions/36244725/why-map-and-type-assertion-can-return-1-or-2-values/36247163#36247163", "title": "Why map and type assertion can return 1 or 2 values?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Function_types\" rel=\"noreferrer\">Function types</a></p>\n  \n  <p>A function type denotes the set of all functions with the same\n  parameter and result types.</p>\n\n<pre><code>FunctionType   = \"func\" Signature .\nSignature      = Parameters [ Result ] .\nResult         = Parameters | Type .\nParameters     = \"(\" [ ParameterList [ \",\" ] ] \")\" .\nParameterList  = ParameterDecl { \",\" ParameterDecl } .\nParameterDecl  = [ IdentifierList ] [ \"...\" ] Type .\n</code></pre>\n  \n  <p><a href=\"https://golang.org/ref/spec#Blank_identifier\" rel=\"noreferrer\">Blank identifier</a></p>\n  \n  <p>The blank identifier is represented by the underscore character _.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Assignments\" rel=\"noreferrer\">Assignments</a></p>\n  \n  <p>The blank identifier provides a way to ignore right-hand side values\n  in an assignment: </p>\n\n<pre><code>x, _ = f()  // evaluate f() but ignore second result value\n</code></pre>\n</blockquote>\n\n<p>Maps, type assertions, and the <code>for</code> statement with a <code>range</code> clause are special features of the Go programming language. You can't have a variable number of return values for an ordinary function type.</p>\n\n<p>You can ignore a return value with an underscore (_), the blank identifier,  or you can use a wrapper function. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc two() (int, bool) {\n    return 42, true\n}\n\nfunc one() int {\n    r, _ := two()\n    return r\n}\n\nfunc main() {\n    r, ok := two()\n    r, _ = two()\n    r = one()\n    fmt.Println(r, ok)\n}\n</code></pre>\n"}], "owner": {"reputation": 118, "user_id": 3045408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be1169e72ac1a87a8b1b8cc17c96be87?s=128&d=identicon&r=PG&f=1", "display_name": "Gimo", "link": "https://stackoverflow.com/users/3045408/gimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1745, "favorite_count": 5, "accepted_answer_id": 36247163, "answer_count": 2, "score": 8, "last_activity_date": 1585471720, "creation_date": 1459061981, "last_edit_date": 1585471720, "question_id": 36244725, "link": "https://stackoverflow.com/questions/36244725/why-map-and-type-assertion-can-return-1-or-2-values", "title": "Why map and type assertion can return 1 or 2 values?", "body": "<p>To define a map, we can do such a thing:</p>\n\n<p><code>value, present := m[\"key\"]</code></p>\n\n<p>or:</p>\n\n<p><code>value := m[\"key\"]</code></p>\n\n<p>and with type assertion, we can do:</p>\n\n<pre><code>var i interface{} = \"hello\"\n\ns := i.(string)\nfmt.Println(s)\n\ns, ok := i.(string)\nfmt.Println(s, ok)\n</code></pre>\n\n<p>but I can't find a way to define a func that can return 1 value or 2-values. </p>\n\n<p>For instance:</p>\n\n<pre><code>func hello() (string, error) {\n    return \"world\", nil\n}\n</code></pre>\n\n<p>When I invoke this func I get:</p>\n\n<pre><code>v, ok := hello() // valid\nv := hello() // invalid\n</code></pre>\n\n<p>PS: I know how something like <code>template.Must</code> works, but it seems different. I really want to know how Map and type assertion can do the magic, so I can apply it to functions.</p>\n\n<p>Thanks in advance. (Am I clear? I have poor English sorry).</p>\n"}, {"tags": ["postgresql", "go", "docker", "docker-compose"], "comments": [{"owner": {"reputation": 9875, "user_id": 4190526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f136b1cb9f010656895934c874637953?s=128&d=identicon&r=PG&f=1", "display_name": "Xiongbing Jin", "link": "https://stackoverflow.com/users/4190526/xiongbing-jin"}, "edited": false, "score": 0, "creation_date": 1459052675, "post_id": 36243559, "comment_id": 60117797, "body": "The reason is that <code>depends_on</code> cannot replace <code>links</code>. The former only determines order of startup, while the latter also enables access between containers by name."}], "answers": [{"comments": [{"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1459315600, "post_id": 36245209, "comment_id": 60224944, "body": "Thank you for the amazing insights. From your answer, I changes my connection code on <code>user.go</code> line 20 to be: <code>var pgConf string = &quot;user=web_app dbname=web_app sslmode=verify-full password=password host=172.18.0.2&quot; and I got a successful connection. So in the end, </code>docker-compose.yaml` was good. All I needed was the additional information you gave me about the internal IP that connected the containers."}, {"owner": {"reputation": 23386, "user_id": 1811501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tj0qU.jpg?s=128&g=1", "display_name": "thaJeztah", "link": "https://stackoverflow.com/users/1811501/thajeztah"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 1, "creation_date": 1459325928, "post_id": 36245209, "comment_id": 60230461, "body": "You should be able to change that to <code>host=db</code>, that&#39;s the idea of the embedded DNS in Docker, and a better approach, because the IP address can change"}], "tags": [], "owner": {"reputation": 23386, "user_id": 1811501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tj0qU.jpg?s=128&g=1", "display_name": "thaJeztah", "link": "https://stackoverflow.com/users/1811501/thajeztah"}, "is_accepted": true, "score": 8, "last_activity_date": 1459066095, "creation_date": 1459066095, "answer_id": 36245209, "question_id": 36243559, "link": "https://stackoverflow.com/questions/36243559/how-to-connect-docker-web-app-container-to-docker-postgresql-container/36245209#36245209", "title": "How to connect Docker web app container to Docker PostgreSQL container?", "body": "<p>When using the docker-compose v2, it's not needed to create links between services. Docker 1.9 and 1.10 allows you to connect to other containers on the same (custom) network through their name.</p>\n\n<p>You should be able to connect using either the name of the <em>service</em> or the name of the <em>container</em> as a hostname. Given that the name of the container is generated by docker-compose, this is not really convenient to use, so for that reason, docker-compose also adds an <em>alias</em> with the service name to each container.</p>\n\n<p>Take this very simple example. I've used an Nginx container for convenience, but the same should apply to your situation;</p>\n\n<pre class=\"lang-YAML prettyprint-override\"><code>version: '2'\nservices:\n  web_app:\n    image: nginx\n  db:\n    image: nginx\n</code></pre>\n\n<p>First start the project (assuming;</p>\n\n<pre><code>$ docker-compose --project-name=test up -d\nCreating network \"test_default\" with the default driver\nCreating test_db_1\nCreating test_web_app_1\n</code></pre>\n\n<p>Then ping the \"db\" service from inside the <code>test_web_app_1</code> container:</p>\n\n<pre><code>$ docker exec -it test_web_app_1 ping -c 2 db\nPING db (172.18.0.2): 56 data bytes\n64 bytes from 172.18.0.2: icmp_seq=0 ttl=64 time=0.108 ms\n64 bytes from 172.18.0.2: icmp_seq=1 ttl=64 time=0.243 ms\n--- db ping statistics ---\n2 packets transmitted, 2 packets received, 0% packet loss\nround-trip min/avg/max/stddev = 0.108/0.175/0.243/0.068 ms\n</code></pre>\n\n<p>If you inspect the <code>test_db_1</code> container, you can see that docker-compose automatically added a \"db\" alias for the <code>test_db_1</code> container;</p>\n\n<pre><code>$ docker inspect test_db_1\n</code></pre>\n\n<p>Gives: (just the <code>NetworkSettings.Networks</code>part)</p>\n\n<pre><code>\"Networks\": {\n    \"test_default\": {\n        \"IPAMConfig\": null,\n        \"Links\": null,\n        \"Aliases\": [\n            \"db\",\n            \"002b1875e61f\"\n        ],\n        \"NetworkID\": \"0f9e2cddeca79e5a46c08294ed61dee273828607f99014f6410bda887626be70\",\n        \"EndpointID\": \"a941ab95586a8fdafc5075f9c5c44d745f974e5790ef6048b9e90115a22fb31f\",\n        \"Gateway\": \"172.18.0.1\",\n        \"IPAddress\": \"172.18.0.2\",\n        \"IPPrefixLen\": 16,\n        \"IPv6Gateway\": \"\",\n        \"GlobalIPv6Address\": \"\",\n        \"GlobalIPv6PrefixLen\": 0,\n        \"MacAddress\": \"02:42:ac:12:00:02\"\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2935, "favorite_count": 3, "accepted_answer_id": 36245209, "answer_count": 1, "score": 4, "last_activity_date": 1459352443, "creation_date": 1459049739, "last_edit_date": 1459352443, "question_id": 36243559, "link": "https://stackoverflow.com/questions/36243559/how-to-connect-docker-web-app-container-to-docker-postgresql-container", "title": "How to connect Docker web app container to Docker PostgreSQL container?", "body": "<p>I'm practicing making a Golang web app that interacts with a PostgreSQL database, each running on their own container.</p>\n\n<p>I'm running the containers with <code>docker-compose up</code></p>\n\n<p>But I seem to be failing on getting the postgres container properly set up.</p>\n\n<p>For brevity, links to <code>Dockerfile</code>s and other settings files are <a href=\"https://gist.github.com/andradei/922e11f469aec277ab6e\" rel=\"nofollow\">on this gist</a> (let me know if you want it here instead).</p>\n\n<pre><code>version: '2'\nservices:\n  web_app:\n    build: dockerfiles/web_app\n    ports:\n      - \"9000:9000\"\n    volumes:\n      - .:/go/src/gitlab.com/repo/web_app\n    # links might be replaced by depends_on.\n    # links:\n    #   - db\n    depends_on:\n      - db\n    # tty and stdin_open cause docker-compose to disconnect from docker-machine after 60sec.\n    # A fix is on the way.\n    # tty: true\n    # stdin_open: true\n  db:\n    build: dockerfiles/db\n    volumes:\n      - data:/var/lib/postgresql/data\nvolumes:\n  data: {}\n</code></pre>\n\n<p><code>docker-compose up</code> works fine. But when the application tries to open a database connection with:</p>\n\n<pre><code>var pgConf string = \"user=web_app dbname=web_app sslmode=verify-full password=password\"\n\ndb, err := sql.Open(\"postgres\", pgConf)\n</code></pre>\n\n<p>I get the following error from docker compose:</p>\n\n<pre><code>Error creating new user:  dial tcp [::1]:5432: getsockopt: connection refused\n</code></pre>\n\n<p>What can I do to make both containers talk to each other?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["go", "google-api", "google-cloud-trace"], "answers": [{"comments": [{"owner": {"reputation": 676, "user_id": 105456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f0049842700597b89972e1fbf6f542?s=128&d=identicon&r=PG", "display_name": "tmc", "link": "https://stackoverflow.com/users/105456/tmc"}, "edited": false, "score": 0, "creation_date": 1467235408, "post_id": 36243165, "comment_id": 63654073, "body": "shouldn&#39;t you mark this as answered and/or update it?"}], "tags": [], "owner": {"reputation": 71, "user_id": 6119221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2980584010501eef47473091068393c?s=128&d=identicon&r=PG", "display_name": "Kyle Conroy", "link": "https://stackoverflow.com/users/6119221/kyle-conroy"}, "is_accepted": true, "score": 0, "last_activity_date": 1459045227, "creation_date": 1459045227, "answer_id": 36243165, "question_id": 36242589, "link": "https://stackoverflow.com/questions/36242589/appending-a-new-trace-fails/36243165#36243165", "title": "Appending a new trace fails", "body": "<p>My trace ID generation was incorrect. </p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"time\"\n    \"encoding/hex\"\n    \"rand\"\n\n    \"golang.org/x/oauth2\"\n    goog \"golang.org/x/oauth2/google\"\n    cloudtrace \"google.golang.org/api/cloudtrace/v1\"\n)\n\nfunc run() error {\n    blob, err := ioutil.ReadFile(\"jwt.json\")\n    if err != nil {\n        return err\n    }\n    conf, err := goog.JWTConfigFromJSON(blob, cloudtrace.CloudPlatformScope)\n    if err != nil {\n        return err\n    }\n\n    client := conf.Client(oauth2.NoContext)\n\n    srv, err := cloudtrace.New(client)\n    if err != nil {\n        return err\n    }\n\n    tracer := cloudtrace.NewProjectsService(srv)\n    now := time.Now()\n    format := \"2006-01-02T15:04:05.999999999Z\"\n\n    p := make([]byte, 16)\n    rand.Read(p)\n\n    call := tracer.PatchTraces(\"foo-1262\", &amp;cloudtrace.Traces{\n        Traces: []*cloudtrace.Trace{\n            {\n                TraceId:   hex.EncodeToString(p),\n                ProjectId: \"foo-1262\",\n                Spans: []*cloudtrace.TraceSpan{\n                    {\n                        StartTime: now.Format(format),\n                        EndTime:   now.Add(5 * time.Second).Format(format),\n                        Kind:      \"RPC_SERVER\",\n                        Name:      \"bar\",\n                        SpanId:    100,\n                    },\n                },\n            },\n        },\n    })\n\n    _, err = call.Do()\n    return err\n}\n\nfunc main() {\n    if err := run(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6119221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2980584010501eef47473091068393c?s=128&d=identicon&r=PG", "display_name": "Kyle Conroy", "link": "https://stackoverflow.com/users/6119221/kyle-conroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 36243165, "answer_count": 1, "score": 2, "last_activity_date": 1459045227, "creation_date": 1459039194, "question_id": 36242589, "link": "https://stackoverflow.com/questions/36242589/appending-a-new-trace-fails", "title": "Appending a new trace fails", "body": "<p>I'm attempting to use the <a href=\"https://cloud.google.com/trace/api/reference/rest/v1/projects/patchTraces\" rel=\"nofollow\"><code>patchTraces</code></a> method to submit tracing information to Google CloudTrace. The patch request I'm making returns a opaque error message. Any idea what I'm doing wrong?</p>\n\n<p>Go code</p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"time\"\n\n    \"github.com/twinj/uuid\"\n    \"golang.org/x/oauth2\"\n    goog \"golang.org/x/oauth2/google\"\n    cloudtrace \"google.golang.org/api/cloudtrace/v1\"\n)\n\nfunc run() error {\n    blob, err := ioutil.ReadFile(\"jwt.json\")\n    if err != nil {\n        return err\n    }\n    conf, err := goog.JWTConfigFromJSON(blob, cloudtrace.CloudPlatformScope)\n    if err != nil {\n        return err\n    }\n\n    client := conf.Client(oauth2.NoContext)\n\n    srv, err := cloudtrace.New(client)\n    if err != nil {\n        return err\n    }\n\n    tracer := cloudtrace.NewProjectsService(srv)\n    now := time.Now()\n    format := \"2006-01-02T15:04:05.999999999Z\"\n\n    call := tracer.PatchTraces(\"foo-1262\", &amp;cloudtrace.Traces{\n        Traces: []*cloudtrace.Trace{\n            {\n                TraceId:   uuid.NewV4().String(),\n                ProjectId: \"foo-1262\",\n                Spans: []*cloudtrace.TraceSpan{\n                    {\n                        StartTime: now.Format(format),\n                        EndTime:   now.Add(5 * time.Second).Format(format),\n                        Kind:      \"RPC_SERVER\",\n                        Name:      \"bar\",\n                        SpanId:    100,\n                    },\n                },\n            },\n        },\n    })\n\n    _, err = call.Do()\n    return err\n}\n\nfunc main() {\n    if err := run(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Here's the request that gets sent</p>\n\n<pre><code>https://cloudtrace.googleapis.com/v1/projects/foo-1262/traces?alt=json\n{\n    \"traces\": [{\n        \"projectId\": \"foo-1262\",\n        \"spans\": [{\n            \"endTime\": \"2016-03-26T17:23:19.705253417Z\",\n            \"kind\": \"RPC_SERVER\",\n            \"name\": \"foo\",\n            \"spanId\": \"100\",\n            \"startTime\": \"2016-03-26T17:23:14.705253417Z\"\n        }],\n        \"traceId\": \"4d86ec85-419d-40cf-ae95-d49c2d066cd6\"\n    }]\n}\n</code></pre>\n\n<p>Response</p>\n\n<pre><code>{\n    \"error\": {\n        \"code\": 400,\n        \"message\": \"Request contains an invalid argument.\",\n        \"errors\": [{\n            \"message\": \"Request contains an invalid argument.\",\n            \"domain\": \"global\",\n            \"reason\": \"badRequest\"\n        }],\n        \"status\": \"INVALID_ARGUMENT\"\n    }\n}\n</code></pre>\n\n<p>Everything looks correct, but I'm getting back a useless error message. Please help!</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1459035178, "post_id": 36242018, "comment_id": 60114541, "body": "No, <code>pq</code> is a variable. <code>(*pq)</code> is the dereference operator on the variable. So <code>(*pq)[0]</code> is equivalent to <code>a := *pq; a[0]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6119074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4115549d18dfe1eb0a422c8c069ec98f?s=128&d=identicon&r=PG", "display_name": "khalieb", "link": "https://stackoverflow.com/users/6119074/khalieb"}, "edited": false, "score": 0, "creation_date": 1459036258, "post_id": 36242187, "comment_id": 60114756, "body": "Makes perfect sense. Thank you!"}], "tags": [], "owner": {"reputation": 15124, "user_id": 144969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a12d286134563e628089f733b946a00?s=128&d=identicon&r=PG", "display_name": "Dimitar Dimitrov", "link": "https://stackoverflow.com/users/144969/dimitar-dimitrov"}, "is_accepted": true, "score": 8, "last_activity_date": 1459035753, "creation_date": 1459035753, "answer_id": 36242187, "question_id": 36242018, "link": "https://stackoverflow.com/questions/36242018/pointer-to-slice-and-array/36242187#36242187", "title": "Pointer to slice and array", "body": "<p>What works for you is not type assertion - it's operation ordering.</p>\n\n<p>The problem is rooted in the fact that the indexing precedes the dereferencing of your pointer. Once you put braces around the pointer dereferencing, it all works well, because the indexing is applied to the now dereferenced <code>PriorityQueue</code> instance.</p>\n\n<p>You don't need to do that for array pointers, because they are automatically dereferenced - the slight difference between indexing arrays and slices is explained here: <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">The Go Programming Language Specification - Index expressions</a></p>\n\n<blockquote>\n  <p>For <code>a</code> of array type <code>A</code>:</p>\n  \n  <ul>\n  <li>a constant index must be in range</li>\n  <li>if <code>x</code> is out of range at run time, a run-time panic occurs</li>\n  <li><code>a[x]</code> is the array element at index <code>x</code> and the type of <code>a[x]</code> is the element type of <code>A</code></li>\n  </ul>\n  \n  <p><strong>For <code>a</code> of pointer to array type:</strong></p>\n  \n  <ul>\n  <li><strong><code>a[x]</code> is shorthand for <code>(*a)[x]</code></strong></li>\n  </ul>\n  \n  <p>For <code>a</code> of slice type <code>S</code>:</p>\n  \n  <ul>\n  <li>if <code>x</code> is out of range at run time, a run-time panic occurs</li>\n  <li><code>a[x]</code> is the slice element at index <code>x</code> and the type of <code>a[x]</code> is the element type of <code>S</code></li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 43, "user_id": 6119074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4115549d18dfe1eb0a422c8c069ec98f?s=128&d=identicon&r=PG", "display_name": "khalieb", "link": "https://stackoverflow.com/users/6119074/khalieb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12649, "favorite_count": 3, "accepted_answer_id": 36242187, "answer_count": 1, "score": 4, "last_activity_date": 1569321142, "creation_date": 1459034187, "last_edit_date": 1569321142, "question_id": 36242018, "link": "https://stackoverflow.com/questions/36242018/pointer-to-slice-and-array", "title": "Pointer to slice and array", "body": "<p>I was looking at Go's heap package's (<a href=\"https://golang.org/pkg/container/heap/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/container/heap/</a>) Priority Queue example and came across this: </p>\n\n<pre><code>type PriorityQueue []*Item\n...\nfunc (pq *PriorityQueue) Pop() interface{} {\n    old := *pq\n    n := len(old)\n    item := old[n-1]\n    item.index = -1 // for safety\n    *pq = old[0 : n-1]\n    return item\n} \n</code></pre>\n\n<p>When I started playing around with this code to make sure I understood it, I tried:</p>\n\n<pre><code>item := *pq[0] // error\n</code></pre>\n\n<p>This gives you type *[]T does not support indexing. But if you do:</p>\n\n<pre><code>item := (*pq)[0] // all is well\n</code></pre>\n\n<p>This is type assertion right? Was hoping someone could explain what is going on here. </p>\n\n<p>Here is some code to quickly show this: <a href=\"https://play.golang.org/p/uAzYASrm_Q\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uAzYASrm_Q</a></p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459019285, "post_id": 36239614, "comment_id": 60109360, "body": "I assume all funcs have the same signature? i.e. <code>func()</code>"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459019485, "post_id": 36239614, "comment_id": 60109439, "body": "Also, do all the funcs live in the same package?"}, {"owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459019883, "post_id": 36239614, "comment_id": 60109579, "body": "Yes, all functions (all &quot;tasks&quot;) have the same signature. And all functions live in the same package."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459022864, "post_id": 36239614, "comment_id": 60110733, "body": "Updated my answer with an explanation why your request to find a func by name using reflection wouldn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "edited": false, "score": 0, "creation_date": 1459066059, "post_id": 36239769, "comment_id": 60120251, "body": "Thanks for your answers, they really help me a lot. In your suggestion, I see a <code>taskDefs</code> map[string]func() where all &quot;tasks&quot; need to be defined. Isn&#39;t is possible to skip this part? This way I can add tasks by simply putting the function name in a config file and implement the function in my tasks package, without having to add something to <code>taskDefs</code>."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "edited": false, "score": 1, "creation_date": 1459116997, "post_id": 36239769, "comment_id": 60136345, "body": "@RogierLommers I understand what you&#39;re wanting; to avoid the explicit mapping between name and function. There are two problems with this: 1) I don&#39;t see a way to do it through reflection, unless you dynamically read the source with the go parser at runtime, which seems way heavier of an approach to do the same thing ultimately (map of name to function).  2) The go linker will drop unreferenced functions, so there is a risk that the function won&#39;t even be in the final binary if it&#39;s not referenced anywhere else, meaning it won&#39;t work."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 3, "last_activity_date": 1459022691, "last_edit_date": 1459022691, "creation_date": 1459019868, "answer_id": 36239769, "question_id": 36239614, "link": "https://stackoverflow.com/questions/36239614/convert-string-value-to-function-call/36239769#36239769", "title": "Convert string value to function call", "body": "<p>Why not something like:</p>\n\n<pre><code>taskDefs := map[string]func(){\n  \"networkInfo\": networkInfo,\n  \"bla\": bla,\n}\n\nfor function, spec := range tasks {\n  if fn, ok := taskDefs[function]; ok {\n    c.AddFunc(spec, func() { fn() }) // not sure if you need the enclosing func\n  } else {\n    log.Errorf(\"unknown task: %q\", function)\n  }\n}\n</code></pre>\n\n<p>If you do need varying signatures of your funcs then you'd actually need reflection, but if the types of the funcs are all the same, then using this map approach might be a simpler solution, without the overhead of reflection.</p>\n\n<p>The only way I've found to find functions by name in a package is by actually parsing the source files.  <a href=\"https://github.com/ungerik/pkgreflect\" rel=\"nofollow\">This repo</a> is an example of finding funcs and storing them in a map with the name as the key.</p>\n\n<p>The Go linker will silently drop unreferenced funcs, so if the only way you're referencing the func is through reflection it would break.  That is why the map approach I suggest is superior; it let's the linker know the func is being used.</p>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459022691, "creation_date": 1459019100, "question_id": 36239614, "link": "https://stackoverflow.com/questions/36239614/convert-string-value-to-function-call", "title": "Convert string value to function call", "body": "<p>I want to specify a function based on a string. I'm getting strings out of a map, in the example below they are the values in <code>function</code> while interating ove the map. Now for example, when the string value <code>function</code> == \"networkInfo\", I would like to \"treat\" that value as a real functions' name. It's hard to explain, but I think you guys will know what I mean.</p>\n\n<p>My goal is to remove the switch statement and directly call <code>c.AddFunc(spec, func() { networkInfo() })</code> where networkInfo is the function name, extracted from string <code>function</code>. I know this is possible, but I don't know how :(. Help is appreciated!</p>\n\n<pre><code>// ScheduleCronjobs starts the scheduler\nfunc ScheduleCronjobs() {\n\ntasks := props.P.GetStringMapString(\"tasks\")\nlog.Infof(\"number of tasks: %d\", len(tasks))\n\nif len(tasks) != 0 {\n    c := cron.New()\n\n    // for each task, initialize\n    for function, spec := range tasks {\n        switch function {\n        case \"networkInfo\":\n            c.AddFunc(spec, func() { networkInfo() })\n        case \"bla\":\n            c.AddFunc(spec, func() { bla() })\n        default:\n            log.Errorf(\"unknown task: %q\", function)\n        }\n    }\n    c.Start()\n}\n\n// after initialization, send out confirmation message\nslack.SendMessage(\"tasks initialized\", props.P.GetString(\"channel\"))\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459018403, "post_id": 36239360, "comment_id": 60108990, "body": "why are you adding the ID field to each struct?  The <code>gorm.Model</code> you&#39;re embedding already does that."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459018863, "post_id": 36239360, "comment_id": 60109165, "body": "Are you trying to override the gorm.Model primary key type of <code>uint</code> with <code>varchar(36)</code>?"}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1459018908, "post_id": 36239360, "comment_id": 60109190, "body": "@JohnWeldon I am, yes. Do I need to remove <code>gorm.Model</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1585150304, "last_edit_date": 1585150304, "creation_date": 1459018594, "answer_id": 36239495, "question_id": 36239360, "link": "https://stackoverflow.com/questions/36239360/message-relation-users-does-not-exist-golang/36239495#36239495", "title": "&quot;Message&quot;: &quot;relation \\&quot;users\\&quot; does not exist&quot;, golang", "body": "<p>I suspect it is because your <code>Artist</code>, <code>Content</code>, and <code>Track</code> structs do not have a parent reference to the <code>User</code>, although the <code>User</code> has-many references to them.  Also, the embedded type <code>gorm.Model</code> already has the ID field.</p>\n\n<p>Try:</p>\n\n<pre><code>type Artist struct {\n    gorm.Model\n    ID string `sql:\"type:varchar(36);primary key\"`\n    UserID string `sql:\"type:varchar(36)\"`\n}\n\ntype Content struct {\n    gorm.Model\n    ID string `sql:\"type:varchar(36);primary key\"`\n    UserID string `sql:\"type:varchar(36)\"`\n}\n\ntype Track struct {\n    gorm.Model\n    ID string `sql:\"type:varchar(36);primary key\"`\n    UserID string `sql:\"type:varchar(36)\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4173, "favorite_count": 0, "accepted_answer_id": 36239495, "answer_count": 1, "score": 1, "last_activity_date": 1585150304, "creation_date": 1459017971, "last_edit_date": 1461025344, "question_id": 36239360, "link": "https://stackoverflow.com/questions/36239360/message-relation-users-does-not-exist-golang", "title": "&quot;Message&quot;: &quot;relation \\&quot;users\\&quot; does not exist&quot;, golang", "body": "<p>I have an API written in Go, I have the following set of models... </p>\n\n<pre><code>type User struct {\n    gorm.Model\n    ID       string `sql:\"type:varchar(36);primary key\"`\n    Name     string\n    Password string\n    Email    string\n    Content  []Content\n    Location string\n    Tracks   []Track\n    Avatar   string\n    BgImg    string\n    Artists  []Artist\n}\n\ntype Artist struct {\n    gorm.Model\n    ID string `sql:\"type:varchar(36);primary key\"`\n}\n\ntype Content struct {\n    gorm.Model\n    ID string `sql:\"type:varchar(36);primary key\"`\n}\n\ntype Track struct {\n    gorm.Model\n    ID string `sql:\"type:varchar(36);primary key\"`\n}\n</code></pre>\n\n<p>in my <code>main.go</code> file, I'm initialising my database with...</p>\n\n<pre><code>drivers.DB().CreateTable(&amp;models.User{})\ndrivers.DB().CreateTable(&amp;models.Artist{})\ndrivers.DB().CreateTable(&amp;models.Content{})\ndrivers.DB().CreateTable(&amp;models.Track{})\n</code></pre>\n\n<p>But I'm getting the error...</p>\n\n<pre><code>{\n  \"_message\": {\n    \"Severity\": \"ERROR\",\n    \"Code\": \"42P01\",\n    \"Message\": \"relation \\\"users\\\" does not exist\",\n    \"Detail\": \"\",\n    \"Hint\": \"\",\n    \"Position\": \"15\",\n    \"InternalPosition\": \"\",\n    \"InternalQuery\": \"\",\n    \"Where\": \"\",\n    \"Schema\": \"\",\n    \"Table\": \"\",\n    \"Column\": \"\",\n    \"DataTypeName\": \"\",\n    \"Constraint\": \"\",\n    \"File\": \"parse_relation.c\",\n    \"Line\": \"1159\",\n    \"Routine\": \"parserOpenTable\"\n  }\n}\n</code></pre>\n"}, {"tags": ["go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 1, "last_activity_date": 1459021091, "creation_date": 1459021091, "answer_id": 36239985, "question_id": 36238206, "link": "https://stackoverflow.com/questions/36238206/how-to-get-the-location-of-the-current-file-in-revel/36239985#36239985", "title": "how to get the location of the current file in revel", "body": "<p>It doesn't make sense to get the directory of the model.go file at runtime, because the compiled executable could be on a completely different filesystem.</p>\n\n<p>You may want to get the directory of where the running executable was started from:</p>\n\n<pre><code>dir, err := filepath.Abs(filepath.Dir(os.Args[0]))\n</code></pre>\n\n<p>dir will be the folder where the program lives at runtime.</p>\n"}], "owner": {"reputation": 529, "user_id": 4325278, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0TpCM.jpg?s=128&g=1", "display_name": "GIRISH RAMNANI", "link": "https://stackoverflow.com/users/4325278/girish-ramnani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459021091, "creation_date": 1459011953, "question_id": 36238206, "link": "https://stackoverflow.com/questions/36238206/how-to-get-the-location-of-the-current-file-in-revel", "title": "how to get the location of the current file in revel", "body": "<p>I am using golang revel web framework and \nI am trying to create a <code>sqlite</code> db in the current working directory.</p>\n\n<p><code>model.go</code></p>\n\n<pre><code>func New(dbName string,table string) *Db {\n    _,filename,_,_ := runtime.Caller(1)\n    db , err := sql.Open(\"sqlite3\",path.Join(path.Dir(filename),dbName))\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err = db.Ping()\n\n    if err != nil {\n        log.Panic(err)\n    }\n\n    database := &amp;Db{Database:db}\n    _,err = db.Exec(\"create table %s\" +\n    \"( id integer primary key, \" +\n    \"name varchar(100),\"+\n    \"email varchar(100),\"+\n    \"branch varchar(100),\"+\n    \"help varchar(100)\",)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>I have a test in place which just calls this function.</p>\n\n<p>whenever i run the test using <code>revel test</code> or by going to the <code>localhost:9000/@tests</code>, the function <code>Panics</code> and the error message is\n<code>cannot open the database file</code>.</p>\n\n<p>The reason that is happening is because the <code>filename</code> returned by <code>runtime.Caller(1)</code> is <code>/usr/local/go/src/runtime/asm_amd64.s</code> for which the program has no permission.</p>\n\n<p>if i directly write <code>./foo.db</code>, even then the error shows.</p>\n\n<p>I tried <code>os.Getwd()</code> which return empty string.</p>\n\n<p>I also tried <code>filepath.Abs(filepath.Dir(os.Args[0]))</code>\nbut that returned <code>/home/girish/GoProjects/bin/revel.d</code> which is the <code>revel</code> binary.</p>\n\n<p>So whats the best way to find the directory of the <code>model.go</code>?</p>\n"}, {"tags": ["unit-testing", "go", "code-coverage"], "answers": [{"comments": [{"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1459185986, "post_id": 36241790, "comment_id": 60162147, "body": "If you remove the first part (as it is obviously not intended to do that in Go) and keep only your (though personal but I agree here with you so we can consider it a good practice) opinion, I&#39;ll probably accept your answer if there is no better till tomorrow evening :-)"}, {"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "reply_to_user": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1459219231, "post_id": 36241790, "comment_id": 60175761, "body": "I know it&#39;s not intended to do testing like that, but its the only way (that I know of) to get the &quot;code coverage&quot; you want while testing. I&#39;ve added that part because I believe it answers your question."}], "tags": [], "owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "is_accepted": false, "score": 0, "last_activity_date": 1459032504, "creation_date": 1459032504, "answer_id": 36241790, "question_id": 36237267, "link": "https://stackoverflow.com/questions/36237267/testing-in-go-code-coverage-within-project-packages/36241790#36241790", "title": "Testing in GO - code coverage within project packages", "body": "<p>You can import your packages within a single test and write tests for them based on how they'll be used within your application. For example, you can have one test, <code>main_test.go</code> which imports all the other packages, and then you write tests for the methods in the imported packages.<br>\nLike this (in main_test.go):</p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n    \"lib\"\n    \"models\"\n    \"handlers\"\n    // etc\n)\n\n// testing code here\n</code></pre>\n\n<p>However, in my personal opinion, it might be better to make sure that each package does what it should and that only. The best way to do that, is by testing the individual package itself, with its own test suite. </p>\n"}], "owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459032504, "creation_date": 1459006991, "question_id": 36237267, "link": "https://stackoverflow.com/questions/36237267/testing-in-go-code-coverage-within-project-packages", "title": "Testing in GO - code coverage within project packages", "body": "<p>I have a question about generating code coverage in Go(lang) projects.I have this simple structure:</p>\n\n<pre><code>ROOT/\n    config/\n    handlers/\n    lib/\n    models/\n    router/\n    main.go\n</code></pre>\n\n<p><code>config</code> contains configuration in JSON and one simple <code>config.go</code> that reads and parses JSON file and fills the <code>Config</code> struct which is used then when initializing DB connection. <code>handlers</code> contains <em>controllers</em> (i.e. handlers of respective METHOD+URL described in <code>router/routes.go</code>). <code>lib</code> contains some DB, request responder and logger logic. <code>models</code> contains structs and their funcs to be mapped from-to JSON and DB. Finally <code>router</code> contains the router and routes definition.</p>\n\n<p>Basically just by testing one single handler I ensure that my config, logger, db, responder, router and corresponding model are invoked (and tested somehow as well).</p>\n\n<p>Now if this would be a PHP or Java or I don't know what else language, having and running that single handler test would create a code coverage also for all other invoked parts of code even if they are in different folders (i.e. packages here). Unfortunately, this is not the case in Go.</p>\n\n<p>And there is very little code in most of my <code>lib</code> files having just one method (like <code>InitDB()</code> or <code>ReadConfig()</code> or <code>NewRouter()</code> or <code>Logger()</code>) so to be able to have code coverage for them I have to create stupid tests in these packages as well while they were already invoked and tested by testing the main URLs handling packages.</p>\n\n<p>Is there any way how to get code coverage from packages also for included other packages within one project?</p>\n"}, {"tags": ["html", "css", "go"], "answers": [{"tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 10, "last_activity_date": 1459007558, "last_edit_date": 1459007558, "creation_date": 1459006722, "answer_id": 36237220, "question_id": 36237060, "link": "https://stackoverflow.com/questions/36237060/gin-golang-loading-html-files-with-stylesheet/36237220#36237220", "title": "Gin-golang: Loading html files with stylesheet", "body": "<p>You need a handler for static files in <code>main.go</code>. Use <a href=\"https://godoc.org/github.com/gin-gonic/gin#RouterGroup.Static\" rel=\"noreferrer\">Static</a>.</p>\n\n<pre><code>r.Static(\"/css\", \"../templates/css\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 5273589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f7a59547b1aa86895dde0daec61acb?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/5273589/abhi"}, "is_accepted": false, "score": -1, "last_activity_date": 1459007298, "creation_date": 1459007298, "answer_id": 36237328, "question_id": 36237060, "link": "https://stackoverflow.com/questions/36237060/gin-golang-loading-html-files-with-stylesheet/36237328#36237328", "title": "Gin-golang: Loading html files with stylesheet", "body": "<p>In your index.tmpl.html file try replacing the following :</p>\n\n<pre><code>&lt;style type=\"text/css\" media=\"screen\"&gt;\n    &lt;!-- \n        @import url(\"/css/index.css\");\n    --&gt;\n&lt;/style&gt;\n</code></pre>\n\n<p>to this one :</p>\n\n<pre><code>&lt;style type=\"text/css\" media=\"screen\"&gt;\n    &lt;!-- \n        @import url(\"css/index.css\");\n    --&gt;\n&lt;/style&gt;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6117895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5874a35ee5368308d80155d8f1dd3109?s=128&d=identicon&r=PG&f=1", "display_name": "marioneta", "link": "https://stackoverflow.com/users/6117895/marioneta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5028, "favorite_count": 0, "accepted_answer_id": 36237220, "answer_count": 2, "score": 5, "last_activity_date": 1527421370, "creation_date": 1459005868, "question_id": 36237060, "link": "https://stackoverflow.com/questions/36237060/gin-golang-loading-html-files-with-stylesheet", "title": "Gin-golang: Loading html files with stylesheet", "body": "<p>my english is very basic, I'm sorry :)</p>\n\n<p>Well, my problem is that when Gin is loading HTML, my HTML file contains import (/stylesheet/index.css), so that when run my app with Gin, this alert that not load stylesheet file</p>\n\n<pre><code>workspace/\n          main/\n               main.go\n          templates/\n                   index.tmpl.html\n                   css/\n                       index.css\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>r.LoadHTMLFiles(\"../templates/index.tmpl.html\")\n\nr.GET(\"/index\", func(c *gin.Context) {\n    c.HTML(200, \"index.tmpl.html\", gin.H{\n        \"title\": \"Main website\", //IGNORE THIS\n    })\n})\n</code></pre>\n\n<p>index.tmpl.html</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;head&gt;\n  &lt;title&gt;Hola titulo&lt;/title&gt;\n  &lt;style type=\"text/css\" media=\"screen\"&gt;\n    &lt;!-- \n        @import url(\"/css/index.css\");\n    --&gt;\n  &lt;/style&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n  &lt;header&gt;\n    &lt;h1&gt;City Gallery&lt;/h1&gt;\n  &lt;/header&gt;\n\n  &lt;nav&gt;\n    London&lt;br&gt;\n    Paris&lt;br&gt;\n    Tokyo\n  &lt;/nav&gt;\n\n  &lt;section&gt;\n    &lt;h1&gt;London&lt;/h1&gt;\n    &lt;p&gt;London is the capital city of England. It is the most populous city in the United Kingdom,\nwith a metropolitan area of over 13 million inhabitants.&lt;/p&gt;\n    &lt;p&gt;Standing on the River Thames, London has been a major settlement for two millennia,\nits history going back to its founding by the Romans, who named it Londinium.&lt;/p&gt;\n  &lt;/section&gt;\n\n  &lt;footer&gt;\n    Copyright \u00a9 W3Schools.com\n  &lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>index.css</p>\n\n<pre><code>header {\n   background-color:black;\n   color:white;\n   text-align:center;\n   padding:5px; \n}\nnav {\n   line-height:30px;\n   background-color:#eeeeee;\n   height:300px;\n   width:100px;\n   float:left;\n   padding:5px; \n}\nsection {\n   width:350px;\n   float:left;\n   padding:10px; \n}\nfooter {\n   background-color:black;\n   color:white;\n   clear:both;\n   text-align:center;\n   padding:5px; \n}\n</code></pre>\n\n<p>So, I am runnning my app and this give me error 404 in Gin mode debug.</p>\n\n<pre><code>[GIN] 2016/03/26 - 12:10:50 | 200 |     688.938\u00b5s | 127.0.0.1 |   GET     /index\n[GIN] 2016/03/26 - 12:10:50 | 404 |       2.865\u00b5s | 127.0.0.1 |   GET     /css/index.css\n</code></pre>\n\n<p>On the other hand when I load html file only, this shows the stylesheet without problems. :(</p>\n\n<p>I do not know how to load the stylesheet with Gin.</p>\n\n<p>Help, please.</p>\n\n<p>PS: I need use Gin</p>\n"}, {"tags": ["go", "jwt", "jwt-go"], "comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1503729254, "post_id": 36236109, "comment_id": 78744349, "body": "The code example using a Claims map doesn&#39;t work. The API may have changed in the mean time."}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1503861490, "post_id": 36236109, "comment_id": 78775619, "body": "I have no idea honestly :/ I did long time ago and today I changed of work so.. :/"}, {"owner": {"reputation": 37028, "user_id": 59198, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6448b40e7037dd0fda767f2370c31809?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/59198/chris"}, "edited": false, "score": 0, "creation_date": 1559086543, "post_id": 36236109, "comment_id": 99307517, "body": "Storing the password in the token claims is not recommended, the token cookie isn&#39;t encrypted, the user can read it"}], "answers": [{"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 1, "creation_date": 1499367538, "post_id": 36236645, "comment_id": 76889267, "body": "After jwt-go this solution is broken. Please update the answer."}], "tags": [], "owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "is_accepted": true, "score": 28, "last_activity_date": 1533632607, "last_edit_date": 1533632607, "creation_date": 1459003527, "answer_id": 36236645, "question_id": 36236109, "link": "https://stackoverflow.com/questions/36236109/go-and-jwt-simple-authentication/36236645#36236645", "title": "Go and JWT - Simple authentication", "body": "<p>To start, you need to import a JWT library in Golang (go get github.com/dgrijalva/jwt-go). You can find that library documentation in below link.</p>\n\n<p><a href=\"https://github.com/dgrijalva/jwt-go\" rel=\"noreferrer\">https://github.com/dgrijalva/jwt-go</a></p>\n\n<p>Firstly, you need to create a token</p>\n\n<pre><code>// Create the token\ntoken := jwt.New(jwt.SigningMethodHS256)\n// Set some claims\ntoken.Claims[\"foo\"] = \"bar\"\ntoken.Claims[\"exp\"] = time.Now().Add(time.Hour * 72).Unix()\n// Sign and get the complete encoded token as a string\ntokenString, err := token.SignedString(mySigningKey)\n</code></pre>\n\n<p>Secondly, parse that token</p>\n\n<pre><code>token, err := jwt.Parse(myToken, func(token *jwt.Token) (interface{}, error) {\n    // Don't forget to validate the alg is what you expect:\n    if _, ok := token.Method.(*jwt.SigningMethodRSA); !ok {\n        return nil, fmt.Errorf(\"Unexpected signing method: %v\", token.Header[\"alg\"])\n    }\n    return myLookupKey(token.Header[\"kid\"]), nil\n})\n\nif err == nil &amp;&amp; token.Valid {\n    deliverGoodness(\"!\")\n} else {\n    deliverUtterRejection(\":(\")\n}\n</code></pre>\n\n<p>Also, there are some examples for use JWT in GOlang like this <a href=\"https://github.com/slok/go-jwt-example\" rel=\"noreferrer\">https://github.com/slok/go-jwt-example</a></p>\n\n<p>EDIT-1</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"github.com/dgrijalva/jwt-go\"\n)\n\nconst (\n    mySigningKey = \"WOW,MuchShibe,ToDogge\"\n)\n\nfunc main() {\n    createdToken, err := ExampleNew([]byte(mySigningKey))\n    if err != nil {\n        fmt.Println(\"Creating token failed\")\n    }\n    ExampleParse(createdToken, mySigningKey)\n}\n\nfunc ExampleNew(mySigningKey []byte) (string, error) {\n    // Create the token\n    token := jwt.New(jwt.SigningMethodHS256)\n    // Set some claims\n    token.Claims[\"foo\"] = \"bar\"\n    token.Claims[\"exp\"] = time.Now().Add(time.Hour * 72).Unix()\n    // Sign and get the complete encoded token as a string\n    tokenString, err := token.SignedString(mySigningKey)\n    return tokenString, err\n}\n\nfunc ExampleParse(myToken string, myKey string) {\n    token, err := jwt.Parse(myToken, func(token *jwt.Token) (interface{}, error) {\n        return []byte(myKey), nil\n    })\n\n    if err == nil &amp;&amp; token.Valid {\n        fmt.Println(\"Your token is valid.  I like your style.\")\n    } else {\n        fmt.Println(\"This token is terrible!  I cannot accept this.\")\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 566, "user_id": 1093531, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/9KfvG.jpg?s=128&g=1", "display_name": "Paval", "link": "https://stackoverflow.com/users/1093531/paval"}, "is_accepted": false, "score": 10, "last_activity_date": 1600048819, "last_edit_date": 1600048819, "creation_date": 1522398333, "answer_id": 49570977, "question_id": 36236109, "link": "https://stackoverflow.com/questions/36236109/go-and-jwt-simple-authentication/49570977#49570977", "title": "Go and JWT - Simple authentication", "body": "<p>Just to make update of @massoud-afrashteh answer.\nIn version 3 of jwt-go setting clams should be</p>\n<pre><code>// Set some claims\nclaims := make(jwt.MapClaims)\nclaims[&quot;foo&quot;] = &quot;bar&quot;\nclaims[&quot;exp&quot;] = time.Now().Add(time.Hour * 72).Unix()\ntoken.Claims = claims\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 448, "user_id": 4710305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9qJQI.jpg?s=128&g=1", "display_name": "icaksama", "link": "https://stackoverflow.com/users/4710305/icaksama"}, "is_accepted": false, "score": 4, "last_activity_date": 1544819983, "last_edit_date": 1544819983, "creation_date": 1544817625, "answer_id": 53786207, "question_id": 36236109, "link": "https://stackoverflow.com/questions/36236109/go-and-jwt-simple-authentication/53786207#53786207", "title": "Go and JWT - Simple authentication", "body": "<p>Don't forget to run the command <code>go get github.com/dgrijalva/jwt-go</code>.</p>\n\n<p>Another way to create more simple:</p>\n\n<pre><code>token := jwt.NewWithClaims(jwt.SigningMethodHS256, jwt.MapClaims{\n   \"foo\": \"bar\",\n   \"nbf\": time.Date(2015, 10, 10, 12, 0, 0, 0, time.UTC).Unix(),\n})\ntokenString, err := token.SignedString([]byte(\"your key\"))\nfmt.Println(tokenString, err)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "is_accepted": false, "score": 1, "last_activity_date": 1545909968, "last_edit_date": 1545909968, "creation_date": 1545909837, "answer_id": 53944259, "question_id": 36236109, "link": "https://stackoverflow.com/questions/36236109/go-and-jwt-simple-authentication/53944259#53944259", "title": "Go and JWT - Simple authentication", "body": "<pre><code>func GenerateToken(mySigningKey []byte, username string) (string, error) {\n    // Create the token\n    token := jwt.New(jwt.SigningMethodRS512)\n    claims := make(jwt.MapClaims)\n    claims[collections.PARAM_USER_NAME] = username\n    claims[\"exp\"] = time.Now().Add(time.Hour * 72).Unix()\n    token.Claims = claims\n    return token.SignedString(mySigningKey)\n}\n</code></pre>\n"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22140, "favorite_count": 14, "accepted_answer_id": 36236645, "answer_count": 4, "score": 24, "last_activity_date": 1600048819, "creation_date": 1459000598, "last_edit_date": 1588055956, "question_id": 36236109, "link": "https://stackoverflow.com/questions/36236109/go-and-jwt-simple-authentication", "title": "Go and JWT - Simple authentication", "body": "<p>I'm currently making an API (with go) and I'm working on the session part.\nAfter research about  what to use for session, I found JWT really interesting.</p>\n\n<p>However I'm not really sure to understand how to use it after some tutorials.\nSo this is my idea:</p>\n\n<pre><code>func main() {\n\n    router := mux.NewRouter().StrictSlash(true)\n\n    router.HandleFunc(\"/login\", login)\n    router.HandleFunc(\"/logout\", logout)\n    router.HandleFunc(\"/register\", register)\n\n    http.ListenAndServe(\":8080\", router)\n\n }\n</code></pre>\n\n<p>After those  requests handled, I create the differents functions.</p>\n\n<pre><code>func login(w http.ResponseWriter, r *http.Request) {\n    /*                                                                                                                                                                                                   \n    Here I just have to search in my database (SQL, I know how to do it). If the user is registered, I create a token and give it to him, but how can I do it?                                           \n    */\n }\n\n func logout(w http.ResponseWriter, r *http.Request) {\n    /*                                                                                                                                                                                                   \n    I get a token and stop/delete it?                                                                                                                                                                    \n    */\n }\n\n func register(w http.ResponseWriter, r *http.Request) {\n    /*                                                                                                                                                                                                   \n    I search if the user isn't register and then, if it isn't, I create a user in the database (I know how to do it). I connect him but again, how to make a new token?                                  \n    */\n }\n</code></pre>\n\n<p>Lot of tutorials on the web seems really hard but I just want something simple. I just want an handle package (code above) which work with a service package to have something like an engine token authentication.</p>\n\n<p>A second point I'm not sure to understand is the saving of the token.\nIf a user connects himself, then what would be best? Each time the user runs their app, the app connects itself and get a new token from saved information (user/password) or the app just save the token forever? And what about the server, is the token managed and saved automatically with JWT or do I have to put it in my sql database?</p>\n\n<p>Thank for your help !</p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>Thank you ! So after I read your answer, I encapsulated my code (token.go) like it</p>\n\n<pre><code>package services\n\nimport (\n    \"fmt\"\n    \"github.com/dgrijalva/jwt-go\"\n    \"time\"\n    \"../models\"\n)\n\nvar tokenEncodeString string = \"something\"\n\nfunc createToken(user models.User) (string, error) {\n    // create the token                                                                                                                                                                                  \n    token := jwt.New(jwt.SigningMethodHS256)\n\n    // set some claims                                                                                                                                                                                   \n    token.Claims[\"username\"] = user.Username;\n    token.Claims[\"password\"] = user.Password;\n    token.Claims[\"exp\"] = time.Now().Add(time.Hour * 72).Unix()\n\n    //Sign and get the complete encoded token as string                                                                                                                                                  \n    return (token.SignedString(tokenEncodeString))\n}\n\nfunc parseToken(unparsedToken string) (bool, string) {\n    token, err := jwt.Parse(unparsedToken, func(token *jwt.Token) (interface{}, error) {\n            // Don't forget to validate the alg is what you expect:                                                                                                                                      \n            if _, ok := token.Method.(*jwt.SigningMethodRSA); !ok {\n                    return nil, fmt.Errorf(\"Unexpected signing method: %v\", token.Header[\"alg\"])\n            }\n            return myLookupKey(token.Header[\"kid\"]), nil\n    })\n\n    if err == nil &amp;&amp; token.Valid {\n            return true, unparsedToken\n    } else {\n            return false, \"\"\n    }\n }\n</code></pre>\n\n<p>However, I got the following error: \"token.go: undefined: myLookupKey\"\nI looked on internet and I found an encapsulated function which have this prototype:</p>\n\n<pre><code>func ExampleParse(myToken string, myLookupKey func(interface{}) (interface{}, error)) {\n /* same code in my func parseToken() */\n}\n</code></pre>\n\n<p>So what are the difference between my function and this one? How can I use this one?</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2446, "user_id": 643951, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/28af467eb309ca3d12cec68ace7b3f05?s=128&d=identicon&r=PG", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/643951/ruslan"}, "edited": false, "score": 0, "creation_date": 1458976104, "post_id": 36232625, "comment_id": 60096082, "body": "Have you tried <code>os.Mkdir(&quot;&#47;Users&#47;anonrose&#47;Documents&#47;goCode&#47;src&#47;github.com&#47;an&zwnj;&#8203;onrose&#47;GoDataStructs&zwnj;&#8203;&#47;tests&#47;myWebsite&quot;, int(0777))</code>?"}, {"owner": {"reputation": 163028, "user_id": 477878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qounX.jpg?s=128&g=1", "display_name": "Joachim Isaksson", "link": "https://stackoverflow.com/users/477878/joachim-isaksson"}, "edited": false, "score": 0, "creation_date": 1458976351, "post_id": 36232625, "comment_id": 60096130, "body": "Note the leading 0 in <code>0777</code> to make the value octal, just <code>777</code> will give strange permissions."}, {"owner": {"reputation": 911, "user_id": 4728636, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yQ2Rl.jpg?s=128&g=1", "display_name": "anonrose", "link": "https://stackoverflow.com/users/4728636/anonrose"}, "reply_to_user": {"reputation": 163028, "user_id": 477878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qounX.jpg?s=128&g=1", "display_name": "Joachim Isaksson", "link": "https://stackoverflow.com/users/477878/joachim-isaksson"}, "edited": false, "score": 0, "creation_date": 1458976654, "post_id": 36232625, "comment_id": 60096186, "body": "@JoachimIsaksson that didn&#39;t but I just used <code>os.ModePerm</code> which is of type FileMode so that got it done. Thank you."}, {"owner": {"reputation": 367, "user_id": 6091069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6438d90b6a57c9f345cf9da730603576?s=128&d=identicon&r=PG&f=1", "display_name": "Hang", "link": "https://stackoverflow.com/users/6091069/hang"}, "edited": false, "score": 0, "creation_date": 1458977859, "post_id": 36232625, "comment_id": 60096443, "body": "Seems like a duplicated question of <a href=\"http://stackoverflow.com/questions/14249467/os-mkdir-and-os-mkdirall-permission-value\">os.MkDir and os.MkDirAll permission value?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 10, "last_activity_date": 1458976961, "creation_date": 1458976961, "answer_id": 36232748, "question_id": 36232625, "link": "https://stackoverflow.com/questions/36232625/how-to-make-a-directory-in-golang/36232748#36232748", "title": "How to make a directory in Golang?", "body": "<p>If you need to set explicit permission bits not listed <a href=\"https://golang.org/pkg/os/#FileMode\" rel=\"noreferrer\">here</a> then use <code>os.FileMode</code></p>\n\n<pre><code>os.Mkdir(\"/path/to/dir\", os.FileMode(0522))\n</code></pre>\n\n<p>The least significant 9 bits of the uint32 represent the file permissions, so 0777 would be 511 for example.</p>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 1, "last_activity_date": 1611428405, "creation_date": 1611428405, "answer_id": 65863237, "question_id": 36232625, "link": "https://stackoverflow.com/questions/36232625/how-to-make-a-directory-in-golang/65863237#65863237", "title": "How to make a directory in Golang?", "body": "<p>I always use <a href=\"//golang.org/pkg/os#ModeDir\" rel=\"nofollow noreferrer\">os.ModeDir</a>:</p>\n<pre><code>package main\nimport &quot;os&quot;\n\nfunc main() {\n   os.Mkdir(&quot;March&quot;, os.ModeDir)\n}\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 4728636, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yQ2Rl.jpg?s=128&g=1", "display_name": "anonrose", "link": "https://stackoverflow.com/users/4728636/anonrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5900, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1611428405, "creation_date": 1458975815, "question_id": 36232625, "link": "https://stackoverflow.com/questions/36232625/how-to-make-a-directory-in-golang", "title": "How to make a directory in Golang?", "body": "<p>So I'm attempting to create a CMS where each user makes their own website and it is stored in a directory named as their choosing. However when I use </p>\n\n<pre><code>os.Mkdir(\"/Users/anonrose/Documents/goCode/src/github.com/anonrose/GoDataStructs/tests/myWebsite\", os.\"some permission\")\n</code></pre>\n\n<p>the \"some permission\" part is what I'm having troubles with. When I attempt to access the directory once it's been created I never have the correct permission. Is there a <code>os.FileMode</code> that I can use to set the permissions as read and write for anyone when I go to create the directory.</p>\n"}, {"tags": ["go", "tcp"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 3, "creation_date": 1458971046, "post_id": 36231968, "comment_id": 60094995, "body": "It should work, but it isn&#39;t necessary. The way to maximize <code>accept()</code> speed is to do nothing else in the loop except accept connections and start threads. Specifically, don&#39;t do any I/O, and that includes anything that could require a DNS lookup. But <code>accept()</code> speed isn&#39;t an important aspect of server performance, unless you&#39;ve broken this rule against I/O."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458971827, "post_id": 36231968, "comment_id": 60095147, "body": "Thanks; I&#39;m already doing something similar; sending accepted connections to a channel and some acceptors (number of cores) are handling that channel. And it&#39;s good. But the documentation of <code>Accept()</code> does not say anything if it&#39;s safe to get called concurrently (and I went through the source code and it seems safe; but I did not understand it completely)."}], "answers": [{"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1458988016, "post_id": 36234170, "comment_id": 60099006, "body": "Disclaimer: I&#39;m not a Go&#39;s author, just investigate sources."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 4, "last_activity_date": 1458987807, "creation_date": 1458987807, "answer_id": 36234170, "question_id": 36231968, "link": "https://stackoverflow.com/questions/36231968/calling-listener-accept-concurrently/36234170#36234170", "title": "Calling listener.Accept() Concurrently", "body": "<p>net.Listener is a FileDescriptor under the hood. Accept() use Plan9 machinery which guards it with readLock while function and produce connection - newFD. So it looks safe. And because of Lock is read only, no exclusive, you even can get some speedup calling accept concurrently to my mind.</p>\n"}], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 36234170, "answer_count": 1, "score": 1, "last_activity_date": 1458987807, "creation_date": 1458970473, "question_id": 36231968, "link": "https://stackoverflow.com/questions/36231968/calling-listener-accept-concurrently", "title": "Calling listener.Accept() Concurrently", "body": "<p>Assuming we are listening on a TCP port (using <code>listener, err := net.Listen(\"tcp\", \":8081\")</code> for example), is it OK to call <code>listener.Accept()</code> in different goroutines concurrently? Does it help with maximizing accepting speed?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1458963161, "last_edit_date": 1458963161, "creation_date": 1458961006, "answer_id": 36231133, "question_id": 36231049, "link": "https://stackoverflow.com/questions/36231049/why-does-printing-out-max-int-cause-compile-error-in-golang/36231133#36231133", "title": "Why does printing out max int cause compile error in golang?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Constants\" rel=\"noreferrer\">Constants</a></p>\n  \n  <p>An untyped constant has a default type which is the type to which the\n  constant is implicitly converted in contexts where a typed value is\n  required. The default type of an untyped constant is bool, rune, int,\n  float64, complex128 or string respectively, depending on whether it is\n  a boolean, rune, integer, floating-point, complex, or string constant.</p>\n</blockquote>\n\n<pre><code>func Println(a ...interface{}) (n int, err error)\n\nfmt.Println(math.MaxUint32)\n</code></pre>\n\n<p><code>math.MaxUint32</code> is an untyped integer constant that defaults to type <code>int</code> in this context, an untyped integer constant argument for a type <code>interface{}</code> parameter.</p>\n\n<p><code>int</code> is a signed 32- or 64-bit integer depending on the implementation.</p>\n\n<pre><code>const (\n    MaxInt32  = 1&lt;&lt;31 - 1\n    MaxUint32 = 1&lt;&lt;32 - 1\n)\n</code></pre>\n\n<p><code>MaxUint32</code> is greater than <code>MaxInt32</code>.</p>\n\n<p>if you run <code>go env</code> you should see that you are using a 32-bit architecture, for example, <code>GOARCH=\"386\"</code>.</p>\n\n<p>Don't accept the default 32-bit <code>int</code> type. Use a compatible type conversion. For example, write </p>\n\n<pre><code>fmt.Println(uint32(math.MaxUint32))\n</code></pre>\n"}], "owner": {"reputation": 1819, "user_id": 4379891, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/00537a374fd78cbd4f92745dbb2ee0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4379891/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 1, "accepted_answer_id": 36231133, "answer_count": 1, "score": 5, "last_activity_date": 1458963161, "creation_date": 1458960142, "question_id": 36231049, "link": "https://stackoverflow.com/questions/36231049/why-does-printing-out-max-int-cause-compile-error-in-golang", "title": "Why does printing out max int cause compile error in golang?", "body": "<p>Here is a link to <a href=\"https://play.golang.org/p/hlnsxqg9Dt\" rel=\"noreferrer\">go playground</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    fmt.Println(math.MaxUint32)\n}\n</code></pre>\n\n<p>The above code seems to cause</p>\n\n<pre><code>constant 4294967295 overflows int\n</code></pre>\n\n<p>does <code>fmt.Println</code> convert every number to int automatically?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1458956633, "post_id": 36230674, "comment_id": 60092459, "body": "Is <code>EnvAssert</code> a wrapper around <code>assert</code>? If so, maybe an assertion is failing and generating a signal?"}, {"owner": {"reputation": 525, "user_id": 3389355, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/21c34d3d1de9b87b7debf3456741116a?s=128&d=identicon&r=PG&f=1", "display_name": "wmaxlees", "link": "https://stackoverflow.com/users/3389355/wmaxlees"}, "reply_to_user": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 0, "creation_date": 1458956799, "post_id": 36230674, "comment_id": 60092492, "body": "EnvAssert is a CLIPS function too. It asserts a fact in the rule based system. It&#39;s not related to unit testing asserts or anything like that."}], "owner": {"reputation": 525, "user_id": 3389355, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/21c34d3d1de9b87b7debf3456741116a?s=128&d=identicon&r=PG&f=1", "display_name": "wmaxlees", "link": "https://stackoverflow.com/users/3389355/wmaxlees"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458956389, "creation_date": 1458956389, "question_id": 36230674, "link": "https://stackoverflow.com/questions/36230674/cgo-unexpected-signal-during-runtime", "title": "CGo: Unexpected Signal During Runtime", "body": "<p>I am attempting to write a Go function that sends a string to a C function as a C.CString.</p>\n\n<pre><code>func AssertString(fact string) {\n    // sbytes := []byte(fact)\n    // ccp := (*C.char)(unsafe.Pointer(&amp;sbytes[0]))\n    ccp := C.CString(fact)\n\n    C.EnvAssertString(C.env, ccp)\n}\n</code></pre>\n\n<p>I tried both the commented out section and the currently used section and I get the following</p>\n\n<pre><code>fatal error: unexpected signal during runtime execution\n[signal 0xb code=0x1 addr=0x30 pc=0x7431a9]\n</code></pre>\n\n<p>The C function EnvAssertString comes from the CLIPS Expert System library and looks like this:</p>\n\n<pre><code>globle void *EnvAssertString(void *theEnv, const char *theString)\n  {\n   struct fact *theFact;\n   int danglingConstructs;\n   danglingConstructs = ConstructData(theEnv)-&gt;DanglingConstructs;\n\n   if ((theFact = StringToFact(theEnv,theString)) == NULL) return(NULL);\n\n   if ((! CommandLineData(theEnv)-&gt;EvaluatingTopLevelCommand) &amp;&amp;\n       (EvaluationData(theEnv)-&gt;CurrentExpression == NULL))\n     { ConstructData(theEnv)-&gt;DanglingConstructs = danglingConstructs; }\n\n   return((void *) EnvAssert(theEnv,(void *) theFact));\n  }\n</code></pre>\n\n<p>I am assuming it is how the Go generated char pointer is used but I'm not exactly sure. Anyone got some ideas?</p>\n"}, {"tags": ["http", "go", "go-templates"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459032472, "post_id": 36229031, "comment_id": 60113854, "body": "Use absolute paths and avoid the problems."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1459121750, "post_id": 36229031, "comment_id": 60137570, "body": "@elithrar example?"}], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1458959796, "post_id": 36229562, "comment_id": 60093068, "body": "What if I want to use a folder of a different name? say point the request toward <code>..&#47;..&#47;app_assets</code> or something like that? I updated the question so you can see what I mean."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459128882, "post_id": 36229562, "comment_id": 60139048, "body": "Still does not work. Getting this error: <code>Uncaught SyntaxError: Unexpected token &lt;</code>"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459129725, "post_id": 36229562, "comment_id": 60139210, "body": "@dopatraman, thats because your <code>src</code> attribute is <code>src=&quot;assets&#47;js&#47;libs.js&quot;</code>. It should be <code>src=&quot;&#47;assets&#47;js&#47;libs.js&quot;</code>. With a <code>&#47;</code> infront. See my answer."}], "tags": [], "owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "is_accepted": false, "score": 0, "last_activity_date": 1458969122, "last_edit_date": 1458969122, "creation_date": 1458947604, "answer_id": 36229562, "question_id": 36229031, "link": "https://stackoverflow.com/questions/36229031/redirect-requests-for-static-files/36229562#36229562", "title": "Redirect requests for static files", "body": "<p>So I know it's a bit confusing, but you want to change <code>fs := http.FileServer(http.Dir(\"../../assets/\"))</code> to be <code>fs := http.FileServer(http.Dir(\"../..\"))</code></p>\n\n<p>The reason is that the path for \"assets\" is already specified in the request so as you have it, it is really pointing to ../../assets/assets/*</p>\n\n<p>Hope that helps!</p>\n\n<p>oh and just to prevent another error, that Handle() functions should be written with a trailing slash in the path. I almost forgot to catch that.</p>\n\n<p>EDIT</p>\n\n<p>To adjust my answer for your other need (using some sort of redirect) you'd have to use the <code>http.StripPrefix</code> handler <a href=\"https://golang.org/pkg/net/http/#StripPrefix\" rel=\"nofollow\">https://golang.org/pkg/net/http/#StripPrefix</a></p>\n\n<p>For your use case you would prepare your server with the following code:</p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"../../app_assets\"))\nhttp.Handle(\"/assets/\", http.StripPrefix(\"/assets/\", fs))\n</code></pre>\n\n<p>This lets you do url rewrites for file system serving.</p>\n"}, {"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1458970184, "post_id": 36231717, "comment_id": 60094830, "body": "But if the <code>src</code> attribute does not point to <code>&#47;assets&#47;*</code> the route handler set in the server will not be hit right?"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1458970283, "post_id": 36231717, "comment_id": 60094848, "body": "Ah. Right! Use StripPrefix."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1459129789, "post_id": 36231717, "comment_id": 60139221, "body": "I don&#39;t get the downvote :( specially after I corrected my mistake. The rest of the answer should be quite useful to OP."}, {"owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "edited": false, "score": 1, "creation_date": 1459135336, "post_id": 36231717, "comment_id": 60140357, "body": "I got downvoted too. However I will upvote yours because it is entirely correct and any little errors like using the wrong asset src url are unrelated to the question, which was to show how to do redirects when using FS servers. Golang dev, man haha"}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 0, "last_activity_date": 1459132234, "last_edit_date": 1459132234, "creation_date": 1458967621, "answer_id": 36231717, "question_id": 36229031, "link": "https://stackoverflow.com/questions/36229031/redirect-requests-for-static-files/36231717#36231717", "title": "Redirect requests for static files", "body": "<p>In your html when you specify the <code>src</code> attributes of your css and js you have <code>src=\"assets/js/libs.js\"</code>. This makes those files to be requested relative to the current path. So the request goes to <code>http://localhost:8000/static/assets/js/libs.js</code>.</p>\n\n<p>Since this has the <code>/static</code> prefix it will be handled by your <code>/static</code> handler and hence the html file is served.</p>\n\n<p>To make it go to <code>/assets</code> handler, specify the <code>src</code> with a <code>/</code> prefixed.</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"/assets/js/libs.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Now the server will look for the file at <code>../../app_assets/assets/js/libs.js</code>.</p>\n\n<p>If you want it to be <code>../../app_assets/js/libs.js</code>, you can use <a href=\"https://golang.org/pkg/net/http/#StripPrefix\" rel=\"nofollow\">StripPrefix</a> to take out the <code>assets</code> part from the url in the server.</p>\n\n<pre><code>fs := http.StripPrefix(\"/assets/\", http.FileServer(http.Dir(\"../../app_assets/\")))\nhttp.Handle(\"/assets/\", fs)\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1682, "favorite_count": 0, "accepted_answer_id": 36231717, "answer_count": 2, "score": 0, "last_activity_date": 1459132234, "creation_date": 1458944674, "last_edit_date": 1592644375, "question_id": 36229031, "link": "https://stackoverflow.com/questions/36229031/redirect-requests-for-static-files", "title": "Redirect requests for static files", "body": "<p>I'm trying to serve a static html file, and this file has script tags that point to other resources. I want to serve the html file from one directory but then redirect requests for assets to another directory. This is how I'm setting it up now:</p>\n<pre><code>// server.go\nimport (\n    &quot;fmt&quot;\n    &quot;html/template&quot;\n    &quot;log&quot;\n    &quot;net/http&quot;\n    &quot;path&quot;\n    &quot;time&quot;\n)\n\nfunc handle(w http.ResponseWriter, r *http.Request) {\n    lp := path.Join(&quot;./&quot;, &quot;index.html&quot;)\n    fmt.Println(lp)\n    tmpl, err := template.ParseFiles(lp)\n    if err != nil {\n        log.Fatal(err)\n    }\n    tmpl.ExecuteTemplate(w, &quot;index&quot;, nil)\n}\n\nfunc main() {\n    fs := http.FileServer(http.Dir(&quot;../../app_assets/&quot;))\n    http.Handle(&quot;/assets&quot;, fs)\n    http.HandleFunc(&quot;/static/&quot;, handle)\n\n    fmt.Println(&quot;Go Server listening on port 8000&quot;)\n    http.ListenAndServe(&quot;:8000&quot;, nil)\n}\n</code></pre>\n<p>Here is my template:</p>\n<pre><code>&lt;!-- index.html --&gt;\n{{define &quot;index&quot;}}\n&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta charset=&quot;utf-8&quot; /&gt;\n&lt;link rel=&quot;stylesheet&quot; href=&quot;assets/css/libs.css&quot; type=&quot;text/css&quot; /&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;assets/js/libs.js&quot;&gt;&lt;/script&gt;\n\n&lt;h1&gt; Hello &lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n<p>I'm able to serve the index file from <code>localhost:8000/static/</code>, but asset requests are not going to the assets folder two levels up (<code>../../</code>). What am I doing wrong?</p>\n<h1>NOTE:</h1>\n<p>I'm getting this error in the console when libs.js is loaded:</p>\n<pre><code>Uncaught SyntaxError: Unexpected token &lt;\n</code></pre>\n<p>This leads me to believe that the request for the <code>libs.js</code> file is being redirected to the html markup.</p>\n<p>How is this happening?</p>\n<h1>NOTE 2:</h1>\n<p>When I browse the result of the request for <code>libs.js</code>, I see the html markup. Even after using <code>StripPrefix</code> as advised below. What am I doing wrong?</p>\n"}, {"tags": ["xml", "go", "concurrency", "goroutine", "bzip2"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 4036216, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-4RroqJIq9MU/AAAAAAAAAAI/AAAAAAAAADY/_-detm33zJU/photo.jpg?sz=128", "display_name": "Manuel Menzella", "link": "https://stackoverflow.com/users/4036216/manuel-menzella"}, "edited": false, "score": 1, "creation_date": 1458984467, "post_id": 36229262, "comment_id": 60097958, "body": "This is exactly what I needed, thanks! Unfortunately, it seems the performance of the stardard lib bzip2 decompressor is not great, so it is still the limiting factor. I may switch to this compressor: <a href=\"https://godoc.org/github.com/dsnet/compress/bzip2\" rel=\"nofollow noreferrer\">godoc.org/github.com/dsnet/compress/bzip2</a> However, it is still about 33% slower than something like pbzip2."}, {"owner": {"reputation": 4209, "user_id": 1536933, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/82c7c848bf6dd69af2749fc4acf885e3?s=128&d=identicon&r=PG", "display_name": "EM0", "link": "https://stackoverflow.com/users/1536933/em0"}, "reply_to_user": {"reputation": 387, "user_id": 4036216, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-4RroqJIq9MU/AAAAAAAAAAI/AAAAAAAAADY/_-detm33zJU/photo.jpg?sz=128", "display_name": "Manuel Menzella", "link": "https://stackoverflow.com/users/4036216/manuel-menzella"}, "edited": false, "score": 0, "creation_date": 1499890043, "post_id": 36229262, "comment_id": 77106574, "body": "How much of a speed-up did you get in the end, @ManuelMenzella? I like the look of this code - it seems like it should work, but in my testing it&#39;s only marginally faster than doing everything single-threaded (67 sec vs 72 sec on 1M records). Any idea what I could be doing wrong, @user1431317?"}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1499963043, "post_id": 36229262, "comment_id": 77144900, "body": "Maybe it&#39;s still limited by how fast the bzip2 decompression can feed it data, and the xml decoding isn&#39;t taking up that much cpu power. The pipe probably adds some overhead, although io.Copy does have optimizations for when one or both ends are io.Reader/io.Writer. It&#39;s possible that it&#39;s allocating a lot of small temporary buffers, and that that&#39;s causing too much garbage. Maybe a buffered reader or writer would help. You should profile your app (both cpu and mem profile - mem profile can help you find lots of unnecessary allocations)."}, {"owner": {"reputation": 4209, "user_id": 1536933, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/82c7c848bf6dd69af2749fc4acf885e3?s=128&d=identicon&r=PG", "display_name": "EM0", "link": "https://stackoverflow.com/users/1536933/em0"}, "edited": false, "score": 0, "creation_date": 1499973407, "post_id": 36229262, "comment_id": 77150976, "body": "The bzip2 decompressor and parser take about the same amount of time - I tested that by running them separately. I&#39;ve also tried buffering everything imaginable and it hasn&#39;t helped. Well, everything except the io.Pipe and I suspect this <i>could</i> be the problem. I&#39;ve posted a separate question about that: <a href=\"https://stackoverflow.com/questions/45089248/buffered-version-of-go-io-pipe\" title=\"buffered version of go io pipe\">stackoverflow.com/questions/45089248/&hellip;</a>"}, {"owner": {"reputation": 4209, "user_id": 1536933, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/82c7c848bf6dd69af2749fc4acf885e3?s=128&d=identicon&r=PG", "display_name": "EM0", "link": "https://stackoverflow.com/users/1536933/em0"}, "edited": false, "score": 0, "creation_date": 1499976499, "post_id": 36229262, "comment_id": 77152515, "body": "Buffering the PipeReader and PipeWriter didn&#39;t help, either. Hmm... Have you (or has anyone else) tried this and found a significant speed-up over the single-threaded version?"}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1499981051, "post_id": 36229262, "comment_id": 77154840, "body": "io.Copy actually uses a 32k buffer. Until that buffer is full, it will block waiting for the bzip2 reader. Perhaps the problem is that that buffer is too big. You want to feed the xml decoder with data as soon as it is available. Here&#39;s a simulated example that uses a tiny buffer and actually shows a large improvement: <a href=\"https://play.golang.org/p/lkwwBBR8jx\" rel=\"nofollow noreferrer\">play.golang.org/p/lkwwBBR8jx</a> Of course you don&#39;t want the buffer to be too small, because that adds too much overhead (switching between goroutines too often). The example uses a tiny json, so you&#39;ll have to tune the buffer size to your actual data."}, {"owner": {"reputation": 4209, "user_id": 1536933, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/82c7c848bf6dd69af2749fc4acf885e3?s=128&d=identicon&r=PG", "display_name": "EM0", "link": "https://stackoverflow.com/users/1536933/em0"}, "edited": false, "score": 0, "creation_date": 1500032046, "post_id": 36229262, "comment_id": 77174861, "body": "I tried that, but a smaller buffer makes it slower. 32K seems to be about optimal.  Interestingly, the standard library bzip2 package is slower then the dsnet one on a single thread, but faster when using 2 goroutines like this! The stdlib one takes 44.6 seconds single-threaded, 34.6 with goroutines. The dsnet one takes 40.7 seconds single-threaded, 38.6 with goroutines. (Tested this multiple times.)"}], "tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": false, "score": 2, "last_activity_date": 1458946310, "last_edit_date": 1458946310, "creation_date": 1458945969, "answer_id": 36229262, "question_id": 36228655, "link": "https://stackoverflow.com/questions/36228655/golang-decompress-bz2-in-on-goroutine-consume-in-other-goroutine/36229262#36229262", "title": "GoLang: Decompress bz2 in on goroutine, consume in other goroutine", "body": "<p>You can use <a href=\"https://golang.org/pkg/io/#Pipe\" rel=\"nofollow\">io.Pipe</a>, then use <a href=\"https://golang.org/pkg/io/#Copy\" rel=\"nofollow\">io.Copy</a> to push the decompressed data into the pipe, and read it in another goroutine:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io\"\n    \"sync\"\n)\n\nfunc main() {\n\n    rawJson := []byte(`{\n            \"Foo\": {\n                \"Bar\": \"Baz\"\n            }\n        }`)\n\n    bzip2Reader := bytes.NewReader(rawJson) // this stands in for the bzip2.NewReader\n\n    var wg sync.WaitGroup\n    wg.Add(2)\n\n    r, w := io.Pipe()\n\n    go func() {\n        // write everything into the pipe. Decompression happens in this goroutine.\n        io.Copy(w, bzip2Reader)\n        w.Close()\n        wg.Done()\n    }()\n\n    decoder := json.NewDecoder(r)\n\n    go func() {\n        for {\n            t, err := decoder.Token()\n            if err != nil {\n                break\n            }\n            fmt.Println(t)\n        }\n        wg.Done()\n    }()\n\n    wg.Wait()\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/fXLnfnaWYA\" rel=\"nofollow\">http://play.golang.org/p/fXLnfnaWYA</a></p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 681490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d799f1b0182ea8bfe5130b8e5e6092?s=128&d=identicon&r=PG", "display_name": "sh0dan", "link": "https://stackoverflow.com/users/681490/sh0dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1557561880, "creation_date": 1557561880, "answer_id": 56088419, "question_id": 36228655, "link": "https://stackoverflow.com/questions/36228655/golang-decompress-bz2-in-on-goroutine-consume-in-other-goroutine/56088419#56088419", "title": "GoLang: Decompress bz2 in on goroutine, consume in other goroutine", "body": "<p>An easy solution is to use a readahead package I created some time back: <a href=\"https://github.com/klauspost/readahead\" rel=\"nofollow noreferrer\">https://github.com/klauspost/readahead</a></p>\n\n<pre><code>inputReader := bzip2.NewReader(inputFile)\nra := readahead.NewReader(input)\ndefer ra.Close()\n</code></pre>\n\n<p>And then pass the reader to the XML parser:</p>\n\n<pre><code>decoder := xml.NewDecoder(ra)\n</code></pre>\n\n<p>With default settings it will decode up to 4MB ahead of time in 4 buffers.</p>\n"}], "owner": {"reputation": 387, "user_id": 4036216, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-4RroqJIq9MU/AAAAAAAAAAI/AAAAAAAAADY/_-detm33zJU/photo.jpg?sz=128", "display_name": "Manuel Menzella", "link": "https://stackoverflow.com/users/4036216/manuel-menzella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1557561880, "creation_date": 1458942816, "question_id": 36228655, "link": "https://stackoverflow.com/questions/36228655/golang-decompress-bz2-in-on-goroutine-consume-in-other-goroutine", "title": "GoLang: Decompress bz2 in on goroutine, consume in other goroutine", "body": "<p>I am a new-grad SWE learning Go (and loving it).</p>\n\n<p>I am building a parser for Wikipedia dump files - basically a huge bzip2-compressed XML file (~50GB uncompressed).</p>\n\n<p>I want to do both streaming decompression and parsing, which sounds simple enough. For decompression, I do:</p>\n\n<p><code>inputFilePath := flag.Arg(0)\ninputReader := bzip2.NewReader(inputFile)</code></p>\n\n<p>And then pass the reader to the XML parser:</p>\n\n<p><code>decoder := xml.NewDecoder(inputFile)</code></p>\n\n<p>However, since both decompressing and parsing are expensive operations, I would like to have them run on separate Go routines to make use of additional cores. How would I go about doing this in Go?</p>\n\n<p>The only thing I can think of is wrapping the file in a chan []byte, and implementing the io.Reader interface, but I presume there might be a built way (and cleaner) way of doing it.</p>\n\n<p>Has anyone ever done something like this?</p>\n\n<p>Thanks!\nManuel</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb"], "comments": [{"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 2, "creation_date": 1458941655, "post_id": 36228130, "comment_id": 60088039, "body": "You can use <code>ALL_NEW</code> or <code>UPDATED_NEW</code> to get the new values in Attributes."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "reply_to_user": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1458941799, "post_id": 36228130, "comment_id": 60088091, "body": "Will the result of <code>UPDATED_NEW</code> be empty if there was no update? Or does it return the current value after the operation regardless?"}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 4, "creation_date": 1458941853, "post_id": 36228130, "comment_id": 60088118, "body": "You&#39;ll have to try that yourself, but if the documentation is correct, the Attributes map should be empty in that case."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "reply_to_user": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1458941917, "post_id": 36228130, "comment_id": 60088140, "body": "Thanks! I can write tests for it so I&#39;ll see how it goes and report back."}, {"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "reply_to_user": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1460138308, "post_id": 36228130, "comment_id": 60619431, "body": "For reference I went with <code>UPDATED_NEW</code> and it&#39;s working as expected, although it turns out if the ConditionExpression fails then an error (ConditionalCheckFailedException) is returned so that&#39;s equally usable to determine whether or not there was an update."}], "answers": [{"tags": [], "owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "is_accepted": false, "score": 0, "last_activity_date": 1460170181, "creation_date": 1460170181, "answer_id": 36512168, "question_id": 36228130, "link": "https://stackoverflow.com/questions/36228130/dynamodb-updateitem-with-conditionexpression-return-whether-item-updated/36512168#36512168", "title": "dynamodb updateitem with conditionexpression return whether item updated", "body": "<p>Turns out what I wanted to do was check the error to see if it contained the string <code>ConditionalCheckFailedException</code>.</p>\n\n<pre><code>func Lock() (bool, error) {\n  ...\n  _, err := db.DynamoDB.UpdateItem(v)\n  if err != nil {\n    if strings.Contains(err.Error(), \"ConditionalCheckFailedException\") {\n      return false, nil\n    }\n    return false, err\n  }\n  return true, nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 350, "user_id": 1480906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f54b576c9d6c524b000b55114ac700b?s=128&d=identicon&r=PG", "display_name": "Andy McCall", "link": "https://stackoverflow.com/users/1480906/andy-mccall"}, "is_accepted": true, "score": 2, "last_activity_date": 1491780486, "last_edit_date": 1491780486, "creation_date": 1491780060, "answer_id": 43312951, "question_id": 36228130, "link": "https://stackoverflow.com/questions/36228130/dynamodb-updateitem-with-conditionexpression-return-whether-item-updated/43312951#43312951", "title": "dynamodb updateitem with conditionexpression return whether item updated", "body": "<p>One way to do this is to check the <code>Code</code> on the <code>awserr</code></p>\n\n<pre><code>import \"github.com/aws/aws-sdk-go/aws/awserr\"\nfunc Lock()(bool, error) {\n    //Create value v\n    _, err := db.DynamoDB.UpdateItem(v)\n    if err != nil {\n         if ae, ok := err.(awserr.RequestFailure); ok &amp;&amp; ae.Code() == \"ConditionalCheckFailedException\" {\n             return false, nil\n         }\n        return false, err\n    }\n    return true, nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3596, "user_id": 2443687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1da01ca60576663e27ab608fc4dbbbb2?s=128&d=identicon&r=PG", "display_name": "Carlos Martinez", "link": "https://stackoverflow.com/users/2443687/carlos-martinez"}, "is_accepted": false, "score": 1, "last_activity_date": 1607104903, "creation_date": 1607104903, "answer_id": 65148512, "question_id": 36228130, "link": "https://stackoverflow.com/questions/36228130/dynamodb-updateitem-with-conditionexpression-return-whether-item-updated/65148512#65148512", "title": "dynamodb updateitem with conditionexpression return whether item updated", "body": "<p>There are now constants to compare the errors rather than using the hardcoded string as in other answers:</p>\n<pre><code>result, err := svc.UpdateItem(input)\nif err != nil {\n    if aerr, ok := err.(awserr.Error); ok {\n        switch aerr.Code() {\n        case dynamodb.ErrCodeConditionalCheckFailedException:\n            fmt.Println(dynamodb.ErrCodeConditionalCheckFailedException, aerr.Error())\n        default:\n            fmt.Println(aerr.Error())\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4059, "favorite_count": 0, "accepted_answer_id": 43312951, "answer_count": 3, "score": 1, "last_activity_date": 1607104903, "creation_date": 1458940425, "question_id": 36228130, "link": "https://stackoverflow.com/questions/36228130/dynamodb-updateitem-with-conditionexpression-return-whether-item-updated", "title": "dynamodb updateitem with conditionexpression return whether item updated", "body": "<p>I would like to update an item under certain conditions and then I would like to know whether the item was updated when UpdateItem returns.</p>\n\n<p>The documentation seems contradictory to me. </p>\n\n<p>On this page: <a href=\"http://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_UpdateItem.html\" rel=\"nofollow\">http://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_UpdateItem.html</a> in the \"Conditional Update\" example it says \"All of the item's attributes, as they appear after the update, are returned in the response.\"</p>\n\n<p>On this page: <a href=\"https://godoc.org/github.com/aws/aws-sdk-go/service/dynamodb#UpdateItemOutput\" rel=\"nofollow\">https://godoc.org/github.com/aws/aws-sdk-go/service/dynamodb#UpdateItemOutput</a> it says that Attributes is \"A map of attribute values as they appeared before the UpdateItem operation\"</p>\n\n<p>I don't really want either of these. What I want is a bool that says whether or not there was an update.</p>\n\n<p>This is where my brain is at now:</p>\n\n<pre><code>out, err := db.DynamoDB.UpdateItem(&amp;dynamodb.UpdateItemInput{\n    TableName: tableName,\n    Key: map[string]*dynamodb.AttributeValue{\n        \"KeyName\": {S: aws.String(keyname)},\n    },\n    ExpressionAttributeNames: map[string]*string{\n        \"#lock\": aws.String(\"Lock\"),\n    },\n    ExpressionAttributeValues: map[string]*string{\n        \":now\":     aws.String(compfmt(time.Now())),\n        \":promise\": aws.String(compfmt(time.Now().Add(30 * time.Second))),\n    },\n    ConditionExpression: aws.String(\"attribute_not_exist(#lock) OR :now &gt; #lock\"),\n    UpdateExpression:    aws.String(\"SET #lock = :promise\"),\n})\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5833717"}, "edited": false, "score": 0, "creation_date": 1459011134, "post_id": 36233528, "comment_id": 60106437, "body": "Thank-you, I completely overlooked this. It is working as expected now."}], "tags": [], "owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "is_accepted": true, "score": 2, "last_activity_date": 1458983395, "creation_date": 1458983395, "answer_id": 36233528, "question_id": 36227600, "link": "https://stackoverflow.com/questions/36227600/go-app-runs-fine-locally-produces-404-when-running-goapp-serve/36233528#36233528", "title": "Go app runs fine locally, produces 404 when running goapp serve", "body": "<p>I haven't trawled through <em>all</em> your code, but I guess the problem is you initialise your router in <a href=\"https://github.com/cobraclamp/hotswapper-api/blob/master/main.go\" rel=\"nofollow\"><code>main</code></a>.</p>\n\n<p>As per the <a href=\"https://cloud.google.com/appengine/docs/go/\" rel=\"nofollow\">App Engine go SDK docs</a> and the <a href=\"http://www.gorillatoolkit.org/pkg/mux\" rel=\"nofollow\">Gorilla mux docs</a>, you need to do this in an <code>init()</code> function:</p>\n\n<blockquote>\n  <p>Or, for Google App Engine, register it in a init() function:</p>\n</blockquote>\n\n<pre><code>func init() {\n    http.Handle(\"/\", router)\n}\n</code></pre>\n\n<p>If you don't do this I guess your app will get a 404 for any route.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5833717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 36233528, "answer_count": 1, "score": 0, "last_activity_date": 1458983395, "creation_date": 1458938019, "question_id": 36227600, "link": "https://stackoverflow.com/questions/36227600/go-app-runs-fine-locally-produces-404-when-running-goapp-serve", "title": "Go app runs fine locally, produces 404 when running goapp serve", "body": "<p>I have a written a REST API using the <strong>Gorilla mux</strong> package and all data is stored in a MySQL database. I'm using the <strong>go-sql-driver/mysql</strong> package to access it.</p>\n\n<p>When I compile and run the bin directly, it works as expected. </p>\n\n<p>This is my first attepmt at deploying about to google cloud services, so I'm not familair with any special setup thatr needs to occur to make this work.</p>\n\n<p>All code can be found at <a href=\"https://github.com/cobraclamp/hotswapper-api\" rel=\"nofollow\">cobraclamp/hotswapper-api</a></p>\n\n<p>NOTE: I'm aware that the InitDB in main has boilerplate credentials, they are properly set in the local and production projects</p>\n"}]