[{"tags": ["go", "google-cloud-storage"], "comments": [{"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 1, "creation_date": 1433983841, "post_id": 30769342, "comment_id": 49591356, "body": "If the error is 503, wait, and retry? See <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/blob/262eba3f791eb465f961585c1eb4cde5672ee109/datastore/example_test.go\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/gcloud-golang/blob/&hellip;</a> for an example"}, {"owner": {"reputation": 15, "user_id": 879597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f925eaf0e94898d862c7a02b22ee9c73?s=128&d=identicon&r=PG", "display_name": "Clyde Starling", "link": "https://stackoverflow.com/users/879597/clyde-starling"}, "reply_to_user": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1433989455, "post_id": 30769342, "comment_id": 49592673, "body": "Thanks for the link, but the quoted documentation says that the library itself handles retrying so that I don&#39;t have to. I can implement retrying myself but I&#39;d like to understand what, if any, retrying the library does itself."}], "answers": [{"tags": [], "owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "is_accepted": true, "score": 0, "last_activity_date": 1434021316, "creation_date": 1434021316, "answer_id": 30779251, "question_id": 30769342, "link": "https://stackoverflow.com/questions/30769342/where-is-the-retrying-logic-in-the-google-cloud-storage-go-client/30779251#30779251", "title": "Where is the retrying logic in the Google Cloud Storage go client?", "body": "<p>As mentioned by Glenn Lewis on a <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/issues/108#issuecomment-75264882\" rel=\"nofollow\">GCloud issue</a> (20 Feb):</p>\n\n<blockquote>\n  <p>We are working on a ResumableMedia upload in the google-api-go-client\n  library that will simply retry from where it left off in case\n  something failed during transfer. I'm hoping that this should solve\n  the problem, but I don't have a date for you as to when this will be\n  ready because there are continuing design discussions.</p>\n</blockquote>\n\n<p>Right now there is no reference to <code>ResumableMedia</code> in the source code, so seems that the documentation is wrong. Note that the <code>storage</code> package is  experimental.</p>\n"}], "owner": {"reputation": 15, "user_id": 879597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f925eaf0e94898d862c7a02b22ee9c73?s=128&d=identicon&r=PG", "display_name": "Clyde Starling", "link": "https://stackoverflow.com/users/879597/clyde-starling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 30779251, "answer_count": 1, "score": 1, "last_activity_date": 1434021316, "creation_date": 1433980699, "question_id": 30769342, "link": "https://stackoverflow.com/questions/30769342/where-is-the-retrying-logic-in-the-google-cloud-storage-go-client", "title": "Where is the retrying logic in the Google Cloud Storage go client?", "body": "<p>Some Google <a href=\"https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/\" rel=\"nofollow\">documentation</a> for the go client for Cloud Storage says:</p>\n\n<blockquote>\n  <p>This library supports reading and writing large amounts of data to Cloud Storage, with internal error handling and retries, so you don't have to write your own code to do this.</p>\n</blockquote>\n\n<p>However, when using the below snippet of code which PUTs an object to Cloud Storage, a 503 Service Unavailable error gets returned to me occasionally.</p>\n\n<p>Where is the logic for retrying Cloud Storage requests located?</p>\n\n<pre><code>    conf, err := google.JWTConfigFromJSON([]byte(apiKey),storage.ScopeFullControl)\n\n    if err != nil {\n        panic(err)\n    }\n\n    ctx := cloud.NewContext(projectId, conf.Client(oauth2.NoContext))\n\n    writer := storage.NewWriter(self.ctx, Bucket, key)\n\n    _, err := writer.Write(data)\n    if err != nil {\n        return err\n    }\n</code></pre>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1433978011, "post_id": 30768684, "comment_id": 49589815, "body": "Hi I&#39;d like to answer your question however you have some problems with your code right now that make me unsure about how to do so. If you&#39;re OK holding this connection open all you really want is to define it your main package and set it up prior to turning on the routes. Anyway, in that composite literal declaration of <code>routes</code> you use <code>db</code> even though it&#39;s not in scope and (even if it were) there is no field to assign it to in the <code>Route</code> instance. If you correct that enough for me to understand your intent then I can more easily put forward a solution."}, {"owner": {"reputation": 5608, "user_id": 660828, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2ab261718814b4842efac71a1b6cd1a5?s=128&d=identicon&r=PG", "display_name": "Tom Jowitt", "link": "https://stackoverflow.com/users/660828/tom-jowitt"}, "edited": false, "score": 0, "creation_date": 1433979376, "post_id": 30768684, "comment_id": 49590231, "body": "You could look at gorilla context for passing extra data around http requests. <a href=\"http://www.gorillatoolkit.org/pkg/context\" rel=\"nofollow noreferrer\">gorillatoolkit.org/pkg/context</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 2, "last_activity_date": 1433990547, "creation_date": 1433990547, "answer_id": 30770653, "question_id": 30768684, "link": "https://stackoverflow.com/questions/30768684/golang-pass-arguments-to-gorilla-router/30770653#30770653", "title": "Golang pass arguments to gorilla router", "body": "<p>Go's <code>sql.DB</code> type represents a connection pool and not a single connection. It is recommended that you create a pool on program initialization and either:</p>\n\n<ol>\n<li><p>Create a global pool and just use it (the pool is safe for concurrent access)</p>\n\n<pre><code>var db *sql.DB\n\nfunc main() {\nvar err error\ndb, err = sql.Open(\"connection string here\")\nif err != nil {\n    // handle it\n}\n\n// Rest of program/router/etc\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\nerr := db.Query(\"...\")\nif err != nil {\n     // handle it\n    }\n\n    // Rest of handler\n}\n</code></pre></li>\n<li><p>Create custom handler functions that satisfy <code>http.Handler</code> and accept the pool or a struct containing the pool as an additional argument. I wrote about that here: <a href=\"https://elithrar.github.io/article/custom-handlers-avoiding-globals/\" rel=\"nofollow\">https://elithrar.github.io/article/custom-handlers-avoiding-globals/</a></p></li>\n</ol>\n\n<p>(I would provide another example but I'm on mobile; excuse the poor indentation)</p>\n\n<p>Also look at <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow\">sqlx</a> to simplify your query into/from struct handling. </p>\n"}, {"tags": [], "owner": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "is_accepted": false, "score": 1, "last_activity_date": 1434007701, "creation_date": 1434007701, "answer_id": 30774324, "question_id": 30768684, "link": "https://stackoverflow.com/questions/30768684/golang-pass-arguments-to-gorilla-router/30774324#30774324", "title": "Golang pass arguments to gorilla router", "body": "<p>Elithar's answer is the standard way of achieving this. If you want to inject a db connection in every handler, this is one way to solve it. You define your own handler and convert it back to what the router expects. Here is the example, I assume, that Elithar wanted to give.</p>\n\n<pre><code>func main() {\n    http.HandlerFunc(myDbHandler(Index, db))\n}\n\ntype dbHandler func(w http.ResponseWriter, r *http.Request, db *sql.DB)\n\nfunc myDbHandler(handler dbHandler, db *sql.DB) func(w http.ResponseWriter, r *http.Request) {\n    return func(w http.ResponseWriter, r *http.Request) {\n        handler(w, r, db)\n    }\n}\n\nfunc Index(w http.ResponseWriter, r *http.Request, db *sql.DB) {\n    // handler code goes here\n}\n</code></pre>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1434007701, "creation_date": 1433976765, "question_id": 30768684, "link": "https://stackoverflow.com/questions/30768684/golang-pass-arguments-to-gorilla-router", "title": "Golang pass arguments to gorilla router", "body": "<p>So I have two files. In one I have initialize a gorilla router, and register handlers. In the other I define the handlers. The handlers are supposed to query a MYSQL database. Routes.go looks like this - </p>\n\n<pre><code>    package main\n\nimport (\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"fmt\"\n)\n\ntype Route struct {\n    Name string\n    Method string\n    Pattern string\n    HandlerFunc http.HandlerFunc\n}\n\ntype Routes[]Route\n\nfunc NewRouter() *mux.Router {\n    db, err := sql.Open(\"mysql\", \"psanker:123@/education_data\")\n    err = db.Ping()\n\n    if err != nil {\n        fmt.Println(\"Failed to prepare connection to database\")\n        log.Fatal(\"Error:\", err.Error())\n    }\n\n    defer db.Close()\n\n    router := mux.NewRouter().StrictSlash(true)\n    for _, route := range routes {\n        router.\n            Methods(route.Method).\n            Path(route.Pattern).\n            Name(route.Name).\n            Handler(route.HandlerFunc)\n    }\n    return router\n}\n\nvar routes = Routes{\n    Route {\n        \"Index\",\n        \"GET\",\n        \"/\",\n        Index,\n    },\n    Route {\n        \"getDistrict\",\n        \"GET\",\n        \"/district/{districtId}\",\n        getDistrict,\n        DBConn &amp;db,\n    },\n    Route {\n        \"getDistricts\",\n        \"GET\",\n        \"/districts\",\n        getDistricts,\n    },\n}\n</code></pre>\n\n<p>My handlers.go file looks like this -</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n    \"encoding/json\"\n)\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"WELCOME!\")\n}\n\nfunc getDistrict(w http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\n    districtId := vars[\"districtId\"]\n    fmt.Fprintln(w, \"District id : \", districtId)\n}\n\nfunc getDistricts(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"application/json;charset=UTF-8\")\n    w.WriteHeader(http.StatusOK)\n    rows, err := db.Query(\"SELECT * from districts\")\n    check(err)\n    var district District\n    for rows.Next() {\n        var id int64\n        test := \"hey\"\n        district = District{Id: id, Activities: test}\n    }\n\n    if err := json.NewEncoder(w).Encode(district); err != nil {\n        check(err)\n    }\n}\n</code></pre>\n\n<p>I want to use one database connection for all of my handlers, how do I achieve this?</p>\n"}, {"tags": ["memory", "go", "resources", "channel", "internals"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1433972029, "post_id": 30767510, "comment_id": 49587579, "body": "I didn&#39;t verify in the source, but I would expect the overhead of the channel itself to dominate the effect of byte, bool or struct{} for an unbuffered channel."}], "answers": [{"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 11, "last_activity_date": 1433980573, "last_edit_date": 1433980573, "creation_date": 1433978411, "answer_id": 30768967, "question_id": 30767510, "link": "https://stackoverflow.com/questions/30767510/which-channel-type-uses-the-least-amount-of-memory-in-go/30768967#30768967", "title": "Which channel type uses the least amount of memory in Go?", "body": "<p>Looking at the <a href=\"https://github.com/golang/go/blob/f9ed2f75c43cb8745a1593ec3e4208c46419216a/src/runtime/chan.go#L17\" rel=\"noreferrer\">latest implementation</a> of the channel, it's not a trivial structure:</p>\n\n<pre><code>type hchan struct {\n    qcount   uint           // total data in the queue\n    dataqsiz uint           // size of the circular queue\n    buf      unsafe.Pointer // points to an array of dataqsiz elements\n    elemsize uint16\n    closed   uint32\n    elemtype *_type // element type\n    sendx    uint   // send index\n    recvx    uint   // receive index\n    recvq    waitq  // list of recv waiters\n    sendq    waitq  // list of send waiters\n    lock     mutex\n}\n</code></pre>\n\n<p>Elements of waiter queues are also <a href=\"https://github.com/golang/go/blob/93e57a22d5d3c9006b144ddfd9d675967fd810d0/src/runtime/runtime2.go#L159\" rel=\"noreferrer\">quite heavy</a>:</p>\n\n<pre><code>type sudog struct {\n    g           *g\n    selectdone  *uint32\n    next        *sudog\n    prev        *sudog\n    elem        unsafe.Pointer // data element\n    releasetime int64\n    nrelease    int32  // -1 for acquire\n    waitlink    *sudog // g.waiting list\n}\n</code></pre>\n\n<p>You see, <em>many</em> bytes. Even if any element would be created for an empty channel, this would be negligible.</p>\n\n<p>However, I expect all empty channels to take the same amount of space, regardless of underlying type, so if you intend to only close the channel, there'll be no difference (an actual element seems to be hold by a pointer). A quick test backs it up:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    // channel type\n    type xchan chan [64000]byte\n    a := make([]xchan, 10000000) // 10 million\n    for n := range a {\n        a[n] = make(xchan)\n    }\n    fmt.Println(\"done\")\n    time.Sleep(time.Minute)\n}\n</code></pre>\n\n<p>I see no difference between <code>chan struct{}</code> and <code>chan [64000]byte</code>, both leads to ~1GB of usage on my 64-bit machine, which makes me believe that overhead of creating a single channel in somewhere around 100 bytes.</p>\n\n<p>In conclusion, it doesn't really matter. Personally I would use <code>struct{}</code> as it's the only really empty type (of size 0 indeed), clearly indicating there is no intension of any payload being sent.</p>\n"}], "owner": {"reputation": 11705, "user_id": 293064, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/KnorP.jpg?s=128&g=1", "display_name": "Jay Taylor", "link": "https://stackoverflow.com/users/293064/jay-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2823, "favorite_count": 0, "accepted_answer_id": 30768967, "answer_count": 1, "score": 9, "last_activity_date": 1433980573, "creation_date": 1433971182, "question_id": 30767510, "link": "https://stackoverflow.com/questions/30767510/which-channel-type-uses-the-least-amount-of-memory-in-go", "title": "Which channel type uses the least amount of memory in Go?", "body": "<p>I find myself frequently using channels to get things to stop.  In these cases the channel is being used solely as a means of signaling, and none of the data is actually used.</p>\n\n<p>For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc routine(stopChan chan bool) {\n    fmt.Println(\"goroutine: I've started!\")\n    &lt;-stopChan\n    fmt.Println(\"goroutine: Cya'round pal\")\n}\n\nfunc main() {\n    fmt.Println(\"main: Sample program run started\")\n\n    stopChan := make(chan bool)\n\n    go routine(stopChan)\n\n    fmt.Println(\"main: Fired up the goroutine\")\n\n    stopChan &lt;- true\n\n    time.Sleep(1 * time.Second)\n\n    fmt.Println(\"main: Sample program run finished\")\n}\n</code></pre>\n\n<hr>\n\n<pre><code>// Sample output:\n//\n//  main: Sample program run started\n//  main: Fired up the goroutine\n//  goroutine: I've started!\n//  goroutine: Cya'round pal\n//  main: Sample program run finished\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/F4V4d9EP9V\">Run/view it</a> if you please on the golang playground.</p>\n\n<hr>\n\n<p>My question is:</p>\n\n<p>Which channel type has the lightest memory footprint in Go?</p>\n\n<p>e.g. Is a bool chan going to require any less overhead than an empty struct{} chan?</p>\n\n<p><code>chan bool</code></p>\n\n<p><code>chan byte</code></p>\n\n<p><code>chan interface{}</code></p>\n\n<p><code>chan struct{}</code></p>\n\n<p>...</p>\n\n<p>something else?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1434031273, "post_id": 30766840, "comment_id": 49615991, "body": "See <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How To Write Go Code</a>; you really don&#39;t want to use <code>go run</code> once you&#39;ve got multiple files. Use <code>go build</code> and/or <code>go install</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434031308, "post_id": 30766920, "comment_id": 49616018, "body": "Although this works, <code>go build</code> and/or <code>go install</code> is the preferred method."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1433969050, "last_edit_date": 1433969050, "creation_date": 1433968931, "answer_id": 30766920, "question_id": 30766840, "link": "https://stackoverflow.com/questions/30766840/running-multi-file-go-program/30766920#30766920", "title": "Running multi-file go program", "body": "<p>From the <code>go run</code> help:</p>\n\n<pre><code>usage: run [build flags] [-exec xprog] gofiles... [arguments...]\n\nRun compiles and runs the main package comprising the named Go source files.\nA Go source file is defined to be a file ending in a literal \".go\" suffix.\n</code></pre>\n\n<p>Only the files passed to <code>go run</code> will be included in the compilation (excluding imported packages). Therefore, you should specify all of your Go source files when using <code>go run</code>:</p>\n\n<pre><code>go run *.go\n# or\ngo run main.go handlers.go routes.go\n</code></pre>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 30766920, "answer_count": 1, "score": -1, "last_activity_date": 1433969050, "creation_date": 1433968680, "question_id": 30766840, "link": "https://stackoverflow.com/questions/30766840/running-multi-file-go-program", "title": "Running multi-file go program", "body": "<p>So I'm pretty new to go and I'm trying to follow this tutorial -</p>\n\n<p><a href=\"http://thenewstack.io/make-a-restful-json-api-go/\" rel=\"nofollow\">http://thenewstack.io/make-a-restful-json-api-go/</a></p>\n\n<p>Right now, this is my file structure -</p>\n\n<pre><code>EdData/\n    dataEntry/\n       populateDb.go\n    main.go\n    handlers.go\n    routes.go\n</code></pre>\n\n<p>When I run <code>go run main.go</code>, I get this error <code>./main.go:11: undefined: NewRouter</code></p>\n\n<p>This is what my main.go looks like -</p>\n\n<pre><code>package main \n\nimport (\n    \"net/http\"\n    \"log\"\n)\n\n\n\nfunc main() {\n    router := NewRouter()\n\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>This is what my routes.go looks like</p>\n\n<pre><code>    package main\n\nimport (\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n)\n\ntype Route struct {\n    Name string\n    Method string\n    Pattern string\n    HandlerFunc http.HandlerFunc\n}\n\ntype Routes[]Route\n\nfunc NewRouter() *mux.Router {\n\n    router := mux.NewRouter().StrictSlash(true)\n    for _, route := range routes {\n        router.\n            Methods(route.Method).\n            Path(route.Pattern).\n            Name(route.Name).\n            Handler(route.HandlerFunc)\n    }\n    return router\n}\n\nvar routes = Routes{\n    Route {\n        \"Index\",\n        \"GET\",\n        \"/\",\n        Index,\n    },\n}\n</code></pre>\n\n<p>and this is what my handlers.go looks like</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(w, \"WELCOME!\")\n}\n</code></pre>\n\n<p>When I try and build routes.go, I get that Index is undefined, and when I try and build handlers.go, I get </p>\n\n<p><code># command-line-arguments\nruntime.main: undefined: main.main</code></p>\n\n<p>How do I get this to run? Also, where do I execute the go run command? Do I need to manually build all the dependent files? </p>\n"}, {"tags": ["go", "github-api"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1433968659, "creation_date": 1433968659, "answer_id": 30766835, "question_id": 30766606, "link": "https://stackoverflow.com/questions/30766606/print-out-repository-releases-with-go-github/30766835#30766835", "title": "Print out repository releases with go-github", "body": "<p>From the <a href=\"https://developer.github.com/v3/repos/releases/#list-releases-for-a-repository\" rel=\"nofollow\">GitHub documentation on the list releases API</a>:</p>\n\n<blockquote>\n  <p>This returns a list of releases, which does not include regular Git tags that have not been associated with a release. To get a list of Git tags, use the <a href=\"https://developer.github.com/v3/repos/#list-tags\" rel=\"nofollow\">Repository Tags API</a>.</p>\n</blockquote>\n\n<p>Since the repository you specified contains only tags and not releases, nothing is returned.</p>\n\n<p>Changing <a href=\"https://godoc.org/github.com/google/go-github/github#RepositoriesService.ListReleases\" rel=\"nofollow\"><code>ListReleases</code></a> to <a href=\"https://godoc.org/github.com/google/go-github/github#RepositoriesService.ListTags\" rel=\"nofollow\"><code>ListTags</code></a> yields output similar to the following:</p>\n\n<pre><code>Releases for repo\n{0xc2081e1a10 github.Commit{SHA:\"d8292227960eab405863ffbc5d13cc85839aa2db\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/d8292227960eab405863ffbc5d13cc85839aa2db\"} 0xc2081e1a50 0xc2081e1a60}\n{0xc2081e1c40 github.Commit{SHA:\"4ed2c8d956d2eae83a2a3750290711ce7fa1ec76\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/4ed2c8d956d2eae83a2a3750290711ce7fa1ec76\"} 0xc2081e1c60 0xc2081e1c70}\n{0xc2081e1ca0 github.Commit{SHA:\"33e11f0eba1b634849784151b29f69314bfae827\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/33e11f0eba1b634849784151b29f69314bfae827\"} 0xc2081e1cb0 0xc2081e1cc0}\n{0xc2081e1cf0 github.Commit{SHA:\"8175d7f82134d378234a407e529853da681af07e\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/8175d7f82134d378234a407e529853da681af07e\"} 0xc2081e1d10 0xc2081e1d20}\n{0xc2081e1d50 github.Commit{SHA:\"166efa1ba0c7aa2fb5a7230f787c8499c765786e\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/166efa1ba0c7aa2fb5a7230f787c8499c765786e\"} 0xc2081e1d60 0xc2081e1d70}\n{0xc2081e1da0 github.Commit{SHA:\"1894e985557f010a4bca873c5b10bedb1cd7de5d\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/1894e985557f010a4bca873c5b10bedb1cd7de5d\"} 0xc2081e1dc0 0xc2081e1dd0}\n{0xc2081e1e00 github.Commit{SHA:\"0bc0c03fece07c4f21ee5195743116a4d418f234\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/0bc0c03fece07c4f21ee5195743116a4d418f234\"} 0xc2081e1e10 0xc2081e1e20}\n{0xc2081e1e50 github.Commit{SHA:\"4e11ed4327fa638a4c2587489a8660c69beb4047\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/4e11ed4327fa638a4c2587489a8660c69beb4047\"} 0xc2081e1e70 0xc2081e1e80}\n{0xc2081e1eb0 github.Commit{SHA:\"a4cf3fec1c8341041f41897ea84781e6be9b1dad\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/a4cf3fec1c8341041f41897ea84781e6be9b1dad\"} 0xc2081e1ec0 0xc2081e1ed0}\n{0xc2081e1f00 github.Commit{SHA:\"146d081b65aba3e0f183d6e4b26f3e794fabaebf\", URL:\"https://api.github.com/repos/hashicorp/terraform/commits/146d081b65aba3e0f183d6e4b26f3e794fabaebf\"} 0xc2081e1f20 0xc2081e1f30}\n</code></pre>\n"}], "owner": {"reputation": 2467, "user_id": 926190, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/098f89dd510cdc23243f3c19902a2af8?s=128&d=identicon&r=PG&f=1", "display_name": "jmreicha", "link": "https://stackoverflow.com/users/926190/jmreicha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 30766835, "answer_count": 1, "score": 0, "last_activity_date": 1433968659, "creation_date": 1433967858, "question_id": 30766606, "link": "https://stackoverflow.com/questions/30766606/print-out-repository-releases-with-go-github", "title": "Print out repository releases with go-github", "body": "<p>I am very new to Go and am having issues printing out all releases for a given repo using the <code>go-github</code> api.</p>\n\n<p>I am adapting my code from the <a href=\"https://github.com/google/go-github/blob/master/examples/repos/main.go\" rel=\"nofollow\">example in the project</a> here.</p>\n\n<p>This is the code I have so far.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"github.com/google/go-github/github\"\n  \"golang.org/x/oauth2\"\n)\n\nfunc main() {\n\n// authentication\nts := oauth2.StaticTokenSource(&amp;oauth2.Token{AccessToken: \"XXX\"})\ntc := oauth2.NewClient(oauth2.NoContext, ts)\n\nclient := github.NewClient(tc)\n\n// list all releases for single repo\nfmt.Println(\"Releases for repo\")\nopt := &amp;github.ListOptions{Page: 2, PerPage: 10}\nreleases, _, err := client.Repositories.ListReleases(\"hashicorp\", \"terraform\", opt)\n\nif err != nil {\n    fmt.Printf(\"error: %v\\n\", err)\n} else {\n    for _, release := range releases {\n        fmt.Printf(\"%v\\n\", release)\n    }\n}\n</code></pre>\n\n<p>This works and runs okay (no errors at least), but when I run it, the code doesn't return anything.  I have a feeling I am missing something simple but am stuck scratching my head.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1433964468, "post_id": 30765350, "comment_id": 49583371, "body": "A difference to the Python version, which may or may not be relevant, is that in Python the types of operands and the result are not specified in advance (i.e., <code>ops[&quot;+&quot;](4.5, 2)</code> gives <code>6.5</code>)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1471847425, "last_edit_date": 1471847425, "creation_date": 1433963793, "answer_id": 30765350, "question_id": 30765238, "link": "https://stackoverflow.com/questions/30765238/how-can-i-turn-a-string-into-an-operator/30765350#30765350", "title": "How can I turn a string into an operator?", "body": "<p>You can do this with function values:</p>\n\n<pre><code>ops := map[string]func(int, int) int{\n    \"+\": func(a, b int) int { return a + b },\n    \"-\": func(a, b int) int { return a - b },\n    \"*\": func(a, b int) int { return a * b },\n    \"/\": func(a, b int) int { return a / b },\n}\n\nfmt.Println(ops[\"+\"](4, 2))\nfmt.Println(ops[\"-\"](4, 2))\nfmt.Println(ops[\"*\"](4, 2))\nfmt.Println(ops[\"/\"](4, 2))\n</code></pre>\n\n<p>Output: <a href=\"http://play.golang.org/p/eJWoaayfqt\" rel=\"nofollow\">Go Playground</a></p>\n\n<pre><code>6\n2\n8\n2\n</code></pre>\n\n<p>For a nice print:</p>\n\n<pre><code>a, b := 4, 2\nfor op, fv := range ops {\n    fmt.Printf(\"%d %s %d = %d\\n\", a, op, b, fv(a, b))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>4 / 2 = 2\n4 + 2 = 6\n4 - 2 = 2\n4 * 2 = 8\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 1, "creation_date": 1434031801, "post_id": 30765434, "comment_id": 49616418, "body": "The map makes sense IFF you need to do run-time registration of operators, but should probably still be encapsulated in a function call."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 4, "last_activity_date": 1433964658, "last_edit_date": 1433964658, "creation_date": 1433964046, "answer_id": 30765434, "question_id": 30765238, "link": "https://stackoverflow.com/questions/30765238/how-can-i-turn-a-string-into-an-operator/30765434#30765434", "title": "How can I turn a string into an operator?", "body": "<p>There are few options but I would recommend just constructing the problem in a switch or using a <code>map[string]func</code> to provide a function which does the same. So... Either this;</p>\n\n<pre><code>ops := map[string]func(int, int) int{\n    \"+\": func(a, b int) int { return a + b },\n    \"-\": func(a, b int) int { return a - b },\n    \"*\": func(a, b int) int { return a * b },\n    \"/\": func(a, b int) int { return a / b },\n}\n</code></pre>\n\n<p>or this;</p>\n\n<pre><code>func doOp(string op, lhs, rhs int) int {\n     switch (op) {\n          case \"+\":\n             return lhs + rhs\n           // ect\n           default:\n              // error cause they gave an unknown op string\n     }\n}\n</code></pre>\n\n<p>Which I use would probably depend on scope. The function imo is more portable. The map isn't read only so for example someone else could just hose it entirely by assigning a different method to <code>\"+\"</code>.</p>\n\n<p>EDIT: After thinking about it the map sucks and I'd recommend against it. The function is more clear, stable, consistent, predictable, encapsulated ect.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434031800, "post_id": 30769579, "comment_id": 49616417, "body": "Do not use <code>case byte(43):</code> as a very hard to read version of <code>case `+`: </code>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434031971, "post_id": 30769579, "comment_id": 49616551, "body": "Also doing <code>sign string</code> is a bit silly. There&#39;s no reason to not just do <code>op byte</code> and then do <code>RunOp(`+`, 1, 2)</code>."}, {"owner": {"reputation": 362, "user_id": 2544044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e4021f92a8fe5f2a4620ef45bfebc6?s=128&d=identicon&r=PG", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/2544044/chris-b"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434119600, "post_id": 30769579, "comment_id": 49659471, "body": "Simply placing byte literals into constants could improve readability and I mentioned my approach is a little less readable. Also, how would you go about calling the method that takes &quot;op byte&quot; as argument without forcing the user to do byte(sign[0])?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434126165, "post_id": 30769579, "comment_id": 49663693, "body": "(D&#39;oh, in the above of course I meant <code>case &#39;+&#39;:</code>; single quotes versus backticks)"}, {"owner": {"reputation": 362, "user_id": 2544044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e4021f92a8fe5f2a4620ef45bfebc6?s=128&d=identicon&r=PG", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/2544044/chris-b"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434234184, "post_id": 30769579, "comment_id": 49693998, "body": "And what&#39;s your point? That a string-based implementation is more readable?"}], "tags": [], "owner": {"reputation": 362, "user_id": 2544044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e4021f92a8fe5f2a4620ef45bfebc6?s=128&d=identicon&r=PG", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/2544044/chris-b"}, "is_accepted": false, "score": -1, "last_activity_date": 1433982273, "creation_date": 1433982273, "answer_id": 30769579, "question_id": 30765238, "link": "https://stackoverflow.com/questions/30765238/how-can-i-turn-a-string-into-an-operator/30769579#30769579", "title": "How can I turn a string into an operator?", "body": "<p>Here's another implementation. This is give or take 3x faster than the string-based switch implementation but readability is a little less.</p>\n\n<pre><code>func RunOp(sign string, a, b int) int {\n    s := byte(sign[0])\n    switch s {\n    case byte(43):\n            return a+b\n    case byte(45):\n            return a-b\n    case byte(47):\n            return a/b\n    case byte(42):\n            return a*b\n    default:\n            return 0\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 30765350, "answer_count": 3, "score": 2, "last_activity_date": 1471847425, "creation_date": 1433963457, "question_id": 30765238, "link": "https://stackoverflow.com/questions/30765238/how-can-i-turn-a-string-into-an-operator", "title": "How can I turn a string into an operator?", "body": "<p>Is there a way to convert a string (e.g. \"+\", \"-\", \"/\", \"*\") into their respective math operators (+, -, /, *)?</p>\n\n<p>In Python you can do:</p>\n\n<pre><code>import operator\nops = {\"+\": operator.add, \"-\": operator.sub} # etc.\nprint ops[\"+\"](1,1) # prints 2\n</code></pre>\n\n<p>Is there a similar library or method for Go?</p>\n"}, {"tags": ["python", "awk", "sed", "go", "go-templates"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1433956181, "post_id": 30762761, "comment_id": 49578381, "body": "You could manually read the file and perform successive replace operations for the variables/replacements, and you can do this efficiently by building the output on-the-fly. It can be done with fairly few lines of code (~30). See this question+answer which shows this in Java: <a href=\"http://stackoverflow.com/questions/26735276/alternative-to-successive-string-replace\">Alternative to successive String.replace</a>"}, {"owner": {"reputation": 773, "user_id": 545342, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d840290c32461dbdeb3320aa7be34d72?s=128&d=identicon&r=PG", "display_name": "Ike", "link": "https://stackoverflow.com/users/545342/ike"}, "edited": false, "score": 0, "creation_date": 1433958844, "post_id": 30762761, "comment_id": 49580021, "body": "Thanks icza. Implementing my own replacer is definitely an option but I was hoping to find an efficient and flexible library that can do it. Replacing tokens in a string seems like a generic enough task that someone else would have solved well already."}, {"owner": {"reputation": 2404, "user_id": 1259917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577edfc3837692b632394130b82b095a?s=128&d=identicon&r=PG", "display_name": "n0741337", "link": "https://stackoverflow.com/users/1259917/n0741337"}, "edited": false, "score": 0, "creation_date": 1433959042, "post_id": 30762761, "comment_id": 49580161, "body": "Would something like <a href=\"https://mustache.github.io/\" rel=\"nofollow noreferrer\">Mustache</a> work for you?"}, {"owner": {"reputation": 773, "user_id": 545342, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d840290c32461dbdeb3320aa7be34d72?s=128&d=identicon&r=PG", "display_name": "Ike", "link": "https://stackoverflow.com/users/545342/ike"}, "edited": false, "score": 0, "creation_date": 1433959828, "post_id": 30762761, "comment_id": 49580615, "body": "n0741337, Mustache is a great option. I didn&#39;t think to look for a Go implementation. It still supports &quot;Sections&quot;, however, with syntax like <code>{{#</code>. Do you know if there&#39;s a way to disable that piece?"}, {"owner": {"reputation": 2633, "user_id": 27898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84028aac31ee14ca90aa08c2442e3a1e?s=128&d=identicon&r=PG", "display_name": "mpez0", "link": "https://stackoverflow.com/users/27898/mpez0"}, "edited": false, "score": 0, "creation_date": 1433960585, "post_id": 30762761, "comment_id": 49581104, "body": "You could pre-filter the input (good idea anyway) and reject it if it contains {{#"}, {"owner": {"reputation": 2404, "user_id": 1259917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577edfc3837692b632394130b82b095a?s=128&d=identicon&r=PG", "display_name": "n0741337", "link": "https://stackoverflow.com/users/1259917/n0741337"}, "edited": false, "score": 0, "creation_date": 1433977284, "post_id": 30762761, "comment_id": 49589566, "body": "Regarding Mustache, looks like the javascript and go projects are licensed for you to fork/edit freely.  I&#39;m a javascript novice and I&#39;ve never looked at go code, but they seem simple enough to alter.  For mustache.js looks like you could just sabotage the <a href=\"https://github.com/janl/mustache.js/blob/master/mustache.js#L71\" rel=\"nofollow noreferrer\"><code>tagRe</code></a> to remove tags you don&#39;t want.  For mustache.go it looks like you could intercept the <a href=\"https://github.com/hoisie/mustache/blob/master/mustache.go#L241\" rel=\"nofollow noreferrer\"><code>tag[0]</code></a> to skip tags you don&#39;t like in the parse() func.  Then make sure the corresponding parse tests fail."}], "answers": [{"comments": [{"owner": {"reputation": 773, "user_id": 545342, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d840290c32461dbdeb3320aa7be34d72?s=128&d=identicon&r=PG", "display_name": "Ike", "link": "https://stackoverflow.com/users/545342/ike"}, "edited": false, "score": 1, "creation_date": 1433968508, "post_id": 30766470, "comment_id": 49585668, "body": "Thanks for the snippet @EdMorton. I currently have the source var/values in either a data structure (in a Go or Python program) or Environment Variables. I can write the var data to a temp file for this to work as suggested. Is there a trivial way to &quot;pass in&quot; the data or have the awk script look it up from exported shell Environment Variables that wouldn&#39;t require creating a temp file with it?"}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "reply_to_user": {"reputation": 773, "user_id": 545342, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d840290c32461dbdeb3320aa7be34d72?s=128&d=identicon&r=PG", "display_name": "Ike", "link": "https://stackoverflow.com/users/545342/ike"}, "edited": false, "score": 0, "creation_date": 1433968676, "post_id": 30766470, "comment_id": 49585760, "body": "Sorry I&#39;ve never heard of &quot;Go&quot; and couldn&#39;t tell a Python program from a hole in the ground. When you say &quot;env vars&quot; - are you talking about shell variables or something else? Whatever it is please edit your question to show it."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "reply_to_user": {"reputation": 773, "user_id": 545342, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d840290c32461dbdeb3320aa7be34d72?s=128&d=identicon&r=PG", "display_name": "Ike", "link": "https://stackoverflow.com/users/545342/ike"}, "edited": false, "score": 0, "creation_date": 1433969134, "post_id": 30766470, "comment_id": 49586016, "body": "@Ike I edited my question to show a couple of possible solutions to one possible interpretation of your comment about having values in env vars."}, {"owner": {"reputation": 773, "user_id": 545342, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d840290c32461dbdeb3320aa7be34d72?s=128&d=identicon&r=PG", "display_name": "Ike", "link": "https://stackoverflow.com/users/545342/ike"}, "edited": false, "score": 1, "creation_date": 1433969437, "post_id": 30766470, "comment_id": 49586184, "body": "Thanks again @EdMorton. This looks like a good, pragmatic approach. I didn&#39;t think of passing the var names in the command line but it&#39;s easy enough to do programmatically and also helps as an input filter.I&#39;ll test it with a couple of real-world template files and report back."}], "tags": [], "owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "is_accepted": false, "score": 1, "last_activity_date": 1433969462, "last_edit_date": 1433969462, "creation_date": 1433967409, "answer_id": 30766470, "question_id": 30762761, "link": "https://stackoverflow.com/questions/30762761/template-variable-replacements-only-is-text-template-a-good-fit/30766470#30766470", "title": "Template variable replacements only. Is text/Template a good fit?", "body": "<p>This will work as long as your variable names don't contain ERE metacharacters:</p>\n\n<pre><code>$ cat tst.awk\nNR==FNR { var2val[$1] = $NF; next }\n{\n    for (var in var2val) {\n        sub(\"[$]#\"var\"#[$]\",var2val[var])\n    }\n    print\n}\n\n$ awk -f tst.awk input.data template.properties\nvar1=apples\nvar2=oranges\n</code></pre>\n\n<p>wrt your comment below about having the mappings in variables instead of in input.data, this might be what you're looking for:</p>\n\n<pre><code>$ cat tst.awk\nBEGIN {\n    split(vars,tmp)\n    for (i in tmp) {\n        var2val[tmp[i]] = ENVIRON[tmp[i]]\n    }\n}\n{\n    for (var in var2val) {\n        sub(\"[$]#\"var\"#[$]\",var2val[var])\n    }\n    print\n}\n</code></pre>\n\n<p>will work with shell variables like:</p>\n\n<pre><code>$ VAR_1=apples VAR_2=oranges gawk -v vars=\"VAR_1 VAR_2\" -f tst.awk template.properties\nvar1=apples\nvar2=oranges\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>$ export VAR_1=apples\n$ export VAR_2=oranges\n$ gawk -v vars=\"VAR_1 VAR_2\" -f tst.awk template.properties\nvar1=apples\nvar2=oranges\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>$ VAR_1=apples\n$ VAR_2=oranges\n$ VAR_1=\"$VAR_1\" VAR_2=\"$VAR_2\" gawk -v vars=\"VAR_1 VAR_2\" -f tst.awk template.properties\nvar1=apples\nvar2=oranges\n</code></pre>\n\n<p>Note that this is gawk-specific due to ENVIRON and requires VAR_1 etc. to be exported or set on the command line as I have it above.</p>\n\n<p>Or maybe this is what you want:</p>\n\n<pre><code>$ cat tst.awk\nBEGIN {\n    var2val[\"VAR_1\"] = VAR_1\n    var2val[\"VAR_2\"] = VAR_2\n}\n{\n    for (var in var2val) {\n        sub(\"[$]#\"var\"#[$]\",var2val[var])\n    }\n    print\n}\n\n$ VAR_1=apples\n$ VAR_2=oranges\n$ awk -v VAR_1=\"$VAR_1\" -v VAR_2=\"$VAR_2\" -f tst.awk template.properties\nvar1=apples\nvar2=oranges\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2246, "user_id": 274937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d848784d081501a5cba4a2fa7856e965?s=128&d=identicon&r=PG", "display_name": "valyala", "link": "https://stackoverflow.com/users/274937/valyala"}, "is_accepted": false, "score": 0, "last_activity_date": 1442840132, "last_edit_date": 1442840132, "creation_date": 1440334253, "answer_id": 32166836, "question_id": 30762761, "link": "https://stackoverflow.com/questions/30762761/template-variable-replacements-only-is-text-template-a-good-fit/32166836#32166836", "title": "Template variable replacements only. Is text/Template a good fit?", "body": "<p>Just use fasttemplate[1]. It perfectly fits your requirements:</p>\n\n<ul>\n<li>Arbitrary placeholders' start and end delimiters can be used.</li>\n<li>Zero risk for untrusted input, because there is no any logic except placeholders' substitution.</li>\n<li>Works much faster than text/template (by 10x).</li>\n</ul>\n\n<p>[1]<a href=\"https://github.com/valyala/fasttemplate\" rel=\"nofollow\">https://github.com/valyala/fasttemplate</a></p>\n"}], "owner": {"reputation": 773, "user_id": 545342, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d840290c32461dbdeb3320aa7be34d72?s=128&d=identicon&r=PG", "display_name": "Ike", "link": "https://stackoverflow.com/users/545342/ike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1442840132, "creation_date": 1433955592, "last_edit_date": 1433959303, "question_id": 30762761, "link": "https://stackoverflow.com/questions/30762761/template-variable-replacements-only-is-text-template-a-good-fit", "title": "Template variable replacements only. Is text/Template a good fit?", "body": "<p>I'm looking for an efficient way to replace a bunch of placeholders/tokens in a user supplied text file, with their corresponding values stored in a simple map or environment vars. The thing is that the template file will be supplied by the end user, so I'm looking for a \"safe\" way to do only the variable replacements, without any risk of code execution, etc.</p>\n\n<p>Go's standard \"text/template\" would work for the replacement itself but imposes specific formatting requirements (e.g. dot \".\" before the Key) and opens up other possibilities with its function invocations, pipelines, etc.</p>\n\n<p>So what I'm looking for, ideally, is a function that can parse a text file with configurable delimiters (\"{{}}\" or \"${}\" or \"$##$\") and replace all the detected tokens with lookups into a supplied map or their env var values. Similar to what Python's <code>string.Template</code> (<a href=\"https://docs.python.org/2.6/library/string.html?highlight=string.template#string.Template\" rel=\"nofollow\">https://docs.python.org/2.6/library/string.html?highlight=string.template#string.Template</a>) does.</p>\n\n<p>Is there an easy way to configure or reuse the text/template library for this? Are there any other approaches that would fit the use case better? I've looked into non-golang options as well (like <code>envsubtr</code>, <code>awk</code> and <code>sed</code> scripts etc.) so feel free to go outside of Go if something fits better.</p>\n\n<p><strong>Sample input file ('template.properties'):</strong></p>\n\n<pre><code>var1=$#VAR_1#$\nvar2=$#VAR_2#$\n</code></pre>\n\n<p><strong>Sample input data:</strong></p>\n\n<pre><code>VAR_1 = apples\nVAR_2 = oranges\n</code></pre>\n\n<p><strong>Expected output after processing:</strong></p>\n\n<pre><code>var1=apples\nvar2=oranges\n</code></pre>\n"}, {"tags": ["go", "metrics", "endpoints"], "comments": [{"owner": {"reputation": 9694, "user_id": 797538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50394e88b7b1ff30dbca04c06560e5a?s=128&d=identicon&r=PG", "display_name": "lnmx", "link": "https://stackoverflow.com/users/797538/lnmx"}, "edited": false, "score": 0, "creation_date": 1433951979, "post_id": 30761071, "comment_id": 49575705, "body": "Which sinks are you using (<code>bugsnag</code>, <code>statsd</code>, etc.)?  Are you using <code>healthd</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433985015, "post_id": 30761071, "comment_id": 49591626, "body": "Have you tried to profile the process to see what&#39;s using the CPU?"}, {"owner": {"reputation": 362, "user_id": 2544044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e4021f92a8fe5f2a4620ef45bfebc6?s=128&d=identicon&r=PG", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/2544044/chris-b"}, "edited": false, "score": 2, "creation_date": 1433986977, "post_id": 30761071, "comment_id": 49592095, "body": "Disclaimer: haven&#39;t ever used this library, but did check out the source code. Do you remove the Sink you add in the vastPlayer handler on every incoming http request? The &quot;stream&quot; object seems to iterate over all the Sink instances and it appears you add a sink on every request."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "reply_to_user": {"reputation": 362, "user_id": 2544044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e4021f92a8fe5f2a4620ef45bfebc6?s=128&d=identicon&r=PG", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/2544044/chris-b"}, "edited": false, "score": 0, "creation_date": 1434014642, "post_id": 30761071, "comment_id": 49603788, "body": "@ChrisB.  Great, didnt notice it, I put the <b>Sink</b> in the main function and it works pefectly now,Gracias."}], "answers": [{"tags": [], "owner": {"reputation": 4173, "user_id": 3479860, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/07d70ea6b00797e7e17daaa30b1dc363?s=128&d=identicon&r=PG&f=1", "display_name": "Valeriy Solovyov", "link": "https://stackoverflow.com/users/3479860/valeriy-solovyov"}, "is_accepted": false, "score": 0, "last_activity_date": 1457508575, "creation_date": 1457508575, "answer_id": 35885498, "question_id": 30761071, "link": "https://stackoverflow.com/questions/30761071/golang-gocraft-health-package-100-cpu/35885498#35885498", "title": "Golang : gocraft/health package 100% CPU", "body": "<p>I think it's right code:</p>\n\n<pre><code>var stream = health.NewStream()\n\n func main() {\n        // Log to stdout! (can also use WriterSink to write to a log file, Syslog, etc)\n  stream.AddSink(&amp;health.WriterSink{os.Stdout})\n\n\n   sink := health.NewJsonPollingSink(time.Minute*5, time.Minute*5)\n    stream.AddSink(sink)\n        //http://creative.health.spoti.io/health\n    adr:=\"127.0.0.1:5001\"\n    sink.StartServer(adr)\n\n  http.HandleFunc(\"/api/getVastPlayer\", vastPlayer)\n  http.HandleFunc(\"/static/\", func(w http.ResponseWriter, r *http.Request) {\n        http.ServeFile(w, r, r.URL.Path[1:])\n    })\n\n  log.Println(\"Listening...\")\n  panic(http.ListenAndServe(\":2001\", nil))\n\n  }\n\n\n  func vastPlayer(w http.ResponseWriter, r *http.Request) {\n\n    job_1 := stream.NewJob(\"/api/getVastPlayer\")\n      //job_2 := stream.NewJob(\"/api/html/\")\n\n\n......\n......\nif bol{\njob_1.Complete(health.Success)\n}\nelse{\njob_1.Complete(health.ValidationError)\n}\n\n}\n</code></pre>\n\n<p>PS:\n<a href=\"https://github.com/gocraft/health#jobs\" rel=\"nofollow\">https://github.com/gocraft/health#jobs</a></p>\n"}], "owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1457508575, "creation_date": 1433950826, "last_edit_date": 1434464675, "question_id": 30761071, "link": "https://stackoverflow.com/questions/30761071/golang-gocraft-health-package-100-cpu", "title": "Golang : gocraft/health package 100% CPU", "body": "<p>Im using <strong>gocraft/health</strong> to check the health of my service and have the metrics of each endPoint. But I have a problem:\nthe CPU  reach  100% after just 5 hours of starting my service I dont know why.\nwithout using the \"<strong>gocraft/health</strong>\"  it takes just 0,7% of CPU\ndoes anyone worked with this pack before</p>\n\n<pre><code>var stream = health.NewStream()\n\n func main() {\n        // Log to stdout! (can also use WriterSink to write to a log file, Syslog, etc)\n  stream.AddSink(&amp;health.WriterSink{os.Stdout})\n\n  http.HandleFunc(\"/api/getVastPlayer\", vastPlayer)\n  http.HandleFunc(\"/static/\", func(w http.ResponseWriter, r *http.Request) {\n        http.ServeFile(w, r, r.URL.Path[1:])\n    })\n\n  log.Println(\"Listening...\")\n  panic(http.ListenAndServe(\":2001\", nil))\n\n  }\n</code></pre>\n\n<p>;</p>\n\n<pre><code>func vastPlayer(w http.ResponseWriter, r *http.Request) {\n\n    job_1 := stream.NewJob(\"/api/getVastPlayer\")\n      //job_2 := stream.NewJob(\"/api/html/\")\n    sink := health.NewJsonPollingSink(time.Minute*5, time.Minute*5)\n    stream.AddSink(sink)\n        //http://creative.health.spoti.io/health\n    adr:=\"127.0.0.1:5001\"\n    sink.StartServer(adr)\n......\n......\nif bol{\njob_1.Complete(health.Success)\n}\nelse{\njob_1.Complete(health.ValidationError)\n}\n</code></pre>\n"}, {"tags": ["mysql", "sql", "database", "go", "xampp"], "comments": [{"owner": {"reputation": 5608, "user_id": 660828, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2ab261718814b4842efac71a1b6cd1a5?s=128&d=identicon&r=PG", "display_name": "Tom Jowitt", "link": "https://stackoverflow.com/users/660828/tom-jowitt"}, "edited": false, "score": 2, "creation_date": 1433922971, "post_id": 30750032, "comment_id": 49554997, "body": "Are you sure you can connect to your DB? You&#39;re not handling the DSN connection error."}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 4655777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8a0f4579bd4de4ad1e1e1abf555759?s=128&d=identicon&r=PG", "display_name": "stonith", "link": "https://stackoverflow.com/users/4655777/stonith"}, "is_accepted": false, "score": 0, "last_activity_date": 1433976463, "creation_date": 1433976463, "answer_id": 30768625, "question_id": 30750032, "link": "https://stackoverflow.com/questions/30750032/cant-connect-go-to-xampp-mysql/30768625#30768625", "title": "Can&#39;t connect Go to XAMPP MySQL", "body": "<p>As Tom mentioned, you should check for an error after sql.Open:</p>\n\n<pre><code>    db, err := sql.Open(\"mysql\", dsn)\n    if err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n\n<p>PS. Never use string concatenations in SQL.</p>\n\n<p>To prevent SQL injections you should use prepared statements:</p>\n\n<pre><code>    sql := \"INSERT INTO users set user_nickname='?', user_first='?', user_last='?', user_email='?'\"\n    q, err := db.Exec(sql, NewUser.Name, NewUser.First, NewUser.Last, NewUser.Email)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3568015, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100002609585093/picture?type=large", "display_name": "Abdul Rehman", "link": "https://stackoverflow.com/users/3568015/abdul-rehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 844, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433976463, "creation_date": 1433921919, "last_edit_date": 1433948206, "question_id": 30750032, "link": "https://stackoverflow.com/questions/30750032/cant-connect-go-to-xampp-mysql", "title": "Can&#39;t connect Go to XAMPP MySQL", "body": "<p>I'm new to Go.\nI'm trying to use MySQL with Go.\nI have installed XAMPP which has Apache and MySQL.\nI'm also using the <code>database/sql</code> package and <code>github.com/go-sql-driver/mysql</code> driver.</p>\n\n<p>I can't figure out the error. I'm using LiteIDE which doesn't show any error but the record is not inserted to my database.</p>\n\n<p>My code is:</p>\n\n<pre><code>// RESTAPI project main.go\npackage main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n\n    \"github.com/gorilla/mux\"\n)\n\ntype API struct {\n    Message string \"json:message\"\n}\ntype User struct {\n    ID    int    \"json:id\"\n    Name  string \"json:username\"\n    Email string \"json:email\"\n    First string \"json:first\"\n    Last  string \"json:last\"\n}\n\nfunc CreateUser(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintln(\"Create file\")\n    NewUser := User{}\n    NewUser.Name = r.FormValue(\"user\")\n    NewUser.Email = r.FormValue(\"email\")\n    NewUser.First = r.FormValue(\"first\")\n    NewUser.Last = r.FormValue(\"last\")\n    output, err := json.Marshal(NewUser)\n    fmt.Println(string(output))\n    if err != nil {\n        fmt.Println(\"Something went wrong!\")\n    }\n    dsn := \"root:password@/dbname\"\n    db, err := sql.Open(\"mysql\", dsn)\n    sql := \"INSERT INTO users set user_nickname='\" + NewUser.Name + \"', user_first='\" + NewUser.First + \"', user_last='\" + NewUser.Last + \"', user_email='\" + NewUser.Email + \"'\"\n    q, err := db.Exec(sql)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(q)\n    fmt.Println(\"User is created\")\n}\n\nfunc main() {\n    routes := mux.NewRouter()\n    routes.HandleFunc(\"/api/user/create\", CreateUser).Methods(\"GET\")\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}, {"tags": ["paypal", "go"], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 2390688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05fa6ab42dac0fb4cea49ae0dafc0649?s=128&d=identicon&r=PG&f=1", "display_name": "golddc", "link": "https://stackoverflow.com/users/2390688/golddc"}, "is_accepted": false, "score": 1, "last_activity_date": 1433922939, "creation_date": 1433922939, "answer_id": 30750396, "question_id": 30749920, "link": "https://stackoverflow.com/questions/30749920/getting-the-payer-information-in-paypal-classic-api/30750396#30750396", "title": "Getting the Payer Information in PayPal Classic API", "body": "<p>It depends on when you call GetEC. GetEC (GetExpressCheckoutDetails) <strong>doesn't necessarily</strong> respond with the payer info, because the payer <strong>may not</strong> be present yet.</p>\n\n<p>Payer info and Payer ID are only available once the payer agrees to pay (he/she signs into PP and fills in the right info and clicks the Continue or Pay button), which means in this case you'd be calling GetEC <strong>AFTER</strong> the payer agrees to pay and gets back to your system for DoEC. This way GetEC will give you payer info.</p>\n\n<p>Here is GetEC doc:\n<a href=\"https://developer.paypal.com/docs/classic/api/merchant/GetExpressCheckoutDetails_API_Operation_NVP/\" rel=\"nofollow\">https://developer.paypal.com/docs/classic/api/merchant/GetExpressCheckoutDetails_API_Operation_NVP/</a></p>\n"}], "owner": {"reputation": 605, "user_id": 2422033, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/jAnBl.jpg?s=128&g=1", "display_name": "mquemazz", "link": "https://stackoverflow.com/users/2422033/mquemazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433922939, "creation_date": 1433921612, "question_id": 30749920, "link": "https://stackoverflow.com/questions/30749920/getting-the-payer-information-in-paypal-classic-api", "title": "Getting the Payer Information in PayPal Classic API", "body": "<p>I am using at the moment the Classic API from PayPal to create a one time payment, however when I called the GetExpressCheckoutDetails, I don't receive any information about the Payer.</p>\n\n<p>Notice: I am using Google Go as a programming language</p>\n"}, {"tags": ["xml", "go", "base64", "gorp"], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1433918943, "post_id": 30748373, "comment_id": 49552366, "body": "Basically sir, I would like to output something like this  &lt;genre&gt;UG9w&lt;/genre&gt;  &lt;genre&gt;Um9jaw==&lt;/genre&gt;  &lt;genre&gt;RGFuY2U=&lt;/genre&gt;  which means every entry must be converted to base64 encode not the whole array,"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1433919210, "post_id": 30748373, "comment_id": 49552536, "body": "@LeViNcE Then just define the <code>genre</code> as a <code>[]byte</code>. It is convention in XML encoders that binary data is encoded using Base64 by default."}, {"owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1433920671, "post_id": 30748373, "comment_id": 49553485, "body": "I&#39;ve inserted my whole code for your reference sir, when I convert genre to []byte, no data is fetch to my database"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1433923060, "post_id": 30748373, "comment_id": 49555064, "body": "@LeViNcE See my edited answer where I show a solution to get your expected output."}, {"owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1433925753, "post_id": 30748373, "comment_id": 49556762, "body": "thank you for your response sir, I really appreciate it, I&#39;m very thankful to you. The code is working fine, For my last question, can you output to this format  [{Um9jaw==} {RGFuY2U} {T3BlcmE} {VGVjaG5v} {SGlwIEhvcA==} {SmF6eg==}] instead of xml format sir? I will do the rest of coding. Thank you very much for the effort sir."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1433926562, "post_id": 30748373, "comment_id": 49557282, "body": "@LeViNcE For that format simply iterate over the <code>Item</code> field (which is a slice of <code>Genre</code>), and append the Base64 representation of each <code>Genre.Title</code> to a <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow noreferrer\"><code>bytes.Buffer</code></a>."}, {"owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1433984752, "post_id": 30748373, "comment_id": 49591562, "body": "Ah, sir icza, can you give me a sample for that code, because I am new to go programming and I can&#39;t easily understand some functions and syntax of it. Thank you."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1473775761, "last_edit_date": 1473775761, "creation_date": 1433916569, "answer_id": 30748373, "question_id": 30747956, "link": "https://stackoverflow.com/questions/30747956/encode-array-to-base64-in-go/30748373#30748373", "title": "Encode array to base64 in go", "body": "<p><em>Foreword: The first section answers the original question (encode array to Base64). If you just want individual <code>string</code> fields to appear as Base64 strings in the output, see the 2nd section.</em></p>\n\n<hr>\n\n<h2>Encoding a <code>[]string</code> into Base64 format</h2>\n\n<p>Base64 is an encoding, a function used to convert an arbitrary sequence of bytes to a text using a small, well defined set of characters.</p>\n\n<p>So you have to decide / come up with a way to convert your <code>[]string</code> array or slice to a sequence of bytes.</p>\n\n<p>An easy and convenient way is to convert your <code>[]string</code> to JSON text which will also take care of escaping strings having a quotation mark <code>\"</code> for example. The result <code>string</code> can be easily encoded using the method you described:</p>\n\n<pre><code>genre := []string{\"Pop\", \"Rock\", \"Dance\", \"Opera\", \"Techno\", \"Hiphop\", \"Jazz\", \"Reggae\"}\n\ndata, _ := json.Marshal(&amp;genre)\nfmt.Println(string(data))\nsEnc := base64.StdEncoding.EncodeToString(data)\nfmt.Println(sEnc)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/gAHrKvLqQa\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>[\"Pop\",\"Rock\",\"Dance\",\"Opera\",\"Techno\",\"Hiphop\",\"Jazz\",\"Reggae\"]\nWyJQb3AiLCJSb2NrIiwiRGFuY2UiLCJPcGVyYSIsIlRlY2hubyIsIkhpcGhvcCIsIkphenoiLCJSZWdnYWUiXQ==\n</code></pre>\n\n<h3>Decoding</h3>\n\n<p>Having such Base64 result, you can decode it like this:</p>\n\n<pre><code>data2, err := base64.StdEncoding.DecodeString(sEnc)\nif err != nil {\n    panic(err)\n}\nvar genre2 []string\nif err = json.Unmarshal(data2, &amp;genre2); err != nil {\n    panic(err)\n}\nfmt.Println(genre2)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[Pop Rock Dance Opera Techno Hiphop Jazz Reggae]\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<p>Of course you may choose any other transformations to convert <code>[]string</code> to a byte sequence. You could convert it to XML, or using the <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"nofollow\"><code>encoding/binary</code></a> or anything else. I chose JSON because it is a one-liner, compact, fast, and is supported in almost every programming language, so it won't be a problem if another program has to decode it.</p>\n\n<h2>Making individual <code>string</code> fields to appear as Base64</h2>\n\n<p>You can do this by implementing the <a href=\"https://golang.org/pkg/encoding/xml/#Marshaler\" rel=\"nofollow\"><code>Marshaler</code></a> interface on the type (or enclosing <code>struct</code>) like this:</p>\n\n<pre><code>func (g *Genre) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n    g2 := *g\n    g2.Title = base64.StdEncoding.EncodeToString([]byte(g.Title))\n    return e.EncodeElement(g2, start)\n}\n</code></pre>\n\n<p>Basically what this does is creates a copy of <code>Genre</code>, changes the value of the <code>Title</code> field (of the copy) to the Base64 representation of its original value and encodes this copy.</p>\n\n<p>Output (partial), try it on the <a href=\"http://play.golang.org/p/3cy4M-0AAP\" rel=\"nofollow\">Go Playground</a>:</p>\n\n<pre><code>&lt;GenreArray&gt;\n    &lt;item&gt;\n        &lt;genre&gt;UG9w&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Um9jaw==&lt;/genre&gt;\n    &lt;/item&gt;\n&lt;/GenreArray&gt;\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1789, "favorite_count": 0, "accepted_answer_id": 30748373, "answer_count": 1, "score": 1, "last_activity_date": 1473775761, "creation_date": 1433914908, "last_edit_date": 1433923163, "question_id": 30747956, "link": "https://stackoverflow.com/questions/30747956/encode-array-to-base64-in-go", "title": "Encode array to base64 in go", "body": "<p>Here is my complete code for a function I develop:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"log\"\n    \"encoding/xml\"\n    \"github.com/gin-gonic/gin\" //golang frameworks\n    _ \"github.com/go-sql-driver/mysql\"\n    \"gopkg.in/gorp.v1\"        //work with database(mysql, etc.)\n)\n\ntype Genre struct {\n    Title string `xml:\"genre\"`\n}\n\ntype GenreArray struct {\n    Auth_state int `xml:\"auth_state\"`\n    Count int64 `xml:\"count\"`\n    Item genreAPI `xml:\"item\"`\n}\n\ntype UserPass struct {\n    Username string `xml:\"username\"`\n    Password string `xml:\"password\"`\n}\n\ntype ErrorMessage struct {\n    XMLName xml.Name `xml:\"error\"`\n    Error string `xml:\"error_code\"`\n    Message string `xml:\"message\"`\n}\n\ntype Auth struct {\n    XMLName xml.Name `xml:\"config\"`\n    Nas_SharingEmpty  int `xml:\"nas_sharing&gt;auth_state\"`\n}\n\ntype ConfigGenre struct {\n    XMLName xml.Name `xml:\"config\"`\n    Nas_Sharing  GenreArray `xml:\"nas_sharing\"`\n}\n\ntype genreAPI []Genre\n\nvar dbmap = initDb()\n\nfunc initDb() *gorp.DbMap {\n\n    db, err := sql.Open(\"mysql\", \"root@tcp(localhost:3306)/mymusic\")\n    checkErr(err, \"sql.Open failed\")\n    dbmap := &amp;gorp.DbMap{Db: db, Dialect: gorp.MySQLDialect{\"InnoDB\", \"UTF8\"}}\n\n    return dbmap\n}\n\nfunc checkErr(err error, msg string) {\n    if err != nil {\n        log.Fatalln(msg, err)\n    }\n}\n\nfunc main() {\n    r := gin.Default()\n    r.POST(\"/nas_sharing\", myMusicXML)\n    r.Run(\":9999\")\n}\n\nfunc myMusicXML(c *gin.Context) {\n\n    c.Request.ParseForm()\n    cmd := c.Request.Form.Get(\"cmd\")\n    usernamepost := c.Request.Form.Get(\"user\")\n    passwordpost := c.Request.Form.Get(\"passwd\")\n\n    if cmd == \"36\" {\n    //Music Genre List API\n\n        var genre []Genre\n        var userpass []UserPass\n        var count int64\n        var countAuth int64\n\n        //Query the post username and password\n        _, errAuth := dbmap.Select(&amp;userpass, \"SELECT username, password FROM user WHERE username=? and password=?\", usernamepost, passwordpost)\n\n        //Check if post username and password exist\n        countAuth, errAuth = dbmap.SelectInt(\"select count(*) FROM user WHERE username=? and password=?\", usernamepost, passwordpost)\n        if countAuth == 0 {\n            //If no rows detected, output a message\n            c.XML(404, Auth{Nas_SharingEmpty: 0})\n        }else{\n            //Check if query is valid\n            if errAuth == nil {\n                log.Println(\"auth_state :\", countAuth)\n            }else{\n                c.XML(404, gin.H{\"error\": \"sql query error found\"})\n            }\n\n            //Query genre list\n            _, err := dbmap.Select(&amp;genre, \"SELECT Title FROM genre_cntr_tbl\")\n\n            //Count genres\n            count, err = dbmap.SelectInt(\"select count(*) FROM genre_cntr_tbl\")\n            if count == 0 {\n                //If no rows detected, output a message\n                c.XML(404, ErrorMessage{Error:\"404\", Message: \"no genre found\"})\n            }else{\n                //Check if query is valid\n                if err == nil {\n                    log.Println(\"Genres :\", genre)\n                    c.XML(200, ConfigGenre{Nas_Sharing: GenreArray{Auth_state: 1, Count: count, Item: genre,}})\n                }else{\n                    c.XML(404, gin.H{\"error\": \"sql query error found\"})\n                }\n            }\n        }\n    }else{\n        c.XML(404, ErrorMessage{Error:\"404\", Message: \"command not found\"})\n    }\n}\n</code></pre>\n\n<p>And here is the output:</p>\n\n<pre><code>&lt;config&gt;\n&lt;nas_sharing&gt;\n    &lt;auth_state&gt;1&lt;/auth_state&gt;\n    &lt;count&gt;8&lt;/count&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Pop&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Rock&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Dance&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Opera&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Techno&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Hip Hop&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Jazz&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Reggae&lt;/genre&gt;\n    &lt;/item&gt;\n&lt;/nas_sharing&gt;\n</code></pre>\n\n<p></p>\n\n<p>Here is the value of genre of my output to log(note: It came from a database):</p>\n\n<pre><code>Genres : [{Pop} {Rock} {Dance} {Opera} {Techno} {Hiphop} {Jazz} {Reggae}]  \n</code></pre>\n\n<p>However, I would like to convert the output to base64 format. Here's a sample code for encoding to base64 but the data given to this is <code>string</code> unlike the one I develop that comes from an array. How could I achieve that output?</p>\n\n<pre><code>data := \"/MyMusic/images/_albums/albums_nophoto.png\"\nsEnc := b64.StdEncoding.EncodeToString([]byte(data))\nfmt.Println(sEnc)\n</code></pre>\n\n<p>Here is what output I expected</p>\n\n<pre><code>&lt;config&gt;\n&lt;nas_sharing&gt;\n    &lt;auth_state&gt;1&lt;/auth_state&gt;\n    &lt;count&gt;8&lt;/count&gt;\n    &lt;item&gt;\n        &lt;genre&gt;UG9w&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;Um9jaw==&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;RGFuY2U=&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;T3BlcmE=&lt;/genre&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n        &lt;genre&gt;VGVjaG5v&lt;/genre&gt;\n    &lt;/item&gt;\n    etc...\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 991, "user_id": 146446, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1d5e8e86e4c8be8cfb5cd58ff37a6a26?s=128&d=identicon&r=PG", "display_name": "Gabe", "link": "https://stackoverflow.com/users/146446/gabe"}, "edited": false, "score": 1, "creation_date": 1433907950, "post_id": 30746629, "comment_id": 49548403, "body": "Thanks! Do you have a pointer to any place that the convention is mentioned?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 991, "user_id": 146446, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1d5e8e86e4c8be8cfb5cd58ff37a6a26?s=128&d=identicon&r=PG", "display_name": "Gabe", "link": "https://stackoverflow.com/users/146446/gabe"}, "edited": false, "score": 0, "creation_date": 1433913543, "post_id": 30746629, "comment_id": 49549972, "body": "No, sorry. I think this is just a convention."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 12, "last_activity_date": 1433907217, "creation_date": 1433907217, "answer_id": 30746629, "question_id": 30746166, "link": "https://stackoverflow.com/questions/30746166/is-os-files-write-threadsafe/30746629#30746629", "title": "Is os.File&#39;s Write() threadsafe?", "body": "<p>The convention (at least for the standard library) is the following: No function/method is safe for concurrent use unless explicitly stated (or obvious from the context).</p>\n\n<p>It is not safe to write concurrently to an <code>os.File</code> via <code>Write()</code> without external synchronization.</p>\n"}, {"tags": [], "owner": {"reputation": 362, "user_id": 2544044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e4021f92a8fe5f2a4620ef45bfebc6?s=128&d=identicon&r=PG", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/2544044/chris-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1433985447, "last_edit_date": 1495535445, "creation_date": 1433985447, "answer_id": 30769989, "question_id": 30746166, "link": "https://stackoverflow.com/questions/30746166/is-os-files-write-threadsafe/30769989#30769989", "title": "Is os.File&#39;s Write() threadsafe?", "body": "<p>After browsing the source code a little bit I found the following method which is eventually called by file.Write(). Since there are race condition checks in place, I'm assuming that the call is in fact not thread-safe within Go (<a href=\"http://golang.org/src/syscall/syscall_unix.go?s=3386:3433#L138\" rel=\"nofollow noreferrer\">Source</a>).</p>\n\n<p>However, it seemed unlikely that those system calls wouldn't be thread-safe on an OS level. After some browsing I came upon <a href=\"https://stackoverflow.com/a/12025655/2544044\">this interesting answer</a> that fueled my suspicions even more. For windows the <a href=\"https://golang.org/src/syscall/syscall_windows.go\" rel=\"nofollow noreferrer\">source</a> indicates a call to <a href=\"https://msdn.microsoft.com/nl-nl/library/windows/apps/aa365747.aspx\" rel=\"nofollow noreferrer\">WriteFile</a> which also appears to be <a href=\"https://stackoverflow.com/questions/15894082/writefile-thread-safety\">thread safe</a>.</p>\n"}], "owner": {"reputation": 991, "user_id": 146446, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1d5e8e86e4c8be8cfb5cd58ff37a6a26?s=128&d=identicon&r=PG", "display_name": "Gabe", "link": "https://stackoverflow.com/users/146446/gabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2684, "favorite_count": 0, "accepted_answer_id": 30746629, "answer_count": 2, "score": 5, "last_activity_date": 1469536352, "creation_date": 1433903962, "last_edit_date": 1469536352, "question_id": 30746166, "link": "https://stackoverflow.com/questions/30746166/is-os-files-write-threadsafe", "title": "Is os.File&#39;s Write() threadsafe?", "body": "<p>I was wondering if calling Write() on an os.File is thread safe.  I'm having a hard time finding any mention of thread safety in the docs.</p>\n"}, {"tags": ["pointers", "go"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 47, "last_activity_date": 1433895913, "creation_date": 1433895913, "answer_id": 30745101, "question_id": 30744965, "link": "https://stackoverflow.com/questions/30744965/how-to-get-the-pointer-of-return-value-from-function-call/30745101#30745101", "title": "How to get the pointer of return value from function call?", "body": "<p>The probably unsatisfying answer is \"you can't do it because the spec says so.\" The spec says that to use <code>&amp;</code> on something it has to be <a href=\"http://golang.org/ref/spec#Address_operators\" rel=\"noreferrer\">addressable</a> or a compound literal, and to be addressable it has to be \"a variable, pointer indirection, or slice indexing operation; or a a field selector of an addressable struct operand; or an array indexing operation of an addressable array.\" Function calls and method calls are definitely not on the list.</p>\n\n<p>Practically speaking, it's probably because the return value of a function may not <em>have</em> a usable address; it may be in a register (in which case it's definitely not addressable) or on the stack (in which case it has an address, but one that won't be valid if it's put in a pointer that escapes the current scope. To guarantee addressability, Go would have to do pretty much the exact equivalent of assigning it to a variable. But Go is the kind of language that figures that if it's going to allocate storage for a variable it's going to be because you said to, not because the compiler magically decided to. So it doesn't make the result of a function addressable.</p>\n\n<p>Or I could be over-thinking it and they simply didn't want to have a special case for functions that return <em>one</em> value versus functions that return multiple :)</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 29, "last_activity_date": 1562830732, "last_edit_date": 1562830732, "creation_date": 1433925152, "answer_id": 30751102, "question_id": 30744965, "link": "https://stackoverflow.com/questions/30744965/how-to-get-the-pointer-of-return-value-from-function-call/30751102#30751102", "title": "How to get the pointer of return value from function call?", "body": "<p>You can't directly take the address of a function call (or more precisely the return value(s) of the function) as described by hobbs.</p>\n\n<p>There is another way but it is ugly:</p>\n\n<pre><code>p := &amp;[]time.Time{time.Now()}[0]\nfmt.Printf(\"%T %p\\n%v\", p, p, *p)\n</code></pre>\n\n<p>Output (<a href=\"http://play.golang.org/p/1-hYdvRHNc\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>*time.Time 0x10438180\n2009-11-10 23:00:00 +0000 UTC\n</code></pre>\n\n<p>What happens here is a <code>struct</code> is created with a literal, containing one element (the return value of <code>time.Now()</code>), the slice is indexed (0<sup>th</sup> element) and the address of the 0<sup>th</sup> element is taken.</p>\n\n<p>So rather just use a local variable:</p>\n\n<pre><code>t := time.Now()\np := &amp;t\n</code></pre>\n\n<p>Or a helper function:</p>\n\n<pre><code>func ptr(t time.Time) *time.Time {\n    return &amp;t\n}\n\np := ptr(time.Now())\n</code></pre>\n\n<p>Which can also be a one-liner anonymous function:</p>\n\n<pre><code>p := func() *time.Time { t := time.Now(); return &amp;t }()\n</code></pre>\n\n<p>Or as an alternative:</p>\n\n<pre><code>p := func(t time.Time) *time.Time { return &amp;t }(time.Now())\n</code></pre>\n\n<p>For even more alternatives, see:</p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/30716354/how-do-i-do-a-literal-int64-in-go\">How do I do a literal *int64 in Go?</a></strong></p>\n\n<p>Also see related question: <a href=\"https://stackoverflow.com/questions/34197248/how-can-i-store-reference-to-the-result-of-an-operation-in-go/34197367#34197367\">How can I store reference to the result of an operation in Go?</a></p>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 2672500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dcfdcfde8c781ab3be905da858d01d9?s=128&d=identicon&r=PG", "display_name": "Jean Spector", "link": "https://stackoverflow.com/users/2672500/jean-spector"}, "edited": false, "score": 0, "creation_date": 1591722805, "post_id": 59706939, "comment_id": 110161921, "body": "The answer doesn&#39;t seem to be relevant to the OP&#39;s question as the example mentions time.Time() - which you can&#39;t modify."}], "tags": [], "owner": {"reputation": 153, "user_id": 8704430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e348ef7b41694b6635199391d860889e?s=128&d=identicon&r=PG&f=1", "display_name": "user40176", "link": "https://stackoverflow.com/users/8704430/user40176"}, "is_accepted": false, "score": 0, "last_activity_date": 1578853998, "creation_date": 1578853998, "answer_id": 59706939, "question_id": 30744965, "link": "https://stackoverflow.com/questions/30744965/how-to-get-the-pointer-of-return-value-from-function-call/59706939#59706939", "title": "How to get the pointer of return value from function call?", "body": "<p>If you are having this trouble with a function you wrote, change your function to return a pointer. Even though you can't take the address of a return value, you <em>can</em> dereference a return value, so it will be suitable whether you want the pointer or the object.</p>\n\n<pre><code>func Add(x, y int) *int {\n    tmp := x + y\n    return &amp;tmp\n}\n\nfunc main() {\n    fmt.Println(\"I want the pointer: \", Add(3, 4))\n    fmt.Println(\"I want the object: \", *Add(3, 4))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/RogRZDNGdmY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RogRZDNGdmY</a></p>\n"}], "owner": {"reputation": 477, "user_id": 2169469, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4712d1bf23ea18fde09e1eb8f74ee886?s=128&d=identicon&r=PG", "display_name": "Meng", "link": "https://stackoverflow.com/users/2169469/meng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11786, "favorite_count": 11, "answer_count": 3, "score": 39, "last_activity_date": 1578853998, "creation_date": 1433894823, "last_edit_date": 1556636296, "question_id": 30744965, "link": "https://stackoverflow.com/questions/30744965/how-to-get-the-pointer-of-return-value-from-function-call", "title": "How to get the pointer of return value from function call?", "body": "<p>I just need a pointer to time.Time, so the code below seems invalid:</p>\n\n<blockquote>\n  <p>./c.go:5: cannot take the address of time.Now()</p>\n</blockquote>\n\n<p>I just wonder why? Is there any way to do that except to do assignment to a variable first and take the pointer of the variable?</p>\n\n<pre><code>package main\n\nimport \"time\"\nfunc main() {\n    _ = &amp;time.Now()\n}\n</code></pre>\n"}, {"tags": ["go", "com", "wmi"], "comments": [{"owner": {"reputation": 13116, "user_id": 17373, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da1209aa320f9bbebbf128ac6a0751d3?s=128&d=identicon&r=PG", "display_name": "Greg Bray", "link": "https://stackoverflow.com/users/17373/greg-bray"}, "edited": false, "score": 0, "creation_date": 1433895001, "post_id": 30744205, "comment_id": 49545447, "body": "It may be easier to start testing with something simple like the StartService/StopService methods of the object path: <code>\\\\.\\root\\cimv2:Win32_Service.Name=&quot;AudioSrv&quot;</code>, Which you should see take effect by the volume icon in the system tray. You could also look at using SWbemServices.ExecMethod from <a href=\"https://msdn.microsoft.com/en-us/library/aa393862(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa393862(v=vs.85).aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13116, "user_id": 17373, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da1209aa320f9bbebbf128ac6a0751d3?s=128&d=identicon&r=PG", "display_name": "Greg Bray", "link": "https://stackoverflow.com/users/17373/greg-bray"}, "is_accepted": false, "score": 1, "last_activity_date": 1433891279, "creation_date": 1433891279, "answer_id": 30744362, "question_id": 30744205, "link": "https://stackoverflow.com/questions/30744205/calling-a-method-of-a-wmi-class/30744362#30744362", "title": "Calling a method of a WMI Class", "body": "<p>Running <strong>wbemtest.exe</strong> as an administrator you can open the MSFT_DSCLocalConfigurationManager class and use <strong>Show MOF</strong> to see it's class definition:</p>\n\n<pre><code>[ClassVersion(\"1.0.0\"), locale(1033), dynamic: ToInstance, provider(\"dsccore\"): ToInstance]\nclass MSFT_DSCLocalConfigurationManager\n{\n    [implemented, static: DisableOverride ToSubClass] uint32 SendConfiguration([In, Octetstring: DisableOverride ToSubClass] uint8 ConfigurationData[], [In] boolean force);\n    [implemented, static: DisableOverride ToSubClass] uint32 SendConfigurationApply([In, Octetstring: DisableOverride ToSubClass] uint8 ConfigurationData[], [In] boolean force);\n    [implemented, static: DisableOverride ToSubClass] uint32 GetConfiguration([In, Octetstring: DisableOverride ToSubClass] uint8 configurationData[], [Stream: DisableOverride ToSubClass, EmbeddedInstance(\"OMI_BaseResource\"): ToSubClass, Out] OMI_BaseResource configurations[]);\n    [implemented, static: DisableOverride ToSubClass] uint32 TestConfiguration([In, Octetstring: DisableOverride ToSubClass] uint8 configurationData[], [Out] boolean InDesiredState, [Out, EmbeddedInstance(\"MSFT_ResourceInDesiredState\"): ToSubClass] MSFT_ResourceInDesiredState ResourcesInDesiredState[], [Out, EmbeddedInstance(\"MSFT_ResourceNotInDesiredState\"): ToSubClass] MSFT_ResourceNotInDesiredState ResourcesNotInDesiredState[]);\n    [implemented, static: DisableOverride ToSubClass] uint32 ApplyConfiguration([In] boolean force);\n    [implemented, static: DisableOverride ToSubClass] uint32 SendMetaConfigurationApply([In, Octetstring: DisableOverride ToSubClass] uint8 ConfigurationData[]);\n    [implemented, static: DisableOverride ToSubClass] uint32 GetMetaConfiguration([Out, EmbeddedInstance(\"MSFT_DSCMetaConfiguration\"): ToSubClass] MSFT_DSCMetaConfiguration MetaConfiguration);\n    [implemented, static: DisableOverride ToSubClass] uint32 RollBack([In] uint8 configurationNumber);\n    [implemented, static: DisableOverride ToSubClass] uint32 PerformRequiredConfigurationChecks([In] uint32 Flags);\n    [implemented, static: DisableOverride ToSubClass] uint32 StopConfiguration([In] boolean force);\n    [implemented, static: DisableOverride ToSubClass] uint32 GetConfigurationStatus([In] uint32 Flags, [Stream: DisableOverride ToSubClass, EmbeddedInstance(\"MSFT_DSCConfigurationStatus\"): ToSubClass, Out] MSFT_DSCConfigurationStatus configurationStatus[]);\n    [implemented, static: DisableOverride ToSubClass] uint32 SendConfigurationApplyAsync([In, Octetstring: DisableOverride ToSubClass] uint8 ConfigurationData[], [In] boolean force, [In] string jobId);\n    [implemented, static: DisableOverride ToSubClass] uint32 GetConfigurationResultOutput([In] string jobId, [In, Octetstring: DisableOverride ToSubClass] uint8 resumeOutputBookmark[], [Out, Stream: DisableOverride ToSubClass, EmbeddedInstance(\"MSFT_DSCConfigurationOutput\"): ToSubClass] MSFT_DSCConfigurationOutput output[]);\n    [implemented, static: DisableOverride ToSubClass] uint32 RemoveConfiguration([In] uint32 Stage, [In] boolean Force);\n    [implemented, static: DisableOverride ToSubClass] uint32 ResourceGet([In] string ResourceType, [In] string ModuleName, [In, Octetstring: DisableOverride ToSubClass] uint8 resourceProperty[], [Stream: DisableOverride ToSubClass, EmbeddedInstance(\"OMI_BaseResource\"): ToSubClass, Out] OMI_BaseResource configurations[]);\n    [implemented, static: DisableOverride ToSubClass] uint32 ResourceSet([In] string ResourceType, [In] string ModuleName, [In, Octetstring: DisableOverride ToSubClass] uint8 resourceProperty[], [Out] boolean RebootRequired);\n    [implemented, static: DisableOverride ToSubClass] uint32 ResourceTest([In] string ResourceType, [In] string ModuleName, [In, Octetstring: DisableOverride ToSubClass] uint8 resourceProperty[], [Out] boolean InDesiredState);\n};\n</code></pre>\n\n<p>GetConfiguration is a method used to return the current configuration document, not the status of the last DSC run. You may be using an older version of DSC, make sure <strong>$psversiontable</strong> in powershell shows at least 5.0.10018.0.</p>\n\n<p>wbemtest.exe will also let you use IWbemServices to execute a method (similar to the code you have above)</p>\n\n<p><img src=\"https://i.stack.imgur.com/u4Rw8.png\" alt=\"wbemtest.exe\"></p>\n\n<p>and it shows the output parameters are of type:</p>\n\n<pre><code>[abstract]\nclass __PARAMETERS\n{\n    [Stream: DisableOverride ToSubClass, EmbeddedInstance(\"MSFT_DSCConfigurationStatus\"): ToSubClass, Out, ID(1): DisableOverride ToInstance] MSFT_DSCConfigurationStatus configurationStatus[] = {\ninstance of MSFT_DSCConfigurationStatus\n{\n    DurationInSeconds = 33;\n    HostName = \"GBRAY02\";\n</code></pre>\n"}], "owner": {"reputation": 16582, "user_id": 864236, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf2143f14e4018a342ce93aa0fad00c6?s=128&d=identicon&r=PG", "display_name": "mjibson", "link": "https://stackoverflow.com/users/864236/mjibson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1433891279, "creation_date": 1433890424, "question_id": 30744205, "link": "https://stackoverflow.com/questions/30744205/calling-a-method-of-a-wmi-class", "title": "Calling a method of a WMI Class", "body": "<p>I'm attempting to call the following method: <a href=\"https://msdn.microsoft.com/en-us/library/dn469242(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/dn469242(v=vs.85).aspx</a></p>\n\n<p>The corresponding powershell is:</p>\n\n<p><code>wmic /namespace:\\\\ROOT\\Microsoft\\Windows\\DesiredStateConfiguration class MSFT_DSCLocalConfigurationManager call GetConfigurationStatus\n</code></p>\n\n<p>I can't quite figure out how to do it correctly using go-ole. Here's what I have so far. It fails with: <code>invoke_test.go:47: wmi: error calling method GetConfiguration: Exception occurred. Generic failure )</code></p>\n\n<p>When I try using <code>GetConfigurationStatus</code> instead of <code>GetConfiguration</code>, I get a <code>Unknown name</code> error, so I suspect this method exists I'm just invoking it wrong.</p>\n\n<pre><code>package wmi\n\nimport (\n    \"testing\"\n\n    \"github.com/go-ole/go-ole\"\n    \"github.com/go-ole/go-ole/oleutil\"\n)\n\nfunc TestMethod(t *testing.T) {\n    err := ole.CoInitializeEx(0, ole.COINIT_MULTITHREADED)\n    if err != nil {\n        t.Fatal(err)\n    }\n\n    unknown, err := oleutil.CreateObject(\"WbemScripting.SWbemLocator\")\n    if err != nil {\n        t.Fatal(err)\n    }\n    defer unknown.Release()\n\n    wmi, err := unknown.QueryInterface(ole.IID_IDispatch)\n    if err != nil {\n        t.Fatal(err)\n    }\n    defer wmi.Release()\n\n    serviceRaw, err := oleutil.CallMethod(wmi, \"ConnectServer\", nil, `ROOT\\Microsoft\\Windows\\DesiredStateConfiguration`)\n    if err != nil {\n        t.Fatal(err)\n    }\n    service := serviceRaw.ToIDispatch()\n    defer serviceRaw.Clear()\n\n    typeName := \"MSFT_DSCLocalConfigurationManager\"\n    typeRaw, err := oleutil.CallMethod(service, \"Get\", typeName)\n    if err != nil {\n        t.Fatalf(\"wmi: error fetching type %v: %v\", typeName, err)\n    }\n    typeResult := typeRaw.ToIDispatch()\n    defer typeRaw.Clear()\n\n    methodName := \"GetConfiguration\"\n    methodRaw, err := oleutil.CallMethod(typeResult, methodName)\n    if err != nil {\n        t.Fatalf(\"wmi: error calling method %v: %v\", methodName, err)\n    }\n    item := methodRaw.ToIDispatch()\n    defer methodRaw.Clear()\n    _ = item\n}\n</code></pre>\n"}, {"tags": ["windows", "go"], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1433888817, "post_id": 30743623, "comment_id": 49543548, "body": "Why not use the C dll when it&#39;s THAT easy?!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2675699"}, "edited": false, "score": 0, "creation_date": 1433900523, "post_id": 30743623, "comment_id": 49546716, "body": "This is awesome! Thanks!"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433948396, "post_id": 30743623, "comment_id": 49573082, "body": "To change <code>GOOS</code> for a single <code>godoc</code> query it&#39;s easier and better to do something like <code>env GOOS=windows godoc syscall</code> instead (at least from unix-like systems that have <code>env</code>; as a plus, unlike your export statements it&#39;s shell agnostic but more importantly it doesn&#39;t muck with the settings beyond the one command)."}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 5, "last_activity_date": 1433927654, "last_edit_date": 1433927654, "creation_date": 1433887409, "answer_id": 30743623, "question_id": 30743070, "link": "https://stackoverflow.com/questions/30743070/query-total-physical-memory-in-windows-with-golang/30743623#30743623", "title": "Query total physical memory in Windows with Golang", "body": "<p>The official online godoc for the syscall package at <a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow\">https://golang.org/pkg/syscall/</a> seems to document Linux APIs so it is somewhat hard to find the resources online.</p>\n\n<p>First thing to do is to run godoc on the Windows platform, or on any platform by changing the values of <code>GOOS</code> and <code>GOARCH</code>.</p>\n\n<p>For example, the following commands run in a Linux shell allow godoc to believe it runs on Windows, and therefore document the corresponding files:</p>\n\n<pre><code>export GOOS=windows\nexport GOARCH=amd64\ngodoc -http=:8080\n</code></pre>\n\n<p>Accessing <a href=\"http://localhost:8080/pkg/syscall/\" rel=\"nofollow\">http://localhost:8080/pkg/syscall/</a> in a browser shows the Windows syscall API docs.</p>\n\n<p>A quick search reveals an interesting function on MSDN, namely <code>GetPhysicallyInstalledSystemMemory</code> (see <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/cc300158(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/desktop/cc300158(v=vs.85).aspx</a>).</p>\n\n<p>Apparently, this function does not exist in the Windows Go syscall package, so calling it directly is not possible.</p>\n\n<p>Since the MSDN page shows that this function is present in <code>kernel32.dll</code> a solution given by this page (<a href=\"https://github.com/golang/go/wiki/WindowsDLLs\" rel=\"nofollow\">https://github.com/golang/go/wiki/WindowsDLLs</a>) exists, that does not involve interfacing with C.<br>\nAdapting the technique to this function gives us the following code:</p>\n\n<pre><code>//+build windows\npackage main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nfunc main() {\n    var mod = syscall.NewLazyDLL(\"kernel32.dll\")\n    var proc = mod.NewProc(\"GetPhysicallyInstalledSystemMemory\")\n    var mem uint64\n\n    ret, _, err := proc.Call(uintptr(unsafe.Pointer(&amp;mem)))\n    fmt.Printf(\"Ret: %d, err: %v, Physical memory: %d\\n\", ret, err, mem)\n}\n</code></pre>\n\n<p>When run, this outputs:</p>\n\n<blockquote>\n  <p>Ret: 1, err: L\u2019op\u00e9ration a r\u00e9ussi., Physical memory: 16777216</p>\n</blockquote>\n\n<p>The value is given in kilobytes, so divide by 1048576 (1024*1024) to obtain a value in gigabytes.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2675699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1739, "favorite_count": 1, "accepted_answer_id": 30743623, "answer_count": 1, "score": 5, "last_activity_date": 1433927654, "creation_date": 1433884938, "last_edit_date": 1433885612, "question_id": 30743070, "link": "https://stackoverflow.com/questions/30743070/query-total-physical-memory-in-windows-with-golang", "title": "Query total physical memory in Windows with Golang", "body": "<p>Trying to get the total physical memory using Go on Windows but not sure which package(s) to use and calls to make. I believe this can be done with <code>syscall</code>. Would also prefer not to interface with C to do this.</p>\n"}, {"tags": ["testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 10611, "user_id": 973810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/fc35612d4cb8ba65f31a6d028bcf138e?s=128&d=identicon&r=PG", "display_name": "Darth Egregious", "link": "https://stackoverflow.com/users/973810/darth-egregious"}, "edited": false, "score": 0, "creation_date": 1433942706, "post_id": 30743582, "comment_id": 49568449, "body": "That works for packages, but not generated code within the same project. I like your avatar, Dude!"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 10611, "user_id": 973810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/fc35612d4cb8ba65f31a6d028bcf138e?s=128&d=identicon&r=PG", "display_name": "Darth Egregious", "link": "https://stackoverflow.com/users/973810/darth-egregious"}, "edited": false, "score": 1, "creation_date": 1433952207, "post_id": 30743582, "comment_id": 49575854, "body": "@Fuser97381 can&#39;t you put the generated code somewhere else? What I do is simple: I put the generated code in a separate project, that includes only thrift gen stuff (this also helps by making generation a build job), and is imported with go get. Then the coverage of my app does not include the metrics for this library. The Dude Abides!"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 10611, "user_id": 973810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/fc35612d4cb8ba65f31a6d028bcf138e?s=128&d=identicon&r=PG", "display_name": "Darth Egregious", "link": "https://stackoverflow.com/users/973810/darth-egregious"}, "edited": false, "score": 0, "creation_date": 1433966958, "post_id": 30743582, "comment_id": 49584679, "body": "@Fuser97381 I&#39;m assuming the &quot;selected&quot; is because of my comment? If so, I&#39;ll modify my answer to describe this pattern in greater detail for future generations."}, {"owner": {"reputation": 10611, "user_id": 973810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/fc35612d4cb8ba65f31a6d028bcf138e?s=128&d=identicon&r=PG", "display_name": "Darth Egregious", "link": "https://stackoverflow.com/users/973810/darth-egregious"}, "edited": false, "score": 1, "creation_date": 1433969461, "post_id": 30743582, "comment_id": 49586200, "body": "That would really tie this question together. It takes an answerer like you to get through to the asker in me. You&#39;re answering easy for all us sinners."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1434004518, "last_edit_date": 1434004518, "creation_date": 1433887207, "answer_id": 30743582, "question_id": 30742456, "link": "https://stackoverflow.com/questions/30742456/how-to-exclude-generated-code-from-coverage-statistics/30743582#30743582", "title": "How to exclude generated code from coverage statistics", "body": "<p>This help message from <code>go test</code> seems to suggest you can filter the packages you're testing:</p>\n\n<pre><code>-coverpkg pkg1,pkg2,pkg3\n    Apply coverage analysis in each test to the given list of packages.\n    The default is for each test to analyze only the package being tested.\n    Packages are specified as import paths.\n    Sets -cover.\n</code></pre>\n\n<p>Another simpler option, and this is what I do, is to import the generated code as a library package that sits outside your code tree, and thus the cover tool ignores it in its stats.</p>\n\n<p>e.g. if your app is <code>github.com/Fuser97381/myproj</code>, put the generated code in <code>github.com/Fuser97381/protocols</code>. Then your code looks like this:</p>\n\n<pre><code>package main\n\nimport (\n      \"github.com/Fuser97381/protocols/myproto\"\n      \"git.apache.org/thrift.git/lib/go/thrift\"\n)\n\n...\n</code></pre>\n"}], "owner": {"reputation": 10611, "user_id": 973810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/fc35612d4cb8ba65f31a6d028bcf138e?s=128&d=identicon&r=PG", "display_name": "Darth Egregious", "link": "https://stackoverflow.com/users/973810/darth-egregious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "accepted_answer_id": 30743582, "answer_count": 1, "score": 2, "last_activity_date": 1434004518, "creation_date": 1433882596, "question_id": 30742456, "link": "https://stackoverflow.com/questions/30742456/how-to-exclude-generated-code-from-coverage-statistics", "title": "How to exclude generated code from coverage statistics", "body": "<p>I have thrift generated code in my project? How do I stop this from affecting my coverage stats? They're dismal.</p>\n"}, {"tags": ["github", "go", "makefile", "travis-ci"], "answers": [{"tags": [], "owner": {"reputation": 376, "user_id": 4981332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e1b1e4adb0a6d62718938f1ae9822?s=128&d=identicon&r=PG", "display_name": "devfubar", "link": "https://stackoverflow.com/users/4981332/devfubar"}, "is_accepted": true, "score": 2, "last_activity_date": 1434544668, "creation_date": 1434544668, "answer_id": 30891836, "question_id": 30741937, "link": "https://stackoverflow.com/questions/30741937/git-tag-name-as-version-in-go-via-travis-ci/30891836#30891836", "title": "Git tag name as version in Go via Travis-CI", "body": "<p>So I fixed this my self.</p>\n\n<p>My problem in the above example was in the Travis file. I seems I needed quotes around my \"script\" parameter. For completeness here is my new Travis file;</p>\n\n<pre><code>language: go\nscript: \n - \"make VERSION=$TRAVIS_TAG\"\ngo:\n - 1.4.1\ndeploy:\n  provider: releases\n  api_key:\n    secure: reallylongsecurestring\n  file: releasebin\n  skip_cleanup: true\n  on:\n    tags: true\n</code></pre>\n"}], "owner": {"reputation": 376, "user_id": 4981332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e1b1e4adb0a6d62718938f1ae9822?s=128&d=identicon&r=PG", "display_name": "devfubar", "link": "https://stackoverflow.com/users/4981332/devfubar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 30891836, "answer_count": 1, "score": 1, "last_activity_date": 1434544668, "creation_date": 1433880790, "last_edit_date": 1592644375, "question_id": 30741937, "link": "https://stackoverflow.com/questions/30741937/git-tag-name-as-version-in-go-via-travis-ci", "title": "Git tag name as version in Go via Travis-CI", "body": "<p>Essentially what I want to do is embed the git tag name (from a github release) to a version string within my GO code.</p>\n<p>If I use this code;</p>\n<pre><code>package main\n    \nimport (\n    &quot;flag&quot;\n    &quot;fmt&quot;\n)\n    \nvar version string\n    \nfunc main() {\n\n    var verFlag bool\n    flag.BoolVar(&amp;verFlag, &quot;version&quot;, false, &quot;Returns the version number&quot;)\n\n    var confPath string\n    flag.StringVar(&amp;confPath, &quot;conf&quot;, &quot;conf.yml&quot;, &quot;Location on config file&quot;)\n\n    flag.Parse()\n    \n    // if the user wants to see the version\n    if verFlag {\n        fmt.Printf(&quot;%s&quot;, version)\n        return\n    }\n}\n</code></pre>\n<p>what's the best way of setting &quot;VERSION&quot; in <code>-ldflags '-X main.version VERSION'</code> to <code>$TRAVIS_TAG</code> during a build in Travis-CI,</p>\n<blockquote>\n<p>Additionally, Travis CI sets environment variables you can use in your build, e.g. to tag the build, or to run post-build deployments.</p>\n<p>TRAVIS_TAG: If the current build for a tag, this includes the tag\u2019s name</p>\n</blockquote>\n<p>My last effort was to use this make file:</p>\n<pre><code>GOFLAGS ?= $(GOFLAGS:)\n\nTAG := $(VERSION)\nifeq ($(TAG),)\n  BRANCH := $(shell git rev-parse --abbrev-ref HEAD)\n  DT := $(shell date '+%F::%T')\n  VSN := $(BRANCH)-$(DT)\nelse\n  VSN := $(TAG)\nendif\n\nENV := $(shell printenv)\n\nGOFLAGS = -ldflags '-X main.version $(VSN)'\n\ndefault:\n    all\n\nall: \n    test\n    install\n\ninstall:\n    get-deps\n    @go build $(GOFLAGS) *.go\n\ntest:\n    @go test $(GOFLAGS) ./...\n\nget-deps:\n    @go get ./...\n\nclean:\n    @go clean $(GOFLAGS) -i ./\n</code></pre>\n<p>with this travis config file;</p>\n<pre><code>language: go\nscript: make VERSION=$TRAVIS_TAG\ngo:\n- 1.4.1\ndeploy:\n  provider: releases\n  api_key:\n    secure: reallylongsecurestring\n  file: releasebin\n  skip_cleanup: true\n  on:\n    tags: true\n</code></pre>\n<p>However no matter what variation I try, and I have tried many different flavours of essentially this example, it seems that the binary that ends up in my github release does not contain the tag name.  What is observed is the branch and date version string that results from when no version string is set in the make file.  I have tried this make file on my dev machine and set environment variable to the expected in Travis and it works as expected.  I am also clear that I dont expect this to happen on commit builds but only on releases from github ie when a tag is created.</p>\n"}, {"tags": ["javascript", "python", "arrays", "recursion", "go"], "comments": [{"owner": {"reputation": 33388, "user_id": 2437514, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8QN0K.jpg?s=128&g=1", "display_name": "Rick supports Monica", "link": "https://stackoverflow.com/users/2437514/rick-supports-monica"}, "edited": false, "score": 0, "creation_date": 1433878768, "post_id": 30741231, "comment_id": 49538412, "body": "the way you have it built, you&#39;d basically have multiple finite sets of related words (one set would be {computer, electronics, PC, abacus}, another would be {feline, kitten, cat, mouser, bag, gear, pack, etc etc etc}). why not just write code to define all those sets ahead of time, and then test if the two words are both a member of any one set?"}, {"owner": {"reputation": 873, "user_id": 1057015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16e625ef0bb65ea7995547d72dc746c?s=128&d=identicon&r=PG", "display_name": "DiogoDoreto", "link": "https://stackoverflow.com/users/1057015/diogodoreto"}, "edited": false, "score": 0, "creation_date": 1433878885, "post_id": 30741231, "comment_id": 49538483, "body": "This seems to be a great fit for Prolog"}, {"owner": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 0, "creation_date": 1433878938, "post_id": 30741231, "comment_id": 49538524, "body": "The code reads in all the Words from a thesaurus, so each word has a different amound of synonyms. Also, it would be ideal if the method could check for relationships between different &quot;distances&quot; so it could find relationships potentially 5 (or more) words apart."}, {"owner": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 0, "creation_date": 1433879012, "post_id": 30741231, "comment_id": 49538582, "body": "I&#39;m not familiar with Prolog, what benefits would it provide?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1433879220, "post_id": 30741231, "comment_id": 49538727, "body": "This can easily be done with the tools in Go. All you have to do is recursively apply the transitive property to your collection. I&#39;ll be working on a solution during my spare time today."}, {"owner": {"reputation": 873, "user_id": 1057015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16e625ef0bb65ea7995547d72dc746c?s=128&d=identicon&r=PG", "display_name": "DiogoDoreto", "link": "https://stackoverflow.com/users/1057015/diogodoreto"}, "edited": false, "score": 0, "creation_date": 1433879373, "post_id": 30741231, "comment_id": 49538828, "body": "Prolog have a declarative syntax to build relations and allow you to query those relations... I&#39;m sorry I can&#39;t show you an example because I&#39;ve learned it some years ago. If no good answer shows up, maybe is worth read about it."}, {"owner": {"reputation": 873, "user_id": 1057015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16e625ef0bb65ea7995547d72dc746c?s=128&d=identicon&r=PG", "display_name": "DiogoDoreto", "link": "https://stackoverflow.com/users/1057015/diogodoreto"}, "edited": false, "score": 2, "creation_date": 1433879613, "post_id": 30741231, "comment_id": 49539022, "body": "Here, I have found a related question in Prolog which you could adapt to your problem: <a href=\"http://stackoverflow.com/questions/8966488/prolog-and-ancestor-relationship\" title=\"prolog and ancestor relationship\">stackoverflow.com/questions/8966488/&hellip;</a>"}, {"owner": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 0, "creation_date": 1433879791, "post_id": 30741231, "comment_id": 49539136, "body": "Thanks, I&#39;ll wait a bit for other answers in languages I&#39;m more familiar with, but if one doesn&#39;t show up I&#39;ll try it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 873, "user_id": 1057015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16e625ef0bb65ea7995547d72dc746c?s=128&d=identicon&r=PG", "display_name": "DiogoDoreto", "link": "https://stackoverflow.com/users/1057015/diogodoreto"}, "edited": false, "score": 2, "creation_date": 1433880312, "post_id": 30741231, "comment_id": 49539485, "body": "@DiogoDoreto Progol is a <a href=\"http://en.wikipedia.org/wiki/Declarative_programming\" rel=\"nofollow noreferrer\"><i>declarative</i></a> language while Go, Python and JavaScript are all <a href=\"http://en.wikipedia.org/wiki/Imperative_programming\" rel=\"nofollow noreferrer\"><i>imperative</i></a>... so I wouldn&#39;t recommend that solution other than just as a matter of curiosity."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1433880838, "post_id": 30741231, "comment_id": 49539796, "body": "what would your function return if I will call it with <code>F(&#39;kitty&#39;, &#39;cat&#39;)</code>?"}, {"owner": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 0, "creation_date": 1433881026, "post_id": 30741231, "comment_id": 49539903, "body": "Hmm, I suppose with my example it would return false. Although ideally it would return true -- if the thesaurus I read from correctly went back and forth. Unfortunately I don&#39;t think it did."}, {"owner": {"reputation": 873, "user_id": 1057015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16e625ef0bb65ea7995547d72dc746c?s=128&d=identicon&r=PG", "display_name": "DiogoDoreto", "link": "https://stackoverflow.com/users/1057015/diogodoreto"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1433881805, "post_id": 30741231, "comment_id": 49540332, "body": "@icza I don&#39;t see a different paradigm as a problem if it can solve the problem. As a matter of fact, the solution will be more elegantly represented in Prolog than in any other imperative language."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 1, "creation_date": 1433879270, "post_id": 30741473, "comment_id": 49538759, "body": "How would I go about constructing the tree?"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1433881044, "last_edit_date": 1433881044, "creation_date": 1433879200, "answer_id": 30741473, "question_id": 30741231, "link": "https://stackoverflow.com/questions/30741231/how-to-find-relationships-between-objects/30741473#30741473", "title": "How to find Relationships between Objects", "body": "<p>A Python solution:</p>\n\n<pre><code>class Word:\n\n   # Dictionary of Words, keyed by name.\n   word_dict = {}\n\n   def __init__(self, name, synonyms):\n      self.name = name\n      self.synonyms = synonyms\n\n      # Update the dictionary.\n      Word.word_dict[name] = self\n      for s in synonyms:\n         if not s in Word.word_dict:\n            Word.word_dict[s] = Word(s, [])\n\n   def isAncestor(self, other):\n      if other in self.synonyms:\n         return True\n      for s in self.synonyms:\n         if Word.word_dict[s].isAncestor(other):\n            return True\n      return False\n\ndef areWordsRelated(word1, word2):\n   if not word1 in Word.word_dict or not word2 in Word.word_dict:\n      return False\n   return Word.word_dict[word1].isAncestor(word2) or Word.word_dict[word2].isAncestor(word1)\n\nwords = []\nwords.append(Word(\"cat\", [\"feline\", \"kitten\", \"mouser\"]))\nwords.append(Word(\"kitten\", [\"kitty\", \"kit\"]))\nwords.append(Word(\"kit\", [\"patck\", \"bag\", \"gear\"]))\nwords.append(Word(\"computer\", [\"electronics\", \"PC\", \"abacus\"]))\n\nprint(areWordsRelated(\"cat\", \"kit\"))\nprint(areWordsRelated(\"kit\", \"cat\"))\nprint(areWordsRelated(\"cat\", \"computer\"))\nprint(areWordsRelated(\"dog\", \"computer\"))\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>True\nTrue\nFalse\nFalse\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 0, "creation_date": 1433881457, "post_id": 30741973, "comment_id": 49540141, "body": "Is there  a way to make it timeout after being X words away from the starting word? I could just add a parameter to the method keeping track of iterations right?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 0, "creation_date": 1433881524, "post_id": 30741973, "comment_id": 49540175, "body": "@MaximilianSun yeah that would be fairly easy, just add a counter and a check for it in the loop. Return false if you hit the edge limit or whatever you&#39;re calling it."}, {"owner": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 0, "creation_date": 1433881912, "post_id": 30741973, "comment_id": 49540396, "body": "I think that your note about &quot;pack&quot; not relating to &quot;kit&quot; is mostly a problem on my part with my example rather than your code."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "edited": false, "score": 0, "creation_date": 1433882449, "post_id": 30741973, "comment_id": 49540670, "body": "@MaximilianSun yeah, the example isn&#39;t consistent so I just chose to do it that way. If you make <code>word2</code> a string instead of a <code>Word</code> then modify functions body as needed to compile you&#39;ll be able to pass in <code>words[0]</code> and &quot;pack&quot; and it will return true"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1433882286, "last_edit_date": 1433882286, "creation_date": 1433880902, "answer_id": 30741973, "question_id": 30741231, "link": "https://stackoverflow.com/questions/30741231/how-to-find-relationships-between-objects/30741973#30741973", "title": "How to find Relationships between Objects", "body": "<p>If you give me some feedback on this I can edit it because it doesn't do exactly what you asked but it is the jist. I'll edit with a technical explanation of what has to be changed to meet your exact example.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    words := []Word{\n            {text: \"cat\", synonyms: []string{\"feline\", \"kitten\", \"mouser\"}},\n            {text: \"kitten\", synonyms: []string{\"kitty\", \"kit\"}} ,\n            {text: \"kit\", synonyms: []string{\"pack\", \"bag\", \"gear\"}},\n            {text: \"computer\", synonyms: []string{\"electronics\", \"PC\", \"abacus\"}},\n    }\n\n    fmt.Println(areWordsRelated(words, words[0], words[2]))\n    fmt.Println(areWordsRelated(words, words[0], words[3]))\n}\n\ntype Word struct{\n     text     string\n     synonyms []string\n}\n\nfunc areWordsRelated(words []Word, word1, word2 Word) bool {\n    for _, elem := range word1.synonyms{\n        if elem == word2.text{\n            return true\n        } else {\n            for _, word := range words {\n                if word.text == elem {\n                    if (areWordsRelated(words, word, word2)) {\n                        return true\n                    }\n                }\n            }\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>EDIT: This doesn't do quite what you asked because it doesn't make the connection between \"pack\" and \"cat\" as pack is not represented by an actual word object and I defined the method to receive word2 as an object (just working off your example). I could instead make that a string so it can check for \"pack\" in the synonyms array of \"kit\" before returning but the idea is the same none the less... Here's a high level explanation of the algorithm.</p>\n\n<p>Iterate the synonyms, if it isn't a match, find that <code>Word</code> object back in the original collection and call myself with it as the first argument. This will recursively exhaust every path until it finds a match, or there are none left in which case you're outside the loop returning false. The code above runs in go playground and correctly returns <code>true\\nfalse</code>. Notice that the recursive call is made within an if to protect from returning false prematurely (also a performance enhancement because we return as soon as true is found rather than continue to recurse the paths).</p>\n\n<p><a href=\"https://play.golang.org/p/gCeY0SthU1\" rel=\"nofollow\">https://play.golang.org/p/gCeY0SthU1</a></p>\n"}, {"tags": [], "owner": {"reputation": 9954, "user_id": 361762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/76eSl.jpg?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/361762/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1465969836, "last_edit_date": 1465969836, "creation_date": 1433881000, "answer_id": 30742005, "question_id": 30741231, "link": "https://stackoverflow.com/questions/30741231/how-to-find-relationships-between-objects/30742005#30742005", "title": "How to find Relationships between Objects", "body": "<p>Here's a sample recursive algorithim written in JavaScript, with some jQuery thrown in to make searching the array easier. It probably could be optimized, but should give you something to start with.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$(function() {\r\n  var words = [{\r\n    text: \"cat\",\r\n    synonyms: [\"feline\", \"kitten\", \"mouser\"]\r\n  }, {\r\n    text: \"kitten\",\r\n    synonyms: [\"kitty\", \"kit\"]\r\n  }, {\r\n    text: \"kit\",\r\n    synonyms: [\"pack\", \"bag\", \"gear\"]\r\n  }, {\r\n    text: \"computer\",\r\n    synonyms: [\"electronics\", \"PC\", \"abacus\"]\r\n  }];\r\n\r\n  console.log(areWordsRelated('cat', 'pack', words));\r\n  console.log(areWordsRelated('cat', 'rack', words));\r\n});\r\n\r\nfunction areWordsRelated(parentWord, childWord, list) {\r\n  var parentWordItems = $.grep(list, function(element) {\r\n    return element.text === parentWord;\r\n  });\r\n\r\n  if (parentWordItems.length === 0) {\r\n    return false\r\n  } else {\r\n    var parentWordItem = parentWordItems[0];\r\n    var remainingItems = $.grep(list, function(element) {\r\n      return element.text !== parentWord;\r\n    });\r\n    if (parentWordItem.synonyms.indexOf(childWord) &gt;= 0) {\r\n      return true;\r\n    } else {\r\n      for (var i = 0; i &lt; parentWordItem.synonyms.length; i++) {\r\n        var synonym = parentWordItem.synonyms[i];\r\n        if (areWordsRelated(synonym, childWord, remainingItems)) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n  }\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 4921364, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PIimAAm9EBM/AAAAAAAAAAI/AAAAAAAAAdE/1y3Cpo858qc/photo.jpg?sz=128", "display_name": "Jonathan Tweedy", "link": "https://stackoverflow.com/users/4921364/jonathan-tweedy"}, "is_accepted": false, "score": 2, "last_activity_date": 1433881734, "creation_date": 1433881734, "answer_id": 30742220, "question_id": 30741231, "link": "https://stackoverflow.com/questions/30741231/how-to-find-relationships-between-objects/30742220#30742220", "title": "How to find Relationships between Objects", "body": "<p>You're looking at a 2nd degree relationship (as opposed to the 'easy' 1st place example you already know how to find), meaning you have to do one of two things:</p>\n\n<p>(1) The storage-heavy solution requires maintaining a separate list of 2nd-degree relationships and then simply do a search within that (longer) list - this requires maintaining (potentially MUCH) more data about word relationships. For example, if you have 10000 words, and each has roughly 10 synonyms, that's 100,000 first-degree relationships stored. But then you'd have something like a billion 2nd-degree relationships. So of course that gets unwieldy quickly.</p>\n\n<p>In that case, each entry looks like this:\n{text: \"cat\" synonyms: [\"feline\", \"kitten\", \"mouser\"] seconds:[\"pack\",...]}\n... and you simply write a separate function that will check for relationships in EITHER 'synonyms' or 'seconds'.</p>\n\n<p>(2) The programmatic solution would be to still only store the 1st-degree relationships and then do an embedded loop.</p>\n\n<p>In this case:</p>\n\n<pre><code>//// This checks for 1st degree relationship\nareWordsRelated1(word1 Word, word2 Word) bool{\n    for _, elem := range word1.synonyms{\n         if elem == word2.text{\n             return true\n         }\n    }\n    return false\n}\n\n//// This checks for 2nd degree by checking 1st and then, if not, \n//// then trying the 1st degree function on the children of word2\n//// before giving up and returning false\nareWordsRelated2(word1 Word, word2 Word) bool{\n    for _, elem1 := range word1.synonyms{\n         if elem1 == word2.text{\n             return true\n         } else {\n         for _, elem2 := range elem1.synonyms{\n             if areWordsRelated1(word1, elem2) {\n                 return true\n             }\n         }\n    }\n    return false\n}\n</code></pre>\n\n<p>NOTE: I noticed that in your sample data, \"cat\" was related to \"kitten\", but \"kitten\" was not conversely related to \"cat\". </p>\n"}, {"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 3, "last_activity_date": 1433882009, "creation_date": 1433882009, "answer_id": 30742297, "question_id": 30741231, "link": "https://stackoverflow.com/questions/30741231/how-to-find-relationships-between-objects/30742297#30742297", "title": "How to find Relationships between Objects", "body": "<p>First of all it is not clear how do you define relationship here. If your \n\"cat\" has synonyms: [\"feline\", \"kitten\", \"mouser\"], does that mean that \"mouser\" has a synonym \"cat\".</p>\n\n<p>Based on my understanding the answer is no. So here is a solution in python:</p>\n\n<pre><code>G = {\n    \"cat\": [\"feline\", \"kitten\", \"mouser\"],\n    \"kitten\": [\"kitty\", \"kit\"],\n    \"kit\": [\"pack\", \"bag\", \"gear\"],\n    \"computer\": [\"electronics\", \"PC\", \"abacus\"]\n}\n\ndef areWordsRelated(G, w1, w2):\n    if w1 == w2:\n        return True\n\n    frontier = [w1]\n    checked = set()\n    while len(frontier):\n        el = frontier.pop()\n        if el in G:\n            neighbors = G[el]\n            for i in neighbors:\n                if i == w2:\n                    return True\n                if i not in checked:\n                    frontier.append(i)\n                    checked.add(i)\n\n    return False\n\nareWordsRelated(G, \"cat\", \"pack\") #true\nareWordsRelated(G, \"cat\", \"computer\") #false\n</code></pre>\n\n<p>So what are we doing here? At first you have your graph, which is just dictionary (map in go) which shows your relationship (I basically took your slice).</p>\n\n<p>Our algorithm grows like a mold, maintaining a set of checked elements and a current frontier. If frontier is empty (nothing to explore, then the elements are not connected). We extract one element at a time from a frontier and check all the neighbors. If any of them is the element we are looking for - then there is a connection. Otherwise check if we already have seen such element (and if not than add it to the frontier and to the set of checked).</p>\n\n<p>Notice that if your relationship works in a slightly different way, all you need is to modify a graph.</p>\n\n<hr>\n\n<p>One last word, if you are looking for a normal way to find synonyms take a look at <a href=\"https://www.kaggle.com/c/word2vec-nlp-tutorial/details/part-2-word-vectors\" rel=\"nofollow\">word to vector algorithm</a> and a nice <a href=\"https://code.google.com/p/word2vec/\" rel=\"nofollow\">implementation in python</a>. This will allow you to find really complicated relationship even between words like finding that <code>California</code> and <code>Golden Gate</code> are related even without having this relationship specified.</p>\n"}], "owner": {"reputation": 147, "user_id": 4657228, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/09e68d4937e279f2127d4064385d1b0d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Sun", "link": "https://stackoverflow.com/users/4657228/maximilian-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 1, "accepted_answer_id": 30741973, "answer_count": 5, "score": 10, "last_activity_date": 1465969836, "creation_date": 1433878399, "last_edit_date": 1495540370, "question_id": 30741231, "link": "https://stackoverflow.com/questions/30741231/how-to-find-relationships-between-objects", "title": "How to find Relationships between Objects", "body": "<h2>For People With A Similar Question (written after finding a solution):</h2>\n\n<p>This problem, as you might notice according to the answers below, has a lot of different solutions. I only chose Evan's because it was the easiest one for me implement into my own code. However, from what I tried, every other answer also worked. <a href=\"https://stackoverflow.com/a/30742297/1090562\">@SalvadorDali</a> linked this <a href=\"https://www.kaggle.com/c/word2vec-nlp-tutorial/details/part-2-word-vectors\" rel=\"nofollow noreferrer\">Kaggle page</a> which was definitely interesting and I reccomend reading if you are interested. Prolog was also brought up as a possible solution, I'm unfamiliar with it, but if you already know it -- it's probably worth considering. Also, if you just want to get code to use there are working Javascript and Python examples below. However, each one had a different approach to the solution and I'm not sure which is most effecient (feel free to test it yourself).</p>\n\n<p><strong>For further approaches/reading:</strong></p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Breadth-first_search\" rel=\"nofollow noreferrer\">http://en.wikipedia.org/wiki/Breadth-first_search</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/8966488/prolog-and-ancestor-relationship?lq=1\">Prolog and ancestor relationship</a></p>\n\n<p><a href=\"https://www.kaggle.com/c/word2vec-nlp-tutorial/details/part-2-word-vectors\" rel=\"nofollow noreferrer\">https://www.kaggle.com/c/word2vec-nlp-tutorial/details/part-2-word-vectors</a></p>\n\n<hr>\n\n<p>Sorry for the confusing title, I can't figure out a way to properly word my question -- any better ideas are welcome.</p>\n\n<p>Because I'm having such a difficult time describing my question, I'll try to explain my goal and code as much as needed:</p>\n\n<p><em>Note: my code here is Go, but I'd be happy with answers in other languages as well, if you have any questions I'll try to answer as quick as possible</em></p>\n\n<p>Basically, I have an array of \"Word\" objects that look like this:</p>\n\n<pre><code>type Word struct{\n     text     string\n     synonyms []string\n}\n</code></pre>\n\n<p>This is an example of 4 words within the array:</p>\n\n<pre><code>  []Word{\n      {text: \"cat\" synonyms: [\"feline\", \"kitten\", \"mouser\"]}\n      {text: \"kitten\" synonyms: [\"kitty\", \"kit\"]} \n      {text: \"kit\" synonyms: [\"pack\", \"bag\", \"gear\"]}\n      {text: \"computer\" synonyms: [\"electronics\", \"PC\", \"abacus\"]}\n   }\n</code></pre>\n\n<p>My challenge is writing a method to test for a relationship between 2 words. Of course, testing between 2 words like <em>\"cat\"</em> and <em>\"kitten\"</em> would be easy with the example above. I could just check \"Cat\"s list of synonyms and test to see if it contains \"kitten.\" With code like this:</p>\n\n<pre><code>areWordsRelated(word1 Word, word2 Word) bool{\n    for _, elem := range word1.synonyms{\n         if elem == word2.text{\n             return true\n         }\n    }\n    return false\n}\n</code></pre>\n\n<p><strong>However, I can't figure out how to test for a more distant relationship.</strong></p>\n\n<p>For example:</p>\n\n<pre><code>areWordsRelated(\"cat\",\"pack\") //should return true \n//because \"cat\" is related to \"kitten\" which is related to \"pack\"\nareWordsRelated(\"cat\", \"computer\") //should return false\n</code></pre>\n\n<p>I tried to do it recursively, but all my attempts don't seem to work. Any example code (My code is in Go, but Python, Java, or Javascript are also fine), pseudocode or just explanations would be really great.</p>\n"}, {"tags": ["ubuntu", "time", "go", "timezone"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 3, "creation_date": 1433876171, "post_id": 30740401, "comment_id": 49536920, "body": "What time zone are you in, and what time zone is your server in?"}, {"owner": {"reputation": 41, "user_id": 1599636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62aa5f8f4a3fb676e0e9aa8f8dc72f78?s=128&d=identicon&r=PG", "display_name": "frausto", "link": "https://stackoverflow.com/users/1599636/frausto"}, "reply_to_user": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 0, "creation_date": 1433878926, "post_id": 30740401, "comment_id": 49538510, "body": "Im in PDT, server is UTC"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433881082, "post_id": 30740401, "comment_id": 49539929, "body": "<a href=\"http://stackoverflow.com/a/30741518/55504\">Jon Skeet describes why</a> but, <i>if</i> the client&#39;s text time format is up to you, you could switch to using a format with timezone names rather than numeric offset (e.g. <code>time.RFC1123</code> has &quot;\u2026 MST&quot;) to preserve the name. Otherwise you&#39;re stuck with just the offset and you should only use/rely on the second return value of <code>clientSendTime.Zone()</code> and not the name (and if you reformat such times using a named zone format you&#39;ll get only your local zone or numeric like &quot;-0700&quot;)."}], "answers": [{"tags": [], "owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "is_accepted": false, "score": 5, "last_activity_date": 1433879313, "creation_date": 1433879313, "answer_id": 30741518, "question_id": 30740401, "link": "https://stackoverflow.com/questions/30740401/golang-time-zone-parsing-not-returning-the-correct-zone-on-ubuntu-server/30741518#30741518", "title": "Golang time zone parsing not returning the correct zone on ubuntu server", "body": "<p>Okay, so I think I know <em>why</em> this is happening - but not a decent fix for it.</p>\n\n<p>The <a href=\"http://golang.org/pkg/time/#Parse\" rel=\"noreferrer\">documentation for <code>Parse</code></a> says:</p>\n\n<blockquote>\n  <p>When parsing a time with a zone offset like -0700, if the offset corresponds to a time zone used by the current location (Local), then Parse uses that location and zone in the returned time. Otherwise it records the time as being in a fabricated location with time fixed at the given zone offset.</p>\n</blockquote>\n\n<p>As you're in Pacific time, the zone offset <em>does</em> happen to match your location - so it can use your local time zone \"name\" (ick; PDT isn't actually a time zone name, but we'll leave that to one side). When your server parses it, it has to fabricate the location - that's why you're seeing \"-0700 -0700\".</p>\n\n<p>Fundamentally, you can't determine the time zone just from an offset - there can be multiple time zones with the same offset at the same moment in time, so you can't predict what the offset will be in the original time zone at any <em>other</em> time. I suggest you just record what you actually know - i.e. the offset - and don't try to infer information that isn't actually present.</p>\n"}], "owner": {"reputation": 41, "user_id": 1599636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62aa5f8f4a3fb676e0e9aa8f8dc72f78?s=128&d=identicon&r=PG", "display_name": "frausto", "link": "https://stackoverflow.com/users/1599636/frausto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1433879313, "creation_date": 1433875795, "question_id": 30740401, "link": "https://stackoverflow.com/questions/30740401/golang-time-zone-parsing-not-returning-the-correct-zone-on-ubuntu-server", "title": "Golang time zone parsing not returning the correct zone on ubuntu server", "body": "<p>Using Ubuntu 12.04</p>\n\n<pre><code>clientSendTimeHeaderFormat := \"2006-01-02T15:04:05-0700\"\nctx := \"2015-04-01T10:04:00-0700\"\nclientSendTime, err  := time.Parse(clientSendTimeHeaderFormat, ctx)\nname, offset := clientSendTime.Zone()\n</code></pre>\n\n<p>On the server, the name returns empty, whereas offset is correct at -25200.\nThe clientSendTime prints out as \"2015-04-01 10:04:00 -0700 -0700\".</p>\n\n<p>Running it locally on my mac returns both name and offset correctly. The name returns the correct zone \"PDT\". Locally the clientSendTime prints out as \"2015-04-01 10:04:00 -0700 PDT\"</p>\n\n<p>I also copied over the /usr/share/zoneinfo folder from the server when running locally to make sure it wasnt due to differences in that.</p>\n\n<p>Anyone know what might be causing these differences?</p>\n"}, {"tags": ["linux", "ubuntu", "go", "signals"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1433861036, "post_id": 30734601, "comment_id": 49526928, "body": "Are you certain that you&#39;re <i>not</i> catching the <code>TERM</code> signal? Maybe the output is getting dropped by upstart. Try logging to a file."}, {"owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433861946, "post_id": 30734601, "comment_id": 49527641, "body": "@JimB man you were right! I managed to write to file. why does upstart drop the outptut? Thank You!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433863593, "post_id": 30734601, "comment_id": 49528854, "body": "Upstart&#39;s <code>wait</code> call probably returns while the output is buffered somewhere, and gets discarded. A small sleep may help, but there&#39;s no way to make it foolproof."}], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "edited": false, "score": 0, "creation_date": 1433860364, "post_id": 30734897, "comment_id": 49526321, "body": "Hi, can you elaborate? what different will it make if I add this defer?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1433860611, "post_id": 30734897, "comment_id": 49526528, "body": "this has nothing to do with a panic"}, {"owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433860787, "post_id": 30734897, "comment_id": 49526699, "body": "@JimB any suggestions?"}, {"owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "edited": false, "score": 0, "creation_date": 1433860996, "post_id": 30734897, "comment_id": 49526876, "body": "@makhov but why shouldn&#39;t it wait? also, as I mentioned, if I add a sleep right after my goroutine and call stop I do manage to catch the signal."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433861127, "post_id": 30734897, "comment_id": 49526998, "body": "this still doesn&#39;t do anything, because you can&#39;t ever get to the main loop."}], "tags": [], "owner": {"reputation": 415, "user_id": 2981904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08200a764edc239f888b61e027aca04e?s=128&d=identicon&r=PG", "display_name": "makhov", "link": "https://stackoverflow.com/users/2981904/makhov"}, "is_accepted": false, "score": -1, "last_activity_date": 1433860832, "last_edit_date": 1433860832, "creation_date": 1433859913, "answer_id": 30734897, "question_id": 30734601, "link": "https://stackoverflow.com/questions/30734601/cant-catch-sigterm-sent-by-upstart-in-golang/30734897#30734897", "title": "can&#39;t catch SIGTERM sent by upstart in golang", "body": "<p><strong>UPD.</strong> Sorry, I read it correctly now. Maybe your goroutine don't wait signal and execute <code>os.Exit()</code>. Try to add another chan.</p>\n\n<pre><code>func main() {\n   sigc := make(chan os.Signal, 1)\n   done := make(chan bool, 1)\n   signal.Notify(sigc, syscall.SIGTERM)\n   go func() {\n\n      s := &lt;-sigc\n      numOfGoRoutines := runtime. NumGoroutine()\n      var stats runtime.MemStats\n      runtime.ReadMemStats(&amp;stats)\n      log.Println(\"Got Signal \", s)\n      log.Println(\"num of goroutines: \", numOfGoRoutines)\n      log.Println(\"Memory Allocated: \",  stats.Alloc)\n      done &lt;- true\n      os.Exit(1)\n   }()\n   &lt;-done\n   someInfiniteLoopFunction() // this function defined in a different file.\n</code></pre>\n"}], "owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 940, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1433860832, "creation_date": 1433859207, "last_edit_date": 1433859895, "question_id": 30734601, "link": "https://stackoverflow.com/questions/30734601/cant-catch-sigterm-sent-by-upstart-in-golang", "title": "can&#39;t catch SIGTERM sent by upstart in golang", "body": "<p>I have an upstart job running (some kind of TCP server). occasionally my process get restarted and I can see the next line in my syslog:  </p>\n\n<pre><code>kernel: [2422352.460162] init: &lt;job_name&gt; main process (16545) killed by TERM signal\n</code></pre>\n\n<p>I don't understand the reason for this TERM signal by the kernel so I decided to catch the signal and print some memory and goroutines statistics before I terminate.<br>\nso now my code looks like this:  </p>\n\n<pre><code>func main() {\n   sigc := make(chan os.Signal, 1)\n   signal.Notify(sigc, syscall.SIGTERM)\n   go func() {\n      s := &lt;-sigc\n      numOfGoRoutines := runtime. NumGoroutine()\n      var stats runtime.MemStats\n      runtime.ReadMemStats(&amp;stats)\n      log.Println(\"Got Signal \", s)\n      log.Println(\"num of goroutines: \", numOfGoRoutines)\n      log.Println(\"Memory Allocated: \",  stats.Alloc)\n      os.Exit(1)\n   }()\n   someInfiniteLoopFunction() // this function defined in a different file.\n</code></pre>\n\n<p>now the weird thing is that my goroutine doesn't catch the TERM signal even when I manually stop the job.<br>\neven more interesting is the fact that if I add a Sleep for 100 seconds right after signal handler goroutine and stop the job during this sleep period then my goroutine DOES catch the TERM signal.<br>\nI'm absolutely clueless here and will appreciate any help. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 8, "creation_date": 1433856597, "post_id": 30733455, "comment_id": 49523139, "body": "<a href=\"https://golang.org/ref/spec#Arithmetic_operators\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Arithmetic_operators</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 7, "last_activity_date": 1433859822, "creation_date": 1433859822, "answer_id": 30734866, "question_id": 30733455, "link": "https://stackoverflow.com/questions/30733455/single-ampersand-between-2-expressions-in-golang/30734866#30734866", "title": "single ampersand between 2 expressions in golang", "body": "<p>This is the <a href=\"https://en.wikipedia.org/wiki/Bitwise_operation#AND\" rel=\"noreferrer\">bitwise AND</a> operator.</p>\n\n<pre><code>// Prints 2, because 3 (0x0011) &amp; 2 (0x0010) = 2 (0x0010)\nfmt.Println(3 &amp; 2)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/JFto4ZHUEC\" rel=\"noreferrer\">http://play.golang.org/p/JFto4ZHUEC</a></p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1593, "favorite_count": 2, "accepted_answer_id": 30734866, "answer_count": 1, "score": 3, "last_activity_date": 1433859822, "creation_date": 1433856539, "question_id": 30733455, "link": "https://stackoverflow.com/questions/30733455/single-ampersand-between-2-expressions-in-golang", "title": "single ampersand between 2 expressions in golang", "body": "<p>I was looking at <code>golang</code> source code, module <a href=\"https://golang.org/src/math/rand/rand.go\" rel=\"nofollow\">math/rand</a>. I found there one interesting line </p>\n\n<pre><code>if n&amp;(n-1) == 0 { // n is power of two, can mask\n</code></pre>\n\n<p>I'm just curious, what does <code>n&amp;(n-1)</code> mean? </p>\n\n<p>I would understand <code>n &amp;&amp; (n-1)</code>. It would be <code>AND</code> operator between 2 boolean expressions. I would understand <code>&amp;n</code>. It's address of <code>n</code> variable. But what is <code>n&amp;(n-1)</code> I cannot figure out.</p>\n\n<p>Full method code:</p>\n\n<pre><code>// Int63n returns, as an int64, a non-negative pseudo-random number in [0,n).\n// It panics if n &lt;= 0.\nfunc (r *Rand) Int63n(n int64) int64 {\n    if n &lt;= 0 {\n        panic(\"invalid argument to Int63n\")\n    }\n    if n&amp;(n-1) == 0 { // n is power of two, can mask\n        return r.Int63() &amp; (n - 1)\n    }\n    max := int64((1 &lt;&lt; 63) - 1 - (1&lt;&lt;63)%uint64(n))\n    v := r.Int63()\n    for v &gt; max {\n        v = r.Int63()\n    }\n    return v % n\n}\n</code></pre>\n"}, {"tags": ["string", "go", "null", "optional", "variant"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1433852838, "post_id": 30731687, "comment_id": 49520104, "body": "Related: <a href=\"http://stackoverflow.com/a/30716481/1705598\">stackoverflow.com/a/30716481/1705598</a>. It is for <code>*int64</code>, but you can use the same solutions for <code>*string</code>."}, {"owner": {"reputation": 506, "user_id": 3835333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c838f6bc14ea3297f3305aca42f8bf?s=128&d=identicon&r=PG&f=1", "display_name": "SkyeC", "link": "https://stackoverflow.com/users/3835333/skyec"}, "edited": false, "score": 0, "creation_date": 1433856462, "post_id": 30731687, "comment_id": 49523035, "body": "In your application is there a semantic difference between a string that is unset (absent) and &quot;&quot;? Most of the time, in my experience, you can effectively treat them the same.  The empty string <code>&quot;&quot;</code> is the zero value for a string in go. This is idiomatic but maybe you need this distinction?"}, {"owner": {"reputation": 26374, "user_id": 229792, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/NIE5f.jpg?s=128&g=1", "display_name": "jameshfisher", "link": "https://stackoverflow.com/users/229792/jameshfisher"}, "reply_to_user": {"reputation": 506, "user_id": 3835333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c838f6bc14ea3297f3305aca42f8bf?s=128&d=identicon&r=PG&f=1", "display_name": "SkyeC", "link": "https://stackoverflow.com/users/3835333/skyec"}, "edited": false, "score": 3, "creation_date": 1434383327, "post_id": 30731687, "comment_id": 49742611, "body": "@SkyeC the problem with that is that it does not express optionality in the types; it&#39;s just an unreliable convention."}], "answers": [{"comments": [{"owner": {"reputation": 26374, "user_id": 229792, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/NIE5f.jpg?s=128&g=1", "display_name": "jameshfisher", "link": "https://stackoverflow.com/users/229792/jameshfisher"}, "edited": false, "score": 9, "creation_date": 1434383181, "post_id": 30731851, "comment_id": 49742520, "body": "Thanks. It does seem like the pointer solution is as good as I&#39;ll get, which is disappointing. Why oh why in the 21st century do languages still not have variant types/sum types/ADTs."}, {"owner": {"reputation": 815, "user_id": 386646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b4d6bb0e346049963b64e4344c6d6a?s=128&d=identicon&r=PG", "display_name": "Michal \u010cizmazia", "link": "https://stackoverflow.com/users/386646/michal-%c4%8cizmazia"}, "edited": false, "score": 0, "creation_date": 1550221222, "post_id": 30731851, "comment_id": 96197076, "body": "The type <code>Optional&lt;String&gt;</code> adds value in languages which use exceptions for error handling. Golang makes error handling explicit via return values, however."}, {"owner": {"reputation": 384, "user_id": 147346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8080c8b02b98612dc66f75e44465329f?s=128&d=identicon&r=PG", "display_name": "Andres F.", "link": "https://stackoverflow.com/users/147346/andres-f"}, "reply_to_user": {"reputation": 815, "user_id": 386646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b4d6bb0e346049963b64e4344c6d6a?s=128&d=identicon&r=PG", "display_name": "Michal \u010cizmazia", "link": "https://stackoverflow.com/users/386646/michal-%c4%8cizmazia"}, "edited": false, "score": 3, "creation_date": 1577994966, "post_id": 30731851, "comment_id": 105306272, "body": "@Michal\u010cizmazia languages such as Haskell use <code>Maybe</code> (which is <code>Optional</code> by another name) and do not, under normal circumstances, use exceptions for error handling. In fact, <code>Optional</code> types have nothing to do with exceptions and are a compile-time check (as opposed to exceptions)."}, {"owner": {"reputation": 815, "user_id": 386646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b4d6bb0e346049963b64e4344c6d6a?s=128&d=identicon&r=PG", "display_name": "Michal \u010cizmazia", "link": "https://stackoverflow.com/users/386646/michal-%c4%8cizmazia"}, "reply_to_user": {"reputation": 384, "user_id": 147346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8080c8b02b98612dc66f75e44465329f?s=128&d=identicon&r=PG", "display_name": "Andres F.", "link": "https://stackoverflow.com/users/147346/andres-f"}, "edited": false, "score": 1, "creation_date": 1578150094, "post_id": 30731851, "comment_id": 105348898, "body": "@AndresF. you are right! Functional programming takes <code>Optional</code> far beyond the <code>getOrThrow</code> operation I was referring to."}, {"owner": {"reputation": 445, "user_id": 1586541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2964eb66ace94db95802f62919cad99b?s=128&d=identicon&r=PG", "display_name": "inix", "link": "https://stackoverflow.com/users/1586541/inix"}, "reply_to_user": {"reputation": 26374, "user_id": 229792, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/NIE5f.jpg?s=128&g=1", "display_name": "jameshfisher", "link": "https://stackoverflow.com/users/229792/jameshfisher"}, "edited": false, "score": 1, "creation_date": 1583829274, "post_id": 30731851, "comment_id": 107236497, "body": "@jameshfisher I recommend use  sql.NullString,string pointer can be aweful thing that you need check nill and deference it everywhere,and may cause unexpected nil crash."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 10, "last_activity_date": 1433852266, "last_edit_date": 1495540024, "creation_date": 1433852266, "answer_id": 30731851, "question_id": 30731687, "link": "https://stackoverflow.com/questions/30731687/how-do-i-represent-an-optional-string-in-go/30731851#30731851", "title": "How do I represent an Optional String in Go?", "body": "<p>You could use something like <a href=\"http://golang.org/pkg/database/sql/#NullString\" rel=\"noreferrer\"><code>sql.NullString</code></a>, but I personally would stick to <code>*string</code>. As for awkwardness, it's true that you can't just <code>sp := &amp;\"foo\"</code> unfortunately. But there is a <a href=\"https://stackoverflow.com/a/29520834/1892060\">workaround</a> for this:</p>\n\n<pre><code>func strPtr(s string) *string {\n    return &amp;s\n}\n</code></pre>\n\n<p>Calls to <code>strPtr(\"foo\")</code> should be inlined, so it's effectively <code>&amp;\"foo\"</code>.</p>\n\n<p>Another possibility is to use <code>new</code>:</p>\n\n<pre><code>sp := new(string)\n*sp = \"foo\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26908, "user_id": 1192728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/481baa815383ed3970e726842195f73f?s=128&d=identicon&r=PG", "display_name": "hqt", "link": "https://stackoverflow.com/users/1192728/hqt"}, "edited": false, "score": 1, "creation_date": 1584262284, "post_id": 30741287, "comment_id": 107378041, "body": "However, using this method, we might lose the context that s might be null."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 10, "last_activity_date": 1471955430, "last_edit_date": 1495541878, "creation_date": 1433878596, "answer_id": 30741287, "question_id": 30731687, "link": "https://stackoverflow.com/questions/30731687/how-do-i-represent-an-optional-string-in-go/30741287#30741287", "title": "How do I represent an Optional String in Go?", "body": "<p>A logical solution would be to use <code>*string</code> as mentioned by Ainar-G. <a href=\"https://stackoverflow.com/questions/30716354/how-do-i-do-a-literal-int64-in-go/30716481#30716481\">This other answer</a> details the possibilities of obtaining a pointer to a value (<code>int64</code> but the same works for <code>string</code> too). A wrapper is another solution.</p>\n\n<h3>Using just <code>string</code></h3>\n\n<p>An optional <code>string</code> means a <code>string</code> plus 1 specific value (or state) saying \"not a string\" (but a <code>null</code>).</p>\n\n<p>This 1 specific value can be stored (signaled) in another variable (e.g <code>bool</code>) and you can pack the <code>string</code> and the <code>bool</code> into a <code>struct</code> and we arrived to the wrapper, but this doesn't fit into the case of \"using just a <code>string</code>\" (but is still a viable solution).</p>\n\n<p>If we want to stick to just a <code>string</code>, we can take out 1 specific value from the possible values of a <code>string</code> type (which has \"infinity\" possible values as the length is not limited (or maybe it is as it must be an <code>int</code> but that's all right)), and we can name this specific value the <code>null</code> value, the value which means \"not a string\".</p>\n\n<p>The most convenient value for indicating <code>null</code> is the zero value of <code>string</code>, which is the empty <code>string</code>: <code>\"\"</code>. Designating this the <code>null</code> element has the convenience that whenever you create a <code>string</code> variable without explicitly specifying the initial value, it will be initialized with <code>\"\"</code>. Also when querying an element from a <code>map</code> whose value is <code>string</code> will also yield <code>\"\"</code> if the key is not in the <code>map</code>.</p>\n\n<p>This solution suits many real-life use-cases. If the optional <code>string</code> is supposed to be a person's name for example, an empty <code>string</code> does not really mean a valid person name, so you shouldn't allow that in the first place.</p>\n\n<p>There might be cases of course when the empty <code>string</code> does represent a valid value of a variable of <code>string</code> type. For these use-cases we can choose another value.</p>\n\n<p>In Go, a <code>string</code> is in effect a read-only slice of bytes. See blog post <a href=\"http://blog.golang.org/strings\" rel=\"noreferrer\">Strings, bytes, runes and characters in Go</a> which explains this in details.</p>\n\n<p>So a <code>string</code> is a byte slice, which is the UTF-8 encoded bytes in case of a valid text. Assuming you want to store a valid text in your optional <code>string</code> (if you wouldn't, then you can just use a <code>[]byte</code> instead which can have a <code>nil</code> value), you can choose a <code>string</code> value which represents an invalid UTF-8 byte sequence and thus you won't even have to make a compromise to exclude a valid text from the possible values. The shortest invalid UTF-8 byte sequence is 1 byte only, for example <code>0xff</code> (there are more). Note: you can use the <a href=\"http://golang.org/pkg/unicode/utf8/#ValidString\" rel=\"noreferrer\"><code>utf8.ValidString()</code></a> function to tell if a <code>string</code> value is a valid text (valid UTF-8 encoded byte sequence).</p>\n\n<p>You can make this exceptional value a <code>const</code>:</p>\n\n<pre><code>const Null = \"\\xff\"\n</code></pre>\n\n<p>Being this short also means it will be very fast to check if a <code>string</code> equals to this.<br>\nAnd by this convention you already have an optional <code>string</code> which also allows the empty <code>string</code>.</p>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/dL9D3twKkD\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<pre><code>const Null = \"\\xff\"\n\nfunc main() {\n    fmt.Println(utf8.ValidString(Null)) // false\n\n    s := Null\n    fmt.Println([]byte(s)) // [255]\n    fmt.Println(s == Null) // true\n    s = \"notnull\"\n    fmt.Println(s == Null) // false\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "is_accepted": false, "score": 1, "last_activity_date": 1607911673, "creation_date": 1607911673, "answer_id": 65282756, "question_id": 30731687, "link": "https://stackoverflow.com/questions/30731687/how-do-i-represent-an-optional-string-in-go/65282756#65282756", "title": "How do I represent an Optional String in Go?", "body": "<p>With an interface type, you can use a more natural assignment syntax.</p>\n<pre><code>var myString interface{} // used as type &lt;string&gt;\nmyString = nil // nil is the default -- and indicates 'empty'\nmyString = &quot;a value&quot;\n</code></pre>\n<p>When referencing the value, a <a href=\"https://stackoverflow.com/q/38816843/86967\">type assertion</a> is typically required to make the checking explicit.</p>\n<pre><code>// checked type assertion\nif s, exists := myString.(string); exists {\n    useString(s)\n}\n</code></pre>\n<p>Also, because of <a href=\"https://tour.golang.org/methods/17\" rel=\"nofollow noreferrer\">stringers</a> there are some contexts in which the 'optional' type will be handled automatically -- meaning that you don't need to explicitly cast the value.  The <code>fmt</code> package uses this feature:</p>\n<pre><code>fmt.Println(&quot;myString:&quot;,myString) // prints the value (or &quot;&lt;nil&gt;&quot;)\n</code></pre>\n<hr />\n<h2>Warning</h2>\n<p><strong>There is no type-checking when assigning to the value.</strong></p>\n<p>In some ways, this is a cleaner approach than dealing with pointers.  However, because this uses an interface type, it is not limited to holding a specific underlying type.  The risk is that you could unintentionally assign a different type -- which would be treated the same as <code>nil</code> in the above conditional.</p>\n<p>Here's a demonstration of assignment using interfaces:</p>\n<pre><code>var a interface{} = &quot;hello&quot;\nvar b = a // b is an interface too\nb = 123 // assign a different type\n\nfmt.Printf(&quot;a: (%T) %v\\n&quot;, a, a)\nfmt.Printf(&quot;b: (%T) %v\\n&quot;, b, b)\n</code></pre>\n<p>Output:</p>\n<pre>\na: (string) hello\nb: (int) 123\n</pre>\n<p><em>Notice that interfaces are assigned by duplication, so <code>a</code> and <code>b</code> are distinct.</em></p>\n"}], "owner": {"reputation": 26374, "user_id": 229792, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/NIE5f.jpg?s=128&g=1", "display_name": "jameshfisher", "link": "https://stackoverflow.com/users/229792/jameshfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11494, "favorite_count": 1, "accepted_answer_id": 30731851, "answer_count": 3, "score": 16, "last_activity_date": 1607911673, "creation_date": 1433851853, "question_id": 30731687, "link": "https://stackoverflow.com/questions/30731687/how-do-i-represent-an-optional-string-in-go", "title": "How do I represent an Optional String in Go?", "body": "<p>I wish to model a value which can have two possible forms: absent, or a string.</p>\n\n<p>The natural way to do this is with <code>Maybe String</code>, or <code>Optional&lt;String&gt;</code>, or <code>string option</code>, etc. However, Go does not have variant types like this.</p>\n\n<p>I then thought, following Java, C, etc., that the alternative would be nullability, or <code>nil</code> in Go. However, <code>nil</code> is not a member of the <code>string</code> type in Go.</p>\n\n<p>Searching, I then thought to use the type <code>*string</code>. This could work, but seems very awkward (e.g. I cannot take the address of the string literal in the same way that I can take the address of a struct literal).</p>\n\n<p>What is the idiomatic way to model such a value in Go?</p>\n"}, {"tags": ["go", "execution"], "comments": [{"owner": {"reputation": 685, "user_id": 1127557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b520b02910b5efa0f813441c85171066?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1127557/alex"}, "edited": false, "score": 0, "creation_date": 1433839349, "post_id": 30725751, "comment_id": 49510571, "body": "I am intersted in syntax, what is this language?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 685, "user_id": 1127557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b520b02910b5efa0f813441c85171066?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1127557/alex"}, "edited": false, "score": 0, "creation_date": 1433851540, "post_id": 30725751, "comment_id": 49519120, "body": "@AliTorabi It&#39;s <a href=\"https://golang.org\" rel=\"nofollow noreferrer\">Go</a>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1433868313, "post_id": 30725751, "comment_id": 49532193, "body": "Not a direct answer (i.e. <code>\\n</code> as @icza mentions) but you may find <a href=\"https://golang.org/pkg/io/#MultiWriter\" rel=\"nofollow noreferrer\"><code>io.MultiWriter</code></a> useful since you say you need to send the output two places. In particular, if you don&#39;t need the formatting that the <code>log</code> package gives you can just do something like: <a href=\"https://play.golang.org/p/4PG3qbiQx9\" rel=\"nofollow noreferrer\">play.golang.org/p/4PG3qbiQx9</a>"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 3883502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745bed98a8e00dd26d5695b02872f317?s=128&d=identicon&r=PG&f=1", "display_name": "jftp", "link": "https://stackoverflow.com/users/3883502/jftp"}, "edited": false, "score": 0, "creation_date": 1433844962, "post_id": 30726590, "comment_id": 49514496, "body": "Yes, as you mentioned there were a problem with line ending, thank you."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433868731, "post_id": 30726590, "comment_id": 49532457, "body": "@icza, reading/checking <code>stderr</code> is a good idea but not reading it when using <code>os&#47;exec</code> isn&#39;t a problem since, unless you override it (via <code>cmd.StderrPipe</code> or setting <code>cmd.Stderr</code> for example), the default is to connect them to <code>os.DevNull</code> (i.e. output would be discarded, not buffered and blocking)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433869245, "post_id": 30726590, "comment_id": 49532778, "body": "@DaveC Oh, good to know. Thanks. In the Java world stderr is not discarded by default and I&#39;ve seen others having (and myself experiencing) mysterious errors when not read properly."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1518952076, "last_edit_date": 1518952076, "creation_date": 1433837960, "answer_id": 30726590, "question_id": 30725751, "link": "https://stackoverflow.com/questions/30725751/streaming-commands-output-progress/30726590#30726590", "title": "Streaming commands output progress", "body": "<p>The code you posted works (with a reasonable command executed).</p>\n\n<p>Here is a simple <em>\"some long running task\"</em> written in Go for you to call and test your code:</p>\n\n<pre><code>func main() {\n    fmt.Println(\"Child started.\")\n    time.Sleep(time.Second*2)\n    fmt.Println(\"Tick...\")\n    time.Sleep(time.Second*2)\n    fmt.Println(\"Child ended.\")\n}\n</code></pre>\n\n<p>Compile it and call it as your command. You will see the different lines appear immediately as written by the child process, \"streamed\".</p>\n\n<h3>Reasons why it may not work for you</h3>\n\n<p>The <a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"noreferrer\"><code>Scanner</code></a> returned by <a href=\"https://golang.org/pkg/bufio/#NewScanner\" rel=\"noreferrer\"><code>bufio.NewScanner()</code></a> reads whole lines and only returns something if a newline character is encountered (as defined by the <a href=\"https://golang.org/pkg/bufio/#ScanLines\" rel=\"noreferrer\"><code>bufio.ScanLines()</code></a> function).</p>\n\n<p>If the command you execute doesn't print newline characters, its output won't be returned immediately (only when newline character is printed, internal buffer is filled or the process ends).</p>\n\n<h3>Possible workarounds</h3>\n\n<p>If you have no guarantee that the child process prints newline characters but you still want to stream the output, you can't read whole lines. One solution is to read by words, or even read by characters (runes). You can achieve this by setting a different <a href=\"https://golang.org/pkg/bufio/#SplitFunc\" rel=\"noreferrer\">split function</a> using the <a href=\"https://golang.org/pkg/bufio/#Scanner.Split\" rel=\"noreferrer\"><code>Scanner.Split()</code></a> method:</p>\n\n<pre><code>scanner := bufio.NewScanner(stdout)\nscanner.Split(bufio.ScanRunes)\n</code></pre>\n\n<p>The <a href=\"https://golang.org/pkg/bufio/#ScanRunes\" rel=\"noreferrer\"><code>bufio.ScanRunes</code></a> function reads the input by <code>rune</code>s so <a href=\"https://golang.org/pkg/bufio/#Scanner.Scan\" rel=\"noreferrer\"><code>Scanner.Scan()</code></a> will return whenever a new <code>rune</code> is available.</p>\n\n<p>Or reading manually without a <code>Scanner</code> (in this example byte-by-byte):</p>\n\n<pre><code>oneByte := make([]byte, 1)\nfor {\n    _, err := stdout.Read(oneByte)\n    if err != nil {\n        break\n    }\n    fmt.Printf(\"%c\", oneByte[0])\n}\n</code></pre>\n\n<p>Note that the above code would read <code>rune</code>s that multiple bytes in UTF-8 encoding incorrectly. To read multi UTF-8-byte runes, we need a bigger buffer:</p>\n\n<pre><code>oneRune := make([]byte, utf8.UTFMax)\nfor {\n    count, err := stdout.Read(oneRune)\n    if err != nil {\n        break\n    }\n    fmt.Printf(\"%s\", oneRune[:count])\n}\n</code></pre>\n\n<h3>Things to keep in mind</h3>\n\n<p>Processes have default buffers for standard output and for standard error (usually the size of a few KB). If a process writes to the standard output or standard error, it goes into the respective buffer. If this buffer gets full, further writes <strong>will block</strong> (in the child process). If you don't read the standard output and standard error of a child process, your child process may hang if the buffer is full.</p>\n\n<p>So it is recommended to always read both the standard output and error of a child process. Even if you know that the command don't <em>normally</em> write to its standard error, if some error occurs, it will probably start dumping error messages to its standard error.</p>\n\n<p><strong>Edit:</strong> As Dave C mentions by default the standard output and error streams of the child process are discarded and will not cause a block / hang if not read. But still, by not reading the error stream you might miss a thing or two from the process.</p>\n"}, {"tags": [], "owner": {"reputation": 753, "user_id": 1826109, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LsWmX.png?s=128&g=1", "display_name": "chingis", "link": "https://stackoverflow.com/users/1826109/chingis"}, "is_accepted": false, "score": 0, "last_activity_date": 1522664848, "creation_date": 1522664848, "answer_id": 49609533, "question_id": 30725751, "link": "https://stackoverflow.com/questions/30725751/streaming-commands-output-progress/49609533#49609533", "title": "Streaming commands output progress", "body": "<p>I found good examples how to implement progress output in <a href=\"https://blog.kowalczyk.info/article/wOYk/advanced-command-execution-in-go-with-osexec.html\" rel=\"nofollow noreferrer\">this article</a> by Krzysztof Kowalczyk</p>\n"}], "owner": {"reputation": 155, "user_id": 3883502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745bed98a8e00dd26d5695b02872f317?s=128&d=identicon&r=PG&f=1", "display_name": "jftp", "link": "https://stackoverflow.com/users/3883502/jftp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3909, "favorite_count": 6, "accepted_answer_id": 30726590, "answer_count": 2, "score": 10, "last_activity_date": 1522664848, "creation_date": 1433835413, "last_edit_date": 1433839398, "question_id": 30725751, "link": "https://stackoverflow.com/questions/30725751/streaming-commands-output-progress", "title": "Streaming commands output progress", "body": "<p>I'm writing a service that has to stream output of a executed command both to parent and to log. When there is a long process, the problem is that <code>cmd.StdoutPipe</code> gives me a final (string) result.</p>\n\n<p>Is it possible to give partial output of what is going on, like in shell</p>\n\n<pre><code>func main() {\n    cmd := exec.Command(\"sh\", \"-c\", \"some long runnig task\")\n\n    stdout, _ := cmd.StdoutPipe()\n    cmd.Start()\n\n    scanner := bufio.NewScanner(stdout)\n    for scanner.Scan() {\n        m := scanner.Text()\n        fmt.Println(m)\n        log.Printf(m)\n    }\n\n    cmd.Wait()\n}\n</code></pre>\n\n<p>P.S. Just to output would be:</p>\n\n<pre><code>cmd.Stdout = os.Stdout\n</code></pre>\n\n<p>But in my case it is not enough.</p>\n"}, {"tags": ["go", "ssh-agent"], "comments": [{"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1433821396, "post_id": 30722304, "comment_id": 49502524, "body": "Is there any indication in the panic trace as to where the panic occurred?"}, {"owner": {"reputation": 59, "user_id": 3409575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676f470fe5bea078b1cf3065b1a0fa46?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan", "link": "https://stackoverflow.com/users/3409575/brendan"}, "reply_to_user": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1433821829, "post_id": 30722304, "comment_id": 49502644, "body": "sorry, I forgot to paste the panic. I am going to paste it."}, {"owner": {"reputation": 59, "user_id": 3409575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676f470fe5bea078b1cf3065b1a0fa46?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan", "link": "https://stackoverflow.com/users/3409575/brendan"}, "reply_to_user": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1433822094, "post_id": 30722304, "comment_id": 49502718, "body": "the panic occur in ssh.Dial()"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433858529, "post_id": 30722304, "comment_id": 49524826, "body": "That &quot;unreachable&quot; line <i>shouldn&#39;t</i> happen. The agent response is likely corrupted from concurrent use, but I&#39;m not sure where offhand. Try this with the race detector (you can set GOMAXPROCS&gt;1 for good measure)."}, {"owner": {"reputation": 59, "user_id": 3409575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676f470fe5bea078b1cf3065b1a0fa46?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan", "link": "https://stackoverflow.com/users/3409575/brendan"}, "edited": false, "score": 0, "creation_date": 1433899918, "post_id": 30722304, "comment_id": 49546577, "body": "I have set GOMAXPROCS like this: runtime.GOMAXPROCS(runtime.NumCPU()), and my NumCPU is 8. It also isn&#39;t working well"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433900406, "post_id": 30722304, "comment_id": 49546681, "body": "Did you check the race detector? But regardless, you probably don&#39;t need a new ssh agent client for each connection."}, {"owner": {"reputation": 59, "user_id": 3409575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676f470fe5bea078b1cf3065b1a0fa46?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan", "link": "https://stackoverflow.com/users/3409575/brendan"}, "edited": false, "score": 0, "creation_date": 1433902211, "post_id": 30722304, "comment_id": 49547113, "body": "I have checked the race detector, but there is nothing new. Then, I use time.Sleep(400000000) before start a goroutine , it works! So, what confused me now is the goroutine seems useless when I do that."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 3409575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676f470fe5bea078b1cf3065b1a0fa46?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan", "link": "https://stackoverflow.com/users/3409575/brendan"}, "is_accepted": true, "score": 2, "last_activity_date": 1434095517, "creation_date": 1434095517, "answer_id": 30797988, "question_id": 30722304, "link": "https://stackoverflow.com/questions/30722304/golang-goroutine-use-sshagent-auth-doesnt-work-well-and-throw-some-unexpect-pan/30797988#30797988", "title": "golang goroutine use SSHAgent auth doesn&#39;t work well and throw some unexpect panic", "body": "<p>I have solved the problem myself. As my understanding, the panic is caused by multiple goroutines want to use the connection of sshagent to the local server. Now, I only set connection once, and keep it connected until the program over. The code in function main :</p>\n\n<pre><code>    //get config\n    var config *ssh.ClientConfig\n    if sshAgent, err := net.Dial(\"unix\", os.Getenv(\"SSH_AUTH_SOCK\")); err == nil {\n            config = GetConfig(uname,sshAgent)\n            defer sshAgent.Close()\n    } else {\n            panic(err)\n    }\n</code></pre>\n\n<p>When I need a config in a goroutine, I pass the config as a param into it, it works well!</p>\n\n<p>My function in a goroutine is as follow:</p>\n\n<pre><code>func RunInChannel(ch chan int, host,cmd string,config *ssh.ClientConfig) error{\n    result,_ := ExcuteRemote(host,cmd,config)\n    if result {\n        fmt.Println(\"\\n\" + host + \"\\t\\tok\\n\")\n    } else {\n        ret,err := ExcuteRemote(host,cmd,config)\n        if ret {\n            fmt.Println(\"\\n\" + host + \"\\t\\tok\\n\")\n        } else {\n            fmt.Println(err)\n            fmt.Println(\"\\n\" + host + \"\\t\\tfailed\\n\")\n        }\n    }\n    ch &lt;- 1\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 3409575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676f470fe5bea078b1cf3065b1a0fa46?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan", "link": "https://stackoverflow.com/users/3409575/brendan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 30797988, "answer_count": 1, "score": 2, "last_activity_date": 1443010649, "creation_date": 1433818807, "last_edit_date": 1443010649, "question_id": 30722304, "link": "https://stackoverflow.com/questions/30722304/golang-goroutine-use-sshagent-auth-doesnt-work-well-and-throw-some-unexpect-pan", "title": "golang goroutine use SSHAgent auth doesn&#39;t work well and throw some unexpect panic", "body": "<p>I am writing a little tool for executing commands in parallel on many different hosts. All the hosts could login with a same private key. So, I want to use SSHAgent to get auth to login. When I use it for a single host, it works well. But when I use it in many goroutines, it doesn't work. I am very confused, is there somebody can help me? Thanks very much.\n    The code used sshagent are as below:</p>\n\n<pre><code>func ExcuteRemote(uname,host,cmd string) (bool,error) {\n        ip,err := GetIp(host)\n        if err != nil {\n                fmt.Println(err)\n                return false,err\n        }\n\n        auths := []ssh.AuthMethod{}\n        if sshAgent, err := net.Dial(\"unix\", os.Getenv(\"SSH_AUTH_SOCK\")); err == nil {\n                fmt.Println(\"get sock\")\n                auths = append(auths, ssh.PublicKeysCallback(agent.NewClient(sshAgent).Signers))\n                defer sshAgent.Close()\n        }\n\n        config := &amp;ssh.ClientConfig{\n                User: uname,\n                Auth: auths,\n        }\n        fmt.Println(\"after config\")\n\n        client, err := ssh.Dial(\"tcp\", ip+\":\"+\"22\", config)\n        if err != nil {\n                fmt.Println(\"something wrong when dial\")\n                fmt.Println(err)\n                return false,err\n        }\n\n        session, err := client.NewSession()\n        if err != nil {\n                return false,err\n        }\n        defer session.Close()\n\n        var b bytes.Buffer\n        session.Stdout = &amp;b\n        err = session.Run(cmd)\n        if err != nil {\n            return false,err\n        }\n\n        fmt.Println(b.String())\n        return true,nil\n}\n</code></pre>\n\n<p>And the code used channel are as below :</p>\n\n<pre><code>func testchannel(ch chan int, uname,host,cmd string) error{\n        result,err := ExcuteRemote(uname,host,cmd)\n        if result {\n                fmt.Println(host + \" ok\")\n        } else {\n                fmt.Println(err)\n                fmt.Println(host + \" failed\")\n        }\n        ch &lt;- 1\n        return nil\n} \n</code></pre>\n\n<p>in main:</p>\n\n<pre><code>if *list != \"\" {\n       runtime.GOMAXPROCS(runtime.NumCPU())\n       hosts,err := ReadLine(*list)\n       if nil != err {\n               panic(err.Error())\n       }\n       chs := make([]chan int, len(hosts))\n       for index := 0; index &lt; len(hosts); index++ {\n               chs[index] = make(chan int)\n               go testchannel(chs[index],uname,hosts[index],*cmd)\n       }\n       for _, ch := range(chs) {\n               &lt;-ch\n       }\n}\n</code></pre>\n\n<p>the panic like this :</p>\n\n<pre><code>panic: unreachable\n\ngoroutine 5 [running]:\ngolang.org/x/crypto/ssh/agent.(*client).Sign(0xc20801e440, 0x7f053381a9f8, 0xc208094100, 0xc208121b00, 0x201, 0x240, 0xc2080a6009, 0x0, 0x0)\n        /usr/local/gosrc/src/golang.org/x/crypto/ssh/agent/client.go:342 +0x472\ngolang.org/x/crypto/ssh/agent.(*agentKeyringSigner).Sign(0xc20801e560, 0x7f053380fb38, 0xc20803c2d0, 0xc208121b00, 0x201, 0x240, 0xe, 0x0, 0x0)\n        /usr/local/gosrc/src/golang.org/x/crypto/ssh/agent/client.go:562 +0x71\ngolang.org/x/crypto/ssh.publicKeyCallback.auth(0xc20801e480, 0xc2080a4040, 0x14, 0x20, 0xc20802a954, 0x4, 0x7f053381a998, 0xc2080ca000, 0x7f053380fb38, 0xc20803c2d0, ...)\n        /usr/local/gosrc/src/golang.org/x/crypto/ssh/client_auth.go:210 +0x5ee\ngolang.org/x/crypto/ssh.(*connection).clientAuthenticate(0xc2080b8080, 0xc2080b2000, 0x0, 0x0)\n        /usr/local/gosrc/src/golang.org/x/crypto/ssh/client_auth.go:34 +0x4e3\ngolang.org/x/crypto/ssh.(*connection).clientHandshake(0xc2080b8080, 0xc20801e4c0, 0x11, 0xc2080b2000, 0x0, 0x0)\n        /usr/local/gosrc/src/golang.org/x/crypto/ssh/client.go:112 +0x62e\ngolang.org/x/crypto/ssh.NewClientConn(0x7f05338111e8, 0xc2080aa000, 0xc20801e4c0, 0x11, 0xc2080420a0, 0x0, 0x0, 0x0, 0x41be71, 0x0, ...)\n        /usr/local/gosrc/src/golang.org/x/crypto/ssh/client.go:74 +0x140\ngolang.org/x/crypto/ssh.Dial(0x785a50, 0x3, 0xc20801e4c0, 0x11, 0xc2080420a0, 0x11, 0x0, 0x0)\n        /usr/local/gosrc/src/golang.org/x/crypto/ssh/client.go:176 +0xf9\nmain.ExcuteRemote(0xc20802a954, 0x4, 0xc20802a9a0, 0xe, 0x7fffa171b7fd, 0x6, 0xc200000000, 0x0, 0x0)\n        /home/myname/easyssh/r.go:126 +0x83f\nmain.testchannel(0xc208036120, 0xc20802a954, 0x4, 0xc20802a9a0, 0xe, 0x7fffa171b7fd, 0x6, 0x0, 0x0)\n        /home/myname/easyssh/r.go:217 +0x8c\ncreated by main.main\n        /home/myname/gocode/easyssh/r.go:262 +0x638\n</code></pre>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1433807887, "post_id": 30720677, "comment_id": 49499253, "body": "Post the error message (exactly) and the corresponding template code. At first glance however you are referencing a <code>&amp;model</code> variable that doesn&#39;t exist in the function&#39;s scope - do you mean to use <code>&amp;user</code> instead?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1433808067, "post_id": 30720677, "comment_id": 49499298, "body": "What is wrong with your code exactly? The if statement and optional length id thing works perfectly fine..."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1433808674, "last_edit_date": 1433808674, "creation_date": 1433808362, "answer_id": 30720994, "question_id": 30720677, "link": "https://stackoverflow.com/questions/30720677/why-are-revel-optional-func-parameters-in-controller-not-working-crud-code-redu/30720994#30720994", "title": "Why are Revel optional func parameters in controller not working? CRUD code redundancy", "body": "<p>There are many ways to solve this problem, like any other. The simple obvious solution (which works in any language) would be to move the common logic into a helper method and provide two wrappers around it that accept different arguments. That being said, I don't think it's necessary and can't actually understand what your problem is because your code works just fine... My example program below clearly shows you can call the method with 0 or more arguments and decide what to do based on how many are present.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    Test()\n    Test(1)\n    Test(1, 2)\n    Test(1, 2, 3, 4)\n}\n\nfunc Test(numbers ... int) {\n    fmt.Println(len(numbers))\n}\n</code></pre>\n\n<p>I would guess your intent is to update if there is an id provided (if there's an id then it would indicate there is an existing record) and do insert if it is not. My other guess is that you're confused about how to call the method, not how to define it. Your definition looks fines and should work how you intend it to so long as you call it correctly. Finally, I think you're probably misusing the <code>...</code> language feature. If the length of id is intended to be 1 or 0 and you're using that variable length array thing as a substitute for real optional parameters, you probably should stop doing that. You could just use 2 arguments, a bool saying 'update' and an int for id. If update is false, you call update and don't pass the id.</p>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 0, "last_activity_date": 1433824627, "creation_date": 1433824627, "answer_id": 30723108, "question_id": 30720677, "link": "https://stackoverflow.com/questions/30720677/why-are-revel-optional-func-parameters-in-controller-not-working-crud-code-redu/30723108#30723108", "title": "Why are Revel optional func parameters in controller not working? CRUD code redundancy", "body": "<p>Or you can try variadic arguments parsing, like how Python uses <strong>*args</strong></p>\n\n<pre><code>func (c Account) User(args ...interface{}) {\n\n    for _, arg := range args {\n        switch v := arg.(type) {\n        case models.User:\n            // validate user\n        case string:\n            // verify password\n        case []int64:\n            if len(v) &gt; 0 {\n                c.Txn.Update(&amp;model)\n            } else {\n                c.Txn.Insert(&amp;model)\n            }\n        default:\n            // some default stuff\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 30723108, "answer_count": 2, "score": 0, "last_activity_date": 1433878620, "creation_date": 1433806009, "last_edit_date": 1592644375, "question_id": 30720677, "link": "https://stackoverflow.com/questions/30720677/why-are-revel-optional-func-parameters-in-controller-not-working-crud-code-redu", "title": "Why are Revel optional func parameters in controller not working? CRUD code redundancy", "body": "<p>I was reading lot about Go and see that I cannot have optional parameters (nor default value for some parameters) in methods or functions.\nLets take for example simple <a href=\"https://en.wikipedia.org/wiki/Create,_read,_update_and_delete\" rel=\"nofollow noreferrer\">CRUD</a>.</p>\n<p>I want to use same controller action for create and update and just to do simple:</p>\n<pre><code>func (c Account) User(user models.User, verifyPassword string, id ...int64) {\n\n    /*\n    validate user etc\n   */\n    if len(id) &gt; 0 {\n        c.Txn.Update(&amp;model)\n    } else{\n        c.Txn.Insert(&amp;model)\n    }\n}\n</code></pre>\n<p>When I try to do <code>{{ url &quot;Account.User&quot; }}</code> in a template,\nI get an error saying that I am missing parameters.\nOnce I hardcode value for route, I have some invalid memory address or nil pointer dereference on an unknown part of code.</p>\n<p>Without optional/default parameters I will have code redundancy for CRUD that I do not want!</p>\n<p>So instead of one function I will have to use two functions for the same thing that are only different in one line of code.</p>\n<p>Since I started learning Go and Revel seven days ago, maybe I've missed something.\nThe only reason I used Go and Revel is for speed.\nI am using this for some project that has a lot of requests\u00a0(millions per day).</p>\n<p>Is there any way to solve this?</p>\n<h3>Update</h3>\n<p>First problem is on the view: <code>{{ url &quot;Account.User&quot; }}</code></p>\n<p>When I used it like this, it says:</p>\n<pre><code>missing parameter id for route Account.User in func (c Account) User(user models.User, verifyPassword string, id ...int64)\n</code></pre>\n<p>So this is more of a Revel problem then Go.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1433826107, "post_id": 30718602, "comment_id": 49503867, "body": "Please note that neither <code>val.(unit16)</code> nor <code>uint16(val)</code> is a &quot;cast&quot;: The first is a &quot;type assertion&quot; and the second and &quot;type conversion&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 13, "last_activity_date": 1433798221, "last_edit_date": 1433798221, "creation_date": 1433797754, "answer_id": 30719144, "question_id": 30718602, "link": "https://stackoverflow.com/questions/30718602/type-cast-custom-types-to-base-types/30719144#30719144", "title": "Type cast custom types to base types", "body": "<p>You can accomplish this by using the <a href=\"https://godoc.org/reflect\" rel=\"noreferrer\"><code>reflect</code></a> package:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype Year uint16\n\nfunc AsUint16(val interface{}) uint16 {\n    ref := reflect.ValueOf(val)\n    if ref.Kind() != reflect.Uint16 {\n        return 0\n    }\n    return uint16(ref.Uint())\n}\n\nfunc main() {\n    fmt.Println(AsUint16(Year(2015)))\n}\n</code></pre>\n\n<p>Depending on your situation, you may want to return <code>(uint16, error)</code>, instead of returning the empty value.</p>\n\n<p><a href=\"https://play.golang.org/p/sYm1jTCMIf\" rel=\"noreferrer\">https://play.golang.org/p/sYm1jTCMIf</a></p>\n"}, {"comments": [{"owner": {"reputation": 732, "user_id": 1195316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0550ca85a6271b34e7b63d27e52f5912?s=128&d=identicon&r=PG", "display_name": "Alex Bar", "link": "https://stackoverflow.com/users/1195316/alex-bar"}, "edited": false, "score": 0, "creation_date": 1433878572, "post_id": 30733791, "comment_id": 49538316, "body": "I have many (N) custom types based on simple types (uint8, 16, 32...). And I don&#39;t want create N methods instead of the one"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "reply_to_user": {"reputation": 732, "user_id": 1195316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0550ca85a6271b34e7b63d27e52f5912?s=128&d=identicon&r=PG", "display_name": "Alex Bar", "link": "https://stackoverflow.com/users/1195316/alex-bar"}, "edited": false, "score": 0, "creation_date": 1433891372, "post_id": 30733791, "comment_id": 49544386, "body": "That&#39;s fair, but it&#39;s worth weighing up the pros and cons of each approach. The explicit approach I described above is simple, fast and type-safe but possibly too verbose. The reflective approach will be slower and less explicit in what it does to people who come along and read your code."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "reply_to_user": {"reputation": 732, "user_id": 1195316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0550ca85a6271b34e7b63d27e52f5912?s=128&d=identicon&r=PG", "display_name": "Alex Bar", "link": "https://stackoverflow.com/users/1195316/alex-bar"}, "edited": false, "score": 0, "creation_date": 1433891479, "post_id": 30733791, "comment_id": 49544418, "body": "FWIW, I&#39;ve dealt with a similar situation by using <a href=\"https://github.com/clipperhouse/gen\" rel=\"nofollow noreferrer\">Gen</a> to create boilerplate code from templates, but in your case it&#39;s not a compelling choice."}], "tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 7, "last_activity_date": 1433857849, "last_edit_date": 1433857849, "creation_date": 1433857413, "answer_id": 30733791, "question_id": 30718602, "link": "https://stackoverflow.com/questions/30718602/type-cast-custom-types-to-base-types/30733791#30733791", "title": "Type cast custom types to base types", "body": "<p>Why did you include <code>Year</code> in the question? Are you hoping to convert arbitrary things into Years, or convert Years into uint16s?</p>\n\n<p>If I assume you meant the latter case, then it would be better to use a method </p>\n\n<pre><code>func (y Year) AsUint16() uint16 { \n    return uint16(y)\n}\n</code></pre>\n\n<p>which doesn't need any type assertions or reflection.</p>\n\n<p><a href=\"https://play.golang.org/p/9wCQJe46PU\" rel=\"noreferrer\">https://play.golang.org/p/9wCQJe46PU</a></p>\n"}], "owner": {"reputation": 732, "user_id": 1195316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0550ca85a6271b34e7b63d27e52f5912?s=128&d=identicon&r=PG", "display_name": "Alex Bar", "link": "https://stackoverflow.com/users/1195316/alex-bar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14878, "favorite_count": 1, "accepted_answer_id": 30719144, "answer_count": 2, "score": 20, "last_activity_date": 1500711479, "creation_date": 1433795752, "last_edit_date": 1500711479, "question_id": 30718602, "link": "https://stackoverflow.com/questions/30718602/type-cast-custom-types-to-base-types", "title": "Type cast custom types to base types", "body": "<p>How can I convert custom type to <code>interface{}</code> and then to base type (ex. <code>uint8</code>)?</p>\n\n<p>I can't use direct cast like <code>uint16(val.(Year))</code> because I may not know all custom types, but I can determinate base types (<code>uint8</code>, <code>uint32</code>,...) in runtime</p>\n\n<hr>\n\n<p>There are many custom types (usually used as enums) based on numeric:</p>\n\n<p>ex:</p>\n\n<pre><code>type Year  uint16\ntype Day   uint8\ntype Month uint8\n</code></pre>\n\n<p>and so on...</p>\n\n<p>The question is about type casting from <code>interface{}</code> to base types:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Year uint16\n\n// ....\n//Many others custom types based on uint8\n\nfunc AsUint16(val interface{}) uint16 {\n    return val.(uint16) //FAIL:  cannot convert val (type interface {}) to type uint16: need type assertion\n}\n\nfunc AsUint16_2(val interface{}) uint16 {\n    return uint16(val) //FAIL:   cannot convert val (type interface {}) to type uint16: need type assertion\n}\n\nfunc main() {\n    fmt.Println(AsUint16_2(Year(2015)))\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/cyAnzQ90At\">http://play.golang.org/p/cyAnzQ90At</a></p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1907906"}, "edited": false, "score": 2, "creation_date": 1433793139, "post_id": 30717830, "comment_id": 49493320, "body": "Plese <a href=\"https://stackoverflow.com/posts/30717830/edit\">edit</a> you question and include code, not screenshots."}, {"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1433793182, "post_id": 30717830, "comment_id": 49493339, "body": "are you aware of Cmd+Shift+4?  full screenshots aren&#39;t necessary. we can&#39;t zoom in!"}, {"owner": {"reputation": 1664, "user_id": 1833511, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ab0c9cc3bb28498a3e83e5862ab2f5b4?s=128&d=identicon&r=PG", "display_name": "Dirk", "link": "https://stackoverflow.com/users/1833511/dirk"}, "reply_to_user": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1433793460, "post_id": 30717830, "comment_id": 49493488, "body": "@sircapsalot I&#39;ll zoom in, I wasn&#39;t aware of the fact that you can&#39;t zoom in on this"}, {"owner": {"reputation": 1664, "user_id": 1833511, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ab0c9cc3bb28498a3e83e5862ab2f5b4?s=128&d=identicon&r=PG", "display_name": "Dirk", "link": "https://stackoverflow.com/users/1833511/dirk"}, "edited": false, "score": 0, "creation_date": 1433793683, "post_id": 30717830, "comment_id": 49493623, "body": "@LutzHorn Code isn&#39;t quite useful here, the screenshots are only to demonstrate that my IDE acts like I&#39;d expect, but <code>go</code> doesn&#39;t"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1433794187, "post_id": 30717830, "comment_id": 49493891, "body": "@Dirk: This may sound harsh, but nobody is interested in your IDE. Only the output  of your compiler matters."}, {"owner": {"reputation": 1664, "user_id": 1833511, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ab0c9cc3bb28498a3e83e5862ab2f5b4?s=128&d=identicon&r=PG", "display_name": "Dirk", "link": "https://stackoverflow.com/users/1833511/dirk"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1433794627, "post_id": 30717830, "comment_id": 49494143, "body": "@Volker I know, but the compiler doesn&#39;t say anything either"}], "answers": [{"comments": [{"owner": {"reputation": 1664, "user_id": 1833511, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ab0c9cc3bb28498a3e83e5862ab2f5b4?s=128&d=identicon&r=PG", "display_name": "Dirk", "link": "https://stackoverflow.com/users/1833511/dirk"}, "edited": false, "score": 0, "creation_date": 1433795381, "post_id": 30718465, "comment_id": 49494526, "body": "That did it, but I&#39;m curious; is there any reason <code>protoc-gen-go</code> would update the .go files, but not the object files?"}, {"owner": {"reputation": 24278, "user_id": 6013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2c21bed614c58c9e1c48fe272e79efd2?s=128&d=identicon&r=PG", "display_name": "Joshua", "link": "https://stackoverflow.com/users/6013/joshua"}, "reply_to_user": {"reputation": 1664, "user_id": 1833511, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ab0c9cc3bb28498a3e83e5862ab2f5b4?s=128&d=identicon&r=PG", "display_name": "Dirk", "link": "https://stackoverflow.com/users/1833511/dirk"}, "edited": false, "score": 1, "creation_date": 1433797841, "post_id": 30718465, "comment_id": 49495725, "body": "protoc is only responsible for creating the .go files. The object files are created by the normal go compilation."}], "tags": [], "owner": {"reputation": 24278, "user_id": 6013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2c21bed614c58c9e1c48fe272e79efd2?s=128&d=identicon&r=PG", "display_name": "Joshua", "link": "https://stackoverflow.com/users/6013/joshua"}, "is_accepted": true, "score": 1, "last_activity_date": 1433795239, "creation_date": 1433795239, "answer_id": 30718465, "question_id": 30717830, "link": "https://stackoverflow.com/questions/30717830/go-protocol-buffers-acting-really-strange/30718465#30718465", "title": "Go + Protocol buffers acting really strange", "body": "<p>Protocol buffers are not compiled automatically into Go code unless you have a third party tool that does this. The protoc tool that is part of Protocol Buffers would be used to create the Go implementation of the .proto files. The output should reside in your $GOPATH/src. The .a files would be stored under $GOPATH/pkg. The code completion looks at the $GOPATH/pkg whereas the \"go\" tool would look in $GOPATH/src for anything that had changed.</p>\n\n<p>Remove the contents of $GOPATH/pkg and then run \"go install\" to recreate the .a files.</p>\n"}], "owner": {"reputation": 1664, "user_id": 1833511, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ab0c9cc3bb28498a3e83e5862ab2f5b4?s=128&d=identicon&r=PG", "display_name": "Dirk", "link": "https://stackoverflow.com/users/1833511/dirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 30718465, "answer_count": 1, "score": -5, "last_activity_date": 1433795239, "creation_date": 1433793005, "last_edit_date": 1433793635, "question_id": 30717830, "link": "https://stackoverflow.com/questions/30717830/go-protocol-buffers-acting-really-strange", "title": "Go + Protocol buffers acting really strange", "body": "<p>I'm writing a service-based server for a project I'm working on, which is written in Go and uses Protocol Buffers for inter-service communication. Everything was working fine until I added protocols named <code>DeviceRequest</code> and <code>DeviceResponse</code>, now the compiler can't find them, while the go source of the protocol exists and is set up in my <code>GOPATH</code>. WebStorm also finds them, but for some reason the compiler doesn't. The strange thing is that old protocols of which the Go source doesn't exist anymore do work (Webstorm also does not recognize them), see these screenshots <img src=\"https://i.stack.imgur.com/7EAKA.png\" alt=\"enter image description here\"> <img src=\"https://i.stack.imgur.com/Zk2DV.png\" alt=\"enter image description here\"> <img src=\"https://i.stack.imgur.com/6wlYH.png\" alt=\"enter image description here\"></p>\n\n<p>I've tried deleting the files in my <code>GOPATH</code>, but that didn't work. My guess is that <code>go</code> is using some kind of cache memory but I couldn't find anything about that online. </p>\n"}, {"tags": ["pointers", "go", "struct", "literals"], "comments": [{"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 1, "creation_date": 1528582788, "post_id": 30716354, "comment_id": 88564888, "body": "Pointers to int are unfortunate as the int takes up the same amount of space as a pointer, so you&#39;re not saving space. It just adds a NULL value which is usually just more complexity than it is worth. In most cases a 0 would be fine. If you need an extra value an &quot;IsValidSomeField&quot; bool also works and if you give that bool a better name it can say more about why you need that extra value, which is good for readability."}, {"owner": {"reputation": 101, "user_id": 7481796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cikv0.jpg?s=128&g=1", "display_name": "Xor", "link": "https://stackoverflow.com/users/7481796/xor"}, "edited": false, "score": 3, "creation_date": 1573121872, "post_id": 30716354, "comment_id": 103781782, "body": "You can use package <a href=\"https://github.com/xorcare/pointer\" rel=\"nofollow noreferrer\">pointer</a>, for example: <code>var _ *int64 = pointer.Int64(64)</code>"}, {"owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "edited": false, "score": 0, "creation_date": 1601300644, "post_id": 30716354, "comment_id": 113356540, "body": "This is such a pity that we have to write a function or even a library to be able to do this."}], "answers": [{"comments": [{"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1433790604, "post_id": 30716481, "comment_id": 49491907, "body": "@icza you typically wouldn&#39;t want them pointing to the same object, I&#39;m not saying you would. I&#39;m just pointing out the difference."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1921, "user_id": 1058820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d68af169f4ca1c5029900da3d154cf54?s=128&d=identicon&r=PG", "display_name": "ThisGuy", "link": "https://stackoverflow.com/users/1058820/thisguy"}, "edited": false, "score": 4, "creation_date": 1433790657, "post_id": 30716481, "comment_id": 49491932, "body": "@Conslo Constants are evaluated at compile time. A valid pointer value, a valid memory address only exists at runtime, so this is not the same as constants."}, {"owner": {"reputation": 6636, "user_id": 1385242, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bce12c002581b804125a5675841f0f7f?s=128&d=identicon&r=PG", "display_name": "Rajkamal Subramanian", "link": "https://stackoverflow.com/users/1385242/rajkamal-subramanian"}, "edited": false, "score": 0, "creation_date": 1511215191, "post_id": 30716481, "comment_id": 81757329, "body": "@icza, i have a question about the selector used in method#6. I have the question mentioned in the playground url <a href=\"https://play.golang.org/p/U9jqOYA6EP\" rel=\"nofollow noreferrer\">play.golang.org/p/U9jqOYA6EP</a>. (comment allows only few chars)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6636, "user_id": 1385242, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/bce12c002581b804125a5675841f0f7f?s=128&d=identicon&r=PG", "display_name": "Rajkamal Subramanian", "link": "https://stackoverflow.com/users/1385242/rajkamal-subramanian"}, "edited": false, "score": 0, "creation_date": 1511251166, "post_id": 30716481, "comment_id": 81769018, "body": "@rajkamal Simply because the spec does not allow it. You can take the address of a composite literal (your first example), but you can&#39;t take the address of a field of a composite literal (this is not listed in the spec). Note that you can take however the address of a field of a variable of struct type, but not that of a composite literal (<i>&quot;field selector of an addressable struct operand&quot;</i>)."}, {"owner": {"reputation": 2266, "user_id": 2128901, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb08c32a2d1d2dff42f538d968632b7f?s=128&d=identicon&r=PG", "display_name": "Matt Wielbut", "link": "https://stackoverflow.com/users/2128901/matt-wielbut"}, "edited": false, "score": 0, "creation_date": 1545669993, "post_id": 30716481, "comment_id": 94674697, "body": "If you want to be really lazy, here is a package that provides the helper functions (solution #3) for each go primitive type: <a href=\"https://godoc.org/github.com/mwielbut/pointy\" rel=\"nofollow noreferrer\">godoc.org/github.com/mwielbut/pointy</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 245, "last_activity_date": 1593690728, "last_edit_date": 1593690728, "creation_date": 1433788138, "answer_id": 30716481, "question_id": 30716354, "link": "https://stackoverflow.com/questions/30716354/how-do-i-do-a-literal-int64-in-go/30716481#30716481", "title": "How do I do a literal *int64 in Go?", "body": "<p>The Go Language Specification (<a href=\"http://golang.org/ref/spec#Address_operators\" rel=\"noreferrer\">Address operators</a>) does not allow to take the address of a numeric constant (not of an <em>untyped</em> nor of a <em>typed</em> constant).</p>\n<blockquote>\n<p>The operand must be <em>addressable</em>, that is, either a variable, pointer indirection, or slice indexing operation; or a field selector of an addressable struct operand; or an array indexing operation of an addressable array. As an exception to the addressability requirement, <code>x</code> [in the expression of <code>&amp;x</code>] may also be a (possibly parenthesized) <a href=\"http://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literal</a>.</p>\n</blockquote>\n<p>For reasoning why this isn't allowed, see related question: <a href=\"https://stackoverflow.com/questions/35146286/find-address-of-constant-in-go/35146856#35146856\">Find address of constant in go</a>. A similar question (similarly not allowed to take its address): <a href=\"https://stackoverflow.com/questions/34197248/how-can-i-store-reference-to-the-result-of-an-operation-in-go/34197367#34197367\">How can I store reference to the result of an operation in Go?</a></p>\n<p>Your options (try all on the <a href=\"https://play.golang.org/p/d2Hks6mYcr5\" rel=\"noreferrer\">Go Playground</a>):</p>\n<h3>1) With <code>new()</code></h3>\n<p>You can simply use the builtin <a href=\"http://golang.org/pkg/builtin/#new\" rel=\"noreferrer\"><code>new()</code></a> function to allocate a new zero-valued <code>int64</code> and get its address:</p>\n<pre><code>instance := SomeType{\n    SomeField: new(int64),\n}\n</code></pre>\n<p>But note that this can only be used to allocate and obtain a pointer to the zero value of any type.</p>\n<h3>2) With helper variable</h3>\n<p>Simplest and recommended for non-zero elements is to use a helper variable whose address can be taken:</p>\n<pre><code>helper := int64(2)\ninstance2 := SomeType{\n    SomeField: &amp;helper,\n}\n</code></pre>\n<h3>3) With helper function</h3>\n<p><em><strong>Note:</strong> Helper functions to acquire a pointer to a non-zero value are available in my <a href=\"https://github.com/icza/gox\" rel=\"noreferrer\"><code>github.com/icza/gox</code></a> library, in the <a href=\"https://godoc.org/github.com/icza/gox/gox\" rel=\"noreferrer\"><code>gox</code></a> package, so you don't have to add these to all your projects where you need it.</em></p>\n<p>Or if you need this many times, you can create a helper function which allocates and returns an <code>*int64</code>:</p>\n<pre><code>func create(x int64) *int64 {\n    return &amp;x\n}\n</code></pre>\n<p>And using it:</p>\n<pre><code>instance3 := SomeType{\n    SomeField: create(3),\n}\n</code></pre>\n<p>Note that we actually didn't allocate anything, the Go compiler did that when we returned the address of the function argument. The Go compiler performs escape analysis, and allocate local variables on the heap (instead of the stack) if they may escape the function. For details, see <a href=\"https://stackoverflow.com/questions/42530219/is-returning-a-slice-of-a-local-array-in-a-go-function-safe/42530418#42530418\">Is returning a slice of a local array in a Go function safe?</a></p>\n<h3>4) With a one-liner anonymous function</h3>\n<pre><code>instance4 := SomeType{\n    SomeField: func() *int64 { i := int64(4); return &amp;i }(),\n}\n</code></pre>\n<p>Or as a (shorter) alternative:</p>\n<pre><code>instance4 := SomeType{\n    SomeField: func(i int64) *int64 { return &amp;i }(4),\n}\n</code></pre>\n<h3>5) With slice literal, indexing and taking address</h3>\n<p>If you would want <code>*SomeField</code> to be other than <code>0</code>, then you need something addressable.</p>\n<p>You can still do that, but that's ugly:</p>\n<pre><code>instance5 := SomeType{\n    SomeField: &amp;[]int64{5}[0],\n}\nfmt.Println(*instance2.SomeField) // Prints 5\n</code></pre>\n<p>What happens here is an <code>[]int64</code> slice is created with a literal, having one element (<code>5</code>). And it is indexed (0th element) and the address of the 0th element is taken. In the background an array of <code>[1]int64</code> will also be allocated and used as the backing array for the slice. So there is a lot of boilerplate here.</p>\n<h3>6) With a helper struct literal</h3>\n<p>Let's examine the exception to the addressability requirements:</p>\n<blockquote>\n<p>As an exception to the addressability requirement, <code>x</code> [in the expression of <code>&amp;x</code>] may also be a (possibly parenthesized) <a href=\"http://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literal</a>.</p>\n</blockquote>\n<p>This means that taking the address of a composite literal, e.g. a struct literal is ok. If we do so, we will have the struct value allocated and a pointer obtained to it. But if so, another requirement will become available to us: <strong>&quot;field selector of an addressable struct operand&quot;</strong>. So if the struct literal contains a field of type <code>int64</code>, we can also take the address of that field!</p>\n<p>Let's see this option in action. We will use this wrapper struct type:</p>\n<pre><code>type intwrapper struct {\n    x int64\n}\n</code></pre>\n<p>And now we can do:</p>\n<pre><code>instance6 := SomeType{\n    SomeField: &amp;(&amp;intwrapper{6}).x,\n}\n</code></pre>\n<p>Note that this</p>\n<pre><code>&amp;(&amp;intwrapper{6}).x\n</code></pre>\n<p>means the following:</p>\n<pre><code>&amp; ( (&amp;intwrapper{6}).x )\n</code></pre>\n<p>But we can omit the &quot;outer&quot; parenthesis as the address operator <code>&amp;</code> is applied to the result of the <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"noreferrer\">selector expression</a>.</p>\n<p>Also note that in the background the following will happen (this is also a valid syntax):</p>\n<pre><code>&amp;(*(&amp;intwrapper{6})).x\n</code></pre>\n<h3>7) With helper anonymous struct literal</h3>\n<p>The principle is the same as with case #6, but we can also use an anonymous struct literal, so no helper/wrapper struct type definition needed:</p>\n<pre><code>instance7 := SomeType{\n    SomeField: &amp;(&amp;struct{ x int64 }{7}).x,\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "is_accepted": false, "score": 6, "last_activity_date": 1585585031, "last_edit_date": 1585585031, "creation_date": 1537524235, "answer_id": 52441288, "question_id": 30716354, "link": "https://stackoverflow.com/questions/30716354/how-do-i-do-a-literal-int64-in-go/52441288#52441288", "title": "How do I do a literal *int64 in Go?", "body": "<h2>Use a function which return an address of an int64 variable to solve the problem.</h2>\n\n<blockquote>\n  <p>In the below code we use function <code>f</code> which accepts an integer and\n  returns a pointer value which holds the address of the integer. By using this method we can easily solve the above problem.</p>\n</blockquote>\n\n<pre><code>type myStr struct {\n    url *int64\n}\n\nfunc main() {\n    f := func(s int64) *int64 {\n        return &amp;s\n    }\n    myStr{\n        url: f(12345),\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1921, "user_id": 1058820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d68af169f4ca1c5029900da3d154cf54?s=128&d=identicon&r=PG", "display_name": "ThisGuy", "link": "https://stackoverflow.com/users/1058820/thisguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66687, "favorite_count": 33, "accepted_answer_id": 30716481, "answer_count": 2, "score": 122, "last_activity_date": 1593690728, "creation_date": 1433787698, "last_edit_date": 1475651133, "question_id": 30716354, "link": "https://stackoverflow.com/questions/30716354/how-do-i-do-a-literal-int64-in-go", "title": "How do I do a literal *int64 in Go?", "body": "<p>I have a struct type with a <code>*int64</code> field.</p>\n\n<pre><code>type SomeType struct {\n    SomeField *int64\n}\n</code></pre>\n\n<p>At some point in my code, I want to declare a literal of this (say, when I know said value should be 0, or pointing to a 0, you know what I mean)</p>\n\n<pre><code>instance := SomeType{\n    SomeField: &amp;0,\n}\n</code></pre>\n\n<p>...except this doesn't work</p>\n\n<pre><code>./main.go:xx: cannot use &amp;0 (type *int) as type *int64 in field value\n</code></pre>\n\n<p>So I try this</p>\n\n<pre><code>instance := SomeType{\n    SomeField: &amp;int64(0),\n}\n</code></pre>\n\n<p>...but this also doesn't work</p>\n\n<pre><code>./main.go:xx: cannot take the address of int64(0)\n</code></pre>\n\n<p>How do I do this? The only solution I can come up with is using a placeholder variable</p>\n\n<pre><code>var placeholder int64\nplaceholder = 0\n\ninstance := SomeType{\n    SomeField: &amp;placeholder,\n}\n</code></pre>\n\n<p><s>Note: the <code>&amp;0</code> syntax works <em>fine</em> when it's a *int instead of an <code>*int64</code>.</s> Edit: no it does not. Sorry about this.</p>\n\n<p>Edit:</p>\n\n<p>Aparently there was too much ambiguity to my question. I'm looking for a way to <em>literally state</em> a <code>*int64</code>. This could be used inside a constructor, or to state literal struct values, or even as arguments to other functions. But helper functions or using a different type are not solutions I'm looking for.</p>\n"}, {"tags": ["go", "google-go-idea-plugin"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1433782270, "post_id": 30714750, "comment_id": 49487088, "body": "<code>...</code> is passing a slice as varargs. You should always append to your <code>queryValues</code> slice, not to <code>Name</code> and <code>Age</code>. I guess your code doesn&#39;t even compile. Even if it does, <code>queryValue</code> will not be what you think it is."}, {"owner": {"reputation": 529, "user_id": 3641313, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/gd4Kd.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3641313/josh"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1433782417, "post_id": 30714750, "comment_id": 49487169, "body": "@icza I had to use Pseudo code because my actual code is company propriety. So What print method can I used to have it append those values in the slice to there corresponding $ number in the original string?"}], "answers": [{"tags": [], "owner": {"reputation": 504, "user_id": 1759754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73c0615cc1c4e200b06f66bcad627dc5?s=128&d=identicon&r=PG", "display_name": "Erik St. Martin", "link": "https://stackoverflow.com/users/1759754/erik-st-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1433782771, "creation_date": 1433782771, "answer_id": 30715021, "question_id": 30714750, "link": "https://stackoverflow.com/questions/30714750/golang-string-parameters-printing/30715021#30715021", "title": "GoLang String Parameters Printing", "body": "<p>The answer to your first question is that Query is what's referred to as a variadic function <a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow\">https://golang.org/ref/spec#Function_types</a>. It takes any number of parameters of the last type, and is handed to the function as a slice.</p>\n\n<p>queryValues... is the reverse of that. It is taking your slice and passing them as individual arguments to query. It's doing the same thing as if you had done: </p>\n\n<pre><code>dbConnection.Query(query, queryValues[0], queryValues[1])\n</code></pre>\n\n<p><a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow\">https://golang.org/ref/spec#Passing_arguments_to_..._parameters</a></p>\n\n<p>In this particular case you don't need the []interface{}</p>\n\n<pre><code>dbConnection(query, obj.Name, obj.Age)\n</code></pre>\n\n<p>The reason your $1, $2 placeholders are not being converted is likely because you're using the wrong placeholders for the particular driver you're using. It's dependent on the driver itself. For instance the MySQL driver uses '?' as it's placeholder.</p>\n"}], "owner": {"reputation": 529, "user_id": 3641313, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/gd4Kd.jpg?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3641313/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 576, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1433782771, "creation_date": 1433781812, "question_id": 30714750, "link": "https://stackoverflow.com/questions/30714750/golang-string-parameters-printing", "title": "GoLang String Parameters Printing", "body": "<p>I have a sql select statement like this example:</p>\n\n<pre><code>queryValues = make([]interface{}, 0, 5)\n\nqueryValues = append(Name, obj.Name)\nqueryValues = append(Age, obj.Age)\nwhereClause := \"where name = $1 and age = $2\"    \n\nquery := fmt.Sprintf(\"Select * from Table1  %s;\", whereClause)\n\nrows, err := dbConnection.Query(query, queryValues...)\n</code></pre>\n\n<p>I have several questions here. What is the ... after queryValues? How come when I look at the query being passed up to the db none of the $1 are actually being converted into there real values?</p>\n\n<p>What print function can I run to mimic dbConnection.Query(query, queryValues...) so that I can see it before it is passed up?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Josh</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "edited": false, "score": 0, "creation_date": 1433772330, "post_id": 30709670, "comment_id": 49479916, "body": "Thanks that works great. I wonder if it is a bug that <code>EncodeToken</code> doesn&#39;t respect Indent?"}, {"owner": {"reputation": 563, "user_id": 2395590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eVs4H.jpg?s=128&g=1", "display_name": "justinpage", "link": "https://stackoverflow.com/users/2395590/justinpage"}, "edited": false, "score": 0, "creation_date": 1540951503, "post_id": 30709670, "comment_id": 93048696, "body": "For convenience, you can use <code>xml.Header</code> const from the package: <a href=\"https://golang.org/pkg/encoding/xml/#pkg-constants\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/xml/#pkg-constants</a>. Here&#39;s how I solved the same problem in relation to this answer: <a href=\"https://gist.github.com/4f19c2981932caa71cd45fd9e6a21f61\" rel=\"nofollow noreferrer\">gist.github.com/4f19c2981932caa71cd45fd9e6a21f61</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1471955454, "last_edit_date": 1471955454, "creation_date": 1433767906, "answer_id": 30709670, "question_id": 30709562, "link": "https://stackoverflow.com/questions/30709562/using-encoding-xml-encoder-how-do-i-place-the-xml-header-on-its-own-line/30709670#30709670", "title": "Using encoding/xml.Encoder how do I place the xml header on its own line?", "body": "<p>How about just write that one static line with a newline character yourself? <a href=\"http://play.golang.org/p/o_wEL-Fdca\" rel=\"nofollow\">Go Playground</a></p>\n\n<pre><code>w := &amp;bytes.Buffer{}\nw.Write([]byte(\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n\"))\n\nenc := xml.NewEncoder(w)\nenc.Indent(\"\", \"  \")\nif err := enc.Encode(Stuff{\"My stuff\"}); err != nil {\n    panic(err)\n}\nfmt.Println(w.String())\n</code></pre>\n\n<p>This one line is even defined as a <a href=\"https://golang.org/pkg/encoding/xml/#pkg-constants\" rel=\"nofollow\">constant</a> in the <code>xml</code> package, so you can simply write: <a href=\"http://play.golang.org/p/gdDC8xF0NA\" rel=\"nofollow\">Go Playground</a></p>\n\n<pre><code>w := &amp;bytes.Buffer{}\nw.WriteString(xml.Header)\n</code></pre>\n"}], "owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2555, "favorite_count": 1, "accepted_answer_id": 30709670, "answer_count": 1, "score": 3, "last_activity_date": 1471955454, "creation_date": 1433767551, "question_id": 30709562, "link": "https://stackoverflow.com/questions/30709562/using-encoding-xml-encoder-how-do-i-place-the-xml-header-on-its-own-line", "title": "Using encoding/xml.Encoder how do I place the xml header on its own line?", "body": "<p>I have the following code that uses <code>xml.Encode</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/xml\"\n    \"fmt\"\n)\n\ntype Stuff struct {\n    Name string `xml:\"name\"`\n}\n\nfunc main() {\n    w := &amp;bytes.Buffer{}\n    enc := xml.NewEncoder(w)\n    enc.Indent(\"\", \"  \")\n    procInst := xml.ProcInst{\n        Target: \"xml\",\n        Inst:   []byte(\"version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"\"),\n    }\n    if err := enc.EncodeToken(procInst); err != nil {\n        panic(err)\n    }\n\n    if err := enc.Encode(Stuff{\"My stuff\"}); err != nil {\n        panic(err)\n    }\n    fmt.Println(w.String())\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/ZtZ5FGABmj\" rel=\"nofollow\">http://play.golang.org/p/ZtZ5FGABmj</a></p>\n\n<p>It prints:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;Stuff&gt;\n  &lt;name&gt;My stuff&lt;/name&gt;\n&lt;/Stuff&gt;\n</code></pre>\n\n<p>How do I make it print with the <code>&lt;Stuff&gt;</code> start tag on a new line:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Stuff&gt;\n  &lt;name&gt;My stuff&lt;/name&gt;\n&lt;/Stuff&gt;\n</code></pre>\n\n<p>Unfortunately I need to write more here so that I can submit the question. Not really sure what to write though because I believe my question is summarized adequately with the above explanation.</p>\n"}, {"tags": ["go", "backend", "datastore", "key-value-store", "boltdb"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1433760793, "post_id": 30707208, "comment_id": 49471849, "body": "Being a file-based DB, it&#39;s unlikely to change due to the way file locks work. This is also probably a better question on the Bolt repository rather than StackOverflow: <a href=\"https://github.com/boltdb/bolt\" rel=\"nofollow noreferrer\">github.com/boltdb/bolt</a>"}], "answers": [{"comments": [{"owner": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "edited": false, "score": 0, "creation_date": 1433852109, "post_id": 30712747, "comment_id": 49519527, "body": "Okay! Thanks. Can anybody create a boltDB tag so that it is easy to manage further queries."}, {"owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "reply_to_user": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "edited": false, "score": 0, "creation_date": 1433964511, "post_id": 30712747, "comment_id": 49583403, "body": "boltb tag just added."}, {"owner": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "edited": false, "score": 0, "creation_date": 1433998538, "post_id": 30712747, "comment_id": 49594910, "body": "Thank you  for adding  !"}], "tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": false, "score": 4, "last_activity_date": 1433775978, "creation_date": 1433775978, "answer_id": 30712747, "question_id": 30707208, "link": "https://stackoverflow.com/questions/30707208/boltdb-key-value-data-store-purely-in-go/30712747#30712747", "title": "Boltdb-key-Value Data Store purely in Go", "body": "<p>There is no connection pooling concept in boltdb, because there is no connection. It is not a client/server database, it is an embedded database (like sqlite or Berkeley-DB).</p>\n\n<p>Boltdb is designed so that multiple goroutines of the same process can access the database at the same time (using different transactions). The model is single writer, multiple readers. Boltdb is not designed to support accesses from multiple processes.</p>\n\n<p>If you need a Go program to use an embedded database supporting access from multiple processes at the same time, you may want to have a look at the wrappers over LMDB, such as:</p>\n\n<ul>\n<li><a href=\"https://github.com/szferi/gomdb\" rel=\"nofollow\">https://github.com/szferi/gomdb</a></li>\n<li><a href=\"https://github.com/armon/gomdb\" rel=\"nofollow\">https://github.com/armon/gomdb</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "edited": false, "score": 0, "creation_date": 1433851826, "post_id": 30712980, "comment_id": 49519318, "body": "Thanks a lot! I understood how its different from other databases which are shared on the network.will have it owned by one process which exposes an API over the network."}, {"owner": {"reputation": 506, "user_id": 3835333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c838f6bc14ea3297f3305aca42f8bf?s=128&d=identicon&r=PG&f=1", "display_name": "SkyeC", "link": "https://stackoverflow.com/users/3835333/skyec"}, "reply_to_user": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "edited": false, "score": 0, "creation_date": 1433854357, "post_id": 30712980, "comment_id": 49521285, "body": "Sounds good. One benefit of wrapping a storage engine like this is you can build the interface to meet your specific needs. Are you only using small keys and values where throughput matters? Make it a UDP interface. Or maybe a protobuf interface is more suitable for you. I&#39;m going to keep tinkering with this code as a side project. So will probably try each of these. Best of luck."}, {"owner": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "edited": false, "score": 0, "creation_date": 1433910354, "post_id": 30712980, "comment_id": 49549004, "body": "There are various unique id and all are bidding a amount at a rate of milliseconds and I have to store it and update their current spend(the total sum of the bids till that time) asap. The schema i am using is like  --a bucket for every unique id and storing the time as the key and value as the bid. --a common bucket for all unique and updating their current spend in that where key=unique id and value = latest current spend . As in this case which interface should I prefer. And how can I increase the rate of updating the value i.e.should i use db.Update() or db.Batch() and how ?"}, {"owner": {"reputation": 506, "user_id": 3835333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c838f6bc14ea3297f3305aca42f8bf?s=128&d=identicon&r=PG&f=1", "display_name": "SkyeC", "link": "https://stackoverflow.com/users/3835333/skyec"}, "reply_to_user": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "edited": false, "score": 0, "creation_date": 1433985254, "post_id": 30712980, "comment_id": 49591681, "body": "This is kind of going off topic for this question. To continue this discussion, feel free to open an issue on the github project I included."}, {"owner": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "edited": false, "score": 0, "creation_date": 1434016827, "post_id": 30712980, "comment_id": 49605257, "body": "In boltdb how can  efficient data sharding, data re-balancing and data distribution can be done ?"}, {"owner": {"reputation": 909, "user_id": 1363774, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fbdf37ccc1f323b8ee9f75fc75934358?s=128&d=identicon&r=PG", "display_name": "auro", "link": "https://stackoverflow.com/users/1363774/auro"}, "edited": false, "score": 0, "creation_date": 1448504942, "post_id": 30712980, "comment_id": 55620117, "body": "This is usable code except for the fact that the Get method doesn&#39;t check that a valid bucket is returned. Something like ... if b == nil { \t\t\tfmt.Printf(&quot;Yikes! Bucket %s not found!&quot;, b) \t\t\treturn fmt.Errorf(&quot;Bucket %q not found!&quot;, b) \t\t}"}], "tags": [], "owner": {"reputation": 506, "user_id": 3835333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c838f6bc14ea3297f3305aca42f8bf?s=128&d=identicon&r=PG&f=1", "display_name": "SkyeC", "link": "https://stackoverflow.com/users/3835333/skyec"}, "is_accepted": true, "score": 10, "last_activity_date": 1433776601, "creation_date": 1433776601, "answer_id": 30712980, "question_id": 30707208, "link": "https://stackoverflow.com/questions/30707208/boltdb-key-value-data-store-purely-in-go/30712980#30712980", "title": "Boltdb-key-Value Data Store purely in Go", "body": "<p>A Bolt database is usually embedded into a larger program and is not used over the network like you would with shared databases (think SQLite vs MySQL). Using Bolt is a bit like having a persistent <code>map[[]byte][]byte</code> if that were possible. Depending on what you are doing, you might want to just use something like Redis.</p>\n\n<p>That said, if you need to use Bolt this way, it is not very difficult to wrap with a simple server. Here is an example that writes/reads keys from a Bolt DB over HTTP. You can use <code>Keep-Alive</code> for connection pooling.</p>\n\n<p>Code at: <a href=\"https://github.com/skyec/boltdb-server\">https://github.com/skyec/boltdb-server</a></p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/boltdb/bolt\"\n    \"github.com/gorilla/mux\"\n)\n\ntype server struct {\n    db *bolt.DB\n}\n\nfunc newServer(filename string) (s *server, err error) {\n    s = &amp;server{}\n    s.db, err = bolt.Open(filename, 0600, &amp;bolt.Options{Timeout: 1 * time.Second})\n    return\n}\n\nfunc (s *server) Put(bucket, key, contentType string, val []byte) error {\n    return s.db.Update(func(tx *bolt.Tx) error {\n        b, err := tx.CreateBucketIfNotExists([]byte(bucket))\n        if err != nil {\n            return err\n        }\n        if err = b.Put([]byte(key), val); err != nil {\n            return err\n        }\n        return b.Put([]byte(fmt.Sprintf(\"%s-ContentType\", key)), []byte(contentType))\n    })\n}\n\nfunc (s *server) Get(bucket, key string) (ct string, data []byte, err error) {\n    s.db.View(func(tx *bolt.Tx) error {\n        b := tx.Bucket([]byte(bucket))\n        r := b.Get([]byte(key))\n        if r != nil {\n            data = make([]byte, len(r))\n            copy(data, r)\n        }\n\n        r = b.Get([]byte(fmt.Sprintf(\"%s-ContentType\", key)))\n        ct = string(r)\n        return nil\n    })\n    return\n}\n\nfunc (s *server) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\n\n    if vars[\"bucket\"] == \"\" || vars[\"key\"] == \"\" {\n        http.Error(w, \"Missing bucket or key\", http.StatusBadRequest)\n        return\n    }\n\n    switch r.Method {\n    case \"POST\", \"PUT\":\n        data, err := ioutil.ReadAll(r.Body)\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        err = s.Put(vars[\"bucket\"], vars[\"key\"], r.Header.Get(\"Content-Type\"), data)\n        w.WriteHeader(http.StatusOK)\n    case \"GET\":\n        ct, data, err := s.Get(vars[\"bucket\"], vars[\"key\"])\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        w.Header().Add(\"Content-Type\", ct)\n        w.Write(data)\n    }\n}\n\nfunc main() {\n    var (\n        addr   string\n        dbfile string\n    )\n\n    flag.StringVar(&amp;addr, \"l\", \":9988\", \"Address to listen on\")\n    flag.StringVar(&amp;dbfile, \"db\", \"/var/data/bolt.db\", \"Bolt DB file\")\n    flag.Parse()\n\n    log.Println(\"Using Bolt DB file:\", dbfile)\n    log.Println(\"Listening on:\", addr)\n\n    server, err := newServer(dbfile)\n    if err != nil {\n        log.Fatalf(\"Error: %s\", err)\n    }\n\n    router := mux.NewRouter()\n    router.Handle(\"/v1/buckets/{bucket}/keys/{key}\", server)\n    http.Handle(\"/\", router)\n\n    log.Fatal(http.ListenAndServe(addr, nil))\n}\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4354, "favorite_count": 5, "accepted_answer_id": 30712980, "answer_count": 2, "score": 6, "last_activity_date": 1433964444, "creation_date": 1433760596, "last_edit_date": 1433964444, "question_id": 30707208, "link": "https://stackoverflow.com/questions/30707208/boltdb-key-value-data-store-purely-in-go", "title": "Boltdb-key-Value Data Store purely in Go", "body": "<p>Bolt obtains a file lock on the data file so multiple processes cannot open the same database at the same time. Opening an already open Bolt database will cause it to hang until the other process closes it.</p>\n\n<p>As this is the case,is there any connection pooling concept like various clients connecting and accessing the database at the same time.? Is this possible in boltdb?Like there are various connections reading and writing in the database at the same time.How it can be implemented?</p>\n"}, {"tags": ["go", "ipc"], "comments": [{"owner": {"reputation": 53111, "user_id": 41596, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e3d742bdb6a1937a032125eef40aa874?s=128&d=identicon&r=PG", "display_name": "alexn", "link": "https://stackoverflow.com/users/41596/alexn"}, "edited": false, "score": 0, "creation_date": 1433756334, "post_id": 30705397, "comment_id": 49469031, "body": "Maybe you are looking for memory mapped files?"}], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": -7, "last_activity_date": 1433756384, "last_edit_date": 1433756384, "creation_date": 1433756255, "answer_id": 30705710, "question_id": 30705397, "link": "https://stackoverflow.com/questions/30705397/how-to-use-share-memory-with-golang/30705710#30705710", "title": "how to use share memory with Golang?", "body": "<p>golang: It is a programming language, so it does not relate to the shared memory that the operating system level things. Not to say golang not use shared memory, but this is not it need to be defined. Posix use shared memory, you can use syscall package, which contains a lot of system calls, as long as the reference c system call interface on the line.</p>\n"}, {"tags": [], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "is_accepted": true, "score": 1, "last_activity_date": 1433757735, "creation_date": 1433757735, "answer_id": 30706248, "question_id": 30705397, "link": "https://stackoverflow.com/questions/30705397/how-to-use-share-memory-with-golang/30706248#30706248", "title": "how to use share memory with Golang?", "body": "<p>In the world of go, don't communicate by sharing memory; share memory by communicating. If you really want to have a try, you can call the C API with cgo:</p>\n\n<p><strong>wrapper.c:</strong>  </p>\n\n<pre><code>#include &lt;stdlib.h&gt; \n#include &lt;string.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/types.h&gt;\n\nint my_shm_open(char* filename, int open_flag){\n    int shm_id;\n    key_t key;\n    key = ftok(filename, 0x03);\n    if(key == -1){\n        return -1;\n    }\n    if(open_flag)\n        shm_id = shmget(key, 4096, IPC_CREAT|IPC_EXCL|0600);\n    else\n        shm_id = shmget(key, 0, 0);\n    if(shm_id == -1){\n        return -1;\n    }\n    return shm_id;\n}\n\nint my_shm_update(int shm_id, char* content){\n    char* addr;\n    addr = (char*)shmat(shm_id, NULL, 0);\n    if(addr == (char*)-1){\n        return -1;\n    }\n    if(strlen(content) &gt; 4095)\n        return -1;\n    strcpy(addr, content);\n    shmdt(addr);\n    return 0;\n}\n\nint my_shm_close(int shm_id){\n    shmctl(shm_id, IPC_RMID, NULL);\n    return 0;\n}\n\nchar* my_shm_read(char* filename){\n    int shm_id;\n    char* addr;\n    char* s;\n    shm_id = my_shm_open(filename, 0);\n    if(shm_id == -1)\n        return NULL;\n    addr = (char*)shmat(shm_id, NULL, 0);\n    if(addr == (char*)-1){\n        return NULL;\n    }\n    s = (char*)malloc(strlen(addr) + 1);\n    strcpy(s, addr);\n    shmdt(addr);\n    return s;\n}\n</code></pre>\n\n<p><strong>reader.go</strong></p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\n// #include \"wrapper.c\"\nimport \"C\"\nimport \"unsafe\"\nimport \"fmt\"\n\nfunc read(filename string) string {\n    f := C.CString(filename)\n    defer C.free(unsafe.Pointer(f))\n    s := C.my_shm_read(f)\n    defer C.free(unsafe.Pointer(s))\n    return C.GoString(s)\n}\n\nfunc main() {\n    fmt.Println(read(\"/tmp\"))\n}\n</code></pre>\n\n<p><strong>writter.go:</strong></p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\n// #include \"wrapper.c\"\nimport \"C\"\nimport \"unsafe\"\n\nimport (\n    \"log\"\n    \"time\"\n)\n\ntype errorString struct {\n    s string\n}\n\nfunc (e *errorString) Error() string {\n    return e.s\n}\n\nfunc open(file string) (int, error) {\n    f := C.CString(file)\n    defer C.free(unsafe.Pointer(f))\n    r := int(C.my_shm_open(f, C.int(1)))\n    if r == -1 {\n        return 0, &amp;errorString{\"error\"}\n    }\n    return r, nil\n}\n\nfunc update(shm_id int, content string) error {\n    c := C.CString(content)\n    defer C.free(unsafe.Pointer(c))\n    r := int(C.my_shm_update(C.int(shm_id), c))\n    if r == -1 {\n        return &amp;errorString{\"update error\"}\n    }\n    return nil\n}\n\nfunc close(shm_id int) error {\n    C.my_shm_close(C.int(shm_id))\n    return nil\n}\n\nfunc main() {\n    id, err := open(\"/tmp\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer close(id)\n    err = update(id, \"hello world\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    time.Sleep(1e9 * 100)\n}\n</code></pre>\n\n<p>run the writer, then the reader by <code>go run filename</code>.\nThe code is from <a href=\"https://gist.github.com/jedy/3282764\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 301, "user_id": 4047001, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca7dcf86ac790b67132a103a1b33eced?s=128&d=identicon&r=PG&f=1", "display_name": "xichen", "link": "https://stackoverflow.com/users/4047001/xichen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5711, "favorite_count": 1, "closed_date": 1433757851, "accepted_answer_id": 30706248, "answer_count": 2, "score": 0, "last_activity_date": 1433757735, "creation_date": 1433755329, "last_edit_date": 1433756092, "question_id": 30705397, "link": "https://stackoverflow.com/questions/30705397/how-to-use-share-memory-with-golang", "closed_reason": "Needs details or clarity", "title": "how to use share memory with Golang?", "body": "<p>How does golang share or read other processes shared memory?\nI've checked some information, but did not find relevant information. Can anyone give me an example?</p>\n"}, {"tags": ["http", "go", "https", "beego"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1433768601, "post_id": 30705387, "comment_id": 49477054, "body": "Are you sure <code>cert.pem</code> and <code>key.pem</code> files are in the proper (current working directory) folder? Try passing absolute paths."}, {"owner": {"reputation": 67, "user_id": 4985625, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XmBvqOg_-2g/AAAAAAAAAAI/AAAAAAAAADI/-dRgZsQ8cxw/photo.jpg?sz=128", "display_name": "Iranna Pattar", "link": "https://stackoverflow.com/users/4985625/iranna-pattar"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1433824570, "post_id": 30705387, "comment_id": 49503385, "body": "@icza, yes it is in the same folder.Even if try to pass the absolute path its giving same error."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1433828018, "creation_date": 1433828018, "answer_id": 30723710, "question_id": 30705387, "link": "https://stackoverflow.com/questions/30705387/switch-from-http-to-https-in-beego/30723710#30723710", "title": "Switch from HTTP to HTTPS in Beego", "body": "<p>The error indicates that the <code>key.pem</code> file cannot be parsed (could be invalid or lacking permission to read its content). Make sure the file is valid and sufficient permissions are set.</p>\n\n<p>For testing purposes, use the <code>generate_cert.go</code> in the <a href=\"https://golang.org/pkg/crypto/tls/\" rel=\"nofollow\"><code>crypto/tls</code></a> package to generate valid <code>cert.pem</code> and <code>key.pem</code> files.</p>\n\n<p>To generate, run the following command (windows):</p>\n\n<pre><code>go run %GOROOT%/src/crypto/tls/generate_cert.go -host=\"127.0.0.1\"\n</code></pre>\n\n<p>Linux:</p>\n\n<pre><code>go run $GOROOT/src/crypto/tls/generate_cert.go -host=\"127.0.0.1\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4985625, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XmBvqOg_-2g/AAAAAAAAAAI/AAAAAAAAADI/-dRgZsQ8cxw/photo.jpg?sz=128", "display_name": "Iranna Pattar", "link": "https://stackoverflow.com/users/4985625/iranna-pattar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1530, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1433828134, "creation_date": 1433755311, "last_edit_date": 1433828134, "question_id": 30705387, "link": "https://stackoverflow.com/questions/30705387/switch-from-http-to-https-in-beego", "title": "Switch from HTTP to HTTPS in Beego", "body": "<p>I try to switch from HTTP to HTTPS:</p>\n\n<pre><code>func handler(w http.ResponseWriter, req *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/plain\")\n    w.Write([]byte(\"This is an example server.\\n\"))\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    log.Printf(\"About to listen on 8080. Go to https://127.0.0.1:8080/\")\n    err := http.ListenAndServeTLS(\":8080\", \"cert.pem\", \"key.pem\", nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>And I am getting the following error:</p>\n\n<pre><code>crypto/tls: failed to parse key PEM data\n</code></pre>\n\n<p>My application is running in HTTP mode now and I want it to run in HTTPS mode.</p>\n\n<p>Can anyone suggest how to make it work in HTTPS?</p>\n"}, {"tags": ["json", "curl", "go", "go-gin"], "comments": [{"owner": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "edited": false, "score": 0, "creation_date": 1433763506, "post_id": 30705110, "comment_id": 49473586, "body": "As I know method <code>Set(key, value)</code> just sets value for <i>existing</i> key. Method <code>Add(key, value)</code> adds new pair key-value or appends value if key exists."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "edited": false, "score": 1, "creation_date": 1433827740, "post_id": 30705110, "comment_id": 49504483, "body": "@AlexKroll not really. HTTP  header allow multiple values for one key, so <code>Add(key, value)</code> do append value to existing key."}, {"owner": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1433836840, "post_id": 30705110, "comment_id": 49509134, "body": "@JiangYD and what I was wrong?  src/net/http/header.go  // Add adds the key, value pair to the header. // It appends to any existing values associated with key. func (h Header) Add(key, value string) { \ttextproto.MIMEHeader(h).Add(key, value) }"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "edited": false, "score": 0, "creation_date": 1433837263, "post_id": 30705110, "comment_id": 49509385, "body": "@AlexKroll yes my mistake. anyhow the question not relate to duplicate key."}], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 1, "last_activity_date": 1433829416, "creation_date": 1433829416, "answer_id": 30723999, "question_id": 30705110, "link": "https://stackoverflow.com/questions/30705110/golang-gin-gonic-force-post-headers-to-json/30723999#30723999", "title": "Golang / Gin-gonic : Force POST headers to JSON", "body": "<p><code>Content-type</code> is a import HTTP header letting server decide how to parse the HTTP body. </p>\n\n<p><em>Is there any way to force the headers rather than asking the user to supply them?</em></p>\n\n<p>Hard to say Yes or No, it is depends on your 'user'. For curl, it can not guess the HTTP body format and set Content-Type to 'applicatoin/json' automatically, so you need specify Content-Type. For others like jQuery, programmer can set the <code>dataType</code> in post <code>jQuery.post( url [, data ] [, success ] [, dataType ] )</code> <a href=\"http://api.jquery.com/jquery.post/\" rel=\"nofollow\">link</a></p>\n"}], "owner": {"reputation": 627, "user_id": 1029949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b3ab7db53dea6f07f963d1ee70c6b7?s=128&d=identicon&r=PG", "display_name": "Elliot Reeve", "link": "https://stackoverflow.com/users/1029949/elliot-reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1986, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490926403, "creation_date": 1433754423, "last_edit_date": 1490926403, "question_id": 30705110, "link": "https://stackoverflow.com/questions/30705110/golang-gin-gonic-force-post-headers-to-json", "title": "Golang / Gin-gonic : Force POST headers to JSON", "body": "<p>I am using Gin-gonic to create an API. All requests whether thats a GET or a POST will be in JSON.</p>\n\n<p>I have an API call which works fine but I <strong>have</strong> to add these headers through with the cURL <code>-H \"Accept: application/json\" -H \"Content-type: application/json\"</code> otherwise the POST does not work as expected.</p>\n\n<p>I tried adding this function as middleware but although it changed the headers slightly it still does not work as expected</p>\n\n<pre><code>func CORSMiddleware() gin.HandlerFunc {\n    return func(c *gin.Context) {\n\n        c.Writer.Header().Set(\"Content-Type\", \"application/json\")\n        c.Writer.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n        c.Writer.Header().Set(\"Access-Control-Allow-Headers\", \"Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization\")\n\n    }\n}\n</code></pre>\n\n<p>Headers when it works (with added header in cURL):\n<code>Accept: application/json</code>\n<code>Content-type: application/json</code></p>\n\n<p>Header when it doesn't work (no header in cURL): <code>Accept: */*</code> <code>Content-Type: application/x-www-form-urlencoded</code></p>\n\n<p>Is there any way to force the headers rather than asking the user to supply them?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1433759112, "creation_date": 1433759112, "answer_id": 30706685, "question_id": 30704336, "link": "https://stackoverflow.com/questions/30704336/how-do-i-get-all-the-attributes-of-an-xml-element-using-go/30706685#30706685", "title": "How do I get all the attributes of an XML element using Go?", "body": "<p>The fundamental problem is that unmarshalling XML to your <code>struct Node</code> doesn't work. Your <code>BodyElements</code> captures the whole content of your root node and nothing is unmarshaled to your <code>Nodes</code>. (Btw: Adding a simple fmt.Printf would have revealed this.)</p>\n\n<p>Why do you try to write your own XML unmarshalling/parsing code? You will fail.\nJust use the Decoder and the <code>Token</code> method to parse your XML by hand, one token after each other, populating your tree manually. And: If your XML actually is HTML you might want to parse it with package html.</p>\n"}], "owner": {"reputation": 2803, "user_id": 3186914, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/kkIb4.jpg?s=128&g=1", "display_name": "Prashant", "link": "https://stackoverflow.com/users/3186914/prashant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 30706685, "answer_count": 1, "score": 2, "last_activity_date": 1433759112, "creation_date": 1433751981, "question_id": 30704336, "link": "https://stackoverflow.com/questions/30704336/how-do-i-get-all-the-attributes-of-an-xml-element-using-go", "title": "How do I get all the attributes of an XML element using Go?", "body": "<p>I am trying to parse xml content along with all the attributes of an XML element  like this</p>\n\n<pre><code>type Node struct {\n  XMLName xml.Name\n  Attributes []xml.Attr `xml:\",attr\"`\n  BodyElements string `xml:\",innerxml\"`\n  Nodes   []Node `xml:\",any\"`\n}\n\nvar xmldata = []byte(\"&lt;div&gt;&lt;div data-id=\\\"images/6C7161080\\\" data-imagesize=\\\"medium\\\" data-alignment=\\\"none\\\"&gt;&lt;/div&gt;&lt;/div&gt;\")\n\nfunc walk(nodes []Node, f func(Node) bool) {\n  for _, n := range nodes {\n    if f(n) {\n        walk(n.Nodes, f)\n    }\n  }\n}\n\n\nfunc main() {\n\n  buf := bytes.NewBuffer(xmldata)\n  dec := xml.NewDecoder(buf)\n\n  var n Node\n  err := dec.Decode(&amp;n)\n  if err != nil {\n    panic(err)\n  }\n\n  walk([]Node{n}, func(n Node) bool {\n    if n.XMLName.Local == \"p\" {\n        fmt.Println(string(n.BodyElements))\n    } else if n.XMLName.Local == \"div\"{\n        fmt.Println(string(n.BodyElements))\n        fmt.Println(len(n.Attributes))\n    }\n    return true\n  })\n}\n</code></pre>\n\n<p>But the value of len(n.Attributes) is always 0. What can I do to get all the attributes in the given element. NOTE: The attribute names are not constant as sometime the element can be a \"div\" tag or \"img\" tag or something else. So I can't use the attribute name as </p>\n\n<pre><code>DataId string `xml:\"data-id,attr\"`\n</code></pre>\n"}, {"tags": ["sql", "go", "gorp"], "comments": [{"owner": {"reputation": 1374, "user_id": 560561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6c5947ff77ff642f370d78017cf04fc?s=128&d=identicon&r=PG", "display_name": "fzerorubigd", "link": "https://stackoverflow.com/users/560561/fzerorubigd"}, "edited": false, "score": 1, "creation_date": 1434214130, "post_id": 30703965, "comment_id": 49688502, "body": "you can use sql logging of gorp to see the query <a href=\"https://github.com/go-gorp/gorp#sql-logging\" rel=\"nofollow noreferrer\">github.com/go-gorp/gorp#sql-logging</a>"}], "answers": [{"comments": [{"owner": {"reputation": 218, "user_id": 1116856, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de68f666ad4ecf47e1c0bf43a12c74d9?s=128&d=identicon&r=PG", "display_name": "norwat", "link": "https://stackoverflow.com/users/1116856/norwat"}, "edited": false, "score": 0, "creation_date": 1434300813, "post_id": 30817658, "comment_id": 49708874, "body": "Thanks for the answer this did work for me but it got a bit ugly, is there a more streamlined way to do this ? Before i posted this question i had <code>npr := dbProbes[index]</code> where <code>dbProbes</code> is a slice of <code>WirelessNetwork</code> but that also failed to work. Now with your solution i have to set every property of that struct ?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 218, "user_id": 1116856, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de68f666ad4ecf47e1c0bf43a12c74d9?s=128&d=identicon&r=PG", "display_name": "norwat", "link": "https://stackoverflow.com/users/1116856/norwat"}, "edited": false, "score": 0, "creation_date": 1434304113, "post_id": 30817658, "comment_id": 49709944, "body": "@norwat That still depends on where do <code>dbProbes</code> come from. I can&#39;t recommend anything without knowing that, but if you could validate your data there, <code>npr := dbProbes[index]</code> would work again."}, {"owner": {"reputation": 218, "user_id": 1116856, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de68f666ad4ecf47e1c0bf43a12c74d9?s=128&d=identicon&r=PG", "display_name": "norwat", "link": "https://stackoverflow.com/users/1116856/norwat"}, "edited": false, "score": 0, "creation_date": 1434309049, "post_id": 30817658, "comment_id": 49711426, "body": "Sorry forgot to mention that, dbProbes comes from another table which also stores <code>WirelessNetwork</code> objects, i then try to match a elements of one table with another based on user input. So in essence <code>dbProbes</code> corresponds to an sql object with all valid fields and <code>npr</code> a new object with only 2 valid fields"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 218, "user_id": 1116856, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de68f666ad4ecf47e1c0bf43a12c74d9?s=128&d=identicon&r=PG", "display_name": "norwat", "link": "https://stackoverflow.com/users/1116856/norwat"}, "edited": false, "score": 0, "creation_date": 1434314544, "post_id": 30817658, "comment_id": 49713168, "body": "Is the data in the other table all NULLs? If it isn&#39;t, I&#39;d say the problem is in the way you fetch the data from that other table. Also I don&#39;t quite get your last sentence. Is <code>npr</code> supposed to be all NULLs except for two fields?"}, {"owner": {"reputation": 218, "user_id": 1116856, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de68f666ad4ecf47e1c0bf43a12c74d9?s=128&d=identicon&r=PG", "display_name": "norwat", "link": "https://stackoverflow.com/users/1116856/norwat"}, "edited": false, "score": 0, "creation_date": 1434373812, "post_id": 30817658, "comment_id": 49735607, "body": "no, <code>dbProbes</code> comes from a table where all the fields are not null, and yes <code>npr</code> only has two non null fields"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 218, "user_id": 1116856, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de68f666ad4ecf47e1c0bf43a12c74d9?s=128&d=identicon&r=PG", "display_name": "norwat", "link": "https://stackoverflow.com/users/1116856/norwat"}, "edited": false, "score": 0, "creation_date": 1434375710, "post_id": 30817658, "comment_id": 49736973, "body": "If values are in the table and you still get NULLs from it, then inspect the code that fetches them and maybe open a new question about it. Once that is solved, you can simply nullify the unneeded fields of <code>npr</code>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 6, "last_activity_date": 1434191561, "creation_date": 1434191561, "answer_id": 30817658, "question_id": 30703965, "link": "https://stackoverflow.com/questions/30703965/gorp-update-not-updating/30817658#30817658", "title": "gorp Update not updating", "body": "<p><code>sql.Null*</code> types are structs with <code>Valid</code> boolean field, which tells if the value is NULL. The initial value for boolean is false, so unless you explicitly validate your data, you'll be sending NULLs to the database. You didn't tell us, what is <code>dbProbes</code> and how does it get the data, but if it's initialised with something like</p>\n\n<pre><code>dbProbes[index].Lat = sql.NullFloat64{Float64: lat}\n</code></pre>\n\n<p>then <code>Valid</code> is still false, and you need to either validate your data manually:</p>\n\n<pre><code>dbProbes[index].Lat = sql.NullFloat64{Float64: lat, Valid: true}\n</code></pre>\n\n<p>or use the <code>Scan</code> method:</p>\n\n<pre><code>err = dbProbes[index].Lat.Scan(lat)\n</code></pre>\n"}], "owner": {"reputation": 218, "user_id": 1116856, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de68f666ad4ecf47e1c0bf43a12c74d9?s=128&d=identicon&r=PG", "display_name": "norwat", "link": "https://stackoverflow.com/users/1116856/norwat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 779, "favorite_count": 0, "accepted_answer_id": 30817658, "answer_count": 1, "score": 12, "last_activity_date": 1434191561, "creation_date": 1433750617, "question_id": 30703965, "link": "https://stackoverflow.com/questions/30703965/gorp-update-not-updating", "title": "gorp Update not updating", "body": "<p>Im having issues updating a row in my postgresql database with gorp, im successfully able run the update using db.Exec, all columns get updated with the right information, while with gorp im only able to update the non sql.Null* fields while the rest remain unchanged.</p>\n\n<pre><code>var db *sql.DB\nvar dbmap *gorp.DbMap\n\nfunc getDB() (*sql.DB, *gorp.DbMap) {\n    if db == nil {\n        var err error\n        db, err = sql.Open(\"postgres\", \"postgres://xxxxxxxx\")\n        db.SetMaxOpenConns(5)\n        db.SetMaxIdleConns(0)\n        dbmap = &amp;gorp.DbMap{Db: db, Dialect: gorp.PostgresDialect{}}\n        dbmap.AddTableWithName(WirelessNetwork{}, \"network\").SetKeys(true, \"Id\")\n        if err != nil {\n            log.Panic(err)\n        }\n    }\n\n    return db, dbmap\n}\n\ntype WirelessNetwork struct {\n    Id        int             `db:\"id\"`\n    Ssid      string          `db:\"ssid\"`\n    Lat       sql.NullFloat64 `db:\"lat\"`\n    Lon       sql.NullFloat64 `db:\"lon\"`\n    Sec       sql.NullString  `db:\"sec\"`\n    Bssid     sql.NullString  `db:\"bssid\"`\n    Channel   sql.NullInt64   `db:\"channel\"`\n    Found     bool            `db:\"found\"`\n    Datefirst sql.NullString  `db:\"datefirst\"`\n    Datelast  sql.NullString  `db:\"datelast\"`\n}\n\nnpr := new(WirelessNetwork)\nnpr.Id = getNetworkId(ssid)\nnpr.Ssid = ssid\nnpr.Lat = dbProbes[index].Lat\nnpr.Lon = dbProbes[index].Lon\nnpr.Sec = dbProbes[index].Sec\nnpr.Bssid = dbProbes[index].Bssid\nnpr.Channel = dbProbes[index].Channel\nnpr.Found = dbProbes[index].Found\nnpr.Datefirst = dbProbes[index].Datefirst\nnpr.Datelast = dbProbes[index].Datelast\nnpr.Found = true\n</code></pre>\n\n<p>This works</p>\n\n<pre><code>db, _ := getDB()\ndb.Exec(\"UPDATE network SET ssid=$1,lat=$2,lon=$3,sec=$4,channel=$5,found=$6,datefirst=$7,datelast=$8,bssid=$9 WHERE id=$10\",\n    npr.Ssid, npr.Lat.Float64, npr.Lon.Float64, npr.Sec.String, npr.Channel.Int64, npr.Found, npr.Datefirst.String, npr.Datelast.String, npr.Bssid.String, getNetworkId(ssid))\n</code></pre>\n\n<p>This does not</p>\n\n<pre><code>func updateNetwork(n *WirelessNetwork) {\n    _, dbmap := getDB()\n    _, err := dbmap.Update(n)\n   if err != nil {\n        log.Fatal(\"updateNetwork - \", err)\n   }\n}\n</code></pre>\n"}, {"tags": ["rest", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1907906"}, "edited": false, "score": 0, "creation_date": 1433747203, "post_id": 30702948, "comment_id": 49463868, "body": "Just curious: Does <code>bytes.Buffer</code> as created by <code>bytes.NewBufferString</code> implement <code>io.Reader</code>?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1433748371, "post_id": 30702948, "comment_id": 49464463, "body": "First: What makes you think that the request body as sent by Go is empty? It is not. Second: Your Java server states clearly that is requires a non null &#39;text&#39;, maybe you should provide one. Third: Use curl, not postman. postman is nice but curl makes clear what actually goes on."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1433749259, "post_id": 30702948, "comment_id": 49464955, "body": "@Volker here is the same working <code>curl</code> request: <code>curl -X POST -u root:1 -H &quot;Content-Type: application&#47;json&quot; --data-urlencode &quot;INSERT INTO V SET name = &#39;jack&#39;, boss = #11:19&quot;  http:&#47;&#47;localhost:2480&#47;command&#47;GratefulDeadConcerts&#47;sql </code>"}, {"owner": {"reputation": 7735, "user_id": 300797, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/328e4d651b4e1c7a97bd86f3d7c84073?s=128&d=identicon&r=PG", "display_name": "thecoshman", "link": "https://stackoverflow.com/users/300797/thecoshman"}, "edited": false, "score": 0, "creation_date": 1433749550, "post_id": 30702948, "comment_id": 49465110, "body": "You realise the <code>Content-Type</code> header is the type of data that you are sending, <code>Accept</code> is the header to say what type of data you want sent back."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1433750000, "post_id": 30702948, "comment_id": 49465355, "body": "@Volker My Java server states about a non null &#39;text&#39; because it receives empty data. I think so since I can get the same <code>text cannot be null</code> response, using <code>curl</code> by removing data: <code>curl -X POST -u root:1 -H &quot;Content-Type: application&#47;json&quot; --data-urlencode &quot;&quot; http:&#47;&#47;localhost:2480&#47;command&#47;GratefulDeadConcerts&#47;sql</code>. It outputs <code>java.lang.IllegalArgumentException: text cannot be null</code>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 7735, "user_id": 300797, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/328e4d651b4e1c7a97bd86f3d7c84073?s=128&d=identicon&r=PG", "display_name": "thecoshman", "link": "https://stackoverflow.com/users/300797/thecoshman"}, "edited": false, "score": 2, "creation_date": 1433753846, "post_id": 30702948, "comment_id": 49467421, "body": "Why do you send this SQL statement in URL-encoded form with curl but as a plain string with Go? And @thecoshman made a very valid point: Why do you set our Content-type to JSON but you send URL-encoded data? You might want to take a deeper look at how HTTP works and study the documentation of your API-endpoint of your Java server before trying to do it in Go. Trial and error programming is not helpful."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1433771741, "post_id": 30702948, "comment_id": 49479458, "body": "Just URL-encode your body as curl does it for you automatically (See <a href=\"https://golang.org/pkg/net/url/#QueryEscape\" rel=\"nofollow noreferrer\">golang.org/pkg/net/url/#QueryEscape</a>). Note that your curl call is still wrong: Your content type is not JSON. One more: Instead of posting curl or postman examples you could post (or link) to your API endpoint specification/description."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1433778575, "post_id": 30702948, "comment_id": 49484786, "body": "As side note: I don&#39;t know know exactly what you are trying to do here, but sending raw sql statements as a post body makes my eyes squirt and my fingers twitch. I can only hope you are not actually doing this (even in an internal network) because security wise this is very, very bad. Just send a json/xml/postparam blob with data and parse and <i>validate</i> that serverside and only then create a sql statement out of this. Like this it is only a matter of time before you wonder who made all those new tables and who user &#39;Joe&#39; is in your user table."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1433778710, "post_id": 30702948, "comment_id": 49484883, "body": "@Volker I tried to use <code>QueryEscape</code> and changed content type to <code>text&#47;plain</code> for <code>curl</code>,  but the result is the same (Update3 above)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1433782608, "post_id": 30702948, "comment_id": 49487266, "body": "@RickA While plaintext SQL statements in the body is definitely strange it seems to be that way in OrientDB; at least they support SSL."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 0, "last_activity_date": 1433782393, "creation_date": 1433782393, "answer_id": 30714917, "question_id": 30702948, "link": "https://stackoverflow.com/questions/30702948/post-golang-request-with-string-data/30714917#30714917", "title": "POST golang request with string data", "body": "<p>Reading the documentation clearly helps. From the OrientDB documentation documentation [1]:</p>\n\n<blockquote>\n  <p>All the requests must have these 2 headers:</p>\n\n<pre><code>'Accept-Encoding': 'gzip,deflate'\n'Content-Length': &lt;content-length&gt;\n</code></pre>\n  \n  <p>Where the  is the length of the request's body.</p>\n</blockquote>\n\n<p>And you do not set the Accept-Encoding header. Most probably this is all you need (and not escaping the body).</p>\n\n<p>[1] <a href=\"http://orientdb.com/docs/last/orientdb.wiki/OrientDB-REST.html#headers\" rel=\"nofollow\">http://orientdb.com/docs/last/orientdb.wiki/OrientDB-REST.html#headers</a></p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5915, "favorite_count": 0, "accepted_answer_id": 30714917, "answer_count": 1, "score": 0, "last_activity_date": 1433782393, "creation_date": 1433746893, "last_edit_date": 1433779140, "question_id": 30702948, "link": "https://stackoverflow.com/questions/30702948/post-golang-request-with-string-data", "title": "POST golang request with string data", "body": "<p>I can do a POST request with string data, using POSTMAN chrome extension.</p>\n\n<p><img src=\"https://i.stack.imgur.com/GjdCs.png\" alt=\"enter image description here\"></p>\n\n<p>I need to do the same using <code>golang</code> code. </p>\n\n<p>But my <code>Go</code> code loses string <code>INSERT INTO V SET name = 'jack', boss = #11:19</code> and posts empty data to the server. </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    client := &amp;http.Client{}\n    // Why this stringData is lost and was not send with POST request?\n    stringData := `INSERT INTO V SET name = 'jack', boss = #11:19`\n    req, err := http.NewRequest(\"POST\", \"http://localhost:2480/command/GratefulDeadConcerts/sql\", bytes.NewBufferString(stringData))\n    req.SetBasicAuth(\"root\", \"1\")\n    resp, err := client.Do(req)\n    if err != nil {\n        fmt.Printf(\"Error : %s\", err)\n    }\n    fmt.Println(\"resp\")\n    fmt.Println(ToJson(resp))\n\n    var b bytes.Buffer\n    _, err = b.ReadFrom(resp.Body)\n    if err != nil {\n        log.Fatal(\"Error : %s\", err)\n    }\n    fmt.Println(b.String())\n}\n\nfunc ToJson(obj interface{}) string {\n    b, err := json.MarshalIndent(&amp;obj, \"\", \"   \")\n    if err != nil {\n        fmt.Printf(\"Error : %s\", err)\n    }\n    strJson := string(b)\n\n    return strJson\n}\n</code></pre>\n\n<p>It gives output:</p>\n\n<pre><code>resp\n{\n   \"Status\": \"500 Internal Server Error\",\n   \"StatusCode\": 500,\n   \"Proto\": \"HTTP/1.1\",\n   \"ProtoMajor\": 1,\n   \"ProtoMinor\": 1,\n   \"Header\": {\n      \"Cache-Control\": [\n         \"no-cache, no-store, max-age=0, must-revalidate\"\n      ],\n      \"Connection\": [\n         \"Keep-Alive\"\n      ],\n      \"Content-Length\": [\n         \"55\"\n      ],\n      \"Content-Type\": [\n         \"text/plain; charset=utf-8\"\n      ],\n      \"Date\": [\n         \"Mon Jun 08 10:47:46 MSK 2015\"\n      ],\n      \"Pragma\": [\n         \"no-cache\"\n      ],\n      \"Server\": [\n         \"OrientDB Server v.2.0.10 (build UNKNOWN@r; 2015-05-25 16:48:43+0000)\"\n      ]\n   },\n   \"Body\": {},\n   \"ContentLength\": 55,\n   \"TransferEncoding\": null,\n   \"Close\": false,\n   \"Trailer\": null,\n   \"Request\": {\n      \"Method\": \"POST\",\n      \"URL\": {\n         \"Scheme\": \"http\",\n         \"Opaque\": \"\",\n         \"User\": null,\n         \"Host\": \"localhost:2480\",\n         \"Path\": \"/command/GratefulDeadConcerts/sql\",\n         \"RawQuery\": \"\",\n         \"Fragment\": \"\"\n      },\n      \"Proto\": \"HTTP/1.1\",\n      \"ProtoMajor\": 1,\n      \"ProtoMinor\": 1,\n      \"Header\": {\n         \"Authorization\": [\n            \"Basic cm9vdDox\"\n         ]\n      },\n      \"Body\": {\n         \"Reader\": {}\n      },\n      \"ContentLength\": 46,\n      \"TransferEncoding\": null,\n      \"Close\": false,\n      \"Host\": \"localhost:2480\",\n      \"Form\": null,\n      \"PostForm\": null,\n      \"MultipartForm\": null,\n      \"Trailer\": null,\n      \"RemoteAddr\": \"\",\n      \"RequestURI\": \"\",\n      \"TLS\": null\n   },\n   \"TLS\": null\n}\njava.lang.IllegalArgumentException: text cannot be null\n</code></pre>\n\n<p>How to make this POST request work successfully, using GoLang, as I can do with POSTMAN chrome extension?</p>\n\n<h1>Update</h1>\n\n<p>I made the same POST request successfully, using curl.</p>\n\n<pre><code>curl -X POST -u root:1 -H \"Content-Type: application/json\" --data-urlencode \"INSERT INTO V SET name = 'jack', boss = #11:19\"  http://localhost:2480/command/GratefulDeadConcerts/sql \n</code></pre>\n\n<p>It outputs:</p>\n\n<pre><code>{\"result\":[{\"@type\":\"d\",\"@rid\":\"#9:822\",\"@version\":1,\"@class\":\"V\",\"name\":null}]}\n</code></pre>\n\n<h1>Update 2</h1>\n\n<p>Of course, I should not use <code>--data-urlencode</code> for <code>curl</code> command. \nThe valid curl command is </p>\n\n<pre><code>curl -X POST -u root:1 -H \"Content-Type: application/json\" -d \"INSERT INTO V SET name = 'jack', boss = #11:19\"  http://localhost:2480/command/GratefulDeadConcerts/sql\n{\"result\":[{\"@type\":\"d\",\"@rid\":\"#9:848\",\"@version\":1,\"@class\":\"V\",\"name\":\"jack\",\"boss\":\"#11:19\",\"@fieldTypes\":\"boss=x\"}]}\n</code></pre>\n\n<p>I still have no clue how to make the similar GoLang POST request.</p>\n\n<h1>Update 3</h1>\n\n<p><code>url.QueryEscape</code> did not help me.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n)\n\nfunc main() {\n    client := &amp;http.Client{}\n    // Why this stringData is lost and do not pass thgouht POST request?\n    stringData := `INSERT INTO V SET name = 'jack', boss = #11:19`\n    stringData = url.QueryEscape(stringData)\n    req, err := http.NewRequest(\"POST\", \"http://localhost:2480/command/GratefulDeadConcerts/sql\", bytes.NewBufferString(stringData))\n    req.SetBasicAuth(\"root\", \"1\")\n    req.Header.Set(\"Content-Type\", \"Content-Type: text/plain\")\n    resp, err := client.Do(req)\n    if err != nil {\n        fmt.Printf(\"Error : %s\", err)\n    }\n    fmt.Println(\"resp\")\n    fmt.Println(ToJson(resp))\n\n    var b bytes.Buffer\n    _, err = b.ReadFrom(resp.Body)\n    if err != nil {\n        log.Fatal(\"Error : %s\", err)\n    }\n    fmt.Println(b.String())\n}\n\nfunc ToJson(obj interface{}) string {\n    b, err := json.MarshalIndent(&amp;obj, \"\", \"   \")\n    if err != nil {\n        fmt.Printf(\"Error : %s\", err)\n    }\n    strJson := string(b)\n\n    return strJson\n}\n</code></pre>\n\n<p>The result is the same:</p>\n\n<pre><code>resp\n{\n   \"Status\": \"500 Internal Server Error\",\n   \"StatusCode\": 500,\n   \"Proto\": \"HTTP/1.1\",\n   \"ProtoMajor\": 1,\n   \"ProtoMinor\": 1,\n   \"Header\": {\n      \"Cache-Control\": [\n         \"no-cache, no-store, max-age=0, must-revalidate\"\n      ],\n      \"Connection\": [\n         \"Keep-Alive\"\n      ],\n      \"Content-Length\": [\n         \"55\"\n      ],\n      \"Content-Type\": [\n         \"text/plain; charset=utf-8\"\n      ],\n      \"Date\": [\n         \"Mon Jun 08 19:39:12 MSK 2015\"\n      ],\n      \"Pragma\": [\n         \"no-cache\"\n      ],\n      \"Server\": [\n         \"OrientDB Server v.2.0.10 (build UNKNOWN@r; 2015-05-25 16:48:43+0000)\"\n      ]\n   },\n   \"Body\": {},\n   \"ContentLength\": 55,\n   \"TransferEncoding\": null,\n   \"Close\": false,\n   \"Trailer\": null,\n   \"Request\": {\n      \"Method\": \"POST\",\n      \"URL\": {\n         \"Scheme\": \"http\",\n         \"Opaque\": \"\",\n         \"User\": null,\n         \"Host\": \"localhost:2480\",\n         \"Path\": \"/command/GratefulDeadConcerts/sql\",\n         \"RawQuery\": \"\",\n         \"Fragment\": \"\"\n      },\n      \"Proto\": \"HTTP/1.1\",\n      \"ProtoMajor\": 1,\n      \"ProtoMinor\": 1,\n      \"Header\": {\n         \"Authorization\": [\n            \"Basic cm9vdDox\"\n         ],\n         \"Content-Type\": [\n            \"Content-Type: text/plain\"\n         ]\n      },\n      \"Body\": {\n         \"Reader\": {}\n      },\n      \"ContentLength\": 60,\n      \"TransferEncoding\": null,\n      \"Close\": false,\n      \"Host\": \"localhost:2480\",\n      \"Form\": null,\n      \"PostForm\": null,\n      \"MultipartForm\": null,\n      \"Trailer\": null,\n      \"RemoteAddr\": \"\",\n      \"RequestURI\": \"\",\n      \"TLS\": null\n   },\n   \"TLS\": null\n}\njava.lang.IllegalArgumentException: text cannot be null\n</code></pre>\n\n<p>Also, I changed content-type to <code>text/plain</code> in <code>curl</code> command. </p>\n\n<pre><code>curl -X POST -u root:1 -H \"Content-Type: text/plain\" -d \"INSERT INTO V SET name = 'jack', boss = #11:19\"  http://localhost:2480/command/GratefulDeadConcerts/sql\n{\"result\":[{\"@type\":\"d\",\"@rid\":\"#9:858\",\"@version\":1,\"@class\":\"V\",\"name\":\"jack\",\"boss\":\"#11:19\",\"@fieldTypes\":\"boss=x\"}]}\n</code></pre>\n\n<p>The result is the same, it's ok with <code>curl</code>, but not ok with <code>golang</code> POST. </p>\n\n<h1>Update 4</h1>\n\n<p>What am I trying to do? I am implementing <a href=\"http://orientdb.com/docs/last/orientdb.wiki/OrientDB-REST.html#post---command\" rel=\"nofollow noreferrer\">OrientDB REST-interface</a> for executing queries from a <code>GO</code> application.</p>\n"}, {"tags": ["methods", "go", "interface"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1433748483, "post_id": 30701755, "comment_id": 49464533, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/14202181/what-is-this-variable-declaration-with-underscore-inline-interface-and-assignme\">What is this variable declaration with underscore, inline interface and assignment?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": false, "score": 8, "last_activity_date": 1433743772, "creation_date": 1433743772, "answer_id": 30702239, "question_id": 30701755, "link": "https://stackoverflow.com/questions/30701755/have-trouble-understanding-a-piece-of-golang-code/30702239#30702239", "title": "Have trouble understanding a piece of golang code", "body": "<p>As you say it's a way to verify that <code>Result</code> implements <code>Writeable</code>. From the <a href=\"https://golang.org/doc/faq#guarantee_satisfies_interface\">GO FAQ</a>:</p>\n\n<blockquote>\n  <p>You can ask the compiler to check that the type T implements the\n  interface I by attempting an assignment:</p>\n\n<pre><code>type T struct{} \nvar _ I = T{}   // Verify that T implements I.\n</code></pre>\n</blockquote>\n\n<p>The blank identifier _ stands for the variable name which is not needed here (and thus prevents a \"declared but not used\" error).</p>\n\n<p><code>(*Result)(nil)</code> creates an uninitialized pointer to a value of type <code>Result</code> by <a href=\"https://golang.org/ref/spec#Conversions\">converting</a> <code>nil</code> to <code>*Result</code>. This avoids allocation of memory for an empty struct as you'd get with <code>new(Result)</code> or <code>&amp;Result{}</code>.</p>\n"}], "owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433743772, "creation_date": 1433741118, "question_id": 30701755, "link": "https://stackoverflow.com/questions/30701755/have-trouble-understanding-a-piece-of-golang-code", "title": "Have trouble understanding a piece of golang code", "body": "<pre><code>package main\n\ntype Writeable interface {\n    OnWrite() interface{}\n}\n\ntype Result struct {\n    Message string\n}\n\nfunc (r *Result) OnWrite() interface{} {\n    return r.Message\n}\n\n// what does this line mean? what is the purpose?\nvar _ Writeable = (*Result)(nil)\n\n\nfunc main() {\n\n}\n</code></pre>\n\n<p>The comments in the code snippet expressed my confusion.\nAs I understood, the line with comment notifies the compiler to check whether a struct  has implemented the interface, but I am not sure very much.  Could someone help explaining the purpose?</p>\n"}, {"tags": ["logging", "go", "console", "output", "reset"], "answers": [{"tags": [], "owner": {"reputation": 4021, "user_id": 3360759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ndket.png?s=128&g=1", "display_name": "frhack", "link": "https://stackoverflow.com/users/3360759/frhack"}, "is_accepted": true, "score": 65, "last_activity_date": 1433706465, "creation_date": 1433706465, "answer_id": 30697774, "question_id": 30697694, "link": "https://stackoverflow.com/questions/30697694/how-to-set-golangs-log-output-back-to-console/30697774#30697774", "title": "How to set Golang&#39;s log output back to console?", "body": "<p>For standard error (the default):  </p>\n\n<pre><code>log.SetOutput(os.Stderr)\n</code></pre>\n\n<p>For standard output: </p>\n\n<pre><code>log.SetOutput(os.Stdout)\n</code></pre>\n\n<p><a href=\"http://golang.org/src/log/log.go\" rel=\"noreferrer\">http://golang.org/src/log/log.go</a></p>\n"}], "owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33833, "favorite_count": 11, "accepted_answer_id": 30697774, "answer_count": 1, "score": 38, "last_activity_date": 1433706465, "creation_date": 1433705938, "question_id": 30697694, "link": "https://stackoverflow.com/questions/30697694/how-to-set-golangs-log-output-back-to-console", "title": "How to set Golang&#39;s log output back to console?", "body": "<p>Google Go's <code>log</code> package has <a href=\"https://golang.org/pkg/log/#SetOutput\">SetOutput</a> - a function for setting the log output to any io.Writer. After I set it for testing, I would like to revert the output back to the standard console output - how do I do that? I don't see any obvious way of resetting it in the <code>log</code> or <code>io</code> packages.</p>\n"}, {"tags": ["ssh", "go", "cryptography"], "answers": [{"tags": [], "owner": {"reputation": 1442, "user_id": 721263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082a4401306decf204b7eeffd88deffa?s=128&d=identicon&r=PG", "display_name": "Neil Smithline", "link": "https://stackoverflow.com/users/721263/neil-smithline"}, "is_accepted": false, "score": 0, "last_activity_date": 1433714443, "creation_date": 1433714443, "answer_id": 30698881, "question_id": 30697500, "link": "https://stackoverflow.com/questions/30697500/ssh-through-multiple-hosts-in-go/30698881#30698881", "title": "SSH through multiple hosts in go", "body": "<p>The problem is that you are running all of this code on the same host. Let's call the host you run your app on <code>host0</code> for convenience.</p>\n\n<p>You start out making a connection from <code>host0</code> to <code>host1</code>. That works fine. What you seem to want to do next is make a connection from <code>host1</code> to <code>host2</code>. To do that you need to run the SSH code on <code>host1</code>. But your app, which is and always has been running on <code>host0</code>, is not in the place to do that.</p>\n\n<p>You will need to put a program on <code>host1</code> that does the connection to <code>host2</code> and then send a command down the SSH connection to <code>host1</code> that will start that program.</p>\n"}], "owner": {"reputation": 1, "user_id": 2196247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc5619f8cbfcab727e2af298e739338?s=128&d=identicon&r=PG", "display_name": "c0nrad", "link": "https://stackoverflow.com/users/2196247/c0nrad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433714443, "creation_date": 1433704679, "question_id": 30697500, "link": "https://stackoverflow.com/questions/30697500/ssh-through-multiple-hosts-in-go", "title": "SSH through multiple hosts in go", "body": "<p>Is it possible to SSH to another host while in an SSH session in golang? I tried chaining some stuff together like this, but the printout says the remote addr of client 2 is 0.0.0.0 and an error is given when I try to execute anything on an ssh.Session from client2.</p>\n\n<pre><code>host1 := \"host1.com\"\nhost2 := \"host2.com\"\nclient1, err := ssh.Dial(\"tcp\", host, config)\nif err != nil {\n    panic(\"Failed to dial: \" + err.Error())\n}\n\nconn, err := client1.Dial(\"tcp\", host2)\nif err != nil {\n    panic(err)\n}\n\nsshConn, newChan, requestChan, err := ssh.NewClientConn(conn, host2, config)\nif err != nil {\n    panic(err)\n}\n\nclient2 := ssh.NewClient(sshConn, newChan, requestChan)\n\nfmt.Println(\"Client 2 RemoteAddr():\", client2.RemoteAddr())\n</code></pre>\n"}, {"tags": ["go", "directory"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1433704775, "post_id": 30697324, "comment_id": 49453247, "body": "You could do <a href=\"https://golang.org/pkg/os/#File.Readdir\" rel=\"nofollow noreferrer\"><code>f.Readdir(1)</code></a> to only look at the first directory entry (or 3 if you need to skip &quot;.&quot; and &quot;..&quot;) (helpful if there may be many many directory entries). But beware, you can only ever know &quot;if the directory <i>was</i> empty&quot;, it may have new files in it by the time you check. That&#39;s probably one reason no such &quot;easy&quot; check exists; because it&#39;s pretty useless. [E.g., that&#39;s why things like <code>rmdir</code> don&#39;t check, they just try and remove the directory and handle/report <code>ENOTEMPTY</code> instead since that&#39;s atomic.]"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1433705247, "post_id": 30697324, "comment_id": 49453389, "body": "^^ actually <a href=\"https://golang.org/pkg/os/#File.Readdirnames\" rel=\"nofollow noreferrer\"><code>f.Readdirnames(1)</code></a> (or 3) would be slightly better."}], "answers": [{"comments": [{"owner": {"reputation": 527, "user_id": 1195832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc4796b90f1b852b6efce7617f8dad94?s=128&d=identicon&r=PG", "display_name": "mat007", "link": "https://stackoverflow.com/users/1195832/mat007"}, "edited": false, "score": 0, "creation_date": 1543471124, "post_id": 30708914, "comment_id": 93933212, "body": "<code>File.Readdirnames()</code> implementation seems to be based on <code>File.Readdir()</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 28, "last_activity_date": 1455796542, "last_edit_date": 1455796542, "creation_date": 1433765702, "answer_id": 30708914, "question_id": 30697324, "link": "https://stackoverflow.com/questions/30697324/how-to-check-if-directory-on-path-is-empty/30708914#30708914", "title": "How to check if directory on path is empty?", "body": "<p>Whether a directory is empty or not is not stored in the file-system level as properties like its name, creation time or its size (in case of files).</p>\n\n<p>That being said you can't just obtain this information from an <a href=\"http://golang.org/pkg/os/#FileInfo\" rel=\"noreferrer\"><code>os.FileInfo</code></a>. The easiest way is to query the children (content) of the directory.</p>\n\n<p><a href=\"http://golang.org/pkg/io/ioutil/#ReadDir\" rel=\"noreferrer\"><code>ioutil.ReadDir()</code></a> is quite a bad choice as that first reads all the contents of the specified directory and then sorts them by name, and then returns the slice. The fastest way is as Dave C mentioned: query the children of the directory using <a href=\"http://golang.org/pkg/os/#File.Readdir\" rel=\"noreferrer\"><code>File.Readdir()</code></a> or (preferably) <a href=\"http://golang.org/pkg/os/#File.Readdirnames\" rel=\"noreferrer\"><code>File.Readdirnames()</code></a> .</p>\n\n<p>Both <code>File.Readdir()</code> and <code>File.Readdirnames()</code> take a parameter which is used to limit the number of returned values. It is enough to query only 1 child. As <code>Readdirnames()</code> returns only names, it is faster because no further calls are required to obtain (and construct) <a href=\"http://golang.org/pkg/os/#FileInfo\" rel=\"noreferrer\"><code>FileInfo</code></a> structs.</p>\n\n<p>Note that if the directory is empty, <code>io.EOF</code> is returned as an error (and not an empty or <code>nil</code> slice) so we don't even need the returned names slice.</p>\n\n<p>The final code could look like this:</p>\n\n<pre><code>func IsEmpty(name string) (bool, error) {\n    f, err := os.Open(name)\n    if err != nil {\n        return false, err\n    }\n    defer f.Close()\n\n    _, err = f.Readdirnames(1) // Or f.Readdir(1)\n    if err == io.EOF {\n        return true, nil\n    }\n    return false, err // Either not empty or error, suits both cases\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": -1, "last_activity_date": 1613015084, "creation_date": 1613015084, "answer_id": 66148476, "question_id": 30697324, "link": "https://stackoverflow.com/questions/30697324/how-to-check-if-directory-on-path-is-empty/66148476#66148476", "title": "How to check if directory on path is empty?", "body": "<p>Depending on your needs, you might just be able to call <code>os.Remove</code>. It will only\nsucceed with files or empty folders:</p>\n<pre><code>package main\n\nimport (\n   &quot;log&quot;\n   &quot;os&quot;\n)\n\nfunc main() {\n   e := os.Remove(&quot;dest&quot;)\n   if e != nil {\n      log.Fatal(e)\n   }\n}\n</code></pre>\n<p><a href=\"https://golang.org/pkg/os#Remove\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os#Remove</a></p>\n"}], "owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8155, "favorite_count": 3, "accepted_answer_id": 30708914, "answer_count": 2, "score": 10, "last_activity_date": 1613015084, "creation_date": 1433703520, "last_edit_date": 1474371223, "question_id": 30697324, "link": "https://stackoverflow.com/questions/30697324/how-to-check-if-directory-on-path-is-empty", "title": "How to check if directory on path is empty?", "body": "<p>How to check in Go if folder is empty? I can check like:</p>\n\n<pre><code>files, err := ioutil.ReadDir(*folderName)\nif err != nil {\n    return nil, err\n}\n\n// here check len of files \n</code></pre>\n\n<p>But it kinda looks to me that there should be more a elegant solution.</p>\n"}, {"tags": ["macos", "intellij-idea", "go", "environment-variables"], "comments": [{"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1433703430, "post_id": 30697191, "comment_id": 49452794, "body": "Are you running the latest version of the plugin?"}, {"owner": {"reputation": 4073, "user_id": 2626491, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/UUSae.jpg?s=128&g=1", "display_name": "Alex Woolford", "link": "https://stackoverflow.com/users/2626491/alex-woolford"}, "reply_to_user": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1433706474, "post_id": 30697191, "comment_id": 49453787, "body": "I downloaded version 0.9.15.3 from <a href=\"http://plugins.jetbrains.com/plugin/5047\" rel=\"nofollow noreferrer\">plugins.jetbrains.com/plugin/5047</a>."}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1433706846, "post_id": 30697191, "comment_id": 49453894, "body": "Try the beta/alpha version from the github page."}, {"owner": {"reputation": 4073, "user_id": 2626491, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/UUSae.jpg?s=128&g=1", "display_name": "Alex Woolford", "link": "https://stackoverflow.com/users/2626491/alex-woolford"}, "reply_to_user": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1433707608, "post_id": 30697191, "comment_id": 49454132, "body": "Thanks @inf. I added the alpha version of the plugin (via <a href=\"https://plugins.jetbrains.com/plugins/alpha/5047\" rel=\"nofollow noreferrer\">plugins.jetbrains.com/plugins/alpha/5047</a>) and it&#39;s working now!"}], "owner": {"reputation": 4073, "user_id": 2626491, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/UUSae.jpg?s=128&g=1", "display_name": "Alex Woolford", "link": "https://stackoverflow.com/users/2626491/alex-woolford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433702730, "creation_date": 1433702730, "last_edit_date": 1495539820, "question_id": 30697191, "link": "https://stackoverflow.com/questions/30697191/go-on-intellij-missing-sdk-environment-variables", "title": "Go on IntelliJ: missing SDK/environment variables", "body": "<p>I'd like to learn <code>Go</code> and attempted to setup the <a href=\"http://github.com/go-lang-plugin-org/go-lang-idea-plugin\" rel=\"nofollow noreferrer\" title=\"Go Plugin For IntelliJ\">Go plugin for IntelliJ</a> on IntelliJ IDEA 14.1.3. I'm running OSX Yosemite (10.10.3).</p>\n\n<p>I installed go using <a href=\"http://brew.sh/\" rel=\"nofollow noreferrer\" title=\"Brew\">Brew</a>: <code>brew install go</code>.</p>\n\n<p>I'm unable to setup the SDK as I go through the new project wizard. The Project SDK is empty, when I click 'Configure', and navigate to the <code>libexec</code> folder of the installation (<code>/usr/local/Cellar/go/1.4.2/libexec/</code>), the Project SDK never is never displayed in the box. If I click through the wizard, it warns me that no SDK was specified, and then warns that <code>GOROOT</code> and <code>GOPATH</code> env variables are empty of could not be detected.</p>\n\n<p>It seems there are <a href=\"https://stackoverflow.com/questions/25385934/setting-environment-variables-via-launchd-conf-no-longer-works-in-os-x-yosemite\" title=\"quite a few ways to setup environment variables on OSX\">quite a few ways to set environment variables on OSX</a>. I created an  <code>~/Library/LaunchAgents/environment.plist</code> file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n  &lt;key&gt;Label&lt;/key&gt;\n  &lt;string&gt;my.startup&lt;/string&gt;\n  &lt;key&gt;ProgramArguments&lt;/key&gt;\n  &lt;array&gt;\n    &lt;string&gt;sh&lt;/string&gt;\n    &lt;string&gt;-c&lt;/string&gt;\n    &lt;string&gt;\n    launchctl setenv GOROOT \"/usr/local/Cellar/go/1.4.2/libexec/\"\n    launchctl setenv GOPATH \"/Users/awoolford/golang/\"\n    &lt;/string&gt;\n\n  &lt;/array&gt;\n  &lt;key&gt;RunAtLoad&lt;/key&gt;\n  &lt;true/&gt;\n&lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre>\n\n<p>If I run <code>launchctl load -w  ~/Library/LaunchAgents/environment.plist</code> the environment variables are loaded:</p>\n\n<pre><code>$ launchctl getenv GOPATH\n/Users/awoolford/golang/\n\n$ launchctl getenv GOROOT\n/usr/local/Cellar/go/1.4.2/libexec/\n</code></pre>\n\n<p>I would have expected IntelliJ to recognize these environment variables, and that I'd be able to create a project in <code>~/golang/</code>.</p>\n\n<p>Can you see what I'm doing wrong?</p>\n"}, {"tags": ["arrays", "string", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1433699566, "post_id": 30696546, "comment_id": 49451555, "body": "Assignment or <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\"><code>copy</code></a>."}, {"owner": {"reputation": 18900, "user_id": 1575153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aec7ad434476dfbfff719f7191c916c9?s=128&d=identicon&r=PG&f=1", "display_name": "sergserg", "link": "https://stackoverflow.com/users/1575153/sergserg"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433700576, "post_id": 30696546, "comment_id": 49451898, "body": "Technically <code>assign</code>. SEO wise people will probably find this Q&amp;A by searching for <code>copy</code> though."}], "answers": [{"comments": [{"owner": {"reputation": 18900, "user_id": 1575153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aec7ad434476dfbfff719f7191c916c9?s=128&d=identicon&r=PG&f=1", "display_name": "sergserg", "link": "https://stackoverflow.com/users/1575153/sergserg"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433700344, "post_id": 30696547, "comment_id": 49451809, "body": "Right you can copy but not assign."}], "tags": [], "owner": {"reputation": 18900, "user_id": 1575153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aec7ad434476dfbfff719f7191c916c9?s=128&d=identicon&r=PG&f=1", "display_name": "sergserg", "link": "https://stackoverflow.com/users/1575153/sergserg"}, "is_accepted": false, "score": 0, "last_activity_date": 1433700332, "last_edit_date": 1433700332, "creation_date": 1433698808, "answer_id": 30696547, "question_id": 30696546, "link": "https://stackoverflow.com/questions/30696546/how-to-copy-a-string-array-into-another-string-array/30696547#30696547", "title": "How to copy a string array into another string array?", "body": "<p>You can declare a new array of the same type and copy over the values by assigning it.</p>\n\n<pre><code>// Declare a string array of five elements.\nvar array1 [5]string\n\n// Declare a second string array of five elements.\n// Initialise the array with values.\narray2 := [5]string{\"A\", \"B\", \"C\", \"D\", \"E\"}\n\n// Copy the values from array2 into array1.\narray1 = array2\n</code></pre>\n\n<hr>\n\n<p>Keep in mind that you <strong>cannot</strong> assign over an array of different size:</p>\n\n<pre><code>// Declare a string array of four elements.\nvar array1 [4]string\n\n// Declare a second string array of five elements.\n// Initialize the array with colors.\narray2 := [5]string{\"A\", \"B\", \"C\", \"D\", \"E\"}\n\n// Copy the values from array2 into array1.\narray1 = array2\n\nCompiler Error:\ncannot use array2 (type [5]string) as type [4]string in assignment\n</code></pre>\n"}], "owner": {"reputation": 18900, "user_id": 1575153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aec7ad434476dfbfff719f7191c916c9?s=128&d=identicon&r=PG&f=1", "display_name": "sergserg", "link": "https://stackoverflow.com/users/1575153/sergserg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1433700332, "creation_date": 1433698792, "question_id": 30696546, "link": "https://stackoverflow.com/questions/30696546/how-to-copy-a-string-array-into-another-string-array", "title": "How to copy a string array into another string array?", "body": "<p>I have an array of string elements, and I want to copy the values over to a new array. </p>\n\n<p>How can I do that?</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "edited": false, "score": 0, "creation_date": 1433795178, "post_id": 30716103, "comment_id": 49494424, "body": "Controller field of my struct AppController is just embedded field. I&#39;ve checked if I have any unexporting fields, and none avaialble. Also reason why am i doing 2 times ValueOf - because otherwise i have error <code>reflect: call of reflect.Value.FieldByName on ptr Value</code>. Updated code with comment"}, {"owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "reply_to_user": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "edited": false, "score": 0, "creation_date": 1433798743, "post_id": 30716103, "comment_id": 49496148, "body": "Can you provide complete code (<i>e.g.</i> on play.golang.org) which shows the error message(s)?"}, {"owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "edited": false, "score": 0, "creation_date": 1433830516, "post_id": 30716103, "comment_id": 49505674, "body": "Not sure how can i do that, since i have few different modules"}], "tags": [], "owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "is_accepted": false, "score": 2, "last_activity_date": 1433786803, "creation_date": 1433786803, "answer_id": 30716103, "question_id": 30695405, "link": "https://stackoverflow.com/questions/30695405/setting-field-using-reflect-set/30716103#30716103", "title": "Setting field using reflect.Set", "body": "<p>You don't give your complete code, so I have to guess a bit, but I suspect that the <code>Controller</code> field of the <code>AppController</code> structure has a lower-case name.  Right?  Here is my attempt to produce a minimal example from your code: <a href=\"http://play.golang.org/p/zmjNP5HWsi\" rel=\"nofollow\">working</a> (with upper-case field name) and <a href=\"http://play.golang.org/p/x_rYrw530R\" rel=\"nofollow\">non-working</a> (with lower-case fieldname).</p>\n\n<p>Also: where you write <code>reflect.ValueOf(appController).Field(0)</code>, the <code>appController</code> is already of type <code>reflect.Value</code>, so the <code>ValueOf</code> is not required.  You can just write <code>appController.Field(0)</code> as in the example code I linked above.</p>\n"}], "owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1433795022, "creation_date": 1433691529, "last_edit_date": 1433795022, "question_id": 30695405, "link": "https://stackoverflow.com/questions/30695405/setting-field-using-reflect-set", "title": "Setting field using reflect.Set", "body": "<p>I have code</p>\n\n<pre><code>var t reflect.Type = LaunchController(route.controller)\n\n    // create controller ptr .\n    var appControllerPtr reflect.Value = reflect.New(t)\n    fmt.Println(appControllerPtr) //#=&gt; &lt;**controller.AppController Value&gt;\n    var appController reflect.Value = appControllerPtr.Elem()\n    // Create and configure base controller\n    var c *Controller = &amp;Controller{\n            Request: r,\n            Writer: w,\n            Name: t.Name(),\n        }\n\n    //this should assign *goninja.Controller field in application controllers\n    var controllerField reflect.Value = reflect.ValueOf(appController).Field(0)\n    controllerField.Elem().Set(reflect.ValueOf(c))\n</code></pre>\n\n<p>This creates pointer to element, and afterwards trying to assign value, into 0 field of this struct.</p>\n\n<p>My struct, that i'm trying to reflect looks like</p>\n\n<pre><code>type AppController struct {\n  *goninja.Controller\n}\n</code></pre>\n\n<p>However when I'm trying to assign this field with code</p>\n\n<pre><code>controllerField.Elem().Set(reflect.ValueOf(c))\n</code></pre>\n\n<p>I'm facing following error</p>\n\n<pre><code>reflect: reflect.Value.Set using value obtained using unexported field\n</code></pre>\n\n<p>What am i doin wrong? Also I cant understand why my <code>reflect.New(t)</code> returns <code>reflect.Value</code> with 2 asterisks in beginning <code>**</code></p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 6983, "user_id": 973397, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/7pwAF.jpg?s=128&g=1", "display_name": "fred randall", "link": "https://stackoverflow.com/users/973397/fred-randall"}, "edited": false, "score": 3, "creation_date": 1435256025, "post_id": 30694652, "comment_id": 50136592, "body": "pizza is always best served in slices"}], "answers": [{"comments": [{"owner": {"reputation": 3740, "user_id": 4310487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ESDVi.jpg?s=128&g=1", "display_name": "light", "link": "https://stackoverflow.com/users/4310487/light"}, "edited": false, "score": 0, "creation_date": 1433690076, "post_id": 30694715, "comment_id": 49448394, "body": "Thanks for your answer. I don&#39;t have enough experience to know if arrays being hashable is necessary or desirable. In any case, I&#39;m guessing most structs don&#39;t have hashable equivalents?"}, {"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "edited": false, "score": 1, "creation_date": 1433701050, "post_id": 30694715, "comment_id": 49452055, "body": "Structs are unhashable if they contain unhashable fields."}], "tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 6, "last_activity_date": 1433687650, "creation_date": 1433687650, "answer_id": 30694715, "question_id": 30694652, "link": "https://stackoverflow.com/questions/30694652/why-use-arrays-instead-of-slices/30694715#30694715", "title": "Why use arrays instead of slices?", "body": "<p>One practical difference is that <code>arrays</code> are hashable, while <code>slices</code> are not.</p>\n"}, {"comments": [{"owner": {"reputation": 3740, "user_id": 4310487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ESDVi.jpg?s=128&g=1", "display_name": "light", "link": "https://stackoverflow.com/users/4310487/light"}, "edited": false, "score": 0, "creation_date": 1433690526, "post_id": 30695082, "comment_id": 49448522, "body": "Hi Stephen, thanks for the answer. Hashable/serializable are all nice to have, but I&#39;m just not sure if they are indeed that compelling to have. For arrays being used to control memory layout, do you have a real example of why you&#39;d want to do that? Sounds like getting closer to C&#39;s malloc, sizeof.  Yes I believe Google&#39;s bottom line is same as yours - which is, more or less, don&#39;t use arrays. If problems can be solved with less difficulty and nil/insignificant performance penalty using slices, I wonder why they included arrays in the first place."}, {"owner": {"reputation": 3740, "user_id": 4310487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ESDVi.jpg?s=128&g=1", "display_name": "light", "link": "https://stackoverflow.com/users/4310487/light"}, "edited": false, "score": 0, "creation_date": 1433728067, "post_id": 30695082, "comment_id": 49458596, "body": "Thanks for the map of hashes example - that really helped."}, {"owner": {"reputation": 3740, "user_id": 4310487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ESDVi.jpg?s=128&g=1", "display_name": "light", "link": "https://stackoverflow.com/users/4310487/light"}, "edited": false, "score": 0, "creation_date": 1433728485, "post_id": 30695082, "comment_id": 49458681, "body": "I still don&#39;t quite understand the &quot;control memory layout&quot; portion, but it&#39;s sounding quite low-level. I&#39;d presume it&#39;s probably not something that the common developer needs to worry about when deciding between slices and arrays, except for very specific use cases. I guess we can conclude: &quot;use slices whenever practical, arrays only if slices are not as easy (e.g. map of hashes) or if you are doing some low-level work and you need the characteristics of fixed memory allocation.&quot; Would that be accurate?"}], "tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": true, "score": 19, "last_activity_date": 1584923982, "last_edit_date": 1584923982, "creation_date": 1433689678, "answer_id": 30695082, "question_id": 30694652, "link": "https://stackoverflow.com/questions/30694652/why-use-arrays-instead-of-slices/30695082#30695082", "title": "Why use arrays instead of slices?", "body": "<p>As said by Akavall, arrays are hashable. That means they can be used as a key to a map.</p>\n\n<p>They are also pass by value. Each time you pass it to a function or assign it to another variable it makes a complete copy of it.</p>\n\n<p>They can be serialized by encoding/binary.</p>\n\n<p>They also can be used to control memory layout. Since it is not a reference, when it is placed in a struct, it will allocate that much memory as part of the struct instead of putting the equivalent of a pointer there like a slice would.</p>\n\n<p>Bottom line, don't use an array unless you know what you are doing.</p>\n\n<hr>\n\n<blockquote>\n  <p>Hashable/serializable are all nice to have, but I'm just not sure if they are indeed that compelling to have</p>\n</blockquote>\n\n<p>What would you do if you wanted to have a map of md5 hashes? Can't use a byte slice so you would need to do something like this to get around the type system:</p>\n\n<pre><code>// 16 bytes\ntype hashableMd5 struct {a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p byte}\n</code></pre>\n\n<p>Then create a serialization function for it. Hashable arrays mean that you can just call it a [16]byte.</p>\n\n<blockquote>\n  <p>Sounds like getting closer to C's malloc, sizeof</p>\n</blockquote>\n\n<p>Nope, that has nothing to do with malloc or sizeof. Those are to allocate memory and get the size of a variable.</p>\n\n<p>However, CGo is another use case for this. The cgo command creates types that have the same memory layout as their corresponding C types. To do this, it sometimes needs to insert unnamed arrays for padding.</p>\n\n<blockquote>\n  <p>If problems can be solved with ... nil/insignificant performance penalty using slices ...</p>\n</blockquote>\n\n<p>Arrays also prevent indirects making certain types of code faster. Of course this is such a minor optimization that this is insignificant in nearly all cases.</p>\n"}, {"comments": [{"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "edited": false, "score": 2, "creation_date": 1433773485, "post_id": 30705048, "comment_id": 49480890, "body": "This is exactly what the cgo command does when it is making Go structures that match their C counterpart. Upvoted."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1433774850, "last_edit_date": 1433774850, "creation_date": 1433754247, "answer_id": 30705048, "question_id": 30694652, "link": "https://stackoverflow.com/questions/30694652/why-use-arrays-instead-of-slices/30705048#30705048", "title": "Why use arrays instead of slices?", "body": "<p>To supplement Stephen Weinberg's answer:</p>\n\n<blockquote>\n  <p>So, what are some real examples of \"planning the detailed layout of memory\" or \"help avoid allocation\" that slices would be unsuited for?</p>\n</blockquote>\n\n<p>Here's an example for \"planning the detailed layout of memory\". There are many file formats. Usually a file format is like this: it starts with a <a href=\"http://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"noreferrer\">\"magic number\"</a> then follows an informational header whose structure is usually fixed. This header contains information about the content, for example in case of an image file it contains info like image size (width, height), pixel format, compression used, header size, image data offset and alike (basically describes the rest of the file and how to interpret / process it).</p>\n\n<p>If you want to implement a file format in Go, an easy and convenient way is to create a <code>struct</code> containing the header fields of the format. When you want to read a file of such format, you can use the <a href=\"https://golang.org/pkg/encoding/binary/#Read\" rel=\"noreferrer\"><code>binary.Read()</code></a> method to read the whole header <code>struct</code> into a variable, and similarly when you want to write a file of that format, you can use <a href=\"https://golang.org/pkg/encoding/binary/#Write\" rel=\"noreferrer\"><code>binary.Write()</code></a> to write the complete header in one step into the file (or wherever you send the data).</p>\n\n<p>The header might contain even tens or a hundred fields, you can still read/write it with just one method call.</p>\n\n<p>Now as you can feel, the \"memory layout\" of the header <code>struct</code> must match exactly the byte layout as it is saved (or should be saved) in the file if you want to do it all in one step.</p>\n\n<h3>And where do arrays come into the picture?</h3>\n\n<p>Many file formats are usually complex because they want to be general and so allowing a wide range of uses and functionality. And many times you don't want to implement / handle everything the format supports because either you don't care (because you just want to extract some info), or you don't have to because you have guarantees that the input will only use a subset or a fixed format (out of the many cases the file format fully supports).</p>\n\n<p>So what do you do if you have a header specification with many fields but you only need a few of them? You can define a struct which will contain the fields you need, and between the fields you can use arrays with the size of the fields you just don't care / don't need. This will ensure that you can still read the whole header with one function call, and the arrays will basically be the placeholder of the unused data in the file. You may also use the <a href=\"https://golang.org/ref/spec#Blank_identifier\" rel=\"noreferrer\">blank</a> identifier as the field name in the header <code>struct</code> definition if you won't use the data.</p>\n\n<h3>Theoretical example</h3>\n\n<p>For an easy example, let's implement a format where the magic is \"TGI\" (Theoretical Go Image) and the header contains fields like this: 2 reserved words (16 bit each), 1 dword image width, 1 dword image height, now comes 15 \"don't care\" dwords then the image save time as 8-byte being nanoseconds since January 1, 1970 UTC.</p>\n\n<p>This can be modeled with a struct like this (magic number excluded):</p>\n\n<pre><code>type TGIHeader struct {\n    _        uint16 // Reserved\n    _        uint16 // Reserved\n    Width    uint32\n    Height   uint32\n    _        [15]uint32 // 15 \"don't care\" dwords\n    SaveTime int64\n}\n</code></pre>\n\n<p>To read a TGI file and print useful info:</p>\n\n<pre><code>func ShowInfo(name string) error {\n    f, err := os.Open(name)\n    if err != nil {\n        return err\n    }\n    defer f.Close()\n\n    magic := make([]byte, 3)\n    if _, err = f.Read(magic); err != nil {\n        return err\n    }\n    if !bytes.Equal(magic, []byte(\"TGI\")) {\n        return errors.New(\"Not a TGI file\")\n    }\n\n    th := TGIHeader{}\n    if err = binary.Read(f, binary.LittleEndian, &amp;th); err != nil {\n        return err\n    }\n\n    fmt.Printf(\"%s is a TGI file,\\n\\timage size: %dx%d\\n\\tsaved at: %v\",\n        name, th.Width, th.Height, time.Unix(0, th.SaveTime))\n\n    return nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2587, "user_id": 2091399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aeHSj.jpg?s=128&g=1", "display_name": "Peter Dotchev", "link": "https://stackoverflow.com/users/2091399/peter-dotchev"}, "is_accepted": false, "score": 0, "last_activity_date": 1521875621, "creation_date": 1521875621, "answer_id": 49462226, "question_id": 30694652, "link": "https://stackoverflow.com/questions/30694652/why-use-arrays-instead-of-slices/49462226#49462226", "title": "Why use arrays instead of slices?", "body": "<p>To expand on this</p>\n\n<blockquote>\n  <p>Arrays are useful when planning the detailed layout of memory and\n  sometimes can help avoid allocation, but primarily they are a building\n  block for slices.</p>\n</blockquote>\n\n<p>Arrays can be more efficient when considering the overhead of heap allocation. Think about the garbage collector, heap management and fragmentation, etc.</p>\n\n<p>For example if you have a local array variable like <code>var x [8]int</code> that is not used after the function returns, most probably it will be allocated on the stack.\nAnd stack allocation is much cheaper than heap allocation.</p>\n\n<p>Also for nested structures like arrays of arrays or arrays inside structs, it is cheaper to allocate them in one blob instead of in several pieces.</p>\n\n<p>So, use arrays for relatively short sequences of fixed size, e.g. an IP address.</p>\n"}], "owner": {"reputation": 3740, "user_id": 4310487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ESDVi.jpg?s=128&g=1", "display_name": "light", "link": "https://stackoverflow.com/users/4310487/light"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2265, "favorite_count": 8, "accepted_answer_id": 30695082, "answer_count": 4, "score": 20, "last_activity_date": 1584923982, "creation_date": 1433687356, "last_edit_date": 1433754669, "question_id": 30694652, "link": "https://stackoverflow.com/questions/30694652/why-use-arrays-instead-of-slices", "title": "Why use arrays instead of slices?", "body": "<p>I have been reading up on Go, and got stumped thinking about this fundamental question.</p>\n\n<p>In Go, it is quite clear that slices are more flexible, and can generally be used in place of arrays when you need a sequence of data.</p>\n\n<p>Reading most of the documentation, they seem to be encouraging developers to just use slices instead of arrays. The impression I get feels like the creators could have simply designed arrays to be resize-able, and done without the entire slices section. In fact, such a design would have made the language even easier to understand, and perhaps even encouraged more idiomatic code.</p>\n\n<p>So why did the creators allow arrays in the first place? When would arrays ever be used instead of slices? Is there ever a situation where the use of arrays over slices will be <strong>compelling</strong>?</p>\n\n<p>When I consulted the official documentation (<a href=\"http://golang.org/doc/effective_go.html#arrays\">http://golang.org/doc/effective_go.html#arrays</a>), the only useful part I found was:</p>\n\n<blockquote>\n  <p>Arrays are useful when planning the detailed layout of memory and\n  sometimes can help avoid allocation, but primarily they are a building block\n  for slices.</p>\n</blockquote>\n\n<p>They went on to talk about how arrays are expensive as values, and how to simulate C-style behavior with pointer. Even then, they ended the array section with a clear recommendation:</p>\n\n<blockquote>\n  <p>But even this style isn't idiomatic Go. Use slices instead.</p>\n</blockquote>\n\n<p>So, what are some real examples of \"planning the detailed layout of memory\" or \"help avoid allocation\" that slices would be unsuited for?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 10170, "user_id": 1916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487430ca3c1389e98a3c39c3910de8ef?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/1916/greg"}, "edited": false, "score": 1, "creation_date": 1433691078, "post_id": 30694577, "comment_id": 49448711, "body": "The parameters passed to the task aren&#39;t json, so unmarshalling as such won&#39;t work. Your code can be almost identical to the example here: <a href=\"https://cloud.google.com/appengine/docs/go/taskqueue/overview-push\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/taskqueue/overview-push</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4376, "user_id": 959140, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/66Jhu.png?s=128&g=1", "display_name": "Robin Andersson", "link": "https://stackoverflow.com/users/959140/robin-andersson"}, "is_accepted": false, "score": 0, "last_activity_date": 1433772970, "creation_date": 1433772970, "answer_id": 30711579, "question_id": 30694577, "link": "https://stackoverflow.com/questions/30694577/unmarshal-body-response-from-task-queue/30711579#30711579", "title": "Unmarshal body response from task queue", "body": "<p>Arguments to tasks are sent as POST-values, you assign a slice of strings as the POST-value for the key <code>filenames</code>. </p>\n\n<p>Then you try to deserialize the full POST request body as JSON.</p>\n\n<p>A simple solution would be to split up each file in one task and just send the file name as a string value, then it would be something like:</p>\n\n<pre><code>// Add tasks\nfor i := range req.FileNames {\n    postValues := url.Values{}\n    postValues.Set(\"fileName\", req.FileNames[i])\n\n    t := taskqueue.NewPOSTTask(\"/deletetask\", postValues)\n    if _, err := taskqueue.Add(ctx, t, \"delete\"); err != nil {\n        c.Errorf(\"Failed add task, error: %v, fileName: %v\", err, req.FileNames[i])\n    }\n}\n\n// The actual delete worker\nfunc worker(w http.ResponseWriter, r *http.Request) {\n    ctx := appengine.NewContext(r)\n    fileName := r.FormValue(\"fileName\")\n\n    ctx.Infof(\"Deleting: %v\", fileName)\n}\n</code></pre>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433772970, "creation_date": 1433686795, "question_id": 30694577, "link": "https://stackoverflow.com/questions/30694577/unmarshal-body-response-from-task-queue", "title": "Unmarshal body response from task queue", "body": "<p>I'm using go and google task queue in order to create  some a sync jobs.</p>\n\n<p>I'm passing the data to the worker method successfully but i can't unmarshal the data in order to use it. </p>\n\n<p>I tried different ways i'm getting an unmarshal error  </p>\n\n<pre><code> err um &amp;json.SyntaxError{msg:\"invalid character 'i' in literal false (expecting 'a')\", Offset:2}\n</code></pre>\n\n<p>This is how i'm sending the data to the queue </p>\n\n<pre><code>    keys := make(map[string][]string)\n    keys[\"filenames\"] = req.FileNames // []string\n\n    t := taskqueue.NewPOSTTask(\"/deletetask\", keys)\n    _, err = taskqueue.Add(ctx, t, \"delete\")\n</code></pre>\n\n<p>And this is how i tried to unmarshal it </p>\n\n<pre><code> type Files struct {\nfileNames string `json:\"filenames\"`\n }\n\n\nfunc worker(w http.ResponseWriter, r *http.Request) {\nc := appengine.NewContext(r)\n\nvar objmap map[string]json.RawMessage\nb, err := ioutil.ReadAll(r.Body)\nif err != nil {\n    c.Debugf(\"err io  %#v\", err)\n}\nc.Debugf(\"b  %#v\", string(b[:])) //Print: b  \"filenames=1.txt&amp;filenames=2.txt\"\n\nerr = json.Unmarshal(b, &amp;objmap)\nif err != nil {\n    c.Debugf(\"err um %#v\", err)\n}\n //this didn't work as well  same err\n    f := []Files{}\n    err = json.Unmarshal(b, &amp;f)\n }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15090, "user_id": 310892, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Jy9kc.jpg?s=128&g=1", "display_name": "Lee Jarvis", "link": "https://stackoverflow.com/users/310892/lee-jarvis"}, "edited": false, "score": 1, "creation_date": 1433680261, "post_id": 30693421, "comment_id": 49445537, "body": "You have no idea how to do it, but you have written code that does what you want?"}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "reply_to_user": {"reputation": 15090, "user_id": 310892, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Jy9kc.jpg?s=128&g=1", "display_name": "Lee Jarvis", "link": "https://stackoverflow.com/users/310892/lee-jarvis"}, "edited": false, "score": 0, "creation_date": 1433680635, "post_id": 30693421, "comment_id": 49445650, "body": "Yep, you are right. My english isn&#39;t quite good)"}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "edited": false, "score": 2, "creation_date": 1433680735, "post_id": 30693421, "comment_id": 49445680, "body": "Your solution looks great. I would not change it, unless you are looking to do something special [so for example, if you want to be able to quickly find a line on demand, say from a client requesting data, DB style, you could consider caching the entire file in memory inside a slice, and then you could simply grab the line by using the index as the line number]"}, {"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1433681026, "post_id": 30693421, "comment_id": 49445765, "body": "Thank for advice. Could you explain what does it mean &quot;you could consider caching the entire file in memory inside a slice, and then you could simply grab the line by using the index as the line number&quot; in the square brackets of your comment?"}], "answers": [{"tags": [], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "is_accepted": true, "score": 3, "last_activity_date": 1560863330, "last_edit_date": 1560863330, "creation_date": 1433765700, "answer_id": 30708912, "question_id": 30693421, "link": "https://stackoverflow.com/questions/30693421/how-to-read-specific-line-of-file/30708912#30708912", "title": "How to read specific line of file?", "body": "<p>Two people said my code in question is actual solution. So I've posted it here. Thanks to @orcaman for additional advice.</p>\n\n<pre><code>import (\n    \"bufio\"\n    \"io\"\n)\n\nfunc ReadLine(r io.Reader, lineNum int) (line string, lastLine int, err error) {\n    sc := bufio.NewScanner(r)\n    for sc.Scan() {\n        lastLine++\n        if lastLine == lineNum {\n            // you can return sc.Bytes() if you need output in []bytes\n            return sc.Text(), lastLine, sc.Err()\n        }\n    }\n    return line, lastLine, io.EOF\n}\n</code></pre>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4838, "favorite_count": 2, "accepted_answer_id": 30708912, "answer_count": 1, "score": 5, "last_activity_date": 1560863330, "creation_date": 1433679391, "last_edit_date": 1495539968, "question_id": 30693421, "link": "https://stackoverflow.com/questions/30693421/how-to-read-specific-line-of-file", "title": "How to read specific line of file?", "body": "<p>I need to read specific line of file. Some of related topics I've read: <a href=\"https://stackoverflow.com/questions/24562942/golang-how-do-i-determine-the-number-of-lines-in-a-file-efficiently\">golang: How do I determine the number of lines in a file efficiently?</a>, <a href=\"https://stackoverflow.com/questions/30692567/what-is-the-best-way-to-count-lines-in-file\">https://stackoverflow.com/questions/30692567/what-is-the-best-way-to-count-lines-in-file</a></p>\n\n<p>I've write the following function and it works as expected, but I have doubt: may be there is better (efficient) way?</p>\n\n<pre><code>func ReadLine(r io.Reader, lineNum int) (line string, lastLine int, err error) {\n    sc := bufio.NewScanner(r)\n    for sc.Scan() {\n        lastLine++\n        if lastLine == lineNum {\n            return sc.Text(), lastLine, sc.Err()\n        }\n    }\n    return line, lastLine, io.EOF\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "edited": false, "score": 0, "creation_date": 1433685119, "post_id": 30692977, "comment_id": 49446900, "body": "Why someone giving negative vote? Comment here if something wrong"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433695939, "post_id": 30692977, "comment_id": 49450267, "body": "W.Mar, often uncommitted downvotes are for the reason given on the down vote button &quot;hover text&quot;: &quot;This question does not show any research effort; it is unclear or not useful&quot;. At a guess, I&#39;d say a likely reason is that your question lacks clarity and makes no effort to have a <a href=\"http://stackoverflow.com/help/mcve\">MCVE (Minimal, Complete, and Verifiable example)</a>. <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433697715, "post_id": 30692977, "comment_id": 49450901, "body": "It is wrong. This question have research effort and clear about the problem I trying to solve. However, do I need to create new better question? This question has been stained with downvotes"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433698932, "post_id": 30692977, "comment_id": 49451328, "body": "&quot;stained with downvotes&quot; I&#39;m not sure you understand how <a href=\"https://stackoverflow.com\">Stack Overflow</a> works."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433699191, "post_id": 30692977, "comment_id": 49451411, "body": "&quot;do I need to create new better question&quot;. In my opinion, you should <a href=\"https://stackoverflow.com/posts/30692977/edit\">edit</a> this question to have a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> (i.e. without the needless template wrapping, with just static data rather than a database query, etc) and then ask a clear question with respect to that minimal example. To me, this question is completely unclear; you have two slices, I suppose one happens to have only one element, what is it you want the template to output??"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433704227, "post_id": 30692977, "comment_id": 49453057, "body": "Did you read <a href=\"http://stackoverflow.com/help/mcve\">mcve</a>? Your edit leaves your example not minimal, not complete, <i>and</i> not verifiable. I would expect something like <a href=\"https://play.golang.org/p/X3-eME61pH\" rel=\"nofollow noreferrer\">play.golang.org/p/X3-eME61pH</a>. That example is minimal (no extraneous/irrelevant db queries/files etc), it&#39;s complete (all the relevant data, templates, etc are included); and it&#39;s verifiable (it runs in isolation on the playground and presumably repeats whatever issue is being asked about) [That code of course would still need a problem statement and a specific question such as &quot;this code gives \u2026 but I want \u2026&quot;]."}, {"owner": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433728471, "post_id": 30692977, "comment_id": 49458679, "body": "Yes, I&#39;ve read MCVE. I cannot remove DB query because this is not single query. I have 2 different query and should know which one come from which query. If remove DB query, I need to explain the query too."}, {"owner": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433728659, "post_id": 30692977, "comment_id": 49458714, "body": "One question about the MCVE: If the code has been truncated here and there, how it can be verifiable?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433790463, "post_id": 30692977, "comment_id": 49491820, "body": "@DaveC: You are pushing it here. Yes, this is not the best formulated question ever, but instead of slapping him with rules and guidelines you can actually help him creating a better question. I see on your profile you are complaining about a serial downvoter. If your other responses are like this I think it is no wonder you attract that kind of aggression."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1433790759, "post_id": 30692977, "comment_id": 49491995, "body": "@W.Mar: The question is unclear because you post a snippet of code (good) that is way to specific (bad) for the purpose of showing what problem you have. I think what you want is a struct that has another struct one, and a slice of yet another struct. But by reading your question that is not clear (bad) thus the downvotes. So: try to formulate exactly what you want, and make the code as minimal as possible so we don&#39;t have to read through sql queries and templates if they are not related to the problem."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1433865390, "post_id": 30692977, "comment_id": 49530292, "body": "@RickyA &quot;slapping him with rules&quot;... WTF? I politely pointed out a possible reason for the downvotes, I then attempted to help them create a mvce that was answerable, even going so far as to provide an related example of mvce means. The OP&#39;s response wrt the database query indicates they clearly don&#39;t get it; at that point I gave up. If you want to waste your time on this question go ahead but don&#39;t berate me for attempting to help then cutting my loses."}], "answers": [{"tags": [], "owner": {"reputation": 506, "user_id": 3835333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c838f6bc14ea3297f3305aca42f8bf?s=128&d=identicon&r=PG&f=1", "display_name": "SkyeC", "link": "https://stackoverflow.com/users/3835333/skyec"}, "is_accepted": true, "score": 1, "last_activity_date": 1433859220, "creation_date": 1433859220, "answer_id": 30734603, "question_id": 30692977, "link": "https://stackoverflow.com/questions/30692977/golang-how-to-make-single-struct-works-together-with-multiple-structs/30734603#30734603", "title": "Golang - How to make single struct works together with multiple structs?", "body": "<p>I think the minimal change to your code to make this work would be the following.</p>\n\n<p>Change this:</p>\n\n<pre><code>    type Model struct {\n        Galleries    []Gallery\n        Idcontainers []Idcontainer\n    }\n    return c.Render(http.StatusOK, \"onlytestingtpl\", Model{\n        Galleries:    gallery,\n        Idcontainers: idcontainer,\n    })\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>    type Model struct {\n        Gallery    Gallery // you said that theres only a single gallery right?\n        Idcontainers []Idcontainer\n    }\n    return c.Render(http.StatusOK, \"onlytestingtpl\", Model{\n        Gallery:    gallery[0],\n        Idcontainers: idcontainer,\n    })\n</code></pre>\n\n<p>And then change your template to this:</p>\n\n<pre><code>{{define \"onlytestingtpl\"}}\n    {{.Gallery.Title}}&lt;br&gt;\n    {{.Gallery.Content}}\n\n    &lt;h1&gt;ID number:&lt;/h1&gt;\n    {{range .Idcontainers}}\n    &lt;a href='{{.Suri}}'&gt;{{.Stitle}}&lt;/a&gt;\n    {{end}}\n{{end}}\n</code></pre>\n\n<p>I've tried to mock up a simple example here: <a href=\"http://play.golang.org/p/uedcjXalEH\" rel=\"nofollow\">http://play.golang.org/p/uedcjXalEH</a></p>\n\n<p>Though you haven't asked for feedback on the code overall, I'll risk adding a few additional comments:</p>\n\n<ul>\n<li>Consider using * (pointers) to objects rather than making copies each time.</li>\n<li><p>Consider changing your initial <code>rows</code> to work something like this:</p>\n\n<pre><code>gallery := Gallery{}\nif !rows.Next() {\n    return rows.Err()\n}\nerr := rows.Scan(&amp;gallery.Title, &amp;gallery.Content)\n\n// anotherquery remains the same ...\n\nreturn c.Render(http.StatusOK, \"onlytestingtpl\", Model{\n    Gallery:    gallery,\n    Idcontainers: idcontainer,\n})\n</code></pre></li>\n<li>This is probably just example code but in production you'll need more error handling of course :)</li>\n</ul>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "accepted_answer_id": 30734603, "answer_count": 1, "score": -1, "last_activity_date": 1433859220, "creation_date": 1433676524, "last_edit_date": 1433729149, "question_id": 30692977, "link": "https://stackoverflow.com/questions/30692977/golang-how-to-make-single-struct-works-together-with-multiple-structs", "title": "Golang - How to make single struct works together with multiple structs?", "body": "<p>I want to make single struct works together with multiple structs.</p>\n\n<p>In below codes, first query (<code>rows</code>) should be single struct because it return single row, while the second query (<code>anotherquery</code>) should be multiple struct because it return 5 rows.</p>\n\n<p>Currently, what can I do is I make <code>rows</code> &amp; <code>anotherquery</code> as multiple struct.</p>\n\n<p><strong>Below is <code>server.go</code>:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"github.com/labstack/echo\"\n    _ \"github.com/lib/pq\"\n    \"html/template\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n)\n\ntype Gallery struct {\n    Title, Content string\n}\ntype Idcontainer struct {\n    Stitle, Suri string\n}\n\nfunc main() {\n    e := echo.New()\n\n    e.Get(\"/post/:uritext\", func(c *echo.Context) error {\n\n        rows, err := db.Query(\"SELECT title, content FROM gallery WHERE uri=$1\", c.Param(\"uritext\"))\n        anotherquery, err := db.Query(\"SELECT title AS stitle, uri AS suri FROM archive WHERE uri!=$1 LIMIT 5\", c.Param(\"uritext\"))\n\n        gallery := []Gallery{}\n        idcontainer := []Idcontainer{}\n\n        for rows.Next() {\n            g := Gallery{}\n            err := rows.Scan(&amp;g.Title, &amp;g.Content)\n\n            gallery = append(gallery, g)\n        }\n\n        for anotherquery.Next() {\n            g := Idcontainer{}\n            err := anotherquery.Scan(&amp;g.Stitle, &amp;g.Suri)\n\n            idcontainer = append(idcontainer, g)\n        }\n\n        type Model struct {\n            Galleries    []Gallery\n            Idcontainers []Idcontainer\n        }\n        return c.Render(http.StatusOK, \"onlytestingtpl\", Model{\n            Galleries:    gallery,\n            Idcontainers: idcontainer,\n        })\n    })\n\n    e.Run(\":4444\")\n}\n</code></pre>\n\n<p>Template:</p>\n\n<pre><code>{{define \"onlytestingtpl\"}}\n    {{.Title}}&lt;br&gt;\n    {{.Content}}\n\n    &lt;h1&gt;ID number:&lt;/h1&gt;\n    {{range .Idcontainers}}\n    &lt;a href='{{.Suri}}'&gt;{{.Stitle}}&lt;/a&gt;\n    {{end}}\n{{end}}\n</code></pre>\n"}, {"tags": ["go", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1433671341, "post_id": 30692168, "comment_id": 49443196, "body": "thank you. I tried to use c.Errors but it isnt suitable as the returned error &quot;json: cannot unmarshal string into Go value of type int64&quot; does not specify the field at fault.  Any tips on how to manually validate the POST data stored in the gin context?"}, {"owner": {"reputation": 86, "user_id": 3467081, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002165383183/picture?type=large", "display_name": "manucorporat", "link": "https://stackoverflow.com/users/3467081/manucorporat"}, "reply_to_user": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1433671919, "post_id": 30692168, "comment_id": 49443352, "body": "try the map[string]interface{} approach... it sucks that the standard library does not return a better error message."}], "tags": [], "owner": {"reputation": 86, "user_id": 3467081, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002165383183/picture?type=large", "display_name": "manucorporat", "link": "https://stackoverflow.com/users/3467081/manucorporat"}, "is_accepted": true, "score": 1, "last_activity_date": 1433671413, "last_edit_date": 1433671413, "creation_date": 1433670736, "answer_id": 30692168, "question_id": 30691905, "link": "https://stackoverflow.com/questions/30691905/determine-if-post-data-value-matches-struct-field-type/30692168#30692168", "title": "Determine if POST data value matches struct field type", "body": "<p>Gin has a built-in validation engine: <a href=\"https://github.com/bluesuncorp/validator/blob/v5/baked_in.go\" rel=\"nofollow\">https://github.com/bluesuncorp/validator/blob/v5/baked_in.go</a></p>\n\n<p>but you can use your own or disable it completely.</p>\n\n<p>The validator does not validate the wire data (json string), instead it validates the binded struct:</p>\n\n<pre><code>LearnMoreImage string `db:\"learn_more_image\" json:\"learn_more_image,omitempty\" binding:\"required\"`\nApiVersion     int64  `db:\"api_version\" json:\"api_version\" binding:\"required,min=1\"`\n</code></pre>\n\n<p>Notice this: binding:\"required,min=1\"</p>\n\n<p>Then:  </p>\n\n<pre><code>err := c.Bind(&amp;json)\n</code></pre>\n\n<p>or use a middleware and read <code>c.Errors</code>.</p>\n\n<p>UPDATED: </p>\n\n<p>Three workarounds:</p>\n\n<ul>\n<li>Validate the json string your own (it can not be done with enconding/json)</li>\n<li>Validate if integer is > 0 binding:\"min=1\"</li>\n<li><p>Use a map[string]interface{} instead of a Struct, then validate the type.</p>\n\n<pre><code>func endpoint(c *gin.Context) {\n    var json map[string]interface{}\n    c.Bind(&amp;json)\n    struct, ok := validateCreateApp(json)\n    if ok { /** DO SOMETHING */ }\n}\n\nfunc validateCreateApp(json map[string]interface{}) (CreateApp, bool) {\n    learn_more_image, ok := json[\"learn_more_image\"].(string)\n    if !ok {\n        return CreateApp{}, false\n    }\n    api_version, ok = json[\"api_version\"].(int)\n    if !ok {\n        return CreateApp{}, false\n    }\n    return CreateApp{\n        learn_more_image, api_version,\n    }\n}\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 0, "accepted_answer_id": 30692168, "answer_count": 1, "score": 1, "last_activity_date": 1434217288, "creation_date": 1433668762, "last_edit_date": 1434217288, "question_id": 30691905, "link": "https://stackoverflow.com/questions/30691905/determine-if-post-data-value-matches-struct-field-type", "title": "Determine if POST data value matches struct field type", "body": "<p>Using the gin framework I am trying to determine if POST'ed data does not match the struct field type and inform API user of their error.</p>\n\n<pre><code>type CreateApp struct {\n    LearnMoreImage string `db:\"learn_more_image\" json:\"learn_more_image,omitempty\" valid:\"string,omitempty\"`\n    ApiVersion     int64  `db:\"api_version\" json:\"api_version\" valid:\"int,omitempty\"`\n}\n...\nfunc CreateApps(c *gin.Context) {\n    var json models.CreateApp\n    c.Bind(&amp;json)\n</code></pre>\n\n<p>So when I POST</p>\n\n<pre><code>curl -H \"Content-Type: application/json\" -d '{\"learn_more_image\":\"someimage.jpg\",\"api_version\":\"somestring\"}' \"http://127.0.0.1:8080/v1.0/apps\"\n</code></pre>\n\n<p>I would like to determine whether the POST'ed data for field 'api_version' (passed as string) does not match the struct field it is being binded to (int). If the data doesnt match I'd like to send a message back to the user. Its for this reason I was hoping I could loop through the gin contexts data and check it.</p>\n\n<p>The gin function 'c.Bind()' seems to omit invalid data and all subsequent data fields with it.</p>\n"}, {"tags": ["go", "terminal"], "answers": [{"comments": [{"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 1, "creation_date": 1433666889, "post_id": 30690401, "comment_id": 49442169, "body": "I cannot install this library. <code>$ go get github.com&#47;carmark&#47;pseudo-terminal-go</code> outputs <code>package github.com&#47;carmark&#47;pseudo-terminal-go \timports terminal: unrecognized import path &quot;terminal&quot;</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1433707816, "post_id": 30690401, "comment_id": 49454191, "body": "@MaximYefremov I agree. It was more to give an example of code regarding the implementation of a terminal, and the fact it needs to be put in raw mode."}, {"owner": {"reputation": 395, "user_id": 733880, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1d9a1a77a93e3338a009e9b28b78cd7?s=128&d=identicon&r=PG", "display_name": "Stephen Smith", "link": "https://stackoverflow.com/users/733880/stephen-smith"}, "edited": false, "score": 0, "creation_date": 1436467322, "post_id": 30690401, "comment_id": 50637753, "body": "It works great, you have to import &quot;github.com/carmark/pseudo-terminal-go/terminal&quot;"}, {"owner": {"reputation": 769, "user_id": 6155692, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0e4ef26e040c1b1fbc5f10777e5b0649?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/6155692/zac"}, "edited": false, "score": 0, "creation_date": 1516544793, "post_id": 30690401, "comment_id": 83722196, "body": "This package doesn&#39;t allow you to type unicode characters"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 3, "last_activity_date": 1433655568, "last_edit_date": 1492086987, "creation_date": 1433655568, "answer_id": 30690401, "question_id": 30689640, "link": "https://stackoverflow.com/questions/30689640/cursor-key-terminal-input-in-go/30690401#30690401", "title": "Cursor key terminal input in Go", "body": "<p>A simpler example would be <a href=\"https://github.com/carmark/pseudo-terminal-go\" rel=\"nofollow noreferrer\"><code>carmark/pseudo-terminal-go</code></a>, where you can put a <a href=\"https://unix.stackexchange.com/questions/21752/what-s-the-difference-between-a-raw-and-a-cooked-device-driver\">terminal in raw mode</a> and benefit from the full up-down-left-right cursor moves.</p>\n\n<p>From <a href=\"https://github.com/carmark/pseudo-terminal-go/blob/master/terminal/terminal.go#L108-L112\" rel=\"nofollow noreferrer\"><code>terminal.go#NewTerminal()</code></a></p>\n\n<pre><code>// NewTerminal runs a VT100 terminal on the given ReadWriter. If the ReadWriter is\n// a local terminal, that terminal must first have been put into raw mode.\n// prompt is a string that is written at the start of each input line (i.e.\n// \"&gt; \").\nfunc NewTerminal(c io.ReadWriter, prompt string) *Terminal \n</code></pre>\n\n<p>See <a href=\"https://github.com/carmark/pseudo-terminal-go/blob/master/terminal/terminal.go\" rel=\"nofollow noreferrer\">terminal/terminal.go</a> and <a href=\"https://github.com/carmark/pseudo-terminal-go/blob/master/terminal/terminal_test.go\" rel=\"nofollow noreferrer\"><code>terminal/terminal_test.go</code></a>, as well as <a href=\"https://github.com/carmark/pseudo-terminal-go/blob/55c346b46a29c2728fed062bb52db3a76816ca83/terminal/util.go#L37-L54\" rel=\"nofollow noreferrer\"><code>MakeRaw()</code></a></p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2553, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1433694716, "creation_date": 1433645912, "last_edit_date": 1433694716, "question_id": 30689640, "link": "https://stackoverflow.com/questions/30689640/cursor-key-terminal-input-in-go", "title": "Cursor key terminal input in Go", "body": "<p>I am creating a Go application for usage in a terminal. The following  code asks a user to input text to the terminal.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    for {\n        fmt.Println(\"Please input something and use arrows to move along the text left and right\")\n        in := bufio.NewReader(os.Stdin)\n        _, err := in.ReadString('\\n')\n        if err != nil {\n            fmt.Println(err)\n        }\n    }\n}\n</code></pre>\n\n<p>The problem is that a user cannot use left and right arrows to go along the just inputted text in order to modify it. When he presses arrows, the console prints  <code>^[[D^[[C^[[A^[[B</code> signs. </p>\n\n<p>The output:</p>\n\n<pre><code>Please input something and use arrows to move along the text left and right\nhello^[[D^[[C^[[A^[[B\n</code></pre>\n\n<p>How to make arrow keys behave more user-friendly and let a human navigate along the just inputted text, using left and right arrows? </p>\n\n<p>I guess, I should pay attention to libraries like <a href=\"http://godoc.org/github.com/nsf/termbox-go\" rel=\"nofollow noreferrer\">termbox-go</a> or <a href=\"https://github.com/jroimartin/gocui\" rel=\"nofollow noreferrer\">gocui</a>  but how to use them exactly for this purpose, I do not know.</p>\n"}, {"tags": ["unit-testing", "testing", "tcp", "go"], "comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 1, "creation_date": 1433651506, "post_id": 30688685, "comment_id": 49439254, "body": "Suggest reading the source for the tests for the actual <code>net</code> library. I have picked up plenty of tips by doing that in the past.  Secondly as you have already mentioned use the <code>httptest</code> package."}, {"owner": {"reputation": 881, "user_id": 276186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5627ef10f7577e6994bc424aa830f2?s=128&d=identicon&r=PG", "display_name": "PerroVerd", "link": "https://stackoverflow.com/users/276186/perroverd"}, "edited": false, "score": 0, "creation_date": 1434443609, "post_id": 30688685, "comment_id": 49767268, "body": "There are several libraries for <i>mocking</i> in unit testing, take a look at this post for hints <a href=\"http://stackoverflow.com/questions/19167970/mock-functions-in-golang\" title=\"mock functions in golang\">stackoverflow.com/questions/19167970/mock-functions-in-golan&zwnj;&#8203;g</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12015, "user_id": 1189328, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/830718c43e6fa5f1dba492b1c05426a9?s=128&d=identicon&r=PG", "display_name": "I&#241;igo", "link": "https://stackoverflow.com/users/1189328/i%c3%b1igo"}, "is_accepted": true, "score": 12, "last_activity_date": 1434376039, "last_edit_date": 1434376039, "creation_date": 1434350621, "answer_id": 30838807, "question_id": 30688685, "link": "https://stackoverflow.com/questions/30688685/how-does-one-test-net-conn-in-unit-tests-in-golang/30838807#30838807", "title": "How does one test net.Conn in unit tests in Golang?", "body": "<p>Although it will depend on the implementation details of your particular case, the general approach will be to start a server (in a separate goroutine, as you already hinted), and listen to the incoming connections. </p>\n\n<p>For example, let's spin up a server and verify that the content we are reading from the connection is indeed the one we send over from the client:</p>\n\n<pre><code>func TestConn(t *testing.T) {\n    message := \"Hi there!\\n\"\n\n    go func() {\n        conn, err := net.Dial(\"tcp\", \":3000\")\n        if err != nil {\n            t.Fatal(err)\n        }\n        defer conn.Close()\n\n        if _, err := fmt.Fprintf(conn, message); err != nil {\n            t.Fatal(err)\n        }\n    }()\n\n    l, err := net.Listen(\"tcp\", \":3000\")\n    if err != nil {\n        t.Fatal(err)\n    }\n    defer l.Close()\n    for {\n        conn, err := l.Accept()\n        if err != nil {\n            return\n        }\n        defer conn.Close()\n\n        buf, err := ioutil.ReadAll(conn)\n        if err != nil {\n            t.Fatal(err)\n        }\n\n        fmt.Println(string(buf[:]))\n        if msg := string(buf[:]); msg != message {\n            t.Fatalf(\"Unexpected message:\\nGot:\\t\\t%s\\nExpected:\\t%s\\n\", msg, message)\n        }\n        return // Done\n    }\n\n}\n</code></pre>\n\n<p>Note that here I'm not starting the server in the goroutine, as otherwise the test case is likely to be finished before the listener has run the test.</p>\n"}, {"comments": [{"owner": {"reputation": 2151, "user_id": 414544, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3b393a43f087897332658031daefda1?s=128&d=identicon&r=PG&f=1", "display_name": "luben", "link": "https://stackoverflow.com/users/414544/luben"}, "edited": false, "score": 11, "creation_date": 1491051767, "post_id": 41668611, "comment_id": 73389672, "body": "This is the greatest answer for testing tcp connections without starting a server. Should be the accepted or at least more up-voted answer imho. Thank you!"}, {"owner": {"reputation": 4687, "user_id": 2176740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c09c0ea83bcb343688502045304a0474?s=128&d=identicon&r=PG", "display_name": "joonas.fi", "link": "https://stackoverflow.com/users/2176740/joonas-fi"}, "edited": false, "score": 0, "creation_date": 1512467691, "post_id": 41668611, "comment_id": 82259448, "body": "Yes, this is genius! You don&#39;t need the overhead of actually using TCP. You could in theory parallelize your tests running by using this design, since it does not reserve global ports from the oprating system."}, {"owner": {"reputation": 1355, "user_id": 48140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IX05X.jpg?s=128&g=1", "display_name": "Tomasz Elendt", "link": "https://stackoverflow.com/users/48140/tomasz-elendt"}, "edited": false, "score": 1, "creation_date": 1537523820, "post_id": 41668611, "comment_id": 91825034, "body": "You may also look at &quot;google.golang.org/grpc/test/bufconn&quot; - it implements in-memory net.Listener in net.Dialer where connections are &quot;pipes&quot;, but unlike net.Pipe they are also buffered which makes them easier to use in some situations."}, {"owner": {"reputation": 1071, "user_id": 241993, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zfpeC.jpg?s=128&g=1", "display_name": "Mohamed Bana", "link": "https://stackoverflow.com/users/241993/mohamed-bana"}, "edited": false, "score": 3, "creation_date": 1551735854, "post_id": 41668611, "comment_id": 96741407, "body": "Can you give an example of how you would test a WebSocket connection (gorilla) in this example with this approach, please."}, {"owner": {"reputation": 21022, "user_id": 348081, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fc6e3adc850c07248a46aaadc05fa59b?s=128&d=identicon&r=PG", "display_name": "JuanPablo", "link": "https://stackoverflow.com/users/348081/juanpablo"}, "edited": false, "score": 1, "creation_date": 1604605272, "post_id": 41668611, "comment_id": 114405482, "body": "an example related to <code>net.pipe</code> <a href=\"https://stackoverflow.com/questions/36932741/how-can-i-properly-write-the-read-and-write-the-net-pipe\" title=\"how can i properly write the read and write the net pipe\">stackoverflow.com/questions/36932741/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1001, "user_id": 7423351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f2343e38b7bc49ece379af0dee650b?s=128&d=identicon&r=PG&f=1", "display_name": "Freman", "link": "https://stackoverflow.com/users/7423351/freman"}, "is_accepted": false, "score": 100, "last_activity_date": 1484533529, "creation_date": 1484533529, "answer_id": 41668611, "question_id": 30688685, "link": "https://stackoverflow.com/questions/30688685/how-does-one-test-net-conn-in-unit-tests-in-golang/41668611#41668611", "title": "How does one test net.Conn in unit tests in Golang?", "body": "<p>You might be able to do what you need with <a href=\"https://golang.org/pkg/net/#Pipe\" rel=\"noreferrer\">net.Pipe</a> which basically gives you both ends of a connection (think, after .Accept())</p>\n\n<pre><code>server, client := net.Pipe()\ngo func() {\n  // Do some stuff\n  server.Close()\n}()\n\n// Do some stuff\nclient.Close()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3433, "user_id": 1766065, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a693ccc173e95b983371c444b86edc82?s=128&d=identicon&r=PG", "display_name": "Jens D", "link": "https://stackoverflow.com/users/1766065/jens-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1532826305, "creation_date": 1532826305, "answer_id": 51576419, "question_id": 30688685, "link": "https://stackoverflow.com/questions/30688685/how-does-one-test-net-conn-in-unit-tests-in-golang/51576419#51576419", "title": "How does one test net.Conn in unit tests in Golang?", "body": "<p>Another option is the <a href=\"https://github.com/maxbrunsfeld/counterfeiter\" rel=\"nofollow noreferrer\">counterfeiter</a> package which lets you create mocks from interfaces and then you can stub out whatever calls you need. I have used it with great success to stub out <code>net.Conn</code> instances where I am testing out a protobuf client for <a href=\"https://github.com/gemfire/geode-go-client\" rel=\"nofollow noreferrer\">Geode</a>.</p>\n\n<p>For example - <a href=\"https://github.com/gemfire/geode-go-client/blob/master/connector/protobuf_test.go\" rel=\"nofollow noreferrer\">https://github.com/gemfire/geode-go-client/blob/master/connector/protobuf_test.go</a></p>\n"}], "owner": {"reputation": 7245, "user_id": 953732, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8115344be80362b14eb47e29c44c61e?s=128&d=identicon&r=PG", "display_name": "ThePiachu", "link": "https://stackoverflow.com/users/953732/thepiachu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15611, "favorite_count": 4, "accepted_answer_id": 30838807, "answer_count": 3, "score": 22, "last_activity_date": 1532826305, "creation_date": 1433634553, "question_id": 30688685, "link": "https://stackoverflow.com/questions/30688685/how-does-one-test-net-conn-in-unit-tests-in-golang", "title": "How does one test net.Conn in unit tests in Golang?", "body": "<p>I'm currently looking into creating some unit tests for net.Conn interface in Go, as well as other functions that build up on top of that functionality, and I'm wondering what is the best way to unit test that in Google Go? My code looks like:</p>\n\n<pre><code>conn, _:=net.Dial(\"tcp\", \"127.0.0.1:8080\")\n...\nfmt.Fprintf(conn, \"test\")\n...\nbuffer:=make([]byte, 100)\nconn.Read(buffer)\n</code></pre>\n\n<p>Is the most efficient way of testing this code and the code that uses these functions to spin up a separate goroutine to act like the server, use <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"noreferrer\">net.http.httptest package</a>, or something else?</p>\n"}, {"tags": ["testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 7, "creation_date": 1433695165, "post_id": 30688577, "comment_id": 49450025, "body": "&quot;Cannot&quot; is a bit strong; but I&#39;ll agree with &quot;should not&quot;. If you want to test a failure condition of a (non-main) block of code then don&#39;t use <code>log.Fatal</code> for that code but return an <code>error</code> instead (i.e. if failure is an option have an API that represents that). In the vast majority of cases <code>log.Fatal</code> should be only be used in <code>main</code>, or <code>init</code> functions (or possibly some things meant to be called only directly from them)."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1484606807, "post_id": 30688577, "comment_id": 70569627, "body": "in a complicated distributed system there are scenarios where my code cannot perform its task, for example a database went down or configuration is missing. i prefer to Fatal here, first to avoid executing with indeterminate program state and second to ensure i get a monitoring alert"}, {"owner": {"reputation": 456, "user_id": 2700497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cfd59dac2900ad8a5bfff5c52fe6949?s=128&d=identicon&r=PG&f=1", "display_name": "MithunS", "link": "https://stackoverflow.com/users/2700497/mithuns"}, "edited": false, "score": 0, "creation_date": 1577831042, "post_id": 30688577, "comment_id": 105266695, "body": "Agree halfway, it is not really necessary to have 100% code coverage, here the question at hand is more about how to go about unit testing when you have <code>log.fatal</code> in your code."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1433633306, "creation_date": 1433633306, "answer_id": 30688577, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal/30688577#30688577", "title": "How to test Go function containing log.Fatal()", "body": "<p>You cannot and you should not.\nThis \"you must 'test' each and every line\"-attitude is strange, especially for terminal conditions and that's what log.Fatal is for.\n(Or just test it from the outside.)</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 16, "last_activity_date": 1433656887, "last_edit_date": 1495539988, "creation_date": 1433656887, "answer_id": 30690532, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal/30690532#30690532", "title": "How to test Go function containing log.Fatal()", "body": "<p>This is similar to \"<a href=\"https://stackoverflow.com/a/26226382/6309\">How to test <code>os.Exit()</code> scenarios in Go</a>\": you need to implement your own logger, which by default redirect to <code>log.xxx()</code>, but gives you the opportunity, when testing, to replace a function like <code>log.Fatalf()</code> with your own (which does not call <code>os.Exit(1)</code>)</p>\n\n<p>I did the same for testing <code>os.Exit()</code> calls in <a href=\"https://github.com/VonC/godbg/blob/master/exit/exit.go\" rel=\"noreferrer\"><code>exit/exit.go</code></a>:</p>\n\n<pre><code>exiter = New(func(int) {})\nexiter.Exit(3)\nSo(exiter.Status(), ShouldEqual, 3)\n</code></pre>\n\n<p>(here, my \"exit\" function is an empty one which does nothing)</p>\n"}, {"comments": [{"owner": {"reputation": 1441, "user_id": 3794466, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/AHnsk.png?s=128&g=1", "display_name": "Bernie Lenz", "link": "https://stackoverflow.com/users/3794466/bernie-lenz"}, "edited": false, "score": 0, "creation_date": 1617893168, "post_id": 39817424, "comment_id": 118441724, "body": "Neat approach. The only catch with this is that you might encounter different errors in between calling logFatalf and when you check for &quot;len(errors) != 1&quot; as your code may now be in an invalid state after logFatalf but continues to run instead of aborting."}], "tags": [], "owner": {"reputation": 1584, "user_id": 211438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc1fb93b959c0d838bf6a900306d9b9?s=128&d=identicon&r=PG", "display_name": "clsung", "link": "https://stackoverflow.com/users/211438/clsung"}, "is_accepted": false, "score": 9, "last_activity_date": 1549480359, "last_edit_date": 1549480359, "creation_date": 1475414218, "answer_id": 39817424, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal/39817424#39817424", "title": "How to test Go function containing log.Fatal()", "body": "<p>I have using the following code to test my function. In xxx.go:</p>\n\n<pre><code>var logFatalf = log.Fatalf\n\nif err != nil {\n    logFatalf(\"failed to init launcher, err:%v\", err)\n}\n</code></pre>\n\n<p>And in xxx_test.go:</p>\n\n<pre><code>// TestFatal is used to do tests which are supposed to be fatal\nfunc TestFatal(t *testing.T) {\n    origLogFatalf := logFatalf\n\n    // After this test, replace the original fatal function\n    defer func() { logFatalf = origLogFatalf } ()\n\n    errors := []string{}\n    logFatalf = func(format string, args ...interface{}) {\n        if len(args) &gt; 0 {\n            errors = append(errors, fmt.Sprintf(format, args))\n        } else {\n            errors = append(errors, format)\n        }\n    }\n    if len(errors) != 1 {\n        t.Errorf(\"excepted one error, actual %v\", len(errors))\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6354, "user_id": 4258430, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a2d5075177b2ff473c38f6d8fb64894?s=128&d=identicon&r=PG", "display_name": "Allen Luce", "link": "https://stackoverflow.com/users/4258430/allen-luce"}, "is_accepted": false, "score": 6, "last_activity_date": 1501266320, "creation_date": 1501266320, "answer_id": 45380105, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal/45380105#45380105", "title": "How to test Go function containing log.Fatal()", "body": "<p>I'd use the supremely handy <a href=\"https://github.com/bouk/monkey\" rel=\"noreferrer\">bouk/monkey</a> package (here along with <a href=\"https://github.com/stretchr/testify\" rel=\"noreferrer\">stretchr/testify</a>).</p>\n\n<pre><code>func TestGoodby(t *testing.T) {\n  wantMsg := \"Goodbye!\"\n\n  fakeLogFatal := func(msg ...interface{}) {\n    assert.Equal(t, wantMsg, msg[0])\n    panic(\"log.Fatal called\")\n  }\n  patch := monkey.Patch(log.Fatal, fakeLogFatal)\n  defer patch.Unpatch()\n  assert.PanicsWithValue(t, \"log.Fatal called\", goodbye, \"log.Fatal was not called\")\n}\n</code></pre>\n\n<p>I advise reading the <a href=\"https://github.com/bouk/monkey#notes\" rel=\"noreferrer\">caveats to using bouk/monkey</a> before going this route.</p>\n"}, {"tags": [], "owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "is_accepted": false, "score": 11, "last_activity_date": 1508466343, "creation_date": 1508466343, "answer_id": 46841524, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal/46841524#46841524", "title": "How to test Go function containing log.Fatal()", "body": "<p>While it's possible to test code that contains log.Fatal, it is not recommended. In particular you cannot test that code in a way that is supported by the <code>-cover</code> flag on <code>go test</code>.</p>\n\n<p>Instead it is recommended that you change your code to return an error instead of calling log.Fatal. In a sequential function you can add an additional return value, and in a goroutine you can pass an error on a channel of type <code>chan error</code> (or some struct type containing a field of type error).</p>\n\n<p>Once that change is made your code will be much easier to read, much easier to test, and it will be more portable (now you can use it in a server program in addition to command line tools).</p>\n\n<p>If you have <code>log.Println</code> calls I also recommend passing a custom logger as a field on a receiver. That way you can log to the custom logger, which you can set to stderr or stdout for a server, and a noop logger for tests (so you don't get a bunch of unnecessary output in your tests). The <code>log</code> package supports custom loggers, so there's no need to write your own or import a third party package for this.</p>\n"}, {"comments": [{"owner": {"reputation": 2113, "user_id": 1896328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7OqqP.jpg?s=128&g=1", "display_name": "voutasaurus", "link": "https://stackoverflow.com/users/1896328/voutasaurus"}, "edited": false, "score": 0, "creation_date": 1530653841, "post_id": 49314170, "comment_id": 89309523, "body": "Hey Plato, the answer you&#39;re referring to was my first answer. I removed it because I think it was encouraging people to be clever and also because somebody pointed out that it breaks the -cover flag, which is a fair point. Sorry I broke your reference. btw Andrew&#39;s slide is here and it contains all the relevant info: <a href=\"https://talks.golang.org/2014/testing.slide#23\" rel=\"nofollow noreferrer\">talks.golang.org/2014/testing.slide#23</a>"}], "tags": [], "owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "is_accepted": false, "score": 2, "last_activity_date": 1521180297, "creation_date": 1521180297, "answer_id": 49314170, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal/49314170#49314170", "title": "How to test Go function containing log.Fatal()", "body": "<p>There used to be an answer here that I referred to, looks like it got deleted. It was the only one I've seen where you could have passing tests without modifying dependencies or otherwise touching the code that should Fatal. </p>\n\n<p>I agree with other answers that this is usually an inappropriate test. Usually you should rewrite the code under test to return an error, test the error is returned as expected, and Fatal at a higher level scope after observing the non-nil error.</p>\n\n<p>To OP's question of testing that the that the correct messages have been logged, you would inspect inner process's <code>cmd.Stdout</code>.</p>\n\n<p><a href=\"https://play.golang.org/p/J8aiO9_NoYS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/J8aiO9_NoYS</a></p>\n\n<pre><code>func TestFooFatals(t *testing.T) {\n    fmt.Println(\"TestFooFatals\")\n    outer := os.Getenv(\"FATAL_TESTING\") == \"\"\n    if outer {\n        fmt.Println(\"Outer process: Spawning inner `go test` process, looking for failure from fatal\")\n        cmd := exec.Command(os.Args[0], \"-test.run=TestFooFatals\")\n        cmd.Env = append(os.Environ(), \"FATAL_TESTING=1\")\n        // cmd.Stdout, cmd.Stderr = os.Stdout, os.Stderr\n        err := cmd.Run()\n        fmt.Printf(\"Outer process: Inner process returned %v\\n\", err)\n        if e, ok := err.(*exec.ExitError); ok &amp;&amp; !e.Success() {\n            // fmt.Println(\"Success: inner process returned 1, passing test\")\n            return\n        }\n        t.Fatalf(\"Failure: inner function returned %v, want exit status 1\", err)\n    } else {\n        // We're in the spawned process.\n        // Do something that should fatal so this test fails.\n        foo()\n    }\n}\n\n// should fatal every time\nfunc foo() {\n    log.Printf(\"oh my goodness, i see %q\\n\", os.Getenv(\"FATAL_TESTING\"))\n    // log.Fatal(\"oh my gosh\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1041, "user_id": 6150999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dKcy6.png?s=128&g=1", "display_name": "Poh Zi How", "link": "https://stackoverflow.com/users/6150999/poh-zi-how"}, "is_accepted": false, "score": 7, "last_activity_date": 1547784492, "creation_date": 1547784492, "answer_id": 54247636, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal/54247636#54247636", "title": "How to test Go function containing log.Fatal()", "body": "<p>If you're using <a href=\"https://github.com/sirupsen/logrus\" rel=\"noreferrer\">logrus</a>, there's now an option to define your exit function from v1.3.0 introduced in <a href=\"https://github.com/sirupsen/logrus/commit/458213699411cdceb6fd839a3178be49c01fba54\" rel=\"noreferrer\">this commit</a>. So your test may look something like:</p>\n\n<pre><code>func Test_X(t *testing.T) {\n    cases := []struct{\n        param string\n        expectFatal bool\n    }{\n        {\n            param: \"valid\",\n            expectFatal: false,\n        },\n        {\n            param: \"invalid\",\n            expectFatal: true,\n        },\n    }\n\n    defer func() { log.StandardLogger().ExitFunc = nil }()\n    var fatal bool\n    log.StandardLogger().ExitFunc = func(int){ fatal = true }\n\n    for _, c := range cases {\n        fatal = false\n        X(c.param)\n        assert.Equal(t, c.expectFatal, fatal)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5689, "user_id": 2600638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ypdy0.jpg?s=128&g=1", "display_name": "Jose Alban", "link": "https://stackoverflow.com/users/2600638/jose-alban"}, "is_accepted": false, "score": 1, "last_activity_date": 1605627058, "creation_date": 1605627058, "answer_id": 64878263, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal/64878263#64878263", "title": "How to test Go function containing log.Fatal()", "body": "<p>I've combined answers from different sources to produce this:</p>\n<pre><code>import (\n    &quot;bufio&quot;\n    &quot;bytes&quot;\n    &quot;errors&quot;\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;log&quot;\n    &quot;os&quot;\n    &quot;os/exec&quot;\n    &quot;os/user&quot;\n    &quot;strings&quot;\n    &quot;testing&quot;\n\n    &quot;bou.ke/monkey&quot;\n    &quot;github.com/stretchr/testify/assert&quot;\n    &quot;github.com/stretchr/testify/mock&quot;\n    &quot;github.com/stretchr/testify/require&quot;\n)\n\n\nfunc TestCommandThatErrors(t *testing.T) {\n    fakeExit := func(int) {\n        panic(&quot;os.Exit called&quot;)\n    }\n    patch := monkey.Patch(os.Exit, fakeExit)\n    defer patch.Unpatch()\n\n    var buf bytes.Buffer\n    log.SetOutput(&amp;buf)\n\n    for _, tc := range []struct {\n        cliArgs       []string\n        expectedError string\n    }{\n        {\n            cliArgs:       []string{&quot;dev&quot;, &quot;api&quot;, &quot;--dockerless&quot;},\n            expectedError: &quot;Some services don't have dockerless variants implemented yet.&quot;,\n        },\n    } {\n        t.Run(strings.Join(tc.cliArgs, &quot; &quot;), func(t *testing.T) {\n            harness := createTestApp()\n            for _, cmd := range commands {\n                cmd(harness.app)\n            }\n\n            assert.Panics(t, func() { harness.app.run(tc.cliArgs) })\n            assert.Contains(t, buf.String(), tc.expectedError)\n            buf.Reset()\n        })\n    }\n}\n</code></pre>\n<p>Works great :)</p>\n"}], "owner": {"reputation": 1740, "user_id": 598929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5187279a8111c09cb5960e47fdc03a8?s=128&d=identicon&r=PG", "display_name": "andrewsomething", "link": "https://stackoverflow.com/users/598929/andrewsomething"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19765, "favorite_count": 5, "accepted_answer_id": 30690532, "answer_count": 8, "score": 30, "last_activity_date": 1605627058, "creation_date": 1433633071, "question_id": 30688554, "link": "https://stackoverflow.com/questions/30688554/how-to-test-go-function-containing-log-fatal", "title": "How to test Go function containing log.Fatal()", "body": "<p>Say, I had the following code that prints some log messages. How would I go about testing that the correct messages have been logged? As <code>log.Fatal</code> calls <code>os.Exit(1)</code> the tests fail.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\nfunc hello() {\n    log.Print(\"Hello!\")\n}\n\nfunc goodbye() {\n    log.Fatal(\"Goodbye!\")\n}\n\nfunc init() {\n    log.SetFlags(0)\n}\n\nfunc main() {\n    hello()\n    goodbye()\n}\n</code></pre>\n\n<p>Here are the hypothetical tests:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"log\"\n    \"testing\"\n)\n\n\nfunc TestHello(t *testing.T) {\n    var buf bytes.Buffer\n    log.SetOutput(&amp;buf)\n\n    hello()\n\n    wantMsg := \"Hello!\\n\"\n    msg := buf.String()\n    if msg != wantMsg {\n        t.Errorf(\"%#v, wanted %#v\", msg, wantMsg)\n    }\n}\n\nfunc TestGoodby(t *testing.T) {\n    var buf bytes.Buffer\n    log.SetOutput(&amp;buf)\n\n    goodbye()\n\n    wantMsg := \"Goodbye!\\n\"\n    msg := buf.String()\n    if msg != wantMsg {\n        t.Errorf(\"%#v, wanted %#v\", msg, wantMsg)\n    }\n}\n</code></pre>\n"}, {"tags": ["reflection", "go", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 423, "user_id": 3435329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ek5Ff.jpg?s=128&g=1", "display_name": "DLopes", "link": "https://stackoverflow.com/users/3435329/dlopes"}, "edited": false, "score": 0, "creation_date": 1433633511, "post_id": 30688564, "comment_id": 49436503, "body": "Thanks, Volker. Works perfectly!"}, {"owner": {"reputation": 461, "user_id": 4816776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SgfL2.jpg?s=128&g=1", "display_name": "Nikolay Bystritskiy", "link": "https://stackoverflow.com/users/4816776/nikolay-bystritskiy"}, "edited": false, "score": 0, "creation_date": 1490348154, "post_id": 30688564, "comment_id": 73081863, "body": "@Volker could you please explain what is happening inside TypeOf ((*error)(nil)) ?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1490349374, "post_id": 30688564, "comment_id": 73082618, "body": "<code>nil</code> is a literal nil. <code>sometype(nil)</code> is a type conversion of nil to a nil sometype. <code>(*error)(nil)</code> produces a nil *error from which we can take the type via TypeOf. Going back to the error interface is done via Elem."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 16, "last_activity_date": 1433633177, "creation_date": 1433633177, "answer_id": 30688564, "question_id": 30688514, "link": "https://stackoverflow.com/questions/30688514/go-reflect-how-to-check-whether-reflect-type-is-an-error-type/30688564#30688564", "title": "Go reflect. How to check whether reflect.Type is an error type?", "body": "<p>In Go <code>error</code> is not something special. <code>error</code> is just a predeclared interface type so it doesn't have its own Kind in reflect.\nTry something along:</p>\n\n<pre><code>errorInterface  := reflect.TypeOf((*error)(nil)).Elem()\n...\ncase reflect.Interface:\n    if typOute.Implements(errorInterface)  // it's an error\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "is_accepted": false, "score": -1, "last_activity_date": 1471170517, "creation_date": 1471170517, "answer_id": 38941327, "question_id": 30688514, "link": "https://stackoverflow.com/questions/30688514/go-reflect-how-to-check-whether-reflect-type-is-an-error-type/38941327#38941327", "title": "Go reflect. How to check whether reflect.Type is an error type?", "body": "<p>You could also just use the type's name.</p>\n"}, {"tags": [], "owner": {"reputation": 2005, "user_id": 292382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1273e01f22fc4ee1f2b29587c37a294e?s=128&d=identicon&r=PG", "display_name": "antichris", "link": "https://stackoverflow.com/users/292382/antichris"}, "is_accepted": false, "score": 0, "last_activity_date": 1597923018, "creation_date": 1597923018, "answer_id": 63504096, "question_id": 30688514, "link": "https://stackoverflow.com/questions/30688514/go-reflect-how-to-check-whether-reflect-type-is-an-error-type/63504096#63504096", "title": "Go reflect. How to check whether reflect.Type is an error type?", "body": "<p>Create a new value of the reflected type and do a type assertion:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>...\ndefault:\n    typeOutValue := reflect.New(typeOut)\n\n    if _, ok := typeOutValue.Interface().(*error); ok {\n        defaultValues[i] = typeOutValue.Elem()\n    } else {\n        fmt.Println(&quot;type of return index &quot;, i, &quot; was not identified&quot;)\n    }\n}\n</code></pre>\n<p>or <code>switch</code> on its interface type:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>...\ndefault:\n    typeOutValue := reflect.New(typeOut)\n\n    switch typeOutValue.Interface().(type) {\n    case *error:\n        defaultValues[i] = typeOutValue.Elem()\n    default:\n        fmt.Println(&quot;type of return index &quot;, i, &quot; was not identified&quot;)\n    }\n</code></pre>\n<p>This way you can handle also any other interface type that you can (and want to) be particular about, with a more idiomatic Go code and reduced reliance on (or, at least, calls into) the <code>reflect</code> package (overhead and all that).</p>\n"}], "owner": {"reputation": 423, "user_id": 3435329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ek5Ff.jpg?s=128&g=1", "display_name": "DLopes", "link": "https://stackoverflow.com/users/3435329/dlopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6042, "favorite_count": 2, "accepted_answer_id": 30688564, "answer_count": 3, "score": 7, "last_activity_date": 1597923018, "creation_date": 1433632603, "question_id": 30688514, "link": "https://stackoverflow.com/questions/30688514/go-reflect-how-to-check-whether-reflect-type-is-an-error-type", "title": "Go reflect. How to check whether reflect.Type is an error type?", "body": "<p>I need to assuredly check whether a reflect.Type is an error. </p>\n\n<p>There is no reflect kind for error. What is the formal/idiomatic manner to check for type error in go reflect?</p>\n\n<p><a href=\"http://play.golang.org/p/JbECG4dvAm\" rel=\"noreferrer\">Go Playground Full Example</a></p>\n\n<pre><code>//return map of default values, based on each return type of a function\n// error  =&gt; err=nil\n// bool   =&gt; true\n// struct =&gt; new struct\nfunc getDefaultValue(originalFunction interface{}) map[int]reflect.Value {\n    defaultValues := make(map[int]reflect.Value)\n\n    typeOfFunc := reflect.ValueOf(originalFunction).Type()\n\n    numOut := typeOfFunc.NumOut() //number of function returns\n\n    for i := 0; i &lt; numOut; i++ {\n\n        typeOut := typeOfFunc.Out(i) // type of return for index i\n        switch typeOut.Kind() {\n\n        case reflect.Bool:\n            defaultValues[i] = reflect.ValueOf(true)\n\n        case reflect.Struct:\n            defaultValues[i] = reflect.New(typeOut()).Elem()\n\n        // --&gt; How to identify reflect.Type error assuredly, using switch or if...\n        //case reflect.error: //don't exists\n        //  var err error = nil\n        //  defaultValues[i] = reflect.ValueOf(&amp;err).Elem()\n\n        default:\n            //var err error = nil\n            //defaultValues[i] = reflect.ValueOf(&amp;err).Elem()\n            fmt.Println(\"type of return index \", i, \" was not identified\")\n\n        }\n\n        fmt.Println(\"type of return index \", i, typeOut, \"kind\", typeOut.Kind(), \"assign to err \", typeOut.AssignableTo(reflect.TypeOf(errors.New(\"\"))))\n    }\n\n    return defaultValues\n}\n</code></pre>\n"}, {"tags": ["json", "curl", "struct", "go", "nested"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4906948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6484d7c4e87b44d13a9a6260f86bf0a2?s=128&d=identicon&r=PG&f=1", "display_name": "TinuC", "link": "https://stackoverflow.com/users/4906948/tinuc"}, "edited": false, "score": 0, "creation_date": 1433649544, "post_id": 30687368, "comment_id": 49438971, "body": "Strange, I thought I had tried that already.  It did work this time though.  Thanks!"}], "tags": [], "owner": {"reputation": 14776, "user_id": 507423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ecee09b51d6a3d476e100119299fd01b?s=128&d=identicon&r=PG", "display_name": "lukad", "link": "https://stackoverflow.com/users/507423/lukad"}, "is_accepted": true, "score": 4, "last_activity_date": 1433625260, "last_edit_date": 1433625260, "creation_date": 1433623180, "answer_id": 30687368, "question_id": 30687000, "link": "https://stackoverflow.com/questions/30687000/golang-decode-nested-json-into-nested-struct/30687368#30687368", "title": "Golang Decode Nested JSON into Nested Struct", "body": "<p><code>Nest</code> is <a href=\"http://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">embedded</a> in <code>Input</code>.</p>\n\n<p>The JSON <code>{\"value1\":\"test\", \"value2\":\"Somevalue\", \"value3\":\"othervalue\", \"ID\": \"12345\"}</code> will be correctly marshalled into your <code>Input</code>.</p>\n\n<p>If you want to use the JSON body from your Question then you will have to change <code>Input</code> to the following</p>\n\n<pre><code>type Input struct {\n    Value1   string\n    Value2   string\n    Value3   string\n    Value4   string\n    Nest     Nest    \n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4906948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6484d7c4e87b44d13a9a6260f86bf0a2?s=128&d=identicon&r=PG&f=1", "display_name": "TinuC", "link": "https://stackoverflow.com/users/4906948/tinuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 0, "accepted_answer_id": 30687368, "answer_count": 1, "score": 1, "last_activity_date": 1542533466, "creation_date": 1433620695, "last_edit_date": 1542533466, "question_id": 30687000, "link": "https://stackoverflow.com/questions/30687000/golang-decode-nested-json-into-nested-struct", "title": "Golang Decode Nested JSON into Nested Struct", "body": "<p>Lets look at the following code snippet:</p>\n\n<pre><code>type Input struct {\n    Value1   string\n    Value2   string\n    Value3   string\n    Value4   string\n    Nest         \n}\n\ntype Nest struct {\n    ID  string\n}\ninput := &amp;Input{}\ndecoder := json.NewDecoder(r.Body)\nif err := decoder.Decode(&amp;input); err != nil {\n    fmt.Printf(\"something went wrong %v\", err)\n}\nfmt.Printf(\"Json Input = %+v\\n\", input)\n</code></pre>\n\n<p>I'm sending the following via <em>cURL</em>:</p>\n\n<pre><code>curl -k -vvv  -X POST -d '{\"value1\":\"test\", \"value2\":\"Somevalue\", \"value3\":\"othervalue\", \"Nest\":{\"ID\": \"12345\"}}' http://localhost:8000/endpoint\n</code></pre>\n\n<p>.. and get the following output:</p>\n\n<pre><code>{Value1:test Value2:Somevalue Value3:othervalue Value4: Nest:{ID:}}\n</code></pre>\n\n<p><strong>Problem:</strong></p>\n\n<p>I'm not getting a good decoding of the nested struct for some reason. Moreover, I'm not really sure if it's my code or the way I'm calling it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1433620745, "post_id": 30686655, "comment_id": 49433565, "body": "Just install Mercurial. This has nothing to do with Go."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1433621422, "post_id": 30686655, "comment_id": 49433754, "body": "@Volker: <a href=\"http://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow noreferrer\"><code>golang.org&#47;x&#47;net&#47;websocket</code></a> is <a href=\"https://git-scm.com/\" rel=\"nofollow noreferrer\">Git</a>. <code>code.google.com&#47;p&#47;go.net&#47;websocket</code> is obsolete: <a href=\"http://google-opensource.blogspot.com/2015/03/farewell-to-google-code.html\" rel=\"nofollow noreferrer\">Bidding farewell to Google Code</a>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1433632714, "post_id": 30686655, "comment_id": 49436369, "body": "@Peter Yes, but importing the old one (for whatever reasons) requires Mercurial. Btw: I upvoted your answer."}, {"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 0, "creation_date": 1433637152, "post_id": 30686655, "comment_id": 49437067, "body": "Thanks Volker and Peter. This command is working magically. Thanks for yor help."}, {"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 0, "creation_date": 1433642140, "post_id": 30686655, "comment_id": 49437890, "body": "Below is the function main"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 15, "last_activity_date": 1433619890, "last_edit_date": 1433619890, "creation_date": 1433619188, "answer_id": 30686776, "question_id": 30686655, "link": "https://stackoverflow.com/questions/30686655/go-program-throwing-error-cannot-find-package-code-google-com-p-go-net-websocke/30686776#30686776", "title": "go program throwing error cannot find package &quot;code.google.com/p/go.net/websocket&quot;", "body": "<p>How about this?</p>\n\n<pre><code>$ go get -v golang.org/x/net/websocket\ngolang.org/x/net/websocket\n$\n</code></pre>\n\n<p>-</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"strconv\"\n\n    \"golang.org/x/net/websocket\"\n)\n\nvar addr = \"12345\"\n\nfunc EchoLengthServer(ws *websocket.Conn) {\n    var msg string\n\n    for {\n        websocket.Message.Receive(ws, &amp;msg)\n        fmt.Println(\"Got Message\", msg)\n        length := len(msg)\n        if err := websocket.Message.Send(ws, strconv.FormatInt(int64(length), 10)); err != nil {\n            fmt.Println(\"can't send message length\")\n            break\n        }\n    }\n}\n\nfunc websocketListen() {\n    http.Handle(\"/length\", websocket.Handler(EchoLengthServer))\n    err := http.ListenAndServe(addr, nil)\n    if err != nil {\n        panic(\"ListenAndServe:\" + err.Error())\n    }\n}\n\nfunc main() {}\n</code></pre>\n"}], "owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7479, "favorite_count": 2, "accepted_answer_id": 30686776, "answer_count": 1, "score": 7, "last_activity_date": 1435184395, "creation_date": 1433618331, "last_edit_date": 1435184395, "question_id": 30686655, "link": "https://stackoverflow.com/questions/30686655/go-program-throwing-error-cannot-find-package-code-google-com-p-go-net-websocke", "title": "go program throwing error cannot find package &quot;code.google.com/p/go.net/websocket&quot;", "body": "<p>I am new to Go programming language. Below is my code.</p>\n\n<pre><code>package main\n\nimport (\n    \"code.google.com/p/go.net/websocket\"\n    \"fmt\"\n    \"net/http\"\n    \"strconv\"\n)\n\nvar add := \"12345\"\n\nfunc EchoLengthServer(ws *webscoket.Conn) {\n    var msg string\n\n    for {\n        websocket.Message.Receive(ws, &amp;msg)\n        fmt.Println(\"Got Message\", msg)\n        length := len(msg)\n        if err := websocket.Message.Send(ws, strconv.FormatInt(int64(length), 10)); err != nil {\n            fmt.Println(\"can't send message length\")\n            break\n        }\n    }\n}\n\nfunc websocketListen() {\n    http.Handle(\"/length\", websocket.Handler(EchoLengthServer))\n    err := http.ListenAndServe(addr, nil)\n    if err != nil {\n        panic(\"ListenAndServe:\" + err.Error())\n    }\n}\n</code></pre>\n\n<p>when I executed  the code i got below error </p>\n\n<pre><code>[rajkumar@localhost ch4-DesigningAPI]$ go run WebSockets.go \nWebSockets.go:6:3: cannot find package \"code.google.com/p/go.net/websocket\" in any of:\n    /usr/local/go/src/code.google.com/p/go.net/websocket (from $GOROOT)\n    /home/rajkumar/GOPackages/src/code.google.com/p/go.net/websocket (from $GOPATH)\n</code></pre>\n\n<p>I tried to add websocket package in GOPATH by go get command but that is also throwing below error</p>\n\n<pre><code>[rajkumar@localhost ch4-DesigningAPI]$ go get code.google.com/p/go.net/websocket\ngo: missing Mercurial command. See http://golang.org/s/gogetcmd\npackage code.google.com/p/go.net/websocket: exec: \"hg\": executable file not found in $PATH\n</code></pre>\n\n<p>Could you please help me in resolving this error.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "edited": false, "score": 0, "creation_date": 1433636057, "post_id": 30686458, "comment_id": 49436909, "body": "How can authp work without any arguments? Do you pass the request to it? And no, you cannot give HandleFunc a different signature, but you can of course wrap the gatekeeper in a function with the correct signature by making gatekeeper return a closure."}, {"owner": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "reply_to_user": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "edited": false, "score": 0, "creation_date": 1433638817, "post_id": 30686458, "comment_id": 49437322, "body": "<code>authp</code> has arguments. I just for the sake of simplicity did not write it. possibly it will take the <code>ResponseWriter</code>, <code>*Request</code> parameters."}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1433637519, "post_id": 30688916, "comment_id": 49437120, "body": "PS: I also wrote an article a while back on how to avoid the &#39;problem&#39; of those naked returns and to centralise your HTTP status responses with custom handler types. You might find it useful: <a href=\"http://elithrar.github.io/article/custom-handlers-avoiding-globals/\" rel=\"nofollow noreferrer\">elithrar.github.io/article/custom-handlers-avoiding-globals</a>"}, {"owner": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "edited": false, "score": 0, "creation_date": 1433640071, "post_id": 30688916, "comment_id": 49437525, "body": "Thanks. not sure yet on the sessions. Possibly I will use some new technology like JWT. But I am not quite sure of it."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "edited": false, "score": 0, "creation_date": 1433641681, "post_id": 30688916, "comment_id": 49437808, "body": "Note that JWT&#39;s need something to catch and store them: (arguably) useful for API clients and Single Page Apps (e.g. an Angular app) but else cookies will be better for browser clients."}, {"owner": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "edited": false, "score": 0, "creation_date": 1433641992, "post_id": 30688916, "comment_id": 49437863, "body": "I will need and try to maintain a single code base for say authentication jobs of a Web service with same or almost same client and server side code. If for browser clients jwt is not a drawback or disadvantage, it will be better development ease I use jwt everywhere. Has it drawbacks with browser clients?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "edited": false, "score": 0, "creation_date": 1433644019, "post_id": 30688916, "comment_id": 49438151, "body": "You need a JS front end to capture the token and store it in LocalStorage, so that&#39;s the major drawback. There&#39;s nothing stopping you from wrapping your API routes (only) with middleware that issues JWTs instead of a cookie. JWTs can be risky in terms of implementation however and I would often suggest just a 256 byte random token (stored in a DB or Redis against the userID) and issued via a HTTP header is a much safer way to authorize an API."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 4, "last_activity_date": 1433637379, "creation_date": 1433637379, "answer_id": 30688916, "question_id": 30686458, "link": "https://stackoverflow.com/questions/30686458/go-authentication-logic-pattern-in-web-app/30688916#30688916", "title": "Go- authentication logic pattern in web app", "body": "<p>There are many ways to spin this, and it's arguable whether one is outright \"better\". I'd strongly suggest writing some middleware that wraps your routes and enforces the check, calling the wrapped handler only on success.</p>\n\n<p>Note that I'm going to make a few assumptions here as you haven't told us how you're managing sessions (cookies? server-side?) and/or what kind of authorization you might need on top of authentication.</p>\n\n<pre><code>// Middleware - a function that sits in the 'middle' of your request processing.\nfunc RequireAuth(h http.Handler) http.Handler) {\n    fn := func(w http.ResponseWriter, r *http.Request) {\n        // Assuming gorilla/sessions\n        session, err := store.Get(\"name\", r)\n        if err != nil {\n            // Raise HTTP 500\n            return\n        }\n\n        // We'll assume you're storing the userID in the cookie|server session\n        // upon login elsewhere.\n        id := session.Values[\"userID\"]\n        // Probably returns a *yourapp.User\n        user, err := db.GetUser(id)\n        if err != nil {\n            // Raise HTTP 500\n            return\n        }\n\n        if user == nil {\n            http.Error(w, http.StatusText(http.StatusUnauthorized), http.StatusUnauthorized)\n            // Don't forget these 'naked' returns - if you miss one, your \n            // handler will keep processing beyond the error and result in\n            // unintended side effects\n            return\n        }\n\n        // Further checks here - i.e. checking user.Active == true, etc.\n\n        // The userID matches one in the DB, so let's proceed\n        h.ServeHTTP(w, r)\n    }\n\n    return http.HandlerFunc(fn)\n}\n\n// And in your router - assuming just vanilla net/http\nhttp.Handle(\"/\", RequireAuth(yourHandlerFunc))\nhttp.Handle(\"/\", RequireAuth(someOtherHandler))\n// Note that using gorilla/mux or goji can help give you \"subrouters\" so you\n// don't have to wrap every single route with your middleware (messy, error prone)\n</code></pre>\n\n<p>I'd also suggest some reading on Go middleware<a href=\"http://www.alexedwards.net/blog/making-and-using-middleware\" rel=\"nofollow\">1</a> composition<a href=\"https://justinas.org/writing-http-middleware-in-go/\" rel=\"nofollow\">2</a> which will help you in the future.</p>\n\n<p>If you want to call a custom error page, just write a handler - e.g. <code>UnauthorizedHandler</code> that satisfies http.Handler and just call <code>UnauthorizedHandler.ServeHTTP(w, r)</code> instead of <code>http.Error</code> along the way.</p>\n"}], "owner": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 1, "accepted_answer_id": 30688916, "answer_count": 1, "score": 2, "last_activity_date": 1433637379, "creation_date": 1433616790, "question_id": 30686458, "link": "https://stackoverflow.com/questions/30686458/go-authentication-logic-pattern-in-web-app", "title": "Go- authentication logic pattern in web app", "body": "<p>I want to determine a simple and useful pattern for user authentication in a web app being written in golang.</p>\n\n<p>I have come up with two patterns. First one is enabling the programmer to have his functions separate form the authentication logic, and has cleaner <code>HandleFunc</code> parts in <code>main()</code> that one can see only by loking <code>main()</code> to see what parts are under authentication control.</p>\n\n<p>Second one is making programmer include a decision in every function deal with authentication required urls. An <code>if</code> statement checks by a <code>authp()</code> function defined else where.</p>\n\n<p>Which one is better pattern for such necessity?</p>\n\n<p>What are the better patterns for this job?  </p>\n\n<p>Is it even possible to pass a function to http.HandleFunc that has signature other than <code>func urlFunc (ResponseWriter, *Request)</code> bu like <code>func urlFunc (successFunc, failFunc)</code> or <code>func urlFunc (ResponseWriter, *Request, successFunc, failFunc)</code> as in <code>authenticationGateKeeper</code> function of <strong>First Way</strong> below, if not a suitable workaround for that?</p>\n\n<pre><code>//First Way\npackage main\n\nfunc authGateKeeper(successFunc, failFunc) {\n    if (authp()) {\n        successFunc\n    } else {\n        failFunc\n    }\n}\n\nfunc authp() boolean {\n    //authentication logic, db query, or session check etc.\n}\n\n//usage in main\nhttp.HandleFunc(\"/\", authGateKeeper)\n\n\n\n//Second Way; other alternative, in each function check pattern\nfunc f(w, r) {\n    if (authp()) {\n    //function's processes\n    } else {\n    //the fail case function or processes\n    }\n}\n\nfunc authp() boolean {\n    //authentication logic, db query, or session check etc.\n}\n\n//usage in main\nhttp.HandleFunc(\"/\", f)\n</code></pre>\n"}, {"tags": ["web-applications", "go", "global-variables", "session-cookies", "beego"], "comments": [{"owner": {"reputation": 1641, "user_id": 3828156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scFYI.jpg?s=128&g=1", "display_name": "chendesheng", "link": "https://stackoverflow.com/users/3828156/chendesheng"}, "edited": false, "score": 0, "creation_date": 1433647624, "post_id": 30686076, "comment_id": 49438705, "body": "Why not use beego&#39;s route system? You can access session through context object directly. No need to create a global session package."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433692675, "post_id": 30686076, "comment_id": 49449252, "body": "&quot;created new packages for each of my go files&quot;. I hope that&#39;s a typo and you aren&#39;t really putting each <code>*.go</code> file in it&#39;s own package. <i>Only</i> use packages where it makes sense, that is, where it&#39;s a separate concept with a clear API and/or it&#39;s reasonable that something else will want/need to use the package. Also, <code>globalsessionkeeper</code> is a poor and non-idiomatic <a href=\"https://blog.golang.org/package-names\" rel=\"nofollow noreferrer\">name for a Go package</a>."}, {"owner": {"reputation": 43, "user_id": 4906948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6484d7c4e87b44d13a9a6260f86bf0a2?s=128&d=identicon&r=PG&f=1", "display_name": "TinuC", "link": "https://stackoverflow.com/users/4906948/tinuc"}, "edited": false, "score": 0, "creation_date": 1433727369, "post_id": 30686076, "comment_id": 49458448, "body": "So can you explain that a bit?  If I have a login and a register file, they shouldn&#39;t be in separate packages?  Sorry I&#39;m new to golang.  Trying to figure this out as I go."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 4906948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6484d7c4e87b44d13a9a6260f86bf0a2?s=128&d=identicon&r=PG&f=1", "display_name": "TinuC", "link": "https://stackoverflow.com/users/4906948/tinuc"}, "is_accepted": true, "score": 0, "last_activity_date": 1433732168, "creation_date": 1433732168, "answer_id": 30700676, "question_id": 30686076, "link": "https://stackoverflow.com/questions/30686076/go-namespace-scope-issue-for-global-session-management-across-multiple-packages/30700676#30700676", "title": "Go Namespace/Scope Issue for Global Session Management Across Multiple Packages", "body": "<p>Turns out this was working all along.  I was passing the wrong cookie value back to the api.  Silly mistakes cause all kinds of headaches.</p>\n"}], "owner": {"reputation": 43, "user_id": 4906948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6484d7c4e87b44d13a9a6260f86bf0a2?s=128&d=identicon&r=PG&f=1", "display_name": "TinuC", "link": "https://stackoverflow.com/users/4906948/tinuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 30700676, "answer_count": 1, "score": -1, "last_activity_date": 1433732168, "creation_date": 1433614377, "last_edit_date": 1433622209, "question_id": 30686076, "link": "https://stackoverflow.com/questions/30686076/go-namespace-scope-issue-for-global-session-management-across-multiple-packages", "title": "Go Namespace/Scope Issue for Global Session Management Across Multiple Packages", "body": "<p>First let me say I'm new to Golang.  Working with it for a couple of weeks now.  Really like the language but...</p>\n\n<p>I'm having some trouble with global session management in Golang.  I see how it works and I can me it work if scope is all in one package, however I just recently created new packages for each of my go files.  I did this because I read this is best practice and good for reusability.</p>\n\n<p>Ever since I moved the go files into their own packages instead of one package, the session management broke.  It looks to create a new session every time instead of reusing an existing session.  Here's some code to give you an understanding of what I'm doing:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"api/login\"\n    \"api/globalsessionkeeper\"\n    \"github.com/astaxie/beego/session\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/login\", login.DoLogin)\n\n    og.Fatal(http.ListenAndServe(\":8000\", nil))\n}\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello, %q\", html.EscapeString(r.URL.Path))\n}\n\nfunc init() {\n    var err error\n    fmt.Println(\"Session init\")\n    globalsessionkeeper.GlobalSessions, err = session.NewManager(\"mysql\", `{\"enableSetCookie\":true, \"SessionOn\":true, \"cookieName\":\"globalsession_id\",\"gclifetime\":120,\"ProviderConfig\":\"root@tcp(172.16.0.23:3306)/databse\"}`)\n    if err != nil {\n        fmt.Printf(\"Error\")\n    }\n    globalsessionkeeper.GlobalSessions.SetSecure(true)\n    go globalsessionkeeper.GlobalSessions.GC()\n}\n</code></pre>\n\n<p>package globalsessionkeeper (I created this just so I can reuse a global variable within all other packages..i.e \"package login\"..etc)</p>\n\n<pre><code>package globalsessionkeeper\n\nimport (\n    \"github.com/astaxie/beego/session\"\n    _ \"github.com/astaxie/beego/session/mysql\"\n)\n\n//Global Variable\nvar GlobalSessions *session.Manager\n</code></pre>\n\n<p>Here's a snipit from the login function/package.  This was working perfectly fine with everything was in one package:</p>\n\n<pre><code>if validated == true {\n    //create session using the request data which includes the cookie/sessionid\n    sessionStore, err := globalsessionkeeper.GlobalSessions.SessionStart(w, r)\n    if err != nil {\n        //need logging here instead of print\n        fmt.Printf(\"Error, could not start session %v\\n\", err)\n        break\n    }\n    defer sessionStore.SessionRelease(w) //update db upon completion for request\n\n    if sessionStore.Get(\"uniquevalue\") == nil {\n        //need logging here instead of print\n        fmt.Printf(\"uniquevalue not found, Saving Session, Get has %v\\n\", sessionStore)\n        fmt.Printf(\"uniquevalue not found, Saving Session, Get has %v\\n\", sessionStore.Get(\"uniquevalue\"))\n        err = sessionStore.Set(\"uniquevalue\", input.uniquevalue)\n        if err != nil {\n            //need logging here instead of print\n            fmt.Printf(\"Error while writing to DB, %v\\n\", err)\n            break\n        }\n    } else {\n        //need logging here instead of print\n        fmt.Printf(\"Found Session! Session uniquevalue = %v\\n\", sessionStore.Get(\"uniquevalue\"))\n    }\n    //Send back 204 no content (with cookie)\n    w.WriteHeader(http.StatusNoContent)\n} else {\n    fmt.Printf(\"Login Failed\")\n    w.WriteHeader(http.StatusUnauthorized)\n}\n</code></pre>\n\n<p>The database has the correctly entry.  It has the unique value stored for each session that it creates.  Here's some output as well:</p>\n\n<pre><code>answer = true\nuniquvalue not found, Saving Session, Get has &amp;{0xc208046b80 f08u0489804984988494994 {{0 0} 0 0 0 0} map[]}\nuniquevalue not found, Saving Session, Get has &lt;nil&gt;\n2015/06/06 17:32:26 http: multiple response.WriteHeader calls\n</code></pre>\n\n<p>And of course, the multiple response.WriteHeader is something else I have to correct. The go routine was originally sending a 200OK but I wanted to change that to a 204 no content, however it started giving me that error once I did.</p>\n\n<p>Any help would be appreciated.  Thanks!</p>\n"}, {"tags": ["templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 1462, "user_id": 2046808, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/uooKU.png?s=128&g=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/2046808/goku"}, "edited": false, "score": 0, "creation_date": 1433619161, "post_id": 30686323, "comment_id": 49433141, "body": "But I&#39;m loading on init() all my templates, I just added my Templates map definition, thanks."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 1462, "user_id": 2046808, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/uooKU.png?s=128&g=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/2046808/goku"}, "edited": false, "score": 0, "creation_date": 1433622684, "post_id": 30686323, "comment_id": 49434066, "body": "@Goku so you should register the function when you parse it."}, {"owner": {"reputation": 1462, "user_id": 2046808, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/uooKU.png?s=128&g=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/2046808/goku"}, "edited": false, "score": 0, "creation_date": 1433627311, "post_id": 30686323, "comment_id": 49435231, "body": "Thanks @Not_a_Golfer!!"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 1, "last_activity_date": 1433615909, "creation_date": 1433615909, "answer_id": 30686323, "question_id": 30685872, "link": "https://stackoverflow.com/questions/30685872/golang-help-registering-a-function-into-templates/30686323#30686323", "title": "Golang: Help registering a function into templates", "body": "<p>You need to call <code>Parse()</code> on the template after attaching the funcs to it. I don't know how your template map is being defined, but assuming it's a map of template texts, the call should look like this:</p>\n\n<pre><code>tmpl := template.New(templateName).Funcs(template.FuncMap{\n        ....  \n        }).Parse(Templates[name+\".tmpl\"])\n</code></pre>\n\n<p>If <code>Templates</code> contains parsed templates, you need to attach the function when you're parsing them.</p>\n"}, {"tags": [], "owner": {"reputation": 1462, "user_id": 2046808, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/uooKU.png?s=128&g=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/2046808/goku"}, "is_accepted": true, "score": 0, "last_activity_date": 1433856834, "creation_date": 1433856834, "answer_id": 30733575, "question_id": 30685872, "link": "https://stackoverflow.com/questions/30685872/golang-help-registering-a-function-into-templates/30733575#30733575", "title": "Golang: Help registering a function into templates", "body": "<p>Ok, finally this solution works done for my case, based on Not_a_Golfer help:</p>\n\n<pre><code>for _, layout := range layouts {\n    t := template.New(\"t\").Funcs(templateFuncs)\n    Templates[filepath.Base(layout)], err = t.ParseFiles(layouts...)\n    if err != nil {\n        panic(err)\n    }\n</code></pre>\n"}], "owner": {"reputation": 1462, "user_id": 2046808, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/uooKU.png?s=128&g=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/2046808/goku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1316, "favorite_count": 0, "accepted_answer_id": 30733575, "answer_count": 2, "score": 1, "last_activity_date": 1433856834, "creation_date": 1433613049, "last_edit_date": 1433625592, "question_id": 30685872, "link": "https://stackoverflow.com/questions/30685872/golang-help-registering-a-function-into-templates", "title": "Golang: Help registering a function into templates", "body": "<p>I'm trying to add to my templates a function to \"humanize\"(<a href=\"https://gowalker.org/github.com/dustin/go-humanize\" rel=\"nofollow\">https://gowalker.org/github.com/dustin/go-humanize</a>) the output, but seems something I'm doing wrong because I'm getting this error:</p>\n\n<p>panic: template: dashboard.tmpl:192: function \"humanizeTime\" not defined</p>\n\n<pre><code>func renderTemplate(w http.ResponseWriter, name string, data map[string]interface{}) error {\n    //functions for templates\n    templateFuncs := template.FuncMap{\n        \"humanizeTime\": func(t time.Time) string {\n            return humanize.Time(t)\n        },\n    }\n    tmpl := Templates[name+\".tmpl\"].Funcs(templateFuncs)\n    w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n\n    err := tmpl.ExecuteTemplate(w, name, data)\n    if err != nil {\n        log.Printf(\"Error rendering template: %s\", err.Error())\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return errors.New(\"Error trying to render template\")\n    }\n    return nil\n}\n</code></pre>\n\n<p>Added:\nI am defining and loading on init() my templates Map:</p>\n\n<pre><code>var Templates      map[string]*template.Template\n\nif Templates == nil {\n    Templates = make(map[string]*template.Template)\n}\nlayouts, err := filepath.Glob(\"templates/*.tmpl\")\nif err != nil {\n    panic(err)\n}\nfor _, layout := range layouts {\n    Templates[filepath.Base(layout)] = template.Must(template.ParseFiles(layouts...))\n}\n</code></pre>\n\n<p>I just change my definition to:</p>\n\n<pre><code>for _, layout := range layouts {\n    Templates[filepath.Base(layout)] = template.Must(template.ParseFiles(layouts...)).Funcs(templateFuncs)\n}\n</code></pre>\n\n<p>But doesn't work yet, I got the same error: not defined.</p>\n\n<p>Please could somebody give me a hand with that? Thanks.</p>\n"}, {"tags": ["go", "travis-ci", "aws-sdk"], "comments": [{"owner": {"reputation": 873, "user_id": 1057015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16e625ef0bb65ea7995547d72dc746c?s=128&d=identicon&r=PG", "display_name": "DiogoDoreto", "link": "https://stackoverflow.com/users/1057015/diogodoreto"}, "edited": false, "score": 0, "creation_date": 1433627338, "post_id": 30683697, "comment_id": 49435238, "body": "Are you sure you don&#39;t have an old version of your dependencies in your GOPATH?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433693709, "post_id": 30683697, "comment_id": 49449561, "body": "<a href=\"https://stackoverflow.com\">Stack Overflow</a> questions include the relevant information directly rather than via links (among other things, external links are likely to break in the future). As-is your question effectively reads &quot;I get an [unspecified] compiler error with my [unspecified] code&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 376, "user_id": 4981332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e1b1e4adb0a6d62718938f1ae9822?s=128&d=identicon&r=PG", "display_name": "devfubar", "link": "https://stackoverflow.com/users/4981332/devfubar"}, "edited": false, "score": 0, "creation_date": 1433696597, "post_id": 30687981, "comment_id": 49450494, "body": "This could well be the issue.  I&#39;m still learning some best practises and dependency management is something I haven&#39;t invested time in yet.  I will mark it as the correct answer when I confirm this indeed was the issue :-)"}, {"owner": {"reputation": 376, "user_id": 4981332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e1b1e4adb0a6d62718938f1ae9822?s=128&d=identicon&r=PG", "display_name": "devfubar", "link": "https://stackoverflow.com/users/4981332/devfubar"}, "edited": false, "score": 0, "creation_date": 1433698761, "post_id": 30687981, "comment_id": 49451274, "body": "That was exactly my problem. Thanks for the very good suggestion."}], "tags": [], "owner": {"reputation": 873, "user_id": 1057015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16e625ef0bb65ea7995547d72dc746c?s=128&d=identicon&r=PG", "display_name": "DiogoDoreto", "link": "https://stackoverflow.com/users/1057015/diogodoreto"}, "is_accepted": true, "score": 1, "last_activity_date": 1433628096, "creation_date": 1433628096, "answer_id": 30687981, "question_id": 30683697, "link": "https://stackoverflow.com/questions/30683697/cant-build-go-project-in-travis/30687981#30687981", "title": "Can&#39;t build go project in travis", "body": "<p>Ok, I have just tried to <code>go get</code> your repo and got the same error:</p>\n\n<pre><code>handler/lambda.go:29: cannot use \"github.com/awslabs/aws-sdk-go/aws\".Config literal (type *\"github.com/awslabs/aws-sdk-go/aws\".Config) as type *\"github.com/aws/aws-sdk-go/aws\".Config in argument to lambda.New\nhandler/sqs.go:26: cannot use \"github.com/awslabs/aws-sdk-go/aws\".Config literal (type *\"github.com/awslabs/aws-sdk-go/aws\".Config) as type *\"github.com/aws/aws-sdk-go/aws\".Config in argument to sqs.New\n</code></pre>\n\n<p>I advice you to start using a dependency manager, so you will fix your dependencies inside your repo and have reproducible builds in any place.</p>\n\n<p>My recommendation is <a href=\"https://github.com/tools/godep\" rel=\"nofollow\">Godep</a>, but there are others out there.</p>\n"}], "owner": {"reputation": 376, "user_id": 4981332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e1b1e4adb0a6d62718938f1ae9822?s=128&d=identicon&r=PG", "display_name": "devfubar", "link": "https://stackoverflow.com/users/4981332/devfubar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 30687981, "answer_count": 1, "score": 0, "last_activity_date": 1433698411, "creation_date": 1433598910, "last_edit_date": 1433698411, "question_id": 30683697, "link": "https://stackoverflow.com/questions/30683697/cant-build-go-project-in-travis", "title": "Can&#39;t build go project in travis", "body": "<p>I started to create a very light weight message broker to practice go, travis and some aws services all in one project.</p>\n\n<p>My current problem is that I can build, run and test my develop branch on my local machine however when travis attempts to build it I get a compile error.  The code it doesn't like came straight from AWS examples to further deepen the mystery for me.</p>\n\n<p><strong>Travis failed build</strong>\n<a href=\"https://travis-ci.org/hevnly/eevy/builds/65687886\" rel=\"nofollow\">https://travis-ci.org/hevnly/eevy/builds/65687886</a></p>\n\n<p><strong>Github repo</strong> <a href=\"https://github.com/hevnly/eevy/tree/92412cf729ed546d698ded1e514d2d54c340ff81\" rel=\"nofollow\">https://github.com/hevnly/eevy/tree/92412cf729ed546d698ded1e514d2d54c340ff81</a></p>\n\n<p><strong>Error</strong></p>\n\n<pre>\nhandler/lambda.go:31: cannot use \"github.com/awslabs/aws-sdk-go/aws\".Config literal (type *\"github.com/awslabs/aws-sdk-go/aws\".Config) as type *\"github.com/aws/aws-sdk-go/aws\".Config in argument to lambda.New\nhandler/sqs.go:26: cannot use \"github.com/awslabs/aws-sdk-go/aws\".Config literal (type *\"github.com/awslabs/aws-sdk-go/aws\".Config) as type *\"github.com/aws/aws-sdk-go/aws\".Config in argument to sqs.New\n</pre>\n\n<p><strong>Sample of code</strong>\n<code>\n<code>svc := lambda.New(&amp;aws.Config{Region: \"eu-west-1\"})</code>\n</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1154, "user_id": 303623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7be2787417fe82e9677e541fb096cb?s=128&d=identicon&r=PG", "display_name": "Rick O&#39;Shea", "link": "https://stackoverflow.com/users/303623/rick-oshea"}, "edited": false, "score": 0, "creation_date": 1590975821, "post_id": 30681054, "comment_id": 109875018, "body": "JSON is of course prolific.  That the json library does not handle case conversion for the single most ubiquitous style (camel-case) both when serializing and deserializing, without this asinine hack, is really inexcusable."}], "answers": [{"comments": [{"owner": {"reputation": 1705, "user_id": 1096624, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb61ead025ea39d15e8a12db47d0cac1?s=128&d=identicon&r=PG", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/1096624/benjamin"}, "edited": false, "score": 12, "creation_date": 1486274500, "post_id": 30681107, "comment_id": 71270657, "body": "Thank you for the back quote explanation."}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": false, "score": 110, "last_activity_date": 1433582589, "last_edit_date": 1495542890, "creation_date": 1433582589, "answer_id": 30681107, "question_id": 30681054, "link": "https://stackoverflow.com/questions/30681054/what-is-the-usage-of-backtick-in-golang-structs-definition/30681107#30681107", "title": "What is the usage of backtick in golang structs definition?", "body": "<p>They are <a href=\"http://golang.org/ref/spec#Struct_types\" rel=\"noreferrer\">tags</a>:</p>\n\n<blockquote>\n  <p>A field declaration may be followed by an optional string literal tag,\n  which becomes an attribute for all the fields in the corresponding\n  field declaration. The tags are made visible through a reflection\n  interface and take part in type identity for structs but are otherwise\n  ignored.</p>\n\n<pre><code>// A struct corresponding to the TimeStamp protocol buffer.\n// The tag strings define the protocol buffer field numbers.\nstruct {\n  microsec  uint64 \"field 1\"\n  serverIP6 uint64 \"field 2\"\n  process   string \"field 3\"\n}\n</code></pre>\n</blockquote>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go\">this question and answer</a> for a more detailed explanation and answer.</p>\n\n<p>The <a href=\"http://golang.org/ref/spec#String_literals\" rel=\"noreferrer\">back quotes</a> are used to create raw string literals which can contain any type of character:</p>\n\n<blockquote>\n  <p>Raw string literals are character sequences between back quotes ``.\n  Within the quotes, any character is legal except back quote.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2911, "user_id": 702065, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae529fa78546d54e42c26bd3713946a2?s=128&d=identicon&r=PG", "display_name": "Johan Wikstr&#246;m", "link": "https://stackoverflow.com/users/702065/johan-wikstr%c3%b6m"}, "is_accepted": true, "score": 87, "last_activity_date": 1433582606, "last_edit_date": 1495540045, "creation_date": 1433582606, "answer_id": 30681110, "question_id": 30681054, "link": "https://stackoverflow.com/questions/30681054/what-is-the-usage-of-backtick-in-golang-structs-definition/30681110#30681110", "title": "What is the usage of backtick in golang structs definition?", "body": "<p>You can add extra meta information to Go structs in the form of tags. <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go\">Here are some examples of use cases</a>.</p>\n\n<p>In this case, the <code>json:\"gateway\"</code> is used by the <a href=\"http://golang.org/pkg/encoding/json/\" rel=\"noreferrer\">json package</a> to encode the value of <code>Gateway</code> into the key <code>gateway</code> in the corresponding json object.</p>\n\n<p>Example:</p>\n\n<pre><code>n := NetworkInterface{\n   Gateway : \"foo\"\n}\njson.Marshal(n)\n// will output `{\"gateway\":\"foo\",...}`\n</code></pre>\n"}], "owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49784, "favorite_count": 26, "closed_date": 1433645349, "accepted_answer_id": 30681110, "answer_count": 2, "score": 154, "last_activity_date": 1433587678, "creation_date": 1433582157, "last_edit_date": 1433587678, "question_id": 30681054, "link": "https://stackoverflow.com/questions/30681054/what-is-the-usage-of-backtick-in-golang-structs-definition", "closed_reason": "Duplicate", "title": "What is the usage of backtick in golang structs definition?", "body": "<pre><code>type NetworkInterface struct {\n    Gateway              string `json:\"gateway\"`\n    IPAddress            string `json:\"ip\"`\n    IPPrefixLen          int    `json:\"ip_prefix_len\"`\n    MacAddress           string `json:\"mac\"`\n    ...\n}\n</code></pre>\n\n<p>I'm quite confused what's the function of contents in backtick, like <code>json:\"gateway\"</code>.</p>\n\n<p>Is it just comment, like <code>//this is the gateway</code>?</p>\n"}, {"tags": ["go", "aerospike"], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "edited": false, "score": 0, "creation_date": 1433591714, "post_id": 30680640, "comment_id": 49425315, "body": "But note that 1. It <i>doesn&#39;t</i> panic every time, you can try it, it returns data 50% of the time  2.  It should never send an error on the error channel unless something is really wrong, I shouldn&#39;t have to worry about race conditions.  Good points though. Thanks."}, {"owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "reply_to_user": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "edited": false, "score": 0, "creation_date": 1433595719, "post_id": 30680640, "comment_id": 49426373, "body": "I did run your code snippet a dozen times or so and it paniced every time. As you say it does return data about half the time but then still panics. Perhaps you didn&#39;t mean to panic on the nil errors but the code snippet does. And you are correct that the Errors channel should only send non-nil errors so that you don&#39;t have to worry about it, but clearly it doesn&#39;t  So that seems to be an error in the package.  If you change the panic on nil error to just print and remove the return stmt you&#39;ll see that it returns data every time."}, {"owner": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "edited": false, "score": 1, "creation_date": 1433717739, "post_id": 30680640, "comment_id": 49456780, "body": "After testing more, it&#39;s always returning <i>something</i> on that error channel and 100% of the time err is nil, which to me is strange.  I asked in the Aerospike forums for a clear answer:  <a href=\"https://discuss.aerospike.com/t/aerospike-randomly-returning-nil-errors-when-using-query-with-go-client/1346/1\" rel=\"nofollow noreferrer\">discuss.aerospike.com/t/&hellip;</a>    so we&#39;ll see what they say"}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": false, "score": 1, "last_activity_date": 1433579092, "creation_date": 1433579092, "answer_id": 30680640, "question_id": 30676900, "link": "https://stackoverflow.com/questions/30676900/aerospike-randomly-returning-nil-errors-when-using-query-with-go-client/30680640#30680640", "title": "Aerospike randomly returning nil errors when using Query() with Go client", "body": "<p>I'm not familiar with the aerospike package but running your example code show that it always panics no matter if it returns data or not.</p>\n\n<p>That means that the <code>Errors</code> channel always sends either an <code>error</code> or <code>nil</code>. If that's the expected behavior you'd have to handle it accordingly and only panic when the error is not <code>nil</code>.</p>\n\n<p>Sending <code>nil</code> on the channel still means that a value is being sent on the channel and it will trigger the select statement. Thus the panic on a <code>nil error</code>.</p>\n\n<p>The randomness you see, i.e. sometimes data is returned and sometimes it isn't is due to the nature of the select statement. If both data and a <code>nil error</code> are being sent at the same time both cases are true and select will <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow\">pseudo randomly select</a> one of the two.</p>\n\n<blockquote>\n  <p>If one or more of the communications can proceed, a single one that\n  can proceed is chosen via a uniform pseudo-random selection.\n  Otherwise, if there is a default case, that case is chosen. If there\n  is no default case, the \"select\" statement blocks until at least one\n  of the communications can proceed.</p>\n</blockquote>\n\n<p>If it selects the data channel first it will print the data and then on the next iteration select the error channel and panic. If it picks the error channel first it panics and the data never prints.</p>\n"}, {"tags": [], "owner": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "is_accepted": false, "score": 1, "last_activity_date": 1433766978, "creation_date": 1433766978, "answer_id": 30709355, "question_id": 30676900, "link": "https://stackoverflow.com/questions/30676900/aerospike-randomly-returning-nil-errors-when-using-query-with-go-client/30709355#30709355", "title": "Aerospike randomly returning nil errors when using Query() with Go client", "body": "<p>Turns out it's a legit bug and should be fixed soon:  <a href=\"https://discuss.aerospike.com/t/aerospike-randomly-returning-nil-errors-when-using-query-with-go-client/1346\" rel=\"nofollow\">https://discuss.aerospike.com/t/aerospike-randomly-returning-nil-errors-when-using-query-with-go-client/1346</a></p>\n"}, {"tags": [], "owner": {"reputation": 493, "user_id": 4967452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tcsF1.jpg?s=128&g=1", "display_name": "Mnemaudsyne", "link": "https://stackoverflow.com/users/4967452/mnemaudsyne"}, "is_accepted": true, "score": 3, "last_activity_date": 1437788437, "creation_date": 1437788437, "answer_id": 31621990, "question_id": 30676900, "link": "https://stackoverflow.com/questions/30676900/aerospike-randomly-returning-nil-errors-when-using-query-with-go-client/31621990#31621990", "title": "Aerospike randomly returning nil errors when using Query() with Go client", "body": "<p>Just to post an update, both Errors and Records channels are closed automatically when the record stream is over from the server-side, hence the nil value from the Errors channel.</p>\n\n<p>So this wasn't an error after all. We've updated the thread in our Aerospike user forum post accordingly. </p>\n"}], "owner": {"reputation": 602, "user_id": 1154200, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ca722d97bf250f7abcb87a05d63ac6c3?s=128&d=identicon&r=PG", "display_name": "seenickcode", "link": "https://stackoverflow.com/users/1154200/seenickcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 31621990, "answer_count": 3, "score": 1, "last_activity_date": 1437788437, "creation_date": 1433544266, "question_id": 30676900, "link": "https://stackoverflow.com/questions/30676900/aerospike-randomly-returning-nil-errors-when-using-query-with-go-client", "title": "Aerospike randomly returning nil errors when using Query() with Go client", "body": "<p>I'm experiencing some strange behavior.  I'm trying to set up a small webapp that fetches some data using Aerospike 3.5 Community running on an Ubuntu 12.04 server.  I'm using the default aerospike.conf file (using the 'test' namespace) and am following the example of how to query <a href=\"https://github.com/aerospike/aerospike-client-go/blob/master/docs/client.md#query\" rel=\"nofollow\">here</a>.  </p>\n\n<p>When I attempt to query some records with a filter, the Errors channel <em>randomly</em> is returning a nil error.  (This example points to my dev database instance).</p>\n\n<p>To replicate, compile and run the following multiple times, you'll see either data returned or a panic:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/aerospike/aerospike-client-go\"\n)\n\nfunc main() {\n\n    c, err := aerospike.NewClient(\"52.7.157.46\", 3000)\n    if err != nil {\n        panic(err)\n    }\n\n    recs := liststuff(c)\n\n    fmt.Printf(\"got results: %v\", recs)\n}\n\nfunc liststuff(client *aerospike.Client) []*aerospike.Record {\n\n    // fetch some records with a filter\n    stm := aerospike.NewStatement(\"test\", \"products\")\n    stm.Addfilter(aerospike.NewEqualFilter(\"visible\", 1))\n    fmt.Println(\"querying...\")\n    recordset, err := client.Query(nil, stm)\n    if err != nil {\n        panic(err)\n    }\n\n    // collect results into a slice\n    recs := []*aerospike.Record{}\nL:\n    for {\n        select {\n        case rec, chanOpen := &lt;-recordset.Records:\n            if !chanOpen {\n                break L\n            }\n            fmt.Println(\"found record %v\", rec)\n            recs = append(recs, rec)\n        case err := &lt;-recordset.Errors:\n            if err != nil {\n                panic(err)\n            } else {\n                panic(fmt.Errorf(\"error nil when it should exist\"))\n            }\n            return nil\n        }\n    }\n\n    return recs\n}\n</code></pre>\n"}, {"tags": ["import", "go", "exec"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433539918, "post_id": 30676008, "comment_id": 49414003, "body": "This makes no sense to me. a) You really shouldn&#39;t be using <code>go run</code> like that b) if you expect it to run with <code>go run</code> that means <code>go</code> is installed so they can just <code>go get</code> your program and it&#39;ll get and install whatever is needed."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1433565388, "post_id": 30676008, "comment_id": 49419187, "body": "Cross-compile. <code>GOOS=linux .&#47;make.bash</code> at the root of your Go installation, then <code>GOOS=linux go build github.com&#47;me&#47;foo</code>. The cross-compilation support is pretty good for pure-Go programs, and you can&#39;t load packages at runtime like that."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1433792087, "post_id": 30676008, "comment_id": 49492755, "body": "LOL, that is a very creative use of the exec command. Self compiling go bins. It might be possible, but you would need two executables: one that sets up the $GOPATH with the dependencies and one actual program. Oh and users will need a working go toolchain. You might be better off with distributing <a href=\"http://dave.cheney.net/2012/09/08/an-introduction-to-cross-compilation-with-go\" rel=\"nofollow noreferrer\">cross compiled</a> binaries"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1433792142, "post_id": 30676008, "comment_id": 49492786, "body": "plus1 for creativity"}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433694216, "post_id": 30688809, "comment_id": 49449727, "body": "No, <code>go run</code> does not (at least on my Go1.4.2 system); only <code>go get</code> fetches dependant packages. A <code>go get .</code> (?) or <code>go get &lt;go-gettable_URL_for_OPs_program&#47;package&gt;</code> will get and build everything required."}, {"owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434472689, "post_id": 30688809, "comment_id": 49788148, "body": "@DaveC: Fixed my mistake."}], "tags": [], "owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "is_accepted": false, "score": -1, "last_activity_date": 1434472664, "last_edit_date": 1434472664, "creation_date": 1433636207, "answer_id": 30688809, "question_id": 30676008, "link": "https://stackoverflow.com/questions/30676008/is-there-a-way-to-import-later-in-golang/30688809#30688809", "title": "Is there a way to import later in golang?", "body": "<p>Just host your code on github or somewhere else. Then the people who want to run the program can use <code>go install \"example.com\"</code> to get a binary.</p>\n\n<p>If you dont want to host your code, you can instruct them to put it in their <code>GOPATH/src/</code> and use <code>go install yourprojectsname</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 4979635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65983f3acf15b4110e819b762bc967b5?s=128&d=identicon&r=PG&f=1", "display_name": "George Khaburzaniya", "link": "https://stackoverflow.com/users/4979635/george-khaburzaniya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1434472664, "creation_date": 1433539228, "question_id": 30676008, "link": "https://stackoverflow.com/questions/30676008/is-there-a-way-to-import-later-in-golang", "title": "Is there a way to import later in golang?", "body": "<p>I'm writing a small go program. I expect it to be run on different OSes, so I was hoping to use go run rather than including the compiled file. The problem is it uses a package from outside the standard library. I don't want to rely on people having the package. I can get the package using</p>\n\n<pre><code>package main\n\nimport \"os/exec\"\n\nfunc main() {\n    _ := exec.Command(\"go\", \"get\",\"github.com/user/library\").Run()\n}\n</code></pre>\n\n<p>But by then it's too late to import it. I can see three solutions. </p>\n\n<ol>\n<li><p>Make a wrapper script.</p></li>\n<li><p>Cross-compile</p></li>\n<li><p>Get the user to do it</p></li>\n</ol>\n\n<p>But I'd really like to install it and then import, is there any way to do so?</p>\n"}, {"tags": ["go", "orientdb"], "comments": [{"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 0, "creation_date": 1433532989, "post_id": 30673437, "comment_id": 49410666, "body": "Doesn&#39;t look like a <code>go</code> problem to me, although you can try with <a href=\"http://golang.org/pkg/net/http/#Client.Get\" rel=\"nofollow noreferrer\"><code>client.Go</code></a> instead of <code>client.Do</code>. Any error in the server logs?"}], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": true, "score": 2, "last_activity_date": 1433541896, "creation_date": 1433541896, "answer_id": 30676496, "question_id": 30673437, "link": "https://stackoverflow.com/questions/30673437/list-orientdb-databases-using-http-protocol-and-golang/30676496#30676496", "title": "list OrientDb databases using HTTP protocol and golang", "body": "<p>Your request is fine, it's the way you're trying to print out the response. </p>\n\n<p>You're marshaling the entire response object to JSON and you can see the <code>\"Body\": {},</code> where your body is missing. A <a href=\"http://golang.org/pkg/net/http/#Response\" rel=\"nofollow\"><code>*http.Response</code></a> won't marshal to JSON the way you want. This is because the <code>Body</code> field is not just a <code>string</code> or <code>[]bytes</code>, it's an <a href=\"http://golang.org/pkg/io/#ReadCloser\" rel=\"nofollow\"><code>io.ReadCloser</code></a> and the JSON marshaling code isn't going to call <code>.Read</code> on it.</p>\n\n<p>Try one of these to just get the response body</p>\n\n<pre><code>var b bytes.Buffer\n_, err = b.ReadFrom(resp.Body)\nif err != nil {\n    log.Fatal(\"Error : %s\", err)\n}\nfmt.Println(b.String())\n</code></pre>\n\n<p>or</p>\n\n<pre><code>contents, err := ioutil.ReadAll(resp.Body)\nif err != nil {\n    log.Fatal(\"Error : %s\", err)\n}\nfmt.Println(string(contents))\n</code></pre>\n\n<p>Or to get the extra response meta information you could do this</p>\n\n<pre><code>dump, err := httputil.DumpResponse(resp, true)\nif err != nil {\n    log.Fatal(\"Error : %s\", err)\n}\nfmt.Println(string(dump))\n</code></pre>\n\n<p>(The second flag the <code>true</code> says to include the body, otherwise it would just show status and headers)</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 30676496, "answer_count": 1, "score": 2, "last_activity_date": 1433541896, "creation_date": 1433529001, "question_id": 30673437, "link": "https://stackoverflow.com/questions/30673437/list-orientdb-databases-using-http-protocol-and-golang", "title": "list OrientDb databases using HTTP protocol and golang", "body": "<p>I am trying to get a list of <code>OrientDb</code> databases using HTTP protocol. But I cannot get expected response, which I can get in a browser. </p>\n\n<p>If I input in a browser address line <code>http://localhost:2480/listDatabases</code> then I have \nresponse:</p>\n\n<pre><code>{\"@type\":\"d\",\"@version\":0,\"databases\":[\"MaximDB\",\"GratefulDeadConcerts\"],\"@fieldTypes\":\"databases=e\"}\n</code></pre>\n\n<p>How can I get the same using <code>golang</code>?</p>\n\n<p>My code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    client := &amp;http.Client{}\n    req, err := http.NewRequest(\"GET\", \"http://localhost:2480/listDatabases\", nil)\n    req.SetBasicAuth(\"root\", \"1\")\n    resp, err := client.Do(req)\n    if err != nil {\n        fmt.Printf(\"Error : %s\", err)\n    }\n    fmt.Println(\"resp\")\n    fmt.Println(ToJson(resp))\n}\n\nfunc ToJson(obj interface{}) string {\n    b, err := json.MarshalIndent(&amp;obj, \"\", \"   \")\n    if err != nil {\n        fmt.Printf(\"Error : %s\", err)\n    }\n    strJson := string(b)\n\n    return strJson\n}\n</code></pre>\n\n<p>It outputs in console:</p>\n\n<pre><code>resp\n{\n   \"Status\": \"200 OK\",\n   \"StatusCode\": 200,\n   \"Proto\": \"HTTP/1.1\",\n   \"ProtoMajor\": 1,\n   \"ProtoMinor\": 1,\n   \"Header\": {\n      \"Connection\": [\n         \"Keep-Alive\"\n      ],\n      \"Content-Type\": [\n         \"application/json; charset=utf-8\"\n      ],\n      \"Date\": [\n         \"Fri Jun 05 22:19:23 MSK 2015\"\n      ],\n      \"Etag\": [\n         \"0\"\n      ],\n      \"Server\": [\n         \"OrientDB Server v.2.0.10 (build UNKNOWN@r; 2015-05-25 16:48:43+0000)\"\n      ],\n      \"Set-Cookie\": [\n         \"OSESSIONID=-; Path=/; HttpOnly\"\n      ]\n   },\n   \"Body\": {},\n   \"ContentLength\": -1,\n   \"TransferEncoding\": null,\n   \"Close\": false,\n   \"Trailer\": null,\n   \"Request\": {\n      \"Method\": \"GET\",\n      \"URL\": {\n         \"Scheme\": \"http\",\n         \"Opaque\": \"\",\n         \"User\": null,\n         \"Host\": \"localhost:2480\",\n         \"Path\": \"/listDatabases\",\n         \"RawQuery\": \"\",\n         \"Fragment\": \"\"\n      },\n      \"Proto\": \"HTTP/1.1\",\n      \"ProtoMajor\": 1,\n      \"ProtoMinor\": 1,\n      \"Header\": {\n         \"Authorization\": [\n            \"Basic cm9vdDox\"\n         ]\n      },\n      \"Body\": null,\n      \"ContentLength\": 0,\n      \"TransferEncoding\": null,\n      \"Close\": false,\n      \"Host\": \"localhost:2480\",\n      \"Form\": null,\n      \"PostForm\": null,\n      \"MultipartForm\": null,\n      \"Trailer\": null,\n      \"RemoteAddr\": \"\",\n      \"RequestURI\": \"\",\n      \"TLS\": null\n   },\n   \"TLS\": null\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12342, "user_id": 1300892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f3a5c87c28be1e3d1d31281c613deb?s=128&d=identicon&r=PG", "display_name": "Sverri M. Olsen", "link": "https://stackoverflow.com/users/1300892/sverri-m-olsen"}, "edited": false, "score": 1, "creation_date": 1433510328, "post_id": 30667337, "comment_id": 49397189, "body": "Single quotes are for <a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"nofollow noreferrer\">rune literals</a>. They may only contain one rune. If you use double quotes then you need to escape the escape character (i.e. <code>&quot;\\\\|&quot;</code>). If you do not have the need for escaping stuff then you can use backticks (<code>`\\|`</code>). Inside backticks nothing has special meaning (except backticks)."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "is_accepted": true, "score": 4, "last_activity_date": 1433510056, "last_edit_date": 1433510056, "creation_date": 1433509947, "answer_id": 30667464, "question_id": 30667337, "link": "https://stackoverflow.com/questions/30667337/go-add-backslash-in-front-of-characters/30667464#30667464", "title": "Go: add backslash in front of &#39;|&#39; characters", "body": "<p>use this:</p>\n\n<pre><code>strings.Replace(f ,\"|\", `\\|`, -1)\n</code></pre>\n\n<p>example:</p>\n\n<p><a href=\"http://play.golang.org/p/EQFR2EX5Bi\" rel=\"nofollow\">http://play.golang.org/p/EQFR2EX5Bi</a></p>\n"}], "owner": {"reputation": 327, "user_id": 961786, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c583f2c2db98cd0c19a9c6bc41b66bd4?s=128&d=identicon&r=PG", "display_name": "tommy_p1ckles", "link": "https://stackoverflow.com/users/961786/tommy-p1ckles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 30667464, "answer_count": 1, "score": -1, "last_activity_date": 1433514084, "creation_date": 1433509598, "last_edit_date": 1433514084, "question_id": 30667337, "link": "https://stackoverflow.com/questions/30667337/go-add-backslash-in-front-of-characters", "title": "Go: add backslash in front of &#39;|&#39; characters", "body": "<p>I'm trying to replace all the instances of | in a string with \\| but when\nI try to do:</p>\n\n<pre><code>strings.Replace(f, \"|\". '\\|', -1)\n</code></pre>\n\n<p>I get: expected selector or type assertion, found 'CHAR' ' \\| ' error.</p>\n"}, {"tags": ["go", "fibonacci"], "comments": [{"owner": {"reputation": 1287, "user_id": 106275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/43vfP.png?s=128&g=1", "display_name": "Stein", "link": "https://stackoverflow.com/users/106275/stein"}, "edited": false, "score": 0, "creation_date": 1469299251, "post_id": 30665829, "comment_id": 64482258, "body": "What I didn&#39;t understand even more is how the <code>close(c)</code> is ever going to get executed. But it appears that in the <a href=\"https://tour.golang.org/concurrency/5\" rel=\"nofollow noreferrer\">current version</a> the close has disappeared, along with the type of parameter c. I would instead have clarified the types as <code>fibonacci(c chan&lt;- int, quit &lt;-chan int)</code> but I am a go-noob."}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 2, "last_activity_date": 1433505829, "last_edit_date": 1433505829, "creation_date": 1433505330, "answer_id": 30665943, "question_id": 30665829, "link": "https://stackoverflow.com/questions/30665829/fibonacci-in-go-using-channels/30665943#30665943", "title": "Fibonacci in Go using channels", "body": "<blockquote>\n  <p>there is always a value for x. So shouldn't select always fall on case 'c &lt;- x' ?</p>\n</blockquote>\n\n<p>No, because this channel is unbuffered, the send will block until someone can receive from it.</p>\n\n<p>Read about channels on <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow\">Effective Go</a>:</p>\n\n<blockquote>\n  <p>Receivers always block until there is data to receive. <strong>If the channel is unbuffered, the sender blocks until the receiver has received the value.</strong> If the channel has a buffer, the sender blocks only until the value has been copied to the buffer; if the buffer is full, this means waiting until some receiver has retrieved a value.</p>\n</blockquote>\n\n<p>Additionally, if 2 cases in a select statement could proceed, <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow\">one is picked pseudo-randomly</a>.</p>\n\n<blockquote>\n  <p>If one or more of the communications can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection. Otherwise, if there is a default case, that case is chosen. If there is no default case, the \"select\" statement blocks until at least one of the communications can proceed.</p>\n</blockquote>\n"}], "owner": {"reputation": 11061, "user_id": 419730, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UwQpu.png?s=128&g=1", "display_name": "Marin", "link": "https://stackoverflow.com/users/419730/marin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 30665943, "answer_count": 1, "score": 2, "last_activity_date": 1433505829, "creation_date": 1433505020, "last_edit_date": 1433505204, "question_id": 30665829, "link": "https://stackoverflow.com/questions/30665829/fibonacci-in-go-using-channels", "title": "Fibonacci in Go using channels", "body": "<p>I am following the examples on tour.golang.org.  </p>\n\n<p>I understand the example mostly, the only issue I have is why does it stop when we pass 0 to quit channel? Regardless of whether 0 was passed to quit,  there is always a value for x. So shouldn't select always fall on case 'c &lt;- x' ?</p>\n\n<pre><code>func fibonacci(c chan int, quit chan int) {\n    x, y := 0, 1\n    for {\n        select {\n        case c &lt;- x:\n            x, y = y, x+y\n        case &lt;-quit:\n            return\n        }\n    }\n    close(c)\n}\n\nfunc main() {\n    c := make(chan int)\n    quit := make(chan int)\n    go func() {\n        for i := 0; i &lt; 10; i++ {\n            fmt.Println(&lt;-c)\n        }\n        quit &lt;- 0\n    }()\n    fibonacci(c, quit)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1433503284, "post_id": 30664557, "comment_id": 49392376, "body": "What OS and Go version are you running?"}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 44, "last_activity_date": 1446674937, "last_edit_date": 1446674937, "creation_date": 1433504009, "answer_id": 30665482, "question_id": 30664557, "link": "https://stackoverflow.com/questions/30664557/http-get-returns-protocol-not-available-error/30665482#30665482", "title": "http.Get returns Protocol not available error", "body": "<p>The Go Playground does not allow HTTP requests. This has nothing to do with code. It is a security precaution enforced by the playground.</p>\n"}], "owner": {"reputation": 570, "user_id": 1093299, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cc1e335ed1e6094cb45f745d978cfb91?s=128&d=identicon&r=PG", "display_name": "Haibin Liu", "link": "https://stackoverflow.com/users/1093299/haibin-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6399, "favorite_count": 4, "closed_date": 1433546448, "accepted_answer_id": 30665482, "answer_count": 1, "score": 15, "last_activity_date": 1446674937, "creation_date": 1433501057, "question_id": 30664557, "link": "https://stackoverflow.com/questions/30664557/http-get-returns-protocol-not-available-error", "closed_reason": "Not suitable for this site", "title": "http.Get returns Protocol not available error", "body": "<p>When I try to run this example at <a href=\"http://golang.org/pkg/net/http/#example_Get\" rel=\"noreferrer\">http://golang.org/pkg/net/http/#example_Get</a>, it returns the following error</p>\n\n<blockquote>\n  <p>2009/11/10 23:00:00 Get <a href=\"http://www.google.com/robots.txt\" rel=\"noreferrer\">http://www.google.com/robots.txt</a>: dial tcp: Protocol not available</p>\n</blockquote>\n\n<p>Any idea why?</p>\n"}, {"tags": ["google-app-engine", "go", "app.yaml"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1433511643, "last_edit_date": 1433511643, "creation_date": 1433507645, "answer_id": 30666703, "question_id": 30664333, "link": "https://stackoverflow.com/questions/30664333/mixing-script-and-static-in-app-yaml/30666703#30666703", "title": "Mixing script and static in app.yaml", "body": "<p>Yes, it's possible for an app to serve both static files and dynamic content. Actually there's nothing magical required for it, this is normal for most web applications.</p>\n\n<p>Your configuration looks ok. One thing you should change: the package of your go file.</p>\n\n<p>Don't use package <code>main</code>, instead use another package and make sure your <code>.go</code> file is put into that. For example if you name your package <code>mypackage</code>, use this folder structure:</p>\n\n<pre><code>+ProjectRoot\n    app.yaml\n    +mypackage\n        myfile.go\n</code></pre>\n\n<p>And start your <code>myfile.go</code> with line:</p>\n\n<pre><code>package mypackage\n</code></pre>\n"}], "owner": {"reputation": 1271, "user_id": 3296660, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a76d22e6c17075af3579b14eacb95192?s=128&d=identicon&r=PG&f=1", "display_name": "Druxtan", "link": "https://stackoverflow.com/users/3296660/druxtan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1433511643, "creation_date": 1433500311, "question_id": 30664333, "link": "https://stackoverflow.com/questions/30664333/mixing-script-and-static-in-app-yaml", "title": "Mixing script and static in app.yaml", "body": "<p>I wish to use Google App Engine for serve static files and REST request in one application.</p>\n\n<p>I use this app.yaml\n</p>\n\n<pre><code>application: test\nversion: 1\nruntime: go\napi_version: go1\n\ndefault_expiration: \"7d 5h\"\n\nhandlers:\n- url: /(index.html)?\n  static_files: static/app/index.html\n  upload: static/app/index.html\n  http_headers:\n    Content-Type: text/html; charset=UTF-8\n\n- url: /\n  static_dir: static/app/\n  http_headers:\n    Vary: Accept-Encoding\n\n- url: /.*\n  script: _go_app\n</code></pre>\n\n<p>It works for static files, but I can't access to my script.</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/hello_world\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprint(w, \"Hello, world!\")\n}\n</code></pre>\n\n<p>It's possible? If yes, how I can to proceed?</p>\n"}, {"tags": ["git", "github", "parse-platform", "go", "travis-ci"], "comments": [{"owner": {"reputation": 2470, "user_id": 213272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06c4aca34fc7fd3eaa957d0e7ce66f9a?s=128&d=identicon&r=PG", "display_name": "Dominic Jodoin", "link": "https://stackoverflow.com/users/213272/dominic-jodoin"}, "edited": false, "score": 0, "creation_date": 1433508912, "post_id": 30662849, "comment_id": 49396107, "body": "Hi, based on some googling about the <code>git</code> error you are getting, can you try doing a <code>git fetch</code> before your <code>git checkout</code> command?"}], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 1, "last_activity_date": 1433515067, "creation_date": 1433515067, "answer_id": 30669284, "question_id": 30662849, "link": "https://stackoverflow.com/questions/30662849/default-git-master-branch-checkout-in-travis-ci-build-when-using-go-get/30669284#30669284", "title": "Default Git master branch checkout in Travis CI build when using go get", "body": "<p>The short answer is that No, you can't specify a branch or tag with <code>go get</code>. However, if you inspect the <a href=\"http://golang.org/src/cmd/go/vcs.go?s=2564:2598#L99\" rel=\"nofollow\">source of the <code>go</code> tool</a> you will see that it doesn't really specify <code>master</code> either when it's doing a clone. It just clones the repo. This is probably really a git/GitHub issue. </p>\n\n<p>Can you open a terminal and just clone that repo to some other location? Does it give you a complaint about not having the <code>master</code> branch? Repositories have a setting for which branch should be the default and if it's still defaulting to <code>master</code> even though you don't have one then you'll see the error. I reproduced this by making a GitHub repo without a master branch. I was able to fix it by going into my GitHub repo settings and specifying the default branch.</p>\n\n<p>Note: The <code>go get</code> command will specify the <code>master</code> branch if your local repo is in a detached head state. Looking at the output I don't think that's what's happening here.</p>\n"}], "owner": {"reputation": 161, "user_id": 4977134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f77ef5d861686e74bd617cdf48775e?s=128&d=identicon&r=PG", "display_name": "Joel Baudin", "link": "https://stackoverflow.com/users/4977134/joel-baudin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433515067, "creation_date": 1433496036, "question_id": 30662849, "link": "https://stackoverflow.com/questions/30662849/default-git-master-branch-checkout-in-travis-ci-build-when-using-go-get", "title": "Default Git master branch checkout in Travis CI build when using go get", "body": "<p>I'm having some difficulties getting my first attempts at an Travis CI build working. </p>\n\n<p>I'm using Parse(.com) as a backend and have then found an example of using Travis for build and deployment <a href=\"http://www.sheki.in/post/autodeploy-hugo/\" rel=\"nofollow\">here</a>. However having tried to set it up as best I could I now gotten to a problem which <em>Google</em> can't help with. </p>\n\n<p>I'm getting this error from the Travis CI build log.</p>\n\n<pre><code>....\n$ mkdir -p \"$TRAVIS_BUILD_DIR/gosrc\"\n$ mkdir -p \"$TRAVIS_BUILD_DIR/static\"\n$ curl -s https://www.parse.com/downloads/cloud_code/installer.sh | sudo /bin/bash\n$ go get -v github.com/xxxxx/xxxxxxx\ngithub.com/xxxxxx/xxxxxx (download)\ncd /home/travis/build/xxxxx/xxxxx/gosrc/src/github.com/xxxxxx/xxxxxx; git checkout master\n\nerror: pathspec 'master' did not match any file(s) known to git.\n\npackage github.com/xxxxx/xxxxxx: exit status 1\n\nThe command \"go get -v github.com/xxxxxx/xxxxxx\" failed and exited with 1 during .\nYour build has been stopped.\n</code></pre>\n\n<p>This is my install section of the .travis.yml file</p>\n\n<pre><code>install:\n- mkdir -p \"$TRAVIS_BUILD_DIR/gosrc\"\n- mkdir -p \"$TRAVIS_BUILD_DIR/static\"\n- curl -s https://www.parse.com/downloads/cloud_code/installer.sh | sudo /bin/bash\n- go get -v github.com/xxxxxx/xxxxxxx\n</code></pre>\n\n<p>My question is: Can you, when conducting a <strong>go get {git repo}</strong>, specify which branch it's supposed to checkout? So it doesn't default to master. If <strong>not</strong> is there a better way of doing this? </p>\n\n<p>Note: I don't have a master branch in my repository, having removed it some time ago because I didn't use it. Do I need to add one for this to work?</p>\n\n<p>Please let me know if the question is unclear or if it's missing some needed information.</p>\n\n<p>Thankful for any help! </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1433496488, "post_id": 30662848, "comment_id": 49388094, "body": "You&#39;re omitting the error returned by <code>os.OpenFile</code>, check it (!!!) I presume that it&#39;s not nil."}, {"owner": {"reputation": 1325, "user_id": 2422037, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5bf62e7d61fe2c3e9bc981a68ee5ac3e?s=128&d=identicon&r=PG", "display_name": "clinyong", "link": "https://stackoverflow.com/users/2422037/clinyong"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1433497303, "post_id": 30662848, "comment_id": 49388643, "body": "The error is nil here..."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1433497714, "post_id": 30662848, "comment_id": 49388881, "body": "Okay, then you&#39;re doing it correctly, hmm. Can you please post the exact error string that you get?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1433498482, "post_id": 30662848, "comment_id": 49389395, "body": "You did not open <code>f</code> with the correct permissions; you need to include the flag <code>os.O_WRONLY</code> or <code>os.O_RDWR</code>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433518586, "post_id": 30662848, "comment_id": 49403113, "body": "or if you don&#39;t need special flags or permissions just use <code>os.Create</code>"}, {"owner": {"reputation": 1325, "user_id": 2422037, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5bf62e7d61fe2c3e9bc981a68ee5ac3e?s=128&d=identicon&r=PG", "display_name": "clinyong", "link": "https://stackoverflow.com/users/2422037/clinyong"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1433554813, "post_id": 30662848, "comment_id": 49417511, "body": "@TimCooper\uff0cyou are right, thanks a lot."}], "answers": [{"tags": [], "owner": {"reputation": 1325, "user_id": 2422037, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5bf62e7d61fe2c3e9bc981a68ee5ac3e?s=128&d=identicon&r=PG", "display_name": "clinyong", "link": "https://stackoverflow.com/users/2422037/clinyong"}, "is_accepted": true, "score": 3, "last_activity_date": 1433554939, "creation_date": 1433554939, "answer_id": 30678115, "question_id": 30662848, "link": "https://stackoverflow.com/questions/30662848/execute-template-to-file/30678115#30678115", "title": "Execute template to file", "body": "<p>As @TimCooper said, I need to include <code>os.O_WRONLY</code> in <code>os.OpenFile</code>.</p>\n"}], "owner": {"reputation": 1325, "user_id": 2422037, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5bf62e7d61fe2c3e9bc981a68ee5ac3e?s=128&d=identicon&r=PG", "display_name": "clinyong", "link": "https://stackoverflow.com/users/2422037/clinyong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1783, "favorite_count": 0, "accepted_answer_id": 30678115, "answer_count": 1, "score": -1, "last_activity_date": 1433554939, "creation_date": 1433496036, "last_edit_date": 1433497346, "question_id": 30662848, "link": "https://stackoverflow.com/questions/30662848/execute-template-to-file", "title": "Execute template to file", "body": "<p>I have a template file <code>template.html</code> as follow</p>\n\n<pre><code>Hello {{.Name}}, welcome!\n</code></pre>\n\n<p>and the code</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"text/template\"\n)\nfunc main() {\n  type person struct {\n    Name string\n  }\n\n  p := &amp;person{\"clinyong\"}\n  t := template.Must(template.New(\"template.html\").ParseFiles(\"template.html\"))\n  f, err := os.OpenFile(\"test\", os.O_CREATE, 0777)\n  if err != nil {\n    fmt.Println(err)\n    return\n  }\n  defer f.Close()\n\n  err := t.Execute(f, p)\n  if err != nil {\n      fmt.Println(err)\n  }\n}\n</code></pre>\n\n<p><code>t.Execute(f, p)</code> calls a error, saying that f is a bad file descriptor. </p>\n\n<p>Is it possible to execute a template output to a file as shown above? I see some examples, the <code>f</code> in <code>Execute</code> is almost http.ResponseWriter or os.Stdout. </p>\n"}, {"tags": ["url", "go", "get", "parameter-passing", "url-parameters"], "answers": [{"comments": [{"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1433498353, "post_id": 30662697, "comment_id": 49389306, "body": "I&#39;m not the one who send the Url, I just get from another service"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 2, "creation_date": 1433498972, "post_id": 30662697, "comment_id": 49389696, "body": "Then you&#39;ll have to work with what you have (cutting <code>domain=site.come?a=val</code>) or call the other guy and tell him to fix his code because his query string is invalid."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1433500167, "post_id": 30662697, "comment_id": 49390421, "body": "He did the change he encoded the url and still the same problem when I get the domain it gave me just <b>domain=site.come?a=val</b> without the <b>&amp;b=val</b>"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1433502706, "post_id": 30662697, "comment_id": 49392009, "body": "I have edited my answer. The other guy probably did the encoding by hand and forgot to encode <code>&amp;</code> as well."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1433514325, "post_id": 30662697, "comment_id": 49400091, "body": "it&#39;s works but i used another he just put the domain between [ ] and it works perfectly"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 3, "last_activity_date": 1433502638, "last_edit_date": 1433502638, "creation_date": 1433495589, "answer_id": 30662697, "question_id": 30662512, "link": "https://stackoverflow.com/questions/30662512/golang-passing-a-url-as-a-get-parameter/30662697#30662697", "title": "Golang: Passing a URL as a GET parameter", "body": "<p>You need to URL-Encode your query string, <a href=\"http://play.golang.org/p/BqHo_cqUFk\" rel=\"nofollow\">like this</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n)\n\nfunc main() {\n    query := make(url.Values)\n    query.Add(\"domain\", \"example.com?foo=bar\")\n\n    fmt.Println(query.Encode())\n}\n</code></pre>\n\n<p>Which outputs <code>domain=example.com%3Ffoo%3Dbar</code>.</p>\n\n<p>You can set that string as a <code>RawQuery</code> of an <a href=\"http://golang.org/pkg/net/url/#URL\" rel=\"nofollow\"><code>url.URL</code></a> value and if you then access the query like you did, it will have the correct value.</p>\n\n<p>If the URL is correctly encoded then you should be able to run the <a href=\"http://play.golang.org/p/9sKnBD-mej\" rel=\"nofollow\">following code</a> with your URL value and get the correct result:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n)\n\nfunc main() {\n    query := make(url.Values)\n    query.Add(\"domain\", \"example.com?foo=bar&amp;abc=123&amp;jkl=qwe\")\n\n    url := &amp;url.URL{RawQuery: query.Encode(), Host: \"domain.com\", Scheme: \"http\"}\n    fmt.Println(url.String())\n\n    abc := url.Query().Get(\"domain\")\n    fmt.Println(abc)\n}\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>http://domain.com?domain=example.com%3Ffoo%3Dbar%26abc%3D123%26jkl%3Dqwe\n</code></pre>\n\n<p>(the complete URI with the encoded parameter called \"domain\")</p>\n\n<pre><code>example.com?foo=bar&amp;abc=123&amp;jkl=qwe\n</code></pre>\n\n<p>(the decoded value of said parameter)</p>\n"}], "owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4313, "favorite_count": 1, "accepted_answer_id": 30662697, "answer_count": 1, "score": 2, "last_activity_date": 1531958214, "creation_date": 1433495086, "last_edit_date": 1433495430, "question_id": 30662512, "link": "https://stackoverflow.com/questions/30662512/golang-passing-a-url-as-a-get-parameter", "title": "Golang: Passing a URL as a GET parameter", "body": "<p>I want to get an URL as a get aparameter</p>\n\n<p>ex: example.com?domain=site.come?a=val&amp;b=val</p>\n\n<p>the problem when i use </p>\n\n<pre><code>query := r.URL.Query()\ndomain := query.Get(\"domain\") \n</code></pre>\n\n<p>to get the domain name it give just <strong>domain=site.come?a=val</strong></p>\n\n<p>I think because when the r.URL.Query() meet <strong>&amp;</strong> it consider it as a new parameter</p>\n\n<p>does anyone know how can I solve this problem </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["database", "go", "key-value-store", "boltdb"], "comments": [{"owner": {"reputation": 1754, "user_id": 2739654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0d4b986bc43255b252b2c6adc2a7d670?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Scally", "link": "https://stackoverflow.com/users/2739654/dan-scally"}, "edited": false, "score": 2, "creation_date": 1433493317, "post_id": 30661777, "comment_id": 49386127, "body": "This is too broad a question - you should attempt to achieve your goal yourself and then when you hit specific problems ask for help overcoming those barriers."}], "answers": [{"tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": false, "score": 9, "last_activity_date": 1433531714, "creation_date": 1433531714, "answer_id": 30674149, "question_id": 30661777, "link": "https://stackoverflow.com/questions/30661777/does-boltdb-support-concurrent-queries-for-reading-and-updating-the-db/30674149#30674149", "title": "Does boltdb support concurrent queries for reading and updating the db?", "body": "<p>Generally, yes you can, provided you pay attention to the following points:</p>\n\n<ul>\n<li><p>all accesses should be done in their own transactions. Transactions should not be shared between goroutines (whether they are read-only or read-write).</p></li>\n<li><p>boltdb only tolerates one writer at a given point in time. If multiple concurrent transactions try to write at the same time, they will be serialized. The consistency of the database is guaranteed, but it has an impact on the performance, since write operations cannot be parallelized.</p></li>\n<li><p>read-only transactions are executed concurrently (and potentially parallelized).</p></li>\n<li><p>open only one transaction in a given goroutine at the same time to avoid deadlock situations.</p></li>\n</ul>\n"}], "owner": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1871, "favorite_count": 1, "closed_date": 1433778923, "answer_count": 1, "score": 4, "last_activity_date": 1433964410, "creation_date": 1433492743, "last_edit_date": 1433964410, "question_id": 30661777, "link": "https://stackoverflow.com/questions/30661777/does-boltdb-support-concurrent-queries-for-reading-and-updating-the-db", "closed_reason": "Needs details or clarity", "title": "Does boltdb support concurrent queries for reading and updating the db?", "body": "<p>Currently using <code>boltdb</code> for storing various entries in the bucket.</p>\n\n<p>How can I use Go language routines and channels concept in reading and updating in the db?</p>\n"}, {"tags": ["import", "go"], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1433486920, "post_id": 30659023, "comment_id": 49382505, "body": "<a href=\"https://golang.org/doc/effective_go.html#panic\" rel=\"nofollow noreferrer\">Effective Go</a> agrees on panicking: &quot;if the library truly cannot set itself up, it might be reasonable to panic, so to speak.&quot;"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1433487241, "post_id": 30659023, "comment_id": 49382683, "body": "Thank you, I have included your contribution in my answer."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 4, "last_activity_date": 1433487230, "last_edit_date": 1433487230, "creation_date": 1433482526, "answer_id": 30659023, "question_id": 30657985, "link": "https://stackoverflow.com/questions/30657985/how-to-capture-errors-when-importing-a-module-in-golang/30659023#30659023", "title": "How to capture errors when importing a module in Golang?", "body": "<p>Errors in Go are return values, as you may know. As init() does not return anything, the only alternative is to panic() in init if anything goes wrong.</p>\n\n<p>A package that panics on init is arguably not very well designed, although there may be valid use cases for this.</p>\n\n<p>Given the circumstances, recover() is not an option, because init is run before main. So if you can't edit the package in question, then you're out of luck.</p>\n\n<p>This is one of the reasons why panic and recover should be used sparingly, only in situations where literally \"panicking\" makes sense.</p>\n\n<p>@twotwotwo contributed the following quote from \"effective Go\" that describes this (for the init case):</p>\n\n<blockquote>\n  <p>if the library truly cannot set itself up, it might be reasonable to panic, so to speak</p>\n</blockquote>\n\n<p>So: if your init function needs to report an error, then ask yourself if that code really belongs in init or would be better kept somewhere else. If it really has to be init, consider setting an error flag inside of the package and document that any client must check that error.</p>\n"}, {"comments": [{"owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 0, "creation_date": 1433490216, "post_id": 30659042, "comment_id": 49384400, "body": "In my case, the module I imported expects some configuration file at a certain path, if the file is not present, it panics. I want to either capture the error (not possible) and record a log, or provide a fallback configuration file elsewhere. Can I change the conf file variable, and re-call the init() func?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 0, "creation_date": 1433490862, "post_id": 30659042, "comment_id": 49384757, "body": "@NeoWang You can&#39;t do anything before the package <code>init()</code> functions that your program depends on complete. You could alter the <code>init()</code> function of the external package. But if the package was written this way and you can&#39;t or don&#39;t want to modify the package source files, only thing you can do is make sure the expected configuration file exists before starting the application."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 0, "creation_date": 1433518369, "post_id": 30659042, "comment_id": 49402985, "body": "@NeoWang if it was me, I&#39;d either request an upstream change or fork the package to allow for something like <code>err := thirdPartyPackage.Config(filename&#47;or&#47;reader)</code> or at minimum to have an environment variable to override the location. Depending on what the third party package is/does, having an API with a statically located config file that needs to be present (and presumably also have &quot;correct&quot; contents) for startup of someone elses program is a bad design."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1433492220, "last_edit_date": 1433492220, "creation_date": 1433482657, "answer_id": 30659042, "question_id": 30657985, "link": "https://stackoverflow.com/questions/30657985/how-to-capture-errors-when-importing-a-module-in-golang/30659042#30659042", "title": "How to capture errors when importing a module in Golang?", "body": "<p>Yes, package <code>init()</code> functions run before the <code>main()</code> function, see <a href=\"https://golang.org/ref/spec#Package_initialization\" rel=\"nofollow\">Package initialization</a> in the language specification.</p>\n\n<p>And no, you can't handle errors occurred in package <code>init()</code> functions. Even if you could, that would mean a package your program depends on failed to initialize and you wouldn't know what to expect from it.</p>\n\n<p>Package <code>init()</code> functions have no return values and they can't panic in a meaningful way that was meant to recover from. If an <code>init()</code> function panics, the program terminates.</p>\n\n<p>Since <code>init()</code> functions are not called by you (e.g. from the <code>main()</code> function), you can't recover from there. It is the responsibility of the package itself to handle errors during its initialization, not the users of the package.</p>\n\n<p>One option to signal error happening during an <code>init()</code> is to store the error state in a variable (e.g. exported, or unexported but queryable by an exported function). But this should be used only if it is reasonable to continue, and this is also the task/responsibility of the package itself (to store/report the error) and not the users of the package. You can't do this without the cooperation of the package (you can't \"catch\" unhandled/unreported errors and panics).</p>\n"}, {"comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 3, "creation_date": 1433486776, "post_id": 30659965, "comment_id": 49382434, "body": "I understand your idea but there&#39;s a bug: <code>:=</code> will declare a local <code>InitErr</code> in init."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1433518029, "post_id": 30659965, "comment_id": 49402781, "body": "IMO, if you need this then you&#39;d be much better off moving to explicitly controlled initialization. E.g. <code>err := mypkg.Init()</code> or <code>x, err := mypkg.OpenSomething()</code> (kinda like <code>sql.Open</code>) or whatever."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1433495494, "last_edit_date": 1433495494, "creation_date": 1433486438, "answer_id": 30659965, "question_id": 30657985, "link": "https://stackoverflow.com/questions/30657985/how-to-capture-errors-when-importing-a-module-in-golang/30659965#30659965", "title": "How to capture errors when importing a module in Golang?", "body": "<p>Not directly, but you could using something like this:</p>\n\n<pre><code>package mypkg\n\nvar InitErr error\nvar Foo MyFoo\n\nfunc init() {\n    Foo, InitErr = makeInitialisation()\n    // ...\n}\n</code></pre>\n\n<p>And then in your main:</p>\n\n<pre><code>package main\n\nimport \"foo/bar/mypkg\"\n\nfunc main() {\n    if (mypkg.InitErr != nil) {\n        panic(err)\n    }\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "accepted_answer_id": 30659042, "answer_count": 3, "score": 4, "last_activity_date": 1433495494, "creation_date": 1433475705, "question_id": 30657985, "link": "https://stackoverflow.com/questions/30657985/how-to-capture-errors-when-importing-a-module-in-golang", "title": "How to capture errors when importing a module in Golang?", "body": "<p>In golang, when I import a module, its init() gets executed (before main() I assume?), it is possible some error is generated in this function. How can I capture these errors and handle them in my own code?</p>\n"}, {"tags": ["go", "endianness"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4973321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f6a7752f083efa02ce03bc639be06a?s=128&d=identicon&r=PG&f=1", "display_name": "Wei He", "link": "https://stackoverflow.com/users/4973321/wei-he"}, "edited": false, "score": 0, "creation_date": 1433502645, "post_id": 30662173, "comment_id": 49391969, "body": "Could you give a reason? Can I use armeb-linux-gcc to recompile go from source?"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 3, "last_activity_date": 1433502873, "last_edit_date": 1433502873, "creation_date": 1433494074, "answer_id": 30662173, "question_id": 30657603, "link": "https://stackoverflow.com/questions/30657603/can-i-compile-go-from-source-for-big-endian-arm/30662173#30662173", "title": "Can I compile go from source for big-endian arm?", "body": "<p>The answer is the one you got from minux on github:</p>\n\n<blockquote>\n  <p>Just FYI, Go doesn't support big endian ARM.</p>\n</blockquote>\n\n<p><a href=\"https://github.com/golang/go/issues/11079\" rel=\"nofollow\">https://github.com/golang/go/issues/11079</a></p>\n\n<p><sup>(As of June 5th 2015)</sup></p>\n\n<p>Edit: The reason is documented <a href=\"https://golang.org/doc/install/source\" rel=\"nofollow\">here</a>: the ARM architectures supported are all little-endian. Theoretically, you could contribute your own big-endian port but I don't think that will be trivial.</p>\n"}], "owner": {"reputation": 11, "user_id": 4973321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f6a7752f083efa02ce03bc639be06a?s=128&d=identicon&r=PG&f=1", "display_name": "Wei He", "link": "https://stackoverflow.com/users/4973321/wei-he"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433502873, "creation_date": 1433472650, "question_id": 30657603, "link": "https://stackoverflow.com/questions/30657603/can-i-compile-go-from-source-for-big-endian-arm", "title": "Can I compile go from source for big-endian arm?", "body": "<p>I know when building go can clarify GOARCH=arm, but how to set it for big-endian. Does it support?</p>\n"}, {"tags": ["memory-management", "memory-leaks", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1433486927, "post_id": 30657454, "comment_id": 49382508, "body": "FInding memory leaks is tricky in GCed language. Especially as the memory is not returned to the OS immediately. But I think it might be worth trying to close the Body. I just skimmed the source and didn&#39;t see an obvious close of Body."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1433494483, "post_id": 30657454, "comment_id": 49386820, "body": "@Volker normally the server will close the body (see <a href=\"http://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">Body</a> field). I think this is just &quot;normal&quot; allocation behavior. Although I&#39;m a little out of date since the switch to contiguous stacks."}], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 704936, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f1b17e044c65c423a29f7af17ceea3ea?s=128&d=identicon&r=PG", "display_name": "Michael Wasser", "link": "https://stackoverflow.com/users/704936/michael-wasser"}, "edited": false, "score": 1, "creation_date": 1433615909, "post_id": 30662461, "comment_id": 49432256, "body": "Thanks for this! I put my curl call in a loop and saw it capped out at 300 and would never grow beyond that. I had dismissed it as GC behavior as I tried forcing it to run, but I guess the GC doesn&#39;t always release memory even if the references have been released."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1433673514, "last_edit_date": 1433673514, "creation_date": 1433494953, "answer_id": 30662461, "question_id": 30657454, "link": "https://stackoverflow.com/questions/30657454/multipart-form-uploads-memory-leaks-in-golang/30662461#30662461", "title": "Multipart form uploads + memory leaks in golang?", "body": "<p>If the memory usage stagnates at a \"maximum\", I wouldn't really call that a memory leak. I would rather say the GC not being eager and being lazy. Or just don't want to physically free memory if it is frequently reallocated / needed. If it would be really a memory leak, used memory wouldn't stop at 300 MB.</p>\n\n<p><code>r.FormFile(\"file\")</code> will result in a call to <a href=\"https://golang.org/pkg/net/http/#Request.ParseMultipartForm\" rel=\"noreferrer\"><code>Request.ParseMultipartForm()</code></a>, and 32 MB will be used as the value of <code>maxMemory</code> parameter (the value of <code>defaultMaxMemory</code> variable defined in <code>request.go</code>). Since you upload a larger file (80 MB), a buffer of size 32 MB at least will be created - eventually (this is implemented in <a href=\"https://golang.org/pkg/mime/multipart/#Reader.ReadForm\" rel=\"noreferrer\"><code>multipart.Reader.ReadFrom()</code></a>). Since <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"noreferrer\"><code>bytes.Buffer</code></a> is used to read the content, the reading process will start with a small or empty buffer, and reallocate whenever a bigger is needed.</p>\n\n<p>The strategy of buffer reallocations and the buffer sizes are implementation dependent (and also depends on the size of the chunks being read/decoded from the request), but just to have a rough picture, imagine it like this: 0 bytes, 4 KB, 16 KB, 64 KB, 256 KB, 1 MB, 4 MB, 16 MB, 64 MB. Again, this is just theoretical, but illustrates that the sum  can even grow beyond 100 MB just to read the first 32 MB of the file in memory at which point it will be decided that it will be moved/stored in file. See the implementation of <a href=\"https://golang.org/pkg/mime/multipart/#Reader.ReadForm\" rel=\"noreferrer\"><code>multipart.Reader.ReadFrom()</code></a> for details. This reasonably explains the 96 MB allocation.</p>\n\n<p>Do this a couple of times, and without the GC releasing the allocated buffers immediately, you can easily end up with 300 MB. And if there is enough free memory, there is no pressure on the GC to hurry with releasing memory. The reason why you see it growing relatively big is because large buffers are used in the background. Would you do the same with uploading a 1MB file, you would probably not experience this.</p>\n\n<p>If it is important to you, you can also call <code>Request.ParseMultipartForm()</code> manually with a smaller <code>maxMemory</code> value, e.g.</p>\n\n<pre><code>r.ParseMultipartForm(2 &lt;&lt; 20) // 2 MB\nfile, _, err := r.FormFile(\"file\")\n// ... rest of your handler\n</code></pre>\n\n<p>Doing so much smaller (and fewer) buffers will be allocated in the background.</p>\n"}], "owner": {"reputation": 1600, "user_id": 704936, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f1b17e044c65c423a29f7af17ceea3ea?s=128&d=identicon&r=PG", "display_name": "Michael Wasser", "link": "https://stackoverflow.com/users/704936/michael-wasser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3336, "favorite_count": 0, "accepted_answer_id": 30662461, "answer_count": 1, "score": 5, "last_activity_date": 1433673514, "creation_date": 1433471571, "last_edit_date": 1433497235, "question_id": 30657454, "link": "https://stackoverflow.com/questions/30657454/multipart-form-uploads-memory-leaks-in-golang", "title": "Multipart form uploads + memory leaks in golang?", "body": "<p>The following server code:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n  file, _, err := r.FormFile(\"file\")\n  if err != nil {\n    fmt.Fprintln(w, err)\n    return\n  }\n  defer file.Close()\n\n  return\n}\n\nfunc main() {\n  http.ListenAndServe(\":8081\", http.HandlerFunc(handler))\n}\n</code></pre>\n\n<p>being run and then calling it with:</p>\n\n<pre><code>curl -i -F \"file=@./large-file\" --form hello=world http://localhost:8081/\n</code></pre>\n\n<p>Where the <code>large-file</code> is about 80MB seems to have some form of memory leak in Go 1.4.2 on darwin/amd64 and linux/amd64.</p>\n\n<p>When I hook up <code>pprof</code>, I see that <code>bytes.makeSlice</code> uses 96MB of memory after calling the service a few times (eventually called by <code>r.FormFile</code> in my code above).</p>\n\n<p>If I keep calling <code>curl</code>, the memory usage of the process grow slows over time, eventually seeming to stick around 300MB on my machine.</p>\n\n<p>Thoughts? I assume this isn't expected/ I'm doing something wrong?</p>\n"}, {"tags": ["struct", "go", "padding"], "comments": [{"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 1, "creation_date": 1433469680, "post_id": 30656844, "comment_id": 49376919, "body": "This <a href=\"http://golang.org/ref/spec#Size_and_alignment_guarantees\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Size_and_alignment_guarantees</a> might be helpful."}, {"owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "reply_to_user": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1433471988, "post_id": 30656844, "comment_id": 49377530, "body": "@alex Unless I&#39;m seriously misunderstanding something, the memory layout isn&#39;t relevant here, as <code>binary.Read</code> just reads the elements of the struct in order."}, {"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1433474656, "post_id": 30656844, "comment_id": 49378242, "body": "Perhaps this <a href=\"http://play.golang.org/p/bCfWmKTP25\" rel=\"nofollow noreferrer\">play.golang.org/p/bCfWmKTP25</a> will help."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1433474870, "post_id": 30656844, "comment_id": 49378294, "body": "Python&#39;s <a href=\"https://docs.python.org/2/library/struct.html\" rel=\"nofollow noreferrer\"><code>struct</code> library</a> is made to be compatible with C types, not Go types. Use <code>standard</code> aligning for platform-independent packing, as described in the linked documentation."}, {"owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "reply_to_user": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 0, "creation_date": 1433475076, "post_id": 30656844, "comment_id": 49378331, "body": "@alex That shows how the struct happens to be aligned in memory, but my point is that that isn&#39;t relevant to reading with <code>binary.Read</code>."}, {"owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "edited": false, "score": 1, "creation_date": 1433478974, "post_id": 30656844, "comment_id": 49379352, "body": "Sorry I didn&#39;t read the question properly. But to sum up my answer: Go struct memory layout is specified by the language spec. So you can make it whatever you want it to be. Padding with extra fields (like described below) sounds like a good plan."}], "answers": [{"comments": [{"owner": {"reputation": 19271, "user_id": 639165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c6e4f9908e8279241e41e6f204df940?s=128&d=identicon&r=PG", "display_name": "Derrick Zhang", "link": "https://stackoverflow.com/users/639165/derrick-zhang"}, "edited": false, "score": 0, "creation_date": 1433919652, "post_id": 30656982, "comment_id": 49552797, "body": "Could you explain why padding before D? I tried to padding after D before posting this, but the value is not right."}, {"owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "reply_to_user": {"reputation": 19271, "user_id": 639165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c6e4f9908e8279241e41e6f204df940?s=128&d=identicon&r=PG", "display_name": "Derrick Zhang", "link": "https://stackoverflow.com/users/639165/derrick-zhang"}, "edited": false, "score": 0, "creation_date": 1433921031, "post_id": 30656982, "comment_id": 49553730, "body": "That&#39;s just how Python was padding its output, to be aligned on 64-bit boundaries.  <code>4 &lt;&lt; 32</code> is <code>17179869184</code>, which is why that&#39;s what your first <code>D</code> came out as without skipping the padding first."}], "tags": [], "owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "is_accepted": true, "score": 7, "last_activity_date": 1433470540, "last_edit_date": 1433470540, "creation_date": 1433468154, "answer_id": 30656982, "question_id": 30656844, "link": "https://stackoverflow.com/questions/30656844/binary-read-does-not-handle-struct-padding-as-expected/30656982#30656982", "title": "binary.Read does not handle struct padding as expected", "body": "<p>You can just pad your Go struct to match:</p>\n\n<pre><code>type Index struct {\n    A int32\n    B int32\n    C int32\n    _ int32\n    D int64\n}\n</code></pre>\n\n<p>Which produces:</p>\n\n<pre><code>[]main.Index{main.Index{A:1, B:2, C:3, _:0, D:4}, main.Index{A:5, B:6, C:7, _:0, D:8}, main.Index{A:9, B:10, C:11, _:0, D:12}}\n</code></pre>\n\n<p><code>binary.Read</code> knows to skip the <code>_</code> field:</p>\n\n<blockquote>\n  <p>When reading into structs, the field data for fields with blank (_) field names is skipped; i.e., blank field names may be used for padding.</p>\n</blockquote>\n\n<p>(So the <code>0</code> values for <code>_</code> are not because the padding in the file was set to zero, but because the struct field was initialized to <code>0</code> and never changed, and the padding in the file was skipped rather than read.)</p>\n"}, {"comments": [{"owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "edited": false, "score": 1, "creation_date": 1433474940, "post_id": 30657865, "comment_id": 49378312, "body": "As long as you&#39;re comfortable using <code>unsafe</code>, which is called that for a reason.  There&#39;s no guarantee that Go&#39;s padding will be consistent across machines or versions.  You are here relying on the fact that (on your machine and Go version) Go is padding its struct just like the file."}], "tags": [], "owner": {"reputation": 19271, "user_id": 639165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c6e4f9908e8279241e41e6f204df940?s=128&d=identicon&r=PG", "display_name": "Derrick Zhang", "link": "https://stackoverflow.com/users/639165/derrick-zhang"}, "is_accepted": false, "score": -1, "last_activity_date": 1433474648, "creation_date": 1433474648, "answer_id": 30657865, "question_id": 30656844, "link": "https://stackoverflow.com/questions/30656844/binary-read-does-not-handle-struct-padding-as-expected/30657865#30657865", "title": "binary.Read does not handle struct padding as expected", "body": "<p>@Barber's solution is workable, but I found adding a padding field not so comfortable. And I found a better way of doing it.</p>\n\n<p>Below is the new golang read code which works perfectly:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"io\"\n    \"io/ioutil\"\n    \"unsafe\"\n)\n\ntype Index struct {\n    A int32\n    B int32\n    C int32\n    // Pad int32\n    D int64\n}\n\nfunc main() {\n    indexSize := unsafe.Sizeof(Index{})\n    fp, _ := os.Open(\"index.bin\")\n    defer fp.Close()\n    info, _ := fp.Stat()\n    fileSize := info.Size()\n    entryCnt := fileSize / int64(indexSize)\n\n    reader := io.Reader(fp)\n    allBytes, _ := ioutil.ReadAll(reader)\n    readSlice := *((*[]Index)(unsafe.Pointer(&amp;allBytes)))\n    realLen := len(allBytes) / int(indexSize)\n    readSlice = readSlice[:realLen]\n    fmt.Printf(\"After read:\\n%#v\\n\", readSlice)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>After read:\n[]main.Index{main.Index{A:1, B:2, C:3, D:4}, main.Index{A:5, B:6, C:7, D:8}, main.Index{A:9, B:10, C:11, D:12}}\n</code></pre>\n\n<p>This solution needs no explicit padding field.</p>\n\n<p>The essence here is that if you let golang convert the whole bytes to a slice of <code>Index</code> struct, it seems to be able to handle the padding well.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433519290, "post_id": 30670524, "comment_id": 49403508, "body": "I&#39;m curious if there is a reason for <code>io.ReadAtLeast(r, buf[:], len(buf))</code> vs <code>io.ReadFull(r, buf[:])</code>? The semantics in this context are the same but the later is more readable here."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1433520110, "post_id": 30670524, "comment_id": 49403986, "body": "@DaveC: <code>ReadFull</code> is a special form of <code>ReadAtLeast</code>. Fixed."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1433519761, "last_edit_date": 1433519761, "creation_date": 1433518631, "answer_id": 30670524, "question_id": 30656844, "link": "https://stackoverflow.com/questions/30656844/binary-read-does-not-handle-struct-padding-as-expected/30670524#30670524", "title": "binary.Read does not handle struct padding as expected", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"encoding/binary\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\ntype Index struct {\n    A int32\n    B int32\n    C int32\n    D int64\n}\n\nfunc readIndex(r io.Reader) (Index, error) {\n    var index Index\n    var buf [24]byte\n    _, err := io.ReadFull(r, buf[:])\n    if err != nil {\n        return index, err\n    }\n    index.A = int32(binary.LittleEndian.Uint32(buf[0:4]))\n    index.B = int32(binary.LittleEndian.Uint32(buf[4:8]))\n    index.C = int32(binary.LittleEndian.Uint32(buf[8:12]))\n    index.D = int64(binary.LittleEndian.Uint64(buf[16:24]))\n    return index, nil\n}\n\nfunc main() {\n    f, err := os.Open(\"index.bin\")\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    defer f.Close()\n    r := bufio.NewReader(f)\n    indexes := make([]Index, 0, 1024)\n    for {\n        index, err := readIndex(r)\n        if err != nil {\n            if err == io.EOF {\n                break\n            }\n            fmt.Fprintln(os.Stderr, err)\n            return\n        }\n        indexes = append(indexes, index)\n    }\n    fmt.Println(indexes)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[{1 2 3 4} {5 6 7 8} {9 10 11 12}]\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>00000000  01 00 00 00 02 00 00 00  03 00 00 00 00 00 00 00  |................|\n00000010  04 00 00 00 00 00 00 00  05 00 00 00 06 00 00 00  |................|\n00000020  07 00 00 00 00 00 00 00  08 00 00 00 00 00 00 00  |................|\n00000030  09 00 00 00 0a 00 00 00  0b 00 00 00 00 00 00 00  |................|\n00000040  0c 00 00 00 00 00 00 00                           |........|\n</code></pre>\n"}], "owner": {"reputation": 19271, "user_id": 639165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3c6e4f9908e8279241e41e6f204df940?s=128&d=identicon&r=PG", "display_name": "Derrick Zhang", "link": "https://stackoverflow.com/users/639165/derrick-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 2, "accepted_answer_id": 30656982, "answer_count": 3, "score": 2, "last_activity_date": 1433519761, "creation_date": 1433467201, "last_edit_date": 1433473622, "question_id": 30656844, "link": "https://stackoverflow.com/questions/30656844/binary-read-does-not-handle-struct-padding-as-expected", "title": "binary.Read does not handle struct padding as expected", "body": "<p>In a recent Go project I need to read a binary data file generated by Python, but due to padding, <code>binary.Read</code> in Go doesn't read it properly. Below is a minimal example of my problem.</p>\n\n<p>The struct I deal with if of the following format</p>\n\n<pre><code>type Index struct{\n    A int32\n    B int32\n    C int32\n    D int64\n}\n</code></pre>\n\n<p>As you can see the size of the struct is 4+4+4+8=20, but Python added an extra 4 bytes for alignment. So the size is actually 24.</p>\n\n<p>Below is the runnable Python code I use to write this struct:</p>\n\n<pre><code>#!/usr/bin/env python\n# encoding=utf8\n\nimport struct\n\nif __name__ == '__main__':\n    data = range(1, 13)\n    format = 'iiiq' * 3\n    content = struct.pack(format, *data)\n    with open('index.bin', 'wb') as f:\n        f.write(content)\n</code></pre>\n\n<p>the <code>iiiq</code> format means there are three 32 bit integers and one 64 bit integer in the struct, which is the same with the <code>Index</code> struct I defined earlier. And running this code will generate a file named <code>index.bin</code> of size 72, which equals to 24 * 3.</p>\n\n<p>And below is the Go code I use to read <code>index.bin</code>:</p>\n\n<pre><code>package main\n\nimport (\n        \"encoding/binary\"\n        \"fmt\"\n        \"os\"\n        \"io\"\n        \"unsafe\"\n)\n\ntype Index struct {\n        A int32\n        B int32\n        C int32\n        D int64\n}\n\nfunc main() {\n        indexSize := unsafe.Sizeof(Index{})\n        fp, _ := os.Open(\"index.bin\")\n        defer fp.Close()\n        info, _ := fp.Stat()\n        fileSize := info.Size()\n        entryCnt := fileSize / int64(indexSize)\n        fmt.Printf(\"entry cnt: %d\\n\", entryCnt)\n\n        readSlice := make([]Index, entryCnt)\n        reader := io.Reader(fp)\n        _ = binary.Read(reader, binary.LittleEndian, &amp;readSlice)\n        fmt.Printf(\"After read:\\n%#v\\n\", readSlice)\n}\n</code></pre>\n\n<p>And this is the output:</p>\n\n<pre><code>entry cnt: 3\nAfter read:\n[]main.Index{main.Index{A:1, B:2, C:3, D:17179869184}, main.Index{A:0, B:5, C:6, D:7}, main.Index{A:8, B:0, C:9, D:47244640266}}\n</code></pre>\n\n<p>Obviously the output is messed up when reading from the Python generated file.</p>\n\n<p>So my question is, how can I read the python generated file(with padding) in Go properly?</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1433491937, "post_id": 30656537, "comment_id": 49385339, "body": "As is, your method doesn&#39;t make sense: you don&#39;t use the parameter for anything, and the check isn&#39;t related. Makes me think that it should be a function at all\u2026"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 4891517, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71e2a6293b83f5da7fd6709b50444880?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Morks", "link": "https://stackoverflow.com/users/4891517/karsten-morks"}, "edited": false, "score": 0, "creation_date": 1433570008, "post_id": 30661322, "comment_id": 49419929, "body": "You&#39;re right. I&#39;m still new to testing, Maybe this method wasn&#39; t a good example. I wanted to ask for a general way to do this kind of &quot;spying&quot;. Because I often times have these methods which just don&#39;t return and only call another method. For example a method, which listens on a channnel, processes the received data and invokes another method with this data as arguments."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1433491108, "creation_date": 1433491108, "answer_id": 30661322, "question_id": 30656537, "link": "https://stackoverflow.com/questions/30656537/testing-non-returning-method-in-go/30661322#30661322", "title": "testing non returning method in go", "body": "<p>First: You wouldn't name a method \"doFunctionOne\" but \"methodOne\" :-)</p>\n\n<p>If neither doFunctionOne nor doFunctionTwo has any observable effect, then there is absolutely no point in testing it. So we may assume that they do have observable side effect, either on the environment or on the customType they have been invoked on.</p>\n\n<p>Now just test these side effects. This is trivial if both methods do return. If they spin up an endless loop it becomes harder, but still doable.</p>\n\n<p>IMHO there is no need to \"test\" this method in the sense of \"test whether it calls One or Two depending on value\": For me this is to lowlevel, too much increasing coverage count for nothing. If you call some method it has to do something (observable effect) and you should check this effect, not the inner workings.</p>\n"}, {"tags": [], "owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "is_accepted": false, "score": 2, "last_activity_date": 1433492290, "creation_date": 1433492290, "answer_id": 30661652, "question_id": 30656537, "link": "https://stackoverflow.com/questions/30656537/testing-non-returning-method-in-go/30661652#30661652", "title": "testing non returning method in go", "body": "<p>The idiomatic way of mocking an object in Go is to make it explicit. A healthy interface should be testable by itself. So if we have something like this:</p>\n\n<pre><code>type customType struct {\n    value int\n}\n\nfunc (c customType) doFunctionOne() {\n    fmt.Println(\"Method #1\")\n}\n\nfunc (c customType) doFunctionTwo() {\n    fmt.Println(\"Method #2\")\n}\n\nfunc (c customType) someMethod() {\n    if c.value &lt;= 0 {\n        c.doFunctionOne()\n    } else {\n        c.doFunctionTwo()\n    }\n}\n</code></pre>\n\n<p>We have to provide a way to change the implementation of <code>doFunctionOne</code> and <code>doFunctionTwo</code> explicitly. We can generalize the <code>someMethod</code> behavior using interfaces:</p>\n\n<pre><code>type customType struct {\n    myValue int\n}\n\nfunc (c customType) doFunctionOne() {\n    fmt.Println(\"Method #1\")\n}\n\nfunc (c customType) doFunctionTwo() {\n    fmt.Println(\"Method #2\")\n}\n\nfunc (c customType) value() int {\n    return c.myValue\n}\n\ntype Interface interface {\n    value() int\n    doFunctionOne()\n    doFunctionTwo()\n}\n\nfunc someMethod(i Interface) {\n    if i.value() &lt;= 0 {\n        i.doFunctionOne()\n    } else {\n        i.doFunctionTwo()\n    }\n}\n\ntype customTestingType struct {\n    t *testing.T\n}\n\nfunc (c customTestingType) doFunctionOne() {\n    c.t.Log(\"Working\")\n}\n\nfunc (c customTestingType) doFunctionTwo() {\n    c.t.Error(\"Not working\")\n}\n\nfunc (c customTestingType) value() int {\n    return 0\n}\n\nfunc TestInterface(t *testing.T) {\n    someMethod(customTestingType{t})\n}\n</code></pre>\n\n<p>Surely there will be more ways to provide this behavior but it depends on the particular declaration of your type. As an example, you can look at  <a href=\"http://golang.org/pkg/net/http/httptest/\" rel=\"nofollow\"><code>httptest</code></a> package. That said, if you really want to mock your type in that way (nonidiomatic), you can some <a href=\"https://github.com/bouk/monkey\" rel=\"nofollow\">unsafe monkey patching</a>:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n\n    \"github.com/bouk/monkey\"\n)\n\ntype customType struct {\n    myValue int\n}\n\nfunc (c customType) doFunctionOne() {\n    fmt.Println(\"Method #1\")\n}\n\nfunc (c customType) doFunctionTwo() {\n    fmt.Println(\"Method #2\")\n}\n\nfunc (c customType) someMethod() {\n    if c.myValue &lt;= 0 {\n        c.doFunctionOne()\n    } else {\n        c.doFunctionTwo()\n    }\n}\n\nfunc main() {\n    c := customType{0}\n    monkey.PatchInstanceMethod(reflect.TypeOf(c), \"doFunctionOne\",\n        func(c customType) {\n            fmt.Println(\"Method #1, but patched\")\n        })\n    monkey.PatchInstanceMethod(reflect.TypeOf(c), \"doFunctionTwo\",\n        func(c customType) {\n            fmt.Println(\"Method #2, but patched\")\n        })\n    c.someMethod()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "is_accepted": false, "score": 0, "last_activity_date": 1433750922, "creation_date": 1433750922, "answer_id": 30704060, "question_id": 30656537, "link": "https://stackoverflow.com/questions/30656537/testing-non-returning-method-in-go/30704060#30704060", "title": "testing non returning method in go", "body": "<ol>\n<li>You can add log before each function call.  </li>\n<li>Inject your own logger implementation, []string for example.  </li>\n<li>Check the string slice for a matching strings.</li>\n</ol>\n\n<p>But, if you are creating a function factory it would be better if you return the function to the caller and the caller will run the function.<br>\nThen testing is straightforward. </p>\n\n<p>Second but, there is only two kind of functions, flow function and logic functions.\nYou mixed flow and logic in the same function.\nTesting difficulty is just one symptom of this bad practice. </p>\n"}], "owner": {"reputation": 165, "user_id": 4891517, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71e2a6293b83f5da7fd6709b50444880?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Morks", "link": "https://stackoverflow.com/users/4891517/karsten-morks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1249, "favorite_count": 0, "accepted_answer_id": 30661322, "answer_count": 3, "score": 3, "last_activity_date": 1433750922, "creation_date": 1433464862, "question_id": 30656537, "link": "https://stackoverflow.com/questions/30656537/testing-non-returning-method-in-go", "title": "testing non returning method in go", "body": "<p>I have a simple method, which just checks if a parameter is empty and then calls one of 2 methods based on a struct field.<br>\nHow would I test it?</p>\n\n<pre><code>func (cT *customType) someMethod(message string) {\n    if message == \"\"{\n        return\n    }\n\n    if cT.value == nil {\n        cT.doFunctionOne()\n    } else {\n        cT.doFunctionTwo()\n    }\n}\n</code></pre>\n\n<p>In Javascript, I would create a spy on <code>doFunctionOne()</code> and mock up the object.<br>\nMocking up works well in <code>Go</code> as well, but how would I do the 'spying' part?<br>\nOr is there another idiomatic way to test this kind of method?</p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1433459123, "post_id": 30655426, "comment_id": 49374085, "body": "Post your code with your connection pool/setup detailed."}, {"owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1433459609, "post_id": 30655426, "comment_id": 49374219, "body": "@elithrar I have 1 connection per redis server with no pool. I just want to know if it&#39;s ok to flush commands to redis without calling receive."}], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "edited": false, "score": 0, "creation_date": 1433661676, "post_id": 30655836, "comment_id": 49441034, "body": "thank you man. just one more thing, I interested in ignoring the response from the redis server in order to speed up things, also, I don&#39;t care so much about a few images getting lost due to some errors. do you know about a way to disable the redis server from replying to every commands?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "edited": false, "score": 0, "creation_date": 1433720275, "post_id": 30655836, "comment_id": 49457217, "body": "@eladm26 The Redis server does not provide a way to ignore errors.  It&#39;s easy for the application to receive and discard responses from the server. See my updated answer."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1433720124, "last_edit_date": 1433720124, "creation_date": 1433460205, "answer_id": 30655836, "question_id": 30655426, "link": "https://stackoverflow.com/questions/30655426/using-go-redis-client-redigo/30655836#30655836", "title": "using Go redis client (Redigo)", "body": "<p>An application must call Receive to clear the responses from the server and to check for errors. If the application is not pipelining commands, then it's best to call Do. Do combines Send, Flush and Receive.</p>\n\n<p>If you don't care about errors, then start a goroutine to read the responses:</p>\n\n<pre><code>go func(c redis.Conn) {\n   for c.Err() == nil {\n       c.Receive()\n   }\n}()\n</code></pre>\n"}], "owner": {"reputation": 471, "user_id": 2959585, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PAepQ.jpg?s=128&g=1", "display_name": "eladm26", "link": "https://stackoverflow.com/users/2959585/eladm26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1317, "favorite_count": 0, "accepted_answer_id": 30655836, "answer_count": 1, "score": 0, "last_activity_date": 1433720124, "creation_date": 1433457642, "question_id": 30655426, "link": "https://stackoverflow.com/questions/30655426/using-go-redis-client-redigo", "title": "using Go redis client (Redigo)", "body": "<p>I'm using GO redis client redigo to write image to ~20 redis servers.<br>\nspeed is an important factor here and I'm just sending set commands to the redis so I'm using Send and Flush without calling Receive.<br>\nafter a few hours I'm getting \"connection reset by peer\" on the client.<br>\nI was wondering, does it have something to do with the fact that I don't call Receive?<br>\nmaybe my RX queue just getting to its max capacity because I don't empty it with Receive?  </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1433456276, "post_id": 30655143, "comment_id": 49372989, "body": "Even if you could call &quot;source&quot;, you can&#39;t change the parent process environment. Exactly what effect are you trying to accomplish?"}, {"owner": {"reputation": 18043, "user_id": 405013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ef3cd04888c6d17f34d43e29ec3d46f?s=128&d=identicon&r=PG", "display_name": "caarlos0", "link": "https://stackoverflow.com/users/405013/caarlos0"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433458803, "post_id": 30655143, "comment_id": 49373971, "body": "Sad :/ Antigen is a plugin manager for ZSH... so, basically, it git pulls repositories and source the *.plugin.zsh file..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433464232, "post_id": 30655143, "comment_id": 49375565, "body": "What&#39;s sad? That&#39;s just how shells work. The whole point of antigen is to execute shell code in your shell."}, {"owner": {"reputation": 18043, "user_id": 405013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ef3cd04888c6d17f34d43e29ec3d46f?s=128&d=identicon&r=PG", "display_name": "caarlos0", "link": "https://stackoverflow.com/users/405013/caarlos0"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433465988, "post_id": 30655143, "comment_id": 49376049, "body": "Yeah, but it&#39;s slow. I hacked it a little, and got a &quot;simplified&quot; version working 5 times faster than antigen does: <a href=\"https://github.com/caarlos0/antibody\" rel=\"nofollow noreferrer\">github.com/caarlos0/antibody</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1433519647, "post_id": 30655143, "comment_id": 49403718, "body": "If theres real work that could be sped up with Go (I haven&#39;t read through the code at all), you could output the final variables, function defs, etc. you need on stdout, and wrap the Go command in an <code>eval</code>."}, {"owner": {"reputation": 18043, "user_id": 405013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ef3cd04888c6d17f34d43e29ec3d46f?s=128&d=identicon&r=PG", "display_name": "caarlos0", "link": "https://stackoverflow.com/users/405013/caarlos0"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433529832, "post_id": 30655143, "comment_id": 49409133, "body": "Yeah, that&#39;s basically what I did :) thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1433516056, "post_id": 30657036, "comment_id": 49401399, "body": "While an interesting hack,  your example doesn&#39;t work on any of the systems I tried (I think the input queue needs to be flushed, all I&#39;m getting is an <code>e</code>). But if you&#39;re wrapping this in a shell script, why not just output something that the shell can <code>eval</code>? Also, <code>fmt.Errorf</code> only creates an <code>error</code> value, it doesn&#39;t print anything."}, {"owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1433519885, "post_id": 30657036, "comment_id": 49403857, "body": "@JimB Sorry, I have forgotten that <code>syscall.Syscall</code> function returns an error even when there is no error. Now it should work."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1433520266, "post_id": 30657036, "comment_id": 49404057, "body": "Oh, of course. I missed it too, even when I looked at errno == 0. Anyway, I&#39;d still rather use stdout and <code>eval</code> if I had to do something along these lines."}, {"owner": {"reputation": 18043, "user_id": 405013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ef3cd04888c6d17f34d43e29ec3d46f?s=128&d=identicon&r=PG", "display_name": "caarlos0", "link": "https://stackoverflow.com/users/405013/caarlos0"}, "edited": false, "score": 0, "creation_date": 1433529888, "post_id": 30657036, "comment_id": 49409156, "body": "Nice hack! I end up using a different approach. Thanks anyways!"}], "tags": [], "owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "is_accepted": true, "score": 0, "last_activity_date": 1433519995, "last_edit_date": 1433519995, "creation_date": 1433468595, "answer_id": 30657036, "question_id": 30655143, "link": "https://stackoverflow.com/questions/30655143/call-source-from-inside-a-go-program/30657036#30657036", "title": "Call source from inside a Go program", "body": "<p>You can write the command directly in the terminal device. But, to do that, first you need to know which device is using the user.  A script that executes your program can be a solution.</p>\n\n<pre><code>#!/bin/bash\necho Running from foo script, pid = $$\ngo run foo.go `tty`\n</code></pre>\n\n<p>Then, the program has to write the commands to the terminal device.</p>\n\n<pre><code>package main\n\nimport (\n    \"C\"\n    \"fmt\"\n    \"os\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nfunc main() {\n    // Get tty path\n    if len(os.Args) &lt; 2 {\n        fmt.Printf(\"no tty path\\n\")\n        os.Exit(1)\n    }\n    ttyPath := os.Args[1]\n\n    // Open tty\n    tty, err := os.Open(ttyPath)\n    if err != nil {\n        fmt.Printf(\"error opening tty: %s\\n\", err.Error())\n        os.Exit(2)\n    }\n    defer tty.Close()\n\n    // Write a command\n    cmd := \"echo Hello from go, pid = $$\\n\"\n    cmdstr := C.CString(cmd)\n    cmdaddr := uintptr(unsafe.Pointer(cmdstr))\n    for i := range []byte(cmd) {\n        _, _, err := syscall.Syscall(syscall.SYS_IOCTL, tty.Fd(), syscall.TIOCSTI, cmdaddr+uintptr(i))\n        if uintptr(err) != 0 {\n            fmt.Printf(\"syscall error: %s\\n\", err.Error())\n            os.Exit(3)\n        }\n    }\n}\n</code></pre>\n\n<p>Here is an example output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ echo $$\n70318\n$ ./foo \nRunning from foo script, pid = 83035\necho Hello from go, pid = $$\n$ echo Hello from go, pid = $$\nHello from go, pid = 70318\n</code></pre>\n\n<p>Note that I am executing the script with <code>./</code> not <code>source</code>, so the PID of the script differs. But later, the command executed by the go program has the same PID.</p>\n"}], "owner": {"reputation": 18043, "user_id": 405013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ef3cd04888c6d17f34d43e29ec3d46f?s=128&d=identicon&r=PG", "display_name": "caarlos0", "link": "https://stackoverflow.com/users/405013/caarlos0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 30657036, "answer_count": 1, "score": 0, "last_activity_date": 1433519995, "creation_date": 1433456165, "question_id": 30655143, "link": "https://stackoverflow.com/questions/30655143/call-source-from-inside-a-go-program", "title": "Call source from inside a Go program", "body": "<p>For fun and to better learn Go, I'm trying to re-implement antigen in Go.</p>\n\n<p>Problem is: <code>source</code> is a shell built-in function, so I can't call it with <code>os/exec</code> <code>Command</code> function, because it expects an executable in <code>PATH</code>.</p>\n\n<p>How can I do this? And, is it possible to make a <code>source</code> from inside a go program affect the user shell?</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 0, "creation_date": 1433450067, "post_id": 30653478, "comment_id": 49370287, "body": "make a call to <code>SELECT DATABASE();</code> and see where you are"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 0, "creation_date": 1433450202, "post_id": 30653478, "comment_id": 49370362, "body": "wait so db.Prepare(&quot;SELECT DATABASE()&quot;), and then what?"}, {"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 0, "creation_date": 1433450291, "post_id": 30653478, "comment_id": 49370405, "body": "then like execute it ?"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 0, "creation_date": 1433450379, "post_id": 30653478, "comment_id": 49370445, "body": "got it, it shows that I&#39;m in the right database, which is education_data"}], "answers": [{"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433451024, "post_id": 30653807, "comment_id": 49370766, "body": "So I printed out splitStr[0] and splitStr[1] and they were both string values"}, {"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433451058, "post_id": 30653807, "comment_id": 49370784, "body": "those i can understand. it is the <code>districtId</code>, <code>activityId</code>, and <code>sub_activityId</code>"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433451198, "post_id": 30653807, "comment_id": 49370847, "body": "so I commented everything out apart from the stuff for stmt1 and stmt2, and still nothing.   I do a SELECT * from activities, and I get this output -  mysql&gt; SELECT * FROM activities; Empty set (0.00 sec)"}, {"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433451309, "post_id": 30653807, "comment_id": 49370907, "body": "i believe that it is in the preparing of the statement (with 0 or no values in key variables) that causes the insert stmt to fail. Can you echo out during normal execution somewhere what the values are of the above 3 variables. i just don&#39;t understand where they are being set. For instance, where is <code>activityId</code> being set by you?"}, {"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433451370, "post_id": 30653807, "comment_id": 49370945, "body": "i say this as a non-go programmer so keep that in mind"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433451400, "post_id": 30653807, "comment_id": 49370965, "body": "well what if I replaced \t\t\t\tstmt1, _ := db.Prepare(&quot;INSERT INTO activities(code) VALUES(?)&quot;)  with &quot;INSERT INTO activities(code) VALUES(&quot; + splitStr[0] + &quot;)&quot;?"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 0, "creation_date": 1433451437, "post_id": 30653807, "comment_id": 49370984, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/79701/discussion-between-praks5432-and-drew-pierce\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "is_accepted": true, "score": 1, "last_activity_date": 1569432993, "last_edit_date": 1569432993, "creation_date": 1433450688, "answer_id": 30653807, "question_id": 30653478, "link": "https://stackoverflow.com/questions/30653478/golang-mysql-prepare-insert-statements-do-not-add-rows-into-db-table/30653807#30653807", "title": "Golang: Mysql Prepare Insert statements do not add rows into db table", "body": "<p>As you are trying to insert into a table, I was reminded (in chat at least) that your columns are non-null and you really meant to create one row when you were in fact creating two. It failed on <code>stmt1</code> and <code>stmt2</code> because non-nullable columns were not given parameters to replace for all necessary data for insertion to succeed.</p>\n\n<p>Focus on creating one row for <code>stmt1</code> and <code>stmt2</code> (combine them into a single <code>stmt1</code> to execute with 2 parameters).</p>\n\n<p>Make sure strings are wrapped with a single quote.</p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3148, "favorite_count": 0, "accepted_answer_id": 30653807, "answer_count": 1, "score": 2, "last_activity_date": 1569473771, "creation_date": 1433449551, "last_edit_date": 1569473771, "question_id": 30653478, "link": "https://stackoverflow.com/questions/30653478/golang-mysql-prepare-insert-statements-do-not-add-rows-into-db-table", "title": "Golang: Mysql Prepare Insert statements do not add rows into db table", "body": "<p>So I'm trying to use a mysql driver to insert data into a database. </p>\n\n<p>Specifically, I'm using this one: </p>\n\n<pre><code>\"github.com/go-sql-driver/mysql\"\n</code></pre>\n\n<p>This is my code</p>\n\n<pre><code>func main() {\n\n    db, err := sql.Open(\"mysql\", \"psanker:123@/education_data\")\n    err = db.Ping()\n\n    if err != nil {\n        fmt.Println(\"Failed to prepare connection to database\")\n        log.Fatal(\"Error:\", err.Error())\n    }\n\n    defer db.Close()\n\n    content, err := ioutil.ReadFile(\"activities.csv\")\n\n    lines := strings.Split(string(content), \"\\r\")\n\n    //only work so long as I have one district\n    rows, err := db.Query(\"SELECT id FROM districts\")\n    var districtId int\n    defer rows.Close()\n\n    for rows.Next() {\n        err := rows.Scan(&amp;districtId)\n        check(err)\n    }\n\n\n    for i, line := range lines {\n        if i &gt; 1 {\n            splitStr := strings.Split(line, \",\")\n            var activityCode string\n\n            if strings.Contains(splitStr[0], \"-\") {\n                //this is an activity\n                activityCode = splitStr[0]\n                stmt1, _ := db.Prepare(\"INSERT INTO activities(code) VALUES(?)\")\n                stmt2, _ := db.Prepare(\"INSERT INTO activities(name) VALUES(?)\")\n                res, _ := stmt1.Exec(splitStr[0])\n                stmt2.Exec(splitStr[1])\n            } else {\n                //this is a sub activity\n                stmt1, _ := db.Prepare(\"INSERT INTO sub_activities(code) VALUES(?)\")\n                stmt2, _ := db.Prepare(\"INSERT INTO sub_activities(name) VALUES(?)\")\n                stmt1.Exec(splitStr[0])\n                stmt2.Exec(splitStr[1])\n                if activityCode != \"\" {\n                    rows, _ := db.Query(\"SELECT id from activities where code = ?\", activityCode)\n                    var activityId int\n                    for rows.Next() {\n                        err := rows.Scan(&amp;activityId)\n                        check(err)\n                        stmt3, err := db.Prepare(\"INSERT INTO sub_activities(activity_id) VALUES(?)\")\n                        stmt3.Exec(activityId)\n                    }\n                }\n                rows, _ := db.Query(\"SELECT id from sub_activities where code= ?\", splitStr[0])\n                var sub_activityId int\n                for rows.Next() {\n                    err := rows.Scan(&amp;sub_activityId)\n                    check(err)\n                    stmt5, _ := db.Prepare(\"INSERT INTO sub_activity_expenditure(district_id) VALUES(?)\")\n                    stmt6, _ := db.Prepare(\"INSERT INTO sub_activity_expenditure(sub_activity_id) VALUES(?)\")\n                    stmt7, _ := db.Prepare(\"INSERT INTO sub_activity_expenditure(expenditure) VALUES(?)\")\n                    stmt5.Exec(districtId)\n                    stmt6.Exec(sub_activityId)\n                    stmt7.Exec(splitStr[2])\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>When I check Mysql database, there are no rows inserted into the tables. I think I'm accessing the right database because the initial query that gets id from districts is returning 1, which is correct. </p>\n\n<p>What's going on? </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have confirmed I'm in the right db by doing this </p>\n\n<pre><code>rows, err = db.Query(\"SELECT DATABASE();\")\nvar test string\n\nfor rows.Next() {\n    rows.Scan(&amp;test)\n    fmt.Println(test)\n}\n</code></pre>\n\n<p>Which prints out <code>education_data</code></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 16171, "user_id": 1155984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22074349884978092d46beac83608767?s=128&d=identicon&r=PG", "display_name": "Umberto Raimondi", "link": "https://stackoverflow.com/users/1155984/umberto-raimondi"}, "is_accepted": false, "score": 2, "last_activity_date": 1433449447, "creation_date": 1433449447, "answer_id": 30653440, "question_id": 30653419, "link": "https://stackoverflow.com/questions/30653419/for-loop-pre-and-post-statement-empty/30653440#30653440", "title": "For Loop pre and post statement empty", "body": "<p>It behaves like a <code>while</code> in other languages, you don't need the two semicolons:</p>\n\n<pre><code>sum := 1\nfor sum &lt; 10 {\n    sum += sum\n}\nfmt.Println(sum)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 2, "last_activity_date": 1433450691, "last_edit_date": 1433450691, "creation_date": 1433449587, "answer_id": 30653491, "question_id": 30653419, "link": "https://stackoverflow.com/questions/30653419/for-loop-pre-and-post-statement-empty/30653491#30653491", "title": "For Loop pre and post statement empty", "body": "<p>For loop has 3 elements: initialization statement, condition check, variable change.</p>\n\n<pre><code>for &lt;initialization statement&gt;; &lt;condition check&gt;; &lt;variable change&gt;{\n    &lt;actual body&gt;\n}\n</code></pre>\n\n<ul>\n<li>initialization statement is executed only once when the loop starts. Based on the name it initialize something (in a lot of cases a variable you iterate through). If it is omitted, then it does nothing</li>\n<li>condition check verifies whether the condition evaluates to true. If it is not, the loop stops. If it is omitted, then it is always true.</li>\n<li>variable change is modifying variables during each iteration of the loop. Most of the time, the iterated variable is increased/decreased, but you can do whatever you want. If it is omitted, does nothing</li>\n</ul>\n\n<p>After this explanation, you can see that this loop does nothing during your initialization, and post condition phase.</p>\n\n<p>You also do not need to use semicolons here. This will be enough.</p>\n\n<pre><code>sum := 1\nfor sum &lt; 10 {\n    sum += sum\n}\n</code></pre>\n\n<p>You can even write a loop like this: <code>for {}</code> which will never stop executing, or do something like a while loop:</p>\n\n<pre><code>t := 10\nfor t &gt; 0{\n  t--\n}\n</code></pre>\n\n<hr>\n\n<p>Note that inside your initialization, condition, and change phase you can use many expressions (not just one). So with a simple while loop you can do something like:</p>\n\n<pre><code>for f1, f2, n := 1, 1, 10; n &gt; 0; f1, f2, n = f2, f1 + f2, n - 1{\n    fmt.Println(f1)\n}\n</code></pre>\n\n<p>which creates a fibonacci numbers <kbd><a href=\"http://play.golang.org/p/DAY6EVXUcW\" rel=\"nofollow\">go playground</a></kbd>. Showing this not because this is the best way to write it, but rather because it is possible.</p>\n"}, {"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1433456377, "post_id": 30653614, "comment_id": 49373032, "body": "Actually, in go you can do the same with for : <code>for sum &lt; 10 { sum += sum }</code>"}], "tags": [], "owner": {"reputation": 182, "user_id": 4747961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oBcIz.jpg?s=128&g=1", "display_name": "cdixit2", "link": "https://stackoverflow.com/users/4747961/cdixit2"}, "is_accepted": true, "score": 4, "last_activity_date": 1433449993, "creation_date": 1433449993, "answer_id": 30653614, "question_id": 30653419, "link": "https://stackoverflow.com/questions/30653419/for-loop-pre-and-post-statement-empty/30653614#30653614", "title": "For Loop pre and post statement empty", "body": "<p>Remember that a for loop is the same as a while loop.\nYour code can be rewritten in other languages as</p>\n\n<pre><code>sum := 1\nwhile(sum &lt; 10) {\n    sum += sum\n}\nfmt.Println(sum)\n</code></pre>\n\n<p>In a <code>for</code> loop, there are 3 parts.</p>\n\n<p><code>for(initial statement ; condition ;  end statement usually iterate)</code></p>\n\n<p>This is equivalent to</p>\n\n<pre><code>initial statement\nwhile(condition) {\n    Stuff here\n    End iteration statement\n}\n</code></pre>\n\n<p>The reason your loop can be written withiut the pre and post statements is because you've specified them in other parts of the code.</p>\n"}], "owner": {"reputation": 653, "user_id": 4560325, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/--z_BcWF1Xxk/AAAAAAAAAAI/AAAAAAAAAHE/Acu0y0eCdlU/photo.jpg?sz=128", "display_name": "Moises Zerme&#241;o", "link": "https://stackoverflow.com/users/4560325/moises-zerme%c3%b1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 0, "accepted_answer_id": 30653614, "answer_count": 3, "score": -1, "last_activity_date": 1433450691, "creation_date": 1433449350, "question_id": 30653419, "link": "https://stackoverflow.com/questions/30653419/for-loop-pre-and-post-statement-empty", "title": "For Loop pre and post statement empty", "body": "<p>In Golang what does it means that the pre and post statements of a for loop are empty like in this example:</p>\n\n<pre><code>    sum := 1\n    for ; sum &lt; 10; {\n        sum += sum\n    }\n    fmt.Println(sum)\n</code></pre>\n"}, {"tags": ["go", "docker"], "answers": [{"comments": [{"owner": {"reputation": 4897, "user_id": 795053, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7281b1d9f19c2c5f8a9c5fc45e81450e?s=128&d=identicon&r=PG", "display_name": "Alex Flint", "link": "https://stackoverflow.com/users/795053/alex-flint"}, "edited": false, "score": 0, "creation_date": 1433452150, "post_id": 30653273, "comment_id": 49371341, "body": "Thanks! Do you by any chance have a pointer to an example of writing to stdin and capturing stdout from such a container?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4897, "user_id": 795053, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7281b1d9f19c2c5f8a9c5fc45e81450e?s=128&d=identicon&r=PG", "display_name": "Alex Flint", "link": "https://stackoverflow.com/users/795053/alex-flint"}, "edited": false, "score": 0, "creation_date": 1433453109, "post_id": 30653273, "comment_id": 49371784, "body": "@AlexFlint: Added a line about attaching to the running container. You may need to set the Stdin, Stdout, or Stderr bool flags on that call to get it to work, or the Attach* options when you create the container. I don&#39;t have a test setup at the moment to confirm what way is best, or if they differ."}, {"owner": {"reputation": 4866, "user_id": 215713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa4a82dca6b5d2d0b58e784231caf3a?s=128&d=identicon&r=PG", "display_name": "rfay", "link": "https://stackoverflow.com/users/215713/rfay"}, "edited": false, "score": 0, "creation_date": 1533599130, "post_id": 30653273, "comment_id": 90395115, "body": "The missing piece of the answer here is how to add those bind mounts asked about in the OP (<code>-v &quot;$PWD&quot;:&#47;usr&#47;src&#47;myapp</code>) . <a href=\"https://github.com/fsouza/go-dockerclient/issues/633\" rel=\"nofollow noreferrer\">github.com/fsouza/go-dockerclient/issues/633</a> gets started on this, but doesn&#39;t end up with a satisfying answer."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1433452965, "last_edit_date": 1433452965, "creation_date": 1433448816, "answer_id": 30653273, "question_id": 30653033, "link": "https://stackoverflow.com/questions/30653033/emulating-docker-run-using-the-golang-docker-api/30653273#30653273", "title": "Emulating `docker run` using the golang docker API", "body": "<p>Using <code>github.com/fsouza/go-dockerclient</code>, you have to first <a href=\"http://godoc.org/github.com/fsouza/go-dockerclient#Client.CreateContainer\" rel=\"noreferrer\">create a container</a>, using the <a href=\"http://godoc.org/github.com/fsouza/go-dockerclient#CreateContainerOptions\" rel=\"noreferrer\"><code>CreateContainerOptions</code></a> to add the same options that you can via the command line.</p>\n\n<pre><code>container, err := client.CreateContainer(createContainerOptions)\n</code></pre>\n\n<p>Once you have the container, you <a href=\"http://godoc.org/github.com/fsouza/go-dockerclient#Client.StartContainer\" rel=\"noreferrer\">start it</a>, with any extra options or overrides in the <a href=\"http://godoc.org/github.com/fsouza/go-dockerclient#HostConfig\" rel=\"noreferrer\"><code>HostConfig</code></a></p>\n\n<pre><code>client.StartContainer(container.ID, hostConfig)\n</code></pre>\n\n<p>To connect to the std io streams of a container, you need to use <a href=\"http://godoc.org/github.com/fsouza/go-dockerclient#Client.AttachToContainer\" rel=\"noreferrer\"><code>client.AttachToContainer</code></a>, and assign the appropriate stream in the <code>AttachToContinerOptions</code>.</p>\n"}], "owner": {"reputation": 4897, "user_id": 795053, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/7281b1d9f19c2c5f8a9c5fc45e81450e?s=128&d=identicon&r=PG", "display_name": "Alex Flint", "link": "https://stackoverflow.com/users/795053/alex-flint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4135, "favorite_count": 2, "accepted_answer_id": 30653273, "answer_count": 1, "score": 4, "last_activity_date": 1433452965, "creation_date": 1433447951, "question_id": 30653033, "link": "https://stackoverflow.com/questions/30653033/emulating-docker-run-using-the-golang-docker-api", "title": "Emulating `docker run` using the golang docker API", "body": "<p>How can I achieve the equivalent of</p>\n\n<pre><code>sudo docker run -it --rm --name my-python-container -v \"$PWD\":/usr/src/myapp -w /usr/src/myapp python:2-slim python test.py\n</code></pre>\n\n<p>using the Docker API for Golang?</p>\n\n<p>Either <a href=\"https://github.com/fsouza/go-dockerclient\" rel=\"nofollow\">https://github.com/fsouza/go-dockerclient</a> or <a href=\"https://github.com/samalba/dockerclient\" rel=\"nofollow\">https://github.com/samalba/dockerclient</a> is fine.</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 1, "creation_date": 1433446483, "post_id": 30652577, "comment_id": 49368353, "body": "So what is wrong with concatenating a string?"}, {"owner": {"reputation": 3659, "user_id": 2080324, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/137499a9336eeb82972414ee5b3efa62?s=128&d=identicon&r=PG", "display_name": "Rudi Strydom", "link": "https://stackoverflow.com/users/2080324/rudi-strydom"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 5, "creation_date": 1433446824, "post_id": 30652577, "comment_id": 49368527, "body": "I suppose nothing, but it&#39;s not really a elegant sollution, just thought there is a better way of doing things in Go.   You see the action changes, the method and then you have to string everything together."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1433450815, "post_id": 30652577, "comment_id": 49370661, "body": "You can use <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\"><code>url.Values</code></a>&#39;s <a href=\"https://golang.org/pkg/net/url/#Values.Encode\" rel=\"nofollow noreferrer\"><code>Encode</code></a> method. You could also use <a href=\"https://golang.org/pkg/net/url/#URL.String\" rel=\"nofollow noreferrer\"><code>URL.String</code></a> to build up the whole URL."}], "answers": [{"comments": [{"owner": {"reputation": 3659, "user_id": 2080324, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/137499a9336eeb82972414ee5b3efa62?s=128&d=identicon&r=PG", "display_name": "Rudi Strydom", "link": "https://stackoverflow.com/users/2080324/rudi-strydom"}, "edited": false, "score": 1, "creation_date": 1433490451, "post_id": 30657518, "comment_id": 49384542, "body": "Awesome thank you man! That&#39;s exactly what I was looking for!"}, {"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1487691618, "post_id": 30657518, "comment_id": 71892921, "body": "Great for testing too!"}, {"owner": {"reputation": 1249, "user_id": 4385714, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TMykz.jpg?s=128&g=1", "display_name": "qtopierw", "link": "https://stackoverflow.com/users/4385714/qtopierw"}, "edited": false, "score": 0, "creation_date": 1515840519, "post_id": 30657518, "comment_id": 83460535, "body": "Any solution to make the query string parameters in your wanted order? The keys are sorted in <code>Encode()</code> method."}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "reply_to_user": {"reputation": 1249, "user_id": 4385714, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TMykz.jpg?s=128&g=1", "display_name": "qtopierw", "link": "https://stackoverflow.com/users/4385714/qtopierw"}, "edited": false, "score": 1, "creation_date": 1516042736, "post_id": 30657518, "comment_id": 83521499, "body": "@artificerpi if it was critical for some reason you could reimplement what they do inside the Encode method <a href=\"https://golang.org/src/net/url/url.go?s=24222:24253#L845\" rel=\"nofollow noreferrer\">golang.org/src/net/url/url.go?s=24222:24253#L845</a> But I would wonder why it mattered."}, {"owner": {"reputation": 879, "user_id": 3778355, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/57af174c54dc32e59d8a528805e4a9db?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3778355/richard"}, "edited": false, "score": 3, "creation_date": 1553492631, "post_id": 30657518, "comment_id": 97388875, "body": "You don&#39;t need to use NewRequest if you&#39;re not doing anything with it. You can just use <code>url.Parse(&quot;https:&#47;&#47;something.com&#47;&quot;)</code> instead or even create an URL object directly."}, {"owner": {"reputation": 3000, "user_id": 5175802, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204557372486692/picture?type=large", "display_name": "Jake Boomgaarden", "link": "https://stackoverflow.com/users/5175802/jake-boomgaarden"}, "edited": false, "score": 0, "creation_date": 1599344380, "post_id": 30657518, "comment_id": 112747413, "body": "one thing that is confusing me in this is that it reads like the OP first makes the request, and then after it&#39;s finished, goes back and updates the URL. I&#39;m sure that&#39;s not the case, so hoping someone can clear up for me why we&#39;re first making the API call and then setting the URL we need"}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "reply_to_user": {"reputation": 3000, "user_id": 5175802, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204557372486692/picture?type=large", "display_name": "Jake Boomgaarden", "link": "https://stackoverflow.com/users/5175802/jake-boomgaarden"}, "edited": false, "score": 1, "creation_date": 1599594745, "post_id": 30657518, "comment_id": 112820192, "body": "@JakeBoomgaarden the <code>http.NewRequest</code> function does not actually call the remote server. It just constructs a <code>*http.Request</code> variable for you to use. You can tweak the request to your liking then send it off by passing it to the <code>*http.Client.Do</code> method."}], "tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 228, "last_activity_date": 1480969503, "last_edit_date": 1480969503, "creation_date": 1433472092, "answer_id": 30657518, "question_id": 30652577, "link": "https://stackoverflow.com/questions/30652577/go-doing-a-get-request-and-building-the-querystring/30657518#30657518", "title": "Go doing a GET request and building the Querystring", "body": "<p>As a commenter mentioned you can get <code>Values</code> from <code>net/url</code> which has an <code>Encode</code> method. You could do something like this (<code>req.URL.Query()</code> returns the existing <code>url.Values</code>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n)\n\nfunc main() {\n    req, err := http.NewRequest(\"GET\", \"http://api.themoviedb.org/3/tv/popular\", nil)\n    if err != nil {\n        log.Print(err)\n        os.Exit(1)\n    }\n\n    q := req.URL.Query()\n    q.Add(\"api_key\", \"key_from_environment_or_flag\")\n    q.Add(\"another_thing\", \"foo &amp; bar\")\n    req.URL.RawQuery = q.Encode()\n\n    fmt.Println(req.URL.String())\n    // Output:\n    // http://api.themoviedb.org/3/tv/popular?another_thing=foo+%26+bar&amp;api_key=key_from_environment_or_flag\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/L5XCrw9VIG\">http://play.golang.org/p/L5XCrw9VIG</a></p>\n"}, {"tags": [], "owner": {"reputation": 1092, "user_id": 1010861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ed61ae52a73266771a93ca9afdcd9b?s=128&d=identicon&r=PG", "display_name": "allyraza", "link": "https://stackoverflow.com/users/1010861/allyraza"}, "is_accepted": false, "score": 39, "last_activity_date": 1524315403, "creation_date": 1524315403, "answer_id": 49955992, "question_id": 30652577, "link": "https://stackoverflow.com/questions/30652577/go-doing-a-get-request-and-building-the-querystring/49955992#49955992", "title": "Go doing a GET request and building the Querystring", "body": "<p>Use <code>r.URL.Query()</code> when you appending to existing query, if you are building new set of params use the <code>url.Values</code> struct like so</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n    \"os\"\n)\n\nfunc main() {\n    req, err := http.NewRequest(\"GET\",\"http://api.themoviedb.org/3/tv/popular\", nil)\n    if err != nil {\n        log.Print(err)\n        os.Exit(1)\n    }\n\n    // if you appending to existing query this works fine \n    q := req.URL.Query()\n    q.Add(\"api_key\", \"key_from_environment_or_flag\")\n    q.Add(\"another_thing\", \"foo &amp; bar\")\n\n    // or you can create new url.Values struct and encode that like so\n    q := url.Values{}\n    q.Add(\"api_key\", \"key_from_environment_or_flag\")\n    q.Add(\"another_thing\", \"foo &amp; bar\")\n\n    req.URL.RawQuery = q.Encode()\n\n    fmt.Println(req.URL.String())\n    // Output:\n    // http://api.themoviedb.org/3/tv/popularanother_thing=foo+%26+bar&amp;api_key=key_from_environment_or_flag\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 7542208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155722334440329/picture?type=large", "display_name": "pow-il", "link": "https://stackoverflow.com/users/7542208/pow-il"}, "edited": false, "score": 0, "creation_date": 1605718974, "post_id": 56985985, "comment_id": 114739337, "body": "Agreed, great answer!"}, {"owner": {"reputation": 2478, "user_id": 229891, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RRyqC.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/229891/paul"}, "edited": false, "score": 0, "creation_date": 1606567547, "post_id": 56985985, "comment_id": 115001666, "body": "This should really be the accepted answer."}], "tags": [], "owner": {"reputation": 3245, "user_id": 492647, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0f954970ccbb138551d0aad4f3f7a4b5?s=128&d=identicon&r=PG", "display_name": "Janek Olszak", "link": "https://stackoverflow.com/users/492647/janek-olszak"}, "is_accepted": false, "score": 19, "last_activity_date": 1562837346, "creation_date": 1562837346, "answer_id": 56985985, "question_id": 30652577, "link": "https://stackoverflow.com/questions/30652577/go-doing-a-get-request-and-building-the-querystring/56985985#56985985", "title": "Go doing a GET request and building the Querystring", "body": "<p>Using <code>NewRequest</code> just to create an URL is an overkill. Use the <code>net/url</code> package:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n)\n\nfunc main() {\n    base, err := url.Parse(\"http://www.example.com\")\n    if err != nil {\n        return\n    }\n\n    // Path params\n    base.Path += \"this will get automatically encoded\"\n\n    // Query params\n    params := url.Values{}\n    params.Add(\"q\", \"this will get encoded as well\")\n    base.RawQuery = params.Encode() \n\n    fmt.Printf(\"Encoded URL is %q\\n\", base.String())\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/YCTvdluws-r\" rel=\"noreferrer\">https://play.golang.org/p/YCTvdluws-r</a></p>\n"}], "owner": {"reputation": 3659, "user_id": 2080324, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/137499a9336eeb82972414ee5b3efa62?s=128&d=identicon&r=PG", "display_name": "Rudi Strydom", "link": "https://stackoverflow.com/users/2080324/rudi-strydom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134122, "favorite_count": 26, "answer_count": 3, "score": 96, "last_activity_date": 1598347216, "creation_date": 1433446334, "last_edit_date": 1433446506, "question_id": 30652577, "link": "https://stackoverflow.com/questions/30652577/go-doing-a-get-request-and-building-the-querystring", "title": "Go doing a GET request and building the Querystring", "body": "<p>I am pretty new to Go and don't quite understand everything as yet. In many of the modern languages Node.js, Angular, jQuery, PHP you can do a GET request with additional query string parameters. </p>\n\n<p>Doing this in Go isn't quite a simple as it seems, and I can't really figure it out as yet. I really don't want to have to concatenate a string for each of the requests I want to do. </p>\n\n<p>Here is the sample script:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    client := &amp;http.Client{}\n\n    req, _ := http.NewRequest(\"GET\", \"http://api.themoviedb.org/3/tv/popular\", nil)\n    req.Header.Add(\"Accept\", \"application/json\")\n    resp, err := client.Do(req)\n\n    if err != nil {\n        fmt.Println(\"Errored when sending request to the server\")\n        return\n    }\n\n    defer resp.Body.Close()\n    resp_body, _ := ioutil.ReadAll(resp.Body)\n\n    fmt.Println(resp.Status)\n    fmt.Println(string(resp_body))\n}\n</code></pre>\n\n<p>In this example you can see there is a URL, which requires a GET variable of api_key with your api key as the value. The problem being that this becomes hard coded in the form of:</p>\n\n<pre><code>req, _ := http.NewRequest(\"GET\", \"http://api.themoviedb.org/3/tv/popular?api_key=mySuperAwesomeApiKey\", nil)\n</code></pre>\n\n<p>Is there a way to build this query string dynamically?? At the moment I will need to assemble the URL prior to this step in order to get a valid response.</p>\n"}, {"tags": ["reflection", "go", "generic-programming"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1433447193, "creation_date": 1433447193, "answer_id": 30652827, "question_id": 30652392, "link": "https://stackoverflow.com/questions/30652392/go-reflect-makefunc-how-to-return-a-err-nil-as-reflect-value/30652827#30652827", "title": "Go reflect.MakeFunc. How to return a err=nil as reflect.Value?", "body": "<p>It's tricky, you have to use <a href=\"http://golang.org/pkg/reflect/#Zero\" rel=\"nofollow\"><code>reflect.Zero</code></a>:</p>\n\n<pre><code>out[2] = reflect.Zero(reflect.TypeOf((*error)(nil)).Elem())\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/DhrZU6BOWN\" rel=\"nofollow\"><kbd>play</kbd></a></p>\n"}, {"tags": [], "owner": {"reputation": 423, "user_id": 3435329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ek5Ff.jpg?s=128&g=1", "display_name": "DLopes", "link": "https://stackoverflow.com/users/3435329/dlopes"}, "is_accepted": false, "score": 2, "last_activity_date": 1433448847, "creation_date": 1433448847, "answer_id": 30653282, "question_id": 30652392, "link": "https://stackoverflow.com/questions/30652392/go-reflect-makefunc-how-to-return-a-err-nil-as-reflect-value/30653282#30653282", "title": "Go reflect.MakeFunc. How to return a err=nil as reflect.Value?", "body": "<p>Defining a typed nil error works too...</p>\n\n<pre><code>var err error = nil\nouts[2] = reflect.ValueOf(&amp;err).Elem()\n</code></pre>\n\n<p>Just out of curiosity.\n<a href=\"http://play.golang.org/p/RgKImlXMOe\" rel=\"nofollow\">Go Playground</a></p>\n"}], "owner": {"reputation": 423, "user_id": 3435329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ek5Ff.jpg?s=128&g=1", "display_name": "DLopes", "link": "https://stackoverflow.com/users/3435329/dlopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 30652827, "answer_count": 2, "score": 2, "last_activity_date": 1433448847, "creation_date": 1433445830, "last_edit_date": 1433446708, "question_id": 30652392, "link": "https://stackoverflow.com/questions/30652392/go-reflect-makefunc-how-to-return-a-err-nil-as-reflect-value", "title": "Go reflect.MakeFunc. How to return a err=nil as reflect.Value?", "body": "<p>How to return a err=nil as reflect.Value? I need to write a swap function to use with reflect.MakeFunc().</p>\n\n<pre><code>//my swap implementation, that call the original function and cache results\nfunc swapFunc(ins []reflect.Value) []reflect.Value {\n    //After cache the first return (Offer) of function FindBestOffer(int)(Offer,bool,error),\n    //i need to return the best Offer cached and default values \n    //for the two other returns (bool=true, err=nil)\n\n    outs := make([]reflect.Value, 3) //mock cache return\n\n    outs[0] = reflect.ValueOf(Offer{10, \"cached offer\", 20})\n    outs[1] = reflect.ValueOf(true)\n    outs[2] = reflect.ValueOf(nil).Elem() // --&gt; Doesn't work!\n\n    return outs\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/inQ7Z9tR3N\" rel=\"nofollow\">Go Playground full example</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "edited": false, "score": 1, "creation_date": 1433430373, "post_id": 30647393, "comment_id": 49358711, "body": "The answer is &quot;sort of&quot;.  See <a href=\"http://stackoverflow.com/a/26045887/3108853\">stackoverflow.com/a/26045887/3108853</a> for a discussion."}, {"owner": {"reputation": 1750, "user_id": 1262568, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b7850546eac0298026dc778445fddcdc?s=128&d=identicon&r=PG", "display_name": "whd", "link": "https://stackoverflow.com/users/1262568/whd"}, "reply_to_user": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "edited": false, "score": 0, "creation_date": 1433430920, "post_id": 30647393, "comment_id": 49359095, "body": "So maybe i coudl create deep copy of variable, like in ada <code>Obj1.all := Ob2.all</code> ?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1433434811, "post_id": 30647393, "comment_id": 49361694, "body": "no, because making a copy is not atomic."}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 6, "last_activity_date": 1433434581, "creation_date": 1433434581, "answer_id": 30649045, "question_id": 30647393, "link": "https://stackoverflow.com/questions/30647393/how-to-print-contents-of-channel-without-changing-it/30649045#30649045", "title": "How to print contents of channel without changing it", "body": "<blockquote>\n  <p>How could I achieve that without interrupting the goroutines' work?</p>\n</blockquote>\n\n<p>The simple answer is that you can't, without interrupting. Channels are a synchronization primitive, meaning that they are what enables concurrent programs to communicate safely. If you take something out of a channel, that \"taking out\" happens atomically, nobody else can take the same item out of the same channel. And that's intended.</p>\n\n<p>What you can do is take items out and put them back after printing them. The problem with this approach is that some elements might never be printed while others may be printed more than once as all goroutines involved race to grab items from the channel.</p>\n\n<p>It sounds like you need something else than a channel.</p>\n"}], "owner": {"reputation": 1750, "user_id": 1262568, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b7850546eac0298026dc778445fddcdc?s=128&d=identicon&r=PG", "display_name": "whd", "link": "https://stackoverflow.com/users/1262568/whd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1670, "favorite_count": 2, "accepted_answer_id": 30649045, "answer_count": 1, "score": 3, "last_activity_date": 1433434581, "creation_date": 1433429995, "last_edit_date": 1433430182, "question_id": 30647393, "link": "https://stackoverflow.com/questions/30647393/how-to-print-contents-of-channel-without-changing-it", "title": "How to print contents of channel without changing it", "body": "<p>I'm writing a program in the Go language, and I have a simple problem:</p>\n\n<p>I have some goroutines in my program and channels with which goroutines use to communicate. From time to time I would like to check what is inside the channels. How could I achieve that without interrupting the goroutines' work? Do channels have any function to print their contents? Or should I somehow copy them?</p>\n\n<pre><code>var shelf chan int = make(chan int, 5)\ngo Depot(shelf)\ngo Shop(shelf)\nvar input string\nfmt.Scanln(&amp;input)\nif (input == \"print\") {\n     //here print what on shelf\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1433433465, "post_id": 30646391, "comment_id": 49360838, "body": "You don&#39;t need to include the body of the answer to your question in the question, just <a href=\"http://meta.stackexchange.com/a/5235/168708\">mark it as accepted</a>."}, {"owner": {"reputation": 5788, "user_id": 615784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def49e4f02dea4911a431380ac6ec823?s=128&d=identicon&r=PG", "display_name": "Shelby Moore III", "link": "https://stackoverflow.com/users/615784/shelby-moore-iii"}, "edited": false, "score": 0, "creation_date": 1516663263, "post_id": 30646391, "comment_id": 83771585, "body": "Even though it\u2019s not currently supported, it has <a href=\"https://groups.google.com/d/msg/golang-dev/HJcGESXfJfs/X-SBuDkcBwAJ\" rel=\"nofollow noreferrer\">been proposed</a> for a new optional capability. And I have proposed <a href=\"https://stackoverflow.com/questions/1880262/forcing-goroutines-into-the-same-thread#comment83771359_1928637\">other use cases</a>."}], "answers": [{"comments": [{"owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "edited": false, "score": 0, "creation_date": 1433431450, "post_id": 30647648, "comment_id": 49359499, "body": "Thank you. I experiment your example putting the lock before the first go and works fine. You can add that example to your answer or allow me to replicate your example to answer my own question."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "edited": false, "score": 0, "creation_date": 1433431566, "post_id": 30647648, "comment_id": 49359584, "body": "@joaonrb At first I forgot about setting GOMAXPROCS. I&#39;ve edited it now."}, {"owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "edited": false, "score": 0, "creation_date": 1433432597, "post_id": 30647648, "comment_id": 49360271, "body": "It turns out I was using the runtime.LockOSThread() to late in the code. I used your example to explain the solution to my problem. Thanks."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1433431519, "last_edit_date": 1433431519, "creation_date": 1433430679, "answer_id": 30647648, "question_id": 30646391, "link": "https://stackoverflow.com/questions/30646391/does-runtime-lockosthread-allow-child-goroutines-to-run-in-same-os-thread/30647648#30647648", "title": "Does runtime.LockOSThread allow child goroutines to run in same OS thread?", "body": "<p>We can check it using pthread.h's <code>pthread_self</code>:</p>\n\n<pre><code>package main\n\n// #include &lt;pthread.h&gt;\nimport \"C\"\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc main() {\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    ch1 := make(chan bool)\n    ch2 := make(chan bool)\n    fmt.Println(\"main\", C.pthread_self())\n    go func() {\n        runtime.LockOSThread()\n        fmt.Println(\"locked\", C.pthread_self())\n        go func() {\n            fmt.Println(\"locked child\", C.pthread_self())\n            ch1 &lt;- true\n        }()\n        ch2 &lt;- true\n    }()\n    &lt;-ch1\n    &lt;-ch2\n}\n</code></pre>\n\n<p>On my machine it prints something like this, <code>main</code> and <code>locked</code> always being sometimes the same, but sometimes different:</p>\n\n<pre><code>main 139711253194560\nlocked 139711219787520\nlocked child 139711236572928\n</code></pre>\n\n<p><strong>EDIT</strong> I forgot about GOMAXPROCS. Added, the results are varying now.</p>\n"}, {"comments": [{"owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "edited": false, "score": 0, "creation_date": 1433437559, "post_id": 30648743, "comment_id": 49363279, "body": "I&#39;m using version 1.4. I&#39;ve run the example(now erased) multiple times and is consistent with my conclusion. If the implementation is inconsistent with the documentation, I agree. But I don&#39;t see any benefit locking a single go routine to one OS thread if you cannot spawn more controlled goroutines in that thread."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "edited": false, "score": 0, "creation_date": 1433439743, "post_id": 30648743, "comment_id": 49364598, "body": "Maybe <code>runtime.NumCPU()</code> returns 1 on your system? Anyhow you should report this bug, including the repro."}, {"owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "edited": false, "score": 0, "creation_date": 1433440157, "post_id": 30648743, "comment_id": 49364855, "body": "I&#39;m using <code>runtime.GOMAXPROCS(runtime.NumCPU())</code>. I will report the bug. But I believe the error to be in the documentation because I fail to understand the benefits of lock a goroutine to a OS thread if you do not allow inside concurrency. Even it usage is not clear in doc and can be misinterpreted. It lock the next goroutine created to OS thread or the current one? is not clear at all."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "edited": false, "score": 1, "creation_date": 1433441313, "post_id": 30648743, "comment_id": 49365500, "body": "The goroutine that calls <code>runtime.LockOSThread()</code> is the one that&#39;s stuck to a thread. If you use the <code>go ...</code> from there, the spawned goroutine should <i>not</i> execute on the same thread."}, {"owner": {"reputation": 419, "user_id": 64381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8805af97a4d1b0105c7f6f219d2459dd?s=128&d=identicon&r=PG", "display_name": "vishvananda", "link": "https://stackoverflow.com/users/64381/vishvananda"}, "edited": false, "score": 0, "creation_date": 1487548498, "post_id": 30648743, "comment_id": 71821292, "body": "It is important to keep in mind that <code>runtime.LockOSThread()</code> does not prevent other threads from spawning from the context of the thread where the goroutine is running, which means other goroutines can run in the context that shares certain thread-specific data like namespaces, uid, and gid. For more information see: <a href=\"https://github.com/golang/go/issues/1435\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/1435</a>"}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 6, "last_activity_date": 1433443372, "last_edit_date": 1433443372, "creation_date": 1433433704, "answer_id": 30648743, "question_id": 30646391, "link": "https://stackoverflow.com/questions/30646391/does-runtime-lockosthread-allow-child-goroutines-to-run-in-same-os-thread/30648743#30648743", "title": "Does runtime.LockOSThread allow child goroutines to run in same OS thread?", "body": "<p><a href=\"http://golang.org/pkg/runtime/#LockOSThread\" rel=\"nofollow\">The documentation</a> for <code>runtime.LockOSThread</code> says:</p>\n\n<blockquote>\n  <p>LockOSThread wires <strong>the calling goroutine</strong> to its current operating system thread. Until the calling goroutine exits or calls UnlockOSThread, it will always execute in that thread, <strong>and no other goroutine can</strong>.</p>\n</blockquote>\n\n<p><sup>(emphasis mine)</sup></p>\n\n<p>This means that if a certain implementation of Go did what you're asking, it would be faulty.</p>\n\n<p>To clarify: if a goroutine had reserved a thread and another goroutine executed on that same thread; that's what would be wrong.</p>\n"}], "owner": {"reputation": 805, "user_id": 2521743, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Gle7p.jpg?s=128&g=1", "display_name": "joaonrb", "link": "https://stackoverflow.com/users/2521743/joaonrb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1393, "favorite_count": 3, "accepted_answer_id": 30648743, "answer_count": 2, "score": 10, "last_activity_date": 1433443372, "creation_date": 1433427602, "last_edit_date": 1433438920, "question_id": 30646391, "link": "https://stackoverflow.com/questions/30646391/does-runtime-lockosthread-allow-child-goroutines-to-run-in-same-os-thread", "title": "Does runtime.LockOSThread allow child goroutines to run in same OS thread?", "body": "<p>I understand that in Go, <a href=\"https://golang.org/pkg/runtime/#LockOSThread\" rel=\"noreferrer\"><code>runtime.LockOSThread()</code></a> will bind a goroutine to one OS thread and not allow other goroutines to execute in that thread.\nIs this also true for child goroutines?</p>\n\n<p>For example:</p>\n\n<pre><code>runtime.LockOSThread()\ngo func() {\n    go func() {\n        // Do something\n    }()\n    // Do something\n}()\n</code></pre>\n\n<p>Do both of these goroutines execute in a single and exclusive OS thread or only the first one?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3023, "user_id": 789774, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/GrpmL.png?s=128&g=1", "display_name": "aamir", "link": "https://stackoverflow.com/users/789774/aamir"}, "edited": false, "score": 0, "creation_date": 1433417913, "post_id": 30642590, "comment_id": 49349695, "body": "you import it using <code>import &quot;golang.org&#47;x&#47;net&#47;websocket&quot;</code>. Although, <a href=\"http://golang.org/x/net/websocket\" rel=\"nofollow noreferrer\">golang.org/x/net/websocket</a> redirects to <a href=\"https://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/net/websocket</a> because the docs reside there."}], "answers": [{"comments": [{"owner": {"reputation": 4045, "user_id": 689990, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c9baee4e96ed5b21f3c0589418d4e73c?s=128&d=identicon&r=PG", "display_name": "egor7", "link": "https://stackoverflow.com/users/689990/egor7"}, "edited": false, "score": 1, "creation_date": 1433422021, "post_id": 30643130, "comment_id": 49352373, "body": "Go 1.4 Release Notes says nothing about moving to github.. <a href=\"https://golang.org/doc/go1.4\" rel=\"nofollow noreferrer\">golang.org/doc/go1.4</a>. Only about code.google.com: &quot;The Go project subrepositories (code.google.com/p/go.tools and so on) are now available under custom import paths replacing code.google.com/p/go. with golang.org/x/, as in golang.org/x/tools.&quot;"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 4045, "user_id": 689990, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c9baee4e96ed5b21f3c0589418d4e73c?s=128&d=identicon&r=PG", "display_name": "egor7", "link": "https://stackoverflow.com/users/689990/egor7"}, "edited": false, "score": 4, "creation_date": 1433422241, "post_id": 30643130, "comment_id": 49352562, "body": "There was a <a href=\"https://groups.google.com/d/msg/golang-dev/sckirqOWepg/YmyT7dWJiocJ\" rel=\"nofollow noreferrer\">separate announcement</a>. <code>golang.org&#47;x&#47;...</code> is the canonical path for those imports now, so it doesn&#39;t matter where they&#39;re hosted."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1433418740, "creation_date": 1433418740, "answer_id": 30643130, "question_id": 30642590, "link": "https://stackoverflow.com/questions/30642590/where-are-the-x-packages-from-golang-org-now/30643130#30643130", "title": "Where are the /x/ packages from golang.org now?", "body": "<p>Since go has moved to Github, their source code is now <a href=\"https://github.com/golang/\" rel=\"noreferrer\">there</a>. So <code>golang.org/x/net/websocket</code> sources are at <a href=\"https://github.com/golang/net/tree/master/websocket\" rel=\"noreferrer\"><code>https://github.com/golang/net/tree/master/websocket</code></a>.</p>\n"}], "owner": {"reputation": 4045, "user_id": 689990, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c9baee4e96ed5b21f3c0589418d4e73c?s=128&d=identicon&r=PG", "display_name": "egor7", "link": "https://stackoverflow.com/users/689990/egor7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9229, "favorite_count": 3, "accepted_answer_id": 30643130, "answer_count": 1, "score": 6, "last_activity_date": 1512544238, "creation_date": 1433417077, "question_id": 30642590, "link": "https://stackoverflow.com/questions/30642590/where-are-the-x-packages-from-golang-org-now", "title": "Where are the /x/ packages from golang.org now?", "body": "<p>It seems all packages like golang.org/x/net/websocket was moved away. Are they moved to godoc.org permanently, and where are their sources now?</p>\n"}, {"tags": ["go", "shutdown-hook", "application-shutdown"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1433414118, "post_id": 30640871, "comment_id": 49347130, "body": "I&#39;d argue that (ab)using finalizers to do &quot;user-space&quot; cleanups is a clear code smell.  Instead, one should supposedly design the whole application around the idea of controlled shutdown, and then perform that controlled shutdown when certain conditions are met (like receiving <code>SIGINT</code> or <code>SIGTERM</code>). <a href=\"http://blog.labix.org/2011/10/09/death-of-goroutines-under-control\" rel=\"nofollow noreferrer\">This</a> is a good starting point."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1433414193, "post_id": 30640871, "comment_id": 49347177, "body": "<a href=\"http://www.reddit.com/r/golang/comments/1y5fg1/critique_graceful_http_shutdown/\" rel=\"nofollow noreferrer\">See also</a>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1433414301, "post_id": 30640871, "comment_id": 49347238, "body": "I&#39;d also add that creating a package that needs an &quot;atexit&quot; hook is a bad design whatsoever.  The package should just export &quot;something&quot; which the user has to initialize explicitly and deinitialize explicitly, and then just let the user to that -- when it&#39;s really needed."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1433414520, "post_id": 30640871, "comment_id": 49347386, "body": "@kostix I agree, it&#39;s bad design to rely on such functions, that&#39;s why there is no first-class support for it. Just showing the  available options."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1471848704, "last_edit_date": 1495540295, "creation_date": 1433412229, "answer_id": 30640871, "question_id": 30640439, "link": "https://stackoverflow.com/questions/30640439/is-there-something-like-finally-in-go-just-opposite-to-what-init/30640871#30640871", "title": "Is there something like finally() in Go just opposite to what init()?", "body": "<p>This was discussed before by the Go team, and the conclusion was not to add support for it. <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/qBQ0bK2zvQA\" rel=\"nofollow noreferrer\">Quoting minux</a>:</p>\n\n<blockquote>\n  <p>Personally, I prefer the style where program exit is handled exactly same as program crash.\n  I believe no matter how hard you try, your program can still crash under some unforeseen\n  situations; for example, memory shortage can bring any well-behave Go program to a crash,\n  and there is nothing you can do about it; so it's better to design for them.\n  If you follow this, you won't feel the need for atexit to clean up (because when your program\n  crash, atexit won't work, so you simply can't depend on it).</p>\n</blockquote>\n\n<p>But you still have some options:</p>\n\n<h3>Handling <kbd>CTRL+C</kbd></h3>\n\n<p>If you want to do something when your program is terminated by <kbd>CTRL+C</kbd> (<a href=\"http://en.wikipedia.org/wiki/Unix_signal#SIGINT\" rel=\"nofollow noreferrer\">SIGINT</a>), you can do so, see:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11268943/golang-is-it-possible-to-capture-a-ctrlc-signal-and-run-a-cleanup-function-in\">Golang: Is it possible to capture a Ctrl+C signal and run a cleanup function, in a &quot;defer&quot; fashion?</a></p>\n\n<h3>Object Finalizer</h3>\n\n<p>Also note that you can register a finalizer function for a pointer value. When the garbage collector finds an unreachable block with an associated finalizer, it clears the association and runs <code>f(x)</code> in a separate goroutine.</p>\n\n<p>You can register such finalizer with <a href=\"https://golang.org/pkg/runtime/#SetFinalizer\" rel=\"nofollow noreferrer\"><code>runtime.SetFinalizer()</code></a> which might be enough for you, but note:</p>\n\n<blockquote>\n  <p>There is no guarantee that finalizers will run before a program exits, so typically they are useful only for releasing non-memory resources associated with an object during a long-running program. </p>\n</blockquote>\n\n<p>See this example:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Age  int\n}\n\nfunc main() {\n    go func() {\n        p := &amp;Person{\"Bob\", 20}\n        runtime.SetFinalizer(p, func(p2 *Person) {\n            log.Println(\"Finalizing\", p2)\n        })\n        runtime.GC()\n    }()\n\n    time.Sleep(time.Second * 1)\n    log.Println(\"Done\")\n}\n</code></pre>\n\n<p>Output (<a href=\"http://play.golang.org/p/_Z1Tz5acUl\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:00 Finalizing &amp;{Bob 20}\n2009/11/10 23:00:01 Done\n</code></pre>\n"}], "owner": {"reputation": 2803, "user_id": 3186914, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/kkIb4.jpg?s=128&g=1", "display_name": "Prashant", "link": "https://stackoverflow.com/users/3186914/prashant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4248, "favorite_count": 1, "accepted_answer_id": 30640871, "answer_count": 1, "score": 8, "last_activity_date": 1471848704, "creation_date": 1433411053, "last_edit_date": 1433413078, "question_id": 30640439, "link": "https://stackoverflow.com/questions/30640439/is-there-something-like-finally-in-go-just-opposite-to-what-init", "title": "Is there something like finally() in Go just opposite to what init()?", "body": "<p>Is there something in Go which do just opposite to what <code>init()</code> do inside a package?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 4, "creation_date": 1433411133, "post_id": 30640392, "comment_id": 49345115, "body": "I don&#39;t understand what&#39;s really the question as you seem to give the answer at the beginning..."}, {"owner": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "reply_to_user": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1433429931, "post_id": 30640392, "comment_id": 49358376, "body": "It was my question, and I ask it."}, {"owner": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "reply_to_user": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1433496226, "post_id": 30640392, "comment_id": 49387937, "body": "I mean it is already the thing that I have asked. I see it is convenience for writing go code. But maybe it was also for another reason I haven&#39;t come across so far. To ask this is completely logical."}], "answers": [{"comments": [{"owner": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "edited": false, "score": 0, "creation_date": 1433430056, "post_id": 30640708, "comment_id": 49358461, "body": "As I have already read this parts from golang refs and told to one of my friends, he pointed if it was for some concern that I do not get. Thanks."}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 2, "last_activity_date": 1433411731, "creation_date": 1433411731, "answer_id": 30640708, "question_id": 30640392, "link": "https://stackoverflow.com/questions/30640392/go-syntax-of-pointer-receivers-of-a-method/30640708#30640708", "title": "Go Syntax of Pointer Receivers of a Method", "body": "<p>It is as you say simply shorthand:</p>\n\n<p>From the spec</p>\n\n<p><a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow\">Method values</a>:</p>\n\n<blockquote>\n  <p>As with method calls, a reference to a non-interface method with a\n  pointer receiver using an addressable value will automatically take\n  the address of that value: t.Mp is equivalent to (&amp;t).Mp.</p>\n</blockquote>\n\n<p>And <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow\">method calls</a>:</p>\n\n<blockquote>\n  <p>A method call x.m() is valid if the method set of (the type of) x\n  contains m and the argument list can be assigned to the parameter list\n  of m. <strong>If x is addressable and &amp;x's method set contains m, x.m() is\n  shorthand for (&amp;x).m()</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 2482, "user_id": 2605049, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/EgmcV.png?s=128&g=1", "display_name": "s&#231;u&#231;u", "link": "https://stackoverflow.com/users/2605049/s%c3%a7u%c3%a7u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 30640708, "answer_count": 1, "score": -3, "last_activity_date": 1433429852, "creation_date": 1433410954, "last_edit_date": 1433429852, "question_id": 30640392, "link": "https://stackoverflow.com/questions/30640392/go-syntax-of-pointer-receivers-of-a-method", "title": "Go Syntax of Pointer Receivers of a Method", "body": "<p>In go one can define a method for a pointer receiver, as well. And Go can interpret the code syntax as follows:</p>\n\n<p>In definition of the method, only writing the pointer type for the receiver is enough, inside the function definition you need not to dereference the pointer to access the very object in memory you want to access.</p>\n\n<p>In function call, you do not need to call the function on a pointer type, on a reference I mean. Go can understand that you mean it.</p>\n\n<pre><code>type Box struct {\n    color string\n}\n\nvar b Box\n</code></pre>\n\n<p><strong>Based on that what is the reason for the golang code snippets are equivalent below?</strong> Are there a different reason other than convenience or code shorthand?</p>\n\n<p>Go way, but the classical C way works, as well:</p>\n\n<pre><code>func (b *Box) setColor(c string) {\n    b.color = c\n}\nb.setColor(\"blue\")\n</code></pre>\n\n<p>Classical C way:</p>\n\n<pre><code>func (b *Box) setColor(c string) {\n    (*b).color = c\n}\n(&amp;b).setColor(\"blue\")\n</code></pre>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "edited": false, "score": 0, "creation_date": 1433669750, "post_id": 30636022, "comment_id": 49442800, "body": "Note that by using <code>reflect.New()</code>, you are making a pointer to a zero value of your struct, like with <code>new()</code>. If you just want the struct directly, rather than a pointer to it, you should use <code>reflect.Zero()</code> to get the zero value."}], "answers": [{"comments": [{"owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "edited": false, "score": 0, "creation_date": 1433398709, "post_id": 30636151, "comment_id": 49337504, "body": "After i added used p.Interface(), i have faced this issue person.Name undefined (type interface {} has no field or method Name). What did i miss this time?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "edited": false, "score": 0, "creation_date": 1433399575, "post_id": 30636151, "comment_id": 49337963, "body": "@Avdept See my edited answer. <code>Value.Interface()</code> returns an <code>interface{}</code>, an empty interface which is not a <code>struct</code> so you can&#39;t refer to any fields. You have to use Type assertion to obtain a value of type <code>*Person</code>."}, {"owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "edited": false, "score": 0, "creation_date": 1433399679, "post_id": 30636151, "comment_id": 49338017, "body": "Thank you @icza. The only problem - i don&#39;t know in advance what exactly type will i receive in my argument, since there are some structs, that may inherit from my Person{}. Is there any way to convert, knowing only reflection.TypeOf?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "edited": false, "score": 0, "creation_date": 1433400506, "post_id": 30636151, "comment_id": 49338462, "body": "@Avdept You may do a <code>switch</code> based on the type, and try to assert the dynamic type it holds. Type assertion also has a comma-ok idiom telling if type assertion failed or succeeded."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "edited": false, "score": 0, "creation_date": 1434541068, "post_id": 30636151, "comment_id": 49820050, "body": "@Alessio You want the pointed value instead? In <code>main()</code> function <code>p3</code> is a pointer, you can do this: <code>var notPointer = *p3</code> - and <code>notPointer</code> will be of type <code>Person</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1471955480, "last_edit_date": 1471955480, "creation_date": 1433397985, "answer_id": 30636151, "question_id": 30636022, "link": "https://stackoverflow.com/questions/30636022/create-new-object-knowing-reflected-type/30636151#30636151", "title": "Create new object knowing reflected type", "body": "<p>To tell what you're doing wrong we should see more of your code. But this is a simple example how to do what you want:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Age  int\n}\n\nfunc main() {\n    p := Person{}\n\n    p2 := create(reflect.TypeOf(p))\n\n    p3 := p2.(*Person)\n    p3.Name = \"Bob\"\n    p3.Age = 20\n    fmt.Printf(\"%+v\", p3)\n}\n\nfunc create(t reflect.Type) interface{} {\n    p := reflect.New(t)\n    fmt.Printf(\"%v\\n\", p)\n\n    pi := p.Interface()\n    fmt.Printf(\"%T\\n\", pi)\n    fmt.Printf(\"%+v\\n\", pi)\n\n    return pi\n}\n</code></pre>\n\n<p>Output (<a href=\"http://play.golang.org/p/HmAdUob0SV\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>&lt;*main.Person Value&gt;\n*main.Person\n&amp;{Name: Age:0}\n&amp;{Name:Bob Age:20}\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/reflect/#New\" rel=\"nofollow\"><code>reflect.New()</code></a> returns a value of <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow\"><code>reflect.Value</code></a>. The returned <code>Value</code> represents a pointer to a new zero value for the specified type.</p>\n\n<p>You can use <a href=\"https://golang.org/pkg/reflect/#Value.Interface\" rel=\"nofollow\"><code>Value.Interface()</code></a> to extract the pointer.</p>\n\n<p><code>Value.Interface()</code> returns a value of type <code>interface{}</code>. Obviously it can't return any concrete type, just the general empty interface. The empty interface is not a <code>struct</code>, so you can't refer to any field. But it may (and in your case it does) hold a value of <code>*Person</code>. You can use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">Type assertion</a> to obtain a value of type <code>*Person</code>.</p>\n"}], "owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 30636151, "answer_count": 1, "score": 2, "last_activity_date": 1471955480, "creation_date": 1433397504, "last_edit_date": 1433400397, "question_id": 30636022, "link": "https://stackoverflow.com/questions/30636022/create-new-object-knowing-reflected-type", "title": "Create new object knowing reflected type", "body": "<p>In function, one of arguments I'm passing</p>\n\n<pre><code>reflect.TypeOf(Person)\n</code></pre>\n\n<p>where person is <code>struct</code> with few strings. If another function which accepts this argument, I want to instantiate this empty struct knowing its reflected type.</p>\n\n<p>I have tried following</p>\n\n<pre><code>ins := reflect.New(typ)  //typ is name or passed reflect.TypeOf(Person)\n</code></pre>\n\n<p>But this returns me <code>nil</code>. What am I doing wrong?</p>\n"}, {"tags": ["html", "go", "screen-scraping"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 4883216, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/73a6db6ae7d0691b4448877e3f607ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Elegant Metal", "link": "https://stackoverflow.com/users/4883216/elegant-metal"}, "edited": false, "score": 0, "creation_date": 1433400039, "post_id": 30636478, "comment_id": 49338215, "body": "Wow this is really interesting I never thought of doing it that way. Thanks so much! I&#39;ll play around with this to make sure I 100% understand it"}, {"owner": {"reputation": 15161, "user_id": 1067003, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e3af2bd4b5604b0b661b5e6646544eba?s=128&d=identicon&r=PG", "display_name": "hanshenrik", "link": "https://stackoverflow.com/users/1067003/hanshenrik"}, "edited": false, "score": 0, "creation_date": 1433400211, "post_id": 30636478, "comment_id": 49338313, "body": "i thought you meant &quot;scraping urls from a google search page html&quot; :p oh well"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1471955497, "last_edit_date": 1471955497, "creation_date": 1433399265, "answer_id": 30636478, "question_id": 30635272, "link": "https://stackoverflow.com/questions/30635272/extract-urls-from-google-search-result-page/30636478#30636478", "title": "Extract URLs from Google search result page", "body": "<p>The standard library has support parsing URLs. Check out the <a href=\"https://golang.org/pkg/net/url/\" rel=\"nofollow\"><code>net/url</code></a> package. Using this package, we can get query parameters from URLs.</p>\n\n<p>Note that your original raw URL contains the URL you want to extract in the <code>\"aqs\"</code> parameter in the form of </p>\n\n<pre><code>chrome.0.0l2j69i59j69i60j0l2.1754j0j7/url?q=https://youknowumsayin.wordpress.com/2015/03/16/the-inventory-and-you-what-items-should-i-bring-mh4u/\n</code></pre>\n\n<p>Which is basically another URL.</p>\n\n<p>Let's write a little helper function which gets a parameter from a raw URL text:</p>\n\n<pre><code>func getParam(raw, param string) (string, error) {\n    u, err := url.Parse(raw)\n    if err != nil {\n        return \"\", err\n    }\n\n    q := u.Query()\n    if q == nil {\n        return \"\", fmt.Errorf(\"No query part\")\n    }\n\n    v := q.Get(param)\n    if v == \"\" {\n        return \"\", fmt.Errorf(\"Param not found\")\n    }\n    return v, nil\n}\n</code></pre>\n\n<p>Using this we can get the <code>\"aqs\"</code> parameter from the original URL, and using this again we can get the <code>\"q\"</code> parameter which is exactly your desired URL:</p>\n\n<pre><code>raw := \"https://www.google.com/search?sourceid=chrome-psyapi2&amp;ion=1&amp;espv=2&amp;ie=UTF-8&amp;q=mh4u%20items&amp;oq=mh4u%20items&amp;aqs=chrome.0.0l2j69i59j69i60j0l2.1754j0j7/url?q=https://youknowumsayin.wordpress.com/2015/03/16/the-inventory-and-you-what-items-should-i-bring-mh4u/&amp;sa=U&amp;ei=n8NvVdSvBMOsyATSzYKoCQ&amp;ved=0CEUQFjAL&amp;usg=AFQjCNGyD5NjsqOncyLElJt9C0hqVQ7gyA\"\naqs, err := getParam(raw, \"aqs\")\nif err != nil {\n    panic(err)\n}\nfmt.Println(aqs)\n\nresult, err := getParam(aqs, \"q\")\nfmt.Println(result)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/dwLYcpu00N\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>chrome.0.0l2j69i59j69i60j0l2.1754j0j7/url?q=https://youknowumsayin.wordpress.com/2015/03/16/the-inventory-and-you-what-items-should-i-bring-mh4u/\nhttps://youknowumsayin.wordpress.com/2015/03/16/the-inventory-and-you-what-items-should-i-bring-mh4u/\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4883216, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/73a6db6ae7d0691b4448877e3f607ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Elegant Metal", "link": "https://stackoverflow.com/users/4883216/elegant-metal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3974, "favorite_count": 0, "accepted_answer_id": 30636478, "answer_count": 1, "score": 1, "last_activity_date": 1471955497, "creation_date": 1433394126, "last_edit_date": 1433399789, "question_id": 30635272, "link": "https://stackoverflow.com/questions/30635272/extract-urls-from-google-search-result-page", "title": "Extract URLs from Google search result page", "body": "<p>I'm trying to grab all the URLs off of a Google search page and there are two ways I think I could do it, but I don't really have any idea how to do them.</p>\n\n<p><strong>First</strong>, I could simply scrape them from the <code>.r</code> tags and get the <code>href</code> attribute for each link. However, this gives me a really long string that I would have to parse through to get the URL. Here's an example of what would have to be parsed through:</p>\n\n<blockquote>\n  <p><a href=\"https://www.google.com/search?sourceid=chrome-psyapi2&amp;ion=1&amp;espv=2&amp;ie=UTF-8&amp;q=mh4u%20items&amp;oq=mh4u%20items&amp;aqs=chrome.0.0l2j69i59j69i60j0l2.1754j0j7/url?q=https://youknowumsayin.wordpress.com/2015/03/16/the-inventory-and-you-what-items-should-i-bring-mh4u/&amp;sa=U&amp;ei=n8NvVdSvBMOsyATSzYKoCQ&amp;ved=0CEUQFjAL&amp;usg=AFQjCNGyD5NjsqOncyLElJt9C0hqVQ7gyA\" rel=\"nofollow\">https://www.google.com/search?sourceid=chrome-psyapi2&amp;ion=1&amp;espv=2&amp;ie=UTF-8&amp;q=mh4u%20items&amp;oq=mh4u%20items&amp;aqs=chrome.0.0l2j69i59j69i60j0l2.1754j0j7/url?q=https://youknowumsayin.wordpress.com/2015/03/16/the-inventory-and-you-what-items-should-i-bring-mh4u/&amp;sa=U&amp;ei=n8NvVdSvBMOsyATSzYKoCQ&amp;ved=0CEUQFjAL&amp;usg=AFQjCNGyD5NjsqOncyLElJt9C0hqVQ7gyA</a></p>\n</blockquote>\n\n<p>The URL I would want out of this would be: </p>\n\n<blockquote>\n  <p><a href=\"https://youknowumsayin.wordpress.com/2015/03/16/the-inventory-and-you-what-items-should-i-bring-mh4u/\" rel=\"nofollow\">https://youknowumsayin.wordpress.com/2015/03/16/the-inventory-and-you-what-items-should-i-bring-mh4u/</a></p>\n</blockquote>\n\n<p>So I would have to create a string between the <code>https</code> and <code>&amp;sa</code> which I'm not 100% sure how to do because each really long string Google gives me is a different size so just using slice and cutting it up \"x\" amount of characters wouldn't work.</p>\n\n<p><strong>Second</strong>, underneath each link in a Google search there is the URL in green text. Right clicking that and inspecting the element gives: <code>cite class=\"_Rm\"</code> (between chevrons) which I don't know how to find with goquery because looking for <code>cite</code> with my small function just gives me more long strings of characters.</p>\n\n<p>Here is my small function, it currently does the first option without the parsing and gives me a long string of text that just takes me to the search page: </p>\n\n<pre><code>func GetUrls(url string) {\n\n    doc, err := goquery.NewDocument(url)\n\n    if err != nil {\n        panic(err)\n    }\n\n    doc.Find(\".r\").Each(func(i int, s *goquery.Selection) {\n\n        doc.Find(\".r a\").Each(func(i int, s *goquery.Selection) {\n            Link, _ := s.Attr(\"href\")\n            Link = url + Link\n            fmt.Printf(\"link is [%s]\\n\", Link)\n        })\n\n    })\n\n}\n</code></pre>\n"}, {"tags": ["interface", "go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1433405904, "post_id": 30634412, "comment_id": 49341565, "body": "<code>areaIntf := sq1</code> is not the same as <code>areaIntf := Shaper(sq1)</code>. In the former the type of <code>areaIntf</code> is <code>*Square</code>, in the latter <code>Shaper</code>. And Shaper is probably better called &quot;surface&quot;, since it only has an &quot;area&quot; method. A Shaper for me would be something that shapes (i.e. has a method called shape)."}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 3707288, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a4cccb853563fa6349abee5377d7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Xevious", "link": "https://stackoverflow.com/users/3707288/xevious"}, "edited": false, "score": 0, "creation_date": 1433429662, "post_id": 30634759, "comment_id": 49358168, "body": "Thank you. That helped immensely. I would guess that it is just an error in the book."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 1, "last_activity_date": 1433390722, "creation_date": 1433390722, "answer_id": 30634759, "question_id": 30634412, "link": "https://stackoverflow.com/questions/30634412/how-are-interfaces-used-in-the-code-example-11-1-from-the-book-the-way-to-go/30634759#30634759", "title": "How are interfaces used in the code example 11.1 from the book The Way to Go?", "body": "<p>In that example, it has no effect.</p>\n\n<p>Interfaces allow different types to adhere to a common contract, allowing you to create generalized functions.</p>\n\n<p>Here's a modified example on <a href=\"http://play.golang.org/p/3YKiM4txbA\" rel=\"nofollow\">Play</a></p>\n\n<p>Notice the printIt function, it can take any type that adheres to the Shaper interface.</p>\n\n<p>Without interfaces, you would have had to make\nprintCircle and printRectangle methods, which doesn't really work as you add more and more types to your application over time.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\ntype Shaper interface {\n    Area() float32\n}\n\ntype Square struct {\n    side float32\n}\n\nfunc (sq *Square) Area() float32 {\n    return sq.side * sq.side\n}\n\ntype Circle struct {\n    radius float32\n}\n\nfunc (c *Circle) Area() float32 {\n    return math.Pi * c.radius * c.radius\n}\n\nfunc main() {\n    sq1 := new(Square)\n    sq1.side = 5\n    circ1 := new(Circle)\n    circ1.radius = 5\n    var areaIntf Shaper\n    areaIntf = sq1\n    // areaIntf = sq1\n    // shorter, without separate declaration:\n    // areaIntf := Shaper(sq1)\n    // or even:\n    fmt.Printf(\"The square has area: %f\\n\", areaIntf.Area())\n    areaIntf = circ1\n    fmt.Printf(\"The circle has area: %f\\n\", areaIntf.Area())\n\n    // Here is where interfaces are actually interesting\n    printIt(sq1)\n    printIt(circ1)\n}\n\nfunc printIt(s Shaper) {\n    fmt.Printf(\"Area of this thing is: %f\\n\", s.Area())\n}\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 3707288, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a4cccb853563fa6349abee5377d7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Xevious", "link": "https://stackoverflow.com/users/3707288/xevious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 30634759, "answer_count": 1, "score": 1, "last_activity_date": 1433390722, "creation_date": 1433388273, "last_edit_date": 1433389613, "question_id": 30634412, "link": "https://stackoverflow.com/questions/30634412/how-are-interfaces-used-in-the-code-example-11-1-from-the-book-the-way-to-go", "title": "How are interfaces used in the code example 11.1 from the book The Way to Go?", "body": "<p>I am learning Go and am trying to fully understand how to use interfaces in Go.</p>\n\n<p>In the book The Way to Go, there is an example listing 11.1 (pages 264-265). I feel that I am definitely missing something in my understanding of it. The code runs fine, but I do not understand what effect (if any) the interface is having on the struct and method.</p>\n\n<pre><code>package main\nimport \"fmt\"\n\n\ntype Shaper interface {\n    Area() float32\n}\n\ntype Square struct {\n    side float32\n}\n\nfunc (sq *Square) Area() float32 {\n         return sq.side * sq.side\n}\n\nfunc main() {\n    sq1 := new(Square)\n    sq1.side = 5\n    // var areaIntf Shaper\n    // areaIntf = sq1\n    // shorter, without separate declaration:\n    // areaIntf := Shaper(sq1)\n    // or even:\n    areaIntf := sq1\n    fmt.Printf(\"The square has area: %f\\n\", areaIntf.Area())\n\n}\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 1, "creation_date": 1433379106, "post_id": 30633189, "comment_id": 49331982, "body": "Is there any reason you need to use regex vs strings.Split(input, &quot; &quot;)? <a href=\"http://golang.org/pkg/strings/#Split\" rel=\"nofollow noreferrer\">golang.org/pkg/strings/#Split</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1433385460, "post_id": 30633189, "comment_id": 49333380, "body": "This <code>&quot; ([+-&#47;*^]) &quot;</code> is more functional as <code>&quot;\\s*([+\\-&#47;*^])\\s*&quot;</code> and the minus sign must be escaped. Whats the problem in <code>go</code>? Does it include the capture in the output array ? Anyway, I&#39;m not sure you should split on spaces, its not really a delimiter."}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1433387108, "post_id": 30633189, "comment_id": 49333777, "body": "@sln the issue is that what I have is not returning the operators. Instead it returns &quot;[&#39;house-width&#39; &#39;3&#39; &#39;y&#39; &#39;(5&#39; &#39;house length)&#39;]&quot; <a href=\"http://play.golang.org/p/B4zCSLWPjz\" rel=\"nofollow noreferrer\">play.golang.org/p/B4zCSLWPjz</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 1, "creation_date": 1433517007, "post_id": 30633189, "comment_id": 49402112, "body": "I glanced at the docs. Go uses RE2 type expressions that don&#39;t do backtracking, nor assertions. And the split looks primitive (couldn&#39;t find any info on that). But, it looks like <code>FindAll()</code> might be your best bet. You have a dilemma though, &lt;space&gt;+&lt;operator&gt;+&lt;space&gt; can&#39;t be used as a delimiter because go&#39;s engine doesn&#39;t do lookaround assertions, therefore it consumes the last &lt;space&gt; which can&#39;t be used as the first &lt;space&gt; if there is an adjacent operator, even if you say this will never happen, there is no provision of constructs to prevent it."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1471955468, "last_edit_date": 1471955468, "creation_date": 1433402957, "answer_id": 30637633, "question_id": 30633189, "link": "https://stackoverflow.com/questions/30633189/how-do-i-include-the-operators-in-my-output-when-i-split-my-string/30637633#30637633", "title": "How do I include the operators in my output when I split my string?", "body": "<p>You can get the operands of your expression using <a href=\"https://golang.org/pkg/regexp/#Regexp.Split\" rel=\"nofollow\"><code>regexp.Split()</code></a> (just as you did) and you can get the operators (the separators) using <a href=\"https://golang.org/pkg/regexp/#Regexp.FindAllString\" rel=\"nofollow\"><code>regexp.FindAllString()</code></a>.</p>\n\n<p>By doing this you will have 2 separate <code>[]string</code> slices, you can merge these 2 slices if you want the result in one <code>[]string</code> slice.</p>\n\n<pre><code>input := \"house-width + 3 - y ^ (5 * house length)\"\n\nr := regexp.MustCompile(`\\s([+\\-/*^])\\s`)\n\ns1 := r.Split(input, -1)\ns2 := r.FindAllString(input, -1)\n\nfmt.Printf(\"%q\\n\", s1)\nfmt.Printf(\"%q\\n\", s2)\n\nall := make([]string, len(s1)+len(s2))\nfor i := range s1 {\n    all[i*2] = s1[i]\n    if i &lt; len(s2) {\n        all[i*2+1] = s2[i]\n    }\n}\nfmt.Printf(\"%q\\n\", all)\n</code></pre>\n\n<p><strong>Output (try it on the <a href=\"http://play.golang.org/p/pzYJwMcLaE\" rel=\"nofollow\">Go Playground</a>):</strong></p>\n\n<pre><code>[\"house-width\" \"3\" \"y\" \"(5\" \"house length)\"]\n[\" + \" \" - \" \" ^ \" \" * \"]\n[\"house-width\" \" + \" \"3\" \" - \" \"y\" \" ^ \" \"(5\" \" * \" \"house length)\"]\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>If you want to trim the spaces from the operators, you can use the <a href=\"https://golang.org/pkg/strings/#TrimSpace\" rel=\"nofollow\"><code>strings.TrimSpace()</code></a> function for that:</p>\n\n<pre><code>for i, v := range s2 {\n    all[i*2+1] = strings.TrimSpace(v)\n}\nfmt.Printf(\"%q\\n\", all)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[\"house-width\" \"+\" \"3\" \"-\" \"y\" \"^\" \"(5\" \"*\" \"house length)\"]\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1433439407, "post_id": 30639226, "comment_id": 49364388, "body": "&quot;You can&#39;t have both spaces and dashes&quot; That&#39;s why I am splitting on a space-separated operator."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1433407871, "creation_date": 1433407871, "answer_id": 30639226, "question_id": 30633189, "link": "https://stackoverflow.com/questions/30633189/how-do-i-include-the-operators-in-my-output-when-i-split-my-string/30639226#30639226", "title": "How do I include the operators in my output when I split my string?", "body": "<p>If you're planing to parse the expression afterwards you'll have to make some changes:</p>\n\n<ul>\n<li>Include parentheses as lexemes</li>\n<li>You can't have both spaces <em>and</em> dashes be valid identifier characters because e.g. <code>- y</code> inbetween <code>3</code> and <code>^</code> would be a valid identifier.</li>\n</ul>\n\n<p>After that's done, you can use use a simple <a href=\"http://play.golang.org/p/kHXngpFL_O\" rel=\"nofollow\">linear iteration</a> to lex your string:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    input := `house width + 3 - y ^ (5 * house length)`\n    buffr := bytes.NewBuffer(nil)\n    outpt := make([]string, 0)\n\n    for _, r := range input {\n        if r == '+' || r == '-' || r == '*' || r == '/' || r == '^' || r == '(' || r == ')' || (r &gt;= '0' &amp;&amp; r &lt;= '9') {\n            bs := bytes.TrimSpace(buffr.Bytes())\n            if len(bs) &gt; 0 {\n                outpt = append(outpt, (string)(bs))\n            }\n            outpt = append(outpt, (string)(r))\n            buffr.Reset()\n        } else {\n            buffr.WriteRune(r)\n        }\n    }\n\n    fmt.Printf(\"%#v\\n\", outpt)\n\n}\n</code></pre>\n\n<p>Once lexed, use Dijkstra's <a href=\"http://en.wikipedia.org/wiki/Shunting-yard_algorithm\" rel=\"nofollow\">shunting-yard algorithm</a> to build an AST or directly evaluate the expression.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": false, "score": 0, "last_activity_date": 1433444310, "last_edit_date": 1433444310, "creation_date": 1433443224, "answer_id": 30651658, "question_id": 30633189, "link": "https://stackoverflow.com/questions/30633189/how-do-i-include-the-operators-in-my-output-when-i-split-my-string/30651658#30651658", "title": "How do I include the operators in my output when I split my string?", "body": "<p>I think FindAll() may be the way to go.  </p>\n\n<p>Expanded regex:  </p>\n\n<pre><code> \\s*                           # Trim preceding whitespace\n (                             # (1 start), Operator/Non-Operator chars\n      (?:                           # Cluster group\n           \\w -                          # word dash\n        |  - \\w                          # or, dash word\n        |  [^+\\-/*^]                     # or, a non-operator char\n      )+                            # End cluster, do 1 to many times\n   |                              # or,\n      [+\\-/*^]                      # A single simple math operator\n )                             # (1 end)\n \\s*                           # Trim trailing whitespace\n</code></pre>\n\n<p>Go code snippet:  </p>\n\n<p><a href=\"http://play.golang.org/p/bHZ21B6Tzi\" rel=\"nofollow\">http://play.golang.org/p/bHZ21B6Tzi</a></p>\n\n<pre><code>package main\n\nimport (\n\"log\"\n\"regexp\"\n)\nfunc main() {\n    in := []byte(\"house-width + 3 - y ^ (5 * house length)\")\n    rr := regexp.MustCompile(\"\\\\s*((?:\\\\w-|-\\\\w|[^+\\\\-/*^])+|[+\\\\-/*^])\\\\s*\")\n    s := r.FindAll( in, -1 )\n    for _, ss:=range s{\n      log.Println(string(ss))\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> house-width \n + \n 3 \n - \n y \n ^ \n (5 \n * \n house length)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 30637633, "answer_count": 3, "score": 2, "last_activity_date": 1471955468, "creation_date": 1433378674, "last_edit_date": 1592644375, "question_id": 30633189, "link": "https://stackoverflow.com/questions/30633189/how-do-i-include-the-operators-in-my-output-when-i-split-my-string", "title": "How do I include the operators in my output when I split my string?", "body": "<p>Yesterday I asked <a href=\"https://stackoverflow.com/questions/30608951/how-do-i-split-on-the-space-separated-math-operators-here\">this question</a> about splitting a string in python. I've since decided to do this project in Go instead. I have the following:</p>\n<pre><code>input := &quot;house-width + 3 - y ^ (5 * house length)&quot;\ns := regexp.MustCompile(&quot; ([+-/*^]) &quot;).Split(input, -1)\nlog.Println(s)  //  [house-width 3 y (5 house length)]\n</code></pre>\n<p>How do I include the operators in this output? e.g. I'd like the following output:</p>\n<pre><code>['house-width', '+', '3', '-', 'y', '^', '(5', '*', 'house length)']\n</code></pre>\n<p>EDIT:\nTo clarify I am splitting on the space-separated operators and not just the operator. The operator must have a space on both ends to differentiate it from a dash/hyphen. Please refer to my original python question I linked to for clarification if needed.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1433378794, "post_id": 30633191, "comment_id": 49331886, "body": "Can you please explain what side effects can I get (apart of boosting the size of an execution file)"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1433380861, "post_id": 30633191, "comment_id": 49332382, "body": "Usually, the side effect is something gets registered with some other library.  For example, most SQL database drivers, import for side effect and then you can use sql.Open(&quot;dbname&quot;,&quot;url&quot;)"}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": false, "score": 3, "last_activity_date": 1433378879, "last_edit_date": 1433378879, "creation_date": 1433378709, "answer_id": 30633191, "question_id": 30633188, "link": "https://stackoverflow.com/questions/30633188/what-is-the-point-of-using-in-import-in-go/30633191#30633191", "title": "What is the point of using _ in import in go", "body": "<p>It means that you want to import it for the side effects. It's usually used with packages that include an <code>init</code>. Of course you could import it normally, too, but the <code>_</code> makes it clear that you only wanted the side effects.</p>\n\n<p>Search for \"Import for side effect\" in <a href=\"http://golang.org/doc/effective_go.html\" rel=\"nofollow\">Effective Go</a> for discussion.</p>\n\n<p>A very common example is <code>net/http/pprof</code>, which attaches some new handlers to the default mux. Packages like <code>github.com/SlyMarbo/spdy</code> use it in the same way to silently modify the default http client.</p>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1328, "favorite_count": 1, "closed_date": 1433395450, "answer_count": 1, "score": 0, "last_activity_date": 1433378879, "creation_date": 1433378649, "question_id": 30633188, "link": "https://stackoverflow.com/questions/30633188/what-is-the-point-of-using-in-import-in-go", "closed_reason": "Duplicate", "title": "What is the point of using _ in import in go", "body": "<p>I have seen a strange syntax in go while importing packages: <code>import _ fmt</code>.</p>\n\n<p>I am aware that <code>import f fmt</code> works like an alias for this package and also I know that <code>_</code> is used as a variable that should not be cared about.</p>\n\n<p>So no prize for guessing that here I am importing a package that I am not going to use. And in fact it looks like this is what happening here.</p>\n\n<hr>\n\n<p>What I fail to understand is <strong>why this might be helpful</strong>. If I use <code>for _, v := range(arr){}</code> I use <code>_</code> because I have no choice and I need to specify to the compiler that it should not worry about the variable that I will not be using. </p>\n\n<p>But if I do not intend to use a package, I would just omit it (if it might be useful later, I would comment it). But no reason for it to be compiled and added to source code.</p>\n\n<p>So is there any point of using this syntax, or is this just a useless artifact from combining aliasing and unused variables?</p>\n"}, {"tags": ["csv", "go", "io", "file-read"], "comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1433378420, "post_id": 30633115, "comment_id": 49331777, "body": "I can&#39;t reproduce this. I suspect your csv file isn&#39;t exactly what you think it is. Perhaps the line endings are strange? (Not Windows line endings; that&#39;s supported, but something else? Spaces?)"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1433378557, "post_id": 30633115, "comment_id": 49331817, "body": "it&#39;s worth a try. You might also look at it in a hex dumper like xxd and make sure it&#39;s what you think it is. And of course, make sure you&#39;re opening the file you think you are."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1433378705, "post_id": 30633115, "comment_id": 49331860, "body": "it&#39;s uploaded - I&#39;m definitely opening the right file as it&#39;s in the same directory as my code, and the last line is being outputted correctly."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 0, "creation_date": 1433379623, "post_id": 30633115, "comment_id": 49332095, "body": "@RobNapier any ideas?"}], "answers": [{"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433379819, "post_id": 30633302, "comment_id": 49332133, "body": "is there a way to programmatically do this?"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433379890, "post_id": 30633302, "comment_id": 49332151, "body": "Ideally, re-export the file. Otherwise, you could split on <code>\\r</code> rather than <code>\\n</code> as a start."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433379949, "post_id": 30633302, "comment_id": 49332164, "body": "but I don&#39;t have access to each line - I get only the last line when I print out the content"}, {"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433380007, "post_id": 30633302, "comment_id": 49332171, "body": "Because you&#39;re splitting on <code>\\n</code>. This file has <code>\\r</code> between lines. There are no <code>\\n</code> in the file, so there&#39;s just one line."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1433380151, "post_id": 30633302, "comment_id": 49332204, "body": "ah you&#39;re talking about the first way I was using. Cool. So I assume the second method i was using automatically splits on \\n?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 1, "creation_date": 1433431844, "post_id": 30633302, "comment_id": 49359787, "body": "@praks5432, You could stick a simple custom <a href=\"https://godoc.org/golang.org/x/text/transform/#Transformer\" rel=\"nofollow noreferrer\"><code>transform.Transformer</code></a> that translates <code>\\r</code> to <code>\\n</code> (and perhaps does something with invalid utf8 also) into the path. That will allow you to trivially use a streaming <code>csv.Reader</code> on a large file translating as the file is read/streamed. E.g. something like: <a href=\"https://play.golang.org/p/y3kKBI6721\" rel=\"nofollow noreferrer\">play.golang.org/p/y3kKBI6721</a>."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 1, "last_activity_date": 1433379826, "last_edit_date": 1433379826, "creation_date": 1433379677, "answer_id": 30633302, "question_id": 30633115, "link": "https://stackoverflow.com/questions/30633115/golang-file-reading-only-reading-last-line/30633302#30633302", "title": "Golang file reading only reading last line", "body": "<p>The basic problem is that this file has <code>\\r</code> line endings. It also isn't valid UTF-8. Together, those are going to cause <code>Scanner</code> a lot of trouble.</p>\n\n<p>First, we can see exactly what's in the file using <code>xxd</code></p>\n\n<pre><code>00000000: 2c2c 2c25 206f 6620 546f 7461 6c20 4578  ,,,% of Total Ex\n00000010: 7065 6e64 6974 7572 652c 2c2c 0d46 756e  penditure,,,.Fun\n</code></pre>\n\n<p>If you look, you'll see the line ending is <code>0d</code>, which is <code>\\r</code>. <code>Scanner</code> needs it to be either <code>\\r\\n</code> or <code>\\n</code>.</p>\n\n<p>Next, you may run into trouble because it isn't UTF-8. All those <code>\u00ca</code> in there are really <code>0xCA</code>, which is not a valid UTF-8 encoding. We can see that in <code>xxd</code> again:</p>\n\n<pre><code>000000b0: 3939 39ca ca2c 494e 5354 5255 4354 494f  999..,INSTRUCTIO\n000000c0: 4eca ca2c 2224 3234 392c 3339 372c 3232  N..,\"$249,397,22\n</code></pre>\n\n<p>Go will probably just ship it along as bytes (and get <code>\u00ca</code>), which is what a lot of editors try to do, but it's likely to cause trouble.</p>\n\n<p>If possible, reformat this file to use either Unix or Windows line endings in UTF-8.</p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1720, "favorite_count": 0, "accepted_answer_id": 30633302, "answer_count": 1, "score": 0, "last_activity_date": 1433379826, "creation_date": 1433378196, "last_edit_date": 1433378626, "question_id": 30633115, "link": "https://stackoverflow.com/questions/30633115/golang-file-reading-only-reading-last-line", "title": "Golang file reading only reading last line", "body": "<p>So I took some publicly available data that looks like this -</p>\n\n<p>this is the file </p>\n\n<p><a href=\"http://expirebox.com/download/b149b744768fb11aee9c5e26ad409bcc.html\" rel=\"nofollow\">http://expirebox.com/download/b149b744768fb11aee9c5e26ad409bcc.html</a></p>\n\n<pre><code>,,,% of Total Expenditure,,,\nFunction Code,Type of Activity,Expenditure,Dollars/Student (ADA),\"This District (ADA 49,497)\",All Unified School Districts,Statewide Average\n1000-1999\u00ca\u00ca,INSTRUCTION\u00ca\u00ca,\"$249,397,226\",\"$5,039\",42%,62%,62%\n1000,Instruction,\"$247,472,790\u00ca\u00ca\",\"$5,000\",42%,48%,49%\n1110,Special Education: Separate Classes,\"$1,004,074\",$20,N/A,N/A,N/A\n1120,Special Education: Resource Specialist Instruction,\"$781,629\",$16,N/A,N/A,N/A\n1130,Special Education: Supplemental Aids &amp; Services in Regular Classrooms,\"$46,747\",$1,N/A,N/A,N/A\n1180,Special Education:  Nonpublic Agencies/Schools (NPA/S),N/A,N/A,N/A,N/A,N/A\n1190,Special Education:  Other Specialized Instructional Services,\"$91,985\",$2,N/A,N/A,N/A\n1100-1199,Instruction - Special Education,\"$1,924,436\u00ca\u00ca\",$39,0%,14%,13%\n\"Subtotal, INSTRUCTION\",,\"$249,397,226\",\"$5,039\",42%,62%,62%\n2000-2999\u00ca\u00ca,INSTRUCTION-RELATED SERVICES\u00ca\u00ca,\"$132,783,414\",\"$2,683\",22%,12%,12%\n2100,Instructional Supervision and Administration,\"$89,551,041\",\"$1,809\",N/A,N/A,N/A\n2110,Instructional Supervision,N/A,N/A,N/A,N/A,N/A\n2120,Instructional Research,N/A,N/A,N/A,N/A,N/A\n2130,Curriculum Development,\"$348,369\",$7,N/A,N/A,N/A\n2140,In-house Instructional Staff Development,\"$19,855\",$0,N/A,N/A,N/A\n2150,Instructional Administration of Special Projects,N/A,N/A,N/A,N/A,N/A\n2100-2199,Instructional Supervision and Administration,\"$89,919,265\u00ca\u00ca\",\"$1,817\",15%,4%,4%\n2200,Administrative Unit (AU) of a Multidistrict SELPA,$0,$0,0%,0%,0%\n2420,\"Instructional Library, Media, and Technology\",\"$8,295,033\u00ca\u00ca\",$168,1%,1%,1%\n2490,Other Instructional Resources,\"$538,734\",$11,N/A,N/A,N/A\n2495,Parent Participation,\"$97,830\",$2,N/A,N/A,N/A\n2490-2495,Other Instructional Resources,\"$636,565\u00ca\u00ca\",$13,0%,1%,0%\n2700,School Administration,\"$33,932,551\u00ca\u00ca\",$686,6%,7%,7%\n\"Subtotal, INSTRUCTION-RELATED SERVICES\",,\"$132,783,414\",\"$2,683\",22%,12%,12%\n3000-3999\u00ca\u00ca,PUPIL SERVICES\u00ca\u00ca,\"$45,325,938\",$916,8%,8%,8%\n4000-4999\u00ca\u00ca,ANCILLARY SERVICES\u00ca\u00ca,\"$2,207,263\",$45,0%,1%,1%\n5000-5999\u00ca\u00ca,COMMUNITY SERVICES\u00ca\u00ca,$0,$0,0%,0%,0%\n6000-6999\u00ca\u00ca,ENTERPRISE\u00ca\u00ca,\"$4,264\",$0,0%,0%,0%\n7000-7999\u00ca\u00ca,GENERAL ADMINISTRATION\u00ca\u00ca,\"$27,916,858\",$564,5%,5%,6%\n8000-8999\u00ca\u00ca,PLANT SERVICES\u00ca\u00ca,\"$55,172,247\",\"$1,115\",9%,11%,10%\n9000-9999\u00ca\u00ca,OTHER OUTGO\u00ca\u00ca,\"$81,981,716\",N/A,14%,2%,2%\n\"Total Expenditures, All Activities\",,\"$594,788,926\",\"$12,017\",100%,100%,100%\n</code></pre>\n\n<p>It's in a csv. </p>\n\n<p>I have tried this code </p>\n\n<pre><code>file, err := os.Open(\"expenses.csv\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer file.Close()\n\nscanner := bufio.NewScanner(file)\nfor scanner.Scan() {\n    fmt.Println(scanner.Text())\n}\n\nif err := scanner.Err(); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>and  this</p>\n\n<pre><code>content, err := ioutil.ReadFile(\"expenses.csv\")\n\nlines := strings.Split(string(content), \"\\n\")\n\nfmt.Println(lines)\n\ncheck(err)\n\ndat, err := os.Open(\"expenses.csv\")\ncheck(err)\n\ndefer dat.Close()\n\nreader := csv.NewReader(dat)\nreader.LazyQuotes = true\n\nreader.FieldsPerRecord = -1\n\nrawCSVData, err := reader.ReadAll()\n\ncheck(err)\nfmt.Println(rawCSVData)\n\nfor _, each := range rawCSVData {\n    fmt.Println(each)\n}\n</code></pre>\n\n<p>where check is</p>\n\n<pre><code>func check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n</code></pre>\n\n<p>In both cases I get this result -</p>\n\n<pre><code>\"Total Expenditures, All Activities\",,\"$594,788,926\",\"$12,017\",100%,100%,100%,1%15%,4%,4%AA,N/A,N/Anified School Districts,Statewide Average\n</code></pre>\n\n<p>Rather than the all the lines.</p>\n\n<p>Why am I only reading the last line?</p>\n"}]