[{"tags": ["docker", "go", "ca"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1513201684, "post_id": 47802583, "comment_id": 82566574, "body": "Check the traffic with tcpdump/wireshark first, to see what exactly was sent and received. Then compare with the traffic gathered after you run the same program from your host machine."}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1513206678, "post_id": 47802583, "comment_id": 82568409, "body": "So what&#39;s the error string returned exactly? Is mybodybytes empty? Can you perform a get request (this is a post)?"}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1513207641, "post_id": 47802583, "comment_id": 82568725, "body": "Can you update this with the error message you see? Perhaps the client is failing due to the certificate not being signed. You can disable certificate checking (at your own risk) in the client by configuring the transport."}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1513211791, "post_id": 47802583, "comment_id": 82569916, "body": "how do you start docker container ? do you expose ports ?"}, {"owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "edited": false, "score": 0, "creation_date": 1513383401, "post_id": 47802583, "comment_id": 82646970, "body": "I figured it out. Not sure if it&#39;s a bug or not. If I connect using TLS in the gRPC service with the encrypted overlay docker network I get that error. If I connect using grpc.WithInsecure() I don&#39;t get the error and the results come back just fine - Am I doubling on TLS?"}], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 671, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513204742, "creation_date": 1513201525, "last_edit_date": 1513204742, "question_id": 47802583, "link": "https://stackoverflow.com/questions/47802583/golang-http-get-displays-error-eof-in-container", "title": "Golang http.Get displays error EOF in Container", "body": "<p>I have a golang script that calls an HTTP API. Everything works great when I run it on my development computer. Once I create the container and run it I get an EOF at the end of the URL on panic. I have read a lot of issues like this and have tried everyone I see. I added a ca-certificates.crt from my host machine to the container to /etc/ssl/certs/. I set the request close to true, I have disabled Keep-Alive and Compression. All of these steps worked for others on other posts. Any help appreciated.</p>\n\n<p>I got my certfile from <a href=\"https://raw.githubusercontent.com/bagder/ca-bundle/master/ca-bundle.crt\" rel=\"nofollow noreferrer\">https://raw.githubusercontent.com/bagder/ca-bundle/master/ca-bundle.crt</a></p>\n\n<p>I am running go version go1.9.2 darwin/amd64 and the container is on a ubuntu 16.04 host.</p>\n\n<pre><code>client := &amp;http.Client{Timeout: 30 * time.Second, Transport: &amp;http.Transport{\n    DisableCompression:true,\n    DisableKeepAlives:  true,\n}}\n\nurl := \"https://myapiurl.com\"\nreq, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(mybodybytes))\nreq.Close = true\nreq.Header.Set(\"Content-Type\", \"application/json\")\nresp, err := client.Do(req)\nif err != nil {\n    log.Panic(err) // Panics Here\n}\ndefer resp.Body.Close()\n...\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code> FROM scratch\n\n    ADD ca-certificates.crt /etc/ssl/certs/\n\n    ADD myservice /\n    CMD [\"/myservice\"]\n</code></pre>\n"}, {"tags": ["go", "currency-formatting"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1513195031, "post_id": 47801050, "comment_id": 82563431, "body": "I don&#39;t see any indication in the documentation of <code>x&#47;text&#47;currency</code> implying that it formats digit groupings in any way at all. It renders the currency symbol as expected, which is what it claims it does."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1513195762, "post_id": 47801050, "comment_id": 82563839, "body": "For grouping: <a href=\"https://stackoverflow.com/questions/13020308/how-to-fmt-printf-an-integer-with-thousands-comma/31046325#31046325\">How to fmt.Printf an integer with thousands comma</a>"}, {"owner": {"reputation": 429, "user_id": 1433721, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lD6AeV9Tf58/AAAAAAAAAAI/AAAAAAAAAVs/0nRvIZ5-4NA/photo.jpg?sz=128", "display_name": "Andr&#233; G. Andrade", "link": "https://stackoverflow.com/users/1433721/andr%c3%a9-g-andrade"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1513195943, "post_id": 47801050, "comment_id": 82563927, "body": "Hi @icza I did a version using this solution. But I would like one that uses system locales. I did using the following code where the currency is hardcoded  p := message.NewPrinter(language.BrazilianPortuguese) return p.Sprintf(&quot;R$ %.2f&quot;, float64(produto.Preco/100))"}], "answers": [{"tags": [], "owner": {"reputation": 1451, "user_id": 1795125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074209c5cd0c3ce13669ae5c0f594e1c?s=128&d=identicon&r=PG", "display_name": "Chaim Leib Halbert", "link": "https://stackoverflow.com/users/1795125/chaim-leib-halbert"}, "is_accepted": false, "score": 1, "last_activity_date": 1608158946, "last_edit_date": 1608158946, "creation_date": 1608153303, "answer_id": 65331205, "question_id": 47801050, "link": "https://stackoverflow.com/questions/47801050/currency-format-in-golang-using-currency-symbol-from-golang-org-x-text-currency/65331205#65331205", "title": "Currency Format in Golang using currency.Symbol from golang.org/x/text/currency", "body": "<p>In this example, I inferred the currency format from the language code.</p>\n<p><a href=\"https://goplay.space/#fqs9t8MG062\" rel=\"nofollow noreferrer\">https://goplay.space/#fqs9t8MG062</a></p>\n<pre><code>n := display.Tags(language.English)\nfor _, lcode := range []string{&quot;en_US&quot;, &quot;pt_BR&quot;, &quot;de&quot;, &quot;ja&quot;, &quot;hi&quot;} {\n    lang := language.MustParse(lcode)\n    cur, _ := currency.FromTag(lang)\n    scale, _ := currency.Cash.Rounding(cur) // fractional digits\n    dec := number.Decimal(100000.00, number.Scale(scale))\n    p := message.NewPrinter(lang)\n    p.Printf(&quot;%24v (%v): %v%v\\n&quot;, n.Name(lang), cur, currency.Symbol(cur), dec)\n}\n\n//         American English (USD): $100,000.00\n//     Brazilian Portuguese (BRL): R$100.000,00\n//                   German (EUR): \u20ac100.000,00\n//                 Japanese (JPY): \uffe5100,000\n//                    Hindi (INR): \u20b91,00,000.00\n</code></pre>\n<p>You could also parse ISO currency codes, but then you must also specify the language in which to format the number. The output language will not affect the number of fractional digits, but it <em>will</em> affect where commas and periods are used:</p>\n<p><a href=\"https://goplay.space/#DlxSmjZbHH6\" rel=\"nofollow noreferrer\">https://goplay.space/#DlxSmjZbHH6</a></p>\n<pre><code>for _, iso := range []string{&quot;USD&quot;, &quot;BRL&quot;, &quot;EUR&quot;, &quot;JPY&quot;, &quot;INR&quot;} {\n    cur := currency.MustParseISO(iso)\n    scale, _ := currency.Cash.Rounding(cur) // fractional digits\n    dec := number.Decimal(100000.00, number.Scale(scale))\n    p := message.NewPrinter(language.English)\n    p.Printf(&quot;%v: %v%v\\n&quot;, cur, currency.Symbol(cur), dec)\n}\n\n// USD: $100,000.00\n// BRL: R$100,000.00\n// EUR: \u20ac100,000.00\n// JPY: \u00a5100,000\n// INR: \u20b9100,000.00\n</code></pre>\n<p>Certain currencies are rounded in increments, like 0.05 or 0.50. For those cases, the second return value of <code>currency.Cash.Rounding(cur)</code> will return 5 or 50 instead of 1. To give the Decimal formatter the IncrementString it expects, we have to do a little more processing:</p>\n<pre><code>package main\n\nimport (\n    &quot;math&quot;\n    &quot;strconv&quot;\n\n    &quot;golang.org/x/text/currency&quot;\n    &quot;golang.org/x/text/language&quot;\n    &quot;golang.org/x/text/language/display&quot;\n    &quot;golang.org/x/text/message&quot;\n    &quot;golang.org/x/text/number&quot;\n)\n\nfunc main() {\n    n := display.Tags(language.English)\n    for _, lcode := range []string{&quot;en_US&quot;, &quot;en_CA&quot;, &quot;da&quot;, &quot;ja&quot;} {\n        lang := language.MustParse(lcode)\n        cur, _ := currency.FromTag(lang)\n        scale, incCents := currency.Cash.Rounding(cur) // fractional digits\n        incFloat := math.Pow10(-scale) * float64(incCents)\n        incFmt := strconv.FormatFloat(incFloat, 'f', scale, 64)\n        dec := number.Decimal(100000.26,\n            number.Scale(scale), number.IncrementString(incFmt))\n        p := message.NewPrinter(lang)\n        p.Printf(&quot;%24v %v, %4s-rounding: %3v%v\\n&quot;,\n            n.Name(lang), cur, incFmt, currency.Symbol(cur), dec)\n    }\n}\n\n//    American English USD, 0.01-rounding: $100,000.26\n//    Canadian English CAD, 0.05-rounding: CA$100,000.25\n//              Danish DKK, 0.50-rounding: DKK100.000,50\n//            Japanese JPY,    1-rounding: \u00a5100,000\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 1433721, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lD6AeV9Tf58/AAAAAAAAAAI/AAAAAAAAAVs/0nRvIZ5-4NA/photo.jpg?sz=128", "display_name": "Andr&#233; G. Andrade", "link": "https://stackoverflow.com/users/1433721/andr%c3%a9-g-andrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2301, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1608158946, "creation_date": 1513194519, "last_edit_date": 1513196317, "question_id": 47801050, "link": "https://stackoverflow.com/questions/47801050/currency-format-in-golang-using-currency-symbol-from-golang-org-x-text-currency", "title": "Currency Format in Golang using currency.Symbol from golang.org/x/text/currency", "body": "<p>Hi I'm working on a function to format values in currency. I'm using golang.org/x/text/currency for the job, but I'm getting the output with points at the place of commas and no thousands separators.</p>\n\n<pre><code>func (produto *Produto) FormataPreco(valor int64) string {\n    unit, _ := currency.ParseISO(\"BRL\")\n    p := message.NewPrinter(language.BrazilianPortuguese)\n    return p.Sprint(currency.Symbol(unit.Amount(float64(valor) / 100)))\n}\n</code></pre>\n\n<p>The expected result should be R$ 123.456,78 but I'm getting R$ 123456.78</p>\n\n<p>--- Edit ---</p>\n\n<p>I did a version using hardcoded values, but I would like a solution that uses system locale resources.</p>\n\n<pre><code>func (produto *Produto) FormataPreco(valor int64) string {\n    p := message.NewPrinter(language.BrazilianPortuguese)\n    return p.Sprintf(\"R$ %.2f\", float64(valor/100))\n}\n</code></pre>\n"}, {"tags": ["go", "generator", "goroutine"], "comments": [{"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1513192180, "post_id": 47800459, "comment_id": 82562033, "body": "why do you create a local buffer and store every event in it, then select from that buffer?"}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "reply_to_user": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1513192459, "post_id": 47800459, "comment_id": 82562175, "body": "@ParhamAlvani want to do it without local buffer. looking for elegant solution"}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1513192624, "post_id": 47800459, "comment_id": 82562253, "body": "As another suggestion, you can implement channels like structure with Mutex and CondVar. I can upload my implementation for you if you want this type of solution."}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "reply_to_user": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1513192743, "post_id": 47800459, "comment_id": 82562311, "body": "@ParhamAlvani it would be interesting to see it"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1513193733, "post_id": 47800459, "comment_id": 82562802, "body": "That&#39;s not how channels work, and fundamentally you can&#39;t do that and retain the guarantees that channels provide. After &quot;peeking&quot; at the value in a channel, it&#39;s not guaranteed to be the same one, or there be a value at all once you actually receive. You could use a different data structure as shown below, but then you also lose the ability to use select directly in the first place."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1513199495, "post_id": 47800740, "comment_id": 82565642, "body": "<code>AsyncRemove</code> might be better named as <code>AsyncNonBlocking</code> - since there is nothing asynchronous there."}], "tags": [], "owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "is_accepted": true, "score": 3, "last_activity_date": 1513206102, "last_edit_date": 1513206102, "creation_date": 1513193117, "answer_id": 47800740, "question_id": 47800459, "link": "https://stackoverflow.com/questions/47800459/inspect-value-from-channel/47800740#47800740", "title": "Inspect value from channel", "body": "<p>You can implement your version of go channel structure. for example following implementation act like go channel without size limit and you can inspect its first element.</p>\n\n<pre><code>package buffchan\n\nimport (\n    \"container/list\"\n    \"sync\"\n)\n\n// BufferedChannel provides go channel like interface with unlimited storage\ntype BufferedChannel struct {\n    m *sync.Mutex\n    l *list.List\n    c *sync.Cond\n}\n\n// New Creates new buffer channel\nfunc New() *BufferedChannel {\n    m := new(sync.Mutex)\n    return &amp;BufferedChannel{\n        m: m,\n        l: list.New(),\n        c: sync.NewCond(m),\n    }\n}\n\n// Append adds given data at end of channel\nfunc (b *BufferedChannel) Append(v interface{}) {\n    b.m.Lock()\n    defer b.m.Unlock()\n\n    b.l.PushBack(v)\n    b.c.Signal()\n\n}\n\n// Remove removes first element of list synchronously\nfunc (b *BufferedChannel) Remove() interface{} {\n    b.m.Lock()\n    defer b.m.Unlock()\n\n    for b.l.Len() == 0 {\n        b.c.Wait()\n    }\n\n    v := b.l.Front()\n    b.l.Remove(v)\n\n    return v.Value\n}\n\n// Inspect first element of list if exists\nfunc (b *BufferedChannel) Inspect() interface{} {\n    b.m.Lock()\n    defer b.m.Unlock()\n\n    for b.l.Len() == 0 {\n        return nil\n    }\n\n    return b.l.Front().Value\n}\n\n// AsyncRemove removes first element of list asynchronously\nfunc (b *BufferedChannel) AsyncNonBlocking() interface{} {\n    b.m.Lock()\n    defer b.m.Unlock()\n\n    for b.l.Len() == 0 {\n        return nil\n    }\n\n    v := b.l.Front()\n    b.l.Remove(v)\n\n    return v.Value\n}\n</code></pre>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 47800740, "answer_count": 1, "score": 1, "last_activity_date": 1513206102, "creation_date": 1513192044, "last_edit_date": 1513193703, "question_id": 47800459, "link": "https://stackoverflow.com/questions/47800459/inspect-value-from-channel", "title": "Inspect value from channel", "body": "<p>I have two read-only channels <code>&lt;-chan Event</code> that utilized as generators. </p>\n\n<pre><code>type Event struct{\n    time int\n}\n</code></pre>\n\n<p>I can read their values as: </p>\n\n<pre><code>for {\n    select {\n    case &lt;-chan1:\n        // do something\n    case &lt;-chan2:\n        //do something\n    }\n</code></pre>\n\n<p>I use those channels for event-driven simulations so I have to choose the <code>Event</code> with the less <code>time</code> field. </p>\n\n<p>Is it possible to inspect which value is going from each channel and only then choose from which one to read? Because the operation <code>&lt;-chan1</code> takes value from channel and it is impossible to push it back (read only channel).</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1513195862, "post_id": 47800400, "comment_id": 82563899, "body": "You could have multiple goroutines with each working on a portion of the arrays, but you won&#39;t see any performance advantage with that unless the arrays are pretty large."}, {"owner": {"reputation": 16516, "user_id": 1133291, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/538bd3553b7540f411a84101e4cbf294?s=128&d=identicon&r=PG", "display_name": "Gal Ben-Haim", "link": "https://stackoverflow.com/users/1133291/gal-ben-haim"}, "edited": false, "score": 0, "creation_date": 1513196041, "post_id": 47800400, "comment_id": 82563967, "body": "you can use the mat64 element wise multiplication and then go over the array and make an int from each element"}], "owner": {"reputation": 3223, "user_id": 702912, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9e25ee94fc81a18d3207befd8aa7837?s=128&d=identicon&r=PG", "display_name": "Charles Holbrow", "link": "https://stackoverflow.com/users/702912/charles-holbrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 748, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513191838, "creation_date": 1513191838, "question_id": 47800400, "link": "https://stackoverflow.com/questions/47800400/fast-element-wise-multiplication-of-golang-integer-arrays", "title": "Fast element wise multiplication of golang integer arrays", "body": "<p>If I have to golang arrays of the same size, Is there a faster way to perform an element wise multiply than a for loop?</p>\n\n<p>It looks like <a href=\"https://godoc.org/github.com/gonum/matrix/mat64#Dense.MulElem\" rel=\"nofollow noreferrer\">mat64 element wise multiplication</a> has some optimizations for contiguous memory, but this is only for 64 bit floating point data.</p>\n\n<p>A trivial example of the for loop is below</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nconst size = 386\n\nfunc main() {\n    var a, b, c [size]int\n\n    for i := 0; i &lt; size; i++ {\n        a[i] = i % 16\n        b[i] = i\n    }\n\n    for i := 0; i &lt; size; i++ {\n        c[i] = a[i] * b[i]\n    }\n\n    fmt.Printf(\"%v\\n\", c[:20])\n}\n</code></pre>\n"}, {"tags": ["docker", "go", "dockerfile", "delve"], "answers": [{"tags": [], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "is_accepted": true, "score": 3, "last_activity_date": 1513254158, "creation_date": 1513254158, "answer_id": 47813283, "question_id": 47797445, "link": "https://stackoverflow.com/questions/47797445/flag-provided-but-not-defined/47813283#47813283", "title": "Flag provided but not defined", "body": "<p>I was able to fix it, my <code>Dockerfile</code> looks like this now:</p>\n\n<pre><code>FROM golang:1.9.2\n\nADD . /go/src/github.com/golang/example/outyet\n\nRUN go install github.com/golang/example/outyet\nRUN [\"chmod\", \"+x\", \"/go/src/github.com/golang/example/outyet/bootstrap.sh\"]\nRUN [\"chmod\", \"+x\", \"/go/bin/outyet\"]\n\nCMD [\"/go/src/github.com/golang/example/outyet/bootstrap.sh\"]\n\nEXPOSE 8091\nEXPOSE 5432\n</code></pre>\n\n<p>bootstrap.sh:</p>\n\n<pre><code>#!/bin/sh\ngo get github.com/derekparker/delve/cmd/dlv;\ngo build -gcflags='-N -l' github.com/golang/example/outyet &amp;&amp; \ndlv --listen=:5432 --headless=true --api-version=2 exec outyet\n</code></pre>\n\n<p>And run it as following:</p>\n\n<pre><code>sudo docker build -t outyet .\nsudo docker run --security-opt=seccomp:unconfined --net=host  --name test --rm outyet\n</code></pre>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7720, "favorite_count": 0, "accepted_answer_id": 47813283, "answer_count": 1, "score": 1, "last_activity_date": 1513267728, "creation_date": 1513181099, "last_edit_date": 1513267728, "question_id": 47797445, "link": "https://stackoverflow.com/questions/47797445/flag-provided-but-not-defined", "title": "Flag provided but not defined", "body": "<p>I have following <code>Dockerfile</code>: </p>\n\n<pre><code>FROM golang:1.9.2\n\nADD . /go/src/github.com/golang/example/outyet\nADD . /go/src/github.com/derekparker/delve/cmd/dlv\n\nRUN go install github.com/golang/example/outyet\nRUN go install github.com/derekparker/delve/cmd/dlv\n\nRUN [\"chmod\", \"+x\", \"/go/src/github.com/golang/example/outyet/bootstrap.sh\"]\nCMD [\"/go/src/github.com/golang/example/outyet/bootstrap.sh\"]\n\nEXPOSE 8091\nEXPOSE 5432\n</code></pre>\n\n<p>And following <code>bootstrap.sh</code>:</p>\n\n<pre><code>#!/bin/sh\ngo build -gcflags='-N -l' github.com/golang/example/outyet &amp;&amp; \ndlv --listen=:5432 --headless=true --api-version=2 exec outyet;\n</code></pre>\n\n<p>After running container and image with following lines:</p>\n\n<pre><code>sudo docker build -t outyet .\nsudo docker run -p 6060:8091 -p 5432:5432  --name test --rm outyet\n</code></pre>\n\n<p>I get following output:</p>\n\n<pre><code>flag provided but not defined: -listen\nUsage of dlv:\n  -http string\n        Listen address (default \":8091\")\n  -poll duration\n        Poll period (default 1s)\n  -version string\n        Go version (default \"1.4\")\n</code></pre>\n\n<p>When I run bootstrap.sh locally on my ubuntu hostmachine everything works fine. What is wrong?</p>\n"}, {"tags": ["java", "go", "cryptography", "sha512"], "answers": [{"comments": [{"owner": {"reputation": 426, "user_id": 1769115, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/72857f57e422bec26d0afbfbaacd24c7?s=128&d=identicon&r=PG", "display_name": "Zach Kauffman", "link": "https://stackoverflow.com/users/1769115/zach-kauffman"}, "edited": false, "score": 1, "creation_date": 1513181210, "post_id": 47797161, "comment_id": 82555694, "body": "wow - TIL! what would the inverse operation be? (taking the Go version and creating the java version). Thanks a lot!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 426, "user_id": 1769115, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/72857f57e422bec26d0afbfbaacd24c7?s=128&d=identicon&r=PG", "display_name": "Zach Kauffman", "link": "https://stackoverflow.com/users/1769115/zach-kauffman"}, "edited": false, "score": 1, "creation_date": 1513181295, "post_id": 47797161, "comment_id": 82555749, "body": "@ZachKauffman: it&#39;s the same data, it&#39;s just the difference between interpreting it as signed or unsigned."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 426, "user_id": 1769115, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/72857f57e422bec26d0afbfbaacd24c7?s=128&d=identicon&r=PG", "display_name": "Zach Kauffman", "link": "https://stackoverflow.com/users/1769115/zach-kauffman"}, "edited": false, "score": 1, "creation_date": 1513181590, "post_id": 47797161, "comment_id": 82555951, "body": "@ZachKauffman Yes, to display a Go <code>byte</code> value in a signed fashion, just convert it to <code>int8</code>. See edited answer."}, {"owner": {"reputation": 426, "user_id": 1769115, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/72857f57e422bec26d0afbfbaacd24c7?s=128&d=identicon&r=PG", "display_name": "Zach Kauffman", "link": "https://stackoverflow.com/users/1769115/zach-kauffman"}, "edited": false, "score": 0, "creation_date": 1513182167, "post_id": 47797161, "comment_id": 82556315, "body": "Awesome! Guess I need to brush up on my fundamentals a bit (pun intended). It looks like changing my return from <code>base64.StdEncoding.EncodeToString(h.Sum(nil))</code> to <code>hex.EncodeToString(h.Sum(nil))</code> in the Go version solved the problem."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 426, "user_id": 1769115, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/72857f57e422bec26d0afbfbaacd24c7?s=128&d=identicon&r=PG", "display_name": "Zach Kauffman", "link": "https://stackoverflow.com/users/1769115/zach-kauffman"}, "edited": false, "score": 2, "creation_date": 1513182511, "post_id": 47797161, "comment_id": 82556553, "body": "@ZachKauffman Base64 and hex encoding are quite different things (giving completely different result). So basically the long -&gt; byte array conversion is right in your case, but in your examples the <code>counter</code> value was different."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1513182703, "last_edit_date": 1513182703, "creation_date": 1513180191, "answer_id": 47797161, "question_id": 47797100, "link": "https://stackoverflow.com/questions/47797100/java-vs-golang-for-hotp-rfc-4226/47797161#47797161", "title": "Java vs. Golang for HOTP (rfc-4226)", "body": "<p>The <code>byte</code> type in Java is signed, it has a range of <code>-128..127</code>, while in Go <code>byte</code> is an alias of <code>uint8</code> and has a range of <code>0..255</code>. So if you want to compare the results, you have to shift negative Java values by <code>256</code> (add <code>256</code>).</p>\n\n<p><em>Tip: To display a Java <code>byte</code> value in an unsigned fashion, use: <code>byteValue &amp; 0xff</code> which converts it to <code>int</code> using the 8 bits of the <code>byte</code> as the lowest 8 bits in the <code>int</code>. Or better: display both results in hex form so you don't have to care about sign-ness...</em></p>\n\n<p>Adding 256 to your negative Java byte values, the output is <strong>almost</strong> identical to Go's: the last byte is off by 1:</p>\n\n<pre><code>javabytes := []int{83, -116, -9, -98, 115, -126, -3, -48}\nfor i, b := range javabytes {\n    if b &lt; 0 {\n        javabytes[i] += 256\n    }\n}\nfmt.Println(javabytes)\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>[83 140 247 158 115 130 253 208]\n</code></pre>\n\n<p>So the last byte of your Java array is <code>208</code> while Go's is <code>207</code>. I'm guessing your <code>counter</code> is incremented once somewhere else in your code which you haven't posted.</p>\n\n<p>What differs is that in Java you return the hex encoded result while in Go you return the Base64 encoded result (they are 2 different encodings giving entirely different results). As you confirmed, in Go returning <code>hex.EncodeToString(h.Sum(nil))</code> the results match.</p>\n\n<p><em>Tip #2: To display Go's bytes in a signed fashion, simply convert them to <code>int8</code> (which is signed) like this:</em></p>\n\n<pre><code>gobytes := []byte{83, 140, 247, 158, 115, 130, 253, 207}\nfor _, b := range gobytes {\n    fmt.Print(int8(b), \" \")\n}\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>83 -116 -9 -98 115 -126 -3 -49 \n</code></pre>\n"}], "owner": {"reputation": 426, "user_id": 1769115, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/72857f57e422bec26d0afbfbaacd24c7?s=128&d=identicon&r=PG", "display_name": "Zach Kauffman", "link": "https://stackoverflow.com/users/1769115/zach-kauffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 0, "accepted_answer_id": 47797161, "answer_count": 1, "score": 5, "last_activity_date": 1513182703, "creation_date": 1513180034, "question_id": 47797100, "link": "https://stackoverflow.com/questions/47797100/java-vs-golang-for-hotp-rfc-4226", "title": "Java vs. Golang for HOTP (rfc-4226)", "body": "<p>I'm trying to implement HOTP (rfc-4226) in Golang and I'm struggling to generate a valid HOTP. I can generate it in java but for some reason my implementation in Golang is different. Here are the samples:</p>\n\n<pre><code>public static String constructOTP(final Long counter, final String key)\n        throws NoSuchAlgorithmException, DecoderException, InvalidKeyException {\n    final Mac mac = Mac.getInstance(\"HmacSHA512\");\n\n    final byte[] binaryKey = Hex.decodeHex(key.toCharArray());\n\n    mac.init(new SecretKeySpec(binaryKey, \"HmacSHA512\"));\n    final byte[] b = ByteBuffer.allocate(8).putLong(counter).array();\n    byte[] computedOtp = mac.doFinal(b);\n\n    return new String(Hex.encodeHex(computedOtp));\n}\n</code></pre>\n\n<p>and in Go:</p>\n\n<pre><code>func getOTP(counter uint64, key string) string {\n    str, err := hex.DecodeString(key)\n    if err != nil {\n        panic(err)\n    }\n    h := hmac.New(sha512.New, str)\n    bs := make([]byte, 8)\n    binary.BigEndian.PutUint64(bs, counter)\n    h.Write(bs)\n    return base64.StdEncoding.EncodeToString(h.Sum(nil))\n}\n</code></pre>\n\n<p>I believe the issue is that the Java line: <code>ByteBuffer.allocate(8).putLong(counter).array();</code> generates a different byte array than the Go line: <code>binary.BigEndian.PutUint64(bs, counter)</code>.</p>\n\n<p>In Java, the following byte array is generated: <code>83 -116 -9 -98 115 -126 -3 -48</code> and in Go: <code>83 140 247 158 115 130 253 207</code>.</p>\n\n<p>Does anybody know the difference in the two lines and how I can port the java line to go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 2, "creation_date": 1513177313, "post_id": 47796079, "comment_id": 82553090, "body": "You should probably check the documentation before asking: <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Interface_types</a>"}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 3726494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4dee191da7592b79ede06dc2658d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3726494", "link": "https://stackoverflow.com/users/3726494/user3726494"}, "edited": false, "score": 0, "creation_date": 1513177909, "post_id": 47796136, "comment_id": 82553515, "body": "Thanks for the quick response.  I followed through the tour before posting but was hoping that there was more functionality than was documented there.  I guess I&#39;ve been programming too much C++ lately.  Your method will work, it just means extra function calls whereas direct access to a channel in the interface would be faster and have simpler looking code."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 3, "last_activity_date": 1513177234, "creation_date": 1513177234, "answer_id": 47796136, "question_id": 47796079, "link": "https://stackoverflow.com/questions/47796079/define-an-interface-with-a-channel-in-go/47796136#47796136", "title": "Define an interface with a channel in Go", "body": "<p>An interface does not hold data, it defines what something implements.</p>\n\n<p>You could have a method that returns a channel. eg:</p>\n\n<pre><code>type I interface {\n    getChannel() (chan []byte)\n    otherMethod()\n}\n</code></pre>\n\n<p>Please read up on interfaces. The <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">tour</a> would help.</p>\n"}], "owner": {"reputation": 213, "user_id": 3726494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb4dee191da7592b79ede06dc2658d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3726494", "link": "https://stackoverflow.com/users/3726494/user3726494"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 47796136, "answer_count": 1, "score": -3, "last_activity_date": 1513177234, "creation_date": 1513177104, "question_id": 47796079, "link": "https://stackoverflow.com/questions/47796079/define-an-interface-with-a-channel-in-go", "title": "Define an interface with a channel in Go", "body": "<p>Can I define an interface with a channel in Go?  I would like to define an interface that would allow me to use objects of different types that would all have the same channel defined.  EXE:</p>\n\n<pre><code>type I interface {\n    chan Communications []byte\n    otherMethod()\n}\n</code></pre>\n\n<p>(This give syntax error: unexpected token chan.  I tried a few different syntaxes and some googling with no avail.)</p>\n"}, {"tags": ["docker", "go", "dockerfile"], "comments": [{"owner": {"reputation": 12854, "user_id": 559504, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/87b61c83e24e695ac8528fcb1a3cbed3?s=128&d=identicon&r=PG", "display_name": "johnharris85", "link": "https://stackoverflow.com/users/559504/johnharris85"}, "edited": false, "score": 0, "creation_date": 1513174659, "post_id": 47794740, "comment_id": 82551224, "body": "This post should point you in the right direction - <a href=\"https://www.goinggo.net/2013/08/using-time-timezones-and-location-in-go.html\" rel=\"nofollow noreferrer\">goinggo.net/2013/08/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1513174868, "post_id": 47794740, "comment_id": 82551352, "body": "Were do you expect the timezone information come from if you build your image from scratch?"}, {"owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "edited": false, "score": 0, "creation_date": 1513175225, "post_id": 47794740, "comment_id": 82551566, "body": "From the image environment variable or write in the golang code."}, {"owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "edited": false, "score": 0, "creation_date": 1513175500, "post_id": 47794740, "comment_id": 82551763, "body": "I just want a minimum image to run go binary file. Empty is best."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1513176011, "post_id": 47794740, "comment_id": 82552121, "body": "You need to add the TZ data file.  If the app uses TLS, you will also need to include root certs."}, {"owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "edited": false, "score": 0, "creation_date": 1513177916, "post_id": 47794740, "comment_id": 82553521, "body": "OK, it&#39;s a good idea. Now I should find a way to reduce the TZ data file size."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1513182984, "post_id": 47794740, "comment_id": 82556888, "body": "You can include a subset of the zone info. Perhaps include  Asia/Shanghai and UTC only."}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 851428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22296c67ba443c0bad5cefbe5e83a3e0?s=128&d=identicon&r=PG", "display_name": "luismartingil", "link": "https://stackoverflow.com/users/851428/luismartingil"}, "is_accepted": true, "score": 2, "last_activity_date": 1583228236, "creation_date": 1583228236, "answer_id": 60504169, "question_id": 47794740, "link": "https://stackoverflow.com/questions/47794740/gos-time-doesnt-work-under-the-docker-image-from-scratch/60504169#60504169", "title": "Go&#39;s time doesn&#39;t work under the docker image from scratch", "body": "<p>Using this library <a href=\"https://godoc.org/4d63.com/tz\" rel=\"nofollow noreferrer\">https://godoc.org/4d63.com/tz</a></p>\n\n<p>Their example (see <code>tz.LoadLocation</code>):</p>\n\n<pre><code>t := time.Date(2009, time.November, 10, 23, 0, 0, 0, time.UTC)\nfmt.Println(t)\n\nsyd, _ := tz.LoadLocation(\"Australia/Sydney\")\nfmt.Println(t.In(syd))\n\n// Output:\n\n// 2009-11-10 23:00:00 +0000 UTC\n// 2009-11-11 10:00:00 +1100 AEDT\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 540, "user_id": 5221418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14fa0854e0be21696d0e721a9e0ba5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Jyosua", "link": "https://stackoverflow.com/users/5221418/jyosua"}, "edited": false, "score": 0, "creation_date": 1603074434, "post_id": 62160085, "comment_id": 113911482, "body": "Using alpine opens your container up to more attack vectors and is a heavy-handed approach. Using scratch is not only fine, but a good idea if you&#39;re going for security or performance. If you want access to platform-independent timezones, the above answer to use tz is honestly better."}], "tags": [], "owner": {"reputation": 1904, "user_id": 4143613, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/nRk19.png?s=128&g=1", "display_name": "erajuan", "link": "https://stackoverflow.com/users/4143613/erajuan"}, "is_accepted": false, "score": 2, "last_activity_date": 1591126724, "creation_date": 1591126724, "answer_id": 62160085, "question_id": 47794740, "link": "https://stackoverflow.com/questions/47794740/gos-time-doesnt-work-under-the-docker-image-from-scratch/62160085#62160085", "title": "Go&#39;s time doesn&#39;t work under the docker image from scratch", "body": "<p>Docker FROM alphine</p>\n\n<pre><code>RUN apk --no-cache add tzdata\n</code></pre>\n\n<p>see answer in:\n<a href=\"https://stackoverflow.com/a/62159987/4143613\">https://stackoverflow.com/a/62159987/4143613</a></p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 2291886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d94d277ece247295c9ca745b28c60067?s=128&d=identicon&r=PG", "display_name": "Gianfranco Reppucci", "link": "https://stackoverflow.com/users/2291886/gianfranco-reppucci"}, "is_accepted": false, "score": 0, "last_activity_date": 1616169888, "last_edit_date": 1616169888, "creation_date": 1616169585, "answer_id": 66711576, "question_id": 47794740, "link": "https://stackoverflow.com/questions/47794740/gos-time-doesnt-work-under-the-docker-image-from-scratch/66711576#66711576", "title": "Go&#39;s time doesn&#39;t work under the docker image from scratch", "body": "<p>I think the proper way to solve this is to import tzdata as the library wants it to be. You can make use of the <code>TZ</code> environment variable.</p>\n<p>The solution is indicated in a Dockerfile which I found on GitHub <a href=\"https://github.com/Senorsen/docker-go-scratch/blob/master/Dockerfile\" rel=\"nofollow noreferrer\">here</a></p>\n<p>To wrap up everything:</p>\n<pre><code>FROM golang:alpine AS build\nRUN apk update &amp;&amp; apk add ca-certificates &amp;&amp; apk add tzdata\nWORKDIR /app\nADD . .\nRUN CGO_ENABLED=0 GOOS=linux go build -o myapp\n\nFROM scratch AS final\nCOPY --from=build /usr/share/zoneinfo /usr/share/zoneinfo\nCOPY --from=build /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\nCOPY --from=build /app/myapp /\n\nENV TZ Australia/Sydney\nENTRYPOINT [&quot;/myapp&quot;]\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1765, "favorite_count": 0, "accepted_answer_id": 60504169, "answer_count": 3, "score": 3, "last_activity_date": 1616169888, "creation_date": 1513173322, "last_edit_date": 1513174055, "question_id": 47794740, "link": "https://stackoverflow.com/questions/47794740/gos-time-doesnt-work-under-the-docker-image-from-scratch", "title": "Go&#39;s time doesn&#39;t work under the docker image from scratch", "body": "<p>Go code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    var local,_ = time.LoadLocation(\"Asia/Shanghai\")\n    fmt.Println(time.Now())\n    fmt.Println(time.Now().In(local))\n}\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM scratch\nCOPY ./main /main\nCMD [ \"/main\" ]\n</code></pre>\n\n<p>build.sh:</p>\n\n<pre><code>rm -rf main\nCGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o main  . \ndocker build -t hello-go .\ndocker run hello-go\n</code></pre>\n\n<p>All the file are in one folder named hello-go. When I run my Go code in my osx. It works. </p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>\u279c  hello-go go run main.go\n2017-12-13 21:50:53.482933 +0800 CST m=+0.000350077\n2017-12-13 21:50:53.483007 +0800 CST\n</code></pre>\n\n<p>When i build the docker image and start it. one error like this:</p>\n\n<pre><code>\u279c  hello-go ./build.sh\nSending build context to Docker daemon  1.937MB\nStep 1/3 : FROM scratch\n ---&gt;\nStep 2/3 : COPY ./main /main\n ---&gt; 80da783f6c5d\nStep 3/3 : CMD /main\n ---&gt; Running in 85cb022b3ce2\n ---&gt; 485ddd3a08dd\nRemoving intermediate container 85cb022b3ce2\nSuccessfully built 485ddd3a08dd\nSuccessfully tagged hello-go:latest\n2017-12-13 13:52:59.861173734 +0000 UTC m=+0.000252335\npanic: time: missing Location in call to Time.In\n\ngoroutine 1 [running]:\ntime.Time.In(0xbe846a0ef355744e, 0x4d607, 0x539b80, 0x0, 0x0, 0x0, 0xc420037f70)\n        /usr/local/go/src/time/time.go:1073 +0xc0\nmain.main()\n        /Users/liujichun/Desktop/workspace/docker/hello-go/main.go:11 +0xee\n\u279c  hello-go\n</code></pre>\n\n<p>I know the scratch image is empty. What should i do to make it.</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513181293, "post_id": 47792443, "comment_id": 82555747, "body": "They are not the same thing, as the error clearly indicates."}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1513166712, "creation_date": 1513166712, "answer_id": 47792593, "question_id": 47792443, "link": "https://stackoverflow.com/questions/47792443/go-protobuf-not-recognizing-identical-packages/47792593#47792593", "title": "Go protobuf not recognizing identical packages", "body": "<p>Your error is on this line:</p>\n\n<pre><code> _, err = sink.Flush(context.Background(), *google_protobuf.Empty{})\n</code></pre>\n\n<p><code>*google_protobuf.Empty{}</code> is attempting to dereference the struct, but your function prototype expects a pointer to a <code>google_protobuf.Empty</code>. Use <code>&amp;google_protobuf.Empty{}</code> instead. And when you end up with a real data structure rather than empty, you will probably do something along the lines of:</p>\n\n<pre><code>  req := google_protobuf.MyRequestStruct{}\n  _, err = service.Method(context.Background(), &amp;req)\n</code></pre>\n\n<p>For an overview of pointer syntax in go, please take the <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">tour</a></p>\n"}], "owner": {"reputation": 3261, "user_id": 1818847, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fPeO9.jpg?s=128&g=1", "display_name": "Mario Stoilov", "link": "https://stackoverflow.com/users/1818847/mario-stoilov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 1, "accepted_answer_id": 47792593, "answer_count": 1, "score": 1, "last_activity_date": 1513166712, "creation_date": 1513166237, "question_id": 47792443, "link": "https://stackoverflow.com/questions/47792443/go-protobuf-not-recognizing-identical-packages", "title": "Go protobuf not recognizing identical packages", "body": "<p>I have some code that uses google protobuf. These are the source files:</p>\n\n<p>Proto file:</p>\n\n<pre><code>syntax = \"proto3\";\n\npackage my_package.protocol;\noption go_package = \"protocol\";\n\nimport \"github.com/golang/protobuf/ptypes/empty/empty.proto\";\n\n...\n\nservice MyService {\n    rpc Flush        (google.protobuf.Empty) returns (google.protobuf.Empty);\n}\n</code></pre>\n\n<p>Compiled go file:</p>\n\n<pre><code>package protocol\n\nimport proto \"github.com/golang/protobuf/proto\"\nimport fmt \"fmt\"\nimport math \"math\"\nimport google_protobuf \"github.com/golang/protobuf/ptypes/empty\"\n\nimport (\n    context \"golang.org/x/net/context\"\n    grpc \"google.golang.org/grpc\"\n)\n\n...\n\ntype MyServiceClient interface {\n    Flush(ctx context.Context, in *google_protobuf.Empty, opts ...grpc.CallOption) (*google_protobuf.Empty, error)\n}\n</code></pre>\n\n<p>And when I finally try to use the compiled service like this:</p>\n\n<pre><code>import (\n    \"golang.org/x/net/context\"\n\n    pb \"myproject/protocol\"\n\n    google_protobuf \"github.com/golang/protobuf/ptypes/empty\"\n)\n...\nfunc Flush(sink pb.MyServiceClient) {\n    _, err = sink.Flush(context.Background(), *google_protobuf.Empty{})\n    ...\n}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Cannot use '*google_protobuf.Empty{}' (type\n  \"myproject/vendor/github.com/golang/protobuf/ptypes/empty\".Empty) as\n  type\n  \"myproject/vendor/github.com/golang/protobuf/ptypes/empty\".*google_protobuf.Empty</p>\n</blockquote>\n\n<p>Which are the same thing (they even resolve to the same file). What am I missing here?</p>\n"}, {"tags": ["xml", "go", "soap", "unmarshalling"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1513164565, "post_id": 47791873, "comment_id": 82544866, "body": "an ugly hack for an ugly format. I don&#39;t see how you d do otherwise."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1513165580, "post_id": 47791873, "comment_id": 82545437, "body": "Where is your attempt?"}, {"owner": {"reputation": 471, "user_id": 2210282, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/997edbdae64652689b581c9a57ccfac7?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/2210282/sam"}, "edited": false, "score": 0, "creation_date": 1513166674, "post_id": 47791873, "comment_id": 82546062, "body": "At least leave a comment on why you just downvoted my question. Simply downvoting doesn&#39;t help me to understand what&#39;s wrong, thus it is not constructive."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1513166849, "post_id": 47791873, "comment_id": 82546157, "body": "Best to put your code in the question. At least the core of the relevant part. Playground links are useful as additions, but playground links don&#39;t last forever, and your question will."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1513166885, "post_id": 47791873, "comment_id": 82546181, "body": "And BTW, my downvote was accompanied with a comment. But that&#39;s not a requirement, and asking for that is just noise."}, {"owner": {"reputation": 471, "user_id": 2210282, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/997edbdae64652689b581c9a57ccfac7?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/2210282/sam"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1513166970, "post_id": 47791873, "comment_id": 82546226, "body": "@Flimzy Thanks for pointing that. I&#39;ll include the code now."}], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 2210282, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/997edbdae64652689b581c9a57ccfac7?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/2210282/sam"}, "edited": false, "score": 0, "creation_date": 1514649680, "post_id": 47798186, "comment_id": 83040971, "body": "Sorry for the delay to respond, Thanks for your answer but I guess using regex may have a performance hit compared to using a custom parser."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1513184887, "last_edit_date": 1513184887, "creation_date": 1513183316, "answer_id": 47798186, "question_id": 47791873, "link": "https://stackoverflow.com/questions/47791873/unmarshalling-a-specific-soap-response-in-go/47798186#47798186", "title": "Unmarshalling a specific SOAP response in go", "body": "<p>Since the contents of the <code>doSendResult</code> element appears to be a \"custom\" format (as opposed to a well-formed document such as HTML, XML, etc.) regular expressions might be a good way to parse the result here.</p>\n\n<p>For example:</p>\n\n<pre><code>type SendResult struct {\n  Status    string\n  ReturnIds []string\n}\n\nvar doSendResultRegex = regexp.MustCompile(\"^Send (.*?)\\\\.&lt;ReturnIDs&gt;(.*?)&lt;/ReturnIDs&gt;$\")\n\nfunc ParseSendResult(s string) *SendResult {\n  ss := doSendResultRegex.FindStringSubmatch(s)\n  if ss == nil {\n    return nil\n  }\n  return &amp;SendResult{\n    Status:    ss[1],\n    ReturnIds: strings.Split(ss[2], \";\"),\n  }\n}\n\n// ...\nfmt.Println(\"%#v\\n\", ParseSendResult(response.Result.RawMessage))\n// &amp;main.SendResult{\n//   Status:    \"OK\",\n//   ReturnIds: []string{\"c71cf425f5\", \"e5e4dbb5ca\"}\n// }\n</code></pre>\n\n<p>Of course, you may want to modify the <code>doSendResultRegex</code> expression depending on other examples of that data but the code above should illustrate the idea.</p>\n"}, {"comments": [{"owner": {"reputation": 471, "user_id": 2210282, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/997edbdae64652689b581c9a57ccfac7?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/2210282/sam"}, "edited": false, "score": 1, "creation_date": 1514649913, "post_id": 47799417, "comment_id": 83041042, "body": "Sorry for the delay, Thank, your answer helped me a lot. Based on this <a href=\"http://herman.asia/efficient-string-concatenation-in-go\" rel=\"nofollow noreferrer\">herman.asia/efficient-string-concatenation-in-go</a>, I used the buffer approach instead of simple concatenation. Although the performance gain might not be much with the current load, I guess it would pay off with higher loads at certain times."}], "tags": [], "owner": {"reputation": 1721, "user_id": 3625217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e04c2f250002971ff233b86a0e25354?s=128&d=identicon&r=PG", "display_name": "Jess&#233; Catrinck", "link": "https://stackoverflow.com/users/3625217/jess%c3%a9-catrinck"}, "is_accepted": true, "score": 0, "last_activity_date": 1513187711, "creation_date": 1513187711, "answer_id": 47799417, "question_id": 47791873, "link": "https://stackoverflow.com/questions/47791873/unmarshalling-a-specific-soap-response-in-go/47799417#47799417", "title": "Unmarshalling a specific SOAP response in go", "body": "<p>You can decode the doSendResult tag content with multiple ways, but I did a example:</p>\n\n<p><a href=\"https://play.golang.org/p/NC9YrWqK0k\" rel=\"nofollow noreferrer\">play.golang.org/p/NC9YrWqK0k</a></p>\n\n<p>I defined two type corresponding to the tags inside body of the soap envelop:</p>\n\n<pre><code>type (\n    SendResponse struct {\n        SendResult SendResult `xml:\"Body&gt;doSendResponse&gt;doSendResult\"`\n    }\n\n    SendResult struct {\n        RawMessage string   `xml:\"-\"`\n        Text       string   `xml:\"-\"`\n        IDS        []string `xml:\"-\"`\n    }\n)\n</code></pre>\n\n<p>The type <code>SendResult</code> has a custom unmarshal function to read the raw message and populate the struct</p>\n\n<pre><code>func (sr *SendResult) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    var raw string\n    d.DecodeElement(&amp;raw, &amp;start)\n\n    var st struct {\n        Contents  string `xml:\",chardata\"`\n        ReturnIDs string `xml:\"ReturnIDs\"`\n    }\n\n    err := xml.Unmarshal([]byte(\"&lt;xml&gt;\"+raw+\"&lt;/xml&gt;\"), &amp;st)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    sr.RawMessage = raw\n    sr.Text = st.Contents\n    sr.IDS = strings.Split(st.ReturnIDs, \";\")\n\n    return nil\n}\n</code></pre>\n\n<p>This is the how to use:</p>\n\n<pre><code>const data = `&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3rg/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n    &lt;soap:Body&gt;\n        &lt;doSendResponse&gt;\n            &lt;doSendResult&gt;Send OK.&amp;lt;ReturnIDs&amp;gt;c71cf425f5;e5e4dbb5ca&amp;lt;/ReturnIDs&amp;gt;&lt;/doSendResult&gt;\n        &lt;/doSendResponse&gt;\n    &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;`\n\nfunc main() {\n    var sendResponse SendResponse\n\n    err := xml.Unmarshal([]byte(data), &amp;sendResponse)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    fmt.Printf(\"%+v\\n\", sendResponse)\n}\n</code></pre>\n"}], "owner": {"reputation": 471, "user_id": 2210282, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/997edbdae64652689b581c9a57ccfac7?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/2210282/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1068, "favorite_count": 1, "accepted_answer_id": 47799417, "answer_count": 2, "score": 1, "last_activity_date": 1513187711, "creation_date": 1513164343, "last_edit_date": 1513167616, "question_id": 47791873, "link": "https://stackoverflow.com/questions/47791873/unmarshalling-a-specific-soap-response-in-go", "title": "Unmarshalling a specific SOAP response in go", "body": "<p>I am trying to unmarshal the following SOAP response using the below structs.   </p>\n\n<pre><code>var data = `&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3rg/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n    &lt;soap:Body&gt;\n        &lt;doSendResponse&gt;\n            &lt;doSendResult&gt;Send OK.&amp;lt;ReturnIDs&amp;gt;c71cf425f5;e5e4dbb5ca&amp;lt;/ReturnIDs&amp;gt;&lt;/doSendResult&gt;\n        &lt;/doSendResponse&gt;\n    &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;`\n\ntype ResponseBody struct {\n    ResponseBody SendResponse `xml:\"Body\"`\n}\ntype SendResponse struct {\n    Result Result `xml:\"doSendResponse\"`\n}\ntype Result struct {\n    RawMessage string `xml:\"doSendResult\"`\n}\n</code></pre>\n\n<p>All goes well until after the <code>&lt;doSendResult&gt;</code> element.<br>\nThis particular tag contains a message i.e. \"Send OK.\" and an HTML encoded <code>&lt;ReturnIDs&gt;</code> element, the problem isn't about the HTML encoded parts, I've already seen <a href=\"https://stackoverflow.com/questions/23585914/unmarshalling-escaped-xml\">this question and the accepted answer.</a>\nMy problem is that I can't manage to extract both the message and the return IDs.</p>\n\n<p>I tried to use the approach suggested in the previously mentioned question but I failed, <a href=\"https://play.golang.org/p/iY4LvUArM3\" rel=\"nofollow noreferrer\">Here</a> is what I tried so far.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nvar data = `&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3rg/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n    &lt;soap:Body&gt;\n        &lt;doSendResponse&gt;\n            &lt;doSendResult&gt;Send OK.&amp;lt;ReturnIDs&amp;gt;c71cf425f5;e5e4dbb5ca&amp;lt;/ReturnIDs&amp;gt;&lt;/doSendResult&gt;\n        &lt;/doSendResponse&gt;\n    &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;`\n\ntype ResponseBody struct {\n    ResponseBody SendResponse `xml:\"Body\"`\n}\ntype SendResponse struct {\n    Result Result `xml:\"doSendResponse\"`\n}\ntype Result struct {\n    RawMessage string `xml:\"doSendResult\"`\n}\ntype RawMessage struct {\n    IDs     string `xml:\"ReturnIDs\"`\n}\n\nfunc main() {\n    var response ResponseBody\n    err := xml.Unmarshal([]byte(data), &amp;response)\n    if err != nil {\n        panic(err.Error())\n    }\n    fmt.Printf(\"%+v\\n\", response)\n\n    var rawMessage RawMessage\n    err = xml.Unmarshal([]byte(response.ResponseBody.Result.RawMessage), &amp;rawMessage)\n    if err != nil {\n        panic(err.Error())\n    }\n    fmt.Printf(\"%+v\\n\", rawMessage)\n\n}\n</code></pre>\n\n<p>Output:<br>\n<code>{ResponseBody:{Result:{RawMessage:Send OK.&lt;ReturnIDs&gt;c71cf425f5;e5e4dbb5ca&lt;/ReturnIDs&gt;}}}\n{IDs:}\n</code>\nI also tried to Unesacpe the response, then tried to unmarshal it, it partially works, but there are 3 main problems with this approach:</p>\n\n<ol>\n<li>It's too slow</li>\n<li>I could only either <a href=\"https://play.golang.org/p/rG7_3uSnTA\" rel=\"nofollow noreferrer\">get the ReturnIDs</a> or <a href=\"https://play.golang.org/p/t2b2xfF704\" rel=\"nofollow noreferrer\">the message</a>, not both.</li>\n<li>I believe it's just an ugly hack and there must be a better way to do that (That I'm not aware of, yet.)</li>\n</ol>\n\n<p>So, How can I extract both values for the message (Send OK.) and the <code>&lt;ReturnIDs&gt;</code>?</p>\n"}, {"tags": ["go", "project"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1513156600, "post_id": 47788850, "comment_id": 82539698, "body": "<code>Can we have issues in the future with this structure?</code> Of course you can. As with literally every other structure. There&#39;s no such thing as a &quot;perfect structure.&quot; Every design decision, in every domain, has pros and cons. There is no &quot;one right answer.&quot; If there were, nobody would ever ask this question, because the answer would be obvious."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1513156800, "post_id": 47788850, "comment_id": 82539816, "body": "@Flimzy - Ok...and for utils where I should put it ? is it OK under the src folder ?"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1513156982, "post_id": 47788850, "comment_id": 82539939, "body": "<a href=\"https://medium.com/@benbjohnson/standard-package-layout-7cdbc8391fc1\" rel=\"nofollow noreferrer\">This</a> is a good reference."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1513156997, "post_id": 47788850, "comment_id": 82539952, "body": "There is no right answer.  Possible answers range from &quot;You should never have &#39;utils&#39;&quot; to anywhere you like."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1513157090, "post_id": 47788850, "comment_id": 82540004, "body": "@Flimzy - You are rellay helping here :("}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1513157174, "post_id": 47788850, "comment_id": 82540076, "body": "Your question is off-topic here. You won&#39;t likely get help here."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1513157408, "post_id": 47788850, "comment_id": 82540209, "body": "@Flimzy - Ok so if I&#39;ve question like this where should I put it? this can help..."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1513158809, "post_id": 47788850, "comment_id": 82541073, "body": "Opinion-based questions like this don&#39;t belong on stack overflow at all. Maybe on the go-nuts mailing list."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1513159191, "post_id": 47788850, "comment_id": 82541325, "body": "Split the whole into packages on sensible package boundaries so that inter-package cohesion is high. It does not matter how you lay out these packages in the filesystem."}, {"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1513160654, "post_id": 47788850, "comment_id": 82542280, "body": "@Volker - Thank you very much , what does it mean <code>Split the whole into packages on sensible package boundaries</code> can you please provide it as answer with example, and i&#39;ll close the question. thanks again."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1513167602, "post_id": 47788850, "comment_id": 82546620, "body": "No I cannot. This is much to broad. What logically belongs together goes into one package. This might be a lot of code or not much. Take a look at some OSS projects."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1513239730, "post_id": 47788850, "comment_id": 82578639, "body": "Following the directory structure in the link has some advantages. Those directories have some tooling semantics. For example if a package from <code>internal&#47;...</code> be imported in another <i>project</i>, compiler will show an error. And that&#39;s the structure that is used in many standard Go packages and by the community. Yet you can have customized structure beside that one, too."}], "answers": [{"comments": [{"owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 0, "creation_date": 1513165971, "post_id": 47791065, "comment_id": 82545666, "body": "Thanks, 1. if I&#39;ve utils/helpers for projectA where I should put it ? 2. my project path is like following is it fine ?  (mac) <code>&#47;Users&#47;i122345&#47;go&#47;src&#47;myapp&#47;cmd&#47;main.go</code> does it fit your proposed structure ?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "edited": false, "score": 1, "creation_date": 1513166219, "post_id": 47791065, "comment_id": 82545807, "body": "1. assuming only projectA uses it, <code>&#47;Users&#47;i122345&#47;go&#47;src&#47;myapp&#47;utils&#47;helpers.go</code> 2. with a cmd at <code>&#47;Users&#47;i122345&#47;go&#47;src&#47;myapp&#47;cmd&#47;main</code> the produced binary, after go install, located in GOPATH/bin, will be named <code>main</code>, because it is the folder name. to clarify the code of the binary would be at <code>&#47;Users&#47;i122345&#47;go&#47;src&#47;myapp&#47;cmd&#47;main&#47;main.go</code>"}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 10, "last_activity_date": 1513161804, "creation_date": 1513161804, "answer_id": 47791065, "question_id": 47788850, "link": "https://stackoverflow.com/questions/47788850/go-project-structure-best-practice/47791065#47791065", "title": "Go project structure - Best practice", "body": "<p>based on <a href=\"https://github.com/anacrolix/torrent\" rel=\"noreferrer\">https://github.com/anacrolix/torrent</a></p>\n\n<pre><code>GOPATH\n  |-src\n    |-projectA\n      |-cmd (of projectA)\n        |-cmdA\n          |-main.go\n        |-cmdB\n          |-main.go\n      |-vendor\n      |-pkg lib\n      |-pkg libB\n    |-projectB\n    ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1513163322, "post_id": 47791461, "comment_id": 82544057, "body": "just to avoid confusion both structure proposed are valid and works. It all depends on what you feel is the best for your project. Personally, i started with nisal structure, later i switched to the historical layout with sub cmd folder."}, {"owner": {"reputation": 5283, "user_id": 6336221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Rh8CEJ_IGpA/AAAAAAAAAAI/AAAAAAAAALc/VV4nk6Yyqhg/photo.jpg?sz=128", "display_name": "Nisal Edu", "link": "https://stackoverflow.com/users/6336221/nisal-edu"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1513163405, "post_id": 47791461, "comment_id": 82544112, "body": "@mh-cbon thanks for the comment"}], "tags": [], "owner": {"reputation": 5283, "user_id": 6336221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Rh8CEJ_IGpA/AAAAAAAAAAI/AAAAAAAAALc/VV4nk6Yyqhg/photo.jpg?sz=128", "display_name": "Nisal Edu", "link": "https://stackoverflow.com/users/6336221/nisal-edu"}, "is_accepted": false, "score": 3, "last_activity_date": 1513162999, "creation_date": 1513162999, "answer_id": 47791461, "question_id": 47788850, "link": "https://stackoverflow.com/questions/47788850/go-project-structure-best-practice/47791461#47791461", "title": "Go project structure - Best practice", "body": "<p>Following is go project structure I have used for go projects </p>\n\n<pre><code>my-project\n     |-&gt; api\n     |-&gt; api_test\n     |-&gt; controllers\n     |-&gt; controllers_test\n     |-&gt; models\n     |-&gt; routes\n     |-&gt; server\n     |-&gt; vendor\n     |main.go\n     |Readme.txt    \n</code></pre>\n\n<p>Find more about go project structure</p>\n\n<p><a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html</a></p>\n"}], "owner": {"reputation": 2317, "user_id": 3012133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/40901b470f6e02cb5426bccd3f594308?s=128&d=identicon&r=PG&f=1", "display_name": "07_05_GuyT", "link": "https://stackoverflow.com/users/3012133/07-05-guyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10741, "favorite_count": 3, "closed_date": 1513171410, "accepted_answer_id": 47791065, "answer_count": 2, "score": 6, "last_activity_date": 1516111497, "creation_date": 1513154899, "last_edit_date": 1516111497, "question_id": 47788850, "link": "https://stackoverflow.com/questions/47788850/go-project-structure-best-practice", "closed_reason": "Opinion-based", "title": "Go project structure - Best practice", "body": "<p>I need to create GO project (first time) for production, I searched on web for best practices and found the following</p>\n\n<p><a href=\"https://github.com/golang-standards/project-layout\" rel=\"nofollow noreferrer\">https://github.com/golang-standards/project-layout</a></p>\n\n<p>For this I've two main questions.</p>\n\n<ol>\n<li><p>I see that most of go projects logic is inside the main function, but in case I need some utils folder with files there, where should I put it ?\nI don't want that the main function will be mass of 500 or more lines of code  </p></li>\n<li><p>In our company the projects should be build like following</p>\n\n<pre><code>myproj\n  |-src\n    |-cmd\n    |  |-main.go\n    |-utils\n    |-vendor\n</code></pre></li>\n</ol>\n\n<p>Our company project build as above structure i.e. the project files is under the <code>src</code> folder, is it right? (can we have issue in the future with this structure type).</p>\n\n<p>I was able to compile this project in our landscape but since everything is under <code>src</code> I'm not sure.</p>\n"}, {"tags": ["go", "cql"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1513162549, "post_id": 47788632, "comment_id": 82543520, "body": "need code to help"}], "answers": [{"tags": [], "owner": {"reputation": 439, "user_id": 3141354, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/swvWQ.jpg?s=128&g=1", "display_name": "kenlz", "link": "https://stackoverflow.com/users/3141354/kenlz"}, "is_accepted": true, "score": 0, "last_activity_date": 1513163932, "creation_date": 1513163932, "answer_id": 47791748, "question_id": 47788632, "link": "https://stackoverflow.com/questions/47788632/multiple-in-clause-gocql-not-executing/47791748#47791748", "title": "multiple in clause gocql not executing", "body": "<p>id := []int{10,20,30}</p>\n\n<p>userData := []int{1,2,3,4}</p>\n\n<p>It has nothing to do with the gocql itself. turns out the way I convert the arrays into comma separated values turned the list into string which is invalid because </p>\n\n<p>id is now \"10,20,30\" and userData is now \"1,2,3,4\" and it's sent to the query like this </p>\n\n<pre><code>DELETE            \nFROM \n    honda.car_v1 \nWHERE \n    (id in '10,20,30')\n    AND\n    (user_id in '1,2,3,4')\n</code></pre>\n\n<p>where i needed them to be like</p>\n\n<pre><code>DELETE            \nFROM \n    honda.car_v1 \nWHERE \n    (id in 10,20,30)\n    AND\n    (user_id in 1,2,3,4)\n</code></pre>\n\n<p>so i just do a simple string formatting to solve the problem.</p>\n"}], "owner": {"reputation": 439, "user_id": 3141354, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/swvWQ.jpg?s=128&g=1", "display_name": "kenlz", "link": "https://stackoverflow.com/users/3141354/kenlz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 47791748, "answer_count": 1, "score": 0, "last_activity_date": 1513163932, "creation_date": 1513154056, "question_id": 47788632, "link": "https://stackoverflow.com/questions/47788632/multiple-in-clause-gocql-not-executing", "title": "multiple in clause gocql not executing", "body": "<p>Problem with running a query from gocql but it runs okay from the console.</p>\n\n<pre><code>  DELETE            \n    FROM \n        honda.car_v1 \n    WHERE \n        (id in ?)\n        AND\n        (user_id in ?)\n</code></pre>\n\n<p>I tried running this in cql console, it runs perfectly but when i run it via <a href=\"https://github.com/gocql/gocql\" rel=\"nofollow noreferrer\">https://github.com/gocql/gocql</a> it does not give any error, yet the rows are still there. I wonder what did i do wrong.</p>\n"}, {"tags": ["oop", "go", "struct", "embedding", "composite-literals"], "answers": [{"comments": [{"owner": {"reputation": 556, "user_id": 4782509, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0PLn2.jpg?s=128&g=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4782509/frank-wang"}, "edited": false, "score": 0, "creation_date": 1513226936, "post_id": 47787886, "comment_id": 82573479, "body": "Thanks for your answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1513151875, "last_edit_date": 1513151875, "creation_date": 1513151082, "answer_id": 47787886, "question_id": 47787512, "link": "https://stackoverflow.com/questions/47787512/embed-an-type-of-other-pkg-into-mine-and-init-it-by-literal/47787886#47787886", "title": "Embed an type of other pkg into mine, and init it by literal", "body": "<p>When you refer to embedded fields, you have to leave out the package name of the embedded type, as the unqualified type name acts as the field name.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">Spec: Struct types:</a></p>\n\n<blockquote>\n  <p>A field declared with a type but no explicit field name is an <em>anonymous field</em>, also called an <em>embedded</em> field or an embedding of the type in the struct. An embedded type must be specified as a type name <code>T</code> or as a pointer to a non-interface type name <code>*T</code>, and <code>T</code> itself may not be a pointer type. <strong>The unqualified type name acts as the field name.</strong></p>\n</blockquote>\n\n<p>So simply write:</p>\n\n<pre><code>var x_01_h1_p = &amp;dala02{\n    Md5_v:            \"\",\n    DefaultSshHelper: feature.DefaultSshHelper{\n    // blabla\n    },\n}\n</code></pre>\n\n<p>Your other attempt <code>type FDH feature.DefaultSshHelper</code> falls short as this type declaration creates a new type with zero methods: the type <code>FDH</code> does not \"inherit\" the methods of <code>feature.DefaultSshHelper</code>. And thus any type that embeds <code>FDH</code> will also lack methods of <code>feature.DefaultSshHelper</code>.</p>\n"}], "owner": {"reputation": 556, "user_id": 4782509, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0PLn2.jpg?s=128&g=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4782509/frank-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 47787886, "answer_count": 1, "score": 1, "last_activity_date": 1513151875, "creation_date": 1513149481, "last_edit_date": 1513151772, "question_id": 47787512, "link": "https://stackoverflow.com/questions/47787512/embed-an-type-of-other-pkg-into-mine-and-init-it-by-literal", "title": "Embed an type of other pkg into mine, and init it by literal", "body": "<p>I read how to init <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/FS_H0SiEioA\" rel=\"nofollow noreferrer\">embed type</a>, and a related <a href=\"https://stackoverflow.com/questions/45897371/how-to-embed-other-packages-struct-in-golang\">Q&amp;A</a>.</p>\n\n<p>What my problem is when compile this code, I got :</p>\n\n<p>[Error] unknown field 'feature.DefaultSshHelper' in struct literal of type dala02</p>\n\n<pre><code>type FDH feature.DefaultSshHelper                                                                                                                                                                            \n\ntype dala02 struct {                                                                                                                                                                                         \n    Md5_v string                                                                                                                                                                                             \n    feature.DefaultSshHelper                                                                                                                                                                                 \n     //FDH                                                                                                                                                                                                    \n}                                                                                                                                                                                                            \n\nvar x_01_h1_p = &amp;dala02{                                                                                                                                                                                     \n    Md5_v: \"\",                                                                                                                                                                                               \n    feature.DefaultSshHelper: feature.DefaultSshHelper{                                                                                                                                                      \n        //FDH: FDH{  \n            // blabla\n    },\n}\n// use it by a interface []feature.CmdFioHelper{x_00_h1_p}        \n</code></pre>\n\n<p>At first time, I thought it was an Exported problem, so I added this line 'type FDH feature.DefaultSshHelper'. Now, we have this error :</p>\n\n<p>[Error] cannot use x_01_h1_p (type *dala02) as type feature.CmdFioHelper in array or slice literal:\n        *dala02 does not implement feature.CmdFioHelper (missing Getnextchecker method)</p>\n\n<p>But a pointer of feature.DefaultSshHelper does implement feature.CmdFioHelper ( a interface ). So pointer of dala02 should also implement that, right? (reference form effective go)</p>\n\n<blockquote>\n  <p>There's an important way in which embedding differs from subclassing. When we embed a type, the methods of that type become methods of the outer type, but when they are invoked the receiver of the method is the inner type, not the outer one.</p>\n</blockquote>\n\n<p>Question is how to fix this compile error, which line is wrong? I'm not a expert for golang, thanks for your advice :). BTW I do find some workaround.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1513152092, "post_id": 47787333, "comment_id": 82537193, "body": "Please consider not posting links to screenshots! While they contain text, this text is not indexed by the Internet search engines. The Windows console supports copying and pasting: with default settings, the right mouse button can be used to enter selection mode, and when you&#39;re done with selecting, hit the Enter key to copy the selected text to the clipboard. You can then paste it to your question (and then format it as code)."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1513162900, "post_id": 47787333, "comment_id": 82543760, "body": "need more info to help properly"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1513151974, "creation_date": 1513151974, "answer_id": 47788120, "question_id": 47787333, "link": "https://stackoverflow.com/questions/47787333/go-run-hello-go-cannot-find-the-hello-go-file/47788120#47788120", "title": "`go run hello.go` cannot find the &quot;hello.go&quot; file", "body": "<p>As you can see from the output of running the <code>dir</code> command\nearlier up in your shell session, there is indeed no file named \"hello.go\"\nin the <code>C:\\GOCODE\\testproject</code> directory.</p>\n\n<p>When you execute the</p>\n\n<pre><code>go run hello.go\n</code></pre>\n\n<p>command, the <code>go</code> tool tries to find the file named \"hello.go\" in the current\ndirectory (because the name of that file is relative, so it's being\nsearched in current working directory).  There's no such file,\nand that's what <code>go run</code> tells you.</p>\n\n<hr>\n\n<p>Unfortunately, from the outlook of your shell session, it appears there\nare more problems with your setup.\nAnd there are problems with your approach to Go.</p>\n\n<p>First, while it looks like you're following\n<a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">this guide</a> (and this is the right thing\nto do, actually), you misread it.</p>\n\n<p>What it tried to tell you is that you should create the \"src\"\ndirectory (and then the \"hello\" directory to contain your test project)\nin the so-called <em>workspace,</em> and a list of workspaces known to Go\nis stored in the <code>GOPATH</code> environment variable.</p>\n\n<p>As you can see from the <code>go env</code> output, Go thinks you have a single\nworkspace located in <code>C:\\Users\\Sitaram\\Go</code>.</p>\n\n<p>Now it worth reiterating that\u2014contrary to many (if not most) \"mainstream\"\nlanguages,\u2014Go is not \"project-based\"; instead, it requires all your code\nto be organized in those workspaces, and it wants to know where these\nworkspaces are.\nBy default\u2014if you did not explicitly set the <code>GOPATH</code> environment\nvariable,\u2014it assumes your single workspace is located in the directory\nnamed \"go\" placed in your \"home folder\".\nAnd that's what you see in the <code>go env</code> output.</p>\n\n<p>Now you have two options:</p>\n\n<ul>\n<li><p>Set the <code>GOPATH</code> env. variable for your user to <code>C:\\GOCODE</code>\nthen start another shell\u2014so that it \"sees\" that variable and allows\nthe <code>go</code> tool to also see it and use).\nRun <code>go env</code> to verify <code>GOPATH</code> contains <code>C:\\GOCODE</code>.</p>\n\n<p>Then follow the rest of the tutorial document:</p>\n\n<ol>\n<li>Make sure there is the \"src\" folder directly under the <code>C:\\GOCODE</code>.</li>\n<li>Create your project folder directory under \"src\".\nLet's say, it will be named \"hello\".</li>\n<li>Under \"hello\", create that \"hello.go\" file.</li>\n<li>Now <code>cd C:\\GOCODE\\src\\hello</code> and then <code>go build</code> \u2014 you will have\nthe <code>hello.exe</code> created there.</li>\n</ol></li>\n<li><p>Don't mess with <code>GOPATH</code> and just repeat the steps 2-4 from above\nin the default workspace\u2014<code>C:\\Users\\Sitaram\\go</code>.</p></li>\n</ul>\n\n<p>I'd go with the second variant because that inexplicable affection\nof certain Windows users for polluting the <code>C:\\</code> with random <em>personal</em>\ndata is really an anti-pattern; have your personal belongings in your home\nfolder! Windows has gone a long way getting that right; and almost all\nWindows software is finally there\u2014understanding that paradigm. So why deviate?</p>\n\n<p>Second, please <em>unlearn</em> <code>go run</code>.\nI'm not sure the Go developers actually regret implementing it,\nbut people do really misinterpret what this tool is for.\nIt's for one-off throw-away \"scripts\".\nReal development is done using <code>go install</code> and, sometimes, <code>go build</code>.</p>\n\n<p>In most cases your normal development routine you use <code>go install</code>\nexclusively \u2014 as it caches the results of compilation of all the packages\nyour project depends on. <code>go build</code> does not do this, and <code>go run</code> does\nnot even preserve the result of the compilation of your project itself.\nPlease read <a href=\"https://dave.cheney.net/2014/06/04/what-does-go-build-build\" rel=\"nofollow noreferrer\">this</a> quick reference card for more info.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10236121, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g_h3VE8B64o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPVOu8dDspsbWZjyw3TzYUW28IsKA/mo/photo.jpg?sz=128", "display_name": "Rogier", "link": "https://stackoverflow.com/users/10236121/rogier"}, "is_accepted": false, "score": 0, "last_activity_date": 1534446560, "creation_date": 1534446560, "answer_id": 51883905, "question_id": 47787333, "link": "https://stackoverflow.com/questions/47787333/go-run-hello-go-cannot-find-the-hello-go-file/51883905#51883905", "title": "`go run hello.go` cannot find the &quot;hello.go&quot; file", "body": "<p>After go get gpackage check if there is a yourproject.exe in your bin directory to compile your github package with your project.\nIf not, you have to do cd src/yourproject and type go install and hit enter.</p>\n"}], "owner": {"reputation": 11, "user_id": 9092460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2Y9GzGdgIws/AAAAAAAAAAI/AAAAAAAAABs/rUwPr72nmA0/photo.jpg?sz=128", "display_name": "seetharam ramaneni", "link": "https://stackoverflow.com/users/9092460/seetharam-ramaneni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4926, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1534446560, "creation_date": 1513148773, "last_edit_date": 1513150764, "question_id": 47787333, "link": "https://stackoverflow.com/questions/47787333/go-run-hello-go-cannot-find-the-hello-go-file", "title": "`go run hello.go` cannot find the &quot;hello.go&quot; file", "body": "<p>I tried to run the program in command prompt #Go lang- But when i type run \"go run hello.go\" command i am gettin</p>\n\n<blockquote>\n  <p>CreateFile hello.go:The system cannot find the file specified</p>\n</blockquote>\n\n<p>Please help to to compile and run the above marked program, Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1513146967, "post_id": 47786562, "comment_id": 82534900, "body": "Duplicate. Also: It is okay to have packages with &quot;test-only code&quot; which is imported during testing. Go is not Java."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1513162833, "post_id": 47786562, "comment_id": 82543717, "body": "try <code>go test sub*&#47;*.go</code>. IMHO im little worried by your package composition, afraid you meet soon a recursive import error, or alike."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513181888, "post_id": 47786562, "comment_id": 82556137, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31794141/can-i-create-shared-test-utilities-in-go\">Can I create shared test utilities in go?</a>"}], "owner": {"reputation": 101, "user_id": 5706801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3ec979780ac95d319e0eec3ff10d49?s=128&d=identicon&r=PG&f=1", "display_name": "Ookami", "link": "https://stackoverflow.com/users/5706801/ookami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513145111, "creation_date": 1513145111, "question_id": 47786562, "link": "https://stackoverflow.com/questions/47786562/go-structures-defined-from-common-package-in-test", "title": "Go structures defined from common package in test", "body": "<p>This is a packaging question in Go. I have a package schema that looks like this:\n<code>\nproject\n|\n--- common_test.go\n|\n--- sub1\n|     |\n|     --- file.go\n|     --- file_test.go\n--- sub2\n|     |\n|     |\n|     --- file.go\n|     --- file_test.go\n</code></p>\n\n<p><code>common_test.go</code> would look like that:</p>\n\n<pre><code>package project\ntype Test struct {\n     ...\n}\n</code></pre>\n\n<p>And <code>sub1</code> and <code>sub2</code> would look like:</p>\n\n<pre><code>package sub1\nimport \"project\"\nfunc SomeTest(t *testing.T) {\n     test := project.Test{}\n     ...\n}\n</code></pre>\n\n<p>The project package only contains the <code>common_test.go</code> file, which defines structures that are used in both <code>sub1/file_test.go</code> and <code>sub2/file_test.go</code>. But if I try to trigger the test, I get the following error:<code>no buildable Go source files in project</code>.</p>\n\n<p>I understand that it is because <code>common_test.go</code> includes the <code>_test</code> suffix and because it is the only file in the <code>project</code> package. But I use the suffix for the reason I don't want this file to be compiled except for test execution.</p>\n\n<p>Is there a way to define test-specific common structures in a package that does not contain non-test files? What is the good practice in this case?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1513139715, "post_id": 47785529, "comment_id": 82532365, "body": "every key for each url I&#39;ve passed in needs to similarly prepended with &quot;s&quot;"}, {"owner": {"reputation": 3296, "user_id": 3086289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhG15.png?s=128&g=1", "display_name": "Sangam Belose", "link": "https://stackoverflow.com/users/3086289/sangam-belose"}, "edited": false, "score": 0, "creation_date": 1513141126, "post_id": 47785529, "comment_id": 82532720, "body": "I tried you example..it also generates the same key. I dont see any problem here. Why do you want to prepend &quot;s&quot; to it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 3296, "user_id": 3086289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhG15.png?s=128&g=1", "display_name": "Sangam Belose", "link": "https://stackoverflow.com/users/3086289/sangam-belose"}, "edited": false, "score": 0, "creation_date": 1513142154, "post_id": 47785529, "comment_id": 82533005, "body": "The example url given is &quot;<a href=\"http://localhost:8080/500,sXyMwWKIC5JPCtlYOQ2f4yMBTqpjtUsfI67Sp7huXIYY=/https://octodex.github.com/images/codercat.jpg&quot;...notice\" rel=\"nofollow noreferrer\">localhost:8080/&hellip;</a> the &quot;s&quot; they prepend to it. My key doesn&#39;t have the &quot;s&quot;"}, {"owner": {"reputation": 3296, "user_id": 3086289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhG15.png?s=128&g=1", "display_name": "Sangam Belose", "link": "https://stackoverflow.com/users/3086289/sangam-belose"}, "edited": false, "score": 0, "creation_date": 1513144468, "post_id": 47785529, "comment_id": 82533836, "body": "I think they might have some format to prepend &#39;s&#39; to the actual key."}, {"owner": {"reputation": 3296, "user_id": 3086289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhG15.png?s=128&g=1", "display_name": "Sangam Belose", "link": "https://stackoverflow.com/users/3086289/sangam-belose"}, "edited": false, "score": 0, "creation_date": 1513144504, "post_id": 47785529, "comment_id": 82533851, "body": "Just found on there docs page please check <a href=\"https://godoc.org/willnorris.com/go/imageproxy#hdr-Signature\" rel=\"nofollow noreferrer\">godoc.org/willnorris.com/go/imageproxy#hdr-Signature</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3296, "user_id": 3086289, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VhG15.png?s=128&g=1", "display_name": "Sangam Belose", "link": "https://stackoverflow.com/users/3086289/sangam-belose"}, "is_accepted": true, "score": 1, "last_activity_date": 1513144821, "creation_date": 1513144821, "answer_id": 47786503, "question_id": 47785529, "link": "https://stackoverflow.com/questions/47785529/why-is-my-hmac-key-off/47786503#47786503", "title": "Why is my hmac key off?", "body": "<p>As per the docs of the given library, the key format is as below:</p>\n\n<pre><code>s{signature}\n</code></pre>\n\n<p>Please check the docs at <a href=\"https://godoc.org/willnorris.com/go/imageproxy#hdr-Signature\" rel=\"nofollow noreferrer\">Url signing signature</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 47786503, "answer_count": 1, "score": 0, "last_activity_date": 1513144821, "creation_date": 1513139616, "last_edit_date": 1513142286, "question_id": 47785529, "link": "https://stackoverflow.com/questions/47785529/why-is-my-hmac-key-off", "title": "Why is my hmac key off?", "body": "<p>I am trying to generate an hmac key for use in an image proxy. I have:</p>\n\n<p><a href=\"https://play.golang.org/p/fec_N2Nim4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/fec_N2Nim4</a></p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/hmac\"\n    \"crypto/sha256\"\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n    mac := hmac.New(sha256.New, []byte(\"secret key\"))\n        mac.Write([]byte(\"https://octodex.github.com/images/codercat.jpg\"))\n        want := mac.Sum(nil)\n        fmt.Println(\"result: \",base64.URLEncoding.EncodeToString(want)) // expect \"sXyMwWKIC5JPCtlYOQ2f4yMBTqpjtUsfI67Sp7huXIYY=\"\n}\n</code></pre>\n\n<p>This is based off <a href=\"https://github.com/willnorris/imageproxy#signed-requests\" rel=\"nofollow noreferrer\">the package's</a> recommended formula for generating the key as well as other methods I have tried, which all result in the same key. The url given in the example, however, has an \"s\" prepended to the front:</p>\n\n<p><a href=\"http://localhost:8080/500,sXyMwWKIC5JPCtlYOQ2f4yMBTqpjtUsfI67Sp7huXIYY=/https://octodex.github.com/images/codercat.jpg\" rel=\"nofollow noreferrer\">http://localhost:8080/500,sXyMwWKIC5JPCtlYOQ2f4yMBTqpjtUsfI67Sp7huXIYY=/https://octodex.github.com/images/codercat.jpg</a></p>\n\n<p>vs what I am getting: </p>\n\n<pre><code>http://localhost:8080/500,XyMwWKIC5JPCtlYOQ2f4yMBTqpjtUsfI67Sp7huXIYY=/https://octodex.github.com/images/codercat.jpg\n</code></pre>\n"}, {"tags": ["go", "tcp", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": false, "score": 1, "last_activity_date": 1513128006, "creation_date": 1513128006, "answer_id": 47784123, "question_id": 47783976, "link": "https://stackoverflow.com/questions/47783976/tcp-server-listening-in-the-background-without-blocking-other-operations/47784123#47784123", "title": "TCP Server listening in the background without blocking other operations", "body": "<p>Your last example should do what you want, the issue is that the main thread ends before you can do anything. There's 2 solutions start <code>doOtherThins()</code> on another goroutine and then call <code>startListener()</code> which blocks but the other goroutine is already running:</p>\n\n<pre><code>func main() {\n  go doOtherThins()\n  startListener()\n}\n</code></pre>\n\n<p>Or use <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">waitGroups</a> to wait until the code ends before exiting.</p>\n"}, {"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1513160776, "post_id": 47784240, "comment_id": 82542361, "body": "i d rather block on the listen op, instead of adding a new chan. whatever you do next, you ll need to sleep a bit before invoking the client. you should have something like Listen, check err || wait a bit, start new routine to consume client."}], "tags": [], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "is_accepted": false, "score": 0, "last_activity_date": 1513129401, "last_edit_date": 1513129401, "creation_date": 1513128974, "answer_id": 47784240, "question_id": 47783976, "link": "https://stackoverflow.com/questions/47783976/tcp-server-listening-in-the-background-without-blocking-other-operations/47784240#47784240", "title": "TCP Server listening in the background without blocking other operations", "body": "<p>Here is a cleaner way of achieving this using channels.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"fmt\"\n)\n\nfunc main() {\n    // Create a channel to synchronize goroutines\n    finish := make(chan bool)\n\n    server8001 := http.NewServeMux()\n    server8001.HandleFunc(\"/foo\", foo8001)\n    server8001.HandleFunc(\"/bar\", bar8001)\n\n    go func() {\n        http.ListenAndServe(\":8001\", server8001)\n    }()\n\n    go func() {\n        //do other things in a separate routine\n        fmt.Println(\"doing some work\")\n        // you can also start a new server on a different port here\n    }()\n\n    // do other things in the main routine\n\n    &lt;-finish //wait for all the routines to finish\n}\n\nfunc foo8001(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Listening on 8001: foo \"))\n}\n\nfunc bar8001(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Listening on 8001: bar \"))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1513161234, "creation_date": 1513161234, "answer_id": 47790862, "question_id": 47783976, "link": "https://stackoverflow.com/questions/47783976/tcp-server-listening-in-the-background-without-blocking-other-operations/47790862#47790862", "title": "TCP Server listening in the background without blocking other operations", "body": "<p>adding another variation of  Anuruddha  answer</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    server8001 := http.NewServeMux()\n    server8001.HandleFunc(\"/foo\", foo8001)\n    server8001.HandleFunc(\"/bar\", bar8001)\n\n    unblock(func() error {\n        return http.ListenAndServe(\":8001\", server8001)\n    })//forgot err check, must be done!\n\n    res, err := http.Get(\"http://0.0.0.0:8001/foo\")\n    if err != nil {\n        panic(err)\n    }\n    defer res.Body.Close()\n    io.Copy(os.Stdout, res.Body)\n    os.Exit(0)\n}\n\nfunc unblock(h func() error) error {\n    w := make(chan error)\n    go func() {\n        w &lt;- h()\n    }()\n    select {\n    case err := &lt;-w:\n        return err\n    case &lt;-time.After(time.Millisecond * 50):\n        return nil\n    }\n}\n\nfunc foo8001(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Listening on 8001: foo \"))\n}\n\nfunc bar8001(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Listening on 8001: bar \"))\n}\n</code></pre>\n"}], "owner": {"reputation": 2264, "user_id": 1964489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dced6d8951b4771cde68c08e372bbede?s=128&d=identicon&r=PG", "display_name": "Ziva", "link": "https://stackoverflow.com/users/1964489/ziva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1513161234, "creation_date": 1513126727, "last_edit_date": 1513160432, "question_id": 47783976, "link": "https://stackoverflow.com/questions/47783976/tcp-server-listening-in-the-background-without-blocking-other-operations", "title": "TCP Server listening in the background without blocking other operations", "body": "<p>I'm writing a TCP Server and Client in Go, just as a working example to get familiar with this language. I want to write a server, let's call it MyServer, which does the following - it has a backend TCP Server, which listens for incoming messages, but it also has a Client which allows him to send other messages, independently on the received once. However, I don't know how to tell MyServer to listen \"in the background\", without blocking the main thread. Here is the code for my TCPServer:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net\"\n  \"os\"\n)\n\nfunc main() {\n  startListener()\n  doOtherThins()\n}\n\nfunc startListener() {\n  listener, err := net.Listen(\"tcp\", \"localhost:9998\")\n  if err != nil {\n      fmt.Println(\"Error listening:\", err.Error())\n      os.Exit(1)\n  }\n  defer listener.Close()\n  fmt.Println(\"Listening on \" + \"localhost:9998\")\n  for {\n      // Listen for an incoming connection.\n      conn, err := listener.Accept()\n      if err != nil {\n          fmt.Println(\"Error during accepting: \", err.Error())\n          os.Exit(1)\n      }\n      go handleConnection(conn)\n  }\n}\n\nfunc handleConnection(conn net.Conn) {\n  buf := make([]byte, 1024)\n\n  _, err := conn.Read(buf)\n  if err != nil {\n    fmt.Println(\"Error reading:\", err.Error())\n  }\n\n  conn.Write([]byte(\"Message correctly received.\"))\n  conn.Close()\n}\n</code></pre>\n\n<p>Function <code>startListener()</code> blocks the main function, so the function <code>doOtherThins()</code> (which I want to independently send packets to other servers) is never triggered as long as the server is listening. I tried to change the main function and use the goroutine:</p>\n\n<pre><code>func main() {\n  go startListener()\n  doOtherThins()\n}\n</code></pre>\n\n<p>But then the server is not listening for the incoming packets (it just triggers <code>doOtherThins()</code> and ends <code>main()</code>). \nIs it possible to spin the listener in the background, to allow the main thread do also other operations?</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1513130352, "post_id": 47783838, "comment_id": 82530207, "body": "Are you asking how to perform the same operation on different slice types as implied by the body of the question, or are you asking what the title says?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1513148243, "post_id": 47783838, "comment_id": 82535428, "body": "If you are new to Go the best advice would be to not fight the language and to <i>not</i> write such a function, but e.g. two or three."}], "answers": [{"tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": false, "score": 1, "last_activity_date": 1513127491, "last_edit_date": 1513127491, "creation_date": 1513125907, "answer_id": 47783880, "question_id": 47783838, "link": "https://stackoverflow.com/questions/47783838/create-function-which-performers-different-operations-depending-on-the-input-sli/47783880#47783880", "title": "Create function which performers different operations depending on the input slice argument", "body": "<p>Just use <code>interface{}</code> not <code>[]interface{}</code>. An empty interface can store any type, including slices.</p>\n\n<p>Your code would look something like this (although I didn't test):</p>\n\n<pre><code>func GetRandomSequence(S interface{}, l int) interface{} {\n   returnSlice := []interface{}\n   switch v := s.(type) {\n   // inside the switch v has the value of S converted to the type\n   case []person:\n      // v is a slice of persons here\n   case []animal:\n      // v is a slice of animals here\n   case []int:\n      // v is a slice of ints here\n   case default:\n       // v is of type interface{} because i didn't match any type on the switch\n       // I recommend you return nil on error instead of a string\n       // or always return 2 things, the value and an error like \n       // the standard library\n       return \"Not Recognized\" \n   }\n   rerurn returnSlice\n}\n</code></pre>\n\n<p>I recommend you do the complete <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">Tour of go</a>, but for this question the answer is <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Depending on what you want to do exactly, it looks like you might not need different types of slices but a slice of <code>interface{}</code>. If in your function to extract random elements from the slice you don't care about the type of the elements just do:</p>\n\n<pre><code>func GetRandomSequence(S []interface{}, l int) []interface{} {\n    returnSlice := make([]interface{}, 0, l)\n    for i:=0; i&lt;l; i++ { \n        // S[i] here is always of type interface{}\n        returnSlice = append(returnSlice, S[getRnd()]) // you need to implement getRnd() or just \"math/rand\" or something.\n    }\n    return returnSlice \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1513181919, "last_edit_date": 1513181919, "creation_date": 1513129392, "answer_id": 47784297, "question_id": 47783838, "link": "https://stackoverflow.com/questions/47783838/create-function-which-performers-different-operations-depending-on-the-input-sli/47784297#47784297", "title": "Create function which performers different operations depending on the input slice argument", "body": "<p>Write a sample function that works with slice indices.   </p>\n\n<pre><code>// Sample k random elements from set of n elements.\n// The function set sets an element in the output given \n// an index in the output and the index in the input.  \nfunc sample(k int, n int, assign func(out int, in int)) {\n    for i := 0; i &lt; k; i++ {\n        set(i, i)\n    }\n    for i := k; i &lt; n; i++ {\n        j := rand.Intn(i + 1)\n        if j &lt; k {\n            set(j, i)\n        }\n    }\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>in := []person{ {\"John\", 10}, {\"Sally\", 11}, {\"James\", 9}, {\"Eve\", 8} }\nout := make([]person, 2)\nsample(len(out), len(in), func(i, j int) { out[i] = in[j] })\n</code></pre>\n\n<p>Because <code>sample</code> works with length and index values only, it can be used on a slice of any type.</p>\n\n<p>This approach is similar to <a href=\"https://godoc.org/sort#Search\" rel=\"nofollow noreferrer\">sort.Search</a> in the standard library.</p>\n"}], "owner": {"reputation": 2264, "user_id": 1964489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dced6d8951b4771cde68c08e372bbede?s=128&d=identicon&r=PG", "display_name": "Ziva", "link": "https://stackoverflow.com/users/1964489/ziva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1513181919, "creation_date": 1513125607, "last_edit_date": 1513160487, "question_id": 47783838, "link": "https://stackoverflow.com/questions/47783838/create-function-which-performers-different-operations-depending-on-the-input-sli", "title": "Create function which performers different operations depending on the input slice argument", "body": "<p>I just started to learn Go language and I want to build a function which will be selecting a random subsequence from a slice. However, I don't know what type of values this slice can store, these can be integers, strings or elements of some struct. For example, let's assume I have to structures: </p>\n\n<pre><code>type person struct {\n    name string\n    age  int\n}\n\ntype animal struct {\n    name  string\n    age   int\n    breed string\n}\n</code></pre>\n\n<p>Now, I want to build function getRandomSequence as follows: given as arguments a slice S and a length l the function returns a slice which contains l randomly selected elements from slice S. The problem which I encountered was - how to make this function work for any possible slice. I tried to do the following:</p>\n\n<pre><code>func GetRandomSequence(S interface{}, l int) []interface{} {\n   switch S.(type) {\n   case person:\n      // Do random selection of l elements from S and return them\n   case animal:\n      // Do random selection of l elements from S and return them\n   case int:\n     // Do random selection of l elements from S and return them\n   }\n   return \" Not Recognised\"\n}\n</code></pre>\n\n<p>Can someone suggest how I can write such function? I manage to make similar (i.e., general) functions work if S would be a single element of any type (so instead of <code>[]interface{}</code> would be just <code>interface{}</code>) but I cannot find out how to solve this problem.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513124698, "post_id": 47783676, "comment_id": 82528772, "body": "How did you install 1.9.2? Did you <code>rm -rf &#47;usr&#47;local&#47;go</code> first, or did you overwrite the previous install? And how did you install it? (official tarball, package)? Code to reproduce it would be great too."}, {"owner": {"reputation": 450, "user_id": 613614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a15e5615b47a2ec1c2b944493d6b751?s=128&d=identicon&r=PG", "display_name": "Steven Fines", "link": "https://stackoverflow.com/users/613614/steven-fines"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513125575, "post_id": 47783676, "comment_id": 82529017, "body": "It was installed a clean VM, so no prior install; installed following the go instructions..."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 1, "creation_date": 1513126112, "post_id": 47783676, "comment_id": 82529153, "body": "Could you try the very same VM but with a newly extracted tarball in a completely different directory? (eg: <code>&#47;home&#47;sfines&#47;go</code> and set <code>GOROOT</code> to that). Keep the install you have though."}, {"owner": {"reputation": 450, "user_id": 613614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a15e5615b47a2ec1c2b944493d6b751?s=128&d=identicon&r=PG", "display_name": "Steven Fines", "link": "https://stackoverflow.com/users/613614/steven-fines"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513126423, "post_id": 47783676, "comment_id": 82529225, "body": "That&#39;s got it, don&#39;t know why it got hosed but thanks."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513126495, "post_id": 47783676, "comment_id": 82529242, "body": "Could you diff the two installs? My guess is the original extract got killed. You may want to check the install process and have it surface errors properly."}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 0, "last_activity_date": 1513126569, "creation_date": 1513126569, "answer_id": 47783956, "question_id": 47783676, "link": "https://stackoverflow.com/questions/47783676/external-linking-crypto-rc4-a-fails/47783956#47783956", "title": "External linking crypto/rc4.a fails", "body": "<p>This is a badly-extracted Go install with missing or partial files. A fresh install (with no errors) fixes the issue.</p>\n"}], "owner": {"reputation": 450, "user_id": 613614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a15e5615b47a2ec1c2b944493d6b751?s=128&d=identicon&r=PG", "display_name": "Steven Fines", "link": "https://stackoverflow.com/users/613614/steven-fines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 47783956, "answer_count": 1, "score": -1, "last_activity_date": 1513126569, "creation_date": 1513124357, "question_id": 47783676, "link": "https://stackoverflow.com/questions/47783676/external-linking-crypto-rc4-a-fails", "title": "External linking crypto/rc4.a fails", "body": "<p>I'm having issues compiling code that deep somewhere in itself it tries to link to go's crypto/rc4 but returns with the following linking error: </p>\n\n<pre><code>truncated object file: /usr/local/go/pkg/linux_amd64/crypto/rc4.a: EOF\ncrypto/rc4.NewCipher: call to external function\ncrypto/rc4.init: call to external function\ncrypto/tls.cipherRC4: relocation target crypto/rc4.NewCipher not defined\ncrypto/tls.cipherRC4: relocation target type.*crypto/rc4.Cipher not defined\ncrypto/tls.init: relocation target crypto/rc4.init not defined\ncrypto/tls.cipherRC4: undefined: \"crypto/rc4.NewCipher\"\ncrypto/tls.cipherRC4: undefined: \"type.*crypto/rc4.Cipher\"\ncrypto/tls.init: undefined: \"crypto/rc4.init\"\n</code></pre>\n\n<p>The following are my go variables: </p>\n\n<pre><code>GOPATH=/home/sfines/workspace/audit_system\nGOROOT=/usr/local/go\n</code></pre>\n\n<p>My Go version is : \n<code>go version go1.9.2 linux/amd64</code></p>\n\n<p>I've made sure that there is only one version of Go installed. I'm at my wits end.</p>\n"}, {"tags": ["go", "casting", "integer"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1513120331, "post_id": 47782921, "comment_id": 82527528, "body": "You should generally <i>not</i> use unsigned integers only to ensure positive values, and reserve them for bitwise manipulation, masks, flags, etc., so there really is no safely lost by using ints. Otherwise, there is no &quot;casting&quot; in go, this is a type conversion."}, {"owner": {"reputation": 1453, "user_id": 1697349, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/w8L7g.jpg?s=128&g=1", "display_name": "joeButler", "link": "https://stackoverflow.com/users/1697349/joebutler"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513120575, "post_id": 47782921, "comment_id": 82527596, "body": "Thanks that makes sense, also see its a conversion"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1513160456, "post_id": 47782921, "comment_id": 82542137, "body": "Note that there is no such thing as typecasting in Go. Only type conversion."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1513132303, "post_id": 47784608, "comment_id": 82530653, "body": "Making up the benchmarks when benchmarking is a part of the standard library :-S"}, {"owner": {"reputation": 259, "user_id": 461475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc32085b553071a3c7d98c83b994bad?s=128&d=identicon&r=PG", "display_name": "dagonza", "link": "https://stackoverflow.com/users/461475/dagonza"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1513132406, "post_id": 47784608, "comment_id": 82530684, "body": "Yeah... I wanted to make it very clear to everyone who is not familiar with it. The code from above is self-contained and goes straight to the point."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513134556, "post_id": 47784608, "comment_id": 82531194, "body": "Did you look at the generated code? Conversion between int and uint shouldn\u2019t cost anything"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513145613, "post_id": 47784608, "comment_id": 82534325, "body": "@JimB literally nothing or a single instruction?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1513171803, "post_id": 47784608, "comment_id": 82549371, "body": "@zerkms: they literally execute the same instructions. The data is the same, so the type is only relevant to the compiler."}], "tags": [], "owner": {"reputation": 259, "user_id": 461475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc32085b553071a3c7d98c83b994bad?s=128&d=identicon&r=PG", "display_name": "dagonza", "link": "https://stackoverflow.com/users/461475/dagonza"}, "is_accepted": false, "score": 0, "last_activity_date": 1513132189, "creation_date": 1513132189, "answer_id": 47784608, "question_id": 47782921, "link": "https://stackoverflow.com/questions/47782921/golang-cost-for-casting-between-int-and-uint/47784608#47784608", "title": "Golang cost for casting between int and uint", "body": "<p>This code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    start := time.Now()\n    var test uint = 3\n    var tmp int\n    for i := 0; i &lt; 1000000000; i++ {\n        tmp = int(test)\n    }\n    // Required by the compiler\n    fmt.Print(tmp)\n    end := time.Now()\n    fmt.Print(\"Time elapsed: \", end.Sub(start))\n}\n</code></pre>\n\n<p>Shows how inexpensive it is. Millions of conversions done in less than 3 msecs (my computer is a fairly powerful iMac but you get the point) which is probably mostly going into the iteration cycle rather than the cast.</p>\n\n<p>However, I would encourage you to use ints and play with your logic to ensure the values are correct (e.g. input validation which needs to be done for security reasons anyway).</p>\n\n<p>In C/C++ the type casting was automagic so you did not need to worry to cast between int and uint even though it was happening. In golang, you need to make it explicit but you are in the exact same situation but adding syntax problems.</p>\n"}], "owner": {"reputation": 1453, "user_id": 1697349, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/w8L7g.jpg?s=128&g=1", "display_name": "joeButler", "link": "https://stackoverflow.com/users/1697349/joebutler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2456, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1513132189, "creation_date": 1513119395, "question_id": 47782921, "link": "https://stackoverflow.com/questions/47782921/golang-cost-for-casting-between-int-and-uint", "title": "Golang cost for casting between int and uint", "body": "<p>I'm porting some old C++ code to go which used unsigned integers fairly often. I can understand their use in the C++ to help ensure positive values were only used in certain places. </p>\n\n<p>However I believe there was also some implicit type conversion going on so in the go version I've ended up with code which looks like</p>\n\n<pre><code>Node{IsTerminal: true, TerminalNo: uint(RandPostiveIntUpTo(int(fitnessCases.Terminals)))})\n</code></pre>\n\n<p>Which seems a little unnecessary. I'm curious, is there much of a (time) cost to this casting, and am I losing any significant safety by switching to use int everywhere?</p>\n"}, {"tags": ["json", "go", "struct", "unmarshalling"], "comments": [{"owner": {"reputation": 4019, "user_id": 1810941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f698e04508a487b6f843b9eeeabd968?s=128&d=identicon&r=PG", "display_name": "Mike Beeler", "link": "https://stackoverflow.com/users/1810941/mike-beeler"}, "edited": false, "score": 1, "creation_date": 1513104039, "post_id": 47779354, "comment_id": 82520012, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14713736/gson-parse-json-with-array-with-different-object-types\">Gson Parse Json with array with different object types</a>"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513104042, "post_id": 47779354, "comment_id": 82520015, "body": "<code>TransactionType</code> is still a string. I&#39;m guessing it&#39;s used to tell you which fields in the <code>transaction</code> struct are important. This means that there should be an authoritative list of all possible fields, with the inclusion or not of fields based on the type of transaction. What have you tried, and why didn&#39;t it work?"}, {"owner": {"reputation": 58, "user_id": 4080162, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/283c8cfec95b09b2fc6128e34b65c255?s=128&d=identicon&r=PG&f=1", "display_name": "martijn9612", "link": "https://stackoverflow.com/users/4080162/martijn9612"}, "edited": false, "score": 0, "creation_date": 1513104481, "post_id": 47779354, "comment_id": 82520235, "body": "Correct. The problem is that I can&#39;t seem to figure out (or I just don&#39;t know) what the most efficient way of unmarshalling such a structure is. I can indeed figure out how to unmarshall the transaction field with a contains on the <code>RawMessage</code> for instance, but then where would I place this result? Should the &quot;parent&quot; struct have a field for each type of transaction? Or should I have a field with the type <code>interface{}</code> and a string that indicates the type of the transaction on the &quot;parent&quot; struct?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1513104867, "post_id": 47779354, "comment_id": 82520438, "body": "An interface contains a type and a value.  If you use a field with interface type, then you may not need the string type in the &quot;parent&quot; struct. The application can type switch or type assert to detect type.  The interface can contain common methods for all transaction types."}], "answers": [{"tags": [], "owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "is_accepted": false, "score": 0, "last_activity_date": 1513106416, "creation_date": 1513106416, "answer_id": 47780035, "question_id": 47779354, "link": "https://stackoverflow.com/questions/47779354/unmarshalling-stream-of-changing-types-into-structs/47780035#47780035", "title": "Unmarshalling stream of changing types into structs", "body": "<p>Perhaps keep your <code>transaction</code> as <code>map[string]interface{}</code></p>\n\n<p>Example <a href=\"https://play.golang.com/p/j_u_ztw04M\" rel=\"nofollow noreferrer\">https://play.golang.com/p/j_u_ztw04M</a></p>\n\n\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Stream []struct {\n    Status string `json:\"status\"`\n    Type   string `json:\"type\"`\n\n    // map instead of struct\n    Transaction map[string]interface{} `json:\"transaction\"`\n\n    Validated bool `json:\"validated\"`\n}\n\nfunc main() {\n\n    stream := Stream{}\n\n    err := json.Unmarshal(rawj, &amp;stream)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n        return\n    }\n\n    for i, s := range stream {\n        fmt.Println(\"thing:\", i)\n        for k, v := range s.Transaction {\n\n            // do manual stuff here, perhaps long switch on k and/or\n            // as suggested by Cerise Lim\u00f3n type switch on v\n            fmt.Printf(\"key: %s, val: %v, val type: %T\\n\", k, v, v)\n\n        }\n        fmt.Println()\n    }\n\n}\n\nvar rawj = []byte(`[{\n  \"status\": \"closed\",\n  \"type\": \"transaction\",\n  \"transaction\": {\n    \"TransactionType\": \"TypeA\",\n    \"Account\": \"Some string\",\n    \"Fee\": \"14\",\n    \"date\": 45325680\n  },\n  \"validated\": true\n},\n\n{\n  \"status\": \"closed\",\n  \"type\": \"transaction\",\n  \"transaction\": {\n    \"TransactionType\" : \"TypeB\",\n    \"Account\" : \"Some string\",\n    \"Fee\": \"42\",\n    \"Destination\" : \"Some string\"\n  },\n  \"validated\": true\n}]`)\n</code></pre>\n\n<p>Have fun!</p>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1513112068, "last_edit_date": 1513112068, "creation_date": 1513111374, "answer_id": 47781208, "question_id": 47779354, "link": "https://stackoverflow.com/questions/47779354/unmarshalling-stream-of-changing-types-into-structs/47781208#47781208", "title": "Unmarshalling stream of changing types into structs", "body": "<p>For the \"transaction\" struct I would make the common keys direct types (e.g. <code>string</code>, <code>int</code>, etc.) and the optional keys <em>pointers</em> to their types (<code>*string</code>, <code>*int</code>, etc.), with the \"omitempty\" tag so they are set to nil if they aren't present in an occurrence:</p>\n\n<pre><code>type Transaction struct {\n  // Common fields are direct types...\n  TransactionType string\n  Account         string\n  Fee             string\n\n  // Optional fields are pointers with \"omitempty\"...\n  Date        *int    `json:\",omitempty\"`\n  Destination *string `json:\",omitempty\"`\n}\n</code></pre>\n\n<p>This way the common fields are always there but possibly the default (empty) values and optional fields are populated if present but nil if omitted:</p>\n\n<pre><code>ts[0].Date = (*int) 45325680\nts[0].Destination = nil\nts[1].Date = nil\nts[1].Destination = (*string) \"Some string\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1885, "user_id": 639133, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4781a491e1923d56755de71fbec9d5d4?s=128&d=identicon&r=PG", "display_name": "mozey", "link": "https://stackoverflow.com/users/639133/mozey"}, "is_accepted": false, "score": 0, "last_activity_date": 1513181379, "last_edit_date": 1513181379, "creation_date": 1513152199, "answer_id": 47788164, "question_id": 47779354, "link": "https://stackoverflow.com/questions/47779354/unmarshalling-stream-of-changing-types-into-structs/47788164#47788164", "title": "Unmarshalling stream of changing types into structs", "body": "<p>Define structs for each transaction type and do the un-marshall in two steps. First use</p>\n\n<pre><code>type Stream []struct {\n    ...\n    TransactionRaw json.RawMessage `json:\"transaction\"`\n    ...\n}\n</code></pre>\n\n<p>Then use <code>Regexp.FindStringSubmatch</code> on <code>TransactionRaw</code> to determine the type for the second call to <code>json.Unmarshal</code> with </p>\n\n<pre><code>type Transaction struct {\n    TransactionType string `json:\"TransactionType\"`\n    Account         string `json:\"Account\"`\n    Fee             string `json:\"Fee\"`\n}\n\ntype TypeA struct {\n    Transaction\n    Date int    `json:\"date\"`\n}\n</code></pre>\n\n<p>etc...</p>\n\n<p><a href=\"https://play.golang.org/p/uPTb0wT4Xm\" rel=\"nofollow noreferrer\">Playground example here</a></p>\n"}, {"tags": [], "owner": {"reputation": 319, "user_id": 8652703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce90a6950f92d17211799b8bb7eabea?s=128&d=identicon&r=PG&f=1", "display_name": "Terry Pang", "link": "https://stackoverflow.com/users/8652703/terry-pang"}, "is_accepted": false, "score": 0, "last_activity_date": 1513211273, "creation_date": 1513211273, "answer_id": 47804167, "question_id": 47779354, "link": "https://stackoverflow.com/questions/47779354/unmarshalling-stream-of-changing-types-into-structs/47804167#47804167", "title": "Unmarshalling stream of changing types into structs", "body": "<p>I think using reflect is one way  <code>[]map[string]interface{}</code></p>\n\n<p>And in <a href=\"https://stackoverflow.com/questions/47747663/golang-invalid-operation-type-interface-does-not-support-indexing/47748858#47748858\">this answer</a> I had gave an example about using reflect to decode changing type.</p>\n"}], "owner": {"reputation": 58, "user_id": 4080162, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/283c8cfec95b09b2fc6128e34b65c255?s=128&d=identicon&r=PG&f=1", "display_name": "martijn9612", "link": "https://stackoverflow.com/users/4080162/martijn9612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1513211273, "creation_date": 1513103731, "question_id": 47779354, "link": "https://stackoverflow.com/questions/47779354/unmarshalling-stream-of-changing-types-into-structs", "title": "Unmarshalling stream of changing types into structs", "body": "<p>I'm currently dealing with a stream of json objects coming in to my application, and am having some difficulties figuring out what the best way of parsing them is. The stream consists of objects that have a defined type. The problem is that one of the fields in the object is of changing type. It looks like this:</p>\n\n<pre><code>[{\n  \"status\": \"closed\",\n  \"type\": \"transaction\",\n  \"transaction\": {\n    \"TransactionType\": \"TypeA\",\n    \"Account\": \"Some string\",\n    \"Fee\": \"14\",\n    \"date\": 45325680\n  },\n  \"validated\": true\n},\n\n{\n  \"status\": \"closed\",\n  \"type\": \"transaction\",\n  \"transaction\": {\n    \"TransactionType\" : \"TypeB\",\n    \"Account\" : \"Some string\",\n    \"Fee\": \"42\",\n    \"Destination\" : \"Some string\"\n  },\n  \"validated\": true\n}]\n</code></pre>\n\n<p>You can see that the \"parent\" does not change, but the \"transaction\" does. I removed a lot of fields from the \"transaction\" field to make it easier to explain, but this is a type with 10-ish common fields and 10-ish changing fields that are dependent on the type. There are also 10 transaction types, this makes it pretty annoying to put everything into one struct and have a ton of optional fields. I was also thinking about one struct for every transaction type, but this does not work because then there is no way of specifying which type the field should have in the parent.</p>\n\n<p>How would I parse these objects effectively? Unfortunately, I can't change the structure of the elements coming out of the stream. What would be the best way to solve this?</p>\n"}, {"tags": ["go", "concurrency", "goroutine", "file-writing"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1513100830, "post_id": 47778481, "comment_id": 82518309, "body": "Just because the calls can happen in parallel, doesn&#39;t mean that writing a single file to disk isn&#39;t an inherently serial operation."}, {"owner": {"reputation": 33, "user_id": 2349132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67cf54a4245d25f91dcc6a0c9f0b542?s=128&d=identicon&r=PG", "display_name": "kdnooij", "link": "https://stackoverflow.com/users/2349132/kdnooij"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1513100989, "post_id": 47778481, "comment_id": 82518394, "body": "Still, isn&#39;t it weird that writing to different offsets in a file takes much longer?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1513101181, "post_id": 47778481, "comment_id": 82518498, "body": "No. The io system is optimized for the common use case, which is serial writes. You&#39;ve also added the overhead of scheduling <code>100000</code> goroutines, and their contention on the file descriptor&#39;s lock."}, {"owner": {"reputation": 33, "user_id": 2349132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67cf54a4245d25f91dcc6a0c9f0b542?s=128&d=identicon&r=PG", "display_name": "kdnooij", "link": "https://stackoverflow.com/users/2349132/kdnooij"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513101468, "post_id": 47778481, "comment_id": 82518660, "body": "I read about <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365203(v=vs.85).aspx\" rel=\"nofollow noreferrer\">FileLockEx</a> which looks to me like a way of locking only a particular range of bytes in a file. Is there a way of doing something equivalent in go? Or would this not speed up the process of writing at all?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1513101894, "post_id": 47778481, "comment_id": 82518874, "body": "<code>FileLockEx </code> is something entirely different. The fastest way to write a file is serially, with as few syscalls as possible. For random sparse writes across the file, <code>mmap</code> is usually how it&#39;s done in posix, but you implied that you&#39;re using windows so I&#39;m not sure what the equivalent is."}, {"owner": {"reputation": 33, "user_id": 2349132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67cf54a4245d25f91dcc6a0c9f0b542?s=128&d=identicon&r=PG", "display_name": "kdnooij", "link": "https://stackoverflow.com/users/2349132/kdnooij"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513103643, "post_id": 47778481, "comment_id": 82519810, "body": "I&#39;ll take a look. Thanks!"}], "owner": {"reputation": 33, "user_id": 2349132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67cf54a4245d25f91dcc6a0c9f0b542?s=128&d=identicon&r=PG", "display_name": "kdnooij", "link": "https://stackoverflow.com/users/2349132/kdnooij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513100403, "creation_date": 1513100403, "question_id": 47778481, "link": "https://stackoverflow.com/questions/47778481/why-dont-goroutines-write-in-parallel-using-writeat", "title": "Why don&#39;t goroutines write in parallel using WriteAt?", "body": "<p>I'm experimenting a bit with reading and writing from a file.\nTo write to a file concurrently I created the following function:</p>\n\n<pre><code>func write(f *os.File, b []byte, off int64, c chan int) {\n    var _, err = f.WriteAt(b, off)\n    check(err)\n    c &lt;- 0\n}\n</code></pre>\n\n<p>I then create a file and 100000 goroutines to perform the write operations.\nThey each write an array of <code>16384</code> bytes to the hard disk:</p>\n\n<pre><code>func main() {\n    path := \"E:/test\"\n    f, err := os.OpenFile(path, os.O_RDWR|os.O_CREATE, 0666)\n    check(err)\n\n    size := int64(16384)\n    ones := make([]byte, size)\n\n    n := int64(100000)\n    c := make(chan int, n)\n\n    for i := int64(0); i &lt; size; i++ {\n        ones[i] = 1\n    }\n\n    // Start timing\n    start := time.Now()\n\n    for i := int64(0); i &lt; n; i++ {\n        go write(f, ones, size*i, c)\n    }\n\n    for i := int64(0); i &lt; n; i++ {\n        &lt;-c\n    }\n\n    // Check elapsed time\n    fmt.Println(time.Now().Sub(start))\n\n    err = f.Sync()\n    check(err)\n    err = f.Close()\n\n    check(err)\n}\n</code></pre>\n\n<p>In this case about 1.6 GB is written where each goroutine writes to a non-overlapping byte range. The documentation for the <code>io</code> package states that <a href=\"https://golang.org/pkg/io/#WriterAt\" rel=\"nofollow noreferrer\">Clients of WriteAt can execute parallel WriteAt calls on the same destination if the ranges do not overlap. </a>\nSo what I expect to see, is that when I use <code>go write(f, ones, 0, c)</code>, it would take much longer since all write operations would be on the same byterange.</p>\n\n<p>However after testing this my results are quite unexpected:</p>\n\n<p>Using <code>go write(f, ones, size*i, c)</code> took an average of about <code>3s</code></p>\n\n<p>But using <code>go write(f, ones, 0, c)</code> only took an average of about <code>480ms</code></p>\n\n<p>Do I use the WriteAt function in the wrong way? How could i achieve concurrent writing to non-overlapping byteranges?</p>\n"}, {"tags": ["algorithm", "go", "combinations"], "comments": [{"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1513100557, "post_id": 47778453, "comment_id": 82518164, "body": "I would think changing <code>if n == 1</code> to <code>if len(arr) == 2</code> would do the trick."}, {"owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1513100880, "post_id": 47778453, "comment_id": 82518340, "body": "That doesn&#39;t really make sense."}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1513101078, "post_id": 47778453, "comment_id": 82518445, "body": "Have you tried it?"}, {"owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1513101432, "post_id": 47778453, "comment_id": 82518642, "body": "It doesn&#39;t make sense because I need a specific length and changing <code>if n == 1</code> to  <code>if len(arr) == 2</code>  doesn&#39;t seem to help. I edited the question with an expected output to make it more clear."}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1513101809, "post_id": 47778453, "comment_id": 82518834, "body": "That&#39;s exactly what this change does.  It changes the terminating condition for recursion from &quot;we have fully enumerated the input array&quot; to &quot;we have three elements in the current output array.&quot; You would also likely need to change <code>tmp := make([]string, len(arr))</code> to <code>tmp := make([]string, 3)</code> and adjust the <code>copy()</code> invocation as well, unless Go is smart enough to use the smaller of the array dimensions."}, {"owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1513102017, "post_id": 47778453, "comment_id": 82518941, "body": "<code>arr</code> has more than 2 elements so changing if len(arr) == 2 results in no result returned if a slice like <code>list</code> provided in the example is used . Not sure what you mean."}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1513102197, "post_id": 47778453, "comment_id": 82519021, "body": "I see, I misunderstood how the algorithm works. It&#39;s unlikely that this algorithm is going to work in this case. A simpler O(n^2) recursive algorithm would do the trick, though I don&#39;t know if it would perform well enough for your use case."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1513103354, "post_id": 47778453, "comment_id": 82519659, "body": "The word is &quot;permute,&quot; not &quot;premute.&quot; Please edit your question accordingly."}, {"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 2, "creation_date": 1513103702, "post_id": 47778453, "comment_id": 82519833, "body": "If order of items is not important, then you want to generate <code>combinations</code> - look for this term, there is a lot of effective methods."}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1513106048, "post_id": 47778453, "comment_id": 82521045, "body": "for generating combinations you can check <a href=\"https://stackoverflow.com/questions/127704/algorithm-to-return-all-combinations-of-k-elements-from-n\">this</a> answer."}, {"owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "reply_to_user": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 0, "creation_date": 1513106806, "post_id": 47778453, "comment_id": 82521416, "body": "@MBo the order is not important but I could not find an anaswer."}, {"owner": {"reputation": 2551, "user_id": 4739247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OwOaK.jpg?s=128&g=1", "display_name": "assefamaru", "link": "https://stackoverflow.com/users/4739247/assefamaru"}, "edited": false, "score": 0, "creation_date": 1513269955, "post_id": 47778453, "comment_id": 82598445, "body": "You can change your wolfram link to use <code>combinations</code> instead: <a href=\"https://www.wolframalpha.com/input/?i=Combinations%5B%7Ba,+b,+c,+d%7D,+%7B3%7D%5D\" rel=\"nofollow noreferrer\">Combinations&#91;{a, b, c, d}, {3}&#93;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "edited": false, "score": 0, "creation_date": 1513110299, "post_id": 47780749, "comment_id": 82523218, "body": "it seems to work with integers...I guess I just need to modify it to work with strings. Can you document <code>m, n</code> params?"}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "reply_to_user": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "edited": false, "score": 0, "creation_date": 1513110601, "post_id": 47780749, "comment_id": 82523382, "body": "@mike you can use its boolean output and create your string list. for example, if <code>b[0]</code> is true you include <code>&quot;alice&quot;</code>. m is 7 and n are 3 in your given example."}], "tags": [], "owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "is_accepted": false, "score": 1, "last_activity_date": 1513109376, "creation_date": 1513109376, "answer_id": 47780749, "question_id": 47778453, "link": "https://stackoverflow.com/questions/47778453/generate-combinations-permutation-of-specific-length/47780749#47780749", "title": "generate combinations/permutation of specific length", "body": "<p>I implement twiddle algorithm for generating combination in Go. Here is my implementation:</p>\n\n<pre><code>package twiddle\n\n// Twiddle type contains all information twiddle algorithm\n// need between each iteration.\ntype Twiddle struct {\n    p   []int\n    b   []bool\n    end bool\n}\n\n// New creates new twiddle algorithm instance\nfunc New(m int, n int) *Twiddle {\n    p := make([]int, n+2)\n    b := make([]bool, n)\n\n    // initiate p\n    p[0] = n + 1\n\n    var i int\n\n    for i = 1; i != n-m+1; i++ {\n        p[i] = 0\n    }\n    for i != n+1 {\n        p[i] = i + m - n\n        i++\n    }\n\n    p[n+1] = -2\n\n    if m == 0 {\n        p[1] = 1\n    }\n\n    // initiate b\n    for i = 0; i != n-m; i++ {\n        b[i] = false\n    }\n    for i != n {\n        b[i] = true\n        i++\n    }\n\n    return &amp;Twiddle{\n        p: p,\n        b: b,\n    }\n}\n\n// Next creates next combination and return it.\n// it returns nil on end of combinations\nfunc (t *Twiddle) Next() []bool {\n    if t.end {\n        return nil\n    }\n\n    r := make([]bool, len(t.b))\n    for i := 0; i &lt; len(t.b); i++ {\n        r[i] = t.b[i]\n    }\n\n    x, y, end := t.twiddle()\n    t.b[x] = true\n    t.b[y] = false\n    t.end = end\n\n    return r\n}\n\nfunc (t *Twiddle) twiddle() (int, int, bool) {\n    var i, j, k int\n    var x, y int\n\n    j = 1\n    for t.p[j] &lt;= 0 {\n        j++\n    }\n\n    if t.p[j-1] == 0 {\n        for i = j - 1; i != 1; i-- {\n            t.p[i] = -1\n        }\n        t.p[j] = 0\n        x = 0\n        t.p[1] = 1\n        y = j - 1\n    } else {\n        if j &gt; 1 {\n            t.p[j-1] = 0\n        }\n        j++\n        for t.p[j] &gt; 0 {\n            j++\n        }\n        k = j - 1\n        i = j\n        for t.p[i] == 0 {\n            t.p[i] = -1\n            i++\n        }\n        if t.p[i] == -1 {\n            t.p[i] = t.p[k]\n            x = i - 1\n            y = k - 1\n            t.p[k] = -1\n        } else {\n            if i == t.p[0] {\n                return x, y, true\n            }\n\n            t.p[j] = t.p[i]\n            t.p[i] = 0\n            x = j - 1\n            y = i - 1\n        }\n    }\n    return x, y, false\n\n}\n</code></pre>\n\n<p>you can use my tweedle package as follow:</p>\n\n<pre><code>tw := tweedle.New(1, 2)\n\nfor b := tw.Next(); b != nil; b = tw.Next() {\n    fmt.Println(b)\n}\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 7623709, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3b869731c724b20a6dd447a3f87121e6?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/7623709/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513109376, "creation_date": 1513100290, "last_edit_date": 1513109254, "question_id": 47778453, "link": "https://stackoverflow.com/questions/47778453/generate-combinations-permutation-of-specific-length", "title": "generate combinations/permutation of specific length", "body": "<p>The project is more complex but the blocking issue is: How to generate a sequence of words of specific length from a list?</p>\n\n<p>I've found how to generate all the possible combinations(see below) but the issue is that I need only the combinations  of specific length. </p>\n\n<p>Wolfram working example (it uses permutations though, I need only combinations(order doesn't matter)) :</p>\n\n<p><a href=\"https://www.wolframalpha.com/input/?i=Permutations%5B%7Ba,%20b,%20c,%20d%7D,%20%7B3%7D%5D&amp;rawformassumption=%7B%22C%22,%20%22Permutations%22%7D%20-%3E%20%7B%22Function%22%7D\" rel=\"nofollow noreferrer\">Permutations[{a, b, c, d}, {3}]</a></p>\n\n<p>Example(pseudo go):</p>\n\n<pre><code>  list := []string{\"alice\", \"moon\", \"walks\", \"mars\", \"sings\", \"guitar\", \"bravo\"}\n  var premutationOf3\n  premutationOf3 = premuate(list, 3)\n  // this should return a list of all premutations such \n  // [][]string{[]string{\"alice\", \"walks\", \"moon\"}, []string{\"alice\", \"signs\", \"guitar\"} ....}\n</code></pre>\n\n<p>Current code to premutate all the possible sequences (no length limit)</p>\n\n<pre><code>    for _, perm := range permutations(list) {\n        fmt.Printf(\"%q\\n\", perm)\n    }\n\nfunc permutations(arr []string) [][]string {\n    var helper func([]string, int)\n    res := [][]string{}\n\n    helper = func(arr []string, n int) {\n        if n == 1 {\n            tmp := make([]string, len(arr))\n            copy(tmp, arr)\n            res = append(res, tmp)\n        } else {\n            for i := 0; i &lt; n; i++ {\n                helper(arr, n-1)\n                if n%2 == 1 {\n                    tmp := arr[i]\n                    arr[i] = arr[n-1]\n                    arr[n-1] = tmp\n                } else {\n                    tmp := arr[0]\n                    arr[0] = arr[n-1]\n                    arr[n-1] = tmp\n                }\n            }\n        }\n    }\n    helper(arr, len(arr))\n    return res\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1513095668, "post_id": 47777098, "comment_id": 82515293, "body": "Everything looks good in the code shown.  Show the code that parses the JSON.  Show the random numbers and how you displayed them."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1513098584, "post_id": 47777098, "comment_id": 82517104, "body": "Half of your code can be replaced by <code>resp, err := http.Get(url)</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1513103985, "post_id": 47777098, "comment_id": 82519970, "body": "You have&#39;t shown how you decode the data, or what you mean by &quot;random numbers&quot;. Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1591, "user_id": 7304216, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7948f2563d2a2d276561b3a05c357150?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Pocock", "link": "https://stackoverflow.com/users/7304216/nick-pocock"}, "edited": false, "score": 0, "creation_date": 1513202581, "post_id": 47791746, "comment_id": 82566951, "body": "Thank you so much! Exactly what I was after."}, {"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "reply_to_user": {"reputation": 1591, "user_id": 7304216, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7948f2563d2a2d276561b3a05c357150?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Pocock", "link": "https://stackoverflow.com/users/7304216/nick-pocock"}, "edited": false, "score": 0, "creation_date": 1513203109, "post_id": 47791746, "comment_id": 82567151, "body": "@NickPocock glad I could help you out :] <b>Happy gophering!</b>"}], "tags": [], "owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "is_accepted": true, "score": 1, "last_activity_date": 1513203123, "last_edit_date": 1513203123, "creation_date": 1513163922, "answer_id": 47791746, "question_id": 47777098, "link": "https://stackoverflow.com/questions/47777098/how-to-parse-json-generated-by-cryptocompare-api/47791746#47791746", "title": "How to parse JSON generated by cryptocompare API?", "body": "<p>Im not sure if I understood your question correctly but here's how I would parse the response given by the API:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"encoding/json\"\n    \"log\"\n    \"io/ioutil\"\n)\n\ntype Data struct {\n    Id        string\n    CoinName  string\n    Algorithm string\n    // You can add more properties if you need them\n}\n\ntype Response struct {\n    Response         string\n    Message          string\n    BaseImageUrl     string\n    BaseLinkUrl      string\n    DefaultWatchlist map[string]string\n    // If you're interested in the Data only all of the above properties can be excluded\n    Data             map[string]Data\n}\n\nfunc main() {\n    url := \"https://min-api.cryptocompare.com/data/all/coinlist\"\n    resp := Response{}\n\n    // Getting the data using http\n    r, err := http.Get(url)\n    if err != nil {\n        log.Fatal(err.Error())\n    }\n\n    // Reading the response body using ioutil\n    body, err := ioutil.ReadAll(r.Body)\n    if err != nil {\n        log.Fatal(err.Error())\n    }\n    defer r.Body.Close()\n\n    if r.StatusCode == http.StatusOK {\n        // Unmarshaling the json bytes into Response struct\n        json.Unmarshal(body, &amp;resp)\n\n        fmt.Println(resp.Data) // Printing parsed struct\n    }\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><em>\"I then try to decode the body of the response and it comes back with loads of random numbers.\"</em></p>\n</blockquote>\n\n<p>These <em>random numbers</em> is the response body as a slice of bytes <code>[]byte</code> given by the <code>ioutil.ReadAll()</code> method, which is perfect for <strong>Unmarshaling</strong>.</p>\n"}], "owner": {"reputation": 1591, "user_id": 7304216, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7948f2563d2a2d276561b3a05c357150?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Pocock", "link": "https://stackoverflow.com/users/7304216/nick-pocock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 1, "closed_date": 1515016279, "accepted_answer_id": 47791746, "answer_count": 1, "score": -2, "last_activity_date": 1513203123, "creation_date": 1513095538, "last_edit_date": 1513098264, "question_id": 47777098, "link": "https://stackoverflow.com/questions/47777098/how-to-parse-json-generated-by-cryptocompare-api", "closed_reason": "Not suitable for this site", "title": "How to parse JSON generated by cryptocompare API?", "body": "<p>I am attempting to parse some JSON using this API endpoint.</p>\n\n<p><a href=\"https://www.cryptocompare.com/api/data/coinlist/\" rel=\"nofollow noreferrer\">https://www.cryptocompare.com/api/data/coinlist/</a></p>\n\n<p>I can see it's making the request fine, I then try to decode the body of the response and it comes back with loads of random numbers.</p>\n\n<p>If I copy the body value from my debugger I get the below.</p>\n\n<blockquote>\n  <p>&lt;[]uint8> (length: 643401, cap: 1048064)</p>\n</blockquote>\n\n<p>Here is my code.</p>\n\n<pre><code>url := fmt.Sprintf(\"https://www.cryptocompare.com/api/data/coinlist/\")\n\n    fmt.Println(\"Requesting data from \" + url)\n\n    req, err := http.NewRequest(\"GET\", url, nil)\n\n    if err != nil {\n        log.Fatal(\"NewRequest: \", err)\n        return\n    }\n\n    client := &amp;http.Client{}\n\n    resp, err := client.Do(req)\n\n    if err != nil {\n        log.Fatal(\"Do: \", err)\n        return\n    }\n\n    body, readErr := ioutil.ReadAll(resp.Body)\n</code></pre>\n\n<p>I want to be able to grab everything inside the Data key from the JSON and then map that to a struct. Can anyone see what I am doing wrong?</p>\n\n<p>Below is an example of what I see in my browser when I hit the endpoint.</p>\n\n<pre><code> {\n\"Response\": \"Success\",\n\"Message\": \"Coin list succesfully returned! This api is moving to https://min-api.cryptocompare.com/data/all/coinlist, please change the path.\",\n\"BaseImageUrl\": \"https://www.cryptocompare.com\",\n\"BaseLinkUrl\": \"https://www.cryptocompare.com\",\n\"DefaultWatchlist\": {\n\"CoinIs\": \"1182,7605,5038,24854,3807,3808,202330,5324,5031,20131\",\n\"Sponsored\": \"\"\n},\n\"Data\": {\n\"42\": {\n\"Id\": \"4321\",\n\"Url\": \"/coins/42/overview\",\n\"ImageUrl\": \"/media/12318415/42.png\",\n\"Name\": \"42\",\n\"Symbol\": \"42\",\n\"CoinName\": \"42 Coin\",\n\"FullName\": \"42 Coin (42)\",\n\"Algorithm\": \"Scrypt\",\n\"ProofType\": \"PoW/PoS\",\n\"FullyPremined\": \"0\",\n\"TotalCoinSupply\": \"42\",\n\"PreMinedValue\": \"N/A\",\n\"TotalCoinsFreeFloat\": \"N/A\",\n\"SortOrder\": \"34\",\n\"Sponsored\": false\n},\n</code></pre>\n"}, {"tags": ["go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 1, "creation_date": 1513089258, "post_id": 47775044, "comment_id": 82511103, "body": "Please show the code used to get and put your data. You may also want to try a flat struct for your <code>Get</code> to see if that works."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513089528, "post_id": 47775044, "comment_id": 82511301, "body": "You may also want to take a look at <a href=\"https://stackoverflow.com/questions/14308530/nested-structs-on-gae-datastore-using-go?rq=1\" title=\"nested structs on gae datastore using go\">stackoverflow.com/questions/14308530/&hellip;</a>"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513089894, "post_id": 47775044, "comment_id": 82511579, "body": "@Marc please see edit. I also noticed that answer but I found the documentation to be quite confusing and complex"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513090140, "post_id": 47775044, "comment_id": 82511763, "body": "Thanks for the edit. Could you try the <code>Get</code> with a flattened struct? (no embedded <code>AppUser</code>).  If that still returns no data, try the same for the Put."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513091105, "post_id": 47775044, "comment_id": 82512351, "body": "@Marc Get already returns the Account struct containing all the other data (Username, Password, RegistrationTime) and this works fine, but the <code>AppUser</code> is returned as <code>{[]}</code> even though the data is visible before I Put it (tested with <code>fmt.Println(&quot;PutAccount, account:&quot;, account)</code>)"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 2, "creation_date": 1513091355, "post_id": 47775044, "comment_id": 82512531, "body": "My point was that you need to figure out where this is going wrong. Is it the put or the get? You can narrow down the problem by moving to a flat struct, one where <code>LoginEntries</code> is a field of <code>Account</code>. Using other tools to check that the data is actually there would help too."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513091725, "post_id": 47775044, "comment_id": 82512768, "body": "@Marc Ahh I understand now.. It works if I replace <code>AppUser</code> with <code>LoginEntries</code> as you suggested :).. but I would really like to have, e.g. <code>AppAuser</code>, <code>AppBUser</code>, etc. that each have their own <code>LoginEntries</code> among other info, do you know if it&#39;s possible to achieve this?"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1513092186, "post_id": 47775044, "comment_id": 82513051, "body": "@Marc Hmm.. I just tried to change <code>AppUser</code> to <code>AppUser AppUser</code> and then it works.. no idea why.. I really appreciate your help &lt;3.. I&#39;d like to give you credit for solving the question (and get it marked as solved), but I think it&#39;s only possible if you put one of your comments as answer (:"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1513099017, "post_id": 47775044, "comment_id": 82517329, "body": "Embedded structs are flattened out. For details see: <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#hdr-Structured_Properties\" rel=\"nofollow noreferrer\">Datastore: Structured Properties</a>"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1513092547, "post_id": 47776093, "comment_id": 82513299, "body": "Thanks a lot, really appreciate it &lt;3"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1513093101, "post_id": 47776093, "comment_id": 82513659, "body": "It&#39;s not really &quot;embedded&quot; if it&#39;s named, now is it? ;)"}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 1, "last_activity_date": 1513093197, "last_edit_date": 1513093197, "creation_date": 1513092414, "answer_id": 47776093, "question_id": 47775044, "link": "https://stackoverflow.com/questions/47775044/datastore-doesnt-put-nested-struct-in-go/47776093#47776093", "title": "datastore doesn&#39;t put nested struct in Go", "body": "<p>Using named struct works. eg:</p>\n\n<pre><code>type Account struct {\n  Username         string    // NameKey\n  Password         []byte    `datastore:\",noindex\"`\n  RegistrationTime time.Time `datastore:\",noindex\"`\n  AppUser          AppUser\n}\n</code></pre>\n\n<p>As to why anonymous embedded struct do not, this is probably worthy of an <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/issues/\" rel=\"nofollow noreferrer\">issue</a>.</p>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 47776093, "answer_count": 1, "score": 0, "last_activity_date": 1513093197, "creation_date": 1513089039, "last_edit_date": 1513089722, "question_id": 47775044, "link": "https://stackoverflow.com/questions/47775044/datastore-doesnt-put-nested-struct-in-go", "title": "datastore doesn&#39;t put nested struct in Go", "body": "<p>The structs look like this:</p>\n\n<pre><code>type Account struct {\n  Username         string    // NameKey\n  Password         []byte    `datastore:\",noindex\"`\n  RegistrationTime time.Time `datastore:\",noindex\"`\n  AppUser\n}\n\ntype AppUser struct {\n  LoginEntries []LoginEntry `datastore:\",noindex\"`\n}\n\ntype LoginEntry struct {\n  Timestamp time.Time `datastore:\",noindex\"`\n  UserAgent string    `datastore:\",noindex\"`\n  IP        string    `datastore:\",noindex\"`\n}\n</code></pre>\n\n<p>I'm also sure I put the data correctly, because other data has no problem being updated, and I tried to <code>fmt.Println</code> the content of <code>account Account</code> right before saving it in datastore (<code>Put(ctx, key, &amp;account</code>) and when I print it then I can see all the <code>AppUser</code> information.. but when I later <code>Get</code> the user then the <code>AppUser</code> info doesn't exist (just shows up as <code>{[]}</code>).</p>\n\n<p>I'm quite certain I have stored nested struct slices before in datastore without any problems, so I'm quite confused as to what might be causing it..</p>\n\n<hr>\n\n<p>The Put func:</p>\n\n<pre><code>func PutAccount(ctx context.Context, acc Account) (*datastore.Key, error) {\n  if isValidUsername(acc.Username) != true {\n    return nil, errors.New(\"Invalid username.\")\n  }\n  var hashedPassword []byte\n  if acc.RegistrationTime.IsZero() {\n    var err error\n    hashedPassword, err = bcrypt.GenerateFromPassword(acc.Password, 12)\n    if err != nil {\n      return nil, err\n    }\n  } else {\n    hashedPassword = acc.Password\n  }\n  account := Account{\n    Username:         strings.ToLower(acc.Username),\n    Password:         hashedPassword,\n    RegistrationTime: time.Now(),\n    AppUser:          acc.AppUser}\n  fmt.Println(\"PutAccount, account:\", account) // before saving it prints the AppUser without problems\n  key := datastore.NameKey(\"Account\", account.Username, nil)\n  return database.DatastoreClient().Put(ctx, key, &amp;account)\n}\n</code></pre>\n\n<p>the Get func:</p>\n\n<pre><code>func GetAccount(ctx context.Context, key *datastore.Key) (Account, error) {\n  var account Account\n  err := database.DatastoreClient().Get(ctx, key, &amp;account)\n  if err != nil {\n    return account, err\n  }\n  return account, nil\n}\n</code></pre>\n"}, {"tags": ["go", "pprof"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1513084182, "post_id": 47773191, "comment_id": 82507701, "body": "1. Three seconds elapsed between the two time.Since calls, 2. Monotonic time."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513093515, "post_id": 47773191, "comment_id": 82513944, "body": "It might not be related, but it would be better to use a synchronized method of output to make sure you&#39;re not interleaving writes to stdout. Plus, if you use <code>log</code> you can also get absolute timestamps to further corroborate your findings."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1513106824, "post_id": 47773191, "comment_id": 82521423, "body": "Note that printing to console (or file) involves a syscall, which often results in the goroutine in question being rescheduled.  If you have a ton of goroutines running, it might be a bit before this goroutine is scheduled again and can proceed to the second print statement."}, {"owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 0, "creation_date": 1513124912, "post_id": 47773191, "comment_id": 82528826, "body": "What does it look like if you write the two Durations to variables and then print them out together in one <code>fmt.Printf(&quot;%v\\n%v\\n&quot;, since1, since2)</code> statement?"}, {"owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "reply_to_user": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 0, "creation_date": 1513158175, "post_id": 47773191, "comment_id": 82540672, "body": "@Verran If fixes the problem if I do that. The numbers match."}, {"owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "edited": false, "score": 1, "creation_date": 1513193618, "post_id": 47773191, "comment_id": 82562742, "body": "I&#39;d say that pretty much confirms in my mind that it&#39;s context switching on the fmt.Println and not getting back to the next time.Since() call for a while because there are so many other goroutines waiting for a chance to run."}], "answers": [{"comments": [{"owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "edited": false, "score": 0, "creation_date": 1513093063, "post_id": 47773514, "comment_id": 82513623, "body": "Each user runs its own goroutine so as long as the ids match its the same one. I thought that if I set gctrace to 1 I will see all GC actions."}], "tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 0, "last_activity_date": 1513084235, "creation_date": 1513084235, "answer_id": 47773514, "question_id": 47773191, "link": "https://stackoverflow.com/questions/47773191/strange-behavior-of-time-since/47773514#47773514", "title": "Strange behavior of time.Since()", "body": "<p>Don't think the problem is related to your posted code. To find the problem I suggest printing <a href=\"https://golang.org/pkg/runtime/#ReadMemStats\" rel=\"nofollow noreferrer\">mem stats</a> like number of GC calls and how much was spent in GC between two prints. I suggest to print <code>startTime</code> too to be 100% sure that two consecutive print belongs to same goroutine.</p>\n"}, {"comments": [{"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1513084756, "post_id": 47773595, "comment_id": 82508119, "body": "It&#39;s not a fraction of second it&#39;s 3 seconds for example in the first case."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1513085064, "post_id": 47773595, "comment_id": 82508317, "body": "@ArmanOrdookhani: There are &quot;~15000 goroutines running at the time of the prints.&quot; What else is running on the machine?"}, {"owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "edited": false, "score": 0, "creation_date": 1513092955, "post_id": 47773595, "comment_id": 82513545, "body": "@peterSO the original code would print with units and it was anywhere between 100ms and 100 seconds. The machine is dedicated to this particular application but there are a lot of users connecting via sockets so there are a bunch of listeners and other stuff going on."}, {"owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "edited": false, "score": 0, "creation_date": 1513093248, "post_id": 47773595, "comment_id": 82513747, "body": "I added the time in seconds to the question"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1513085888, "last_edit_date": 1513085888, "creation_date": 1513084502, "answer_id": 47773595, "question_id": 47773191, "link": "https://stackoverflow.com/questions/47773191/strange-behavior-of-time-since/47773595#47773595", "title": "Strange behavior of time.Since()", "body": "<p>If you print the duration units (you are printing nanoseconds), you will see, as expected, it's just a fraction of a monotonic second later. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    var user_uid string\n    startTime := time.Now()\n    since := time.Since(startTime)\n    fmt.Printf(\"%v (1) %v %v\\n\", user_uid, int64(since), since)\n    since = time.Since(startTime)\n    fmt.Printf(\"%v (F) %v %v\\n\", user_uid, int64(since), since)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> (1) 142 142ns\n (F) 22036 22.036\u00b5s\n</code></pre>\n\n<p><code>time.Since</code> and <code>fmt.Printf</code> yield the processor, allowing other goroutines to run.</p>\n"}], "owner": {"reputation": 2705, "user_id": 1501456, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/660e626ccb2d55bc2f3ca14940fb882e?s=128&d=identicon&r=PG", "display_name": "Buzzy", "link": "https://stackoverflow.com/users/1501456/buzzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1513158624, "creation_date": 1513083313, "last_edit_date": 1513158624, "question_id": 47773191, "link": "https://stackoverflow.com/questions/47773191/strange-behavior-of-time-since", "title": "Strange behavior of time.Since()", "body": "<p>I am running a GO (1.9.2) program and I have code similar to:</p>\n\n<pre><code>startTime := time.Now()\n...\n...\nfmt.Printf(\"%v (1) %v \\n\", user.uid, int64(time.Since(startTime)))\nfmt.Printf(\"%v (F) %v \\n\", user.uid, int64(time.Since(startTime)))\n</code></pre>\n\n<p>(The two fmt statements are on consecutive lines)</p>\n\n<p>I expected that the printout would be of similar time but here are some results of the print:</p>\n\n<pre><code>921 (1)    2000100\n921 (F) 3040173800\n</code></pre>\n\n<p>(3 seconds)</p>\n\n<pre><code>360 (1)    2000100\n360 (F) 1063060800\n</code></pre>\n\n<p>(1 second)</p>\n\n<pre><code>447 (1)    4000200\n447 (F) 2564146700\n</code></pre>\n\n<p>(2.5 seconds)</p>\n\n<p>The time difference is consistently high between the two printouts.</p>\n\n<p><strong>What could be the explanation of this phenomenon?</strong></p>\n\n<p>Extra info:\nAccording to pprof there are ~15000 goroutines running at the time of the prints but most of them are waiting for incoming data on sockets.</p>\n\n<p>I ran the code with <code>GODEBUG=gctrace=1</code> but there aren't many GC printouts, not nearly as many as the number of printouts of my code.</p>\n\n<p><strong>EDIT:</strong>\nIt seems that storing the result of time.Since() into variables as suggested by @Verran solves the issue.</p>\n\n<p>Changing to <code>fmt</code> to <code>log</code> didn't help but the prints are no longer synchronized.</p>\n\n<p>It appears the \"problem\" is in the way <code>fmt</code> is handled in a high load environment. I hope someone could shed some light to what is going on here.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "goamz"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "edited": false, "score": 0, "creation_date": 1513233771, "post_id": 47772554, "comment_id": 82575831, "body": "I have checked s3.go file earlier but was not sure about that I can pass nothing.                                                                                                    &quot;In the simplest case, you can just pass nothing. eg: bucket.Put(path,user_content,content_type, s3.ACL(&quot;public-read&quot;), s3.Options{})&quot;"}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1513081367, "creation_date": 1513081367, "answer_id": 47772554, "question_id": 47772367, "link": "https://stackoverflow.com/questions/47772367/aws-s3-put-method-params-by-goamz/47772554#47772554", "title": "aws s3 put method params by goamz", "body": "<p>Options is defined in <a href=\"https://github.com/goamz/goamz/blob/master/s3/s3.go\" rel=\"nofollow noreferrer\">s3.go</a>:</p>\n\n<pre><code>type Options struct {\n    SSE              bool\n    Meta             map[string][]string\n    ContentEncoding  string\n    CacheControl     string\n    RedirectLocation string\n    ContentMD5       string\n    // What else?\n    // Content-Disposition string\n    //// The following become headers so they are []strings rather than strings... I think\n    // x-amz-storage-class []string\n}\n</code></pre>\n\n<p>These options are well documented in the <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectPUT.html\" rel=\"nofollow noreferrer\">official S3 api docs</a>.</p>\n\n<p>In the simplest case, you can just pass nothing. eg:\n<code>bucket.Put(path,user_content,content_type, s3.ACL(\"public-read\"), s3.Options{})</code></p>\n"}], "owner": {"reputation": 157, "user_id": 5608289, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab011a0f1618b7f9bec3dcf25d079549?s=128&d=identicon&r=PG&f=1", "display_name": "Sapna Mishra", "link": "https://stackoverflow.com/users/5608289/sapna-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 47772554, "answer_count": 1, "score": 0, "last_activity_date": 1513081367, "creation_date": 1513080826, "question_id": 47772367, "link": "https://stackoverflow.com/questions/47772367/aws-s3-put-method-params-by-goamz", "title": "aws s3 put method params by goamz", "body": "<p>Earlier I was using <strong>\"launchpad.net/goamz/s3\"</strong> \nbut for my new project I am using <strong>\"github.com/goamz/goamz/s3\".</strong>\nAnd there is change in put method of bucket now it has one more param \"options\"</p>\n\n<pre><code>region := aws.USEast2\nconnection := s3.New(AWSAuth, region)\nbucket := connection.Bucket(\"XXXXX\") // change this your bucket name\npath := \"mypath\" // this is the target file and location in S3\n//Save image to s3\nerr = bucket.Put(path,user_content,content_type, s3.ACL(\"public-read\"), options)\n</code></pre>\n\n<p>Above is my code. Can you help me what is expected in options and how I can get the value of that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1513080788, "post_id": 47772242, "comment_id": 82505471, "body": "Make a <code>[]interface{}</code> out of the non-conditional fields, and then, if the condition is met, append those that are conditional. After that do <code>query.Exex(a...)</code>."}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513081140, "post_id": 47772242, "comment_id": 82505710, "body": "I used this one but it showing an error &quot;rc is not a package&quot; here rc is the struct from which i get the values."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513081284, "post_id": 47772242, "comment_id": 82505795, "body": "Please update your code example, also show where the code in question gets access to <code>rc</code>."}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513082122, "post_id": 47772242, "comment_id": 82506370, "body": "yes please see the modification."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513082470, "post_id": 47772242, "comment_id": 82506614, "body": "Something like this: <a href=\"https://play.golang.org/p/zvSyxiHPjR\" rel=\"nofollow noreferrer\">play.golang.org/p/zvSyxiHPjR</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513082612, "post_id": 47772242, "comment_id": 82506711, "body": "Also the type of the slice elements is the empty interface so when you construct it you need to include the curly braces; <code>[]interface{}{elem1, elem2, ...}</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1513082743, "post_id": 47772242, "comment_id": 82506783, "body": "And you need to &quot;unpack&quot; the args at the end, <code>query.Exec(queryArgs)</code> is not gonna match the columns, you need to do <code>query.Exec(queryArgs...)</code>."}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513088716, "post_id": 47772242, "comment_id": 82510753, "body": "yes Thanks @mkopriva its working"}], "owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530342007, "creation_date": 1513080366, "last_edit_date": 1530342007, "question_id": 47772242, "link": "https://stackoverflow.com/questions/47772242/how-conditional-argument-used-in-db-exec-command-using-golang", "title": "How conditional argument used in `db.Exec` command using golang", "body": "<p>I have a query string with optional fields inside a function like :</p>\n\n<pre><code>func (s *RepairClosesStore) UpdateByCondition(rc RepairClose, userID string, remoteUser string) (err error) {\n\n    log.Println(\"repairclosesStore.go : UpdateByCondition method started\")\n    strQry := `\n                UPDATE \n                    repaircloses \n                SET \n                    dispatchNumber = ?,\n                    runDate = ?,\n                    servicePerformed = ?,\n                    notes = ? ,\n                    repairCode = ?,\n                    serialNumber = ? ,\n                    repairSuccessful =?,\n                    statusCode = ? ,\n                    repairCloseFinished = ?,\n                    billingFinished = ? ,\n                    updateUserID = ? ,\n                    updateRemoteUser = ?,\n                    updateTimestamp = NOW()`\n\n        //Checks repairCloseFinished\n        if rc.RepairCloseFinished {\n\n            //Append strQry query\n            strQry += ` ,closeUserID = ?,\n                        closeRemoteUser = ?,\n                        closeTimeStamp = NOW()`\n        }\n\n        //Checks billingFinished\n        if rc.BillingFinished {\n\n            //Append strQry query\n            strQry += ` ,billingFinishUserID = ?,\n                        billingFinishRemoteUser = ?,\n                        billingFinishTimeStamp = NOW()`\n\n        }\n\n        //Append strQry query\n        strQry += ` WHERE RepairCloseID = ? `\n\n\n\n query, err := s.DB.Prepare(strQry)\n\nqueryArgs := []interface{\n        rc.DispatchNumber,\n        rc.RunDate,\n        rc.ServicePerformed,\n        rc.Notes,\n        rc.RepairCode,\n        rc.SerialNumber,\n        rc.RepairSuccessful,\n\n    }\n\n    resp, err := query.Exec(queryArgs)\n}\n</code></pre>\n\n<p>This is the entire function i used but the problem is there that i don't know how to append optional parameter inside Exec command to execute with conditional parameters.</p>\n\n<p>please help me.</p>\n"}, {"tags": ["go", "unicode", "utf-8"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1513076635, "last_edit_date": 1513076635, "creation_date": 1513075289, "answer_id": 47770584, "question_id": 47769542, "link": "https://stackoverflow.com/questions/47769542/utf8-second-byte-lower-bound-in-golang/47770584#47770584", "title": "utf8 second byte lower bound in golang", "body": "<p>If the first byte of an UTF-8 sequence is <code>0xe0</code>, that means it's a 3-byte sequence representing / encoding a Unicode codepoint (because <code>0xe0 = 1110 0000b</code>).</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">Wikipedia: UTF-8:</a></p>\n\n<pre><code>Number    Bits for    First       Last        Byte 1   Byte 2    Byte 3 \nof bytes  code point  code point  code point \n---------------------------------------------------------------------------\n3         16          U+0800      U+FFFF      1110xxxx 10xxxxxx  10xxxxxx\n</code></pre>\n\n<p>The first Unicode codepoint that is encoded using 3-byte UTF-8 sequence is U+0800, so the codepoint is <code>0x0800</code>, in binary: <code>0000 1000 0000 0000</code></p>\n\n<p>If you try to insert these bits into the ones marked with <code>x</code>:</p>\n\n<pre><code>1110xxxx 10xxxxxx 10xxxxxx\n11110000 10100000 10000000\n</code></pre>\n\n<p>As you can see, the second byte is <code>1010 0000</code> which is <code>0xa0</code>. So a valid UTF-8 sequence that starts with <code>0xe0</code>: its 2nd byte cannot be lower than <code>0xa0</code> (because even the lowest Unicode codepoint whose UTF-8 encoded sequence starts with <code>0xe0</code> has a 2nd byte of <code>0xa0</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": true, "score": 4, "last_activity_date": 1513075317, "creation_date": 1513075317, "answer_id": 47770598, "question_id": 47769542, "link": "https://stackoverflow.com/questions/47769542/utf8-second-byte-lower-bound-in-golang/47770598#47770598", "title": "utf8 second byte lower bound in golang", "body": "<p>The reason is to prevent so-called overlong sequences. Quoting the RFC:</p>\n\n<blockquote>\n  <p>Implementations of the decoding algorithm above MUST protect against\n     decoding invalid sequences.  For instance, <strong>a naive implementation may\n     decode the overlong UTF-8 sequence C0 80 into the character U+0000</strong>,\n     or the surrogate pair ED A1 8C ED BE B4 into U+233B4.  Decoding\n     invalid sequences may have security consequences or cause other\n     problems.</p>\n  \n  <p>[...]</p>\n  \n  <p>A particularly subtle form of this attack can be carried out against\n     a parser which performs security-critical validity checks against the\n     UTF-8 encoded form of its input, but interprets certain illegal octet\n     sequences as characters.  For example, a parser might prohibit the\n     NUL character when encoded as the single-octet sequence 00, but\n     erroneously allow the illegal two-octet sequence C0 80 and interpret\n     it as a NUL character.  Another example might be a parser which\n     prohibits the octet sequence 2F 2E 2E 2F (\"/../\"), yet permits the\n     illegal octet sequence 2F C0 AE 2E 2F.  This last exploit has\n     actually been used in a widespread virus attacking Web servers in\n     2001; thus, the security threat is very real.</p>\n</blockquote>\n\n<p>Also note the syntax rules in section 4 which explicitly only allow characters A0-BF after E0:</p>\n\n<blockquote>\n<pre><code>UTF8-2      = <b>%xC2-DF</b> UTF8-tail  \nUTF8-3      = <b>%xE0 %xA0-BF UTF8-tail</b> / %xE1-EC 2( UTF8-tail ) /\n              %xED %x80-9F UTF8-tail / %xEE-EF 2( UTF8-tail )  \nUTF8-4      = <b>%xF0 %x90-BF 2( UTF8-tail )</b> / %xF1-F3 3( UTF8-tail ) /\n              %xF4 %x80-8F 2( UTF8-tail )</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 2364, "user_id": 2226753, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9f4aaabdbd6fc131a2d3503c07d94f6b?s=128&d=identicon&r=PG", "display_name": "Seneca", "link": "https://stackoverflow.com/users/2226753/seneca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 47770598, "answer_count": 2, "score": 2, "last_activity_date": 1513076635, "creation_date": 1513072108, "last_edit_date": 1513072689, "question_id": 47769542, "link": "https://stackoverflow.com/questions/47769542/utf8-second-byte-lower-bound-in-golang", "title": "utf8 second byte lower bound in golang", "body": "<p>I was recently going through the go source code of utf8 decoding.\nApparently when decoding utf8 bytes, when the first byte has the value 224\n(0xE0) it maps to an accept range of [0xA0;  0xBF].\n<a href=\"https://github.com/golang/go/blob/master/src/unicode/utf8/utf8.go#L81\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/unicode/utf8/utf8.go#L81</a>\n<a href=\"https://github.com/golang/go/blob/master/src/unicode/utf8/utf8.go#L94\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/unicode/utf8/utf8.go#L94</a></p>\n\n<p>If I understand the utf8 spec (<a href=\"https://tools.ietf.org/html/rfc3629\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc3629</a>) correctly every continuation byte has the minimum value of 0x80 or 1000 0000. Why is the minimum value for opening byte with 0xE0 higher, i.e. 0xA0 instead of 0x80?</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-go-client"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6723657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JTBrkpRo97g/AAAAAAAAAAI/AAAAAAAAAA0/rGy5eFjt8wA/photo.jpg?sz=128", "display_name": "user6723657", "link": "https://stackoverflow.com/users/6723657/user6723657"}, "is_accepted": false, "score": 1, "last_activity_date": 1541536801, "last_edit_date": 1541536801, "creation_date": 1541535293, "answer_id": 53179338, "question_id": 47768367, "link": "https://stackoverflow.com/questions/47768367/create-api-object-from-a-list-of-yaml-object/53179338#53179338", "title": "Create API object from a list of YAML object", "body": "<p>To convert runtime objects to Kubernetes objects, you can do something like:</p>\n\n<pre><code>switch typed := obj.(type) {\n  case *apiv1.Pod:\n    log.Info(typed.Name) // type is Pod\n  case *apiv1.Namespace:\n  // typed is Namespace\n}\n</code></pre>\n"}], "owner": {"reputation": 9173, "user_id": 172265, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7d658f2c111ae5d8b48f0f0aa7624372?s=128&d=identicon&r=PG", "display_name": "lang2", "link": "https://stackoverflow.com/users/172265/lang2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1541536801, "creation_date": 1513068215, "last_edit_date": 1519118643, "question_id": 47768367, "link": "https://stackoverflow.com/questions/47768367/create-api-object-from-a-list-of-yaml-object", "title": "Create API object from a list of YAML object", "body": "<p>I have a list of kubernetes objects defined like this:</p>\n\n<pre><code>apiVersion: v1\nitems:\nkind: List\n- .....\n</code></pre>\n\n<p>I'd like to parse it with something like <code>client-go</code> and gather some information on it.</p>\n\n<p>So I searched and found some piece of code like this:</p>\n\n<pre><code>decode := api.Codecs.UniversalDeserializer().Decode\nobj, _, err := decode([]byte(f), nil, nil)\n\nlst, err := meta.ExtractList(obj)\nfor _, o := range lst {\n    doSomeThing(o)\n}\n</code></pre>\n\n<p>So <code>obj</code> and each of its element is <code>runtime.Object</code> kind. But I can't seem to find a way to convert that into a concrete kubernetes object like <code>v1.Pod</code>. How can I do that?</p>\n"}, {"tags": ["ruby-on-rails", "go", "microservices"], "answers": [{"comments": [{"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1513073053, "post_id": 47768881, "comment_id": 82500711, "body": "I just read your post, really helpful - maybe I will print it out and put on my wall as I will come back to it dozen of times in meantime  Thanks a lot :)"}, {"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "reply_to_user": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1513073275, "post_id": 47768881, "comment_id": 82500847, "body": "Glad you liked it.  Not so much tech as well-worn battle scars from having run/participated in such tech transitions, but still...  That said, I love Go and wish you the best of luck--it really is a great, fast language and a pleasure to code in."}, {"owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "edited": false, "score": 0, "creation_date": 1513073758, "post_id": 47768881, "comment_id": 82501154, "body": "Yeah, it was really helpful and will definitely follow some of those principles. Will come back again, when I would have something practical to ask again"}], "tags": [], "owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "is_accepted": true, "score": 2, "last_activity_date": 1513069987, "creation_date": 1513069987, "answer_id": 47768881, "question_id": 47767993, "link": "https://stackoverflow.com/questions/47767993/golang-microservices-and-communication-with-existing-app/47768881#47768881", "title": "Golang microservices and communication with existing app", "body": "<blockquote>\n  <p>How to best eat an elephant?  One bite at a time...</p>\n</blockquote>\n\n<p>Since this is a new world for you, I would start by peeling off one function of your application that isn't highly connected to anything else at first.  Pick on that reporting engine that doesn't use any actual business logic or that periodic maintenance task that queries the database directly or similar.  It need not be the most-in-need of performance enhancement (though IME reporting is almost always slower if it has to wade through business logic to get data).  The point is to peel something off that doesn't have huge prerequisites to get there so you gain confidence and understanding as to how the new environment will plug in.</p>\n\n<p>Once you have that, consider how much business logic you need and how deep your side effects are.  Try to find your second batch of work in things that don't have many side effects and are as close to a classical function (i.e. a bunch of inputs, one output) as possible.  If there's something in your RoR code that could be dispatched (like \"I got all this data\" ... then something magical happens ... then \"I output some processed data\"), that's a good bet.</p>\n\n<p>There's a certain amount of latency added by the trips back and forth on HTTP (less if it's direct from the browser, but still...), so be careful to work in places where you know you can get gains.  A profiler against your old code would help bunches here--whatever's expensive would be your next candidate.</p>\n\n<p>If you still need optimizations after handling the low-hanging fruit, then you may need to consider splitting your business rules such that some live in the RoR world and others live in the Go one.  DO NOT MAINTAIN TWO IMPLEMENTATIONS OF THE SAME BUSINESS RULES--THAT WAY LIES MADNESS.  If you decide that orders are one system and supply chain is another, that's fine, but do not try to maintain implementations of the supply chain code in both environments.</p>\n\n<p>And for G-d's sake, if you migrate business logic from an old system to a new one, DON'T LEAVE THE OLD CODE IN PLACE BUT UNUSED!!!  You have version control--if someone needs to refer back to the old implementation, have them dig.  Otherwise you'll confuse your poor code maintainers with vestigial code that never gets run.  If you've deprecated code, REMOVE IT.</p>\n\n<p>Oh, and I'm sure I don't need to say this, but you need unit tests to verify bug-for-bug compatibility...</p>\n\n<p>Finally, keep in mind that RoR is highly MVC-oriented and Go is not <em>inherently</em> MVC (though there are a <a href=\"https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiZ_KuWi4TYAhUs0YMKHXIHDyAQFggnMAA&amp;url=https%3A%2F%2Fgithub.com%2Fgernest%2Futron&amp;usg=AOvVaw3VZd4unouRSN4BZ3fJbCAp\" rel=\"nofollow noreferrer\">number</a> <a href=\"https://github.com/kataras/iris\" rel=\"nofollow noreferrer\">of</a> <a href=\"https://revel.github.io/manual/concepts.html\" rel=\"nofollow noreferrer\">frameworks</a> that are).  You'll definitely want to check out (and honestly probably discard) those frameworks in the vain attempt to do a direct port.  Go ahead: get it out of your system.  Then move on to doing small, incremental advances and slowly eat your elephant.</p>\n"}], "owner": {"reputation": 1099, "user_id": 1967868, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38a7404c188b85337c9613bc2cc7cd93?s=128&d=identicon&r=PG", "display_name": "zauzaj", "link": "https://stackoverflow.com/users/1967868/zauzaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "closed_date": 1513085198, "accepted_answer_id": 47768881, "answer_count": 1, "score": -1, "last_activity_date": 1547985911, "creation_date": 1513066568, "last_edit_date": 1547985911, "question_id": 47767993, "link": "https://stackoverflow.com/questions/47767993/golang-microservices-and-communication-with-existing-app", "closed_reason": "Opinion-based", "title": "Golang microservices and communication with existing app", "body": "<p>I'm wondering to do some scaling on our Rails app and I'd like to use Golang. \nSo, today we have quite big application written in RoR, where a lot of processing &amp; computations goes through Ruby which turned to be slow in some cases.</p>\n\n<p>I'm wondering to take some parts of our application, and to re-write them in Golang for the sake of better performances. </p>\n\n<p>I'd like to hear some good advice &amp; practices, especially how to start splitting them. </p>\n\n<p>Best Regards</p>\n"}, {"tags": ["linux", "go", "rpc"], "comments": [{"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1513064148, "post_id": 47767326, "comment_id": 82495744, "body": "Your question is not clear at all. How do you enable SSH on a machine without access to it? What is the web application? And whats the relation to Go?"}, {"owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "edited": false, "score": 0, "creation_date": 1513064580, "post_id": 47767326, "comment_id": 82495962, "body": "I hope I corrected the mistakes mentioned in the comments."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1513064786, "post_id": 47767326, "comment_id": 82496082, "body": "@Gauranga There&#39;s little information there that we can use. We can perhaps guess that your manager machine already can do what you want it to do - but that part is very unclear. If it can already do this, you need to reverse engineer the code you have running on your machines that does this, or ask whoever wrote this code what they have done. If the manager machine already can enable ssh on your other machines, those machines run some non-standard services - It&#39;s hard for anyone that does not have access to your machines to figure out how they work."}, {"owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "edited": false, "score": 0, "creation_date": 1513065026, "post_id": 47767326, "comment_id": 82496217, "body": "ok, let me try if I can get more details. These machines are actually 3rd party machines. And currently, its happening via web. I need to automate that in Golang."}, {"owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "edited": false, "score": 0, "creation_date": 1513065448, "post_id": 47767326, "comment_id": 82496427, "body": "I guess you may be able to do this. Check in the browser what network traffic - http request-response exchange is happening. You probably may be able to do the same using Go."}, {"owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "edited": false, "score": 0, "creation_date": 1513065700, "post_id": 47767326, "comment_id": 82496537, "body": "Sure, let me try that as well."}], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "edited": false, "score": 0, "creation_date": 1513065183, "post_id": 47767612, "comment_id": 82496302, "body": "Thank you for answer. I just need a confirmation if its not possible. I tried all possible ways and failed. So, thought of checking once before giving up :)"}], "tags": [], "owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "is_accepted": false, "score": 1, "last_activity_date": 1513065045, "creation_date": 1513065045, "answer_id": 47767612, "question_id": 47767326, "link": "https://stackoverflow.com/questions/47767326/execute-a-script-on-local-server-without-ssh/47767612#47767612", "title": "Execute a script on local server without ssh", "body": "<blockquote>\n  <p>Currently, its done by opening a http session in browser, and then providing username and password, followed by the buttons on the page for each script. I need to automate this.</p>\n</blockquote>\n\n<p>I think you don't need to care about interface at all, until you find a way to execute scripts in backend. From my point of view, it's impossible to execute scripts on the machine without setting up at least SSHD on them. To have your script executed, you need to have some kind of server working on remote machine to handle your requests.</p>\n\n<p>Also, have a look at Configuration Management Systems, such as: <a href=\"https://www.ansible.com/\" rel=\"nofollow noreferrer\">Ansible</a>, <a href=\"https://saltstack.com/\" rel=\"nofollow noreferrer\">SaltStack</a>, and <a href=\"https://en.wikipedia.org/wiki/Comparison_of_open-source_configuration_management_software\" rel=\"nofollow noreferrer\">so on</a>, because even SSH seems to be a too low-level tool for your use-case.</p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1513067428, "last_edit_date": 1513067428, "creation_date": 1513066642, "answer_id": 47768023, "question_id": 47767326, "link": "https://stackoverflow.com/questions/47767326/execute-a-script-on-local-server-without-ssh/47768023#47768023", "title": "Execute a script on local server without ssh", "body": "<p>Yes, it's possible to do solely with the Go standard library.</p>\n\n<p>The things to study, in this order:</p>\n\n<ol>\n<li><p>How HTML forms are encoded and sent to HTTP servers by the Internet browsers.</p>\n\n<p>The things to get familiar with:</p>\n\n<ul>\n<li><a href=\"https://tools.ietf.org/html/rfc7230\" rel=\"nofollow noreferrer\">The HTTP protocol</a> \u2014 especially\nits <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.1\" rel=\"nofollow noreferrer\"><code>GET</code></a> and <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.3\" rel=\"nofollow noreferrer\"><code>POST</code></a> request methods.</li>\n<li><a href=\"https://www.w3.org/TR/html401/interact/forms.html\" rel=\"nofollow noreferrer\">Forms in HTML</a> \u2014 especially pt. 13 \"Form submission\".</li>\n</ul></li>\n<li><p>When a HTML form is submitted, the data sent to the HTTP server\nis typically encoded in one of two forms:</p>\n\n<ul>\n<li>The <code>application/x-www-form-urlencoded</code> encoding\nis used to make <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.1\" rel=\"nofollow noreferrer\"><code>GET</code></a> requests and</li>\n<li>The <code>multipart/form-data</code> encoding is used to make <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.3\" rel=\"nofollow noreferrer\"><code>POST</code></a>\nrequests.</li>\n</ul>\n\n<p>In your example, the form has the <code>method=\"get\"</code>\nattribute which indicates the form submission uses <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.1\" rel=\"nofollow noreferrer\"><code>GET</code></a>\nand hence the <code>application/x-www-form-urlencoded</code> encoding for its\ndata.</p></li>\n<li><p>The <code>net/http</code> package in the Go standard library which can be used to\nmake HTTP requests.</p></li>\n</ol>\n\n<p>With all this things in place, you need to make a HTTP <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.1\" rel=\"nofollow noreferrer\"><code>GET</code></a>\nrequest to a proper server and URL, with a proper set of parameters.</p>\n\n<p>The server is the same from which you get that HTML page.\nThe URL will be <code>/enableSsh.cgi</code>.</p>\n\n<p>Now you just need to make up the request and to it.</p>\n\n<p>Here is <a href=\"https://stackoverflow.com/a/30657518/720999\">one example</a>\nbut really googling for <code>golang+get+query+with+parameters</code> will bring\nyou myriads of similar examples.\nThe query parameters are those form fields\u2014<code>stamp</code>, <code>token</code> and <code>frame</code>,\nand their values are, well, what is about to be submitted.</p>\n\n<hr>\n\n<p>In the case you'll need to <code>POST</code> a form with the <code>multipart/form-data</code>\nencoding, you'd use\nthe <code>mime/multipart</code> package in the Go standard library, whose\n<code>Writer</code> type can be used to build a stream of data encoded according\nto the <code>multipart/form-data</code> rules.</p>\n"}], "owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 2, "answer_count": 2, "score": -2, "last_activity_date": 1513067428, "creation_date": 1513063881, "last_edit_date": 1513066671, "question_id": 47767326, "link": "https://stackoverflow.com/questions/47767326/execute-a-script-on-local-server-without-ssh", "title": "Execute a script on local server without ssh", "body": "<p>There is a local area network, machines are in same address space.</p>\n\n<p>I have one manager node which controls other machines. Is there a way to execute a script on any of these machines? (Note: SSH is not enabled and we cannot install any code on these machines except manager machine)</p>\n\n<p>Currently, its done by opening a http session in browser, and then providing username and password, followed by the buttons on the page for each script. I need to automate this in <code>Go</code>. Is this possible?</p>\n\n<p>Eg of one such button:</p>\n\n<pre><code>`&lt;form ACTION=\"enableSsh.cgi\" method=\"get\"&gt;\n    &lt;b&gt;\n        &lt;input type=\"SUBMIT\" VALUE=\"Enable SSH Service\"&gt;\n        &lt;input type=hidden name=stamp value=\"########\"&gt;\n        &lt;input type=hidden name=token value=\"********\"&gt;\n        &lt;input type=hidden name=frame value=\"$%$%$%$%\"&gt;\n    &lt;/b&gt;\n&lt;/form&gt;`\n</code></pre>\n"}, {"tags": ["json", "parsing", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1513066162, "last_edit_date": 1513066162, "creation_date": 1513065859, "answer_id": 47767813, "question_id": 47767300, "link": "https://stackoverflow.com/questions/47767300/struct-to-complex-json-parsing-in-golang/47767813#47767813", "title": "Struct to complex JSON parsing in golang", "body": "<p>I assume that <code>params</code> depends on the <code>method</code>.  If so, start by decoding the top-level to a struct with the method name and a <a href=\"https://godoc.org/encoding/json#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a> to collect the parameters as JSON text. </p>\n\n<pre><code>var call struct {\n    Method string\n    Params json.RawMessage\n}\nif err := json.Unmarshal(data, &amp;call); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Declare variables for each parameter. This code will depend on the method.</p>\n\n<pre><code>    var param0 int\n    var param1 []struct {\n        Previous                string\n        Timestamp               string\n        Witness                 string\n        Transaction_merkle_root string\n        Extensions              []interface{}\n        Witness_signature       string\n    }\n</code></pre>\n\n<p>Create a parameter list using pointers to those variables.</p>\n\n<pre><code>    params := []interface{}{&amp;param0, &amp;param1}\n</code></pre>\n\n<p>Now unmarshal the JSON to params. This will set the variables param0 and param1:</p>\n\n<pre><code>    if err := json.Unmarshal(call.Params, &amp;params); err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n\n<p>Repeat for other methods.</p>\n\n<p><a href=\"https://play.golang.org/p/U0mcP0gC62\" rel=\"nofollow noreferrer\">Here's the runnable code on the playground</a>.</p>\n\n<p>This can be simplified if you will only need to handle the \"notice\" method. In this case, you can decode directly to the parameters without the RawMessage step.</p>\n\n<pre><code>var param0 int\nvar param1 []struct {\n    Previous                string\n    Timestamp               string\n    Witness                 string\n    Transaction_merkle_root string\n    Extensions              []interface{}\n    Witness_signature       string\n}\ncall := struct {\n    Method string\n    Params []interface{}\n}{\n    Params: []interface{}{&amp;param0, &amp;param1},\n}\n\nif err := json.Unmarshal(data, &amp;call); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/eRxeTumdCt\" rel=\"nofollow noreferrer\">Here's runnable code for the simple case</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2246, "user_id": 274937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d848784d081501a5cba4a2fa7856e965?s=128&d=identicon&r=PG", "display_name": "valyala", "link": "https://stackoverflow.com/users/274937/valyala"}, "is_accepted": false, "score": 0, "last_activity_date": 1527690341, "creation_date": 1527690341, "answer_id": 50607192, "question_id": 47767300, "link": "https://stackoverflow.com/questions/47767300/struct-to-complex-json-parsing-in-golang/50607192#50607192", "title": "Struct to complex JSON parsing in golang", "body": "<p>Try using <a href=\"https://github.com/valyala/fastjson\" rel=\"nofollow noreferrer\">fastjson</a>. It is able to parse and query arbitrary JSON without defining additional structs and without code generation:</p>\n\n<pre><code>var p fastjson.Parser\nv, err := p.Parse(data)\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Printf(\"method=%s\", v.GetStringBytes(\"method\"))\n\n// GetStringBytes accepts a path of keys to extract json value.\n// Array indexes must be passed as decimal strings.\nfmt.Printf(\"timestamp=%s\", v.GetStringBytes(\"params\", \"1\", \"0\", \"timestamp\"))\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9087344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c81a4322fc631a9cc806d3c70ac929e?s=128&d=identicon&r=PG&f=1", "display_name": "Futurama1", "link": "https://stackoverflow.com/users/9087344/futurama1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1527690341, "creation_date": 1513063761, "last_edit_date": 1513064360, "question_id": 47767300, "link": "https://stackoverflow.com/questions/47767300/struct-to-complex-json-parsing-in-golang", "title": "Struct to complex JSON parsing in golang", "body": "<p>I have a valid JSON, which I don't know how to parse in json.Unmarshal (golang):</p>\n\n<pre><code>{\n   \"method\": \"notice\",\n   \"params\": [0, [{\n           \"previous\": \"12345\",\n           \"timestamp\": \"2017-12-12T05:49:09\",\n           \"witness\": \"12345\",\n           \"transaction_merkle_root\": \"ffff\",\n           \"extensions\": [],\n           \"witness_signature\": \"12345\"\n   }]]\n}\n</code></pre>\n\n<p>All I can do is:</p>\n\n<pre><code>type MyJSON struct {\n    Method string        `json:\"method\"`\n    Params []interface{} `json:\"params\"`\n}\n</code></pre>\n\n<p>I will be really thankful if somebody help me to write correct MyJSON type to parse all other fields through golang's json.Unmarshal. It's way too complex to me :(</p>\n"}, {"tags": ["pointers", "go", "types", "interface", "type-assertion"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1513054484, "post_id": 47765489, "comment_id": 82492363, "body": "Make SomeFuncion take a pointer reciever?"}, {"owner": {"reputation": 71, "user_id": 4310168, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/115d8672e572d88c138b81bd9d2ee4b7?s=128&d=identicon&r=PG&f=1", "display_name": "cepiolot", "link": "https://stackoverflow.com/users/4310168/cepiolot"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1513054638, "post_id": 47765489, "comment_id": 82492397, "body": "@Volker in my implementation, SomeFunction() was already taking a pointer receiver, updated the question accordingly, thanks for noticing."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1513056624, "post_id": 47765489, "comment_id": 82492943, "body": "Take the address of a Player and pass it to TakeInterface.   See <a href=\"https://play.golang.org/p/oZKuFC0z1l\" rel=\"nofollow noreferrer\">play.golang.org/p/oZKuFC0z1l</a> ."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1513067522, "post_id": 47765489, "comment_id": 82497395, "body": "&quot;How do I go about passing a Player by address to a function that takes a Character/Character pointer?&quot; You simply <i>do</i> <i>not</i> <i>do</i> <i>this</i>! You never (except you need to and you do not!) pass pointers to interfaces. You pass values to interfaces. This is possible if the  type implements the interface. Some type implement interfaces only for pointer receivers."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1513090610, "post_id": 47765489, "comment_id": 82512056, "body": "@Volker but Player isn&#39;t an interface. What they&#39;re describing is completely normal: passing a pointer to an object to a function that takes an interface that the object satisfies."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1513110172, "post_id": 47765489, "comment_id": 82523168, "body": "I&#39;m not talking about Player. You asked about &quot;a Character/Character pointer&quot; and that is <i>wrong</i>."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4310168, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/115d8672e572d88c138b81bd9d2ee4b7?s=128&d=identicon&r=PG&f=1", "display_name": "cepiolot", "link": "https://stackoverflow.com/users/4310168/cepiolot"}, "edited": false, "score": 0, "creation_date": 1513104687, "post_id": 47765904, "comment_id": 82520339, "body": "To answer your question, I tested my code but it didn&#39;t occur to me that you could pass a value or a pointer to a function that takes an interface value. I kept trying to pass a player pointer to a function taking a character pointer. I looked around but didn&#39;t find an answer like this, my bad. Thanks for your answer."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1513117229, "post_id": 47765904, "comment_id": 82526275, "body": "See also my answer <a href=\"https://stackoverflow.com/questions/44370277/type-is-pointer-to-interface-not-interface-confusion/44372954#44372954\">here</a> for a bit more details on pointers versus values and interfaces and how that all functions."}], "tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": true, "score": 2, "last_activity_date": 1513057302, "last_edit_date": 1513057302, "creation_date": 1513056726, "answer_id": 47765904, "question_id": 47765489, "link": "https://stackoverflow.com/questions/47765489/how-to-pass-by-address-to-function-that-takes-interface/47765904#47765904", "title": "How to pass by address to function that takes interface", "body": "<p>Have you tested your code? I'm guessing no, because it works the way you expect it to work. Just pass a pointer to a player when calling the function.</p>\n\n<pre><code>func main() {\n    p := new(Player)\n    TakeInterface(p)\n}\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>func main() {\n    p := Player{0}\n    TakeInterface(&amp;p)\n}\n</code></pre>\n\n<p>In go you can use a type or a pointer to a type as an argument to a function that takes an interface because both satisfy the interface. You can do both:</p>\n\n<pre><code>    var p1 Player\n    p1.SomeFunction()\n    var p2 *Player\n    p2.SomeFunction()\n</code></pre>\n\n<p>You should do the tour of go: <a href=\"https://tour.golang.org/methods/10\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/10</a></p>\n\n<p>Here is the whole code: <a href=\"https://play.golang.org/p/iQIChLCziG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iQIChLCziG</a></p>\n"}], "owner": {"reputation": 71, "user_id": 4310168, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/115d8672e572d88c138b81bd9d2ee4b7?s=128&d=identicon&r=PG&f=1", "display_name": "cepiolot", "link": "https://stackoverflow.com/users/4310168/cepiolot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 47765904, "answer_count": 1, "score": -3, "last_activity_date": 1513090982, "creation_date": 1513053848, "last_edit_date": 1513090982, "question_id": 47765489, "link": "https://stackoverflow.com/questions/47765489/how-to-pass-by-address-to-function-that-takes-interface", "title": "How to pass by address to function that takes interface", "body": "<p>\nI have a <code>Character</code> interface defined like:</p>\n\n<pre><code>type Character interface {\n    SomeFunction()\n}\n</code></pre>\n\n<p>And a <code>Player</code> struct defined like:</p>\n\n<pre><code>type Player struct{}\n\nfunc (r *Player) SomeFunction() { }\n// Some fields and other functions....\n</code></pre>\n\n<p>\nSuppose I have a function defined as</p>\n\n<pre><code>func TakeInterface(characterValue Character) {\n     // Do something\n}\n</code></pre>\n\n<p>The catch is, I want to pass in <code>characterValue</code> as a <code>Player</code> by <strong>address</strong> so that changes made to it will be made to the <code>Player</code> the caller passed in. In Java and C++, this is easy, but I can't seem to figure it out in Golang. I've tried something like,</p>\n\n<pre><code>func TakeInterface(characterValue &amp;Character) {\n    // Do something that changes characterValue\n}\n</code></pre>\n\n<p>and then passing in a <code>Player</code> pointer, but then I get the error <code>*Character.Character is pointer to interface, not interface</code> when I try to pass in an address.</p>\n\n<p>How do I go about passing a <code>Player</code> by address to a function that takes a <code>Character</code>/<code>Character</code> pointer? I've been looking around but with no success. Thanks!\n</p>\n\n\n"}, {"tags": ["testing", "go", "rpc", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 4848, "user_id": 4698795, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-Geo9JqDWnPg/AAAAAAAAAAI/AAAAAAAAKFg/VCKLQs7w4vo/photo.jpg?sz=128", "display_name": "Brick Yang", "link": "https://stackoverflow.com/users/4698795/brick-yang"}, "edited": false, "score": 1, "creation_date": 1556626501, "post_id": 47771830, "comment_id": 98495124, "body": "If I didn&#39;t missing something, the testing with an implement of gRPC client is completely manual. It means You have to start the server manually then you can run the client to test it, right?"}, {"owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "reply_to_user": {"reputation": 4848, "user_id": 4698795, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-Geo9JqDWnPg/AAAAAAAAAAI/AAAAAAAAKFg/VCKLQs7w4vo/photo.jpg?sz=128", "display_name": "Brick Yang", "link": "https://stackoverflow.com/users/4698795/brick-yang"}, "edited": false, "score": 0, "creation_date": 1556627196, "post_id": 47771830, "comment_id": 98495513, "body": "@BrickYang yes you are partly correct. But usually server is started before the test cases ( for example in <code>init</code> method ) and it is stopped after all the test cases are completed."}], "tags": [], "owner": {"reputation": 996, "user_id": 4909445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ded7e867ff7001048e511974d4c19137?s=128&d=identicon&r=PG&f=1", "display_name": "Shettyh", "link": "https://stackoverflow.com/users/4909445/shettyh"}, "is_accepted": false, "score": 2, "last_activity_date": 1513079099, "creation_date": 1513079099, "answer_id": 47771830, "question_id": 47764448, "link": "https://stackoverflow.com/questions/47764448/how-to-test-grpc-apis/47771830#47771830", "title": "How to test gRPC APIs?", "body": "<p>There can be two type of testing.</p>\n\n<ul>\n<li><p>Testing just the implementation of the <em>gRPC</em> method by ignoring the networking</p>\n\n<p><a href=\"https://stackoverflow.com/a/42103776/4909445\">this</a> question answers this aspect of the testing. By just writing the unit test for the RPC method</p></li>\n<li><p>If you want to test both the implementation and the <em>gRPC</em> networking aspects as well then you need write the gRPC client for the service you want to test.</p></li>\n</ul>\n\n<p>Here a code snippet about creating a gRPC client</p>\n\n<pre><code>// Set up a connection to the server.\nconn, err := grpc.Dial(address, grpc.WithInsecure())\n// Execute RPC you want to test\nr, err := c.SayHello(context.Background(), &amp;pb.HelloRequest{Name: name})\n</code></pre>\n\n<p>Check <a href=\"https://github.com/grpc/grpc-go/blob/master/examples/helloworld/greeter_client/main.go\" rel=\"nofollow noreferrer\">here</a> for complete code example</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 5881066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xVwalJH0Aqk/AAAAAAAAAAI/AAAAAAAAAIs/VOgUxNkNp1o/photo.jpg?sz=128", "display_name": "Amrit Kr Lama", "link": "https://stackoverflow.com/users/5881066/amrit-kr-lama"}, "edited": false, "score": 0, "creation_date": 1614082102, "post_id": 57832375, "comment_id": 117270458, "body": "Any idea how we can wrap the text in BloomRPC?  Sometimes the string gets huge and it&#39;s clumsy without text wrap."}], "tags": [], "owner": {"reputation": 1477, "user_id": 4051158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461145086dafae69345b35ece8bdfe79?s=128&d=identicon&r=PG&f=1", "display_name": "Pram", "link": "https://stackoverflow.com/users/4051158/pram"}, "is_accepted": false, "score": 4, "last_activity_date": 1567848296, "creation_date": 1567848296, "answer_id": 57832375, "question_id": 47764448, "link": "https://stackoverflow.com/questions/47764448/how-to-test-grpc-apis/57832375#57832375", "title": "How to test gRPC APIs?", "body": "<p>Well, I was in search for a client like Postman, then i found <a href=\"https://github.com/uw-labs/bloomrpc\" rel=\"nofollow noreferrer\">bloomrpc</a>, which helps in calling grpc services. But i am not sure if it serves your purpose, if you are looking for a tool like jmeter. </p>\n"}, {"comments": [{"owner": {"reputation": 789, "user_id": 5885483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2acddf5292a671b45ada59a3617a3709?s=128&d=identicon&r=PG&f=1", "display_name": "Krisz", "link": "https://stackoverflow.com/users/5885483/krisz"}, "edited": false, "score": 4, "creation_date": 1591689008, "post_id": 62277329, "comment_id": 110142713, "body": "Try to avoid link-only answers, provide an example or some context around it."}], "tags": [], "owner": {"reputation": 34, "user_id": 11616398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa4d028980f3263f0d26663f3ae31e6?s=128&d=identicon&r=PG&f=1", "display_name": "wannabepro", "link": "https://stackoverflow.com/users/11616398/wannabepro"}, "is_accepted": false, "score": 0, "last_activity_date": 1591688043, "creation_date": 1591688043, "answer_id": 62277329, "question_id": 47764448, "link": "https://stackoverflow.com/questions/47764448/how-to-test-grpc-apis/62277329#62277329", "title": "How to test gRPC APIs?", "body": "<p>You can also try this <a href=\"https://github.com/ktr0731/evans\" rel=\"nofollow noreferrer\">command line tool</a>, evans, for testing gRPC</p>\n"}, {"tags": [], "owner": {"reputation": 11239, "user_id": 2829009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec98d526f807d6895070e3226291ac0?s=128&d=identicon&r=PG", "display_name": "Manuel Allenspach", "link": "https://stackoverflow.com/users/2829009/manuel-allenspach"}, "is_accepted": false, "score": 2, "last_activity_date": 1611845723, "creation_date": 1611845723, "answer_id": 65939612, "question_id": 47764448, "link": "https://stackoverflow.com/questions/47764448/how-to-test-grpc-apis/65939612#65939612", "title": "How to test gRPC APIs?", "body": "<p>If you are searching for a tool like Postman, there is also <a href=\"https://kreya.app\" rel=\"nofollow noreferrer\">https://kreya.app</a>. With it, you can call your gRPC services and view the responses.</p>\n<p><em>Disclaimer: I'm one of the authors of Kreya.</em></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 751891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb407c9b544696e60839007676cbb27?s=128&d=identicon&r=PG", "display_name": "Erik Araojo", "link": "https://stackoverflow.com/users/751891/erik-araojo"}, "is_accepted": false, "score": 1, "last_activity_date": 1615539682, "creation_date": 1615539682, "answer_id": 66596936, "question_id": 47764448, "link": "https://stackoverflow.com/questions/47764448/how-to-test-grpc-apis/66596936#66596936", "title": "How to test gRPC APIs?", "body": "<p>Since you mentiond you've done testing before with JMeter, I assume that you're looking for an external test client that can call the gRPC service.  There are several that you can use. The common ones are</p>\n<ul>\n<li><a href=\"https://github.com/uw-labs/bloomrpc\" rel=\"nofollow noreferrer\">BloomRPC</a></li>\n<li><a href=\"https://kreya.app/\" rel=\"nofollow noreferrer\">Kreya</a></li>\n<li><a href=\"https://github.com/rogchap/wombat\" rel=\"nofollow noreferrer\">Wombat</a></li>\n<li><a href=\"http://www.bytesmotion.com/fint/\" rel=\"nofollow noreferrer\">Fint</a></li>\n</ul>\n<p>With those 4 clients, you can dynamically call gRPC services.  However, if you are looking a test client that can also do load testing, Fint is the one you will need.</p>\n"}], "owner": {"reputation": 387, "user_id": 9066193, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3d2f6a45f7051b47fd307af792748ddd?s=128&d=identicon&r=PG&f=1", "display_name": "C J", "link": "https://stackoverflow.com/users/9066193/c-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11526, "favorite_count": 2, "answer_count": 5, "score": 6, "last_activity_date": 1615539682, "creation_date": 1513045547, "last_edit_date": 1513126051, "question_id": 47764448, "link": "https://stackoverflow.com/questions/47764448/how-to-test-grpc-apis", "title": "How to test gRPC APIs?", "body": "<p>I have been assigned to test a gRPC API (written in Golang) but I don't know how to go about testing it and I couldn't find any tutorials online for this type of testing. The only method that I can think of is to write unit tests to test the methods themselves but I would like to also test it with a client. For example, I have tested REST APIs in the past using JMeter as a client to send requests and verify the response data. Is there a method for testing gRPC APIs with a client or is unit testing the only way?</p>\n"}, {"tags": ["node.js", "file", "express", "go", "streaming"], "comments": [{"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 1, "creation_date": 1513032256, "post_id": 47761810, "comment_id": 82486701, "body": "If you just need a file <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow noreferrer\">http.FileServer()</a> will do most of work for ya. From node request it as any other file."}], "answers": [{"tags": [], "owner": {"reputation": 13013, "user_id": 2382650, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c7d1f30701e93afd6b330bb1f7479a6c?s=128&d=identicon&r=PG", "display_name": "Francisco Mateo", "link": "https://stackoverflow.com/users/2382650/francisco-mateo"}, "is_accepted": false, "score": 0, "last_activity_date": 1513109703, "creation_date": 1513109703, "answer_id": 47780824, "question_id": 47761810, "link": "https://stackoverflow.com/questions/47761810/streaming-file-from-golang-backend-to-node-frontend/47780824#47780824", "title": "Streaming file from Golang backend to Node frontend", "body": "<p>I haven't used the <code>request</code> library specifically, but essentially you need something like the following (judging from the <code>request</code> documentation):</p>\n\n<pre><code>const request = require('request')\n\n// ...\n\nrouter.get('/my-route', async (req, res) =&gt; {\n  const requestResponse = await request('...')\n  const binaryFile = Buffer.from(requestResponse.body, 'binary')\n\n  res.type(requestResponse.headers('content-type'))\n  res.end(binaryFile)\n})\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8219588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c65ace77450ced27cc9d135a21c46bd?s=128&d=identicon&r=PG&f=1", "display_name": "Yerlan", "link": "https://stackoverflow.com/users/8219588/yerlan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1024, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513109703, "creation_date": 1513028135, "question_id": 47761810, "link": "https://stackoverflow.com/questions/47761810/streaming-file-from-golang-backend-to-node-frontend", "title": "Streaming file from Golang backend to Node frontend", "body": "<p>I have set up a backend on <strong>Golang</strong> (wrapped in Gin gonic framework) and the frontend is run on <strong>NodeJS</strong> (wrapped in Express framework). Assume Express is to make a request to Golang backend to request a file, receive it back to Express and push to the client.</p>\n\n<p><strong>Frontend Node:</strong></p>\n\n<pre><code>var request = require('request');\n\nrouter.get('/testfile', function (req, res, next) {\n\n  // URL to Golang backend server\n  var filepath = 'http://127.0.0.1:8000/testfile';\n\n  request(filepath, function (error, response, body) {\n\n    // This is incorrect, as it's just rendering the body to the client as text\n    res.send(body);  \n\n  })\n\n});\n</code></pre>\n\n<p><strong>Backend Golang:</strong></p>\n\n<pre><code>r.GET(\"/testfile\", func(c *gin.Context) {\n\n    url := \"http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png\"\n\n    timeout := time.Duration(5) * time.Second\n    transport := &amp;http.Transport{\n        ResponseHeaderTimeout: timeout,\n        Dial: func(network, addr string) (net.Conn, error) {\n            return net.DialTimeout(network, addr, timeout)\n        },\n        DisableKeepAlives: true,\n    }\n    client := &amp;http.Client{\n        Transport: transport,\n    }\n    resp, err := client.Get(url)\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer resp.Body.Close()\n\n    c.Writer.Header().Set(\"Content-Disposition\", \"attachment; filename=Wiki.png\")\n    c.Writer.Header().Set(\"Content-Type\", c.Request.Header.Get(\"Content-Type\"))\n    c.Writer.Header().Set(\"Content-Length\", c.Request.Header.Get(\"Content-Length\"))\n\n    //stream the body to the client without fully loading it into memory\n    io.Copy(c.Writer, resp.Body)\n\n})\n</code></pre>\n\n<p>My question is: <strong>How do I properly request a file from Node to Golang, and render it back to the client, keeping the possibility of streaming file (if there would be a large file)?</strong></p>\n"}, {"tags": ["multithreading", "go", "synchronization", "memory-model"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1513027935, "post_id": 47761700, "comment_id": 82484906, "body": "WaitGroup wouldn&#39;t be very useful if it wasn&#39;t a synchronization primitive."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513027981, "post_id": 47761700, "comment_id": 82484933, "body": "It also wouldn&#39;t be in the <code>sync</code> package."}, {"owner": {"reputation": 3282, "user_id": 3102, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/debc1608fc160fb51ed0b07c9ad7739c?s=128&d=identicon&r=PG", "display_name": "Johannes Hoff", "link": "https://stackoverflow.com/users/3102/johannes-hoff"}, "edited": false, "score": 0, "creation_date": 1513028469, "post_id": 47761700, "comment_id": 82485197, "body": "Thanks for the comments. However, it doesn&#39;t really answer my question other than on an &quot;intuitive&quot; level. What is it about this code or the documentation that guarantees memory access won&#39;t be rearranged before/after the <code>WaitGroup</code> access?"}], "answers": [{"comments": [{"owner": {"reputation": 3282, "user_id": 3102, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/debc1608fc160fb51ed0b07c9ad7739c?s=128&d=identicon&r=PG", "display_name": "Johannes Hoff", "link": "https://stackoverflow.com/users/3102/johannes-hoff"}, "edited": false, "score": 0, "creation_date": 1513028265, "post_id": 47761753, "comment_id": 82485082, "body": "Where is it guaranteed that the compiler doesn&#39;t move memory access instructions before or after the <code>WaitGroup</code> functions?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 3282, "user_id": 3102, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/debc1608fc160fb51ed0b07c9ad7739c?s=128&d=identicon&r=PG", "display_name": "Johannes Hoff", "link": "https://stackoverflow.com/users/3102/johannes-hoff"}, "edited": false, "score": 0, "creation_date": 1513028392, "post_id": 47761753, "comment_id": 82485159, "body": "What do you mean? <code>WaitGroup</code> is internally synchronized, any code outside those functions is your responsibility."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1513028508, "post_id": 47761753, "comment_id": 82485214, "body": "<a href=\"https://golang.org/src/sync/waitgroup.go?s=3482:3518#L111\" rel=\"nofollow noreferrer\">golang.org/src/sync/waitgroup.go?s=3482:3518#L111</a>.  The package uses atomic loads and saves, which the runtime guarantees are synchronized.  If you call <code>&lt;waitgroup&gt;.Wait()</code>, memory operations that occur after that <i>cannot</i> be rearranged before the atomic load operation (and therefore before the <code>Wait()</code> call)."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1513028656, "post_id": 47761753, "comment_id": 82485270, "body": "Oh I understand, a guarantee that it won&#39;t move a memory op after the call to before the call. I believe @Kaedys is right here - the <code>sync&#47;atomic</code> calls act as a memory barrier. If it did not, <code>WaitGroup</code> would be useless (which it isn&#39;t)."}, {"owner": {"reputation": 3282, "user_id": 3102, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/debc1608fc160fb51ed0b07c9ad7739c?s=128&d=identicon&r=PG", "display_name": "Johannes Hoff", "link": "https://stackoverflow.com/users/3102/johannes-hoff"}, "edited": false, "score": 0, "creation_date": 1513028692, "post_id": 47761753, "comment_id": 82485286, "body": "@Adrian: I mean, the compiler is free to move instructions around as it pleases. Where is that guarantee codified? (edit: ok you got it while I was updating the answer)"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1513028973, "post_id": 47761753, "comment_id": 82485419, "body": "<a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"nofollow noreferrer\">golang.org/ref/mem#tmp_2</a> <code>Within a single goroutine, reads and writes must behave as if they executed in the order specified by the program.</code>.  That means that a memory operation that occurs <i>after</i> the atomic read memory operation MUST always function as if it occurred after that memory operation within the scope of a single goroutine (which is all the guarantee that a Waitgroup, or any synchronization primitive, makes anyway).  The compiler can move the operations around, but not enough to violate that constraint."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1513029362, "post_id": 47761753, "comment_id": 82485571, "body": "Kaedys beat me to it while I was searching the spec. Also note the &quot;Advice&quot; section at the same page Kaedys linked: &quot;If you must read the rest of this document to understand the behavior of your program, you are being too clever. Don&#39;t be clever.&quot; The <code>sync</code> and <code>sync&#47;atomic</code> packages work as advertised. If you can produce a scenario in which they don&#39;t, file a bug report. If you&#39;re really keen on learning exactly how it works behind-the-scenes, read the complete source of the compiler, <code>sync</code>, and <code>sync&#47;atomic</code>."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1513027919, "creation_date": 1513027919, "answer_id": 47761753, "question_id": 47761700, "link": "https://stackoverflow.com/questions/47761700/is-sync-waitgroup-a-synchronization-primitive/47761753#47761753", "title": "Is sync.WaitGroup a &quot;synchronization primitive&quot;?", "body": "<p><code>sync.WaitGroup</code> is synchronized. If you read the source, you'll see it uses <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"nofollow noreferrer\"><code>sync/atomic</code></a> to synchronize operations on the counters.</p>\n"}, {"tags": [], "owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "is_accepted": false, "score": 3, "last_activity_date": 1513033813, "last_edit_date": 1513033813, "creation_date": 1513031695, "answer_id": 47762546, "question_id": 47761700, "link": "https://stackoverflow.com/questions/47761700/is-sync-waitgroup-a-synchronization-primitive/47762546#47762546", "title": "Is sync.WaitGroup a &quot;synchronization primitive&quot;?", "body": "<p>If you go against wise <a href=\"https://golang.org/ref/mem#tmp_1\" rel=\"nofollow noreferrer\">advice</a> and follow turtles all the way down... </p>\n\n<p><a href=\"https://github.com/golang/go/blob/05deefee5227947b2239a4e1772cf738a320b09e/src/sync/waitgroup.go#L52\" rel=\"nofollow noreferrer\">wg.Add()</a> leads to line 63 which leads into <a href=\"https://github.com/golang/go/blob/05deefee5227947b2239a4e1772cf738a320b09e/src/sync/atomic/asm_amd64.s#L81\" rel=\"nofollow noreferrer\">atomic.AddUint64()</a> which leads to this assembly code:</p>\n\n<pre><code>LOCK\nXADDQ   AX, 0(BP)\n</code></pre>\n\n<p>On the other hand <a href=\"https://github.com/golang/go/blob/05deefee5227947b2239a4e1772cf738a320b09e/src/sync/waitgroup.go#L102\" rel=\"nofollow noreferrer\">wg.Wait()</a> leads to line 121 which leads to <a href=\"https://github.com/golang/go/blob/05deefee5227947b2239a4e1772cf738a320b09e/src/sync/atomic/asm_amd64.s#L53\" rel=\"nofollow noreferrer\">atomic.CompareAndSwapUint64()</a> which leads to:</p>\n\n<pre><code>LOCK\nCMPXCHGQ    CX, 0(BP)\n</code></pre>\n\n<p>And that is apparently how you build a <code>WaitGroup</code> :). With <strong>locked atomic exchange and add</strong> and <strong>locked atomic compare and exchange</strong>. Pretty conclusive to me. You cannot fight the assembler. OK maybe you can I cannot. </p>\n\n<p>On <a href=\"https://stackoverflow.com/questions/3339141/x86-lock-question-on-multi-core-cpus\">x86 locks</a></p>\n"}], "owner": {"reputation": 3282, "user_id": 3102, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/debc1608fc160fb51ed0b07c9ad7739c?s=128&d=identicon&r=PG", "display_name": "Johannes Hoff", "link": "https://stackoverflow.com/users/3102/johannes-hoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513033813, "creation_date": 1513027662, "question_id": 47761700, "link": "https://stackoverflow.com/questions/47761700/is-sync-waitgroup-a-synchronization-primitive", "title": "Is sync.WaitGroup a &quot;synchronization primitive&quot;?", "body": "<p>The <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">go memory model</a> document says</p>\n\n<blockquote>\n  <p>To serialize access, protect the data with channel operations or other synchronization primitives such as those in the sync and sync/atomic packages. </p>\n</blockquote>\n\n<p>And the <a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\">sync package</a> says</p>\n\n<blockquote>\n  <p>Package sync provides basic synchronization primitives such as mutual exclusion locks</p>\n</blockquote>\n\n<p>So from this we can conclude that <code>sync.Mutex</code> is a synchronization primitive. There's also a very strong hint that other types in that package are synchronization primitives. However, it doesn't say explicitly that e.g. <code>sync.WaitGroup</code> is.</p>\n\n<p>Reading the <a href=\"https://golang.org/src/sync/waitgroup.go\" rel=\"nofollow noreferrer\">source of WaitGroup</a>, I can't convince myself completely that memory operations won't be rearranged around <code>WaitGroup</code> functions (the same way I could with java's <code>synchronized</code> keyword for example). I <em>believe</em> it is serializing before/after, but how can I be sure.</p>\n\n<p>Is <code>sync.WaitGroup</code> a \"synchronization primitive\"? I'm not simply looking for the answer \"yes\" (or \"no\" for that matter), but pointers that can prove the case.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1513024120, "post_id": 47760840, "comment_id": 82482968, "body": "You&#39;re doing a lot in your code. At what exact point your expectations don&#39;t match the actual variable values?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513024270, "post_id": 47760840, "comment_id": 82483030, "body": "The <code>headers</code> field isn&#39;t exported, and a number of the fields don&#39;t match the key names in the json."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513026533, "post_id": 47760840, "comment_id": 82484212, "body": "Remove the spaces from your tags please: <code>json: &quot;User-Agent&quot;</code> and <code>json: &quot;Upgrade-Insecure-Requests&quot;</code> should be <code>json:&quot;User-Agent&quot;</code> and <code>json:&quot;Upgrade-Insecure-Requests&quot;</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513026943, "post_id": 47760840, "comment_id": 82484414, "body": "Also note that underscores in identifiers is considered bad practice in Go (linters will warn you about them). E.g. <code>Accept_Encoding</code> should be <code>AcceptEncoding</code>, etc. And mkopriva is correct, you cannot have spaces in struct tags (between the tag key and value, nor between comma-separated items in the value)."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513029766, "post_id": 47760840, "comment_id": 82485768, "body": "You seriously need to read the error messages, if you would, you would know that <code>&quot;1&quot;</code> is not a bool but a string in Go, and <code>json.Unmarshal</code> will not auto parse a string into a bool so you need to change the type of your field."}, {"owner": {"reputation": 19, "user_id": 9085556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b78a82a57b95be7555cdef8ed96313?s=128&d=identicon&r=PG&f=1", "display_name": "vetiv3r", "link": "https://stackoverflow.com/users/9085556/vetiv3r"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513059316, "post_id": 47760840, "comment_id": 82493871, "body": "@mkopriva If I use a type of string then nothing appears, seems that parser treats it as nil."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513070059, "post_id": 47760840, "comment_id": 82498830, "body": "@vetiv3r it does not treat it as <code>nil</code>, most probably your actual code is different from what you&#39;ve shared in the question  (maybe you have a typo somewhere or something). <a href=\"https://play.golang.org/p/AYYTFQb18U\" rel=\"nofollow noreferrer\">with bool</a> you get error, <a href=\"https://play.golang.org/p/om6vGHvsle\" rel=\"nofollow noreferrer\">with string</a> you get <code>&quot;1&quot;</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1513070227, "post_id": 47760840, "comment_id": 82498942, "body": "@vetiv3r also you should print the <code>body</code> to actually see if the header you want was in the response. Do <code>fmt.Printf(&quot;%s&quot;, body)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 0, "last_activity_date": 1513024445, "creation_date": 1513024445, "answer_id": 47760972, "question_id": 47760840, "link": "https://stackoverflow.com/questions/47760840/fetching-json-data-with-struct-in-go/47760972#47760972", "title": "Fetching json data with struct in Go", "body": "<p>Change your last line to</p>\n\n<pre><code>fmt.Printf(\"%+v\\n\", head)\n</code></pre>\n\n<p>to see all of your fields. As you can see all of strings are empty. It's because in <code>Headers</code> struct <code>headers</code> field is not exported (first letter must be capital) and no data will be unmarshaled into it. Also some fields name don't match the data in <code>http://httpbin.org/headers</code>.</p>\n\n<p>For example change <code>Accept_Encoding</code> field in struct as follows:</p>\n\n<pre><code>    Accept_Encoding string `json:\"Accept-Encoding\"`\n</code></pre>\n\n<p>to read from <code>Accept-Encoding</code> instead of <code>Accept_Encoding</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513026825, "post_id": 47760990, "comment_id": 82484358, "body": "You do not have to tag them with JSON names if the only difference is case. The tag on <code>Headers</code> is unnecessary for unmarshalling."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513027683, "post_id": 47760990, "comment_id": 82484790, "body": "@Adrian very cool, I didn&#39;t know that! I&#39;ll update my answer. Thanks for the tip."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513028279, "post_id": 47760990, "comment_id": 82485091, "body": "It&#39;s in the docs for <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>Unmarshal</code></a>: &quot;To unmarshal JSON into a struct, Unmarshal matches incoming object keys to the keys used by Marshal (either the struct field name or its tag), preferring an exact match but also accepting a case-insensitive match. Unmarshal will only set exported fields of the struct.&quot;"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513028388, "post_id": 47760990, "comment_id": 82485154, "body": "Sure enough. Clearly I didn&#39;t read docs closely enough the first time around =D"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1513093944, "last_edit_date": 1513093944, "creation_date": 1513024509, "answer_id": 47760990, "question_id": 47760840, "link": "https://stackoverflow.com/questions/47760840/fetching-json-data-with-struct-in-go/47760990#47760990", "title": "Fetching json data with struct in Go", "body": "<p>A couple of issues here, first you must export the \"HttpHeaders\" field of the \"Headers\" struct, and second, you must tag the fields with JSON names if their JSON key isn't the same (case insensitive):</p>\n\n<pre><code>type Headers struct {\n  // The \"Headers\" member must have a capital \"H\" so that the\n  // JSON marshaler knows that it can be de/serialized.\n  Headers HttpHeaders\n}\n\ntype HttpHeaders {\n  Accept          string\n  // Since the JSON key is the same as the field name we don't need a tag.\n  Accept_Encoding string `json:\"Accept-Encoding\"`\n  // Here we need a tag since the member name cannot contain a dash.\n  // ...\n}\n</code></pre>\n\n<p>Note that the \"Headers\" field of the \"Headers\" struct doesn't need a JSON tag because the unmarshaler ignores capitalization when matching JSON document keys to go struct field names. That is, the \"Header\" field would be populated by the JSON key <code>\"header\"</code>, or <code>\"Header\"</code>, or even <code>\"HEADER\"</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 9085556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92b78a82a57b95be7555cdef8ed96313?s=128&d=identicon&r=PG&f=1", "display_name": "vetiv3r", "link": "https://stackoverflow.com/users/9085556/vetiv3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513093944, "creation_date": 1513023898, "last_edit_date": 1513027201, "question_id": 47760840, "link": "https://stackoverflow.com/questions/47760840/fetching-json-data-with-struct-in-go", "title": "Fetching json data with struct in Go", "body": "<p>I am facing a rather simple problem in Go since I am totally new to it. I want to fetch and print data from a REST api. the code I have written: </p>\n\n<pre><code>package main\n\nimport (\n  _\"bytes\"\n  \"encoding/json\"\n  \"fmt\"\n  \"io/ioutil\"\n  \"net/http\"\n)\n\ntype Headers struct {\n  Headers HttpHeaders `json:\"headers\"`\n}\n\ntype HttpHeaders struct {\n  Accept string\n  Accept_Encoding string `json:\"Accept-Encoding\"`\n  Accept_Language string `json:\"Accept-Language\"`\n  Connection string\n  Cookie string\n  Host string\n  Referer string\n  Upgrade_Insecure_Requests bool `json:\"Upgrade-Insecure-Requests\"`\n  User_Agent string `json:\"User-Agent\"`\n}\n\n\nfunc main() {\n  url := \"http://httpbin.org/headers\"\n  res, err := http.Get(url)\n  if err != nil {\n    panic(err)\n  }\n  defer res.Body.Close()\n\n  body, err := ioutil.ReadAll(res.Body)\n  if err != nil {\n    panic(err)\n  }\n  var head Headers\n  err = json.Unmarshal(body, &amp;head)\n  if err != nil {\n    panic(err)\n  }\n  fmt.Printf(\"%+v\\n\", head)\n\n\n}\n</code></pre>\n\n<p>After the adjustments I made, the response looks like: </p>\n\n<pre><code>{Headers:{Accept: Accept_Encoding:gzip Accept_Language: Connection:close Cookie: Host:httpbin.org Referer: Upgrade_Insecure_Requests:false User_Agent:}}\n</code></pre>\n\n<p>I have still some fields without a value and the value in Upgrade_Insecure_requests does not seem to match the one that is returned via the API.</p>\n\n<p>2nd edit: \nRemoved the spaces in the tags. The response now still looks not good. </p>\n\n<pre><code>{Headers:{Accept: Accept_Encoding:gzip Accept_Language: Connection:close Cookie: Host:httpbin.org Referer: Upgrade_Insecure_Requests:false User_Agent:Go-http-client/1.1}}\n</code></pre>\n\n<p>The Upgrade_insecure_Requests is still 0 instead of 1 and the other fields are still blank.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1513017532, "post_id": 47759210, "comment_id": 82479766, "body": "Go does not do this kind of string interpolation. Take a look at the <a href=\"https://golang.org/pkg/fmt\" rel=\"nofollow noreferrer\"><code>fmt</code></a> and <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>template</code></a> packages for potential solutions."}, {"owner": {"reputation": 601, "user_id": 4713933, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/93Ht5.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4713933/mark-smith"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513017976, "post_id": 47759210, "comment_id": 82479971, "body": "@Adrian Thank you - I seem to be trying to use a Python way of thinking on this which is getting me nowhere - I will check fmt and template for solutions"}], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 4713933, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/93Ht5.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4713933/mark-smith"}, "edited": false, "score": 0, "creation_date": 1513018129, "post_id": 47759357, "comment_id": 82480043, "body": "Thank you Cerise, I seem to be stuck using a Python way of thinking on this - I will try using your suggestion (and also see Effective Go...) and come back to you..."}, {"owner": {"reputation": 601, "user_id": 4713933, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/93Ht5.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4713933/mark-smith"}, "edited": false, "score": 0, "creation_date": 1513018412, "post_id": 47759357, "comment_id": 82480204, "body": "Excellent - this works as needed and I now see where I was going wrong - thank you for your help!"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 601, "user_id": 4713933, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/93Ht5.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4713933/mark-smith"}, "edited": false, "score": 1, "creation_date": 1513018544, "post_id": 47759357, "comment_id": 82480266, "body": "fmt.Sprintf is very similar to Python&#39;s string format method: <code>body = &quot;Timestamp,{:d}&quot;.format(TimeNow)</code>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1513017906, "creation_date": 1513017906, "answer_id": 47759357, "question_id": 47759210, "link": "https://stackoverflow.com/questions/47759210/inserting-a-variable-within-a-double-quoted-string/47759357#47759357", "title": "Inserting a variable within a double quoted string", "body": "<p>Use the <code>fmt</code> package: <code>body := fmt.Sprintf(\"Timestamp,%d\", TimeNow)</code></p>\n\n<p>The string() conversion converts an integer to a string, but not in the way you think. </p>\n\n<p>See Effective Go for an <a href=\"https://golang.org/doc/effective_go.html#printing\" rel=\"noreferrer\">introduction to formatting and printing strings</a>.</p>\n"}], "owner": {"reputation": 601, "user_id": 4713933, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/93Ht5.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4713933/mark-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2518, "favorite_count": 0, "accepted_answer_id": 47759357, "answer_count": 1, "score": 0, "last_activity_date": 1513090991, "creation_date": 1513017350, "last_edit_date": 1513090991, "question_id": 47759210, "link": "https://stackoverflow.com/questions/47759210/inserting-a-variable-within-a-double-quoted-string", "title": "Inserting a variable within a double quoted string", "body": "<p>Please forgive the newbie Golang question, I am coming at this having basic Python expereince:</p>\n\n<p>I am trying to workout how to insert a string variable, within a variable named body, which is used within an AMQP library further on in my program.</p>\n\n<p>body expects a string value which is enclosed within double quotes. For example:</p>\n\n<pre><code>body := \"This messages contains,variable1\"\n</code></pre>\n\n<p>In my program I am creating a variable as an int64 data type and converting it to a string.</p>\n\n<pre><code>    ...\n    TimeNow := currentEpochTime()     // Sets TimeNow to an int64 epoch timestamp\n    variable1:= string(TimeNow)       // Converts TimeNow to a string\n</code></pre>\n\n<p>I am trying to insert variable1 after \"This messages contains, -\n        and then enclose it with \" - so that something like the below is passed to the AMQP library via the body variable.</p>\n\n<pre><code>    body := \"Timestamp,1513011846048\"\n</code></pre>\n\n<p>Can you give any pointers on how to do this - this may also be useful for other Go newbies going forward...</p>\n"}, {"tags": ["go", "composition", "behavior-tree"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513014377, "post_id": 47758412, "comment_id": 82478144, "body": "In your example of usage, <code>test</code> is assigned to <code>tree.Root</code> but <code>test</code> is not defined. What is it and where is it coming from?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1513014633, "post_id": 47758412, "comment_id": 82478272, "body": "Go has absolutely no notion of inheritance (embedding is not inheritance) and you simply cannot do parent/child stuff in Go. Redesign."}, {"owner": {"reputation": 117, "user_id": 1715816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a9b11c53cb80e788dfb35fc87813921?s=128&d=identicon&r=PG", "display_name": "Felipe Rocha", "link": "https://stackoverflow.com/users/1715816/felipe-rocha"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513015435, "post_id": 47758412, "comment_id": 82478640, "body": "@Adrian Added that information."}, {"owner": {"reputation": 117, "user_id": 1715816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a9b11c53cb80e788dfb35fc87813921?s=128&d=identicon&r=PG", "display_name": "Felipe Rocha", "link": "https://stackoverflow.com/users/1715816/felipe-rocha"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1513015533, "post_id": 47758412, "comment_id": 82478696, "body": "@Volker I get that, but I was here because I got stuck in trying to find that design since I&#39;m not used to this way of designing code. It would be illuminating if you could help a bit more instead of just saying &quot;Redesign,&quot; which doesn&#39;t help at all."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1513016087, "post_id": 47758412, "comment_id": 82478998, "body": "There is no inheritance, but composition does allow for parent/child relationships; not sure what @Volker is getting at here. Regardless, in your usage example, it still does not show how the variable <code>test</code> assigned to <code>tree.Root</code> is created. Is it supposed to be <code>tree.Root = n1</code> maybe?"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 1, "creation_date": 1513016270, "post_id": 47758412, "comment_id": 82479090, "body": "@FelipeRocha it&#39;s a fine question, don&#39;t mind the downvotes. For some reason the golang community on this site aggressively downvotes questions, often regardless of their validity. Maybe try reducing your question down to a standalone example in a single function (e.g. that doesn&#39;t require multiple files)."}, {"owner": {"reputation": 117, "user_id": 1715816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a9b11c53cb80e788dfb35fc87813921?s=128&d=identicon&r=PG", "display_name": "Felipe Rocha", "link": "https://stackoverflow.com/users/1715816/felipe-rocha"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513016947, "post_id": 47758412, "comment_id": 82479443, "body": "@Adrian Oh! Sorry! Typo! <code>n1</code> is supposed to read <code>test</code>. I&#39;ll fix it!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1513016987, "post_id": 47758412, "comment_id": 82479465, "body": "See also <a href=\"https://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method\" title=\"go embedded struct call child method instead parent method\">stackoverflow.com/questions/29390736/&hellip;</a>, and <a href=\"https://stackoverflow.com/questions/45974464/how-to-call-parent-method-and-pass-any-child-that-extending-the-parent-struct-as\" title=\"how to call parent method and pass any child that extending the parent struct as\">stackoverflow.com/questions/45974464/&hellip;</a>"}, {"owner": {"reputation": 117, "user_id": 1715816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a9b11c53cb80e788dfb35fc87813921?s=128&d=identicon&r=PG", "display_name": "Felipe Rocha", "link": "https://stackoverflow.com/users/1715816/felipe-rocha"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1513017094, "post_id": 47758412, "comment_id": 82479512, "body": "@maerics Yeah, it&#39;s not the first time I run into the downvotes, which is why I asked. Sorry, but I already tried to distill it to its basics! Anything less than this, and the question won&#39;t make much sense..."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1513017273, "post_id": 47758412, "comment_id": 82479631, "body": "Unfortunately it already doesn&#39;t make much sense; the structure is so convoluted and complicated it&#39;s hard to quickly trace execution. This is the benefit of distilling it down to <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> - oftentimes the problem reveals itself when you remove some of the unnecessary complexity."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1513019926, "post_id": 47758412, "comment_id": 82480929, "body": "@FelipeRocha I think you can still simplify your question, there are several lines of code that aren&#39;t relevant to the issue (type Status, code listings, unused interface methods, etc). The problem domain doesn&#39;t matter here, only the specifics of interfaces, composition, and dynamic dispatch."}, {"owner": {"reputation": 117, "user_id": 1715816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a9b11c53cb80e788dfb35fc87813921?s=128&d=identicon&r=PG", "display_name": "Felipe Rocha", "link": "https://stackoverflow.com/users/1715816/felipe-rocha"}, "edited": false, "score": 0, "creation_date": 1513025072, "post_id": 47758412, "comment_id": 82483475, "body": "Sorry. I was at work, and waiting for lunch to come back to this. I removed all the extraneous information to help clarify the ask"}], "answers": [{"tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 0, "last_activity_date": 1513027520, "creation_date": 1513027520, "answer_id": 47761670, "question_id": 47758412, "link": "https://stackoverflow.com/questions/47758412/calling-childs-method-from-parents-implementation-method-in-golang/47761670#47761670", "title": "Calling child&#39;s method from parent&#39;s implementation method in golang", "body": "<p>As Volker said </p>\n\n<blockquote>\n  <p>Go has absolutely no notion of inheritance (embedding is not inheritance) and you simply cannot do parent/child stuff in Go. Redesign</p>\n</blockquote>\n\n<p>What you want as far as I can tell is a function which uses an interface to perform the same task multiple times. </p>\n\n<pre><code>func Tick(n IBehavior) Status {\n  fmt.Println(\"ticking!\")\n  if n.Status != RUNNING { n.Initialize() }\n  status := n.Update()\n  if n.Status != RUNNING { n.Terminate(status) }\n  return status\n}\n</code></pre>\n\n<p>Of course Initialize will then have to be in the interface. </p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 1715816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a9b11c53cb80e788dfb35fc87813921?s=128&d=identicon&r=PG", "display_name": "Felipe Rocha", "link": "https://stackoverflow.com/users/1715816/felipe-rocha"}, "edited": false, "score": 0, "creation_date": 1513029633, "post_id": 47761819, "comment_id": 82485690, "body": "Interesting. I was trying to avoid redefining that behavior... Is there really no way around it?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 117, "user_id": 1715816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a9b11c53cb80e788dfb35fc87813921?s=128&d=identicon&r=PG", "display_name": "Felipe Rocha", "link": "https://stackoverflow.com/users/1715816/felipe-rocha"}, "edited": false, "score": 0, "creation_date": 1513031917, "post_id": 47761819, "comment_id": 82486590, "body": "You could embed an interface that defines the method and call that.  But no, there&#39;s no way to call a method of a &quot;child&quot; object, and then have that &quot;child&quot; object call a method of the &quot;parent&quot; object, unless you have circular references (ie. the child has a handle for the parent as well).  From an embedding perspective, the general solution is to have a structure that defines the external methods, and it embeds or more commonly simply has a field for an interface that holds the method you want to dynamically define."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 2, "last_activity_date": 1513028175, "creation_date": 1513028175, "answer_id": 47761819, "question_id": 47758412, "link": "https://stackoverflow.com/questions/47758412/calling-childs-method-from-parents-implementation-method-in-golang/47761819#47761819", "title": "Calling child&#39;s method from parent&#39;s implementation method in golang", "body": "<p>Your issue here is that <code>Tick()</code> is not defined on your BehaviorTree structure.  As a result, when you call <code>tree.Tick()</code>, there's no direct method defined, so it calls the promoted <code>Tick()</code> method of the embedded <code>Behavior</code> struct.  That <code>Behavior</code> struct <em>has no idea what a <code>BehaviorTree</code> is!</em>  In Go\u2019s embedding style of pseudo-inheritance, \u201cchild\u201d types have no concept of their \"parents\", nor any reference or access to them.  Embedded methods are called with the <em>embedded type</em> as their receiver, not the embedding struct.</p>\n\n<p>If you want your expected behavior, you need to define a <code>Tick()</code> method on your <code>BehaviorTree</code> type, and have that method to call its own <code>Update()</code> method (and then call sub <code>Tick()</code> or <code>Update()</code> methods if you wish).  For example:</p>\n\n<pre><code>type BehaviorTree struct {\n  Behavior\n\n  Root IBehavior\n}\n\nfunc (n *BehaviorTree) Tick() Status {\n    n.Update() // TODO: do you want this status or the Root.Tick() status?\n    return n.Root.Tick()\n}\n\nfunc (n *BehaviorTree) Update() Status {\n  fmt.Printf(\"Tree tick! %#v\\n\", n.Root)\n  return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 1715816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6a9b11c53cb80e788dfb35fc87813921?s=128&d=identicon&r=PG", "display_name": "Felipe Rocha", "link": "https://stackoverflow.com/users/1715816/felipe-rocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "accepted_answer_id": 47761819, "answer_count": 2, "score": 4, "last_activity_date": 1572979968, "creation_date": 1513014088, "last_edit_date": 1572979968, "question_id": 47758412, "link": "https://stackoverflow.com/questions/47758412/calling-childs-method-from-parents-implementation-method-in-golang", "title": "Calling child&#39;s method from parent&#39;s implementation method in golang", "body": "<p>I'm trying to implement a behavior tree in go, and I'm struggling with its composition features. Basically, I need <code>Tick()</code> implemented below to call the method defined by wherever it was embedded.</p>\n\n<p>Here is <code>behavior.go</code>:</p>\n\n<pre><code>type IBehavior interface {\n  Tick() Status\n  Update() Status\n}\n\ntype Behavior struct {\n  Status Status\n}\n\nfunc (n *Behavior) Tick() Status {\n  fmt.Println(\"ticking!\")\n  if n.Status != RUNNING { n.Initialize() }\n  status := n.Update()\n  if n.Status != RUNNING { n.Terminate(status) }\n\n  return status\n}\n\nfunc (n *Behavior) Update() Status {\n  fmt.Println(\"This update is being called\")\n  return n.Status\n}\n</code></pre>\n\n<p>And here is the <code>Behavior</code> struct being embedded:</p>\n\n<pre><code>type IBehaviorTree interface {\n  IBehavior\n}\n\ntype BehaviorTree struct {\n  Behavior\n\n  Root IBehavior\n}\n\nfunc (n *BehaviorTree) Update() Status {\n  fmt.Printf(\"Tree tick! %#v\\n\", n.Root)\n  return n.Root.Tick()\n}\n</code></pre>\n\n<p>A few more files to make this example make sense:</p>\n\n<pre><code>type ILeaf interface {\n  IBehavior\n}\n\ntype Leaf struct {\n  Behavior\n}\n</code></pre>\n\n<p>And this one:</p>\n\n<pre><code>type Test struct {\n  Leaf\n\n  Status Status\n}\n\nfunc NewTest() *Test {\n    return &amp;Test{}\n}\n\nfunc (n Test) Update() Status {\n    fmt.Println(\"Testing!\")\n    return SUCCESS\n}\n</code></pre>\n\n<p>And here is an example of its usage:</p>\n\n<pre><code>tree := ai.NewBehaviorTree()\ntest := ai.NewTest()\ntree.Root = test\n\ntree.Tick()\n</code></pre>\n\n<p>I was expecting the tree to tick normally by printing this:</p>\n\n<pre><code>ticking!\nTree tick!\n</code></pre>\n\n<p>But instead I'm getting:</p>\n\n<pre><code>ticking!\nThis update is being called\n</code></pre>\n\n<p>Could anyone help me with this issue?</p>\n\n<p>Edit: Added a few extra files to illuminate the issue. Also, I don't understand the downvotes. I have an honest go question. Am I only supposed to ask questions that make sense to me already?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1513021449, "post_id": 47758359, "comment_id": 82481699, "body": "In addition to what the answers recommend, you can also convert a valid timestamp string into a <code>timestamp</code> or <code>timestamptz</code> in the postgres query like so <code>&#39;2006-01-02T15:04:05Z07:00&#39;::timestamp</code> / <code>&#39;2006-01-02T15:04:05Z07:00&#39;::timestamptz</code>, works also with placeholders <code>$2::timestamp</code>... Just make sure the timestamp string has a format that is accepted by postgres, the one in your example <b>is not</b>."}, {"owner": {"reputation": 1988, "user_id": 6716410, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbA3G.png?s=128&g=1", "display_name": "sf9v", "link": "https://stackoverflow.com/users/6716410/sf9v"}, "edited": false, "score": 0, "creation_date": 1513045139, "post_id": 47758359, "comment_id": 82490166, "body": "this might help <a href=\"https://www.postgresql.org/docs/9.1/static/datatype-datetime.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/9.1/static/datatype-datetime.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 6, "last_activity_date": 1513015698, "creation_date": 1513015698, "answer_id": 47758807, "question_id": 47758359, "link": "https://stackoverflow.com/questions/47758359/how-to-store-golang-time-time-in-postgresql-timestamp/47758807#47758807", "title": "How to store Golang time.time in Postgresql timestamp?", "body": "<p>The pq driver (which I assume you are using) automatically converts time.Time instances correctly for you.</p>\n\n<p>so, you can do:</p>\n\n<pre><code>db.Exec(`INSERT INTO \"UserAccount\" (\"email\", \"login_time\") VALUES ($1, $2)`,\"human@example.com\",time.Now())\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 7, "creation_date": 1513028746, "post_id": 47758818, "comment_id": 82485317, "body": "Note that Postgres does not support the <code>?</code> placeholder.  You must use <code>$1</code> and <code>$2</code>, or use something like <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">sqlx</a>&#39;s <code>Rebind()</code> function."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 16, "last_activity_date": 1513028767, "last_edit_date": 1513028767, "creation_date": 1513015743, "answer_id": 47758818, "question_id": 47758359, "link": "https://stackoverflow.com/questions/47758359/how-to-store-golang-time-time-in-postgresql-timestamp/47758818#47758818", "title": "How to store Golang time.time in Postgresql timestamp?", "body": "<p>Instead of manually building the query string you should use <a href=\"https://golang.org/pkg/database/sql/#DB.Exec\" rel=\"noreferrer\"><code>sql#DB.Exec(...)</code></a> with placeholder parameters so that the database driver properly escapes the values for you. Doing it this way is a best-practice, especially to avoid security errors such as <a href=\"https://en.wikipedia.org/wiki/SQL_injection\" rel=\"noreferrer\">SQL injection</a>.</p>\n\n<pre><code>email, loginTime := \"human@example.com\", time.Now()\nresult, err := db.Exec(\"INSERT INTO UserAccount VALUES ($1, $2)\", email, loginTime)\nif err != nil {\n  panic(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 1867, "user_id": 5281215, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/10153631051339031/picture?type=large", "display_name": "Boo Yan Jiong", "link": "https://stackoverflow.com/users/5281215/boo-yan-jiong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20270, "favorite_count": 1, "answer_count": 2, "score": 12, "last_activity_date": 1513028767, "creation_date": 1513013904, "question_id": 47758359, "link": "https://stackoverflow.com/questions/47758359/how-to-store-golang-time-time-in-postgresql-timestamp", "title": "How to store Golang time.time in Postgresql timestamp?", "body": "<p>May I know how to store the <code>time.time</code> object in Postgresql?</p>\n\n<p>For example, the SQL query:</p>\n\n<p><code>INSERT INTO \"UserAccount\" (\"email\", \"login_time\") VALUES ('human@example.com', 2017-12-12 00:58:26.9589451 +0800 +08 m=+1406.914186601)</code></p>\n\n<p>I tried to use <code>loginTime := time.Now()</code>, and it gives a time format that Postgresql don't really understand, e.g. <em>2017-12-12 00:58:26.9589451 +0800 +08 m=+1406.914186601</em></p>\n\n<p>But if I try to use <code>loginTime := time.Now().Format(time.RFC3339)</code>, and the compiler complain that <code>loginTime</code> is a <code>string</code>, and I need it to be <code>time.time</code> type.</p>\n\n<p>May I know how to handle this?</p>\n\n<p><em>Sorry for asking newbie question, new to both Golang and Postgres. :)</em></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 7496749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ij7XNtbUPqw/AAAAAAAAAAI/AAAAAAAABGQ/bpdn80GLhEs/photo.jpg?sz=128", "display_name": "Deepak Sah", "link": "https://stackoverflow.com/users/7496749/deepak-sah"}, "edited": false, "score": 1, "creation_date": 1580294451, "post_id": 47758259, "comment_id": 106047574, "body": "&quot;When you redeclare a variable, it is a different variable. &quot; This is true only if the scope is different. When we redeclare a variable in the same scope, it just assigns a new value to the original."}, {"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "reply_to_user": {"reputation": 267, "user_id": 7496749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ij7XNtbUPqw/AAAAAAAAAAI/AAAAAAAABGQ/bpdn80GLhEs/photo.jpg?sz=128", "display_name": "Deepak Sah", "link": "https://stackoverflow.com/users/7496749/deepak-sah"}, "edited": false, "score": 1, "creation_date": 1580830415, "post_id": 47758259, "comment_id": 106222656, "body": "According to the spec: &quot;No identifier may be declared twice in the same block.&quot; So you are correct, it is the same variable, but that is because it cannot be redeclared. When a variable is redeclared, it is always done within an inner block (new scope). In this case, the new scope is the if statement."}], "tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1513014030, "last_edit_date": 1513014030, "creation_date": 1513013535, "answer_id": 47758259, "question_id": 47758154, "link": "https://stackoverflow.com/questions/47758154/redeclare-a-variable-for-convenience-in-golang/47758259#47758259", "title": "Redeclare a variable for convenience in golang?", "body": "<p>You did redeclare the variable, that is the problem. When you redeclare a variable, it is a different variable. This is known as \"shadowing\".</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n\n    // original a.\n    var a bool\n    var b interface{}\n    b = true\n    // redeclared a here. This is a a'\n    if a, ok := b.(bool); !ok {\n        // a' will last until the end of this block\n        fmt.Println(\"Problem!\")\n    }\n    // a' is gone. So using a here would get the original a.\n}\n</code></pre>\n\n<hr>\n\n<p>As for your second question. That code looks great. I would probably switch it to if err == nil (and swap the if and else blocks). But that is a style thing.</p>\n"}, {"comments": [{"owner": {"reputation": 8455, "user_id": 850326, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cd6f8a1a0f5957695e1d9625868d2642?s=128&d=identicon&r=PG", "display_name": "djhaskin987", "link": "https://stackoverflow.com/users/850326/djhaskin987"}, "edited": false, "score": 0, "creation_date": 1513024001, "post_id": 47759588, "comment_id": 82482917, "body": "I suppose that is a bit shorter, using short decls outside the if."}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 5, "last_activity_date": 1513018699, "creation_date": 1513018699, "answer_id": 47759588, "question_id": 47758154, "link": "https://stackoverflow.com/questions/47758154/redeclare-a-variable-for-convenience-in-golang/47759588#47759588", "title": "Redeclare a variable for convenience in golang?", "body": "<p>This is happening because you are using the short variable declaration in an <code>if</code> initialization statement, which introduces a new scope.</p>\n\n<p>Rather than this, where <code>a</code> is a new variable that shadows the existing one:</p>\n\n<pre><code>if a, ok := b.(bool); !ok {\n    fmt.Println(\"Problem!\")\n}\n</code></pre>\n\n<p>you could do this, where <code>a</code> is redeclared:</p>\n\n<pre><code>a, ok := b.(bool)\nif !ok {\n    fmt.Println(\"Problem!\")\n}\n</code></pre>\n\n<p>This works because <code>ok</code> is a new variable, so you can redeclare <code>a</code> and the passage you quoted is in effect.</p>\n\n<p>Similarly, your second code snippet could be written as:</p>\n\n<pre><code>A, err := SomeFunc()\nif err != nil {\n    return err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1549578233, "creation_date": 1549578233, "answer_id": 54583232, "question_id": 47758154, "link": "https://stackoverflow.com/questions/47758154/redeclare-a-variable-for-convenience-in-golang/54583232#54583232", "title": "Redeclare a variable for convenience in golang?", "body": "<p>The error raised by the compiler is saying that both declarations of variable <code>a</code> are not being used.\nYou're actually declaring <code>a</code> twice, when using short declaration in the <code>if</code> condition you're creating a new scope that shadows the previous declaration of the variable.</p>\n\n<p>The actual problem you're facing is that you're never using the variable value which, in Go, is considered a compile time error.</p>\n\n<hr>\n\n<p>Regarding your second question, I think that the shortest way to get the value and check the error is to do something similar to this:</p>\n\n<pre><code>func main() {\n    a, ok := someFunction()\n    if !ok {\n        fmt.Println(\"Problem!\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8455, "user_id": 850326, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cd6f8a1a0f5957695e1d9625868d2642?s=128&d=identicon&r=PG", "display_name": "djhaskin987", "link": "https://stackoverflow.com/users/850326/djhaskin987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2462, "favorite_count": 0, "accepted_answer_id": 47759588, "answer_count": 3, "score": 1, "last_activity_date": 1549578233, "creation_date": 1513013148, "question_id": 47758154, "link": "https://stackoverflow.com/questions/47758154/redeclare-a-variable-for-convenience-in-golang", "title": "Redeclare a variable for convenience in golang?", "body": "<p>This code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n\n    var a bool\n    var b interface{}\n    b = true\n    if a, ok := b.(bool); !ok {\n        fmt.Println(\"Problem!\")\n    }\n}\n</code></pre>\n\n<p>Yields this error in the golang playground:</p>\n\n<pre><code>tmp/sandbox791966413/main.go:11:10: a declared and not used\ntmp/sandbox791966413/main.go:14:21: a declared and not used\n</code></pre>\n\n<p>This is confusing because of what we read in the short variable declaration <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">golang docs</a>:</p>\n\n<blockquote>\n  <p>Unlike regular variable declarations, a short variable declaration may\n  redeclare variables provided they were originally declared earlier in\n  the same block (or the parameter lists if the block is the function\n  body) with the same type, and at least one of the non-blank variables\n  is new. As a consequence, redeclaration can only appear in a\n  multi-variable short declaration. Redeclaration does not introduce a\n  new variable; it just assigns a new value to the original.</p>\n</blockquote>\n\n<p>So, my questions:</p>\n\n<ol>\n<li>Why can't I redeclare the variable in the code snippet above?</li>\n<li><p>Supposing I really can't, what I'd <em>really</em> like to do is find\na way to populate variables with the output of functions while\nchecking the error in a more concise way. So <strong>is there any way \nto improve on the following form for getting a value out of an\nerror-able function?</strong></p>\n\n<pre><code>var A RealType\nif newA, err := SomeFunc(); err != nil {\n    return err\n} else {\n    A = newA\n}   \n</code></pre></li>\n</ol>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 377, "user_id": 2214818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/904dfd8f939241f50c468d2f27b25bd0?s=128&d=identicon&r=PG", "display_name": "Tiega", "link": "https://stackoverflow.com/users/2214818/tiega"}, "edited": false, "score": 2, "creation_date": 1512999550, "post_id": 47754090, "comment_id": 82468923, "body": "try &lt;link href=&quot;/resources/css/gwall.css&quot; type=&quot;text/css&quot; rel=&quot;stylesheet&quot;&gt;"}, {"owner": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "edited": false, "score": 0, "creation_date": 1512999691, "post_id": 47754090, "comment_id": 82469011, "body": "Hi, the issue might be in the way the mux is routing your requests. Try and remove the root handler, using instead another URI than &quot;/&quot; like <code>swall.HandleFunc(&quot;&#47;app&quot;, handler)</code> or removing the trailing slash from resources like <code>swall.Handle(&quot;&#47;resources&quot;, http.FileServer(http.Dir(&quot;resources&quot;))</code>"}, {"owner": {"reputation": 377, "user_id": 2214818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/904dfd8f939241f50c468d2f27b25bd0?s=128&d=identicon&r=PG", "display_name": "Tiega", "link": "https://stackoverflow.com/users/2214818/tiega"}, "reply_to_user": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "edited": false, "score": 1, "creation_date": 1512999972, "post_id": 47754090, "comment_id": 82469197, "body": "@FrancescoGualazzi He wrote that the http-server is delivering the file. What MIME-Type is the server serving? you can check in the chrome-dev network tab."}, {"owner": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "edited": false, "score": 0, "creation_date": 1512999981, "post_id": 47754090, "comment_id": 82469203, "body": "Took out the type=&quot;text/css&quot; as it was causing an error."}, {"owner": {"reputation": 377, "user_id": 2214818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/904dfd8f939241f50c468d2f27b25bd0?s=128&d=identicon&r=PG", "display_name": "Tiega", "link": "https://stackoverflow.com/users/2214818/tiega"}, "edited": false, "score": 0, "creation_date": 1513000087, "post_id": 47754090, "comment_id": 82469274, "body": "@user2592525 So like i guessed its a MIME-Type issue. Try to solve that rather then removing the type."}, {"owner": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "reply_to_user": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "edited": false, "score": 0, "creation_date": 1513000330, "post_id": 47754090, "comment_id": 82469429, "body": "@FrancescoGualazzi I tried your suggestions but no joy."}, {"owner": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "edited": false, "score": 0, "creation_date": 1513000492, "post_id": 47754090, "comment_id": 82469521, "body": "Thanks you, Tiega!  That fixed it!  I can live with a warning/"}, {"owner": {"reputation": 6022, "user_id": 468495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vRQn6.jpg?s=128&g=1", "display_name": "Vinay Pai", "link": "https://stackoverflow.com/users/468495/vinay-pai"}, "edited": false, "score": 1, "creation_date": 1513017213, "post_id": 47754090, "comment_id": 82479595, "body": "You&#39;re missing rel=&quot;stylesheet&quot;"}], "owner": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512999068, "creation_date": 1512999068, "question_id": 47754090, "link": "https://stackoverflow.com/questions/47754090/css-is-not-used-by-template", "title": "CSS is not used by template", "body": "<p>I'm using a template that links to a CSS file, and following some other posts on this board, I think I have everything correct, but the CSS is still not being applied.  Also, when I use the Developer tools in Chrome is see the link to the CSS file as I put in in the template, and if I click on it, it takes me to the CSS file, which I assume shows me it can find the file. </p>\n\n<p>Go code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"os\"\n    \"text/template\"\n    \"net/http\"\n)\n\nvar tpl *template.Template\n\nfunc init() {\n    tpl = template.Must(template.ParseGlob(\"templates/*\"))\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    host, _ := os.Hostname()\n    err := tpl.Execute(w, host)\n    if err != nil {\n        fmt.Println(\"Template Execute failed: \", err)\n    }\n}\n\nfunc process(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    fmt.Println(r.Form)\n    fmt.Println(\"path\", r.URL.Path)\n    fmt.Println(\"scheme\", r.URL.Scheme)\n    fmt.Println(r.Form[\"url_long\"])\n    for k, v := range r.Form {\n        fmt.Println(\"key:\", k)\n        fmt.Println(\"val:\", strings.Join(v, \"\"))\n    }\n    fmt.Println(r.Form[\"wall\"])\n}\n\nfunc main() {\n    host, _ := os.Hostname()\n    fmt.Println(\"host =\", host)\n    //err = tpl.Execute(f, host)\n\n    swall := http.NewServeMux()\n    //fs := http.FileServer(http.Dir(\"www\"))\n    //swall.Handle(\"/\", fs)\n    swall.Handle(\"/resources/\", http.StripPrefix(\"/resources/\", http.FileServer(http.Dir(\"resources\"))))\n    swall.HandleFunc(\"/\", handler)\n    swall.HandleFunc(\"/process\", process)\n    http.ListenAndServe(\":8080\", swall)\n}\n</code></pre>\n\n<p>HTML:</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Great Wall&lt;/title&gt;\n    &lt;link href=\"/resources/css/gwall.css\" type=\"text/css\" /&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;main&gt;\n        &lt;div id=\"page_title\"&gt;\n            &lt;h1&gt;Great Wall&lt;/h1&gt;\n        &lt;/div&gt;\n&lt;/main&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>CSS:</p>\n\n<pre><code>h1 {\n    color: red;\n    font-size: 36pt;\n    text-align: center;\n} \n</code></pre>\n\n<p>I tried everything I can think of and searched for several days, but I don't have much experience with templates and I'm at a complete loss right now. I know when someone tells me what I'm doing wrong I'll end up smacking myself on the forehead, but at this point I'll risk the bruising.  Thanks for any help.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1512996564, "post_id": 47752821, "comment_id": 82467030, "body": "No there is no such function. Did you take a look at a Regexps string method?"}, {"owner": {"reputation": 55, "user_id": 7425610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee14446bf5d9e375410f60287b7d15fe?s=128&d=identicon&r=PG&f=1", "display_name": "user7425610", "link": "https://stackoverflow.com/users/7425610/user7425610"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1512997115, "post_id": 47752821, "comment_id": 82467403, "body": "String() doesn&#39;t seem to work ... it prints the escaped string (<code>https:\\&#47;\\&#47;ad.doubleclick.net</code>)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1513008812, "post_id": 47752821, "comment_id": 82474927, "body": "The regexp.QuoteMeta function will not return the string <code>https:\\&#47;\\&#47;ad.doubleclick.net</code> for any input.  Please update the question with the actual strings and code."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1513030000, "last_edit_date": 1513030000, "creation_date": 1513006514, "answer_id": 47756267, "question_id": 47752821, "link": "https://stackoverflow.com/questions/47752821/how-to-unescape-escaped-regex/47756267#47756267", "title": "How to unescape escaped regex?", "body": "<p>Parse the string with the <a href=\"http://godoc.org/regexp/syntax\" rel=\"nofollow noreferrer\">regexp/syntax</a> package to get the unquoted string:</p>\n\n<pre><code>func unquoteMeta(s string) (string, error) {\n    r, err := syntax.Parse(s), 0)\n    if err != nil {\n        return \"\", err\n    }\n    if r.Op != syntax.OpLiteral {\n        return \"\", errors.New(\"not a quoted meta\")\n    }\n    return string(r.Rune), nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/O8WetXgHiz\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 55, "user_id": 7425610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee14446bf5d9e375410f60287b7d15fe?s=128&d=identicon&r=PG&f=1", "display_name": "user7425610", "link": "https://stackoverflow.com/users/7425610/user7425610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1513030000, "creation_date": 1512994699, "question_id": 47752821, "link": "https://stackoverflow.com/questions/47752821/how-to-unescape-escaped-regex", "title": "How to unescape escaped regex?", "body": "<p>I'm looking for the reverse of <a href=\"https://godoc.org/regexp#QuoteMeta\" rel=\"nofollow noreferrer\">regexp.QuoteMeta</a>.\n  Is it there a such function? </p>\n\n<p>I've tried to manually unescape it using <code>strings.Replace(\"\\\", \"\", -1)</code> but this is prone to error/unreliable as it doesn't work in all the cases(i.e. on excessive escaping or unicode). </p>\n\n<p>I also tried to add some quotes and use  <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"nofollow noreferrer\">strconv.Unquote</a> <code>(e.g. strconv.Unquote(</code>\"<code>+ \"https:\\/\\/ad.doubleclick.net\" +</code>\"<code>) )</code> but it errors out. </p>\n"}, {"tags": ["go", "atomic"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -1, "last_activity_date": 1512990044, "creation_date": 1512990044, "answer_id": 47751461, "question_id": 47750967, "link": "https://stackoverflow.com/questions/47750967/how-to-atomic-store-load-an-interface-in-golang/47751461#47751461", "title": "How to atomic store &amp; load an interface in golang?", "body": "<p>You cannot do this.</p>\n\n<p>You will have to protect the store/load with a mutex.\nThe internal representation of an interface is not specified by the language and might (is) to large to be handled by package atomic.</p>\n"}, {"tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": false, "score": 1, "last_activity_date": 1512991636, "last_edit_date": 1512991636, "creation_date": 1512991176, "answer_id": 47751807, "question_id": 47750967, "link": "https://stackoverflow.com/questions/47750967/how-to-atomic-store-load-an-interface-in-golang/47751807#47751807", "title": "How to atomic store &amp; load an interface in golang?", "body": "<p>Here's a way to use <code>atomic.StorePointer</code> and <code>atomic.LoadPointer</code> (based on your example):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync/atomic\"\n    \"unsafe\"\n)\n\nvar addr unsafe.Pointer\n\nfunc GetMyValue() *interface{} {\n    return (*interface{})(atomic.LoadPointer(&amp;addr))\n}\n\nfunc StoreMyValue(newValue *interface{}) {\n    atomic.StorePointer(&amp;addr, unsafe.Pointer(newValue))\n}\n\nfunc main() {\n    var i interface{}\n    i = 1\n    StoreMyValue(&amp;i)\n    fmt.Println(\"before:\", *GetMyValue())\n    i = 2\n    StoreMyValue(&amp;i)\n    fmt.Println(\"after\", *GetMyValue())\n}\n</code></pre>\n\n<p>Playground <a href=\"https://play.golang.org/p/93Ri2RTEoC\" rel=\"nofollow noreferrer\">link</a></p>\n\n<p>Note that this will not make your object thread-safe. Only the pointer is stored/loaded atomically. Also, I would avoid using <code>interface{}</code> and prefer concrete types whenever possible.</p>\n"}, {"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": true, "score": 9, "last_activity_date": 1512997904, "creation_date": 1512997904, "answer_id": 47753757, "question_id": 47750967, "link": "https://stackoverflow.com/questions/47750967/how-to-atomic-store-load-an-interface-in-golang/47753757#47753757", "title": "How to atomic store &amp; load an interface in golang?", "body": "<p>If I'm not mistaken you want <a href=\"https://golang.org/pkg/sync/atomic/#Value\" rel=\"noreferrer\">atomic Value</a>. You can store and fetch values atomically with it (signatures are <code>interface{}</code>  but you should put same type into it). It does some unsafe pointer stuff under the hood like what you wanted to do.</p>\n\n<p>Sample from docs:</p>\n\n<pre><code>var config Value // holds current server configuration\n// Create initial config value and store into config.\nconfig.Store(loadConfig())\ngo func() {\n        // Reload config every 10 seconds\n        // and update config value with the new version.\n        for {\n                time.Sleep(10 * time.Second)\n                config.Store(loadConfig())\n        }\n}()\n// Create worker goroutines that handle incoming requests\n// using the latest config value.\nfor i := 0; i &lt; 10; i++ {\n        go func() {\n                for r := range requests() {\n                        c := config.Load()\n                        // Handle request r using config c.\n                        _, _ = r, c\n                }\n        }()\n}\n</code></pre>\n"}], "owner": {"reputation": 1075, "user_id": 5006550, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef273a9ea35bc46ad4e1dad7c11faedd?s=128&d=identicon&r=PG&f=1", "display_name": "HongyanShen", "link": "https://stackoverflow.com/users/5006550/hongyanshen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4474, "favorite_count": 1, "accepted_answer_id": 47753757, "answer_count": 3, "score": 5, "last_activity_date": 1512997904, "creation_date": 1512988498, "last_edit_date": 1512989140, "question_id": 47750967, "link": "https://stackoverflow.com/questions/47750967/how-to-atomic-store-load-an-interface-in-golang", "title": "How to atomic store &amp; load an interface in golang?", "body": "<p>I want to write some code like this:</p>\n\n<pre><code>var myValue interface{}\n\nfunc GetMyValue() interface{} {\n    return atomic.Load(myValue)\n}\n\nfunc StoreMyValue(newValue interface{}) {\n    atomic.Store(myValue, newValue)\n}\n</code></pre>\n\n<p>It seems like that i can use <strong>LoadUintptr(addr *uintptr) (val uintptr)</strong> and <strong>StoreUintptr(addr *uintptr, val uintptr)</strong> in atomic package to achive this,but i do not know how to convert between <strong>uintptr</strong>,<strong>unsafe.Pointer</strong> and <strong>interface{}</strong>.</p>\n\n<p>If i do it like this:</p>\n\n<pre><code>var V interface{}\n\nfunc F(v interface{}) {\n    p := unsafe.Pointer(&amp;V)\n    atomic.StorePointer(&amp;p, unsafe.Pointer(&amp;v))\n}\n\nfunc main() {\n    V = 1\n    F(2)\n    fmt.Println(V)\n}\n</code></pre>\n\n<p>the <strong>V</strong> will always be 1</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1512987215, "post_id": 47750355, "comment_id": 82461370, "body": "In the json time, bpi, usd, and eur are not arrays, therefore you should not use slices in your structs, so remove <code>[]</code> from the relevant fields. (example <a href=\"https://play.golang.org/p/9dT8TShrea\" rel=\"nofollow noreferrer\">play.golang.org/p/9dT8TShrea</a>)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512987485, "post_id": 47750355, "comment_id": 82461525, "body": "Also, this might be a type in the question but, in the json it says <code>rate_float</code> while your tag in the go struct says <code>rate-float</code>, that won&#39;t match and therefore will not be unmarshaled as you might expect."}], "answers": [{"tags": [], "owner": {"reputation": 1332, "user_id": 3664021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3a9f339c82088c5bfe6be353fbae64?s=128&d=identicon&r=PG", "display_name": "leninhasda", "link": "https://stackoverflow.com/users/3664021/leninhasda"}, "is_accepted": true, "score": 5, "last_activity_date": 1512987484, "creation_date": 1512987484, "answer_id": 47750651, "question_id": 47750355, "link": "https://stackoverflow.com/questions/47750355/working-with-json-data-in-go-from-api-call/47750651#47750651", "title": "Working with JSON data in Go from API Call", "body": "<p>You have problem in your structure. If you see the <code>json</code> returned by the api call there is no array value for <code>time</code> and <code>bpi</code> key, all of them are object. Same goes for <code>USD</code> and <code>EUR</code> key.</p>\n\n<p>And there are two more typos/mistake as well:</p>\n\n<ol>\n<li><code>rate</code> is string not float. (you have to convert to float after reading it as string)</li>\n<li><code>rate-float</code> should be <code>rate_float</code></li>\n</ol>\n\n<p>Here is the full working one (worked for me):</p>\n\n<pre><code>//Currency blah blah\ntype Currency struct {\n    Code  string  `json:\"code\"`\n    Rate  string  `json:\"rate\"`\n    Descr string  `json:\"description\"`\n    Rf    float64 `json:\"rate_float\"`\n}\n\n//Bpi blah\ntype Bpi struct {\n    Usd Currency `json:\"USD\"`\n    Eur Currency `json:\"EUR\"`\n}\n\n//ListResponse is a blah\ntype ListResponse struct {\n    Time       Time   `json:\"time\"`\n    Disclaimer string `json:\"disclaimer\"`\n    Bpi        Bpi    `json:\"bpi\"`\n}\n</code></pre>\n\n<p>Crosscheck with yours. Hope it helps!</p>\n"}], "owner": {"reputation": 145, "user_id": 9083019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9e1099b90708cf365a95e8da51d85db6?s=128&d=identicon&r=PG&f=1", "display_name": "dwalsh", "link": "https://stackoverflow.com/users/9083019/dwalsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 47750651, "answer_count": 1, "score": 0, "last_activity_date": 1512991399, "creation_date": 1512986507, "last_edit_date": 1512991399, "question_id": 47750355, "link": "https://stackoverflow.com/questions/47750355/working-with-json-data-in-go-from-api-call", "title": "Working with JSON data in Go from API Call", "body": "<p>I mainly program in python and am in the process of teaching myself some Go! </p>\n\n<p>I've come to a stumbling block in trying to parse JSON data from an api call and I am turning to the great community here for some advice! Nothing I can find online has worked yet so any advice, even if its just related to the rest of the code, would be helpful!</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n) \n\n//Time blah\ntype Time struct {\n    Updated    string `json:\"updated\"`\n    UpdatedISO string `json:\"updatedISO\"`\n    Updateduk  string `json:\"updateduk\"`\n}\n\n//Currency blah blah\ntype Currency struct {\n    Code  string  `json:\"code\"`\n    Rate  float64 `json:\"rate\"`\n    Descr string  `json:\"description\"`\n    Rf    float64 `json:\"rate-float\"`\n}\n\n//Bpi blah\ntype Bpi struct {\n    Usd []Currency `json:\"USD\"`\n    Eur []Currency `json:\"EUR\"`\n}\n\n//ListResponse is a blah\ntype ListResponse struct {\n    Time       []Time `json:\"time\"`\n    Disclaimer string `json:\"disclaimer\"`\n    Bpi        []Bpi  `json:\"bpi\"`\n}\n\n    func btcPrice() {\n\n    url := \"https://api.coindesk.com/v1/bpi/currentprice/eur.json\"\n    req, err := http.Get(url)\n    if err != nil {\n        panic(err.Error())\n    } else {\n        data, err := ioutil.ReadAll(req.Body)\n        if err != nil {\n            fmt.Println(\"Error at the data stage: \", err)\n        }\n        // fmt.Println(string(data))\n        var result ListResponse\n        json.Unmarshal(data, &amp;result)\n        fmt.Println(result)\n    }\n}\nfunc main() {\n    btcPrice()\n}\n</code></pre>\n\n<p>Basically the code above is to make an api call, take the JSON data and manipulate it using my structs above. (I may be going at this the wrong way altogether so if that's the case call me for it). </p>\n\n<p>Here is where things go belly up for me. The JSON returned is the following:</p>\n\n<pre><code>{\n   \"time\":{\n      \"updated\":\"Dec 10, 2017 20:41:00 UTC\",\n      \"updatedISO\":\"2017-12-10T20:41:00+00:00\",\n      \"updateduk\":\"Dec 10, 2017 at 20:41 GMT\"\n   },\n   \"disclaimer\":\"This data was produced from the CoinDesk Bitcoin Price Index (USD). Non-USD currency data converted using hourly conversion rate from openexchangerates.org\",\n   \"bpi\":{\n      \"USD\":{\n         \"code\":\"USD\",\n         \"rate\":\"15,453.3888\",\n         \"description\":\"United States Dollar\",\n         \"rate_float\":15453.3888\n      },\n      \"EUR\":{\n         \"code\":\"EUR\",\n         \"rate\":\"13,134.4532\",\n         \"description\":\"Euro\",\n         \"rate_float\":13134.4532\n      }\n   }\n}\n</code></pre>\n\n<p>What I want to be able to do is access the json data sets individually, but the issue appears to be in my structs. If I call a basic print (commented in go code above for you to see), the whole data set from the json prints.But when I use the <em>result</em> code and <em>json.unmarshal</em> it only gives me the disclaimer, i.e the part of the struct simply labelled as of type string. </p>\n\n<p>I may seem to be rambling and will clarify statements if they are questioned in the comments. </p>\n\n<p>To Summarise:</p>\n\n<ul>\n<li>The code above fetches JSON and attempts to decode it using my structs created above.</li>\n<li>The data itself is fine, I've tested that with a simple print function.</li>\n<li>The issue could be in the structs (more than likely).</li>\n<li>What I want to be able to do with this code is basically access the \"rate_float\" amount in the \"EUR\" data subset of the \"bpi\" data set of the JSON file. (Taking the euro amount and using it for a slack bot as a small project).</li>\n</ul>\n"}, {"tags": ["database", "postgresql", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512990771, "post_id": 47750191, "comment_id": 82463457, "body": "Try not calling <code>stmt.Close()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "edited": false, "score": 0, "creation_date": 1512989075, "post_id": 47750449, "comment_id": 82462438, "body": "If i remove tx.commit() then no records inserted in database.What could be reason for duplicate records insertion?"}, {"owner": {"reputation": 166, "user_id": 9060023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ca363d26325706c1752d60cfdf3285?s=128&d=identicon&r=PG&f=1", "display_name": "Vyacheslav", "link": "https://stackoverflow.com/users/9060023/vyacheslav"}, "reply_to_user": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "edited": false, "score": 0, "creation_date": 1512989454, "post_id": 47750449, "comment_id": 82462654, "body": "Please take a look this article: <a href=\"http://www.alexedwards.net/blog/practical-persistence-sql\" rel=\"nofollow noreferrer\">alexedwards.net/blog/practical-persistence-sql</a>  Especially section &quot;Executing a statement&quot;. There is example how author created endpoint for POST with INSERT to DB. Hope that this will help you. P.S. I don&#39;t see any transactions in this example only Exec"}, {"owner": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "edited": false, "score": 0, "creation_date": 1512991905, "post_id": 47750449, "comment_id": 82464179, "body": "Thanks. I will check it."}, {"owner": {"reputation": 166, "user_id": 9060023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ca363d26325706c1752d60cfdf3285?s=128&d=identicon&r=PG&f=1", "display_name": "Vyacheslav", "link": "https://stackoverflow.com/users/9060023/vyacheslav"}, "reply_to_user": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "edited": false, "score": 0, "creation_date": 1512991949, "post_id": 47750449, "comment_id": 82464207, "body": "Ok, if you need some help ping me and I will try to help you! ;-)"}, {"owner": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "edited": false, "score": 0, "creation_date": 1513234863, "post_id": 47750449, "comment_id": 82576322, "body": "Thanks. It worked. I need one more help. In my Go routine, I have response object array ( with fields and values that mapped to struct type). Is there any way to pass this object from handler to html page  and iterate and display each variable with value ?"}, {"owner": {"reputation": 166, "user_id": 9060023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ca363d26325706c1752d60cfdf3285?s=128&d=identicon&r=PG&f=1", "display_name": "Vyacheslav", "link": "https://stackoverflow.com/users/9060023/vyacheslav"}, "reply_to_user": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "edited": false, "score": 0, "creation_date": 1513235130, "post_id": 47750449, "comment_id": 82576453, "body": "Thanks, I am glad to hear that! ;-)"}, {"owner": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "edited": false, "score": 0, "creation_date": 1513244521, "post_id": 47750449, "comment_id": 82581410, "body": "can you help me here"}, {"owner": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "edited": false, "score": 0, "creation_date": 1513244525, "post_id": 47750449, "comment_id": 82581413, "body": "In my Go routine, I have response object array ( with fields and values that mapped to struct type). Is there any way to pass this object from handler to html page and iterate and display each variable with value ?"}], "tags": [], "owner": {"reputation": 166, "user_id": 9060023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ca363d26325706c1752d60cfdf3285?s=128&d=identicon&r=PG&f=1", "display_name": "Vyacheslav", "link": "https://stackoverflow.com/users/9060023/vyacheslav"}, "is_accepted": false, "score": 2, "last_activity_date": 1512986822, "creation_date": 1512986822, "answer_id": 47750449, "question_id": 47750191, "link": "https://stackoverflow.com/questions/47750191/record-inserted-twice-into-database/47750449#47750449", "title": "Record inserted twice into database", "body": "<p>Probably commit is done twice. First time by some of previous operations like <code>stmt.exec</code> and second time when <code>tx.Commit()</code> executed.</p>\n"}], "owner": {"reputation": 321, "user_id": 9068929, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b34f512608edfd66b7c06f9990fcea3f?s=128&d=identicon&r=PG&f=1", "display_name": "sheik", "link": "https://stackoverflow.com/users/9068929/sheik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512986822, "creation_date": 1512985987, "last_edit_date": 1512986269, "question_id": 47750191, "link": "https://stackoverflow.com/questions/47750191/record-inserted-twice-into-database", "title": "Record inserted twice into database", "body": "<p>I have code in Go like below :</p>\n\n<pre><code>package main\n\nimport (  \n  \"database/sql\"\n  \"log\"\n\n  _ \"github.com/lib/pq\"\n\n)\n\n\nconst (\n    insertLoginSQL   = `insert into Logins(id, name,password) values($1, $2, $3)`\n)\n\nfunc main() {  \n\n     db, err := sql.Open(\"postgres\", \"user=postgres password=admin dbname=Quality sslmode=disable\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer db.Close()\n\n    if err := Insert(db); err != nil {\n        log.Println(\"error with double insert\", err)\n    }\n\n}\n\nfunc Insert(db *sql.DB) error {\n    tx, err := db.Begin()\n    if err != nil {\n        return err\n    }\n\n        stmt, err := tx.Prepare(insertLoginSQL)\n        if err != nil {\n            return err\n        }\n        defer stmt.Close()\n\n        if _, err := stmt.Exec(10, \"user\",\"pwd\"); err != nil {\n            tx.Rollback()\n            return err\n        }\n\n    return tx.Commit()\n}\n</code></pre>\n\n<p>When I run above code, records inserted twice in database. Can someone let me know why duplicate records inserted? Any issue with this code?</p>\n"}, {"tags": ["go", "struct", "yaml"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1512990123, "post_id": 47751020, "comment_id": 82463029, "body": "Thanks 1+ , Can you please provide example how would you parse the file in the answer to this struct ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1512994113, "post_id": 47751020, "comment_id": 82465583, "body": "Thank you very much, I&#39;ve tried your example and it works partially the <code>install</code>  <code>properties</code>  <code>provides</code> objects are empty , any idea ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1512994666, "post_id": 47751020, "comment_id": 82465891, "body": "Sorry this is Ok the problem is with vs code debugger, it appear that it doesnt show object in deep struct...see my update, you cannot open the array object to see whats in there"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1512994898, "post_id": 47751020, "comment_id": 82466034, "body": "my last question :) if you need to build this golang program how would you structre the project , lets say the main is under <code>rootProj-&gt; cmd&gt;main.go</code>  where do you put all the `struct&#39; (which folder in the proj and if you create new file for each struct ...)and how you load them to the main method. thank a lot!"}, {"owner": {"reputation": 698, "user_id": 5617424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rmoz.jpg?s=128&g=1", "display_name": "Vane Trajkov", "link": "https://stackoverflow.com/users/5617424/vane-trajkov"}, "edited": false, "score": 0, "creation_date": 1513006436, "post_id": 47751020, "comment_id": 82473369, "body": "If the app is all that from this question description you might keep it all in one file. The final design of your app should depend on your full requirements and complexity. This feels like another question and it is too generic. Could you please separate it to another StackOverflow question and provide more specifics."}], "tags": [], "owner": {"reputation": 698, "user_id": 5617424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rmoz.jpg?s=128&g=1", "display_name": "Vane Trajkov", "link": "https://stackoverflow.com/users/5617424/vane-trajkov"}, "is_accepted": true, "score": 3, "last_activity_date": 1512991141, "last_edit_date": 1512991141, "creation_date": 1512988643, "answer_id": 47751020, "question_id": 47750076, "link": "https://stackoverflow.com/questions/47750076/parse-yaml-file-to-predefined-struct-in-go/47751020#47751020", "title": "Parse yaml file to predefined struct in go", "body": "<p>Your struct definition should be something like this</p>\n\n<pre><code>type Yaml struct {\n    Schema     string\n    ID         string\n    Version    string\n    Dependency []Dependency\n}\n\ntype Dependency struct {\n    Name     string\n    Type     string\n    CWD      string\n    Install  []Install\n    Provides []Provide\n}\n\ntype Install struct {\n    Name       string\n    Group      string\n    Type       string\n    Properties Properties\n}\n\ntype Properties struct {\n    Name string\n    URL  string\n}\n\ntype Provide struct {\n    Name       string\n    Properties Properties\n}\n</code></pre>\n\n<p>Here is full sample code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n\n    \"gopkg.in/yaml.v2\"\n)\n\nvar data = `\nschema: \"1.0.0\"\nid: test\nversion: \"1.2.3\"\n\n\ndependency :\n  - name: ui\n    type: runner\n    cwd: /ui\n    install:\n       - name: api\n         group: test\n         properties:\n             name: app\n             url: appUrl\n\n  - name: backend\n    type: mongoDb\n    path: be\n    install:\n       - name: db\n         type: mongo\n    provides:\n       - name: api\n         properties:\n             url: url\n`\n\ntype Yaml struct {\n    Schema     string\n    ID         string\n    Version    string\n    Dependency []Dependency\n}\n\ntype Dependency struct {\n    Name     string\n    Type     string\n    CWD      string\n    Install  []Install\n    Provides []Provide\n}\n\ntype Install struct {\n    Name       string\n    Group      string\n    Type       string\n    Properties Properties\n}\n\ntype Properties struct {\n    Name string\n    URL  string\n}\n\ntype Provide struct {\n    Name       string\n    Properties Properties\n}\n\nfunc main() {\n    y := Yaml{}\n\n    err := yaml.Unmarshal([]byte(data), &amp;y)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n    fmt.Printf(\"%+v\\n\", y)\n\n}\n</code></pre>\n\n<p>Output </p>\n\n<pre><code>{Schema:1.0.0 ID:test Version:1.2.3 Dependency:[{Name:ui Type:runner CWD:/ui Install:[{Name:api Group:test Type: Properties:{Name:appURL:appUrl}}] Provides:[]} {Name:backend Type:mongoDb CWD: Install:[{Name:db Group: Type:mongo Properties:{Name: URL:}}] Provides:[{Name:api Properties:{Name: URL:url}}]}]}\n</code></pre>\n\n<p>If you want to read from a yaml file, in the main func just replace:</p>\n\n<pre><code>err := yaml.Unmarshal([]byte(data), &amp;y)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>yamlFile, err := ioutil.ReadFile(\"yaml_sample.yaml\")\nif err != nil {\n    log.Printf(\"yamlFile.Get err   #%v \", err)\n}\nerr = yaml.Unmarshal(yamlFile, &amp;y)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5046, "favorite_count": 0, "accepted_answer_id": 47751020, "answer_count": 1, "score": 0, "last_activity_date": 1512994701, "creation_date": 1512985590, "last_edit_date": 1512994701, "question_id": 47750076, "link": "https://stackoverflow.com/questions/47750076/parse-yaml-file-to-predefined-struct-in-go", "title": "Parse yaml file to predefined struct in go", "body": "<p>I\u2019ve multiple yaml files which need to be parsed and have exactly the same structure</p>\n\n<pre><code>schema: \"1.0.0\"\nid: test\nversion: \"1.2.3\"\n\n\ndependency :\n  - name: ui\n    type: runner\n    cwd: /ui\n    install:\n       - name: api\n         group: test\n         properties:\n             name: app\n             url: appUrl\n\n  - name: backend\n    type: mongoDb\n    path: be\n    install:\n       - name: db\n         type: mongo\n    provides:\n       - name: api\n         properties:\n            url: url\n</code></pre>\n\n<blockquote>\n  <p>The schema section is mandatory for all the yaml which the app should\n  get always</p>\n  \n  <p>The dependency tag can contain 1..n entries with mandatory fields\n  ,name, type, cwd</p>\n  \n  <p>The dependency tag can (or not) contain <code>install</code> section with <code>name</code>\n  and <code>properties</code> which is mandatory</p>\n  \n  <p>The dependency tag can (or not) contain <code>provides</code> section with <code>name</code>\n  and which is mandatory</p>\n  \n  <p>The install can have properties and the provides also can have\n  properties</p>\n</blockquote>\n\n<p>I am using a <a href=\"https://github.com/go-yaml/yaml\" rel=\"nofollow noreferrer\">yaml parser</a> to parse the files but my question is how in Golang I can build struct that when I parse the doc it will automatically fill the main struct and will include the sub structs (such as dependency/ install sections ) </p>\n\n<p>I have tried something like</p>\n\n<pre><code>type main struct {\n    schema struct {\n        schema  string\n        id int\n        version string\n    }\n\n    dependency struct {\n        name  string\n        type string\n        cwd string\n\n    install struct {\n        name  string\n    }\n\n\n}\n</code></pre>\n\n<p>In the install section, it can be group or type or both and it can have also properties section, so I'm not sure how to build\nsome generic /extendable struct which I use to parse the document (the document have close list of properties, what I put in the example describe the most options) </p>\n\n<p>I use this lib to parse the doc</p>\n\n<p><a href=\"https://github.com/go-yaml/yaml\" rel=\"nofollow noreferrer\">yaml parser</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/wUVkk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wUVkk.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["angular", "go", "angular5"], "answers": [{"tags": [], "owner": {"reputation": 183792, "user_id": 1749403, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/g0aFU.png?s=128&g=1", "display_name": "Sajeetharan", "link": "https://stackoverflow.com/users/1749403/sajeetharan"}, "is_accepted": true, "score": 0, "last_activity_date": 1514002193, "creation_date": 1514002193, "answer_id": 47949667, "question_id": 47749169, "link": "https://stackoverflow.com/questions/47749169/check-username-exist-in-angular4-go/47949667#47949667", "title": "Check Username exist in Angular4 &amp; GO", "body": "<p>You can just check the response from the service if its sending the message back to the client catch the errror and display it.</p>\n\n<pre><code>  this.http.post('http://localhost:8080/log', JSON.stringify(this.login))\n    .subscribe((response) =&gt; {\n      console.log('response data from golang ' + response);\n    },\n    errmess =&gt; { alert(errmess) });\n  } \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7161855"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 47949667, "answer_count": 1, "score": 0, "last_activity_date": 1514448697, "creation_date": 1512982238, "last_edit_date": 1514448697, "question_id": 47749169, "link": "https://stackoverflow.com/questions/47749169/check-username-exist-in-angular4-go", "title": "Check Username exist in Angular4 &amp; GO", "body": "<p>I'm Using Angular4 as front end and Go service as Back end. When user is log in,I need to check whether username already exist to do that GO service back end will check about that user. If the user is not exists and it displays message. How to display message that <strong><code>\"Invalid user details\".</code></strong></p>\n\n<p>Please refer some inputs about that.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "struct", "gorilla"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1512982752, "post_id": 47748215, "comment_id": 82458686, "body": "Decoding the body is not &quot;query parameter&quot;. Get the logic and semantics straight, the rest will be easy."}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1512983059, "post_id": 47748215, "comment_id": 82458881, "body": "Output what you actually receive here and all will probably become clear. You are probably just receiving the parameters in the wrong format (either as url params or otherwise encoded in body)."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "edited": false, "score": 0, "creation_date": 1512978719, "post_id": 47748304, "comment_id": 82456964, "body": "haha thank you. oke i edit in my question. I already using tag names in my code.."}, {"owner": {"reputation": 666, "user_id": 5339180, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec7a87ded73862f4599d86c43da80327?s=128&d=identicon&r=PG&f=1", "display_name": "V. Panchenko", "link": "https://stackoverflow.com/users/5339180/v-panchenko"}, "reply_to_user": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "edited": false, "score": 0, "creation_date": 1512980067, "post_id": 47748304, "comment_id": 82457494, "body": "if this answer is correct and works for you - please mark it as an &quot;answer&quot;)"}, {"owner": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "edited": false, "score": 0, "creation_date": 1512982201, "post_id": 47748304, "comment_id": 82458441, "body": "i already using tag names and it&#39;s not solve my problem.. in my question i forgot to add tag names."}], "tags": [], "owner": {"reputation": 666, "user_id": 5339180, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec7a87ded73862f4599d86c43da80327?s=128&d=identicon&r=PG&f=1", "display_name": "V. Panchenko", "link": "https://stackoverflow.com/users/5339180/v-panchenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1512977928, "creation_date": 1512977928, "answer_id": 47748304, "question_id": 47748215, "link": "https://stackoverflow.com/questions/47748215/how-to-decode-query-parameter-in-golang/47748304#47748304", "title": "How to decode query parameter in golang", "body": "<p>I think you should fix your tags from this:</p>\n\n<pre><code>type User struct{\n    IDUser         int     `json:id_user`\n    PhoneNumber    string  `json:phone_number`\n}\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>type User struct{\n    IDUser         int     `json:\"id_user\"`\n    PhoneNumber    string  `json:\"phone_number\"`\n}\n</code></pre>\n\n<p>So, you should use quotes in tag names.</p>\n"}, {"tags": [], "owner": {"reputation": 1592, "user_id": 7251967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-al-If026iHU/AAAAAAAAAAI/AAAAAAAAABE/9lsheyH-V9Q/photo.jpg?sz=128", "display_name": "negi Yogi", "link": "https://stackoverflow.com/users/7251967/negi-yogi"}, "is_accepted": true, "score": 2, "last_activity_date": 1566286366, "last_edit_date": 1566286366, "creation_date": 1512987048, "answer_id": 47750527, "question_id": 47748215, "link": "https://stackoverflow.com/questions/47748215/how-to-decode-query-parameter-in-golang/47750527#47750527", "title": "How to decode query parameter in golang", "body": "<p>If your mentioned two fields are query params you can directly read it like this way:</p>\n\n<pre><code>func User(w http.ResponseWriter, r *http.Request) {\nidUser := r.URL.Query().Get(\"id_user\")\nphoneNumber := r.URL.Query().Get(\"phone_number\")\nvar user User\nid, err := strconv.Atoi(idUser)\nif err != nil {\n    fmt.Println(\"error converting string to int\")\n    return\n}\nuser.IDUser = id\nuser.PhoneNumber = phoneNumber\nrespBody, _ := json.Marshal(user)\nw.Header().Set(\"Content-Type\", \"application/json\")\nw.WriteHeader(http.StatusOK)\nw.Write(respBody)\n}\n</code></pre>\n\n<p>Otherwise you can directly pass the User struct in api payload and directly do the payLoad decoding like this </p>\n\n<pre><code>    if err := json.NewDecoder(r.Body).Decode(&amp;user); err != nil {\n      fmt.Println(\"error decoding api payload\")\n      return\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "is_accepted": false, "score": 0, "last_activity_date": 1618986516, "creation_date": 1618986516, "answer_id": 67190351, "question_id": 47748215, "link": "https://stackoverflow.com/questions/47748215/how-to-decode-query-parameter-in-golang/67190351#67190351", "title": "How to decode query parameter in golang", "body": "<p>If you want to decode them directly into a structure without getting the values of the fields one by one then you can use <code>github.com/gorilla/schema</code>. Refer to <a href=\"https://stackoverflow.com/questions/39486740/how-to-get-all-get-request-query-parameters-into-a-structure-in-go\">this question</a>.</p>\n"}], "owner": {"reputation": 85, "user_id": 6265099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1cf4ab5937cbde28db073128ff3968?s=128&d=identicon&r=PG&f=1", "display_name": "Rikcat Kristian Lumban Gaol", "link": "https://stackoverflow.com/users/6265099/rikcat-kristian-lumban-gaol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5622, "favorite_count": 0, "accepted_answer_id": 47750527, "answer_count": 3, "score": -3, "last_activity_date": 1618986516, "creation_date": 1512977429, "last_edit_date": 1512978599, "question_id": 47748215, "link": "https://stackoverflow.com/questions/47748215/how-to-decode-query-parameter-in-golang", "title": "How to decode query parameter in golang", "body": "<p>i have parameter</p>\n\n<pre><code>id_user\nphone_number\n</code></pre>\n\n<p>I want to decode to my struct</p>\n\n<pre><code>type User struct{\n     IDUser int `json:\"id_user\"`\n     PhoneNumber string `json:\"phone_number\"`\n}\n</code></pre>\n\n<p>is it possible to decode into struct? I use gorilla schema. My Code:</p>\n\n<pre><code>func User(w http.ResponseWriter, r *http.Request){\n  var decoder = schema.NewDecoder()\n  var user User\n  if err := r.ParseForm(); err != nil {\n     fmt.Println(err)\n  }\n\n  err := decoder.Decode(&amp;user, r.PostForm)\n  if err != nil {\n     fmt.Println(err)\n  }\n  respBody, err := json.Marshal(user)\n  w.Header().Set(\"Content-Type\", \"application/json\")\n  w.WriteHeader(http.StatusOK)\n  w.Write(respBody)\n}\n</code></pre>\n\n<p>i input id_user = 1 and phone_number = qwerty. But the result is id_user = 0 and phone_number = \"\".</p>\n"}, {"tags": ["json", "dictionary", "go", "unmarshalling", "type-assertion"], "comments": [{"owner": {"reputation": 5954, "user_id": 230392, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uwtL7.jpg?s=128&g=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/230392/jeff"}, "edited": false, "score": 1, "creation_date": 1512975001, "post_id": 47747663, "comment_id": 82455541, "body": "This is a pretty good resource <a href=\"https://gobyexample.com/json\" rel=\"nofollow noreferrer\">gobyexample.com/json</a>"}, {"owner": {"reputation": 461, "user_id": 7647297, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-IkUGmoG0Wxw/AAAAAAAAAAI/AAAAAAAAABw/Wk5yAPARLxM/photo.jpg?sz=128", "display_name": "Rohit Kumar", "link": "https://stackoverflow.com/users/7647297/rohit-kumar"}, "reply_to_user": {"reputation": 5954, "user_id": 230392, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uwtL7.jpg?s=128&g=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/230392/jeff"}, "edited": false, "score": 0, "creation_date": 1512975215, "post_id": 47747663, "comment_id": 82455603, "body": "@jeff i&#39;m using interface assuming that i don&#39;t know the structure of response."}, {"owner": {"reputation": 461, "user_id": 7647297, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-IkUGmoG0Wxw/AAAAAAAAAAI/AAAAAAAAABw/Wk5yAPARLxM/photo.jpg?sz=128", "display_name": "Rohit Kumar", "link": "https://stackoverflow.com/users/7647297/rohit-kumar"}, "reply_to_user": {"reputation": 5954, "user_id": 230392, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uwtL7.jpg?s=128&g=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/230392/jeff"}, "edited": false, "score": 0, "creation_date": 1512976712, "post_id": 47747663, "comment_id": 82456230, "body": "@Jeff   it works but assuming if i have to parse nested element  this solution will be  complex.  do you have any alternate solution ?"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513002436, "post_id": 47748858, "comment_id": 82470673, "body": "This question has nothing to do with BSON or Mongo. If you want to reference something for using reflection in this case, you might as well read the source of the <code>json</code> package since it&#39;s actually relevant."}, {"owner": {"reputation": 319, "user_id": 8652703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce90a6950f92d17211799b8bb7eabea?s=128&d=identicon&r=PG&f=1", "display_name": "Terry Pang", "link": "https://stackoverflow.com/users/8652703/terry-pang"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513037208, "post_id": 47748858, "comment_id": 82488281, "body": "I recommend to read bson.M cause the questioner said in the comments, <i>nested interface{}</i>, and I think bson.M is an example for decode nested interface{}"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513037747, "post_id": 47748858, "comment_id": 82488435, "body": "Handling of nesting is simple recursion. JSON does it as well."}, {"owner": {"reputation": 319, "user_id": 8652703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce90a6950f92d17211799b8bb7eabea?s=128&d=identicon&r=PG&f=1", "display_name": "Terry Pang", "link": "https://stackoverflow.com/users/8652703/terry-pang"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513037903, "post_id": 47748858, "comment_id": 82488472, "body": "I am new to go and familiar with bson.M, sorry to waste your time."}], "tags": [], "owner": {"reputation": 319, "user_id": 8652703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce90a6950f92d17211799b8bb7eabea?s=128&d=identicon&r=PG&f=1", "display_name": "Terry Pang", "link": "https://stackoverflow.com/users/8652703/terry-pang"}, "is_accepted": false, "score": 0, "last_activity_date": 1513066365, "last_edit_date": 1513066365, "creation_date": 1512980603, "answer_id": 47748858, "question_id": 47747663, "link": "https://stackoverflow.com/questions/47747663/invalid-operation-type-interface-does-not-support-indexing/47748858#47748858", "title": "invalid operation: type interface {} does not support indexing", "body": "<p>You need some tricks to handle your situation.<br>\nLike using reflect and you may ref Marshall&amp;&amp;UnMarshall code about bson.M in <a href=\"https://github.com/go-mgo/mgo/blob/v2-unstable/bson/bson.go\" rel=\"nofollow noreferrer\">golang mongo driver mgo</a></p>\n\n<p>code sample using reflect decode nested as following:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    keys := []string{\"hello\", \"world\", \"dude\", \"kind\", \"cool\"}\n    a := make(map[string]interface{})\n    a[keys[4]] = \"perfect\"\n    b := make(map[string]interface{})\n    b[keys[3]] = a\n    c := make(map[string]interface{})\n    c[keys[2]] = b\n    d := make(map[string]interface{})\n    d[keys[1]] = c\n    e := make(map[string]interface{})\n    e[keys[0]] = d\n    fmt.Println(e)\n\n    if buf, err := json.Marshal(e); nil == err {\n        dd := make(map[string]interface{})\n        err = json.Unmarshal(buf, &amp;dd)\n        if nil != err {\n            fmt.Println(\"failed\", err)\n        }\n\n        for k, v := range dd {\n            travel(dd, k, v)\n        }\n        fmt.Println(dd)\n\n    } else {\n        fmt.Println(\"failed marshal\")\n    }\n}\n\nfunc travel(dd map[string]interface{}, key string, value interface{}) {\n    vv := reflect.ValueOf(value)\n    switch vv.Kind() {\n    case reflect.Map:\n        m := value.(map[string]interface{})\n        dd[key] = m\n        for k, v := range m {\n            travel(m, k, v)\n        }\n    case reflect.String:\n        dd[key] = value.(string)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 12, "last_activity_date": 1514460370, "last_edit_date": 1514460370, "creation_date": 1512980731, "answer_id": 47748884, "question_id": 47747663, "link": "https://stackoverflow.com/questions/47747663/invalid-operation-type-interface-does-not-support-indexing/47748884#47748884", "title": "invalid operation: type interface {} does not support indexing", "body": "<p><code>d</code> is of type <code>interface{}</code>, so you cannot index it like <code>d[\"data\"]</code>, you need another type assertion:</p>\n\n<pre><code>test := d.(map[string]interface{})[\"data\"].(map[string]interface{})[\"type\"]\nfmt.Println(test)\n</code></pre>\n\n<p>Then it will work. Output will be <code>\"domains\"</code>. See a working example on the <a href=\"https://play.golang.org/p/HZDAaxV5QW\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>Also note that if you declare <code>d</code> to be of type <code>map[string]interface{}</code>, you can spare the first type assertion:</p>\n\n<pre><code>var d map[string]interface{}\nif err := json.NewDecoder(response.Body).Decode(&amp;d); err != nil {\n    panic(err)\n}\ntest := d[\"data\"].(map[string]interface{})[\"type\"]\nfmt.Println(test)\n</code></pre>\n\n<p>Output is the same. Try this one on the <a href=\"https://play.golang.org/p/6X6nFCw1-e\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>If you need to do these and similar operations many times, you may find my <a href=\"https://github.com/icza/dyno\" rel=\"noreferrer\"><code>github.com/icza/dyno</code></a> library useful (whose primary goal is to aid working with dynamic objects).</p>\n"}, {"tags": [], "owner": {"reputation": 1715, "user_id": 8712494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iWUnn1PqAuw/AAAAAAAAAAI/AAAAAAAAAGQ/2OslFo_DLk4/photo.jpg?sz=128", "display_name": "Amin Shojaei", "link": "https://stackoverflow.com/users/8712494/amin-shojaei"}, "is_accepted": false, "score": 0, "last_activity_date": 1595438026, "creation_date": 1595438026, "answer_id": 63039704, "question_id": 47747663, "link": "https://stackoverflow.com/questions/47747663/invalid-operation-type-interface-does-not-support-indexing/63039704#63039704", "title": "invalid operation: type interface {} does not support indexing", "body": "<p>You can do this also:</p>\n<pre><code>var inputJson string = &quot;...&quot;\n\nvar decoded map[string]map[string]interface{}\n\njson.Unmarshal([]byte(inputJson), &amp;decoded)\n\ntest := decoded[&quot;data&quot;][&quot;type&quot;]\n\nfmt.Println(test)\n// output: domains\n</code></pre>\n"}], "owner": {"reputation": 461, "user_id": 7647297, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-IkUGmoG0Wxw/AAAAAAAAAAI/AAAAAAAAABw/Wk5yAPARLxM/photo.jpg?sz=128", "display_name": "Rohit Kumar", "link": "https://stackoverflow.com/users/7647297/rohit-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8453, "favorite_count": 2, "answer_count": 3, "score": 3, "last_activity_date": 1595438026, "creation_date": 1512974568, "last_edit_date": 1536146747, "question_id": 47747663, "link": "https://stackoverflow.com/questions/47747663/invalid-operation-type-interface-does-not-support-indexing", "title": "invalid operation: type interface {} does not support indexing", "body": "<p>I'm new to the golang and I have problem while reading the nested JSON response.  </p>\n\n<pre><code>var d interface{}\njson.NewDecoder(response.Body).Decode(&amp;d)\ntest :=d[\"data\"].(map[string]interface{})[\"type\"]\n</code></pre>\n\n<p><code>response.Body</code> looks like this</p>\n\n<pre><code>{\n    \"links\": {\n      \"self\": \"/domains/test.one\"\n    },\n    \"data\": {\n        \"type\": \"domains\",\n        \"id\": \"test.one\",\n        \"attributes\": {\n            \"product\": \" Website\",\n            \"package\": \"Professional\",\n            \"created_at\": \"2016-08-19T11:37:01Z\"\n        }\n    }\n}\n</code></pre>\n\n<p>The Error I'm getting is this:</p>\n\n<pre><code>invalid operation: d[\"data\"] (type interface {} does not support indexing)\n</code></pre>\n"}, {"tags": ["go", "restart", "systemd"], "answers": [{"comments": [{"owner": {"reputation": 2491, "user_id": 1117320, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/LA0T3.jpg?s=128&g=1", "display_name": "ambikanair", "link": "https://stackoverflow.com/users/1117320/ambikanair"}, "edited": false, "score": 0, "creation_date": 1512971358, "post_id": 47747068, "comment_id": 82454207, "body": "Thanks for the reply. Apart from &quot;replace&quot; what other starings can be used. Is there any doc whoch explains these mode."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2491, "user_id": 1117320, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/LA0T3.jpg?s=128&g=1", "display_name": "ambikanair", "link": "https://stackoverflow.com/users/1117320/ambikanair"}, "edited": false, "score": 0, "creation_date": 1512971556, "post_id": 47747068, "comment_id": 82454277, "body": "@ambikanair Yes: I have edited the answer accordingly."}, {"owner": {"reputation": 188, "user_id": 1062363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570be7f5e58be34fb21ad5ea37011d0f?s=128&d=identicon&r=PG", "display_name": "kaeso", "link": "https://stackoverflow.com/users/1062363/kaeso"}, "edited": false, "score": 0, "creation_date": 1513089005, "post_id": 47747068, "comment_id": 82510952, "body": "PR author and library maintainer here. I&#39;ll happily take a patch to clarify the documentation if you care to submit it."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 188, "user_id": 1062363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570be7f5e58be34fb21ad5ea37011d0f?s=128&d=identicon&r=PG", "display_name": "kaeso", "link": "https://stackoverflow.com/users/1062363/kaeso"}, "edited": false, "score": 0, "creation_date": 1513089337, "post_id": 47747068, "comment_id": 82511152, "body": "@kaeso were you suggesting that to the OP? Because I found the existing documentation (<a href=\"https://godoc.org/github.com/coreos/go-systemd/dbus#Conn.StartUnit\" rel=\"nofollow noreferrer\">godoc.org/github.com/coreos/go-systemd/dbus#Conn.StartUnit</a>) clear enough myself."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1512993415, "last_edit_date": 1512993415, "creation_date": 1512971072, "answer_id": 47747068, "question_id": 47747001, "link": "https://stackoverflow.com/questions/47747001/what-should-be-the-mode-and-channel-while-restarting-unit-files/47747068#47747068", "title": "What should be the mode and channel while restarting unit files", "body": "<p>From <a href=\"https://github.com/coreos/go-systemd/pull/203/files\" rel=\"nofollow noreferrer\">PR 203</a>, you can see <a href=\"https://github.com/endocode/go-systemd/blob/86fc89891ea3d7006495462e85985585ccd307eb/dbus/methods_test.go#L149-L186\" rel=\"nofollow noreferrer\">that method used/tested</a> as:</p>\n\n<pre><code>// Restart the unit\nreschan = make(chan string)\n_, err = conn.RestartUnit(target, \"replace\", reschan)\nif err != nil {\n    t.Fatal(err)\n}\n\njob = &lt;-reschan\nif job != \"done\" {\n    t.Fatal(\"Job is not done:\", job)\n}\n</code></pre>\n\n<p>So you have to create your own label and channel.</p>\n\n<p>From <a href=\"https://github.com/coreos/go-systemd/blob/2f344660b11f7285b0af86195c4456e92970f640/dbus/methods.go#L65-L75\" rel=\"nofollow noreferrer\"><code>dbus/methods.go</code></a></p>\n\n<pre><code>// Takes the unit to activate, plus a **mode string**. \n</code></pre>\n\n<blockquote>\n  <p>The mode needs to be one of:</p>\n  \n  <ul>\n  <li><strong>replace</strong> (the call will start the unit and its dependencies, possibly replacing already queued jobs that conflict with this), </li>\n  <li><strong>fail</strong> (the call will start the unit and its dependencies, but will fail if this would change an already queued job), </li>\n  <li><strong>isolate</strong> (the call will start the unit in question and terminate all units that aren't dependencies of it), </li>\n  <li><strong>ignore-dependencies</strong> (it will start a unit but ignore all its dependencies), </li>\n  <li><strong>ignore-requirements</strong> (it will start a unit but only ignore the requirement dependencies). </li>\n  </ul>\n  \n  <p>It is not recommended to make use of the latter two options.</p>\n</blockquote>\n"}], "owner": {"reputation": 2491, "user_id": 1117320, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/LA0T3.jpg?s=128&g=1", "display_name": "ambikanair", "link": "https://stackoverflow.com/users/1117320/ambikanair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 47747068, "answer_count": 1, "score": 2, "last_activity_date": 1512993415, "creation_date": 1512970584, "question_id": 47747001, "link": "https://stackoverflow.com/questions/47747001/what-should-be-the-mode-and-channel-while-restarting-unit-files", "title": "What should be the mode and channel while restarting unit files", "body": "<p>In <a href=\"https://github.com/coreos/go-systemd\" rel=\"nofollow noreferrer\">go-systemd</a>, what should be the second and third parameters for restarting the units.</p>\n\n<pre><code>// RestartUnit restarts a service.  If a service is restarted that isn't\n// running it will be started.\nfunc (c *Conn) RestartUnit(name string, mode string, ch chan&lt;- string)    (int, error) {\nreturn c.startJob(ch, \"org.freedesktop.systemd1.Manager.RestartUnit\", name, mode)\n}\n</code></pre>\n"}, {"tags": ["json", "go", "slice"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1512967481, "post_id": 47746431, "comment_id": 82453137, "body": "The JSON is malformed. It&#39;s probably missing the closing &quot;]&quot; and possibly more."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1512969622, "post_id": 47746431, "comment_id": 82453665, "body": "Show the code used to read the HTTP response."}, {"owner": {"reputation": 2497, "user_id": 4280615, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/vNe8H.png?s=128&g=1", "display_name": "Nate Vaughan", "link": "https://stackoverflow.com/users/4280615/nate-vaughan"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1513035326, "post_id": 47746431, "comment_id": 82487754, "body": "embarrassed to say that I simply was requesting the wrong URL and getting an empty response"}], "answers": [{"tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": true, "score": 2, "last_activity_date": 1512967210, "creation_date": 1512967210, "answer_id": 47746525, "question_id": 47746431, "link": "https://stackoverflow.com/questions/47746431/go-json-unmarshall-works-with-single-entity-but-not-with-slice/47746525#47746525", "title": "Go json.Unmarshall() works with single entity but not with slice", "body": "<p>Works fine for me (try it on <a href=\"https://play.golang.org/p/UCY4RyrzAs\" rel=\"nofollow noreferrer\">playground</a>), where are you getting the payload data from? sounds like that's truncating it.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Message struct {\n    Id         int64\n    Timestamp  int64\n    Text       string\n    Author     User\n    LastEdited int64\n}\n\ntype User struct {\n    Id   int64\n    Name string\n}\n\nfunc main() {\n    body := []byte(`[\n    {\n        \"text\": \"hello, can you hear me?\",\n        \"timestamp\": 1512964800981,\n        \"author\": {\n            \"name\": \"eleven\",\n            \"id\": 4\n        },\n        \"lastEdited\": null,\n        \"id\": 7\n    }\n]`)\n\n    var m []Message\n\n    err := json.Unmarshal(body, &amp;m)\n    if err != nil {\n        fmt.Printf(\"error: %v\") // unexpected end of JSON input\n    }\n\n    for i := 0; i &lt; len(m); i++ {\n        fmt.Println(m[i].Text)\n    }\n}\n</code></pre>\n\n<p>running it gives this output</p>\n\n<pre><code>hello, can you hear me?\n</code></pre>\n"}], "owner": {"reputation": 2497, "user_id": 4280615, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/vNe8H.png?s=128&g=1", "display_name": "Nate Vaughan", "link": "https://stackoverflow.com/users/4280615/nate-vaughan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 47746525, "answer_count": 1, "score": 0, "last_activity_date": 1512967210, "creation_date": 1512966505, "question_id": 47746431, "link": "https://stackoverflow.com/questions/47746431/go-json-unmarshall-works-with-single-entity-but-not-with-slice", "title": "Go json.Unmarshall() works with single entity but not with slice", "body": "<p>I'm using Go for a simple http client. Here's the entity I'm unmarshalling:</p>\n\n<pre><code>type Message struct {\n    Id int64\n    Timestamp int64\n    Text string\n    Author User\n    LastEdited int64\n}\n\ntype User struct {\n    Id int64\n    Name string\n}\n</code></pre>\n\n<p>A single entity looks like this in JSON:</p>\n\n<pre><code>{\n    \"text\": \"hello, can you hear me?\",\n    \"timestamp\": 1512964818565,\n    \"author\": {\n        \"name\": \"andrea\",\n        \"id\": 3\n    },\n    \"lastEdited\": null,\n    \"id\": 8\n}\n</code></pre>\n\n<p>Go/json has no problem unmarshalling the single entity:</p>\n\n<pre><code>var m Message\n\nerr = json.Unmarshal(body, &amp;m)\nif err != nil {\n    printerr(err.Error())\n}\nprintln(m.Text)\n</code></pre>\n\n<p>However, if the return of the endpoint is multiple entities:</p>\n\n<pre><code>[\n    {\n        \"text\": \"hello, can you hear me?\",\n        \"timestamp\": 1512964800981,\n        \"author\": {\n            \"name\": \"eleven\",\n            \"id\": 4\n        },\n        \"lastEdited\": null,\n        \"id\": 7\n    }\n]\n</code></pre>\n\n<p>And I change my corresponding Unmarshall to work on a slice of structs, Go throws an error:</p>\n\n<pre><code>var m []Message\n\nerr = json.Unmarshal(body, &amp;m)\nif err != nil {\n    printerr(err.Error()) // unexpected end of JSON input\n}\n\nfor i := 0; i &lt; len(m); i++ {\n    println(m[i].Text)\n}\n</code></pre>\n\n<p>What gives?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1512965899, "post_id": 47746231, "comment_id": 82452787, "body": "Debug by checking the value of r.URL.Path on <a href=\"https://github.com/willnorris/imageproxy/blob/e7f9017674d9badb025048fb73bfa39782016e5d/imageproxy.go#L118\" rel=\"nofollow noreferrer\">this line</a>.  If the path is <code>&#47;250x,&#47;https:&#47;octodex.github.com&#47;images&#47;codercat.jpg</code>, then something is amiss in the proxy code.  Otherwise, there might be problem with what http.StripPrefix is doing."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1512966740, "post_id": 47746231, "comment_id": 82452973, "body": "See updated answer to   <a href=\"https://stackoverflow.com/questions/47736050/how-do-i-run-this-image-proxy-under-a-different-path/47736401#47736401\" title=\"how do i run this image proxy under a different path\">stackoverflow.com/questions/47736050/&hellip;</a>. The first argument to StripPrefix should not have a trailing &quot;/&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1512966917, "post_id": 47746231, "comment_id": 82453016, "body": "That doesn&#39;t seem to fix it. To answer your first point above: <a href=\"http://127.0.0.1:8000/proxy/250x,/https:/octodex.github.com/images/codercat.jpg\" rel=\"nofollow noreferrer\">127.0.0.1:8000/proxy/250x,/https:/octodex.github.com/images/&zwnj;&#8203;&hellip;</a> results in &quot;250x,/https:/octodex.github.com/images/codercat.jpg&quot; so it doesn&#39;t seem like it is getting cut off there."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1512967103, "post_id": 47746231, "comment_id": 82453052, "body": "Yikes, I deleted the wrong /. Answer updated again. Use current answer.  The answer my comment above directly points to the problem.  The original call to http.StripPrefix chopped off one too many characters."}, {"owner": {"reputation": 8719, "user_id": 3347384, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/unn6p.jpg?s=128&g=1", "display_name": "cchantep", "link": "https://stackoverflow.com/users/3347384/cchantep"}, "edited": false, "score": 0, "creation_date": 1579381073, "post_id": 47746231, "comment_id": 105749646, "body": "You can have a look at <a href=\"https://github.com/cchantep/nuggan\" rel=\"nofollow noreferrer\">nuggan</a> (I&#39;m a contributor of)"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1512972246, "last_edit_date": 1512972246, "creation_date": 1512970420, "answer_id": 47746982, "question_id": 47746231, "link": "https://stackoverflow.com/questions/47746231/cannot-resize-image-on-image-proxy/47746982#47746982", "title": "Cannot resize image on image proxy", "body": "<p>Use <a href=\"https://godoc.org/net/http#StripPrefix\" rel=\"nofollow noreferrer\">http.StripPrefix</a> to remove \"/proxy\" from the request path before invoking the image proxy handler. Note that there's not a trailing / on the first argument to StripPrefix.</p>\n\n<pre><code>router.NewRoute().Name(\"proxy\").Methods(\"GET\").PathPrefix(\"/proxy/\").Handler(http.StripPrefix(\"/proxy\", p))\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 47746982, "answer_count": 1, "score": 0, "last_activity_date": 1512972246, "creation_date": 1512964596, "question_id": 47746231, "link": "https://stackoverflow.com/questions/47746231/cannot-resize-image-on-image-proxy", "title": "Cannot resize image on image proxy", "body": "<p>I am trying to integrate <a href=\"http://github.com/willnorris/imageproxy/\" rel=\"nofollow noreferrer\">github.com/willnorris/imageproxy/</a> on an existing server and have the images served on \"/proxy/\" path. I have:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n    \"willnorris.com/go/imageproxy\"\n)\n\nfunc main() {\n    p := imageproxy.NewProxy(nil, nil)\n\n    router := mux.NewRouter()\n    router.NewRoute().Name(\"proxy\").Methods(\"GET\").PathPrefix(\"/proxy/\").Handler(http.StripPrefix(\"/proxy/\", p))\n\n    server := &amp;http.Server{\n        Addr:    \":8000\",\n        Handler: router,\n    }\n\n    //server.Handler = p\n\n    log.Printf(\"Listening at %v\", server.Addr)\n    log.Fatal(server.ListenAndServe())\n}\n</code></pre>\n\n<p>When I try to resize an image, the first digit seems to get cutoff:\n<code>http://127.0.0.1:8000/proxy/250x,/https:/octodex.github.com/images/codercat.jpg</code></p>\n\n<p>returns a 50x50 image rather than a 250x250 image. </p>\n\n<p>A 250x250 image is accessable by\n<code>http://127.0.0.1:8000/proxy/2250x,/https:/octodex.github.com/images/codercat.jpg</code></p>\n\n<p>Uncommenting <code>server.Handler = p</code> works and images are resized as expected. </p>\n"}, {"tags": ["go", "intellij-idea", "goland"], "comments": [{"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 2, "creation_date": 1512954537, "post_id": 47745175, "comment_id": 82450414, "body": "It\u2019s the name of the parameter."}], "answers": [{"tags": [], "owner": {"reputation": 4810, "user_id": 5006588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NOZf8.jpg?s=128&g=1", "display_name": "Christian Santos", "link": "https://stackoverflow.com/users/5006588/christian-santos"}, "is_accepted": true, "score": 18, "last_activity_date": 1512954642, "creation_date": 1512954642, "answer_id": 47745211, "question_id": 47745175, "link": "https://stackoverflow.com/questions/47745175/what-is-the-little-a-for-mean-in-goland/47745211#47745211", "title": "What is the little &quot;a:&quot; for/mean in GoLand?", "body": "<p>These are known as <a href=\"https://www.jetbrains.com/go/features/\" rel=\"noreferrer\"><strong>parameter hints</strong></a>, and they are common in JetBrains IDEs. Basically, it's the name of the parameter in the definition of <code>fmt.Println</code>. See <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"noreferrer\">the official docs</a>, where the first parameter is named <code>a</code> in the definition of <code>Println</code>. </p>\n"}], "owner": {"reputation": 3670, "user_id": 868044, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/tQcbU.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/868044/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "accepted_answer_id": 47745211, "answer_count": 1, "score": 13, "last_activity_date": 1512954705, "creation_date": 1512954334, "last_edit_date": 1512954705, "question_id": 47745175, "link": "https://stackoverflow.com/questions/47745175/what-is-the-little-a-for-mean-in-goland", "title": "What is the little &quot;a:&quot; for/mean in GoLand?", "body": "<p>In the JetBrains GoLand IDE, when I type a basic \"Hello, World!\" example, there is a small <code>a:</code> in front of the string passed to <code>fmt.Println()</code> that is added by the IDE. What does it mean and what is its purpose?</p>\n\n<p><a href=\"https://i.stack.imgur.com/fY5is.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/fY5is.png\" alt=\"small a\"></a></p>\n\n<p>I could not find the answer in the documentation.</p>\n"}, {"tags": ["html", "css", "caching", "go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512949459, "post_id": 47744629, "comment_id": 82449455, "body": "Are you running your server on your local machine or elsewhere? Can you show the browser requests? it should be obvious from that if it&#39;s requesting <code>main.css</code> or not."}, {"owner": {"reputation": 173, "user_id": 6686617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d87b55c5e49f7df8cb22b22b3328a2?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6686617/john-smith"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512949832, "post_id": 47744629, "comment_id": 82449545, "body": "I am running in on my vagrant box, using ubuntu 16.04. I&#39;ll try to post an image of what the network tab says in developer tools inside Chrome. It says it&#39;s requesting it, but an old version of it is always loaded in."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 1, "creation_date": 1512949977, "post_id": 47744629, "comment_id": 82449582, "body": "Ah, take a look at this one: <a href=\"https://stackoverflow.com/questions/20702221/http-fileserver-caching-files-and-serving-old-versions-after-edit\" title=\"http fileserver caching files and serving old versions after edit\">stackoverflow.com/questions/20702221/&hellip;</a>, same issue, also on vagrant."}, {"owner": {"reputation": 173, "user_id": 6686617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d87b55c5e49f7df8cb22b22b3328a2?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6686617/john-smith"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512950198, "post_id": 47744629, "comment_id": 82449618, "body": "That was exactly it. You know, sometime I really, REALLY hate development. This is the stuff that makes you scream at your computer for hours. In short, you&#39;re a god send."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 1, "creation_date": 1512953053, "post_id": 47744629, "comment_id": 82450166, "body": "I&#39;m out of flags for today, can someone mark this as dup and point to the question mentioned above?"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 6686617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d87b55c5e49f7df8cb22b22b3328a2?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6686617/john-smith"}, "edited": false, "score": 0, "creation_date": 1513099955, "post_id": 47754634, "comment_id": 82517839, "body": "It was not this my friend, it was an issue with deploying a go server inside a vagrant machine."}], "tags": [], "owner": {"reputation": 132, "user_id": 6015840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd1e01ac2d50e45522252bf1f804e1b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Tone", "link": "https://stackoverflow.com/users/6015840/nick-tone"}, "is_accepted": false, "score": 0, "last_activity_date": 1513001032, "creation_date": 1513001032, "answer_id": 47754634, "question_id": 47744629, "link": "https://stackoverflow.com/questions/47744629/go-server-constantly-serving-outdated-files/47754634#47754634", "title": "Go Server Constantly Serving Outdated Files", "body": "<p>Well, I'm create package with full copy of you code. All work well (add screenshot).\n<a href=\"https://i.stack.imgur.com/0wEA5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0wEA5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>May be you need check package structure? My <code>tree</code> response.</p>\n\n<pre><code>.\n\u251c\u2500\u2500 homepage.html\n\u251c\u2500\u2500 static\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 css\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.css\n\u2514\u2500\u2500 test.go\n\n2 directories, 3 files\n</code></pre>\n\n<p>Also I write unit-tests for you case. Please replace this lines to func init() in you test.go (for set handlers in <code>http.DefaultServeMux</code>)</p>\n\n<p></p>\n\n<pre><code> func init() {\n    http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n    http.HandleFunc(\"/\", HomePage)\n }\n</code></pre>\n\n<p><code>test_test.go</code> this code compare equality static/css/main.css and <a href=\"http://localhost:8000/static/css/main.css\" rel=\"nofollow noreferrer\">http://localhost:8000/static/css/main.css</a>.</p>\n\n<p></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"testing\"\n)\n\nfunc test(no int, name, addr, filepath string) error {\n    var (\n        err        error\n        body, data []byte\n        resp       *http.Response\n\n        fmtError = func(step string, err error) error {\n            return fmt.Errorf(\"Test #%d: error in testing &lt;%s&gt; in '%s' method\n    %s\", no, step, name, err)\n        }\n    )\n\n    if resp, err = http.Get(addr); err != nil {\n        return fmtError(fmt.Sprintf(\"HTTP GET %s\", addr), err)\n    } else if no == 0 {\n        return nil\n    }\n\n    if data, err = ioutil.ReadFile(filepath); err != nil {\n        return fmtError(\"read file\", err)\n    }\n\n    if body, err = ioutil.ReadAll(resp.Body); err != nil {\n        return fmtError(\"read response data\", err)\n    } else if string(body) != string(data) {\n        return fmtError(\"compare data\", fmt.Errorf(\"File data and response body not equal\"))\n    } else if err = resp.Body.Close(); err != nil {\n        return fmtError(\"HTTP response body close\", err)\n    }\n\n    return nil\n}\n\nfunc TestServer(t *testing.T) {\n    var (\n        ts = httptest.NewServer(http.DefaultServeMux)\n\n        testData = []struct {\n            Name, Addr, File string\n        }{\n            {\n                Name: \"Index\",\n                Addr: \"/\",\n                File: \"homepage.html\",\n            },\n            {\n                Name: \"main.css\",\n                Addr: \"/static/css/main.css\",\n                File: \"static/css/main.css\",\n            },\n        }\n    )\n    defer ts.Close()\n\n    for i, tt := range testData {\n        if err := test(i, tt.Name, ts.URL+tt.Addr, tt.File); err != nil {\n            t.Fatal(err)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 6686617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d87b55c5e49f7df8cb22b22b3328a2?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6686617/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "closed_date": 1513018610, "answer_count": 1, "score": 0, "last_activity_date": 1513001032, "creation_date": 1512948964, "question_id": 47744629, "link": "https://stackoverflow.com/questions/47744629/go-server-constantly-serving-outdated-files", "closed_reason": "Duplicate", "title": "Go Server Constantly Serving Outdated Files", "body": "<p>I'm using Go to build a website. When serving in static files, css and js, no matter what I do the updates to files will not show. I've tried cache busting, deleting cache in my web browser, and deleting the disk cache on my computer, but no matter what ( even across different browsers ) an old version of the file is served. I've looked all over an found no answers.</p>\n\n<p>To illustrate, I have a file main.css</p>\n\n<pre><code>html {\n    text-align:center;\n}\n</code></pre>\n\n<p>However, the following css ( from an older file ) shows up in browser</p>\n\n<pre><code>html {\n    background-color:red;\n}\n</code></pre>\n\n<p>Chrome's Developer Tools saying the css is loading in with a status of 200.</p>\n\n<p><strong>My Questions:</strong></p>\n\n<p>1) What is going on?</p>\n\n<p>2) How do I fix this issue?</p>\n\n<p>My code is as follows:\n<strong>test.go</strong>\n    package main</p>\n\n<pre><code>import (\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n)\n\ntype PageVariables struct {\n    Name         string\n}\n\nfunc main() {\n    http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n    http.HandleFunc(\"/\", HomePage)\n    log.Fatal(http.ListenAndServe(\":8000\", nil))\n}\n\nfunc HomePage(w http.ResponseWriter, r *http.Request){\n    HomePageVars := PageVariables{ //store the date and time in a struct\n      Name: \"PDiddy\",\n    }\n    t, err := template.ParseFiles(\"homepage.html\") //parse the html file homepage.html\n    if err != nil { // if there is an error\n      log.Print(\"template parsing error: \", err) // log it\n    }\n    err = t.Execute(w, HomePageVars) //execute the template and pass it the HomePageVars struct to fill in the gaps\n    if err != nil { // if there is an error\n      log.Print(\"template executing error: \", err) //log it\n    }\n}\n</code></pre>\n\n<p><strong>homepage.html</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;My Page&lt;/title&gt;\n&lt;!-- Latest compiled and minified CSS --&gt;\n&lt;link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\"&gt;\n\n&lt;!-- jQuery library --&gt;\n&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js\"&gt;&lt;/script&gt;\n\n&lt;!-- Latest compiled JavaScript --&gt;\n&lt;script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"&gt;&lt;/script&gt;\n&lt;link rel=\"stylesheet\" href=\"./static/css/main.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;div class=\"container-fluid\"&gt;\n  &lt;div class=\"jumbotron\"&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;h1&gt;Welcome to HQ {{.Name}}&lt;/h1&gt;\n      &lt;div class=\"col-sm-4\"&gt;\n          &lt;h2&gt;Here's Whats Happening&lt;/h2&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col-sm-8\"&gt;\n          &lt;h2&gt;Select A Company&lt;/h2&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 2, "creation_date": 1512948931, "post_id": 47744574, "comment_id": 82449325, "body": "Can you list the requests as seen by your browser? This may be due to the fact that none of your handlers are actually writing a response."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 2, "creation_date": 1512949122, "post_id": 47744574, "comment_id": 82449381, "body": "Actually, I wouldn&#39;t be surprised if this was the browser looking for the favicon. The best match for that would be <code>handler</code>. That would explain the extra response, but that&#39;s because it&#39;s a whole other request made by the browser."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1512949457, "post_id": 47744574, "comment_id": 82449454, "body": "It&#39;s probably a request for <code>&#47;favicon.ico</code>."}, {"owner": {"reputation": 20869, "user_id": 990524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rJPoP.jpg?s=128&g=1", "display_name": "Adrian Cornish", "link": "https://stackoverflow.com/users/990524/adrian-cornish"}, "edited": false, "score": 0, "creation_date": 1512949702, "post_id": 47744574, "comment_id": 82449511, "body": "Yup the favicon - thanks guys <code>[adrian@stellajay server2]$ .&#47;server2 I am here in handler GET &#47;countjgjhg HTTP&#47;1.1 I am here in handler GET &#47;favicon.ico HTTP&#47;1.1  I am here in counter GET &#47;count HTTP&#47;1.1 I am here in handler GET &#47;favicon.ico HTTP&#47;1.1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 20869, "user_id": 990524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rJPoP.jpg?s=128&g=1", "display_name": "Adrian Cornish", "link": "https://stackoverflow.com/users/990524/adrian-cornish"}, "is_accepted": true, "score": 0, "last_activity_date": 1512949833, "creation_date": 1512949833, "answer_id": 47744727, "question_id": 47744574, "link": "https://stackoverflow.com/questions/47744574/why-are-both-http-handlers-being-called/47744727#47744727", "title": "Why are both http handlers being called", "body": "<p>As people mentioned in the comments it is the browser requesting the favicon which I proved by printing the GET requests as well</p>\n\n<pre><code>[adrian@stellajay server2]$ ./server2\nI am here in handler\nGET /countjgjhg HTTP/1.1\nI am here in handler\nGET /favicon.ico HTTP/1.1\n\nI am here in counter\nGET /count HTTP/1.1\nI am here in handler\nGET /favicon.ico HTTP/1.1\n</code></pre>\n"}], "owner": {"reputation": 20869, "user_id": 990524, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rJPoP.jpg?s=128&g=1", "display_name": "Adrian Cornish", "link": "https://stackoverflow.com/users/990524/adrian-cornish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "closed_date": 1512951600, "accepted_answer_id": 47744727, "answer_count": 1, "score": 0, "last_activity_date": 1512951943, "creation_date": 1512948529, "question_id": 47744574, "link": "https://stackoverflow.com/questions/47744574/why-are-both-http-handlers-being-called", "closed_reason": "Duplicate", "title": "Why are both http handlers being called", "body": "<p>Why are both handlers called each time I hit the server with a browser. I thought only one or the other would be called according to the book. What am I missing. If I hit url <code>http://localhost:8000/foobar</code> - I am handler is printed twice and if I hit <code>http://localhost:8000/count</code> - I am handler and I am count are both printed.</p>\n\n<pre><code>// Copyright \u00a9 2016 Alan A. A. Donovan &amp; Brian W. Kernighan.\n// License: https://creativecommons.org/licenses/by-nc-sa/4.0/\n\n// See page 20.\n//!+\n\n// Server2 is a minimal \"echo\" and counter server.\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"sync\"\n)\n\nvar mu sync.Mutex\nvar count int\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.HandleFunc(\"/count\", counter)\n    log.Fatal(http.ListenAndServe(\"localhost:8000\", nil))\n}\n\n// handler echoes the Path component of the requested URL.\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    mu.Lock()\n    count++\n    mu.Unlock()\n    fmt.Fprintf(w, \"URL.Path = %q\\n\", r.URL.Path)\n    fmt.Println(\"I am here in handler\")\n}\n\n// counter echoes the number of calls so far.\nfunc counter(w http.ResponseWriter, r *http.Request) {\n    mu.Lock()\n    fmt.Fprintf(w, \"Count %d\\n\", count)\n    mu.Unlock()\n    fmt.Println(\"I am here in counter\")\n}\n\n//!-\n</code></pre>\n"}, {"tags": ["unit-testing", "go", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4921479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce7475845c079a76e67d0e8c49a4911?s=128&d=identicon&r=PG&f=1", "display_name": "achnichtsowichtig", "link": "https://stackoverflow.com/users/4921479/achnichtsowichtig"}, "edited": false, "score": 0, "creation_date": 1513026000, "post_id": 47744562, "comment_id": 82483951, "body": "Thank you so much Marc! Your idea was exactly right. My path was relativ. When running the unit-test the path was false, when running main.go, it fit. Super easy, if you know it."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 1, "last_activity_date": 1512948386, "creation_date": 1512948386, "answer_id": 47744562, "question_id": 47744451, "link": "https://stackoverflow.com/questions/47744451/unable-to-open-sqlite-database-in-golang-unable-to-open-database-file-recover/47744562#47744562", "title": "Unable to open SQLite database in golang: &quot;unable to open database file [recovered]&quot;-error", "body": "<p><code>sql.Open</code> usually does not perform any database operations, it merely initializes the driver (see <a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"nofollow noreferrer\">sql.Open docs</a> for details). The driver's <code>Open()</code> method is called in the background.</p>\n\n<p>This means that the first error is usually encountered on trying to perform an operation, in your case: the <code>db.Exec</code>.</p>\n\n<p>As for the actual error: if this is in tests it is likely that your path is not correct (eg: if the test database is in the test's sub-directory, the test runner's current directory will be different, I think). Try to switch to absolute paths (or paths computed at runtime).</p>\n\n<p>And a small nit: move <code>defer db.Close()</code> after the first error check.</p>\n"}], "owner": {"reputation": 97, "user_id": 4921479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce7475845c079a76e67d0e8c49a4911?s=128&d=identicon&r=PG&f=1", "display_name": "achnichtsowichtig", "link": "https://stackoverflow.com/users/4921479/achnichtsowichtig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1931, "favorite_count": 0, "accepted_answer_id": 47744562, "answer_count": 1, "score": 0, "last_activity_date": 1512948386, "creation_date": 1512947400, "question_id": 47744451, "link": "https://stackoverflow.com/questions/47744451/unable-to-open-sqlite-database-in-golang-unable-to-open-database-file-recover", "title": "Unable to open SQLite database in golang: &quot;unable to open database file [recovered]&quot;-error", "body": "<p>I am just starting learning golang and am not sure if my error is conceptual or with the language. </p>\n\n<p>It is peculiar, because the error only occurs, when unit-testing my code. If I \"go run\" everything works fine. As a sqlite-driver I use <a href=\"http://github.com/mattn/go-sqlite3\" rel=\"nofollow noreferrer\">mattn/go-sqlite3</a>.</p>\n\n<p>Here is where the problem occurs:</p>\n\n<pre><code>    func dbExec(command *string) {\n    db, err := sql.Open(\"sqlite3\", dbPath) // Path and driver are set correcrtly\n    defer db.Close()\n    if err != nil { //No problem here\n        panic(err)\n    }\n    _, err = db.Exec(*command)\n    if err != nil { //Here the errorNo14 \"Unable to open the database file\" occurs\n        panic(err)\n    }\n }\n</code></pre>\n\n<p>So it seems to me, that the database file can be found, but it can't be open because of other limits. I have no concurrency in all of my code. I have only one test-method so far, so even if the testing would be done concurrently, it would so far be only one thread. Maybe someone has an idea! The problem seems to basic, there really is not much more to my code then this.</p>\n"}, {"tags": ["go", "macos-high-sierra"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1512938383, "post_id": 47743194, "comment_id": 82446559, "body": "This is a threaddump, where is the main panic error message?"}, {"owner": {"reputation": 39, "user_id": 4826605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYcCw.jpg?s=128&g=1", "display_name": "T_Lube", "link": "https://stackoverflow.com/users/4826605/t-lube"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1512938611, "post_id": 47743194, "comment_id": 82446618, "body": "You kind of lost me. Is this what you meant? &quot;fatal error: unexpected signal during runtime execution [signal 0xb code=0x1 addr=0x62ab9765895 pc=0xa6b39]&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1512938654, "post_id": 47743194, "comment_id": 82446627, "body": "Update your go installation."}, {"owner": {"reputation": 39, "user_id": 4826605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYcCw.jpg?s=128&g=1", "display_name": "T_Lube", "link": "https://stackoverflow.com/users/4826605/t-lube"}, "edited": false, "score": 0, "creation_date": 1512938970, "post_id": 47743194, "comment_id": 82446712, "body": "good point, I guess it has been a while ;)"}], "owner": {"reputation": 39, "user_id": 4826605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dYcCw.jpg?s=128&g=1", "display_name": "T_Lube", "link": "https://stackoverflow.com/users/4826605/t-lube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512938244, "creation_date": 1512938244, "question_id": 47743194, "link": "https://stackoverflow.com/questions/47743194/high-sierra-blocking-localhost-server-startup", "title": "High Sierra blocking &quot;localhost&quot; server startup?", "body": "<p>I am trying to start a simple server for learning Go on my Mac. I was using Yosemite where this worked fine</p>\n\n<pre><code>err := http.ListenAndServe(\":8080\", nil)\n</code></pre>\n\n<p>at the console (in the right dir, I double checked)</p>\n\n<pre><code>go run main-1.go\n</code></pre>\n\n<p>in my Go Code. however with High Sierra I get a huge list of errors of which I have no understanding (still learning). I doubt posting the errors are going to do anything, because hey, look I am still a newb and wouldn't track with the answers anyway.</p>\n\n<p>So is there some basic thing that someone else has run into that solves this, like a setting on my Mac? Like is there some security feature that got added that I can change and so allow my learning to continue?</p>\n\n<p>PS here is the list of errors</p>\n\n<pre><code>goroutine 1 [running]:\nruntime.systemstack_switch()\n    /usr/local/go/src/runtime/asm_amd64.s:216 fp=0xc820147488 sp=0xc820147480\nruntime.writebarrierptr_nostore1(0xc82050b4b8, 0xc8200166c0)\n    /usr/local/go/src/runtime/mbarrier.go:118 +0x71 fp=0xc8201474c0 sp=0xc820147488\nruntime.writebarrierptr(0xc82050b4b8, 0xc8200166c0)\n    /usr/local/go/src/runtime/mbarrier.go:137 +0x4b fp=0xc8201474f0 sp=0xc8201474c0\ngo/token.(*FileSet).AddFile(0xc82050ac80, 0xc8201128a0, 0x22, 0x923, 0x104, 0x0)\n    /usr/local/go/src/go/token/position.go:380 +0x2d5 fp=0xc820147580 sp=0xc8201474f0\ngo/parser.(*parser).init(0xc820536000, 0xc82050ac80, 0xc8201128a0, 0x22, 0xc82008c600, 0x104, 0x200, 0x6)\n    /usr/local/go/src/go/parser/parser.go:74 +0x4c fp=0xc8201475d0 sp=0xc820147580\ngo/parser.ParseFile(0xc82050ac80, 0xc8201128a0, 0x22, 0x3e2e20, 0xc82000d160, 0x6, 0x0, 0x0, 0x0)\n    /usr/local/go/src/go/parser/interface.go:116 +0x199 fp=0xc820147640 sp=0xc8201475d0\ngo/build.(*Context).Import(0x7a6860, 0xc82050e391, 0x2, 0xc8204e0840, 0x15, 0x4, 0x0, 0x0, 0x0)\n    /usr/local/go/src/go/build/build.go:679 +0x2597 fp=0xc8201480d8 sp=0xc820147640\nmain.loadImport(0xc82050e391, 0x2, 0xc8204e0840, 0x15, 0xc8204c3800, 0xc8201498c0, 0xc820514280, 0x2, 0x2, 0x1, ...)\n    /usr/local/go/src/cmd/go/pkg.go:344 +0x687 fp=0xc8201483a0 sp=0xc8201480d8\nmain.(*Package).load(0xc8204c3800, 0xc8201498c0, 0xc820399200, 0x0, 0x0, 0x4)\n    /usr/local/go/src/cmd/go/pkg.go:899 +0x42e1 fp=0xc820148c00 sp=0xc8201483a0\nmain.loadImport(0xc82015bf31, 0x3, 0xc82015e5a0, 0x2a, 0xc820160c00, 0xc8201498c0, 0xc82015e8a0, 0x1, 0x1, 0x1, ...)\n    /usr/local/go/src/cmd/go/pkg.go:374 +0xd67 fp=0xc820148ec8 sp=0xc820148c00\nmain.(*Package).load(0xc820160c00, 0xc8201498c0, 0xc820172600, 0x0, 0x0, 0x0)\n    /usr/local/go/src/cmd/go/pkg.go:899 +0x42e1 fp=0xc820149728 sp=0xc820148ec8\nmain.goFilesPackage(0xc82000a2f0, 0x1, 0x1, 0x8)\n    /usr/local/go/src/cmd/go/build.go:750 +0x836 fp=0xc820149a50 sp=0xc820149728\nmain.runRun(0x79fe80, 0xc82000a2f0, 0x1, 0x1)\n    /usr/local/go/src/cmd/go/run.go:87 +0x479 fp=0xc820149c40 sp=0xc820149a50\nmain.main()\n    /usr/local/go/src/cmd/go/main.go:181 +0x782 fp=0xc820149f30 sp=0xc820149c40\nruntime.main()\n    /usr/local/go/src/runtime/proc.go:111 +0x2b0 fp=0xc820149f80 sp=0xc820149f30\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:1696 +0x1 fp=0xc820149f88 sp=0xc820149f80\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:1696 +0x1\n\ngoroutine 5 [syscall]:\nos/signal.loop()\n    /usr/local/go/src/os/signal/signal_unix.go:22 +0x18\ncreated by os/signal.init.1\n    /usr/local/go/src/os/signal/signal_unix.go:28 +0x37\n</code></pre>\n"}, {"tags": ["sorting", "go", "slice", "quicksort"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512915281, "post_id": 47739638, "comment_id": 82439529, "body": "This will not even build. Please show a include a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1512926240, "post_id": 47739638, "comment_id": 82442766, "body": "A golang map, which is just a hash table, is by definition unordered. There&#39;s no way you can sort the data it actually holds. At best, you can create a wrapper type comprised of the actual map, and a slice holding the keys, and sort the slice. When you iterate the map, then, you&#39;d actually iterate the ordered slice and retrieve the data from the map in a set order. This is fairly trivial to implement, yet I can&#39;t help but feel like you&#39;re trying to solve an X-Y problem here. What are you trying to do? Maybe there&#39;s a better way"}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 1, "last_activity_date": 1512915098, "creation_date": 1512915098, "answer_id": 47739688, "question_id": 47739638, "link": "https://stackoverflow.com/questions/47739638/how-to-sort-a-mapintint-by-its-values/47739688#47739688", "title": "How to sort a map[int]int by its values?", "body": "<p>Go maps are unordered data structures. No matter what you do it will not be sorted, either by key or by value.</p>\n\n<p>If you want to sort your values, you should use a slice and perform your quicksort over that.</p>\n\n<p>See the <a href=\"https://golang.org/ref/spec#Map_types\" rel=\"nofollow noreferrer\">Go spec</a> or <a href=\"https://golang.org/doc/effective_go.html#maps\" rel=\"nofollow noreferrer\">Effective Go</a> for more details.</p>\n"}], "owner": {"reputation": 5, "user_id": 9034441, "user_type": "registered", "profile_image": "https://graph.facebook.com/295819290928032/picture?type=large", "display_name": "Sam", "link": "https://stackoverflow.com/users/9034441/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "closed_date": 1512939900, "answer_count": 1, "score": -2, "last_activity_date": 1512915938, "creation_date": 1512914765, "last_edit_date": 1512915938, "question_id": 47739638, "link": "https://stackoverflow.com/questions/47739638/how-to-sort-a-mapintint-by-its-values", "closed_reason": "Duplicate", "title": "How to sort a map[int]int by its values?", "body": "<p>My insertion and quicksort does not work on map[uint64]uint64 values. Can anyone help? Thanks in advance. Would like to have sort of the map \"aint\" by value.</p>\n\n<p>Please ask for details if any. I will improve on this question. Thanks again.</p>\n\n<pre><code>package main\n\nimport (\n    \"sort\"\n    \"fmt\"\n    \"time\"\n    \"runtime\"\n    \"math/rand\"\n)\n    func main() {\n\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    start := time.Now()\n\n    //the map variable\n    aint := map[uint64]uint64{}\n\n    start = time.Now()\n    for i := uint64(0); i &lt; 100000000; i++ {\n            aint[i+32132112313] = uint64(rand.Intn(13123123123)+2312423213) //random generation of input data\n//              aint = insertSort(aint,uint64(rand.Intn(13123123123)))\n    }\n    fmt.Printf(\"%d\\n\", aint[22] )\n\n    elapsed := time.Since(start)\n    fmt.Printf(\"Entry took %s %d\\n\", elapsed)\n\n    start = time.Now()\n    quicksort(aint)\n\n    //      sort.Sort(sort.IntSlice(aint))\n\n    elapsed = time.Since(start)\n    fmt.Printf(\"Sorting took %s %d\\n\", elapsed)\n}\nfunc insertionsort(items []int) {\n    var n = len(items)\n    for i := 1; i &lt; n; i++ {\n            j := i\n            for j &gt; 0 {\n                    if items[j-1] &gt; items[j] {\n                            items[j-1], items[j] = items[j], items[j-1]\n                    }\n                    j = j - 1\n            }\n    }\n}\n\n\nfunc quicksort(a map[uint64]uint64) map[uint64]uint64 {\n    if len(a) &lt; 2 {\n            return a\n    }\n\n    left, right := uint64(0), uint64(len(a)-1)\n\n    pivot := Uint64() % uint64(len(a))\n\n    a[pivot], a[right] = a[right], a[pivot]\n    // does not work anymore from here onwards.\n    for uint64(i), _ := range a {\n            if a[i] &lt; a[right] {\n                    a[left], a[i] = a[i], a[left]\n                    left++\n            }\n    }\n\n    a[left], a[right] = a[right], a[left]\n\n    quicksort(a[:left])\n    quicksort(a[left+1:])\n\n    return a\n}\n</code></pre>\n"}, {"tags": ["json", "rest", "go", "beego"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512913714, "post_id": 47739398, "comment_id": 82439149, "body": "<a href=\"https://beego.me/docs/mvc/controller/jsonxml.md\" rel=\"nofollow noreferrer\">beego.me/docs/mvc/controller/jsonxml.md</a>"}, {"owner": {"reputation": 503, "user_id": 2044343, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/5f669e11a7a25ff428b8332d35e06986?s=128&d=identicon&r=PG", "display_name": "wizard", "link": "https://stackoverflow.com/users/2044343/wizard"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512915148, "post_id": 47739398, "comment_id": 82439490, "body": "I want to parse the json dynamically."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512915678, "post_id": 47739398, "comment_id": 82439632, "body": "As stated in the link <code>ServeJSON</code> &quot;JSONifies&quot; what you set as the value of <code>Data[&quot;json&quot;]</code>, that means that a string gets turned into valid json string, regardless of the content of the string, that&#39;s why its escaped. <code>ServeJSON</code> is not meant to be used with strings containing json."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1512915908, "post_id": 47739398, "comment_id": 82439672, "body": "If you want to send strings containing valid json you can use <code>u.Ctx.Output.Body(bytes []byte)</code>, use <code>[]byte(str)</code> to convert your string into bytes. You&#39;ll need to also set the HTTP header Content-Type, which you can do like this: <code>u.Ctx.Output.Header(&quot;Content-Type&quot;, &quot;application&#47;json&quot;)</code>."}, {"owner": {"reputation": 503, "user_id": 2044343, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/5f669e11a7a25ff428b8332d35e06986?s=128&d=identicon&r=PG", "display_name": "wizard", "link": "https://stackoverflow.com/users/2044343/wizard"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512916106, "post_id": 47739398, "comment_id": 82439733, "body": "In JS I would parse to JSON to JS object beforehand, so what should I do in go?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512916379, "post_id": 47739398, "comment_id": 82439814, "body": "<code>ServeJSON</code> does that for you, so it expects a value that can be turned into json (e.g. a struct that has exported fields and the proper field tags), just like in the example where they pass <code>mystruct</code>, that value gets turned into a json object."}, {"owner": {"reputation": 503, "user_id": 2044343, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/5f669e11a7a25ff428b8332d35e06986?s=128&d=identicon&r=PG", "display_name": "wizard", "link": "https://stackoverflow.com/users/2044343/wizard"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512919334, "post_id": 47739398, "comment_id": 82440692, "body": "@mkopriva tnx! I updated your solution in my question. You can post the second solution with <code>mystruct</code> here."}], "answers": [{"tags": [], "owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "is_accepted": false, "score": 0, "last_activity_date": 1535079544, "creation_date": 1535079544, "answer_id": 51996839, "question_id": 47739398, "link": "https://stackoverflow.com/questions/47739398/how-to-pass-json-response-in-go-beego-framework/51996839#51996839", "title": "How to pass JSON response in Go BeeGo framework?", "body": "<p>Try this:</p>\n\n<pre><code>func (u *ServiceController) GetAll() {\n    req := httplib.Get(\"http://localhost/api/1/services\")\n    str, err := req.Bytes()\n    // str = {\"id\":1, \"name\":\"some service\"}\n    if err != nil {\n        fmt.Println(err)\n    }\n    u.Ctx.Output.Header(\"Content-Type\", \"text/plain;charset=UTF-8\")\n    u.Ctx.ResponseWriter.Write(str)\n}\n</code></pre>\n\n<p>If you call <code>req.String()</code>, it will encode the <code>\"</code> in the json string. I suggest you use <code>[]byte</code> to handle data usually.</p>\n"}], "owner": {"reputation": 503, "user_id": 2044343, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/5f669e11a7a25ff428b8332d35e06986?s=128&d=identicon&r=PG", "display_name": "wizard", "link": "https://stackoverflow.com/users/2044343/wizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 810, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1535079544, "creation_date": 1512913065, "last_edit_date": 1512919236, "question_id": 47739398, "link": "https://stackoverflow.com/questions/47739398/how-to-pass-json-response-in-go-beego-framework", "title": "How to pass JSON response in Go BeeGo framework?", "body": "<p>I'm building microservices app with go and beego. I'm trying to pass JSON response from service A to service B as following: </p>\n\n<pre><code>func (u *ServiceController) GetAll() {\n    req := httplib.Get(\"http://localhost/api/1/services\")\n    str, err := req.String()\n    // str = {\"id\":1, \"name\":\"some service\"}\n    if err != nil {\n        fmt.Println(err)\n    }\n    u.Data[\"json\"] = str\n    u.ServeJSON()\n}\n</code></pre>\n\n<p>However, when I send the response I actually double json encoding:</p>\n\n<pre><code>\"{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"some service\\\"}\"\n</code></pre>\n\n<p>Finally, this is the solution I came up with: </p>\n\n<pre><code>func (u *ServiceController) GetAll() {\n    req := httplib.Get(\"http://localhost/api/1/services\")\n    str, err := req.String()\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    strToByte := []byte(str)\n    u.Ctx.Output.Header(\"Content-Type\", \"application/json\")\n    u.Ctx.Output.Body(strToByte)\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "go", "reflection"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512913276, "post_id": 47739395, "comment_id": 82439043, "body": "<code>time.Time</code> is a struct, so <code>reflect.Struct</code> if you&#39;re looking for the kind, or else do <code>f.Interface()</code> to get the field value as an <code>interface{}</code> and then do type assertion on it <code>if t, ok := f.Interface().(time.Time); ok { ...</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1512913463, "post_id": 47739395, "comment_id": 82439095, "body": "... example of the above comment <a href=\"https://play.golang.org/p/T9yG5PoRbP\" rel=\"nofollow noreferrer\">play.golang.org/p/T9yG5PoRbP</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": true, "score": 10, "last_activity_date": 1512914643, "creation_date": 1512914643, "answer_id": 47739620, "question_id": 47739395, "link": "https://stackoverflow.com/questions/47739395/go-type-switch-with-time-time/47739620#47739620", "title": "Go type switch with `time.Time`", "body": "<p>Judging from what you are trying to do, you don't really need reflection after getting the field. Here is a sample that works with <code>time.Time</code> too.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc getField(v interface{}, field string) string {\n    r := reflect.ValueOf(v)\n    f := reflect.Indirect(r).FieldByName(field)\n    fieldValue := f.Interface()\n\n    switch v := fieldValue.(type) {\n    case int64:\n        return strconv.FormatInt(v, 10)\n    case int32:\n        return strconv.FormatInt(int64(v), 10)\n    case int:\n        return strconv.FormatInt(int64(v), 10)\n    case string:\n        return v\n    case bool:\n        if v {\n            return \"true\"\n        }\n        return \"false\"\n    case time.Time:\n        return v.String()\n    default:\n        return \"\"\n    }\n}\n\ntype MyStruct struct {\n    Name   string\n    Number int32\n    Is     bool\n    Clock  time.Time\n}\n\nfunc main() {\n    s := MyStruct{}\n    fmt.Println(getField(s, \"Name\"))\n    fmt.Println(getField(s, \"Number\"))\n    fmt.Println(getField(s, \"Is\"))\n    fmt.Println(getField(s, \"Clock\"))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23187, "user_id": 365695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/da2febfbe6953d360e020f4e15410795?s=128&d=identicon&r=PG", "display_name": "Aaron Harun", "link": "https://stackoverflow.com/users/365695/aaron-harun"}, "edited": false, "score": 4, "creation_date": 1569395033, "post_id": 53768862, "comment_id": 102578206, "body": "This will actually return true for <i>any</i> struct."}], "tags": [], "owner": {"reputation": 117, "user_id": 1165193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3825e08ccde6a055a477e11d5941dd6?s=128&d=identicon&r=PG", "display_name": "Seray Uzgur", "link": "https://stackoverflow.com/users/1165193/seray-uzgur"}, "is_accepted": false, "score": 1, "last_activity_date": 1544729544, "creation_date": 1544729544, "answer_id": 53768862, "question_id": 47739395, "link": "https://stackoverflow.com/questions/47739395/go-type-switch-with-time-time/53768862#53768862", "title": "Go type switch with `time.Time`", "body": "<p>Just for having an alternative solution, you can always hold <em>kind</em>s as <em>var</em>s and use them in a case.</p>\n\n<pre><code>var timeKind = reflect.TypeOf(time.Time{}).Kind()\n\nfunc getField(v interface{}, field string) string {\n    r := reflect.ValueOf(v)\n    f := reflect.Indirect(r).FieldByName(field)\n    t := f.Kind()\n\n    switch t {\n    case reflect.Int, reflect.Int64:\n        return strconv.FormatInt(f.Int(), 10)\n    case reflect.String:\n        return f.String()\n    case reflect.Bool:\n        if f.Bool() {\n            return \"true\"\n        }\n        return \"false\"\n    case timeKind: // i am here!!!\n       // do whatever you want\n    return \"\"\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7493952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eee9b88bdd8301c71e68cb71202bb7a?s=128&d=identicon&r=PG&f=1", "display_name": "Shen SXueck", "link": "https://stackoverflow.com/users/7493952/shen-sxueck"}, "is_accepted": false, "score": 0, "last_activity_date": 1608781598, "creation_date": 1608781598, "answer_id": 65433718, "question_id": 47739395, "link": "https://stackoverflow.com/questions/47739395/go-type-switch-with-time-time/65433718#65433718", "title": "Go type switch with `time.Time`", "body": "<p>It took me two hours to finally fix this problem. In fact, the underlying implementation of the time type is a struct, You can find out if you check its kind</p>\n<pre><code>const TimeStringKind = &quot;time.Time&quot;\n\nfunc getFieldName(obj interface{}, columnName string) reflect.Value {\n    defer func() {\n        if err := recover(); err != nil {\n            Log.Errorf(&quot;parse cloumn error : %s&quot;, err)\n        }\n    }()\n\n    t := reflect.ValueOf(obj)\n\n    if t.Kind() == reflect.Ptr {\n        t = t.Elem()\n    }\n\n    ...\n        // what made me wrong\n        if t.Kind() != reflect.Struct &amp;&amp; t.Kind() != reflect.Slice {\n            return t\n        }\n    }\n\n    // fix patch code\n    if t.Type().String() == TimeStringKind {\n        return t\n    }\n\n    return reflect.Value{}\n}\n\nfunc GetFieldNameString(obj interface{}, columnName string) string {\n    value := getFieldName(obj, columnName)\n\n    if !reflect.DeepEqual(value, reflect.Value{}) {\n        switch value.Type().String() {\n        case &quot;string&quot;, &quot;int&quot;:\n            return value.String()\n        case TimeStringKind:\n            return value.Interface().(time.Time).String()\n        }\n    }\n    return &quot;&quot;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2842, "user_id": 648741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/47813cc59b0edb414b88601f1defe02a?s=128&d=identicon&r=PG", "display_name": "jochen", "link": "https://stackoverflow.com/users/648741/jochen"}, "is_accepted": false, "score": 0, "last_activity_date": 1610397522, "creation_date": 1610397522, "answer_id": 65674189, "question_id": 47739395, "link": "https://stackoverflow.com/questions/47739395/go-type-switch-with-time-time/65674189#65674189", "title": "Go type switch with `time.Time`", "body": "<p>Here is a function which tests whether a <code>reflect.Value</code> represents a <code>time.Time</code> object:</p>\n<pre><code>func isTime(obj reflect.Value) bool {\n    _, ok := obj.Interface().(time.Time)\n    return ok\n}\n</code></pre>\n<p>(full code on the <a href=\"https://play.golang.org/p/GCTGuV6XGc4\" rel=\"nofollow noreferrer\">Go Playground</a>).</p>\n"}], "owner": {"reputation": 3126, "user_id": 85010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5a1b964e34cc2b1d3e233fa387b791b0?s=128&d=identicon&r=PG", "display_name": "fiskeben", "link": "https://stackoverflow.com/users/85010/fiskeben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3600, "favorite_count": 0, "accepted_answer_id": 47739620, "answer_count": 4, "score": 2, "last_activity_date": 1610397522, "creation_date": 1512913027, "question_id": 47739395, "link": "https://stackoverflow.com/questions/47739395/go-type-switch-with-time-time", "title": "Go type switch with `time.Time`", "body": "<p>In my test I have a function that can get a value from a struct like this:</p>\n\n<pre><code>func getField(v interface{}, field string) string {\n    r := reflect.ValueOf(v)\n    f := reflect.Indirect(r).FieldByName(field)\n    t := f.Kind()\n\n    switch t {\n    case reflect.Int, reflect.Int64:\n        return strconv.FormatInt(f.Int(), 10)\n    case reflect.String:\n        return f.String()\n    case reflect.Bool:\n        if f.Bool() {\n            return \"true\"\n        }\n        return \"false\"\n    return \"\"\n}\n</code></pre>\n\n<p>This works for the types above but I can't get it to work for <code>time.Time</code>. How do I do this?</p>\n"}, {"tags": ["go", "storage", "system-calls", "iscsi"], "comments": [{"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 1, "creation_date": 1512932989, "post_id": 47739092, "comment_id": 82444935, "body": "Please show a minimum working example, when you refer to &quot;whole class&quot; things become a little confusing. Go has no classes :)"}], "answers": [{"tags": [], "owner": {"reputation": 562, "user_id": 3012123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/811868539/picture?type=large", "display_name": "TzurEl", "link": "https://stackoverflow.com/users/3012123/tzurel"}, "is_accepted": true, "score": 0, "last_activity_date": 1513002097, "creation_date": 1513002097, "answer_id": 47754962, "question_id": 47739092, "link": "https://stackoverflow.com/questions/47739092/using-exec-commandcontext-with-sg-inq-sys-comand-and-timeout-never-returns/47754962#47754962", "title": "Using exec.CommandContext with sg_inq sys comand and timeout never returns", "body": "<p>The solution was pretty simple actually.\nThe main problem was that the systemcall didn't always function properly. I've researched this using these links:</p>\n\n<p><a href=\"http://www.darrencoxall.com/golang/executing-commands-in-go/\" rel=\"nofollow noreferrer\">http://www.darrencoxall.com/golang/executing-commands-in-go/</a><br>\n<a href=\"https://github.com/ryankurte/go-async-cmd/blob/master/cmd.go\" rel=\"nofollow noreferrer\">https://github.com/ryankurte/go-async-cmd/blob/master/cmd.go</a></p>\n\n<p>I found out that the only place to read the output of a command was before cmd.Wait() and after cmd.Start(). That's why I kept getting an empty byte array.\nThe code did return, it was just empty.</p>\n\n<p>What I found out more - \n<a href=\"https://medium.com/@vCabbage/go-timeout-commands-with-os-exec-commandcontext-ba0c861ed738\" rel=\"nofollow noreferrer\">https://medium.com/@vCabbage/go-timeout-commands-with-os-exec-commandcontext-ba0c861ed738</a></p>\n\n<p>This last link has an <strong>amazing</strong> solution to the problem I've encountered. not using cmd.Wait() at all.</p>\n"}], "owner": {"reputation": 562, "user_id": 3012123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/811868539/picture?type=large", "display_name": "TzurEl", "link": "https://stackoverflow.com/users/3012123/tzurel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 47754962, "answer_count": 1, "score": 0, "last_activity_date": 1513002097, "creation_date": 1512910817, "last_edit_date": 1513001527, "question_id": 47739092, "link": "https://stackoverflow.com/questions/47739092/using-exec-commandcontext-with-sg-inq-sys-comand-and-timeout-never-returns", "title": "Using exec.CommandContext with sg_inq sys comand and timeout never returns", "body": "<p>I'm trying to call sg_inq on a multipath device (/dev/mapper/mpatha).\nsg_inq sends a iScsi inquiry to the specific device and extracts some data. I'm using go's own exec.commandContext for the timeout, like this:</p>\n\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), \ntime.Duration(1000)*time.Millisecond)\ndefer cancel()\n\ncmd := exec.CommandContext(ctx, \"sg_inq\", \"/dev/mapper/mpatha\")\nerr := cmd.Run()\ncmd.Stdout = &amp;stdout\ncmd.Stderr = &amp;stderr\nstdErr := stderr.Bytes()\nstdOut := stdout.Bytes()\n</code></pre>\n\n<p>code reference in the official guide - <a href=\"https://golang.org/pkg/os/exec/#CommandContext\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/#CommandContext</a></p>\n\n<p>This code never returns.\nWhen I run it as a standalone script, it works fine. But what I run it as a part of a whole interface, it just gets stuck. I can see all of the calls \"out\", but none of them return.</p>\n\n<p>Is there any reason why the same code snippet works in a standalone script but not in a whole go class? Or maybe I'm way off here and the problem is something else entirely?\nI'm compiling it on go 1.9.2 (latest) but I've tried on 1.9.1 as well.</p>\n\n<p>The build works fine, the tests pass, so everything should be working.</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "is_accepted": false, "score": 1, "last_activity_date": 1512993514, "creation_date": 1512993514, "answer_id": 47752465, "question_id": 47738235, "link": "https://stackoverflow.com/questions/47738235/google-appengine-ah-health-method-does-not-exist/47752465#47752465", "title": "Google appengine /ah/health &quot;Method does not exist.&quot;", "body": "<p>Add this to open API </p>\n\n<pre><code>paths:\n  \"/_ah/health\":\n    get:\n      operationId: \"OkStatus\"\n      security: []\n      responses:\n        200:\n          description: \"Ok message\"\n</code></pre>\n\n<p>It's not let through the ESP proxy</p>\n"}], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512993514, "creation_date": 1512904369, "question_id": 47738235, "link": "https://stackoverflow.com/questions/47738235/google-appengine-ah-health-method-does-not-exist", "title": "Google appengine /ah/health &quot;Method does not exist.&quot;", "body": "<p>Requests to projectname.appspot.com/_ah/health return the following error </p>\n\n<pre><code>{\n \"code\": 5,\n \"message\": \"Method does not exist.\",\n \"details\": [\n  {\n   \"@type\": \"type.googleapis.com/google.rpc.DebugInfo\",\n   \"stackEntries\": [],\n   \"detail\": \"service_control\"\n  }\n ]\n}\n</code></pre>\n\n<p>Tested locally and it works fine. </p>\n\n<p>abbreviated app.yaml:</p>\n\n<pre><code>runtime: go\nenv: flex\napi_version: go1\n</code></pre>\n\n<p>app.go main function:</p>\n\n<pre><code>func main() {\n\n    r := mux.NewRouter()\n\n    r.HandleFunc(\"/\", handler)\n\n    r.HandleFunc(\"/_ah/health\", healthCheckHandler)\n\n    http.Handle(\"/\", r)\n\n    port := 8080\n    if portStr := os.Getenv(\"PORT\"); portStr != \"\" {\n        port, _ = strconv.Atoi(portStr)\n    }\n    log.Fatal(http.ListenAndServe(fmt.Sprintf(\":%d\", port), nil))\n}\n</code></pre>\n\n<p>Any idea's what's going wrong?</p>\n"}, {"tags": ["json", "file", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1512903777, "post_id": 47738091, "comment_id": 82436498, "body": "You are asking two unrelated questions. Please ask one question per post. Your JSON question is great; the second question about writing big data sets should be a second question--and it needs to be clarified."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1512916523, "post_id": 47738091, "comment_id": 82439850, "body": "Is it a requirement that the file is a JSON array, or can it be a stream of values?  The latter makes the answer to both of your questions simpler."}, {"owner": {"reputation": 23, "user_id": 6252511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb88c60eeb64a9e90af89c9f0a8bd57?s=128&d=identicon&r=PG&f=1", "display_name": "Abhsk", "link": "https://stackoverflow.com/users/6252511/abhsk"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1512928964, "post_id": 47738091, "comment_id": 82443659, "body": "@Flimzy have edited the question."}, {"owner": {"reputation": 23, "user_id": 6252511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb88c60eeb64a9e90af89c9f0a8bd57?s=128&d=identicon&r=PG&f=1", "display_name": "Abhsk", "link": "https://stackoverflow.com/users/6252511/abhsk"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1512929176, "post_id": 47738091, "comment_id": 82443739, "body": "@CeriseLim&#243;n Yes it is like a requirement as I have a structure like  {&quot;list&quot;: [{&quot;name&quot;: &quot;Batman&quot;}, {&quot;name&quot;: &quot;Superman&quot;}]} and I want to keep appending  to this &quot;list&quot; attribute value."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1512929655, "post_id": 47738091, "comment_id": 82443892, "body": "@Abhsk Please update the question with the Go types involved and this example JSON.  It&#39;s not clear at all from the question the the top-level of the file is a JSON object, not a JSON array."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6252511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb88c60eeb64a9e90af89c9f0a8bd57?s=128&d=identicon&r=PG&f=1", "display_name": "Abhsk", "link": "https://stackoverflow.com/users/6252511/abhsk"}, "edited": false, "score": 1, "creation_date": 1512964327, "post_id": 47743535, "comment_id": 82452462, "body": "Thanks for your suggestion. I was thinking on the similar lines but then after every iteration I have to do following steps 1. Remove &#39;]}&#39; -- since my json structure is <i>&#39;{&quot;list&quot;: [{&quot;name&quot;: &quot;Batman&quot;}, {&quot;name&quot;: &quot;Superman&quot;}]}&#39;</i> 2. Add new item  3. Re-add  &#39;]}&#39;  But this could result in invalid json if any of these steps fails. Also doing this manually could increase the chances errors."}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "reply_to_user": {"reputation": 23, "user_id": 6252511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb88c60eeb64a9e90af89c9f0a8bd57?s=128&d=identicon&r=PG&f=1", "display_name": "Abhsk", "link": "https://stackoverflow.com/users/6252511/abhsk"}, "edited": false, "score": 0, "creation_date": 1512967803, "post_id": 47743535, "comment_id": 82453225, "body": "Yes, I agree with you about these issues. @Abhsk"}], "tags": [], "owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "is_accepted": false, "score": 1, "last_activity_date": 1512940511, "creation_date": 1512940511, "answer_id": 47743535, "question_id": 47738091, "link": "https://stackoverflow.com/questions/47738091/appending-to-json-file-without-writing-entire-file/47743535#47743535", "title": "Appending to json file without writing entire file", "body": "<p>If your JSON array is simple you can use something like the following code. In this code, I create JSON array manually.</p>\n\n<pre><code>type item struct {\n    Name string\n}\n\nfunc main() {\n    fd, err := os.Create(\"hello.json\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fd.Write([]byte{'['})\n    for i := 0; i &lt; 10; i++ {\n        b, err := json.Marshal(item{\n            \"parham\",\n        })\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        if i != 0 {\n            fd.Write([]byte{','})\n        }\n        fd.Write(b)\n    }\n    fd.Write([]byte{']'})\n}\n</code></pre>\n\n<p>If you want to have a valid array in each step you can write ']' at the end of each iteration and then seek back on the start of the next iteration.</p>\n"}, {"tags": [], "owner": {"reputation": 804, "user_id": 144244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1873681c821bccff2c116534394d8312?s=128&d=identicon&r=PG", "display_name": "Ken", "link": "https://stackoverflow.com/users/144244/ken"}, "is_accepted": false, "score": 2, "last_activity_date": 1512974850, "creation_date": 1512974850, "answer_id": 47747702, "question_id": 47738091, "link": "https://stackoverflow.com/questions/47738091/appending-to-json-file-without-writing-entire-file/47747702#47747702", "title": "Appending to json file without writing entire file", "body": "<p>A general solution makes the most sense if the existing JSON is actually an array, or if it's an object that has an array as the last or only pair, as in your case. Otherwise, you're <em>inserting</em> instead of appending. You probably don't want to <em>read</em> the entire file either.</p>\n\n<p>One approach is not much different than what you were thinking, but handles several details</p>\n\n<ol>\n<li>Read the end of the file to verify that it \"ends with an array\"</li>\n<li>Retain that part</li>\n<li>Position the file at that ending array bracket</li>\n<li>Take the output from a standard encoder for an array of new data, dropping its opening bracket, and inserting a comma if necessary</li>\n<li>The end of the the new output replaces the original ending array bracket</li>\n<li>Tack the rest of the tail back on</li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n        \"bytes\"\n        \"errors\"\n        \"io\"\n        \"io/ioutil\"\n        \"os\"\n        \"regexp\"\n        \"unicode\"\n)\n\nconst (\n        tailCheckLen = 16\n)\n\nvar (\n        arrayEndsObject = regexp.MustCompile(\"(\\\\[\\\\s*)?](\\\\s*}\\\\s*)$\")\n        justArray       = regexp.MustCompile(\"(\\\\[\\\\s*)?](\\\\s*)$\")\n)\n\ntype jsonAppender struct {\n        f               *os.File\n        strippedBracket bool\n        needsComma      bool\n        tail            []byte\n}\n\nfunc (a jsonAppender) Write(b []byte) (int, error) {\n        trimmed := 0\n        if !a.strippedBracket {\n                t := bytes.TrimLeftFunc(b, unicode.IsSpace)\n                if len(t) == 0 {\n                        return len(b), nil\n                }\n                if t[0] != '[' {\n                        return 0, errors.New(\"not appending array: \" + string(t))\n                }\n                trimmed = len(b) - len(t) + 1\n                b = t[1:]\n                a.strippedBracket = true\n        }\n        if a.needsComma {\n                a.needsComma = false\n                n, err := a.f.Write([]byte(\", \"))\n                if err != nil {\n                        return n, err\n                }\n        }\n        n, err := a.f.Write(b)\n        return trimmed + n, err\n}\n\nfunc (a jsonAppender) Close() error {\n        if _, err := a.f.Write(a.tail); err != nil {\n                defer a.f.Close()\n                return err\n        }\n        return a.f.Close()\n}\n\nfunc JSONArrayAppender(file string) (io.WriteCloser, error) {\n        f, err := os.OpenFile(file, os.O_RDWR, 0664)\n        if err != nil {\n                return nil, err\n        }\n\n        pos, err := f.Seek(0, io.SeekEnd)\n        if err != nil {\n                return nil, err\n        }\n\n        if pos &lt; tailCheckLen {\n                pos = 0\n        } else {\n                pos -= tailCheckLen\n        }\n        _, err = f.Seek(pos, io.SeekStart)\n        if err != nil {\n                return nil, err\n        }\n\n        tail, err := ioutil.ReadAll(f)\n        if err != nil {\n                return nil, err\n        }\n\n        hasElements := false\n\n        if len(tail) == 0 {\n                _, err = f.Write([]byte(\"[\"))\n                if err != nil {\n                        return nil, err\n                }\n        } else {\n                var g [][]byte\n                if g = arrayEndsObject.FindSubmatch(tail); g != nil {\n                } else if g = justArray.FindSubmatch(tail); g != nil {\n                } else {\n                        return nil, errors.New(\"does not end with array\")\n                }\n\n                hasElements = len(g[1]) == 0\n                _, err = f.Seek(-int64(len(g[2])+1), io.SeekEnd) // 1 for ]\n                if err != nil {\n                        return nil, err\n                }\n                tail = g[2]\n        }\n\n        return jsonAppender{f: f, needsComma: hasElements, tail: tail}, nil\n}\n</code></pre>\n\n<p>Usage is then like in this test fragment</p>\n\n<pre><code>    a, err := JSONArrayAppender(f)\n    if err != nil {\n            t.Fatal(err)\n    }\n\n    added := []struct {\n            Name string `json:\"name\"`\n    }{\n            {\"Wonder Woman\"},\n    }\n    if err = json.NewEncoder(a).Encode(added); err != nil {\n            t.Fatal(err)\n    }\n\n    if err = a.Close(); err != nil {\n            t.Fatal(err)\n    }\n</code></pre>\n\n<p>You can use whatever settings on the Encoder you want. The only hard-coded part is handling <code>needsComma</code>, but you can add an argument for that.</p>\n"}], "owner": {"reputation": 23, "user_id": 6252511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb88c60eeb64a9e90af89c9f0a8bd57?s=128&d=identicon&r=PG&f=1", "display_name": "Abhsk", "link": "https://stackoverflow.com/users/6252511/abhsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1512974850, "creation_date": 1512903259, "last_edit_date": 1512964172, "question_id": 47738091, "link": "https://stackoverflow.com/questions/47738091/appending-to-json-file-without-writing-entire-file", "title": "Appending to json file without writing entire file", "body": "<p>I have a json which contains one its attributes value as an array and I need to keep appending values to the array and write to a file. Is there a way I could avoid rewrite of the existing data and only append the new values?</p>\n\n<p><em>----- Moving next question on different thread ---------------\nwhat is recommended way for writing big data sets onto the file incremental file write or file dump at the end process?</em></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1512896334, "post_id": 47737302, "comment_id": 82434853, "body": "Thanks 1+, I think the idea which you describe as <code>Alternatively</code> sounds better, can you please provide example with my context for this ?"}, {"owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1512897925, "post_id": 47737302, "comment_id": 82435119, "body": "Added a simple example of a logger as a field in a config struct."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1512900301, "post_id": 47737302, "comment_id": 82435643, "body": "Thanks but Not sure what is related to what, the example you put is it related to main-&gt; main and how should I use it from the handler ? it will be great if you can put the example in my context"}, {"owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1512944923, "post_id": 47737302, "comment_id": 82448386, "body": "Ok I added much more details about what I was trying to convey with the config struct. I also added an answer to the second part of your question about your project layout."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1512980599, "post_id": 47737302, "comment_id": 82457741, "body": "Thanks a lot!  Now I really understand it. 2 validation question regard the project structure 1. what do you mean by <code>github.com&#47;you&#47;myproject&#47; </code> your proj start here ? what is it ? 2. the handler and utils should be in the root project structure , do I get it right ? It will be great if you can share a real go project which have some best practice structure which explain your answer. thanks!"}, {"owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1513733368, "post_id": 47737302, "comment_id": 82762003, "body": "Replace <code>github.com&#47;you&#47;myproject</code> with the path to your package. The path you choose will be the path that everyone who depends on your project will import in their own code (and in the rest of your code as well). If your repository is hosted on GitHub, the convention is to set your package&#39;s path to <code>github.com&#47;&lt;username&gt;&#47;&lt;reponame&gt;</code> because that will work cleanly with go get... i.e. <code>go get github.com&#47;you&#47;project</code> would put your repository under <code>$GOPATH&#47;src&#47;github.com&#47;you&#47;project</code>. You can use whatever path you want, though, as long as you stick to it everywhere."}], "tags": [], "owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "is_accepted": true, "score": 5, "last_activity_date": 1512944870, "last_edit_date": 1512944870, "creation_date": 1512896177, "answer_id": 47737302, "question_id": 47737242, "link": "https://stackoverflow.com/questions/47737242/share-object-from-in-local-package/47737302#47737302", "title": "Share object from in local package", "body": "<p>If you want to share your logger instance across your project, one way is to just export it as a global variable from your utils package as Armin suggested in his answer:</p>\n\n<pre><code>package utils\n\n...\n\nvar Logger *logrus.Logger\n\nfunc init() {\n    Logger = InitLogs()\n}\n</code></pre>\n\n<p>I'd bet you can then get away with not having to export <code>InitLogs()</code> by changing it to <code>initLogs()</code></p>\n\n<p>Then, elsewhere in your code, you can import <code>utils</code> and use that logger instance:</p>\n\n<pre><code>import \"utils\"\n\n...\nfunc something() {\n    utils.Logger.Info(\"Hi\")\n}\n</code></pre>\n\n<p>Alternatively, if it makes sense to keep all your configuration in one place, you can declare your logger pointer as a field of a config struct and initialize it along with the rest of your program configuration (if you have any).</p>\n\n<p>For example, say you have the following in your <code>utils</code> package:</p>\n\n<pre><code>package utils\n\n...\n\ntype MyAppConfig struct {\n    // whatever config parameters your app needs,\n    // like DB connections, etc.\n    Logger *logrus.Logger\n}\n\n// pass in whatever configuration parameters you need,\n// like DB URL, etc.\nfunc InitConfig() (*MyAppConfig, error) {\n   // set up other configuration\n\n   config := &amp;MyAppConfig{\n       // other config\n       Logger: InitLogs(),\n   }\n\n   return config, nil\n}\n\nfunc (c *MyAppConfig) DoSomethingImportant() {\n    c.Logger.Info(\"Hello\")\n}\n</code></pre>\n\n<p>Meanwhile, you can use this anywhere else, like in your CLI interface:</p>\n\n<pre><code>package main\n\nimport \"utils\"\n\n...\n\nfunc main() {\n    // input, or CLI parameters...\n\n    // pass in other CLI parameters, if any\n    // (of course you'd have to change the function signature in\n    // the previous file above)\n    config, err := utils.NewConfig()\n    if err != nil {\n        // handle error\n    }\n\n    config.DoSomethingImportant()\n\n    // or since Logger is exported:\n    config.Logger.Info(\"hello\")\n}\n</code></pre>\n\n<p>If you find you end up with lots of global things like the Logger you need to configure, the config struct is the more scalable approach IMO. As an added bonus, using a config type makes it easier to do dependency injection in unit tests than having the global variables used directly. </p>\n\n<p>On the other hand, if you only have to worry about the one global Logger, then the config struct might be overkill, especially if it's not something you'll need to instrument when designing tests. It's a subjective call depending on your circumstances.</p>\n\n<p>To answer your second question...</p>\n\n<p><strong>Project Layout</strong></p>\n\n<p>If <code>/server</code> has a main package with a command, move it under <code>cmd/server</code>.</p>\n\n<p>Also, the way you currently have it, it would be a bit confusing for others to depend on your project. Since your repository appears to begin at <code>src/</code>, here's what it will look like when someone else tries to import your <code>utils</code> package:</p>\n\n<p>File structure:</p>\n\n<pre><code> &lt;top of someone else's GOPATH&gt;/\n   src/\n     myproject/src/utils/\n       ...\n</code></pre>\n\n<p>To import:</p>\n\n<pre><code> import \"myproject/src/utils\"\n</code></pre>\n\n<p>... and actually, since you <code>import \"utils\"</code> in your code right now, I don't think your code will compile in someone else's <code>GOPATH</code> because they don't have a <code>$GOPATH/src/utils</code>.</p>\n\n<p>Solution: Your repository should not include <code>src/</code>. The idea is that you setup your <code>$GOPATH</code> and you put different repositories/packages inside of it. For example (assuming you host your code on Github):</p>\n\n<pre><code> &lt;top of gopath&gt;/\n   src/\n     github.com/you/myproject/  &lt;---- your repo starts here\n       cmd/server/\n         main.go\n       utils\n         file1.go\n         logger.go\n       handler\n         handler1.go\n         handler2.go\n</code></pre>\n\n<p>This would make your packages importable to you and to others like so:</p>\n\n<pre><code>import \"github.com/you/myproject/utils\"\n</code></pre>\n\n<p>Also, this project structure allow others to include your project inside their $GOPATH or in their <code>vendor/</code> interchangeably.</p>\n"}, {"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1512896482, "post_id": 47737314, "comment_id": 82434881, "body": "Thanks Arman, This is the best practice ? since here I create dependency on the main package...maybe yes just to verify since Im not expert in golang..."}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 1, "creation_date": 1512896711, "post_id": 47737314, "comment_id": 82434917, "body": "If you want to share same logger instance in you project, its better to move it into <code>utils&#47;log.go</code> and <code>import &quot;utils&quot;</code> or even to its own package (If logging has more than just one variable and function)"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1512901863, "post_id": 47737314, "comment_id": 82435976, "body": "Thanks but how I provide the instance to the <code>handler1</code> can you please provide example for this ? this is my main lack of understanding ...."}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1512906267, "post_id": 47737314, "comment_id": 82437158, "body": "just rename <code>logger</code> to <code>Logger</code> and import it. I changed my answer to be more like your question codes."}], "tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 1, "last_activity_date": 1512906199, "last_edit_date": 1512906199, "creation_date": 1512896313, "answer_id": 47737314, "question_id": 47737242, "link": "https://stackoverflow.com/questions/47737242/share-object-from-in-local-package/47737314#47737314", "title": "Share object from in local package", "body": "<p>It seems you want to use the exact logger from <code>main.go</code>. You should just export it and use it in other packages:</p>\n\n<p><code>server/main.go</code></p>\n\n<pre><code>var Logger *logrus.Logger  // Notice capital L\n\nfunc main() {\n    Logger = utils.InitLogs()  // Init logger once\n    ...\n}\n</code></pre>\n\n<p><code>handler/handler1.go</code></p>\n\n<pre><code>import \"server\"\n\nfunc run(){\n   //here Im not using logger otherwise maybe I can move it as parameter\u2026\n} \n\nfunc build(){\n    // No need to initialize logger as its done in main func.\n\n    //Here Im using the logger\n    server.Logger.info(\"in xyz\")\n}\n</code></pre>\n\n<p>And your project structure is not standard. See <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}], "owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 3, "accepted_answer_id": 47737302, "answer_count": 2, "score": 0, "last_activity_date": 1512944870, "creation_date": 1512895595, "last_edit_date": 1512918748, "question_id": 47737242, "link": "https://stackoverflow.com/questions/47737242/share-object-from-in-local-package", "title": "Share object from in local package", "body": "<p>I'm new to Go and I've created an application which is working as expected.</p>\n\n<p>My application structure is like following:</p>\n\n<pre><code>myproj\n   Gopkg.toml\n   Gopkg.lock\n   src\n      server\n         main.go\n      utils\n          file1.go\n          logger.go\n      handler\n          handler1.go\n          handler2.go\n</code></pre>\n\n<p>Now inside the main.go file I've created a logger like the following:</p>\n\n<p>File <code>server-&gt; main.go</code></p>\n\n<pre><code>import (\n      \"handler\"\n      \"utils\"\n      \"github.com/sirupsen/logrus\"\n)\n\nvar logger                *logrus.Logger\n\nfun init(){\n    logger = utils.InitLogs()\n} \n\n\nfunc main(){\n  logger.info(\"my message\")\n\n  \u2026\n\n  handler.run()\n\n} \n</code></pre>\n\n<p>Everything is <strong>working</strong> as expected!</p>\n\n<p>Now I want to use the logger inside the <code>handler1&amp;2</code> files (from diff package inside my local project) </p>\n\n<p>To do this, I did the following steps.\nInside the handler <code>init</code> the logger (exactly as I did in the main file) and it\u2019s working </p>\n\n<p>File <code>handler-&gt; handler1.go</code></p>\n\n<pre><code>import (\n      \"utils\"\n      \"github.com/sirupsen/logrus\"\n)\n\nvar logger                *logrus.Logger\n\nfun init(){\n   //Init the logger again\n    logger = utils.InitLogs()\n} \nfunc run(){\n   //here Im not using logger otherwise maybe I can move it as parameter\u2026\n} \n\nfunc build(){\n  //Here Im using the logger\n  logger.info(\"Hi\") \n}\n</code></pre>\n\n<p>While this is working but I've created <strong>two</strong> instance of logger, <em>first</em> on <code>main</code> and <strong>second</strong> on <code>handler1</code> which Im not sure is best</p>\n\n<blockquote>\n  <p>My questions are:</p>\n</blockquote>\n\n<ol>\n<li>I want to reuse the <code>logger</code> inside the <code>handler</code> class/module, is a better way to do it in Go? </li>\n</ol>\n\n<p>This is <strong>diff package</strong> (inside my local proj)  and I'm not sure that I'm that if Im <strong>not re-use the same logger object</strong> from the <code>main</code> method, this is the right way to do it...</p>\n\n<ol start=\"2\">\n<li>(lower prio question) Is my project structure okay for Go? I used <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">this</a> as reference which is similar...<a href=\"https://github.com/golang-standards/project-layout\" rel=\"nofollow noreferrer\">also this</a> which is a bit different </li>\n</ol>\n"}, {"tags": ["gcc", "go", "cgo"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1512894475, "post_id": 47736729, "comment_id": 82434481, "body": "Try renaming the file <code>libtest.so</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1512893631, "creation_date": 1512893631, "answer_id": 47737038, "question_id": 47736729, "link": "https://stackoverflow.com/questions/47736729/golang-c-shared-on-linux-ld-cannot-find-ltest/47737038#47737038", "title": "Golang c-shared on linux - ld cannot find -ltest", "body": "<p>Try <code>gcc -o test test.c -L. -l:test.so</code> to link the library.</p>\n"}, {"tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": true, "score": 1, "last_activity_date": 1512899217, "creation_date": 1512899217, "answer_id": 47737624, "question_id": 47736729, "link": "https://stackoverflow.com/questions/47736729/golang-c-shared-on-linux-ld-cannot-find-ltest/47737624#47737624", "title": "Golang c-shared on linux - ld cannot find -ltest", "body": "<p>Note the difference between the go build commandline in the instructions you say\nyou are following:</p>\n\n<pre><code>go build -o libimgutil.so -buildmode=c-shared imgutil.go\n            +++^^^^^^^^^^                     ^^^^^^^^^^ \n</code></pre>\n\n<p>and your own go build command:</p>\n\n<pre><code>go build -o test.so -buildmode=c-shared test.go\n            ^^^^^^^                     ^^^^^^^\n</code></pre>\n\n<p>Consider this difference in the light of <a href=\"https://sourceware.org/binutils/docs-2.27/ld/Options.html\" rel=\"nofollow noreferrer\">the documentation of the linker\noption <code>-l | --library</code></a></p>\n\n<pre><code>-l namespec\n--library=namespec\n\nAdd the archive or object file specified by namespec to the list of files to link.\n                                            ^^^^^^^^\nThis option may be used any number of times. If namespec is of the form :filename,\n                                                ^^^^^^^^                +^^^^^^^^\nld will search the library path for a file called filename, otherwise it will\n                                                  ^^^^^^^^\nsearch the library path for a file called libnamespec.a.\n                                          +++^^^^^^^^++\nOn ... ELF and SunOS systems, ld will search a directory for a library called\nlibnamespec.so before searching for one called libnamespec.a. (By convention,\n+++^^^^^^^^+++                                 +++^^^^^^^^++\na .so extension indicates a shared library.) ...\n</code></pre>\n\n<p>This will show you that your go build command needs to be:</p>\n\n<pre><code>go build -o libtest.so -buildmode=c-shared test.go\n</code></pre>\n"}], "owner": {"reputation": 1595, "user_id": 5276890, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VfQC8.jpg?s=128&g=1", "display_name": "Roy Falk", "link": "https://stackoverflow.com/users/5276890/roy-falk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1361, "favorite_count": 0, "accepted_answer_id": 47737624, "answer_count": 2, "score": 0, "last_activity_date": 1512904332, "creation_date": 1512890237, "last_edit_date": 1512904332, "question_id": 47736729, "link": "https://stackoverflow.com/questions/47736729/golang-c-shared-on-linux-ld-cannot-find-ltest", "title": "Golang c-shared on linux - ld cannot find -ltest", "body": "<p>I'm trying to follow the instructions in <a href=\"http://snowsyn.net/2016/09/11/creating-shared-libraries-in-go/\" rel=\"nofollow noreferrer\">http://snowsyn.net/2016/09/11/creating-shared-libraries-in-go/</a></p>\n\n<p>My project is somewhat simpler. The library has one test function with println. As the title says, I'm getting 'cannot find'.</p>\n\n<p>I'm running Ubuntu zesty and go 1.7.4</p>\n\n<p>ls -l</p>\n\n<p><code>roy@roy-desktop:~/go/src/c$ ls -l\ntotal 2016\n-rw-rw-r-- 1 roy roy      43 Dec 10 06:55 test.c\n-rw-rw-r-- 1 roy roy    1274 Dec 10 06:54 test.h\n-rw-rw-r-- 1 roy roy 2053664 Dec 10 06:54 test.so</code></p>\n\n<p>test.c</p>\n\n<pre><code>#include \"test.h\"\n\nint main() {\n    test();\n}\n</code></pre>\n\n<p>lib.go</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"C\"\n\n\n//export test\nfunc test() {\n    fmt.Println(\"test\")\n}\n\nfunc main() {}\n</code></pre>\n\n<p>test.h and test.so were generated with: go build -o test.so -buildmode=c-shared test.go</p>\n\n<p>invocation of gcc fails as follows:</p>\n\n<pre><code>roy@roy-desktop:~/go/src/c$ gcc -o test test.c -L. -ltest\n/usr/bin/ld: cannot find -ltest\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>The original example uses clang but googling indicates the invocation should work for gcc as well.</p>\n\n<h2>Post Solution</h2>\n\n<p>A couple of extra comments:</p>\n\n<ol>\n<li><p>A function name in go <code>func test() {}</code> will appear in nm as <code>_test</code> but should be declared in C as <code>extern void test();</code></p></li>\n<li><p>For some reason, the invocation <code>go build -buildmode=c-shared</code> does not generate a header file on OSX but does on Linux. </p></li>\n</ol>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6810508, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v65YjwzVumE/AAAAAAAAAAI/AAAAAAAABMw/m3GobXxSroo/photo.jpg?sz=128", "display_name": "Niraj Bhatt", "link": "https://stackoverflow.com/users/6810508/niraj-bhatt"}, "is_accepted": false, "score": 1, "last_activity_date": 1512890004, "creation_date": 1512890004, "answer_id": 47736705, "question_id": 47736681, "link": "https://stackoverflow.com/questions/47736681/go-xml-unmarshaling-not-reading-attribute/47736705#47736705", "title": "Go XML Unmarshaling not reading attribute", "body": "<p>Resolved. \nApparently GO did not like the space in front of attr</p>\n\n<p>It should be\nOFXHomeID         string   <code>xml:\"id,attr\"</code></p>\n\n<p>instead of</p>\n\n<p>OFXHomeID         string   <code>xml:\"id, attr\"</code></p>\n"}], "owner": {"reputation": 21, "user_id": 6810508, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v65YjwzVumE/AAAAAAAAAAI/AAAAAAAABMw/m3GobXxSroo/photo.jpg?sz=128", "display_name": "Niraj Bhatt", "link": "https://stackoverflow.com/users/6810508/niraj-bhatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512890004, "creation_date": 1512889752, "last_edit_date": 1512889834, "question_id": 47736681, "link": "https://stackoverflow.com/questions/47736681/go-xml-unmarshaling-not-reading-attribute", "title": "Go XML Unmarshaling not reading attribute", "body": "<p>New to Go lang. From the XML, the code unmarshall all values except for attribute. Can someone please advise what I am doing wrong:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nfunc main() {\n    v, _ := GetData()\n    fmt.Print(v)\n}\n\n\ntype Query struct {\n    InstituationList []Instituation `xml:\"institution\"`\n}\n\ntype Instituation struct {\n    XMLName           xml.Name `xml:\"institution\"`\n    OFXHomeID         string   `xml:\"id, attr\"`\n    Name              string   `xml:\"name\"`\n    FId               string   `xml:\"fid\"`\n    FOrg              string   `xml:\"org\"`\n    URL               string   `xml:\"url\"`\n    OFXHomeIDD         string   `xml:\"idd\"`\n}\n\n\nfunc GetData() (*Query, error) {\n    fakeXML := `\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Data&gt;\n&lt;institution id=\"A421\"&gt;\n&lt;idd&gt;423&lt;/idd&gt;\n&lt;name&gt;ING DIRECT (Canada)&lt;/name&gt;\n&lt;fid&gt;061400152&lt;/fid&gt;\n&lt;org&gt;INGDirectCanada&lt;/org&gt;\n&lt;url&gt;https://ofx.ingdirect.ca&lt;/url&gt;\n&lt;/institution&gt;\n&lt;/Data&gt;\n`\n\n    content := []byte(fakeXML)\n\n    e := new(Query)\n    xml.Unmarshal(content, e)\n\n    return e, nil\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1512926880, "post_id": 47736401, "comment_id": 82442957, "body": "still get a 404"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1512954717, "post_id": 47736401, "comment_id": 82450452, "body": "seems to break the resizing."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1512957933, "post_id": 47736401, "comment_id": 82451146, "body": "Debug by checking the value of r.URL.Path on <a href=\"https://github.com/willnorris/imageproxy/blob/e7f9017674d9badb025048fb73bfa39782016e5d/imageproxy.go#L118\" rel=\"nofollow noreferrer\">this line</a>.  That should tell you if the problem is with the mux or strip prefix or something else."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1512967183, "post_id": 47736401, "comment_id": 82453070, "body": "Fixed by removing trailing / from first argument to http.StripPrefix."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1512969414, "post_id": 47736401, "comment_id": 82453602, "body": "@kristen It works for me.  Here&#39;s my program: <a href=\"https://play.golang.org/p/93fSQIIrIv\" rel=\"nofollow noreferrer\">play.golang.org/p/93fSQIIrIv</a>.  Here&#39;s the URL I used to test it: <a href=\"http://localhost:8000/proxy/250x/https:/octodex.github.com/images/codercat.jpg\" rel=\"nofollow noreferrer\">localhost:8000/proxy/250x/https:/octodex.github.com/images/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1512970334, "post_id": 47736401, "comment_id": 82453877, "body": "I&#39;m retarted. Browser cached my image. Full refresh and it works. Please create answer on other question and I&#39;ll accept. Thanks!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1512970397, "last_edit_date": 1512970397, "creation_date": 1512886435, "answer_id": 47736401, "question_id": 47736050, "link": "https://stackoverflow.com/questions/47736050/how-do-i-run-this-image-proxy-under-a-different-path/47736401#47736401", "title": "How do I run this image proxy under a different path?", "body": "<p>Use <a href=\"https://godoc.org/net/http#StripPrefix\" rel=\"nofollow noreferrer\">http.StripPrefix</a> to remove \"/proxy\" from the request path before invoking the image proxy handler:</p>\n\n<pre><code>router.NewRoute().Name(\"proxy\").Methods(\"GET\").PathPrefix(\"/proxy/\").Handler(http.StripPrefix(\"/proxy\", p))\n</code></pre>\n\n<p>Also, use <a href=\"https://godoc.org/github.com/gorilla/mux#Route.PathPrefix\" rel=\"nofollow noreferrer\">PathPrefix</a> instead of Path for match on all paths below \"/proxy\".</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 47736401, "answer_count": 1, "score": 1, "last_activity_date": 1512970397, "creation_date": 1512882162, "question_id": 47736050, "link": "https://stackoverflow.com/questions/47736050/how-do-i-run-this-image-proxy-under-a-different-path", "title": "How do I run this image proxy under a different path?", "body": "<p>I am using <a href=\"https://github.com/willnorris/imageproxy\" rel=\"nofollow noreferrer\">https://github.com/willnorris/imageproxy</a> to fetch and resize images on behalf of users. The default app works but I'd like to integrate this with an existing server and change the path to \"/proxy/\" since \"/\" will be used for my main app. I also don't want to have to run this separately since it's literally just a few lines I need. I have:</p>\n\n<pre><code>p := imageproxy.NewProxy(nil, nil)\np.SignatureKey = []byte(\"secret key\")\np.Timeout = 10 * time.Second\n\nrouter := mux.NewRouter().StrictSlash(true)\nrouter.NewRoute().Name(\"proxy\").Methods(\"GET\").Path(\"/proxy/\").Handler(p)\n\nserver := &amp;http.Server{\n    Addr:    \"127.0.0.1:8000\",\n    Handler: router,\n}\n</code></pre>\n\n<p>I receive \"404 page not found\" for every image. Changing it to:</p>\n\n<pre><code>server := &amp;http.Server{\n    Addr:    \"localhost:8000\",\n    Handler: p,\n}\n\nlog.Fatal(server.ListenAndServe()) \n</code></pre>\n\n<p>works. Is it possible to do change the path?</p>\n"}, {"tags": ["go", "goland"], "answers": [{"comments": [{"owner": {"reputation": 14973, "user_id": 128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c330659979615fe50c46f5f553b39f?s=128&d=identicon&r=PG", "display_name": "Arjan", "link": "https://stackoverflow.com/users/128186/arjan"}, "edited": false, "score": 15, "creation_date": 1512896178, "post_id": 47737130, "comment_id": 82434829, "body": "You can also do it every time you save using <code>File Watchers</code> plugin"}, {"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "edited": false, "score": 0, "creation_date": 1513068813, "post_id": 47737130, "comment_id": 82498100, "body": "When working with GoLand most of the time I have a terminal window open below my code and just time &quot;go fmt&quot; in there if my code feels cluttered."}], "tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": true, "score": 67, "last_activity_date": 1587162741, "last_edit_date": 1587162741, "creation_date": 1512894450, "answer_id": 47737130, "question_id": 47735678, "link": "https://stackoverflow.com/questions/47735678/goland-how-to-use-gofmt/47737130#47737130", "title": "goland how to use gofmt?", "body": "<p>GoLand have commands to <code>go fmt</code> your file or project. Right click on your file and you will find it under \"Go tools\". You could see its shortcut there.</p>\n\n<p>You can also use \"Reformat code\" command (bound to Command-Alt-L for me). It's not 100% same as <code>go fmt</code> but very close. Also works for other languages.</p>\n\n<p>If you have an open terminal, you can run <code>go fmt ./...</code> to format all files in a directory (including sub directories). You can put this in a git commit hook to run it every time you commit.</p>\n\n<p>As others mentioned there's a file watcher section under Preferences \u2192 Tools \u2192 File Watchers, in there you can setup to run <code>go fmt</code> or <code>goimports</code> everytime you save a Go file.</p>\n"}, {"tags": [], "owner": {"reputation": 1592, "user_id": 7251967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-al-If026iHU/AAAAAAAAAAI/AAAAAAAAABE/9lsheyH-V9Q/photo.jpg?sz=128", "display_name": "negi Yogi", "link": "https://stackoverflow.com/users/7251967/negi-yogi"}, "is_accepted": false, "score": 105, "last_activity_date": 1536665086, "last_edit_date": 1536665086, "creation_date": 1512924583, "answer_id": 47741115, "question_id": 47735678, "link": "https://stackoverflow.com/questions/47735678/goland-how-to-use-gofmt/47741115#47741115", "title": "goland how to use gofmt?", "body": "<p>There are  ways to format your code , you can do that by using any one of the way : </p>\n\n<ol>\n<li>once your code is done. just run the command \" gofmt -s -w .\" in terminal in required directory or else in needed file. it will format your whole directory/file as per your need .</li>\n<li>go to preferences ->Tools ->File Watchers  and enable go fmt . This  way on each save it will format the file. </li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1772, "user_id": 4706119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e597fc1530bb59898a572f5625417851?s=128&d=identicon&r=PG&f=1", "display_name": "hutabalian", "link": "https://stackoverflow.com/users/4706119/hutabalian"}, "is_accepted": false, "score": 5, "last_activity_date": 1554436208, "creation_date": 1554436208, "answer_id": 55527951, "question_id": 47735678, "link": "https://stackoverflow.com/questions/47735678/goland-how-to-use-gofmt/55527951#55527951", "title": "goland how to use gofmt?", "body": "<p>Just want to add 1 more option. You can automatically apply go fmt every time when you are about to commit to git. When you open the commit window, under the <code>Before Commit</code> section, there is a <code>Go fmt</code> checkbox. Just check it. Later when you do another commit, the default value for that checkbox is checked. So, you only need to check it once. Then go fmt will run automatically before you commit.</p>\n"}], "owner": {"reputation": 1194, "user_id": 7196144, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JqkLR.jpg?s=128&g=1", "display_name": "Mikita Melnikau", "link": "https://stackoverflow.com/users/7196144/mikita-melnikau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39871, "favorite_count": 8, "accepted_answer_id": 47737130, "answer_count": 3, "score": 70, "last_activity_date": 1587162741, "creation_date": 1512877770, "last_edit_date": 1532034172, "question_id": 47735678, "link": "https://stackoverflow.com/questions/47735678/goland-how-to-use-gofmt", "title": "goland how to use gofmt?", "body": "<p>I started learning golang and installed <a href=\"https://www.jetbrains.com/go/\" rel=\"noreferrer\">GoLand from JetBrains</a>. I am reading the book <em>The Go Programming Language</em>, and in the first chapter author strongly recommends using the <code>gofmt</code> tool before each save. How I can follow this recommendation in GoLand?</p>\n"}, {"tags": ["json", "go", "struct", "trello"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1512878264, "post_id": 47735660, "comment_id": 82431886, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28228393/json-unmarshal-returning-blank-structure\" title=\"json unmarshal returning blank structure\">stackoverflow.com/questions/28228393/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1512900747, "post_id": 47735660, "comment_id": 82435726, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28228393/json-unmarshal-returning-blank-structure\">json.Unmarshal returning blank structure</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1512877760, "creation_date": 1512877760, "answer_id": 47735677, "question_id": 47735660, "link": "https://stackoverflow.com/questions/47735660/decoded-json-response-return-empty-struct/47735677#47735677", "title": "Decoded json response return empty struct", "body": "<p>You need to make sure the fields are exported, or the json decoder can't access them.</p>\n\n<p>Replace <code>fullName string</code> with <code>FullName string</code> etc... Keep the json attributes the same though.</p>\n"}], "owner": {"reputation": 399, "user_id": 3546305, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d962b74d2f43bc25fac439283df90fc9?s=128&d=identicon&r=PG&f=1", "display_name": "amiceli", "link": "https://stackoverflow.com/users/3546305/amiceli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 47735677, "answer_count": 1, "score": 1, "last_activity_date": 1512900729, "creation_date": 1512877475, "last_edit_date": 1512900729, "question_id": 47735660, "link": "https://stackoverflow.com/questions/47735660/decoded-json-response-return-empty-struct", "title": "Decoded json response return empty struct", "body": "<p>I'm trying to get trello organization members list.\nWhen I print result I've correct number of struct (17 structs, 17 members).</p>\n\n<p>But struct are empty.</p>\n\n<p>This is my code : </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"net/http\"\nimport \"io/ioutil\"\nimport \"encoding/json\"\nimport \"bytes\"\n\ntype Obj struct {\n  fullName string `json:\"fullName\"`\n  username string `json:\"username\"`\n  id string `json:\"id\"`\n}\n\nfunc main() {\n    fmt.Printf(\"hello, world\\n\")\n\n    var key string = \"key\"\n    var token string = \"token\"\n    var orga string = \"organization\"\n\n    var url = fmt.Sprintf(\"https://api.trello.com/1/organizations/%s/members\", orga)\n    var urlQuery = fmt.Sprintf(\"?key=%s&amp;token=%s\", key, token)\n\n    var fullUrl string = url + urlQuery\n\n    fmt.Println(fullUrl)\n\n    resp, err := http.Get(fullUrl)\n\n    body, err2 := ioutil.ReadAll(resp.Body)\n    if err2 != nil {\n        panic(err.Error())\n    }\n\n    people1 := []Obj{}\n\n    decoder := json.NewDecoder(bytes.NewBuffer(body))\n    jsonErr := decoder.Decode(&amp;people1)\n\n    if jsonErr != nil {\n      panic(jsonErr)\n    }\n\n    fmt.Println(people1)\n}\n</code></pre>\n\n<p>And console output : </p>\n\n<pre><code>[{} {} {} {} {} {} {} {} {} {} {} {} {} {} {} {} {}]\n</code></pre>\n\n<p>I tried with json.Unmarshal but I've same result.</p>\n"}, {"tags": ["function", "pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 0, "creation_date": 1512943608, "post_id": 47737439, "comment_id": 82448038, "body": "Yes, I&#39;m trying to replace functions for unit testing purposes. I know the idiomatic solution is to use interfaces to mock behaviors, but injecting interfaces make the code more cluttered..."}, {"owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "reply_to_user": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 1, "creation_date": 1512945344, "post_id": 47737439, "comment_id": 82448503, "body": "Unfortunately, what you&#39;re trying to do is fighting against the design of the language, and the cure may be deadlier that the sickness :( . Also, many (including myself) might argue that defining explicit interfaces adds clarity to your code and more clearly conveys your design intentions. It&#39;s a language design choice, and Go is pretty opinionated towards doing things its own way. Some people hate it, but there&#39;s certainly value to be had by having a code base with consistent style and structure (enforced at the language level in this case)."}], "tags": [], "owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1512897521, "creation_date": 1512897521, "answer_id": 47737439, "question_id": 47735012, "link": "https://stackoverflow.com/questions/47735012/how-are-functions-implemented/47737439#47737439", "title": "How are functions implemented?", "body": "<p>Underneath the covers, a Go function is probably just as you describe it- an address to a set of instructions in memory, and parameters / return values are filled in according to your system's linkage conventions as the function executes.</p>\n\n<p>However, Go's function <em>abstraction</em> is much more limited, on purpose (it's a language design decision). You can't just replace functions, or even override methods from other imported packages, like you might do in a normal object-oriented language. You certainly can't do dynamic replacement of functions under normal circumstances (I suppose you could write into arbitrary memory locations using the <a href=\"https://golang.org/pkg/unsafe/\" rel=\"nofollow noreferrer\">unsafe</a> package, but that's willful circumvention of the language rules, and all bets are off at that point).</p>\n\n<p>Are you trying to do some sort of dependency injection for unit testing?  If so, the idiomatic way to do this in Go is to define interface that you pass around to your functions/methods, and replace with a test version in your tests. In your case, an interface may wrap the call to <code>strings.ToUpper</code> in the normal implementation, but a test implementation might call something else.</p>\n\n<p>For example:</p>\n\n<pre><code>type Upper interface {\n   ToUpper(string) string\n}\n\ntype defaultUpper struct {}\n\nfunc (d *defaultUpper) ToUpper(s string) string {\n    return strings.ToUpper(s)\n}\n\n...\n\n// normal implementation: pass in &amp;defaultUpper{}\n// test implementation: pass in a test version that\n//      does something else\nfunc SomethingUseful(s string, d Upper) string {\n    return d.ToUpper(s)\n}\n</code></pre>\n\n<p>Finally, you can also pass function values around. For example:</p>\n\n<pre><code>var fn func(string) string\nfn = strings.ToUpper\n\n...\n\nfn(\"hello\")\n</code></pre>\n\n<p>... but this won't let you replace the system's <code>strings.ToUpper</code> implementation, of course.</p>\n\n<p>Either way, you can only sort of approximate what you want to do in Go via interfaces or function values. It's not like Python, where everything is dynamic and replaceable.</p>\n"}, {"comments": [{"owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 0, "creation_date": 1512943370, "post_id": 47741924, "comment_id": 82447981, "body": "For the record, I&#39;m only modifying functions at runtime for my test code. Sometimes it&#39;s hard to gain coverage on functions which return errors."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 0, "creation_date": 1512943551, "post_id": 47741924, "comment_id": 82448022, "body": "@hlin117: In that case, I sincerely believe we&#39;re dealing with an X-Y problem here. There are plenty of ways to inject mock functions to use during testing. I&#39;ll update my answer adding a simplistic example"}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 1, "last_activity_date": 1512983817, "last_edit_date": 1592644375, "creation_date": 1512929614, "answer_id": 47741924, "question_id": 47735012, "link": "https://stackoverflow.com/questions/47735012/how-are-functions-implemented/47741924#47741924", "title": "How are functions implemented?", "body": "<h2>Disclaimers:</h2>\n<ol>\n<li><p>I've only recently started to delve deeper into the golang compiler, more specifically: the go assembler and mapping thereof. Because I'm by no means an expert, I'm not going to attempt explaining all the details here (as my knowledge is most likely still lacking). I will provide a couple of links at the bottom that might be worth checking out for more details.</p>\n</li>\n<li><p>What you're trying to do makes very, very little sense to me. If, at runtime, you're trying to modify a function, you're probably doing something wrong earlier on. And that's just in case you want to mess with any function. The fact that you're trying to do something with a function from the <code>strings</code> package makes this all the more worrying. The <code>reflect</code> package allows you to write very generic functions (eg a service with request handlers, but you want to pass arbitrary arguments to those handlers requires you to have a single handler, process the raw request, then call the corresponding handler. You cannot possibly know what that handler looks like, so you use reflection to work out the arguments required...).</p>\n</li>\n</ol>\n<hr />\n<p>Now, how are functions implemented?</p>\n<p>The go compiler is a tricky codebase to wrap ones head around, but thankfully the language design, and the implementation thereof has been discussed openly. From what I gather, golang functions are essentially compiled in pretty much the same way as a function in, for example, C. However, calling a function is a bit different. Go functions are first-class objects, that's why you can pass them as arguments, declare a function type, and why the <code>reflect</code> package has to allow you to use reflection on a function argument.</p>\n<p>Essentially, functions are not addressed directly. Functions are passed and invoked through a function <em>&quot;pointer&quot;</em>. Functions are effectively a type like similar to a <code>map</code> or a <code>slice</code>. They hold a pointer to the actual code, and the call data. In simple terms, think of a function as a type (in pseudo-code):</p>\n<pre><code>type SomeFunc struct {\n    actualFunc *func(...) // pointer to actual function body\n    data struct {\n        args []interface{} // arguments\n        rVal []interface{} // returns\n        // any other info\n    }\n}\n</code></pre>\n<p>This means that the <code>reflect</code> package can be used to, for example, count the number of arguments and return values the function expects. It also tells you what the return value(s) will be. The overall function &quot;type&quot; will be able to tell you where the function resides, and what arguments it expects and returns, but that's about it. IMO, that's all you really need though.</p>\n<p>Because of this implementation, you can create fields or variables with a function type like this:</p>\n<pre><code>var callback func(string) string\n</code></pre>\n<p>This would create an underlying value that, based on the pseudo code above, looks something like this:</p>\n<pre><code>callback := struct{\n    actualFunc: nil, // no actual code to point to, function is nil\n    data: struct{\n       args: []interface{}{string}, // where string is a value representing the actual string type\n        rVal: []interface{}{string},\n    },\n}\n</code></pre>\n<p>Then, by assigning any function that matches the <code>args</code> and <code>rVal</code> constraints, you can determine what executable code the <code>callback</code> variable points to:</p>\n<pre><code>callback = strings.ToUpper\ncallback = func(a string) string {\n    return fmt.Sprintf(&quot;a = %s&quot;, a)\n}\ncallback = myOwnToUpper\n</code></pre>\n<p>I hope this cleared 1 or 2 things up a bit, but if not, here's a bunch of links that might shed some more light on the matter.</p>\n<ul>\n<li>Go functions <a href=\"https://docs.google.com/document/d/1bMwCey-gmqZVTpRax-ESeVuZGmjwbocYs1iHplK-cjo/pub\" rel=\"nofollow noreferrer\">implementation and design</a></li>\n<li>Introduction to <a href=\"https://golang.org/doc/asm\" rel=\"nofollow noreferrer\">go's ASM</a></li>\n<li>Rob Pike on the go compiler written in go, and the plan 9 derived <a href=\"https://talks.golang.org/2016/asm.slide#1\" rel=\"nofollow noreferrer\">asm mapping</a></li>\n<li>Writing a <a href=\"http://nelhagedebugsshit.tumblr.com/post/84342207533/things-i-learned-writing-a-jit-in-go\" rel=\"nofollow noreferrer\">JIT in go asm</a></li>\n<li>a &quot;case study&quot; attempting to <a href=\"https://blog.sgmansfield.com/2017/04/a-foray-into-go-assembly-programming/\" rel=\"nofollow noreferrer\">use golang ASM for optimisation</a></li>\n<li>Go and assembly <a href=\"http://www.doxsey.net/blog/go-and-assembly\" rel=\"nofollow noreferrer\">introduction</a></li>\n<li>Plan 9 assembly <a href=\"https://9p.io/sys/doc/asm.html\" rel=\"nofollow noreferrer\">docs</a></li>\n</ul>\n<hr />\n<h2>Update</h2>\n<p>Seeing as you're attempting to swap out a function you're using for testing purposes, I would suggest you <em>not</em> use reflection, but instead inject mock functions, which is a more common practice WRT testing to begin with. Not to mention it being so much easier:</p>\n<pre><code>type someT struct {\n    toUpper func(string) string\n}\n\nfunc New(toUpper func(string) string) *someT {\n    if toUpper == nil {\n        toUpper = strings.ToUpper\n    }\n    return &amp;someT{\n        toUpper: toUpper,\n    }\n}\n\nfunc (s *someT) FuncToTest(t string) string {\n    return s.toUpper(t)\n}\n</code></pre>\n<p>This is a basic example of how you could inject a specific function. From within your <code>foo_test.go</code> file, you'd just call <code>New</code>, passing a different function.</p>\n<p>In more complex scenario's, using interfaces is the easiest way to go. Simply implement the interface in the test file, and pass the alternative implementation to the <code>New</code> function:</p>\n<pre><code>type StringProcessor interface {\n    ToUpper(string) string\n    Join([]string, string) string\n    // all of the functions you need\n}\n\nfunc New(sp StringProcessor) return *someT {\n    return &amp;someT{\n        processor: sp,\n    }\n}\n</code></pre>\n<p>From that point on, simply create a mock implementation of that interface, and you can test everything without having to muck about with reflection. This makes your tests easier to maintain and, because reflection is complex, it makes it far less likely for your tests to be faulty.</p>\n<p>If your test is faulty, it could cause your actual tests to pass, even though the code you're trying to test isn't working. I'm always suspicious if the test code is more complex than the code you're covering to begin with...</p>\n"}], "owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 47741924, "answer_count": 2, "score": -1, "last_activity_date": 1512983817, "creation_date": 1512869415, "last_edit_date": 1512870212, "question_id": 47735012, "link": "https://stackoverflow.com/questions/47735012/how-are-functions-implemented", "title": "How are functions implemented?", "body": "<p>I've been playing around with the <code>reflect</code> package, and I notice how limited the functionality of functions are.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"strings\"\n)\n\nfunc main() {\n    v := reflect.ValueOf(strings.ToUpper)\n    fmt.Printf(\"Address: %v\\n\", v)               // 0xd54a0\n    fmt.Printf(\"Can set? %d\\n\", v.CanSet())      // False\n    fmt.Printf(\"Can address? %d\\n\", v.CanAddr()) // False\n    fmt.Printf(\"Element? %d\\n\", v.Elem())        // Panics\n}\n</code></pre>\n\n<p>Playground link <a href=\"https://play.golang.org/p/qAOxS1nsm0\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>I've been taught that functions are addresses to memory with a set of instructions (hence <code>v</code> prints out <code>0xd54a0</code>), but it looks like I can't get an address to this memory address, set it, or dereference it. </p>\n\n<p>So, how are Go functions implemented under the hood? Eventually, I'd ideally want to manipulate the <code>strings.ToUpper</code> function by making the function point to my own code.</p>\n"}, {"tags": ["go", "cookies", "gorilla"], "owner": {"reputation": 11, "user_id": 9078279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0240470dc7786b76c43e808250a21f2b?s=128&d=identicon&r=PG&f=1", "display_name": "robsonde", "link": "https://stackoverflow.com/users/9078279/robsonde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1512869305, "creation_date": 1512869305, "question_id": 47735007, "link": "https://stackoverflow.com/questions/47735007/cookies-with-golang-and-gorilla-csrf", "title": "cookies with golang and gorilla/csrf", "body": "<p>I am new to Go and trying to build a web site signup/login.</p>\n\n<p>I was doing session cookies like this:</p>\n\n<pre><code> // If the login succeeded\n    cookie:=&amp;http.Cookie{\n            Name: \"session\",\n            Value: uuid.NewV4().String(),\n        }\n        sessionStore[cookie.Value] = Client{true,databaseUsername}\n        http.SetCookie(res, cookie)\n        http.Redirect(res, req, \"/home\", 302)\n</code></pre>\n\n<p>But after adding CSRF protection using gorilla/csrf my session cookie is not working.</p>\n\n<p>any thought?</p>\n"}, {"tags": ["ssl", "go", "tls1.2"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512863632, "post_id": 47734440, "comment_id": 82429402, "body": "Since your clients/servers will need to authenticate each other why not just use server and client certificates signed by a known CA? Then all you need is an existing library (eg: grpc with SSL) and do mutual auth. This is way safer than trying to control a shared secret."}, {"owner": {"reputation": 43, "user_id": 3064090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294b63951265205824c3d21255ad58d9?s=128&d=identicon&r=PG&f=1", "display_name": "PSU2017", "link": "https://stackoverflow.com/users/3064090/psu2017"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512865106, "post_id": 47734440, "comment_id": 82429688, "body": "@Marc What&#39;s the easiest way to request a certificate from the server if I were to go with a self signed CA?"}, {"owner": {"reputation": 43, "user_id": 3064090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294b63951265205824c3d21255ad58d9?s=128&d=identicon&r=PG&f=1", "display_name": "PSU2017", "link": "https://stackoverflow.com/users/3064090/psu2017"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 1, "creation_date": 1512865728, "post_id": 47734440, "comment_id": 82429792, "body": "<a href=\"https://github.com/levigross/go-mutual-tls\" rel=\"nofollow noreferrer\">github.com/levigross/go-mutual-tls</a> seems like the right answer"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 2, "creation_date": 1512865857, "post_id": 47734440, "comment_id": 82429821, "body": "you don&#39;t request a certificate from the server, the client should already have a cert and key. If you&#39;re distributing secrets with your client, might as well go for that rather than try to do your own authentication scheme that returns a certificate."}], "owner": {"reputation": 43, "user_id": 3064090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294b63951265205824c3d21255ad58d9?s=128&d=identicon&r=PG&f=1", "display_name": "PSU2017", "link": "https://stackoverflow.com/users/3064090/psu2017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512863333, "creation_date": 1512863333, "question_id": 47734440, "link": "https://stackoverflow.com/questions/47734440/client-server-tls-authentication-in-go", "title": "Client/Server TLS Authentication in Go", "body": "<p>What's the easiest way to get TCP Client/Server authentication via TLS/Certs/Keys in Go? </p>\n\n<p>That is, I have a TCP server, and when a new client tries to connect to it, it should receive a certificate/key from the Server to allow it to connect again in the future without re-authenticating (or at least until the certificate expires). Both the client and the server should authenticate the other. OpenSSL isn't an option to create keys as the clients will be cross platform (Windows/macOS/Linux). Essentially, the server should only accept connections from known clients, and authorize new clients as needed (the clients can have some sort of known secret when installed).</p>\n\n<p>Here's what I think the general flow is (correct me if I'm wrong)</p>\n\n<p>Server: Get Cert/Key pair --> if they don't exist, create them --> listen on port --> receive connection --> verify Certificate is valid --> if not, reject --> if it is, continue to do what the server is supposed to do</p>\n\n<p>Client: Get cert/key pair --> if they don't exist (i.e just installed), request from the server (Signed by the server) --> continue to connect as normal</p>\n\n<p>This is still in the planning phase and open to all suggestions!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["gcc", "go", "compilation", "compiler-construction", "cross-compiling"], "comments": [{"owner": {"reputation": 1239, "user_id": 8887578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3nMBo.png?s=128&g=1", "display_name": "Do Say Lazy", "link": "https://stackoverflow.com/users/8887578/do-say-lazy"}, "edited": false, "score": 3, "creation_date": 1512863164, "post_id": 47734417, "comment_id": 82429314, "body": "<a href=\"https://en.wikipedia.org/wiki/Bootstrapping_(compilers)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Bootstrapping_(compilers)</a>"}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "reply_to_user": {"reputation": 1239, "user_id": 8887578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3nMBo.png?s=128&g=1", "display_name": "Do Say Lazy", "link": "https://stackoverflow.com/users/8887578/do-say-lazy"}, "edited": false, "score": 0, "creation_date": 1512863228, "post_id": 47734417, "comment_id": 82429326, "body": "tanks you , So go is a self-hosting compiler, so what execute and run <code>.go</code> file at <a href=\"https://github.com/golang/go\" rel=\"nofollow noreferrer\">github.com/golang/go</a> ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513001915, "post_id": 47734417, "comment_id": 82470358, "body": "Also note that the majority of what&#39;s in github.com/golang/go is the standard library, not the compiler."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513005478, "post_id": 47734417, "comment_id": 82472748, "body": "woow , where available compiler source? @Adrian"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1513005562, "post_id": 47734417, "comment_id": 82472805, "body": "Same repo. It&#39;s the compiler, tools, standard library, tests, and documentation, it&#39;s all there."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513006954, "post_id": 47734417, "comment_id": 82473725, "body": "<a href=\"https://github.com/golang/go\" rel=\"nofollow noreferrer\">github.com/golang/go</a> , Original/Final Compiler for <code>.go</code> is write at <code>.c</code>? <a href=\"https://github.com/golang/go/search?l=c\" rel=\"nofollow noreferrer\">github.com/golang/go/search?l=c</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1512863464, "post_id": 47734449, "comment_id": 82429366, "body": "tanks you , if go is a self-hosting compiler , so use ASM for execute and parse .go file?"}, {"owner": {"reputation": 1239, "user_id": 8887578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3nMBo.png?s=128&g=1", "display_name": "Do Say Lazy", "link": "https://stackoverflow.com/users/8887578/do-say-lazy"}, "reply_to_user": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1512863523, "post_id": 47734449, "comment_id": 82429378, "body": "The Go compiler written in Go is used to compile itself, but the original Go compiler was written in C and compiled using a C compiler."}, {"owner": {"reputation": 1239, "user_id": 8887578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3nMBo.png?s=128&g=1", "display_name": "Do Say Lazy", "link": "https://stackoverflow.com/users/8887578/do-say-lazy"}, "reply_to_user": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1512927568, "post_id": 47734449, "comment_id": 82443194, "body": "I&#39;m a little confused about the Go compiler because I see Go code right from the branch of the first release... Nevertheless, you should take a peek around <a href=\"https://github.com/golang/go\" rel=\"nofollow noreferrer\">github.com/golang/go</a> , and also read <a href=\"https://docs.google.com/document/d/1OaatvGhEAq7VseQ9kkavxKNAfepWy2yhPUBs96FGV28/edit#\" rel=\"nofollow noreferrer\">docs.google.com/document/d/&hellip;</a>! ."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1512943431, "post_id": 47734449, "comment_id": 82447994, "body": "<a href=\"https://golang.org/doc/faq#What_compiler_technology_is_used_to_build_the_compilers\" rel=\"nofollow noreferrer\">golang.org/doc/&hellip;</a> , how can see Gc original compiler of go? is open source?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1512998244, "post_id": 47734449, "comment_id": 82468100, "body": "@Nahad, if by &quot;original&quot; you mean &quot;written in C&quot;, then just check out the branch &quot;release1.4&quot; from the Go&#39;s Git repository, or the branches for any earlier version."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513000279, "post_id": 47734449, "comment_id": 82469395, "body": "i want see source of original compiler(last version Go)."}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "reply_to_user": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513004393, "post_id": 47734449, "comment_id": 82472009, "body": "@Nahad What do you mean by original? Current version can be found in <a href=\"https://github.com/golang/go\" rel=\"nofollow noreferrer\">github.com/golang/go</a> older version that implemented with C can be found in older branches like <a href=\"https://github.com/golang/go/tree/release-branch.go1.4\" rel=\"nofollow noreferrer\">github.com/golang/go/tree/release-branch.go1.4</a>"}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513005401, "post_id": 47734449, "comment_id": 82472701, "body": "i not want go1.4 then in using c.  88% source of <a href=\"https://github.com/golang/go\" rel=\"nofollow noreferrer\">github.com/golang/go</a> is <code>.go</code> file. what compile <code>.go</code> file at Go Source? i want see Final GO Compiler?"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "reply_to_user": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513061868, "post_id": 47734449, "comment_id": 82494788, "body": "@Nahad An old version of Go compiler (version 1.4) is used to compile newer version of Go compiler. Furthermore, not all files in git repository are related to compiler lots of them are standard library."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "reply_to_user": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1513077352, "post_id": 47734449, "comment_id": 82503333, "body": "<code>go-go1.4.3&#47;src&#47;go&#47;token&#47;token.go</code> this is go lexer and is write at go so where main compiler?  ,  \tFUNC:   &quot;func&quot;, \tGO:     &quot;go&quot;, \tGOTO:   &quot;goto&quot;, \tIF:     &quot;if&quot;,  @ArmanOrdookhani"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "reply_to_user": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513078119, "post_id": 47734449, "comment_id": 82503792, "body": "@Nahad Those file was not used in the compiler itself and intended for people want to parse go files. I think go compiler used yacc for lexing that time."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "reply_to_user": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1513078175, "post_id": 47734449, "comment_id": 82503831, "body": "i want see source of main compiler for parse and execute <code>.go</code> file? where can see this? @ArmanOrdookhani"}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513078279, "post_id": 47734449, "comment_id": 82503900, "body": "main compiler is <code>GC</code>? where available source of main compiler?"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "reply_to_user": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 1, "creation_date": 1513078435, "post_id": 47734449, "comment_id": 82504015, "body": "@Nahad See this file it&#39;s compiler entry point <a href=\"https://github.com/golang/go/blob/release-branch.go1.4/src/cmd/gc/lex.c#L199\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/release-branch.go1.4/src/cmd/gc/&hellip;</a> gc directory is compiler architecture-independent parts."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513078798, "post_id": 47734449, "comment_id": 82504239, "body": "so all code/files of main compiler at <code>go-go1.4.3&#47;src&#47;cmd&#47;gc</code>?  , all is c and 1.1MB file."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513078889, "post_id": 47734449, "comment_id": 82504309, "body": "if parser of go is <code>go-go1.4.3&#47;src&#47;cmd&#47;gc&#47;go.y</code> . so why also another parser at <code>go-go1.4.3&#47;src&#47;go&#47;parser&#47;parser.go</code> ?"}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "reply_to_user": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1513079237, "post_id": 47734449, "comment_id": 82504508, "body": "go-go1.4.3/src/cmd/gc$ make ----------------      go tool dist install -v     make: go: Command not found     ../../Make.dist:13: recipe for target &#39;install&#39; failed     make: *** [install] Error 127  ---------------- , make at gc also need go!? :|||| @ArmanOrdookhani"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "reply_to_user": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "edited": false, "score": 0, "creation_date": 1513079468, "post_id": 47734449, "comment_id": 82504622, "body": "@Nahad You should run <code>make.bash</code>. If there is a problem make another question about compiling old go lang compiler."}, {"owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "reply_to_user": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1513081361, "post_id": 47734449, "comment_id": 82505849, "body": "Last version of GO Language how work?! mean how this generate a output for cross platform? this use generate code to C and then use c compiler? @ArmanOrdookhani"}], "tags": [], "owner": {"reputation": 1239, "user_id": 8887578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3nMBo.png?s=128&g=1", "display_name": "Do Say Lazy", "link": "https://stackoverflow.com/users/8887578/do-say-lazy"}, "is_accepted": true, "score": 7, "last_activity_date": 1512863424, "creation_date": 1512863424, "answer_id": 47734449, "question_id": 47734417, "link": "https://stackoverflow.com/questions/47734417/why-does-go-source-contain-many-go-files-how-do-they-get-compiled/47734449#47734449", "title": "Why does Go source contain many .go files? How do they get compiled?", "body": "<p>According to <a href=\"https://golang.org/doc/go1.5#implementation\" rel=\"noreferrer\">https://golang.org/doc/go1.5#implementation</a> and <a href=\"https://www.infoq.com/news/2015/01/golang-15-bootstrapped\" rel=\"noreferrer\">https://www.infoq.com/news/2015/01/golang-15-bootstrapped</a> , Go was originally implemented in C but became self-hosted at version 1.5. Bootstrapping is the process of compiling a compiler with itself. The Go developers wrote a C -> Go transpiler to convert the original C compiler to Go, then they hand-edited the Go code to make it idiomatic.</p>\n"}], "owner": {"reputation": 11, "user_id": 8844473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb85c111e66cc9915f153ec098b84932?s=128&d=identicon&r=PG&f=1", "display_name": "Nahad", "link": "https://stackoverflow.com/users/8844473/nahad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 47734449, "answer_count": 1, "score": 0, "last_activity_date": 1513116960, "creation_date": 1512863041, "last_edit_date": 1513116960, "question_id": 47734417, "link": "https://stackoverflow.com/questions/47734417/why-does-go-source-contain-many-go-files-how-do-they-get-compiled", "title": "Why does Go source contain many .go files? How do they get compiled?", "body": "<p>i want know how go compiler work!</p>\n\n<p><a href=\"https://github.com/golang/go\" rel=\"nofollow noreferrer\">https://github.com/golang/go</a>\nthis source Contains 88% <code>.go</code> file.</p>\n\n<p>so this should be have another compiler to execute <code>.go</code> file.</p>\n\n<p>Example : <a href=\"https://github.com/golang/go/blob/964639cc338db650ccadeafb7424bc8ebb2c0f6c/src/go/ast/ast.go\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/964639cc338db650ccadeafb7424bc8ebb2c0f6c/src/go/ast/ast.go</a></p>\n\n<p>Golang use what compiler for final Generate Execute file?! and where available they source?</p>\n\n<p>may be Golang generate a c code and next use GCC or ...?</p>\n\n<h2>New Update</h2>\n\n<p>i not want go1.4 then in using c.</p>\n\n<p>88% source of github.com/golang/go is <code>.go</code> file. what compile <code>.go</code> file at Go Source? i want see Final GO Compiler? </p>\n\n<p><a href=\"https://github.com/golang/go/search?l=c\" rel=\"nofollow noreferrer\">https://github.com/golang/go/search?l=c</a></p>\n\n<p>i think this called <code>cg</code>.</p>\n\n<hr>\n\n<p>mean An old version of Go compiler (version 1.4) is used to compile newer version of Go compiler.???!</p>\n\n<p><code>go-go1.4.3/src/go/token/token.go</code> this is go token,lexer and is write at GO</p>\n\n<p><code>\n    FUNC:   \"func\",\n    GO:     \"go\",\n    GOTO:   \"goto\",\n    IF:     \"if\",\n    IMPORT: \"import\",\n</code></p>\n\n<h2>so where main compiler for execute <code>.go</code> file?</h2>\n\n<p><code>go-go1.4.3/src/runtime/compiler.go</code></p>\n\n<pre><code>// Copyright 2012 The Go Authors.  All rights reserved.\npackage runtime\n// Compiler is the name of the compiler toolchain that built the\n// running binary.  Known toolchains are:\n//\n//  gc      The 5g/6g/8g compiler suite at code.google.com/p/go.\n//  gccgo   The gccgo front end, part of the GCC compiler suite.\n//\nconst Compiler = \"gc\"\n</code></pre>\n\n<hr>\n\n<h2>go-go1.4.3/src/cmd/gc$ make</h2>\n\n<pre><code>go tool dist install -v\nmake: go: Command not found\n../../Make.dist:13: recipe for target 'install' failed\nmake: *** [install] Error 127\n</code></pre>\n\n<p>make gc why need Go?!</p>\n\n<hr>\n\n<h2>Last version of GO Language how work?! mean how this generate a output for cross platform? this use generate code to C and then use c compiler?</h2>\n"}, {"tags": ["ssl", "go", "cryptography", "x509"], "answers": [{"comments": [{"owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1512861437, "post_id": 47734175, "comment_id": 82428953, "body": "The certificate is already in production in another system I&#39;m porting. Also, running <code>wget https:&#47;&#47;secure.site --ca-certificate=&#47;the&#47;certificate</code> works. There must be something wrong in my implementation."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1512861685, "post_id": 47734175, "comment_id": 82429010, "body": "Can you dump the contents of the server cert using: <code>$ openssl s_client -showcerts -connect secure.site:443</code>, we&#39;re looking for the <code>Server certificate: subject</code> section."}, {"owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1512861921, "post_id": 47734175, "comment_id": 82429056, "body": "<code>Server certificate subject=&#47;C=SE&#47;O=Company Inc.&#47;OU=Server1024&#47;serialNumber=165563372191&#47;CN=secure.site issuer=&#47;C=SE&#47;O=Issues Inc.&#47;CN=Issuer Inc. EID CA v2</code>"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1512862669, "post_id": 47734175, "comment_id": 82429212, "body": "That is odd. I&#39;m pretty sure the certificate validity check comes before the host check so your CA should be fine. Just to make sure, can you add <code>--verify_hostname secure.site</code> to the openssl command? It should finish with <code>Verify return code: 0 (ok)</code>"}, {"owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1512862963, "post_id": 47734175, "comment_id": 82429272, "body": "I get all the output again... should I remove any other parameters? Also, I&#39;m curious as of whether it&#39;s related to this: <a href=\"https://github.com/golang/go/issues/22922\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/22922</a>"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1512863216, "post_id": 47734175, "comment_id": 82429323, "body": "That might be it. One last try: <code>openssl s_client -connect secure.site:443 | openssl x509 -noout -text</code>. That dumps the entire certificate. Look for <code>X509v3 Subject Alternative Name</code>. If the field is there but does not contain <code>secure.site</code>, that&#39;s your problem."}, {"owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1512864227, "post_id": 47734175, "comment_id": 82429532, "body": "Yup, you got it!  <code>X509v3 Subject Alternative Name: email:secure@company.com</code>  If you want to, make an answer about that bug, stating that Go have actively decided to ignore CNs if there are SANs and I&#39;ll accept it :)"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1512864341, "post_id": 47734175, "comment_id": 82429555, "body": "Sure, I&#39;ll just edit my previous answer. It&#39;s all on you for finding the issue though, glad I learned something."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 2, "creation_date": 1512864618, "post_id": 47734175, "comment_id": 82429594, "body": "&quot;...Go now ignores the Common Name if is a SAN is found...&quot; According to RFC 2818 that is a bug, pure and simple."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 4, "last_activity_date": 1512864486, "last_edit_date": 1512864486, "creation_date": 1512860777, "answer_id": 47734175, "question_id": 47734147, "link": "https://stackoverflow.com/questions/47734147/golang-certificate-validation/47734175#47734175", "title": "Golang certificate validation", "body": "<p>You need to do two things:</p>\n\n<ol>\n<li>add the CA certificate on the server side as well, the CA needs to be known by all parties.</li>\n<li>generate and use a server certificate (with the hostname in the certificate) on the server. The server cert needs to be signed by the CA.</li>\n</ol>\n\n<p>You can find an example of this at <a href=\"https://github.com/jcbsmpsn/golang-https-example\" rel=\"nofollow noreferrer\">here</a> (first google example)</p>\n\n<p>Edit: to clarify, the error is due to the fact that you are trying to connect securely to a remote host. By default, the go client will look for a valid certificate returned by the server.</p>\n\n<p>Valid means (among other things):</p>\n\n<ol>\n<li>it is signed by a known CA</li>\n<li>it contains the ip/dns of the server (the one you passed to <code>http.NewRequest</code>) in the <code>CommonName</code> or <code>Subject Alternative Name: DNS/IP</code> fields.</li>\n</ol>\n\n<p><strong>final edit</strong>:</p>\n\n<p>The server certificate contained the correct <code>Common Name</code> set to the server hostname, but it also contained a <code>Subject Alternative Name</code> set to an email address.</p>\n\n<p>As mentioned in <a href=\"https://groups.google.com/a/chromium.org/forum/#!topic/security-dev/IGT2fLJrAeo\" rel=\"nofollow noreferrer\">https://groups.google.com/a/chromium.org/forum/#!topic/security-dev/IGT2fLJrAeo</a>, Go now ignores the <code>Common Name</code> if is a SAN is found.</p>\n"}], "owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5077, "favorite_count": 1, "accepted_answer_id": 47734175, "answer_count": 1, "score": 1, "last_activity_date": 1512864486, "creation_date": 1512860473, "question_id": 47734147, "link": "https://stackoverflow.com/questions/47734147/golang-certificate-validation", "title": "Golang certificate validation", "body": "<p>I'm using Go to perform HTTPS requests with a custom root CA. The root CA is the only certificate I have on my side.</p>\n\n<p>My code looks like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// performRequest sets up the HTTPS Client we'll use for communication and handle the actual requesting to the external\n// end point. It is used by the auth and collect adapters who set their response data up first.\nfunc performRequest(rawData []byte, soapHeader string) (*http.Response, error) {\n  conf := config.GetConfig()\n\n  // Set up the certificate handler and the HTTP client.\n  certPool := x509.NewCertPool()\n  certPool.AppendCertsFromPEM(certificate)\n  client := &amp;http.Client{\n    Transport: &amp;http.Transport{\n      TLSClientConfig: &amp;tls.Config{\n        RootCAs:            certPool,\n        InsecureSkipVerify: false,\n      },\n    },\n  }\n\n  req, err := http.NewRequest(http.MethodPost, baseURL, bytes.NewBuffer(rawData))\n  if err != nil {\n    return nil, err\n  }\n\n  // Sets the SOAPAction and Content-Type headers to the request.\n  req.Header.Set(\"SOAPAction\", soapHeader)\n  req.Header.Set(\"Content-Type\", \"text/xml; charset=UTF-8\")\n\n  // Send request as our custom client, return response\n  return client.Do(req)\n}\n</code></pre>\n\n<p>The error I get back is this:</p>\n\n<pre><code>2017/12/09 21:06:13 Post https://secure.site: x509: certificate is not valid for any names, but wanted to match secure.site\n</code></pre>\n\n<p>I've been unable to find out exactly what the cause is of this. When checking the SANs of the CA cert, I don't have <code>secure.site</code> in there (no names at all, as the error states), but I can't see how I've done this wrong.</p>\n\n<p>What should I do to troubleshoot this?</p>\n"}, {"tags": ["c++", "go", "openssl", "aes"], "comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 3, "creation_date": 1512855627, "post_id": 47733366, "comment_id": 82427439, "body": "Your C++ version uses only 128 bits of the key, whereas your Go version uses all 256 bits of the key. Thus, the difference is in AES-128 vs. AES-256.  Do you get the same results when calling <code>AES_set_encrypt_key(&amp;key[0], 256, &amp;ctx);</code>? Or to answer the question, try to use in Go <code>key := []byte{52, 51, 51, 100, 52, 53, 98, 57, 51, 98, 98, 98, 102, 102, 56, 100}</code>"}, {"owner": {"reputation": 11, "user_id": 6453045, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y90w-hVdVHA/AAAAAAAAAAI/AAAAAAAAAOk/voWlAs2Ay7g/photo.jpg?sz=128", "display_name": "Vitalii Maslov", "link": "https://stackoverflow.com/users/6453045/vitalii-maslov"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1512973695, "post_id": 47733366, "comment_id": 82455025, "body": "@zett42, you are helped me. Thank you for explaination."}], "owner": {"reputation": 11, "user_id": 6453045, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y90w-hVdVHA/AAAAAAAAAAI/AAAAAAAAAOk/voWlAs2Ay7g/photo.jpg?sz=128", "display_name": "Vitalii Maslov", "link": "https://stackoverflow.com/users/6453045/vitalii-maslov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512854764, "creation_date": 1512854764, "question_id": 47733366, "link": "https://stackoverflow.com/questions/47733366/difference-between-c-openssl-aes-and-go-crypto-aes", "title": "Difference between C++ openssl/aes and Go crypto/aes", "body": "<p>I have two programs on C++ and Go for encrypt data using AES, but they returns different results. Could you explain me the difference? How I can write similar code to get the same result using Go?</p>\n\n<p><strong>C++</strong></p>\n\n<blockquote>\n  <p>g++ aes.cpp -o aes -O3 -lcrypto -std=c++11 &amp;&amp; ./aes</p>\n</blockquote>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\n#include &lt;openssl/aes.h&gt;\n\nusing std::cout;\n\nint main(int argc, char const *argv[]) {\n    uint8_t result[16] = {0};\n    uint8_t key[32] = {\n      52, 51, 51, 100, 52, 53, 98, 57, 51, 98, 98, 98, 102, 102, 56, 100,\n      54, 53, 53, 49, 55, 56, 54, 51, 50, 102, 49, 56, 101, 97, 101, 97,\n    };\n    uint8_t data[16] = {\n      89, 0, 192, 238, 251, 3, 19, 11, 0, 0, 0, 0, 0, 15, 0, 236,\n    };\n\n    AES_KEY ctx;\n    AES_set_encrypt_key(&amp;key[0], 128, &amp;ctx);\n\n    AES_encrypt(data, result, &amp;ctx);\n\n    std::cout &lt;&lt; \"Result: \";\n\n    for (auto const&amp; value: result) {\n        std::cout &lt;&lt; unsigned(value) &lt;&lt; \",\";\n    }\n\n    std::cout &lt;&lt; '\\n';\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>Result: 65,68,199,89,141,129,6,202,211,198,47,54,212,0,243,130</p>\n</blockquote>\n\n<p><strong>Go</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"log\"\n)\n\nfunc main() {\n    result := make([]byte, 16)\n    key := []byte{\n        52, 51, 51, 100, 52, 53, 98, 57, 51, 98, 98, 98, 102, 102, 56, 100,\n        54, 53, 53, 49, 55, 56, 54, 51, 50, 102, 49, 56, 101, 97, 101, 97,\n    }\n    data := []byte{89, 0, 192, 238, 251, 3, 19, 11, 0, 0, 0, 0, 0, 15, 0, 236}\n\n    cipher, err := aes.NewCipher(key)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    cipher.Encrypt(result, data)\n\n    log.Println(result)\n}\n</code></pre>\n\n<blockquote>\n  <p>Result: 18 144 147 200 175 53 202 191 80 17 142 126 228 220 57 180</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1512933792, "post_id": 47731919, "comment_id": 82445225, "body": "If feels that in this case a post processing is perhaps simpler, especially if your yaml is small and simple. Meaning let lib to it&#39;s work and then simply modify your <code>VerySimple.data</code> to fit your actual path."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1512846613, "creation_date": 1512846613, "answer_id": 47732142, "question_id": 47731919, "link": "https://stackoverflow.com/questions/47731919/stateful-implementation-of-yaml-v2-unmarshaller-interface/47732142#47732142", "title": "Stateful implementation of yaml.v2 Unmarshaller interface?", "body": "<p>It's pretty clear from the <a href=\"https://godoc.org/gopkg.in/yaml.v2\" rel=\"nofollow noreferrer\">API documentation</a> that this isn't supported. The natural way to support it, IMO, would be with a Decoder type, analogous to the <a href=\"https://golang.org/pkg/encoding/json/#Decoder\" rel=\"nofollow noreferrer\"><code>json.Decoder</code></a> type. It could be initialized with a root include path, or a list of include paths to search.</p>\n\n<p>There is <a href=\"https://github.com/go-yaml/yaml/issues/4\" rel=\"nofollow noreferrer\">already a request</a> for such a feature. It does mention working with multiple documents, which probably implies including an include path, although that specific feature has not yet been explicitly mentioned. I suggest offering your ideas in that thread.</p>\n"}], "owner": {"reputation": 8058, "user_id": 8528, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/649821cb51ef40f0b6c9bf87fcd4c08e?s=128&d=identicon&r=PG", "display_name": "Spencer Kormos", "link": "https://stackoverflow.com/users/8528/spencer-kormos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512846613, "creation_date": 1512845030, "question_id": 47731919, "link": "https://stackoverflow.com/questions/47731919/stateful-implementation-of-yaml-v2-unmarshaller-interface", "title": "Stateful implementation of yaml.v2 Unmarshaller interface?", "body": "<p>This could either be a file path question, or a question on how to best implement an interface.</p>\n\n<p>Given the following very simple yaml:</p>\n\n<pre><code>name: MyYamlName\ndata: some/relative/path.txt\n</code></pre>\n\n<p>I would like to unmarshal it to the following struct:</p>\n\n<pre><code>type VerySimple struct {\n    name string\n    data io.Reader\n}\n</code></pre>\n\n<p>I'm already using the <a href=\"http://gopkg.in/yaml.v2\" rel=\"nofollow noreferrer\">yaml.v2 library</a>, and know that for simple types, I can implement the <a href=\"https://godoc.org/gopkg.in/yaml.v2#Unmarshaler\" rel=\"nofollow noreferrer\">Unmarshaller</a> interface. However, in my program, I can't assume an absolute root from which to base the relative path in the <code>data</code> field. </p>\n\n<p>Is there a way to implement the <code>Unmarshaller</code> interface to pass a working directory, or maybe a different way to handle relative paths in Go?</p>\n"}, {"tags": ["go", "build", "standards"], "answers": [{"comments": [{"owner": {"reputation": 2308, "user_id": 532383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b16537f0f4ce1a484c06d3fc996ea37?s=128&d=identicon&r=PG", "display_name": "Ayub Malik", "link": "https://stackoverflow.com/users/532383/ayub-malik"}, "edited": false, "score": 0, "creation_date": 1512843040, "post_id": 47731525, "comment_id": 82423774, "body": "so there is nothing &#39;magic&#39; about the &#39;internal/pkg&#39; layout and it&#39;s just a convention?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2308, "user_id": 532383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b16537f0f4ce1a484c06d3fc996ea37?s=128&d=identicon&r=PG", "display_name": "Ayub Malik", "link": "https://stackoverflow.com/users/532383/ayub-malik"}, "edited": false, "score": 2, "creation_date": 1512844480, "post_id": 47731525, "comment_id": 82424219, "body": "There&#39;s <a href=\"https://docs.google.com/document/d/1e8kOo3r51b2BWtTs_1uADIA5djfXhPT36s6eHVRIvaU/edit\" rel=\"nofollow noreferrer\">magic to &quot;internal&quot; regarding access</a>. There&#39;s no magic regarding naming. Most of what&#39;s in the document is one person&#39;s convention on how to layout a project."}, {"owner": {"reputation": 455, "user_id": 2033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6552571bdbfa7d31353b64f6fdec053a?s=128&d=identicon&r=PG", "display_name": "Sreenidhi Sreesha", "link": "https://stackoverflow.com/users/2033450/sreenidhi-sreesha"}, "edited": false, "score": 0, "creation_date": 1526950181, "post_id": 47731525, "comment_id": 87930080, "body": "The document suggests to remove src directory, but your answer includes src directory.  This is confusing."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 455, "user_id": 2033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6552571bdbfa7d31353b64f6fdec053a?s=128&d=identicon&r=PG", "display_name": "Sreenidhi Sreesha", "link": "https://stackoverflow.com/users/2033450/sreenidhi-sreesha"}, "edited": false, "score": 1, "creation_date": 1526952221, "post_id": 47731525, "comment_id": 87930481, "body": "@SreenidhiSreesha The document says that a project should not contain a <code>src</code> directory.     The <code>src</code> directory shown in my answer is not part of the project.  See <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">How To Write Go Code</a> for information about this directory."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1512842427, "creation_date": 1512842427, "answer_id": 47731525, "question_id": 47730362, "link": "https://stackoverflow.com/questions/47730362/go-build-project-with-cmd-and-pkg-layout-build-error/47731525#47731525", "title": "Go build project with cmd and pkg layout - build error", "body": "<p>The document suggests this structure:</p>\n\n<pre><code>$GOPATH/src/github.com/ayubmalik/cleanprops\n    /cmd\n        /cleanprops\n            /main.go\n    /internal\n        /pkg\n            /cleanprops\n                /readprops.go\n</code></pre>\n\n<p>Import the package like this. The import path matches the directory structure below $GOPATH/src.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/ayubmalik/cleanprops/internal/pkg/cleanprops\"\n)\n\nfunc main() {\n    body := cleanprops.ReadProps(\"/tmp/hello.props\")\n    fmt.Println(\"%s\", body)\n}\n</code></pre>\n"}], "owner": {"reputation": 2308, "user_id": 532383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b16537f0f4ce1a484c06d3fc996ea37?s=128&d=identicon&r=PG", "display_name": "Ayub Malik", "link": "https://stackoverflow.com/users/532383/ayub-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1614, "favorite_count": 1, "accepted_answer_id": 47731525, "answer_count": 1, "score": 4, "last_activity_date": 1512842427, "creation_date": 1512835046, "last_edit_date": 1512835753, "question_id": 47730362, "link": "https://stackoverflow.com/questions/47730362/go-build-project-with-cmd-and-pkg-layout-build-error", "title": "Go build project with cmd and pkg layout - build error", "body": "<p>I'm trying to build a Go project using the layout as described in <a href=\"https://github.com/golang-standards/project-layout\" rel=\"nofollow noreferrer\">Go Project Layout</a></p>\n\n<p>I'm using go 1.9.2 on Ubuntu. My project layout is as follows</p>\n\n<pre><code>$GOPATH/src/github.com/ayubmalik/cleanprops\n    /cmd\n        /cleanprops\n            /main.go\n    /internal\n        /pkg\n            /readprops.go\n</code></pre>\n\n<p>The file cmd/cleanprops/main.go is referring to the cleanprops package i.e.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/ayubmalik/cleanprops\"\n)\n\nfunc main() {\n    body := cleanprops.ReadProps(\"/tmp/hello.props\")\n    fmt.Println(\"%s\", body)\n}\n</code></pre>\n\n<p>The contents of internal/pkg/readprops.go are:</p>\n\n<pre><code>package cleanprops\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n\nfunc ReadProps(file string) string {\n    body, err := ioutil.ReadFile(file)\n    check(err)\n    fmt.Println(string(body))\n    return body\n}\n</code></pre>\n\n<p>However when I build cmd/cleanprops/main.go, from inside directory $GOPATH/src/github.com/ayubmalik/cleanprops, using command:</p>\n\n<pre><code>go build cmd/cleanprops/main.go \n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>cmd/cleanprops/main.go:5:2: no Go files in /home/xyz/go/src/github.com/ayubmalik/cleanprops\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "is_accepted": false, "score": 0, "last_activity_date": 1512993840, "creation_date": 1512993840, "answer_id": 47752575, "question_id": 47729295, "link": "https://stackoverflow.com/questions/47729295/google-appengine-cloud-tasks-alpha-handler-http-404-error/47752575#47752575", "title": "Google appengine cloud tasks alpha handler http 404 error", "body": "<p>It turns out endpoints can't run on the same service as task handlers. Task handler url requests are blocked by the ESP proxy if they run on the same service in the flexible environment, and the service has the endpoints service enabled. </p>\n\n<p>Run task handlers on a separate service and do not set \"endpoints_api_service:\" in the task handler service app.yaml file. </p>\n\n<p>Doing so will prevent the queue from being able to dispatch to workers in the flexible environment. </p>\n\n<p>This isn't mentioned in the app engine documentation which is kinda bizarre. </p>\n\n<p>The \"/_ah/health\" issue was caused by this path not being set in the open api file. If this path isn't set the url isn't recognised by the proxy. </p>\n"}], "owner": {"reputation": 457, "user_id": 4489733, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/10714df646d369c5a41225156d051cac?s=128&d=identicon&r=PG&f=1", "display_name": "mbudge", "link": "https://stackoverflow.com/users/4489733/mbudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512993840, "creation_date": 1512827773, "last_edit_date": 1512904397, "question_id": 47729295, "link": "https://stackoverflow.com/questions/47729295/google-appengine-cloud-tasks-alpha-handler-http-404-error", "title": "Google appengine cloud tasks alpha handler http 404 error", "body": "<p>When I send a task to a task queue it keeps failing and shows a http 404 (not found) error in the logs. </p>\n\n<p>The project has been whitelisted for cloud tasks alpha on flexible. </p>\n\n<p>I can send HTTP post requests to /endpointpath &amp; /tasks/worker locally without any errors. </p>\n\n<p>The endpoint works fine and adds the task to the task queue. </p>\n\n<pre><code> 13:37:41.300 POST 200 0 B 422 ms curl/7.54.0 /endpointspath?key=keyremoved 0.0.0.0 - \"POST endpointspath?key=keyremoved\" 200 undefined \"-\" \"curl/7.54.0\"\n</code></pre>\n\n<p>The app is running as the default service. </p>\n\n<p>app.go main func:</p>\n\n<pre><code>func main() {\n    r := mux.NewRouter()\n\n    r.HandleFunc(\"/\", handler)\n\n    r.HandleFunc(\"/_ah/health\", healthCheckHandler)\n\n    // Task handlers\n\n    r.Path(\"/tasks/worker\").Methods(\"POST\", \"GET\", \"PUT\").HandlerFunc(workerTaskHandler)\n\n    // Endpoints\n\n    r.Path(\"/endpointpath\").Methods(\"POST\").HandlerFunc(searchHandler)\n\n    http.Handle(\"/\", r)\n\n    port := 8080\n    if portStr := os.Getenv(\"PORT\"); portStr != \"\" {\n        port, _ = strconv.Atoi(portStr)\n    }\n    log.Fatal(http.ListenAndServe(fmt.Sprintf(\":%d\", port), nil))\n}\n</code></pre>\n\n<p>abbreviated app.yaml:</p>\n\n<pre><code>runtime: go\nenv: flex\n\nhandlers:\n- url: /tasks/.*\n  script: _go_app\n- url: /.*\n  script: _go_app\n</code></pre>\n\n<p>Logs HTTP 404 response when queue dispatches request to worker:</p>\n\n<pre><code>10.0.0.1 - \"POST /tasks/worker\" 404 200 \"-\" \"AppEngine-Google; (+http://code.google.com/appengine)\"\nExpand all | Collapse all {\n httpRequest: {\n  latency:  \"0s\"    \n  referer:  \"-\"    \n  remoteIp:  \"10.0.0.1\"    \n  requestMethod:  \"POST\"    \n  requestUrl:  \"/tasks/worker\"    \n  responseSize:  \"200\"    \n  status:  404    \n  userAgent:  \"AppEngine-Google; (+http://code.google.com/appengine)\"    \n }\n insertId:  \".......\"   \n jsonPayload: {\n  appLatencySeconds:  \"-\"    \n  latencySeconds:  \"0.000\"    \n  time:  null    \n  trace:  \".......\"    \n }\n labels: {\n  appengine.googleapis.com/instance_name:  \"......\"    \n  appengine.googleapis.com/trace_id:  \".......\"    \n  compute.googleapis.com/resource_id:  \".......\"    \n  compute.googleapis.com/resource_name:  \"......\"    \n  compute.googleapis.com/zone:  \"us-central1-b\"    \n }\n logName:  \"projects/projectname/logs/appengine.googleapis.com%2Fnginx.request\"   \n receiveTimestamp:  \"2017-12-09T10:56:14.794726383Z\"   \n resource: {\n  labels: {\n   module_id:  \"default\"     \n   project_id:  \"projectname\"     \n   version_id:  \".....\"     \n  }\n  type:  \"gae_app\"    \n }\n timestamp:  \"2017-12-09T10:56:10.301Z\"   \n}\n</code></pre>\n\n<p>The closest I can get GAE to find the tasks/worker url is by setting login:admin in app.yaml (even tho flex doesn't use this for authentication). This returns a 403 unauthorised error. </p>\n\n<pre><code>handlers:\n- url: /tasks/.*\n  script: _go_app\n  login: admin\n</code></pre>\n\n<p>Here is the 403 response in the logs </p>\n\n<pre><code>{\n httpRequest: {\n  latency:  \"0s\"    \n  referer:  \"-\"    \n  remoteIp:  \"10.0.0.1\"    \n  requestMethod:  \"POST\"    \n  requestUrl:  \"/tasks/worker\"    \n  responseSize:  \"162\"    \n  status:  403    \n  userAgent:  \"AppEngine-Google; (+http://code.google.com/appengine)\"    \n }\n insertId:  \".....\"   \n jsonPayload: {\n  appLatencySeconds:  \"-\"    \n  latencySeconds:  \"0.000\"    \n  time:  null    \n  trace:  \".....\"    \n }\n labels: {\n  appengine.googleapis.com/instance_name:  \"....\"    \n  appengine.googleapis.com/trace_id:  \"....\"    \n  compute.googleapis.com/resource_id:  \"....\"    \n  compute.googleapis.com/resource_name:  \".....\"    \n  compute.googleapis.com/zone:  \"us-central1-b\"    \n }\n logName:  \"projects/projectname/logs/appengine.googleapis.com%2Fnginx.request\"   \n receiveTimestamp:  \"2017-12-09T13:35:59.986118082Z\"   \n resource: {\n  labels: {\n   module_id:  \"default\"     \n   project_id:  \"projectname\"     \n   version_id:  \".....\"     \n  }\n  type:  \"gae_app\"    \n }\n timestamp:  \"2017-12-09T13:35:54.764Z\"   \n}\n</code></pre>\n\n<p>Not sure if it's related but projectname.appspot.com/_ah/health returns this error:</p>\n\n<pre><code>{\n \"code\": 5,\n \"message\": \"Method does not exist.\",\n \"details\": [\n  {\n   \"@type\": \"type.googleapis.com/google.rpc.DebugInfo\",\n   \"stackEntries\": [],\n   \"detail\": \"service_control\"\n  }\n ]\n}\n</code></pre>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 45, "user_id": 5234084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuUcs_xWX7M/AAAAAAAAAAI/AAAAAAAAADg/Fj8KMWw9i2Q/photo.jpg?sz=128", "display_name": "Hussain Shaikh", "link": "https://stackoverflow.com/users/5234084/hussain-shaikh"}, "edited": false, "score": 0, "creation_date": 1512839001, "post_id": 47728565, "comment_id": 82422388, "body": "Someone Help Please"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5234084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuUcs_xWX7M/AAAAAAAAAAI/AAAAAAAAADg/Fj8KMWw9i2Q/photo.jpg?sz=128", "display_name": "Hussain Shaikh", "link": "https://stackoverflow.com/users/5234084/hussain-shaikh"}, "edited": false, "score": 0, "creation_date": 1512880162, "post_id": 47731980, "comment_id": 82432136, "body": "I tried that but it doesn&#39;t allow me to assign users to Post.Users. It says model.users cannot be used as assignment to *model.Users."}, {"owner": {"reputation": 45, "user_id": 5234084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuUcs_xWX7M/AAAAAAAAAAI/AAAAAAAAADg/Fj8KMWw9i2Q/photo.jpg?sz=128", "display_name": "Hussain Shaikh", "link": "https://stackoverflow.com/users/5234084/hussain-shaikh"}, "edited": false, "score": 0, "creation_date": 1512880206, "post_id": 47731980, "comment_id": 82432144, "body": "And the thing i m trying to store in posts.Users is the id of currently logged in user"}, {"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "reply_to_user": {"reputation": 45, "user_id": 5234084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuUcs_xWX7M/AAAAAAAAAAI/AAAAAAAAADg/Fj8KMWw9i2Q/photo.jpg?sz=128", "display_name": "Hussain Shaikh", "link": "https://stackoverflow.com/users/5234084/hussain-shaikh"}, "edited": false, "score": 0, "creation_date": 1512902420, "post_id": 47731980, "comment_id": 82436112, "body": "Didn&#39;t notice how you init Users, should be <code>post.Users = &amp;users</code> then. Updated my answer."}], "tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": true, "score": 0, "last_activity_date": 1512902373, "last_edit_date": 1512902373, "creation_date": 1512845401, "answer_id": 47731980, "question_id": 47728565, "link": "https://stackoverflow.com/questions/47728565/how-to-assign-the-user-id-to-foreign-key/47731980#47731980", "title": "How to assign the User Id to Foreign Key", "body": "<p>First, answering your question:</p>\n\n<pre><code>post.Date = time.Now()\n// This is your last line\n// Up until now all good\npost.Users = &amp;users // Actually the naming is bad, should be post.User = user\no.Insert(users) // First create user \no.Insert(post) // Then insert post\n</code></pre>\n\n<p>This is very similar to the basic example BeeGo ORM provides: <a href=\"https://beego.me/docs/mvc/model/orm.md\" rel=\"nofollow noreferrer\">https://beego.me/docs/mvc/model/orm.md</a></p>\n\n<p>In real world, you'll notice that most of the time you have a user, and you only want to create it once. So you'll switch first <code>Insert</code> to <code>ReadOrCreate</code>: <a href=\"https://beego.me/docs/mvc/model/object.md#readorcreate\" rel=\"nofollow noreferrer\">https://beego.me/docs/mvc/model/object.md#readorcreate</a></p>\n\n<p>Having said that, from my experience, using MVC and ORM frameworks with Go is a bad idea. </p>\n"}], "owner": {"reputation": 45, "user_id": 5234084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuUcs_xWX7M/AAAAAAAAAAI/AAAAAAAAADg/Fj8KMWw9i2Q/photo.jpg?sz=128", "display_name": "Hussain Shaikh", "link": "https://stackoverflow.com/users/5234084/hussain-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 47731980, "answer_count": 1, "score": 1, "last_activity_date": 1512902373, "creation_date": 1512822268, "last_edit_date": 1512827799, "question_id": 47728565, "link": "https://stackoverflow.com/questions/47728565/how-to-assign-the-user-id-to-foreign-key", "title": "How to assign the User Id to Foreign Key", "body": "<pre><code>type Users struct {\n    Id       int `orm:\"pk;auto\"`\n    Username string\n    Password string\n    Salt     string\n    Email    string `orm:\"unique\"`\n}\n\ntype Post struct {\n    Id          int    `orm:\"pk;auto\"`\n    Users       *Users `orm:\"rel(fk)\"`\n    Author      string\n    Title       string    `form:\"title,text,Title:\" valid:\"MinSize(5); MaxSize(20)\"`\n    Description string    `form:textarea`\n    Date        time.Time `orm:\"auto_now_add;type(datetime)\"`\n}\n</code></pre>\n\n<p>I am trying to assign value to <code>Users</code> as it is the foreign key. I want to assign the user id who is logged in. How to assign the user id from <code>Users</code> struct to user id in <code>Post</code> struct which is foreign key.</p>\n\n<pre><code>o := orm.NewOrm()\no.Using(\"default\")\npost := models.Post{}\nusers := models.Users{}\n\nif this.Ctx.Input.Method() == \"POST\" {\n    inputs := this.Input()\n\n    post.Author = sess.(string)\n    post.Title = inputs.Get(\"title\")\n    post.Description = inputs.Get(\"description\")\n    post.Date = time.Now()\n}\n</code></pre>\n"}, {"tags": ["go", "system-calls"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1512812365, "post_id": 47725336, "comment_id": 82414846, "body": "<a href=\"https://github.com/loov/watchrun/blob/master/watch/monitor.go\" rel=\"nofollow noreferrer\">github.com/loov/watchrun/blob/master/watch/monitor.go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3518, "user_id": 3384609, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1cb30cda6294521f9c6e60277504c5c2?s=128&d=identicon&r=PG", "display_name": "Clintm", "link": "https://stackoverflow.com/users/3384609/clintm"}, "edited": false, "score": 0, "creation_date": 1512839489, "post_id": 47727244, "comment_id": 82422563, "body": "It seems like there might be quite a few problems with this approach after reading the <a href=\"https://github.com/howeyc/fsnotify#faq\" rel=\"nofollow noreferrer\">faq</a>."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1512812344, "creation_date": 1512812344, "answer_id": 47727244, "question_id": 47725336, "link": "https://stackoverflow.com/questions/47725336/calling-os-lstat-only-if-the-file-has-changed-since-the-last-time-i-called-os-ls/47727244#47727244", "title": "Calling os.Lstat only if the file has changed since the last time I called os.Lstat", "body": "<p>Whether, and how, this is possible depends heavily on your operating system.  But you might take a look at <a href=\"https://github.com/howeyc/fsnotify\" rel=\"nofollow noreferrer\">github.com/howeyc/fsnotify</a> which claims to offer this (I've never used it--I just now found it via Google).</p>\n\n<p>In general, look at any Go program that provides a 'watch' feature.  <a href=\"http://goconvey.co/\" rel=\"nofollow noreferrer\">GoConvey</a> and <a href=\"https://github.com/gopherjs/gopherjs\" rel=\"nofollow noreferrer\">GopherJS's serve mode</a> come to mind as examples, but there are others (possibly even in the standard library).</p>\n"}, {"comments": [{"owner": {"reputation": 3518, "user_id": 3384609, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1cb30cda6294521f9c6e60277504c5c2?s=128&d=identicon&r=PG", "display_name": "Clintm", "link": "https://stackoverflow.com/users/3384609/clintm"}, "edited": false, "score": 0, "creation_date": 1512922073, "post_id": 47735932, "comment_id": 82441507, "body": "Definitely the right answer\u2026 I&#39;ll amend my question with some optimizations I found while doing some research on the problem."}], "tags": [], "owner": {"reputation": 2742, "user_id": 10314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20cf40f15981c94eb92341e8cdf98e85?s=128&d=identicon&r=PG", "display_name": "James Antill", "link": "https://stackoverflow.com/users/10314/james-antill"}, "is_accepted": true, "score": 1, "last_activity_date": 1512880783, "creation_date": 1512880783, "answer_id": 47735932, "question_id": 47725336, "link": "https://stackoverflow.com/questions/47725336/calling-os-lstat-only-if-the-file-has-changed-since-the-last-time-i-called-os-ls/47735932#47735932", "title": "Calling os.Lstat only if the file has changed since the last time I called os.Lstat", "body": "<p>In general, no. However you might want to look at: <a href=\"https://github.com/mattn/go-zglob/blob/master/fastwalk/fastwalk_unix.go\" rel=\"nofollow noreferrer\">https://github.com/mattn/go-zglob/blob/master/fastwalk/fastwalk_unix.go</a></p>\n\n<p>And using that data you can skip some of the stat calls, if you only care about files.</p>\n"}], "owner": {"reputation": 3518, "user_id": 3384609, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1cb30cda6294521f9c6e60277504c5c2?s=128&d=identicon&r=PG", "display_name": "Clintm", "link": "https://stackoverflow.com/users/3384609/clintm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 47735932, "answer_count": 2, "score": 1, "last_activity_date": 1512880783, "creation_date": 1512793985, "question_id": 47725336, "link": "https://stackoverflow.com/questions/47725336/calling-os-lstat-only-if-the-file-has-changed-since-the-last-time-i-called-os-ls", "title": "Calling os.Lstat only if the file has changed since the last time I called os.Lstat", "body": "<p>I'm trying to write a program, <code>calcsize</code>, that calculates the size of all sub directories. I want to create a cache of the result and only re-walk the directory if it has changed since the last time I've run the program.</p>\n\n<p>Something like:</p>\n\n<pre><code>./calcsize\n//outputs \n/absolute/file/path1/ 1000 Bytes\n/absolute/file/path2/ 2000 Bytes\n</code></pre>\n\n<p>I'm already walking the dirs with my own walk implementation because the built in go <code>filepath.Walk</code> is already calling <code>Lstat</code> on every file. </p>\n\n<p>Is there any way to know if a directory or set of files has changed without calling <code>Lstat</code> on every file? Maybe a system call I'm not aware of?</p>\n"}, {"tags": ["php", "wordpress", "post", "go"], "comments": [{"owner": {"reputation": 763, "user_id": 5258926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d494d40863c44611bd2744e6cf5549a?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Hegde", "link": "https://stackoverflow.com/users/5258926/mahesh-hegde"}, "edited": false, "score": 0, "creation_date": 1512796000, "post_id": 47725254, "comment_id": 82411678, "body": "I suggest check  what POST data ur getting $_POST in using var_dump($_POST)  or print_r($_POST) so that u can check what went wrong"}, {"owner": {"reputation": 519, "user_id": 7533957, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/79e9e353a40ca6a2f95c498b3962f405?s=128&d=identicon&r=PG&f=1", "display_name": "Amandeep kaur", "link": "https://stackoverflow.com/users/7533957/amandeep-kaur"}, "reply_to_user": {"reputation": 763, "user_id": 5258926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d494d40863c44611bd2744e6cf5549a?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Hegde", "link": "https://stackoverflow.com/users/5258926/mahesh-hegde"}, "edited": false, "score": 0, "creation_date": 1512796314, "post_id": 47725254, "comment_id": 82411726, "body": "@MaheshHegde I have edited the question with $_POST response. I had already done this."}], "answers": [{"comments": [{"owner": {"reputation": 519, "user_id": 7533957, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/79e9e353a40ca6a2f95c498b3962f405?s=128&d=identicon&r=PG&f=1", "display_name": "Amandeep kaur", "link": "https://stackoverflow.com/users/7533957/amandeep-kaur"}, "edited": false, "score": 0, "creation_date": 1512795855, "post_id": 47725408, "comment_id": 82411656, "body": "No, it did not solve the problem. Still getting the same error."}], "tags": [], "owner": {"reputation": 61, "user_id": 9051974, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JRCn70VawTI/AAAAAAAAAAI/AAAAAAAAE0U/f82CH_3Qg0k/photo.jpg?sz=128", "display_name": "Marcelo Mizuno", "link": "https://stackoverflow.com/users/9051974/marcelo-mizuno"}, "is_accepted": false, "score": 0, "last_activity_date": 1512794859, "creation_date": 1512794859, "answer_id": 47725408, "question_id": 47725254, "link": "https://stackoverflow.com/questions/47725254/how-to-process-post-data-from-golang-into-php-using-wordpress/47725408#47725408", "title": "How to process POST data from Golang into PHP using Wordpress", "body": "<p>Change your condition statement:</p>\n\n<pre><code>if(isset($_POST[\"business_name\"]) &amp;&amp; $_POST[\"business_name\"] != '')\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>if(!empty($_POST[\"business_name\"]))\n</code></pre>\n\n<p>I hope it could do the job.</p>\n"}, {"tags": [], "owner": {"reputation": 519, "user_id": 7533957, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/79e9e353a40ca6a2f95c498b3962f405?s=128&d=identicon&r=PG&f=1", "display_name": "Amandeep kaur", "link": "https://stackoverflow.com/users/7533957/amandeep-kaur"}, "is_accepted": false, "score": 0, "last_activity_date": 1512798697, "creation_date": 1512798697, "answer_id": 47725760, "question_id": 47725254, "link": "https://stackoverflow.com/questions/47725254/how-to-process-post-data-from-golang-into-php-using-wordpress/47725760#47725760", "title": "How to process POST data from Golang into PHP using Wordpress", "body": "<p>Actually I have accidentally passed x-WWW-form-urlencoded headers in post request. Due to this it was generating output like above. When I removed this header, It worked fine.</p>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 519, "user_id": 7533957, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/79e9e353a40ca6a2f95c498b3962f405?s=128&d=identicon&r=PG&f=1", "display_name": "Amandeep kaur", "link": "https://stackoverflow.com/users/7533957/amandeep-kaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1512798697, "creation_date": 1512792865, "last_edit_date": 1512796268, "question_id": 47725254, "link": "https://stackoverflow.com/questions/47725254/how-to-process-post-data-from-golang-into-php-using-wordpress", "title": "How to process POST data from Golang into PHP using Wordpress", "body": "<p>I am trying to call a PHP post api in Golang using HTTP package with some post values. After sending these parameters from Golang I am trying to get it into PHP $_POST array in Wordpress. But I am not able to access any index of $_POST array in PHP code.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>func SaveProviderInGlobalDb(providerId int, providerEmail string, businessName string) (*http.Response, error){\n    postValues := url.Values{}\n    providerIdString := strconv.Itoa(providerId)\n    postValues.Add(\"provider_id\", providerIdString)\n    postValues.Add(\"provider_email\", providerEmail)\n    postValues.Add(\"business_name\", businessName)\n    response, err := http.PostForm(\"http://localhost/provider.php\", postValues)\n    return response, err\n}\n</code></pre>\n\n<p>PHP code:</p>\n\n<pre><code>if(isset($_POST) &amp;&amp; count($_POST) &gt; 0){\n    if(isset($_POST[\"business_name\"]) &amp;&amp; $_POST[\"business_name\"] != ''){\n        $providersCount = GetProviderCount($_POST[\"business_name\"], $_POST[\"provider_email\"]);\n        if($providersCount &gt; 0) {\n            $response[\"response\"] = \"This provider is already registered for \".$_POST[\"business_name\"];\n            $response[\"code\"] = 400;\n        }else{\n            $result = SaveProvider($_POST);\n            if($result){\n                $response[\"response\"] = \"Provider saved successfully.\";\n                $response[\"code\"] = 200;\n            }else{\n                $response[\"response\"] = \"Error while saving provider.\";\n                $response[\"code\"] = 400;\n            }\n        }\n    }else {\n        $response[\"response\"] = \"No merchant found.\";\n        $response[\"code\"] = 400;    \n    }\n    echo json_encode($response);\n}\n</code></pre>\n\n<p>In the above PHP code I am not able to check if \"business_name\" is set in $_POST or not. Due to this, It always gives me error message that \"No merchant found.\"</p>\n\n<p><strong>EDITED</strong></p>\n\n<pre><code>Array\n(\n    [------WebKitFormBoundaryGPuoAolbEsWBZnVh\nContent-Disposition:_form-data;_name] =&gt; \\\"provider_email\\\"\n\njohn_doe_1234@example.com\n------WebKitFormBoundaryGPuoAolbEsWBZnVh\nContent-Disposition: form-data; name=\\\"provider_id\\\"\n\n54\n------WebKitFormBoundaryGPuoAolbEsWBZnVh\nContent-Disposition: form-data; name=\\\"business_name\\\"\n\ntestkom1\n------WebKitFormBoundaryGPuoAolbEsWBZnVh--\n\n)\n</code></pre>\n\n<p>It is the response which I am getting after printing $_POST.</p>\n\n<p>Can anyone tell me how do I solve this problem ?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5219, "user_id": 4724167, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/2CiEe.jpg?s=128&g=1", "display_name": "Nandu Kalidindi", "link": "https://stackoverflow.com/users/4724167/nandu-kalidindi"}, "edited": false, "score": 0, "creation_date": 1512787041, "post_id": 47724736, "comment_id": 82410288, "body": "<code>other := &lt;-c</code> will store the value(42) in <code>other</code> once the channel is populated."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1512812775, "post_id": 47724736, "comment_id": 82414964, "body": "Your question is being downvoted because it &quot;does not show any research effort&quot; and &quot;it is unclear&quot;. Be sure to take the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Tour of Go</a>."}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 1, "last_activity_date": 1512787580, "creation_date": 1512787580, "answer_id": 47724824, "question_id": 47724736, "link": "https://stackoverflow.com/questions/47724736/storing-channels-data-in-go/47724824#47724824", "title": "Storing channels&#39; data in Go", "body": "<p>You can store it anywhere you like but channels are only a method for passing information within a Go program. Where the data comes from and what you do with it is entirely up to you. </p>\n\n<p>I strongly recommend going through the Go tour, and specifically <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">here</a> for channels.</p>\n"}], "owner": {"reputation": 342, "user_id": 3283051, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f28830b4cd0a70d2487b05211ab9a19f?s=128&d=identicon&r=PG&f=1", "display_name": "Prstoo", "link": "https://stackoverflow.com/users/3283051/prstoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1512819390, "accepted_answer_id": 47724824, "answer_count": 1, "score": -4, "last_activity_date": 1512812699, "creation_date": 1512786541, "last_edit_date": 1512812699, "question_id": 47724736, "link": "https://stackoverflow.com/questions/47724736/storing-channels-data-in-go", "closed_reason": "Needs details or clarity", "title": "Storing channels&#39; data in Go", "body": "<p>Can we store and retrieve data from a channel?</p>\n\n<p>For instance, can I store c, in the code below, somewhere?</p>\n\n<pre><code>package main\n\n    import (\n        \"fmt\"\n    )\n\n    func main() {\n\n        c := make(chan int)\n\n        go func(){\n\n            c &lt;- 42\n        }()\n        fmt.Println(&lt;-c)\n    }\n</code></pre>\n"}, {"tags": ["go", "grpc"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512787658, "post_id": 47724391, "comment_id": 82410383, "body": "Please clarify what you are looking for. Is it a library to take a request and forward it to a pool of targets, or a full-fledged load balancer?"}, {"owner": {"reputation": 368, "user_id": 6661243, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4527bf83b943f7afe5de12ba672b3543?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Podkolzin", "link": "https://stackoverflow.com/users/6661243/maxim-podkolzin"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512793207, "post_id": 47724391, "comment_id": 82411236, "body": "I updated my original post"}, {"owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "edited": false, "score": 1, "creation_date": 1512841413, "post_id": 47724391, "comment_id": 82423287, "body": "I haven&#39;t try new balancer API on my own (because we have our own balancer implementation)... but I think that unit-tests may inspire you :  <a href=\"https://github.com/grpc/grpc-go/blob/master/balancer/roundrobin/roundrobin_test.go#L125\" rel=\"nofollow noreferrer\">github.com/grpc/grpc-go/blob/master/balancer/roundrobin/&hellip;</a>"}, {"owner": {"reputation": 368, "user_id": 6661243, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4527bf83b943f7afe5de12ba672b3543?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Podkolzin", "link": "https://stackoverflow.com/users/6661243/maxim-podkolzin"}, "edited": false, "score": 0, "creation_date": 1514927594, "post_id": 47724391, "comment_id": 83109377, "body": "Actually reading through test was surpsisingly simple, and really helped a lot"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6328154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wxOUc7bziHo/AAAAAAAAAAI/AAAAAAAAACI/ENB5WGwg-7U/photo.jpg?sz=128", "display_name": "user6328154", "link": "https://stackoverflow.com/users/6328154/user6328154"}, "is_accepted": false, "score": 2, "last_activity_date": 1513779715, "creation_date": 1513779715, "answer_id": 47908108, "question_id": 47724391, "link": "https://stackoverflow.com/questions/47724391/grpc-load-balancer-name-resolver-example/47908108#47908108", "title": "gRPC load balancer/name resolver example?", "body": "<p><a href=\"https://github.com/wothing/wonaming\" rel=\"nofollow noreferrer\">https://github.com/wothing/wonaming</a></p>\n\n<p>Wonaming is a simple grpc-go balancer &amp; naming implementation, supporting etcd and Consul as the service register/discovery backend. Wonaming also supports self-register to etcd/consul.</p>\n"}], "owner": {"reputation": 368, "user_id": 6661243, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4527bf83b943f7afe5de12ba672b3543?s=128&d=identicon&r=PG&f=1", "display_name": "Maxim Podkolzin", "link": "https://stackoverflow.com/users/6661243/maxim-podkolzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3220, "favorite_count": 0, "closed_date": 1539853876, "answer_count": 1, "score": 6, "last_activity_date": 1539851729, "creation_date": 1512782619, "last_edit_date": 1512793588, "question_id": 47724391, "link": "https://stackoverflow.com/questions/47724391/grpc-load-balancer-name-resolver-example", "closed_reason": "Not suitable for this site", "title": "gRPC load balancer/name resolver example?", "body": "<p>Does anybody have working gRPC load balancer/name resolver example in go? Nothing fancy just round robin over list of predefined addresses.</p>\n\n<p>UPDATE:\nWhat i mean is that gRPC has dial option WithBalancer, which is used like</p>\n\n<pre><code>    var opts []grpc.DialOption\n    b := grpc.RoundRobin(r) //r - name resolver\n    opts = append(opts, grpc.WithBalancer(b))\n    conn, err := grpc.Dial(\"\", opts...)\n</code></pre>\n\n<p>Is there any example of how to implement name resolver to work with this code?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["http", "go", "video-streaming"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1512806333, "post_id": 47724059, "comment_id": 82413574, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36540610/how-to-serve-http-partial-content-with-go/36543480#36543480\">How to serve http partial content with Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 1306251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a33e61874bf25461b46069cddbc359?s=128&d=identicon&r=PG", "display_name": "Sync", "link": "https://stackoverflow.com/users/1306251/sync"}, "edited": false, "score": 0, "creation_date": 1512818551, "post_id": 47724672, "comment_id": 82416522, "body": "Thanks Marc you&#39;re right it was a problem with the video! Using ServeContent is extremely easy, but I was wondering if there is anything that would allow me to understand what section of the file is currently being read so that I can pull out some stats about the playback from the server side."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1512785698, "creation_date": 1512785698, "answer_id": 47724672, "question_id": 47724059, "link": "https://stackoverflow.com/questions/47724059/how-to-stream-a-video-file-for-html5-video-tag/47724672#47724672", "title": "How to stream a video file for html5 video tag", "body": "<p>Your go code looks fine, leading me to think this is probably a problem with your video.\navi is usually not supported for html5, see <a href=\"http://diveintohtml5.info/video.html\" rel=\"nofollow noreferrer\">here</a> for more details on containers/codecs for html5.</p>\n\n<p>I would try with a known working video. eg: <a href=\"https://www.quirksmode.org/html5/videos/big_buck_bunny.mp4\" rel=\"nofollow noreferrer\">https://www.quirksmode.org/html5/videos/big_buck_bunny.mp4</a></p>\n\n<p>Maybe even simplify your code and just use <code>http.ServeFile</code>, although the important part of video serving (range requests) is in <code>ServeContent</code> anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 0, "last_activity_date": 1512814812, "creation_date": 1512814812, "answer_id": 47727547, "question_id": 47724059, "link": "https://stackoverflow.com/questions/47724059/how-to-stream-a-video-file-for-html5-video-tag/47727547#47727547", "title": "How to stream a video file for html5 video tag", "body": "<p>I just ran your code and worked in the latest version of Chrome. My video was a MP4 file with H264 video and AAC audio (Both codecs are pretty commonplace and widely supported).</p>\n\n<p>You should convert your video to a supported format for browsers. See <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats\" rel=\"nofollow noreferrer\">this</a> MDN docs to see supported formats and pay attention to \"Browser compatibility\" part of it.</p>\n"}], "owner": {"reputation": 125, "user_id": 1306251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a33e61874bf25461b46069cddbc359?s=128&d=identicon&r=PG", "display_name": "Sync", "link": "https://stackoverflow.com/users/1306251/sync"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2140, "favorite_count": 1, "accepted_answer_id": 47724672, "answer_count": 2, "score": 1, "last_activity_date": 1512814812, "creation_date": 1512779487, "question_id": 47724059, "link": "https://stackoverflow.com/questions/47724059/how-to-stream-a-video-file-for-html5-video-tag", "title": "How to stream a video file for html5 video tag", "body": "<p>I was wondering what's the best way to stream a video file (mpg4/avi - or any other format) in Go. Possibly, I'd like to be able to play it using a simple  tag.</p>\n\n<p>I've tried playing the famous Big Buck Bunny file with this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n)\n\nfunc serveHTTP(w http.ResponseWriter, r *http.Request) {\n    video, err := os.Open(\"./bunny.avi\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    http.ServeContent(w, r, \"bunny.avi\", time.Now(), video)\n    defer video.Close()\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", serveHTTP)\n    err := http.ListenAndServe(\":8080\", nil)\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n}\n</code></pre>\n\n<p>But when loading the html page in my browser nothing plays and only one http request is actually triggered and only one response with 206 Partial content is sent to the page.\n<a href=\"https://i.stack.imgur.com/IHjOS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IHjOS.png\" alt=\"Response\"></a></p>\n\n<p>The html page contains the following code in the body:</p>\n\n<pre><code>&lt;video width=\"320\" height=\"240\" controls autoplay&gt;\n    &lt;source src=\"http://localhost:8080\"&gt;\n    Your browser does not support the video tag.\n&lt;/video&gt;\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["linux", "go", "child-process"], "answers": [{"comments": [{"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1512776812, "post_id": 47723738, "comment_id": 82408205, "body": "Oh! That&#39;s too simple! I was wondering why there was so much in <code>syscall</code> about signals but seemingly no way to listen for them. I will learn to navigate the library documentation one of these days."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1513645197, "post_id": 47723738, "comment_id": 82723217, "body": "I shouldn&#39;t have accepted your answer so soon, though waiting for the week and a half for me to discover this doesn&#39;t seem reasonable either. The problem is that the Notify mechanism tells you all about which signal you got, but none of the other details. So when you get the SIGCHLD telling you that you have a new child, you aren&#39;t told what it&#39;s PID is. :-("}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 3, "last_activity_date": 1512776755, "creation_date": 1512776755, "answer_id": 47723738, "question_id": 47723721, "link": "https://stackoverflow.com/questions/47723721/how-do-i-learn-about-unknown-children-exiting-in-go-on-unix-liunx/47723738#47723738", "title": "How do I learn about unknown children exiting in Go on Unix/Liunx?", "body": "<p>You can register signal handlers using <a href=\"https://golang.org/pkg/os/signal/#example_Notify\" rel=\"nofollow noreferrer\">signal.Notify</a></p>\n"}], "owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 47723738, "answer_count": 1, "score": 1, "last_activity_date": 1512777633, "creation_date": 1512776665, "last_edit_date": 1512777633, "question_id": 47723721, "link": "https://stackoverflow.com/questions/47723721/how-do-i-learn-about-unknown-children-exiting-in-go-on-unix-liunx", "title": "How do I learn about unknown children exiting in Go on Unix/Liunx?", "body": "<p>It doesn't look like Go has a way to register a signal handler, so I can't catch <code>SIGCHLD</code>. So, how do I learn about a process exiting that I may not known about because my process has its CHILD_SUBREAPER flag set or is PID 1 in a PID namespace.</p>\n"}, {"tags": ["templates", "go", "go-templates"], "comments": [{"owner": {"reputation": 95, "user_id": 1301019, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d7123605e98385e64c994489c7f2480?s=128&d=identicon&r=PG", "display_name": "Miguel Pragier", "link": "https://stackoverflow.com/users/1301019/miguel-pragier"}, "edited": false, "score": 0, "creation_date": 1525536257, "post_id": 47723198, "comment_id": 87399662, "body": "Maybe this discussion bring a little bit more of light: <a href=\"https://stackoverflow.com/questions/42507958/golang-template-engine-pipelines\" title=\"golang template engine pipelines\">stackoverflow.com/questions/42507958/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 2, "last_activity_date": 1525524843, "last_edit_date": 1525524843, "creation_date": 1512773488, "answer_id": 47723291, "question_id": 47723198, "link": "https://stackoverflow.com/questions/47723198/how-to-access-struct-field-value-in-a-map-of-that-struct-with-a-specific-key/47723291#47723291", "title": "How to access struct field value in a map of that struct with a specific key", "body": "<p><code>Errs.Val</code> isn't valid, you need to separate the lookup and field access:</p>\n\n<pre><code>{{ $myval := index .Errs \"key\" }} {{ $myval.Val }}\n</code></pre>\n\n<p>Or if you only need to use the value once:</p>\n\n<pre><code>{{ (index .Errs \"key\").Val }}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1512773802, "last_edit_date": 1512773802, "creation_date": 1512773498, "answer_id": 47723292, "question_id": 47723198, "link": "https://stackoverflow.com/questions/47723198/how-to-access-struct-field-value-in-a-map-of-that-struct-with-a-specific-key/47723292#47723292", "title": "How to access struct field value in a map of that struct with a specific key", "body": "<p>Use <code>{{.Errs.Name.Val}}</code>.  There's no need to use index.</p>\n\n<p><a href=\"https://play.golang.org/p/0B2C1tMqsO\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 2178, "user_id": 3858203, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/Os9fr.jpg?s=128&g=1", "display_name": "samadadi", "link": "https://stackoverflow.com/users/3858203/samadadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3799, "favorite_count": 0, "accepted_answer_id": 47723292, "answer_count": 2, "score": 1, "last_activity_date": 1569176428, "creation_date": 1512772847, "last_edit_date": 1569176428, "question_id": 47723198, "link": "https://stackoverflow.com/questions/47723198/how-to-access-struct-field-value-in-a-map-of-that-struct-with-a-specific-key", "title": "How to access struct field value in a map of that struct with a specific key", "body": "<p>I have \"FormError\" struct. I pass this struct to my template. So how to access InputError struct field value with specific key in the template?</p>\n\n<pre><code>type InputError struct {\n    Val string\n    Has bool\n}\n\ntype FormError struct {\n    Errs map[string]InputError\n}\n</code></pre>\n\n<p>This doesn't work.</p>\n\n<pre><code>&lt;input name=\"Name\" type=\"text\" value=\"{{index .Errs.Val `Name`}}\"&gt;\n</code></pre>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 1926476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XfR37.png?s=128&g=1", "display_name": "Vaisakh Rajagopal", "link": "https://stackoverflow.com/users/1926476/vaisakh-rajagopal"}, "edited": false, "score": 0, "creation_date": 1562317762, "post_id": 47723246, "comment_id": 100345178, "body": "&quot;cannot unmarshal array into Go value of type main. Structure&quot; Actually the problem is simple, we are trying to parse an array of data with a struct type(object).   Even if we try to unmarshal response with a variable of type array of string(&quot;[]string&quot;) unmarshal will panic. But an array of any struct&quot;[]MyStruct&quot; will parse but give zero value if key doesn&#39;t match."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 15, "last_activity_date": 1512773365, "last_edit_date": 1512773365, "creation_date": 1512773140, "answer_id": 47723246, "question_id": 47723193, "link": "https://stackoverflow.com/questions/47723193/panic-json-cannot-unmarshal-array-into-go-value-of-type-main-structure/47723246#47723246", "title": "panic: json: cannot unmarshal array into Go value of type main.Structure", "body": "<p>The application is unmarshalling a JSON array to a struct. Unmarshal to a slice:</p>\n\n<pre><code> var decoded []interface{}\n err = json.Unmarshal(body, &amp;decoded)\n</code></pre>\n\n<p>Consider unmarshalling to a []map[string]string or a []Tick where Tick is</p>\n\n<pre><code> type Tick struct {\n     ID string\n     Name string\n     Symbol string\n     Rank string\n     ... and so on\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1297, "user_id": 6074182, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/eea96ceabd30de865464b40ddbd2e64d?s=128&d=identicon&r=PG&f=1", "display_name": "Aemyl", "link": "https://stackoverflow.com/users/6074182/aemyl"}, "edited": false, "score": 0, "creation_date": 1522156677, "post_id": 49513400, "comment_id": 86032600, "body": "It would be nice if you explain your code a little bit"}, {"owner": {"reputation": 271, "user_id": 4059724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/46t5i.jpg?s=128&g=1", "display_name": "hextet", "link": "https://stackoverflow.com/users/4059724/hextet"}, "edited": false, "score": 0, "creation_date": 1523588264, "post_id": 49513400, "comment_id": 86632096, "body": "This example worked, not the other one. Could you explain why this works?"}], "tags": [], "owner": {"reputation": 81, "user_id": 9558361, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7d7062c810c998521a5d070fdf5817a1?s=128&d=identicon&r=PG", "display_name": "olekus", "link": "https://stackoverflow.com/users/9558361/olekus"}, "is_accepted": false, "score": 8, "last_activity_date": 1522155170, "creation_date": 1522155170, "answer_id": 49513400, "question_id": 47723193, "link": "https://stackoverflow.com/questions/47723193/panic-json-cannot-unmarshal-array-into-go-value-of-type-main-structure/49513400#49513400", "title": "panic: json: cannot unmarshal array into Go value of type main.Structure", "body": "<p>i had same problem. use this code:</p>\n\n<pre><code>type coinsData struct {\n    Symbol string `json:\"symbol\"`\n    Price  string `json:\"price_usd\"`\n}\n\nfunc main() {\nresp, err := http.Get(\"https://api.coinmarketcap.com/v1/ticker/?limit=0\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer resp.Body.Close()\n\n    body, err := ioutil.ReadAll(resp.Body)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    var c []coinsData\n    err = json.Unmarshal(body, &amp;c)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Printf(\"%v\\n\", c)\n    }\n</code></pre>\n\n<p>You'll get the result:\n[{BTC 7986.77} {ETH 455.857} {XRP 0.580848}...]</p>\n"}], "owner": {"reputation": 467, "user_id": 8761914, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/24e93f0d9539d0b42c1458a329cb9629?s=128&d=identicon&r=PG&f=1", "display_name": "Peter S", "link": "https://stackoverflow.com/users/8761914/peter-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31243, "favorite_count": 1, "accepted_answer_id": 47723246, "answer_count": 2, "score": 9, "last_activity_date": 1525125402, "creation_date": 1512772816, "last_edit_date": 1592644375, "question_id": 47723193, "link": "https://stackoverflow.com/questions/47723193/panic-json-cannot-unmarshal-array-into-go-value-of-type-main-structure", "title": "panic: json: cannot unmarshal array into Go value of type main.Structure", "body": "<h3>What are you trying to accomplish?</h3>\n<p>I am trying to parse data from a json api.</p>\n<h3>Paste the part of the code that shows the problem.</h3>\n<pre><code>package main\n\nimport (\n        &quot;encoding/json&quot;\n        &quot;fmt&quot;\n        &quot;io/ioutil&quot;\n        &quot;net/http&quot;\n)\n\ntype Structure struct {\n        stuff []interface{}\n}\n\nfunc main() {\n        url := &quot;https://api.coinmarketcap.com/v1/ticker/?start=0&amp;limit=100&quot;\n        response, err := http.Get(url)\n        if err != nil {\n                panic(err)\n        }   \n        body, err := ioutil.ReadAll(response.Body)\n        if err != nil {\n                panic(err)\n        }   \n        decoded := &amp;Structure{}\n        fmt.Println(url)\n        err = json.Unmarshal(body, decoded)\n        if err != nil {\n                panic(err)\n        }   \n        fmt.Println(decoded)\n}\n</code></pre>\n<h3>What do you expect the result to be?</h3>\n<p>I expected for the code to return a list of interface objects.</p>\n<h3>What is the actual result you get?</h3>\n<p>I got an error: <code>panic: json: cannot unmarshal array into Go value of type main.Structure</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1512769152, "post_id": 47722542, "comment_id": 82405644, "body": "It does take a slice of the full array (<a href=\"https://tour.golang.org/moretypes/10\" rel=\"nofollow noreferrer\">as covered in the Go tour</a>), and you&#39;d pass it instead of the full array to a function that accepts a slice, not an array. They aren&#39;t interchangeable."}, {"owner": {"reputation": 465, "user_id": 1936173, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/8uQ1j.png?s=128&g=1", "display_name": "Illia Danko", "link": "https://stackoverflow.com/users/1936173/illia-danko"}, "edited": false, "score": 1, "creation_date": 1512776579, "post_id": 47722542, "comment_id": 82408145, "body": "One of the reasons of [:] is it allows you to convert from array to slice by creating a reference (slice) to the array&#39;s data without extra copy. If you&#39;ll just pass to function(method) an array you&#39;ll create a new copy of data."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 5, "last_activity_date": 1512772854, "last_edit_date": 1512772854, "creation_date": 1512769793, "answer_id": 47722663, "question_id": 47722542, "link": "https://stackoverflow.com/questions/47722542/what-does-the-symbol-mean-in-go/47722663#47722663", "title": "what does the symbol [:] mean in Go?", "body": "<p>In go, Arrays and Slices are slightly different and cannot be used interchangeably; however, you can make a slice from an array easily using the <code>[:]</code> operator.</p>\n\n<p>This article explains in detail - <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: Usage and Internals</a>.</p>\n\n<p>See also the <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">Slice Expressions</a> section of The Go Programming Language Specification.</p>\n\n<p>In a nutshell, the <code>[:]</code> operator allows you to create a slice from an array, optionally using start and end bounds.  For example:</p>\n\n<pre><code>a := [3]int{1, 2, 3, 4} // \"a\" has type [4]int (array of 4 ints)\nx := a[:]   // \"x\" has type []int (slice of ints) and length 4\ny := a[:2]  // \"y\" has type []int, length 2, values {1, 2}\nz := a[2:]  // \"z\" has type []int, length 2, values {3, 4}\nm := a[1:3] // \"m\" has type []int, length 2, values {2, 3}\n</code></pre>\n\n<p>Presumably the reason for this distinction is for an extra measure of type safety. That is, length is a formal part of an array type (e.g. <code>[4]int</code> is an array of four ints and a different size is a different type) whereas slices can have any length, including zero. So if you want the safety of a known-length sequence then use an Array, otherwise use a Slice for convenience.</p>\n"}], "owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 47722663, "answer_count": 1, "score": 2, "last_activity_date": 1512772854, "creation_date": 1512769092, "question_id": 47722542, "link": "https://stackoverflow.com/questions/47722542/what-does-the-symbol-mean-in-go", "title": "what does the symbol [:] mean in Go?", "body": "<p>I found this in some code:</p>\n\n<pre><code>h := s.Hash(tx)\nsig, err := crypto.Sign(h[:], prv)\n</code></pre>\n\n<p>What does <code>[:]</code> mean ?\nIf this is the full slice of the array, why not to pass the array itself? What kind of coding style is this, I wonder...</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1512768972, "post_id": 47722502, "comment_id": 82405579, "body": "It&#39;s an interface. Please <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">take the Go tour</a>."}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 1, "last_activity_date": 1512769099, "creation_date": 1512769099, "answer_id": 47722544, "question_id": 47722502, "link": "https://stackoverflow.com/questions/47722502/function-argument-type-differs-without-any-compilation-or-runtime-error/47722544#47722544", "title": "function argument type differs without any compilation or runtime error", "body": "<p><code>square</code> implements the <code>geometry</code> interface because it has the method <code>area()</code>. This is exactly the point of interfaces. See: <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">https://tour.golang.org/methods/9</a></p>\n"}], "owner": {"reputation": 49, "user_id": 7278209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bce0d734d8ec0d8b361a4457e9fcfa8?s=128&d=identicon&r=PG&f=1", "display_name": "psin", "link": "https://stackoverflow.com/users/7278209/psin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 47722544, "answer_count": 1, "score": -1, "last_activity_date": 1512769099, "creation_date": 1512768901, "last_edit_date": 1512769026, "question_id": 47722502, "link": "https://stackoverflow.com/questions/47722502/function-argument-type-differs-without-any-compilation-or-runtime-error", "title": "function argument type differs without any compilation or runtime error", "body": "<p>How come the following code is running? \"measure\" expects an argument of type geometry, but this code passes argument of \"square\" type.</p>\n\n<pre><code>package main\nimport \"fmt\"\n\ntype geometry interface {\n    area() int\n}\n\ntype square struct {\n    radius int\n}\nfunc (s square) area() int {\n    return s.radius*s.radius\n}\n\nfunc measure(g geometry) {\n    fmt.Println(g)\n    fmt.Println(g.area())\n}\n\nfunc main() {\n    measure(square{radius: 3})\n}\n</code></pre>\n\n<p>The outpust is:</p>\n\n<pre><code>{3}\n9\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "gitlab-ci"], "comments": [{"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1512766478, "post_id": 47721570, "comment_id": 82404554, "body": "Try to make manuallu <code>git clone -v ...</code> to check what&#39;s going on inside. If doesn&#39;t help, try to go deeper: <code>ssh -v git@gitlab.com</code>"}, {"owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "reply_to_user": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1512767983, "post_id": 47721570, "comment_id": 82405189, "body": "Thanks, I&#39;ll start by running those two and get back."}], "answers": [{"tags": [], "owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "is_accepted": true, "score": 0, "last_activity_date": 1512769496, "creation_date": 1512769496, "answer_id": 47722622, "question_id": 47721570, "link": "https://stackoverflow.com/questions/47721570/go-get-git-settings-ignored/47722622#47722622", "title": "go get: Git settings ignored", "body": "<p>Found the answer, and it's silly, and of course, my fault. I hadn't added the deploy key to the projects, of course rejecting the clones.</p>\n\n<p>To fix the problem, in GitLab, go to the repository and then \"Settings\" > \"Repository\" and fold out \"Deploy keys\". There, make sure that the key you're trying to clone with is available and enabled.</p>\n"}], "owner": {"reputation": 1865, "user_id": 2670926, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/525181988/picture?type=large", "display_name": "Helge Talvik S&#246;derstr&#246;m", "link": "https://stackoverflow.com/users/2670926/helge-talvik-s%c3%b6derstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "accepted_answer_id": 47722622, "answer_count": 1, "score": 1, "last_activity_date": 1512769496, "creation_date": 1512764274, "last_edit_date": 1512765625, "question_id": 47721570, "link": "https://stackoverflow.com/questions/47721570/go-get-git-settings-ignored", "title": "go get: Git settings ignored", "body": "<p>I'm using Golang and GitLab CI, and I've got a GitLab CI configuration which works perfectly for 12 projects, but not for a 13th.</p>\n\n<p>The problem I have is that I'm trying to <code>go get</code> some private repositories, which <code>go get</code> tries to run over HTTPS, which is turned off.</p>\n\n<p>The solution, that works in the other repos, is this:</p>\n\n<pre><code>git config --global url.\"git@gitlab.my.site:\".insteadOf \"https://gitlab.my.site/\"\n</code></pre>\n\n<p>However, in the runner for this one project, on the same GitLab, with the exact same config (except for the service name), this happens:</p>\n\n<pre><code>[...]\n$ git config --global url.\"git@gitlab.my.site:\".insteadOf \"https://gitlab.my.site/\"\n$ cd ${APP_PATH}\n$ go get\n# cd .; git clone https://gitlab.my.site/group/project.git /go/src/gitlab.my.site/group/project\nCloning into '/go/src/gitlab.my.site/group/projects'...\nGitLab: The project you were looking for could not be found.\nfatal: Could not read from remote repository.\n</code></pre>\n\n<p>Why is it suddenly trying to clone over HTTPS? It happens in this one project only, consistently, but works in all the other ones. The only reason I can think about is that this one project uses a lot of different repos, rather than just one or two, but I have a hard time seing that this would be the actual issue.</p>\n\n<p>How can I troubleshoot this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["node.js", "go", "encryption", "cryptography", "aes"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1512761277, "post_id": 47720876, "comment_id": 82402440, "body": "What does &quot;I got require IV but I have not use the same in Node JS&quot; mean?"}, {"owner": {"reputation": 241, "user_id": 8869761, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0c368616d9cdd6f637a9a12c0745141?s=128&d=identicon&r=PG&f=1", "display_name": "Chacha", "link": "https://stackoverflow.com/users/8869761/chacha"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1512761586, "post_id": 47720876, "comment_id": 82402590, "body": "Updated the question. Thanks for noticing."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1512761712, "post_id": 47720876, "comment_id": 82402642, "body": "For CTR mode an initial counter is required, many times supplied as an IV. It could be that Node JS internally creates a counter and it is returned in some manor or added to the encrypted data in the same manor an IV is many time add as a prefix to the encrypted data. Tjere are other questions such as do the encryption functions expect a hexadecimal string as the key?"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1512761956, "post_id": 47720876, "comment_id": 82402752, "body": "What is the value of <code>JSON.stringify(typedRequest)</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1512761969, "post_id": 47720876, "comment_id": 82402756, "body": "The documentation here explains the process: <a href=\"https://nodejs.org/api/crypto.html#crypto_crypto_createcipher_algorithm_password_options\" rel=\"nofollow noreferrer\">nodejs.org/api/&hellip;</a>. You shouldn&#39;t be using a ctr mode here at all, and probably should use <code>createCipheriv</code>"}, {"owner": {"reputation": 241, "user_id": 8869761, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0c368616d9cdd6f637a9a12c0745141?s=128&d=identicon&r=PG&f=1", "display_name": "Chacha", "link": "https://stackoverflow.com/users/8869761/chacha"}, "edited": false, "score": 0, "creation_date": 1512762067, "post_id": 47720876, "comment_id": 82402802, "body": "What is iv basically? Is there a way to generate a password and iv for a algorithm?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513007470, "post_id": 47720876, "comment_id": 82474073, "body": "You&#39;re not putting the IV at the start of the ciphertext, you&#39;re inserting near the end (it ends up at the end in this case, you can see directly in Go example you pasted in). You&#39;re then decoding the IV as hex data, though you didn&#39;t use it as such, so even if you take the IV from the end you have the wrong data."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1513009925, "post_id": 47720876, "comment_id": 82475623, "body": "You&#39;re also decoding your key as hex data, when that wasn&#39;t encoded in the first place either."}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 8869761, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0c368616d9cdd6f637a9a12c0745141?s=128&d=identicon&r=PG&f=1", "display_name": "Chacha", "link": "https://stackoverflow.com/users/8869761/chacha"}, "edited": false, "score": 0, "creation_date": 1512767058, "post_id": 47721157, "comment_id": 82404808, "body": "Can I keep the algorithm same as aes-256-ctr? And what would be the length of iv?"}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "reply_to_user": {"reputation": 241, "user_id": 8869761, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0c368616d9cdd6f637a9a12c0745141?s=128&d=identicon&r=PG&f=1", "display_name": "Chacha", "link": "https://stackoverflow.com/users/8869761/chacha"}, "edited": false, "score": 0, "creation_date": 1512767625, "post_id": 47721157, "comment_id": 82405029, "body": "@Chacha Yes, and IV length is always the same as the block size, so 128 bits for AES."}, {"owner": {"reputation": 241, "user_id": 8869761, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0c368616d9cdd6f637a9a12c0745141?s=128&d=identicon&r=PG&f=1", "display_name": "Chacha", "link": "https://stackoverflow.com/users/8869761/chacha"}, "edited": false, "score": 0, "creation_date": 1512768713, "post_id": 47721157, "comment_id": 82405470, "body": "I have updated the question. If possible, can you please help."}], "tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": true, "score": 4, "last_activity_date": 1512762199, "creation_date": 1512762199, "answer_id": 47721157, "question_id": 47720876, "link": "https://stackoverflow.com/questions/47720876/encrypting-in-node-js-using-aes-256-ctr-and-decrypting-in-golang/47721157#47721157", "title": "Encrypting in Node JS using AES 256 CTR and Decrypting in Golang", "body": "<p>It is your NodeJS code that is incorrect.  CTR mode requires an IV, calling <code>crypto.createCipher</code> is undefined behavior for CTR mode.</p>\n\n<p>As per the NodeJS docs for <a href=\"https://nodejs.org/api/crypto.html\" rel=\"nofollow noreferrer\">Crypto</a>, you should be using <code>crypto.createCipheriv</code>.  Your Golang code attempts to retrieve this IV from the start of the plaintext, so you'll need to place it there in your NodeJS code.</p>\n\n<p>The IV should be unique for each encryption operation, using a CSPRNG is the recommended way to do this.</p>\n"}], "owner": {"reputation": 241, "user_id": 8869761, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0c368616d9cdd6f637a9a12c0745141?s=128&d=identicon&r=PG&f=1", "display_name": "Chacha", "link": "https://stackoverflow.com/users/8869761/chacha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4008, "favorite_count": 0, "accepted_answer_id": 47721157, "answer_count": 1, "score": 0, "last_activity_date": 1512768679, "creation_date": 1512760907, "last_edit_date": 1512768679, "question_id": 47720876, "link": "https://stackoverflow.com/questions/47720876/encrypting-in-node-js-using-aes-256-ctr-and-decrypting-in-golang", "title": "Encrypting in Node JS using AES 256 CTR and Decrypting in Golang", "body": "<p>I have encrypted some JSON Text using following Node JS code:-</p>\n\n<pre><code>var algorithm = 'aes-256-ctr';\nvar crypto = require('crypto');\n\nvar password = \"6A80FD8D38D579D1090F6CDB62C729311781E4BA31CD7D804BD7BF5AEC3BFC2D\"\n\nvar typedRequest = {\"abc\":\"cde\"}\n\nvar cipher = crypto.createCipher(algorithm, password);\nvar hashRequest = cipher.update(JSON.stringify(typedRequest),\n    'utf8', 'hex');\nhashRequest += cipher.final('hex');\n</code></pre>\n\n<p>And now, I wanted to decrypt this encryptedText in Golang. But I am not able to found any way to do this, since in almost all decryption logic examples of AES 256 CTR in Golang, I found it always requires IV while decrypting but I have not use the same in Node JS. I have written something in Golang but its not decrypting correctly and giving error for now:-</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"encoding/hex\"\n    \"fmt\"\n\n)\n\nfunc main() {\n\n    encKey := \"6A80FD8D38D579D1090F6CDB62C729311781E4BA31CD7D804BD7BF5AEC3BFC2D\"\n    cipherText := \"746c17cd10f8f86646f843ac2a\"\n\n    encKeyDecoded, err := hex.DecodeString(encKey)\n    if err != nil {\n        panic(err)\n    }\n    cipherTextDecoded, err := hex.DecodeString(cipherText)\n    if err != nil {\n        panic(err)\n    }\n\n    iv := cipherTextDecoded[:aes.BlockSize]\n\n    block, err := aes.NewCipher([]byte(encKeyDecoded))\n    if err != nil {\n        panic(err)\n    }\n\n    cipherTextBytes := []byte(cipherTextDecoded)\n\n    plaintext := make([]byte, len(cipherTextBytes) - aes.BlockSize)\n    stream := cipher.NewCTR(block, iv)\n    stream.XORKeyStream(plaintext, cipherTextBytes[aes.BlockSize:])\n\n    fmt.Println(string(plaintext))\n}\n</code></pre>\n\n<p>Any help in getting the correct Golang code is highly appreciated. Thanks</p>\n\n<p>=====================================</p>\n\n<p>Now, I have updated to following after taking suggestion from Answer:-</p>\n\n<p>This is my node js code:-</p>\n\n<pre><code>var crypto = require('crypto'),\n  algorithm = 'aes-256-ctr',\n  password = '6A80FD8D38D579D1090F6CDB62CA34CA',\n  // do not use a global iv for production, \n  // generate a new one for each encryption\n  iv = '79b67e539e7fcadf'\n\nvar typedRequest = {\"abc\":\"cde\"}\n\nvar cipher = crypto.createCipheriv(algorithm, password, iv);\nvar hashRequest = cipher.update(JSON.stringify(typedRequest),\n    'utf8', 'hex');\nhashRequest += iv.toString('hex') + cipher.final('hex');\n</code></pre>\n\n<p>This is my Go code:-</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"encoding/hex\"\n    \"fmt\"\n\n)\n\nfunc main() {\n\n    encKey := \"6A80FD8D38D579D1090F6CDB62CA34CA\"\n    cipherText := \"af7d1eb42107549a7e3adbce1a79b67e539e7fcadf\" // Got from above\n\n    encKeyDecoded, err := hex.DecodeString(encKey)\n    if err != nil {\n        panic(err)\n    }\n    cipherTextDecoded, err := hex.DecodeString(cipherText)\n    if err != nil {\n        panic(err)\n    }\n\n    block, err := aes.NewCipher([]byte(encKeyDecoded))\n    if err != nil {\n        panic(err)\n    }\n\n    iv := cipherTextDecoded[:aes.BlockSize]\n    cipherTextBytes := []byte(cipherTextDecoded)\n\n    plaintext := make([]byte, len(cipherTextBytes) - aes.BlockSize)\n    stream := cipher.NewCTR(block, iv)\n    stream.XORKeyStream(plaintext, cipherTextBytes[aes.BlockSize:])\n\n    fmt.Println(string(plaintext))\n}\n</code></pre>\n\n<p>Now, I am getting something completely different in decrypted form.</p>\n"}, {"tags": ["linux", "unix", "gcc", "go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1512764147, "post_id": 47720668, "comment_id": 82403628, "body": "I this through cgo? Can you provide more details including your cgo code above the <code>import &quot;C&quot;</code> line."}], "answers": [{"tags": [], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "is_accepted": true, "score": 0, "last_activity_date": 1512931981, "creation_date": 1512931981, "answer_id": 47742307, "question_id": 47720668, "link": "https://stackoverflow.com/questions/47720668/ldconfig-register-so-lib/47742307#47742307", "title": "ldconfig register .so lib", "body": "<p>Answer is here: <a href=\"https://codeyarns.com/2017/11/02/how-shared-library-locations-are-found-at-runtime/\" rel=\"nofollow noreferrer\">https://codeyarns.com/2017/11/02/how-shared-library-locations-are-found-at-runtime/</a></p>\n\n<p>I added my <code>*.so</code> libs into <code>/lib/</code> directory. </p>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 47742307, "answer_count": 1, "score": 0, "last_activity_date": 1512931981, "creation_date": 1512759930, "question_id": 47720668, "link": "https://stackoverflow.com/questions/47720668/ldconfig-register-so-lib", "title": "ldconfig register .so lib", "body": "<p>I am running <code>go build</code> and encounter following issue:</p>\n\n<pre><code>/tmp/___go_build_myproject_: error while loading shared libraries: libSomeLib_x64.so: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>I have <code>libSomeLib_x64.so</code> compiled in another directory.\nFrom <a href=\"https://unix.stackexchange.com/q/44990/152046\">this question</a> I know that I should use ldconfig to link lib.</p>\n\n<p>I tried both add lib path to <code>/etc/ld.so.conf</code> and to <code>export LD_LIBRARY_PATH</code> but nothing helped. How can I get rid of the error? </p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "aws-sdk-go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1512756297, "creation_date": 1512756297, "answer_id": 47719921, "question_id": 47719788, "link": "https://stackoverflow.com/questions/47719788/multiple-file-upload-using-s3/47719921#47719921", "title": "Multiple file upload using s3", "body": "<p>Use the <a href=\"https://godoc.org/mime/multipart#FileHeader.Open\" rel=\"nofollow noreferrer\">FileHeader.Open</a> method to get an <code>io.ReadSeeker</code>.</p>\n\n<pre><code>    f, err := f.Open()\n    if err != nil {\n       // handle error\n    }\n\n    _, err = svc.PutObjectWithContext(ctx, &amp;s3.PutObjectInput{\n            Bucket: aws.String(\"bucket\"),\n            Key:    aws.String(\"key\"),\n            Body:   f,\n        })\n</code></pre>\n\n<p>Open returns a <a href=\"https://godoc.org/mime/multipart#File\" rel=\"nofollow noreferrer\">File</a>. This type satisfies the <a href=\"https://godoc.org/io#ReadSeeker\" rel=\"nofollow noreferrer\">io.ReadSeeker</a> interface.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 6082795, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--MhlhZaMhl4/AAAAAAAAAAI/AAAAAAAAADE/yDDV_aMNNe4/photo.jpg?sz=128", "display_name": "Doug Schwartz", "link": "https://stackoverflow.com/users/6082795/doug-schwartz"}, "is_accepted": false, "score": -1, "last_activity_date": 1513109842, "creation_date": 1513109842, "answer_id": 47780862, "question_id": 47719788, "link": "https://stackoverflow.com/questions/47719788/multiple-file-upload-using-s3/47780862#47780862", "title": "Multiple file upload using s3", "body": "<p>Use the S3 Manager's Uploader.Upload method, <a href=\"http://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/#Uploader.Upload\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/#Uploader.Upload</a>. We have an example at <a href=\"http://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/s3-example-basic-bucket-operations.html#s3-examples-bucket-ops-upload-file-to-bucket\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/s3-example-basic-bucket-operations.html#s3-examples-bucket-ops-upload-file-to-bucket</a>. </p>\n"}], "owner": {"reputation": 1536, "user_id": 1793374, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qK8kV.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1793374/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1486, "favorite_count": 0, "accepted_answer_id": 47719921, "answer_count": 2, "score": 1, "last_activity_date": 1513109842, "creation_date": 1512755756, "question_id": 47719788, "link": "https://stackoverflow.com/questions/47719788/multiple-file-upload-using-s3", "title": "Multiple file upload using s3", "body": "<p>I'd like to upload files to my s3 bucket via the aws golang sdk. I have a web server listening to POST requests and I'm expecting to receive multiple files of any type.</p>\n\n<p>Using the sdk, the s3 struct <code>PutObjectInput</code> expects <code>Body</code> to be of type <code>io.ReadSeeker</code> and I'm not sure how to extract the content from the files uploaded and in turn satisfy the <code>io.ReadSeeker</code> interface.</p>\n\n<pre><code>images := r.MultipartForm.File\n\nfor _, files := range images {\n    for _, f := range files {\n\n        # In my handler, I can loop over the files\n        # and see the content\n        fmt.Println(f.Header)\n\n        _, err = svc.PutObjectWithContext(ctx, &amp;s3.PutObjectInput{\n                Bucket: aws.String(\"bucket\"),\n                Key:    aws.String(\"key\"),\n                Body:   FILE_CONTENT_HERE,\n            })\n    }\n}\n</code></pre>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1512759783, "post_id": 47719767, "comment_id": 82401735, "body": "If you don&#39;t want to shell out, you&#39;ll have to find the appropriate system call for each supported OS and call it with cgo. This is going to require a different implementation for each supported OS either way."}], "answers": [{"tags": [], "owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "is_accepted": false, "score": 0, "last_activity_date": 1514047578, "creation_date": 1514047578, "answer_id": 47954220, "question_id": 47719767, "link": "https://stackoverflow.com/questions/47719767/how-to-determine-the-active-network-interface-media-type/47954220#47954220", "title": "How to determine the active network interface media type?", "body": "<p>Clearly the answer varies based on the OS.  This question was specific to OSX. The biggest challenge is that it is possible, but unusual, to have two active and route-able devices on a personal computer that is not bridging networks. That's more of a server function... In my case I'm interested in the ONE network media device. And that can be complicated...</p>\n\n<p>On OSX there is an OS tool that dumps the device types in priority order with their accompanying device name.</p>\n\n<pre><code>networksetup -listnetworkserviceorder\n</code></pre>\n\n<p>I had to capture the output then parse it in order to call the following <code>isactive</code> function.</p>\n\n<pre><code>func isactive(name string) bool {\n    if iface, err := net.InterfaceByName(name); err!=nil {\n        log.Printf(\"could not locate %s interface - %v\", name, err)\n    } else {\n        if addrs, err := iface.Addrs(); err!=nil || len(addrs)==0 {\n            log.Printf(\"could not locate %s addr - %v\", name, err)\n            return false\n        }\n        if iface.Flags &amp; net.FlagBroadcast == net.FlagBroadcast &amp;&amp; iface.Flags &amp; net.FlagUp == net.FlagUp {\n            //log.Printf(\"%s is active\", name)\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n\n<p>In retrospect there is one other thing to note... <code>iface.Addrs()</code> could return more than one IP address. But again unlikely in the normal use-case.</p>\n"}], "owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514047578, "creation_date": 1512755644, "last_edit_date": 1512903439, "question_id": 47719767, "link": "https://stackoverflow.com/questions/47719767/how-to-determine-the-active-network-interface-media-type", "title": "How to determine the active network interface media type?", "body": "<p>I'm trying to determine if the current active/default network is wifi or ethernet in a reasonable reliable way. Windows offers a command <code>netsh.exe interface ipv4 show interfaces</code> This seems to be reliable except I don't really like shelling out to the CLI for this sort of thing. At least things are reasonable in Windows. The OSX analog is far less reliable or accurate. Using the <code>net.Interface</code> is not reliable as <code>FlagUp</code> is also ambiguous. My next test might be to check for <code>FlagBooadcast</code> per <a href=\"https://superuser.com/questions/124453/how-can-i-scan-the-local-network-for-connected-devices-mac-os\">this</a></p>\n"}, {"tags": ["go", "cucumber", "integration-testing"], "answers": [{"tags": [], "owner": {"reputation": 634, "user_id": 237568, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e7ca1b3e2860bcb4332d8e425a63908f?s=128&d=identicon&r=PG", "display_name": "Francis Norton", "link": "https://stackoverflow.com/users/237568/francis-norton"}, "is_accepted": false, "score": 0, "last_activity_date": 1513863559, "last_edit_date": 1513863559, "creation_date": 1513863219, "answer_id": 47926115, "question_id": 47718814, "link": "https://stackoverflow.com/questions/47718814/is-it-possible-to-reuse-godog-scenarios/47926115#47926115", "title": "Is it possible to reuse godog scenarios?", "body": "<p><code>Scenario Outline</code> with <code>Examples</code> (as documented <a href=\"http://docs.behat.org/en/v2.5/guides/1.gherkin.html#scenario-outlines\" rel=\"nofollow noreferrer\">here</a> for behat, but also implemented in Godog) does what you describe:</p>\n\n<pre><code>Scenario Outline: User starts a workspace with stack\n    Given \"&lt;stack&gt;\" has state \"Running\"\n    When user triggers workspace creation for stack\n    Then workspace should be starting\n    When user looks at the workspace status\n    Then the workspace status should be running and creation successful\nExamples:\n    | stack     |\n    | Minishift |\n    | Redshift  |\n    | Lateshift |\n</code></pre>\n\n<p>Your scenario will be called three times, with the parameters [<code>Minishift</code>, <code>Running</code>]; [<code>Redshift</code>, <code>Running</code>] and finally [<code>Lateshift</code>, <code>Running</code>] being passed to the first step.</p>\n"}, {"tags": [], "owner": {"reputation": 783, "user_id": 186355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213cb2e855af1cbbee74fdc7e9c6d92d?s=128&d=identicon&r=PG", "display_name": "Gediminas", "link": "https://stackoverflow.com/users/186355/gediminas"}, "is_accepted": false, "score": 0, "last_activity_date": 1543184822, "creation_date": 1543184822, "answer_id": 53472649, "question_id": 47718814, "link": "https://stackoverflow.com/questions/47718814/is-it-possible-to-reuse-godog-scenarios/53472649#53472649", "title": "Is it possible to reuse godog scenarios?", "body": "<p>All of your steps in this scenario can be summarized as <code>Given minishift is \"running\" at workspace named \"stack\"</code>. The point is that this step definition can invoke all of your steps defined in the scenario described. And that is an usual practice in order to prevent redundant context in multiple scenarios.</p>\n\n<p>The point in general is that, you can combine stack of steps into a single precondition and that is an usual composition of steps, which is an advocated practice.</p>\n\n<p>Further more, I've noticed you have <strong>two When</strong> steps in your scenario definition and it is not something I would suggest. <strong>When</strong> is a single action and in order to prevent ambiguity, you should not have two actions in scenario, it cannot be clear, what exactly your scenario is about or why it fails exactly if it would. It just means in this case that you have two scenarios here instead of one.</p>\n\n<p>Make your scenarios clear and small, it should be resusable and composable.</p>\n\n<p>Another option is to <strong>@tag</strong> your scenarios needing minishift running for example:</p>\n\n<p><code>\n@minishift\nScenario: expected behavior\n  When I do that action\n  Then I expect this outcome\n</code></p>\n\n<p>Then you can use godog before scenario hook in order to start the minishift as expected.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8914241"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1543184822, "creation_date": 1512752045, "question_id": 47718814, "link": "https://stackoverflow.com/questions/47718814/is-it-possible-to-reuse-godog-scenarios", "title": "Is it possible to reuse godog scenarios?", "body": "<p>I have a defined scenario in godog:</p>\n\n<pre><code>User starts a workspace with stack\n    Given Minishift has state \"Running\"\n    When user triggers workspace creation for stack\n    Then workspace should be starting\n    When user looks at the workspace status\n    Then the workspace status should be running and creation successful\n</code></pre>\n\n<p>and I was wondering if it was possible to reuse this scenario for multiple stacks? Ideally, I would reuse this scenario for every stack and if that stack failed then I would fail that scenario but not all the tests. Each stack is independent of the others. I'm not sure if this is possible or if I have to manually define each stack as a scenario and do it that way.</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 666, "user_id": 5339180, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec7a87ded73862f4599d86c43da80327?s=128&d=identicon&r=PG&f=1", "display_name": "V. Panchenko", "link": "https://stackoverflow.com/users/5339180/v-panchenko"}, "edited": false, "score": 1, "creation_date": 1512751499, "post_id": 47718320, "comment_id": 82397567, "body": "You can store <code>slice</code>, <code>struct</code> and <code>slice of struct</code> values in JSON format, and other values <code>as is</code> (so <code>ID</code> as <code>int</code>, <code>Name</code> as <code>string</code> etc). It will be logical :)"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 1, "creation_date": 1512751591, "post_id": 47718320, "comment_id": 82397608, "body": "How are the <i>SuperPower</i>, <i>Vehicle</i>, and <i>FriendList</i> properties stored in the database? Do you control that decision or are there related tables for them? If it&#39;s up to you then you have many choices; if the database structure is already set then you just have to handle those associations..."}, {"owner": {"reputation": 1867, "user_id": 5281215, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/10153631051339031/picture?type=large", "display_name": "Boo Yan Jiong", "link": "https://stackoverflow.com/users/5281215/boo-yan-jiong"}, "edited": false, "score": 0, "creation_date": 1512752783, "post_id": 47718320, "comment_id": 82398298, "body": "I wish to store those fields (<i>SuperPower</i>, <i>Vehicle</i>, and <i>FriendList</i>) as if the data types in Golang. This is the <b>easiest</b>. Hopefully, those fields can be stored without JSON encoding, then that is the <b>fastest</b>. If it is possible to store without relative tables with association, than that will be <b>elagant</b>. If possible, I wish to access  the database with <i>dot notation</i>, such as <code>SELECT Person.Vehicle.Brand ...</code>, then this may beautifully <b>implemented</b>... is it possible? :)"}], "answers": [{"comments": [{"owner": {"reputation": 1867, "user_id": 5281215, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/10153631051339031/picture?type=large", "display_name": "Boo Yan Jiong", "link": "https://stackoverflow.com/users/5281215/boo-yan-jiong"}, "edited": false, "score": 0, "creation_date": 1512754433, "post_id": 47719156, "comment_id": 82399195, "body": "Yeah, thank you for your suggestion... Hmmm... the website front-end uses too much nested object as that will ease their workflow... Nested objects and arrays are everywhere... Haha... I read about <b>custom data types</b> in Postgresql, hope that will be my saviour... Hmmm... Anyway, thank you for your suggestion... will try to implement the relationship table if can&#39;t find any better solution :)"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1512753235, "creation_date": 1512753235, "answer_id": 47719156, "question_id": 47718320, "link": "https://stackoverflow.com/questions/47718320/storing-and-retrieving-golang-slice-struct-and-slice-of-struct-in-postgresql/47719156#47719156", "title": "Storing and retrieving Golang slice, struct and slice of struct in Postgresql", "body": "<p>In most cases you should create separate tables for Superpowers, Vehicles, and Friends.</p>\n\n<p>If the relationships between one of these tables and the People table is many-to-one or one-to-one you can add foreign keys to them. If the relationship is many-to-many you should create a linking table that will hold the fkeys of the related records.</p>\n\n<p>To store the data you can insert/update each record individually with simple SQL query strings and <code>database/sql</code>.</p>\n\n<p>After that you can create table views that would aggregate the data you want per one person into a single row so that you don't pollute your Go code with complex SQL strings. Then you define simple SQL select query strings in Go and execute them with <code>database/sql</code>.</p>\n"}], "owner": {"reputation": 1867, "user_id": 5281215, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/10153631051339031/picture?type=large", "display_name": "Boo Yan Jiong", "link": "https://stackoverflow.com/users/5281215/boo-yan-jiong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512753235, "creation_date": 1512750252, "question_id": 47718320, "link": "https://stackoverflow.com/questions/47718320/storing-and-retrieving-golang-slice-struct-and-slice-of-struct-in-postgresql", "title": "Storing and retrieving Golang slice, struct and slice of struct in Postgresql", "body": "<p>Let say I have a <em>table</em> named <code>PEOPLE</code> which store rows of <code>Person</code>. However, the <code>Person</code> contains <strong>slice</strong>, <strong>struct</strong> and <strong>slice of struct</strong>, i.e. the <em>Superpower</em>, <em>Vehicle</em> and <em>FriendList</em> fields respectively.</p>\n\n<p>How should I store and retrieve those values in <strong>Postgresql</strong> with <strong>Golang</strong>? I can't find any practical tutorial related to this problem. Use custom data types, or JSON, or ORM method, or building custom functions to deal with these? Many opinions out there, but I still can't figure out a working way to solve this problem, please help.</p>\n\n<p>I am using <a href=\"http://github.com/go-ozzo/ozzo-dbx\" rel=\"nofollow noreferrer\">Ozzo-dbx</a> , however, any solutions is welcome.</p>\n\n<p>Can someone provides a working example? Sorry if this newbie question irritates you, but I already tried for few days, and keep failing... (T_T)</p>\n\n<pre><code>type Transport struct {\n    Brand string\n    Size  int\n}\n\ntype Friend struct {\n    Name         string\n    IsProgrammer bool\n}\n\ntype Person struct {\n    ID         int\n    Name       string\n    Superpower []string   //slice\n    Vehicle    Transport  //struct\n    FriendList []Friend   //slice of struct\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1512742369, "post_id": 47715983, "comment_id": 82392282, "body": "You are reusing tempArray. That&#39;s not how slices work in Go. Read <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a> and take the Tour of Go <a href=\"https://tour.golang.org/moretypes/6\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/6</a> ff."}, {"owner": {"reputation": 41, "user_id": 2107353, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e2fb4a6b1c291b17301441c979cdcbe?s=128&d=identicon&r=PG", "display_name": "teepleb", "link": "https://stackoverflow.com/users/2107353/teepleb"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1512742828, "post_id": 47715983, "comment_id": 82392556, "body": "Thank you for the insight, however I built this directly off of the Tour of Go notes and various pieces in Stack Overflow. :)  I will run back through and see if I missed anything else with Slices though. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 2107353, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e2fb4a6b1c291b17301441c979cdcbe?s=128&d=identicon&r=PG", "display_name": "teepleb", "link": "https://stackoverflow.com/users/2107353/teepleb"}, "edited": false, "score": 0, "creation_date": 1512744872, "post_id": 47716095, "comment_id": 82393759, "body": "I edited my post above, I forgot to include my initialization of the map. I&#39;m essentially just taking data and putting it in the map and using an number index as the key value.  I will go and review the Go documentation again, however I built this near direct off Go docs and Stack Overflow..   Either way, I marked it as accepted answer and gave it an upvote. Thanks for your help. Your solution to just re-create the tempArray each time worked."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1512742319, "creation_date": 1512742319, "answer_id": 47716095, "question_id": 47715983, "link": "https://stackoverflow.com/questions/47715983/confusion-on-potential-variable-scope-maybe-pointers-not-sure/47716095#47716095", "title": "Confusion on Potential Variable Scope (Maybe Pointers)? Not sure", "body": "<p>A slice assignment does not perform a copy, it's just a pointer. This means that every <code>parsedDataSet</code> entry is the same slice.</p>\n\n<p>The simplest solution is for you to move <code>var tempArray []string</code> inside the for loop.</p>\n\n<p>For details on slices and how re-slicing works, you should <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">read up on the details</a></p>\n"}], "owner": {"reputation": 41, "user_id": 2107353, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e2fb4a6b1c291b17301441c979cdcbe?s=128&d=identicon&r=PG", "display_name": "teepleb", "link": "https://stackoverflow.com/users/2107353/teepleb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 47716095, "answer_count": 1, "score": -2, "last_activity_date": 1512744823, "creation_date": 1512741960, "last_edit_date": 1512744823, "question_id": 47715983, "link": "https://stackoverflow.com/questions/47715983/confusion-on-potential-variable-scope-maybe-pointers-not-sure", "title": "Confusion on Potential Variable Scope (Maybe Pointers)? Not sure", "body": "<p>I tried searching for an answer (I feel this is a basic concept) but I was unable to find one that related directly to mine... so here is my post.</p>\n\n<p>I am currently parsing log files off my server and building a script to kind of automate some of the process (learn a new skill, make my job easier, etc.). I built a simplified parser to breakdown each line. I have omitted quite a bit of code as it's unrelated.</p>\n\n<p>Here is my function:</p>\n\n<pre><code>var parsedDataSet = make(map[int][]string)\n\nfunc parseData(dataSet []string) {\n    var tempArray []string\n    for index, element := range dataSet {\n        tempData := strings.Fields(element)\n        tempArray = append(tempArray, tempData[0], tempData[3][1:]+\" \"+tempData[4][:len(tempData[4])-1], tempData[5][1:], tempData[6], tempData[7][:len(tempData[7])-1], tempData[8], tempData[9])\n        parsedDataSet[index] = tempArray\n        fmt.Println(parsedDataSet[index])\n        tempArray = tempArray[:0]\n    }\n    fmt.Println(\"------\")\n    fmt.Println(parsedDataSet[0])\n    fmt.Println(parsedDataSet[1])\n    fmt.Println(parsedDataSet[2])\n    fmt.Println(parsedDataSet[3])\n}\n</code></pre>\n\n<p>Here is the sample result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pSnHW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pSnHW.png\" alt=\"Sample result from a test file.\"></a></p>\n\n<p>As you can see when I print out the \"parsedDataSet\" variable at different sections it holds different values. Above the \"------\" line break is the values I want, below is the values I am showing outside of the \"for\" loop. I am leaning towards variable scope as it's assigning the values inside the \"for\" loop and it's not carrying it outside of that. However, I am accessing a global variable for assignment so my assumption is that it would carry through to the global scope.</p>\n\n<p>I am new to Go so I am still learning quite a bit with the language - loving it so far. I just can't wrap my head around the issue. I re-wrote this in Python (my current language) and it worked perfectly fine in a near similar manner.</p>\n\n<p>Thank you in advance for your help!</p>\n"}, {"tags": ["json", "postgresql", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1512743294, "post_id": 47715952, "comment_id": 82392798, "body": "Change your table column definition, <code>jsonb[]</code> is not a json array, but a <i>postgres array</i> of json data. Change it to just <code>jsonb</code> and see what happens."}, {"owner": {"reputation": 1290, "user_id": 2483507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIUqf.jpg?s=128&g=1", "display_name": "Joffutt4", "link": "https://stackoverflow.com/users/2483507/joffutt4"}, "edited": false, "score": 1, "creation_date": 1512743465, "post_id": 47715952, "comment_id": 82392883, "body": "You could also change your code and not call <code>json.Marshal(c)</code> and instead marshal a and b separately and then add them into an array and then pass that array"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1512766721, "post_id": 47715952, "comment_id": 82404663, "body": "Also I can recommend check postgresql logs to see whole query - possibly it contains errors."}, {"owner": {"reputation": 2836, "user_id": 1359163, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/063e1984ad8cb19353c311ba3a9290b9?s=128&d=identicon&r=PG", "display_name": "KBN", "link": "https://stackoverflow.com/users/1359163/kbn"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1571116433, "post_id": 47715952, "comment_id": 103122217, "body": "@mkopriva just saved me from 2 days of spiraling down. The solution helped me. Also, for future ref: <a href=\"https://github.com/jackc/pgx/v4\" rel=\"nofollow noreferrer\">github.com/jackc/pgx/v4</a> is very useful."}], "owner": {"reputation": 53, "user_id": 1560585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99967d8de0060e5df4ed5d3d111b55e3?s=128&d=identicon&r=PG", "display_name": "user1560585", "link": "https://stackoverflow.com/users/1560585/user1560585"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 878, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1512741847, "creation_date": 1512741847, "question_id": 47715952, "link": "https://stackoverflow.com/questions/47715952/inserting-struct-slice-into-postgresql-jsonb", "title": "Inserting struct slice into Postgresql jsonb[]", "body": "<p>I have a struct slice that I'm trying to marshal into a json array for insert into a postgresql database with a column type of jsonb[].</p>\n\n<pre><code>type t struct {\n    A int\n    B string\n}\na := t{1, \"hello\"}\nb := t{2, \"goodbye\"}\n\nvar c []t\nc = append(c, a, b)\n\nbytes, _ := json.Marshal(c)\n\nstmt := `INSERT INTO test (s, ja) VALUES ($1, $2)`\n_, err = db.Exec(stmt, \"test\", bytes)\nif err != nil {\n    log.Fatal(\"Insert error:\", err)\n}\n</code></pre>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>pq: malformed array literal: \"[{\"A\":1,\"B\":\"hello\"},{\"A\":2,\"B\":\"goodbye\"}]\"</p>\n</blockquote>\n\n<p>How can I make the data appropriate for a jsonb[] column?</p>\n"}]