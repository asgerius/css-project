[{"tags": ["go", "ginkgo", "gomega"], "answers": [{"tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": false, "score": 0, "last_activity_date": 1562817367, "creation_date": 1562817367, "answer_id": 56981435, "question_id": 56979836, "link": "https://stackoverflow.com/questions/56979836/ginkgo-cleanup-on-failure/56981435#56981435", "title": "ginkgo cleanup on failure", "body": "<p>You can keep this test in seperate <strong>context</strong>. Then <strong>afterEach</strong> will only apply to all the <strong>It</strong> under that context:</p>\n\n<pre><code>Context(\"Setup X, Y, Z resources and check conditions\", func() {\n    BeforeEach(func() {\n        // do ...\n    })\n\n    AfterEach(func() {\n        // do clean up\n    })\n\n    It(\"should pass the condition\", func() {\n        // do ...\n    })\n})\n</code></pre>\n"}], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562817367, "creation_date": 1562801503, "question_id": 56979836, "link": "https://stackoverflow.com/questions/56979836/ginkgo-cleanup-on-failure", "title": "ginkgo cleanup on failure", "body": "<p>I am writing my test specs in Ginkgo. </p>\n\n<p>My tests have the following structure:</p>\n\n<pre><code>It(\"Setup X, Y, Z resources and check conditions\" func() {\n    // setup resources. \n    // assert certain conditions using\n    //cleanup resources\n}) \n</code></pre>\n\n<p>My question is, how do I perform cleanup when assertion fails. If I use afterEach block for this purpose, then it executes same cleanup on all test specs, which shows with a bunch of failures to cleanup messages. </p>\n\n<p>what's the recommended way to cleanup on failure with ginkgo.  </p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 2, "creation_date": 1562800502, "post_id": 56979195, "comment_id": 100495339, "body": "I disagree with the votes to close, as the answer to that question is <i>not</i> opinion based, but because there are empirical drawbacks of <i>just</i> using <code>database.DB</code> for the interaction with the database, namely nor using the underlying connection pool."}, {"owner": {"reputation": 630, "user_id": 4484994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3u-HviiJiKY/AAAAAAAAAAI/AAAAAAAAAFM/h4Nq7C48_Pg/photo.jpg?sz=128", "display_name": "Ali Padida", "link": "https://stackoverflow.com/users/4484994/ali-padida"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562846077, "post_id": 56979195, "comment_id": 100511712, "body": "It&#39;s not opinion based obviously, it&#39;s about performance. I am really sorry for stackoverflow community. Thanks @MarkusWMahlberg"}], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 4484994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3u-HviiJiKY/AAAAAAAAAAI/AAAAAAAAAFM/h4Nq7C48_Pg/photo.jpg?sz=128", "display_name": "Ali Padida", "link": "https://stackoverflow.com/users/4484994/ali-padida"}, "edited": false, "score": 0, "creation_date": 1562846094, "post_id": 56979859, "comment_id": 100511723, "body": "thanks, as simple as that."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1562801645, "creation_date": 1562801645, "answer_id": 56979859, "question_id": 56979195, "link": "https://stackoverflow.com/questions/56979195/whats-the-downside-of-using-global-mongo-mgo-database-in-golang/56979859#56979859", "title": "What&#39;s the downside of using global mongo (mgo) database in golang?", "body": "<p>The procedure of using a globally initialized database to be handed down to the places it is needed is well established and reasonable.</p>\n\n<p>However, <em>just</em> using <code>database.DB</code> in a manner like</p>\n\n<pre><code>_ = database.DB.C(foo).Find(q).One(&amp;bar)\n</code></pre>\n\n<p>all over the place holds a significant disadvantage: you only use one connection of the underlying connection pool, practically ensuring that <em>all</em> requests are processed sequentially.</p>\n\n<p>So what you rather want to do is something like this:</p>\n\n<pre><code>s := database.DB.Session.Copy()\n_ = database.DB.C(foo).With(s).Find(q).One(&amp;bar)\ndefer s.Close()\n</code></pre>\n\n<p>for \u201eparallel\u201c requests (there are some caveats about parallel requests, which I leave out for the sake of brevity).</p>\n"}], "owner": {"reputation": 630, "user_id": 4484994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-3u-HviiJiKY/AAAAAAAAAAI/AAAAAAAAAFM/h4Nq7C48_Pg/photo.jpg?sz=128", "display_name": "Ali Padida", "link": "https://stackoverflow.com/users/4484994/ali-padida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "closed_date": 1562830364, "accepted_answer_id": 56979859, "answer_count": 1, "score": -1, "last_activity_date": 1575759987, "creation_date": 1562796021, "last_edit_date": 1575759987, "question_id": 56979195, "link": "https://stackoverflow.com/questions/56979195/whats-the-downside-of-using-global-mongo-mgo-database-in-golang", "closed_reason": "Opinion-based", "title": "What&#39;s the downside of using global mongo (mgo) database in golang?", "body": "<p><strong>Are there</strong> any downsides if we use a global variable to handle database operations instead of passing it as an argument to functions and methods or storing it as a field in structs? </p>\n\n<p><strong>What are these downsides (if there are)?</strong></p>\n\n<p>Let's say we create a package inside a project called database, inside that package define a variable called DB <code>var DB *mgo.Database</code>, and then in project's main function fill it with our mongo database:</p>\n\n<pre><code>func main() {\n    session, err := mgo.Dial(\"localhost\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    database.DB = session.DB(\"mydatabase\")\n    // project code\n    defer session.Close()\n}\n</code></pre>\n\n<p>After that, we use database.DB to interact with our database.</p>\n\n<p><strong>Note that there will be lots of goroutines using database.DB (if it makes any difference)</strong></p>\n\n<p><strong>The question is not opinion based, please take more time to read and understand</strong></p>\n\n<p><strong>I REPEAT AGAIN The question is not opinion based, please take more more time to read and understand</strong></p>\n"}, {"tags": ["algorithm", "go", "recursion"], "answers": [{"tags": [], "owner": {"reputation": 458, "user_id": 11751463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5091d0a03b8da93bbc04e92c5a3fd29b?s=128&d=identicon&r=PG&f=1", "display_name": "Tannisha Hill", "link": "https://stackoverflow.com/users/11751463/tannisha-hill"}, "is_accepted": false, "score": 0, "last_activity_date": 1562800967, "creation_date": 1562800967, "answer_id": 56979787, "question_id": 56979108, "link": "https://stackoverflow.com/questions/56979108/recursively-create-nested-struct/56979787#56979787", "title": "Recursively create nested struct", "body": "<p>This would be my approach, I'll create the Node and then add a separate method to add children.</p>\n\n<pre><code>func createNode(id string) *Node{\n   return &amp;Node{\n      id: id,\n      children: make([]*Node, 0)\n   }\n}\n</code></pre>\n\n<p>And now add the nodes.</p>\n\n<pre><code>func(n *Node) addChildren(nodes []*Node){\n   for _, node := range nodes{\n     n.children.append(node)\n   }\n}\n</code></pre>\n\n<p>But then if you wish to, you could combine the two.</p>\n\n<pre><code>func createNode(id string, nodes []*Node) *Node{\n   p= Node{\n      id: id,\n      children: make([]*Node, 0)\n   }\n   for _, node := range nodes{\n     p.children.append(node)\n   }\n   return &amp;p\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2877350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60908734c10ecd95b615a0eebe091c82?s=128&d=identicon&r=PG&f=1", "display_name": "user2877350", "link": "https://stackoverflow.com/users/2877350/user2877350"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562807207, "creation_date": 1562795434, "last_edit_date": 1562807207, "question_id": 56979108, "link": "https://stackoverflow.com/questions/56979108/recursively-create-nested-struct", "title": "Recursively create nested struct", "body": "<p>I have a struct of the following format</p>\n\n<pre><code>type Node struct {\n    Id string\n    Children []*Node\n}\n</code></pre>\n\n<h2>Input</h2>\n\n<p>I have the following input </p>\n\n<pre><code>var nestedSlice = [][]string{\n        {\"60566\", \"605\", \"6056\"},\n        {\"60566\", \"605\", \"6061\"},\n        {\"60566\", \"605\", \"6065\"},\n        {\"60653\", \"606\", \"6109\"},\n        {\"60566\", \"603\", \"6065\"},\n    }\n</code></pre>\n\n<h2>The code</h2>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    //\"fmt\"\n    \"github.com/davecgh/go-spew/spew\"\n)\n\ntype Node struct {\n    Id       string\n    Type     string\n    Children []*Node\n}\n\nfunc createNode(values []string, node *Node) *Node {\n\n}\n\nfunc insert(values []string, nodes []*Node) []*Node {\n    if len(nodes) == 0 {\n        rootNode := createNode(values, &amp;Node{})\n        nodes = append(nodes, rootNode)\n        return nodes\n    } else {\n        for _, node := range nodes {\n            if node.Id == values[0] {\n                return insert(values[1:], node.Children)\n            }\n        }\n        anotherRoot := &amp;Node{\n            Id: values[0],\n        }\n        nodes = append(nodes, anotherRoot)\n    }\n    return nodes\n}\n\nfunc main() {\n    nodes := make([]*Node, 0, 6)\n\n    var nestedSlice = [][]string{\n        {\"60566\", \"605\", \"6056\"},\n        {\"60566\", \"605\", \"6061\"},\n        {\"60566\", \"605\", \"6065\"},\n        {\"60653\", \"606\", \"6109\"},\n        {\"60566\", \"603\", \"6065\"},\n    }\n\n    for _, value := range nestedSlice {\n        nodes = insert(value, nodes)\n    }\n\n    spew.Dump(nodes)\n}\n\n</code></pre>\n\n<p>I am having troubles with createNode function. I am not sure how can I take the slice and create it using recursion</p>\n\n<p>I want to be able to have the following struct in the end </p>\n\n<pre><code>[{\n    Id: 60566,\n    Children: [{\n        Id: 605,\n        Children: [{\n            Id: 6056\n        }, {\n            Id: 6061\n        }, {\n            Id: 6065\n        }]\n    }, {\n        Id: 603,\n        Children: [{\n            Id: 6065\n        }]\n    }]\n}, {\n    Id: 60653\n    Children: [{\n        Id: 606,\n        Children: [{\n            Id: 6109\n        }]\n    }]\n}]\n\n\n\n\n</code></pre>\n"}, {"tags": ["go", "grpc", "go-modules"], "answers": [{"comments": [{"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1562818399, "post_id": 56980362, "comment_id": 100498480, "body": "Thank you. I think this approach would work. However, Go Modules provides the ability to define my project as e.g. <code>github.com&#47;acme&#47;toolbox</code> even though the files are stored in some arbitrary directory. This is because <code>go.mod</code> includes a <code>module</code> prefix that references that github path. If -- and perhaps this is my mistake -- <code>protos</code> is a subdirectory of the project, Go files in my project should refer to its files using the module prefix."}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1563382196, "post_id": 56980362, "comment_id": 100684546, "body": "On reflection, this is exactly the correct answer. For some (stupid) reason, I was not thinking through the consequences of using <code>go_package</code> using a <code>${GOPATH}</code> value. You&#39;re, of course, correct. I revised <code>go_package</code> to be <code>protos</code> and the bindings are generated where I want them. Thank you!"}], "tags": [], "owner": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "is_accepted": true, "score": 4, "last_activity_date": 1562807509, "last_edit_date": 1562807509, "creation_date": 1562806782, "answer_id": 56980362, "question_id": 56978791, "link": "https://stackoverflow.com/questions/56978791/best-practice-for-the-generation-of-in-repo-protos-when-using-go-modules/56980362#56980362", "title": "Best practice for the generation of in-repo protos when using Go Modules", "body": "<p>The main point of the <code>go_package</code> option is to define what the go package name will be. With that said, it can behave differently depending on what you set it too.</p>\n\n<p>If <code>option go_package</code> is defined to be a valid go package name (e.g. protos), <code>protoc</code> will generate the files in the folder defined by <code>--go_out</code> with that package name. If <code>option go_package</code> is instead a path (e.g. github.com/acme/toolbox/protos), <code>protoc</code> will create the folder structure defined relative to <code>--go_out</code> and place the files there with the package name being the same as the last folder name.</p>\n\n<p>Unless I am mistaken in what you are wanting to do, you can change <code>go_package</code> to be:</p>\n\n<pre><code>option go_package = \"protos\";\n</code></pre>\n\n<p>and change your <code>protoc</code> invocation to be:</p>\n\n<pre><code>protoc \\\n--proto_path=./protos \\\n--go_out=plugins=grpc:${TOOLBOX}/protos\n./protos/*.proto\n</code></pre>\n\n<p>Doing that, the generated files will be placed in <code>${TOOLBOX}/protos</code> with the go package <code>package protos</code>.</p>\n"}], "owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 0, "accepted_answer_id": 56980362, "answer_count": 1, "score": 3, "last_activity_date": 1562853554, "creation_date": 1562793550, "question_id": 56978791, "link": "https://stackoverflow.com/questions/56978791/best-practice-for-the-generation-of-in-repo-protos-when-using-go-modules", "title": "Best practice for the generation of in-repo protos when using Go Modules", "body": "<p><strong>tl;dr</strong> A repo formerly configured to use <code>GOPATH</code> is now configured for Modules. All's good and better. However, protoc correctly (!) generates Golang code for protobufs defined within the repo in a <code>github.com/path/to/repo/protos</code> structure when I'd now prefer these to be generated in my sources, outside of <code>GOPATH</code>. I'm moving them to resolve this. Is there a better solution?</p>\n\n<hr>\n\n<p>I have a GitHub repo. For the sake of discussion, let's call it <code>github.com/acme/toolbox</code>. In a subdirectory, I have protobuf files that include:</p>\n\n<pre><code>package acme.toolbox.v1;\noption go_package = \"github.com/acme/toolbox/protos\";\n</code></pre>\n\n<p>When I was <code>GOPATH</code>'ing, all was well and <code>protoc</code> would generate Golang bindings in <code>$GOPATH/src/github.com/acme/toolbox/protos</code> and my code, importing <code>pb \"github.com/acme/toolbox/protos\"</code>, would work.</p>\n\n<p>Moving to <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">Go Modules</a> hasn't been pain-free but, the benefits outweigh the cost and I'm future-proofing myself and the code.</p>\n\n<p>My issue is that I don't see how I can get <code>protoc</code> to generate the Golang bindings into my arbitrarily and outside of <code>GOPATH</code> located clone.</p>\n\n<p>I'm moving the files after they're generated but this feels... inelegant:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>cd ${TOOLBOX}\nprotoc \\\n--proto_path=./protos \\\n--go_out=plugins=grpc:/go/src\n./protos/*.proto\nmv ${GOPATH}/src/github.com/acme/toolbox/protos/*.go ${TOOLBOX}/protos\n</code></pre>\n\n<p>Is there a better solution?</p>\n"}, {"tags": ["json", "go", "encoding", "marshalling"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1562791263, "post_id": 56978218, "comment_id": 100492677, "body": "Remove all the <code>,string</code>s from your struct tags."}], "answers": [{"tags": [], "owner": {"reputation": 583, "user_id": 10272405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2cfdf6c1b7de7e555dbf40cfd583cfb?s=128&d=identicon&r=PG&f=1", "display_name": "moficodes", "link": "https://stackoverflow.com/users/10272405/moficodes"}, "is_accepted": false, "score": 1, "last_activity_date": 1562792425, "creation_date": 1562792425, "answer_id": 56978572, "question_id": 56978218, "link": "https://stackoverflow.com/questions/56978218/removing-escape-characters-from-marshalled-struct-golang/56978572#56978572", "title": "Removing Escape Characters from Marshalled Struct Golang", "body": "<p>For removing double quotes you could use <code>strconc.Unquote</code> </p>\n\n<p>It would be great to see an example of a row of data to see if anything else is missing. </p>\n\n<p>But from what is available here, if there is quotes in the string <code>json.Marshal</code> will not automagically remove them. You can remove quotes using the above command. </p>\n\n<p><a href=\"https://play.golang.org/p/id4f4r9tEr\" rel=\"nofollow noreferrer\">Look at This Example</a> for <code>Unquote</code>.</p>\n\n<p>You can probably just write one method on the <code>ChannelData</code> struct that will unquote each field.</p>\n\n<pre><code>func (c *ChannelData) unquote() {\n  c.Idx = strconv.Unquote(c.Idx)\n.\n.\n.\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3966193, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000320559490/picture?type=large", "display_name": "Varun Wadhwa", "link": "https://stackoverflow.com/users/3966193/varun-wadhwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562792425, "creation_date": 1562790697, "last_edit_date": 1562791060, "question_id": 56978218, "link": "https://stackoverflow.com/questions/56978218/removing-escape-characters-from-marshalled-struct-golang", "title": "Removing Escape Characters from Marshalled Struct Golang", "body": "<p>The format of my JSON output after I marshal a struct has a lot of escape characters and double quotes.</p>\n\n<p>I've tried using an encoder, Marshalling, RawMessages, forcefully removing parts of the string.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>data := ChannelData{}\nif err := rows.Scan(&amp;data.Idx, &amp;data.MciIdx, &amp;data.Channel, &amp;data.MatchIdx, &amp;data.MatchCx, &amp;data.StartTs, &amp;data.EndTs, &amp;data.Len, &amp;data.MatchStartTs, &amp;data.MatchEndTs, &amp;data.MatchLen, &amp;data.Happened, &amp;data.Instance); err != nil {\nlog.Printf(\"%+v\\n\", rows)\nlog.Error().Err(err).Msg(\"unable to scan mysql data into struct\")\ncontinue\n}\n\njsonD, err := json.Marshal(&amp;data)\nif err != nil {\nlog.Error().Err(err).Msg(\"cannot marshal data\")\n}\nlog.Debug().Msg(string(jsonD))\n\ntype ChannelData struct {\n    Idx          string `json:\"idx,string\"`\n    MciIdx       string `json:\"mci_idx,string\"`\n    Channel      string `json:\"channel,string\"`\n    MatchIdx     string `json:\"match_idx,string\"`\n    MatchCx      string `json:\"match_cx,string\"`\n    StartTs      string `json:\"start_ts,string\"`\n    EndTs        string `json:\"end_ts,string\"`\n    Len          string `json:\"len,string\"`\n    MatchStartTs string `json:\"match_start_ts,string\"`\n    MatchEndTs   string `json:\"match_end_ts,string\"`\n    MatchLen     string `json:\"match_len,string\"`\n    Happened     string `json:\"happened,string\"`\n    Instance     string `json:\"instance,string\"`\n}\n\n</code></pre>\n\n<p>I am getting:</p>\n\n<p>{\"level\":\"debug\",\"time\":\"2019-07-10T20:12:09Z\",\"message\":\"{\\\"idx\\\":\\\"\\\\\"8931741865\\\\\"\\\",\\\"mci_idx\\\":\\\"\\\\\"107265043\\\\\"\\\",\\\"channel\\\":\\\"\\\\\"WPVIDT\\\\\"\\\",\\\"match_idx\\\":\\\"\\\\\"36028797060807935\\\\\"\\\",\\\"match_cx\\\":\\\"\\\\\"\\\\\"\\\",\\\"start_ts\\\":\\\"\\\\\"2019-07-10 17:57:59\\\\\"\\\",\\\"end_ts\\\":\\\"\\\\\"2019-07-10 17:58:14\\\\\"\\\",\\\"len\\\":\\\"\\\\\"00:00:15\\\\\"\\\",\\\"match_start_ts\\\":\\\"\\\\\"2019-06-05 07:14:52\\\\\"\\\",\\\"match_end_ts\\\":\\\"\\\\\"2019-06-05 07:15:08\\\\\"\\\",\\\"match_len\\\":\\\"\\\\\"00:00:16\\\\\"\\\",\\\"happened\\\":\\\"\\\\\"2019-07-10 17:58:16\\\\\"\\\",\\\"instance\\\":\\\"\\\\\"172.17.65.80\\\\\"\\\"}\"}</p>\n\n<p>I expect it to be in JSON format:</p>\n\n<p>{\"level\":\"debug\",\"time\":\"2019-07-10T20:12:09Z\",\"message\":\"{\"idx\":\"8931741865\",\"mci_idx\":\"107265043\",\"channel\":\"WPVIDT\"...}\"}</p>\n"}, {"tags": ["reactjs", "go", "axios", "go-gin"], "comments": [{"owner": {"reputation": 1305, "user_id": 2136376, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0eb15e19a4e5bc32d6c08fa36e450557?s=128&d=identicon&r=PG", "display_name": "prichrd", "link": "https://stackoverflow.com/users/2136376/prichrd"}, "edited": false, "score": 2, "creation_date": 1562783923, "post_id": 56976754, "comment_id": 100489730, "body": "You should fix the CORS issue, it clearly doesn&#39;t help getting a right response code."}, {"owner": {"reputation": 14231, "user_id": 1218980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c6b54df38abce7b1c35f499a1d4a67?s=128&d=identicon&r=PG", "display_name": "Emile Bergeron", "link": "https://stackoverflow.com/users/1218980/emile-bergeron"}, "edited": false, "score": 0, "creation_date": 1562783945, "post_id": 56976754, "comment_id": 100489740, "body": "Your server must set the right CORS headers in order for the browser to make the POST request. For this, your server needs to respond to <code>OPTIONS</code> requests sent by the browser as well."}, {"owner": {"reputation": 193, "user_id": 11766408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec295cea34bc4a92fe14a67082d53407?s=128&d=identicon&r=PG&f=1", "display_name": "jpskgc", "link": "https://stackoverflow.com/users/11766408/jpskgc"}, "edited": false, "score": 0, "creation_date": 1562786028, "post_id": 56976754, "comment_id": 100490602, "body": "I already added <code>c.Header(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;)</code> in server side code. But still same error occurs."}, {"owner": {"reputation": 14231, "user_id": 1218980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c6b54df38abce7b1c35f499a1d4a67?s=128&d=identicon&r=PG", "display_name": "Emile Bergeron", "link": "https://stackoverflow.com/users/1218980/emile-bergeron"}, "edited": false, "score": 2, "creation_date": 1562786093, "post_id": 56976754, "comment_id": 100490625, "body": "Your server only responds to POST requests, as seen with <code>api.POST</code>, but it should also respond to OPTIONS requests as well."}, {"owner": {"reputation": 193, "user_id": 11766408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec295cea34bc4a92fe14a67082d53407?s=128&d=identicon&r=PG&f=1", "display_name": "jpskgc", "link": "https://stackoverflow.com/users/11766408/jpskgc"}, "edited": false, "score": 0, "creation_date": 1562787035, "post_id": 56976754, "comment_id": 100491005, "body": "I got it. Issue was resolved. Thanks!!"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 11766408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec295cea34bc4a92fe14a67082d53407?s=128&d=identicon&r=PG&f=1", "display_name": "jpskgc", "link": "https://stackoverflow.com/users/11766408/jpskgc"}, "edited": false, "score": 0, "creation_date": 1562786041, "post_id": 56976832, "comment_id": 100490606, "body": "I already added <code>c.Header(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;)</code> in server side code. But still same error occurs."}], "tags": [], "owner": {"reputation": 2487, "user_id": 2628903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kIwNY.jpg?s=128&g=1", "display_name": "Velimir Tchatchevsky", "link": "https://stackoverflow.com/users/2628903/velimir-tchatchevsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1562784104, "creation_date": 1562784104, "answer_id": 56976832, "question_id": 56976754, "link": "https://stackoverflow.com/questions/56976754/axios-post-request-gets-404/56976832#56976832", "title": "axios.post request gets 404", "body": "<p>As the error says the request 'has been blocked by CORS policy', which is short for '<a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\" rel=\"nofollow noreferrer\">Cross-Origin Resource Sharing</a>' and is a security measure implemented by the browser. The solution is to modify your server to return the correct 'Access-Control-Allow-Origin' header.</p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 11766408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec295cea34bc4a92fe14a67082d53407?s=128&d=identicon&r=PG&f=1", "display_name": "jpskgc", "link": "https://stackoverflow.com/users/11766408/jpskgc"}, "is_accepted": false, "score": 0, "last_activity_date": 1562787198, "creation_date": 1562787198, "answer_id": 56977487, "question_id": 56976754, "link": "https://stackoverflow.com/questions/56976754/axios-post-request-gets-404/56977487#56977487", "title": "axios.post request gets 404", "body": "<p>After I added some codes in server side, issue was resolved.</p>\n\n<pre><code>        api.POST(\"/post\", func(c *gin.Context) {\n            c.Header(\"Content-Type\", \"application/json\")\n            c.Header(\"Access-Control-Allow-Origin\", \"*\")\n            // add \n            c.Header(\"Access-Control-Allow-Headers\", \"Content-Type\")\n            var article Article\n            c.BindJSON(&amp;article)\n            ins, err := db.Prepare(\"INSERT INTO articles(title,content) VALUES(?,?)\")\n            if err != nil {\n                log.Fatal(err)\n            }\n            ins.Exec(article.TITLE, article.CONTENT)\n            c.JSON(http.StatusOK, gin.H{\"status\": \"ok\"})\n        })\n        // add response to OPTIONS\n        api.OPTIONS(\"/post\", func(c *gin.Context) {\n            c.Header(\"Content-Type\", \"application/json\")\n            c.Header(\"Access-Control-Allow-Origin\", \"*\")\n            c.Header(\"Access-Control-Allow-Headers\", \"Content-Type\")\n            c.JSON(http.StatusOK, gin.H{\"status\": \"ok\"})\n        })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 6088841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pKBMYc2VCNI/AAAAAAAAAAI/AAAAAAAAAKA/5xPhBCZ3RYE/photo.jpg?sz=128", "display_name": "Shakhawat Hossain", "link": "https://stackoverflow.com/users/6088841/shakhawat-hossain"}, "is_accepted": true, "score": 2, "last_activity_date": 1562788373, "creation_date": 1562788373, "answer_id": 56977728, "question_id": 56976754, "link": "https://stackoverflow.com/questions/56976754/axios-post-request-gets-404/56977728#56977728", "title": "axios.post request gets 404", "body": "<p>Here is the working code that I tested:</p>\n\n<pre><code>type Article struct {\n    ID      int    `json:\"id\"`\n    TITLE   string `json:\"title\"`\n    CONTENT string `json:\"content\"`\n}\n\nvar articles []Article\n\nfunc main() {\n\n    db, err := sql.Open(\"mysql\", \"root:111111@tcp(localhost:3306)/article\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    router := gin.Default()\n\n    router.Use(cors.New(cors.Config{\n        AllowOrigins:     []string{\"*\"},\n        AllowMethods:     []string{\"GET\", \"POST\", \"OPTIONS\"},\n        AllowHeaders:     []string{\"Content-Type\", \"Content-Length\", \"Accept-Encoding\", \"X-CSRF-Token\", \"Authorization\", \"accept\", \"origin\", \"Cache-Control\", \"X-Requested-With\"},\n        ExposeHeaders:    []string{\"Content-Length\"},\n        AllowCredentials: true,\n        AllowOriginFunc: func(origin string) bool {\n            return true\n        },\n        MaxAge: 15 * time.Second,\n    }))\n    api := router.Group(\"/api\")\n    {\n\n        api.POST(\"/post\", func(c *gin.Context) {\n            var article Article\n            c.BindJSON(&amp;article)\n            ins, err := db.Prepare(\"INSERT INTO articles(title,content) VALUES(?,?)\")\n            if err != nil {\n                log.Fatal(err)\n            }\n            ins.Exec(article.TITLE, article.CONTENT)\n            c.JSON(http.StatusOK, gin.H{\"status\": \"ok\"})\n        })\n    }\n    router.Run(\":4000\")\n}\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 11766408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec295cea34bc4a92fe14a67082d53407?s=128&d=identicon&r=PG&f=1", "display_name": "jpskgc", "link": "https://stackoverflow.com/users/11766408/jpskgc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2363, "favorite_count": 0, "accepted_answer_id": 56977728, "answer_count": 3, "score": 1, "last_activity_date": 1597431107, "creation_date": 1562783751, "last_edit_date": 1597431107, "question_id": 56976754, "link": "https://stackoverflow.com/questions/56976754/axios-post-request-gets-404", "title": "axios.post request gets 404", "body": "<p>Client side(React/axios.post) failed to post to server side api (Golang/gin) with status code 404.\nI want to make this post request success.</p>\n\n<p>Following curl success to write data in mysql table</p>\n\n<pre><code>curl -X POST -H \"Content-Type: application/json\" -d '{\"title\":\"bbb\", \"content\":\"bbb\"}' localhost:4000/api/post\n</code></pre>\n\n<p>But, in case of axios.post, 404 error occurs.</p>\n\n<p>This is target source code.</p>\n\n<pre><code>interface ArticleState {\n  title: string;\n  content: string;\n  redirect: boolean;\n}\n\nclass Post extends React.Component&lt;{}, ArticleState&gt; {\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      title: '',\n      content: '',\n      redirect: false,\n    };\n\n    this.handleChangeTitle = this.handleChangeTitle.bind(this);\n    this.handleChangeContent = this.handleChangeContent.bind(this);\n    this.setRedirect = this.setRedirect.bind(this);\n    this.renderRedirect = this.renderRedirect.bind(this);\n  }\n\n  handleChangeTitle(e: React.FormEvent&lt;HTMLInputElement&gt;) {\n    this.setState({title: e.currentTarget.value});\n  }\n\n  handleChangeContent(e: React.FormEvent&lt;HTMLInputElement&gt;) {\n    this.setState({content: e.currentTarget.value});\n  }\n\n  setRedirect() {\n    this.setState({\n      redirect: true,\n    });\n\n    const data = {title: this.state.title, content: this.state.content};\n    axios.post('http://localhost:4000/api/post', data).then(res =&gt; {\n      console.log(res);\n    });\n  }\n\n  renderRedirect = () =&gt; {\n    if (this.state.redirect) {\n      return &lt;Redirect to=\"/post/finish\" /&gt;;\n    }\n  };\n\n  render() {\n    return (\n      &lt;Container text style={{marginTop: '3em'}}&gt;\n        &lt;Form onSubmit={this.setRedirect}&gt;\n          &lt;Form.Input\n            label=\"Title\"\n            name=\"title\"\n            value={this.state.title}\n            onChange={this.handleChangeTitle}\n          /&gt;\n          &lt;Form.Field\n            label=\"Content\"\n            name=\"content\"\n            value={this.state.content}\n            control=\"textarea\"\n            onChange={this.handleChangeContent}\n          /&gt;\n          {this.renderRedirect()}\n          &lt;Form.Button content=\"Submit\" /&gt;\n        &lt;/Form&gt;\n      &lt;/Container&gt;\n    );\n  }\n}\n</code></pre>\n\n<pre><code>type Article struct {\n    ID      int    `json:\"id\"`\n    TITLE   string `json:\"title\"`\n    CONTENT string `json:\"content\"`\n}\n\nvar articles []Article\n\nfunc main() {\n\n    db, err := sql.Open(\"mysql\", \"user:password@tcp(localhost:3306)/article\")\n    if err != nil {\n        panic(err.Error())\n    }\n    defer db.Close()\n\n    router := gin.Default()\n\n    api := router.Group(\"/api\")\n    {\n        api.POST(\"/post\", func(c *gin.Context) {\n            var article Article\n            c.BindJSON(&amp;article)\n            c.Header(\"Content-Type\", \"application/json\")\n            c.Header(\"Access-Control-Allow-Origin\", \"*\")\n            ins, err := db.Prepare(\"INSERT INTO articles(title,content) VALUES(?,?)\")\n            if err != nil {\n                log.Fatal(err)\n            }\n            ins.Exec(article.TITLE, article.CONTENT)\n            c.JSON(http.StatusOK, gin.H{\"status\": \"ok\"})\n        })\n    }\n    router.Run(\":4000\")\n}\n\n</code></pre>\n\n<p>I expect axios.post success to request, but actually failed with 404 status.</p>\n\n<pre><code>OPTIONS http://localhost:4000/api/post 404 (Not Found)\nAccess to XMLHttpRequest at 'http://localhost:4000/api/post' \nfrom origin 'http://localhost:3000' has been blocked by CORS policy: \nResponse to preflight request doesn't pass access control check: \nNo 'Access-Control-Allow-Origin' header is present on the requested \nresource.\ncreateError.js:17 Uncaught (in promise) Error: Network Error\n    at createError (createError.js:17)\n    at XMLHttpRequest.handleError (xhr.js:80)\n</code></pre>\n"}, {"tags": ["mysql", "database", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562776634, "post_id": 56975075, "comment_id": 100486453, "body": "Your go code is invalid, and won&#39;t compile. Please copy and paste your code directly (then edit out the password)."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "edited": false, "score": 0, "creation_date": 1562776899, "post_id": 56975075, "comment_id": 100486569, "body": "@Anshu: More likely, the user isn&#39;t granted remote access in mysql."}, {"owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "edited": false, "score": 0, "creation_date": 1562777008, "post_id": 56975075, "comment_id": 100486628, "body": "@flimzy..but the given error.the user don&#39;t have authentication to access the database."}, {"owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1562777087, "post_id": 56975075, "comment_id": 100486669, "body": "i can connect remotely from command prompt"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562777146, "post_id": 56975075, "comment_id": 100486695, "body": "&quot;i can connect remotly from command prompt&quot; -- Then it must be a bad username or password, or you&#39;re connecting over a different network type with different security settings (such as IPv4 vs IPv6)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "edited": false, "score": 0, "creation_date": 1562777194, "post_id": 56975075, "comment_id": 100486727, "body": "@Anshu: I&#39;m pretty sure the error message is the same in both cases."}, {"owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562777371, "post_id": 56975075, "comment_id": 100486813, "body": "Ok @Flimzy sure you&#39;re right.... Thanks \ud83d\ude0a"}, {"owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "edited": false, "score": 0, "creation_date": 1562778220, "post_id": 56975075, "comment_id": 100487168, "body": "Ok part of the unit test was throwing it off as the user only has select rights, it could not create the database so it did not even get the the select query"}], "owner": {"reputation": 728, "user_id": 3755946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b78dda1af6b7a699776ad1bc69bbe35?s=128&d=identicon&r=PG&f=1", "display_name": "user3755946", "link": "https://stackoverflow.com/users/3755946/user3755946"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1562776730, "answer_count": 0, "score": 0, "last_activity_date": 1562790722, "creation_date": 1562776477, "last_edit_date": 1562790722, "question_id": 56975075, "link": "https://stackoverflow.com/questions/56975075/i-can-connect-to-my-remote-database-via-command-line-but-not-from-golang-althou", "closed_reason": "Duplicate", "title": "I can connect to my remote database via command line but not from golang, although local db works fine with both", "body": "<p>If I run the following from command prompt...</p>\n\n<pre><code>mysql -h xxx.xxx.xxx.xxx -u myuser -p mydb\n</code></pre>\n\n<p>I can access the database and successfully run a query from the sql> command prompt</p>\n\n<p>However, when I use the <code>database/sql</code> package in Golang get the following...</p>\n\n<blockquote>\n  <p>[0/0]0x0Error 1045: Access denied for user\n  'myuser'@'xxx.xxx.xxx.xxx' (using password: YES)</p>\n</blockquote>\n\n<p>Please see code below...</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", myuser:mypassword@tcp(xxx.xxx.xxx.xxx:3306)/mydb)\n\nif err != nil {\n    color.Red(err.Error())\n}\nvar objects []map[string]interface{}\n\nrows, err := db.Query(\"select * from mytable\" , args...)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n\n<p>Please note the <code>db</code> var seems fine as if it connects to the database, it's when i try to populate the rows var i get the error.</p>\n\n<p>Also i created unit tests which create a database and table and test a query these all work fine.</p>\n\n<p>Al firewalls etc are off.</p>\n\n<p>so to summarise...</p>\n\n<blockquote>\n  <p>Remote + Command Prompt -  works</p>\n  \n  <p>local + golang - is fine</p>\n  \n  <p>Remote + golang  - gets the error</p>\n</blockquote>\n"}, {"tags": ["algorithm", "go", "tree"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1562775435, "post_id": 56974674, "comment_id": 100485871, "body": "It&#39;s difficult to understand what&#39;s going on because the code is incomplete (the symbols <code>tacticNode</code>, <code>tempNode</code> are not defined in the question).  Please post an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 2877350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60908734c10ecd95b615a0eebe091c82?s=128&d=identicon&r=PG&f=1", "display_name": "user2877350", "link": "https://stackoverflow.com/users/2877350/user2877350"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562775968, "post_id": 56974674, "comment_id": 100486138, "body": "Sorry for incompletion, the <code>tacticNode</code> is suppose to be <code>middleNode</code> and  <code>tempNode`` was supposed to be just </code>node```"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1562776342, "post_id": 56974674, "comment_id": 100486323, "body": "The code does not compile. Start by fixing the syntax errors. Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> when you are done."}, {"owner": {"reputation": 1, "user_id": 2877350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60908734c10ecd95b615a0eebe091c82?s=128&d=identicon&r=PG&f=1", "display_name": "user2877350", "link": "https://stackoverflow.com/users/2877350/user2877350"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562777162, "post_id": 56974674, "comment_id": 100486708, "body": "My bad. Fixed. The output I get is the following <code>&amp;{60566 TYPE1 [0xc420056140]} &amp;{60566 TYPE1 [0xc420056240]} &amp;{60566 TYPE1 [0xc420056340]} &amp;{60653 TYPE1 [0xc420056440]}</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562778739, "post_id": 56974674, "comment_id": 100487426, "body": "One problem is that <code>buildNode</code> appends a value to the slice <code>node</code> and this resulting slice is discarded.  Perhaps change <code>buildNode</code> to take a <code>*Node</code> as an argument and update that nodes <code>Children</code>."}], "owner": {"reputation": 1, "user_id": 2877350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60908734c10ecd95b615a0eebe091c82?s=128&d=identicon&r=PG&f=1", "display_name": "user2877350", "link": "https://stackoverflow.com/users/2877350/user2877350"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562777095, "creation_date": 1562774817, "last_edit_date": 1562777095, "question_id": 56974674, "link": "https://stackoverflow.com/questions/56974674/cannot-create-tree-with-the-proper-structure", "title": "Cannot create tree with the proper structure", "body": "<p>I have a struct with the following structure </p>\n\n<pre><code>type Node struct {\n    Id string,\n    Type string,\n    Children []*Node\n}\n</code></pre>\n\n<p>My input is of the following format </p>\n\n<pre><code>[60566 605 6061],\n[60566 605 6065],\n[60653 606 6109]]\n</code></pre>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n)\n\ntype Node struct {\n    Id       string\n    Type     string\n    Children []*Node\n}\n\nfunc buildFullNode(values []string) Node {\n    bottomNode := Node{\n        Id:   values[2],\n        Type: \"TYPE3\",\n    }\n    middleNode := Node{\n        Id:       values[1],\n        Type:     \"TYPE2\",\n        Children: []*Node{&amp;bottomNode},\n    }\n    rootNode := Node{\n        Id:       values[0],\n        Type:     \"TYPE1\",\n        Children: []*Node{&amp;middleNode},\n    }\n    return rootNode\n}\n\nfunc newNode(id string, providerType string) Node {\n    return Node{\n        Id: id,\n        Type: providerType,\n    }\n}\n\nfunc insertNode(nodes []string, node *Node, types []string, count uint64) *Node {\n\n    if uint64(len(types)) == count {\n        return node\n    }\n    if node.Id == nodes[0] {\n        count++\n        return insertNode(nodes[1:], node,  types, count)\n    } else {\n        newNode := newNode(nodes[0], types[count])\n        node.Children = append(node.Children, &amp;newNode)\n        count++\n        return insertNode(nodes[1:], node, types, count)\n    }\n}\n\nfunc buildNode(values []string, node []*Node) *Node {\n    if len(node) == 0 {\n        rootNode := buildFullNode(values)\n        node = append(node, &amp;rootNode)\n        return node[len(node)-1]\n    } else {\n        var types = []string{\n            \"TYPE1\", \"TYPE2\", \"TYPE3\",\n        }\n        newNode := insertNode(values, node[len(node)-1], types, 0)\n        return newNode\n    }\n}\n\nfunc main() {\n    rootNode := Node{\n        Id: \"\",\n    }\n\n    var nestedSlice = [][]string{\n        {\"60566\", \"605\", \"6056\"},\n        {\"60566\", \"605\", \"6061\"},\n        {\"60566\", \"605\", \"6065\"},\n        {\"60653\", \"606\", \"6109\"},\n    }\n\n    for _, value := range nestedSlice {\n        node := buildNode(value, rootNode.Children)\n        fmt.Println(node)\n    }\n}\n\n</code></pre>\n\n<p>In the end I should have the following tree structure </p>\n\n<pre><code>           nil\n        /      \\\n     60566    60653\n       |        |\n      605      606\n      /\\       |\n   6056 6056  6109\n</code></pre>\n\n<p>I think the problem is that in the first if in insertNode statement I am not returning the full struct but rather the last updated one. Also I am not sure on how to append correctly to the root of the rootNode</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1562773840, "post_id": 56974353, "comment_id": 100485009, "body": "This is not a feature of the go toolchain, as there&#39;s no enforced standard for storing license information. You might be able to guess (i.e. by checking the root for <code>LICENSE.txt</code> or similar), but you&#39;d have to write your own tooling to do that."}], "answers": [{"comments": [{"owner": {"reputation": 751, "user_id": 1489188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d09b01056766ffeae38623aaf89bcc7?s=128&d=identicon&r=PG", "display_name": "Mohan Raj", "link": "https://stackoverflow.com/users/1489188/mohan-raj"}, "edited": false, "score": 2, "creation_date": 1579223699, "post_id": 56975548, "comment_id": 105704030, "body": "Thanks. But isn&#39;t the full dependency graph the one in <code>go.sum</code>? <code>modules.txt</code> seems closer to <code>go.mod</code> which contains (mostly) direct dependencies?"}, {"owner": {"reputation": 647, "user_id": 9773285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95570197a5ef8f4a067a3669c09143?s=128&d=identicon&r=PG&f=1", "display_name": "Mark A", "link": "https://stackoverflow.com/users/9773285/mark-a"}, "reply_to_user": {"reputation": 751, "user_id": 1489188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d09b01056766ffeae38623aaf89bcc7?s=128&d=identicon&r=PG", "display_name": "Mohan Raj", "link": "https://stackoverflow.com/users/1489188/mohan-raj"}, "edited": false, "score": 0, "creation_date": 1579275130, "post_id": 56975548, "comment_id": 105723156, "body": "The purpose of the vendored dependencies is to have a local copy of <i>all</i> dependencies required to build so the vendor directory (and <code>modules.txt</code>) will have all your direct dependencies (from go.mod) plus all transitive dependencies.  As an experiment, I&#39;ve also tried deleting everything cached in my <code>~&#47;go</code> directory and verified that building using the <code>-mod=vendor</code> flag did not need to download anything else."}, {"owner": {"reputation": 2219, "user_id": 8608146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3B2gl.jpg?s=128&g=1", "display_name": "Phani Rithvij", "link": "https://stackoverflow.com/users/8608146/phani-rithvij"}, "edited": false, "score": 0, "creation_date": 1603106297, "post_id": 56975548, "comment_id": 113921790, "body": "It is painfully slow. It took 32 secs on my windows 10 pc for detecting one Apache-2.0 license and it did output <code>100% Apache-2.0</code> correctly. It claims to do it in 13 secs for 1000 repos on the Readme."}], "tags": [], "owner": {"reputation": 647, "user_id": 9773285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95570197a5ef8f4a067a3669c09143?s=128&d=identicon&r=PG&f=1", "display_name": "Mark A", "link": "https://stackoverflow.com/users/9773285/mark-a"}, "is_accepted": true, "score": 5, "last_activity_date": 1562778526, "creation_date": 1562778526, "answer_id": 56975548, "question_id": 56974353, "link": "https://stackoverflow.com/questions/56974353/get-third-party-licences-using-go-get/56975548#56975548", "title": "Get third party licences using go get", "body": "<p>I also had to do this recently and didn't find any \"official\" way of doing it. I used a tool called <code>go-license-detector</code> against my vendored third-party dependencies to automate most of the work.</p>\n\n<ol>\n<li>Install <a href=\"https://github.com/src-d/go-license-detector\" rel=\"noreferrer\">https://github.com/src-d/go-license-detector</a>. This tool scans directories for \nlicense files and determines what license they (probably) are.</li>\n<li>Download the source code for all the third-party library dependencies by running <code>go mod vendor</code>. This places all the source code for your dependencies into a directory named \"vendor\".</li>\n<li><p><code>cd</code> into your vendor directory and run:</p>\n\n<p><code>license-detector `cat modules.txt |grep \"^#\" |cut -d' ' -f2`</code></p></li>\n</ol>\n\n<p>This will run <code>license-detector</code> against each downloaded module and output a list of probable licenses for each module. You'll get output that looks like this:</p>\n\n<pre><code>github.com/influxdata/influxdb\n    91% MIT\ngithub.com/influxdata/platform\n    99% MIT\n    84% MIT-feh\ngithub.com/kr/logfmt\n    100%    Unlicense\n    98% MIT\n    93% JSON\n    84% MIT-feh\n</code></pre>\n\n<p>Usually the top license is the right one but it's best to double-check each one.</p>\n"}], "owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 56975548, "answer_count": 1, "score": 3, "last_activity_date": 1562778526, "creation_date": 1562773628, "last_edit_date": 1592644375, "question_id": 56974353, "link": "https://stackoverflow.com/questions/56974353/get-third-party-licences-using-go-get", "title": "Get third party licences using go get", "body": "<p>Let's say we've got a <code>go.mod</code> file that defines third party dependencies. Is there a feature or a way in the language to get a list of the third party licenses preferably without third party tools? Unfortunately, I can't share any code because I haven't found any potential solutions yet.</p>\n<p>For example we have:</p>\n<pre><code>module github.com/myGoProject\n\nrequire (\n    github.com/sirupsen/logrus v1.4.2\n    github.com/stretchr/testify v1.2.2\n)\n</code></pre>\n<p>How can I get as output:</p>\n<blockquote>\n<p>MIT</p>\n<p>MIT</p>\n</blockquote>\n"}, {"tags": ["go", "fish"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1562766356, "post_id": 56972032, "comment_id": 100480522, "body": "You almost certainly have some kind of shell alias for &quot;go&quot; and you&#39;re running that and not the go executable. Try <code>which go</code>."}, {"owner": {"reputation": 964, "user_id": 6533353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b614dfd7a0f7a1f653d3a267f28a9dd1?s=128&d=identicon&r=PG", "display_name": "CermakM", "link": "https://stackoverflow.com/users/6533353/cermakm"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1562766509, "post_id": 56972032, "comment_id": 100480626, "body": "Thanks for the input, I already mentioned the output of <code>which go</code> in the question:  &gt; &quot;where /usr/local/bin/go is an output of which go in both bash and fish&quot;"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1562767003, "post_id": 56972032, "comment_id": 100480918, "body": "Could this be some kind of alias that is used instead? The error message is an error from the <code>git</code> binary. Take a look in your file <code>~&#47;.config&#47;fish&#47;config.fish</code> and see if you find an alias there. If you do not find anything there look at the files in <code>~&#47;.config&#47;fish&#47;</code> and subfolders."}, {"owner": {"reputation": 964, "user_id": 6533353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b614dfd7a0f7a1f653d3a267f28a9dd1?s=128&d=identicon&r=PG", "display_name": "CermakM", "link": "https://stackoverflow.com/users/6533353/cermakm"}, "reply_to_user": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1562767528, "post_id": 56972032, "comment_id": 100481252, "body": "Oh my ... @mbuechmann completely correct. It was aliased to <code>git checkout</code> (facepalm, 2 hours spent by this thing). I had no idea that the <code>which</code> command does not catch that. Thanks!"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1562768152, "post_id": 56972032, "comment_id": 100481648, "body": "No problem. I&#39;ll add this as an answer then."}], "answers": [{"comments": [{"owner": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "edited": false, "score": 0, "creation_date": 1562769336, "post_id": 56972699, "comment_id": 100482375, "body": "Or see what comes up with <code>type -a go</code>"}], "tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": true, "score": 1, "last_activity_date": 1562768171, "creation_date": 1562768171, "answer_id": 56972699, "question_id": 56972032, "link": "https://stackoverflow.com/questions/56972032/using-go-with-fish-shell/56972699#56972699", "title": "Using `go` with fish shell", "body": "<p>Could this be some kind of alias that is used instead? The error message is an error from the git binary.</p>\n\n<p>Take a look in your file ~/.config/fish/config.fish and see if you find an alias there. If you do not find anything there look at the files in ~/.config/fish/ and subfolders.</p>\n"}], "owner": {"reputation": 964, "user_id": 6533353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b614dfd7a0f7a1f653d3a267f28a9dd1?s=128&d=identicon&r=PG", "display_name": "CermakM", "link": "https://stackoverflow.com/users/6533353/cermakm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 56972699, "answer_count": 1, "score": 0, "last_activity_date": 1562768171, "creation_date": 1562766035, "last_edit_date": 1562766425, "question_id": 56972032, "link": "https://stackoverflow.com/questions/56972032/using-go-with-fish-shell", "title": "Using `go` with fish shell", "body": "<p>I am struggling with running <code>go</code> in the <strong>fish shell</strong>.</p>\n\n<p>A) I followed the installation procedure and installed <code>go</code> as specified in the <a href=\"https://golang.org/doc/install?download=go1.12.7.linux-amd64.tar.gz\" rel=\"nofollow noreferrer\">documentation</a></p>\n\n<p>However, when I run <code>go version</code>, I am getting a fatal error:</p>\n\n<pre><code>fatal: not a git repository (or any parent up to mount point /)\nStopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).\n</code></pre>\n\n<p>When I initialize the git by <code>git init</code>, I receive another error:</p>\n\n<pre><code>error: pathspec 'version' did not match any file(s) known to git\n</code></pre>\n\n<p>I have the paths configured in my fish <strong>config</strong> as follows:</p>\n\n<pre><code>set -gx GOPATH /home/&lt;user&gt;/go\nset -gx PATH $PATH /usr/local/bin/go $GOPATH/bin\n</code></pre>\n\n<p>where <code>/usr/local/bin/go</code> is an output of <code>which go</code> in both <code>bash</code> and <code>fish</code></p>\n\n<p><br></p>\n\n<p>Running it like <code>bash -c 'go version'</code>, however, <strong>works without any problems</strong> (even without the git directory).</p>\n\n<p><br></p>\n\n<p>B) Also tried <code>gofish</code> and <code>dnf</code> to install go, the same results</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<p><br></p>\n\n<p>Additional info:</p>\n\n<ul>\n<li>Fish version: <code>fish, version 3.0.2</code></li>\n<li>Operating system: <code>Linux t460s 5.0.13-300.fc30.x86_64 x86_64 GNU/Linux</code></li>\n</ul>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562764845, "post_id": 56970867, "comment_id": 100479760, "body": "Could you post what error you are getting when your code doesn&#39;t work?"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1562767621, "post_id": 56970867, "comment_id": 100481299, "body": "can you please post a full executable code sample that generates the error? When do you call <code>ConfigDB</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 393, "user_id": 5223002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tmBSX.jpg?s=128&g=1", "display_name": "Eduardo Hitek", "link": "https://stackoverflow.com/users/5223002/eduardo-hitek"}, "is_accepted": true, "score": 1, "last_activity_date": 1562775863, "creation_date": 1562775863, "answer_id": 56974941, "question_id": 56970867, "link": "https://stackoverflow.com/questions/56970867/how-to-use-mongo-driver-connection-into-other-packages/56974941#56974941", "title": "How to use mongo-driver connection into other packages", "body": "<p>You'll have to import to import the db/connect.go file into the handler/task.go. This is not working because they are in different packages.\nIn my opinion you could refactor your code like this</p>\n\n<pre><code>func ConfigDB() (*mongo.Database) {\n    ctx := context.Background()\n    client, err := mongo.Connect(\n            ctx,\n        options.Client().ApplyURI(\"mongodb://localhost:27017/todo\"),\n    )\n    if err != nil {\n        log.Fatal(err)\n    }\n    return client.Database(\"todo\")\n\n}\n\nimport (\n\"db/connect\"\n)\n\nfunc CreateTask() () {\n    ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\n    defer cancel()\n    res, err := ConfigDB().Collection(\"test\").InsertOne(ctx, bson.D{\n        {\"task\", \"test4\"},\n        {\"createdAt\", \"test\"},\n        {\"modifiedAt\",\"test3\"},\n    })\n    if err != nil {\n        fmt.Println( err))\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "edited": false, "score": 0, "creation_date": 1562899555, "post_id": 56978884, "comment_id": 100532509, "body": "This is done using mgo Can you suggest same with mongo-driver Bcoz mgo community stops support for mgo  New feature ie srv is not working with mgo"}, {"owner": {"reputation": 43, "user_id": 6088841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pKBMYc2VCNI/AAAAAAAAAAI/AAAAAAAAAKA/5xPhBCZ3RYE/photo.jpg?sz=128", "display_name": "Shakhawat Hossain", "link": "https://stackoverflow.com/users/6088841/shakhawat-hossain"}, "reply_to_user": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "edited": false, "score": 0, "creation_date": 1562951890, "post_id": 56978884, "comment_id": 100555515, "body": "The mgo has a community edition <a href=\"https://github.com/globalsign/mgo\" rel=\"nofollow noreferrer\">github.com/globalsign/mgo</a> . Unfortunately, the community has no activity after 2018. The best I suggest to use MongoDB official mongo go driver <a href=\"https://github.com/mongodb/mongo-go-driver\" rel=\"nofollow noreferrer\">github.com/mongodb/mongo-go-driver</a>. I will update my answer when I get time using this library. Thanks"}], "tags": [], "owner": {"reputation": 43, "user_id": 6088841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pKBMYc2VCNI/AAAAAAAAAAI/AAAAAAAAAKA/5xPhBCZ3RYE/photo.jpg?sz=128", "display_name": "Shakhawat Hossain", "link": "https://stackoverflow.com/users/6088841/shakhawat-hossain"}, "is_accepted": false, "score": 0, "last_activity_date": 1562794060, "creation_date": 1562794060, "answer_id": 56978884, "question_id": 56970867, "link": "https://stackoverflow.com/questions/56970867/how-to-use-mongo-driver-connection-into-other-packages/56978884#56978884", "title": "How to use mongo-driver connection into other packages", "body": "<p>Here I post a complete working example.\nI catch the mongo session connection in a global variable. So that, anywhere in the project you can access the active connection.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/gin-gonic/gin\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\n// SESSION ensure global mongodb connection\nvar SESSION *mgo.Session\n\nfunc init() {\n    // mongodb manual connection using host ip. Replace your host IP address there\n    session, err := mgo.Dial(\"172.17.0.2\")\n    // session, err := mgo.Dial(\"&lt;HostIP&gt;\")\n    Must(err)\n    fmt.Println(err)\n    SESSION = session\n}\n\nfunc main() {\n\n    port := os.Getenv(\"PORT\")\n    gin.SetMode(gin.ReleaseMode)\n    // gin.SetMode(gin.DebugMode)\n    r := gin.Default()\n    r.Use(mapMongo)\n\n    if port == \"\" {\n        port = \"8000\"\n    }\n    r.POST(\"/api/v1/task\", CreateTask)\n\n    http.ListenAndServe(\":\"+port, r)\n\n}\n\n// close connection\nfunc mapMongo(c *gin.Context) {\n    s := SESSION.Clone()\n    defer s.Close()\n    c.Set(\"mongo\", s.DB(\"mongotask\"))\n    c.Next()\n}\n\n// Must to catch the mongo panic issues\nfunc Must(err error) {\n    if err != nil {\n        panic(err.Error())\n    }\n}\n\n// NewTask Struct/model\ntype NewTask struct {\n    Id   bson.ObjectId `json:\"_id,omitempty\" bson:\"_id,omitempty\"`\n    Task string\n}\n\n// Mongo bson generate New unique Id each request\nfunc (self *NewTask) Init() {\n    self.Id = bson.NewObjectId()\n}\n\nconst (\n    // CollectionTask is the collection name\n    CollectionTask = \"taskCollection\"\n)\n\n// CreateTask to create new Task message\nfunc CreateTask(c *gin.Context) {\n    var newTask NewTask\n    err := c.BindJSON(&amp;newTask)\n    if err != nil {\n        c.Error(err)\n        return\n    }\n    mongodb := c.MustGet(\"mongo\").(*mgo.Database)\n    con := mongodb.C(CollectionTask)\n    // fmt.Println(newTask)\n    con.Insert(newTask)\n    if err != nil {\n        c.Error(err)\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1202, "favorite_count": 0, "accepted_answer_id": 56974941, "answer_count": 2, "score": 1, "last_activity_date": 1567704520, "creation_date": 1562762204, "last_edit_date": 1567704520, "question_id": 56970867, "link": "https://stackoverflow.com/questions/56970867/how-to-use-mongo-driver-connection-into-other-packages", "title": "How to use mongo-driver connection into other packages", "body": "<p>I am using <code>Mongo-driver</code> with gin framework. I have written code to connect mongodb in DB package and if I write query inside <code>db/connect.go</code>, it works but when I use same <code>dbcon</code> in other package it doesn't. </p>\n\n<p><strong>db/connect.go:</strong></p>\n\n<pre><code>var dbcon *mongo.Database\nfunc ConfigDB() (*mongo.Database) {\n    ctx := context.Background()\n    client, err := mongo.Connect(\n            ctx,\n        options.Client().ApplyURI(\"mongodb://localhost:27017/todo\"),\n    )\n    if err != nil {\n        log.Fatal(err)\n    }\n    dbcon = client.Database(\"todo\")\n\n}\n</code></pre>\n\n<p>if I use the code below in same db/connect.go, then it works but when I use the same code in handler/task.go, then it won't.</p>\n\n<pre><code>func CreateTask() () {\n    ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\n    defer cancel()\n    res, err := dbcon.Collection(\"ttest\").InsertOne(ctx, bson.D{\n        {\"task\", \"test4\"},\n        {\"createdAt\", \"test\"},\n        {\"modifiedAt\",\"test3\"},\n    })\n    if err != nil {\n        fmt.Println( err))\n    }\n}\n</code></pre>\n\n<p>I have to implement a <code>mongo-driver</code> in my project, but due to above issue I am facing problem to implement.</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1562764737, "post_id": 56970850, "comment_id": 100479697, "body": "Close the channel when all senders are complete. The fact that you needed a <code>sync.Once</code> to close the channel should be an indication it&#39;s in the wrong place. You also have a data race, always check with the race detector."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562766093, "post_id": 56970850, "comment_id": 100480388, "body": "You have multiple goroutines all sending on <code>intChan</code>. They can&#39;t all close it. Senders sharing a channel need to wait until <i>all senders are finished sending</i> before closing."}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1562794061, "creation_date": 1562794061, "answer_id": 56978885, "question_id": 56970850, "link": "https://stackoverflow.com/questions/56970850/why-still-go-panic-send-on-closed-channel-when-i-close-on-sender-side/56978885#56978885", "title": "Why still Go panic &quot;send on closed channel&quot; when I close on sender side?", "body": "<p><code>go</code> concurrency is very powerful. Coordinating concurrency is <em>very</em> <em>hard</em>. Fortunately the <code>go</code> standard library has many tools to help with this. You should probably familiarize yourself with the <code>context</code> package.</p>\n\n<p><code>context.Context</code> use done-channels under the covers (similar to your <code>stopChan</code>) but have other mechanisms like cancelation chaining. They are also used throughout the <code>go</code> standard library for http, database and other blocking-type requests.</p>\n\n<p>As @JimB has mentioned, usually <code>sync.Once</code> are rarely needed when coordinating producer/consumers. <code>chan</code>s and <code>sync.WaitGroup</code>s are usually enough.</p>\n\n<p>Anyway, here's the coordination fix to your code using <code>context.Context</code>:</p>\n\n<p><a href=\"https://play.golang.org/p/QwszE_bW41X\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QwszE_bW41X</a></p>\n"}], "owner": {"reputation": 43, "user_id": 10685711, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gOSHyYctXTI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j8wMXIl57UrRkc04n8A7KC3ASBcg/mo/photo.jpg?sz=128", "display_name": "xdk", "link": "https://stackoverflow.com/users/10685711/xdk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1785, "favorite_count": 0, "accepted_answer_id": 56978885, "answer_count": 1, "score": -1, "last_activity_date": 1562794061, "creation_date": 1562762155, "last_edit_date": 1562764998, "question_id": 56970850, "link": "https://stackoverflow.com/questions/56970850/why-still-go-panic-send-on-closed-channel-when-i-close-on-sender-side", "title": "Why still Go panic &quot;send on closed channel&quot; when I close on sender side?", "body": "<p>I have a <code>stopChan</code> to notify senders to close channel and a <code>sync.Once</code> to make sure only one sender can close the channel, but I still get a \"send on closed channel\" panic, why? </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func muitiSenderClose() {\n    const SenderNum = 3\n\n    wg := sync.WaitGroup{}\n    wg.Add(SenderNum)\n\n    intChan := make(chan int)\n\n    stopChan := make(chan struct{})\n\n    once := sync.Once{}\n    for i := 0; i &lt; SenderNum; i++ {\n        go func(i int) {\n            defer wg.Done()\n            needStop := false\n            for {\n                select {\n                case &lt;-stopChan:\n                    needStop = true\n                case intChan &lt;- 1:\n                case intChan &lt;- 2:\n                case intChan &lt;- 3:\n                }\n\n                if needStop {\n                    break\n                }\n            }\n            once.Do(func() {\n                fmt.Printf(\"%d want to close chan\\n\",i)\n                close(intChan)\n            })\n            fmt.Println(\"End. [sender] %id\", i)\n        }(i)\n    }\n    sum := 0\n    for e := range intChan {\n        fmt.Printf(\"Receive %d\\n\", e)\n        sum += e\n        if sum &gt; 10 {\n            close(stopChan)\n            fmt.Printf(\"Got %d\\n\", sum)\n            break\n        }\n    }\n    fmt.Println(\"End. [receiver]\")\n\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "html", "go", "button"], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "edited": false, "score": 0, "creation_date": 1562806719, "post_id": 56979355, "comment_id": 100496451, "body": "Hi, this looks like it works, thanks very much.  I&#39;ll just play with it a bit more and make sure it works for sure, then mark it as the answer. Cheers."}], "tags": [], "owner": {"reputation": 5145, "user_id": 987704, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/9nXwn.jpg?s=128&g=1", "display_name": "LIGHT", "link": "https://stackoverflow.com/users/987704/light"}, "is_accepted": true, "score": 1, "last_activity_date": 1562797153, "creation_date": 1562797153, "answer_id": 56979355, "question_id": 56970054, "link": "https://stackoverflow.com/questions/56970054/disable-button-call-server-then-re-enable-button/56979355#56979355", "title": "Disable Button Call Server then Re-enable Button", "body": "<p>Since you're saying you want to disable the submit button once the button is clicked. And you're also saying you want the page to refresh while the form is being submitted.</p>\n\n<pre><code>&lt;form action=\"\" method=\"post\" onsubmit=\"subBtn.disabled = true; return true;\"&gt;\n    &lt;input type=\"submit\" name=\"subBtn\" value=\"submit\"/&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>In the code above, when <code>&lt;form&gt;</code> is submitted, <code>&lt;input&gt;</code> field named <code>subBtn</code> is disabled and <code>true</code> is returned for <code>&lt;form&gt;</code> to continue the submission process. Once the page is reloaded, the button goes to its original state, which is <code>enabled</code>.</p>\n\n<hr>\n\n<p>I am not sure whats going on the code down there or how/when is <code>getTime()</code> function executed, but <code>return true;</code> might just submit the form.</p>\n\n<pre><code>&lt;script&gt;\nfunction getTime() {\n    $(\"#updateButton\").prop(\"disabled\", true);\n    return true; // this to continue with the original &lt;form&gt; process\n}\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 3015449, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/csGZm.gif?s=128&g=1", "display_name": "davo36", "link": "https://stackoverflow.com/users/3015449/davo36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56979355, "answer_count": 1, "score": 0, "last_activity_date": 1562797153, "creation_date": 1562759131, "last_edit_date": 1562795185, "question_id": 56970054, "link": "https://stackoverflow.com/questions/56970054/disable-button-call-server-then-re-enable-button", "title": "Disable Button Call Server then Re-enable Button", "body": "<p>I've seen many similar questions to mine, but have spent a few hours browsing and can't find the answer to my situation.</p>\n\n<p>I have a Go based web-server.  I have an HTML template page that lets me update the hardware clock and system clock on a 'nix system with the current browser time:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PX2R6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PX2R6.png\" alt=\"enter image description here\"></a></p>\n\n<p>The update button is of type submit and calls the Go code which makes some system calls which take a few seconds, and I can't have this server code being called twice whilst it's still processing the first request. </p>\n\n<p>So I want to disable the update button and then re-enable it once the server has responded.</p>\n\n<p>I have jQuery, so I know I can have a function that is called via `onclick' and make these calls:</p>\n\n<pre><code>$(\"#updateButton\").prop(\"disabled\", true);\n$(\"#updateButton\").prop(\"disabled\", false);\n</code></pre>\n\n<p>I have the form being submitted via the button (and not a jQuery call for instance - although I'm all ears) because I want the form to refresh when the server responds.  So I have this:</p>\n\n<pre><code>&lt;form action=\"/clock\" method=\"POST\"&gt;\n    ...\n&lt;/form&gt;\n</code></pre>\n\n<p>This is so some values on the page get updated. Such as the status message at the top and the values in the various fields (updated to the values actually set).</p>\n\n<p>The first problem I have is that if I call a JS function on the button click, and it disables the button as per above, then my server code doesn't get called!  I have no idea why - could this be stopping the post request somehow?</p>\n\n<pre><code>&lt;script&gt;\nfunction getTime() {\n    // Disable update button while waiting for response\n    $(\"#updateButton\").prop(\"disabled\", true); // Stops post request???\n\n    // How to re-enable update button?\n\n}\n&lt;/script&gt;\n</code></pre>\n\n<p>And secondly, how do I re-enable the button?  I don't know how to tell when the server has responded.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 2, "creation_date": 1562758706, "post_id": 56969469, "comment_id": 100476263, "body": "Your question doesn&#39;t seem to include all the code.  You are calling time.Parse and you should be calling time.Unix"}], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 9957458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YonLx.jpg?s=128&g=1", "display_name": "Radu Ciurlea", "link": "https://stackoverflow.com/users/9957458/radu-ciurlea"}, "is_accepted": true, "score": 1, "last_activity_date": 1562764962, "creation_date": 1562764962, "answer_id": 56971697, "question_id": 56969469, "link": "https://stackoverflow.com/questions/56969469/using-json-unmarshal-gives-parseerror-when-trying-to-convert-unix-formatted-stri/56971697#56971697", "title": "Using json.Unmarshal gives ParseError when trying to convert unix formatted string into time.Time", "body": "<p>You can declare your own time type and make that implement json.Unmarshaller, e.g. something like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"strconv\"\n    \"time\"\n)\n\nvar data = []byte(`{\"timestamp\": 1562764768}`)\n\ntype myTime time.Time\n\nfunc (mt *myTime) UnmarshalJSON(b []byte) error {\n    timestamp, err := strconv.ParseInt(string(b), 10, 64)\n    if err != nil {\n        return err\n    }\n    *mt = myTime(time.Unix(timestamp, 0))\n    return nil\n}\n\nfunc (mt *myTime) String() string {\n    return time.Time(*mt).String()\n}\n\ntype body struct {\n    Timestamp *myTime `json:\"timestamp\"`\n}\n\nfunc main() {\n    var b body\n    err := json.Unmarshal(data, &amp;b)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%+v\\n\", b)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/zb6lQP361J5\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56971697, "answer_count": 1, "score": -3, "last_activity_date": 1562768540, "creation_date": 1562757091, "last_edit_date": 1592644375, "question_id": 56969469, "link": "https://stackoverflow.com/questions/56969469/using-json-unmarshal-gives-parseerror-when-trying-to-convert-unix-formatted-stri", "title": "Using json.Unmarshal gives ParseError when trying to convert unix formatted string into time.Time", "body": "<p>I have a <code>JSON</code> file with following content:</p>\n<pre><code>{  ...\n   &quot;body&quot;: &quot;{\\&quot;timestampFrom\\&quot;:\\&quot;154087600\\&quot;}&quot;\n   ...\n}\n</code></pre>\n<p>When I try to execute:</p>\n<pre><code>if err := json.Unmarshal([]byte(apiGatewayEvent.Body), &amp;config); err != nil {\n            glog.Errorf(&quot;Error occurred while trying to unmarshal body of APIGatewayProxyRequest. Error message - %v&quot;, err)\n            return nil, err\n        }\n</code></pre>\n<p>I receive:</p>\n<blockquote>\n<p>Error occurred while trying to unmarshal body of APIGatewayProxyRequest.</p>\n<p>Error message - parsing time &quot;&quot;1540857600&quot;&quot; as &quot;&quot;2006-01-02T15:04:05Z07:00&quot;&quot;: cannot parse &quot;857600&quot;&quot; as &quot;-&quot;</p>\n</blockquote>\n<p>Thing is that I always will receive UNIX formatted input and I need to convert it to <code>time.Time</code>. How do I exactly do that?</p>\n"}, {"tags": ["go", "heroku"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562755773, "post_id": 56968852, "comment_id": 100474762, "body": "Try the previous exact revision: <code>go 1.12.6</code>"}, {"owner": {"reputation": 79, "user_id": 9306756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e36433c2afa70cd0c2289d9d58b6712?s=128&d=identicon&r=PG&f=1", "display_name": "Cage fighter", "link": "https://stackoverflow.com/users/9306756/cage-fighter"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562756036, "post_id": 56968852, "comment_id": 100474905, "body": "If i change &quot;go 1.12&quot; in &quot;go 1.12.6&quot; in the go.mod file, it doesn&#39;t change anything. It seems that it&#39;s not the correct way to set Go version. Because I get: <code>The go.mod file for this project does not specify a Go version</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562756183, "post_id": 56968852, "comment_id": 100474984, "body": "Without Go modules, you can set Go version by adding a <code>GOVERSION</code> environment variable (heroku Settings page). Try adding <code>GOVERSION=go1.12.6</code>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1562759707, "last_edit_date": 1562759707, "creation_date": 1562756420, "answer_id": 56969275, "question_id": 56968852, "link": "https://stackoverflow.com/questions/56968852/specify-go-version-for-go-mod-file/56969275#56969275", "title": "Specify Go version for go.mod file", "body": "<p>You can set the Go version to be used by adding a <code>GOVERSION</code> environment variable. You can do this on the Heroku Settings page of your project.</p>\n\n<p>You may set the previous (working) revision by adding <code>GOVERSION=go1.12.6</code>.</p>\n\n<p>This is documented at <a href=\"https://devcenter.heroku.com/articles/go-support#go-versions\" rel=\"nofollow noreferrer\">Heroku Go Support: Go versions</a>:</p>\n\n<blockquote>\n  <p>If you need to select a specific minor revision (e.x. go1.8.7) for any reason you will need to hand edit the appropriate metadata file or set the <code>$GOVERSION</code> environment variable...</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 253, "user_id": 2620553, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fAVEV.jpg?s=128&g=1", "display_name": "Rahul Bali", "link": "https://stackoverflow.com/users/2620553/rahul-bali"}, "edited": false, "score": 0, "creation_date": 1614532910, "post_id": 63857618, "comment_id": 117408302, "body": "saved my day... so much time wasted, for lack of documentation."}], "tags": [], "owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "is_accepted": false, "score": 14, "last_activity_date": 1599892984, "creation_date": 1599892984, "answer_id": 63857618, "question_id": 56968852, "link": "https://stackoverflow.com/questions/56968852/specify-go-version-for-go-mod-file/63857618#63857618", "title": "Specify Go version for go.mod file", "body": "<p>You could add a directive <code>// +heroku goVersion go1.11</code> in your <code>go.mod</code> file.</p>\n<pre><code>module somemodule\n\n// +heroku goVersion go1.11\ngo 1.11\n\nrequire (\n    // ...\n)\n</code></pre>\n<p>Then it should look like this.</p>\n<pre><code>remote:        Detected go modules via go.mod\nremote: -----&gt;\nremote:        Detected Module Name: somemodule\nremote: -----&gt;\nremote: -----&gt; New Go Version, clearing old cache\nremote: -----&gt; Installing go1.11\n</code></pre>\n<p>Documentation: <a href=\"https://github.com/heroku/heroku-buildpack-go#go-module-specifics\" rel=\"noreferrer\">https://github.com/heroku/heroku-buildpack-go#go-module-specifics</a></p>\n<blockquote>\n<h2>Go Module Specifics</h2>\n<p>You can specify specific package spec(s) via the <code>go.mod</code> file's <code>// +heroku install</code> directive (see below).</p>\n<p><code>// +heroku goVersion &lt;version&gt;</code>: the major version of go you would\nlike Heroku to use when compiling your code. If not specified this\ndefaults to the buildpack's [DefaultVersion].</p>\n</blockquote>\n"}], "owner": {"reputation": 79, "user_id": 9306756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e36433c2afa70cd0c2289d9d58b6712?s=128&d=identicon&r=PG&f=1", "display_name": "Cage fighter", "link": "https://stackoverflow.com/users/9306756/cage-fighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2949, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1599892984, "creation_date": 1562754839, "last_edit_date": 1562765015, "question_id": 56968852, "link": "https://stackoverflow.com/questions/56968852/specify-go-version-for-go-mod-file", "title": "Specify Go version for go.mod file", "body": "<p>I am deploying an application through Heroku.\nI do <code>git push heroku master</code></p>\n\n<p>And I get this error:</p>\n\n<pre><code>remote: Compressing source files... done.\nremote: Building source:\nremote:\nremote: -----&gt; Go app detected\nremote: -----&gt; Fetching stdlib.sh.v8... done\nremote: -----&gt;\nremote:        Detected go modules via go.mod\nremote: -----&gt;\nremote:        Detected Module Name: go-getting-started\nremote: -----&gt;\nremote:  !!    The go.mod file for this project does not specify a Go version\nremote:  !!\nremote:  !!    Defaulting to go1.12.7\nremote:  !!\nremote:  !!    For more details see: https://devcenter.heroku.com/articles/go-a\nps-with-modules#build-configuration\nremote:  !!\nremote: -----&gt; New Go Version, clearing old cache\nremote: -----&gt; Installing go1.12.7\nremote: -----&gt; Fetching go1.12.7.linux-amd64.tar.gz...\nremote: gzip: stdin: not in gzip format\nremote: tar: Child returned status 1\nremote: tar: Error is not recoverable: exiting now\nremote:  !     Push rejected, failed to compile Go app.\nremote:\nremote:  !     Push failed\nremote: Verifying deploy...\nremote:\nremote: !       Push rejected to autoattack.\n</code></pre>\n\n<p>I think it's a problem with the new Go version and for this reason I want to use a previous one.</p>\n\n<p>This is my go.mod file:</p>\n\n<pre><code>module go-getting-started\n\ngo 1.12\n\n...\n\n</code></pre>\n\n<p>I tried to change <code>go 1.12</code> to <code>go 1.11</code> but it doesn't work.</p>\n"}, {"tags": ["go", "cryptography", "sha1", "sha256", "rclone"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1562758158, "post_id": 56968274, "comment_id": 100475994, "body": "<a href=\"https://github.com/ncw/rclone/issues/1810\" rel=\"nofollow noreferrer\">github.com/ncw/rclone/issues/1810</a> references this issue.  As you haven&#39;t given a complete minimal example showing this problem, I am going to vote to close and suggest you rely on the project&#39;s bug tracking"}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1562767429, "post_id": 56968274, "comment_id": 100481187, "body": "It&#39;s also not a programming question in any way."}], "answers": [{"tags": [], "owner": {"reputation": 2075, "user_id": 887934, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/dc7c01a462ab39109c8cf9577329a9a0?s=128&d=identicon&r=PG", "display_name": "fuyi", "link": "https://stackoverflow.com/users/887934/fuyi"}, "is_accepted": true, "score": 1, "last_activity_date": 1562915838, "creation_date": 1562915838, "answer_id": 57001951, "question_id": 56968274, "link": "https://stackoverflow.com/questions/56968274/config-rclone-to-support-diffie-hellman-group-exchange-sha256-diffie-hellman-gro/57001951#57001951", "title": "config rclone to support diffie-hellman-group-exchange-sha256 diffie-hellman-group-exchange-sha1", "body": "<p>We have managed to opt-in those algorithms support and submitted a PR here: <a href=\"https://github.com/ncw/rclone/pull/3341\" rel=\"nofollow noreferrer\">https://github.com/ncw/rclone/pull/3341</a></p>\n\n<p>Note: since those algorithms are considered insecure, your also need to use the exisiting rclone flag <code>--sftp-use-insecure-cipher</code> to make them available for SSH handshake.</p>\n"}], "owner": {"reputation": 2075, "user_id": 887934, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/dc7c01a462ab39109c8cf9577329a9a0?s=128&d=identicon&r=PG", "display_name": "fuyi", "link": "https://stackoverflow.com/users/887934/fuyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 2, "accepted_answer_id": 57001951, "answer_count": 1, "score": 1, "last_activity_date": 1562915838, "creation_date": 1562752876, "last_edit_date": 1562772406, "question_id": 56968274, "link": "https://stackoverflow.com/questions/56968274/config-rclone-to-support-diffie-hellman-group-exchange-sha256-diffie-hellman-gro", "title": "config rclone to support diffie-hellman-group-exchange-sha256 diffie-hellman-group-exchange-sha1", "body": "<p>Some quick background. I use <code>rclone</code> to transfer data to a SFTP server.  rclone is written in Golang and uses lib <code>crypto</code> under the hood. When we try to establish ssh connection to SFTP server, we get the error message </p>\n\n<blockquote>\n  <p>couldn't connect SSH: ssh: handshake failed: ssh: no common algorithm\n  for key exchange; client offered: [curve25519-sha256@libssh.org\n  ecdh-sha2-nistp256 ecdh-sha2-nistp384 ecdh-sha2-nistp521\n  diffie-hellman-group14-sha1 diffie-hellman-group1-sha1], server\n  offered: [diffie-hellman-group-exchange-sha256\n  diffie-hellman-group-exchange-sha1].</p>\n</blockquote>\n\n<p><code>crypto</code> lib has added the support for <code>diffie-hellman-group-exchange-sha256 diffie-hellman-group-exchange-sha1</code> around 3 weeks ago, but needs to be opt-in. (See <a href=\"https://github.com/golang/crypto/commit/57b3e21c3d5606066a87e63cfe07ec6b9f0db000\" rel=\"nofollow noreferrer\">https://github.com/golang/crypto/commit/57b3e21c3d5606066a87e63cfe07ec6b9f0db000</a>)</p>\n\n<p>Obviously, the latest rclone version hasn\u2019t opt-in those algorithms support yet. So the question is: Anyone know how to config rclone to opt-in algorithm support for <code>diffie-hellman-group-exchange-sha256 diffie-hellman-group-exchange-sha1</code></p>\n"}, {"tags": ["go", "google-cloud-platform"], "comments": [{"owner": {"reputation": 563, "user_id": 10138004, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TMCqlmHNIqA/AAAAAAAAAAI/AAAAAAAAALQ/GvxaLDlx5yQ/photo.jpg?sz=128", "display_name": "ShailyAggarwal", "link": "https://stackoverflow.com/users/10138004/shailyaggarwal"}, "edited": false, "score": 0, "creation_date": 1562840252, "post_id": 56967043, "comment_id": 100508334, "body": "I was able to do an existence check for image using: <a href=\"https://gcr.io/v2/&lt;project&gt;/&lt;image&gt;/manifests/&lt;tag\" rel=\"nofollow noreferrer\">gcr.io/v2/&lt;project&gt;/&lt;image&gt;/manifests/&lt;tag</a>&gt; But not vulnerability scan."}], "owner": {"reputation": 563, "user_id": 10138004, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TMCqlmHNIqA/AAAAAAAAAAI/AAAAAAAAALQ/GvxaLDlx5yQ/photo.jpg?sz=128", "display_name": "ShailyAggarwal", "link": "https://stackoverflow.com/users/10138004/shailyaggarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562749014, "creation_date": 1562749014, "question_id": 56967043, "link": "https://stackoverflow.com/questions/56967043/vulnerability-scan-on-an-existing-image-using-tag-information", "title": "Vulnerability scan on an existing image using tag information", "body": "<p>I need to check if an image exists in Gcp container registry before doing any further operation. So far, I was able to find the following API from <a href=\"https://cloud.google.com/container-registry/docs/get-image-vulnerabilities\" rel=\"nofollow noreferrer\">https://cloud.google.com/container-registry/docs/get-image-vulnerabilities</a>:</p>\n\n<pre><code>GET https://containeranalysis.googleapis.com/v1beta1/projects/PROJECT_ID/occurrences?filter=kind%3D%22DISCOVERY%22%20AND%20resourceUrl%3D%22ENCODED_RESOURCE_URL%22\n</code></pre>\n\n<p>which lists the images matching the criteria. But I don't have the information required in the criteria. Information I have is:\n<code>commit_id, build_id, image_id and tags</code>. </p>\n\n<p>Is there any other API or any other way which can help me in vulnerability scanning of an image using the information I have?</p>\n"}, {"tags": ["go", "concurrency", "goroutine", "channels"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1562756263, "post_id": 56966124, "comment_id": 100475037, "body": "<a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">&quot;If one or more of the communications can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection.&quot;</a> The send on rc can verly likely proceed since there is a matching receive in main. Your program simply isn&#39;t deterministic."}, {"owner": {"reputation": 189, "user_id": 3764392, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/741c8ea1b53b56e450a377fd79d71e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3764392/adam"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1562758963, "post_id": 56966124, "comment_id": 100476402, "body": "@Peter I dont quite understand, how could rc proceed while the sleep is longer than the timeout? Also, what do you mean by it is not simply deterministic?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1562766130, "post_id": 56966124, "comment_id": 100480403, "body": "@Adam Your &quot;timeout&quot; doesn&#39;t time anything out. You <i>always</i> wait for the sleep to complete and then check if some time ago a &quot;timeout&quot; occurred; you do that check in the same step that sees if a result can be sent. Both will be possible and the choice of which to do is complete arbitrary.  This isn&#39;t how you do timeouts in Go."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 3764392, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/741c8ea1b53b56e450a377fd79d71e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3764392/adam"}, "edited": false, "score": 0, "creation_date": 1562759860, "post_id": 56967083, "comment_id": 100476939, "body": "If it is actually the reason, I don&#39;t think that it would take more time than the sleep."}, {"owner": {"reputation": 3374, "user_id": 1063250, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50ce9a9e3c79bf98919e99a96de7b05c?s=128&d=identicon&r=PG", "display_name": "Abhijit-K", "link": "https://stackoverflow.com/users/1063250/abhijit-k"}, "reply_to_user": {"reputation": 189, "user_id": 3764392, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/741c8ea1b53b56e450a377fd79d71e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3764392/adam"}, "edited": false, "score": 0, "creation_date": 1562782815, "post_id": 56967083, "comment_id": 100489257, "body": "As Peter mentioned <code>rc &lt;- &quot;success&quot;</code> is something which also is also equally qualified event for the <code>select </code> against the expired timer. I did not realize that. <code>select</code> call on 1) expired timer OR 2) writing &quot;success&quot; to a channel that can be read from the other end, are 2 equally competing event."}], "tags": [], "owner": {"reputation": 3374, "user_id": 1063250, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50ce9a9e3c79bf98919e99a96de7b05c?s=128&d=identicon&r=PG", "display_name": "Abhijit-K", "link": "https://stackoverflow.com/users/1063250/abhijit-k"}, "is_accepted": false, "score": -1, "last_activity_date": 1562824411, "last_edit_date": 1562824411, "creation_date": 1562749108, "answer_id": 56967083, "question_id": 56966124, "link": "https://stackoverflow.com/questions/56966124/golang-intermittent-behaviour-on-timed-out-goroutine/56967083#56967083", "title": "Golang intermittent behaviour on timed out Goroutine", "body": "<p>The doc mentions:</p>\n\n<blockquote>\n  <p>NewTimer creates a new Timer that will send the current time on its\n  channel after <strong>at least duration d</strong>.</p>\n</blockquote>\n\n<p>\"at least means\" timer will take specified time for sure, however this also implicitly means can take more time than specified. Timer starts its own go routine and write to channel on expiry.\nBecause of scheduler or garbage collection or processes of writing to other channel can get delayed. Besides simulated work load is very short considering above possibilities.</p>\n\n<p><strong>Update</strong>:</p>\n\n<p>As Peter mentioned in comment writing \"success\" to rc channel is action which is equally likely to complete because that can be read from the other end by main routine. The select has to choose between 1) writing \"success\" to rc channel &amp; 2) expired timer. And both are possible.\nThe likelihood of No1 is more in the beginning because the main routine is yet to read it from other end. Once that happens. Other remaining routines will have to <strong>compete</strong> for the channel (to write \"success\") (since it is blocking with buffer size 0) so for rest of the times the likelihood of expired timer getting selected is more as cannot say how fast the main routine will read from the resultChan channel (other end of rc). </p>\n"}], "owner": {"reputation": 189, "user_id": 3764392, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/741c8ea1b53b56e450a377fd79d71e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3764392/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562824411, "creation_date": 1562745938, "last_edit_date": 1562746519, "question_id": 56966124, "link": "https://stackoverflow.com/questions/56966124/golang-intermittent-behaviour-on-timed-out-goroutine", "title": "Golang intermittent behaviour on timed out Goroutine", "body": "<p>I am trying to implement concurrency for repetitive task. I want to implement an http request on a different Goroutine (pictured by <code>longRunningTask</code> function). I provide a timer for a mechanism to stop the Goroutine and sends a timeout signal to the main Goroutine if the heavy load task proceed the predefined timeout. The problem that I currently have is that I am getting intermittent behaviour. </p>\n\n<p>The code has been simplified to look like below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    var iteration int = 5\n\n    timeOutChan := make(chan struct{})\n    resultChan := make(chan string)\n\n    for i := 0; i &lt; iteration; i++ {\n        go longRunningTaks(timeOutChan, resultChan)\n    }\n\n    for i := 0; i &lt; iteration; i++ {\n        select {\n        case data := &lt;-resultChan:\n            fmt.Println(data)\n        case &lt;-timeOutChan:\n            fmt.Println(\"timed out\")\n        }\n    }\n\n}\n\nfunc longRunningTaks(tc chan struct{}, rc chan string) {\n    timer := time.NewTimer(time.Nanosecond * 1)\n    defer timer.Stop()\n\n    // Heavy load task\n    time.Sleep(time.Second * 1)\n\n    select {\n    case &lt;-timer.C:\n        tc &lt;- struct{}{}\n    case rc &lt;- \"success\":\n        return\n    }\n}\n</code></pre>\n\n<p>I believe every tries should be printing out</p>\n\n<pre><code>timeout\ntimeout\ntimeout\ntimeout\ntimeout\n</code></pre>\n\n<p>Instead I got an intermittent </p>\n\n<pre><code>success\ntimeout\ntimeout\ntimeout\ntimeout\n</code></pre>\n"}, {"tags": ["json", "go", "exec"], "comments": [{"owner": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 0, "creation_date": 1562745188, "post_id": 56965686, "comment_id": 100468819, "body": "What is that OS() function doing actually? You can use   <code>runtime.GOOS</code> for checking the OS type."}, {"owner": {"reputation": 19, "user_id": 10673761, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MxRArf_tO1w/AAAAAAAAAAI/AAAAAAAAAAc/w4r8sho4IEE/photo.jpg?sz=128", "display_name": "M\u1ea1nh Linh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/10673761/m%e1%ba%a1nh-linh-nguy%e1%bb%85n"}, "reply_to_user": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 0, "creation_date": 1562745517, "post_id": 56965686, "comment_id": 100468985, "body": "Yep. this is runtime.GOOS  ``` // OS Function: func OS() (os string) {  \tswitch goos := runtime.GOOS; goos { \tcase &quot;darwin&quot;: \t\tos = &quot;macOS X&quot; \tcase &quot;windows&quot;: \t\tos = &quot;Windows&quot; \tcase &quot;linux&quot;: \t\tos = &quot;Linux&quot; \tdefault: \t\tos = &quot;unknown&quot; \t}  \treturn os } ```"}, {"owner": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 0, "creation_date": 1562746268, "post_id": 56965686, "comment_id": 100469380, "body": "If it returns a map, use json.Marshal to convert it to JSON. You mean stdout returns a map on Windows? I can&#39;t test it on Windows."}, {"owner": {"reputation": 19, "user_id": 10673761, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MxRArf_tO1w/AAAAAAAAAAI/AAAAAAAAAAc/w4r8sho4IEE/photo.jpg?sz=128", "display_name": "M\u1ea1nh Linh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/10673761/m%e1%ba%a1nh-linh-nguy%e1%bb%85n"}, "reply_to_user": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 0, "creation_date": 1562826887, "post_id": 56965686, "comment_id": 100501158, "body": "It looks like a map but not a map."}, {"owner": {"reputation": 19, "user_id": 10673761, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MxRArf_tO1w/AAAAAAAAAAI/AAAAAAAAAAc/w4r8sho4IEE/photo.jpg?sz=128", "display_name": "M\u1ea1nh Linh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/10673761/m%e1%ba%a1nh-linh-nguy%e1%bb%85n"}, "reply_to_user": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 0, "creation_date": 1562826938, "post_id": 56965686, "comment_id": 100501189, "body": "It takes the form:  ProductName:\tMac OS X ProductVersion:\t10.15 BuildVersion:\t19A501i"}], "owner": {"reputation": 19, "user_id": 10673761, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MxRArf_tO1w/AAAAAAAAAAI/AAAAAAAAAAc/w4r8sho4IEE/photo.jpg?sz=128", "display_name": "M\u1ea1nh Linh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/10673761/m%e1%ba%a1nh-linh-nguy%e1%bb%85n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 996, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562749251, "creation_date": 1562744393, "question_id": 56965686, "link": "https://stackoverflow.com/questions/56965686/how-to-convert-output-exec-command-to-json-in-golang", "title": "How to convert output exec command to json in golang", "body": "<p>I have use <code>exec.Command(command)</code> on golang and convert it to string.\nWhen I RunCommand <code>systeminfo</code> on windowOS it return string type <code>key:value</code>. How to convert it to json?</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZeXDI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZeXDI.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>// Version Function:\nfunc Version() (version string) {\n    os := OS()\n    if os == \"macOS X\" {\n        result := RunCommand(\"sw_vers\")\n        resultRune := []rune(result)\n        version = string(resultRune[38:43]) // tested\n    }\n    if os == \"Windows\" {\n        result := RunCommand(\"systeminfo\")\n        resultRune := []rune(result)\n        version = string(resultRune[:]) // not tested\n    }\n    if os == \"Linux\" {\n        result := RunCommand(\"lsb_release -a\")\n        resultRune := []rune(result)\n        version = string(resultRune[:]) // not tested\n    }\n    return version\n}\n// RunCommand Function:\nfunc RunCommand(command string) string {\n    cmd := exec.Command(command)\n    var stdout, stderr bytes.Buffer\n    cmd.Stdout = &amp;stdout\n    cmd.Stderr = &amp;stderr\n    err := cmd.Run()\n    if err != nil {\n        log.Fatalf(\"Command \"+command+\" failed with %s\\n\", err)\n    }\n    outStr := string(stdout.Bytes())\n    return outStr\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 5, "creation_date": 1562745913, "post_id": 56965633, "comment_id": 100469200, "body": "There&#39;s no inheritance in go. You can try using interfaces, but you&#39;ll have to expose the fields via getter methods."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1562765181, "post_id": 56965633, "comment_id": 100479957, "body": "You need to think about the problem differently, and given that this seems to be example code, it&#39;s hard to say what you actually need to do differently. But the key is: Go has no inheritance and no class hierarchy, <i>do not try to write Java/C# in Go, it will never work</i>. Write Go in Go; solve problems the Go way, not the way of any other language."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1562748152, "post_id": 56966330, "comment_id": 100470352, "body": "By doing so, you throw all of the static checks and guarantees out the window. You won&#39;t be able to do anything with a VehicleType without a type switch or type assertion. Sometimes this is acceptable/recommended and sometimes it&#39;s the only way, but I feel that this is not necessary in this case."}, {"owner": {"reputation": 93, "user_id": 2006407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4533a06fe67961de7d2b97631261288c?s=128&d=identicon&r=PG", "display_name": "Bikram Panjikar", "link": "https://stackoverflow.com/users/2006407/bikram-panjikar"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1562749729, "post_id": 56966330, "comment_id": 100471359, "body": "@Sergio: Could you please give me some hints for type assertion using interface to solve this problem? I guess this is a common problem where ever we will have Type dependencies with actual domain model. In this example Vehicle has a type  field of VehicleType."}], "tags": [], "owner": {"reputation": 24, "user_id": 8397295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaade7d09ad405f445b61238b2c15e78?s=128&d=identicon&r=PG", "display_name": "dchaofei", "link": "https://stackoverflow.com/users/8397295/dchaofei"}, "is_accepted": false, "score": -1, "last_activity_date": 1562746688, "creation_date": 1562746688, "answer_id": 56966330, "question_id": 56965633, "link": "https://stackoverflow.com/questions/56965633/inheritance-in-go-data-structure/56966330#56966330", "title": "Inheritance in go data structure", "body": "<p>It's can work!</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Vehicle struct {                        \n    Id          int\n    Name        string\n    VehicleType VehicleTypeInterface\n}\n\ntype VehicleTypeInterface interface{}\n\ntype VehicleTypeBase struct {\n    Id     int\n    Name   string\n    Milage int\n}\n\ntype VehicleTypeSedan struct {\n    VehicleTypeBase\n    IsABSEnabled bool\n}\n\ntype VehicleTypeHatchback struct {\n    VehicleTypeBase\n    Is4WheelDriveEnabled bool\n}\n\nfunc main() {\n    var veh Vehicle\n\n    veh = Vehicle{\n        Id:   1,\n        Name: \"Zeep Compass\",\n        VehicleType: VehicleTypeSedan{\n            VehicleTypeBase: VehicleTypeBase{\n                Id:     3,\n                Name:   \"Sedan\",\n                Milage: 13,\n            },\n            IsABSEnabled: true,\n        },\n    }\n    fmt.Printf(\"%+v\", veh)\n}\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 2006407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4533a06fe67961de7d2b97631261288c?s=128&d=identicon&r=PG", "display_name": "Bikram Panjikar", "link": "https://stackoverflow.com/users/2006407/bikram-panjikar"}, "edited": false, "score": 0, "creation_date": 1562752574, "post_id": 56966372, "comment_id": 100473036, "body": "Thanks Abhijit! It seems to be working. However, I am wondering why Interface is not allowed to define a field. Putting the getters setters looks a workaround. Its more simpler in OOP language. I am not sure if there are better approach to solve this kind of problem. In real world scenario we will have more complex data structures. :-). Also I have gone through an issue in Golang (Github) which is similar in nature: <a href=\"https://github.com/golang/go/issues/23796\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/23796</a>"}, {"owner": {"reputation": 3374, "user_id": 1063250, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50ce9a9e3c79bf98919e99a96de7b05c?s=128&d=identicon&r=PG", "display_name": "Abhijit-K", "link": "https://stackoverflow.com/users/1063250/abhijit-k"}, "reply_to_user": {"reputation": 93, "user_id": 2006407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4533a06fe67961de7d2b97631261288c?s=128&d=identicon&r=PG", "display_name": "Bikram Panjikar", "link": "https://stackoverflow.com/users/2006407/bikram-panjikar"}, "edited": false, "score": 0, "creation_date": 1562752838, "post_id": 56966372, "comment_id": 100473205, "body": "I have added a func <code>processSpecificVehicle</code> that uses type checking however makes the execution little slow. For complex data struct embedding like in <code>VehicleTypeSedan</code> should be fine since you can directly access all the data (including embedded struct <code>VehicleTypeGeneral</code>) and you know that you have to operate on that specific struct"}, {"owner": {"reputation": 3374, "user_id": 1063250, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50ce9a9e3c79bf98919e99a96de7b05c?s=128&d=identicon&r=PG", "display_name": "Abhijit-K", "link": "https://stackoverflow.com/users/1063250/abhijit-k"}, "reply_to_user": {"reputation": 93, "user_id": 2006407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4533a06fe67961de7d2b97631261288c?s=128&d=identicon&r=PG", "display_name": "Bikram Panjikar", "link": "https://stackoverflow.com/users/2006407/bikram-panjikar"}, "edited": false, "score": 0, "creation_date": 1562753459, "post_id": 56966372, "comment_id": 100473599, "body": "Added func processSedan, you can see that we can access directly the fields of  <code>VehicleTypeSedan</code> as well as embedded struct <code>VehicleTypeGeneral</code>."}, {"owner": {"reputation": 3374, "user_id": 1063250, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50ce9a9e3c79bf98919e99a96de7b05c?s=128&d=identicon&r=PG", "display_name": "Abhijit-K", "link": "https://stackoverflow.com/users/1063250/abhijit-k"}, "reply_to_user": {"reputation": 93, "user_id": 2006407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4533a06fe67961de7d2b97631261288c?s=128&d=identicon&r=PG", "display_name": "Bikram Panjikar", "link": "https://stackoverflow.com/users/2006407/bikram-panjikar"}, "edited": false, "score": 0, "creation_date": 1562754054, "post_id": 56966372, "comment_id": 100473879, "body": "Go tries to address problems in OOPs so in go lang try to embrace go lang principle of embedding over traditional inheritance."}], "tags": [], "owner": {"reputation": 3374, "user_id": 1063250, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50ce9a9e3c79bf98919e99a96de7b05c?s=128&d=identicon&r=PG", "display_name": "Abhijit-K", "link": "https://stackoverflow.com/users/1063250/abhijit-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1562753883, "last_edit_date": 1562753883, "creation_date": 1562746846, "answer_id": 56966372, "question_id": 56965633, "link": "https://stackoverflow.com/questions/56965633/inheritance-in-go-data-structure/56966372#56966372", "title": "Inheritance in go data structure", "body": "<p>Struct embedding is how go lang prefers. Composition is better than inheritance is the idea.</p>\n\n<p><a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#embedding</a></p>\n\n<p>You should declare an interface for Vehicle and all the Vehicles implement that interface.</p>\n\n<p>This is design level problem than just fixing the error. Since its not clear exactly how you are going to use and deal with Vehicles. I will make some assumptions.</p>\n\n<p>By Embedding way should embed a reusable struct inside specific structs.</p>\n\n<pre><code>type VehicleTypeGeneral struct {\n    Id     int\n    Name   string\n    Milage int\n}\n\n//Embed VehicleTypeGeneral\ntype VehicleTypeHatchback struct {\n    VehicleTypeGeneral\n    Is4WheelDriveEnabled bool\n}\n</code></pre>\n\n<p>If we creates instance vh of <code>VehicleTypeHatchback</code> then we can access fields of <code>VehicleTypeHatchback</code> as well as embedded struct <code>VehicleTypeGeneral</code> like <code>vh.Is4WheelDriveEnabled</code> and <code>vh.VehicleTypeGeneral.Name</code> </p>\n\n<p>If <code>VehicleTypeGeneral</code> implement interface like <code>Vehicle</code> interface then <code>VehicleTypeHatchback</code> also implements that. You can override by implementing the methods though.</p>\n\n<p>I have added type check example in <code>processSpecificVehicle</code> function. However these things slow the execution. Instead try to use the approached mentioned in <code>processVehicle</code> and <code>processAbsVehicle</code></p>\n\n<p>Also the interfaces should not have to many methods. One or two are enough other wise it is violation of interface segregation principle. Keep the interfaces short and meaningful and design them from the prospective of consumer of interfaces.</p>\n\n<p><strong>Complete example with certain assumptions:</strong></p>\n\n<pre><code>package main\nimport \"fmt\"\n\ntype Vehicle interface {\n    GetId() int\n    GetName() string\n}\n\ntype AbsVehicle interface {\n    IsAbsEnabled() bool   \n}\n\ntype VehicleTypeGeneral struct {\n    Id     int\n    Name   string\n    Milage int\n}\n\nfunc (v *VehicleTypeGeneral) GetId() int{\n    return v.Id\n}\n\nfunc (v *VehicleTypeGeneral) GetName() string{\n    return v.Name\n}\n\ntype VehicleTypeSedan struct {\n    VehicleTypeGeneral\n    IsABSEnabled bool\n}\n\nfunc(vs *VehicleTypeSedan) IsAbsEnabled() bool {\n    return vs.IsABSEnabled\n}\n\ntype VehicleTypeHatchback struct {\n    VehicleTypeGeneral\n    Is4WheelDriveEnabled bool\n}\n\nfunc main() {\n    println(\"Hello\")\n\n    var vehicle = VehicleTypeSedan{IsABSEnabled: true, VehicleTypeGeneral: VehicleTypeGeneral{Id:1001,Name:\"Sedan 1\", Milage:12}}\n\n    processVehicle(&amp;vehicle)\n    processAbsVehicle(&amp;vehicle)\n    processSpecificVehicle(&amp;vehicle)\n    processSedan(&amp;vehicle)\n}\n\nfunc processVehicle(vehicle Vehicle){\n    println(vehicle.GetId())\n    println(vehicle.GetName())  \n}\n\n\nfunc processAbsVehicle(vehicle AbsVehicle){\n    println(vehicle.IsAbsEnabled())\n\n}\n\nfunc processSpecificVehicle(vehicle Vehicle){\n    switch v := vehicle.(type) {\n    case *VehicleTypeSedan:\n        fmt.Printf(\"Its a sedan %v with ABS %v \", v.GetName(), v.IsAbsEnabled())\n    case *VehicleTypeHatchback:\n        fmt.Printf(\"Its a VehicleTypeHatchback %v\", v.GetName())\n    default:\n        fmt.Printf(\"Its a Vehicle\")\n    }\n\n}\n\nfunc processSedan(vs *VehicleTypeSedan){\n    println(\"\\nprocess sedan\")\n    println(vs.VehicleTypeGeneral.Name)\n    println(vs.IsABSEnabled)\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 2006407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4533a06fe67961de7d2b97631261288c?s=128&d=identicon&r=PG", "display_name": "Bikram Panjikar", "link": "https://stackoverflow.com/users/2006407/bikram-panjikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1562753883, "creation_date": 1562744189, "last_edit_date": 1562752198, "question_id": 56965633, "link": "https://stackoverflow.com/questions/56965633/inheritance-in-go-data-structure", "title": "Inheritance in go data structure", "body": "<p>Is there a better way to achieve the inheritance in go? (In c# we use Abstract class and Interfaces to achieve similar behavior). Please refer below code to understand the problem. </p>\n\n<p>I tried using interface in Go but I am unable to access the data fields of struct.</p>\n\n<pre><code>type Vehicle struct {\n    Id          int\n    Name        string\n    VehicleType VehicleTypeBase\n}\n\ntype VehicleTypeBase struct {\n    Id     int\n    Name   string\n    Milage int\n}\n\ntype VehicleTypeSedan struct {\n    VehicleTypeBase\n    IsABSEnabled bool\n}\n\ntype VehicleTypeHatchback struct {\n    VehicleTypeBase\n    Is4WheelDriveEnabled bool\n}\n\nfunc main() {\n    var veh Vehicle\n\n    veh = Vehicle{\n        Id:   1,\n        Name: \"Zeep Compass\",\n        VehicleType: VehicleTypeSedan{\n            Id:           1,\n            Name:         \"Sedan\",\n            Milage:       13,\n            IsABSEnabled: true,\n        },\n    }\n}\n\n// Above initialization gives error. Here, I would like to understand that how // to achieve inheritance using base class\n// in Golang. Is there a way to solve this situation in Go??\n</code></pre>\n\n<p>The error message is:</p>\n\n<blockquote>\n  <p>.\\main.go:40:3: cannot use VehicleTypeSedan literal (type VehicleTypeSedan) as type VehicleTypeBase in field value</p>\n</blockquote>\n"}, {"tags": ["string", "go", "slice", "golang-migrate"], "comments": [{"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 1, "creation_date": 1562736821, "post_id": 56963358, "comment_id": 100465217, "body": "few basic things are wrong in your code. I suggest to take <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">a tour of go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3374, "user_id": 1063250, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/50ce9a9e3c79bf98919e99a96de7b05c?s=128&d=identicon&r=PG", "display_name": "Abhijit-K", "link": "https://stackoverflow.com/users/1063250/abhijit-k"}, "is_accepted": false, "score": 3, "last_activity_date": 1562737915, "creation_date": 1562737915, "answer_id": 56964121, "question_id": 56963358, "link": "https://stackoverflow.com/questions/56963358/slice-display-in-list-with-row-and-column/56964121#56964121", "title": "Slice display in list with row and column", "body": "<p>Here is one way to do it. You have displayed 6 rows in required output however mentioned 6 columns in question. <a href=\"https://play.golang.org/p/bIvKLMTwxal\" rel=\"nofollow noreferrer\">Link to playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    words := [] string{\"peace\", \"note\", \"vapor\", \"notice\", \"meat\", \"shed\", \"immune\", \"law\", \"web\", \"security\", \"estate\", \"chat\", \"biology\", \"because\", \"visit\", \"inch\", \"credit\", \"void\", \"ability\", \"police\", \"crush\", \"begin\", \"matrix\", \"wreck\"}\n    for i := range words {\n\n        words[i] = strconv.Itoa(i+1) + \".\" + words[i]\n    }\n    IterSplits(SliceSplit(words, 6), 6)\n}\n\nfunc IterSplits(slices[][] string, splitSize int){\n    for i := 0; i &lt; splitSize; i ++ {       \n        for _, s := range slices {\n            if len(s) &gt; i {\n                fmt.Printf(\"%-15v\", s[i])\n            }            \n        }\n        println(\"\")     \n    }   \n}\n\n\nfunc SliceSplit(aSlice[] string, splitSize int) [][]string{\n\n  var splits [][]string \n\n  for i := 0; i &lt; len(aSlice); i += splitSize {\n    end := i + splitSize\n\n    if end &gt; len(aSlice) {\n        end = len(aSlice)\n    }\n\n    splits = append(splits, aSlice[i:end])\n  }\n\n  return splits\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 147, "user_id": 7060199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/51b4e0f1117b2ae94e68239aaad68097?s=128&d=identicon&r=PG&f=1", "display_name": "Nagaraj M", "link": "https://stackoverflow.com/users/7060199/nagaraj-m"}, "edited": false, "score": 0, "creation_date": 1562778359, "post_id": 56966040, "comment_id": 100487223, "body": "@NagarajM Simplified and fixed a bug in the original code, also added a 2nd note. See edited answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1562778091, "last_edit_date": 1562778091, "creation_date": 1562745629, "answer_id": 56966040, "question_id": 56963358, "link": "https://stackoverflow.com/questions/56963358/slice-display-in-list-with-row-and-column/56966040#56966040", "title": "Slice display in list with row and column", "body": "<p>The <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package does not have means to jump up one row in the terminal. There are control characters, but they are usually terminal-dependant, so we should avoid them if we can.</p>\n\n<p>We can achieve the \"table\" layout by printing the elements by rows. If we have 4 rows and 6 columns, that means the first row will contain the 1. element, then the 7. element, then the 13. etc. The second row will contain the 2. element, then the 8. element, then the 14. element etc.</p>\n\n<p>In general, we will have <code>len(inputs) / cols</code> rows, rounded up. This is how we can express that with integer arithmetic:</p>\n\n<pre><code>rows := (len(input) + cols - 1) / cols\n</code></pre>\n\n<p>And the elements in a row will have indices:</p>\n\n<pre><code>i := col*rows + row // col goes from 0 to cols\n</code></pre>\n\n<p>So basically we may use a <code>for</code> loop, iterating over the rows, and print the elements of the row. We may use <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow noreferrer\"><code>fmt.Printf()</code></a> with a format string that contains the index and the element, using the same width for all elements (left aligned), something like this: <code>\"%d.%-11s\"</code> (the 11 is the width for the elements, adjust that if you have longer input texts).</p>\n\n<p>The index however does not always have the same width. E.g. the index <code>3</code> has a single digit, while <code>13</code> has 2 digits. So we may use a \"padding\" to make each element and index occupy the same index. This padding may simply be spaces, and as many as needed to make all indices occupy the same space. E.g. if we assume we have less than 100 elements, then we may use 1 space for numbers less than 10, and no spaces for numbers 10..99. </p>\n\n<p>Without further ado, here's our simple <code>table()</code> printing function, that's generic enough to take the number of columns, and takes care of the rest:</p>\n\n<pre><code>func table(input []string, cols int) {\n    rows := (len(input) + cols - 1) / cols\n    for row := 0; row &lt; rows; row++ {\n        for col := 0; col &lt; cols; col++ {\n            i := col*rows + row\n            if i &gt;= len(input) {\n                break // This means the last column is not \"full\"\n            }\n            padding := \"\"\n            if i &lt; 9 {\n                padding = \" \"\n            }\n            fmt.Printf(\"%d.%-11s%s\", i+1, input[i], padding)\n        }\n        fmt.Println()\n    }\n}\n</code></pre>\n\n<p>Let's test it:</p>\n\n<pre><code>input := []string{\n    \"one\", \"two\", \"three\", \"four\", \"five\", \"six\",\n    \"seven\", \"eight\", \"nine\", \"ten\", \"eleven\", \"twelve\",\n    \"thirteen\", \"fourteen\", \"fifteen\", \"sixteen\", \"seventeen\", \"eighteen\",\n    \"nineteen\", \"twenty\", \"twenty-one\", \"twenty-two\", \"twenty-three\", \"twenty-four\",\n}\n\ntable(input, 6)\n</code></pre>\n\n<p>For the above, we get this output:</p>\n\n<pre><code>1.one         5.five        9.nine        13.thirteen   17.seventeen  21.twenty-one \n2.two         6.six         10.ten        14.fourteen   18.eighteen   22.twenty-two \n3.three       7.seven       11.eleven     15.fifteen    19.nineteen   23.twenty-three\n4.four        8.eight       12.twelve     16.sixteen    20.twenty     24.twenty-four\n</code></pre>\n\n<p>Now let's test with 5 columns where the last column will not be \"complete\":</p>\n\n<pre><code>table(input, 5)\n</code></pre>\n\n<p>This time output will be:</p>\n\n<pre><code>1.one         6.six         11.eleven     16.sixteen    21.twenty-one \n2.two         7.seven       12.twelve     17.seventeen  22.twenty-two \n3.three       8.eight       13.thirteen   18.eighteen   23.twenty-three\n4.four        9.nine        14.fourteen   19.nineteen   24.twenty-four\n5.five        10.ten        15.fifteen    20.twenty     \n</code></pre>\n\n<p>Try these on the <a href=\"https://play.golang.org/p/OiNRquY1Yon\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Note #1:</strong></p>\n\n<p>The above solution contains the \"max width\" of elements \"wired in\". If you can't make such assumption, you may iterate over the elements first to get the max width of all elements, and use that in the format string.</p>\n\n<p>This is how it can be done:</p>\n\n<pre><code>maxWidth := 0\nfor _, s := range input {\n    if len(s) &gt; maxWidth {\n        maxWidth = len(s)\n    }\n}\nformat := fmt.Sprintf(\"%%d.%%-%ds%%s\", maxWidth)\n</code></pre>\n\n<p>Then this <code>format</code> is to be used when printing elements:</p>\n\n<pre><code>fmt.Printf(format, i+1, input[i], padding)\n</code></pre>\n\n<p>Try this improved version on the <a href=\"https://play.golang.org/p/ZWJK28Pm9uT\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Note #2:</strong></p>\n\n<p>Also note that the above algorithm might use less columns than what you pass. It does so in the spirit of \"minimizing\" columns.</p>\n\n<p>For example if input length is 24 and you pass <code>cols=10</code>, that means at least 3 rows is required to present the 24 elements (2 rows could only display 20 elements at most in 10 columns). But if 3 rows are used / utilized, then 24 elements can be presented in as few as 8 columns, because 3*8 = 24.</p>\n"}], "owner": {"reputation": 147, "user_id": 7060199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/51b4e0f1117b2ae94e68239aaad68097?s=128&d=identicon&r=PG&f=1", "display_name": "Nagaraj M", "link": "https://stackoverflow.com/users/7060199/nagaraj-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 56966040, "answer_count": 2, "score": 1, "last_activity_date": 1562778091, "creation_date": 1562732406, "last_edit_date": 1562746249, "question_id": 56963358, "link": "https://stackoverflow.com/questions/56963358/slice-display-in-list-with-row-and-column", "title": "Slice display in list with row and column", "body": "<p>I have slice with 24 words, I want to display it with 4 row with 6 column in  list format. I am trying to implement it in Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    words := []string{\"peace\", \"note\", \"vapor\", \"notice\", \"meat\", \"shed\", \"immune\", \"law\", \"web\", \"security\", \"estate\", \"chat\", \"biology\", \"because\", \"visit\", \"inch\", \"credit\", \"void\", \"ability\", \"police\", \"crush\", \"begin\", \"matrix\", \"wreck\"}\n    for i, s := range words {\n        fmt.Println(i, s)\n    }\n}\n</code></pre>\n\n<p>Required output:</p>\n\n<pre><code>1.peace      7.immune         \n2.note       8.law\n3.vapor      9.web\n4.notice     10.security\n5.meat       11.estate\n6.shed       12 chat\n</code></pre>\n"}, {"tags": ["go", "time", "byte"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1562766001, "post_id": 56963226, "comment_id": 100480342, "body": "Just store a format that&#39;s actually useful, like the Unix timestamp as an int."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562745573, "post_id": 56963444, "comment_id": 100469010, "body": "This is not an accurate result for the OP&#39;s use case, because it contains a pointer to a location, which mis-represents encoding size, and it also includes monotonic clock data, which can generally be discarded when encoding."}, {"owner": {"reputation": 289, "user_id": 3553597, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/o4F20.jpg?s=128&g=1", "display_name": "Diericx", "link": "https://stackoverflow.com/users/3553597/diericx"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562770007, "post_id": 56963444, "comment_id": 100482774, "body": "Ahh I didn&#39;t realize that. You&#39;re answer is really interesting, thanks!"}], "tags": [], "owner": {"reputation": 289, "user_id": 3553597, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/o4F20.jpg?s=128&g=1", "display_name": "Diericx", "link": "https://stackoverflow.com/users/3553597/diericx"}, "is_accepted": false, "score": 0, "last_activity_date": 1562733056, "creation_date": 1562733056, "answer_id": 56963444, "question_id": 56963226, "link": "https://stackoverflow.com/questions/56963226/how-many-bytes-are-in-a-golang-time-object/56963444#56963444", "title": "How many bytes are in a golang time object", "body": "<p>You can use <a href=\"https://godoc.org/unsafe#Sizeof\" rel=\"nofollow noreferrer\">usafe.Sizeof</a> to get the size in bytes of a variable. I did this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"unsafe\"\n)\n\nfunc main() {\n    t := time.Now()\n    fmt.Printf(\"a: %T, %d\\n\", t, unsafe.Sizeof(t))\n}\n</code></pre>\n\n<p>Looks like its 24 bytes! :)</p>\n\n<p>Also MarshalBinary looks like it works, although it depends on where you are sending it and how you want to unmarshal it. It may be easier to simply convert it to a string then use that if you are using it in Javascript or something. </p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 3, "last_activity_date": 1562746769, "last_edit_date": 1562746769, "creation_date": 1562745532, "answer_id": 56966008, "question_id": 56963226, "link": "https://stackoverflow.com/questions/56963226/how-many-bytes-are-in-a-golang-time-object/56966008#56966008", "title": "How many bytes are in a golang time object", "body": "<p>The answer to this question is not as straight forward as it might seem.  It depends a lot on how much detail you need to preserve in your marshaling.</p>\n\n<p>As pointed out in another answer, you can simply use <code>unsafe.Sizeof()</code> to determine the in-memory size of a time object, but this has little resemblance to the actual marshaled size, for the simple reason that it contains a pointer.  If we look at the definition of <code>time.Time</code> we see:</p>\n\n<pre><code>type Time struct {\n    // wall and ext encode the wall time seconds, wall time nanoseconds,\n    // and optional monotonic clock reading in nanoseconds.\n    //\n    // From high to low bit position, wall encodes a 1-bit flag (hasMonotonic),\n    // a 33-bit seconds field, and a 30-bit wall time nanoseconds field.\n    // The nanoseconds field is in the range [0, 999999999].\n    // If the hasMonotonic bit is 0, then the 33-bit field must be zero\n    // and the full signed 64-bit wall seconds since Jan 1 year 1 is stored in ext.\n    // If the hasMonotonic bit is 1, then the 33-bit field holds a 33-bit\n    // unsigned wall seconds since Jan 1 year 1885, and ext holds a\n    // signed 64-bit monotonic clock reading, nanoseconds since process start.\n    wall uint64\n    ext  int64\n\n    // loc specifies the Location that should be used to\n    // determine the minute, hour, month, day, and year\n    // that correspond to this Time.\n    // The nil location means UTC.\n    // All UTC times are represented with loc==nil, never loc==&amp;utcLoc.\n    loc *Location\n}\n</code></pre>\n\n<p>Whether you care about the timezone info stored in <code>loc</code>, is application dependent. If you always store UTC times (usually the best approach), then you can ignore this bit entirely, which means you can get by storing just the two <code>uint64</code>s.</p>\n\n<p>But even these two fields depend on whether or not you're using a monotonic clock. When marshaling data, you almost certainly do not care about the monotonic clock, whether or not it's encoded in those bits.</p>\n\n<p>What this means is that, in most cases, you should be able to store a full time object in 64 bits (8 bytes), plus a timezone indicator, if necessary.</p>\n\n<p>Further, depending on the precision you need, you may be able to store only the seconds field (discarding sub-second precision), which needs only 33 bits. If you only care about minutes or days, you could use even less space.</p>\n"}], "owner": {"reputation": 2275, "user_id": 7458927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03baa06e976e374201e74a42e8cc8a4b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Hendren", "link": "https://stackoverflow.com/users/7458927/lucas-hendren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1400, "favorite_count": 0, "accepted_answer_id": 56966008, "answer_count": 2, "score": 0, "last_activity_date": 1562746769, "creation_date": 1562731122, "question_id": 56963226, "link": "https://stackoverflow.com/questions/56963226/how-many-bytes-are-in-a-golang-time-object", "title": "How many bytes are in a golang time object", "body": "<p>I am having to store a time object in an array of bytes in a go project I am working on and have to declare the size of the array up front.  I can not find the length in bytes referenced anywhere.  At this point, I am planning on using the time.MarshalBinary() from the time library to convert it to bytes and manually figuring it out.  But I wanted to know if anyone has any reference to the number of bytes this is and if time.MarshalBinary() is the best method to use for converting to bytes.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1562727258, "post_id": 56962726, "comment_id": 100463150, "body": "Do note, that types defined within functions <i>cannot</i> have methods defined on these types."}, {"owner": {"reputation": 7, "user_id": 11758694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-p2e1870iJI4/AAAAAAAAAAI/AAAAAAAAADc/UBHjL-tTMfI/photo.jpg?sz=128", "display_name": "dovejb", "link": "https://stackoverflow.com/users/11758694/dovejb"}, "edited": false, "score": 0, "creation_date": 1562745913, "post_id": 56962726, "comment_id": 100469199, "body": "thank you, the solution is nice in some circumstances. But I really like to use anonymous struct. in my opinion, to pass the type again to make() is not necessary, but golang require you to do so, it&#39;s weird."}, {"owner": {"reputation": 7, "user_id": 11758694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-p2e1870iJI4/AAAAAAAAAAI/AAAAAAAAADc/UBHjL-tTMfI/photo.jpg?sz=128", "display_name": "dovejb", "link": "https://stackoverflow.com/users/11758694/dovejb"}, "edited": false, "score": 0, "creation_date": 1562746053, "post_id": 56962726, "comment_id": 100469271, "body": "if i insist to use the anonymous struct, maybe I have to use reflect to make without writing the type again. But I still wonder why make() is like this."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 1, "last_activity_date": 1562726462, "creation_date": 1562726462, "answer_id": 56962726, "question_id": 56962521, "link": "https://stackoverflow.com/questions/56962521/why-must-i-pass-type-to-make-function-when-variable-is-already-declared/56962726#56962726", "title": "Why must I pass type to make function when variable is already declared?", "body": "<p>Anonymous structs are handy for one-time use.</p>\n\n<p>If you are using it more than once, then define a named struct type.</p>\n\n<p>If you only use it within a single function, you can define the type within the scope of that particular function, so it's obvious that it cannot be used elsewhere:</p>\n\n<pre><code>func myfunc() {\n    type MyType struct {\n        Name string\n    }\n    m := MyType{Name: \"Hello, World!\"} // this type can only be used within this func\n    fmt.Println(m)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1562746275, "creation_date": 1562746275, "answer_id": 56966212, "question_id": 56962521, "link": "https://stackoverflow.com/questions/56962521/why-must-i-pass-type-to-make-function-when-variable-is-already-declared/56966212#56966212", "title": "Why must I pass type to make function when variable is already declared?", "body": "<blockquote>\n  <p>if I insist using anonymous struct, is there any way to make it more decent?</p>\n</blockquote>\n\n<p>Yes, there is. Use <code>:=</code>:</p>\n\n<pre><code>users := make([]struct{\n    Name string `json:\"name,omitempty\"`\n    Age int\n}, 0, 10)\n</code></pre>\n\n<p>Of course, this only works if you're calling <code>make</code> right after you're defining the variable. If these bits are separated by other code, this trick won't work for you.</p>\n\n<p>But don't be afraid to name your types. That's generally a better approach anyway (with or without <code>:=</code>).</p>\n"}], "owner": {"reputation": 7, "user_id": 11758694, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-p2e1870iJI4/AAAAAAAAAAI/AAAAAAAAADc/UBHjL-tTMfI/photo.jpg?sz=128", "display_name": "dovejb", "link": "https://stackoverflow.com/users/11758694/dovejb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1562746341, "creation_date": 1562724420, "last_edit_date": 1562746341, "question_id": 56962521, "link": "https://stackoverflow.com/questions/56962521/why-must-i-pass-type-to-make-function-when-variable-is-already-declared", "title": "Why must I pass type to make function when variable is already declared?", "body": "<p>I want use anonymous struct to do something.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var users []struct{\n    Name string `json:\"name,omitempty\"`\n    Age int\n}\n</code></pre>\n\n<p>and I have to write the type again to set value</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>users = make([]struct{\n    Name string `json:\"name,omitempty\"`\n    Age int\n}, 0, 10)\n</code></pre>\n\n<p>if I insist using anonymous struct, is there any way to make it more decent?</p>\n\n<p>(if no, I wonder why golang design make function like this...)</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562707682, "post_id": 56960663, "comment_id": 100459403, "body": "Missing fields are never a problem when unmarshaling JSON. Go just skips them. But your two structs are actually different. That&#39;s not your problem."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562707718, "post_id": 56960663, "comment_id": 100459418, "body": "Can you update your question with complete JSON for the two different payloads you need to decode?"}, {"owner": {"reputation": 3, "user_id": 7057976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1603368fbef648389489c18e3d61002f?s=128&d=identicon&r=PG&f=1", "display_name": "Fef0", "link": "https://stackoverflow.com/users/7057976/fef0"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562708636, "post_id": 56960663, "comment_id": 100459664, "body": "@Flimzy that&#39;s where the issues start, because the two JSONs come from the same source, what do you mean by complete JSON?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1562712956, "post_id": 56960663, "comment_id": 100460585, "body": "I don&#39;t think there&#39;s a particularly good way to handle something like this. You have one field (<code>devices</code>) that can have two different types, object or array. You can define it as type <code>interface{}</code> in your struct and see whether it&#39;s a slice or a map. I think the two possible types you would see are <code>[]interface{}</code> and <code>map[string]interface{}</code>. I don&#39;t know that that&#39;s any better than what you&#39;re doing now (two different struct definitions)."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562744433, "post_id": 56960663, "comment_id": 100468463, "body": "I mean <i>complete JSON</i>. The JSON in your question is incomplete. It appears to have missing bits."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562744801, "post_id": 56960663, "comment_id": 100468631, "body": "This should help: <a href=\"https://stackoverflow.com/q/33436730/13860\">stackoverflow.com/q/33436730/13860</a>  The key is to unmarshal twice. You can encapsulate that in a custom unmarshaler, though."}, {"owner": {"reputation": 3, "user_id": 7057976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1603368fbef648389489c18e3d61002f?s=128&d=identicon&r=PG&f=1", "display_name": "Fef0", "link": "https://stackoverflow.com/users/7057976/fef0"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562767601, "post_id": 56960663, "comment_id": 100481284, "body": "Ok guys, I finally managed to kind of make it work with just one struct, using <code>interface{}</code> for Device and Refs, but it&#39;s ugly and I constantly have to use a JSON conversion in between to force the use of Stats.Device instead of map[string]interface{}. @Flimzy the JSON isn&#39;t incomplete, is just wrong from the server side, because they send &quot;devices&quot; and &quot;refs&quot; as an object first and as an empty array later, depending on the link I give them. I contacted their support and they&#39;ll probably resolve the issue. Thank you very much for the help"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562769599, "post_id": 56960663, "comment_id": 100482545, "body": "I&#39;m glad you got something working. But please don&#39;t edit your question to include the answer. Instead, provide an answer below."}, {"owner": {"reputation": 3, "user_id": 7057976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1603368fbef648389489c18e3d61002f?s=128&d=identicon&r=PG&f=1", "display_name": "Fef0", "link": "https://stackoverflow.com/users/7057976/fef0"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562773743, "post_id": 56960663, "comment_id": 100484950, "body": "@Flimzy Ok, I deleted the edit and posted a new answer, I&#39;m new here and it&#39;s my first question. Thank you very much"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562773786, "post_id": 56960663, "comment_id": 100484975, "body": "Well done. Thanks for providing your own answer!  You can also accept your own answer (some times after a delay) to indicate that it was the answer that helped you."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 7057976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1603368fbef648389489c18e3d61002f?s=128&d=identicon&r=PG&f=1", "display_name": "Fef0", "link": "https://stackoverflow.com/users/7057976/fef0"}, "is_accepted": true, "score": 0, "last_activity_date": 1562774005, "last_edit_date": 1562774005, "creation_date": 1562773622, "answer_id": 56974350, "question_id": 56960663, "link": "https://stackoverflow.com/questions/56960663/how-to-handle-missing-fields-in-a-json-response-dynamically-in-go/56974350#56974350", "title": "How to handle missing fields in a JSON response dynamically in Go", "body": "<p>I finally managed to make it work with an ugly workaround.\nI changed my struct to</p>\n\n<pre><code>type Stats struct {\n    Status     int         `json:\"status\"`\n    Date       string      `json:\"date\"`\n    Title      string      `json:\"title\"`\n    Devices    interface{} `json:\"devices\"`\n    Refs       interface{} `json:\"refs\"`\n}\n</code></pre>\n\n<p>Then I can finally Unmarshal the JSON in both cases, but I get a <code>map[string]interface{}</code> when an object is passed and an empty <code>interface{}</code> when an empty array is passed. In order to fix this inconsistency, I simply check for the data type and force the use of a JSON intermediate conversion in order to unpack the <code>map[string]interface{}</code> value inside a custom <code>Devices</code> struct:</p>\n\n<pre><code>// Devices contains devices information\ntype Devices struct {\n    Dev []struct {\n        Tag    string `json:\"tag\"`\n        Clicks string `json:\"clicks\"`\n    } `json:\"dev\"`\n    Sys []struct {\n        Tag    string `json:\"tag\"`\n        Clicks string `json:\"clicks\"`\n    } `json:\"sys\"`\n    Bro []struct {\n        Tag    string `json:\"tag\"`\n        Clicks string `json:\"clicks\"`\n    } `json:\"bro\"`\n}\n</code></pre>\n\n<p>The algorithms I use are the following:</p>\n\n<pre><code>//ForceDevicesToRightType uses a json conversion as intermediary for filling the Stats.Devices\n// struct with map[string]interface{} values\nfunc ForceDevicesToRightType(dev interface{}) (Devices, error) {\n    temp, err := json.Marshal(dev)\n    if err != nil {\n        return Devices{}, err\n    }\n    // Use a temporary variable of the right type\n    var devices Devices\n    err = json.Unmarshal(temp, &amp;devices)\n    if err != nil {\n        return Devices{}, err\n    }\n\n    return devices, nil\n}\n</code></pre>\n\n<pre><code>// ForceRefsToRightType uses a json conversion as intermediary for filling the Stats.Refs\n// struct with map[string]interface{} values\nfunc ForceRefsToRightType(refs interface{}) (Refs, error) {\n    temp, err := json.Marshal(refs)\n    if err != nil {\n        return Refs{}, err\n    }\n    // Use a temporary variable of the right type\n    var references Refs\n    err = json.Unmarshal(temp, &amp;references)\n    if err != nil {\n        return Refs{}, err\n    }\n\n    return references, nil\n}\n</code></pre>\n\n<p>Since the compiler knows that both Devices and Refs fields are <code>interface{}</code> I cannot simply access any methods after the conversion, so I simply make a cast of the right type and everything works fine.\nFor example, if I wanted to access the Dev sub-struct, this is the proper way:</p>\n\n<pre><code>y, _ := GetStats()\nfmt.Println(y.Devices.(Devices).Dev)\n</code></pre>\n\n<p>It's ugly, but it works.</p>\n\n<p><strong>Thank you very much for your help, I hope that this method will save you an headache!</strong></p>\n"}], "owner": {"reputation": 3, "user_id": 7057976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1603368fbef648389489c18e3d61002f?s=128&d=identicon&r=PG&f=1", "display_name": "Fef0", "link": "https://stackoverflow.com/users/7057976/fef0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 56974350, "answer_count": 1, "score": 0, "last_activity_date": 1562774005, "creation_date": 1562707276, "last_edit_date": 1562773656, "question_id": 56960663, "link": "https://stackoverflow.com/questions/56960663/how-to-handle-missing-fields-in-a-json-response-dynamically-in-go", "title": "How to handle missing fields in a JSON response dynamically in Go", "body": "<p>I'm working on a Go wrapper for an API and I noticed that two of the JSON fields stay empty when they don't have any data.\nBasically the API returns a set of information on a given url, and if it was visited at least once, everything is okay and I get a full json that I then Unmarshal into a struct:</p>\n\n<pre><code>{\n   \"stats\":{\n      \"status\":1,\n      \"date\":\"09.07.2019\",\n      \"title\":\"Test\",\n      \"devices\":{\n         \"dev\":[\n            {\n               \"tag\":\"Desktop\"\n            }\n         ],\n         \"sys\":[\n            {\n               \"tag\":\"GNU/Linux \"\n            },\n            {\n               \"tag\":\"Windows 10\"\n            }\n         ],\n         \"bro\":[\n            {\n               \"tag\":\"Firefox 67.0\"\n            },\n            {\n               \"tag\":\"Chrome 62.0\"\n            }\n         ]\n      },\n      \"refs\":[\n         {\n            \"link\":\"www.google.com\"\n         }\n      ]\n   }\n}\n\n</code></pre>\n\n<p>This is the struct I'm using:</p>\n\n<pre><code>type Stats struct {\n    Stats struct {\n        Status  int    `json:\"status\"`\n        Date    string `json:\"date\"`\n        Title   string `json:\"title\"`\n        Devices struct {\n            Dev []struct {\n                Tag string `json:\"tag\"`\n            } `json:\"dev\"`\n            Sys []struct {\n                Tag string `json:\"tag\"`\n            } `json:\"sys\"`\n            Bro []struct {\n                Tag string `json:\"tag\"`\n            } `json:\"bro\"`\n        } `json:\"devices\"`\n        Refs []struct {\n            Link string `json:\"link\"`\n        } `json:\"refs\"`\n    } `json:\"stats\"`\n}\n</code></pre>\n\n<p>When a new url is given, then things become a little bit weird:</p>\n\n<pre><code>{\n  \"stats\": {\n    \"status\": 1,\n    \"date\": \"09.07.2019\",\n    \"title\": \"Test2\",\n    \"devices\": [\n\n    ],\n    \"refs\": [\n\n    ]\n  }\n}\n</code></pre>\n\n<p>As you can see, the fields \"dev\", \"sys\" and \"bro\" just disappear because they're not used and when I try to Unmarshal the JSON into the same struct I get <code>json: cannot unmarshal array into Go struct field Stats.device of type [...]</code>\nI tried to use two different structs to handle both the responses but I'm sure that there's a way to handle them gracefully with just one.\nAny help would be appreciated, thanks!</p>\n"}, {"tags": ["arrays", "json", "api", "go", "byte"], "comments": [{"owner": {"reputation": 722, "user_id": 6387948, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cbaNARBRWO4/AAAAAAAAAAI/AAAAAAAAAGM/lVLNlR9XqDE/photo.jpg?sz=128", "display_name": "Hans-Martin Mosner", "link": "https://stackoverflow.com/users/6387948/hans-martin-mosner"}, "edited": false, "score": 0, "creation_date": 1562707076, "post_id": 56960370, "comment_id": 100459187, "body": "Although I&#39;m not too familiar with JavaScript, it looks like you&#39;re cutting off some characters at the end, not at the beginning of the body."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10542844, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PBm-_RMSXio/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCZwndQcIm7Io0ZZ60ISuojaEtdMw/mo/photo.jpg?sz=128", "display_name": "Nathan Phillips", "link": "https://stackoverflow.com/users/10542844/nathan-phillips"}, "edited": false, "score": 0, "creation_date": 1562706320, "post_id": 56960402, "comment_id": 100458946, "body": "ah, dumb mistake on my part thank you. now im getting a panic EOF but i can try to figure that out. thanks"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1562706258, "last_edit_date": 1562706258, "creation_date": 1562705807, "answer_id": 56960402, "question_id": 56960370, "link": "https://stackoverflow.com/questions/56960370/how-to-filter-out-first-few-bad-characters-of-gerrit-json-api-response/56960402#56960402", "title": "How to filter out first few bad characters of Gerrit JSON api response", "body": "<p>The code in the question trims four bytes from the end of the response. </p>\n\n<p>Trim the bytes from the beginning of the response:</p>\n\n<pre><code> respBoby = respBody[4:]\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10542844, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PBm-_RMSXio/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCZwndQcIm7Io0ZZ60ISuojaEtdMw/mo/photo.jpg?sz=128", "display_name": "Nathan Phillips", "link": "https://stackoverflow.com/users/10542844/nathan-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 56960402, "answer_count": 1, "score": 0, "last_activity_date": 1562706258, "creation_date": 1562705657, "question_id": 56960370, "link": "https://stackoverflow.com/questions/56960370/how-to-filter-out-first-few-bad-characters-of-gerrit-json-api-response", "title": "How to filter out first few bad characters of Gerrit JSON api response", "body": "<p>In querying Gerrit, they intentionally put a <code>)]}'</code> at the beginning of their api response, see: <a href=\"https://gerrit-review.googlesource.com/Documentation/rest-api-changes.html\" rel=\"nofollow noreferrer\">https://gerrit-review.googlesource.com/Documentation/rest-api-changes.html</a>. I am trying to remove it so the JSON is valid, but I'm unsure of the best way to do this in Go</p>\n\n<p>this is my current program to query gerrit and pull out the changeID and the status from its json :</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"flag\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\ntype gerritData struct {\n    ChangeID string `json:\"change_id\"`\n    Status   string `json:\"status\"`\n}\n\nfunc gerritQuery(gerrit string) (gerritData, error) {\n    username := \"redacted\"\n    password := \"redacted\"\n    client := &amp;http.Client{}\n    req, err := http.NewRequest(\"GET\", \"https://gerrit.company.com/a/changes/?q=\"+gerrit, nil)\n    req.SetBasicAuth(username, password)\n\n    resp, err := client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    respBody, err := ioutil.ReadAll(resp.Body)\n\n        // Trying to cut it out manually.\n    respBody = respBody[:len(respBody)-4]\n\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer resp.Body.Close()\n\n    var gerritResponse gerritData\n    if err := json.NewDecoder(resp.Body).Decode(&amp;gerritResponse); err != nil {\n        panic(err.Error())\n    }\n\n    return gerritResponse, nil\n}\n\nfunc main() {\n    gerritFlag := flag.String(\"gerrit\", \"foo\", \"The Gerrit you want to query\")\n    flag.Parse()\n\n    gerritResponse, _ := gerritQuery(*gerritFlag)\n\n    fmt.Println(gerritResponse)\n}\n</code></pre>\n\n<p>Go is still complaining with <code>panic: invalid character ')' looking for beginning of value</code>. I'm still new to the language so any advice would be great.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1562702447, "post_id": 56959711, "comment_id": 100457542, "body": "What does &quot;It fails in the call to FormFile&quot; mean, ie in which way it fails?"}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1562703229, "post_id": 56959711, "comment_id": 100457830, "body": "yes sorry, added it to the question - it throws : runtime error: invalid memory address or nil pointer dereference"}, {"owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1562703517, "post_id": 56959711, "comment_id": 100457937, "body": "its like that the FormFile (&quot;File&quot;) dont get the &#39;File&#39; that is attached in the postman client"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1562787914, "post_id": 56959711, "comment_id": 100491371, "body": "See does code example in this answer <a href=\"https://stackoverflow.com/a/39982229/723693\">stackoverflow.com/a/39982229/723693</a> help you to figure out..."}], "owner": {"reputation": 317, "user_id": 7868246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07273a6f68864edf11c793a2f774066a?s=128&d=identicon&r=PG&f=1", "display_name": "MdTp", "link": "https://stackoverflow.com/users/7868246/mdtp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574113032, "creation_date": 1562702111, "last_edit_date": 1574113032, "question_id": 56959711, "link": "https://stackoverflow.com/questions/56959711/trying-to-recreate-a-mock-version-of-a-webservice", "title": "Trying to recreate a mock version of a webservice", "body": "<p>I am trying to emulate some APIs in Go for testing - I don't have the source code for the original API, but I can call them.</p>\n\n<p>The thing I'm struggling with is that some of them have a bit different format in the calling part as I'm used to as there doesn't seems to be a filename just data - I have three Postman snapshots here how it looks when you call the original web service (it uploads a csv file):</p>\n\n<p><a href=\"https://i.stack.imgur.com/JPEGE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JPEGE.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/SjfIG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SjfIG.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/tMYvR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tMYvR.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I try to use a handler like this it panics:</p>\n\n<pre><code>file, handler, err := r.FormFile(\"File\")\ndefer file.Close()\n\n// copy example\nf, err := os.OpenFile(\"./downloaded\", os.O_WRONLY|os.O_CREATE, 0666)\ndefer f.Close()\nio.Copy(f, file)\n</code></pre>\n\n<p>It fails in the call to FormFile - I have an idea that its because of the File is in body. How can I make it work server side in Go with the client call from Postman?</p>\n\n<h2>Edit</h2>\n\n<p>The panic it throws is:</p>\n\n<pre><code>runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 1508, "user_id": 6405985, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/78736a4802ae6a766a28829994cd7fff?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Wang", "link": "https://stackoverflow.com/users/6405985/peter-wang"}, "is_accepted": false, "score": 2, "last_activity_date": 1562699322, "creation_date": 1562699322, "answer_id": 56959181, "question_id": 56958728, "link": "https://stackoverflow.com/questions/56958728/how-to-convert-ctype-char-to-ctype-uchar/56959181#56959181", "title": "How to convert *_Ctype_char to *_Ctype_uchar", "body": "<p>The following worked:</p>\n\n<pre><code>compressedData := unsafe.Pointer(data)\n</code></pre>\n\n<p>and </p>\n\n<pre><code>(*C.uchar) (compressedData)\n</code></pre>\n"}], "owner": {"reputation": 1508, "user_id": 6405985, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/78736a4802ae6a766a28829994cd7fff?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Wang", "link": "https://stackoverflow.com/users/6405985/peter-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562699322, "creation_date": 1562697249, "question_id": 56958728, "link": "https://stackoverflow.com/questions/56958728/how-to-convert-ctype-char-to-ctype-uchar", "title": "How to convert *_Ctype_char to *_Ctype_uchar", "body": "<p>I'm using <code>cgo</code> to call a function in a dynamic library whose signature looks like this:</p>\n\n<pre><code>int decompress(int, const uint8_t *, size_t, uint8_t *, size_t);\n</code></pre>\n\n<p>Here is my go code:</p>\n\n<pre><code>// #include statements here\nimport \"C\"\nimport (\n    \"unsafe\"\n)\n\nfunc Decompress(comp_type int, data string, expected_size int) []byte {\n    compressedData := C.CString(data)\n    defer C.free(unsafe.Pointer(compressedData))\n    compressedDataSize := C.ulong(len(data))\n\n    decompressedData := C.malloc(C.ulong(C.sizeof_char * expected_size))\n    defer C.free(unsafe.Pointer(decompressedData))\n    decompressedDataSize := C.ulong(expected_size)\n\n    ret_val := C.XpressDecompress(C.int(comp_type),\n                                  (*C.uchar) (compressedData),\n                                  compressedDataSize,\n                                  (*C.uchar) (decompressedData),\n                                  &amp;decompressedDataSize)\n\n    decompressed := C.GoBytes(decompressedData, C.int(decompressedDataSize))\n\n    return decompressed\n}\n</code></pre>\n\n<p>However, I'm getting this error when I try to build: \n<code>cannot convert compressedData (type *_Ctype_char) to type *_Ctype_uchar</code></p>\n\n<p>What is the best way for me to convert the input string into a <code>const unsigned char*</code>?</p>\n"}, {"tags": ["java", "go", "x509", "pki", "certificate-revocation"], "owner": {"reputation": 87, "user_id": 7868044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f473ab5f487fe07ff66439a5f7a66373?s=128&d=identicon&r=PG&f=1", "display_name": "rafaelqfigueiredo", "link": "https://stackoverflow.com/users/7868044/rafaelqfigueiredo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1617286531, "creation_date": 1562691324, "last_edit_date": 1562692195, "question_id": 56957356, "link": "https://stackoverflow.com/questions/56957356/copy-a-crl-that-was-created-in-go", "title": "Copy a CRL that was created in Go", "body": "<p>I created a CRL in Go (parsed it into PEM) and now I want to re-create the exact same CRL in Java (to obtain the same PEM). However, I'm not sure how to do this, I find that the CRL classes in Go and Java are very different.</p>\n\n<p>I created the CRL in Golang the following way:</p>\n\n<pre><code>var revokedCerts []pkix.RevokedCertificate\n\nclientRevocation := pkix.RevokedCertificate{\n    SerialNumber:   clientCert.SerialNumber,\n    RevocationTime: timeToUseInRevocation.UTC(),\n}\n\nrevokedCerts = append(revokedCerts, clientRevocation)\n\n\ncrlSubject := pkix.Name{\n    Organization:  []string{\"testorg\", \"TestOrg\"},\n    StreetAddress: []string{\"TestAddress\"},\n    PostalCode:    []string{\"0\"},\n    Province:      []string{\"TestProvince\"},\n    Locality:      []string{\"TestLocality\"},\n    Country:       []string{\"TestCountry\"},\n    CommonName:    \"Test Name\",\n}\n\nvar sigAlgorithm pkix.AlgorithmIdentifier\nsigAlgorithm.Algorithm = asn1.ObjectIdentifier{1, 2, 840, 113549, 1, 1, 11}\nsigAlgorithm.Parameters = asn1.NullRawValue\n\ntbsCertList := pkix.TBSCertificateList{\n    Version:             1,\n    Signature:           sigAlgorithm,\n    Issuer:              crlSubject.ToRDNSequence(),\n    ThisUpdate:          timeToUseInRevocation,\n    NextUpdate:          timeToUseInRevocation.Add(time.Millisecond * time.Duration(86400000)),\n    RevokedCertificates: revokedCerts,\n}\nnewCRL, err := asn1.Marshal(pkix.CertificateList{\n    TBSCertList:        tbsCertList, // new CRL\n    SignatureAlgorithm: sigAlgorithm,\n    SignatureValue:     asn1.BitString{}, \n})\ncrlCreated, err := x509.ParseCRL(newCRL)\n\n//CRL pem Block\ncrlPemBlock := &amp;pem.Block{\n    Type:  \"X509 CRL\",\n    Bytes: newCRL,\n}\n\nvar crlBuffer bytes.Buffer\nerr = pem.Encode(&amp;crlBuffer, crlPemBlock)\n</code></pre>\n\n<p>I want to reproduce this in Java.\nI am aware that I have variables (e.g. crl signature) that are empty/nil. That is for the purpose of what I want to do.\nI could take the PEM and read to a CRL in Java but I'm not being able to do so to create the exact same CRL.</p>\n\n<p>I want to create the CRL in Java also without a signature (all parameters equal).</p>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 1534, "user_id": 4589931, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-7h3oUiT0GNI/AAAAAAAAAAI/AAAAAAAAAJk/BMEx6gt1MWg/photo.jpg?sz=128", "display_name": "Rastalamm", "link": "https://stackoverflow.com/users/4589931/rastalamm"}, "edited": false, "score": 0, "creation_date": 1562691382, "post_id": 56957342, "comment_id": 100453021, "body": "What have you tried so far?"}, {"owner": {"reputation": 29, "user_id": 11760849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4278e8e75a2ce394a85988fd72871d9?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy", "link": "https://stackoverflow.com/users/11760849/srikanth-reddy"}, "reply_to_user": {"reputation": 1534, "user_id": 4589931, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-7h3oUiT0GNI/AAAAAAAAAAI/AAAAAAAAAJk/BMEx6gt1MWg/photo.jpg?sz=128", "display_name": "Rastalamm", "link": "https://stackoverflow.com/users/4589931/rastalamm"}, "edited": false, "score": 0, "creation_date": 1562696362, "post_id": 56957342, "comment_id": 100455107, "body": "tcp connection using the ip addess and port"}, {"owner": {"reputation": 29, "user_id": 11760849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4278e8e75a2ce394a85988fd72871d9?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy", "link": "https://stackoverflow.com/users/11760849/srikanth-reddy"}, "reply_to_user": {"reputation": 1534, "user_id": 4589931, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-7h3oUiT0GNI/AAAAAAAAAAI/AAAAAAAAAJk/BMEx6gt1MWg/photo.jpg?sz=128", "display_name": "Rastalamm", "link": "https://stackoverflow.com/users/4589931/rastalamm"}, "edited": false, "score": 0, "creation_date": 1562720751, "post_id": 56957342, "comment_id": 100462018, "body": "<code>connection, err := net.Dial(&quot;tcp&quot;, fmt.Sprintf(&quot;%s:%d&quot;, Host, Port))</code> \t<code>if err != nil {</code> \t\t<code>log.Fatal(&quot;Something went wrong with connection&quot;, err)</code> \t} \tif connection == nil { \t\tlog.Fatal(&quot;could not create connection&quot;) \t} \tdefer connection.Close() \tlog.Println(&quot;Connected to server&quot;)```"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11760849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4278e8e75a2ce394a85988fd72871d9?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy", "link": "https://stackoverflow.com/users/11760849/srikanth-reddy"}, "edited": false, "score": 0, "creation_date": 1562718615, "post_id": 56961037, "comment_id": 100461628, "body": "I have tried ssh connection but it is throwing error <b>ssh: handshake failed : EOF</b> . Also, I have tried smb package that you mentioned. <code>smb</code> package have the capability to check if we can establish the connection and able to login. But there are no functions to use the session and write file to destination path."}], "tags": [], "owner": {"reputation": 31, "user_id": 7053644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5Kh3.jpg?s=128&g=1", "display_name": "cwadley", "link": "https://stackoverflow.com/users/7053644/cwadley"}, "is_accepted": false, "score": 0, "last_activity_date": 1567393934, "last_edit_date": 1567393934, "creation_date": 1562709755, "answer_id": 56961037, "question_id": 56957342, "link": "https://stackoverflow.com/questions/56957342/connecting-to-windows-shared-drive-from-kubernetes-using-go/56961037#56961037", "title": "Connecting to windows shared drive from kubernetes using go", "body": "<p>Windows shares use the SMB protocol. There are a couple of Go libraries for using SMB, but I have never used them so I cannot vouch for their utility. Here is one I Googled:</p>\n\n<p><a href=\"https://github.com/stacktitan/smb\" rel=\"nofollow noreferrer\">https://github.com/stacktitan/smb</a></p>\n\n<p>Other options would be to ensure that the Windows share is mounted on the Linux host filesystem using cifs. Then you could just use the regular Go file utilities:</p>\n\n<p><a href=\"https://www.thomas-krenn.com/en/wiki/Mounting_a_Windows_Share_in_Linux\" rel=\"nofollow noreferrer\">https://www.thomas-krenn.com/en/wiki/Mounting_a_Windows_Share_in_Linux</a></p>\n\n<p>Or, you could install something like Cygwin on the Windows box and run an SSH server. This would allow you to use SCP:</p>\n\n<p><a href=\"https://godoc.org/github.com/tmc/scp\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/tmc/scp</a></p>\n"}, {"tags": [], "owner": {"reputation": 2031, "user_id": 11602913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839532642263a2cdea4da6d557d71d64?s=128&d=identicon&r=PG&f=1", "display_name": "mebius99", "link": "https://stackoverflow.com/users/11602913/mebius99"}, "is_accepted": false, "score": 2, "last_activity_date": 1564748978, "last_edit_date": 1564748978, "creation_date": 1562941732, "answer_id": 57009045, "question_id": 56957342, "link": "https://stackoverflow.com/questions/56957342/connecting-to-windows-shared-drive-from-kubernetes-using-go/57009045#57009045", "title": "Connecting to windows shared drive from kubernetes using go", "body": "<p>Before proceeding with debugging the GO code, it would be needed to do some \"unskilled labour\" within container in order to ensure pre-requisites are met: </p>\n\n<ol>\n<li>samba client is installed and daemons are running; </li>\n<li>the target name gets resolved; </li>\n<li>there are no connectivity issues (routing, firewall rules, etc); </li>\n<li>there are share access permissions; </li>\n<li>mounting remote volume is allowed for the container.</li>\n</ol>\n\n<p>Connect to the container: </p>\n\n<pre><code>$ docker ps \n$ docker exec -it container_id /bin/bash\n</code></pre>\n\n<p>Samba daemons are running: </p>\n\n<pre><code>$ smbd status\n$ nmbd status\n</code></pre>\n\n<p>You use the right name format in your code and command lines: </p>\n\n<pre><code>UNC notation =&gt;  \\\\server_name\\share_name\nURL notation =&gt;  smb://server_name/share_name\n</code></pre>\n\n<p>Target name is resolvable</p>\n\n<pre><code>$ nslookup server_name.domain_name\n$ nmblookup netbios_name \n$ ping server_name\n</code></pre>\n\n<p>Samba shares are visible</p>\n\n<pre><code>$ smbclient -L //server [-U user]       # list of shares\n</code></pre>\n\n<p>and accessible (<code>ls</code>, <code>get</code>, <code>put</code> commands provide expected output here)</p>\n\n<pre><code>$ smbclient //server/share\n&gt; ls \n</code></pre>\n\n<p>Try to mount remote share as suggested by <a href=\"https://stackoverflow.com/users/7053644/cwadley\">@cwadley</a> (mount could be prohibited by default in Docker container): </p>\n\n<pre><code>$ sudo mount -t cifs -o username=geeko,password=pass //server/share /mnt/smbshare\n</code></pre>\n\n<p>For investigation purposes you might use the Samba docker container available at <a href=\"https://github.com/dperson/samba\" rel=\"nofollow noreferrer\">GitHub</a>, or even deploy your application in it since it contains Samba client and helpful command line tools: </p>\n\n<pre><code>$ sudo docker run -it -p 139:139 -p 445:445 -d dperson/samba\n</code></pre>\n\n<p>After you get this working at the Docker level, you could easily reproduce this in Kubernetes. </p>\n\n<p>You might do the checks from within the running Pod in Kubernetes: </p>\n\n<pre><code>$ kubectl get deployments --show-labels\n$ LABEL=label_value; kubectl get pods -l app=$LABEL -o custom-columns=POD:metadata.name,CONTAINER:spec.containers[*].name\n$ kubectl exec pod_name -c container_name -- ping -c1 server_name\n</code></pre>\n\n<p>Having got it working in command line in Docker and Kubernetes, you should get your program code working also. </p>\n\n<p>Also, there is a really thoughtful discussion on StackOverflow regards Samba topic:<br>\n<a href=\"https://stackoverflow.com/questions/27989751/mount-smb-cifs-share-within-a-docker-container\">Mount SMB/CIFS share within a Docker container</a></p>\n"}], "owner": {"reputation": 29, "user_id": 11760849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4278e8e75a2ce394a85988fd72871d9?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Reddy", "link": "https://stackoverflow.com/users/11760849/srikanth-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1364, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1567393934, "creation_date": 1562691290, "question_id": 56957342, "link": "https://stackoverflow.com/questions/56957342/connecting-to-windows-shared-drive-from-kubernetes-using-go", "title": "Connecting to windows shared drive from kubernetes using go", "body": "<p>I need to connect to windows remote server(shared drive) from GO API hosted in the alpine linux. I tried using tcp,ssh and ftp none of them didn't work. Any suggestions or ideas to tackle this?</p>\n"}, {"tags": ["go", "httprequest"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562690327, "post_id": 56956588, "comment_id": 100452553, "body": "We can&#39;t tell you how to fix your code if you don&#39;t show us your code."}, {"owner": {"reputation": 65, "user_id": 11760643, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TS6o86EsszQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8D2anQztw32cTLOuQCObCKTDI4A/photo.jpg?sz=128", "display_name": "Saeed Amin", "link": "https://stackoverflow.com/users/11760643/saeed-amin"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562691593, "post_id": 56956588, "comment_id": 100453128, "body": "@Flimzy the code is fairly simple I defined a root and inside my handler functions I wrote this and the code is OK when content-type is <code>x-www-form-urlencoded</code>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562692100, "post_id": 56956588, "comment_id": 100453333, "body": "I didn&#39;t say it wasn&#39;t simple. I said we need to see it."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1562695117, "creation_date": 1562695117, "answer_id": 56958245, "question_id": 56956588, "link": "https://stackoverflow.com/questions/56956588/get-parameters-in-http-post-request-from-postman/56958245#56958245", "title": "Get parameters in http post request from postman", "body": "<p>When it's multipart you either have to do:</p>\n\n<pre><code>req.ParseMultipartForm(0)\nfmt.Println(req.FormValue(\"aaa\"))\n</code></pre>\n\n<p>or if you don't want to load the whole thing into memory, you could do:</p>\n\n<pre><code>form, err := req.MultipartReader()\nfor {\n    part, err := form.NextPart()\n    if err == io.EOF {\n        break\n    }\n    if part.FormName() == \"aaa\" {\n        buf := new(bytes.Buffer)\n        buf.ReadFrom(part)\n        fmt.Println(buf.String())\n    } \n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 11760643, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TS6o86EsszQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8D2anQztw32cTLOuQCObCKTDI4A/photo.jpg?sz=128", "display_name": "Saeed Amin", "link": "https://stackoverflow.com/users/11760643/saeed-amin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1562701647, "accepted_answer_id": 56958245, "answer_count": 1, "score": -5, "last_activity_date": 1562695117, "creation_date": 1562688228, "last_edit_date": 1562691403, "question_id": 56956588, "link": "https://stackoverflow.com/questions/56956588/get-parameters-in-http-post-request-from-postman", "closed_reason": "Not suitable for this site", "title": "Get parameters in http post request from postman", "body": "<p>I have a Go server but seems I can't get a list of POST (form) parameters in my server from the POST request </p>\n\n<p>I send the request from postman when the option I selected in Body tab is <code>form-data</code> and the request looks like this: </p>\n\n<pre><code>POST /todo/323/item HTTP/1.1\nHost: localhost:8080\nCache-Control: no-cache\nPostman-Token: ef4b5606-3079-fb02-824f-f58ae89ee6f3\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\n\n------WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"aaa\"\n\nskhdfb\n------WebKitFormBoundary7MA4YWxkTrZu0gW\nContent-Disposition: form-data; name=\"test\"\n\n1213\n------WebKitFormBoundary7MA4YWxkTrZu0gW--\n</code></pre>\n\n<p>I get null but when the option is <code>x-www-form-urlencoded</code> it works fine. What should I do? </p>\n\n<p>this is how I try to get the value:</p>\n\n<p><code>fmt.Fprintln(w, req.FormValue(\"aaa\"))</code></p>\n\n<p>thanks in advance for your help</p>\n"}, {"tags": ["c++", "windows", "go", "winapi", "named-pipes"], "comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1562687820, "post_id": 56955966, "comment_id": 100451286, "body": "Does the code work fine if you /don&#39;t/ change user ID?"}, {"owner": {"reputation": 620, "user_id": 3856355, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d98c91290f61527628086a60948745a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tchinmai", "link": "https://stackoverflow.com/users/3856355/tchinmai"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1562689334, "post_id": 56955966, "comment_id": 100452098, "body": "Yes it does. So I suspect the problem is somewhere in the permissions for the pipe, I just don&#39;t know the right way to do it."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562694693, "post_id": 56955966, "comment_id": 100454359, "body": "Rather than using the Everyone SID in an ACL, have you tried setting a null DACL on the <code>SECURITY_DESCRIPTOR</code> that you give to <code>CreatePipe()</code>? That is the typical way to grant all access to everyone. <code>SetSecurityDescriptorDacl(pSD, TRUE, NULL, FALSE)</code>"}, {"owner": {"reputation": 620, "user_id": 3856355, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d98c91290f61527628086a60948745a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tchinmai", "link": "https://stackoverflow.com/users/3856355/tchinmai"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562699466, "post_id": 56955966, "comment_id": 100456401, "body": "@RemyLebeau I just tried it out, and I&#39;m still seeing the same issue - a BrokenPipe in the <code>ReadAndHandleOutput</code> method."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562700116, "post_id": 56955966, "comment_id": 100456642, "body": "The way you are managing handle inheritance is old-school. Use <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/handleapi/nf-handleapi-sethandleinformation\" rel=\"nofollow noreferrer\"><code>SetHandleInformation()</code></a> to control per-handle inheritance without having to duplicate handles, and <a href=\"https://devblogs.microsoft.com/oldnewthing/20111216-00/?p=8873\" rel=\"nofollow noreferrer\">use <code>STARTUPINFOEX</code> with a <code>PROC_THREAD_ATTRIBUTE_HANDLE_LIST</code> attribute list</a> to control which specific handles can be passed by <code>CreateProcessAsUser()</code> to the child."}, {"owner": {"reputation": 620, "user_id": 3856355, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d98c91290f61527628086a60948745a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tchinmai", "link": "https://stackoverflow.com/users/3856355/tchinmai"}, "edited": false, "score": 0, "creation_date": 1562701443, "post_id": 56955966, "comment_id": 100457176, "body": "So, I&#39;d be replacing <code>DuplicateHandle()</code> calls with <code>SetHandleInformation()</code> with <code>dwFlags</code> set to HANDLE_FLAG_INHERIT, and pass the Handles - <code>hOutputWrite</code>, <code>hInputRead</code>, <code>hErrorWrite</code> as an attribute list?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562716283, "post_id": 56955966, "comment_id": 100461172, "body": "security descriptor not play any role here at all, because you have already opened handles. so drop all code related to set  <i>SD</i>. <code>ERROR_BROKEN_PIPE</code> mean that other end (to wich you was connect) of pipe is closed. not need create 2 pipe pairs (4 handles) - enough 1 pipe pair - 2 handles only. in place <code>GetCurrentSessionId</code> use <code>WTSGetActiveConsoleSessionId</code>.."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562717302, "post_id": 56955966, "comment_id": 100461391, "body": "<i>I suspect the problem is somewhere in the permissions for the pipe</i> absolute wrong suspect"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562718116, "post_id": 56955966, "comment_id": 100461551, "body": "you have whole zoo of pipe handles - all this wrong and not need. not need use <code>CreatePipe</code> api (very bad design). create only 2 handles with <code>CreateNamedPipe</code> (<code>PIPE_ACCESS_DUPLEX</code>)+ <code>CreateFile</code>. you not need any duplicate or <code>SetHandleInformation</code> at all. just create client hand with inherited attribute and server without it."}, {"owner": {"reputation": 620, "user_id": 3856355, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d98c91290f61527628086a60948745a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tchinmai", "link": "https://stackoverflow.com/users/3856355/tchinmai"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562763041, "post_id": 56955966, "comment_id": 100478703, "body": "@RbMm Thanks for the clarification, is there an example implementation that you can link to?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562764521, "post_id": 56955966, "comment_id": 100479561, "body": "for exampe <a href=\"https://stackoverflow.com/questions/49327749/how-to-run-a-batch-file-and-read-output/49330919#49330919\">1</a> <a href=\"https://stackoverflow.com/questions/46611207/createprocess-cmd-exe-read-write-pipes-deadlock/46613238#46613238\">2</a> <a href=\"https://stackoverflow.com/questions/60645/overlapped-i-o-on-anonymous-pipe/51448441#51448441\">3</a> note that you not mandatory need use asynchronous io from server side, as i. can use and synhronous too. so 1.) create only 2 pipe handles. 2) set inherit attribute (on chile handle) already on create (so not need change it later). not need any SD"}, {"owner": {"reputation": 620, "user_id": 3856355, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d98c91290f61527628086a60948745a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tchinmai", "link": "https://stackoverflow.com/users/3856355/tchinmai"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562786330, "post_id": 56955966, "comment_id": 100490732, "body": "@RbMm I have modified the code per your suggestions, and I see a different problem, the parent is unable to read anything in the stdout/stderr of the child. There are no errors either."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562803417, "post_id": 56955966, "comment_id": 100495843, "body": "<i>| STARTF_USESHOWWINDOW;</i> - remove this - faster of all your process just exit with this flag. <code>if (SessionId == -1)</code> must be check. <code>PIPE_ACCESS_DUPLEX|FILE_READ_DATA|FILE_WRITE_DATA</code> - error - <code>PIPE_ACCESS_DUPLEX</code> must be alone"}, {"owner": {"reputation": 620, "user_id": 3856355, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d98c91290f61527628086a60948745a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tchinmai", "link": "https://stackoverflow.com/users/3856355/tchinmai"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562855548, "post_id": 56955966, "comment_id": 100517734, "body": "@RbMm still seeing the same issue after these changes. Unable to read anything from the child"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1562857346, "post_id": 56955966, "comment_id": 100518846, "body": "@Tchinmai - are you debug your code at all ? not need do this from service (you have no problem here). simply drop <code>WTSQueryUserToken</code> call and pass 0 in place <code>hToken</code> in <code>CreateProcessAsUser</code>. and <b>debug</b> . look are child is run. are it not exit just. <i>Unable to read anything from the child</i> - in sense ? which error ? and not use <code>PeekNamedPipe</code> too."}], "owner": {"reputation": 620, "user_id": 3856355, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d98c91290f61527628086a60948745a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tchinmai", "link": "https://stackoverflow.com/users/3856355/tchinmai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562855594, "creation_date": 1562686088, "last_edit_date": 1562855594, "question_id": 56955966, "link": "https://stackoverflow.com/questions/56955966/broken-pipe-when-reading-from-a-pipe-of-a-child-process-launched-as-a-different", "title": "Broken pipe when reading from a pipe of a child process launched as a different user", "body": "<p>I'm trying to launch a child executable to run as the logged in user(written in golang) from a windows service running as SYSTEM. I am using the <code>CreateProcessAsUser</code> method to start the process. I've observed that the child process actually starts, but i'm unable to read the stdout of it. I've followed the steps described in <a href=\"https://docs.microsoft.com/en-us/windows/win32/procthread/creating-a-child-process-with-redirected-input-and-output\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/procthread/creating-a-child-process-with-redirected-input-and-output</a> to redirect the stdin and stdout of the child.</p>\n\n<p>I have also set the permissions on the pipe to the Everyone SID, but still getting the same issue.</p>\n\n<p>The parent process's code is as follows (after further edits based on suggestions in the comments)</p>\n\n<pre><code>#include \"test.h\"\n#include &lt;windows.h&gt;\n#include &lt;winbase.h&gt;\n#include &lt;userenv.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;wtsapi32.h&gt;\n#include &lt;strsafe.h&gt;\n#include &lt;processthreadsapi.h&gt;\n\n#define BUFSIZE 4096 \n#define PROC_THREAD_ATTRIBUTE_HANDLE_LIST ( 2 | 0x00020000)\ntypedef struct _STARTUPINFOEXA {\n    STARTUPINFOA StartupInfo;\n    LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList;\n} STARTUPINFOEXA, *LPSTARTUPINFOEXA;\n\nvoid ReadAndHandleOutput(HANDLE hPipeRead, FILE* fp)\n{\n    CHAR lpBuffer[BUFSIZE];\n    DWORD nBytesRead;\n    DWORD bytesAvailable;\n    DWORD bytesLeftInMsg;\n    do\n    {\n        if (!PeekNamedPipe(hPipeRead, lpBuffer, sizeof(lpBuffer), &amp;nBytesRead, &amp;bytesAvailable, &amp;bytesLeftInMsg))\n        {\n            if (GetLastError() == ERROR_BROKEN_PIPE) {\n                fprintf(fp, \"Broken Pipe \\n\");\n                fflush(fp);\n                break; // pipe done - normal exit path.\n            }\n            else {\n                fprintf(fp, \"ReadFileError %d\\n\", GetLastError()); // Something bad happened.\n                fflush(fp);\n            }\n        }   \n    } while(bytesLeftInMsg &gt; 0);\n    fprintf(fp, \"GOT OUTPUT, %s -- %d -- %d -- %d\\n\", lpBuffer, nBytesRead, bytesAvailable, bytesLeftInMsg);\n    fflush(fp);\n}\n\nbool LaunchProcess(char *process_path)\n{\n    FILE *fp = fopen(\"C:\\\\test.log\", \"a\");\n    DWORD SessionId = WTSGetActiveConsoleSessionId();\n    if (SessionId == -1)  { // no-one logged in \n        fprintf(fp, \"Session ID is -1\\n\");\n        fclose(fp);\n        return false;\n    }\n\n    HANDLE hToken;\n    BOOL ok = WTSQueryUserToken(SessionId, &amp;hToken);\n    if (!ok) {\n        fprintf(fp, \"Unable to get the token for session id %d\\n\", SessionId);\n        fclose(fp);\n        return false;\n    }\n\n    void *environment = NULL;\n    ok = CreateEnvironmentBlock(&amp;environment, hToken, TRUE);\n\n    if (!ok)\n    {\n        fprintf(fp, \"Unable to create environment with session ID %d\\n\", SessionId);\n        CloseHandle(hToken);\n        fclose(fp);\n        return false;\n    }\n\n    HANDLE hServerPipe = CreateNamedPipe(\"\\\\\\\\.\\\\Pipe\\\\test-pipe.em\", PIPE_ACCESS_DUPLEX, PIPE_TYPE_BYTE|PIPE_READMODE_BYTE, 1, 0, 0, 0, 0);\n    HANDLE hClientPipe;\n    if (hServerPipe != INVALID_HANDLE_VALUE)\n    {\n        static SECURITY_ATTRIBUTES sa = { sizeof(sa), 0, TRUE };\n\n        hClientPipe = CreateFile(\"\\\\\\\\.\\\\Pipe\\\\test-pipe.em\", FILE_GENERIC_READ|FILE_GENERIC_WRITE, 0, &amp;sa, OPEN_EXISTING, 0, 0);\n\n        if (hClientPipe == INVALID_HANDLE_VALUE)\n        {\n            fprintf(fp, \"Error creating client handle %d\", GetLastError());\n            CloseHandle(hServerPipe);\n            return false;\n        }\n    } else {\n        fprintf(fp, \"Error creating server handle %d\", GetLastError());\n        return false;\n    }\n\n    STARTUPINFOEXA si = { { sizeof(si) } };\n    PROCESS_INFORMATION pi;\n    si.StartupInfo.dwFlags = STARTF_USESTDHANDLES;\n    si.StartupInfo.hStdInput = si.StartupInfo.hStdOutput = si.StartupInfo.hStdError = hClientPipe;\n    DWORD dwCreationFlags = CREATE_NO_WINDOW | CREATE_UNICODE_ENVIRONMENT;\n\n    BOOL fInit = FALSE;\n    SIZE_T Size;\n    if (!InitializeProcThreadAttributeList(0, 1, 0, &amp;Size) &amp;&amp; GetLastError() == ERROR_INSUFFICIENT_BUFFER &amp;&amp;\n            InitializeProcThreadAttributeList(si.lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)alloca(Size), 1, 0, &amp;Size))\n    {\n        fInit = TRUE;\n        if (UpdateProcThreadAttribute(si.lpAttributeList, 0, PROC_THREAD_ATTRIBUTE_HANDLE_LIST, &amp;si.StartupInfo.hStdError, sizeof(HANDLE), 0, 0)) {\n                dwCreationFlags |= EXTENDED_STARTUPINFO_PRESENT;\n        }\n    }\n\n    fprintf(fp, \"calling the process %s\\n\", process_path);\n    fflush(fp);\n    ok = CreateProcessAsUser(hToken, NULL, process_path, NULL, NULL, TRUE, dwCreationFlags, environment, NULL, &amp;si.StartupInfo, &amp;pi);\n    fprintf(fp, \"Running process %s and %d with PID %d\\n\", process_path, ok, pi.dwProcessId);\n    fflush(fp);\n    if (!ok) {\n        wchar_t buf[BUFSIZE];\n        FormatMessageW(FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,\n               NULL, GetLastError(), MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), \n               buf, (sizeof(buf) / sizeof(wchar_t)), NULL);\n\n        fprintf(fp, \"Failed to create processes as user - %d, %d, %S, %s\\n\", SessionId, GetLastError(), buf, process_path);\n        fclose(fp);\n\n        return false;\n    } else {\n        CloseHandle(pi.hThread);\n        CloseHandle(pi.hProcess);\n    }\n\n    // Close pipe handles (do not continue to modify the parent).\n    // You need to make sure that no handles to the write end of the\n    // output pipe are maintained in this process or else the pipe will\n    // not close when the child process exits and the ReadFile will hang.\n    if (!CloseHandle(si.StartupInfo.hStdError)) {\n        fprintf(fp, \"CloseHandle - outputwrite Error %d\\n\", GetLastError());   \n        fclose(fp);\n        return false;    \n    } \n    ReadAndHandleOutput(hServerPipe, fp);\n\n    CloseHandle(hServerPipe);\n    fclose(fp);\n    return true;\n\nCleanup:\n    fprintf(fp, \"Something went wrong\");\n    fclose(fp);\n    return false;\n}\n</code></pre>\n\n<p>The child process's code is as follows</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    os.Stdout.Write([]byte(\"Hello from the GO side...\"))\n    f, err := os.OpenFile(\"C:\\\\log.text\", os.O_APPEND|os.O_WRONLY, 0600)\n    if err != nil {\n        panic(err)\n    }\n\n    defer f.Close()\n    var output = fmt.Sprintf(\"I'm running as %d launched by %d\", os.Getpid(), os.Getppid())\n    if _, err = f.WriteString(output); err != nil {\n        panic(err)\n    }\n    os.Stdout.Close()\n}\n\n</code></pre>\n\n<p>I'm able to see the current PID and the parent's PID(the service) in the log.text file, However I keep getting a pipe broken error on the parent side.</p>\n\n<p>Any pointers are appreciated</p>\n"}, {"tags": ["go", "gota"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "edited": false, "score": 0, "creation_date": 1562681768, "post_id": 56954464, "comment_id": 100447527, "body": "this is working for a list, my problem is about gota series. is there any way to convert series to list?  ./prog.go:27:35: cannot use new_series (type series.Series) as type []string in argument to setFromList"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "edited": false, "score": 0, "creation_date": 1562683795, "post_id": 56954464, "comment_id": 100448854, "body": "updated answer to create a unique series from an existing series - and preserve name and type."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1562684078, "last_edit_date": 1562684078, "creation_date": 1562681262, "answer_id": 56954464, "question_id": 56953626, "link": "https://stackoverflow.com/questions/56953626/removing-duplicate-values-of-gota-series/56954464#56954464", "title": "Removing duplicate values of gota series", "body": "<p>To represent a unique set of elements in <code>go</code>, use a <code>map</code>.</p>\n\n<p>So to create a unique set of strings from a given list, use something like:</p>\n\n<pre><code>func setFromList(list []string) (set []string) {\n    ks := make(map[string]bool) // map to keep track of repeats\n\n    for _, e := range list {\n        if _, v := ks[e]; !v {\n            ks[e] = true\n            set = append(set, e)\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>and to apply this to an existing <code>gota.Series</code>:</p>\n\n<pre><code>func uniqueGotaSeries(s series.Series) series.Series {\n    return series.New(setFromList(s.Records()), s.Type(), s.Name)\n}\n</code></pre>\n\n<p>Working playground example: <a href=\"https://play.golang.org/p/zqQM-0XxLF5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zqQM-0XxLF5</a></p>\n\n<p>Output:</p>\n\n<pre><code>Orig: [b a c a d b]\nUnique: [b a c d]\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 56954464, "answer_count": 1, "score": 1, "last_activity_date": 1562684078, "creation_date": 1562678556, "question_id": 56953626, "link": "https://stackoverflow.com/questions/56953626/removing-duplicate-values-of-gota-series", "title": "Removing duplicate values of gota series", "body": "<p>I have a simple gota series and I want to remove duplicate from it.\nhow it is possible in go?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n\n    new_series := series.New([]string{\"b\", \"a\", \"c\", \"a\", \"d\", \"b\"}, series.String, \"COL.1\")\n    fmt.Println(new_series)\n}\n</code></pre>\n\n<p>[b a c a d b]</p>\n\n<p>expected: [b a c d]</p>\n"}, {"tags": ["bash", "go", "operating-system", "systemd", "systemctl"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562678856, "post_id": 56953623, "comment_id": 100445716, "body": "So your question is simply &quot;How can I detach it from the of scope of systemd service?&quot;?"}, {"owner": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562681664, "post_id": 56953623, "comment_id": 100447449, "body": "@Flimzy Yes but I felt it was important to elaborate on the issue."}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "edited": false, "score": 0, "creation_date": 1562742023, "post_id": 56954110, "comment_id": 100467268, "body": "systemd-run forces me to use absolute paths in the script and I feel it is not the right way to proceed. It doesnt seem to have the &quot;--working-dir&quot; option like systemctl"}, {"owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "reply_to_user": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "edited": false, "score": 0, "creation_date": 1562742752, "post_id": 56954110, "comment_id": 100467645, "body": "<a href=\"https://www.freedesktop.org/software/systemd/man/systemd-run.html#--working-directory=\" rel=\"nofollow noreferrer\">--working-directory</a> is documented in the man-page and does not seem to work, at least not in my case. You can give the script the current working directory path as an argument and have it cd there before doing anything else."}, {"owner": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "edited": false, "score": 0, "creation_date": 1563169449, "post_id": 56954110, "comment_id": 100596162, "body": "Fabian thank you for the solution. systemd-run does solve the problem but does have a few drawbacks. I&#39;m currently looking into how I can bring the logs of the systemd-run unit and systemctl service under same unit."}, {"owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "reply_to_user": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "edited": false, "score": 0, "creation_date": 1563178642, "post_id": 56954110, "comment_id": 100599851, "body": "@achilles I do not know how you would tie two together. But another solution could be to make the updater the dominant process who starts the Golang app and messages it with an Interrupt-Signal if it should shut down. Then wait for it to shut down, update the binary and start it up again, all from the updater systemd unit. Or you could try <a href=\"https://stackoverflow.com/questions/32208782/cant-detach-child-process-when-main-process-is-started-from-systemd\">KillMode</a> to not have the updater die?"}, {"owner": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "edited": false, "score": 1, "creation_date": 1563278886, "post_id": 56954110, "comment_id": 100639423, "body": "Fabian I was able to tie the two together using the command : journalctl _SYSTEMD_UNIT=cantizconnect.service + SYSLOG_IDENTIFIER=cantizconnect"}, {"owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "reply_to_user": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "edited": false, "score": 0, "creation_date": 1563286922, "post_id": 56954110, "comment_id": 100644472, "body": "@achilles nice!"}], "tags": [], "owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "is_accepted": true, "score": 1, "last_activity_date": 1562680124, "creation_date": 1562680124, "answer_id": 56954110, "question_id": 56953623, "link": "https://stackoverflow.com/questions/56953623/go-application-run-as-systemd-service/56954110#56954110", "title": "Go application run as systemd service", "body": "<blockquote>\n  <p>invokes an autoupdate bash script present in the same working directory as the executable.</p>\n</blockquote>\n\n<p>I would recommend running it with <a href=\"https://www.linux.org/docs/man1/systemd-run.html\" rel=\"nofollow noreferrer\">systemd-run</a>. Excerpt from the man-page:</p>\n\n<blockquote>\n  <p>It will run in a\n         clean and detached execution environment.</p>\n</blockquote>\n"}], "owner": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1921, "favorite_count": 1, "accepted_answer_id": 56954110, "answer_count": 1, "score": 3, "last_activity_date": 1562680479, "creation_date": 1562678546, "last_edit_date": 1562680479, "question_id": 56953623, "link": "https://stackoverflow.com/questions/56953623/go-application-run-as-systemd-service", "title": "Go application run as systemd service", "body": "<p>We are running a Golang application that internally runs an autoupdate module to recieve over the air updates. At the time of a new update, the autoupdate module downloads the new version from s3 and invokes an autoupdate bash script present in the same working directory as the executable. The steps performed by the autoupdate bash script are explained in terms of process management handled with and without systemd.</p>\n\n<p><strong>Execution without Systemd</strong></p>\n\n<ol>\n<li>Kills the currently running golang app via PID</li>\n<li>Runs the newly downloaded golang binary.</li>\n<li>The new version exposes an health check API which is invoked by script to makesure this version is healthy.</li>\n<li>If not healthy, rollback is performed. The new version is stopped and older version is started.</li>\n</ol>\n\n<p>In golang, the script execution code is written such that when autoupdate script is invoked, it is disowned from the lifecycle of the golang application. i.e bash script (child process) continues execution even after the parent(golang app) is killed. It works fine when running from the GoLand IDE.</p>\n\n<p><strong>Issue : Execution via Systemd</strong></p>\n\n<p>We needed a cleaner system to handle the start ,stop, restart-on failure functionalities. So we decided to run the app as a systemd service.The steps are the same as above but performed using systemctl</p>\n\n<ol>\n<li>Kills the currently running golang app : \"systemctl stop goapp.service\"</li>\n<li>Updates the systemd service with the new executable path : \"systemctl daemon-reload\"</li>\n<li>Restarts the systemd service : \"systemctl restart goapp.service\"</li>\n<li>If not healthy, rollback is performed. The new version is stopped, systemd service file is updated with older version and older version is started.</li>\n</ol>\n\n<p>On executing the application via systemd, <em>the script exits as soon as the systemctl service is stopped using command \"sudo systemctl stop goapp.service\" during step 1 mentioned above</em>. This means that the lifecycle of the script executed by the golang app is clearly coupled to the lifecycle of the systemd service. How can I detach it from the of scope of systemd service?</p>\n\n<p><strong>Systemd service file</strong></p>\n\n<pre><code>[Unit]\nDescription=Goapp\nAfter=docker.service\nRequires=docker.service\nRequires=docker-mysql.service\nRequires=docker-redis.service\nStartLimitInterval=200\nStartLimitBurst=5\n\n[Service]\nUser=root\nEnvironment=AWS_SHARED_CREDENTIALS_FILE=/home/username/.aws/credentials\nRestart=on-failure\nRestartSec=30\nWorkingDirectory=/home/username/go/src/goapp-v2.0.0\nExecStart=/home/username/go/src/goapp-v2.0.0/goexecutable --autoupdate=true\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<p><strong>The Golang code section that invokes the autoupdate bashscript</strong></p>\n\n<pre><code>func scriptExecutor(argsliceString []string, remoteVersion *semver.Version, localVersion *semver.Version) {\n\nnewVersion := fmt.Sprint(remoteVersion)\npreviousVersion := fmt.Sprint(localVersion)\nargslice := append(argsliceString, newVersion, previousVersion)\nscriptParams := append([]string{\"./autoupdate-script.sh\"}, argslice...)\nInfo(\"Autoupdater - New version \", newVersion)\nInfo(\"Autoupdater - Existing Version \", previousVersion)\nInfo(\"Autoupdater - Executing shell script to upgrade go app.Passing parameters \", scriptParams) // ./autoupdate-script.sh goexecutable 7.1.0 7.0.0\ncmd := exec.Command(\"sudo\", scriptParams...)\nerr := cmd.Start()\nif err!=nil{\n    Info(err)\n}\ncmd.Process.Release()\n</code></pre>\n\n<p>}</p>\n\n<p>Posts on \"how to run a script in Golang and disown/detach it\" have been posted but could not find any posts on this type of an issue. Please help me resolve the issue or correct me if there are any errors in my understanding.</p>\n"}, {"tags": ["go", "ssh", "x11", "x11-forwarding"], "comments": [{"owner": {"reputation": 18507, "user_id": 13317, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/47a9a5b4589057085336011863d2ee9a?s=128&d=identicon&r=PG", "display_name": "Kenster", "link": "https://stackoverflow.com/users/13317/kenster"}, "edited": false, "score": 1, "creation_date": 1562677835, "post_id": 56953203, "comment_id": 100445101, "body": "&quot;...but fails with OpenChannel.&quot; This isn&#39;t very informative. What exactly happens then? Is the server logging any useful error messages?"}, {"owner": {"reputation": 11, "user_id": 11142107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19312b5de92906d5cf7e74ea2534e5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Naofumi Uesugi", "link": "https://stackoverflow.com/users/11142107/naofumi-uesugi"}, "reply_to_user": {"reputation": 18507, "user_id": 13317, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/47a9a5b4589057085336011863d2ee9a?s=128&d=identicon&r=PG", "display_name": "Kenster", "link": "https://stackoverflow.com/users/13317/kenster"}, "edited": false, "score": 0, "creation_date": 1562681325, "post_id": 56953203, "comment_id": 100447243, "body": "sorry. I added sshd side debug log."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11142107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19312b5de92906d5cf7e74ea2534e5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Naofumi Uesugi", "link": "https://stackoverflow.com/users/11142107/naofumi-uesugi"}, "edited": false, "score": 0, "creation_date": 1562742591, "post_id": 56957403, "comment_id": 100467565, "body": "Thank you very much! It seems that I misunderstood it! It was possible to implement based on what you taught!"}], "tags": [], "owner": {"reputation": 18507, "user_id": 13317, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/47a9a5b4589057085336011863d2ee9a?s=128&d=identicon&r=PG", "display_name": "Kenster", "link": "https://stackoverflow.com/users/13317/kenster"}, "is_accepted": false, "score": 1, "last_activity_date": 1562692352, "last_edit_date": 1562692352, "creation_date": 1562691538, "answer_id": 56957403, "question_id": 56953203, "link": "https://stackoverflow.com/questions/56953203/how-to-do-simple-ssh-x11-forwarding/56957403#56957403", "title": "How to do simple SSH x11 forwarding", "body": "<pre><code>// x11 OpenChannel (Not working...)\nx11Data := x11channel{\n    Host: \"localhost\",\n    Port: uint32(6000),\n}\n\nsshChan, req, x11err := client.OpenChannel(\"x11\", ssh.Marshal(x11Data))\n</code></pre>\n\n<p>The fundamental issue here is that X11 forwarding channels are initiated from the SSH server to the SSH client. You're trying to open an X11 channel from the client to the server. This isn't supported by your server, and it isn't the usual way to use X forwarding.</p>\n\n<p>I'm not a go programmer. But after looking <a href=\"https://godoc.org/golang.org/x/crypto/ssh\" rel=\"nofollow noreferrer\">the documentation</a>, after your send your x11-req it looks like you would call <a href=\"https://godoc.org/golang.org/x/crypto/ssh#Client.HandleChannelOpen\" rel=\"nofollow noreferrer\">client.HandleChannelOpen()</a> to receive X11 channel requests coming from the server.</p>\n\n<p>More background: To be clear, start with the terminology. Your program is an <em>ssh client</em> and it connects to an <em>ssh server</em>. With X, the <em>server</em> is the program which controls a display, keyboard, and mouse. <em>X clients</em> are programs like xterm and xeyes which connect to a server to display windows and do similar things.</p>\n\n<p>When you want to forward X11 through SSH, the ssh client will send an X11 request to the ssh server. This tells the server that the client wants X11 forwarding for the connection. The server will perform some setup and open a TCP listening port to receive connections from X clients.</p>\n\n<p>When an X client connects to the ssh server's X11 listening port, the ssh server will open a channel back to the ssh client. The ssh client will connect to the local X server, and the ssh client and ssh server will relay data between the X server (local to the ssh client host) and the X client (local to the ssh server host). Each channel handles a single X client.</p>\n\n<p>So a program such as yours has to send a request to the server, signalling that your program wants to forward X11 through the ssh connection. The actual x11 channels will be opened on demand from the ssh server to the ssh client when an X client tries to use the forwarded X11 service.</p>\n"}], "owner": {"reputation": 11, "user_id": 11142107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19312b5de92906d5cf7e74ea2534e5b1?s=128&d=identicon&r=PG&f=1", "display_name": "Naofumi Uesugi", "link": "https://stackoverflow.com/users/11142107/naofumi-uesugi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562742703, "creation_date": 1562677237, "last_edit_date": 1562742703, "question_id": 56953203, "link": "https://stackoverflow.com/questions/56953203/how-to-do-simple-ssh-x11-forwarding", "title": "How to do simple SSH x11 forwarding", "body": "<p>I'm trying to implement ssh x11 forwarding in Go, referring to Paramiko's source, but it does not work well.</p>\n\n<p>The x11-req request seems to be successful, but fails with OpenChannel.\nIsn't there any better way?</p>\n\n<p><a href=\"https://tools.ietf.org/html/rfc4254#section-6.3.2\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc4254#section-6.3.2</a></p>\n\n<p>The full code is here.</p>\n\n<p><a href=\"https://gist.github.com/blacknon/6e2e6e2c0ebcd64c381925f0e3e86e42\" rel=\"nofollow noreferrer\">https://gist.github.com/blacknon/6e2e6e2c0ebcd64c381925f0e3e86e42</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\n(omit)\n\nfunc main() {\n    // Create sshClientConfig\n    sshConfig := &amp;ssh.ClientConfig{\n        User: user,\n        Auth: []ssh.AuthMethod{\n            ssh.Password(pass),\n        },\n        HostKeyCallback: ssh.InsecureIgnoreHostKey(),\n    }\n\n    // SSH connect.\n    client, err := ssh.Dial(\"tcp\", host+\":\"+port, sshConfig)\n\n    // Create Session\n    session, err := client.NewSession()\n    defer session.Close()\n\n    // NOTE:\n    // x11-req Payload\n    payload := x11request{\n        SingleConnection: false,\n        AuthProtocol:     string(\"MIT-MAGIC-COOKIE-1\"),\n        AuthCookie:       string(\"d92c30482cc3d2de61888961deb74c08\"),\n        ScreenNumber:     uint32(0),\n    }\n\n    // NOTE:\n    // send x11-req Request\n    ok, err := session.SendRequest(\"x11-req\", true, ssh.Marshal(payload))\n    if err == nil &amp;&amp; !ok {\n        fmt.Println(errors.New(\"ssh: x11-req failed\"))\n    }\n    fmt.Printf(\"x11-req: %v\\n\", ok)\n    fmt.Println(\"-----\")\n\n    // x11 OpenChannel (Not working...)\n    x11Data := x11channel{\n        Host: \"localhost\",\n        Port: uint32(6000),\n    }\n\n    sshChan, req, x11err := client.OpenChannel(\"x11\", ssh.Marshal(x11Data))\n    fmt.Println(sshChan) // DEBUG\n    fmt.Println(req)     // DEBUG\n    fmt.Println(x11err)  // DEBUG\n\n    (omit)\n}\n\n</code></pre>\n\n<p>I added sshd side debug log.</p>\n\n<pre><code>sshd[1811]: debug1: server_input_channel_req: channel 0 request x11-req reply 1\nsshd[1811]: debug1: session_by_channel: session 0 channel 0\nsshd[1811]: debug1: session_input_channel_req: session 0 req x11-req\nsshd[1811]: debug1: channel 1: new [X11 inet listener]\nsshd[1811]: debug1: channel 2: new [X11 inet listener]\nsshd[1811]: debug1: server_input_channel_open: ctype x11 rchan 1 win 2097152 max 32768\nsshd[1811]: debug1: server_input_channel_open: failure x11\n</code></pre>\n\n<p>Thanks guys! Thanks to it, I was able to implement it safely. Have a working code.</p>\n\n<p><a href=\"https://gist.github.com/blacknon/9eca2e2b5462f71474e1101179847d2a\" rel=\"nofollow noreferrer\">https://gist.github.com/blacknon/9eca2e2b5462f71474e1101179847d2a</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1562675482, "post_id": 56952520, "comment_id": 100443714, "body": "You are storing a copy of the struct; the <code>Conn</code> type is not a pointer."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1562675840, "post_id": 56952520, "comment_id": 100443932, "body": "How it works &quot;under the hood&quot; is an implementation detail, and may differ by implementation. What matters, from a language spec standpoint, is the behavior. And a <code>map[string]Conn</code> is a map of objects, whereas <code>map[string]*Conn</code> is a map of pointers to objects."}], "answers": [{"tags": [], "owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "is_accepted": true, "score": 5, "last_activity_date": 1562679776, "last_edit_date": 1562679776, "creation_date": 1562675928, "answer_id": 56952795, "question_id": 56952520, "link": "https://stackoverflow.com/questions/56952520/does-go-store-objects-in-map-by-value-or-as-pointers/56952795#56952795", "title": "Does Go store objects in map by value or as pointers?", "body": "<p><code>struct</code>s are stored by value. Accesses to <code>conns[\"127.0.0.1\"]</code> will give you a <em>copy</em> of the <code>Conn</code> struct.</p>\n\n<p>If you try to modify the struct like this, the struct at <code>conns[\"127.0.0.1\"]</code> will remain unchanged until you overwrite the map entry with the newly modified struct:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>c := conns[\"127.0.0.1\"]\nc.x = y\n\n// `c` now contains different content to `conns[\"127.0.0.1\"]`!\n\n// To ensure conns[\"127.0.0.1\"] is updated, either overwrite or use a point.\nconns[\"127.0.0.1\"] = c // overwrite\n</code></pre>\n\n<p>This is why when you modify the struct, the struct in the map remains unchanged until you overwrite the map entry with the new struct.</p>\n\n<p>Instead, you can store the pointer to the struct. This allows direct modification of the struct.</p>\n\n<p>So if you change the type of <code>conns</code> from <code>map[string]Conn</code> to <code>map[string]*Conn</code>, the first two lines of the above code would update the struct in the map.</p>\n\n<p>More information can be found here: <a href=\"https://www.ardanlabs.com/blog/2017/07/interface-semantics.html\" rel=\"nofollow noreferrer\">https://www.ardanlabs.com/blog/2017/07/interface-semantics.html</a></p>\n"}], "owner": {"reputation": 7035, "user_id": 2945958, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/K4Ig3.jpg?s=128&g=1", "display_name": "Mostafa Talebi", "link": "https://stackoverflow.com/users/2945958/mostafa-talebi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 56952795, "answer_count": 1, "score": -2, "last_activity_date": 1618443945, "creation_date": 1562675026, "last_edit_date": 1562675703, "question_id": 56952520, "link": "https://stackoverflow.com/questions/56952520/does-go-store-objects-in-map-by-value-or-as-pointers", "title": "Does Go store objects in map by value or as pointers?", "body": "<p>I have the following map:</p>\n\n<pre><code>var conns map[string]Conn\n</code></pre>\n\n<p>Where as you know, <code>Conn</code> is a custom type. And my map stores values of types Conn, as the declaration shows.\nFor storing them in a map, I do this:</p>\n\n<pre><code>conns[\"127.0.0.1\"] = Conn{}\n</code></pre>\n\n<p>But my question is does Go, under the hood, store a pointer to the <code>Conn</code> object or it actually stores the value? </p>\n"}, {"tags": ["go", "compression", "gzip", "eof", "gob"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562669225, "post_id": 56950371, "comment_id": 100440252, "body": "What is your question, then? Just whether <code>gob</code> is appropriate or more efficient? Or do you have some specific problem with your code?"}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562669432, "post_id": 56950371, "comment_id": 100440374, "body": "When I try to recover the initial int array after Gob-&gt;compress-&gt;expand-&gt;Gob I get an EOF - i.e its not restoring to the original int array"}], "answers": [{"comments": [{"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "edited": false, "score": 0, "creation_date": 1562669996, "post_id": 56951021, "comment_id": 100440701, "body": "excellent thanks alot. Reading about flush now, but will remove the writer from the process. Edit: Is there a way to know when compression becomes valuable? And is using gob necessary to save a []int that is not worth compressing?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "edited": false, "score": 0, "creation_date": 1562670978, "post_id": 56951021, "comment_id": 100441221, "body": "@amlwwalker When it becomes &quot;valueable&quot;: measure. It depends on the input. Some input may be compressed better. The <code>gob</code> is not necessary, actually it just ads both computational and spatial overhead. If you still want to compress, just use <code>encoding&#47;binary</code> to convert integers to bytes (which you can write to the <code>gzip</code> stream). Also note that you should not use <code>int</code> as its size depends on the architecture, but instead fix-sized integers like <code>int32</code> or <code>int64</code>."}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "edited": false, "score": 0, "creation_date": 1562672297, "post_id": 56951021, "comment_id": 100441865, "body": "Cool, so getting rid of gob then sounds like a good idea. I think I&#39;m pretty close, its using encoding/binary to convert it back to the []int64 after compression that is failing for me - I get an empty array after reading into the []int64. Any chance you can take a look? <a href=\"https://play.golang.org/p/NRimlw4Udss\" rel=\"nofollow noreferrer\">play.golang.org/p/NRimlw4Udss</a>"}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "edited": false, "score": 0, "creation_date": 1562672732, "post_id": 56951021, "comment_id": 100442102, "body": "hmm issue maybe I need to know the size of the array first? gob can handle that? encoding/binary cant? - EDIT - yes this seems to be it. Hmmm. Does that mean I need to persist the length of the original []int64 then or can it be &quot;worked out&quot; on the fly? <a href=\"https://play.golang.org/p/cayXw7fCcK2\" rel=\"nofollow noreferrer\">play.golang.org/p/cayXw7fCcK2</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "edited": false, "score": 0, "creation_date": 1562673039, "post_id": 56951021, "comment_id": 100442281, "body": "@amlwwalker Length of a value of type <code>[]int64</code> is not fixed, so you have to persist the length yourself. <code>gob</code> takes care of that for you."}, {"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "edited": false, "score": 0, "creation_date": 1562673097, "post_id": 56951021, "comment_id": 100442310, "body": "Thats the ticket then. Save overhead by not using gob, and just persist the length. Thanks for all your help"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1562670845, "last_edit_date": 1562670845, "creation_date": 1562669808, "answer_id": 56951021, "question_id": 56950371, "link": "https://stackoverflow.com/questions/56950371/convert-int-array-to-byte-array-compress-it-then-reverse-it/56951021#56951021", "title": "Convert int array to byte array, compress it then reverse it", "body": "<p>You are using <a href=\"https://golang.org/pkg/bufio/#Writer\" rel=\"nofollow noreferrer\"><code>bufio.Writer</code></a> which\u2013as its name implies\u2013<em>buffers</em> bytes written to it. This means if you're using it, you have to <em>flush</em> it to make sure buffered data makes its way to the underlying writer:</p>\n\n<pre><code>writer := bufio.NewWriter(&amp;indexBuffer)\nencoder := gob.NewEncoder(writer)\nif err := encoder.Encode(arry); err != nil {\n    panic(err)\n}\nif err := writer.Flush(); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Although the use of <code>bufio.Writer</code> is completely unnecessary as you're already writing to an in-memory buffer (<a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow noreferrer\"><code>bytes.Buffer</code></a>), so just skip that, and write directly to <code>bytes.Buffer</code> (and so you don't even have to flush):</p>\n\n<pre><code>var indexBuffer bytes.Buffer\nencoder := gob.NewEncoder(&amp;indexBuffer)\nif err := encoder.Encode(arry); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>The next error is how you close the gzip stream:</p>\n\n<pre><code>defer compressor.Close()\n</code></pre>\n\n<p>This deferred closing will only happen when the enclosing function (the <code>main()</code> function) returns, not a second earlier. But by that time you already wanted to read the zipped data, but that might still sit in an internal cache of <a href=\"https://golang.org/pkg/compress/gzip/#Writer\" rel=\"nofollow noreferrer\"><code>gzip.Writer</code></a>, and not in <code>compressionBuffer</code>, so you obviously can't read the compressed data from <code>compressionBuffer</code>. Close the gzip stream without using <code>defer</code>:</p>\n\n<pre><code>if err := compressor.Close(); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>With these changes, you program runs and outputs (try it on the <a href=\"https://play.golang.org/p/aT8KiEQXQG7\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>byte array before unzipping:  [31 139 8 0 0 0 0 0 0 255 226 249 223 200 196 200 244 191 137 129 145 133 129 129 243 127 19 3 43 19 11 27 7 23 32 0 0 255 255 110 125 126 12 23 0 0 0]\nfinal int Array content:  [1 2 3 4 5]\n</code></pre>\n\n<p><sup>As a side note: <code>buf := bytes.NewBuffer(compressionBuffer.Bytes())</code> \u2013 this <code>buf</code> is also completely unnecessary, you can just start decoding <code>compressionBuffer</code> itself, you can read data from it that was previously written to it.</sup></p>\n\n<p>As you might have noticed, the compressed data is much larger than the initial, compressed data. There are several reasons: both <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\"><code>encoding/gob</code></a> and <a href=\"https://golang.org/pkg/compress/gzip/\" rel=\"nofollow noreferrer\"><code>compress/gzip</code></a> streams have significant overhead, and they (may) only make input smaller on a larger scale (5 int numbers don't qualify to this).</p>\n\n<p>Please check related question: <a href=\"https://stackoverflow.com/questions/37618399/efficient-go-serialization-of-struct-to-disk/37620399#37620399\">Efficient Go serialization of struct to disk</a></p>\n\n<p>For small arrays, you may also consider <a href=\"https://en.wikipedia.org/wiki/Variable-length_code\" rel=\"nofollow noreferrer\">variable-length encoding</a>, see <a href=\"https://golang.org/pkg/encoding/binary/#PutVarint\" rel=\"nofollow noreferrer\"><code>binary.PutVarint()</code></a>.</p>\n"}], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 56951021, "answer_count": 1, "score": 1, "last_activity_date": 1562670845, "creation_date": 1562667502, "last_edit_date": 1562669164, "question_id": 56950371, "link": "https://stackoverflow.com/questions/56950371/convert-int-array-to-byte-array-compress-it-then-reverse-it", "title": "Convert int array to byte array, compress it then reverse it", "body": "<p>I have a large int array that I want to persist on the filesystem. My understanding is the best way to store something like this is to use the <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">gob</a> package to convert it to a byte array and then to compress it with <a href=\"https://golang.org/pkg/compress/gzip/\" rel=\"nofollow noreferrer\">gzip</a>.\nWhen I need it again, I reverse the process. I am pretty sure I am storing it correctly, however recovering it is failing with EOF. Long story short, I have some example code below that demonstrates the issue. (playground link here <a href=\"https://play.golang.org/p/v4rGGeVkLNh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/v4rGGeVkLNh</a>).\nI am not convinced gob is needed, however reading around it seems that its more efficient to store it as a byte array than an int array, but that may not be true. Thanks!</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"compress/gzip\"\n    \"encoding/gob\"\n    \"fmt\"\n)\n\nfunc main() {\n    arry := []int{1, 2, 3, 4, 5}\n    //now gob this\n    var indexBuffer bytes.Buffer\n    writer := bufio.NewWriter(&amp;indexBuffer)\n    encoder := gob.NewEncoder(writer)\n    if err := encoder.Encode(arry); err != nil {\n        panic(err)\n    }\n    //now compress it\n    var compressionBuffer bytes.Buffer\n    compressor := gzip.NewWriter(&amp;compressionBuffer)\n    compressor.Write(indexBuffer.Bytes())\n    defer compressor.Close()\n    //&lt;--- I think all is good until here\n\n    //now decompress it\n    buf := bytes.NewBuffer(compressionBuffer.Bytes())\n    fmt.Println(\"byte array before unzipping: \", buf.Bytes())\n    if reader, err := gzip.NewReader(buf); err != nil {\n        fmt.Println(\"gzip failed \", err)\n        panic(err)\n    } else {\n        //now ungob it...\n        var intArray []int\n        decoder := gob.NewDecoder(reader)\n        defer reader.Close()\n        if err := decoder.Decode(&amp;intArray); err != nil {\n            fmt.Println(\"gob failed \", err)\n            panic(err)\n        }\n        fmt.Println(\"final int Array content: \", intArray)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "cloudflare"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1562677352, "post_id": 56949575, "comment_id": 100444814, "body": "Do you need ID of video or full link is also enough? If link is enough you probably can get this URL via <code>uploader.Url()</code> method."}, {"owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1562691171, "post_id": 56949575, "comment_id": 100452934, "body": "So I get get video ID by parsing url?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1562697899, "post_id": 56949575, "comment_id": 100455703, "body": "I think that in this url the last part after <code>&#47;</code> is video ID. So url will look like <code>https:&#47;&#47;api.cloudflare.com&#47;client&#47;v4&#47;accounts&#47;{accountID}&#47;me&zwnj;&#8203;dia&#47;{videoID}</code> and yes you can probably fetch information via this url."}], "owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562666558, "creation_date": 1562664864, "last_edit_date": 1562666558, "question_id": 56949575, "link": "https://stackoverflow.com/questions/56949575/how-to-get-video-id-from-cloudflare-or-post-it-with-generated-id", "title": "How to get Video ID from CloudFlare or post it with generated ID?", "body": "<p>I upload a video to CloudFlare with Golang and I need to get video ID.</p>\n\n<p>CloudFlare Upload docs: <a href=\"https://developers.cloudflare.com/stream/getting-started/uploading-golang/\" rel=\"nofollow noreferrer\">link</a></p>\n\n<p>I think there are two ways:\n1. Get ID after video will be uploaded\n2. Upload video with ID, which I generate on my backend</p>\n\n<p>I have spent several days trying to find some information about it, but I could not</p>\n\n<p>Here is my Golang code for uploading Video file:</p>\n\n<pre><code>// get file from request\nfile, err := c.FormFile(\"file\")\nif err != nil {\n    log.Errorf(\"get file error: %s\", err)\n    return c.JSONStatus(http.StatusBadRequest)\n}\n\nsourceFile, err := file.Open()\nif err != nil {\n    log.Errorf(\"open file error: %s\", err)\n    return c.JSONStatus(http.StatusInternalServerError)\n}\n\nfileBytes, err := ioutil.ReadAll(sourceFile)\nif err != nil {\n    fmt.Println(err)\n}\n\n// Here I generate Video ID (which I save to my DB)\nfileName := uuid.New().String()\n\n// Upload to CloudFlare\nheaders := make(http.Header)\nheaders.Add(\"X-Auth-Email\", \"***\")\nheaders.Add(\"X-Auth-Key\", \"***\")\n\nconfig := &amp;tus.Config{\n    ChunkSize:           5 * 1024 * 1024,\n    Resume:              false,\n    OverridePatchMethod: false,\n    Store:               nil,\n    Header:              headers,\n}\n\nclient, err := tus.NewClient(\"https://api.cloudflare.com/client/v4/accounts/\"+ accountID +\"/media\", config) // I have tried to add /id after /media but I got 400 status code\nif err != nil {\n    log.Errorf(\"create upload client error: %s\", err)\n    return c.JSONStatus(http.StatusInternalServerError)\n}\n\nupload := tus.NewUploadFromBytes(fileBytes)\n\nuploader, err := client.CreateUpload(upload)\nif err != nil {\n    log.Errorf(\"create upload error: %s\", err)\n    return c.JSONStatus(http.StatusInternalServerError)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562664339, "post_id": 56949354, "comment_id": 100437773, "body": "You may use <code>reflect.Type</code> as the type of the 2nd parameter. Does that suit you? But then you have to call it like: <code>checkType(&quot;hello&quot;, reflect.TypeOf(0))</code> for <code>int</code>. All in all, I don&#39;t see the benefit if this function."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1562664478, "post_id": 56949354, "comment_id": 100437849, "body": "Can you also explain what you need this for? The reason I&#39;m asking is the need to to what you&#39;re after is a clear &quot;code smell&quot; in Go: you might be trying to solve a problem in a wrong way, and we may be currently experiencing a case of <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY problem</a>."}, {"owner": {"reputation": 158, "user_id": 3584906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f47b52341fabcfee97c2c3dbca41338?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh S", "link": "https://stackoverflow.com/users/3584906/mahesh-s"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1562666586, "post_id": 56949354, "comment_id": 100438925, "body": "@icza, I thought about this, but felt there should be a more elegant way than to declare unwanted literals in code."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562664512, "post_id": 56949432, "comment_id": 100437879, "body": "You can&#39;t do <code>t := int; _, ok := i.(t)</code>, and that&#39;s what the OP was basically asking for."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562664537, "post_id": 56949432, "comment_id": 100437893, "body": "The OP&#39;s example doesn&#39;t show that. It shows calling <code>checkType()</code> with a type literal."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562664629, "post_id": 56949432, "comment_id": 100437945, "body": "Okay, you beat me to this, but by extension, to <i>demonstrate</i> what you&#39;re after you will inevitably have a call with some literal at the top level of your call chain ;-)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562665208, "post_id": 56949432, "comment_id": 100438256, "body": "It really depends on the goal. If the OP has a broader goal, not mentioned in the question, you may well be right."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1562664445, "creation_date": 1562664445, "answer_id": 56949432, "question_id": 56949354, "link": "https://stackoverflow.com/questions/56949354/generic-function-in-golang-to-match-variable-and-type-passed/56949432#56949432", "title": "Generic function in Golang to match variable and type passed", "body": "<p>No need to write a function like this, it's already a built-in feature of the language:</p>\n\n<pre><code>i := \"hello\"\n\n_, ok := i.(int)    // ok is false\n_, ok := i.(string) // ok is true\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 3584906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f47b52341fabcfee97c2c3dbca41338?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh S", "link": "https://stackoverflow.com/users/3584906/mahesh-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "closed_date": 1562664482, "answer_count": 1, "score": 0, "last_activity_date": 1562666534, "creation_date": 1562664224, "last_edit_date": 1562666534, "question_id": 56949354, "link": "https://stackoverflow.com/questions/56949354/generic-function-in-golang-to-match-variable-and-type-passed", "closed_reason": "Duplicate", "title": "Generic function in Golang to match variable and type passed", "body": "<p>I want to write a function which takes two arguments <code>interface{}</code> and a type and return <code>true</code> if the interface is of the type passed, else return <code>false</code>.</p>\n\n<p>I am a beginner in reflection and main challenge I see is how to take type as a function parameter.</p>\n\n<p>For example:</p>\n\n<pre><code>func checkType(val interface{}, t &lt;??&gt;){\n   if reflect.Typeof(val) == t {\n      return true\n   }else{\n      return false\n   }\n}\n\ncheckType(\"hello\",&lt;int type&gt;) // returns false\ncheckType(\"hello\",&lt;string type&gt;) // returns true\n</code></pre>\n\n<p>I am not able to fill the code in all the <code>&lt;&gt;</code> portions to achieve the required behavior.</p>\n\n<p>Edit: Got queries about the safe type cast operator and also intent of my question. Though the methods suggested would help to achieve the type cast, the question was mainly to enhance the academic knowledge about Go reflection.</p>\n"}, {"tags": ["mongodb", "go", "bson"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11712511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fzWQz8SeL44/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDzW_6DvPt3YLvtpmx0_HOnF0wGg/photo.jpg?sz=128", "display_name": "daniel wilson", "link": "https://stackoverflow.com/users/11712511/daniel-wilson"}, "edited": false, "score": 0, "creation_date": 1562682479, "post_id": 56952920, "comment_id": 100447973, "body": "Yes there is syntax errors  &quot;missing key in map literal&quot;  in {&quot;$unwind&quot;: bson.M{&quot;$ipv4Addresses&quot;}}, and bson.M{&quot;$distance&quot;}"}, {"owner": {"reputation": 25, "user_id": 11712511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fzWQz8SeL44/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDzW_6DvPt3YLvtpmx0_HOnF0wGg/photo.jpg?sz=128", "display_name": "daniel wilson", "link": "https://stackoverflow.com/users/11712511/daniel-wilson"}, "edited": false, "score": 0, "creation_date": 1562684602, "post_id": 56952920, "comment_id": 100449374, "body": "I have tried changing them  to    {&quot;$unwind&quot;: &quot;$ipv4Addresses&quot;}, and  bson.M{&quot;_id&quot;: &quot;$distance&quot;}  but it not working."}, {"owner": {"reputation": 25, "user_id": 11712511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fzWQz8SeL44/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDzW_6DvPt3YLvtpmx0_HOnF0wGg/photo.jpg?sz=128", "display_name": "daniel wilson", "link": "https://stackoverflow.com/users/11712511/daniel-wilson"}, "edited": false, "score": 0, "creation_date": 1562751704, "post_id": 56952920, "comment_id": 100472558, "body": "No error after the change but it did not provide the ipv4addresses with the distance 10. It provides all the ipv4addresses."}, {"owner": {"reputation": 1380, "user_id": 9590708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxgY5.jpg?s=128&g=1", "display_name": "Prostagma", "link": "https://stackoverflow.com/users/9590708/prostagma"}, "reply_to_user": {"reputation": 25, "user_id": 11712511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fzWQz8SeL44/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDzW_6DvPt3YLvtpmx0_HOnF0wGg/photo.jpg?sz=128", "display_name": "daniel wilson", "link": "https://stackoverflow.com/users/11712511/daniel-wilson"}, "edited": false, "score": 0, "creation_date": 1562757115, "post_id": 56952920, "comment_id": 100475473, "body": "@danielwilson i added sort and limit to the answer"}], "tags": [], "owner": {"reputation": 1380, "user_id": 9590708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxgY5.jpg?s=128&g=1", "display_name": "Prostagma", "link": "https://stackoverflow.com/users/9590708/prostagma"}, "is_accepted": true, "score": 0, "last_activity_date": 1562759065, "last_edit_date": 1562759065, "creation_date": 1562676306, "answer_id": 56952920, "question_id": 56948324, "link": "https://stackoverflow.com/questions/56948324/how-to-write-bson-form-of-mongo-query-in-golang/56952920#56952920", "title": "How to write bson form of mongo query in golang?", "body": "<p>The problem with your golang code is you didn't group.</p>\n\n<p>You can make use of <code>Pipe</code> which prepares a pipeline to aggregate:</p>\n\n<pre><code>pipe := db.C(COLLECTION).Pipe([]bson.M{\n    {\"$match\":  bson.M{\"nfType\": \"AMF\"}},\n    {\"$unwind\": \"$ipv4Addresses\"},\n    {\"$group\":  bson.M{\n                       \"_id\": \"$distance\",\n                       \"ipv4Addresses\": bson.M{\"$addToSet\": \"$ipv4Addresses\"},\n                      }},\n    {\"$sort\": bson.M{\"_id\": 1}},\n    {\"$limit\": 1},\n\n})\n\nerr := pipe.All(&amp;ip)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 11712511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fzWQz8SeL44/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDzW_6DvPt3YLvtpmx0_HOnF0wGg/photo.jpg?sz=128", "display_name": "daniel wilson", "link": "https://stackoverflow.com/users/11712511/daniel-wilson"}, "edited": false, "score": 0, "creation_date": 1562752138, "post_id": 56965888, "comment_id": 100472783, "body": "Am trying to integrate the code into the function FindIp above and am getting &quot;collection.Aggregate undefined  (type *mgo.Collection has no filed or method Aggregate)&quot; error."}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "reply_to_user": {"reputation": 25, "user_id": 11712511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fzWQz8SeL44/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDzW_6DvPt3YLvtpmx0_HOnF0wGg/photo.jpg?sz=128", "display_name": "daniel wilson", "link": "https://stackoverflow.com/users/11712511/daniel-wilson"}, "edited": false, "score": 0, "creation_date": 1562758611, "post_id": 56965888, "comment_id": 100476226, "body": "Looks like you\u2019re using \u2018mgo\u2019 module instead of \u2018mongo-go-driver\u2019"}], "tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": false, "score": 0, "last_activity_date": 1562745131, "creation_date": 1562745131, "answer_id": 56965888, "question_id": 56948324, "link": "https://stackoverflow.com/questions/56948324/how-to-write-bson-form-of-mongo-query-in-golang/56965888#56965888", "title": "How to write bson form of mongo query in golang?", "body": "<p>If you are using the official <a href=\"https://godoc.org/go.mongodb.org/mongo-driver\" rel=\"nofollow noreferrer\">MongoDB Go driver</a> you can utilise <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo#Collection.Aggregate\" rel=\"nofollow noreferrer\">Collection.Aggregate</a> to perform <a href=\"https://docs.mongodb.com/manual/core/aggregation-pipeline/\" rel=\"nofollow noreferrer\">Aggregation Pipeline</a>. The example Go code snippet that you posted is using <code>find()</code> which is different than aggregation. </p>\n\n<p>For example, using MongoDB Go driver v1.0.4 (current): </p>\n\n<pre><code>collection := client.Database(\"dbname\").Collection(\"collname\")\npipeline := mongo.Pipeline{\n    {{\"$match\", bson.D{\n        {\"nfType\", \"AMF\"},\n    }}}, \n    {{\"$unwind\", \"$ipv4Addresses\"}},\n    {{\"$group\", bson.D{\n        {\"_id\", \"$distance\"},\n        {\"ipv4Addresses\", bson.D{\n            {\"$addToSet\", \"$ipv4Addresses\"},\n        }},\n    }}}, \n    {{\"$sort\", bson.D{\n        {\"_id\", 1},\n    }}}, \n    {{\"$limit\", 1}},\n}\n\ncursor, err := collection.Aggregate(context.Background(), pipeline)\ndefer cursor.Close(context.Background())\nfor cursor.Next(context.Background()) {\n    doc := bson.D{}\n    err := cursor.Decode(&amp;doc)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(doc)\n}\n</code></pre>\n\n<p>The example documents that you posted only have 1 element for all of <code>ipv4Addresses</code>, I'm assuming that this is just an example. If however, all of the documents do only have 1 element array for <code>ipv4Addresses</code> you're likely better off to just use <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/project/\" rel=\"nofollow noreferrer\">$project</a>. </p>\n\n<p>Generally <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/bson#D\" rel=\"nofollow noreferrer\">bson.D</a> is used when serialising to BSON (and when order matters). </p>\n"}], "owner": {"reputation": 25, "user_id": 11712511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fzWQz8SeL44/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDzW_6DvPt3YLvtpmx0_HOnF0wGg/photo.jpg?sz=128", "display_name": "daniel wilson", "link": "https://stackoverflow.com/users/11712511/daniel-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2207, "favorite_count": 0, "accepted_answer_id": 56952920, "answer_count": 2, "score": 1, "last_activity_date": 1582718509, "creation_date": 1562660738, "last_edit_date": 1562751088, "question_id": 56948324, "link": "https://stackoverflow.com/questions/56948324/how-to-write-bson-form-of-mongo-query-in-golang", "title": "How to write bson form of mongo query in golang?", "body": "<p>I can query my mongodb collection to get the ipv4Addresses based on the nfType and the minimum distance using the command line query</p>\n\n<pre><code>db.nfinstancesdb.aggregate([\n  {\n    \"$match\": {\n      \"nfType\": \"AMF\"\n    }\n  },\n  {\n    \"$unwind\": \"$ipv4Addresses\"\n  },\n  {\n    $group: {\n      \"_id\": \"$distance\",\n      \"ipv4Addresses\": {\n        \"$addToSet\": \"$ipv4Addresses\"\n      }\n    }\n  },\n  {\n    \"$sort\": {\n      \"_id\": 1\n    }\n  },\n  {\n    \"$limit\": 1\n  }\n])\n\n</code></pre>\n\n<p>This give the output am expecting as</p>\n\n<pre><code>[{\"_id\": 10,\"ipv4Addresses\": [\"172.16.0.11\",\"172.16.0.10\"]}]\n\n</code></pre>\n\n<p>How can I write the bson form of the above query on Go? </p>\n\n<p>I did in the function below but am getting all the ipv4Addresses\ninstead of the above result.</p>\n\n<pre><code>func (m *NfInstanceDataAccess) FindIp(nfType string) ([]NfInstance, error) {\n    var ip []NfInstance\n\n    collection := db.C(COLLECTION)\n    pipeline := mongo.Pipeline{\n        {{\"$match\", bson.D{\n            {\"nfType\", \"AMF\"},\n        }}},\n        {{\"$unwind\", \"$ipv4Addresses\"}},\n        {{\"$group\", bson.D{\n            {\"_id\", \"$distance\"},\n            {\"ipv4Addresses\", bson.D{\n                {\"$addToSet\", \"$ipv4Addresses\"},\n            }},\n        }}},\n        {{\"$sort\", bson.D{\n            {\"_id\", 1},\n        }}},\n        {{\"$limit\", 1}},\n    }\n\n    cursor, err := collection.Aggregate(context.Background(), pipeline)\n    defer cursor.Close(context.Background())\n    for cursor.Next(context.Background()) {\n        var ip []NfInstance\n        err := cursor.Decode(&amp;ip)\n        if err != nil {\n            log.Fatal(err)\n        }\n        //fmt.Println(doc)\n    }\n    return ip, nil\n}\n\n\n</code></pre>\n\n<p>My collection has the following items</p>\n\n<pre><code>{\n    \"nfInstanceID\": \"1\",\n    \"nfType\": [\n      \"AMF\"\n    ],\n    \"nfStatus\": [\n      \"REGISTERED\"\n    ],\n    \"ipv4Addresses\": [\n      \"172.16.0.10\"\n    ],\n    \"distance\": 10\n  },\n  {\n    \"nfInstanceID\": \"2\",\n    \"nfType\": [\n      \"UPF\"\n    ],\n    \"nfStatus\": [\n      \"REGISTERED\"\n    ],\n    \"ipv4Addresses\": [\n      \"172.16.0.20\"\n    ],\n    \"distance\": 20\n  },\n  {\n    \"nfInstanceID\": \"3\",\n    \"nfType\": [\n      \"AMF\"\n    ],\n    \"nfStatus\": [\n      \"REGISTERED\"\n    ],\n    \"ipv4Addresses\": [\n      \"172.16.0.30\"\n    ],\n    \"distance\": 30\n  },\n  {\n    \"nfInstanceID\": \"4\",\n    \"nfType\": [\n      \"AMF\"\n    ],\n    \"nfStatus\": [\n      \"REGISTERED\"\n    ],\n    \"ipv4Addresses\": [\n      \"172.16.0.11\"\n    ],\n    \"distance\": 10\n  }\n</code></pre>\n\n<p>And I am expecting the same or similar output.</p>\n"}, {"tags": ["go", "concurrency", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 10644581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7062244df47416e59a7ac2d96d49bce1?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/10644581/gabriel"}, "edited": false, "score": 0, "creation_date": 1562658578, "post_id": 56947717, "comment_id": 100434695, "body": "thanks! forgot to comment out the ch&lt;-1 in the question though"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 47, "user_id": 10644581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7062244df47416e59a7ac2d96d49bce1?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/10644581/gabriel"}, "edited": false, "score": 0, "creation_date": 1562658637, "post_id": 56947717, "comment_id": 100434726, "body": "@Gabriel Same thing if you comment out the send: the app ends without waiting for the other goroutine."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1562658590, "last_edit_date": 1562658590, "creation_date": 1562658450, "answer_id": 56947717, "question_id": 56947672, "link": "https://stackoverflow.com/questions/56947672/cant-read-from-a-channel-in-goroutine/56947717#56947717", "title": "Can&#39;t read from a channel in goroutine", "body": "<p>First, the buffer is not empty, because you send a value on it:</p>\n\n<pre><code>ch &lt;- 1\n</code></pre>\n\n<p>This send operation will not block because the channel is buffered.</p>\n\n<p>Then you launch a goroutine, and the <code>main()</code> function ends. And with that, your program ends as well, it does not wait for other non-main goroutines to complete. For details, see <a href=\"https://stackoverflow.com/questions/28958192/no-output-from-goroutine-in-go/28958240#28958240\">No output from goroutine in Go</a>.</p>\n\n<p>Note that the same thing happens even if you comment out the send operation in <code>main()</code>: you launch a goroutine and then <code>main()</code> ends along with your app: it does not wait for the other goroutine.</p>\n\n<p>To wait for other goroutines, often a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\"><code>sync.WaitGroup</code></a> is used like this:</p>\n\n<pre><code>var wg = &amp;sync.WaitGroup{}\n\nfunc fun(c chan int) {\n    defer wg.Done()\n    fmt.Println(&lt;-c)\n}\n\nfunc main() {\n    ch := make(chan int, 1)\n    ch &lt;- 1\n\n    wg.Add(1)\n    go fun(ch)\n    wg.Wait()\n}\n</code></pre>\n\n<p>Then output will be (try it on the <a href=\"https://play.golang.org/p/XyfnENIEj5k\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>1\n</code></pre>\n\n<p>For details, see <a href=\"https://stackoverflow.com/questions/42752705/prevent-the-main-function-from-terminating-before-goroutines-finish-in-golang/42753005#42753005\">Prevent the main() function from terminating before goroutines finish in Golang</a></p>\n"}], "owner": {"reputation": 47, "user_id": 10644581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7062244df47416e59a7ac2d96d49bce1?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/10644581/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "closed_date": 1562658880, "answer_count": 1, "score": 0, "last_activity_date": 1562658699, "creation_date": 1562658278, "last_edit_date": 1562658699, "question_id": 56947672, "link": "https://stackoverflow.com/questions/56947672/cant-read-from-a-channel-in-goroutine", "closed_reason": "Duplicate", "title": "Can&#39;t read from a channel in goroutine", "body": "<p>In this piece of code, a goroutine is created and tries to read from a buffered channel. </p>\n\n<p>But the buffer is empty and should block the receiver, but it didn't. It will run but output nothin.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc fun(c chan int) {\n    fmt.Println(&lt;-c)\n}\n\nfunc main() {\n    ch := make(chan int, 1)\n    //ch &lt;- 1\n    go fun(ch)\n}\n</code></pre>\n"}, {"tags": ["go", "go-echo"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1562656039, "post_id": 56946957, "comment_id": 100433447, "body": "Use <code>json:&quot;-&quot;</code> for the password field?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11758084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9-1IBqEQUhM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr45goA1UXDeS247ANIBgY1GQMJg/photo.jpg?sz=128", "display_name": "Vitaliy", "link": "https://stackoverflow.com/users/11758084/vitaliy"}, "is_accepted": false, "score": 1, "last_activity_date": 1562657177, "creation_date": 1562657177, "answer_id": 56947345, "question_id": 56946957, "link": "https://stackoverflow.com/questions/56946957/how-omit-struct-filed/56947345#56947345", "title": "How omit struct filed", "body": "<ol>\n<li>Add new struct than describe desired struct</li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type LoginFormResponse struct {\n    Login    string `json:\"name\"`\n    Password string `json:\"-\"`\n}\n</code></pre>\n\n<ol start=\"2\">\n<li>Convert </li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>return c.JSON(http.StatusOK, map[string]interface{}{\n            \"user\":  LoginFormResponse(*data),\n            \"token\": \"slkdfj\",\n        })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 15314666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DH9erRrXZWo/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuck1Scc6eiAZV0Uy5YRlRC17OpHHLw/s96-c/photo.jpg?sz=128", "display_name": "Muhammad Iqbal Ali", "link": "https://stackoverflow.com/users/15314666/muhammad-iqbal-ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1617165462, "creation_date": 1617165462, "answer_id": 66881728, "question_id": 56946957, "link": "https://stackoverflow.com/questions/56946957/how-omit-struct-filed/66881728#66881728", "title": "How omit struct filed", "body": "<p>you can create a helper package to handle api response</p>\n<p>for example:\nhelper/response_formatter.go:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package helper\n\ntype Response struct {\n    Message string `json:&quot;message&quot;`\n    Data interface{} `json:&quot;data&quot;`\n}\n\nfunc ResponseFormatter(message string, data interface{}) Response {\n    response := Response{\n        Message: message\n        Data: data,\n    }\n\n    return response\n}\n</code></pre>\n<p>then in echo handler:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>response := helper.ResponseFormatter(&quot;authenticated&quot;, userData)\n\nreturn c.JSON(http.StatusOK, response)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11758084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9-1IBqEQUhM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr45goA1UXDeS247ANIBgY1GQMJg/photo.jpg?sz=128", "display_name": "Vitaliy", "link": "https://stackoverflow.com/users/11758084/vitaliy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1617165462, "creation_date": 1562655669, "last_edit_date": 1562656152, "question_id": 56946957, "link": "https://stackoverflow.com/questions/56946957/how-omit-struct-filed", "title": "How omit struct filed", "body": "<p>How can I omit struct filed, in my case I login user and return response with user data and token but in this case I need to remove password field, how can I do this ?</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type LoginFormData struct {\n    Login    string `json:\"name\"`\n    Password string `json:\"password\"`\n}\n\ndata := new(LoginFormData)\n\nif err := c.Bind(data); err != nil {\n    return err\n}\n\nuserData := data // omit password field\n\n        return c.JSON(http.StatusOK, map[string]interface{}{\n            \"user\": struct {\n                Password string `json:\"-\"`\n                *LoginFormData\n            }{\n                LoginFormData: userData,\n                Password:      userData.Password,\n            },\n            \"token\": \"slkdfj\",\n        })\n</code></pre>\n"}, {"tags": ["go", "geolocation", "amazon-dynamodb", "geospatial", "geohashing"], "comments": [{"owner": {"reputation": 40792, "user_id": 563420, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/715062f31800335c2a33422b311dbb93?s=128&d=identicon&r=PG", "display_name": "rynop", "link": "https://stackoverflow.com/users/563420/rynop"}, "edited": false, "score": 0, "creation_date": 1562653979, "post_id": 56946172, "comment_id": 100432401, "body": "My hunch is the go port of the S2 lib (<a href=\"https://godoc.org/github.com/golang/geo/s2#CellID\" rel=\"nofollow noreferrer\">godoc.org/github.com/golang/geo/s2#CellID</a>) can&#39;t return a negative int, because it returns <code>uint64</code>. The Java port of S2 returns a <code>float</code>, which can produce negative. If I use go S2 port, I can just assume positive integers always. AMIRITE?"}, {"owner": {"reputation": 1893, "user_id": 2832976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0c06a48cb81bc7a5d934b92dce67510?s=128&d=identicon&r=PG&f=1", "display_name": "LuisTavares", "link": "https://stackoverflow.com/users/2832976/luistavares"}, "edited": false, "score": 1, "creation_date": 1562875383, "post_id": 56946172, "comment_id": 100527119, "body": "I couldn&#39;t find any! Geohash Wikipedia entry mentions some edge cases but none of them will produce negative values. Your hunch is most probably correct."}], "owner": {"reputation": 40792, "user_id": 563420, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/715062f31800335c2a33422b311dbb93?s=128&d=identicon&r=PG", "display_name": "rynop", "link": "https://stackoverflow.com/users/563420/rynop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1598836517, "creation_date": 1562652164, "question_id": 56946172, "link": "https://stackoverflow.com/questions/56946172/what-latitude-longitude-combination-will-produce-a-negative-geohash-integer", "title": "What latitude / longitude combination will produce a negative geohash integer?", "body": "<p>I'm trying to write a simple go application that interfaces with DynamoDB to store points as a geohash.</p>\n\n<p>Essentially I'm trying to replicate what the <a href=\"https://aws.amazon.com/blogs/mobile/geo-library-for-amazon-dynamodb-part-1-table-structure/\" rel=\"nofollow noreferrer\">Java geo lib for DynamoDB</a> does, but with Go.</p>\n\n<p>I'm using <a href=\"https://github.com/mmcloughlin/geohash\" rel=\"nofollow noreferrer\">https://github.com/mmcloughlin/geohash</a> to encode the point:</p>\n\n<pre><code>geohash.EncodeInt(47.61121, -122.31846) // produces 6379143490183141059\n</code></pre>\n\n<p>The Geo Library for Amazon DynamoDB <a href=\"https://aws.amazon.com/blogs/mobile/geo-library-for-amazon-dynamodb-part-1-table-structure/\" rel=\"nofollow noreferrer\">blog</a> post mentions that a negative 64-bit geohash encoding of a point is possible.  Specifically they mention <code>-6093522776912656819</code>.</p>\n\n<p>I can't find a lat/lng combination, that when run through <code>geohash.EncodeInt()</code> produces a negative integer value.</p>\n\n<p>What lat/lng combination will encode to a negative integer?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1562652961, "post_id": 56945970, "comment_id": 100431996, "body": "<i>&quot;Does this not work because ithRow is a copy of resultArray[i], but not reference of it?&quot;</i> Yes. <i>&quot;If so, why is it not reference of it&quot;</i> Because in Go <b>everything</b> is pass-by-value."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1562653104, "post_id": 56945970, "comment_id": 100432051, "body": "<a href=\"https://dave.cheney.net/2017/04/29/there-is-no-pass-by-reference-in-go\" rel=\"nofollow noreferrer\">dave.cheney.net/2017/04/29/there-is-no-pass-by-reference-in-&zwnj;&#8203;go</a>"}, {"owner": {"reputation": 881, "user_id": 9534591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxvb4.png?s=128&g=1", "display_name": "ik1ne", "link": "https://stackoverflow.com/users/9534591/ik1ne"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1562653494, "post_id": 56945970, "comment_id": 100432203, "body": "@mkopriva Thank you, before that point the tutorial did not mention about what golang&#39;s calling/iterating convention used. However I still don&#39;t know why in the world I mistakenly thought it would be similar to C++&#39;s pass-by-reference-ish calling convention (<code>function(type &amp; arg)</code>)."}], "owner": {"reputation": 881, "user_id": 9534591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxvb4.png?s=128&g=1", "display_name": "ik1ne", "link": "https://stackoverflow.com/users/9534591/ik1ne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562650837, "creation_date": 1562650837, "question_id": 56945970, "link": "https://stackoverflow.com/questions/56945970/golang-tutorials-slices-exercise-my-code-does-not-work-if-indexvalue-iterati", "title": "Golang tutorial&#39;s slices exercise - my code does not work if index&amp;value iteration is used", "body": "<p>I'm doing golang tutorial, and the <a href=\"https://tour.golang.org/moretypes/18\" rel=\"nofollow noreferrer\">very first exercise</a> is giving me a headache.</p>\n\n<p>The exercise in a nutshell wants me to dynamically create a array with dx*dy dimention.</p>\n\n<p>This is my function that receives <code>dx</code>, <code>dy</code> and returns <code>[dx][dy]uint8</code> array that works:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Pic(dx, dy int) [][]uint8 {\n    resultArray := make([][]uint8, dx, dx)\n    for i := range resultArray {\n        fmt.Println(resultArray[i])\n        resultArray[i] = make([]uint8, dy, dy)\n        fmt.Println(resultArray)\n        for j := range resultArray[i] {\n            if (i+j)%30 &lt;= 15 {\n                resultArray[i][j] = uint8(255)\n            }\n        }\n    }\n    return resultArray\n}\n</code></pre>\n\n<p>However, this code which uses <code>for i, v := range x</code> does <strong>not</strong> work:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Pic(dx, dy int) [][]uint8 {\n    resultArray := make([][]uint8, dx, dx)\n    for i, ithRow := range resultArray {\n        ithRow = make([]uint8, dy, dy)\n        for j := range ithRow {\n            if (i+j)%30 &lt;= 15 {\n                ithRow[j] = uint8(255)\n            }\n        }\n    }\n    return resultArray\n}\n</code></pre>\n\n<p>Does this not work because <code>ithRow</code> is a copy of <code>resultArray[i]</code>, but not reference of it? If so, why is it not reference of it(like, what is the benefit or use case of making it copied)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1562650810, "post_id": 56945922, "comment_id": 100431306, "body": "<code>big.Int</code> <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\">golang.org/pkg/math/big</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1562660221, "post_id": 56945922, "comment_id": 100435560, "body": "\u201eThe largest number\u201c would be something asserted by I0. This is probably too big gor your nerds."}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1562650842, "creation_date": 1562650842, "answer_id": 56945971, "question_id": 56945922, "link": "https://stackoverflow.com/questions/56945922/what-is-the-numerical-type-i-can-use-in-go-to-get-the-largest-number/56945971#56945971", "title": "What is the numerical type I can use in go to get the largest number?", "body": "<p>You can use <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\">math/big</a> package. It contains types Int, Float, Rat (rational).</p>\n"}], "owner": {"reputation": 8026, "user_id": 9296, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/513676303/picture?type=large", "display_name": "Tzury Bar Yochay", "link": "https://stackoverflow.com/users/9296/tzury-bar-yochay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 56945971, "answer_count": 1, "score": -3, "last_activity_date": 1562650842, "creation_date": 1562650527, "last_edit_date": 1562650653, "question_id": 56945922, "link": "https://stackoverflow.com/questions/56945922/what-is-the-numerical-type-i-can-use-in-go-to-get-the-largest-number", "title": "What is the numerical type I can use in go to get the largest number?", "body": "<p>Assuming the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var MaxInt uint64\n    MaxInt = 1&lt;&lt;64 - 1\n    fmt.Printf(\"Type: %T Value: %v\\n\", MaxInt, MaxInt)\n}\n</code></pre>\n\n<p>I get the results of:</p>\n\n<pre><code>Type: uint64 Value: 18446744073709551615\n</code></pre>\n\n<p>Just as expected.</p>\n\n<p>However, say I want to get a larger, say <code>1&lt;&lt;256 - 1</code>, when I use</p>\n\n<pre><code>func main() {\n    x:= 1&lt;&lt;256-1\n    fmt.Printf(\"Type: %T Value: %v\\n\", x, x)\n}\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>./prog.go:10:10: constant 115792089237316195423570985008687907853269984665640564039457584007913129639936 overflows int\n</code></pre>\n\n<p>For <code>x:=1&lt;&lt;512-1</code> I get:</p>\n\n<pre><code>./prog.go:10:10: shift count too large: 512\n</code></pre>\n\n<p>My question is: What types can I use go to play with large numbers at this scale?</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 394, "user_id": 4794989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kl1aC.jpg?s=128&g=1", "display_name": "Alireza Bashiri", "link": "https://stackoverflow.com/users/4794989/alireza-bashiri"}, "edited": false, "score": 1, "creation_date": 1562654977, "post_id": 56945553, "comment_id": 100432886, "body": "Take a look at this, but please add more details to your question. <a href=\"https://github.com/golang-migrate/migrate\" rel=\"nofollow noreferrer\">github.com/golang-migrate/migrate</a> <a href=\"http://gorm.io/docs/migration.html\" rel=\"nofollow noreferrer\">gorm.io/docs/migration.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 501, "user_id": 4813990, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/RxYGo.png?s=128&g=1", "display_name": "Babak no&#39;doust", "link": "https://stackoverflow.com/users/4813990/babak-nodoust"}, "is_accepted": true, "score": 1, "last_activity_date": 1562703483, "last_edit_date": 1562703483, "creation_date": 1562693569, "answer_id": 56957887, "question_id": 56945553, "link": "https://stackoverflow.com/questions/56945553/how-to-migrate-a-model-in-gorm/56957887#56957887", "title": "How to migrate a model in gorm?", "body": "<p>You can migrate to your database with following command</p>\n\n<pre><code>db.AutoMigrate(&amp;Product{})\n</code></pre>\n\n<p>This command migrates if product model does not exist in database</p>\n\n<p>This is usually used as a CREATE statement</p>\n\n<p>you can also see here to more information.\n<a href=\"http://gorm.io/docs/migration.html\" rel=\"nofollow noreferrer\">GORM migration document</a></p>\n"}], "owner": {"reputation": 53, "user_id": 9255126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edb7b042405714228abf4c2d71b32e2a?s=128&d=identicon&r=PG", "display_name": "Towhid Zeinali", "link": "https://stackoverflow.com/users/9255126/towhid-zeinali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 1, "accepted_answer_id": 56957887, "answer_count": 1, "score": 2, "last_activity_date": 1563995806, "creation_date": 1562648006, "last_edit_date": 1563995806, "question_id": 56945553, "link": "https://stackoverflow.com/questions/56945553/how-to-migrate-a-model-in-gorm", "title": "How to migrate a model in gorm?", "body": "<p>I am a beginner golang developer I use GORM package to connect to DB.\nHow to migration and a model like following in GORM: </p>\n\n<pre><code>type Product struct {\n    ID         int64\n    Name       string\n    created_at  int64\n    updated_at  int64\n}\n</code></pre>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 13757, "user_id": 1270003, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d5ed9123b92a6e4dffa75f9f6dd9e382?s=128&d=identicon&r=PG&f=1", "display_name": "texasbruce", "link": "https://stackoverflow.com/users/1270003/texasbruce"}, "edited": false, "score": 1, "creation_date": 1562642137, "post_id": 56944781, "comment_id": 100429393, "body": "Loop variables in Golang is actually shared for all iterations of the loop similar to JS, so <code>i</code> and <code>v</code> are the same variables for the whole loop. So you need to create a temp value for v if you want to get the address."}], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562653714, "post_id": 56944822, "comment_id": 100432294, "body": "Expanded a bit further in <a href=\"https://play.golang.org/p/pLLVhRaJ0jo\" rel=\"nofollow noreferrer\">play.golang.org/p/pLLVhRaJ0jo</a> to match  OP&#39;s code more closely."}], "tags": [], "owner": {"reputation": 602, "user_id": 6863654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VaBUN.png?s=128&g=1", "display_name": "beiping96", "link": "https://stackoverflow.com/users/6863654/beiping96"}, "is_accepted": false, "score": 1, "last_activity_date": 1562641952, "creation_date": 1562641952, "answer_id": 56944822, "question_id": 56944781, "link": "https://stackoverflow.com/questions/56944781/why-is-string-pointer-in-golang-behavior-counter-intuitive-in-range-loop/56944822#56944822", "title": "Why is string pointer in golang behavior counter-intuitive in range-loop?", "body": "<p><a href=\"https://play.golang.org/p/utJrUmxeqfh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/utJrUmxeqfh</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    foo := []int{1, 2, 3}\n    for _, f := range foo {\n        fmt.Printf(\"value is %d, addr is %p \\n\", f, &amp;f)\n    }\n    fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<pre><code>value is 1, addr is 0x414020 \nvalue is 2, addr is 0x414020 \nvalue is 3, addr is 0x414020 \nHello, playground\n</code></pre>\n\n<p>the value <code>f</code> in <code>range</code> has the same address</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1562642652, "last_edit_date": 1562642652, "creation_date": 1562641987, "answer_id": 56944824, "question_id": 56944781, "link": "https://stackoverflow.com/questions/56944781/why-is-string-pointer-in-golang-behavior-counter-intuitive-in-range-loop/56944824#56944824", "title": "Why is string pointer in golang behavior counter-intuitive in range-loop?", "body": "<p>The items all contain the address of the one local variable <code>v</code>. </p>\n\n<p>If your goal is to assign the address of the slice element the <code>a</code> field, then do the following:</p>\n\n<pre><code>for i := range slist {\n    item := &amp;A{\n        a: &amp;slist[i],  // address of element instead of local variable.\n    }\n    list[i] = item\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/svzrbtdVi1X\" rel=\"nofollow noreferrer\">Run it on the Go Playground</a>.</p>\n\n<p>You can also get the output you want by creating a new variable on each loop iteration:</p>\n\n<pre><code>for i, v := range slist {\n    v := v  // create new value on each iteration.\n    item := &amp;A{\n        a: &amp;v,\n    }\n    list[i] = item\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pEJOEIMW8_f\" rel=\"nofollow noreferrer\">Run it on the Go Playground</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "edited": false, "score": 0, "creation_date": 1562642422, "post_id": 56944850, "comment_id": 100429439, "body": "You can see the answer..I think its helpful to you. @shougang"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562653650, "post_id": 56944850, "comment_id": 100432264, "body": "Link only answers do not help much. Should the link change or vanish, the answer becomes meaningless. Please include at least the gist in your answer."}, {"owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562655466, "post_id": 56944850, "comment_id": 100433146, "body": "@MarkusWMahlberg ,i am try to solve their question. so that i can only run code and do the some changes."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562655801, "post_id": 56944850, "comment_id": 100433325, "body": "I understand that. But for the sake of long term knowledge retention, it makes sense to actually answer the question here completely, with links only adding information. Please see <a href=\"https://meta.stackexchange.com/questions/8231/are-answers-that-just-contain-links-elsewhere-really-good-answers\" title=\"are answers that just contain links elsewhere really good answers\">meta.stackexchange.com/questions/8231/&hellip;</a> for an in depth discussion why link-only anwers should be avoided."}], "tags": [], "owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "is_accepted": false, "score": -2, "last_activity_date": 1562655277, "last_edit_date": 1562655277, "creation_date": 1562642242, "answer_id": 56944850, "question_id": 56944781, "link": "https://stackoverflow.com/questions/56944781/why-is-string-pointer-in-golang-behavior-counter-intuitive-in-range-loop/56944850#56944850", "title": "Why is string pointer in golang behavior counter-intuitive in range-loop?", "body": "<p><strong>You can try this</strong></p>\n\n<p>Here I can run your code and do some changes.</p>\n\n<p><a href=\"https://play.golang.org/p/GmU3goeOKdF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/GmU3goeOKdF</a></p>\n\n<p>here is code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    a  *string\n}\n\nfunc f() {\n    slist := []string{\"a\", \"b\", \"c\"}\n    list := make([]*A, len(slist))\n    for i, v := range slist {\n        item := &amp;A{\n            a: &amp;v,\n        }\n        list[i] = item\n\n    fmt.Printf(\"%s\", *list[i].a)\n    }\n}\nfunc main() {\n    f()\n}\n\n</code></pre>\n\n<p><strong>Output</strong> <code>abc</code></p>\n"}, {"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1562654485, "creation_date": 1562654485, "answer_id": 56946643, "question_id": 56944781, "link": "https://stackoverflow.com/questions/56944781/why-is-string-pointer-in-golang-behavior-counter-intuitive-in-range-loop/56946643#56946643", "title": "Why is string pointer in golang behavior counter-intuitive in range-loop?", "body": "<p>The thing is that the iterator variable is allocated only once and the value it points to is changed with each iteration of the loop:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    a *string\n}\n\nfunc f() {\n    slist := []string{\"a\", \"b\", \"c\"}\n    list := make([]*A, len(slist))\n\n    // v is only allocated once and the value at it's address is changed\n    // on each iteration.\n    for i, v := range slist {\n        fmt.Printf(\"Iteration %d: address of v %#v, value of v \\\"%s\\\"\\n\", i+1, &amp;v, v)\n        // Add in a temp variable, which will get allocated\n        // and hence have a new address each iteration.\n        t := v\n\n        // Now assign that temp variable's address to the Item's a.\n        list[i] = &amp;A{\n            a: &amp;t,\n        }\n    }\n    fmt.Printf(\"[%s %s %s]\", *list[0].a, *list[1].a, *list[2].a)\n}\n\nfunc main() {\n    f()\n}\n</code></pre>\n\n<p><strong><kbd><a href=\"https://play.golang.org/p/pLLVhRaJ0jo\" rel=\"nofollow noreferrer\">Run on playground</a></kbd></strong></p>\n\n<p>However, I have a strong feeling that this is unintuitive because we are pretty much talking of premature optimization. (A bit simplified): A string in Go is basically a slice of bytes(<code>[]byte</code>), with a slice already being a pointer to the backing array. See <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a> for details.</p>\n"}], "owner": {"reputation": 9, "user_id": 11757318, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z5FK7lcqM7Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfHaI9x9mkX2vFnHIPj4gg-HyrTew/photo.jpg?sz=128", "display_name": "Shougang Deng", "link": "https://stackoverflow.com/users/11757318/shougang-deng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1562657176, "creation_date": 1562641496, "last_edit_date": 1562657176, "question_id": 56944781, "link": "https://stackoverflow.com/questions/56944781/why-is-string-pointer-in-golang-behavior-counter-intuitive-in-range-loop", "title": "Why is string pointer in golang behavior counter-intuitive in range-loop?", "body": "<p>With this code: <a href=\"https://play.golang.org/p/tCm1W-K-6ob\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tCm1W-K-6ob</a></p>\n\n<p>This code would print: <code>[c c c]</code>, but <code>[a b c]</code> is excepted.</p>\n\n<pre><code>type A struct {\n    a *string\n}\n\nfunc f() {\n    slist := []string{\"a\", \"b\", \"c\"}\n    list := make([]*A, len(slist))\n    for i, v := range slist {\n        item := &amp;A{\n            a: &amp;v,\n        }\n        list[i] = item\n    }\n    fmt.Printf(\"[%s %s %s]\", *list[0].a, *list[1].a, *list[2].a)\n}\n\nfunc main() {\n    f()\n}\n</code></pre>\n\n<p>Why the list is not <code>[\"a\", \"b\", \"c\"]</code>? What happened to the range or the <code>&amp;string</code>?</p>\n"}, {"tags": ["go", "hyperledger-fabric", "blockchain", "hyperledger"], "comments": [{"owner": {"reputation": 698, "user_id": 4110629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZl7k.jpg?s=128&g=1", "display_name": "Mrudav Shukla", "link": "https://stackoverflow.com/users/4110629/mrudav-shukla"}, "edited": false, "score": 0, "creation_date": 1562652016, "post_id": 56944097, "comment_id": 100431651, "body": "Are you specifically looking for the peer that did the transaction or the client/member identity with which the transaction was signed and broadcasted for endorsing? Cuz, the peers are mostly involved in simulating and endorsing the transactions and they never propose the transaction."}, {"owner": {"reputation": 1019, "user_id": 1453704, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/h6nHH.png?s=128&g=1", "display_name": "deeptimancode", "link": "https://stackoverflow.com/users/1453704/deeptimancode"}, "reply_to_user": {"reputation": 698, "user_id": 4110629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZl7k.jpg?s=128&g=1", "display_name": "Mrudav Shukla", "link": "https://stackoverflow.com/users/4110629/mrudav-shukla"}, "edited": false, "score": 0, "creation_date": 1562683783, "post_id": 56944097, "comment_id": 100448842, "body": "I am not sure but mostly, i want to know , which organization did the transaction among all the available org in a network"}], "answers": [{"comments": [{"owner": {"reputation": 1019, "user_id": 1453704, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/h6nHH.png?s=128&g=1", "display_name": "deeptimancode", "link": "https://stackoverflow.com/users/1453704/deeptimancode"}, "edited": false, "score": 0, "creation_date": 1562711566, "post_id": 56955787, "comment_id": 100460342, "body": "one more thing, i received the block by txid but how to read the blockheader hash byte array in go"}, {"owner": {"reputation": 698, "user_id": 4110629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZl7k.jpg?s=128&g=1", "display_name": "Mrudav Shukla", "link": "https://stackoverflow.com/users/4110629/mrudav-shukla"}, "reply_to_user": {"reputation": 1019, "user_id": 1453704, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/h6nHH.png?s=128&g=1", "display_name": "deeptimancode", "link": "https://stackoverflow.com/users/1453704/deeptimancode"}, "edited": false, "score": 1, "creation_date": 1562718944, "post_id": 56955787, "comment_id": 100461690, "body": "Do you mean to say the identity byte array?"}, {"owner": {"reputation": 1019, "user_id": 1453704, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/h6nHH.png?s=128&g=1", "display_name": "deeptimancode", "link": "https://stackoverflow.com/users/1453704/deeptimancode"}, "edited": false, "score": 0, "creation_date": 1562719086, "post_id": 56955787, "comment_id": 100461714, "body": "in this post, i have specified , please check :   <a href=\"https://stackoverflow.com/questions/56961434/how-to-read-block-data-received-by-transaction-id-in-hyperledger-fabric-go\" title=\"how to read block data received by transaction id in hyperledger fabric go\">stackoverflow.com/questions/56961434/&hellip;</a>"}, {"owner": {"reputation": 1019, "user_id": 1453704, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/h6nHH.png?s=128&g=1", "display_name": "deeptimancode", "link": "https://stackoverflow.com/users/1453704/deeptimancode"}, "edited": false, "score": 0, "creation_date": 1562720828, "post_id": 56955787, "comment_id": 100462034, "body": "yes i am getting the byte array but not able to see the data"}, {"owner": {"reputation": 698, "user_id": 4110629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZl7k.jpg?s=128&g=1", "display_name": "Mrudav Shukla", "link": "https://stackoverflow.com/users/4110629/mrudav-shukla"}, "reply_to_user": {"reputation": 1019, "user_id": 1453704, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/h6nHH.png?s=128&g=1", "display_name": "deeptimancode", "link": "https://stackoverflow.com/users/1453704/deeptimancode"}, "edited": false, "score": 1, "creation_date": 1562737788, "post_id": 56955787, "comment_id": 100465546, "body": "If you just need the MSP_ID then you can get that from Payload -&gt; Header -&gt; Signature Header -&gt; Creater -&gt; Msp Id. However, if you need the exact identity of that signed the transaction, you&#39;ll need to use some utility to parse IdBytes which is a PEM string to the certificate. I used one of the utilities available in node to convert this pem string to X509 format certificate. Not much aware about syntax/semantics of GoLang yet, however, I&#39;m sure there might be some utility to help you convert PEM string to X509 Certificate."}], "tags": [], "owner": {"reputation": 698, "user_id": 4110629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZl7k.jpg?s=128&g=1", "display_name": "Mrudav Shukla", "link": "https://stackoverflow.com/users/4110629/mrudav-shukla"}, "is_accepted": true, "score": 2, "last_activity_date": 1562685454, "creation_date": 1562685454, "answer_id": 56955787, "question_id": 56944097, "link": "https://stackoverflow.com/questions/56944097/how-do-i-know-which-peer-did-the-transaction-in-hyperledger-fabric-go/56955787#56955787", "title": "How do i know, which Peer did the Transaction in Hyperledger Fabric Go?", "body": "<p>The call <code>stub.GetHistoryForKey(userNameIndexKey)</code> will query the state database and not the ledger (channel). The information about the identity who made the transaction is stored in the block. </p>\n\n<p>I have implemented the same thing with NodeJS SDK. However, Go SDK too contains similar API calls. The following steps worked for me:</p>\n\n<ol>\n<li>Using your SDK, get the transactionId</li>\n<li>Use the SDK function for querying block by transactionId. References <a href=\"https://github.com/hyperledger/fabric-sdk-go/blob/48690b259926e9b25bb00443e32bd17f8a14952c/pkg/client/ledger/ledger.go#L194\" rel=\"nofollow noreferrer\">here</a>.</li>\n<li>At this step, you'll get the block. Now the identity of the submitter is located within this block. Hints: Payload -> Header -> Signature Header -> Creater -> IdBytes.</li>\n<li>These identity bytes are the X509 certs of the submitter. You can read the certificate info to find out which member did submit this transaction. The subject and OUs will indicate the Organization of the peer that did the transaction.</li>\n</ol>\n"}], "owner": {"reputation": 1019, "user_id": 1453704, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/h6nHH.png?s=128&g=1", "display_name": "deeptimancode", "link": "https://stackoverflow.com/users/1453704/deeptimancode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 56955787, "answer_count": 1, "score": 1, "last_activity_date": 1562685454, "creation_date": 1562633435, "question_id": 56944097, "link": "https://stackoverflow.com/questions/56944097/how-do-i-know-which-peer-did-the-transaction-in-hyperledger-fabric-go", "title": "How do i know, which Peer did the Transaction in Hyperledger Fabric Go?", "body": "<p>I am working on getting a transaction id info, which will give the peer details for the transaction. Currently, I am able to retrieve the History for a key, which gives me the list of transaction committed to that key.</p>\n\n<p><strong>MyCode:</strong></p>\n\n<pre><code>historyRes, err := stub.GetHistoryForKey(userNameIndexKey)\n\nif err != nil {\n    return shim.Error(fmt.Sprintf(\"Unable to get History key from the ledger: %v\", err))\n}\n\nfor historyRes.HasNext() {\n\n    history, errIt := historyRes.Next()\n\n    if errIt != nil {\n        return shim.Error(fmt.Sprintf(\"Unable to retrieve history in the ledger: %v\", errIt))\n    }\n\n    deleted := history.GetIsDelete()\n\n    ds := strconv.FormatBool(deleted)\n\n    fmt.Println(\"History TxId = \"+history.GetTxId()+\" --  Delete = \"+ds)\n }\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>History TxId = 78c8d17c668d7a9df8373fd85df4fc398388976a1c642753bbf73abc5c648dd8 -- Deleted = false\n\nHistory TxId = 102bbb64a7ca93367334a8c98f1f7be17e6a8d5277f0167c73da47072d302fa3 -- Deleted = true\n</code></pre>\n\n<p>But I don't know, which peer did this transaction. Is there any API available in <strong>fabric-sdk-go</strong> to retrieve peer info for a transaction id.</p>\n\n<p>please suggest me some solution.</p>\n"}, {"tags": ["http", "go", "handler", "middleware"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562618070, "post_id": 56942186, "comment_id": 100424368, "body": "You can&#39;t with that type of middleware. You could if your handlers used a non-standard signature to return an error (which means they would only work with your middleware). Or you could just handle your errors in your handlers."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1562618491, "post_id": 56942186, "comment_id": 100424574, "body": "Just as you can pass data into the handler by storing it in the context, so you can have the handler store the error in the context and have the middleware look for it after the handler exits. If you&#39;ve done that but it didn&#39;t work for you can you show the code you&#39;ve tried?"}, {"owner": {"reputation": 11, "user_id": 11756468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c339bde88560bcd9c89c9902b6f92aa?s=128&d=identicon&r=PG&f=1", "display_name": "sharklasers", "link": "https://stackoverflow.com/users/11756468/sharklasers"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1562619105, "post_id": 56942186, "comment_id": 100424834, "body": "@mkopriva I was unsure of how to get context from the handler back to the middleware. To get from middleware to handler I substituted with this <code>next.ServeHTTP(w, r.WithContext(context.WithValue(r.Context(), ContextKey, &quot;THIS IS A VALUE FROM MIDDLEWARE&quot;)))</code> and then in the handler I was able to access with: <code>r.Context().Value(ContextKey).(string)</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1562619807, "post_id": 56942186, "comment_id": 100425070, "body": "@sharklasers right, I forgot about the shallow copy that <code>WithContext</code> returns which makes it a little bit different to do from handler to middleware, but it&#39;s possible, although maybe not idiomatic. When you call <code>WithContext</code> in the handler you save the result in a new variable, say <code>r2</code>, then you use that to update the pointer of the original request like so <code>*r = *r2</code>, now when the handler exists the middleware can access the context of <code>r2</code> using the <code>r</code> variable."}], "owner": {"reputation": 11, "user_id": 11756468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c339bde88560bcd9c89c9902b6f92aa?s=128&d=identicon&r=PG&f=1", "display_name": "sharklasers", "link": "https://stackoverflow.com/users/11756468/sharklasers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562617858, "creation_date": 1562617858, "question_id": 56942186, "link": "https://stackoverflow.com/questions/56942186/conditional-middleware-behavior-via-handler", "title": "Conditional middleware behavior via handler", "body": "<p>I am trying to implement conditional middleware behavior after a handler call. </p>\n\n<p>I've looked into contexts and was able to alter/use them as flags, passing data INTO the handler from the middleware but not FROM the handler to middleware. The method signatures do not allow for return values.</p>\n\n<p>This is a quick writeup of what I am working with:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func Reporter(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        next.ServeHTTP(w, r)\n        // conditionally check if err != nil here and log\n    })\n}\n\nfunc appRoutes(r chi.Router) {\n    r.Use(Reporter)\n    r.Get(\"/\", ListApplications)\n}\n\nfunc ListApplications(w http.ResponseWriter, , r *http.Request) {\n    apps, err := fetchApps()\n    if err != nil {\n        render.Render(w, r, ErrorStructRenderer(err))\n        return\n    }\n    render.Respond(w, r, apps)\n}\n</code></pre>\n"}, {"tags": ["go", "websocket"], "comments": [{"owner": {"reputation": 999, "user_id": 1584308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YAV1v.png?s=128&g=1", "display_name": "hewiefreeman", "link": "https://stackoverflow.com/users/1584308/hewiefreeman"}, "edited": false, "score": 0, "creation_date": 1562645516, "post_id": 56941280, "comment_id": 100430043, "body": "I personally like <a href=\"https://github.com/gorilla/websocket\" rel=\"nofollow noreferrer\">github.com/gorilla/websocket</a> better. I use it in my game server: <a href=\"https://github.com/hewiefreeman/GopherGameServer\" rel=\"nofollow noreferrer\">github.com/hewiefreeman/GopherGameServer</a>"}, {"owner": {"reputation": 1, "user_id": 10562672, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQlai5QD09Y/AAAAAAAAAAI/AAAAAAAAAJc/i7QWTEb0r_k/photo.jpg?sz=128", "display_name": "Dinamis", "link": "https://stackoverflow.com/users/10562672/dinamis"}, "reply_to_user": {"reputation": 999, "user_id": 1584308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YAV1v.png?s=128&g=1", "display_name": "hewiefreeman", "link": "https://stackoverflow.com/users/1584308/hewiefreeman"}, "edited": false, "score": 0, "creation_date": 1562661504, "post_id": 56941280, "comment_id": 100436239, "body": "@hueyfreeman gorilla ws probbably a bit more popular and common, but it&#39;s probably got same problem with Io.Writer and OpConn. The direct problem is to store them, and i don&#39;t know how to do it exactly."}, {"owner": {"reputation": 999, "user_id": 1584308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YAV1v.png?s=128&g=1", "display_name": "hewiefreeman", "link": "https://stackoverflow.com/users/1584308/hewiefreeman"}, "edited": false, "score": 0, "creation_date": 1562664661, "post_id": 56941280, "comment_id": 100437959, "body": "What do you mean by store them? In memory? The socket connection <code>conn</code> is right there for you to use in your endless for-loop (that you should be <code>break</code>ing out of on error). You shouldn&#39;t ever need to touch any of the readers/writers yourself."}, {"owner": {"reputation": 1, "user_id": 10562672, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQlai5QD09Y/AAAAAAAAAAI/AAAAAAAAAJc/i7QWTEb0r_k/photo.jpg?sz=128", "display_name": "Dinamis", "link": "https://stackoverflow.com/users/10562672/dinamis"}, "reply_to_user": {"reputation": 999, "user_id": 1584308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YAV1v.png?s=128&g=1", "display_name": "hewiefreeman", "link": "https://stackoverflow.com/users/1584308/hewiefreeman"}, "edited": false, "score": 0, "creation_date": 1562667465, "post_id": 56941280, "comment_id": 100439365, "body": "@hueyfreeman i&#39;m need exactly as Example in NodeJS. Probably to use variable that will send message or channel will be easyer, but my goal is learning."}], "owner": {"reputation": 1, "user_id": 10562672, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQlai5QD09Y/AAAAAAAAAAI/AAAAAAAAAJc/i7QWTEb0r_k/photo.jpg?sz=128", "display_name": "Dinamis", "link": "https://stackoverflow.com/users/10562672/dinamis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562613368, "creation_date": 1562613368, "question_id": 56941280, "link": "https://stackoverflow.com/questions/56941280/websocketserver-send-message-on-event-to-connected-client", "title": "WebsocketServer: send message on event to connected client", "body": "<p>Problem is simple: i have WS server that doing it's \"for {}\". I need \"register\" connected user, then send message on event(outside of CoreWS function). I'm added NodeJS example that doing exactly what i need, for better understanding.</p>\n\n<p>Go Lang Code that fails:\ni'm using this pkg <a href=\"https://github.com/gobwas/ws\" rel=\"nofollow noreferrer\">https://github.com/gobwas/ws</a></p>\n\n<pre><code>var conn_itf interface{} //yeah,\nvar op_itf interface{} //i know it's not how it works\n\nfunc main() {\n    go collector()\n    go sender()\n    http.ListenAndServe(\":3333\", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        conn, _, _, err := ws.UpgradeHTTP(r, w)\n        if err != nil {\n            // handle error\n        }\n        go func() {\n            defer conn.Close()\n\n            for {\n                msg, op, err := wsutil.ReadClientData(conn)\n                conn_itf = conn // i'm trying to \"register\" user\n                op_itf = op\n                if err != nil {\n\n                }\n                err = wsutil.WriteServerMessage(conn, op, msg)\n                if err != nil {\n\n                }\n            }\n        }()\n    }))\n}\n\nfunc collector() {\n    for {\n        fmt.Println(\"conn: \", conn_itf)\n        fmt.Println(\"op: \", op_itf)\n        time.Sleep(10000 * time.Millisecond)\n    }\n}\n\nfunc sender() {\n    for {\n        msg := []byte(\"Hello world!\")\n        time.Sleep(50000 * time.Millisecond)\n        wsutil.WriteServerMessage(conn_itf, op_itf, msg)  //invoking ws-send\n    }\n}\n</code></pre>\n\n<p>NodeJS that working:</p>\n\n<pre><code>const wss = new WebSocket.Server({ port: 3333 })\nwss.on('connection', ws =&gt; {\n    sockets.set('key', ws) //this code remember active connection\n    ws.on('message', message =&gt; {\n      console.log(`Received message =&gt; ${message}`)\n    })\n\n})\n\n\nfunction callsend(data) {\n    const ws = sockets.get('key') //this code sending message on invoking\n    ws.send(data)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562610297, "post_id": 56940366, "comment_id": 100421357, "body": "That&#39;s not only achievable, it&#39;s the definition of a typical Go program. Take a look at any Go project using modules for examples. There is no &quot;best way&quot; to structure a project. If you&#39;re having a specific problem, please post about that problem and include the relevant code."}, {"owner": {"reputation": 3246, "user_id": 815612, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/aff0866587273eeae903c6bd2715b717?s=128&d=identicon&r=PG", "display_name": "Jack M", "link": "https://stackoverflow.com/users/815612/jack-m"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562613237, "post_id": 56940366, "comment_id": 100422502, "body": "@Adrian My problem is that I don&#39;t know where to begin and <i>can&#39;t find</i> any example code. <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">The official tutorial</a> only talks about <i>external</i> dependencies. <a href=\"https://vsupalov.com/go-folder-structure/\" rel=\"nofollow noreferrer\">This article</a> seems to suggest that if I just use the cmd/internal style directory structure and then type <code>go run [my main file]</code> it should work, but that didn&#39;t work. Meanwhile, googling the problems leads to many many forum threads with people complaining about how this is hard to do and suggesting workarounds involving <code>replace</code>."}, {"owner": {"reputation": 3246, "user_id": 815612, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/aff0866587273eeae903c6bd2715b717?s=128&d=identicon&r=PG", "display_name": "Jack M", "link": "https://stackoverflow.com/users/815612/jack-m"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562613273, "post_id": 56940366, "comment_id": 100422510, "body": "I <i>do not have</i> a specific problem and example code because <i>I am a beginner and have no idea what I&#39;m doing</i>. I have of course tried a lot of things, but I&#39;m not going to post 10 <code>.go</code> files worth of dead ends in here just to show I tried. All I would need is a simple two-file example project like I suggested  complete with directory structure and what <code>go run</code> command to use."}], "answers": [{"comments": [{"owner": {"reputation": 3246, "user_id": 815612, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/aff0866587273eeae903c6bd2715b717?s=128&d=identicon&r=PG", "display_name": "Jack M", "link": "https://stackoverflow.com/users/815612/jack-m"}, "edited": false, "score": 0, "creation_date": 1562617493, "post_id": 56941679, "comment_id": 100424161, "body": "Thanks, I was able to replicate your working example. I&#39;ll have to look at it more closely tomorrow. I think probably the big thing that tripped me up is that the file name doesn&#39;t matter. Coming from Python, it was just obvious to me that of <i>course</i> the file name has to appear in your import statement."}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "reply_to_user": {"reputation": 3246, "user_id": 815612, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/aff0866587273eeae903c6bd2715b717?s=128&d=identicon&r=PG", "display_name": "Jack M", "link": "https://stackoverflow.com/users/815612/jack-m"}, "edited": false, "score": 0, "creation_date": 1562618103, "post_id": 56941679, "comment_id": 100424382, "body": "I&#39;m glad it worked and hope it help! Golang is similar to Java and .NET in that the directory structure reflects the package structure not the file names. The good news is that, if this make sense, you&#39;ve pretty much cracked package management in Golang."}], "tags": [], "owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1597016149, "last_edit_date": 1597016149, "creation_date": 1562615162, "answer_id": 56941679, "question_id": 56940366, "link": "https://stackoverflow.com/questions/56940366/how-should-i-structure-a-go-module-so-as-to-be-able-to-run-it-easily-and-import/56941679#56941679", "title": "How should I structure a Go module so as to be able to run it easily and import internal packages?", "body": "<p>It is confusing and the documentation assumes a level of familiarity with Golang. I've been trying to understand Modules recently.</p>\n<h3>The previous|current way without Modules:</h3>\n<pre class=\"lang-sh prettyprint-override\"><code>WORKDIR=[[PATH-TO-YOUR-WORKING-DIRECTORY]]\n\nmkdir -p ${WORKDIR}/go\nexport GOPATH=${WORKDIR}/go\nexport PATH=${GOPATH}/bin:${PATH}\n\nmkdir -p {${WORKDIR}/go/src/foo, ${WORKDIR}/go/src/foo/bar}\n</code></pre>\n<p>Then create <code>${WORKDIR}/go/src/foo/bar/library.go</code>:</p>\n<pre><code>package bar\n\nfunc Something() (string) {\n    return &quot;Hello Freddie&quot;\n}\n</code></pre>\n<p>Then create <code>${WORKDIR}/go/src/foo/main.go</code>:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;foo/bar&quot;\n)\n\nfunc main() {\n    fmt.Printf(&quot;%s&quot;, bar.Something())\n}\n</code></pre>\n<p>You'll have a structure like this:</p>\n<pre><code>.\n\u2514\u2500\u2500 go\n    \u2514\u2500\u2500 src\n        \u2514\u2500\u2500 foo\n            \u251c\u2500\u2500 bar\n            \u2502\u00a0\u00a0 \u2514\u2500\u2500 library.go\n            \u2514\u2500\u2500 main.go\n</code></pre>\n<p>Then you may run this either of the following ways:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>GO111MODULE=off go run ${WORKDIR}/go/src/main.go\nHello Freddie!\n\ncd ${WORKDIR}/go/src/\nGO111MODULE=off go run main.go\nHello Freddie!\n\nGO111MODULE=off go run foo\nHello Freddie!\n</code></pre>\n<h3>The new (!) way with Modules:</h3>\n<p>Assuming you've done the above!</p>\n<p>You don't need to do this step but this is the new best practice. We're moving our sources outside of <code>${GOPATH}</code>. <code>${GOPATH}</code> is still used to store our versioned packages. <strong>NB</strong> In this trivial example, we're not using external packages so <code>${GOPATH}</code> remains empty.</p>\n<pre class=\"lang-sh prettyprint-override\"><code>mv ${WORKDIR}/go/src/foo ${WORKDIR}\nrm ${WORKDIR}/go/src\n</code></pre>\n<p>You should a structure like this:</p>\n<pre><code>.\n\u251c\u2500\u2500 foo\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bar\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 library.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u2514\u2500\u2500 go\n</code></pre>\n<p><strong>NB</strong> Our sources are now outside of <code>${GOPATH}</code></p>\n<pre class=\"lang-sh prettyprint-override\"><code>cd ${WORKDIR}/foo\n\nGO111MODULE=on go mod init foo\nmore go.mod\nmodule foo\n\ngo 1.12\n\nGO111MODULE=on go run foo\nHello Freddie!\n\nGO111MODULE=on go run main.go\nHello Freddie!\n</code></pre>\n<h3>For Completeness</h3>\n<p>To show the difference with external packages:</p>\n<p>No Modules pulls the latest version of the package into <code>${GOPATH}/src</code>:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>GO111MODULE=off go get github.com/golang/glog\n\n.\n\u251c\u2500\u2500 foo\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bar\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 library.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 go.mod\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 go.sum\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u2514\u2500\u2500 go\n    \u2514\u2500\u2500 src\n        \u2514\u2500\u2500 github.com\n            \u2514\u2500\u2500 golang\n                \u2514\u2500\u2500 glog\n                    \u251c\u2500\u2500 glog_file.go\n                    \u251c\u2500\u2500 glog.go\n                    \u251c\u2500\u2500 glog_test.go\n                    \u251c\u2500\u2500 LICENSE\n                    \u2514\u2500\u2500 README\n</code></pre>\n<p>Versus using Modules, pulls a specific version (or versions) of the package into <code>${GOPATH}/pkg</code>:</p>\n<pre><code>GO111MODULE=on go get github.com/golang/glog\n\n.\n\u251c\u2500\u2500 foo\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bar\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 library.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 go.mod\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 go.sum\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u2514\u2500\u2500 go\n    \u2514\u2500\u2500 pkg\n     \u00a0\u00a0 \u251c\u2500\u2500 linux_amd64\n     \u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 github.com\n     \u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 golang\n     \u00a0\u00a0 \u2502\u00a0\u00a0         \u2514\u2500\u2500 glog.a\n     \u00a0\u00a0 \u2514\u2500\u2500 mod\n     \u00a0\u00a0     \u251c\u2500\u2500 cache\n     \u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 download\n     \u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 github.com\n     \u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 golang\n     \u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2514\u2500\u2500 glog\n     \u00a0\u00a0     \u2514\u2500\u2500 github.com\n     \u00a0\u00a0         \u2514\u2500\u2500 golang\n     \u00a0\u00a0             \u2514\u2500\u2500 glog@v0.0.0-20160126235308-23def4e6c14b\n     \u00a0\u00a0                 \u251c\u2500\u2500 glog_file.go\n     \u00a0\u00a0                 \u251c\u2500\u2500 glog.go\n     \u00a0\u00a0                 \u251c\u2500\u2500 glog_test.go\n     \u00a0\u00a0                 \u251c\u2500\u2500 LICENSE\n     \u00a0\u00a0                 \u2514\u2500\u2500 README\n\n</code></pre>\n<h3>Notes</h3>\n<ul>\n<li>Our file names are somewhat arbitrary. You said <code>library.go</code> so I've used that and conventionally, files are named after their content.</li>\n<li>Our directory names are important. Go uses directory names to help find packages. So, even though <code>library.go</code> could have been called <code>freddie.go</code> or <code>something.go</code>, it's important that it be <code>package bar</code> and in a directory called <code>bar</code>.</li>\n<li>An exception to these rules is that <code>main.go</code> is conventionally where <code>func main() {...}</code> is defined and <code>func main() {...}</code> must be in a package called <code>main</code>. So, even though the directory is called <code>foo</code>, because we want a <code>main</code> function, we name the file <code>main.go</code> and it must be <code>package main</code>.</li>\n<li>In package <code>bar</code>, it's important that <code>Something</code> be initially capitalized (<code>S</code>). This exports the function from the <code>bar</code> package so that it may be used by other packages. If the function's name were lowercase (<code>something</code>), the function is only available to other functions within the <code>bar</code> package.</li>\n</ul>\n"}], "owner": {"reputation": 3246, "user_id": 815612, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/aff0866587273eeae903c6bd2715b717?s=128&d=identicon&r=PG", "display_name": "Jack M", "link": "https://stackoverflow.com/users/815612/jack-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1597016149, "creation_date": 1562609026, "question_id": 56940366, "link": "https://stackoverflow.com/questions/56940366/how-should-i-structure-a-go-module-so-as-to-be-able-to-run-it-easily-and-import", "title": "How should I structure a Go module so as to be able to run it easily and import internal packages?", "body": "<p>I'm just discovering Go. When I started looking at it last week, I found out GOPATH and how Go apparently is very opinionated about what directories you store your code in. So I cursed Google's name and decided Go wasn't for me, then recently heard about Go modules and how apparently they resolve this very issue.</p>\n\n<p>The trouble is that information online on how to structure a module-based Go project appears to be very scarce. I'm having trouble figuring out how to lay out my code and what to call the packages in order to get imports working. I've tried various things and looked at examples but no matter what I do, I get \"unknown import path\" errors.</p>\n\n<p>Basically I want to have a directory with, say, <code>main.go</code> and <code>library.go</code>, maybe with <code>library.go</code> in a subdirectory. I want to be able to write <code>import library</code> or something similar in <code>main.go</code> and be able to access members of <code>library.go</code>. I also want to be able to run the code by typing <code>go run main.go</code>. Is this achievable?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 4, "last_activity_date": 1562603972, "creation_date": 1562603972, "answer_id": 56939249, "question_id": 56939128, "link": "https://stackoverflow.com/questions/56939128/how-to-create-type-conditionals-for-functions-that-accept-interface-in-go/56939249#56939249", "title": "How to create type conditionals for functions that accept interface{} in go?", "body": "<p>Use type assertions like</p>\n\n<pre><code>keySlice := keys.([]interface{})\nvalSlice := values.([]interface{})\n</code></pre>\n\n<p>and work with those from that point onwards. You can even eliminate the use of <code>reflect</code>, like:</p>\n\n<pre><code>keySlice, keysIsSlice := keys.([]interface{})\nvalSlice, valuesIsSlice := values.([]interface{})\n\nif (keysIsSlice &amp;&amp; valuesIsSlice) {\n    // work with keySlice, valSlice\n    return\n}\n\nkeyString, keysIsString := keys.(string)\nvalString, valuesIsString := values.(string)\n\nif (keysIsString &amp;&amp; valuesIsString) {\n    // work with keyString, valString\n    return\n}\n\nreturn errors.New(\"types don't match\")\n</code></pre>\n\n<p>Or you can structure the whole thing as type switches:</p>\n\n<pre><code>switch k := keys.(type) {\ncase []interface{}:\n    switch v := values.(type) {\n    case []interface{}:\n        // work with k and v as slices\n    default:\n        // mismatch error\n    }\ncase string:\n    switch v := values.(type) {\n    case string:\n        // work with k and v as strings\n    default:\n        // mismatch error\n    }\ndefault:\n    // unknown types error\n}\n</code></pre>\n"}], "owner": {"reputation": 987, "user_id": 5753523, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/hDUF7.png?s=128&g=1", "display_name": "calbear47", "link": "https://stackoverflow.com/users/5753523/calbear47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56939249, "answer_count": 1, "score": -1, "last_activity_date": 1562603972, "creation_date": 1562603436, "question_id": 56939128, "link": "https://stackoverflow.com/questions/56939128/how-to-create-type-conditionals-for-functions-that-accept-interface-in-go", "title": "How to create type conditionals for functions that accept interface{} in go?", "body": "<p>I'm writing a function that is meant to accept either strings or slices in go. However, when I type my parameters as <code>interface{}</code> I can't perform actions upon those variables even when inside a conditional which checks the type.</p>\n\n<p>Can the compiler deduce that my local variable must be of type <code>Slice</code> once inside my <code>if</code> block? How can I accomplish a <code>for</code> loop over the <code>Slice</code> after I know for certain it is a Slice? </p>\n\n<pre><code>func createFields(keys interface{}, values interface{}) ([]map[string]interface{}, error) {\n    fields := make([]map[string]interface{}, 1, 1)\n    if reflect.TypeOf(keys).Kind() == reflect.Slice &amp;&amp; reflect.TypeOf(values).Kind() == reflect.Slice {\n        if len(keys.([]interface{})) != len(values.([]interface{})) {\n            return fields, errors.New(\"The number of keys and values must match\")\n        }\n        // How can I loop over this slice inside the if block?\n        for i, key := range keys.([]interface{}) {\n            item := map[string]string{\n                \"fieldID\":    keys[i], // ERROR: invalid operation: keys[i] (type interface {} does not support indexing)\n                \"fieldValue\": values[i],\n            }\n            fields.append(item)// ERROR: fields.append undefined (type []map[string]interface {} has no field or method append)\n        }\n\n        return fields, _\n\n    }\n\n    if reflect.TypeOf(keys).Kind() == reflect.String &amp;&amp; reflect.Typeof(values).Kind() == reflect.String {\n        item := map[string]string{\n            \"fieldID\":    keys,\n            \"fieldValue\": values,\n        }\n        fields.append(item)\n        return fields, _\n    }\n\n    return fields, errors.New(\"Parameter types did not match\")\n}\n</code></pre>\n"}, {"tags": ["go", "base64", "hex"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1562604144, "last_edit_date": 1562604144, "creation_date": 1562603734, "answer_id": 56939196, "question_id": 56938989, "link": "https://stackoverflow.com/questions/56938989/decode-base64-and-encode-it-to-hex/56939196#56939196", "title": "Decode base64 and encode it to hex", "body": "<p>Use the following code:</p>\n\n<pre><code>doc_id := \"Can35qPeFkm9Xgmp9+aj3g==\"\nbase64_decode, err := base64.StdEncoding.DecodeString(doc_id)\nif err != nil {\n    log.Fatal(\"error:\", err)\n}\nfmt.Println(hex.EncodeToString(base64_decode))\n</code></pre>\n\n<p>Directly encode the bytes in <code>base64_decode</code> as hex.</p>\n\n<p>The call to <code>fmt.Sprintf(\"%q\", base64_decode)</code> returns a string with the bytes escaped per Go's string literal rules. In the general case, the bytes in the returned string are not equal to the bytes in <code>base64_decode</code>. For example, the input byte 0x11 is escaped to the four bytes <code>\\x11</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10865104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e389beadd06fe9cb51cea053a43b131?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus R. Gonzalez L.", "link": "https://stackoverflow.com/users/10865104/jesus-r-gonzalez-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1562626879, "creation_date": 1562626879, "answer_id": 56943474, "question_id": 56938989, "link": "https://stackoverflow.com/questions/56938989/decode-base64-and-encode-it-to-hex/56943474#56943474", "title": "Decode base64 and encode it to hex", "body": "<p>what happens is that the conversion that fmt.Sprintf(\"%q\", base64_decode) makes to base64_decode, in this process to convert some bytes in the memory are lost.</p>\n\n<p>here you below I leave an example: <a href=\"https://play.golang.org/p/pdQBp7NsvQM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pdQBp7NsvQM</a></p>\n\n<pre><code>doc_id := \"Can35qPeFkm9Xgmp9+aj3g==\"\nvar_encode := b64.StdEncoding.EncodeToString([]byte(doc_id))\nfmt.Println(var_encode)\nvar_decode , _ := b64.StdEncoding.DecodeString(var_encode)\nfmt.Println(string(var_decode))\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11740404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f71be9edd0c20c62b1ab0954c3114e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/11740404/mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 56939196, "answer_count": 2, "score": 0, "last_activity_date": 1562626879, "creation_date": 1562602913, "question_id": 56938989, "link": "https://stackoverflow.com/questions/56938989/decode-base64-and-encode-it-to-hex", "title": "Decode base64 and encode it to hex", "body": "<p>I have following code which decodes base64 and then encodes it to hex.</p>\n\n<pre><code>doc_id := \"Can35qPeFkm9Xgmp9+aj3g==\"\nbase64_decode, err := base64.StdEncoding.DecodeString(doc_id)\nif err != nil {\nlog.Fatal(\"error:\", err)\n}\nbase64_decoded := fmt.Sprintf(\"%q\", base64_decode)\nfmt.Printf(\"base_decoded %v\\n\", base64_decoded)\n\n\n\nsrc := []byte(base64_decoded)\nfmt.Println(src)\nhex_encode := make([]byte, hex.EncodedLen(len(src)))\nhex.Encode(hex_encode, src)\nhex_encoded := fmt.Sprintf(\"%s\", hex_encode)\nfmt.Printf(\"hex_encoded %v\", hex_encoded)\n</code></pre>\n\n<p>where doc_id is base64 format.\nbase64_decoded is its decoded value.\nI have to encode it to hex, so i pass it to src.</p>\n\n<p>The problem is when i pass the identifier base64_decoded to src i get wrong when i pass in the value that base64_decoded is holding i get correct answer.\nfor example:\nif i get base64_decoded value as \"\\x11z\\xc0[d~\\xfcK\\xb1\\xf8\\x11z\\xc0[d~\"\nif i pass its value which is \"\\x11z\\xc0[d~\\xfcK\\xb1\\xf8\\x11z\\xc0[d~\", i get correct answer 117ac05b647efc4bb1f8117ac05b647e</p>\n\n<p>if i pass the variable holding \"\\x11z\\xc0[d~\\xfcK\\xb1\\xf8\\x11z\\xc0[d~\" i get wrong answer 225c7831317a5c7863305b647e5c7866634b5c7862315c7866385c7831317a5c7863305b647e22dn</p>\n\n<p>Has it got something with this assignment <strong>base64_decoded := fmt.Sprintf(\"%q\", base64_decode)</strong></p>\n\n<p>what am i doing wrong</p>\n"}, {"tags": ["git", "http", "go", "go-modules"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1564523991, "post_id": 56938451, "comment_id": 101057414, "body": "<a href=\"https://gitlab.com/\" rel=\"nofollow noreferrer\">Gitlab</a> offers unlimited free private repositories. That would be a more featureful and secure solution."}, {"owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1564565176, "post_id": 56938451, "comment_id": 101069670, "body": "Hehe I&#39;ll use this comment to push GitLab in front of bureaucracy :)"}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "is_accepted": false, "score": 0, "last_activity_date": 1564514416, "creation_date": 1564514416, "answer_id": 57278708, "question_id": 56938451, "link": "https://stackoverflow.com/questions/56938451/using-go-modules-with-private-repositories-via-http-without-ssl/57278708#57278708", "title": "Using Go modules with private repositories via HTTP without SSL", "body": "<p>The <code>go</code> command begins fetching a given module path by resolving that path to a version-control location. In order to resolve the path, it issues an HTTPS request and looks for a <code>&lt;meta name=\"go-import\" [\u2026]&gt;</code> tag as described at <a href=\"https://tip.golang.org/cmd/go/#hdr-Remote_import_paths\" rel=\"nofollow noreferrer\">https://tip.golang.org/cmd/go/#hdr-Remote_import_paths</a>.</p>\n\n<p>If you want it to skip that step, you must indicate that the import path is a raw version-control path by using a version-control suffix (listed in that same documentation).</p>\n\n<p>If you write <code>import \"git.ourdomain.net/foo/bar/reponame.git\"</code> instead of <code>import \"git.ourdomain.net/foo/bar/reponame\"</code>, you should find that the initial HTTPS resolution is skipped and the subsequent <code>git</code> operation uses the <code>insteadOf</code> declaration from your global <code>git</code> configuration.</p>\n"}], "owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1666, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1564514416, "creation_date": 1562600760, "last_edit_date": 1562604469, "question_id": 56938451, "link": "https://stackoverflow.com/questions/56938451/using-go-modules-with-private-repositories-via-http-without-ssl", "title": "Using Go modules with private repositories via HTTP without SSL", "body": "<p>Is there a way to force the <code>go</code> command to use HTTP instead of HTTPS?</p>\n\n<p>I am trying to move a project to Go Modules, but this project includes a private <code>git</code> repository as a dependency.\nThis <code>git</code> repository is hosted in a private LAN behind a firewall and I usually \nclone it with something like <code>cd $GOPATH/git.ourdomain.net/foo/bar/ &amp;&amp; git clone http://my-user:my-password@git.ourdomain.net/foo/bar/reponame.git</code>.</p>\n\n<p>However now the commands <code>go mod</code>, <code>go get</code> and <code>go test</code> are trying to use HTTP with SSL (HTTPS).</p>\n\n<p>This setting is not helping:</p>\n\n<pre><code>git config \\\n  --global \\\n  url.\"http://my-user:my-password@git.ourdomain.net/foo/bar/reponame\".insteadOf \\\n  \"http://git.ourdomain.net\"\n</code></pre>\n\n<p>(Check here for some context around <code>git</code> settings for private repositories: <a href=\"https://medium.com/cloud-native-the-gathering/go-modules-with-private-git-repositories-dfe795068db4\" rel=\"nofollow noreferrer\">https://medium.com/cloud-native-the-gathering/go-modules-with-private-git-repositories-dfe795068db4</a>)</p>\n\n<p>I've amended the file <code>go.mod</code> to include a reference to that private repository (using a pattern like <code>git.ourdomain.net/foo/bar/reponame@v0.0.0-&lt;YYYYMMDDHHmmSS&gt;-&lt;GIT_COMMIT_ID&gt;</code>), but when invoking <code>go test</code> with a file <code>go.mod</code> including that private repo, then I see:</p>\n\n<pre><code>go: git.ourdomain.net/foo/bar/reponame@v0.0.0-&lt;YYYYMMDDHHmmSS&gt;-&lt;GIT_COMMIT_ID&gt;: unrecognized import path \"git.ourdomain.net/foo/bar/reponame\" (https fetch: Get https://git.ourdomain.net/foo/bar/reponame?go-get=1: dial tcp &lt;PUBLIC_IP_ADDRESS&gt;:443: connect: connection refused)\n</code></pre>\n\n<p>I've also tried to revert <code>go.mod</code> to the original version (without that private repository) and tried to <code>go get</code> from the path where the file <code>go.mod</code> is stored, assuming that will somehow update the <code>go.mod</code> file via HTTP because of <code>-insecure</code> (check here <a href=\"https://golang.org/cmd/go/#hdr-Module_aware_go_get\" rel=\"nofollow noreferrer\">https://golang.org/cmd/go/#hdr-Module_aware_go_get</a>), like this:</p>\n\n<pre><code>GO111MODULE=on go get -insecure -u git.ourdomain.net/foo/bar/reponame\n</code></pre>\n\n<p>But this gave the error message: </p>\n\n<pre><code>fatal: remote error: Repository not found\nThe requested repository does not exist, or you do not have permission to\naccess it.\n</code></pre>\n\n<p>I know I should use SSL, but I've never had control on this <code>git</code> server to configure it the way it should be configured. So I just used <code>git clone</code> providing an HTTP URL (when behind the firewall) and it always worked.</p>\n"}, {"tags": ["go", "stackdriver", "google-cloud-stackdriver", "opencensus"], "comments": [{"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1562632680, "post_id": 56937653, "comment_id": 100427885, "body": "Have you enabled billing on the Google Cloud Platform project?"}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1562633029, "post_id": 56937653, "comment_id": 100427950, "body": "APIs Explorer is an excellent tool for testing any Google REST API. See this for enumerating Stackdriver Monitoring time series: <a href=\"https://developers.google.com/apis-explorer/#search/monitoring.projects.timeseries.list/m/monitoring/v3/monitoring.projects.timeSeries.list\" rel=\"nofollow noreferrer\">developers.google.com/apis-explorer/#search/&hellip;</a>"}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1562633436, "post_id": 56937653, "comment_id": 100427991, "body": "The OpenCensus page also recommends <code>view.SetReportingPeriod(60 * time.Second)</code> for Stackdriver (<a href=\"https://opencensus.io/exporters/supported-exporters/go/stackdriver/#creating-the-exporter\" rel=\"nofollow noreferrer\">opencensus.io/exporters/supported-exporters/go/stackdriver/&zwnj;&#8203;&hellip;</a>). You should <code>sd.Flush()</code> before exiting but I think that&#39;s not your issue."}, {"owner": {"reputation": 5906, "user_id": 198825, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aba9dac582a7e4346b1895366200e2f2?s=128&d=identicon&r=PG", "display_name": "noamt", "link": "https://stackoverflow.com/users/198825/noamt"}, "reply_to_user": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1562655748, "post_id": 56937653, "comment_id": 100433296, "body": "Thanks, @DazWilkin . Yes, billing is enabled. I&#39;ll check out the open census docs"}], "answers": [{"tags": [], "owner": {"reputation": 5906, "user_id": 198825, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aba9dac582a7e4346b1895366200e2f2?s=128&d=identicon&r=PG", "display_name": "noamt", "link": "https://stackoverflow.com/users/198825/noamt"}, "is_accepted": true, "score": 3, "last_activity_date": 1562657583, "creation_date": 1562657583, "answer_id": 56947466, "question_id": 56937653, "link": "https://stackoverflow.com/questions/56937653/custom-opencensus-metrics-not-appearing-on-stackdriver/56947466#56947466", "title": "Custom OpenCensus metrics not appearing on Stackdriver", "body": "<p>The issue was in the user guide.\nYou must in fact register the exporter and set a reporting interval:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>view.RegisterExporter(exporter)\nview.SetReportingPeriod(60 * time.Second)\n</code></pre>\n"}], "owner": {"reputation": 5906, "user_id": 198825, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/aba9dac582a7e4346b1895366200e2f2?s=128&d=identicon&r=PG", "display_name": "noamt", "link": "https://stackoverflow.com/users/198825/noamt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 56947466, "answer_count": 1, "score": 2, "last_activity_date": 1562657583, "creation_date": 1562597952, "question_id": 56937653, "link": "https://stackoverflow.com/questions/56937653/custom-opencensus-metrics-not-appearing-on-stackdriver", "title": "Custom OpenCensus metrics not appearing on Stackdriver", "body": "<p>I'm trying to send custom metrics to Stackdriver from my Go application using OpenCensus.</p>\n\n<p>I've followed the <a href=\"https://cloud.google.com/monitoring/custom-metrics/open-census\" rel=\"nofollow noreferrer\">guide</a>, so the views and exporter are setup:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"context\"\n    \"contrib.go.opencensus.io/exporter/stackdriver\"\n    \"github.com/pkg/errors\"\n    \"go.opencensus.io/stats\"\n    \"go.opencensus.io/stats/view\"\n    \"time\"\n)\n\nvar (\n    apiRequestDurationMs = stats.Int64(\"api_request_duration\", \"API request duration in milliseconds\", stats.UnitMilliseconds)\n)\n\nfunc NewMetricsExporter() (*stackdriver.Exporter, error) {\n    v := &amp;view.View{\n        Name:        \"api_request_durations\",\n        Measure:     apiRequestDurationMs,\n        Description: \"The distribution of request durations\",\n        Aggregation: view.Distribution(0, 100, 200, 400, 1000, 2000, 4000),\n    }\n    if registerError := view.Register(v); registerError != nil {\n        return nil, errors.Wrapf(registerError, \"failed to register request duration view\")\n    }\n\n    exporter, exporterError := stackdriver.NewExporter(stackdriver.Options{ProjectID: \"project-ID\"})\n    if exporterError != nil {\n        return nil, errors.Wrapf(exporterError, \"failed to create stackdriver exporter\")\n    }\n\n    if startError := exporter.StartMetricsExporter(); startError != nil {\n        return nil, errors.Wrapf(startError, \"failed to create stackdriver exporter\")\n\n    }\n    return exporter, nil\n}\n</code></pre>\n\n<p>And then I send my metrics using:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func RequestDuration(d time.Duration) {\n    stats.Record(context.Background(), apiRequestDurationMs.M(int64(d)))\n}\n</code></pre>\n\n<p>But the custom metrics I'm sending aren't appearing in Stackdriver's Metrics Explorer.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["go", "dns", "resolve", "musl"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562597761, "post_id": 56937331, "comment_id": 100415419, "body": "Is it <i>fully static</i> build or not? IOW, does running <code>ldd .&#47;that_binary</code> displays dependency on some <code>libc</code>?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1562597890, "post_id": 56937331, "comment_id": 100415503, "body": "I&#39;m asking because by default the <code>net</code> package uses <code>libc</code> for name resolution; in fully static builds, a custom stub code is used. See <a href=\"https://golang.org/pkg/net/#hdr-Name_Resolution\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://www.google.com/search?q=golang+cgo+resolver\" rel=\"nofollow noreferrer\">this</a> in general."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1562598016, "post_id": 56937331, "comment_id": 100415594, "body": "Plus the go resolver will read resolv.conf and nsswitch.conf, as long as they don&#39;t specify any features that require the system resolver."}, {"owner": {"reputation": 5834, "user_id": 274460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b76693482ab729ff9f4cf92406d95623?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/274460/tom"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562598795, "post_id": 56937331, "comment_id": 100416094, "body": "@kostix I&#39;ve added some detail to the question."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1562600833, "post_id": 56937331, "comment_id": 100417170, "body": "If the binary is linked to libc, and this happens both with and without CGO regardless of <code>GODEBUG=netdns</code> settings, then it appears that both resolvers act identically. Without <code>hosts: files</code> in nsswitch, a linux system resolver is not going to read <code>&#47;etc&#47;hosts</code> first, which is where <code>localhost</code> is defined."}, {"owner": {"reputation": 5834, "user_id": 274460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b76693482ab729ff9f4cf92406d95623?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/274460/tom"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1562601029, "post_id": 56937331, "comment_id": 100417275, "body": "@JimB as far as I can tell, that&#39;s only true for GNU libc systems - other libc implementations don&#39;t use nsswitch.conf."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1562602175, "post_id": 56937331, "comment_id": 100417825, "body": "Even if it&#39;s only glibc, Go following the behavior of the most common resolver wouldn&#39;t be surprising, especially since that implementation was partly a concession to match existing system behaviors to begin with. Though it appears from your description here the musl resolver does the same?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562605805, "post_id": 56937331, "comment_id": 100419427, "body": "After reading <a href=\"https://wiki.musl-libc.org/functional-differences-from-glibc.html#Name-Resolver/DNS\" rel=\"nofollow noreferrer\">this</a> I wonder what&#39;s the value of your <code>ndots</code> conf. variable?"}, {"owner": {"reputation": 5834, "user_id": 274460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b76693482ab729ff9f4cf92406d95623?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/274460/tom"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562770192, "post_id": 56937331, "comment_id": 100482890, "body": "@kostix ndots is not set in my resolv.conf.  I think it defaults to 1."}], "owner": {"reputation": 5834, "user_id": 274460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b76693482ab729ff9f4cf92406d95623?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/274460/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1562605832, "creation_date": 1562596799, "last_edit_date": 1562605832, "question_id": 56937331, "link": "https://stackoverflow.com/questions/56937331/golangs-handling-of-localhost", "title": "golang&#39;s handling of localhost", "body": "<p>I have an alpine linux system which uses the musl libc and therefore has no <code>/etc/nsswitch.conf</code>.</p>\n\n<p>According to tcpdump on this system, <code>net.LookupIP(\"localhost\")</code> actually does a query for <code>localhost.a.b.c</code>, where <code>a.b.c</code> is taken from <code>domain a.b.c</code> in <code>/etc/resolv.conf</code>.  But if I add an <code>/etc/nsswitch.conf</code> with <code>hosts: files dns</code>, it correctly looks up <code>localhost</code> from <code>/etc/hosts</code>.</p>\n\n<p>As far as I can tell, no libc implementation tries to add a domain to <code>localhost</code> when looking it up in DNS.  So (a) is there some good reason it's done this way or is it a bug?  and (b) is there a way to work around it without adding an nsswitch.conf and while still using just the name <code>localhost</code>?</p>\n\n<p><strong><em>Edit</em></strong> More details:</p>\n\n<pre><code>ldd ./dnstest\n    /lib/ld-musl-armhf.so.1 (0x76f2c000)\n    libc.so =&gt; /lib/ld-musl-armhf.so.1 (0x76f2c000)\n</code></pre>\n\n<p>So yes, there is a dependency on <code>libc.so</code>.  I have tried this with <code>CGO_ENABLED=1</code> and with <code>CGO_ENABLED=0</code> in the build commandline, too.</p>\n"}, {"tags": ["go", "cloudflare"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562595594, "post_id": 56936861, "comment_id": 100414112, "body": "<code>f</code> is undefined in your quoted code, and <code>sourceFile</code> is unused.. It&#39;s unlikely that <code>NewUploadFromFile</code> actually requires an <code>os.File</code>; any <code>io.Reader</code> is probably fine (check the documentation for <code>NewUploadFromFile</code> in the CloudFlare SDK docs). Just pass the <code>file</code> you got back from <code>formFile</code>."}, {"owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562595807, "post_id": 56936861, "comment_id": 100414237, "body": "Yes, there are several variables that are undefined (I have cut some code and forget to change it here). But if I pass file it does not work"}], "answers": [{"tags": [], "owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "is_accepted": true, "score": 4, "last_activity_date": 1562598535, "creation_date": 1562598535, "answer_id": 56937832, "question_id": 56936861, "link": "https://stackoverflow.com/questions/56936861/how-to-convert-type-multipart-file-to-os-file-in-golang/56937832#56937832", "title": "How to convert type multipart.File to *os.File in Golang", "body": "<p>This is actually related to the <a href=\"https://github.com/eventials/go-tus\" rel=\"nofollow noreferrer\"><code>go-tus</code> client</a>.</p>\n\n<p>Cloudflare's example creates a <code>tus.Upload</code> from an <code>*os.File</code>, but rather than trying to \"convert\" your <code>multipart.File</code> to an <code>*os.File</code>, I would consider the other functions <code>go-tus</code> provides for getting a <code>tus.Upload</code>.</p>\n\n<p>Looking at the <a href=\"https://godoc.org/github.com/eventials/go-tus\" rel=\"nofollow noreferrer\"><code>docs</code></a>, you should consider these two:</p>\n\n<ul>\n<li><code>func NewUpload(reader io.Reader, size int64, metadata Metadata, fingerprint string) *Upload</code></li>\n<li><code>func NewUploadFromBytes(b []byte) *Upload</code></li>\n</ul>\n\n<p>Considering <code>multipart.File</code> implements the <code>io.Reader</code> interface, you can go with both of these. Which is best depends on your use case, but if the files being uploaded have a size of more than several tens of KB's, you should really <code>NewUpload</code>. <code>NewUploadFromBytes</code> forces you to read the entire file into memory first.</p>\n\n<p>In case you need some inspiration for what the <code>size</code>, <code>metadata</code> and <code>fingerprint</code> arguments should contain, look at the <a href=\"https://github.com/eventials/go-tus/blob/master/upload.go#L60\" rel=\"nofollow noreferrer\">implementation of <code>NewUploadFromFile</code></a>.</p>\n"}], "owner": {"reputation": 1068, "user_id": 9099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5de81fb6a10f82f3f4c0d2287a963d3?s=128&d=identicon&r=PG&f=1", "display_name": "Klimbo", "link": "https://stackoverflow.com/users/9099830/klimbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2074, "favorite_count": 0, "accepted_answer_id": 56937832, "answer_count": 1, "score": 2, "last_activity_date": 1562598535, "creation_date": 1562595289, "last_edit_date": 1562595844, "question_id": 56936861, "link": "https://stackoverflow.com/questions/56936861/how-to-convert-type-multipart-file-to-os-file-in-golang", "title": "How to convert type multipart.File to *os.File in Golang", "body": "<p>I am trying to upload video to CloudFlare, but in docs they use os.Open but in my situation user uploads file via html form</p>\n\n<p>Golang CloudFlare Docs: <a href=\"https://developers.cloudflare.com/stream/getting-started/uploading-golang/\" rel=\"nofollow noreferrer\">https://developers.cloudflare.com/stream/getting-started/uploading-golang/</a></p>\n\n<pre><code>file, err := c.FormFile(\"file\")\nif err != nil {\n    log.Errorf(\"get file error: %s\", err)\n    return c.JSONStatus(http.StatusBadRequest)\n}\n\nsourceFile, err := file.Open()\nif err != nil {\n    log.Errorf(\"open file error: %s\", err)\n    return c.JSONStatus(http.StatusInternalServerError)\n}\n\nheaders := make(http.Header)\nheaders.Add(\"X-Auth-Email\", \"***\")\nheaders.Add(\"X-Auth-Key\", \"***\")\n\nconfig := &amp;tus.Config{\n    ChunkSize:           5 * 1024 * 1024, // Cloudflare Stream requires a minimum chunk size of 5MB.\n    Resume:              false,\n    OverridePatchMethod: false,\n    Store:               nil,\n    Header:              headers,\n}\n\nclient, _ := tus.NewClient(\"https://api.cloudflare.com/client/v4/accounts/\"+ accountID +\"/media\", config)\n\nupload, _ := tus.NewUploadFromFile(sourceFile)\n\nuploader, _ := client.CreateUpload(upload)\n\nuploader.Upload()\n</code></pre>\n"}, {"tags": ["go", "heroku", "httpserver"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9451782, "user_type": "registered", "profile_image": "https://graph.facebook.com/1963254207037202/picture?type=large", "display_name": "Michael Chandra Lrc", "link": "https://stackoverflow.com/users/9451782/michael-chandra-lrc"}, "edited": false, "score": 0, "creation_date": 1562595477, "post_id": 56936531, "comment_id": 100414030, "body": "thanks for the quick answer, it really helps me understanding why my app cant run on heroku. Following your advice now my app run successfully. Thank You!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1562595596, "last_edit_date": 1562595596, "creation_date": 1562594200, "answer_id": 56936531, "question_id": 56936448, "link": "https://stackoverflow.com/questions/56936448/deploying-a-golang-app-on-heroku-build-succeed-but-application-error/56936531#56936531", "title": "Deploying a golang app on heroku, build succeed but application error", "body": "<p>Your app starts but is getting killed because you don't bind your webserver to the specified port. This is clear from the log message:</p>\n\n<blockquote>\n  <p>2019-07-08T05:03:48.131507+00:00 heroku[web.1]: Error R10 (Boot timeout) -> Web process failed to bind to $PORT within 60 seconds of launch</p>\n</blockquote>\n\n<p>On Heroku you have to bind your HTTP server to the port specified by the <code>PORT</code> environment variable. Your app will be publicly available on default HTTP and HTTPS ports with the help of Heroku gateways.</p>\n\n<p>So start your server on the expected port. Instead of this:</p>\n\n<pre><code>err := grace.Serve(\":9000\", context.ClearHandler(http.DefaultServeMux))\n</code></pre>\n\n<p>Do this:</p>\n\n<pre><code>port := os.Getenv(\"PORT\")\nif port == \"\" {\n    port = \"9000\" // Default port if not specified\n}\nerr := grace.Serve(\":\" + port, context.ClearHandler(http.DefaultServeMux))\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9451782, "user_type": "registered", "profile_image": "https://graph.facebook.com/1963254207037202/picture?type=large", "display_name": "Michael Chandra Lrc", "link": "https://stackoverflow.com/users/9451782/michael-chandra-lrc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 56936531, "answer_count": 1, "score": 1, "last_activity_date": 1562595596, "creation_date": 1562593976, "last_edit_date": 1562594666, "question_id": 56936448, "link": "https://stackoverflow.com/questions/56936448/deploying-a-golang-app-on-heroku-build-succeed-but-application-error", "title": "Deploying a golang app on heroku, build succeed but application error", "body": "<p>My golang app runs on port 9000 at my localhost. After deploying it at heroku using godep support, i was able to push and deploy at heroku. However when i try to access the endpoint e.g '/', it shows Application Error. You can see below my code and log while deploying at heroku</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/gorilla/mux\"\n    \"github.com/gorilla/context\"\n\n    \"gopkg.in/paytm/grace.v1\"\n\n    // utilhttp \"bitbucket.org/michaelchandrag/chit/pkg/util/http\"\n    // util \"bitbucket.org/michalechandrag/chit/pkg/util\"\n)\n\nfunc main() {\n    log.Println(\"$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ CHIT STARTED $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\")\n    log.Println(\"$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\")\n\n    muxRouter := mux.NewRouter()\n\n    muxRouter.HandleFunc(\"/\", Articles)\n    http.Handle(\"/\", muxRouter)\n\n    // err = grace.Serve(\":\"+cfg.Server.Port, context.ClearHandler(http.DefaultServeMux))\n    err := grace.Serve(\":9000\", context.ClearHandler(http.DefaultServeMux))\n    if err != nil {\n        log.Println(\"[ERROR GRACEFUL]\", err)\n        os.Exit(1)\n    }\n\n    os.Exit(0)\n}\n\nfunc Articles(w http.ResponseWriter, r *http.Request) {\n    // vars := mux.Vars(r)\n    w.WriteHeader(http.StatusOK)\n    fmt.Fprintf(w, \"Hello\")\n    // r.Close = true\n    // w.Header().Set(\"Content-Type\", \"application/json\")\n    // w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n\n    /*if r.Method == \"OPTIONS\" {\n        w.WriteHeader(http.StatusOK)\n        return\n    }\n\n    if err := fn(w, r); err != nil {\n        log.Println(err)\n        apiObject := ConstructAPIError(http.StatusInternalServerError, ErrGeneral, SysMsgErrGeneral, MsgErrGeneral)\n        SendAPIObject(w, apiObject)\n        return\n    }*/\n}\n</code></pre>\n\n<p>heroku logs while deploying</p>\n\n<pre><code>-----&gt; Go app detected\n-----&gt; Fetching jq... done\n-----&gt; Fetching stdlib.sh.v8... done\n-----&gt; Checking Godeps/Godeps.json file.\n-----&gt; New Go Version, clearing old cache\n-----&gt; Installing go1.12.6\n-----&gt; Fetching go1.12.6.linux-amd64.tar.gz... done\n-----&gt; Running: go install -v -tags heroku ./... \nbitbucket.org/michaelchandrag/chit/pkg\nbitbucket.org/michaelchandrag/chit/vendor/github.com/gorilla/context\nbitbucket.org/michaelchandrag/chit/vendor/github.com/gorilla/mux\nbitbucket.org/michaelchandrag/chit/vendor/gopkg.in/tylerb/graceful.v1\nbitbucket.org/michaelchandrag/chit/vendor/gopkg.in/paytm/grace.v1\nbitbucket.org/michaelchandrag/chit/pkg/util\nbitbucket.org/michaelchandrag/chit\n\n       Installed the following binaries:\n            ./bin/chit\n-----&gt; Discovering process types\n       Procfile declares types -&gt; web\n-----&gt; Compressing...\n       Done: 7.5M\n-----&gt; Launching...\n       Released v3\n       https://michaelchandrag-project.herokuapp.com/ deployed to Heroku\n</code></pre>\n\n<p>app logs before and after access endpoint</p>\n\n<pre><code>2:47.954106+00:00 heroku[web.1]: Starting process with command `chit`\n2019-07-08T05:02:49.413453+00:00 app[web.1]: 2019/07/08 05:02:49 $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ CHIT STARTED $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\n2019-07-08T05:02:49.413476+00:00 app[web.1]: 2019/07/08 05:02:49 $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\n2019-07-08T05:02:49.413647+00:00 app[web.1]: 2019/07/08 05:02:49 starting serve on  :9000\n2019-07-08T05:03:48.131507+00:00 heroku[web.1]: Error R10 (Boot timeout) -&gt; Web process failed to bind to $PORT within 60 seconds of launch\n2019-07-08T05:03:48.131595+00:00 heroku[web.1]: Stopping process with SIGKILL\n2019-07-08T05:03:48.214979+00:00 heroku[web.1]: State changed from starting to crashed\n2019-07-08T05:03:48.193205+00:00 heroku[web.1]: Process exited with status 137\n2019-07-08T10:38:59.721224+00:00 heroku[web.1]: State changed from crashed to starting\n2019-07-08T10:39:00.359017+00:00 heroku[web.1]: Starting process with command `chit`\n2019-07-08T10:39:02.232435+00:00 app[web.1]: 2019/07/08 10:39:02 $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ CHIT STARTED $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\n2019-07-08T10:39:02.232458+00:00 app[web.1]: 2019/07/08 10:39:02 $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\n2019-07-08T10:39:02.232583+00:00 app[web.1]: 2019/07/08 10:39:02 starting serve on  :9000\n2019-07-08T10:40:00.462841+00:00 heroku[web.1]: Error R10 (Boot timeout) -&gt; Web process failed to bind to $PORT within 60 seconds of launch\n2019-07-08T10:40:00.462974+00:00 heroku[web.1]: Stopping process with SIGKILL\n2019-07-08T10:40:00.555959+00:00 heroku[web.1]: Process exited with status 137\n2019-07-08T10:40:00.573427+00:00 heroku[web.1]: State changed from starting to crashed\n2019-07-08T13:33:25.021835+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=michaelchandrag-project.herokuapp.com request_id=e6b5c93a-7177-4080-9858-ed925a20c513 fwd=\"36.74.35.162\" dyno= connect= service= status=503 bytes= protocol=https\n2019-07-08T13:33:25.566036+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=michaelchandrag-project.herokuapp.com request_id=35c741a9-be4d-48f6-ba99-ba24ddc58b9b fwd=\"36.74.35.162\" dyno= connect= service= status=503 bytes= protocol=https\n2019-07-08T13:48:38.294082+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=michaelchandrag-project.herokuapp.com request_id=57a3a243-58f4-4efe-b478-eb660d84fe1f fwd=\"36.74.35.162\" dyno= connect= service= status=503 bytes= protocol=https\n2019-07-08T13:48:38.616077+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=michaelchandrag-project.herokuapp.com request_id=0687b8a8-86ae-4c49-a37f-9cbf9e0f75de fwd=\"36.74.35.162\" dyno= connect= service= status=503 bytes= protocol=https\n</code></pre>\n"}, {"tags": ["mongodb", "go", "struct", "mongo-go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562584920, "post_id": 56933823, "comment_id": 100408085, "body": "Your struct tags are completely invalid, and <a href=\"https://play.golang.org/p/4rQ2Q-ge-WS\" rel=\"nofollow noreferrer\">won&#39;t even compile</a>."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11753899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24cac14711da550d13a4690ea7ccd54e?s=128&d=identicon&r=PG&f=1", "display_name": "moddos", "link": "https://stackoverflow.com/users/11753899/moddos"}, "edited": false, "score": 1, "creation_date": 1562586565, "post_id": 56933923, "comment_id": 100408878, "body": "I thought I don&#39;t have to specify values of other fields as well , brand.deploymentid  works thank you :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1562587614, "last_edit_date": 1562587614, "creation_date": 1562585130, "answer_id": 56933923, "question_id": 56933823, "link": "https://stackoverflow.com/questions/56933823/how-to-write-nested-bson-m-correctly/56933923#56933923", "title": "How to write nested bson.M{} correctly", "body": "<p>This filter:</p>\n\n<pre><code>filter := bson.M{\"brand\" : bson.M{\"_id\" : someValue}}\n</code></pre>\n\n<p>Tells you want documents that have a <code>brand</code> field that is an embedded document <strong>having a single <code>_id</code> field</strong> whose value is the value of <code>someValue</code>.</p>\n\n<p>This would actually work if your embedded documents would only consist of this single <code>_id</code> field, but your embedded <code>brand</code> has this ID field mapped to <code>deploymentid</code> and most likely has other fields as well (which you \"stripped off\" to minimize the example), and that is why it won't match.</p>\n\n<p>Instead you want documents that have a <code>brand</code> field being a document that has a matching <code>deployment</code> field <em>among other fields</em>. This is how you can express that:</p>\n\n<pre><code>filter := bson.M{\"brand.deploymentid\" : someValue}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11753899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24cac14711da550d13a4690ea7ccd54e?s=128&d=identicon&r=PG&f=1", "display_name": "moddos", "link": "https://stackoverflow.com/users/11753899/moddos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562587614, "creation_date": 1562584829, "last_edit_date": 1562586169, "question_id": 56933823, "link": "https://stackoverflow.com/questions/56933823/how-to-write-nested-bson-m-correctly", "title": "How to write nested bson.M{} correctly", "body": "<p>Suppose we have the following struct:</p>\n\n<pre><code>type shop struct {\n   ID primitive.ObjectID `json:\"_id,omitempty\" bson:\"_id,omitempty\"`\n   Brands *brand         `json:\"brand,omitempty\" bson:\"brand,omitempty\"`\n}\n\ntype brand struct {\n  ID primitive.ObjectID `json:\"_id,omitempty\" bson:\"deploymentid,omitempty\"`\n}\n</code></pre>\n\n<p>I tried to find a document using <code>findOne()</code> but I don't get any document even there is a result match by using the MongoDB shell. </p>\n\n<pre><code>filter := bson.M{\"brand\" : bson.M{\"_id\" : someValue}}\nvar shopWithBrand shop\nmycollection.findOne(ctx , filter).Decode(&amp;shopWithBrand)\n</code></pre>\n\n<p>What mistake did I make?</p>\n"}, {"tags": ["c#", "go", "dll", "geolocation"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562583345, "post_id": 56933071, "comment_id": 100407308, "body": "There are additional correction factors that are required.  See Wiki : <a href=\"https://en.wikipedia.org/wiki/Geographic_coordinate_system\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Geographic_coordinate_system</a>"}, {"owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562583639, "post_id": 56933071, "comment_id": 100407448, "body": "Thank you very much for the reference but would appreciate if someone implemented this in golang or implemented dll in golang with unix, linux and windows supported os."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562583972, "post_id": 56933071, "comment_id": 100407630, "body": "Net Library applications rely on Windows dlls and in a unix environment you are missing the windows dlls.  I&#39;m not sure why the standard correction factors due to earth not being truly circular is not already built into the libraries you are using."}, {"owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562584188, "post_id": 56933071, "comment_id": 100407741, "body": "Yeah your right but my last resort is by writing a small microservice to connect to my golang. But i read somehow dll is fine in unix environment. But cross platform support for dll is there but the problem is in golang how to read the windows dll or dll file."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562585323, "post_id": 56933071, "comment_id": 100408301, "body": "What are you getting for the accuracy?  See : <a href=\"https://developer.here.com/blog/tracking-device-location-with-golang-wlan-access-points-and-the-here-positioning-api\" rel=\"nofollow noreferrer\">developer.here.com/blog/&hellip;</a>"}, {"owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562585680, "post_id": 56933071, "comment_id": 100408463, "body": "Am getting for the elevation of the drone which i found only supported by c# or c which is dificult for me to readl dll in golang, also i need the accuracy of geoid for mean sea level"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562588273, "post_id": 56933071, "comment_id": 100409761, "body": "Early GPS receivers has issues with latitude and most receivers were fixed around 10-15 years ago.  Not sure why unix applications were not fixed.  Drones are pretty new so I would think their receiver are accurate.  What happens if you compare you cell phone location with the drone location.  I want to find out if the issue is with the drone or the issue with you PC.  Using a cell phone will tell which is wrong."}, {"owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1562631761, "post_id": 56933071, "comment_id": 100427756, "body": "Supposedly in windows environment supported the location stuff but on unix i cannot find any cross platform for dll."}], "owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562581959, "creation_date": 1562581959, "question_id": 56933071, "link": "https://stackoverflow.com/questions/56933071/compute-geoid-undulation-in-golang", "title": "Compute GeoId undulation in golang", "body": "<p>I need to compute for the undulation or geoID of lattitude and longitude using golang but i found this package i think its useful </p>\n\n<pre><code>https://github.com/garrettsickles/geolocation\n</code></pre>\n\n<p>implemented it but it gives me incorrect geoid and also i did by using dll which could be comfortable with me but the problem is that there is no easier way to read dll files in golang via unix environment but also found difficult to implement it</p>\n\n<pre><code>DLLExport\n</code></pre>\n\n<p>i used this in my dll\nand also i want to export it and read in golang\nbut in windows it could be possible but as golang newbie\ni cannot be able to figure out how can i achieve \nreading dll in golang in my unix environment (macos darwin)</p>\n\n<pre><code>   public interface IComputeMSL\n    {\n        // DLL Export from msl result\n        [DllExport(HelperStr.GetMSLDLL, CallingConvention.ThisCall)]\n        double GetMSLResult(double lat, double lon, double gpsElevation);\n        // DLL Export from WSG84\n        [DllExport(HelperStr.GetWSG84DLL, CallingConvention.ThisCall)]\n        double GetWSG84Result(double gpsElevation, double mslElevation);\n    }\n</code></pre>\n\n<p>this is my c# dll reader which keeps the geoid computation correctly </p>\n\n<pre><code>   public class ComputeMSL : IComputeMSL\n    {\n        /* GetMSLResult from the parameter as lat, lon, and gps elevation */\n        public double GetMSLResult(double lat, double lon, double gpsElevation) =&gt;\n            Helper.GetMSL(Helper.GetGeoID(lat, lon), gpsElevation);\n\n        /* GetWSG84Result from the parameter gpsElevation and mslElevation */\n        public double GetWSG84Result(double gpsElevation, double mslElevation) =&gt;\n            Helper.ConvertMSLToWSG84(gpsElevation, mslElevation);\n    }\n</code></pre>\n\n<p>this is computeMSL which computes the msl result and wsg84 both of them are written in c# and used this package for it</p>\n\n<pre><code>GeoidHeightsDotNet\n</code></pre>\n\n<p>if anyone can help me to configure correctly my dll to be able to read in unix and windows environment at the same time or any package that can support the computation of geoID in golang or package that can compute egm86, egm2008 i would appreciate your help.</p>\n"}, {"tags": ["go", "kubernetes", "kubernetes-helm"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562581945, "post_id": 56933053, "comment_id": 100406665, "body": "So what&#39;s the question? Are you having trouble doing what you want? If so, what have you tried? What output do you see, and what did you expect to see instead?"}, {"owner": {"reputation": 11, "user_id": 5196933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e6d0647a18062f866ab687a3a15c646?s=128&d=identicon&r=PG&f=1", "display_name": "Inder Singh", "link": "https://stackoverflow.com/users/5196933/inder-singh"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562582209, "post_id": 56933053, "comment_id": 100406794, "body": "erro --range cant be iterate over a:b"}], "answers": [{"tags": [], "owner": {"reputation": 2069, "user_id": 11207414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8d2b0efd28e43f5580e7546cf912f5?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11207414/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1562680355, "creation_date": 1562680355, "answer_id": 56954180, "question_id": 56933053, "link": "https://stackoverflow.com/questions/56933053/default-key-value-when-reading-values-from-values-file-in-helm-chart/56954180#56954180", "title": "default key value when reading values from values file in helm chart", "body": "<p>Please try this:</p>\n\n<pre><code> {{- if .Values.nodeLabel -}}\n    {{- range $key, $val := .Values.nodeLabel  }}\n    {{ $key }}: {{ $val }}\n  #  {{- end }}\n  {{ else }}\n     {{ default \"b: c\" }}\n  {{- end -}}\n</code></pre>\n\n<p>Additional resources: <a href=\"https://helm.sh/docs/chart_best_practices/\" rel=\"nofollow noreferrer\">The Chart Best Practices Guide</a></p>\n\n<p>Hope this help</p>\n"}], "owner": {"reputation": 11, "user_id": 5196933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e6d0647a18062f866ab687a3a15c646?s=128&d=identicon&r=PG&f=1", "display_name": "Inder Singh", "link": "https://stackoverflow.com/users/5196933/inder-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 587, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562705593, "creation_date": 1562581866, "last_edit_date": 1562705593, "question_id": 56933053, "link": "https://stackoverflow.com/questions/56933053/default-key-value-when-reading-values-from-values-file-in-helm-chart", "title": "default key value when reading values from values file in helm chart", "body": "<p>I want to pass the default key value while reading values file.</p>\n\n<pre><code>{{- range $key, $val := .Values.nodeLabel | default map[string]string{\"a\":\"b\"}}}\n</code></pre>\n\n<p><strong>Values.yaml nodeLabel - a: b</strong></p>\n\n<p>But i am trying to pass default value too.</p>\n\n<p><code>{{- range $key, $val := .Values.nodeLabel | default \"b:c\"</code></p>\n\n<p><strong>error</strong>- <code>range cannot iterate over b:c</code></p>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1562579200, "post_id": 56932052, "comment_id": 100405213, "body": "Did you try <code>go get github.com&#47;coreos&#47;go-oidc@v2</code> in your project directory? For me it seems that it added this dependency correctly."}, {"owner": {"reputation": 4336, "user_id": 819651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b3b2801b397b45b57b784c83b6274e22?s=128&d=identicon&r=PG", "display_name": "Lu&#237;s Soares", "link": "https://stackoverflow.com/users/819651/lu%c3%ads-soares"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1562582568, "post_id": 56932052, "comment_id": 100406941, "body": "that works well but it is not reflected in <code>go.mod</code> file. and when I navigate to the lib code it seems to be the old master version"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1562583498, "post_id": 56932052, "comment_id": 100407374, "body": "It wired that&#39;s is not reflected, because when I did that it automaticaly added me all dependencies. Here is my files which were generated after <code>go get</code> <a href=\"https://gist.github.com/t-tomalak/a55d9483a2ba876c9f11611456f77c8e\" rel=\"nofollow noreferrer\">gist.github.com/t-tomalak/a55d9483a2ba876c9f11611456f77c8e</a>"}, {"owner": {"reputation": 4336, "user_id": 819651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b3b2801b397b45b57b784c83b6274e22?s=128&d=identicon&r=PG", "display_name": "Lu&#237;s Soares", "link": "https://stackoverflow.com/users/819651/lu%c3%ads-soares"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1562585742, "post_id": 56932052, "comment_id": 100408493, "body": "do you have a reference to <code>SkipIssuerCheck</code> at <code>verify.go</code>? That would mean you have <code>v2</code>. otherwise you&#39;re in <code>master</code>"}, {"owner": {"reputation": 4336, "user_id": 819651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b3b2801b397b45b57b784c83b6274e22?s=128&d=identicon&r=PG", "display_name": "Lu&#237;s Soares", "link": "https://stackoverflow.com/users/819651/lu%c3%ads-soares"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1562585757, "post_id": 56932052, "comment_id": 100408501, "body": "<a href=\"https://github.com/coreos/go-oidc/blob/v2/verify.go#L243\" rel=\"nofollow noreferrer\">github.com/coreos/go-oidc/blob/v2/verify.go#L243</a>"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1562586082, "post_id": 56932052, "comment_id": 100408651, "body": "It&#39;s for sure pointed to newer version I can copy examples from v2 branch and their compile properly. Where are you checking code reference? It should be in <code>GOPATH&#47;pkg&#47;mod&#47;github.com&#47;coreos&#47;go-oidc@v2.0.0+incompatible</code> at least I had it there"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1562586291, "post_id": 56932052, "comment_id": 100408751, "body": "Could you share your <code>go.mod</code> and <code>go.sum</code> file?"}, {"owner": {"reputation": 4336, "user_id": 819651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b3b2801b397b45b57b784c83b6274e22?s=128&d=identicon&r=PG", "display_name": "Lu&#237;s Soares", "link": "https://stackoverflow.com/users/819651/lu%c3%ads-soares"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1562590933, "post_id": 56932052, "comment_id": 100411212, "body": "<a href=\"https://gist.github.com/lsoares/6d1bc0957c646f7c2d3bdf875ca16039\" rel=\"nofollow noreferrer\">gist.github.com/lsoares/6d1bc0957c646f7c2d3bdf875ca16039</a> the way the software is behaving it&#39;s like the old. and through IDE navigation I get to the old as well"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1562591163, "post_id": 56932052, "comment_id": 100411341, "body": "Did you try to run <code>go mod tidy &amp;&amp; go mod verify &amp;&amp; go mod download</code> ?"}, {"owner": {"reputation": 4336, "user_id": 819651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b3b2801b397b45b57b784c83b6274e22?s=128&d=identicon&r=PG", "display_name": "Lu&#237;s Soares", "link": "https://stackoverflow.com/users/819651/lu%c3%ads-soares"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1562596753, "post_id": 56932052, "comment_id": 100414810, "body": "it doesn&#39;t change.. but it might be IDE stuff if it works in yours - you get v2 branch. thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "is_accepted": true, "score": 0, "last_activity_date": 1564513713, "creation_date": 1564513713, "answer_id": 57278542, "question_id": 56932052, "link": "https://stackoverflow.com/questions/56932052/go-modules-how-to-reference-a-branch-in-github/57278542#57278542", "title": "Go Modules - how to reference a branch in GitHub", "body": "<p>The phrase <code>import path</code> in the error message suggests that somewhere in your code you have written something like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import \"github.com/coreos/go-oidc@v2\"\n</code></pre>\n\n<p>But the import path of a Go package does not include its version: only the entries in the <code>go.mod</code> and <code>go.sum</code> files do.</p>\n\n<p>So instead you should write:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import \"github.com/coreos/go-oidc\"\n</code></pre>\n\n<p>and update your <code>go.mod</code> and <code>go.sum</code> files by running</p>\n\n<pre><code>go get -d github.com/coreos/go-oidc@v2\n</code></pre>\n\n<p>That should result in an entry in your <code>go.mod</code> file like:</p>\n\n<pre><code>require github.com/coreos/go-oidc v2.0.0+incompatible\n</code></pre>\n"}], "owner": {"reputation": 4336, "user_id": 819651, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b3b2801b397b45b57b784c83b6274e22?s=128&d=identicon&r=PG", "display_name": "Lu&#237;s Soares", "link": "https://stackoverflow.com/users/819651/lu%c3%ads-soares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 0, "accepted_answer_id": 57278542, "answer_count": 1, "score": 2, "last_activity_date": 1564513713, "creation_date": 1562578441, "question_id": 56932052, "link": "https://stackoverflow.com/questions/56932052/go-modules-how-to-reference-a-branch-in-github", "title": "Go Modules - how to reference a branch in GitHub", "body": "<p>I'm using <a href=\"https://github.com/coreos/go-oidc\" rel=\"nofollow noreferrer\">Coreos OIDC library</a> and would like to know how to reference (in <code>go.mod</code> file) a branch, since they don't develop under <code>master</code> but use <code>v2</code> instead.</p>\n\n<p>I tried <code>github.com/coreos/go-oidc@v2</code> but I get:</p>\n\n<pre><code>go: github.com/coreos/go-oidc@v2@v2.0.0+incompatible: invalid github.com/ import path \"github.com/coreos/go-oidc@v2\"\ngo: error loading module requirements\n</code></pre>\n"}, {"tags": ["ios", "go", "apple-push-notifications"], "comments": [{"owner": {"reputation": 3448, "user_id": 230264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64319d2344224d2242f11e2c94792a9?s=128&d=identicon&r=PG", "display_name": "Simon Zimmermann", "link": "https://stackoverflow.com/users/230264/simon-zimmermann"}, "edited": false, "score": 0, "creation_date": 1562571268, "post_id": 56929690, "comment_id": 100401406, "body": "You could return an error, and handle that error accordingly. You are making a network request and network requests can time out. You&#39;ll have to decide how to deal with that scenario."}, {"owner": {"reputation": 284, "user_id": 10828054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tEPnX.jpg?s=128&g=1", "display_name": "ink", "link": "https://stackoverflow.com/users/10828054/ink"}, "reply_to_user": {"reputation": 3448, "user_id": 230264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a64319d2344224d2242f11e2c94792a9?s=128&d=identicon&r=PG", "display_name": "Simon Zimmermann", "link": "https://stackoverflow.com/users/230264/simon-zimmermann"}, "edited": false, "score": 0, "creation_date": 1562571480, "post_id": 56929690, "comment_id": 100401501, "body": "hi\uff0c@Simon Zimmermann\uff0cI can manually control the retry to send, but I don&#39;t understand why it will be shutdown"}], "owner": {"reputation": 284, "user_id": 10828054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tEPnX.jpg?s=128&g=1", "display_name": "ink", "link": "https://stackoverflow.com/users/10828054/ink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562568718, "creation_date": 1562568718, "question_id": 56929690, "link": "https://stackoverflow.com/questions/56929690/golang-use-apns2-dial-tcp-lookup-api-development-push-apple-com-on-xxx-read-u", "title": "golang use apns2, dial tcp: lookup api.development.push.apple.com on xxx: read udp xxx-&gt;xxx: i/o timeout", "body": "<p>I call apns2 in golang, which sometimes returns a timeout and the process will close.\nI am using go version go1.12.5 darwin / amd64.\nI have reviewed apns2's issues #24 and #21, I guess they have solved it, but there will still be problems.</p>\n\n<p>This is my code</p>\n\n<pre><code>func ApplePushNotificationService(deviceToken string, parameters string) {\n    cert, err := certificate.FromP12File(\"./hookupAPNS.p12\", \"******\")\n    if err != nil {\n        log.Fatal(\"Cert Error:\", err)\n    }\n    notification := &amp;apns2.Notification{}\n    notification.DeviceToken = deviceToken\n    notification.Topic = \"com.preferme.hookup\"\n    payload := payload.NewPayload().Alert(parameters).AlertBody(parameters).Badge(1).Sound(\"sound.wav\").Custom(\"key\", \"val\")\n    notification.Payload = payload\n    client := apns2.NewClient(cert).Production()\n    res, err := client.Push(notification)\n    if err != nil {\n        log.Fatal(\"push Error:\", err)\n    }\n    fmt.Printf(\"%v %v %v\\n\", res.StatusCode, res.ApnsID, res.Reason)\n}\n</code></pre>\n\n<p>This is the last log of the process shutdown.</p>\n\n<pre><code>push Error:Post https://api.development.push.apple.com/3/device/4dc8efa9c46b0206c2e6e0dda6a1314c457704f897747ae1f7dffe4ef31a443b: dial tcp: lookup api.development.push.apple.com on 10.143.22.116:53: read udp 10.116.213.185:38055-&gt;10.143.22.116:53: i/o timeout\n</code></pre>\n"}, {"tags": ["linux", "go", "system-calls"], "comments": [{"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1562568921, "post_id": 56929594, "comment_id": 100400348, "body": "it works with <code>GOOS=linux</code> on macOS, go version: <code>1.12.5</code>.  what&#39;s your go version?"}, {"owner": {"reputation": 1999, "user_id": 4431422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c443c3ff19187910aca1a5b7e0511f84?s=128&d=identicon&r=PG&f=1", "display_name": "Vipin Menon", "link": "https://stackoverflow.com/users/4431422/vipin-menon"}, "reply_to_user": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1562576972, "post_id": 56929594, "comment_id": 100404070, "body": "As mentioned above, I am running it within an Ubuntu system 14.04.1-Ubuntu..Go version: go version go1.2.1 linux/amd64"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562578092, "post_id": 56929594, "comment_id": 100404636, "body": "Have you tried update to a later version of Go?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1562582523, "post_id": 56929594, "comment_id": 100406919, "body": "Go1.2 was release in 2013. Update to the current version of go."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1562586471, "post_id": 56929594, "comment_id": 100408831, "body": "This field <a href=\"https://golang.org/doc/go1.7#syscall\" rel=\"nofollow noreferrer\">was added in Go 1.7</a>."}], "owner": {"reputation": 1999, "user_id": 4431422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c443c3ff19187910aca1a5b7e0511f84?s=128&d=identicon&r=PG&f=1", "display_name": "Vipin Menon", "link": "https://stackoverflow.com/users/4431422/vipin-menon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562586487, "creation_date": 1562568265, "last_edit_date": 1562586487, "question_id": 56929594, "link": "https://stackoverflow.com/questions/56929594/unknown-syscall-sysprocattr-field-unshareflags", "title": "unknown syscall.SysProcAttr field &#39;Unshareflags&#39;", "body": "<p>I was trying out the Syscall in Go and had created the struct</p>\n\n<pre><code>cmd.SysProcAttr = &amp;syscall.SysProcAttr{\n        //New UTS              Child become 1          Mount Name Space\n        Cloneflags:   syscall.CLONE_NEWUTS | syscall.CLONE_NEWPID | syscall.CLONE_NEWNS,\n        Unshareflags: syscall.CLONE_NEWNS, //Dont share the container to the host,\n    }\n</code></pre>\n\n<p>but I get the error :</p>\n\n<pre><code>unknown syscall.SysProcAttr field 'Unshareflags' in struct literal\n</code></pre>\n\n<p>From the documentation I understand it does not work in a mac. I tried running it on an Ubuntu VM:</p>\n\n<blockquote>\n  <p>Linux xxx 4.2.0-27-generic #32~14.04.1-Ubuntu SMP Fri Jan 22 15:32:26\n  UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</p>\n</blockquote>\n\n<p>Doesn't work as a sudo user either.</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 1, "last_activity_date": 1562575618, "last_edit_date": 1562575618, "creation_date": 1562569352, "answer_id": 56929819, "question_id": 56929295, "link": "https://stackoverflow.com/questions/56929295/read-select-columns-more-than-one-into-string-in-go/56929819#56929819", "title": "read \u201cSELECT *\u201d columns (more than one) into [][]string in go", "body": "<p>Suppose your query returns 4 columns, you just scan multiple values at once.</p>\n\n<pre><code>details:=[][]string{}\nfor rows.Next() {\n    cols := make([]string, 4) \n    rows.Scan(&amp;cols[0], &amp;cols[1], &amp;cols[2], &amp;cols[3])\n    details = append(details, cols)\n}\n</code></pre>\n\n<p>If the number of columns is not static, you can do something like this to automate it, instead of expanding the pointers manually:</p>\n\n<pre><code>details:=[][]string{}\nfor rows.Next() {\n    cols := make([]string, num_cols)\n    // Create an array of string pointers pointing to the column strings.\n    col_ptrs = make([]*string, num_cols)\n    for i := 0; i &lt; num_cols; i++ {\n        col_ptrs[i] = &amp;cols[i];\n    }\n    rows.Scan(col_ptrs...)\n    details = append(details, cols)\n}\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8660255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deab6881d51059ce496b8146ed41fc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Morteza Hasanabadi", "link": "https://stackoverflow.com/users/8660255/morteza-hasanabadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56929819, "answer_count": 1, "score": 0, "last_activity_date": 1562575618, "creation_date": 1562566714, "last_edit_date": 1562566814, "question_id": 56929295, "link": "https://stackoverflow.com/questions/56929295/read-select-columns-more-than-one-into-string-in-go", "title": "read \u201cSELECT *\u201d columns (more than one) into [][]string in go", "body": "<p>I want to insert MySQL database columns into [][]string in Go, here is a similar code which do this for only one column and insert it into []string but I need more columns into [][]string to make a data frame.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>mysql&gt; select * from users;\n+----+-----------+----------+----------+-------------------------------+--------------+\n| id | fname     | lname    | uname    | email                         | contact      |\n+----+-----------+----------+----------+-------------------------------+--------------+\n|  1 | Rishikesh | Agrawani | hygull   | rishikesh0014051992@gmail.com | 917353787704 |\n|  2 | Sandeep   | E        | sandeep  | sandeepeswar8@gmail.com       | 919739040038 |\n|  3 | Darshan   | Sidar    | darshan  | sidardarshan@gmail.com        | 917996917565 |\n|  4 | Surendra  | Prajapat | surendra | surendrakgadwal@gmail.com     | 918385894407 |\n|  5 | Mukesh    | Jakhar   | mukesh   | mjakhar.kjahhar@gmail.com     | 919772254140 |\n+----+-----------+----------+----------+-------------------------------+--------------+\n5 rows in set (0.00 sec)\n\nmysql&gt; \n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    // db, err := sql.Open(\"mysql\", \"&lt;username&gt;:&lt;password&gt;@tcp(127.0.0.1:&lt;port&gt;)/&lt;dbname&gt;?charset=utf8\" )\n    db, err := sql.Open(\"mysql\", \"hygull:admin@67@tcp(127.0.0.1:3306)/practice_db?charset=utf8\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    rows, err := db.Query(\"select fname from users\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    firstnames:=[]string{}\n    for rows.Next() {\n        var fname string\n        rows.Scan(&amp;fname)\n        firstnames = append(firstnames, fname)\n    }\n\n    fmt.Println(firstnames)\n    db.Close()\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562580131, "post_id": 56928028, "comment_id": 100405721, "body": "What do you mean there&#39;s no documentation? <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo\" rel=\"nofollow noreferrer\">This</a> looks pretty extensive to me. Is there something specific you feel is missing?"}, {"owner": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562691074, "post_id": 56928028, "comment_id": 100452894, "body": "@flimzy, Thanks for the -1.  It is my opinion the documentation is worthless without good examples. Documentation that says it takes an interface is useless without examples, in my opinion. You may be more advanced than I am, however comments like yours do not help the learning. The one I accepted was  perfect and should be a guide to writers of documentation."}, {"owner": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562704063, "post_id": 56928028, "comment_id": 100458136, "body": "I could have been more clear in &quot;Really no documentation&quot; to me means nothing useful for beginner/intermediate mongo-go developer. I did state the examples I found &quot;All references, as normal are the simplest and updating one field&quot;  in the various documentation.    Again the marked answer should be included in some more complete documentation aimed at the beginner/Intermediate developer."}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1562745320, "post_id": 56928028, "comment_id": 100468891, "body": "Hi @DonaldFrench, you can also find examples for MongoDB Go driver on <a href=\"https://docs.mongodb.com/manual/tutorial/query-documents/\" rel=\"nofollow noreferrer\">docs.mongodb.com/manual/tutorial/query-documents</a> and select the Go tab above to show the examples in Go. Hope that helps. Cheers."}, {"owner": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "edited": false, "score": 0, "creation_date": 1562817720, "post_id": 56928028, "comment_id": 100498350, "body": "Thank you @ Wan Bachtiar!  That is the type of documentation I was looking for. Based upon the answer I selected I have updates working perfectly."}], "answers": [{"comments": [{"owner": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "edited": false, "score": 0, "creation_date": 1562690842, "post_id": 56928722, "comment_id": 100452790, "body": "Perfect.  This type of information should be part of the documentation. Just saying it is an interface is useless.  Need simple and something more complex.    I am not sure what you $currentDate is doing though."}, {"owner": {"reputation": 627, "user_id": 2931316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOHqU.jpg?s=128&g=1", "display_name": "M Ashraful A", "link": "https://stackoverflow.com/users/2931316/m-ashraful-a"}, "reply_to_user": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "edited": false, "score": 1, "creation_date": 1562731769, "post_id": 56928722, "comment_id": 100463976, "body": "$currentDate for just in case you want to save last update timestamp, the above example will update the field &#39;updated&#39; with the current timestamp"}], "tags": [], "owner": {"reputation": 627, "user_id": 2931316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOHqU.jpg?s=128&g=1", "display_name": "M Ashraful A", "link": "https://stackoverflow.com/users/2931316/m-ashraful-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1562562665, "creation_date": 1562562665, "answer_id": 56928722, "question_id": 56928028, "link": "https://stackoverflow.com/questions/56928028/how-to-update-more-than-one-mongodb-field/56928722#56928722", "title": "How to update more than one MongoDB field", "body": "<p>For multiple fields, you have to create an array of bson element(<code>bson.E</code>). then append/assign as many fields you want in array item.</p>\n\n<pre><code>var update []bson.E\nif r.ReleaseImage != \"\" {\n    update = append(update, bson.E{\"releaseimage\", r.ReleaseImage})\n}\nif r.Releasepath != \"\" {\n    update = append(update, bson.E{\"releasepath\", r.Releasepath})\n}\n// now update db\nresult, err := coll.UpdateOne(\n        context.Background(),\n        bson.D{\n            {\"id\", r.ID},\n        },\n        bson.D{\n            {\"$set\", update},\n            {\"$currentDate\", bson.D{\n                {\"updated\", true},\n            }},\n        },\n    )\n</code></pre>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 1592, "user_id": 7251967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-al-If026iHU/AAAAAAAAAAI/AAAAAAAAABE/9lsheyH-V9Q/photo.jpg?sz=128", "display_name": "negi Yogi", "link": "https://stackoverflow.com/users/7251967/negi-yogi"}, "is_accepted": false, "score": 0, "last_activity_date": 1566285993, "last_edit_date": 1566285993, "creation_date": 1562570289, "answer_id": 56930034, "question_id": 56928028, "link": "https://stackoverflow.com/questions/56928028/how-to-update-more-than-one-mongodb-field/56930034#56930034", "title": "How to update more than one MongoDB field", "body": "<p>Simply do like this:</p>\n\n<pre><code>uQuery := make(bson.M)\nif len(r.ReleaseImage)&gt;0{\n  uQuery[\"releaseimage\"]=r.ReleaseImage\n}\nif len(r.Releasepath)&gt;0{\n  uQuery[\"releasepath\"]=r.Releasepath\n}\nupdateQ := make(bson.M)\nupdateQ[\"$set\"] = uQuery\n</code></pre>\n\n<p>Now simply pass 'updateQ' to mongodb update Wrapper function along with findQuery.</p>\n"}], "owner": {"reputation": 1515, "user_id": 1516001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d465bb8df6bda89904c7aafea0dda6c?s=128&d=identicon&r=PG", "display_name": "Donald French", "link": "https://stackoverflow.com/users/1516001/donald-french"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 56928722, "answer_count": 2, "score": -1, "last_activity_date": 1566285993, "creation_date": 1562556081, "last_edit_date": 1562580076, "question_id": 56928028, "link": "https://stackoverflow.com/questions/56928028/how-to-update-more-than-one-mongodb-field", "title": "How to update more than one MongoDB field", "body": "<p>I am so frustrated with the Official MongoDB for Go. There is really no documentation. I am trying to update more than one field in a collection. All references, as normal are the simplest and updating one field:</p>\n\n<pre><code>    update := bson.D{bson.E{\"$set\", bson.E{\"releaseimage\", r.ReleaseImage}}}\n</code></pre>\n\n<p>That works. I have tried various ways to expand that to set two fields and get errors:</p>\n\n<pre><code>    update := bson.D{\n        {\"$set\",\n            bson.E{\"releaseimage\", r.ReleaseImage},\n            //bson.E{\"releasepath\", r.ReleasePath},\n        },\n        // {\"$set\",\n        //  bson.E{\n        //      \"releasepath\", r.ReleasePath}},\n    }\n</code></pre>\n\n<p>the first one remove the  comments in the first set. invalid syntax for second attempt remove the comments on the second set. invalid syntax.</p>\n\n<p>I am at a loss.  To keep going I am doing two updates, one right after another. Inefficient.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "testing", "parallel-processing"], "answers": [{"comments": [{"owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 0, "creation_date": 1562568797, "post_id": 56928589, "comment_id": 100400292, "body": "Thanks for the answer. I guess based on this, there is no built in way to make all tests in a package parallel?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 0, "creation_date": 1562569574, "post_id": 56928589, "comment_id": 100400630, "body": "@hlin117 Yes, no &quot;global option&quot; that would quickly make all test parallel... An explicit naming convention is still required."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1562561526, "creation_date": 1562561526, "answer_id": 56928589, "question_id": 56927397, "link": "https://stackoverflow.com/questions/56927397/how-to-automatically-enable-tests-to-run-in-parallel-within-a-package/56928589#56928589", "title": "How to automatically enable tests to run in parallel within a package?", "body": "<p>This comes from <a href=\"https://github.com/golang/go/commit/f80d8fbcf0851959c047d55d0b31bbeb256a9f0c\" rel=\"nofollow noreferrer\">commit f80d8fb</a> and Go1 (Oct. 2011)</p>\n\n<p>An option (<code>--parallel</code>) was <a href=\"https://groups.google.com/forum/#!topic/golang-dev/RAKiqi44GEU/discussion\" rel=\"nofollow noreferrer\">debated at the time</a>, but quickly rejected:</p>\n\n<blockquote>\n  <p>Many tests won't work if run in parallel. (Many will, too.)<br>\n  The presence of a <code>--parallel</code> flag means scripts and so on will want to turn it on, and tests must be able to protect themselves from erroneous runs. </p>\n  \n  <p>I suggest whitelisting individual tests that are knowingly able to run\n  in parallel, and the easiest way to do this is to name them\n  differently. </p>\n  \n  <p>I like <code>t.Parallel</code>.<br>\n  It's clear which tests are parallel, it's not a global default, so you can apply it just to the tests where it is both appropriate and necessary,\n  and the behavior is great: all the non-parallel run\n  first - meaning the easy ones - and then the parallel\n  ones can chew cpu.</p>\n</blockquote>\n"}], "owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 56928589, "answer_count": 1, "score": 2, "last_activity_date": 1562561526, "creation_date": 1562549636, "question_id": 56927397, "link": "https://stackoverflow.com/questions/56927397/how-to-automatically-enable-tests-to-run-in-parallel-within-a-package", "title": "How to automatically enable tests to run in parallel within a package?", "body": "<p>I would like to run tests in a package in parallel. We know that the <a href=\"https://golang.org/pkg/testing/#T.Parallel\" rel=\"nofollow noreferrer\"><code>testing.Parallel</code> function</a> enables us to run two tests in a package in parallel, but is there a way to automatically enable all tests in a package to run in parallel without calling <code>t.Parallel()</code>? </p>\n\n<p>For example, are there any flags I can throw into <code>go test</code> to make all tests with the function signature <code>func(t *testing.T)</code> be ran in parallel?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 0, "creation_date": 1562548768, "post_id": 56927301, "comment_id": 100396109, "body": "Is there a way of doing this that does not require repeating the type name (<code>[]string{\u2026\u2026}</code>)?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1562549290, "post_id": 56927301, "comment_id": 100396190, "body": "interface{} is the catch-all generic type in go - but will only work if the target function accepts this generic type explicitly. I think you are angling for Generics - which go 1.X does not support. go 2.X may support generics, but that&#39;s a long way away."}, {"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1562550396, "post_id": 56927301, "comment_id": 100396345, "body": "@colminator ... go doesn&#39;t have first class or user-definable generics, but it does have certain built-in things like <code>range</code> and <code>append</code> that behave like polymorphic functions. It seems as though prepending to a slice is not possible without naming the type in question."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1562550641, "post_id": 56927301, "comment_id": 100396375, "body": "You certainly can achieve what you want as long as the root type is interface{}. See the reflect package. But to reiterate my earlier comment, your target function <i>must</i> accept an interface{} type to achieve any generic behavior."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 0, "creation_date": 1562552141, "post_id": 56927301, "comment_id": 100396596, "body": "@GregoryNisbet There is not a way to create the slice without mentioning a type."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1562564897, "last_edit_date": 1562564897, "creation_date": 1562548423, "answer_id": 56927301, "question_id": 56927159, "link": "https://stackoverflow.com/questions/56927159/idiom-for-mapping-multiple-arguments-to-single-variadic-parameter/56927301#56927301", "title": "idiom for mapping multiple &quot;arguments&quot; to single variadic parameter", "body": "<p>Create a slice with all of the arguments and splat that slice.</p>\n\n<pre><code>write(append([]string{\"foobarbaz\"}, os.Args[1:]...)...)\n</code></pre>\n\n<p>If the <code>string, []string</code> pattern is common in the application code, then consider writing a function to simplify the code at the call sites:</p>\n\n<pre><code>func stringArgs(s string, args []string) []string { \n   return append([]string{s}, args...)\n}\n\n...\n\nwrite(stringArgs(\"foobarbaz\", os.Args[1:])...)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>func writeStringArgs(s string, args []string) {\n    write(append([]string{\"foobarbaz\"}, os.Args[1:]...)...)\n}\n\n...\n\nwriteStringArgs(s, os.Args[1:])\n</code></pre>\n"}], "owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 56927301, "answer_count": 1, "score": 0, "last_activity_date": 1562564897, "creation_date": 1562546543, "question_id": 56927159, "link": "https://stackoverflow.com/questions/56927159/idiom-for-mapping-multiple-arguments-to-single-variadic-parameter", "title": "idiom for mapping multiple &quot;arguments&quot; to single variadic parameter", "body": "<p>Is there a way to use a combination of splatted arguments and simple arguments (defined below) in a function taking a variadic parameter in golang? If not, is there a well-known idiom that approximates this feature? If possible, is there an idiom approximating this feature that does not require repeating the type name?</p>\n\n<hr>\n\n<p>Suppose I have a function with a variadic parameter in golang of type <code>...T</code>.\nIt seems like your options at the call site are limited to:</p>\n\n<ul>\n<li>multiple <em>simple arguments</em>, each of type <code>T</code>, i.e. <code>f(\u2026\u2026 x1, x2, x3 \u2026\u2026)</code></li>\n<li>a single <em>splatted argument</em> of type <code>[]T</code>, i.e <code>f(\u2026\u2026 ...xs \u2026\u2026)</code></li>\n</ul>\n\n<p>In some other languages like Python, it is possible to <em>capture</em> a combination of simple arguments and splatted arguments with a variadic parameter:</p>\n\n<pre><code>$ python\n&gt;&gt;&gt; def foo(*args): return args\n... \n&gt;&gt;&gt; foo(1, 2, *[3, 4])\n(1, 2, 3, 4)\n</code></pre>\n\n<p>However, the same thing does not appear to work in go. </p>\n\n<pre><code>// splat.go\npackage main\n\nimport \"os\"\nimport \"fmt\"\n\nfunc write(args ...string) {\n        for _, item := range args {\n                fmt.Printf(\"%s\\n\", item)\n        }\n}\n\nfunc main() {\n        write(\"foobarbaz\", os.Args[1:]...)\n}\n</code></pre>\n\n<p>from the error message, it's clear that the splatted argument and the simple argument are not being mapped to the same parameter.</p>\n\n<pre><code>$ go run splat.go \n# command-line-arguments\n./splat.go:14: too many arguments in call to write\n</code></pre>\n"}, {"tags": ["php", "go", "aes", "rijndael", "cbc-mode"], "comments": [{"owner": {"reputation": 3, "user_id": 11751847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac54198bfc3738ee115fbf69663f02e0?s=128&d=identicon&r=PG&f=1", "display_name": "Daci", "link": "https://stackoverflow.com/users/11751847/daci"}, "edited": false, "score": 1, "creation_date": 1562546153, "post_id": 56926812, "comment_id": 100395725, "body": "OK - I re-re-read the documentation and AES-256 is using only 128 bytes IV (16 chars).. AES is a variant of Rijndael that has a fixed block size of 128 bits, and a key size of 128, 192, or 256 bits.  The Rijndael documentation specifiy with block and key sizes multiple of 32 bits, with a minimum of 128 and a maximum of 256 bits, hence the confusion AES is not RIJNDAEL - only a variant.  I guess the only solution is to decrypt the sensitive data in php and encrypt it using 128 bytes IV.  Anyone know another library - compatible with RIJNDAEL 250 that works with IV of 256 bytes (32 chars)?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 11751847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac54198bfc3738ee115fbf69663f02e0?s=128&d=identicon&r=PG&f=1", "display_name": "Daci", "link": "https://stackoverflow.com/users/11751847/daci"}, "is_accepted": false, "score": 0, "last_activity_date": 1562580592, "last_edit_date": 1592644375, "creation_date": 1562580592, "answer_id": 56932700, "question_id": 56926812, "link": "https://stackoverflow.com/questions/56926812/decrypt-aes-cbc-256-mcrypt-rijndael-encrypted-in-php-decrypt-on-golang/56932700#56932700", "title": "Decrypt AES-CBC-256 Mcrypt_RIJNDAEL encrypted in PHP decrypt on GOLang", "body": "<p>This works in Linux - for anyone courious how to decode with IV 32 characters</p>\n<blockquote>\n<p>apt install libmcrypt-dev</p>\n<p>go get &quot;github.com/tblyler/go-mcrypt&quot;</p>\n</blockquote>\n<pre class=\"lang-go-lang prettyprint-override\"><code>import (\n  &quot;fmt&quot;\n  &quot;github.com/tblyler/go-mcrypt&quot;\n  &quot;encoding/base64&quot;\n)\n\nconst (\n   KEY = &quot;12345678901234567890123456789012&quot;\n   ENC = &quot;Egu4tSySXluBLi5dcMzHbZHVSOS7jdNwUKUFlZ8dL1yATFjg26/Nav7cWtlJJL3djhUCND6KV8r/JL7owboKFA==&quot;\n)\n\nfunc main(){\n    encText, _ := base64.StdEncoding.DecodeString(ENC)\n\n    iv := encText[:32]\n    toDecrypt := encText[32:]\n\n    fmt.Printf(&quot;Key Len: %d\\n&quot;,len(KEY))\n    fmt.Printf(&quot;IV  Len: %d\\n&quot;,len(iv))\n\n    decText, err := mcrypt.Decrypt([]byte(KEY),iv,[]byte(toDecrypt))\n    if err != nil { panic(err) }\n\n    fmt.Printf(&quot;%s\\n&quot;,decText)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24042, "user_id": 1356107, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/qXxvn.png?s=128&g=1", "display_name": "Tschallacka", "link": "https://stackoverflow.com/users/1356107/tschallacka"}, "is_accepted": false, "score": 0, "last_activity_date": 1562580931, "creation_date": 1562580931, "answer_id": 56932787, "question_id": 56926812, "link": "https://stackoverflow.com/questions/56926812/decrypt-aes-cbc-256-mcrypt-rijndael-encrypted-in-php-decrypt-on-golang/56932787#56932787", "title": "Decrypt AES-CBC-256 Mcrypt_RIJNDAEL encrypted in PHP decrypt on GOLang", "body": "<p>I've been playing with a similar issue, when transporting code from php 5.6 to php 7.3. The easiest and most reliable way I have found is just to decrypt all the values with php 5.6 and then recrypt with the new format that works well. It's a one time thing to do when moving over, but it saves a lot of headaches.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11751847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac54198bfc3738ee115fbf69663f02e0?s=128&d=identicon&r=PG&f=1", "display_name": "Daci", "link": "https://stackoverflow.com/users/11751847/daci"}, "is_accepted": false, "score": 0, "last_activity_date": 1562598463, "last_edit_date": 1592644375, "creation_date": 1562598463, "answer_id": 56937809, "question_id": 56926812, "link": "https://stackoverflow.com/questions/56926812/decrypt-aes-cbc-256-mcrypt-rijndael-encrypted-in-php-decrypt-on-golang/56937809#56937809", "title": "Decrypt AES-CBC-256 Mcrypt_RIJNDAEL encrypted in PHP decrypt on GOLang", "body": "<p>I just test it from my MacOS, the above code is working from Mohave 10.14.5.</p>\n<p>I used MacPorts to install libmcrypt</p>\n<blockquote>\n<p>sudo port install libmcrypt</p>\n<p>mkdir mcrypt\ncurl -o mcrypt/mcrypt.go <a href=\"https://raw.githubusercontent.com/tblyler/go-mcrypt/master/mcrypt.go\" rel=\"nofollow noreferrer\">https://raw.githubusercontent.com/tblyler/go-mcrypt/master/mcrypt.go</a></p>\n</blockquote>\n<p><em>or copy it from your own src/github.com/tblyler/go-mcrypt to project mcrypt folder</em></p>\n<p>now edit mcrypt.go and add the C flags:</p>\n<pre class=\"lang-go-lang prettyprint-override\"><code>package mcrypt\n\n/*\n#cgo LDFLAGS: -L/opt/local/lib -lmcrypt\n#cgo CFLAGS: -I/opt/local/include\n#include &lt;stdlib.h&gt;\n...\n</code></pre>\n<p>modify import from above example to import mcrypt version locally, and run it...</p>\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n  &quot;fmt&quot;\n//&quot;github.com/tblyler/go-mcrypt&quot;\n  &quot;./mcrypt&quot;\n  &quot;encoding/base64&quot;\n)\n</code></pre>\n<p>when running the code it adds a warning about linking</p>\n<pre><code>ld: warning: building for macOS, but linking in object file (/var/folders/xz/7ng416ds5611ypt12c96g1_40000gn/T/go-link-754294955/go.o) built for\nKey Len: 32\nIV  Len: 32\nAbra Cadabra\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11751847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac54198bfc3738ee115fbf69663f02e0?s=128&d=identicon&r=PG&f=1", "display_name": "Daci", "link": "https://stackoverflow.com/users/11751847/daci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562598463, "creation_date": 1562541133, "question_id": 56926812, "link": "https://stackoverflow.com/questions/56926812/decrypt-aes-cbc-256-mcrypt-rijndael-encrypted-in-php-decrypt-on-golang", "title": "Decrypt AES-CBC-256 Mcrypt_RIJNDAEL encrypted in PHP decrypt on GOLang", "body": "<p>I try to rewrite some old code made in php5.6 (CodeIgniter) in go, but I'm banging my head with decryption on go. I managed to decode MCRYPT_RIJNDAEL_128 from php to go, where the iv size is 16 characters, but I can't do it on 256 - iv is 32. I don't want to use go_mcrypt because that's strict on libcrypt headers, so I tried using go classic encrypt libs AES cipher with CBC mode, but on 256 it complains about IV length... The php IV has 32 characters not 16 as expected.. </p>\n\n<p>The php part works well...</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>private $CIPHER_KEY = \"12345678901234567890123456789012\";\n\n    private function Encrypt($toEncrypt=null){\n        $iv_size = $this-&gt;ivSize = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC);\n        $iv = $this-&gt;ivKey = mcrypt_create_iv($iv_size, MCRYPT_RAND);\n        $this-&gt;B64IV = base64_encode($iv);\n        return base64_encode($iv . mcrypt_encrypt(MCRYPT_RIJNDAEL_256, $this-&gt;CIPHER_KEY, $toEncrypt, MCRYPT_MODE_CBC, $iv));\n    }\n</code></pre>\n\n<p>this is the PHP result:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>KEY: 12345678901234567890123456789012\nIV: Egu4tSySXluBLi5dcMzHbZHVSOS7jdNwUKUFlZ8dL1w=\nENC: Egu4tSySXluBLi5dcMzHbZHVSOS7jdNwUKUFlZ8dL1yATFjg26/Nav7cWtlJJL3djhUCND6KV8r/JL7owboKFA==\nIV Size: 32\n</code></pre>\n\n<p>IV is included in the encrypted text... (and has 32 chars)</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC); return 32\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n   key := []byte(\"12345678901234567890123456789012\")\n\n   iv,_ := base64.StdEncoding.DecodeString(\"Egu4tSySXluBLi5dcMzHbZHVSOS7jdNwUKUFlZ8dL1w=\")\n   encText,_  := base64.StdEncoding.DecodeString(\"Egu4tSySXluBLi5dcMzHbZHVSOS7jdNwUKUFlZ8dL1yATFjg26/Nav7cWtlJJL3djhUCND6KV8r/JL7owboKFA==\")\n//   iv := encText[:32] // also tried to get the iv from encoded string\n\n\n   fmt.Printf(\"Key Len: %d\\nIV  Len: %d\\nENC Len: %d\\n\",len(key),len(iv),len(encText))\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    if len(encText) &lt; aes.BlockSize {\n        panic(\"cipherText too short\")\n    }\n\n    cipherText := encText[32:]\n    if len(cipherText)%aes.BlockSize != 0 {\n        panic(\"cipherText is not a multiple of the block size\")\n    }\n\n    mode := cipher.NewCBCDecrypter(block, iv)\n    mode.CryptBlocks(cipherText, cipherText)\n\n    cipherText, _ = pkcs7.Unpad(cipherText, aes.BlockSize)\n\n   fmt.Printf(\"Dec: %s\\n\",cipherText)\n\n}\n</code></pre>\n\n<p>Key Len: 32\nIV  Len: 32\nENC Len: 64\npanic: cipher.NewCBCDecrypter: IV length must equal block size</p>\n\n<p>goroutine 1 [running]:\ncrypto/cipher.NewCBCDecrypter(0x10e7c20, 0xc00009a030, 0xc00008a000, 0x20, 0x42, 0x0, 0x0)</p>\n\n<p>IV size is 32 but the block size is 16.</p>\n"}, {"tags": ["go", "struct", "slice", "variadic"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1562519230, "post_id": 56923866, "comment_id": 100390601, "body": "@krijn-van-der-burg, note that one of the design goals of Go is to have (almost) no magic. If you&#39;ll think about your proposed idea a bit harder, you&#39;ll notice that to achieve what you imagine the Go compiler would have allocate a memory for a special slice the length of <code>len(items)*sizeof(int)</code>, fill it up with the IDs and then pass to the function; and that price whould have been paid on each call to that function. Now imagine you have 1bn items in your slice. So no, Go forces you to not hide such things behind innocently-looking expressions."}, {"owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "edited": false, "score": 0, "creation_date": 1562519512, "post_id": 56923866, "comment_id": 100390656, "body": "Didnt know / think about that Kostix, thanks for the addition. Makes me feel better about applying &quot;yet another loop&quot; as its inevitable in my case."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1562516511, "last_edit_date": 1562516511, "creation_date": 1562515569, "answer_id": 56923866, "question_id": 56923791, "link": "https://stackoverflow.com/questions/56923791/slice-of-a-structs-field-to-variadic/56923866#56923866", "title": "Slice of a struct&#39;s field to variadic", "body": "<p>You have to create a new slice for the IDs, and use a loop to populate it. There is no shortcut.</p>\n\n<p>For example:</p>\n\n<pre><code>ids := make([]int, len(items))\nfor i, item := range items {\n    ids[i] = item.ItemId\n}\nItemIds(\"en\", ids...)\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/V2aN55hHBj8\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 398, "user_id": 2936329, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/31Ke7.jpg?s=128&g=1", "display_name": "Rien", "link": "https://stackoverflow.com/users/2936329/rien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 56923866, "answer_count": 1, "score": 1, "last_activity_date": 1562516511, "creation_date": 1562515032, "last_edit_date": 1562515514, "question_id": 56923791, "link": "https://stackoverflow.com/questions/56923791/slice-of-a-structs-field-to-variadic", "title": "Slice of a struct&#39;s field to variadic", "body": "<p>My application has a slice of a struct like so</p>\n\n<pre><code>type ItemOrder struct {\n    ItemId\n    ...\n}\n\nvar items = []*ItemOrder\n</code></pre>\n\n<p>And a variadic function accepting <code>...int</code></p>\n\n<pre><code>func ItemIds(lang string, ids ...int){\n...\n</code></pre>\n\n<p>How can I take all itemIds from the <code>items []*ItemOrder</code> slice and supply it to the variadic function? Something like</p>\n\n<pre><code>itemsPB, err := ItemIds(\"\", items[:].itemId)\n</code></pre>\n\n<p>Abov doesnt work because im not giving  the slice a position to extract itemId from.</p>\n"}, {"tags": ["html", "loops", "templates", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1562514450, "post_id": 56923511, "comment_id": 100389445, "body": "You should first aggregate your data into a slice, then, in the template you can use the <code>range</code> action to loop over that slice and render individual rows. Currently you&#39;re rendering each row individually in a separate <code>index.html</code> file, that&#39;s just wrong. Also you should include the template code in the question and not link to it outside SO."}, {"owner": {"reputation": 2763, "user_id": 10312071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k1D2u.jpg?s=128&g=1", "display_name": "Kate Orlova", "link": "https://stackoverflow.com/users/10312071/kate-orlova"}, "edited": false, "score": 0, "creation_date": 1562520907, "post_id": 56923511, "comment_id": 100391007, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19991124/go-template-html-iteration-to-generate-table-from-struct\">Go template/html iteration to generate table from struct</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2859, "user_id": 6225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqBej.jpg?s=128&g=1", "display_name": "Shalauddin Ahamad Shuza", "link": "https://stackoverflow.com/users/6225565/shalauddin-ahamad-shuza"}, "reply_to_user": {"reputation": 41, "user_id": 11171720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-st4ZkxmMJ0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retm4sDJbfueXEVV-wwPkyBUXrPRg/mo/photo.jpg?sz=128", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u0412\u043b\u0430\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/11171720/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%92%d0%bb%d0%b0%d1%81%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1562614157, "post_id": 56924763, "comment_id": 100422907, "body": "@\u0421\u0435\u0440\u0433\u0435\u0439\u0412\u043b\u0430\u0441\u043e\u0432 check the html file also."}, {"owner": {"reputation": 2859, "user_id": 6225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqBej.jpg?s=128&g=1", "display_name": "Shalauddin Ahamad Shuza", "link": "https://stackoverflow.com/users/6225565/shalauddin-ahamad-shuza"}, "reply_to_user": {"reputation": 41, "user_id": 11171720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-st4ZkxmMJ0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retm4sDJbfueXEVV-wwPkyBUXrPRg/mo/photo.jpg?sz=128", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u0412\u043b\u0430\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/11171720/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%92%d0%bb%d0%b0%d1%81%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1562689880, "post_id": 56924763, "comment_id": 100452356, "body": "Accept the answer it will help others."}], "tags": [], "owner": {"reputation": 2859, "user_id": 6225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqBej.jpg?s=128&g=1", "display_name": "Shalauddin Ahamad Shuza", "link": "https://stackoverflow.com/users/6225565/shalauddin-ahamad-shuza"}, "is_accepted": false, "score": 4, "last_activity_date": 1562614045, "last_edit_date": 1562614045, "creation_date": 1562522501, "answer_id": 56924763, "question_id": 56923511, "link": "https://stackoverflow.com/questions/56923511/go-html-template-table/56924763#56924763", "title": "go html template table", "body": "<p>Because you are executing template inside <code>for loop</code>. Also you can pass a single <code>struct</code>. To pass array you have to pass it as a member of the struct.</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"net/http\"\n)\n\ntype Data struct {\n    Items []Devicevalue_view\n}\n\ntype Devicevalue_view struct {\n    Devicetype string\n    Iddevice   string\n    Devicename string\n    Oidname    string\n    Value      string\n}\n\nfunc page_1(w http.ResponseWriter, r *http.Request) {\n    data := Data{}\n    for i := 1; i &lt; 10; i++ {\n        view := Devicevalue_view{\n            Devicetype: \"devicetype\",\n            Iddevice:   \"iddevice\",\n            Devicename: \"devicename\",\n            Oidname:    \"oidname\",\n            Value:      \"value\",\n        }\n\n        data.Items = append(data.Items, view)\n    }\n\n    tmpl, _ := template.ParseFiles(\"./index.html\")\n    tmpl.Execute(w, data)\n}\nfunc main() {\n    http.HandleFunc(\"/table\", page_1)\n    http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n\n<p>Also you have to iterate through data and generate row dynamically.</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;body&gt;\n&lt;table&gt;\n    &lt;tr&gt;\n        &lt;th&gt;Type&lt;/th&gt;\n        &lt;th&gt;Name&lt;/th&gt;\n        &lt;th&gt;Param&lt;/th&gt;\n        &lt;th&gt;Time&lt;/th&gt;\n        &lt;th&gt;Value&lt;/th&gt;\n    &lt;/tr&gt;\n    {{ range .Items}}\n        &lt;tr&gt;\n            &lt;td&gt;{{ .Devicetype }}&lt;/td&gt;\n            &lt;td&gt;{{ .Iddevice }}&lt;/td&gt;\n            &lt;td&gt;{{ .Devicename }}&lt;/td&gt;\n            &lt;td&gt;{{ .Oidname }}&lt;/td&gt;\n            &lt;td&gt;{{ .Value }}&lt;/td&gt;\n        &lt;/tr&gt;\n    {{ end}}\n&lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11171720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-st4ZkxmMJ0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retm4sDJbfueXEVV-wwPkyBUXrPRg/mo/photo.jpg?sz=128", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u0412\u043b\u0430\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/11171720/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%92%d0%bb%d0%b0%d1%81%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562614045, "creation_date": 1562513051, "last_edit_date": 1562513782, "question_id": 56923511, "link": "https://stackoverflow.com/questions/56923511/go-html-template-table", "title": "go html template table", "body": "<p>I want to make the table in HTML in go package \"temlate\" and i want to add rows in loop, but i didn't find how doing this</p>\n\n<p>my code:</p>\n\n<pre><code>package main\nimport (\n     \"net/http\"\n     \"html/template\"\n)\ntype Devicevalue_view struct {\n    Devicetype string\n    Iddevice   string\n    Devicename string\n    Oidname    string\n    Value      string\n  }\nfunc page_1(w http.ResponseWriter, r *http.Request){\n    for i:=1; i&lt;10; i++{    \n        data := Devicevalue_view{\n            Devicetype: \"devicetype\",\n            Iddevice: \"iddevice\",\n            Devicename: \"devicename\",\n            Oidname: \"oidname\",\n            Value: \"value\",\n        }   \n        tmpl, _ := template.ParseFiles(\"./index.html\")\n        tmpl.Execute(w, data)\n    }   \n}\nfunc main() {\n    http.HandleFunc(\"/table\", page_1) \n    http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n\n<p>i'm getting this :</p>\n\n<pre><code>\nDevices\nType    Name    Param   Time    Value\ndevicetype  iddevice    devicename  oidname value\nDevices\nType    Name    Param   Time    Value\ndevicetype  iddevice    devicename  oidname value\n...\n</code></pre>\n\n<p>but i want somthing like this</p>\n\n<pre><code>Devices\nType    Name    Param   Time    Value\ndevicetype  iddevice    devicename  oidname value\ndevicetype  iddevice    devicename  oidname value\n...\n</code></pre>\n\n<p>I don't undestand how connect all cells in one table</p>\n\n<p>index.html:\n<a href=\"https://drive.google.com/file/d/1HzEL0i3VhiafPzlV8iC0kU8WaSQwoYZY/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1HzEL0i3VhiafPzlV8iC0kU8WaSQwoYZY/view?usp=sharing</a></p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 3, "creation_date": 1562504447, "post_id": 56922298, "comment_id": 100387090, "body": "One cannot pass an array without defining size. For such cases one needs to use slices.Use of arrays is very limited in GoLang."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1562507590, "post_id": 56922298, "comment_id": 100387788, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46809499/why-cant-you-put-a-variable-as-a-multidimensional-array-size-in-go/46809576?r=SearchResults#46809576\">Why can&#39;t you put a variable as a multidimensional array size in Go?</a>"}, {"owner": {"reputation": 891, "user_id": 2761837, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000191017794/picture?type=large", "display_name": "Anton Ohorodnyk", "link": "https://stackoverflow.com/users/2761837/anton-ohorodnyk"}, "edited": false, "score": 0, "creation_date": 1562530820, "post_id": 56922298, "comment_id": 100393340, "body": "Do you want something like that? <a href=\"https://play.golang.org/p/Tko8AP36ukH\" rel=\"nofollow noreferrer\">play.golang.org/p/Tko8AP36ukH</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 3, "last_activity_date": 1562508393, "last_edit_date": 1562508393, "creation_date": 1562504932, "answer_id": 56922435, "question_id": 56922298, "link": "https://stackoverflow.com/questions/56922298/how-to-pass-array-to-a-go-function-without-define-the-size-of-the-array/56922435#56922435", "title": "How to pass array to a GO function without define the size of the array?", "body": "<p>You can convert the array to a slice inline, like so:</p>\n\n<pre><code>f(a[:],5)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/skm4DsDwR9I\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>For more background see: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-slices-usage-and-internals</a></p>\n"}], "owner": {"reputation": 93, "user_id": 10556246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8G9IARupjpc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAZoPxDy3wy-ggvIpLG68uMh5sMaQ/mo/photo.jpg?sz=128", "display_name": "zening.chen", "link": "https://stackoverflow.com/users/10556246/zening-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 56922435, "answer_count": 1, "score": 0, "last_activity_date": 1562508393, "creation_date": 1562503730, "question_id": 56922298, "link": "https://stackoverflow.com/questions/56922298/how-to-pass-array-to-a-go-function-without-define-the-size-of-the-array", "title": "How to pass array to a GO function without define the size of the array?", "body": "<p>I try to defined an array pass it to the function that doesn't define the size of the argument, errors occur however. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var a=[5]int{1,2,3,4,5}\n    f(a,5)\n    fmt.Println(a)\n}\nfunc f(arr []int,size int) {\n    for i,x:=range arr  {\n        fmt.Println(i,x)\n        arr[i]=100\n    }\n}\n</code></pre>\n\n<p>cannot use a (type [5]int) as type []int in argument to f</p>\n"}, {"tags": ["go", "yaml", "go-templates"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1562502741, "post_id": 56921759, "comment_id": 100386692, "body": "Use two ranges, have the first one render only the requesting city and the second one render all the other ones. Alternatively sort your slice outside the template."}], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 1907802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5793082c513ee9190269f2beaefe94be?s=128&d=identicon&r=PG", "display_name": "Ace", "link": "https://stackoverflow.com/users/1907802/ace"}, "edited": false, "score": 1, "creation_date": 1562597053, "post_id": 56922378, "comment_id": 100414984, "body": "this is what i did, made a secondary struct, unwrapped my data into the struct, then used it to populate the template."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 4, "last_activity_date": 1562504401, "creation_date": 1562504401, "answer_id": 56922378, "question_id": 56921759, "link": "https://stackoverflow.com/questions/56921759/golang-format-text-template-based-on-variable/56922378#56922378", "title": "Golang Format Text Template based on variable", "body": "<p>One simple solution would be to pass a different data object to <code>Template.Execute</code>.  Something like:</p>\n\n<pre><code>type templateData struct {\n    requestingCityName string\n    cities             []citiesStruct // or whatever you name the struct\n}\n...\nfmt.Println(t.Execute(os.Stdout, templateData{requestingCityName, x}))\n</code></pre>\n\n<p>This solution would require you to update your template to work with the new context struct (i.e. that the old cities array is now <code>.cities</code> rather than <code>.</code>), but it gives you access to <code>.requestingCityName</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "is_accepted": false, "score": 1, "last_activity_date": 1562510264, "last_edit_date": 1562510264, "creation_date": 1562509874, "answer_id": 56923042, "question_id": 56921759, "link": "https://stackoverflow.com/questions/56921759/golang-format-text-template-based-on-variable/56923042#56923042", "title": "Golang Format Text Template based on variable", "body": "<p>You can do the if-condition inside the template with <code>eq</code>, see <a href=\"https://stackoverflow.com/questions/31101729/compare-strings-in-templates\">Compare strings in templates</a>. To negate an if you can write <code>if not &lt;a&gt; eq &lt;b&gt;</code>.</p>\n\n<p>I assumed you don't care about order. If you care you can sort it beforehand so at the top is the requested city and everything else below. Else you have to split the request-city-printing up and output outside of the range the requested, then filter out the requested once you range over all cities.</p>\n\n<p>The most clean is probably to go with a separate attribute inside the data struct where the requesting city is held and filter that one out of cities beforehand.</p>\n\n<p>Oh and if you haven't added the requested city to the data struct, then do that beforehand. It's probably easiest to separate by embedding the yaml data struct by embedding it inside a struct named <code>DataRendering</code> which also has the requested city attribute.</p>\n"}], "owner": {"reputation": 413, "user_id": 1907802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5793082c513ee9190269f2beaefe94be?s=128&d=identicon&r=PG", "display_name": "Ace", "link": "https://stackoverflow.com/users/1907802/ace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 56922378, "answer_count": 2, "score": 3, "last_activity_date": 1562575159, "creation_date": 1562499079, "last_edit_date": 1562575159, "question_id": 56921759, "link": "https://stackoverflow.com/questions/56921759/golang-format-text-template-based-on-variable", "title": "Golang Format Text Template based on variable", "body": "<p>I am trying to use <code>text/template</code> to generate ini-like configurations on the fly, where the original data is provided in yaml format.</p>\n\n<p>I want the resulting output to be different depending on where the request is coming from.</p>\n\n<p>Please consider the following broken code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/yaml.v3\"\n    \"os\"\n    \"text/template\"\n)\n\nvar yamlData = `\n# comment\n---\nStates:\n- StateName: California\n  DateEstablished: September 9, 1850\n  Cities:\n  - CityName: Los Angeles\n    Population: 4 Million\n  - CityName: Santa Barbara\n    Population: 92 Thousand\n  - CityName: San Jose\n    Population: 1 Million\n- StateName: Washington\n  DateEstablished: November 11, 1889\n  Cities:\n  - CityName: Seattle\n    Population: 724 Thousand\n    Climate: wet\n  - CityName: Spokane\n    Population: 217 Thousand\n    Climate: dry\n  - CityName: Scappoose\n    Population: 7\n`\n\nconst reportTemplate string = `{{ range . }}\n# {{ if .CityName == requestingCityName }}\n# {{ .CityName }}\n[RequestingCity]\nPopulation = {{ .Population }}\n{{ if .Climate }}Climate = {{ .Climate }}{{ end }}\n{{ end }}\n# {{ if .CityName != requestingCityName }}\n# {{ .CityName }}\n[City]\nPopulation = {{ .Population }}\n{{ if .Climate }}Climate = {{ .Climate }}{{ end }}\n{{ end }}\n{{ end }}\n`\n\ntype dataStruct struct {\n    States []struct {\n        StateName       string `yaml:\"StateName\"`\n        DateEstablished string `yaml:\"DateEstablished\"`\n        Cities          []struct {\n            CityName   string `yaml:\"CityName\"`\n            Population string `yaml:\"Population\"`\n            Climate    string `yaml:\"Climate,omitempty\"`\n        } `yaml:\"Cities\"`\n    } `yaml:\"States\"`\n}\n\nfunc (d *dataStruct) readData(data []byte) *dataStruct {\n    yaml.Unmarshal(data, d)\n    return d\n}\n\nfunc main() {\n\n    var report dataStruct\n    report.readData([]byte(yamlData))\n    t := template.Must(template.New(\"new\").Parse(reportTemplate))\n\n    requestingStateName := \"Washington\"\n    requestingCityName := \"Seattle\"\n\n    for i := range report.States {\n        if report.States[i].StateName == requestingStateName {\n            x := report.States[i].Cities\n            fmt.Println(t.Execute(os.Stdout, x))\n\n        }\n    }\n}\n\n</code></pre>\n\n<p>Most of this code \"works\" the way i would expect it to, but the part i am having problems with is how to make the template.</p>\n\n<p>I want to be able to change the value for <code>requestingCityName</code> so that the output will change like so:</p>\n\n<p>if <code>requestingCityName</code> == <code>\"Scappoose\"</code>\nthen the output would be like so:</p>\n\n<pre><code>\n# Scappoose\n[RequestingCity]\nPopulation = 7\n\n# Spokane\n[City]\nPopulation = 217 Thousand\nClimate = dry\n\n# Seattle\n[City]\nPopulation = 724 Thousand\nClimate = wet\n\n</code></pre>\n\n<p>or if <code>requestingCityName</code> == <code>\"Seattle\"</code>\nthen the output would be like so:</p>\n\n<pre><code>\n# Seattle\n[RequestingCity]\nPopulation = 724 Thousand\nClimate = wet\n\n# Spokane\n[City]\nPopulation = 217 Thousand\nClimate = dry\n\n# Scappoose\n[City]\nPopulation = 7\n\n</code></pre>\n\n<p>How would make the template so that I can achieve the desired behaviour?</p>\n"}, {"tags": ["go", "continuous-integration"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562533601, "post_id": 56920983, "comment_id": 100393848, "body": "Which project? What was the purpose of doing it there?"}, {"owner": {"reputation": 33, "user_id": 8278332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a462d40f229c4be267e6ed4005137a3?s=128&d=identicon&r=PG&f=1", "display_name": "Real Mind", "link": "https://stackoverflow.com/users/8278332/real-mind"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562564900, "post_id": 56920983, "comment_id": 100398991, "body": "it&#39;s a private project, the purpose is what i am confused about"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562579321, "post_id": 56920983, "comment_id": 100405271, "body": "You&#39;ll have to look at the context. What happens before and after that command? Is it creating a new commit? Is it generating an error if something changed?"}], "answers": [{"tags": [], "owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "is_accepted": true, "score": 2, "last_activity_date": 1562494353, "creation_date": 1562494353, "answer_id": 56921200, "question_id": 56920983, "link": "https://stackoverflow.com/questions/56920983/does-it-make-sense-to-gofmt-project-inside-a-ci-file/56921200#56921200", "title": "Does it make sense to gofmt project inside a CI file", "body": "<p>Depends on what the goal is. It may be totally sane to do if a later linter checks whether code is in the proper <code>gofmt</code> format and</p>\n\n<ul>\n<li>they know some forget that and they want to ignore that case for a better experience.</li>\n<li>some generated code is not formatted but also not checked in and so must be gofmt'ed to avoid linter complaints.</li>\n</ul>\n\n<p>Or it just copied over from somewhere else and no one cared to remove it.</p>\n"}], "owner": {"reputation": 33, "user_id": 8278332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a462d40f229c4be267e6ed4005137a3?s=128&d=identicon&r=PG&f=1", "display_name": "Real Mind", "link": "https://stackoverflow.com/users/8278332/real-mind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 56921200, "answer_count": 1, "score": 0, "last_activity_date": 1562494353, "creation_date": 1562492385, "question_id": 56920983, "link": "https://stackoverflow.com/questions/56920983/does-it-make-sense-to-gofmt-project-inside-a-ci-file", "title": "Does it make sense to gofmt project inside a CI file", "body": "<p>I came across a project which has this line in its gitlab-ci.yml<br>\n<code>go fmt $(go list ./... | grep -v /vendor/)</code> \nwhich is followed by a go test and then a go build.<br>\nThe problem is by this point the code is already committed so there is no point in doing a gofmt or am i missing something here.</p>\n"}, {"tags": ["go", "kubernetes", "client-go"], "comments": [{"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 0, "creation_date": 1562575490, "post_id": 56919318, "comment_id": 100403319, "body": "Are you running same code from multiple processes? you got the latest deployment just before updating the version. It&#39;s very unlikely that the deployment is got updated within this fraction of moment. I tried the function. This works fine for me."}, {"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 0, "creation_date": 1562575561, "post_id": 56919318, "comment_id": 100403352, "body": "The error is happening because the object got modified in between GETTER and update time period."}, {"owner": {"reputation": 95, "user_id": 5235551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb3b0ee835d5e0ee10eaf0d3f9bfe858?s=128&d=identicon&r=PG&f=1", "display_name": "Toni.W", "link": "https://stackoverflow.com/users/5235551/toni-w"}, "reply_to_user": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 0, "creation_date": 1562900822, "post_id": 56919318, "comment_id": 100532697, "body": "@MarufTuhin Thanks for your reply, I have solved the problem. the reason is that the err of conflict is hided by &quot;updatedDeployWithTolera, err := client.AppsV1().Deployments(ns).Update(updateDeploy)     if err != nil || updatedDeployWithTolera == nil {         return deploy, fmt.Errorf(&quot;failed to update deploy %v after adding toleration: %v&quot;, deploy.Name, err)}&quot;."}, {"owner": {"reputation": 95, "user_id": 5235551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb3b0ee835d5e0ee10eaf0d3f9bfe858?s=128&d=identicon&r=PG&f=1", "display_name": "Toni.W", "link": "https://stackoverflow.com/users/5235551/toni-w"}, "reply_to_user": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 0, "creation_date": 1562901245, "post_id": 56919318, "comment_id": 100532771, "body": "So the function of retry.RetryOnConflict doesn&#39;t work."}, {"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 0, "creation_date": 1563309767, "post_id": 56919318, "comment_id": 100655375, "body": "glad that you found the problem. Go ahead and add the solution here in answer box and accept that answer. :)"}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 5235551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb3b0ee835d5e0ee10eaf0d3f9bfe858?s=128&d=identicon&r=PG&f=1", "display_name": "Toni.W", "link": "https://stackoverflow.com/users/5235551/toni-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1563685319, "creation_date": 1563685319, "answer_id": 57130473, "question_id": 56919318, "link": "https://stackoverflow.com/questions/56919318/i-occasionally-get-such-an-error-the-object-has-been-modified-when-i-update-no/57130473#57130473", "title": "I occasionally get such an error &quot;the object has been modified&quot; when I update node or deploy with client-go", "body": "<p>I have solved the problem. the reason is that the err of conflict is hided by</p>\n\n<pre><code>updatedDeployWithTolera, err := client.AppsV1().Deployments(ns).Update(updateDeploy) if err != nil || updatedDeployWithTolera == nil { return deploy, fmt.Errorf(\"failed to update deploy %v after adding toleration: %v\", deploy.Name, err)}\n</code></pre>\n\n<p>,So the function of retry.RetryOnConflict doesn't work.</p>\n"}], "owner": {"reputation": 95, "user_id": 5235551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb3b0ee835d5e0ee10eaf0d3f9bfe858?s=128&d=identicon&r=PG&f=1", "display_name": "Toni.W", "link": "https://stackoverflow.com/users/5235551/toni-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1500, "favorite_count": 2, "accepted_answer_id": 57130473, "answer_count": 1, "score": 1, "last_activity_date": 1563685319, "creation_date": 1562473229, "question_id": 56919318, "link": "https://stackoverflow.com/questions/56919318/i-occasionally-get-such-an-error-the-object-has-been-modified-when-i-update-no", "title": "I occasionally get such an error &quot;the object has been modified&quot; when I update node or deploy with client-go", "body": "<p>I occasionally get such an error \"the object has been modified; please apply your changes to the latest version and try again\" when I update node or deploy with client-go.My goal is that adding a taint/toleration and a label to one node/deployment.</p>\n\n<p>some people said should use</p>\n\n<pre><code>err = retry.RetryOnConflict(retry.DefaultBackoff, func() error {})\n</code></pre>\n\n<p>,but it seems that does not work.</p>\n\n<pre><code>func AddFaultToleration(deploy *appsv1.Deployment, ns string, client kubernetes.Interface) (*appsv1.Deployment, error) {\n\n    updateDeploy, err := client.AppsV1().Deployments(ns).Get(deploy.Name, metav1.GetOptions{})\n    if updateDeploy == nil || err != nil {\n        return deploy, fmt.Errorf(\"Failed to get latest version of Deployment: %v\", err)\n    }\n\n    effect := apiv1.TaintEffectNoExecute\n    updateDeploy.Spec.Template.Spec.Tolerations = append(updateDeploy.Spec.Template.Spec.Tolerations, apiv1.Toleration{\n        Key:      ToBeFaultTaintKey,\n        Value:    ToBeFaultTaintValue,\n        Effect:   effect,\n        Operator: apiv1.TolerationOpEqual,\n    })\n\n    updatedDeployWithTolera, err := client.AppsV1().Deployments(ns).Update(updateDeploy)\n    if err != nil || updatedDeployWithTolera == nil {\n        return deploy, fmt.Errorf(\"failed to update deploy %v after adding toleration: %v\", deploy.Name, err)\n    }\n\n    log.Info(\"Successfully added toleration on pod:\", updatedDeployWithTolera.Name)\n    return updatedDeployWithTolera, nil\n}\n\n</code></pre>\n"}, {"tags": ["go", "gorilla", "mux"], "comments": [{"owner": {"reputation": 2859, "user_id": 6225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqBej.jpg?s=128&g=1", "display_name": "Shalauddin Ahamad Shuza", "link": "https://stackoverflow.com/users/6225565/shalauddin-ahamad-shuza"}, "edited": false, "score": 1, "creation_date": 1562522941, "post_id": 56919055, "comment_id": 100391520, "body": "share full code"}, {"owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "edited": false, "score": 0, "creation_date": 1562578952, "post_id": 56919055, "comment_id": 100405088, "body": "There is yes, create a new <code>http.Server</code>."}], "owner": {"reputation": 339, "user_id": 4158062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f10ce8266ac660f74455aee351c634?s=128&d=identicon&r=PG&f=1", "display_name": "Bhupinder Singh Narang", "link": "https://stackoverflow.com/users/4158062/bhupinder-singh-narang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562468622, "creation_date": 1562468622, "question_id": 56919055, "link": "https://stackoverflow.com/questions/56919055/gorilla-mux-reuse-restart-server-after-a-shutdown", "title": "Gorilla mux reuse/restart server after a shutdown", "body": "<p>I am setting up an http server in a separate goroutine. This goroutine will set up a new server on a signal. However, after a shutdown request, I cannot restart that, Here is the code</p>\n\n<pre><code>for {\n       select {\n       case &lt;-m.start:\n           fmt.Println(\"Start the server now\")\n\n           go func() {\n               err := m.ListenAndServe()\n               if err != nil {\n                   fmt.Println(err)\n               }\n           }()\n       case &lt;-m.stop:\n           fmt.Println(\"Stop the server now\")\n           go func() {\n\n               ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\n               err := m.Shutdown(ctx)\n               fmt.Println(\"Error is :\", err)\n               if err != nil {\n                   fmt.Println(err)\n               }\n               cancel()\n           }()\n       }\n   }\n</code></pre>\n\n<p>I am controlling this goroutine through separate handlers externally. In the documentation, it is mentioned that the server may not be reused after a shutdown. Is there any alternative?</p>\n"}, {"tags": ["reactjs", "go", "kubernetes", "dns"], "comments": [{"owner": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "edited": false, "score": 0, "creation_date": 1562469043, "post_id": 56918987, "comment_id": 100380766, "body": "Share your service yamls"}, {"owner": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "edited": false, "score": 0, "creation_date": 1562469069, "post_id": 56918987, "comment_id": 100380769, "body": "You should be able to access the service by their name. This is taken care by kunernetes dns"}, {"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "reply_to_user": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "edited": false, "score": 0, "creation_date": 1562469409, "post_id": 56918987, "comment_id": 100380817, "body": "I added those to the question. I have tried with the service name and it doesn&#39;t work."}, {"owner": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "edited": false, "score": 0, "creation_date": 1562470136, "post_id": 56918987, "comment_id": 100380907, "body": "Aren&#39;t you supposed to use the container port in the target port fields in services?"}, {"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "reply_to_user": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "edited": false, "score": 0, "creation_date": 1562470856, "post_id": 56918987, "comment_id": 100381000, "body": "I added that and still nothing. I have base API endpoint for the Go server as <code>api.client:8001</code> in the React app. It is failing with the error: <code>ERR_NAME_NOT_RESOLVED</code>."}, {"owner": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "edited": false, "score": 0, "creation_date": 1562471733, "post_id": 56918987, "comment_id": 100381111, "body": "Share your deployment yamls as well"}, {"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "reply_to_user": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "edited": false, "score": 0, "creation_date": 1562472967, "post_id": 56918987, "comment_id": 100381260, "body": "Added deployment yamls."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562490291, "post_id": 56918987, "comment_id": 100383980, "body": "Unless your client is in the same domain as your cluster AND the domain as a whole was delegated to the DNS of your cluster, ofc the short name will not be resolved properly. As a side note: More often than not, running nginx as a reverse proxy inside a docker container holds no additional value when compared to an <a href=\"https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/\" rel=\"nofollow noreferrer\">ingress controller</a>."}], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562490397, "post_id": 56919431, "comment_id": 100384008, "body": "Thise two yamls are identical"}, {"owner": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562491577, "post_id": 56919431, "comment_id": 100384252, "body": "My bad, was pasting the deployment yamls, edited answer with service yamls. Thanks"}], "tags": [], "owner": {"reputation": 1429, "user_id": 1237402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3706ad62b82b6482f64ab6139b0ab6d6?s=128&d=identicon&r=PG", "display_name": "Malathi", "link": "https://stackoverflow.com/users/1237402/malathi"}, "is_accepted": false, "score": 0, "last_activity_date": 1562491545, "last_edit_date": 1562491545, "creation_date": 1562475114, "answer_id": 56919431, "question_id": 56918987, "link": "https://stackoverflow.com/questions/56918987/react-app-communicating-with-go-backend-api/56919431#56919431", "title": "React App communicating with Go backend api", "body": "<p>There are many issues with the yamls. First, in service yamls, the targetPort should be port numbers(integers) and not string. So, the updated config will be,</p>\n\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: ui\n  namespace: client\n  labels:\n    app: ui\nspec:\n  type: NodePort\n  ports:\n    - name: http\n      port: 80\n      targetPort: 80\n    - name: https\n      port: 443\n      targetPort: 443\n  selector:\n    app: ui\n</code></pre>\n\n<p>and </p>\n\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: api\n  namespace: client\n  labels:\n    app: api\nspec:\n  type: NodePort\n  ports:\n    - port: 8001\n      protocol: TCP\n      targetPort: 8001\n      name: http\n  selector:\n    app: api\n</code></pre>\n\n<p>After changing the targetPort in service yamls, I created a pod to do nslookup and it works as expected.</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>kubectl apply -f https://k8s.io/examples/admin/dns/busybox.yaml\nkubectl exec -ti busybox -- nslookup api.client\n</code></pre>\n\n<p>produces the output</p>\n\n<pre><code>Defaulting container name to busybox.\nUse 'kubectl describe pod/busybox -n default' to see all of the containers in this pod.\nServer:    10.96.0.10\nAddress 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      api.client\nAddress 1: 10.101.84.21 api.client.svc.cluster.local\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "edited": false, "score": 0, "creation_date": 1562512240, "post_id": 56921550, "comment_id": 100388896, "body": "What would the <code>...</code> be inside <code>https:&#47;&#47;...&#47;api</code>? I guess it&#39;s the external ip of the service resource, but does one have to change the external DNS record every time one redeploys the service then?"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "reply_to_user": {"reputation": 3851, "user_id": 6266540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0455a60b54cc79b3f8935832f4ca76c?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6266540/fabian"}, "edited": false, "score": 0, "creation_date": 1562518329, "post_id": 56921550, "comment_id": 100390395, "body": "Usually you have some sort of DNS service that can point at your combined system, so that host name.  Kubernetes in general doesn&#39;t change things that don&#39;t need to be changed, so even if you <code>kubectl apply</code> your Service object again, the external host name or load balancer address usually won&#39;t change."}, {"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "edited": false, "score": 0, "creation_date": 1562539044, "post_id": 56921550, "comment_id": 100394803, "body": "This is what I ended up doing after realizing the React app isn&#39;t running inside Kubernetes. I added an api.* subdomain to the ingress that redirects to the back end service."}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 5, "last_activity_date": 1562497152, "creation_date": 1562497152, "answer_id": 56921550, "question_id": 56918987, "link": "https://stackoverflow.com/questions/56918987/react-app-communicating-with-go-backend-api/56921550#56921550", "title": "React App communicating with Go backend api", "body": "<p><strong>The React application does not run in Kubernetes.</strong>  Maybe you have a dev server running in Kubernetes, but it just serves up HTML and Javascript files to a browser running outside the cluster.  The application in the browser has no idea about this \"Kubernetes\" thing and can't resolve the Kubernetes-internal <code>...svc.cluster.local</code> hostnames; it needs a way to talk back to the cluster.</p>\n\n<p>Since you have the backend configured as a NodePort type service, you can look up the backend's externally visible port, then configure the backend URL in the served browser application to be that port number on some node in your cluster.  This is a little bit messy and manual.</p>\n\n<p>A better path is to configure an <a href=\"https://kubernetes.io/docs/concepts/services-networking/ingress/\" rel=\"noreferrer\">ingress</a> so that, for example, <code>https://.../</code> serves your browser application and <code>https://.../api</code> goes to your back-end.  Then the backend URL can just be the bare path <code>/api</code>, and it will be interpreted with the same host name and scheme as the UI.</p>\n"}], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 56921550, "answer_count": 2, "score": 0, "last_activity_date": 1562497152, "creation_date": 1562467406, "last_edit_date": 1562482560, "question_id": 56918987, "link": "https://stackoverflow.com/questions/56918987/react-app-communicating-with-go-backend-api", "title": "React App communicating with Go backend api", "body": "<p>I have a frontend React application and a Go backend service as the API for the frontend. Both are Kubernetes services in the same namespace. How can I communicate with the Go backend service without having to use an external IP? I got it to work with an external ip, but, I can't get the fqdn to resolve correctly like it should. The frontend service is built from the <code>nginx:1.15.2-alpine</code> docker image. How can I get the frontend React app to communicate with the backend Go server?</p>\n\n<p>Frontend service.yaml:</p>\n\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: ui\n  namespace: client\n  labels:\n    app: ui\nspec:\n  type: NodePort\n  ports:\n    - name: http\n      port: 80\n      targetPort: http\n    - name: https\n      port: 443\n      targetPort: https\n  selector:\n    app: ui\n</code></pre>\n\n<p>Frontend deployment.yaml:</p>\n\n<pre><code>apiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  name: ui\n  namespace: client\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 2\n  template:\n    metadata:\n      labels:\n        app: ui\n    spec:\n      containers:\n        - name: ui\n          image: #######\n          imagePullPolicy: IfNotPresent\n          ports:\n            - name: http\n              containerPort: 80\n</code></pre>\n\n<p>Backend service.yaml:</p>\n\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: api\n  namespace: client\n  labels:\n    app: api\nspec:\n  type: NodePort\n  ports:\n    - port: 8001\n      protocol: TCP\n      targetPort: http\n      name: http\n  selector:\n    app: api\n</code></pre>\n\n<p>Backend deployment.yaml:</p>\n\n<pre><code>apiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  name: api\n  namespace: client\n  labels:\n    name: api\nspec:\n  replicas: 1\n  revisionHistoryLimit: 2\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 1\n  template:\n    metadata:\n      labels:\n        app: api\n    spec:\n      containers:\n        - name: api\n          image: ####\n          imagePullPolicy: IfNotPresent\n          ports:\n            - containerPort: 8001\n</code></pre>\n"}, {"tags": ["go", "office365"], "comments": [{"owner": {"reputation": 442, "user_id": 9429150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkBiN.jpg?s=128&g=1", "display_name": "sHartmann", "link": "https://stackoverflow.com/users/9429150/shartmann"}, "edited": false, "score": 0, "creation_date": 1562443300, "post_id": 56917083, "comment_id": 100377157, "body": "Can you give an example word file? Additionally, use <code>for _,file:= range doc.FormFields()</code> instead of <code>i</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4853187"}, "reply_to_user": {"reputation": 442, "user_id": 9429150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkBiN.jpg?s=128&g=1", "display_name": "sHartmann", "link": "https://stackoverflow.com/users/9429150/shartmann"}, "edited": false, "score": 0, "creation_date": 1562444371, "post_id": 56917083, "comment_id": 100377372, "body": "@sHartmann, here is the file: <a href=\"https://www.dropbox.com/s/668493hp1yrbv8t/form.docx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/668493hp1yrbv8t/form.docx?dl=0</a>"}], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 9429150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkBiN.jpg?s=128&g=1", "display_name": "sHartmann", "link": "https://stackoverflow.com/users/9429150/shartmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1562450318, "creation_date": 1562450318, "answer_id": 56917939, "question_id": 56917083, "link": "https://stackoverflow.com/questions/56917083/filling-out-the-form-fields-in-docx-using-golang-library-unioffice/56917939#56917939", "title": "Filling out the form fields in docx using golang library unioffice", "body": "<p>Looks to me like a bug in <code>func (d *Document) Save(w io.Writer) error{}</code>. I can read and write to every of the <code>FormFields</code> but only the last <code>FormField</code> value in the paragraph gets actually saved to the file.</p>\n\n<p>Below code works like expected until you save to file. (That means it prints out the previously set value). I saw you already opened a new issue on github (<a href=\"https://github.com/unidoc/unioffice/issues/305\" rel=\"nofollow noreferrer\">link</a>) i hope you have more luck with that.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/unidoc/unioffice/document\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    _, err := ioutil.ReadFile(\"filled-form.docx\")\n    if err == nil {\n        err = os.Remove(\"filled-form.docx\")\n        if err != nil {\n            log.Fatal(err)\n        }\n    }\n\n    doc, err := document.Open(\"form.docx\")\n    if err != nil {\n        log.Fatalf(\"error opening form: %s\", err)\n    }\n\n    for _, f := range doc.FormFields() {\n        if f.Type() == document.FormFieldType(1) {\n            f.SetValue(\"test\")\n        }\n    }\n\n    for _, f := range doc.FormFields() {\n        log.Println(\"-------------------\")\n        log.Println(f.Name())\n        log.Println(f.Value())\n    }\n\n    err = doc.SaveToFile(\"filled-form.docx\")\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4853187"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562450318, "creation_date": 1562441558, "question_id": 56917083, "link": "https://stackoverflow.com/questions/56917083/filling-out-the-form-fields-in-docx-using-golang-library-unioffice", "title": "Filling out the form fields in docx using golang library unioffice", "body": "<p>I'm trying to fill out the form fields using unioffice library. The document that i'm working with, contains several paragraphs. The paragraphs contains several form fields.\nI want to fill out all of the form fields in the document. And here is the code i'm running:</p>\n\n<pre><code>    doc, err := document.Open(\"form.docx\")\n    if err != nil {\n        log.Fatalf(\"error opening form: %s\", err)\n    }\n\n    for i := range doc.FormFields() {\n        doc.FormFields()[i].SetValue(\"test\")\n    }\n\n    doc.SaveToFile(\"filled-form.docx\")\n</code></pre>\n\n<p>However, not all of the form fields were filled out.</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 561, "user_id": 522915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c96d965519bcb39f42401ff75d807ae?s=128&d=identicon&r=PG", "display_name": "cyang", "link": "https://stackoverflow.com/users/522915/cyang"}, "edited": false, "score": 2, "creation_date": 1562436364, "post_id": 56915535, "comment_id": 100375725, "body": "It looks like this is a duplicate question. <a href=\"https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path\" title=\"gopath error in windows gopath entry is relative must be absolute path\">stackoverflow.com/questions/35884965/&hellip;</a>"}, {"owner": {"reputation": 3450, "user_id": 6191996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504f78646955fcac7085b880890cd82e?s=128&d=identicon&r=PG&f=1", "display_name": "jowey", "link": "https://stackoverflow.com/users/6191996/jowey"}, "edited": false, "score": 1, "creation_date": 1562437665, "post_id": 56915535, "comment_id": 100376032, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35884965/gopath-error-in-windows-gopath-entry-is-relative-must-be-absolute-path\">GOPATH error in windows &quot;GOPATH entry is relative; must be absolute path: &quot;</a>"}], "owner": {"reputation": 1, "user_id": 11748063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wPjHDoEFopE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcOgNWD3M_FIevlVMIkOsftCVh3KQ/photo.jpg?sz=128", "display_name": "Adam", "link": "https://stackoverflow.com/users/11748063/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562463256, "creation_date": 1562427699, "last_edit_date": 1562463256, "question_id": 56915535, "link": "https://stackoverflow.com/questions/56915535/error-installing-golang-setup-tools-in-visual-studio-code", "title": "Error installing golang setup tools in visual studio code", "body": "<p>I have a problem with installing golang setup tools in visual studio code. </p>\n\n<p>Also i have set paths like GOPATH and GOROOT ==> </p>\n\n<p><img src=\"https://i.stack.imgur.com/bi63b.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Installing github.com/mdempsky/gocode FAILED\nInstalling github.com/uudashr/gopkgs/cmd/gopkgs FAILED\nInstalling github.com/ramya-rao-a/go-outline FAILED\nInstalling github.com/acroca/go-symbols FAILED\nInstalling golang.org/x/tools/cmd/guru FAILED\nInstalling golang.org/x/tools/cmd/gorename FAILED\nInstalling github.com/go-delve/delve/cmd/dlv FAILED\nInstalling github.com/stamblerre/gocode FAILED\nInstalling github.com/rogpeppe/godef FAILED\nInstalling github.com/sqs/goreturns FAILED\nInstalling golang.org/x/lint/golint FAILED\nInstalling github.com/cweill/gotests/... FAILED\nInstalling github.com/fatih/gomodifytags FAILED\nInstalling github.com/josharian/impl FAILED\nInstalling github.com/davidrjenni/reftools/cmd/fillstruct FAILED\nInstalling github.com/haya14busa/goplay/cmd/goplay FAILED\nInstalling github.com/godoctor/godoctor FAILED\n\n17 tools failed to install.\n\ngocode:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v github.com/mdempsky/gocode\ngo: GOPATH entry is relative; must be absolute path: \"go.gopath\".\nFor more details see: 'go help gopath'\ngo: GOPATH entry is relative; must be absolute path: \"go.gopath\".\nFor more details see: 'go help gopath'\n</code></pre>\n"}, {"tags": ["go", "environment-variables", "string-interpolation"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1562432421, "last_edit_date": 1562432421, "creation_date": 1562431058, "answer_id": 56915933, "question_id": 56915429, "link": "https://stackoverflow.com/questions/56915429/interpolate-a-string-with-bash-like-environment-variables-references/56915933#56915933", "title": "Interpolate a string with bash-like environment variables references", "body": "<p>Use <a href=\"https://godoc.org/os#ExpandEnv\" rel=\"nofollow noreferrer\">os.ExpandEnv</a>:</p>\n\n<pre><code>s := os.ExpandEnv(\n    \"$HOME/somedir/${SOME_VARIABLE}dir/anotherdir-${ANOTHER_VARIABLE}\")\n</code></pre>\n\n<p>You can use <a href=\"https://godoc.org/os#Expand\" rel=\"nofollow noreferrer\">os.Expand</a> for the case where the values are not taken from environment variables:</p>\n\n<pre><code>m := map[string]string{\n    \"HOME\":             \"/home/user\",\n    \"SOME_VARIABLE\":    \"4\",\n    \"ANOTHER_VARIABLE\": \"5\",\n}\ns := os.Expand(\n    \"$HOME/somedir/${SOME_VARIABLE}dir/anotherdir-${ANOTHER_VARIABLE}\", \n    func(s string) string { return m[s] })\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/73fxIwlbuwg\" rel=\"nofollow noreferrer\">Run it in the playground</a>.</p>\n"}], "owner": {"reputation": 5619, "user_id": 1723695, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/dx9jj.jpg?s=128&g=1", "display_name": "Kirill", "link": "https://stackoverflow.com/users/1723695/kirill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 56915933, "answer_count": 1, "score": 4, "last_activity_date": 1562432421, "creation_date": 1562426827, "question_id": 56915429, "link": "https://stackoverflow.com/questions/56915429/interpolate-a-string-with-bash-like-environment-variables-references", "title": "Interpolate a string with bash-like environment variables references", "body": "<p>I have an input string for my Golang CLI tool with some references to environment variables in bash syntax (<code>$VAR</code> and <code>${VAR}</code>), e.g.:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$HOME/somedir/${SOME_VARIABLE}dir/anotherdir-${ANOTHER_VARIABLE}\n</code></pre>\n\n<p>What is the most efficient way to interpolate this string by replacing environemnt variables references with actual values?\nFor previous example it can be:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>/home/user/somedir/4dir/anotherdir-5\n</code></pre>\n\n<p>if <code>HOME=/home/user</code>, <code>SOME_VARIABLE=4</code> and <code>ANOTHER_VARIABLE=5</code>.</p>\n\n<p>Right now I'm using something like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func interpolate(str string) string {\n        for _, e := range os.Environ() {\n                parts := strings.SplitN(e, \"=\", 2)\n                name, value := parts[0], parts[1]\n                str = strings.Replace(str, \"$\" + name, value, -1)\n        }\n        return str\n}\n</code></pre>\n\n<p>but this code doesn't handle <code>${}</code> variables.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 1, "creation_date": 1562470432, "post_id": 56918824, "comment_id": 100380943, "body": "Yeah....Thanks @TimBrown for your help... I&#39;m done with added <code>Preload(&quot;OrderDetail&quot;)</code>"}], "tags": [], "owner": {"reputation": 2615, "user_id": 2480468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNCmN.jpg?s=128&g=1", "display_name": "Tim Brown", "link": "https://stackoverflow.com/users/2480468/tim-brown"}, "is_accepted": true, "score": 2, "last_activity_date": 1562463837, "creation_date": 1562463837, "answer_id": 56918824, "question_id": 56914508, "link": "https://stackoverflow.com/questions/56914508/how-to-add-relation-data/56918824#56918824", "title": "How to add relation data", "body": "<p>You'd need to add a <code>Preload</code> call into your query or a <code>Related</code> call after you've gotten your object.  See <a href=\"http://gorm.io/docs/preload.html\" rel=\"nofollow noreferrer\">the <code>Preload</code> docs here</a> or <a href=\"http://gorm.io/docs/has_many.html#Working-with-Has-Many\" rel=\"nofollow noreferrer\">the <code>Related</code> docs</a> for usage.  If you use <code>Preload</code>, which I'd recommend for simplicity, you might have to abandon your <code>crudOne</code> function or adapt it to work with your needs.</p>\n"}], "owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 1, "accepted_answer_id": 56918824, "answer_count": 1, "score": 2, "last_activity_date": 1562463837, "creation_date": 1562419470, "question_id": 56914508, "link": "https://stackoverflow.com/questions/56914508/how-to-add-relation-data", "title": "How to add relation data", "body": "<p>I start to learn Golang with sample project from <a href=\"https://github.com/dejavuzhou/felix\" rel=\"nofollow noreferrer\">https://github.com/dejavuzhou/felix</a></p>\n\n<p>My first project already runnning well. But I want some custom output. I mean I want to get relation data <strong>Has Many</strong> when I get order data, but I fail.</p>\n\n<p>Start with my simple case, I have 2 tables (<strong>order</strong> and <strong>detail_order</strong>). One order has one or more detail_order.</p>\n\n<p>My handler_order.go</p>\n\n<pre><code>    package handlers\n\n    import (\n        \"github.com/berthojoris/ginbro/models\"\n        \"github.com/gin-gonic/gin\"\n    )\n\n    func init() {\n        groupApi.GET(\"order\", orderAll)\n        groupApi.GET(\"order/:id\", orderOne)\n        groupApi.POST(\"order\", orderCreate)\n        groupApi.PATCH(\"order\", orderUpdate)\n        groupApi.DELETE(\"order/:id\", orderDelete)\n    }\n\n    //All\n    func orderAll(c *gin.Context) {\n        mdl := models.Order{}\n        query := &amp;models.PaginationQuery{}\n        err := c.ShouldBindQuery(query)\n        if handleError(c, err) {\n            return\n        }\n        list, total, err := mdl.All(query)\n        if handleError(c, err) {\n            return\n        }\n        jsonPagination(c, list, total, query)\n    }\n\n    //One\n    func orderOne(c *gin.Context) {\n        var mdl models.Order\n        id, err := parseParamID(c)\n        if handleError(c, err) {\n            return\n        }\n        mdl.Id = id\n        data, err := mdl.One()\n        if handleError(c, err) {\n            return\n        }\n        jsonData(c, data)\n    }\n\n    //Create\n    func orderCreate(c *gin.Context) {\n        var mdl models.Order\n        err := c.ShouldBind(&amp;mdl)\n        if handleError(c, err) {\n            return\n        }\n        err = mdl.Create()\n        if handleError(c, err) {\n            return\n        }\n        jsonData(c, mdl)\n    }\n\n    //Update\n    func orderUpdate(c *gin.Context) {\n        var mdl models.Order\n        err := c.ShouldBind(&amp;mdl)\n        if handleError(c, err) {\n            return\n        }\n        err = mdl.Update()\n        if handleError(c, err) {\n            return\n        }\n        jsonSuccess(c)\n    }\n\n    //Delete\n    func orderDelete(c *gin.Context) {\n        var mdl models.Order\n        id, err := parseParamID(c)\n        if handleError(c, err) {\n            return\n        }\n        mdl.Id = id\n        err = mdl.Delete()\n        if handleError(c, err) {\n            return\n        }\n        jsonSuccess(c)\n    }\n</code></pre>\n\n<p>My model_order.go</p>\n\n<pre><code>package models\n\nimport (\n    \"errors\"\n    \"time\"\n)\n\nvar _ = time.Thursday\n\n//Order\ntype Order struct {\n    Id    uint    `gorm:\"column:id\" form:\"id\" json:\"id\" comment:\"\" sql:\"int(10),PRI\"`\n    Total float64 `gorm:\"column:total\" form:\"total\" json:\"total\" comment:\"\" sql:\"double\"`\n    OrderDetail []OrderDetail `gorm:\"foreignkey:OrderID\" json:\"detail_order\"`\n}\n\n//TableName\nfunc (m *Order) TableName() string {\n    return \"order\"\n}\n\n//One\nfunc (m *Order) One() (one *Order, err error) {\n    one = &amp;Order{}\n    err = crudOne(m, one)\n    return\n}\n\n//All\nfunc (m *Order) All(q *PaginationQuery) (list *[]Order, total uint, err error) {\n    list = &amp;[]Order{}\n    total, err = crudAll(m, q, list)\n    return\n}\n\n//Update\nfunc (m *Order) Update() (err error) {\n    where := Order{Id: m.Id}\n    m.Id = 0\n\n    return crudUpdate(m, where)\n}\n\n//Create\nfunc (m *Order) Create() (err error) {\n    m.Id = 0\n\n    return mysqlDB.Create(m).Error\n}\n\n//Delete\nfunc (m *Order) Delete() (err error) {\n    if m.Id == 0 {\n        return errors.New(\"resource must not be zero value\")\n    }\n    return crudDelete(m)\n}\n</code></pre>\n\n<p>My model_order_detail.go</p>\n\n<pre><code>package models\n\nimport (\n    \"errors\"\n    \"time\"\n)\n\nvar _ = time.Thursday\n\n//OrderDetail\ntype OrderDetail struct {\n    Id        uint    `gorm:\"column:id\" form:\"id\" json:\"id\" comment:\"\" sql:\"int(10),PRI\"`\n    OrderId   int     `gorm:\"column:order_id\" form:\"order_id\" json:\"order_id\" comment:\"\" sql:\"int(10),MUL\"`\n    ItemId    int     `gorm:\"column:item_id\" form:\"item_id\" json:\"item_id\" comment:\"\" sql:\"int(10)\"`\n    ItemName  string  `gorm:\"column:item_name\" form:\"item_name\" json:\"item_name\" comment:\"\" sql:\"varchar(100)\"`\n    ItemPrice float64 `gorm:\"column:item_price\" form:\"item_price\" json:\"item_price\" comment:\"\" sql:\"double\"`\n}\n\n//TableName\nfunc (m *OrderDetail) TableName() string {\n    return \"order_detail\"\n}\n\n//One\nfunc (m *OrderDetail) One() (one *OrderDetail, err error) {\n    one = &amp;OrderDetail{}\n    err = crudOne(m, one)\n    return\n}\n\n//All\nfunc (m *OrderDetail) All(q *PaginationQuery) (list *[]OrderDetail, total uint, err error) {\n    list = &amp;[]OrderDetail{}\n    total, err = crudAll(m, q, list)\n    return\n}\n\n//Update\nfunc (m *OrderDetail) Update() (err error) {\n    where := OrderDetail{Id: m.Id}\n    m.Id = 0\n\n    return crudUpdate(m, where)\n}\n\n//Create\nfunc (m *OrderDetail) Create() (err error) {\n    m.Id = 0\n\n    return mysqlDB.Create(m).Error\n}\n\n//Delete\nfunc (m *OrderDetail) Delete() (err error) {\n    if m.Id == 0 {\n        return errors.New(\"resource must not be zero value\")\n    }\n    return crudDelete(m)\n}\n</code></pre>\n\n<p>And my db_helper.go</p>\n\n<pre><code>package models\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"github.com/jinzhu/gorm\"\n    \"reflect\"\n    \"strconv\"\n    \"strings\"\n)\n\n//PaginationQuery gin handler query binding struct\ntype PaginationQuery struct {\n    Where  string `form:\"where\"`\n    Fields string `form:\"fields\"`\n    Order  string `form:\"order\"`\n    Offset uint   `form:\"offset\"`\n    Limit  uint   `form:\"limit\"`\n}\n\n//String to string\nfunc (pq *PaginationQuery) String() string {\n    return fmt.Sprintf(\"w=%v_f=%s_o=%s_of=%d_l=%d\", pq.Where, pq.Fields, pq.Order, pq.Offset, pq.Limit)\n}\n\nfunc crudAll(m interface{}, q *PaginationQuery, list interface{}) (total uint, err error) {\n    var tx *gorm.DB\n    total, tx = getResourceCount(m, q)\n    if q.Fields != \"\" {\n        columns := strings.Split(q.Fields, \",\")\n        if len(columns) &gt; 0 {\n            tx = tx.Select(q.Fields)\n        }\n    }\n    if q.Order != \"\" {\n        tx = tx.Order(q.Order)\n    }\n    if q.Offset &gt; 0 {\n        tx = tx.Offset(q.Offset)\n    }\n    if q.Limit &lt;= 0 {\n        q.Limit = 15\n    }\n    err = tx.Limit(q.Limit).Find(list).Error\n    return\n}\n\nfunc crudOne(m interface{}, one interface{}) (err error) {\n    if mysqlDB.Where(m).First(one).RecordNotFound() {\n        return errors.New(\"resource is not found\")\n    }\n    return nil\n}\n\nfunc crudUpdate(m interface{}, where interface{}) (err error) {\n    db := mysqlDB.Model(where).Updates(m)\n    if err = db.Error; err != nil {\n        return\n    }\n    if db.RowsAffected != 1 {\n        return errors.New(\"id is invalid and resource is not found\")\n    }\n    return nil\n}\n\nfunc crudDelete(m interface{}) (err error) {\n    //WARNING When delete a record, you need to ensure it\u2019s primary field has value, and GORM will use the primary key to delete the record, if primary field\u2019s blank, GORM will delete all records for the model\n    //primary key must be not zero value\n    db := mysqlDB.Delete(m)\n    if err = db.Error; err != nil {\n        return\n    }\n    if db.RowsAffected != 1 {\n        return errors.New(\"resource is not found to destroy\")\n    }\n    return nil\n}\nfunc getResourceCount(m interface{}, q *PaginationQuery) (uint, *gorm.DB) {\n    var tx = mysqlDB.Model(m)\n    conditions := strings.Split(q.Where, \",\")\n    for _, val := range conditions {\n        w := strings.SplitN(val, \":\", 2)\n        if len(w) == 2 {\n            bindKey, bindValue := w[0], w[1]\n            if intV, err := strconv.ParseInt(bindValue, 10, 64); err == nil {\n                // bind value is int\n                field := fmt.Sprintf(\"`%s` &gt; ?\", bindKey)\n                tx = tx.Where(field, intV)\n            } else if fV, err := strconv.ParseFloat(bindValue, 64); err == nil {\n                // bind value is float\n                field := fmt.Sprintf(\"`%s` &gt; ?\", bindKey)\n                tx = tx.Where(field, fV)\n            } else if bindValue != \"\" {\n                // bind value is string\n                field := fmt.Sprintf(\"`%s` LIKE ?\", bindKey)\n                sV := fmt.Sprintf(\"%%%s%%\", bindValue)\n                tx = tx.Where(field, sV)\n            }\n        }\n    }\n    modelName := getType(m)\n    rKey := redisPrefix + modelName + q.String() + \"_count\"\n    v, err := mem.GetUint(rKey)\n    if err != nil {\n        var count uint\n        tx.Count(&amp;count)\n        mem.Set(rKey, count)\n        return count, tx\n    }\n    return v, tx\n}\n\nfunc getType(v interface{}) string {\n    t := reflect.TypeOf(v)\n    if t.Kind() == reflect.Ptr {\n        return \"*\" + t.Elem().Name()\n    }\n    return t.Name()\n}\n</code></pre>\n\n<p>In my order model, I add</p>\n\n<pre><code>OrderDetail []OrderDetail `gorm:\"foreignkey:OrderID\" json:\"detail_order\"`\n</code></pre>\n\n<p>For my relation data. And the result is\n<a href=\"https://i.stack.imgur.com/LTqvp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LTqvp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Even though I have the relation data\n<a href=\"https://i.stack.imgur.com/SOls5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SOls5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>My question, How I add / attach <code>OrderDetail struct</code> inside <code>Order struct</code> So that my table relationship data comes out.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "windows-10", "filepath"], "answers": [{"tags": [], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "is_accepted": true, "score": 2, "last_activity_date": 1562413818, "creation_date": 1562413818, "answer_id": 56913830, "question_id": 56913799, "link": "https://stackoverflow.com/questions/56913799/how-do-you-get-filepath-isabs-to-correctly-indentify-an-absolute-path/56913830#56913830", "title": "How do you get filepath.IsAbs to correctly indentify an absolute path?", "body": "<p>Because on Windows root path starts with drive.</p>\n\n<p>Try: \u2018C:\\dir\\file\u2019</p>\n"}], "owner": {"reputation": 415, "user_id": 5641767, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c05ce9cbf6b06b52baf435908e98d37?s=128&d=identicon&r=PG&f=1", "display_name": "smkarber", "link": "https://stackoverflow.com/users/5641767/smkarber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 56913830, "answer_count": 1, "score": 0, "last_activity_date": 1562414883, "creation_date": 1562413597, "last_edit_date": 1562414883, "question_id": 56913799, "link": "https://stackoverflow.com/questions/56913799/how-do-you-get-filepath-isabs-to-correctly-indentify-an-absolute-path", "title": "How do you get filepath.IsAbs to correctly indentify an absolute path?", "body": "<p>According to the <a href=\"https://gobyexample.com/file-paths\" rel=\"nofollow noreferrer\">File Paths tutorial on gobyexample.com</a>, the following code should result in a print out of <strong><em>false</em></strong>, and then <strong><em>true</em></strong> for each line respectively:</p>\n\n<pre><code>package main\n\n  import (\n    \"fmt\"\n    \"path/filepath\"\n    \"strings\"\n  )\n\n  func main() {\n    fmt.Println(filepath.IsAbs(\"dir/file\"))\n    fmt.Println(filepath.IsAbs(\"/dir/file\"))\n  }\n</code></pre>\n\n<p>I on Windows 10, Go version go1.12.5 windows/amd64, and building in Cmder.</p>\n\n<p>I get false for both lines, and I cannot figure out why or if there is something different I can do to get the expected output.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 837, "user_id": 1108824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db03848c6bb955bc11ec52fee3ee401c?s=128&d=identicon&r=PG", "display_name": "r---------k", "link": "https://stackoverflow.com/users/1108824/r-k"}, "edited": false, "score": 1, "creation_date": 1562412361, "post_id": 56913543, "comment_id": 100370307, "body": "At first glance there are several things I would do differently:      - first make sure you check for errors, you shouldn&#39;t discard errors from ioutil in copy()      - the correct way to handle errors in a func is to return it, not to print it in the func, this way you can stop execution in main when you have an error (after printing it)      - avoid globals, you could return a new []string and return it in your CollectFiles() ([]string, error)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562413077, "post_id": 56913543, "comment_id": 100370453, "body": "You need to be more specific than &quot;it doesn&#39;t work.&quot; What doesn&#39;t work? What behavior do you observe? What do you expect instead?"}, {"owner": {"reputation": 1, "user_id": 11747381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9b3fc4d999dab40e69c24a201f61d0?s=128&d=identicon&r=PG&f=1", "display_name": "jimbel", "link": "https://stackoverflow.com/users/11747381/jimbel"}, "edited": false, "score": 0, "creation_date": 1562414917, "post_id": 56913543, "comment_id": 100370844, "body": "Obviously I expect that copy until the folder reaches 10000 bytes. But copy more than 10000 bytes"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1562419232, "post_id": 56913543, "comment_id": 100371794, "body": "That&#39;s not at all obvious from your description. &quot;It doesn&#39;t work&quot; can mean anything, including it copies nothing, or it returns an error, or it crashes or doesn&#39;t compilie."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1562419785, "post_id": 56913687, "comment_id": 100371894, "body": "I don&#39;t know if this is correct or not, but without commentary explaining what you corrected, it&#39;s an incomplete answer, at best."}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": false, "score": -4, "last_activity_date": 1562412546, "creation_date": 1562412546, "answer_id": 56913687, "question_id": 56913543, "link": "https://stackoverflow.com/questions/56913543/copy-files-into-a-folder-until-it-reaches-a-certain-size/56913687#56913687", "title": "Copy files into a folder until it reaches a certain size", "body": "<p>You have multiple places where you're wrong. Perhaps check this code and compare:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n)\n\nvar (\n    MyFolderPath   = \"/tmp\"\n    DestPath       = \"/tmp/dest\"\n    CumulativeSize int64 = 0 // in bytes\n    ErrDone = errors.New(\"done\")\n)\n\nconst UpperLimit = 1024 * // 1 Kilobyte\n    1024 * // 1 Megabyte\n    10 // 10 Megabytes\n\nfunc main() {\n    err := filepath.Walk(MyFolderPath, func(path string, info os.FileInfo, err error) error {\n        if err != nil {\n            fmt.Printf(\"problem with file (%s): %v\", path, err)\n            return nil\n        }\n        if info.IsDir() {\n            return filepath.SkipDir // skip it, walk will enter it too\n        }\n        CumulativeSize += info.Size()\n\n        if CumulativeSize &gt;= UpperLimit {\n            return ErrDone\n        }\n\n        // copy file here\n\n        return nil\n    })\n\n    if err == ErrDone {\n        fmt.Println(\"finished successfully\")\n    } else {\n        fmt.Printf(\"error: %v\", err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1562419705, "creation_date": 1562419705, "answer_id": 56914541, "question_id": 56913543, "link": "https://stackoverflow.com/questions/56913543/copy-files-into-a-folder-until-it-reaches-a-certain-size/56914541#56914541", "title": "Copy files into a folder until it reaches a certain size", "body": "<p>This line is wrong:</p>\n\n<pre><code>    copy(files[1:], fmt.Sprintf(\"%v/test/%v\", MyFolderPath, \"file\"))\n</code></pre>\n\n<p>Every time you find a file match, you tell it to (re)-copy <em>every</em> file in your <code>files</code> slice, except the first one.</p>\n\n<p>You probably want to copy a single file there.</p>\n\n<p>Although your code is difficult to reason through--I'm not sure why <code>files</code> exists at all, nor why you're walking your directory structure twice. So your goals aren't really clear, so it's hard to be more specific.</p>\n\n<p>Also note: You should not use <code>copy</code> as the name of a function, as that is a <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\">built-in</a>, so makes your code very confusing to read.</p>\n"}], "owner": {"reputation": 1, "user_id": 11747381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9b3fc4d999dab40e69c24a201f61d0?s=128&d=identicon&r=PG&f=1", "display_name": "jimbel", "link": "https://stackoverflow.com/users/11747381/jimbel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1562419705, "creation_date": 1562411498, "last_edit_date": 1562413044, "question_id": 56913543, "link": "https://stackoverflow.com/questions/56913543/copy-files-into-a-folder-until-it-reaches-a-certain-size", "title": "Copy files into a folder until it reaches a certain size", "body": "<p>I have a folder named \"myfolder\" that has some txt and jpeg files and and a folder named \"test\".\nI want to copy files inside myfolder to test until it reaches a certain size, for example 10MB, then stop to copy.</p>\n\n<p>This is my code that does not work:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"path/filepath\"\n    \"strconv\"\n)\n\nvar (\n    MyFolderPath = \"/home/jim/myfolder\"\n    files        []string\n)\n\nfunc copy(source []string, destination string) {\n\n    for a, b := range source {\n        input, _ := ioutil.ReadFile(b)\n        ioutil.WriteFile(destination+strconv.Itoa(a), input, 0777)\n    }\n\n}\n\nfunc CopyFile(path string) {\n    var size int64\n    done := errors.New(\"size reached\")\n    err := filepath.Walk(path, func(_ string, info os.FileInfo, err error) error {\n        if err != nil {\n            return err\n        }\n        copy(files[1:], fmt.Sprintf(\"%v/test/%v\", MyFolderPath, \"file\"))\n        size += info.Size()\n\n        if size &gt; 10000 {\n            return done\n        }\n\n        return err\n\n    })\n    if err != nil {\n        fmt.Println(err)\n    }\n\n}\n\nfunc CollectFiles() {\n    err := filepath.Walk(MyFolderPath, func(path string, info os.FileInfo, err error) error {\n        if err != nil {\n            fmt.Println(err)\n        }\n        files = append(files, path)\n        return nil\n\n    })\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n\nfunc main() {\n    CollectFiles()\n    CopyFile(fmt.Sprintf(\"%v/test\", MyFolderPath))\n}\n</code></pre>\n\n<p>What I do wrong and how can I do in right way?</p>\n"}, {"tags": ["pointers", "go", "struct"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1562412454, "post_id": 56913379, "comment_id": 100370325, "body": "Can you be more specific, of what you are trying to achieve here, what ever you are trying to achieve here, it doesn&#39;t seem you are doing it in right way."}, {"owner": {"reputation": 11313, "user_id": 1910920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ZcpU1.jpg?s=128&g=1", "display_name": "Shaharyar", "link": "https://stackoverflow.com/users/1910920/shaharyar"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1562412722, "post_id": 56913379, "comment_id": 100370381, "body": "I am trying to create an array and fill it using the function <code>saveCar</code>. If I pass the array by value, my main array doesn&#39;t get updated. So I tried to pass pointer of array, which is giving me above errors."}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1562412874, "post_id": 56913379, "comment_id": 100370411, "body": "don&#39;t you think a map would be better, if you are going to delete values. If not then append would work fine just store the returned array to the same variable. <code>a = append(a, x...)</code>"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1562413008, "post_id": 56913379, "comment_id": 100370438, "body": "<code>tCars := make([]car, 4) _cars = &amp;tCars</code>, and by the way we don&#39;t use underscores in go."}, {"owner": {"reputation": 11313, "user_id": 1910920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ZcpU1.jpg?s=128&g=1", "display_name": "Shaharyar", "link": "https://stackoverflow.com/users/1910920/shaharyar"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1562413486, "post_id": 56913379, "comment_id": 100370536, "body": "Your last comment, it did the job. I passed <code>&amp;tCars</code> to my function. Post it as answer so I can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 649, "user_id": 554480, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/m1Kjt.png?s=128&g=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/554480/mikhail"}, "is_accepted": false, "score": 1, "last_activity_date": 1562414153, "creation_date": 1562414153, "answer_id": 56913868, "question_id": 56913379, "link": "https://stackoverflow.com/questions/56913379/initialize-pointer-array-cannot-make-type-type/56913868#56913868", "title": "Initialize pointer array - cannot make type *[]type", "body": "<blockquote>\n  <p>1 - cannot make type *[]car</p>\n</blockquote>\n\n<p>You observe it because <code>make</code> creates slice, map or chan. In the example you gave you tried to create pointer to a slice which is none of the typed <code>make</code> works with.</p>\n\n<blockquote>\n  <p>2 - If I don't use make, runtime error occurs:</p>\n</blockquote>\n\n<p>that's another problem - you have type \"pointer to a slice of car\", not \"a slice  of car\". And in general you need to initialize pointer types before using. </p>\n\n<p>Overall there is no need to use pointer to a slice rather than plain slice in your case, because you don't use append, to there is no chance for reallocation of backed storage.</p>\n\n<p>However, in a real world scenario, when you don't know amount of car instances you are going to add, is much better to use append instead of iterating through slice till the last non-initialized value.</p>\n\n<p>summary:</p>\n\n<ul>\n<li>to make your program work change *[]car to []car everywhere (example <a href=\"https://play.golang.org/p/lpCtvXqG6UY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/lpCtvXqG6UY</a>)</li>\n<li>another (and probably better) way is to use append instead of saveCar (don't forget to use returned value in case of happened re-allocation, example: <a href=\"https://play.golang.org/p/L8V10tSb-IJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/L8V10tSb-IJ</a>)</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "is_accepted": true, "score": 2, "last_activity_date": 1562415174, "creation_date": 1562415174, "answer_id": 56913990, "question_id": 56913379, "link": "https://stackoverflow.com/questions/56913379/initialize-pointer-array-cannot-make-type-type/56913990#56913990", "title": "Initialize pointer array - cannot make type *[]type", "body": "<p>Changing this would make your code work:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>tCars := make([]car, 4)\n_cars = &amp;tCars\n</code></pre>\n"}], "owner": {"reputation": 11313, "user_id": 1910920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ZcpU1.jpg?s=128&g=1", "display_name": "Shaharyar", "link": "https://stackoverflow.com/users/1910920/shaharyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 56913990, "answer_count": 2, "score": -3, "last_activity_date": 1562415174, "creation_date": 1562410126, "question_id": 56913379, "link": "https://stackoverflow.com/questions/56913379/initialize-pointer-array-cannot-make-type-type", "title": "Initialize pointer array - cannot make type *[]type", "body": "<p>Its a simple code, saving <code>car</code> type objects into a <code>car</code> type array. I am trying to use pointer here to pass array reference.</p>\n\n<p><strong>There are 2 problems:</strong></p>\n\n<p><strong>1</strong> - I can't initialize it as empty array. When I use <code>make</code>, it says:</p>\n\n<blockquote>\n  <p>cannot make type *[]car</p>\n</blockquote>\n\n<p><strong>2</strong> - If I don't use <code>make</code>, runtime error occurs:</p>\n\n<blockquote>\n  <p>panic: runtime error: invalid memory address or nil pointer dereference</p>\n</blockquote>\n\n<hr>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>import \"fmt\"\n\ntype car struct {\n    plate string\n    color string\n}\n\nfunc main() {\n\n    var _cars *[]car        // list of cars\n    _cars = make(*[]car, 4) // initialize empty cars list\n\n    saveCar(_cars, car{\"ABC-123\", \"Black\"})\n    saveCar(_cars, car{\"ABC-456\", \"Black\"})\n    saveCar(_cars, car{\"ABC-789\", \"Black\"})\n\n    fmt.Println(_cars)\n}\n\nfunc saveCar(_cars_list *[]car, _car car) int {\n\n    for index, current := range *_cars_list {\n        // if empty place found, save car\n        if (car{}) == current {\n\n            // save car\n            (*_cars_list)[index] = _car\n\n            // return the saved index\n            return index\n        }\n    }\n\n    return -1\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1562403254, "post_id": 56912491, "comment_id": 100368578, "body": "Yes, the only way to achieve what you want (without a struct) must include <code>raw[&quot;emails&quot;].([]interface{})</code> at some point."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562403292, "post_id": 56912491, "comment_id": 100368590, "body": "Why do you want to avoid a struct? A struct is the easy way to handle this--and no need to do it twice. If that field is missing, the struct will just have it unset."}, {"owner": {"reputation": 2052, "user_id": 3782963, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/457c55bc8c6bff07894da51767e408fb?s=128&d=identicon&r=PG", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3782963/akshay"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562403383, "post_id": 56912491, "comment_id": 100368606, "body": "@Flimzy I think I don&#39;t mind that now if I don&#39;t have to unmarshal it twice"}, {"owner": {"reputation": 2052, "user_id": 3782963, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/457c55bc8c6bff07894da51767e408fb?s=128&d=identicon&r=PG", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3782963/akshay"}, "edited": false, "score": 0, "creation_date": 1562426238, "post_id": 56912491, "comment_id": 100373427, "body": "Why the negative mark?"}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1562403138, "creation_date": 1562403138, "answer_id": 56912573, "question_id": 56912491, "link": "https://stackoverflow.com/questions/56912491/unmarshal-unknown-json-fields-without-structs/56912573#56912573", "title": "Unmarshal unknown JSON fields without structs", "body": "<p>You can use type assertions. The Go tutorial on type assertions is <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>A Go playground link applying type assertions to your problem is <a href=\"https://play.golang.org/p/nQY19CoN8La\" rel=\"nofollow noreferrer\">here</a>. For ease of reading, that code is replicated below:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    jo := `\n        {\n            \"given_name\": \"Akshay Raj\",\n            \"name\": \"Akshay\",\n            \"country\": \"New Zealand\",\n            \"family_name\": \"Gollahalli\",\n            \"emails\": [\n                \"name@example.com\"\n            ]\n        }\n        `\n    var raw map[string]interface{}\n    err := json.Unmarshal([]byte(jo), &amp;raw)\n    if err != nil {\n        panic(err)\n    }\n\n    emails, ok := raw[\"emails\"]\n    if !ok {\n        panic(\"do this when no 'emails' key\")\n    }\n\n    emailsSlice, ok := emails.([]interface{})\n    if !ok {\n        panic(\"do this when 'emails' value is not a slice\")\n    }\n\n    if len(emailsSlice) == 0 {\n        panic(\"do this when 'emails' slice is empty\")\n    }\n\n    email, ok := (emailsSlice[0]).(string)\n    if !ok {\n        panic(\"do this when 'emails' slice contains non-string\")\n    }\n\n    fmt.Println(email)\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1562403525, "creation_date": 1562403525, "answer_id": 56912621, "question_id": 56912491, "link": "https://stackoverflow.com/questions/56912491/unmarshal-unknown-json-fields-without-structs/56912621#56912621", "title": "Unmarshal unknown JSON fields without structs", "body": "<p>The easiest way is with a struct. There's no need to unmarshal twice.</p>\n\n<pre><code>type MyStruct struct {\n    // ... other fields\n    Emails []string `json:\"emails\"`\n}\n</code></pre>\n\n<p>This will work, regardless of whether the JSON input contains the <code>emails</code> field. When it is missing, your resulting struct will just have an uninitialized <code>Emails</code> field.</p>\n"}, {"tags": [], "owner": {"reputation": 342, "user_id": 9955790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "RimeBeliskner", "link": "https://stackoverflow.com/users/9955790/rimebeliskner"}, "is_accepted": false, "score": 0, "last_activity_date": 1562433216, "creation_date": 1562433216, "answer_id": 56916167, "question_id": 56912491, "link": "https://stackoverflow.com/questions/56912491/unmarshal-unknown-json-fields-without-structs/56916167#56916167", "title": "Unmarshal unknown JSON fields without structs", "body": "<p>As always you can use additional libraries for work with your json data. For example with <a href=\"https://github.com/thedevsaddam/gojsonq\" rel=\"nofollow noreferrer\">gojsonq</a> package it will like so: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/thedevsaddam/gojsonq\"\n)\n\nfunc main() {\n\n    json := `\n        {\n            \"given_name\": \"Akshay Raj\",\n            \"name\": \"Akshay\",\n            \"country\": \"New Zealand\",\n            \"family_name\": \"Gollahalli\",\n            \"emails\": [\n                \"name@example.com\"\n                ]\n        }\n        `\n    first := gojsonq.New().JSONString(json).Find(\"emails.[0]\")\n    if first != nil {\n        fmt.Println(first.(string))\n    } else {\n        fmt.Println(\"There isn't emails\")\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 2052, "user_id": 3782963, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/457c55bc8c6bff07894da51767e408fb?s=128&d=identicon&r=PG", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3782963/akshay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 56912621, "answer_count": 3, "score": -1, "last_activity_date": 1562433216, "creation_date": 1562402238, "last_edit_date": 1562402881, "question_id": 56912491, "link": "https://stackoverflow.com/questions/56912491/unmarshal-unknown-json-fields-without-structs", "title": "Unmarshal unknown JSON fields without structs", "body": "<p>I am trying to unmarshal a JSON object which has an optional array, I am doing this without an array and this is what I got so far:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    jo := `\n        {\n            \"given_name\": \"Akshay Raj\",\n            \"name\": \"Akshay\",\n            \"country\": \"New Zealand\",\n            \"family_name\": \"Gollahalli\",\n            \"emails\": [\n                \"name@example.com\"\n                ]\n        }\n        `\n    var raw map[string]interface{}\n    err := json.Unmarshal([]byte(jo), &amp;raw)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(raw[\"emails\"][0])\n\n}\n</code></pre>\n\n<p>The <code>emails</code> field might or might not come sometime. I know I can use <code>struct</code> and unmarshal it twice for with and without array. When I try to get the index <code>0</code> of <code>raw[\"emails\"][0]</code> I get the following error</p>\n\n<pre><code>invalid operation: raw[\"emails\"][0] (type interface {} does not support indexing)\n</code></pre>\n\n<p>Is there a way to get the index of the <code>emails</code> field?</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>I can do something like this <code>fmt.Println(raw[\"emails\"].([]interface{})[0])</code> and it works. Is this the only way?</p>\n"}, {"tags": ["go", "zip"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1562398433, "post_id": 56912047, "comment_id": 100367869, "body": "I&#39;m sure, as a practical matter, you can rely on that, even if it&#39;s not a documented behavior. It would be odd to write an implementation that returns files in an order other than that in which they are found in the archive."}, {"owner": {"reputation": 2317, "user_id": 4466589, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uPR5Y.jpg?s=128&g=1", "display_name": "Bora M. Alper", "link": "https://stackoverflow.com/users/4466589/bora-m-alper"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562400611, "post_id": 56912047, "comment_id": 100368168, "body": "@Flimzy I thought so too, thanks. =)"}], "owner": {"reputation": 2317, "user_id": 4466589, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uPR5Y.jpg?s=128&g=1", "display_name": "Bora M. Alper", "link": "https://stackoverflow.com/users/4466589/bora-m-alper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562397573, "creation_date": 1562397573, "question_id": 56912047, "link": "https://stackoverflow.com/questions/56912047/can-i-rely-the-order-of-files-in-archive-zip-reader-file", "title": "Can I rely the order of Files in archive/zip.Reader.File?", "body": "<p>I am writing an app that would allow random access to files in a zip archive based on the md5sum of the files. To do that, I am planning to map each hashsum to a tuple of <code>(zip_file, file_index)</code>.</p>\n\n<p>Can I rely on the order of Files in <a href=\"https://golang.org/pkg/archive/zip/#Reader\" rel=\"nofollow noreferrer\"><code>archive/zip.Reader</code></a>? I presume it's same as the order of files in the archive but couldn't find any resources.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-firestore", "google-cloud-run"], "comments": [{"owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "edited": false, "score": 0, "creation_date": 1562395277, "post_id": 56911844, "comment_id": 100367422, "body": "I just found another google example, here the context is imported as plainly &quot;context&quot;,:  <a href=\"https://github.com/GoogleCloudPlatform/golang-samples/blob/master/auth/snippets.go\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/golang-samples/blob/master/au&zwnj;&#8203;th/&hellip;</a>   however, when one goes directly into the folder where the context thing should be defined, it turns out there is no &quot;context&quot; file, this stuff is crippled by design."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562399158, "post_id": 56911844, "comment_id": 100367969, "body": "This is practically the first thing you learn in Go. Please take the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Tour</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "edited": false, "score": 0, "creation_date": 1562396988, "post_id": 56911964, "comment_id": 100367666, "body": "I thank you for your answer, I kinda expected google\u2019s example to be runnable outside of their \u201ccloud functions\u201d environment, so I kinda wanted to simply run it locally, however the problem is that in the docs it is not clear where to find the context file or in which library it is defined. one could even say they are telling their customers that everything is easy when in reality there is a lot of hidden code and they are not making it easy for people to access firebase outside of their firebase functions context where the context is a free global variable already defined."}, {"owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "edited": false, "score": 0, "creation_date": 1562397048, "post_id": 56911964, "comment_id": 100367680, "body": "if you open the link you will see the context file is intentionally missing, because google likes go devs to suffer."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "reply_to_user": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "edited": false, "score": 0, "creation_date": 1562397358, "post_id": 56911964, "comment_id": 100367725, "body": "Your comment is valid for any language. Google assumes that you know how to program in a language. Stuff like import statements, packages, etc are the very first items to learn on Go. If Google overloaded their documentation with very beginner stuff, those that know the language would get tired of the repetition. API documentation should show how to use the API, not how to use the language. However, opinions do vary on this matter."}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "edited": false, "score": 2, "creation_date": 1562399907, "post_id": 56911964, "comment_id": 100368083, "body": "@FelipeValdes quite disagree with that. Not just google, every company/organization that provide documentation for their 3rd parties library will always assume that the one who read the doc already know at least &quot;how to speak the language&quot;. learn the basic of go it self before trying to understand the 3rd party"}, {"owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "edited": false, "score": 0, "creation_date": 1562401082, "post_id": 56911964, "comment_id": 100368239, "body": "Ok, I&#39;ll go back to school."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562403371, "post_id": 56911964, "comment_id": 100368604, "body": "Plus, if you use standard tools, the imports will be added automatically for you, so explicitly documenting them is redundant."}], "tags": [], "owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "is_accepted": true, "score": 2, "last_activity_date": 1562432258, "last_edit_date": 1562432258, "creation_date": 1562396623, "answer_id": 56911964, "question_id": 56911844, "link": "https://stackoverflow.com/questions/56911844/how-to-create-a-context-object-in-google-cloud-run-for-firebase/56911964#56911964", "title": "how to create a context object in google cloud run for firebase", "body": "<p>In Go, you need to import packages. For this statement <code>ctx := context.Background()</code> add to the top of your source file <code>import \"context\"</code> or merge with your existing import set.</p>\n\n<p>Like most languages, the more experience you have the more the language makes sense and you just know what to do. Most languages are the same. In C/C++ you have the <code>include</code> statement, C# the <code>using</code> statement, in Python the <code>import</code> statement, etc.</p>\n\n<p>Google has a large package of examples for using Go and Google Cloud Platform:</p>\n\n<p><a href=\"https://github.com/GoogleCloudPlatform/golang-samples/archive/master.zip\" rel=\"nofollow noreferrer\">Google Cloud Examples in Go</a></p>\n\n<p>I wrote an article that documents my 30-day journey to learn Go and Google Cloud Platform.</p>\n\n<p><a href=\"https://www.jhanley.com/google-cloud-and-go-my-journey-to-learn-a-new-language-in-30-days/\" rel=\"nofollow noreferrer\">Google Cloud and Go \u2013 My Journey to Learn a new Language in 30 days</a></p>\n"}, {"tags": [], "owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "is_accepted": false, "score": 1, "last_activity_date": 1562402643, "creation_date": 1562402643, "answer_id": 56912529, "question_id": 56911844, "link": "https://stackoverflow.com/questions/56911844/how-to-create-a-context-object-in-google-cloud-run-for-firebase/56912529#56912529", "title": "how to create a context object in google cloud run for firebase", "body": "<p>Given the plethora of 3 lines of code examples that are hard for beginners, and the lack of complete working examples online, like myself, here is a full working example, which is kinda what I needed when I started this task, I hope this helps anybody in the future.</p>\n\n<pre><code>\npackage main\nimport (\n    \"cloud.google.com/go/firestore\" // https://godoc.org/cloud.google.com/go/firestore\"\n    \"context\"                       // https://blog.golang.org/context\n    firebase \"firebase.google.com/go\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n)\nfunc fail(w http.ResponseWriter, msg string) {\n    fmt.Fprintln(w, \"fail:\"+msg)\n    log.Println(\"fail:\" + msg)\n}\n\n// State example code\ntype State struct {\n    Capital    string  `firestore:\"capital\"`\n    Population float64 `firestore:\"pop\"` // in millions\n}\n\nfunc main() {\n\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        override := make(map[string]interface{})\n\n        ctx := context.Background()\n        client, err := firestore.NewClient(ctx, \"YOURPID\")// set GOOGLE_APPLICATION_CREDENTIALS env var\n        if err != nil {\n            fail(w, err.Error())\n            return\n        }\n\n        states := client.Collection(\"States\")\n        ny := states.Doc(\"NewYork\")\n        wr, err := ny.Create(ctx, State{\n            Capital:    \"Albany\",\n            Population: 19.8,\n        })\n        fmt.Println(wr)\n\n    })\n\n    log.Fatal(http.ListenAndServe(\"0.0.0.0:8082\", nil))\n}\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "is_accepted": false, "score": 2, "last_activity_date": 1562434434, "creation_date": 1562434434, "answer_id": 56916288, "question_id": 56911844, "link": "https://stackoverflow.com/questions/56911844/how-to-create-a-context-object-in-google-cloud-run-for-firebase/56916288#56916288", "title": "how to create a context object in google cloud run for firebase", "body": "<p>You should use <code>r.Context()</code> of http.Request object in the request handler instead of initializing a new detached context like context.Background().</p>\n\n<p>The main purpose of contexts is to propagate them, and in Cloud Run you always process requests, so if you pass the request\u2019s context, it\u2019s the right thing to do.</p>\n\n<p>I think in your case, \u201ccontext\u201d package is not imported. Make sure to use go 1.11+ in your Dockerfile and say:</p>\n\n<pre><code>import \u201ccontext\u201d\n</code></pre>\n"}], "owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 56911964, "answer_count": 3, "score": 0, "last_activity_date": 1562434434, "creation_date": 1562395115, "question_id": 56911844, "link": "https://stackoverflow.com/questions/56911844/how-to-create-a-context-object-in-google-cloud-run-for-firebase", "title": "how to create a context object in google cloud run for firebase", "body": "<p>I'm trying to create a context object, so that I can connect to firestore from cloud run, however, all the examples I find on the net basically say I need a context objects, examples I find online usually look like this:</p>\n\n<pre><code>        ctx := context.Background()\n        client, err := firestore.NewClient(ctx, \"projectID\")\n        if err != nil {\n            fail(w, err.Error())\n            // TODO: Handle error.\n        }\n\n</code></pre>\n\n<p>You can find these examples in places like this one:\n<a href=\"https://godoc.org/cloud.google.com/go/firestore#example-NewClient\" rel=\"nofollow noreferrer\">https://godoc.org/cloud.google.com/go/firestore#example-NewClient</a>\nNowhere in this example is there an explanation of where to find the context object.</p>\n\n<p>so I just get this error:</p>\n\n<pre><code>undefined: context\n</code></pre>\n\n<p>I think the documentation is just too confusing.</p>\n"}, {"tags": ["unit-testing", "go", "mocking", "leveldb"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562399605, "post_id": 56911670, "comment_id": 100368042, "body": "&quot;Mocking out a db just to get test coverage up for a few edge cases seems like a lot of work&quot; -- isn&#39;t that the entire reason mocks exist? Besides, you don&#39;t need to mock <i>the entire db</i>--just the parts your function depends on."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 3, "last_activity_date": 1562397403, "creation_date": 1562397403, "answer_id": 56912029, "question_id": 56911670, "link": "https://stackoverflow.com/questions/56911670/how-to-test-db-errors-in-go/56912029#56912029", "title": "How to test db errors in go?", "body": "<p>Mocking is the general chosen approach for this kind of test, which is why <a href=\"https://github.com/golang/mock\" rel=\"nofollow noreferrer\"><code>golang/mock</code></a>, for instance, has a <strong><code>mockgen</code></strong> command, to <em>generate</em> the test code.</p>\n\n<blockquote>\n  <p><code>mockgen</code> has two modes of operation: source and reflect.</p>\n  \n  <ul>\n  <li><strong>Source</strong> mode generates mock interfaces from a source file.<br>\n  It is enabled by using the <code>-source</code> flag.<br>\n  Other flags that may be useful in this mode are <code>-imports</code> and <code>-aux_files</code>.  </li>\n  </ul>\n  \n  <p>Example:</p>\n\n<pre><code>mockgen -source=foo.go [other options]\n</code></pre>\n  \n  <ul>\n  <li><strong>Reflect</strong> mode generates mock interfaces by building a program\n  that uses reflection to understand interfaces.<br>\n  It is enabled by passing two non-flag arguments: an import path, and a\n  comma-separated list of symbols.  </li>\n  </ul>\n  \n  <p>Example:</p>\n\n<pre><code>mockgen database/sql/driver Conn,Driver\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 1629, "user_id": 297800, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9294a411bf93a16ee1e783255e7aedc5?s=128&d=identicon&r=PG", "display_name": "Andrew Bucknell", "link": "https://stackoverflow.com/users/297800/andrew-bucknell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "accepted_answer_id": 56912029, "answer_count": 1, "score": 2, "last_activity_date": 1562399577, "creation_date": 1562392991, "last_edit_date": 1562399577, "question_id": 56911670, "link": "https://stackoverflow.com/questions/56911670/how-to-test-db-errors-in-go", "title": "How to test db errors in go?", "body": "<p>I am implementing a storer that is backed by leveldb (<a href=\"https://github.com/syndtr/goleveldb\" rel=\"nofollow noreferrer\">https://github.com/syndtr/goleveldb</a>) in go. I am new to go and am trying to figure out how I get test coverage for the condition in the code below where perr != nil. I can test my own errors ok, but I can't figure out how to reliably get the Put method of leveldb to return an error.\nMocking out a db just to get test coverage up for a few edge cases seems like a lot of work for not much reward. Is mocking leveldb my only real choice here? If so what's the recommended mocking framework for go? If there's another way what is it?</p>\n\n<pre><code>    if err == leveldb.ErrNotFound {\n            store.Lock()\n            perr := store.ldb.Put(itob(p.ID), p.ToBytes(), nil)\n            if perr != nil {\n                    store.Unlock()\n                    return &amp;StorerError{\n                            Message: fmt.Sprintf(\"leveldb put error could not create puppy %d : %s\", p.ID, perr),\n                            Code:    501,\n                    }\n            }\n            store.Unlock()\n            return nil\n    }\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code"], "answers": [{"comments": [{"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562417881, "post_id": 56911719, "comment_id": 100371471, "body": "In my env variables I already set. Do you mean I must remove this? @VonC"}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562419537, "post_id": 56911719, "comment_id": 100371854, "body": "On my computer. <code>System Environment Variables</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562420270, "post_id": 56911719, "comment_id": 100372008, "body": "@BerthoJoris OK. You have something in your System Environment Variables. Got it. But what did you set there? A GOPATH? GO111MODULE? Some other variable?"}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562468820, "post_id": 56911719, "comment_id": 100380745, "body": "Hi @Vonc sorry for late response. I only add <code>GOPATH</code>, not <code>GO111MODULE</code>"}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562469829, "post_id": 56911719, "comment_id": 100380863, "body": "I already delete <code>GOPATH</code> in my <code>System Environment Variables</code> but still failed when I press <code>Install All</code> in my VSCode notification"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562471320, "post_id": 56911719, "comment_id": 100381050, "body": "@BerthoJoris Did you relaunch VSCode after deleting GOPATH? The VSCode process inherited from the system environment variables, and modifying them would only work for <i>new</i> processes."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562471357, "post_id": 56911719, "comment_id": 100381058, "body": "@BerthoJoris What version of Go are you using in VSCode? And is GO111MODULE set?"}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562471384, "post_id": 56911719, "comment_id": 100381062, "body": "Yes... I already delete and restart my computer after this. But always the same"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562471575, "post_id": 56911719, "comment_id": 100381089, "body": "@BerthoJoris Do you have <code>&quot;go.toolsGopath&quot;</code> set in your VSCode USer settings?"}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562471645, "post_id": 56911719, "comment_id": 100381097, "body": "go.toolsGopath Not find in my VSCode setting (setting.json)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562471727, "post_id": 56911719, "comment_id": 100381109, "body": "@BerthoJoris Try and set it to a new empty folder: that will be a GOPATH dedicated to your tools (as opposed to your projects which will not use any GOPATH at all). Make sure <code>GO111MODULE</code> is set to the value <code>on</code>."}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562471814, "post_id": 56911719, "comment_id": 100381122, "body": "How to check <code>GO111MODULE</code> setting ON or OFF in my current project? Is that in my computer setting? I mean <code>System Environment Variables</code> or in every project folder?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562472062, "post_id": 56911719, "comment_id": 100381150, "body": "Before launching VSCode, open a CMD terminal and type <code>set GO</code>: if you see <code>GO111MODULE=on</code>, you are good to go."}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562472144, "post_id": 56911719, "comment_id": 100381157, "body": "I found <code>Environment variable GO not defined</code> when I type <code>set GO</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562472257, "post_id": 56911719, "comment_id": 100381165, "body": "@BerthoJoris OK. Try and set it, then launch VSCode, check <code>go.toolsGopath</code> is set and try install all your tools. Only then try and build your project."}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562472387, "post_id": 56911719, "comment_id": 100381181, "body": "How do I do? Try to set what?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 1, "creation_date": 1562472510, "post_id": 56911719, "comment_id": 100381203, "body": "@BerthoJoris I meant: set <code>GO111MODULE</code> to the value <code>on</code> in your Windows System environment variable. Then launch VSCode, and set in your JSonn Users settings <code>go.toolsGopath</code> to a new empty folder, dedicated for tools. Then try and build your project in VSCode, to see if your initial error message still persists."}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562472739, "post_id": 56911719, "comment_id": 100381227, "body": "Ok, I will try it"}, {"owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "edited": false, "score": 0, "creation_date": 1562474635, "post_id": 56911719, "comment_id": 100381437, "body": "Everything went perfectly.. Thanks @VonC"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1562474735, "last_edit_date": 1562474735, "creation_date": 1562393624, "answer_id": 56911719, "question_id": 56911553, "link": "https://stackoverflow.com/questions/56911553/vs-code-always-fail-when-try-to-install-dependencies/56911719#56911719", "title": "VS Code always fail when try to install dependencies", "body": "<p><a href=\"https://github.com/dejavuzhou/felix\" rel=\"nofollow noreferrer\"><code>dejavuzhou/felix</code></a> has a go.momd and go.sum: it depends on <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">go modules</a></p>\n\n<p>So make sure your VScode uses Go 1.11+ and </p>\n\n<ul>\n<li>no <code>GOPATH</code></li>\n<li><code>GO111MODULE</code> set</li>\n</ul>\n\n<p>(see <a href=\"https://github.com/golang/go/wiki/Modules#what-are-some-general-things-i-can-spot-check-if-i-am-seeing-a-problem\" rel=\"nofollow noreferrer\">troubleshooting</a>)</p>\n\n<p>As commented:</p>\n\n<blockquote>\n  <ul>\n  <li>set <code>GO111MODULE</code> to the value on in your Windows System environment variable.</li>\n  <li>Then launch VSCode, and set in your JSon Users settings <code>go.toolsGopath</code> to a new empty folder, dedicated for tools. </li>\n  <li>Then try and build your project in VSCode, to see if your initial error message still persists.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 1223, "user_id": 1201937, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w56Lr.jpg?s=128&g=1", "display_name": "Bertho Joris", "link": "https://stackoverflow.com/users/1201937/bertho-joris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 1, "accepted_answer_id": 56911719, "answer_count": 1, "score": 2, "last_activity_date": 1562474735, "creation_date": 1562391723, "last_edit_date": 1592644375, "question_id": 56911553, "link": "https://stackoverflow.com/questions/56911553/vs-code-always-fail-when-try-to-install-dependencies", "title": "VS Code always fail when try to install dependencies", "body": "<p>I tried using the example from here <a href=\"https://github.com/dejavuzhou/felix\" rel=\"nofollow noreferrer\">https://github.com/dejavuzhou/felix</a></p>\n<p>And I have succeeded create my project from there. My project running well. It's just that when I open a project with VSCode, I always find notifications to download dependencies</p>\n<p><a href=\"https://i.stack.imgur.com/77n7A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/77n7A.jpg\" alt=\"enter image description here\" /></a></p>\n<p>But when I press <code>Install All</code> download always fail to all dependencies.</p>\n<p>Error report from VSCode</p>\n<pre><code>Installing 8 tools at C:\\Users\\berth\\go\\bin\n  gocode\n  go-outline\n  go-symbols\n  guru\n  gorename\n  gocode-gomod\n  goreturns\n  golint\n\nC:\\Users\\berth\\go\\src\\github.com\\berthojoris\\ginbro\\handlers&gt;Finished running tool: C:\\Go\\bin\\go.exe build -i -o C:\\Users\\berth\\AppData\\Local\\Temp\\vscode-go8ZWFLb\\go-code-check github.com\\berthojoris\\ginbro\\handlers\n\nC:\\Users\\berth\\go\\src\\github.com\\berthojoris\\ginbro\\handlers&gt;Finished running tool: C:\\Go\\bin\\go.exe vet ./...\n\nInstalling github.com/mdempsky/gocode FAILED\nInstalling github.com/ramya-rao-a/go-outline FAILED\nInstalling github.com/acroca/go-symbols FAILED\nInstalling golang.org/x/tools/cmd/guru FAILED\nInstalling golang.org/x/tools/cmd/gorename FAILED\nInstalling github.com/stamblerre/gocode FAILED\nInstalling github.com/sqs/goreturns FAILED\nInstalling golang.org/x/lint/golint FAILED\n\n8 tools failed to install.\n\ngocode:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v github.com/mdempsky/gocode\ngithub.com/mdempsky/gocode (download)\n# cd C:\\Users\\berth\\go\\src\\github.com\\mdempsky\\gocode; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage github.com/mdempsky/gocode: exit status 1\ngithub.com/mdempsky/gocode (download)\n# cd C:\\Users\\berth\\go\\src\\github.com\\mdempsky\\gocode; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage github.com/mdempsky/gocode: exit status 1\n\ngo-outline:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v github.com/ramya-rao-a/go-outline\ngithub.com/ramya-rao-a/go-outline (download)\nFetching https://golang.org/x/tools/go/buildutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/buildutil?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/buildutil&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/buildutil?go-get=1\nget &quot;golang.org/x/tools/go/buildutil&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/go/buildutil: exit status 1\ngithub.com/ramya-rao-a/go-outline (download)\nFetching https://golang.org/x/tools/go/buildutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/buildutil?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/buildutil&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/buildutil?go-get=1\nget &quot;golang.org/x/tools/go/buildutil&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/go/buildutil: exit status 1\n\ngo-symbols:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v github.com/acroca/go-symbols\ngithub.com/acroca/go-symbols (download)\nFetching https://golang.org/x/tools/go/buildutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/buildutil?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/buildutil&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/buildutil?go-get=1\nget &quot;golang.org/x/tools/go/buildutil&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/go/buildutil: exit status 1\ngithub.com/acroca/go-symbols (download)\nFetching https://golang.org/x/tools/go/buildutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/buildutil?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/buildutil&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/buildutil?go-get=1\nget &quot;golang.org/x/tools/go/buildutil&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/go/buildutil: exit status 1\n\nguru:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v golang.org/x/tools/cmd/guru\nFetching https://golang.org/x/tools/cmd/guru?go-get=1\nParsing meta tags from https://golang.org/x/tools/cmd/guru?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/cmd/guru&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/cmd/guru?go-get=1\nget &quot;golang.org/x/tools/cmd/guru&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/cmd/guru: exit status 1\nFetching https://golang.org/x/tools/cmd/guru?go-get=1\nParsing meta tags from https://golang.org/x/tools/cmd/guru?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/cmd/guru&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/cmd/guru?go-get=1\nget &quot;golang.org/x/tools/cmd/guru&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/cmd/guru: exit status 1\n\ngorename:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v golang.org/x/tools/cmd/gorename\nFetching https://golang.org/x/tools/cmd/gorename?go-get=1\nParsing meta tags from https://golang.org/x/tools/cmd/gorename?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/cmd/gorename&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/cmd/gorename?go-get=1\nget &quot;golang.org/x/tools/cmd/gorename&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/cmd/gorename: exit status 1\nFetching https://golang.org/x/tools/cmd/gorename?go-get=1\nParsing meta tags from https://golang.org/x/tools/cmd/gorename?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/cmd/gorename&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/cmd/gorename?go-get=1\nget &quot;golang.org/x/tools/cmd/gorename&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/cmd/gorename: exit status 1\n\ngocode-gomod:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v -d github.com/stamblerre/gocode\ngithub.com/stamblerre/gocode (download)\nFetching https://golang.org/x/tools/go/packages?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/packages?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/packages&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/packages?go-get=1\nget &quot;golang.org/x/tools/go/packages&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/go/packages: exit status 1\ngithub.com/stamblerre/gocode (download)\nFetching https://golang.org/x/tools/go/packages?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/packages?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/packages&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/packages?go-get=1\nget &quot;golang.org/x/tools/go/packages&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/go/packages: exit status 1\n\ngoreturns:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v github.com/sqs/goreturns\ngithub.com/sqs/goreturns (download)\nFetching https://golang.org/x/tools/imports?go-get=1\nParsing meta tags from https://golang.org/x/tools/imports?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/imports&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/imports?go-get=1\nget &quot;golang.org/x/tools/imports&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/imports: exit status 1\ngithub.com/sqs/goreturns (download)\nFetching https://golang.org/x/tools/imports?go-get=1\nParsing meta tags from https://golang.org/x/tools/imports?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/imports&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/imports?go-get=1\nget &quot;golang.org/x/tools/imports&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/imports: exit status 1\n\ngolint:\nError: Command failed: C:\\Go\\bin\\go.exe get -u -v golang.org/x/lint/golint\nFetching https://golang.org/x/lint/golint?go-get=1\nParsing meta tags from https://golang.org/x/lint/golint?go-get=1 (status code 200)\nget &quot;golang.org/x/lint/golint&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/lint&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/lint&quot;} at https://golang.org/x/lint/golint?go-get=1\nget &quot;golang.org/x/lint/golint&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/lint?go-get=1\nParsing meta tags from https://golang.org/x/lint?go-get=1 (status code 200)\ngolang.org/x/lint (download)\nFetching https://golang.org/x/lint?go-get=1\nParsing meta tags from https://golang.org/x/lint?go-get=1 (status code 200)\nget &quot;golang.org/x/lint&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/lint&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/lint&quot;} at https://golang.org/x/lint?go-get=1\nFetching https://golang.org/x/tools/go/ast/astutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/ast/astutil?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/ast/astutil&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/ast/astutil?go-get=1\nget &quot;golang.org/x/tools/go/ast/astutil&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/go/ast/astutil: exit status 1\nFetching https://golang.org/x/tools/go/gcexportdata?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/gcexportdata?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/gcexportdata&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/gcexportdata?go-get=1\nget &quot;golang.org/x/tools/go/gcexportdata&quot;: verifying non-authoritative meta tag\npackage golang.org/x/tools/go/gcexportdata: cannot find package &quot;golang.org/x/tools/go/gcexportdata&quot; in any of:\n    c:\\go\\src\\golang.org\\x\\tools\\go\\gcexportdata (from $GOROOT)\n    C:\\Users\\berth\\go\\src\\golang.org\\x\\tools\\go\\gcexportdata (from $GOPATH)\nFetching https://golang.org/x/lint/golint?go-get=1\nParsing meta tags from https://golang.org/x/lint/golint?go-get=1 (status code 200)\nget &quot;golang.org/x/lint/golint&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/lint&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/lint&quot;} at https://golang.org/x/lint/golint?go-get=1\nget &quot;golang.org/x/lint/golint&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/lint?go-get=1\nParsing meta tags from https://golang.org/x/lint?go-get=1 (status code 200)\ngolang.org/x/lint (download)\nFetching https://golang.org/x/lint?go-get=1\nParsing meta tags from https://golang.org/x/lint?go-get=1 (status code 200)\nget &quot;golang.org/x/lint&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/lint&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/lint&quot;} at https://golang.org/x/lint?go-get=1\nFetching https://golang.org/x/tools/go/ast/astutil?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/ast/astutil?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/ast/astutil&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/ast/astutil?go-get=1\nget &quot;golang.org/x/tools/go/ast/astutil&quot;: verifying non-authoritative meta tag\nFetching https://golang.org/x/tools?go-get=1\nParsing meta tags from https://golang.org/x/tools?go-get=1 (status code 200)\ngolang.org/x/tools (download)\n# cd C:\\Users\\berth\\go\\src\\golang.org\\x\\tools; git pull --ff-only\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; master\n\npackage golang.org/x/tools/go/ast/astutil: exit status 1\nFetching https://golang.org/x/tools/go/gcexportdata?go-get=1\nParsing meta tags from https://golang.org/x/tools/go/gcexportdata?go-get=1 (status code 200)\nget &quot;golang.org/x/tools/go/gcexportdata&quot;: found meta tag get.metaImport{Prefix:&quot;golang.org/x/tools&quot;, VCS:&quot;git&quot;, RepoRoot:&quot;https://go.googlesource.com/tools&quot;} at https://golang.org/x/tools/go/gcexportdata?go-get=1\nget &quot;golang.org/x/tools/go/gcexportdata&quot;: verifying non-authoritative meta tag\npackage golang.org/x/tools/go/gcexportdata: cannot find package &quot;golang.org/x/tools/go/gcexportdata&quot; in any of:\n    c:\\go\\src\\golang.org\\x\\tools\\go\\gcexportdata (from $GOROOT)\n    C:\\Users\\berth\\go\\src\\golang.org\\x\\tools\\go\\gcexportdata (from $GOPATH)\n</code></pre>\n<p>How do I fix this problem because I am new to trying Golang.</p>\n<p>Or should I ignore the warning from VSCode?</p>\n<p>Thanks</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1562378814, "post_id": 56910656, "comment_id": 100365665, "body": "What is the purpose of the pipe? Why not copy directly from srcFile to f?"}, {"owner": {"reputation": 1448, "user_id": 2693236, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/af538d108c4d72edfb2d3946b9b71b80?s=128&d=identicon&r=PG&f=1", "display_name": "Martavis P.", "link": "https://stackoverflow.com/users/2693236/martavis-p"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562379132, "post_id": 56910656, "comment_id": 100365694, "body": "I hired someone to do this a while ago and server coding isn&#39;t my strong suit. Would that have anything to do with why the response doesn&#39;t write?"}, {"owner": {"reputation": 733, "user_id": 729900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70de23cfa408edce373604a201e31d58?s=128&d=identicon&r=PG", "display_name": "Kyle", "link": "https://stackoverflow.com/users/729900/kyle"}, "edited": false, "score": 0, "creation_date": 1562379634, "post_id": 56910656, "comment_id": 100365745, "body": "Might not be related, but you&#39;re not handling the error from <code>json.Marshal</code>. Could be a source of bugs in the future.  Also, you may want to change the <code>Printf</code> calls to be <code>logger.Log</code> instead so that all output is consistent and in the same location."}, {"owner": {"reputation": 1448, "user_id": 2693236, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/af538d108c4d72edfb2d3946b9b71b80?s=128&d=identicon&r=PG&f=1", "display_name": "Martavis P.", "link": "https://stackoverflow.com/users/2693236/martavis-p"}, "reply_to_user": {"reputation": 733, "user_id": 729900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70de23cfa408edce373604a201e31d58?s=128&d=identicon&r=PG", "display_name": "Kyle", "link": "https://stackoverflow.com/users/729900/kyle"}, "edited": false, "score": 0, "creation_date": 1562379739, "post_id": 56910656, "comment_id": 100365759, "body": "Ah, right. Thanks @Kyle."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1562380235, "post_id": 56910656, "comment_id": 100365805, "body": "After looking at it some more, the pipe code is probably not the cause of the problem. The pipe is unnecessary as is bunding this code in a defer function call."}, {"owner": {"reputation": 1448, "user_id": 2693236, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/af538d108c4d72edfb2d3946b9b71b80?s=128&d=identicon&r=PG&f=1", "display_name": "Martavis P.", "link": "https://stackoverflow.com/users/2693236/martavis-p"}, "edited": false, "score": 0, "creation_date": 1562380546, "post_id": 56910656, "comment_id": 100365838, "body": "That&#39;s good to know. I&#39;ve had to simplify a lot more of the hire&#39;s code as well. I&#39;m about to update the post in a few minutes as I&#39;m expecting an error to show after the <code>w.Write()</code> call."}], "answers": [{"tags": [], "owner": {"reputation": 1448, "user_id": 2693236, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/af538d108c4d72edfb2d3946b9b71b80?s=128&d=identicon&r=PG&f=1", "display_name": "Martavis P.", "link": "https://stackoverflow.com/users/2693236/martavis-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1562396321, "creation_date": 1562396321, "answer_id": 56911935, "question_id": 56910656, "link": "https://stackoverflow.com/questions/56910656/i-think-my-file-upload-connection-is-closing-why/56911935#56911935", "title": "I think my file upload connection is closing...why?", "body": "<p>I was in the ballpark mentioning timeouts but it turns out this issue had nothing to do with the code. I stumbled upon another <a href=\"https://stackoverflow.com/questions/17690380/golang-http-server-timeout\">SO post</a> that had the same problem but on AWS instead. The problem was a timeout from the load balancer. I used the instructions from <a href=\"https://cloud.google.com/load-balancing/docs/backend-service#timeout-setting\" rel=\"nofollow noreferrer\">Google Cloud's docs</a> to increase the timeout from a default of 30 secs to a couple of hours. To be specific, the timeout setting is a count for how long to wait on the server to send a response to the client.</p>\n"}], "owner": {"reputation": 1448, "user_id": 2693236, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/af538d108c4d72edfb2d3946b9b71b80?s=128&d=identicon&r=PG&f=1", "display_name": "Martavis P.", "link": "https://stackoverflow.com/users/2693236/martavis-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562398517, "creation_date": 1562377824, "last_edit_date": 1562398517, "question_id": 56910656, "link": "https://stackoverflow.com/questions/56910656/i-think-my-file-upload-connection-is-closing-why", "title": "I think my file upload connection is closing...why?", "body": "<p><em>Disclaimer: I'm not sure if the title is my actual problem, but it's the only reason that makes sense for what's below.</em></p>\n\n<p><strong>Scenario</strong></p>\n\n<p>I am uploading large videos to my Golang server. I have an 8GB file that takes roughly 15 minutes locally and works well. However, on my staging server (Google Cloud) this file takes a little over an hour to upload and this is where the problem hits. </p>\n\n<p><strong>Problem</strong></p>\n\n<p>My client is waiting on the file to finish uploading in order to call another API endpoint, but only on the staging server does it fail. So it seems like when my server is looking to write the response, then the connection won't allow it because the client shows a <code>502</code> error and a CORS error, which I know is Chrome's way of saying \"We don't know, check your server\".</p>\n\n<p><strong>Code</strong></p>\n\n<p>Inside my <code>SrcHandler</code> is this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>defer func(begin time.Time) {\n        pr, pw := io.Pipe()\n        defer pw.Close()\n\n        if err := r.ParseMultipartForm(32 &lt;&lt; 20); err != nil {\n            http.Error(w, err.Error(), http.StatusBadRequest)\n            fmt.Printf(\"%v\\n\", err)\n            return\n        }\n\n        srcFile, handler, err := r.FormFile(\"video\")\n        if err != nil {\n            http.Error(w, \"INVALID_FILE\", http.StatusBadRequest)\n            return\n        }\n        defer srcFile.Close()\n\n        // Copy uploaded file to *PipeWriter\n        go func() {\n            defer srcFile.Close()\n            defer pw.Close()\n            io.Copy(pw, srcFile)\n        }()\n\n        // Prep fileName\n        var srcFileName = strings.Replace(handler.Filename, \" \", \"_\", -1)\n        var extension = filepath.Ext(srcFileName)\n        srcFileName = srcFileName[0 : len(srcFileName)-len(extension)]\n\n        // Create temp file to write too\n        f, err := ioutil.TempFile(\"./tmp/pending\", srcFileName+\"_\")\n        if err != nil {\n            log.Fatal(err)\n        }\n        defer f.Close()\n\n        // Copy *PipeReader to temp file\n        io.Copy(f, pr)\n\n        contentType, err := getFileContentType(\"./\" + f.Name())\n        if err != nil {\n            fmt.Printf(\"Content Type Error: %v\\n\", err)\n            return\n        }\n\n        fmt.Printf(\"ContentType = %v\\n \", contentType)\n        if contentType != \"video/x-flv\" &amp;&amp; contentType != \"video/mp4\" &amp;&amp;\n            contentType != \"video/quicktime\" &amp;&amp; contentType != \"video/x-msvideo\" &amp;&amp;\n            contentType != \"video/x-ms-wmv\" &amp;&amp; contentType != \"video/webm\" {\n            http.Error(w, \"INVALID_FILE_TYPE\", http.StatusBadRequest)\n            os.Remove(f.Name())\n            return\n        }\n\n        fmt.Printf(\"Upload path -&gt; %v\\n\", f.Name())\n        upload := UploaderResponse{srcFileName, \"./\" + f.Name()}\n\n        resp, err := json.Marshal(upload)\n        if err != nil {\n            fmt.Printf(\"Error using Marshal %v\\n\", err)\n        }\n\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.WriteHeader(http.StatusOK)\n\n        status, err2 := w.Write(resp)\n        if err2 != nil {\n            fmt.Printf(\"Error when writing response to app %v\\n\", err2)\n        } else {\n            fmt.Printf(\"Status from uploading: %v\\n\", status)\n        }\n\n        _ = u.logger.Log(\"upload.Handler Duration \", time.Since(begin))\n\n    }(time.Now())\n</code></pre>\n\n<p>The code gets down to the last line, <code>u.logger.Log()</code> which actually shows output. So the video is uploaded correctly...only responding to the client fails. Does anyone have ideas?</p>\n\n<p><em>Disclaimer 2: I just found out that <code>w.Write</code> returns an error, so I'm waiting on a file to finish uploading to see if I get an errors logged. Will respond with an update.</em></p>\n\n<h1>Update 1</h1>\n\n<p>I uploaded a new file and the <code>w.Write()</code> call works, returning a <code>91</code> integer. I'm not sure what the issue may be now. Could it be a time-out somewhere I don't know of. FYI, my server read and write timeouts are both 6 hours.</p>\n\n<p>If it helps, here are the logs. It should be easy to follow the code with the outputs:\n<a href=\"https://i.stack.imgur.com/uyvYm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uyvYm.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "reflection", "type-switch"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562377151, "post_id": 56910034, "comment_id": 100365499, "body": "Are you asking how to call one of the registered functions given a value of one of the registered types?  It will be helpful if can give some examples of what switch would look like if written statically.  Part one of the question works with <i>functions</i>. Part two talks about executing a <i>method</i> for a type.  What are these methods?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562399719, "post_id": 56910034, "comment_id": 100368057, "body": "Your Register function is invalid go. But if I understand, why would you use a switch? Just do a map lookup."}], "owner": {"reputation": 31, "user_id": 11746039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_8b9nJ3LUU0/AAAAAAAAAAI/AAAAAAAAACA/_14oH3njG14/photo.jpg?sz=128", "display_name": "Pedro Ramos", "link": "https://stackoverflow.com/users/11746039/pedro-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1562385186, "creation_date": 1562368180, "question_id": 56910034, "link": "https://stackoverflow.com/questions/56910034/is-there-a-way-to-dynamically-add-cases-to-a-golang-type-switch", "title": "Is there a way to dynamically add cases to a golang type switch?", "body": "<p>I have a simple type switch that I need to perform operations according to the type it receives. But I want to add methods to be run according to a certain type dynamically.</p>\n\n<p>I have this method called \"Register\", in which I register a function to be executed for a certain reflect.Type T. These transformations will be stored in a map whose key is the actual type.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>/*Register ...*/\nfunc (bs *BaseStreamer) Register(\n    transform func (in interface{}) interface{},\n    T reflect.Type) {\n\n        _, ok := bs.transformations[T]\n        if ok {\n            log.Printf(\n               \"Warning: Overriding method for type %s\",\n               T.String()\n            )\n        }\n        bs.transformations[T] = transform\n}\n</code></pre>\n\n<p>Now I want to iterate over this map and dynamically add cases to my TypeSwitch, so the right method will be executed for its respective type, and I don't know if this is even possible in go. I tried looking for it in the reflect package, but the only option there seems to do something similar to the select operation. Well, as I'm not dealing with channels here, I really only needed to add cases dynamically to my switch.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>switch item := newItem.(type) {\n\n   // Here I'd like to iterate over my map\n   // and add cases for each pair key, value\n   // (type, function) i have on my map\n\n   default:\n      log.Printf(\"No transformation function registered for any of the types\")\n}\n</code></pre>\n\n<p>Is this even possible in go? Is there something similar to <code>SelectCase</code> from the reflect package?</p>\n"}, {"tags": ["go", "gorilla", "chrome-devtools-protocol"], "comments": [{"owner": {"reputation": 366, "user_id": 326457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee7e6929b3d680c589a590323735f3c8?s=128&d=identicon&r=PG", "display_name": "adiabatic", "link": "https://stackoverflow.com/users/326457/adiabatic"}, "edited": false, "score": 0, "creation_date": 1562381576, "post_id": 56909878, "comment_id": 100365942, "body": "I would have tagged this post &quot;chromedp&quot;, but I don&#39;t have enough rep to do so yet. The tag would apply to posts about using &lt;<a href=\"https://github.com/chromedp/chromedp\" rel=\"nofollow noreferrer\">github.com/chromedp/chromedp</a>&gt;."}], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 326457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee7e6929b3d680c589a590323735f3c8?s=128&d=identicon&r=PG", "display_name": "adiabatic", "link": "https://stackoverflow.com/users/326457/adiabatic"}, "is_accepted": true, "score": 0, "last_activity_date": 1562719285, "creation_date": 1562719285, "answer_id": 56962056, "question_id": 56909878, "link": "https://stackoverflow.com/questions/56909878/chromedp-getting-invalid-csrf-token-errors-puppeteer-and-the-browser-are-ok/56962056#56962056", "title": "chromedp getting invalid CSRF token errors; Puppeteer and the browser are OK", "body": "<p>Turns out, on the second access of the \"Sign up\" page, I had a one-button \"Sign out\" form that <code>chromedp.Submit(\"//button[@type='submit']\")</code> was clicking on. Changing the path to an unambiguous <code>chromedp.Submit(\"//form[@action='/signup/']//button[@type='submit']\")</code> in <code>signUpWithContext</code> fixed my problem of clicking on the submit button of the wrong form.</p>\n"}], "owner": {"reputation": 366, "user_id": 326457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee7e6929b3d680c589a590323735f3c8?s=128&d=identicon&r=PG", "display_name": "adiabatic", "link": "https://stackoverflow.com/users/326457/adiabatic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 56962056, "answer_count": 1, "score": 0, "last_activity_date": 1562719285, "creation_date": 1562366372, "last_edit_date": 1562608116, "question_id": 56909878, "link": "https://stackoverflow.com/questions/56909878/chromedp-getting-invalid-csrf-token-errors-puppeteer-and-the-browser-are-ok", "title": "chromedp getting invalid CSRF token errors; Puppeteer and the browser are OK", "body": "<p>I'm using chromedp to test my Go-based website. While I've managed to do basic login tests with it, I'm getting CSRF errors when I try to sign out of an account that I've just logged in as.</p>\n\n<p>Here's the test function that's getting the CSRF error and its main helper. <code>httpServerURL</code> is the base URL of either the live webserver running or an <code>httptest.Server.URL</code> (I get the same CSRF error either way):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func TestSignupDuplicate(t *testing.T) {\n    ctx, cancel := context.WithTimeout(context.Background(), 3*time.Second)\n    defer cancel()\n    ctx, cancel = chromedp.NewContext(ctx) //   chromedp.WithDebugf(log.Printf),\n\n    defer cancel()\n\n    email := \"doubly.headless@example.com\"\n    password := \"asdfasdf\"\n\n    signUpWithContext(ctx, t, email, password)\n\n    defer func() {\n        if err := userManager.DeleteByEmail(email); err != nil {\n            t.Fatal(err)\n        }\n    }()\n\n    var postSignoutClickLocationGot string\n    postSignoutClickLocationExpected := httpServerURL + \"/\"\n    if err := chromedp.Run(ctx,\n        chromedp.Click(\"//button[@class='sign-out-form__button']\"),\n        chromedp.Sleep(800*time.Millisecond),\n        chromedp.Location(&amp;postSignoutClickLocationGot),\n    ); err != nil {\n        t.Fatal(err)\n    }\n\n    if postSignoutClickLocationGot != postSignoutClickLocationExpected {\n        t.Logf(\"Expected to be redirected to &lt;%s&gt; after signing out, but was here instead: &lt;%s&gt;\",\n            postSignoutClickLocationExpected,\n            postSignoutClickLocationGot,\n        )\n    }\n\n    var location string\n    var html string\n    if err := chromedp.Run(ctx,\n        //chromedp.WaitReady(\"//footer\"),\n        chromedp.Location(&amp;location),\n        chromedp.InnerHTML(\"/html\", &amp;html),\n    ); err != nil {\n        t.Fatalf(\"Had trouble getting debug information: %s\", err)\n    }\n\n    log.Println(location)\n    log.Println(html)\n\n    signUpWithContext(ctx, t, email, password)\n\n    expectedAlertHeading := \"E-mail address already in use\"\n    var gotAlertHeading string\n\n    if err := chromedp.Run(ctx,\n        chromedp.Text(\"//*[@class='alert__heading']\", &amp;gotAlertHeading),\n    ); err != nil {\n        t.Fatalf(\"couldn\u2019t get alert heading: %s\", err)\n    }\n\n    if expectedAlertHeading != gotAlertHeading {\n        t.Fatalf(\"Unexpected alert heading. Want: \u00ab%s\u00bb. Got: \u00ab%s\u00bb\", expectedAlertHeading, gotAlertHeading)\n    }\n}\n\nfunc signUpWithContext(ctx context.Context, t *testing.T, email, password string) {\n    t.Helper()\n\n    if err := chromedp.Run(ctx,\n        chromedp.Navigate(httpServerURL+\"/signup/\"),\n        chromedp.WaitVisible(\"#email\", chromedp.ByID),\n        chromedp.SendKeys(\"#email\", email, chromedp.ByID),\n        chromedp.SendKeys(\"#password\", password, chromedp.ByID),\n        chromedp.Submit(\"//button[@type='submit']\"),\n    ); err != nil {\n        t.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>And here's the output of that:</p>\n\n<pre><code>Running tool: /usr/local/go/bin/go test -timeout 30s example.com/webdictions -run ^(TestSignupDuplicate)$\n\n2019/07/05 15:26:02 http://127.0.0.1:53464/signout/\n2019/07/05 15:26:02 &lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;pre style=\"word-wrap: break-word; white-space: pre-wrap;\"&gt;Forbidden - CSRF token invalid\n&lt;/pre&gt;&lt;/body&gt;\n--- FAIL: TestSignupDuplicate (3.01s)\n    /Users/comatoast/Projects/predictionsweb/main_test.go:150: Expected to be redirected to &lt;http://127.0.0.1:53464/&gt; after signing out, but was here instead: &lt;http://127.0.0.1:53464/signout/&gt;\n    /Users/comatoast/Projects/predictionsweb/main_test.go:177: couldn\u2019t get alert heading: context deadline exceeded\nFAIL\nFAIL    example.com/webdictions 3.073s\n</code></pre>\n\n<p>Oddly enough, a Puppeteer program doesn't error out like this. At its end I don't get any screenshots of CSRF errors, regardless of whether the user already has an account before I start the test:</p>\n\n<pre><code>const puppeteer = require('puppeteer');\n\n(async () =&gt; {\n    const opts = {\n        width: 800,\n        height: 600,\n        deviceScaleFactor: 2,\n    }\n    const browser = await puppeteer.launch({defaultViewport: opts});\n    const page = await browser.newPage();\n    await page.goto('http://www.localhost:3000/');\n    await page.click(\"a[href='/signup/']\");\n    await page.type('#email', \"headless.javascript@example.com\");\n    await page.type('#password', 'asdfasdf');\n    await page.click('[type=\"submit\"]');\n    await page.screenshot({path: '1. should be the dashboard after signup.png'});\n\n    await page.click('.sign-out-form__button');\n    await page.screenshot({path: '2. should be slash.png'});\n\n    await page.click('a[href=\"/signup/\"]')\n    await page.screenshot({path: '3. signup again.png'});\n\n    await page.type('#email', \"headless.javascript@example.com\");\n    await page.type('#password', 'asdfasdf');\n    await page.click('[type=\"submit\"]');\n\n    await page.screenshot({path: '4. after second identical signup attempt.png'});\n\n//    await page.screenshot({path: 'screenshot.png'});\n    await browser.close();\n})();\n</code></pre>\n\n<p>Likewise, when I try to sign up for the same account twice in either Safari or Chrome, I get a normal \"this e-mail address is already in use\" error, not a CSRF error. What, if anything, am I doing incorrectly via chromedp?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1305, "user_id": 2136376, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0eb15e19a4e5bc32d6c08fa36e450557?s=128&d=identicon&r=PG", "display_name": "prichrd", "link": "https://stackoverflow.com/users/2136376/prichrd"}, "edited": false, "score": 0, "creation_date": 1562367079, "post_id": 56909709, "comment_id": 100364265, "body": "These files might be of interest for you: <a href=\"https://github.com/golang/go/blob/master/src/cmd/go/internal/work/build.go\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/cmd/go/internal/work/&hellip;</a> <a href=\"https://github.com/golang/go/blob/master/src/cmd/go/internal/work/action.go\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/cmd/go/internal/work/&hellip;</a>"}, {"owner": {"reputation": 1305, "user_id": 2136376, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0eb15e19a4e5bc32d6c08fa36e450557?s=128&d=identicon&r=PG", "display_name": "prichrd", "link": "https://stackoverflow.com/users/2136376/prichrd"}, "edited": false, "score": 0, "creation_date": 1562367125, "post_id": 56909709, "comment_id": 100364274, "body": "I might be wrong, but I think that <code>go get</code> will refuse to get <code>internal</code> packages."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562405274, "post_id": 56909709, "comment_id": 100368940, "body": "Use the right tool for the job. You are dealing with source code, resulting artifacts, etc. I&#39;d choose a <a href=\"https://concourse-ci.org\" rel=\"nofollow noreferrer\">concourse pipeline</a> for that. Basically, you have a code resource, which gets transpiled to go code, and said go code gets compiled to one or more binaries, which in turn need to be made available."}], "owner": {"reputation": 3239, "user_id": 1478636, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7651e5295fced56136e81d876c5c7c95?s=128&d=identicon&r=PG", "display_name": "Paul Nelson Baker", "link": "https://stackoverflow.com/users/1478636/paul-nelson-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562364747, "creation_date": 1562364747, "question_id": 56909709, "link": "https://stackoverflow.com/questions/56909709/how-can-i-access-execute-go-tools-programmatically", "title": "How can I access/execute Go tools programmatically", "body": "<p>I'm looking to build a tool that builds/compiles additional Go applications. Basically what I want to do is make a compiler for a DSL I'm working on. I can so far transpile my DSL into Go using <a href=\"https://github.com/dave/jennifer\" rel=\"nofollow noreferrer\">jennifer</a>. However, if I want to compile this newly generated application to machine code I still need the Go toolchain installed on the executing machine.</p>\n\n<p>I know the compiler is, itself, written in go. So it should in theory be possible, but after browsing around what looks like the <a href=\"https://github.com/golang/go/blob/master/src/cmd/compile/main.go\" rel=\"nofollow noreferrer\">source</a> I still can't find the actual entry-point for the build subcommand.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562359631, "post_id": 56909038, "comment_id": 100362642, "body": "How are you sure the problem is appending, and not that <code>s</code> , <code>ss</code>, or <code>outString</code> is not what you expect?"}, {"owner": {"reputation": 169, "user_id": 5225507, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2b36e20306d068e0900f7f5d13b03a5?s=128&d=identicon&r=PG&f=1", "display_name": "SO03112", "link": "https://stackoverflow.com/users/5225507/so03112"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562359771, "post_id": 56909038, "comment_id": 100362687, "body": "@Flimzy I can see during fmt.Println(test) that &quot;test&quot; prints each line, so I believe everything up to &quot;ss&quot; is good."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562359845, "post_id": 56909038, "comment_id": 100362705, "body": "The problem is that you&#39;re assigning the result to <code>test</code>, which you then immediately discard."}], "answers": [{"tags": [], "owner": {"reputation": 17034, "user_id": 27512, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/28362320859e0c16e99dcfcabd6e6c6d?s=128&d=identicon&r=PG", "display_name": "kevingessner", "link": "https://stackoverflow.com/users/27512/kevingessner"}, "is_accepted": false, "score": 1, "last_activity_date": 1562359699, "creation_date": 1562359699, "answer_id": 56909083, "question_id": 56909038, "link": "https://stackoverflow.com/questions/56909038/cant-append-slice-to-existing-slice/56909083#56909083", "title": "Can&#39;t append slice to existing slice", "body": "<p><a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\"><code>append</code> isn't guaranteed</a> to modify the slice passed to it, so <code>parsed</code> isn't changed.  Only <code>test</code> contains the elements of <code>ss</code>.  Use the returned value in each iteration:</p>\n\n<pre><code>var parsed []string\nfor scanner.Scan() {\n    s := scanner.Text()\n    ss := strings.Fields(s)\n    parsed = append(parsed, ss...)\n}\nreturn parsed\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 5225507, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2b36e20306d068e0900f7f5d13b03a5?s=128&d=identicon&r=PG&f=1", "display_name": "SO03112", "link": "https://stackoverflow.com/users/5225507/so03112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562359699, "creation_date": 1562359306, "last_edit_date": 1562359486, "question_id": 56909038, "link": "https://stackoverflow.com/questions/56909038/cant-append-slice-to-existing-slice", "title": "Can&#39;t append slice to existing slice", "body": "<p>My goal below is to return a slice of slices, so I can iterate over them later in my main function. </p>\n\n<p>The current behavior is the \"test\" variable will show each line in a slice when I print it at <code>fmt.PrintLn(test)</code>, but the \"parsed\" variable when printed at <code>fmt.PrintLn(showParsed)</code> is empty. How can I resolve that?</p>\n\n<pre><code>func lsCommand(outString string) []string {\n    scanner := bufio.NewScanner(strings.NewReader(outString))\n    var parsed []string\n    for scanner.Scan() {\n        s := scanner.Text()\n        ss := strings.Fields(s)\n        test := append(parsed, ss...)\n        fmt.Println(test)\n    }\n    return parsed\n}\n\nfunc main() {\n    ctx := context.Background()\n    ok, outString, errString := runBashCommandAndKillIfTooSlow(ctx, \"ls\", 2000*time.Millisecond)\n    if ok != true {\n        panic(errString)\n    }\n\n    showParsed := lsCommand(outString)\n    fmt.Println(showParsed)\n}\n</code></pre>\n"}, {"tags": ["python", "go", "type-conversion", "hex"], "comments": [{"owner": {"reputation": 9325, "user_id": 10785975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c668b4905932bb9e8abe4d881e689a36?s=128&d=identicon&r=PG&f=1", "display_name": "Daweo", "link": "https://stackoverflow.com/users/10785975/daweo"}, "edited": false, "score": 3, "creation_date": 1562353980, "post_id": 56908139, "comment_id": 100360955, "body": "What do you tried so far?"}, {"owner": {"reputation": 230, "user_id": 6523220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ab841802106b1cbd162e5d9ce05ad6?s=128&d=identicon&r=PG&f=1", "display_name": "thefett", "link": "https://stackoverflow.com/users/6523220/thefett"}, "edited": false, "score": 2, "creation_date": 1562354386, "post_id": 56908139, "comment_id": 100361092, "body": "I&#39;ve tried the binary.BigEndian.Uint64()  and then also the hex.DecodeString(), but both just give me wrong numbers"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562354738, "post_id": 56908139, "comment_id": 100361195, "body": "Questions seeking coding help <i>must</i> include the current attempt, and explain the current output, and what is expected."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562358858, "post_id": 56908139, "comment_id": 100362427, "body": "Duplicate of <a href=\"https://stackoverflow.com/q/47315683/13860\">stackoverflow.com/q/47315683/13860</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "is_accepted": true, "score": 3, "last_activity_date": 1562389093, "creation_date": 1562389093, "answer_id": 56911345, "question_id": 56908139, "link": "https://stackoverflow.com/questions/56908139/golang-vs-python-hex-string-to-int/56911345#56911345", "title": "Golang vs Python - Hex String to Int", "body": "<p>This is a good question (though similar to another that Flimzy found). The main problem is that the built-in integers only go up to 64 bits in Go but you can use the math/big package.</p>\n\n<pre><code>fmt.Println(new(big.Int).SetString(\"0xd458985bc81e284609dd69267c73b8464e1795d5b91ce6ed8871ecbc5b6ec4d1\", 0))\n</code></pre>\n\n<p>If you don't have a leading 0x then use 16 as the base:</p>\n\n<pre><code>fmt.Println(new(big.Int).SetString(\"d458985bc81e284609dd69267c73b8464e1795d5b91ce6ed8871ecbc5b6ec4d1\", 16))\n</code></pre>\n"}], "owner": {"reputation": 230, "user_id": 6523220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ab841802106b1cbd162e5d9ce05ad6?s=128&d=identicon&r=PG&f=1", "display_name": "thefett", "link": "https://stackoverflow.com/users/6523220/thefett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 56911345, "answer_count": 1, "score": -1, "last_activity_date": 1562389093, "creation_date": 1562353555, "question_id": 56908139, "link": "https://stackoverflow.com/questions/56908139/golang-vs-python-hex-string-to-int", "title": "Golang vs Python - Hex String to Int", "body": "<p>I have a hex string:  </p>\n\n<pre><code>n = \"0xd458985bc81e284609dd69267c73b8464e1795d5b91ce6ed8871ecbc5b6ec4d1\"  \n</code></pre>\n\n<p>that I can convert to an int in python by using:</p>\n\n<pre><code>mynum = int(n,16)\n</code></pre>\n\n<p>and I get the long number: <code>96046857981227695367604088053507399752198003710848334588478940192231467697361</code></p>\n\n<p>Now how would I do this in Golang?</p>\n"}, {"tags": ["go", "gopacket"], "comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1562400622, "post_id": 56907724, "comment_id": 100368172, "body": "It sounds a lot like you&#39;re describing a system where the payload belongs to <code>LayerA</code>, with <code>LayerB</code> and <code>LayerC</code> being optional headers for that layer rather than new levels of encapsulation.  That might just be due to the simplified version of the problem you&#39;ve presented here though."}, {"owner": {"reputation": 115, "user_id": 10067842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63b4748573ae5c1e2e762aba870c019?s=128&d=identicon&r=PG&f=1", "display_name": "anonom", "link": "https://stackoverflow.com/users/10067842/anonom"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1562626960, "post_id": 56907724, "comment_id": 100426913, "body": "Hi @JamesHenstridge, ah yes it makes sense to see them as optional headers! I think it&#39;s the case, since it&#39;s <code>LayerA</code> only that knows about their presence. Thank you, it will simplify the structure!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8202235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405d5f5ba422f628fd2d7aa84827eb05?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Jones", "link": "https://stackoverflow.com/users/8202235/patrick-jones"}, "is_accepted": false, "score": 0, "last_activity_date": 1583402336, "creation_date": 1583402336, "answer_id": 60542606, "question_id": 56907724, "link": "https://stackoverflow.com/questions/56907724/how-to-properly-write-a-custom-layer-when-nextdecoder-depends-on-the-previous-la/60542606#60542606", "title": "How to properly write a custom Layer when NextDecoder depends on the previous layer, not the current one?", "body": "<p>You can do this by declaring the next layer to be an interface, which could support either B or C.  As long as whatever you declare fits as a LayerType, this should work fine.</p>\n"}], "owner": {"reputation": 115, "user_id": 10067842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63b4748573ae5c1e2e762aba870c019?s=128&d=identicon&r=PG&f=1", "display_name": "anonom", "link": "https://stackoverflow.com/users/10067842/anonom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583402336, "creation_date": 1562350894, "question_id": 56907724, "link": "https://stackoverflow.com/questions/56907724/how-to-properly-write-a-custom-layer-when-nextdecoder-depends-on-the-previous-la", "title": "How to properly write a custom Layer when NextDecoder depends on the previous layer, not the current one?", "body": "<p>I am writing custom layer decoders with <em>gopacket</em>.</p>\n\n<p><strong>LayerA</strong> contains a field <code>Type</code> that can be one of the following values:</p>\n\n<ul>\n<li><em>B-only</em>, the next layer is <strong>LayerB</strong>, followed by a raw payload</li>\n<li><em>C-only</em>, the next layer is <strong>LayerC</strong>, followed by a raw payload</li>\n<li><em>B-C</em>, the next layer is <strong>LayerB</strong>, followed by <strong>LayerC</strong> then a raw payload</li>\n</ul>\n\n<p>There is no field in <strong>LayerB</strong> that can be used to know if <strong>LayerC</strong> is the next or not. <strong>LayerB</strong> and <strong>LayerC</strong> decoding does not depend on whenever the other layer is present or not.</p>\n\n<p>What would be the proper way to write the decode function of <strong>LayerA</strong>, since it's the one that knows what are the next layers?</p>\n\n<p>There is not a lot of tutorials about custom layers with <em>gopacket</em>, and this case is not like the basic ones covered there.</p>\n\n<p>It seems the logic should be put in <strong>LayerA</strong> decoding function, just before calling <code>p.NextDecoder</code>.</p>\n\n<p>I thought of two ways to achieve this:</p>\n\n<h1>1. Use a closure</h1>\n\n<p>Add a field <code>nextDecoder Decoder</code> to the struct <strong>LayerB</strong>.\nIn the decoder of <strong>LayerA</strong>, when <code>Type</code> is <em>C-only</em>, simply use the decoder of <strong>LayerC</strong>. Otherwise, create a struct <strong>LayerB</strong> and  fill the field <code>nextDecoder</code> accordingly. Then use this struct in a closure, that will be used as the next decoder.</p>\n\n<h2>Issues</h2>\n\n<p>The decoding logic of <strong>LayerB</strong> would be in the <strong>LayerA</strong> decoding function (see code in Palyground below).\nMoreover, which decoding function to use when registering the <strong>LayerB</strong> with <code>gopacket.RegisterLayer</code>?</p>\n\n<h1>2. Have two separate layers LayerB-C and LayerB-only</h1>\n\n<p><strong>LayerB-C</strong> next decoder would be <code>LayerC</code>'s, <strong>LayerB-only</strong>'s would be just the payload layer.</p>\n\n<h2>Issues</h2>\n\n<p>The decoding function of <strong>LayerB-only</strong> and <strong>LayerB-C</strong> is the same, expect the call the <code>p.NextDecoder</code>.\nSince there is no notion of 'inheritance' in go, I am not sure how to design this to avoid duplication. Maybe create a <strong>LayerB-base</strong> interface with a function <code>nextDecoder() LayerType</code>, and make <strong>LayerB-C</strong> and <strong>LayerB-only</strong> implement it? Or embed a type <strong>LayerB-base</strong> that has a function <code>Decode</code>? But neither of them doesn't feel right.</p>\n\n<h1>Code</h1>\n\n<p>Here is some code for each described way: <a href=\"https://play.golang.org/p/N9ZpYqFb16Q\" rel=\"nofollow noreferrer\">https://play.golang.org/p/N9ZpYqFb16Q</a>. The actual content of the layers are not relevant, except <code>LayerA.Type</code>.</p>\n\n<p>The result of this code is as expected but I would like to know if there is a better or more idiomatic to do it.</p>\n"}, {"tags": ["unit-testing", "go", "mocking", "testify", "gomock"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1562349878, "post_id": 56907401, "comment_id": 100359706, "body": "Yes, it&#39;s possible. Embed the <i>interface</i> type in a struct, and add only the methods that are used. See an example of this here: <a href=\"https://stackoverflow.com/questions/43912124/example-code-for-testing-the-filesystem-in-golang/43914455?r=SearchResults#43914455\">Example code for testing the filesystem in Golang</a>."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 6, "last_activity_date": 1562350045, "creation_date": 1562350045, "answer_id": 56907584, "question_id": 56907401, "link": "https://stackoverflow.com/questions/56907401/how-to-mock-only-one-method-of-an-interface/56907584#56907584", "title": "How to mock only one method of an interface", "body": "<p>First, if your interface has 5 methods, and you're only using one, your interface is too big. Use a smaller interface.</p>\n\n<pre><code>type BigInterface interface {\n    Thing1()\n    Thing2()\n    ThingN()\n}\n\ntype SmallInterface interface {\n    Thing1()\n}\n\nfunc MyFunc(i SmallInterface) { ... }\n</code></pre>\n\n<p>Another option is to create a complete implementation of the full interface, by embedding the full interface. This will panic if you try to access one of the other methods, but will work for testing if you're careful. (But please don't do this in production code!)</p>\n\n<pre><code>type BigInterface interface {\n    Thing1()\n    Thing2()\n    ThingN()\n}\n\ntype myImplementation struct {\n    BigInterface\n}\n\nfunc (i *myImplementation) Thing1() { ... }\n</code></pre>\n\n<p>Now <code>myImplementation</code> satisfies the <code>BigInterface</code> interface, by virtue of containing an embedded instance of <code>BigInterface</code>. If you never set that embedded instance to anything, then calling those methods will panic, but you can still define <code>Thing1</code> to do what you want for your tests.</p>\n"}], "owner": {"reputation": 477, "user_id": 7047456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b50238281fc05d33c8a5b17492cb560?s=128&d=identicon&r=PG&f=1", "display_name": "Mozhi", "link": "https://stackoverflow.com/users/7047456/mozhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 56907584, "answer_count": 1, "score": 1, "last_activity_date": 1562350045, "creation_date": 1562348999, "last_edit_date": 1592644375, "question_id": 56907401, "link": "https://stackoverflow.com/questions/56907401/how-to-mock-only-one-method-of-an-interface", "title": "How to mock only one method of an interface", "body": "<p>I am struggling to understand mocking in Go (am looking for something related to Mockito.spy equivalent of java in Go).</p>\n<p>Let's say I have an interface in Go with 5 methods. But the piece of code that I want to test has references to only two methods. Now how do I mock this dependency without implementing all methods , i.e my actual implementation in source code implements 5 methods of interface , but is there a way to avoid implementing dummy interface implementation of 5 methods in test file. Following is the way am currently doing , implementing 5 methods is manageable but what if the interface has 20 methods , it becomes tedious to mock implement all the methods in test file.</p>\n<h2>Example:</h2>\n<h2>Source code in handler.go:</h2>\n<pre><code>type Client struct {}\ntype ClientStore interface {\n  func(c *Client) methodOne() error {// some implementation}\n  func(c *Client) methodTwo() error {// some implementation}\n  func(c *Client) methodThree() error {// some implementation}\n  func(c *Client) methodFour() error {// some implementation}\n  func(c *Client) methodFive() error {// some implementation}\n}\n</code></pre>\n<h2>Source code in api.go:</h2>\n<pre><code> func processFeed(c Client) error {\n     err := c.methodOne()\n     if(err != null) {\n      return err\n    }\n     err1 := c.methodTwo()\n     if(err1 != null) {\n      return err1\n    }\n }\n</code></pre>\n<h2>Test class code:</h2>\n<pre><code>import &quot;testify/mock&quot;\n\nfunc TestFeed(t *testing.T){\n   mockClient := &amp;MockClient{}\n   err := processFeed(mockClient)\n   assert.NotNil(t , err)\n \n}\n\ntype MockClient struct {\n  mock.Mock\n}\n\n  func(c *MockClient ) methodOne() error {fmt.Printf(&quot;methodOne&quot;);nil}\n  func(c *MockClient ) methodTwo() error {return errors.New(&quot;mocked error&quot;)}\n  func(c *MockClient ) methodThree() error {fmt.Printf(&quot;methodThree&quot;);nil}\n  func(c *MockClient ) methodFour() error {fmt.Printf(&quot;methodFour&quot;);nil}\n  func(c *MockClient ) methodFive() error {fmt.Printf(&quot;methodFive&quot;);nil}\n\n\n</code></pre>\n<h2>Question:</h2>\n<p>Is there a way to mock only what i required in the above case only the methodOne() and methodTwo() methods and not worry about remaining methods in tests ? Can you please suggest any other alternatives if they are present ? Thank you</p>\n"}, {"tags": ["macos", "go", "terminal", "console", "darwin"], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 6819444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289d6360e771afa6d95cb1aad5f5c991?s=128&d=identicon&r=PG&f=1", "display_name": "pornstache", "link": "https://stackoverflow.com/users/6819444/pornstache"}, "edited": false, "score": 1, "creation_date": 1562351987, "post_id": 56907307, "comment_id": 100360370, "body": "yeah I was running in Goland IDE and it wasn&#39;t working, it does work in Terminal though."}], "tags": [], "owner": {"reputation": 561, "user_id": 522915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c96d965519bcb39f42401ff75d807ae?s=128&d=identicon&r=PG", "display_name": "cyang", "link": "https://stackoverflow.com/users/522915/cyang"}, "is_accepted": true, "score": 0, "last_activity_date": 1562348466, "creation_date": 1562348466, "answer_id": 56907307, "question_id": 56907134, "link": "https://stackoverflow.com/questions/56907134/how-to-clear-the-console-in-darwin-mac/56907307#56907307", "title": "How to clear the console in Darwin/Mac", "body": "<p>I'm pretty sure <code>exec.Command(\"clear\")</code> method is working on Mac. I'm running my test program using the command <code>go run ./...</code> in terminal. And tried <code>go build ./...</code> and then run the binary file, both are worked.</p>\n\n<p>Test environment:</p>\n\n<ul>\n<li>Mac(Mojave 10.14.5) </li>\n<li>terminal </li>\n<li>bash: /bin/zsh</li>\n</ul>\n\n<pre><code>cmd := exec.Command(\"clear\")\ncmd.Stdout = os.Stdout\ncmd.Run()\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 6819444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289d6360e771afa6d95cb1aad5f5c991?s=128&d=identicon&r=PG&f=1", "display_name": "pornstache", "link": "https://stackoverflow.com/users/6819444/pornstache"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 56907307, "answer_count": 1, "score": 2, "last_activity_date": 1562348466, "creation_date": 1562347440, "last_edit_date": 1562347566, "question_id": 56907134, "link": "https://stackoverflow.com/questions/56907134/how-to-clear-the-console-in-darwin-mac", "title": "How to clear the console in Darwin/Mac", "body": "<p>Trying to figure out how to clear console with Go in Darwin/Mac OS</p>\n\n<p>I've tried the following methods already:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>cmd := exec.Command(\"clear\")\ncmd.Stdout = os.Stdout\ncmd.Run()\n</code></pre>\n\n<p>As well as goterm lib:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>goterm.Clear()\n</code></pre>\n\n<p>Neither of these work.  There has to be some way to do this, doesn't there?</p>\n"}, {"tags": ["amazon-web-services", "go", "jwt", "amazon-cognito", "jwt-go"], "answers": [{"comments": [{"owner": {"reputation": 660, "user_id": 233153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c0684a3c351fcca52d0d98bc73e285?s=128&d=identicon&r=PG", "display_name": "Jhonghee", "link": "https://stackoverflow.com/users/233153/jhonghee"}, "edited": false, "score": 1, "creation_date": 1592721934, "post_id": 56907478, "comment_id": 110522218, "body": "This doesn&#39;t work anymore since Materialize has been renamed into Raw. Also Raw takes key type."}, {"owner": {"reputation": 311, "user_id": 3315934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e372beba07029914e8a5ee18510eb011?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/3315934/anton"}, "edited": false, "score": 0, "creation_date": 1610274795, "post_id": 56907478, "comment_id": 116075637, "body": "Starting from <code>lestrrat-go&#47;jwx v1.x.y</code>): you can replace <code>return keys[0].Materialize()</code> by: <code>var pubkey interface{}</code>, then <code>err := key[0].Raw(&amp;pubkey)</code> and <code>return pubkey, nil</code>. Ensure you do an error check on the err (return value of the Raw method)"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 7, "last_activity_date": 1617645267, "last_edit_date": 1617645267, "creation_date": 1562349428, "answer_id": 56907478, "question_id": 56905995, "link": "https://stackoverflow.com/questions/56905995/how-to-verify-a-jwt-token-from-aws-cognito-in-go/56907478#56907478", "title": "How to verify a JWT Token from AWS Cognito in Go?", "body": "<p><strong>Public keys for Amazon Cognito</strong></p>\n<p>As you already guessed, you'll need the public key in order to verify the JWT token.</p>\n<p><a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/amazon-cognito-user-pools-using-tokens-verifying-a-jwt.html#amazon-cognito-user-pools-using-tokens-step-2\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/cognito/latest/developerguide/amazon-cognito-user-pools-using-tokens-verifying-a-jwt.html#amazon-cognito-user-pools-using-tokens-step-2</a></p>\n<blockquote>\n<p>Download and store the corresponding public JSON Web Key (JWK) for your user pool. It is available as part of a JSON Web Key Set (JWKS).\nYou can locate it at\nhttps://cognito-idp.{region}.amazonaws.com/{userPoolId}/.well-known/jwks.json</p>\n</blockquote>\n<p><strong>Parse keys and verify token</strong></p>\n<p>That JSON file structure is documented in the web, so you could potentially parse that manually, generate the public keys, etc.</p>\n<p>But it'd probably be easier to just use a library, for example this one:\n<a href=\"https://github.com/lestrrat-go/jwx\" rel=\"nofollow noreferrer\">https://github.com/lestrrat-go/jwx</a></p>\n<p>And then jwt-go to deal with the JWT part: <a href=\"https://github.com/dgrijalva/jwt-go\" rel=\"nofollow noreferrer\">https://github.com/dgrijalva/jwt-go</a></p>\n<p>You can then:</p>\n<ol>\n<li><p>Download and parse the public keys JSON using the first library</p>\n<pre><code> keySet, err := jwk.Fetch(THE_COGNITO_URL_DESCRIBED_ABOVE)\n</code></pre>\n</li>\n<li><p>When parsing the token with jwt-go, use the &quot;kid&quot; field from the JWT header to find the right key to use</p>\n<pre><code> token, err := jwt.Parse(tokenString, func(token *jwt.Token) (interface{}, error) {\n if _, ok := token.Method.(*jwt.SigningMethodRS256); !ok {\n     return nil, fmt.Errorf(&quot;Unexpected signing method: %v&quot;, token.Header[&quot;alg&quot;])\n }\n kid, ok := token.Header[&quot;kid&quot;].(string)\n if !ok {\n     return nil, errors.New(&quot;kid header not found&quot;)\n }\n keys := keySet.LookupKeyID(kid);\n if !ok {\n     return nil, fmt.Errorf(&quot;key with specified kid is not present in jwks&quot;)\n }\n var publickey interface{}\n err = keys.Raw(&amp;publickey)\n if err != nil {\n     return nil, fmt.Errorf(&quot;could not parse pubkey&quot;)\n }\n return publickey, nil\n</code></pre>\n</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 5971023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad27ed2e7c4ecd69725e14046fe31dc?s=128&d=identicon&r=PG", "display_name": "S. Yacko", "link": "https://stackoverflow.com/users/5971023/s-yacko"}, "edited": false, "score": 0, "creation_date": 1594488786, "post_id": 61718113, "comment_id": 111146556, "body": "This worked with the addition of the github.com/lestrrat-go/jwx/jwk package for the keySet.  Thank you."}, {"owner": {"reputation": 712, "user_id": 8868419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a530d27369c9d4f6ecf421fe83d2b4?s=128&d=identicon&r=PG&f=1", "display_name": "Madeo", "link": "https://stackoverflow.com/users/8868419/madeo"}, "edited": false, "score": 0, "creation_date": 1615863306, "post_id": 61718113, "comment_id": 117817687, "body": "not sure I can understand that piece of code. Are you parsing the token two times? Also where does <code>keySet</code> is coming from?"}], "tags": [], "owner": {"reputation": 31, "user_id": 5066591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f932aab8a8395b9defc037ac8c9a713?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Wylder", "link": "https://stackoverflow.com/users/5066591/kevin-wylder"}, "is_accepted": false, "score": 3, "last_activity_date": 1589141827, "last_edit_date": 1589141827, "creation_date": 1589141489, "answer_id": 61718113, "question_id": 56905995, "link": "https://stackoverflow.com/questions/56905995/how-to-verify-a-jwt-token-from-aws-cognito-in-go/61718113#61718113", "title": "How to verify a JWT Token from AWS Cognito in Go?", "body": "<p>eugenioy's answer stopped working for me because of <a href=\"https://github.com/lestrrat-go/jwx/pull/169\" rel=\"nofollow noreferrer\">this refactor</a>. I ended up fixing with something like this</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>token, err := jwt.Parse(tokenString, func(token *jwt.Token) (interface{}, error) {\n    token, err := jwt.Parse(tokenString, func(token *jwt.Token) (interface{}, error) {\n    if _, ok := token.Method.(*jwt.SigningMethodRS256); !ok {\n        return nil, fmt.Errorf(\"Unexpected signing method: %v\", token.Header[\"alg\"])\n    }\n    kid, ok := token.Header[\"kid\"].(string)\n    if !ok {\n        return nil, errors.New(\"kid header not found\")\n    }\n    keys := keySet.LookupKeyID(kid);\n    if len(keys) == 0 {\n         return nil, fmt.Errorf(\"key %v not found\", kid)\n    }\n    // keys[0].Materialize() doesn't exist anymore\n    var raw interface{}\n    return raw, keys[0].Raw(&amp;raw)\n})\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 6058505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0fa421ba0fd010c72905a02da066176?s=128&d=identicon&r=PG&f=1", "display_name": "mulles3008", "link": "https://stackoverflow.com/users/6058505/mulles3008"}, "is_accepted": false, "score": 4, "last_activity_date": 1598869768, "last_edit_date": 1598869768, "creation_date": 1598612492, "answer_id": 63632514, "question_id": 56905995, "link": "https://stackoverflow.com/questions/56905995/how-to-verify-a-jwt-token-from-aws-cognito-in-go/63632514#63632514", "title": "How to verify a JWT Token from AWS Cognito in Go?", "body": "<p>The type assertion in the code provided by eugenioy and Kevin Wydler did not work for me: <code>*jwt.SigningMethodRS256 is not a type</code>.</p>\n<p><code>*jwt.SigningMethodRS256</code> was a type in the initial commit. From the second commit on (back in July 2014) it was abstracted and replaced by a global variable (see <a href=\"https://github.com/dgrijalva/jwt-go/commit/629af62465e3c5e2ab5c5e97d22d4e593ab0a9bc#diff-cc15cd66e8c9e3a7ca06b9a7dc9bdce7\" rel=\"nofollow noreferrer\">here</a>).</p>\n<p>This following code works for me:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>func verify(tokenString string, keySet *jwk.Set) {\n  tkn, err := jwt.Parse(tokenString, func(token *jwt.Token) (interface{}, error) {\n    if token.Method.Alg() != &quot;RSA256&quot; { // jwa.RS256.String() works as well\n      return nil, fmt.Errorf(&quot;Unexpected signing method: %v&quot;, token.Header[&quot;alg&quot;])\n    }\n    kid, ok := token.Header[&quot;kid&quot;].(string)\n    if !ok {\n      return nil, errors.New(&quot;kid header not found&quot;)\n    }\n    keys := keySet.LookupKeyID(kid)\n    if len(keys) == 0 {\n      return nil, fmt.Errorf(&quot;key %v not found&quot;, kid)\n    }\n    var raw interface{}\n    return raw, keys[0].Raw(&amp;raw)\n  })\n}\n</code></pre>\n<p>Using the following dependency versions:</p>\n<pre><code>github.com/dgrijalva/jwt-go/v4 v4.0.0-preview1\ngithub.com/lestrrat-go/jwx v1.0.4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4427, "user_id": 1373465, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/QXmES.jpg?s=128&g=1", "display_name": "Menelaos Kotsollaris", "link": "https://stackoverflow.com/users/1373465/menelaos-kotsollaris"}, "is_accepted": false, "score": 0, "last_activity_date": 1606949320, "last_edit_date": 1606949320, "creation_date": 1606948865, "answer_id": 65117242, "question_id": 56905995, "link": "https://stackoverflow.com/questions/56905995/how-to-verify-a-jwt-token-from-aws-cognito-in-go/65117242#65117242", "title": "How to verify a JWT Token from AWS Cognito in Go?", "body": "<p>This is what worked for me:</p>\n<pre><code>import (\n    &quot;errors&quot;\n    &quot;fmt&quot;\n    &quot;github.com/dgrijalva/jwt-go&quot;\n    &quot;github.com/gin-gonic/gin&quot;\n    &quot;github.com/lestrrat-go/jwx/jwk&quot;\n    &quot;net/http&quot;\n    &quot;os&quot;\n)\n\nfunc verifyToken(token *jwt.Token) (interface{}, error) {\n    // make sure to replace this with your actual URL\n    // https://docs.aws.amazon.com/cognito/latest/developerguide/amazon-cognito-user-pools-using-tokens-verifying-a-jwt.html#amazon-cognito-user-pools-using-tokens-step-2\n    jwksURL := &quot;COGNITO_JWKS_URL&quot; \n    set, err := jwk.FetchHTTP(jwksURL)\n    if err != nil {\n        return nil, err\n    }\n\n    keyID, ok := token.Header[&quot;kid&quot;].(string)\n    if !ok {\n        return nil, errors.New(&quot;expecting JWT header to have string kid&quot;)\n    }\n\n    keys := set.LookupKeyID(keyID)\n    if len(keys) == 0 {\n        return nil, fmt.Errorf(&quot;key %v not found&quot;, keyID)\n    }\n\n    if key := set.LookupKeyID(keyID); len(key) == 1 {\n        return key[0].Materialize()\n    }\n\n    return nil, fmt.Errorf(&quot;unable to find key %q&quot;, keyID)\n}\n</code></pre>\n<p>I am calling it like this (using AWS Lambda <code>gin</code>) in my case. If you are using a different way of managing requests, make sure to replace that with <code>http.Request</code> or any other framework that you might be using:</p>\n<pre><code>func JWTVerify() gin.HandlerFunc {\n    return func(c *gin.Context) {\n        tokenString := c.GetHeader(&quot;AccessToken&quot;)\n        _, err := jwt.Parse(tokenString, verifyToken)\n        if err != nil {\n            c.AbortWithStatus(http.StatusUnauthorized)\n        }\n    }\n}\n</code></pre>\n<p>This is my <code>go.mod</code>:</p>\n<pre><code>module MY_MODULE_NAME\ngo 1.12\n\nrequire (\n    github.com/aws/aws-lambda-go v1.20.0\n    github.com/aws/aws-sdk-go v1.36.0\n    github.com/awslabs/aws-lambda-go-api-proxy v0.9.0\n    github.com/dgrijalva/jwt-go v3.2.0+incompatible\n    github.com/gin-gonic/gin v1.6.3\n    github.com/google/uuid v1.1.2\n    github.com/lestrrat-go/jwx v0.9.2\n    github.com/onsi/ginkgo v1.14.2 // indirect\n    github.com/onsi/gomega v1.10.3 // indirect\n    golang.org/x/xerrors v0.0.0-20200804184101-5ec99f83aff1 // indirect\n)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 501, "user_id": 373499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ys54a.jpg?s=128&g=1", "display_name": "Necro", "link": "https://stackoverflow.com/users/373499/necro"}, "edited": false, "score": 0, "creation_date": 1616564833, "post_id": 65947083, "comment_id": 118038734, "body": "Works for me; some notes: (1) The issuer in AWS must be: <a href=\"https://cognito-idp.us-east-1.amazonaws.com/&lt;userpoolID\" rel=\"nofollow noreferrer\">cognito-idp.us-east-1.amazonaws.com/&lt;userpoolID</a>&gt;, (2) you should use WithClaimValue to validate &quot;token_use&quot; is &quot;id&quot; or &quot;access&quot; as per the previous link, (3) the first token param should be the raw base64-encoded ID token, last (4) if you are using a unit test to validate a real AWS ID token like I did you will fail validation due to expiration of the token if you do not use the WithClock(...) option."}, {"owner": {"reputation": 501, "user_id": 373499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ys54a.jpg?s=128&g=1", "display_name": "Necro", "link": "https://stackoverflow.com/users/373499/necro"}, "edited": false, "score": 0, "creation_date": 1616649429, "post_id": 65947083, "comment_id": 118070330, "body": "Ah, one last note, you must also validate the audience, so use WithAudience. In AWS the audience is the client ID of the app client."}], "tags": [], "owner": {"reputation": 444, "user_id": 9996080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoRKR.jpg?s=128&g=1", "display_name": "James South", "link": "https://stackoverflow.com/users/9996080/james-south"}, "is_accepted": false, "score": 2, "last_activity_date": 1611879232, "creation_date": 1611879232, "answer_id": 65947083, "question_id": 56905995, "link": "https://stackoverflow.com/questions/56905995/how-to-verify-a-jwt-token-from-aws-cognito-in-go/65947083#65947083", "title": "How to verify a JWT Token from AWS Cognito in Go?", "body": "<p>This is what I did with only the latest (<code>v1.0.8</code>) <code>github.com/lestrrat-go/jwx</code>. Note that <code>github.com/dgrijalva/jwt-go</code> does not seem to be maintained anymore and people are forking it to make the updates they need.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    ...\n    &quot;github.com/lestrrat-go/jwx/jwk&quot;\n    &quot;github.com/lestrrat-go/jwx/jwt&quot;\n)\n    ...\n\n    keyset, err := jwk.Fetch(&quot;https://cognito-idp.&quot; + region + &quot;.amazonaws.com/&quot; + userPoolID + &quot;/.well-known/jwks.json&quot;)\n\n    parsedToken, err := jwt.Parse(\n        bytes.NewReader(token), //token is a []byte\n        jwt.WithKeySet(keyset),\n        jwt.WithValidate(true),\n        jwt.WithIssuer(...),\n        jwt.WithClaimValue(&quot;key&quot;, value),\n    )\n\n    //check err as usual\n    //here you can call methods on the parsedToken to get the claim values\n    ...\n\n</code></pre>\n<p><a href=\"https://github.com/lestrrat-go/jwx/blob/master/jwt/token_gen.go#L42\" rel=\"nofollow noreferrer\">Token claim methods</a></p>\n"}], "owner": {"reputation": 727, "user_id": 3365278, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d58c4b6b44306a99fd704477e729acc6?s=128&d=identicon&r=PG", "display_name": "Lewis Lebentz", "link": "https://stackoverflow.com/users/3365278/lewis-lebentz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4029, "favorite_count": 3, "accepted_answer_id": 56907478, "answer_count": 5, "score": 9, "last_activity_date": 1617645267, "creation_date": 1562341335, "last_edit_date": 1588099317, "question_id": 56905995, "link": "https://stackoverflow.com/questions/56905995/how-to-verify-a-jwt-token-from-aws-cognito-in-go", "title": "How to verify a JWT Token from AWS Cognito in Go?", "body": "<p>How can I validate and get info from a JWT received from Amazon Cognito?</p>\n\n<p>I have setup Google authentication in Cognito, and set the redirect uri to to hit API Gateway, I then receive a code which I POST to this endpoint:</p>\n\n<p><a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/token-endpoint.html\" rel=\"noreferrer\">https://docs.aws.amazon.com/cognito/latest/developerguide/token-endpoint.html</a></p>\n\n<p>To receive the JWT token, in a RS256 format. I am now struggling to validate, and parse the token in Golang. I\u2019ve tried to parse it using jwt-go, but it appears to support HMAC instead by default and read somewhere that they recommend using frontend validation instead. I tried a few other packages and had similar problems.</p>\n\n<p>I came across this answer here: <a href=\"https://stackoverflow.com/questions/41077953/go-language-and-verify-jwt\">Go Language and Verify JWT</a> but assume the code is outdated as that just says <code>panic: unable to find key</code>.</p>\n\n<p>jwt.io can easily decode the key, and probably verify too. I\u2019m not sure where the public/secret keys are as Amazon generated the token, but from what I understand I need to use a JWK URL to validate too? I\u2019ve found a few AWS specific solutions, but they all seem to be hundreds of lines long. Surely it isn\u2019t that complicated in Golang is it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1562341145, "post_id": 56905929, "comment_id": 100356527, "body": "Return <code>(*A, error)</code> from the function."}, {"owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 3, "creation_date": 1562341269, "post_id": 56905929, "comment_id": 100356589, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34774615/should-a-constructor-function-return-an-error-or-a-null-value\" title=\"should a constructor function return an error or a null value\">stackoverflow.com/questions/34774615/&hellip;</a>"}, {"owner": {"reputation": 6899, "user_id": 143225, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7cda9bd33304b647bb27408979d34c8b?s=128&d=identicon&r=PG", "display_name": "Brenden", "link": "https://stackoverflow.com/users/143225/brenden"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1562341955, "post_id": 56905929, "comment_id": 100356888, "body": "@CeriseLim&#243;n I edited my question to clarify. I would like to consider the options based on real world experiences. Returning an error is one option, but it may complicate the calling code."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1562344498, "post_id": 56905929, "comment_id": 100357861, "body": "2 is unclear - I&#39;m not sure how you would &quot;not allow potentially invalid constructor params&quot;. 3 is unidiomatic Go; 1 would be the correct way to indicate an error occurred, and would actually let the caller know what the error was instead of just &quot;something went wrong no object for you&quot;."}, {"owner": {"reputation": 6899, "user_id": 143225, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7cda9bd33304b647bb27408979d34c8b?s=128&d=identicon&r=PG", "display_name": "Brenden", "link": "https://stackoverflow.com/users/143225/brenden"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562344533, "post_id": 56905929, "comment_id": 100357873, "body": "@Adrian see my answer below"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1562344793, "post_id": 56905929, "comment_id": 100357953, "body": "I just read the answer and my comment would be the same - it&#39;s unclear what 2 (or the related 3 in your answer, not present in your question) means and 3 (in the question - 4 in your answer) is a poor choice for the reasons I gave above."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562345750, "post_id": 56905929, "comment_id": 100358288, "body": "&quot;I&#39;d like to discuss alternatives&quot; This isn&#39;t the proper forum for discussions like that. Questions with objective answers are more appropriate here."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562345821, "post_id": 56905929, "comment_id": 100358319, "body": "The proper approach depends entirely on your use case. There&#39;s no general answer possible."}, {"owner": {"reputation": 6899, "user_id": 143225, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7cda9bd33304b647bb27408979d34c8b?s=128&d=identicon&r=PG", "display_name": "Brenden", "link": "https://stackoverflow.com/users/143225/brenden"}, "edited": false, "score": 0, "creation_date": 1562352058, "post_id": 56905929, "comment_id": 100360400, "body": "To be fair, you could rate each option objectively with clearly defined criteria. That&#39;s what I tried to do in my answer. Objectively consider the pros and cons and decide on the most ideal option. PS - I understand this isn&#39;t a forum, which is why I&#39;ve tried to structure the conversation as a question with a possible answer."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562345950, "post_id": 56906554, "comment_id": 100358373, "body": "Your discussion of #1 is the only that I think makes any sense. #2 is just type safety--no constructor needed. #3 is pure evil. #4 is almost always evil. It probably only ever makes sense if a <code>nil</code> value makes sense in its own right. But then it becomes #3, so still evil."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1562346526, "post_id": 56906554, "comment_id": 100358581, "body": "Realistically, I think you have 3 options: 1) Return an error. 2) Refactor so no error is possible. 3) If applicable, defer the error until a later function is called."}, {"owner": {"reputation": 6899, "user_id": 143225, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7cda9bd33304b647bb27408979d34c8b?s=128&d=identicon&r=PG", "display_name": "Brenden", "link": "https://stackoverflow.com/users/143225/brenden"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1562351858, "post_id": 56906554, "comment_id": 100360332, "body": "I agree that #4 is least ideal. I&#39;ll edit my answer with your clarification on #3."}], "tags": [], "owner": {"reputation": 6899, "user_id": 143225, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7cda9bd33304b647bb27408979d34c8b?s=128&d=identicon&r=PG", "display_name": "Brenden", "link": "https://stackoverflow.com/users/143225/brenden"}, "is_accepted": false, "score": -2, "last_activity_date": 1562351931, "last_edit_date": 1562351931, "creation_date": 1562344160, "answer_id": 56906554, "question_id": 56905929, "link": "https://stackoverflow.com/questions/56905929/best-practice-for-handling-error-in-structs-new/56906554#56906554", "title": "Best practice for handling error in struct&#39;s `New()`", "body": "<p>Based on the votes/comments I'm seeing, I'll answer this myself and close. If anyone would like to refine my answer, please comment.</p>\n\n<h1>1) Return an error in the constructor</h1>\n\n<h2>Pros</h2>\n\n<ul>\n<li>Allows calling code to deal with less logic itself</li>\n</ul>\n\n<h2>Cons</h2>\n\n<ul>\n<li>Disallows calling code to do inline assignment since it returns multiple params.</li>\n</ul>\n\n<h1>2) Don't allow potentially invalid constructor params</h1>\n\n<p>For example, don't accept a string date which needs to be parsed into a <code>time.Time</code>. Instead, require an instance of <code>time.Time</code> as a param.</p>\n\n<h2>Pros</h2>\n\n<ul>\n<li>Allows calling code to do inline assignments</li>\n<li>Enables sane defaults</li>\n</ul>\n\n<h2>Cons</h2>\n\n<ul>\n<li>Makes the constructor func less convenient compared to a composite literal</li>\n<li>Could require additional separate convenience methods for the struct</li>\n<li>Requires calling code to handle more logic</li>\n</ul>\n\n<h1>3) Allow potentially invalid constructor params and use sane defaults in their place</h1>\n\n<p>\"defer the error until a later function is called\"</p>\n\n<h2>Pros</h2>\n\n<ul>\n<li>Allows calling code to do inline assignments</li>\n</ul>\n\n<h2>Cons</h2>\n\n<ul>\n<li>Difficult to know if the desired params were accepted</li>\n</ul>\n\n<h1>4) Return a nil struct instance on error</h1>\n\n<p>This is possible, but just not a good idea. Some would say evil even.</p>\n\n<h2>Pros</h2>\n\n<ul>\n<li>Allows inline assignments</li>\n<li>Allows calling code to be simpler/naive</li>\n</ul>\n\n<h2>Cons</h2>\n\n<ul>\n<li>Not typical (ie. idiomatic) of Go code</li>\n<li>Hides the cause</li>\n<li>Allows calling code to be naive</li>\n</ul>\n"}], "owner": {"reputation": 6899, "user_id": 143225, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7cda9bd33304b647bb27408979d34c8b?s=128&d=identicon&r=PG", "display_name": "Brenden", "link": "https://stackoverflow.com/users/143225/brenden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1562352343, "creation_date": 1562341028, "last_edit_date": 1562352343, "question_id": 56905929, "link": "https://stackoverflow.com/questions/56905929/best-practice-for-handling-error-in-structs-new", "title": "Best practice for handling error in struct&#39;s `New()`", "body": "<p>Given:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type A struct{}\n\nfunc New() *A {\n  return &amp;A{}\n}\n</code></pre>\n\n<p>What is the best practice-based recommendation for handling an error that occurs during construction?</p>\n\n<p>A real world scenario is constructing a <code>time.Time</code> for a specific <code>time.Location</code> based on some <code>location string</code> that may not be valid.</p>\n\n<p>EDIT:</p>\n\n<p>This is more than \"should a constructor func return an error\". I'd like to discuss alternatives.</p>\n\n<p>For example, if it doesn't return an error, perhaps we don't allow values to be passed into the constructor that could result in an error.</p>\n\n<p>I'd like to consider the merit to different approaches.</p>\n\n<p>EDIT 2:</p>\n\n<p>Possible approaches:</p>\n\n<ol>\n<li>return an error in the constructor</li>\n<li>only return a valid struct and don't allow potentially invalid constructor params</li>\n<li>return a nil struct instance on error</li>\n</ol>\n\n<p>EDIT 3:</p>\n\n<p>Rating Criteria</p>\n\n<ol>\n<li>Lines of calling code</li>\n<li>Lines of own code </li>\n<li>Level of ambiguity</li>\n</ol>\n"}, {"tags": ["go", "go-modules"], "answers": [{"tags": [], "owner": {"reputation": 4173, "user_id": 1199408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/5HJv7.jpg?s=128&g=1", "display_name": "georgeok", "link": "https://stackoverflow.com/users/1199408/georgeok"}, "is_accepted": true, "score": 4, "last_activity_date": 1598544080, "last_edit_date": 1598544080, "creation_date": 1562331439, "answer_id": 56903542, "question_id": 56902369, "link": "https://stackoverflow.com/questions/56902369/are-there-conventions-for-go-module-names-in-mono-repos-with-multiple-modules/56903542#56903542", "title": "Are there conventions for Go module names in mono-repos with multiple modules?", "body": "<p>There isn't any hard requirement for referencing modules, although it always good practice to use the domain/repo pattern. So, if you want to reference other modules locally that are not in the GOPATH, you can use the <code>replace</code> directive.</p>\n<p><a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive</a></p>\n<blockquote>\n<p>replace also can be used to inform the go tooling of the relative or absolute on-&gt;disk location of modules in a multi-module project, such as:</p>\n<p>replace example.com/project/foo =&gt; ../foo</p>\n</blockquote>\n<p>Let's say we have the following structure:</p>\n<pre><code>\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 pkg1\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 go.mod\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u2514\u2500\u2500 pkg2\n    \u251c\u2500\u2500 go.mod\n    \u2514\u2500\u2500 utils.go\n</code></pre>\n<p>pkg1/main.go</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;local/pkg2&quot;\n)\n\nfunc main() {\n    fmt.Println(pkg2.Add(1, 2))\n\n}\n</code></pre>\n<p>pkg1/go.mod</p>\n<pre><code>module local/pkg1\n\ngo 1.12\n\nrequire local/pkg2 v0.0.0\n\nreplace local/pkg2 =&gt; ../pkg2\n</code></pre>\n<p>pkg2/utils.go</p>\n<pre><code>package pkg2\n\nfunc Add(a, b int) int {\n    return a + b\n}\n</code></pre>\n<p>pkg2/go.mod</p>\n<pre><code>module local/pkg2\n\ngo 1.12\n</code></pre>\n<p>Running:</p>\n<pre><code>cd pkg1\ngo run main.go\n</code></pre>\n<p>You get:</p>\n<blockquote>\n<p>3</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2653, "user_id": 11210494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f24d82ad87e7e92592ede8c31c52748e?s=128&d=identicon&r=PG&f=1", "display_name": "typical182", "link": "https://stackoverflow.com/users/11210494/typical182"}, "is_accepted": false, "score": 0, "last_activity_date": 1564771815, "creation_date": 1564771815, "answer_id": 57332008, "question_id": 56902369, "link": "https://stackoverflow.com/questions/56902369/are-there-conventions-for-go-module-names-in-mono-repos-with-multiple-modules/57332008#57332008", "title": "Are there conventions for Go module names in mono-repos with multiple modules?", "body": "<p>If you want to be able to <code>go get</code> a module, it should follow the <code>&lt;host&gt;/repo/path/within/repo</code> pattern.</p>\n\n<p>However, I would suggest stepping back and asking if you really do want a multi-module repo. It adds substantial complexity, it is hard to get right, and usually means more work on an on-going basis.</p>\n\n<p>Russ Cox commented in <a href=\"https://github.com/golang/go/issues/26664#issuecomment-455232444\" rel=\"nofollow noreferrer\">#26664</a>:</p>\n\n<blockquote>\n  <p>For all but power users, you probably want to adopt the usual convention that one repo = one module. It's important for long-term evolution of code storage options that a repo <em>can</em> contain multiple modules, but it's almost certainly not something you want to do by default.</p>\n</blockquote>\n\n<p>For more details, see <a href=\"https://stackoverflow.com/a/57314494/11210494\">\"Organize local code in packages using Go modules\"</a>.</p>\n"}], "owner": {"reputation": 43, "user_id": 7098660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BGUd2FLWT6k/AAAAAAAAAAI/AAAAAAAAAEw/L2sjnBFLmMM/photo.jpg?sz=128", "display_name": "Alan Cham", "link": "https://stackoverflow.com/users/7098660/alan-cham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2827, "favorite_count": 1, "accepted_answer_id": 56903542, "answer_count": 2, "score": 4, "last_activity_date": 1598544080, "creation_date": 1562326764, "last_edit_date": 1562334572, "question_id": 56902369, "link": "https://stackoverflow.com/questions/56902369/are-there-conventions-for-go-module-names-in-mono-repos-with-multiple-modules", "title": "Are there conventions for Go module names in mono-repos with multiple modules?", "body": "<p>In a multi-module repository, should a module name (set via the go.mod <code>module</code> directive) follow the conventions of package naming?</p>\n\n<p>E.g. <code>module github.com/org-name/repo-name/path/to/module-dir</code></p>\n\n<p>I understand that, whatever the module is named, the packages within the module refer to each other using the module name as prefix. But, from outside the module, there seems to problems if the module name is set to something other than the <code>&lt;host&gt;&lt;path-within-repo&gt;</code> pattern. <code>get</code>-ing a package included in the module then gives messages about <code>unrecognized import path</code>. </p>\n\n<p>Is there any cause to name a module differently than <code>&lt;host&gt;&lt;path-within-repo&gt;</code> ?</p>\n"}]