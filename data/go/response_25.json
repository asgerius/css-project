[{"tags": ["parameters", "go", "reference"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1435783174, "post_id": 31170368, "comment_id": 50350179, "body": "You&#39;re confusing the slice descriptor with the underlying array. There are no reference types in Go. You have values, you have pointers. A pointer is a &#39;reference&#39;. And I don&#39;t know what your code sample is doing but  that certainly isn&#39;t necessary. A worthwhile read <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1435783610, "post_id": 31170368, "comment_id": 50350405, "body": "@evanmcdonnal: no, that requires a pointer, because an append may allocate a new array, changing the internal data pointer, as well and the len and cap values. <a href=\"http://play.golang.org/p/Cm8AQXpK5J\" rel=\"nofollow noreferrer\">play.golang.org/p/Cm8AQXpK5J</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435784084, "post_id": 31170368, "comment_id": 50350659, "body": "@JimB yeah I noticed that while tinkering with it in playground. That necessity is caused by the silly design though. Just define the method with a receiver and return type of <code>Stack</code> and do <code>myStack = myStack.Push(x)</code>. Or better yet, define none of this because it is all just a waste of your systems RAM. Like the only reason it acts that way is because append is made to handle the slice descriptor as a value, returning a new one after the action completes. Then he does something inconsistent in making his type which is nothing more than a slice chain the method using a pointer."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1435784279, "post_id": 31170368, "comment_id": 50350780, "body": "@evanmcdonnal: there&#39;s perfectly good reasons to use custom types like this. Look at <code>container&#47;heap</code>in the stdlib for example, or the <code>sort</code> package (which shows where you <i>don&#39;t</i> need pointers). There&#39;s many more examples of just using custom types like this throughout the stdlib, including map and func types too."}, {"owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1435784491, "post_id": 31170368, "comment_id": 50350902, "body": "@evanmcdonnal By the way, the example is from <a href=\"https://rads.stackoverflow.com/amzn/click/com/0321774639\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">amazon.com/Programming-Go-Creating-Applications-Developers/d&zwnj;&#8203;p/&hellip;</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435784745, "post_id": 31170368, "comment_id": 50351058, "body": "@JimB True, not saying custom types are useless, just the particular example. However, if you&#39;re going make a custom type which is nothing more than a slice I would keep things consistent and define the methods for that type with a value receiver, not a pointer, just saying."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1435785001, "post_id": 31170368, "comment_id": 50351204, "body": "@evanmcdonnal: though it&#39;s named &quot;stack&quot;,  this example is basically taken directly from the heap package, which <i>requires</i> a pointer receiver to fulfill heap.Interface."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435785622, "post_id": 31170368, "comment_id": 50351530, "body": "@JimB that&#39;s fine, you&#39;re not going to convince me it&#39;s a good design by proving that someone at Google was stupid enough to put it in the standard library. All that abstraction does is leak and slow down application performance."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1435787419, "post_id": 31170368, "comment_id": 50352323, "body": "There are no reference types in Go. E.g. a slice is not a reference type and a chanel also is not a reference type. The closest type in Go to resemble reference types are maps. Stop using &quot;reference type&quot; really helps: There are no."}, {"owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1435790086, "post_id": 31170368, "comment_id": 50353286, "body": "@Volker The first line was a citation from the book I mentioned earlier in the comments, which happens to be my first &quot;formal&quot; source of information about the language, so I stick to the terminology used there. The Go Specification indeed mentions Boolean types, Numeric types, String types, Array types, Slice types, Struct types, Pointer types, Function types, Interface types, Map types and Channel types."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1435791522, "post_id": 31170368, "comment_id": 50353765, "body": "Yeah that goes beyond this question or anything but the use of &#39;reference types&#39; as if they&#39;re any different than any other value has become a big pet peeve of mine. In every language everything is a value, period. That value could be a memory address, but it is fundamentally the same as any other value even if I can &#39;dereference&#39; it to access some other value. It doesn&#39;t make it any less of a value, just one which that operation is defined for. No one acts like ints are special because <code>+</code> is defined for them but not other types..."}, {"owner": {"reputation": 1973, "user_id": 484050, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/75870a83d2863117631cd690335d473d?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/484050/mike"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1610620107, "post_id": 31170368, "comment_id": 116192256, "body": "@evanmcdonnal Could you please take a look at this question <a href=\"https://stackoverflow.com/questions/65717235/how-reference-types-are-called-in-go-in-general\" title=\"how reference types are called in go in general\">stackoverflow.com/questions/65717235/&hellip;</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1435835571, "post_id": 31171339, "comment_id": 50371374, "body": "You do not necessarily have to synchronise modifications to pointers to chans. If the modifications happen only by a single goroutine, synchronisation is not needed (just like with all pointers)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1435846399, "post_id": 31171339, "comment_id": 50379247, "body": "@rightfold: well, nothing needs to be synchronized if there&#39;s only access in one goroutine, but even if the value is only <i>modified</i> in a single goroutine, unsynchronized concurrent reads of that value are still a race condition. Though, that condition is the same as a shared chan value in the same scope. I&#39;ll remove the phrasing as it&#39;s probably more confusing than helpful."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 10, "last_activity_date": 1435846470, "last_edit_date": 1435846470, "creation_date": 1435783511, "answer_id": 31171339, "question_id": 31170368, "link": "https://stackoverflow.com/questions/31170368/go-reference-types-as-arguments/31171339#31171339", "title": "Go: reference types as arguments", "body": "<p>The rules are fairly easy when you think of everything as a value, where some values contain pointers internally.</p>\n\n<ul>\n<li><strong>slices</strong>: Use a pointer when you may need to modify the length or capacity, which changes the value of the slice.</li>\n<li><strong>maps</strong>: Don't use a pointer, since the map value doesn't change with modifications.</li>\n<li><strong>functions and methods</strong>: Don't use a pointer, the same effect is had through function values. </li>\n<li><strong>chan</strong>: Don't use a pointer.  </li>\n</ul>\n\n<p>There are of course exceptions, like if you want to be able to swap out a map entirely you would need to use pointer to do so, but these are rare cases. </p>\n"}, {"comments": [{"owner": {"reputation": 1973, "user_id": 484050, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/75870a83d2863117631cd690335d473d?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/484050/mike"}, "edited": false, "score": 0, "creation_date": 1610620191, "post_id": 31173039, "comment_id": 116192306, "body": "While it is a good answer, it should not begin with &quot;There isn&#39;t really a dichotomy between &quot;value types&quot; and &quot;reference types&quot;&quot;. There <i>is</i> a <i>difference</i> between value types such as structs that involve copying contents when passed as function parameter and types such as maps, for example, which don&#39;t involve copying contents of a map that is passed as function parameter. Whether or not &quot;difference&quot; is sufficiently weaker than &quot;dichotomy&quot; that allows to state &quot;absence of dichotomy&quot; while there&#39;s clearly &quot;presence of difference&quot; is debatable and confusing."}], "tags": [], "owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "is_accepted": false, "score": 3, "last_activity_date": 1435791530, "creation_date": 1435791530, "answer_id": 31173039, "question_id": 31170368, "link": "https://stackoverflow.com/questions/31170368/go-reference-types-as-arguments/31173039#31173039", "title": "Go: reference types as arguments", "body": "<p>There isn't really a dichotomy between \"value types\" and \"reference types\". \"Reference type\" is just used to describe a value type whose \"value\" consists wholly of a single pointer.</p>\n\n<p>This is true for map and channel types, which are basically pointer types to an internal structure. But this is not completely true for slices, because a slice is a composite type (basically a struct), consisting of two integer values (length &amp; capacity) and a pointer (to the elements). So it is a \"reference type\" with respect to the elements, which are accessed through the pointer, but it is a \"value type\" with respect to the length and capacity.</p>\n\n<p>Appending to a slice operates on its length and potentially capacity, so it needs to change the \"value\" of the slice, whereas assigning to elements in place just uses the pointer, and thus does not need to change the \"value\" of the slice. You might also need to change the \"value\" of a slice if you want it to change the pointer to point to the same as another slice (which you would do by assigning to the slice).</p>\n\n<p>It's similar for the \"reference types\", maps and channels. Changing the \"contents\" of the map or channel (which is in the stuff pointed to by the pointer) doesn't require changing the \"value\" of the map or channel. But if you wanted to change the pointer to point to a different underlying map or channel, then you would change the \"value\" of the map or channel variable.</p>\n"}], "owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4607, "favorite_count": 1, "accepted_answer_id": 31171339, "answer_count": 2, "score": 7, "last_activity_date": 1435846470, "creation_date": 1435780040, "question_id": 31170368, "link": "https://stackoverflow.com/questions/31170368/go-reference-types-as-arguments", "title": "Go: reference types as arguments", "body": "<p>Certain types in Go are reference types: maps, slices, channels, functions, and methods.</p>\n\n<p>Sometimes you need to use pointers to references. For example,</p>\n\n<pre><code>type Stack []interface{}\nfunc (stack *Stack) Push(x interface{}) { \n    *stack = append(*stack, x)\n}\n</code></pre>\n\n<p>You need it because all arguments are passed by copying the value, and <code>append()</code> might need to reallocate memory in the slice's capacity is not big enough. I get that.</p>\n\n<p><strong>First question.</strong> How about <code>map</code> types? If I have a custom type based on a <code>map</code>, should I better <em>always</em> pass a pointer to it if some key:value insertions or deletions are expected?</p>\n\n<p><strong>Second question.</strong> What about other reference types? <code>Channel</code>, for example. I can imagine a situation where I build a custom type based on a channel to implement some custom pre-processing for the values being passed to a channel. Pointers needed here too?</p>\n\n<p>Sorry if this is basic as heck, but I really want to get a good grasp of the subject.</p>\n"}, {"tags": ["go", "stack-trace", "embedding"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1435773563, "last_edit_date": 1435773563, "creation_date": 1435773124, "answer_id": 31168349, "question_id": 31168199, "link": "https://stackoverflow.com/questions/31168199/create-custom-error-with-stack-trace/31168349#31168349", "title": "Create custom error with stack trace", "body": "<p>Why not just name this inner error with something appropriate like <code>inner-error</code> or <code>stack-trace</code>?</p>\n\n<pre><code>type HttpError struct {\n  status int\n  StackTace *errors.Error\n}\n</code></pre>\n\n<p>Seems to be fairly common practice in classes used for error handling in other languages/frameworks like .NET and Java.</p>\n\n<p>Another option would be to concatenate your custom message with the inner error using <code>fmt.Sprintf</code> at the time you create the error, keeping it all as one. </p>\n\n<p><code>errors.New(fmt.Sprintf(\"This proprietary error happened! Stack trace: %s\", message))</code>;</p>\n\n<p>If you did that you wouldn't implement <code>func (h *HttpError) Error()</code> since you'd be relying on the embedded error for this.</p>\n"}], "owner": {"reputation": 7973, "user_id": 177633, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ea201f6c54b6b00fb1d44aed31670d5a?s=128&d=identicon&r=PG", "display_name": "theazureshadow", "link": "https://stackoverflow.com/users/177633/theazureshadow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 1, "accepted_answer_id": 31168349, "answer_count": 1, "score": 2, "last_activity_date": 1435773563, "creation_date": 1435772653, "question_id": 31168199, "link": "https://stackoverflow.com/questions/31168199/create-custom-error-with-stack-trace", "title": "Create custom error with stack trace", "body": "<p>I'm trying to use <a href=\"https://godoc.org/github.com/go-errors/errors\" rel=\"nofollow\">go-errors</a> to include stack traces with errors I generate. I have a custom <code>HttpError</code> type that I also want to include stack traces. My initial thought was to do this with an embed, but I can't seem to embed it since the name of the class (<code>Error</code>) is the same as the name of one of the methods.</p>\n\n<pre><code>package netutil\n\nimport (\n  \"github.com/go-errors/errors\"\n)\n\ntype HttpError struct {\n  status int\n  *errors.Error\n}\n\nfunc (h *HttpError) Error() string {\n  return \"Failed\"\n}\n\nfunc NewHttpError(status int, message string) *HttpError {\n  return &amp;HttpError{\n    status,\n    errors.New(message),\n  }\n}\n</code></pre>\n\n<p>I receive the following error:</p>\n\n<pre><code>tmp_error.go:12: type HttpError has both field and method named Error\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["json", "go", "websocket"], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 2729715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/477dc0e93e54bedc7521bf85f9ebf7c5?s=128&d=identicon&r=PG&f=1", "display_name": "csabiftw", "link": "https://stackoverflow.com/users/2729715/csabiftw"}, "is_accepted": false, "score": 1, "last_activity_date": 1436897714, "creation_date": 1436897714, "answer_id": 31414255, "question_id": 31166703, "link": "https://stackoverflow.com/questions/31166703/websocketd-with-json-over-stdin-stdout/31414255#31414255", "title": "websocketd with json over STDIN/STDOUT", "body": "<p>You could run a websocket server in your go app, where you could handle all the related routing and logic. It would probably make things a lot simpler, and more flexible.</p>\n\n<p>Here is a library I have used previously, and can recommend:\n<a href=\"https://github.com/gorilla/websocket\" rel=\"nofollow\">https://github.com/gorilla/websocket</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7564630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yre9z.png?s=128&g=1", "display_name": "Zucce05", "link": "https://stackoverflow.com/users/7564630/zucce05"}, "is_accepted": false, "score": 0, "last_activity_date": 1499277618, "last_edit_date": 1499277618, "creation_date": 1499273597, "answer_id": 44931986, "question_id": 31166703, "link": "https://stackoverflow.com/questions/31166703/websocketd-with-json-over-stdin-stdout/44931986#44931986", "title": "websocketd with json over STDIN/STDOUT", "body": "<p>This is very late to the party and probably won't help at this point, but it might help future people who see this.</p>\n\n<p>Websocketd supports a binary transfer type and removes the <code>/n</code> line endings. This might be used by just buffering in and outbound binary streams and just reading them as json on either end.</p>\n\n<p><a href=\"https://github.com/joewalnes/websocketd/issues/38\" rel=\"nofollow noreferrer\">https://github.com/joewalnes/websocketd/issues/38</a></p>\n\n<pre><code>websocketd --devconsole --port 8080 --binary --devconsole stdbuf -i0 -io0 cat\n</code></pre>\n\n<p>The <code>--binary</code> flag being the important part of that link. (Copied in the even the link ever dies).</p>\n"}], "owner": {"reputation": 3061, "user_id": 1905022, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f743dcdd53e216313cdb74f66cbb4c3f?s=128&d=identicon&r=PG", "display_name": "Zhe Hu", "link": "https://stackoverflow.com/users/1905022/zhe-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499277618, "creation_date": 1435767525, "last_edit_date": 1459830536, "question_id": 31166703, "link": "https://stackoverflow.com/questions/31166703/websocketd-with-json-over-stdin-stdout", "title": "websocketd with json over STDIN/STDOUT", "body": "<p>We have built software that consists of two parts, a GUI (front-end) running in the browser and a kernel (back-end) with Go compiled into exe.</p>\n\n<p>To glue these two pieces together, we used nodejs+expressjs+socket.io running on the local machine. Nodejs talks to the browser over http/socket.io, and it also \"spawn\" Go exe as child_process. </p>\n\n<p>Now with <a href=\"https://github.com/joewalnes/websocketd\" rel=\"nofollow\">websocketd</a>, we can skip the nodejs+expressjs+socket.io part. That is great.</p>\n\n<p>The difficulty is: the GUI in the browser used to send JSON to nodejs, which is then written into a configuration file. Our kernel exe will read that JSON configuration file to determine what to do. </p>\n\n<p>I guess one cannot send JSON over STDIN/STDOUT. I can certainly do command line \"flag\" for Go to parse. </p>\n\n<p>Question: Is there a better way doing this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1435767290, "post_id": 31166247, "comment_id": 50341170, "body": "The application is using your current working directory or the location of the binary to find assets.  Without seeing your app code or knowing about gin-gonic, I cannot say which it is. In any case, you need to arrange for the application assets to be in place that the running binary expects to find them.  The assets are not bundled into the binary."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1435768863, "post_id": 31166247, "comment_id": 50342090, "body": "There is no need to set GOROOT."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1435768948, "post_id": 31166247, "comment_id": 50342143, "body": "Most probably cause of this problem: Your code accesses files (e.g. templates) via a relative path. This has nothing to do with GOPATH, GOBIN or whatever, it is just a missunderstanding how file access works."}, {"owner": {"reputation": 49, "user_id": 4638860, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768212f16481aed42b312f00cbc281e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4638860/ganesh"}, "edited": false, "score": 0, "creation_date": 1435802017, "post_id": 31166247, "comment_id": 50356286, "body": "Thanks. I moved my static files to the same location as the binary and it fixed the issue."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4638860, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768212f16481aed42b312f00cbc281e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4638860/ganesh"}, "edited": false, "score": 0, "creation_date": 1435801984, "post_id": 31166446, "comment_id": 50356278, "body": "Thanks guys. That was the issue. The static html and javascript files were not in the current working directory. Is there a good library to package all the static contents with in the same binary?"}, {"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "reply_to_user": {"reputation": 49, "user_id": 4638860, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768212f16481aed42b312f00cbc281e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4638860/ganesh"}, "edited": false, "score": 0, "creation_date": 1435818596, "post_id": 31166446, "comment_id": 50360775, "body": "The most common and simple approach is to change the working directory, possibly based on a command line option, when the server starts. I don&#39;t know what you mean with &quot;package&quot;. I use <code>tar</code> for such purpose."}], "tags": [], "owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "is_accepted": true, "score": 1, "last_activity_date": 1435766751, "creation_date": 1435766751, "answer_id": 31166446, "question_id": 31166247, "link": "https://stackoverflow.com/questions/31166247/golang-binary-not-working-outside-gopath-src-folder/31166446#31166446", "title": "golang binary not working outside gopath src folder", "body": "<p>All those GOPATH, GOROOT and of course the missing PATH variables just say something about how to call the go program itself and where it searches for modules. But you told us, that you built and installed some go program. </p>\n\n<p>When a go program has been built go is actually not needed anymore. You can take the binary, put it anywhere you want, even to another machine, that has the same or at least a similar system and run that program there.</p>\n\n<p>When your program, that you have built and installed and that seems to be called gin-gonic is executed, you will execute it in some path, also known as the current working directory (see getcwd(2) or pwd(1)).</p>\n\n<p>I just guess now, that under the current working directory there lives your htdocs, index.html, whatever files, that this gin-gonic uses to create the pages.</p>\n\n<p>It is common, that, if such a program cannot find the document it should create, send, produce, whatever, it will return the code 404: Not found.</p>\n\n<p>Though just guessed, this is, quite likely, the situation you are in, when you run your program with a different current working directory, than the working directory, under which the program expects its documents.</p>\n"}], "owner": {"reputation": 49, "user_id": 4638860, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/768212f16481aed42b312f00cbc281e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4638860/ganesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "closed_date": 1435855787, "accepted_answer_id": 31166446, "answer_count": 1, "score": -2, "last_activity_date": 1459470537, "creation_date": 1435766228, "last_edit_date": 1459470537, "question_id": 31166247, "link": "https://stackoverflow.com/questions/31166247/golang-binary-not-working-outside-gopath-src-folder", "closed_reason": "Not suitable for this site", "title": "golang binary not working outside gopath src folder", "body": "<p>I have a golang web application defined using gin-gonic. I have defined the the goapp under /usr/local/goapp\nThe structure is like this -<br>\n /usr/local/goapp<br>\n                 +src<br>\n                 +bin<br>\n                 +pkg<br>\nHere are my go env -<br>\nGOPATH - /usr/local<br>\nGOBIN - /usr/local/goapp/bin<br>\nGOROOT - /usr/local/go</p>\n\n<p>When I run go build and go install under the main folder in source, I get my binary and I am able to run it and see my html getting loaded when I go to the home page URL.\nIf I try to run the same binary under bin folder, I don't see the html getting loaded when I go to the home page URL. I am getting 404 page not found.</p>\n\n<p>Am I missing something here? Has anyone came across such a kind of issue?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1435765599, "post_id": 31165589, "comment_id": 50340063, "body": "&quot;I have problems like this frequently in Go having to do with inheritance&quot; -- that&#39;s because there is no inheritance in go."}], "answers": [{"comments": [{"owner": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "edited": false, "score": 0, "creation_date": 1435766179, "post_id": 31165985, "comment_id": 50340449, "body": "I get that, but what I dislike is that both yamlcms.Page and main.Page have to implement the ReadFile function... They will be exactly the same except for the signature."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "edited": false, "score": 0, "creation_date": 1435766619, "post_id": 31165985, "comment_id": 50340745, "body": "@eatonphil: no, they will be the exact same signature except for the type. <code>Page</code> implements <code>FileReader</code> because it embeds <code>*yamlcms.Page</code>."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "edited": false, "score": 0, "creation_date": 1435766631, "post_id": 31165985, "comment_id": 50340758, "body": "@eatonphil that&#39;s where you&#39;re confused. Because you&#39;ve embedded <code>yamlcms.Page</code> in <code>main.Page</code> <code>main.Page</code> will be recognized as implementing the interface. You can call ReadFile directly from an instance of <code>main.Page</code>. Actually, I would highly recommend against re-implementing that method. Embedding is not inheritance, overriding methods in a type which embeds another would be a very poor design imo. Think of it as composition in traditional OOP but you don&#39;t have to reference the thing you compose of, instead it&#39;s methods from the embedded type can be invoked directly."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435766686, "post_id": 31165985, "comment_id": 50340793, "body": "@JimB I think eatonphil means that in order to unmarshal the additional fields in <code>main.Page</code>, they&#39;ll need to implement the same method."}, {"owner": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "edited": false, "score": 0, "creation_date": 1435767663, "post_id": 31165985, "comment_id": 50341395, "body": "@Ainar-G, so I&#39;ve made the change but still get a similar error - see my edit."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "edited": false, "score": 0, "creation_date": 1435768537, "post_id": 31165985, "comment_id": 50341913, "body": "@eatonphil I forgot that interfaces and slices don&#39;t work like that, sorry. See edit for a possible alternative."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1435768523, "last_edit_date": 1435768523, "creation_date": 1435765518, "answer_id": 31165985, "question_id": 31165589, "link": "https://stackoverflow.com/questions/31165589/golang-downcasting-list-of-structs/31165985#31165985", "title": "Golang downcasting list of structs", "body": "<p><strong>EDIT:</strong> I forgot that slices of interfaces don't work like that. You'd need to allocate a new slice, convert all pages to <code>FileReaders</code>, call the function, and convert them back.</p>\n\n<p>Another possible solution is refactoring <code>yamlcms.ReadDir</code> to return the contents of the files, so that they could be unmarshaled later:</p>\n\n<pre><code>// In yamlcms.\nfunc ReadYAMLFilesInDir(dir string) ([][]byte, error) { ... }\n\n// In client code.\nfiles := yamlcms.ReadYAMLFilesInDir(\"dir\")\nfor i := range pages {\n    if err := yaml.Unmarshal(files[i], &amp;pages[i]); err != nil { return err }\n}\n</code></pre>\n\n<p>The original answer:</p>\n\n<p>There are no such things as inheritance or casting in Go. Prefer composition and interfaces in your designs. In your case, you can redefine your <code>yamlcms.ReadDir</code> to accept an interface, <code>FileReader</code>.</p>\n\n<pre><code>type FileReader interface {\n    ReadFile(file string) error\n}\n</code></pre>\n\n<p>Both <code>yamlcms.Page</code> and <code>main.Page</code> will implement this, as the latter embeds the former.</p>\n"}], "owner": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1435768523, "creation_date": 1435764448, "last_edit_date": 1435767625, "question_id": 31165589, "link": "https://stackoverflow.com/questions/31165589/golang-downcasting-list-of-structs", "title": "Golang downcasting list of structs", "body": "<p>I want to be able to unmarshal yaml files less rigidly. That is, my library has a predefined number of options the yaml file must have. Then, the user should be able to extend this to include any custom options.</p>\n\n<p>Here is what I have</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"yamlcms\"\n\n    \"github.com/julienschmidt/httprouter\"\n)\n\ntype Page struct {\n    *yamlcms.Page\n    Title string\n    Date  string\n}\n\nfunc getBlogRoutes() {\n    pages := []*Page{}\n    yamlcms.ReadDir(\"html\", pages)\n}\n\n// This section is a work in progress, I only include it for loose context\nfunc main() {\n    router := httprouter.New()\n    //blogRoutes := getBlogRoutes()\n    //for _, blogRoute := range *blogRoutes {\n    //  router.Handle(blogRoute.Method, blogRoute.Pattern,\n    //      func(w http.ResponseWriter, r *http.Request, _ httprouter.Params) {})\n    //} \n    http.ListenAndServe(\":8080\", router)\n}\n</code></pre>\n\n<p>Here is the yamlcms package:</p>\n\n<pre><code>package yamlcms\n\nimport (\n    \"io/ioutil\"\n    \"os\"\n    \"strings\"\n\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Page struct {\n    Slug string `yaml:\"slug\"`\n    File string `yaml:\"file\"`\n}\n\nfunc (page *Page) ReadFile(file string) (err error) {\n    fileContents, err := ioutil.ReadFile(file)\n    if err != nil {\n        return\n    }   \n\n    err = yaml.Unmarshal(fileContents, &amp;page)\n    return\n}\n\nfunc isYamlFile(fileInfo os.FileInfo) bool {\n    return !fileInfo.IsDir() &amp;&amp; strings.HasSuffix(fileInfo.Name(),     \".yaml\")\n}\n\nfunc ReadDir(dir string, pages []*Page) (err error) {\n    filesInfo, err := ioutil.ReadDir(dir)\n    if err != nil {\n        return\n    }   \n\n    for i, fileInfo := range filesInfo {\n        if isYamlFile(fileInfo) {\n            pages[i].ReadFile(fileInfo.Name())\n        }   \n    }   \n\n    return\n}\n</code></pre>\n\n<p>There is a compiler issue here:</p>\n\n<pre><code>src/main.go:19: cannot use pages (type []*Page) as type []*yamlcms.Page in argument to yamlcms.ReadDir\n</code></pre>\n\n<p>My main intent in this question is to learn the idiomatic way of doing this kind of thing in Go. Other 3rd-party solutions may exist but I am not immediately interested in them because I have problems like this frequently in Go having to do with inheritance, etc. So along the lines of what I've presented, how can I best (idiomatically) accomplish what I am going for?</p>\n\n<p>EDIT:</p>\n\n<p>So I've made some changes as suggested. Now I have this:</p>\n\n<pre><code>type FileReader interface {\n    ReadFile(file string) error\n}\n\nfunc ReadDir(dir string, pages []*FileReader) (err error) {\n    filesInfo, err := ioutil.ReadDir(dir)\n    if err != nil {\n        return\n    }   \n\n    for i, fileInfo := range filesInfo {\n        if isYamlFile(fileInfo) {\n            (*pages[i]).ReadFile(fileInfo.Name())\n        }   \n    }   \n\n    return\n}\n</code></pre>\n\n<p>However, I still get a similar compiler error:</p>\n\n<pre><code>src/main.go:19: cannot use pages (type []*Page) as type []*yamlcms.FileReader in argument to yamlcms.ReadDir\n</code></pre>\n\n<p>Even though main.Page should be a FileReader because it embeds yamlcms.Page.</p>\n"}, {"tags": ["parsing", "time", "go"], "answers": [{"comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1435765818, "post_id": 31165804, "comment_id": 50340204, "body": "Interesting, I tried to change the input to <code>+0000</code> and it does work on playground, but on my system it shows <code>+0000 +0000</code>. Then tried with <code>+0200</code> and it correctly shows <code>CEST</code>. I guess this only translates if the offset matches <code>time.Local</code>. Good to know!"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1435764994, "creation_date": 1435764994, "answer_id": 31165804, "question_id": 31165516, "link": "https://stackoverflow.com/questions/31165516/go-time-parse-issue/31165804#31165804", "title": "Go: time.Parse() issue", "body": "<p>The default format used by <a href=\"http://golang.org/pkg/time/#Time.String\" rel=\"nofollow\">Time.String</a> is this:</p>\n\n<pre><code>2006-01-02 15:04:05.999999999 -0700 MST\n</code></pre>\n\n<p>Notice the \"MST\" part. Since you're not providing the name of the zone, the format just \"names\" it the same as offset, that is \"+0900\". If you change that to \"+0000\", you'll see that this is indeed a time zone name:</p>\n\n<pre><code>2015-07-01 18:12:25 +0000 UTC\n</code></pre>\n\n<p>If you don't want that, just use a separate format for printing:</p>\n\n<pre><code>myFmt := \"2006-01-02 15:04:05.999999999 -0700\"\nfmt.Println(parsed.Format(myFmt))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 2, "last_activity_date": 1435765359, "last_edit_date": 1592644375, "creation_date": 1435765009, "answer_id": 31165811, "question_id": 31165516, "link": "https://stackoverflow.com/questions/31165516/go-time-parse-issue/31165811#31165811", "title": "Go: time.Parse() issue", "body": "<p>If you look at documentation of <a href=\"http://golang.org/pkg/time/#Time.String\" rel=\"nofollow noreferrer\"><code>time.Time</code></a> you will see what the default output format is:</p>\n<blockquote>\n<p>String returns the time formatted using the format string:</p>\n<p>&quot;2006-01-02 15:04:05.999999999 -0700 MST&quot;</p>\n</blockquote>\n<p>Now you should see what the second <code>+0900</code> is doing there \u2013 this is a location (time zone) name. Since your input format doesn't have a name it will simply repeat an offset.</p>\n<p>You can provide name by altering your input format to parse location name. Alternatively you can provide an output format which doesn't print the name, if you don't need it.</p>\n<p>Your modified example:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;time&quot;\n    &quot;log&quot;\n)\n\nfunc main() {\n    timeLocal := &quot;01/July/2015:18:12:25 +0900 XYZ&quot;\n    inFormat := &quot;02/January/2006:15:04:05 -0700 MST&quot;\n    parsed, err := time.Parse(inFormat, timeLocal)\n    if err != nil {\n        log.Fatal(&quot;Time format was not recognized!&quot;)\n    }\n\n    fmt.Println(timeLocal)\n    fmt.Println(inFormat)\n    fmt.Println(parsed) // 2015-07-01 18:12:25 +0900 XYZ\n    fmt.Println(parsed.Format(&quot;02/January/2006:15:04:05 -0700&quot;))\n}\n</code></pre>\n<p><a href=\"http://play.golang.org/p/xVGvlt-M5B\" rel=\"nofollow noreferrer\">http://play.golang.org/p/xVGvlt-M5B</a></p>\n"}], "owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 31165811, "answer_count": 2, "score": 2, "last_activity_date": 1435765359, "creation_date": 1435764255, "question_id": 31165516, "link": "https://stackoverflow.com/questions/31165516/go-time-parse-issue", "title": "Go: time.Parse() issue", "body": "<p>I have the following code:</p>\n\n<pre><code>timeLocal := \"01/July/2015:18:12:25 +0900\"\ninFormat := \"02/January/2006:15:04:05 -0700\"\nparsed, err := time.Parse(inFormat, timeLocal)\nif err != nil {\n    log.Fatal(\"Time format was not recognized!\")\n}\n</code></pre>\n\n<p>Now, parsing works fine. But when I run:</p>\n\n<pre><code>fmt.Println(timeLocal)\nfmt.Println(inFormat)\nfmt.Println(parsed)\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>01/July/2015:18:12:25 +0900\n02/January/2006:15:04:05 -0700\n2015-07-01 18:12:25 +0900 +0900\n</code></pre>\n\n<p>Should the second <code>+0900</code> be there? What is the stupid thing that I'm doing? Sorry, it was really a long day, I don't see what I'm missing.</p>\n\n<p>Oh, and the whole file is here:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"log\"\n)\n\nfunc main() {\n    timeLocal := \"01/July/2015:18:12:25 +0900\"\n    inFormat := \"02/January/2006:15:04:05 -0700\"\n    parsed, err := time.Parse(inFormat, timeLocal)\n    if err != nil {\n        log.Fatal(\"Time format was not recognized!\")\n    }\n\n    fmt.Println(timeLocal)\n    fmt.Println(inFormat)\n    fmt.Println(parsed)\n}\n</code></pre>\n"}, {"tags": ["struct", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1435760234, "post_id": 31163866, "comment_id": 50336192, "body": "<code>i</code> isn&#39;t a keyword, so you don&#39;t need the <code>_</code>."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1435760858, "last_edit_date": 1435760858, "creation_date": 1435760328, "answer_id": 31163953, "question_id": 31163866, "link": "https://stackoverflow.com/questions/31163866/cgo-c-struct-field-access-from-go-underscore-or-no-underscore/31163953#31163953", "title": "cgo C struct field access from Go: underscore or no underscore?", "body": "<p>The answer is in the very quote you have in your question:</p>\n\n<blockquote>\n  <p>Within the Go file, C's struct field names <strong>that are <a href=\"http://golang.org/ref/spec#Keywords\" rel=\"nofollow\">keywords</a> in Go</strong> can be accessed by prefixing them with an underscore(\u2026)</p>\n</blockquote>\n\n<p><code>i</code>, <code>d</code>, and <code>s</code> are not keywords in Go.</p>\n"}], "owner": {"reputation": 137, "user_id": 5058093, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e80c9396e250c345163ee73e200d1c8d?s=128&d=identicon&r=PG&f=1", "display_name": "kov", "link": "https://stackoverflow.com/users/5058093/kov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2578, "favorite_count": 0, "accepted_answer_id": 31163953, "answer_count": 1, "score": 3, "last_activity_date": 1435760858, "creation_date": 1435760117, "question_id": 31163866, "link": "https://stackoverflow.com/questions/31163866/cgo-c-struct-field-access-from-go-underscore-or-no-underscore", "title": "cgo C struct field access from Go: underscore or no underscore?", "body": "<p>I'm running into a disconnect between the online documentation and the behavior I see in my programs accessing C structs within GO code. <code>go version</code> says I am using:</p>\n\n<pre><code>go version go1.4.2 linux/amd64\n</code></pre>\n\n<p>According to the <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">GO CGO documentation</a>: </p>\n\n<blockquote>\n  <p>Within the Go file, C's struct field names that are keywords in Go can be \n  accessed by prefixing them with an underscore: if x points at a C struct with \n  a field named \"type\", x._type accesses the field. C struct fields that cannot \n  be expressed in Go, such as bit fields or misaligned data, are omitted in the \n  Go struct, replaced by appropriate padding to reach the next field or the end \n  of the struct.</p>\n</blockquote>\n\n<p>I had troubles with this, so made a quick sample program to test it out:</p>\n\n<pre><code>package main\n// struct rec\n// {\n//      int    i;\n//      double d;\n//      char*  s;\n// };\nimport \"C\"\nimport \"fmt\"\nfunc main() {\n        s := \"hello world\"\n        r := C.struct_rec{}\n        r.i = 9\n        r.d = 9.876\n        r.s = C.CString(s)\n        fmt.Printf(\"\\n\\tr.i: %d\\n\\tr.d: %f\\n\\tr.s: %s\\n\", \n                r.i, \n                r.d, \n                C.GoString(r.s))\n}\n</code></pre>\n\n<p>When I use underscores as the docs indicate (eg, substitute <code>r._i</code> for <code>r.i</code> above) I get the following compile error:</p>\n\n<blockquote>\n  <p><code>r._i undefined (type C.struct_rec has no field or method _i)</code></p>\n</blockquote>\n\n<p>When I don't use underscores it works fine. I tried this with both pointers and non-pointers. The only other idea I can think of is that maybe it's because I allocated the instances in GO rather than C, is that the case??</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5069827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXeug.jpg?s=128&g=1", "display_name": "David Bailey", "link": "https://stackoverflow.com/users/5069827/david-bailey"}, "edited": false, "score": 0, "creation_date": 1435759703, "post_id": 31163594, "comment_id": 50335794, "body": "Um, does not this distance() func I created on on lines 14 through 18, not count?  Also, I&#39;ll check out &quot;Effective Go&quot;.  Thanks"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 19, "user_id": 5069827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXeug.jpg?s=128&g=1", "display_name": "David Bailey", "link": "https://stackoverflow.com/users/5069827/david-bailey"}, "edited": false, "score": 0, "creation_date": 1435759913, "post_id": 31163594, "comment_id": 50335974, "body": "No, it&#39;s a method. <code>func distance(x1, y1, x2, y2 float64) float64 { ... }</code> - this would be a function."}, {"owner": {"reputation": 19, "user_id": 5069827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXeug.jpg?s=128&g=1", "display_name": "David Bailey", "link": "https://stackoverflow.com/users/5069827/david-bailey"}, "edited": false, "score": 0, "creation_date": 1435762591, "post_id": 31163594, "comment_id": 50338004, "body": "Okay, I&#39;m going back to think about this again.  I&#39;ll reply when I&#39;ve come to my senses a bit more.  (:&gt;)  Thanks, @Ainar-G"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1435759413, "creation_date": 1435759413, "answer_id": 31163594, "question_id": 31163376, "link": "https://stackoverflow.com/questions/31163376/getting-an-undefined-distance-error-from-go-compiler/31163594#31163594", "title": "Getting an &quot;undefined: distance&quot; error from Go compiler", "body": "<p>You don't have a function called <code>distance</code>. It's a method of the type <code>*Distance</code>. You need to create a <code>*Distance</code> first, and then call the method.</p>\n\n<pre><code>d := &amp;Distance{r.x1, r.y1, r.x2, r.y1}\nl := d.distance()\n</code></pre>\n\n<p>I'd suggest starting with <a href=\"http://golang.org/doc/effective_go.html\" rel=\"nofollow\">Effective Go</a>. It's a very good introduction into the language for  \"a seasoned programmer\".</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 5069827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXeug.jpg?s=128&g=1", "display_name": "David Bailey", "link": "https://stackoverflow.com/users/5069827/david-bailey"}, "edited": false, "score": 0, "creation_date": 1435769528, "post_id": 31163606, "comment_id": 50342460, "body": "Thanks @Ainar-G!  Who says you can&#39;t teach an old dog new tricks?  (:&gt;)"}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 19, "user_id": 5069827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXeug.jpg?s=128&g=1", "display_name": "David Bailey", "link": "https://stackoverflow.com/users/5069827/david-bailey"}, "edited": false, "score": 0, "creation_date": 1435775088, "post_id": 31163606, "comment_id": 50345577, "body": "If your question is resolved, please consider selecting an answer David."}], "tags": [], "owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "is_accepted": false, "score": 2, "last_activity_date": 1435759983, "last_edit_date": 1435759983, "creation_date": 1435759443, "answer_id": 31163606, "question_id": 31163376, "link": "https://stackoverflow.com/questions/31163376/getting-an-undefined-distance-error-from-go-compiler/31163606#31163606", "title": "Getting an &quot;undefined: distance&quot; error from Go compiler", "body": "<p>Your function defined here:</p>\n\n<pre><code>func (d *Distance) distance() float64 {\n    a := d.x2 - d.x1\n    b := d.y2 - d.y1\n    return math.Sqrt(a*a + b*b)\n}\n</code></pre>\n\n<p>is a method on the Distance object. It looks like you're trying to create a new Distance instance here:</p>\n\n<pre><code>func (r *Rectangle) area() float64 {\n    l := distance(r.x1, r.y1, r.x2, r.y1)\n    w := distance(r.x1, r.y1, r.x1, r.y2)\n    return l.distance() * w.distance()\n}\n</code></pre>\n\n<p>but what you're actually doing is trying to call a function called <code>distance</code>.</p>\n\n<p>You want</p>\n\n<pre><code>func (r *Rectangle) area() float64 {\n    l := &amp;Distance{r.x1, r.y1, r.x2, r.y1}\n    w := &amp;Distance{r.x1, r.y1, r.x1, r.y2}\n    return l.distance() * w.distance()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1435845643, "post_id": 31170129, "comment_id": 50378696, "body": "You&#39;ve made the <i>exact</i> same code formatting mistakes you did in the question (since corrected by others). <b>Look at the preview</b> and correct things (like the <code>&lt;pre&gt;&lt;code&gt;</code> mistakes) <b>before</b> posting."}, {"owner": {"reputation": 19, "user_id": 5069827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXeug.jpg?s=128&g=1", "display_name": "David Bailey", "link": "https://stackoverflow.com/users/5069827/david-bailey"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1442338061, "post_id": 31170129, "comment_id": 53037853, "body": "Okay.  Mea culpa.  I shall endeavor to to it correctly going forward.  Thanks."}], "tags": [], "owner": {"reputation": 19, "user_id": 5069827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXeug.jpg?s=128&g=1", "display_name": "David Bailey", "link": "https://stackoverflow.com/users/5069827/david-bailey"}, "is_accepted": false, "score": 0, "last_activity_date": 1435779279, "creation_date": 1435779279, "answer_id": 31170129, "question_id": 31163376, "link": "https://stackoverflow.com/questions/31163376/getting-an-undefined-distance-error-from-go-compiler/31170129#31170129", "title": "Getting an &quot;undefined: distance&quot; error from Go compiler", "body": "<p>thanks @Ainar-G and @Momer!  After I got my \"mind right\" (had to fix a couple more self-inflicted syntax errors), the following worked:</p>\n\n<pre><code>&lt;pre&gt;&lt;code&gt;\npackage main\n\nimport (\"fmt\"; \"math\")\n\ntype Shape interface {\n    area() float64\n    perimeter() float64\n}\n\ntype Distance struct {\n    x1, y1, x2, y2 float64\n}\n\nfunc distance(x1, y1, x2, y2 float64) float64 {\n    a := x2 - x1\n    b := y2 - y1\n    return math.Sqrt(a*a + b*b)\n}\n\ntype Rectangle struct {\n    x1, y1, x2, y2 float64\n}\n\nfunc (r *Rectangle) area() float64 {\n    l  := distance(r.x1, r.y1, r.x2, r.y1)\n    w := distance(r.x1, r.y1, r.x1, r.y2)\n    return l * w\n}\ntype Circle struct {\n    x, y, r float64\n}\n\nfunc (c *Circle) area() float64 {\n    return math.Pi * c.r*c.r\n}\n\ntype Perimeter struct {\n    x1, y1, x2, y2 float64\n}\n\nfunc (p *Perimeter) perimeter() float64 {\n    s1 := distance(p.x1, p.y1, p.x1, p.y2)\n    s2 := distance(p.x1, p.y2, p.x2, p.y2)\n    s3 := distance(p.x2, p.y2, p.x2, p.y1)\n    s4 := distance(p.x2, p.y1, p.x1, p.y1)\n    return s1 + s2 + s3 + s4\n}\n\nfunc main() {\n    d := new(Distance)\n    d.x1, d.y1, d.x2, d.y2 = 0, 0, 10, 10\n\n    p := new(Perimeter)\n    p.x1, p.y1, p.x2, p.y2 = 0, 0, 10, 10\n    fmt.Println(p.perimeter())\n\n    r := new(Rectangle)\n    r.x1, r.y1 = 0, 0\n    r.x2, r.y2 = 10, 10\n    fmt.Println(r.area())\n\n    c := new(Circle)\n    c.x, c.y, c.r = 0, 0, 5\n    fmt.Println(c.area())\n\n}\n&lt;pre&gt;&lt;code&gt;\n</code></pre>\n\n<p>Here's the resulting output:</p>\n\n<pre><code>&lt;pre&gt;&lt;code&gt;\nDavid Bailey@DAVIDBAILEY-PC /c/Go/src/golang-book/chapter9/chapterProblems\n$ go run interface.go\n40\n100\n78.53981633974483\n\nDavid Bailey@DAVIDBAILEY-PC /c/Go/src/golang-book/chapter9/chapterProblems\n$\n&lt;pre&gt;&lt;code&gt;\n</code></pre>\n\n<p>Again, thank you.</p>\n"}], "owner": {"reputation": 19, "user_id": 5069827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXeug.jpg?s=128&g=1", "display_name": "David Bailey", "link": "https://stackoverflow.com/users/5069827/david-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1435779279, "creation_date": 1435758847, "last_edit_date": 1435761449, "question_id": 31163376, "link": "https://stackoverflow.com/questions/31163376/getting-an-undefined-distance-error-from-go-compiler", "title": "Getting an &quot;undefined: distance&quot; error from Go compiler", "body": "<p>I'm a seasoned \"old school\" programmer, but a rank beginner with Go. I'm making my way through the \"CreateSpace: An Introduction to \nPrograming in Go\" book.  On p.\u00a0111, the third of Chapter\u00a09's Chapter Problems, the task is to add a new method to the user-defined Shape interface.  The interface has been built up over the course of the chapter and here's what I have so far:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\ntype Shape interface {\n    area() float64\n    perimeter() float64\n}\n\ntype Distance struct {\n    x1, y1, x2, y2 float64\n}\n\nfunc (d *Distance) distance() float64 {\n    a := d.x2 - d.x1\n    b := d.y2 - d.y1\n    return math.Sqrt(a*a + b*b)\n}\n\ntype Rectangle struct {\n    x1, y1, x2, y2 float64\n}\n\nfunc (r *Rectangle) area() float64 {\n    l := distance(r.x1, r.y1, r.x2, r.y1)\n    w := distance(r.x1, r.y1, r.x1, r.y2)\n    return l * w\n}\n\ntype Circle struct {\n    x, y, r float64\n}\n\nfunc (c *Circle) area() float64 {\n    return math.Pi * c.r * c.r\n}\n\ntype Perimeter struct {\n    x1, y1, x2, y2 float64\n}\n\nfunc (p *Perimeter) perimeter() float64 {\n    s1 := distance(p.x1, p.y1, p.x1, p.y2)\n    s2 := distance(p.x1, p.y2, p.x2, p.y2)\n    s3 := distance(p.x2, p.y2, p.x2, p.y1)\n    s4 := distance(p.x2, p.y1, p.x1, p.y1)\n    return s1 + s2 + s3 + s4\n}\n\nfunc main() {\n    d := new(Distance)\n    d.x2, d.y2, d.x1, d.y1 = 0, 0, 10, 10\n\n    p := new(Perimeter)\n    p.x1, p.y1 = 0, 0\n    p.x2, p.y2 = 10, 10\n    fmt.Println(p.perimeter())\n\n    r := new(Rectangle)\n    r.x1, r.y1 = 0, 0\n    r.x2, r.y2 = 10, 10\n    fmt.Println(r.area())\n\n    c := Circle{0, 0, 5}\n    fmt.Println(c.area())\n\n}\n</code></pre>\n\n<p>The problem is that I am getting the following error (from the compiler?):</p>\n\n<pre><code>user@pc /c/Go/src/golang-book/chapter9/chapterProblems\n$ go run interface.go\n# command-line-arguments\n.\\interface.go:25: undefined: distance\n.\\interface.go:26: undefined: distance\n.\\interface.go:42: undefined: distance\n.\\interface.go:43: undefined: distance\n.\\interface.go:44: undefined: distance\n.\\interface.go:45: undefined: distance\n</code></pre>\n\n<p>I've spent a good amount of time doing my \"due diligence\" hereto pertaining by rereading the chapter text and thinking hard about what this \n\"undefined: distance\" error might mean, but so far to no avail.\nAs you can see, I have defined a \"Distance struct\", created a new() instance of \nit called <code>d</code>, initialized its fields with the <code>.</code> operator, and created a <code>distance()</code> func, but, clearly, I'm not grokking some relevant piece(s) of information.</p>\n"}, {"tags": ["go", "command-line-interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1435758727, "post_id": 31163176, "comment_id": 50335031, "body": "don&#39;t use <code>go run *.go</code>, it&#39;s going to cause you more confusion."}, {"owner": {"reputation": 5, "user_id": 5066027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381489fc0bc5d8f4ed78ea47b0e7c19?s=128&d=identicon&r=PG&f=1", "display_name": "newtogolang", "link": "https://stackoverflow.com/users/5066027/newtogolang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435758882, "post_id": 31163176, "comment_id": 50335171, "body": "I am going to try &quot;go build&quot; now."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5066027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381489fc0bc5d8f4ed78ea47b0e7c19?s=128&d=identicon&r=PG&f=1", "display_name": "newtogolang", "link": "https://stackoverflow.com/users/5066027/newtogolang"}, "edited": false, "score": 0, "creation_date": 1435759032, "post_id": 31163355, "comment_id": 50335282, "body": "I know go run is bad, but so I understand, &quot;go run *.go -slow true printrepeater 5&quot; would pass 5 to printrepeater and true to go."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5, "user_id": 5066027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381489fc0bc5d8f4ed78ea47b0e7c19?s=128&d=identicon&r=PG&f=1", "display_name": "newtogolang", "link": "https://stackoverflow.com/users/5066027/newtogolang"}, "edited": false, "score": 1, "creation_date": 1435759403, "post_id": 31163355, "comment_id": 50335557, "body": "I don&#39;t understand, what do you mean &quot;true to go&quot;? You don&#39;t have a <code>-slow</code> flag defined for your main app, so that&#39;s invalid. I would suggest learning how the <code>flag</code> package works before delving into a more complicated package like this <code>cli</code>."}, {"owner": {"reputation": 5, "user_id": 5066027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381489fc0bc5d8f4ed78ea47b0e7c19?s=128&d=identicon&r=PG&f=1", "display_name": "newtogolang", "link": "https://stackoverflow.com/users/5066027/newtogolang"}, "edited": false, "score": 0, "creation_date": 1435759578, "post_id": 31163355, "comment_id": 50335693, "body": "I made a type, pass true to slow.  To my understanding I made the flag within the printrepeater command.  And I will be looking into the flag package."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5, "user_id": 5066027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381489fc0bc5d8f4ed78ea47b0e7c19?s=128&d=identicon&r=PG&f=1", "display_name": "newtogolang", "link": "https://stackoverflow.com/users/5066027/newtogolang"}, "edited": false, "score": 1, "creation_date": 1435759786, "post_id": 31163355, "comment_id": 50335853, "body": "No for two reasons. You don&#39;t have a <code>-slow</code> flag defined at that level, so &quot;-slow&quot; isn&#39;t valid there, and a <code>bool</code> flag doesn&#39;t require an argument, so you would have to insert a <code>=</code> to force it to evaluate the &quot;true&quot;."}, {"owner": {"reputation": 5, "user_id": 5066027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381489fc0bc5d8f4ed78ea47b0e7c19?s=128&d=identicon&r=PG&f=1", "display_name": "newtogolang", "link": "https://stackoverflow.com/users/5066027/newtogolang"}, "edited": false, "score": 0, "creation_date": 1435760197, "post_id": 31163355, "comment_id": 50336167, "body": "I deleted the flag from app.Commands.  Then I put app.Flags = []cli.Flag {....} in the main.  Now if I don&#39;t put -slow it will return FLASE, if I put -slow it gives me TRUE.  Is that correct?  Also thank you from you time and patience."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5, "user_id": 5066027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381489fc0bc5d8f4ed78ea47b0e7c19?s=128&d=identicon&r=PG&f=1", "display_name": "newtogolang", "link": "https://stackoverflow.com/users/5066027/newtogolang"}, "edited": false, "score": 1, "creation_date": 1435760411, "post_id": 31163355, "comment_id": 50336345, "body": "@newtogolang: A <code>cli.BoolFlag</code> defaults to false, and is true when you use the flag. Go and learn how the <code>flag</code> package works, and you will see how this is a supplement to that functionality."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1435758802, "creation_date": 1435758802, "answer_id": 31163355, "question_id": 31163176, "link": "https://stackoverflow.com/questions/31163176/getting-different-outputs-when-i-change-from-to-no-on-flag/31163355#31163355", "title": "Getting different outputs when I change from &quot;--&quot; to no -- on flag", "body": "<p>Flags start with a <code>-</code>, that's just how they are defined. </p>\n\n<p>When you use <code>printrepeater 3 slow</code>, \"slow\" is now an extra argument, and doesn't affect the state of the <code>slow</code> flag. </p>\n"}], "owner": {"reputation": 5, "user_id": 5066027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381489fc0bc5d8f4ed78ea47b0e7c19?s=128&d=identicon&r=PG&f=1", "display_name": "newtogolang", "link": "https://stackoverflow.com/users/5066027/newtogolang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 31163355, "answer_count": 1, "score": 0, "last_activity_date": 1435798018, "creation_date": 1435758359, "last_edit_date": 1435798018, "question_id": 31163176, "link": "https://stackoverflow.com/questions/31163176/getting-different-outputs-when-i-change-from-to-no-on-flag", "title": "Getting different outputs when I change from &quot;--&quot; to no -- on flag", "body": "<p>Ok, I have having trouble with flags.  I think I currently am on the right track but my println in my PrintRepeater program will output a true if I type \"go run *.go printrepeater 3 --slow\", but if I type \"go run *.go printrepeater 3 slow\" I get flase.</p>\n\n<p><strong>testCli.go</strong></p>\n\n<pre><code>package main\n</code></pre>\n\n<p>import (\n    \"github.com/codegangsta/cli\"\n    \"os\"\n   )</p>\n\n<pre><code>func main() {\napp := cli.NewApp()\napp.Name = \"Learn CLI\"\napp.Usage = \"basic things in cli\"\n/*  app.Flags = []gangstaCli.Flag{\n    gangstaCli.StringFlag{\n        Name: \"s\",\n        //Value:  \"y\",\n        Usage: \"slowing down\",\n    },\n    }*/\n\n  //    app.Flags = []cli.Flag{\n  //cli.StringFlag{\"slow\", \"yes\", \"for when you have too much time\", \"\"},\n // }\n\n app.Commands = []cli.Command{\n    {\n        Name:   \"countup\",\n        Usage:  \"counting up\",\n        Action: PrintRepeater,\n    },\n\n    {\n        Name:   \"countdown\",\n        Usage:  \"counting down\",\n        Action: GoDown,\n    },\n\n    {\n        Name:  \"printrepeater\",\n        Usage: \"prints hello x number of times\",\n        Flags: []cli.Flag{\n            cli.BoolFlag{\n                Name:  \"slow\",\n                Usage: \"to slow things down by a certian amount\",\n            },\n        },\n        Action: PrintRepeater,\n    },\n}\n\napp.Run(os.Args)\n}\n</code></pre>\n\n<p><strong>PrintRepeater.go</strong></p>\n\n<pre><code>package main\n\nimport \"github.com/codegangsta/cli\"\nimport \"strconv\"\n\nfunc PrintRepeater(c *cli.Context) {\n    println(c.Bool(\"slow\"))\n\n    i1 := c.Args()[0]\n    i2, err := strconv.Atoi(i1)\n    if err != nil {\n        println(err)\n    }\n    for i := i2; i &gt;= 1; i-- {\n        println(\"hello\")\n    }\n}\n</code></pre>\n"}, {"tags": ["struct", "go", "deep-copy"], "comments": [{"owner": {"reputation": 4122, "user_id": 1743957, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa0c08c9d80f0702b0eba6398a4ae26d?s=128&d=identicon&r=PG", "display_name": "Sebastien C.", "link": "https://stackoverflow.com/users/1743957/sebastien-c"}, "edited": false, "score": 0, "creation_date": 1435757711, "post_id": 31161829, "comment_id": 50334230, "body": "Assignment is always a copy unless you use a pointer."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4122, "user_id": 1743957, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa0c08c9d80f0702b0eba6398a4ae26d?s=128&d=identicon&r=PG", "display_name": "Sebastien C.", "link": "https://stackoverflow.com/users/1743957/sebastien-c"}, "edited": false, "score": 2, "creation_date": 1435758916, "post_id": 31161829, "comment_id": 50335198, "body": "@SebastienC.: Assignment is <i>always</i> a copy. When it&#39;s a pointer, you&#39;re copying the pointer value."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 11, "last_activity_date": 1435761142, "last_edit_date": 1435761142, "creation_date": 1435755719, "answer_id": 31162101, "question_id": 31161829, "link": "https://stackoverflow.com/questions/31161829/go-deep-shallow-copy/31162101#31162101", "title": "Go deep/shallow copy", "body": "<p>Assignment <em>is</em> a copy. Your second function comes close, you just need to dereference <code>s</code>.</p>\n\n<p>This copies the <code>*Server</code> <code>s</code> to <code>c</code></p>\n\n<pre><code>c := new(Server)\n*c = *s\n</code></pre>\n\n<p>As for a deep copy, you need to go through the fields, and determine what needs to be copied recursively. Depending on what <code>*httprouter.Router</code> is, you may not be able to make a deep copy if it contains data in unexported fields. </p>\n"}], "owner": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7403, "favorite_count": 1, "accepted_answer_id": 31162101, "answer_count": 1, "score": 5, "last_activity_date": 1435761142, "creation_date": 1435755037, "last_edit_date": 1435755357, "question_id": 31161829, "link": "https://stackoverflow.com/questions/31161829/go-deep-shallow-copy", "title": "Go deep/shallow copy", "body": "<p>I am trying to copy a struct in Go and cannot find many resources on this. Here is what I have:</p>\n\n<pre><code>type Server struct {\n    HTTPRoot       string // Location of the current subdirectory\n    StaticRoot     string // Folder containing static files for all domains\n    Auth           Auth\n    FormRecipients []string\n    Router         *httprouter.Router\n}\n\nfunc (s *Server) Copy() (c *Server) {\n    c.HTTPRoot = s.HTTPRoot\n    c.StaticRoot = s.StaticRoot\n    c.Auth = s.Auth\n    c.FormRecipients = s.FormRecipients\n    c.Router = s.Router\n    return\n}\n</code></pre>\n\n<p>First question, this will not be a deep copy because I am not copying s.Auth. Is this at least a correct shallow copy? Second question, is there a more idiomatic way to perform a deep (or shallow) copy?</p>\n\n<p>Edit:</p>\n\n<p>One other alternative I've played around with is really simple and uses the fact that arguments are passed by value.</p>\n\n<pre><code>func (s *Server) Copy() (s2 *Server) {\n    tmp := s\n    s2 = &amp;tmp\n    return\n}\n</code></pre>\n\n<p>Is this version any better? (Is it correct?)</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1435754503, "creation_date": 1435754503, "answer_id": 31161645, "question_id": 31160815, "link": "https://stackoverflow.com/questions/31160815/got-an-invalid-memory-address-error-while-following-a-pluralsight-go-tutorial/31161645#31161645", "title": "Got an invalid memory address error while following a Pluralsight Go tutorial", "body": "<p>You're ignoring errors returned by <code>Parse</code>. If you didn't, you'd see this:</p>\n\n<pre><code>template: test:2: function \"Title\" not defined\n</code></pre>\n\n<p>Your template is incorrect, so <code>Lookup(\"test\")</code> returns <code>nil</code>.</p>\n\n<pre><code>{{template \"header\" . Title}}\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>{{template \"header\" .Title}}\n</code></pre>\n\n<p>No space after the dot.</p>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 31161645, "answer_count": 1, "score": -3, "last_activity_date": 1458903797, "creation_date": 1435752328, "last_edit_date": 1458903797, "question_id": 31160815, "link": "https://stackoverflow.com/questions/31160815/got-an-invalid-memory-address-error-while-following-a-pluralsight-go-tutorial", "title": "Got an invalid memory address error while following a Pluralsight Go tutorial", "body": "<p>I am following a tutorial from Pluralsight and doing exactly what it says, and the compilation even works, but when refreshing the page on the browser the application panics and outputs error on the console and the http server does not work as expected.</p>\n\n<p>The src code that generates this error is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"text/template\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, req *http.Request) {\n        w.Header().Add(\"Content Type\", \"text/html\")\n        templates := template.New(\"template\")\n        templates.New(\"test\").Parse(doc)\n        templates.New(\"header\").Parse(header)\n        templates.New(\"footer\").Parse(footer)\n        context := Context{\n            [3]string{\"Lemon\", \"Orange\", \"Apple\"},\n            \"the title\",\n        }\n        templates.Lookup(\"test\").Execute(w, context)\n\n    })\n\n    http.ListenAndServe(\":80\", nil)\n}\n\nconst doc = `\n{{template \"header\" . Title}}\n    &lt;body&gt;\n        &lt;h1&gt;List of Fruit&lt;/h1&gt;\n        &lt;ul&gt;\n            {{range .Fruit}}\n                &lt;li&gt;{{.}}&lt;/li&gt;\n            {{end}}\n        &lt;/ul&gt;\n    &lt;/body&gt;\n`\n\nconst header = `\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;&lt;title&gt;{{.}}&lt;/title&gt;&lt;/head&gt;\n`\n\nconst footer = `\n&lt;/html&gt;\n`\n\ntype Context struct {\n    Fruit [3]string\n    Title string\n}\n</code></pre>\n\n<p>and the error messages from the console</p>\n\n<pre><code>2015/07/01 13:53:14 http: panic serving 127.0.0.1:56994: runtime error: invalid memory address or nil pointer dereference\ngoroutine 5 [running]:\nnet/http.func\u00b7011()\n        c:/go/src/net/http/server.go:1130 +0xc2\ntext/template.errRecover(0xc082097b48)\n        c:/go/src/text/template/exec.go:100 +0xc3\ntext/template.(*Template).Execute(0x0, 0x353378, 0xc082070280, 0x6a5000, 0xc082008840, 0x0, 0x0)\n        c:/go/src/text/template/exec.go:137 +0x249\nmain.func\u00b7001(0x353210, 0xc082070280, 0xc082020000)\n        D:/Go/src/main/main.go:19 +0x325\nnet/http.HandlerFunc.ServeHTTP(0x786560, 0x353210, 0xc082070280, 0xc082020000)\n        c:/go/src/net/http/server.go:1265 +0x48\nnet/http.(*ServeMux).ServeHTTP(0xc08205c360, 0x353210, 0xc082070280, 0xc082020000)\n        c:/go/src/net/http/server.go:1541 +0x184\nnet/http.serverHandler.ServeHTTP(0xc082044180, 0x353210, 0xc082070280, 0xc082020000)\n        c:/go/src/net/http/server.go:1703 +0x1a1\nnet/http.(*conn).serve(0xc082070000)\n        c:/go/src/net/http/server.go:1204 +0xb5e\ncreated by net/http.(*Server).Serve\n        c:/go/src/net/http/server.go:1751 +0x365\n2015/07/01 13:53:14 http: panic serving 127.0.0.1:56995: runtime error: invalid memory address or nil pointer dereference\ngoroutine 6 [running]:\nnet/http.func\u00b7011()\n        c:/go/src/net/http/server.go:1130 +0xc2\ntext/template.errRecover(0xc082067b48)\n        c:/go/src/text/template/exec.go:100 +0xc3\ntext/template.(*Template).Execute(0x0, 0x353378, 0xc082070320, 0x6a5000, 0xc082008a40, 0x0, 0x0)\n        c:/go/src/text/template/exec.go:137 +0x249\nmain.func\u00b7001(0x353210, 0xc082070320, 0xc0820200d0)\n        D:/Go/src/main/main.go:19 +0x325\nnet/http.HandlerFunc.ServeHTTP(0x786560, 0x353210, 0xc082070320, 0xc0820200d0)\n        c:/go/src/net/http/server.go:1265 +0x48\nnet/http.(*ServeMux).ServeHTTP(0xc08205c360, 0x353210, 0xc082070320, 0xc0820200d0)\n        c:/go/src/net/http/server.go:1541 +0x184\nnet/http.serverHandler.ServeHTTP(0xc082044180, 0x353210, 0xc082070320, 0xc0820200d0)\n        c:/go/src/net/http/server.go:1703 +0x1a1\nnet/http.(*conn).serve(0xc0820701e0)\n        c:/go/src/net/http/server.go:1204 +0xb5e\ncreated by net/http.(*Server).Serve\n        c:/go/src/net/http/server.go:1751 +0x365\n2015/07/01 13:53:14 http: panic serving 127.0.0.1:56997: runtime error: invalid memory address or nil pointer dereference\ngoroutine 13 [running]:\nnet/http.func\u00b7011()\n        c:/go/src/net/http/server.go:1130 +0xc2\ntext/template.errRecover(0xc08201fb48)\n        c:/go/src/text/template/exec.go:100 +0xc3\ntext/template.(*Template).Execute(0x0, 0x353378, 0xc082070460, 0x6a5000, 0xc082008dc0, 0x0, 0x0)\n        c:/go/src/text/template/exec.go:137 +0x249\nmain.func\u00b7001(0x353210, 0xc082070460, 0xc0820209c0)\n        D:/Go/src/main/main.go:19 +0x325\nnet/http.HandlerFunc.ServeHTTP(0x786560, 0x353210, 0xc082070460, 0xc0820209c0)\n        c:/go/src/net/http/server.go:1265 +0x48\nnet/http.(*ServeMux).ServeHTTP(0xc08205c360, 0x353210, 0xc082070460, 0xc0820209c0)\n        c:/go/src/net/http/server.go:1541 +0x184\nnet/http.serverHandler.ServeHTTP(0xc082044180, 0x353210, 0xc082070460, 0xc0820209c0)\n        c:/go/src/net/http/server.go:1703 +0x1a1\nnet/http.(*conn).serve(0xc0820703c0)\n        c:/go/src/net/http/server.go:1204 +0xb5e\ncreated by net/http.(*Server).Serve\n        c:/go/src/net/http/server.go:1751 +0x365\n2015/07/01 13:53:15 http: panic serving 127.0.0.1:56998: runtime error: invalid memory address or nil pointer dereference\ngoroutine 17 [running]:\nnet/http.func\u00b7011()\n        c:/go/src/net/http/server.go:1130 +0xc2\ntext/template.errRecover(0xc082067b48)\n        c:/go/src/text/template/exec.go:100 +0xc3\ntext/template.(*Template).Execute(0x0, 0x353378, 0xc0820701e0, 0x6a5000, 0xc082008840, 0x0, 0x0)\n        c:/go/src/text/template/exec.go:137 +0x249\nmain.func\u00b7001(0x353210, 0xc0820701e0, 0xc0820200d0)\n        D:/Go/src/main/main.go:19 +0x325\nnet/http.HandlerFunc.ServeHTTP(0x786560, 0x353210, 0xc0820701e0, 0xc0820200d0)\n        c:/go/src/net/http/server.go:1265 +0x48\nnet/http.(*ServeMux).ServeHTTP(0xc08205c360, 0x353210, 0xc0820701e0, 0xc0820200d0)\n        c:/go/src/net/http/server.go:1541 +0x184\nnet/http.serverHandler.ServeHTTP(0xc082044180, 0x353210, 0xc0820701e0, 0xc0820200d0)\n        c:/go/src/net/http/server.go:1703 +0x1a1\nnet/http.(*conn).serve(0xc082070000)\n        c:/go/src/net/http/server.go:1204 +0xb5e\ncreated by net/http.(*Server).Serve\n        c:/go/src/net/http/server.go:1751 +0x365\n</code></pre>\n\n<p>Don't know what to do here. Makes me feel a bit uneasy.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1435750600, "post_id": 31156938, "comment_id": 50328889, "body": "You might find this useful: <a href=\"http://stackoverflow.com/questions/30256729/how-to-traverse-through-xml-data-in-golang\">How to traverse through XML data in Golang?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "is_accepted": true, "score": 2, "last_activity_date": 1435752707, "last_edit_date": 1435752707, "creation_date": 1435748935, "answer_id": 31159600, "question_id": 31156938, "link": "https://stackoverflow.com/questions/31156938/error-when-trying-to-xml-unmarshal-to-struct-with-field-of-type-mapstringinter/31159600#31159600", "title": "Error when trying to xml.Unmarshal to struct with field of type map[string]interface{}", "body": "<p>depending what you need to do with meta at the end you might want to take a look at this lib: <a href=\"https://github.com/clbanning/mxj\" rel=\"nofollow\">https://github.com/clbanning/mxj</a></p>\n\n<p>you could do it just a little nicer if you implement a custom UnmarshalXML function</p>\n\n<pre><code>func (m *MyStruct) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    var v struct {\n        XMLName xml.Name `xml:\"myStruct\"`\n        Name    string   `xml:\"name\"`\n        Meta    struct {\n            Inner []byte `xml:\",innerxml\"`\n        } `xml:\"meta\"`\n    }\n\n\n    err := d.DecodeElement(&amp;v, &amp;start)\n    if err != nil {\n        return err\n    }\n\n    m.Name = v.Name\n    myMap := make(map[string]interface{})\n    // ... do the mxj magic here ... -\n    // fill myMap\n    m.Meta = myMap\n\n\n    return nil\n}\n\ntype MyStruct struct {\n    Name    string\n    Meta    map[string]interface{}\n}\n</code></pre>\n\n<p>`</p>\n\n<p>that leaves your MyStruct nice and clean</p>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1230, "favorite_count": 0, "accepted_answer_id": 31159600, "answer_count": 1, "score": 0, "last_activity_date": 1435818784, "creation_date": 1435741230, "last_edit_date": 1435818784, "question_id": 31156938, "link": "https://stackoverflow.com/questions/31156938/error-when-trying-to-xml-unmarshal-to-struct-with-field-of-type-mapstringinter", "title": "Error when trying to xml.Unmarshal to struct with field of type map[string]interface{}", "body": "<p>The problem is that xml.Unmarshal of a struct with a field of type map[string]interface{} will fail with the error:</p>\n\n<pre><code>unknown type map[string]interface {}\n{XMLName:{Space: Local:myStruct} Name:test Meta:map[]}\n</code></pre>\n\n<p>Since the Meta field of type map[string]interface{} is as far as I can define, what's inside has to be dynamically unmarshalled.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\nfunc main() {\n    var myStruct MyStruct\n\n    // meta is as far as we know, inside meta, dynamic properties and nesting will happen\n    s := `&lt;myStruct&gt;\n        &lt;name&gt;test&lt;/name&gt;\n        &lt;meta&gt;\n            &lt;someProp&gt;something&lt;/someProp&gt;\n            &lt;someOtherDynamic&gt;\n                &lt;name&gt;test&lt;/name&gt;\n                &lt;somethingElse&gt;test2&lt;/somethingElse&gt;\n                &lt;nested3&gt;\n                    &lt;name&gt;nested3&lt;/name&gt;\n                    &lt;nested3elements&gt;\n                        &lt;elem&gt;ele1&lt;/elem&gt;\n                        &lt;elem&gt;ele2&lt;/elem&gt;\n                    &lt;/nested3elements&gt;\n                &lt;/nested3&gt;\n            &lt;/someOtherDynamic&gt;\n        &lt;/meta&gt;\n    &lt;/myStruct&gt;`\n\n    err := xml.Unmarshal([]byte(s), &amp;myStruct)\n    if err == nil {\n        fmt.Printf(\"%+v\\n\", myStruct)\n    } else {\n        fmt.Println(err)\n        fmt.Printf(\"%+v\\n\", myStruct)\n    }\n}\n\ntype MyStruct struct {\n    XMLName xml.Name               `xml:\"myStruct\"`\n    Name    string                 `xml:\"name\"`\n    Meta    map[string]interface{} `xml:\"meta,omitempty\"`\n}\n</code></pre>\n\n<p>I've made an example here: <a href=\"http://play.golang.org/p/lTDJzXXPwT\" rel=\"nofollow\">http://play.golang.org/p/lTDJzXXPwT</a></p>\n\n<p>How can I achieve this?</p>\n\n<hr>\n\n<p><strong>My workaround \"solution\" so far:</strong></p>\n\n<p><a href=\"http://play.golang.org/p/gQUlvkYl7k\" rel=\"nofollow\">http://play.golang.org/p/gQUlvkYl7k</a></p>\n\n<p>Basically what happens is that:</p>\n\n<ol>\n<li>The Meta field got the xml annotations removed, thus being ignore from the xml.Unmashal</li>\n<li>New type, MapContainer, is created with a field: InnerXML []byte <code>xml:\",innerxml\"</code></li>\n<li>MetaByte field of type MapContainer is added using the <code>xml:\"meta,omitempty\"</code> annotations</li>\n</ol>\n\n<p>So in the first xml.Unmarshal we save a byte slice of the meta element's XML. Then in our custom xml unmarshal function we take that byteSlice and use the magic function NewMapXml from the mxj package, and set the Meta field of the struct to this newly created map.</p>\n\n<p>This is possible thanks to the genius made this repo, <a href=\"https://github.com/clbanning/mxj\" rel=\"nofollow\">https://github.com/clbanning/mxj</a> , which can unmarshal from XML to maps.</p>\n\n<p><strong>Updated current best solution:</strong></p>\n\n<p><a href=\"http://play.golang.org/p/_tw06klods\" rel=\"nofollow\">http://play.golang.org/p/_tw06klods</a></p>\n\n<p>Thanks to Adam Vincze</p>\n"}, {"tags": ["go", "interface", "type-conversion", "embedding"], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 4393843, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SMD24CPNLkQ/AAAAAAAAAAI/AAAAAAAAABE/dFnWcyHOJcA/photo.jpg?sz=128", "display_name": "JieMin Xia", "link": "https://stackoverflow.com/users/4393843/jiemin-xia"}, "is_accepted": false, "score": -3, "last_activity_date": 1435739679, "creation_date": 1435739679, "answer_id": 31156359, "question_id": 31156217, "link": "https://stackoverflow.com/questions/31156217/in-golang-why-i-cant-use-the-struct-as-nested-struct-type/31156359#31156359", "title": "In golang why I can&#39;t use the struct as nested struct type?", "body": "<p>Different type can't assign, GO do not support extension.</p>\n"}, {"comments": [{"owner": {"reputation": 3196, "user_id": 1541397, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/991c4e6d0872e18880e3e0ff51cdf5a2?s=128&d=identicon&r=PG", "display_name": "David Callanan", "link": "https://stackoverflow.com/users/1541397/david-callanan"}, "edited": false, "score": 0, "creation_date": 1588514772, "post_id": 31156750, "comment_id": 108920479, "body": "Why isn&#39;t a bufio reader and writer an interface in the first place?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1435741996, "last_edit_date": 1435741996, "creation_date": 1435740737, "answer_id": 31156750, "question_id": 31156217, "link": "https://stackoverflow.com/questions/31156217/in-golang-why-i-cant-use-the-struct-as-nested-struct-type/31156750#31156750", "title": "In golang why I can&#39;t use the struct as nested struct type?", "body": "<p><a href=\"https://golang.org/pkg/bufio/#NewReadWriter\" rel=\"nofollow\"><code>bufio.NewReadWriter()</code></a> returns a concrete type, a pointer to a <code>struct</code> and <a href=\"https://golang.org/pkg/bufio/#Writer\" rel=\"nofollow\"><code>bufio.Writer</code></a> is also a concrete type, a <code>struct</code>. Neither <code>*ReadWriter</code> and <code>*bufio.Writer</code> is an <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow\">interface</a>!</p>\n\n<p>In Go there is no automatic type conversion, you cannot assign a value of different concrete type to a variable.</p>\n\n<h3>You have 2 options:</h3>\n\n<ol>\n<li><p>Since <code>bufio.ReadWriter</code> embeds <code>*bufio.Writer</code>, you can simply refer to it and use that in the assignment:</p>\n\n<pre><code>var r *bufio.Writer\nr = rw.Writer\n</code></pre></li>\n<li><p>Or you can declare <code>r</code> to be an <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow\"><code>io.Writer</code></a> (it is an interface type) so that you can assign <code>rw</code> to it because <code>rw</code> implements <code>io.Writer</code>:</p>\n\n<pre><code>var r io.Writer\nr = rw\n</code></pre>\n\n<p>Although I don't think creating <code>r</code> in this case is particularly useful because whenever you would use <code>r</code> you could also use <code>rw</code>.</p></li>\n</ol>\n\n<p>Check out <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow\">Go spec: Assignability</a>:</p>\n\n<blockquote>\n  <p>A value <code>x</code> is assignable to a variable of type <code>T</code> (\"<code>x</code> is assignable to <code>T</code>\") in any of these cases:</p>\n  \n  <ul>\n  <li><code>x</code>'s type is identical to <code>T</code>.</li>\n  <li><code>x</code>'s type <code>V</code> and <code>T</code> have identical underlying types and at least one of <code>V</code> or <code>T</code> is not a named type.</li>\n  <li><code>T</code> is an interface type and <code>x</code> implements <code>T</code>.</li>\n  <li><code>x</code> is a bidirectional channel value, <code>T</code> is a channel type, <code>x</code>'s type <code>V</code> and <code>T</code> have identical element types, and at least one of <code>V</code> or <code>T</code> is not a named type.</li>\n  <li><code>x</code> is the predeclared identifier <code>nil</code> and <code>T</code> is a pointer, function, slice, map, channel, or interface type.</li>\n  <li><code>x</code> is an untyped constant representable by a value of type <code>T</code>.</li>\n  </ul>\n</blockquote>\n\n<p>None of the cases apply to your code, so it is an invalid assignment.</p>\n\n<p>When <code>r</code> is declared to be <code>io.Writer</code>, it is the the following case and therefore it is valid:</p>\n\n<blockquote>\n  <p><code>T</code> is an interface type and <code>x</code> implements <code>T</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2059, "favorite_count": 0, "accepted_answer_id": 31156750, "answer_count": 2, "score": 2, "last_activity_date": 1435741996, "creation_date": 1435739226, "last_edit_date": 1435741920, "question_id": 31156217, "link": "https://stackoverflow.com/questions/31156217/in-golang-why-i-cant-use-the-struct-as-nested-struct-type", "title": "In golang why I can&#39;t use the struct as nested struct type?", "body": "<p>The following code (<a href=\"http://play.golang.org/p/Uwr_TzM5OB\" rel=\"nofollow\">play</a>):</p>\n\n<pre><code>func main() {\n    buf := bytes.NewBuffer(make([]byte, 0))\n    rw := bufio.NewReadWriter(bufio.NewReader(buf), bufio.NewWriter(buf))\n    var r *bufio.Writer\n    r = rw\n}\n</code></pre>\n\n<p>Gives the following compile-time error:</p>\n\n<pre><code>cannot use rw (type *bufio.ReadWriter) as type *bufio.Writer in assignment\n</code></pre>\n\n<p>What I expected is use a struct as a nested struct type. But if I declare <code>r</code> as <code>io.Reader</code>, this will be ok, so should I move to interface?</p>\n"}, {"tags": ["http", "go", "server"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1435732109, "post_id": 31152768, "comment_id": 50317278, "body": "Compile it locally (cross-compiling if necessary) and then copy the binary to the server. One file. You shouldn&#39;t need to compile it on your server."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435736800, "post_id": 31152768, "comment_id": 50319885, "body": "would this lead to corruption of data because of simultaneous reads while overwriting or writes from users while overwriting the binary files?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435743022, "post_id": 31152768, "comment_id": 50323873, "body": "Don&#39;t live overwrite. Copy to a temp location, stop the service (gracefully if you must), overwrite the old binary and start the replacement. There are more elegant ways to swap them but unless you really can&#39;t survive a few <i>seconds</i> of planned downtime they involve a lot more complexity. e.g. a socket manager like Einhorn"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435744992, "post_id": 31152768, "comment_id": 50325158, "body": "thank you very much, I will gracefully end things."}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1435727468, "creation_date": 1435727468, "answer_id": 31152966, "question_id": 31152768, "link": "https://stackoverflow.com/questions/31152768/updating-code-on-production-server-when-using-go/31152966#31152966", "title": "Updating code on production server when using Go", "body": "<p>First of all, don't do it in that order.  Copy and install first.  Then you could stop the old process and run the new one.  </p>\n\n<p>If you run multiple instances of your app, then you can do a rolling update, so that when you bounce one server, the other ones are still serving.  A similar approach is to do <a href=\"https://www.google.ca/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=blue-green%20deployment\" rel=\"nofollow\">blue-green deployments</a>, which has the advantage that the code your active cluster is running is always homogeneous (whereas during a rolling deploy, you'll have a mixture until they've all rolled), and you can also do a blue-green deployment where you normally have only one instance of your app (whereas rolling requires more than one).  It does however require you to have double the instances during the blue-green switch.</p>\n\n<p>One thing you'll want to take into consideration is any in-flight requests -- you may want to make sure that in-flight requests continue to go to old-code servers until their finished.</p>\n\n<p>You can also look into Platform-as-a-Service solutions, that can automate a lot of this stuff for you, plus a whole lot more.  That way you're not ssh'ing into production servers and copying files around manually.  The <a href=\"http://12factor.net/\" rel=\"nofollow\">12 Factor App</a> principles are always a good place to start when thinking about ops.</p>\n"}, {"comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1435745033, "post_id": 31155276, "comment_id": 50325180, "body": "Thank you for the advice!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1435736277, "creation_date": 1435736277, "answer_id": 31155276, "question_id": 31152768, "link": "https://stackoverflow.com/questions/31152768/updating-code-on-production-server-when-using-go/31155276#31155276", "title": "Updating code on production server when using Go", "body": "<p>PHP is an <a href=\"https://en.wikipedia.org/wiki/Interpreted_language\" rel=\"nofollow\">interpreted language</a>, which means you provide your code in source format and the PHP interpreter will read it and execute it (it may create a more compact binary form so that it doesn't have to analyze the source again when needed).</p>\n\n<p>Go is a <a href=\"https://en.wikipedia.org/wiki/Compiled_language\" rel=\"nofollow\">compiled language</a>, it compiles into a native executable binary; going further it is <em>statically linked</em> which means every code and library your app is referring to is compiled and linked when the executable is created. This implies you can't just \"drop-in\" new go modules into a running application.</p>\n\n<p>You have to stop your running application and start the new version. You can however minimize the downtime: only stop the running application when the new version of the executable is already created and ready to be run. You may choose to compile it on a remote machine and upload the binary to the server, or upload the source and compile it on the server, it doesn't matter.</p>\n\n<p>With this you could decrease the downtime to a maximum of few seconds, which your users won't notice. Also you shouldn't update in every hour, you can't really achieve significant updates in just an hour of coding. You could schedule updates daily (or even less frequently), and you could schedule them for hours when your traffic is low.</p>\n\n<p>If even a few seconds downtime is not acceptable to you, then you should look for platforms which handle this for you automatically without any downtime. Check out <a href=\"https://cloud.google.com/appengine/docs/go/\" rel=\"nofollow\">Google App Engine - Go</a> for example.</p>\n"}, {"comments": [{"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1435745055, "post_id": 31155660, "comment_id": 50325196, "body": "Thanks, I will use that!"}], "tags": [], "owner": {"reputation": 76, "user_id": 2665446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28470def10eda769aea68284c919493f?s=128&d=identicon&r=PG", "display_name": "Antoine F", "link": "https://stackoverflow.com/users/2665446/antoine-f"}, "is_accepted": true, "score": 1, "last_activity_date": 1435737429, "creation_date": 1435737429, "answer_id": 31155660, "question_id": 31152768, "link": "https://stackoverflow.com/questions/31152768/updating-code-on-production-server-when-using-go/31155660#31155660", "title": "Updating code on production server when using Go", "body": "<p>The grace library will allow you to do graceful restarts without annoyance for your users: <a href=\"https://github.com/facebookgo/grace\" rel=\"nofollow\">https://github.com/facebookgo/grace</a></p>\n\n<p>Yet in my experience restarting Go applications is so quick, unless you have an high traffic website it won't cause any trouble.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 1, "accepted_answer_id": 31155660, "answer_count": 3, "score": 2, "last_activity_date": 1435737674, "creation_date": 1435726341, "last_edit_date": 1435737674, "question_id": 31152768, "link": "https://stackoverflow.com/questions/31152768/updating-code-on-production-server-when-using-go", "title": "Updating code on production server when using Go", "body": "<p>When I develop and update files on production server with PHP I just copy the files on the fly and everything seems to work without interrupting the server.</p>\n\n<p>But if I am to update the code on the Go server and application and would need to kill the server, copy the src files to the server, run go install, and then start the server, this would interrupt the service, and if I do this quite often then it is going to look very bad for my users of the service.</p>\n\n<p>How can I update files without the downtime when using Go with Go's http server?</p>\n"}, {"tags": ["networking", "go"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1435733534, "post_id": 31152704, "comment_id": 50318015, "body": "You need to read about the TCP backlog queue. A connection can succeed before the server calls <code>accept()</code>. It is placed on the backlog queue. The behaviour you want isn&#39;t implementable."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1436088368, "post_id": 31152704, "comment_id": 50457022, "body": "I actually ended-up with a different / dedicated connection which manages the connections pool. Thanks for your help!"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435744448, "creation_date": 1435725947, "last_edit_date": 1435744448, "question_id": 31152704, "link": "https://stackoverflow.com/questions/31152704/why-net-dial-is-not-blocking-until-the-connection-is-accepted", "title": "Why net.Dial is not blocking until the connection is accepted?", "body": "<p>Why Dial doesn't block until the connection is accepted? Or is there any way that I can detect that the connection was not accepted so that I can avoid  draining my server resources? If I try to read the connection I get blocked forever (as the connection was not accepted) and  I might loose the opportunity to connect/dial with the server when it decides to accept my connection too. If I launch new go routines to read from each connection returned by Dial the server gets exhausted (i.e. it can't handle thousands of go routines per second).</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net\"\n    \"time\"\n)\n\nfunc main() {\n    go listen()\n    // wait the listener\n    time.Sleep(1)\n    dial()\n}\nfunc listen() {\n    dstNet := &amp;net.TCPAddr{IP: net.ParseIP(\"0.0.0.0\"), Port: 9090}\n    // Listen on the dstNet\n    _, err := net.ListenTCP(\"tcp\", dstNet)\n    if err != nil {\n        panic(err)\n    }\n    time.Sleep(30 * time.Second)\n}\nfunc dial() {\n    dstNet := &amp;net.TCPAddr{IP: net.ParseIP(\"127.0.0.1\"), Port: 9090}\n    for {\n        log.Printf(\"dialing\")\n        conn, err := net.DialTCP(\"tcp\", nil, dstNet)\n        if err != nil {\n            panic(err)\n            //return\n        }\n        log.Printf(\"new conn %v\", conn)\n    }\n}\n</code></pre>\n\n<p>//Reason why I need dial to block call:</p>\n\n<p>I'm trying to implement a reverse socks server:</p>\n\n<p><code>server x behind NAT</code> connects to -> <code>server y internet</code></p>\n\n<p><code>client z from internet</code> connects to -> server y</p>\n\n<p>so the issue is that the server behind NAT gets a lot of connections(due non-blocking Dial) even if <code>server y</code> didn't accept any. </p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1435717232, "last_edit_date": 1435717232, "creation_date": 1435708658, "answer_id": 31150469, "question_id": 31150418, "link": "https://stackoverflow.com/questions/31150418/can-not-retrieve-value-using-mgo-when-the-key-contains-uppercase/31150469#31150469", "title": "Can not retrieve value using mgo when the key contains uppercase", "body": "<p>There is a syntax error in the field tag. Remove the space between the ':' and the '\"' in the field tag.</p>\n\n<pre><code>TimeStamp   string `bson:\"timeStamp\" json:\"timeStamp\"`\n</code></pre>\n\n<p>The syntax for field tags is unforgiving.</p>\n\n<p>Separate from this issue, you should probably add</p>\n\n<pre><code>ID bson.ObjectId `bson:\"_id\"` \n</code></pre>\n\n<p>to the struct the application can access the object id.</p>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 31150469, "answer_count": 1, "score": 0, "last_activity_date": 1435717232, "creation_date": 1435708272, "last_edit_date": 1435710944, "question_id": 31150418, "link": "https://stackoverflow.com/questions/31150418/can-not-retrieve-value-using-mgo-when-the-key-contains-uppercase", "title": "Can not retrieve value using mgo when the key contains uppercase", "body": "<p>One data from mongoDB is</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"5536def4e4b0644323e219a8\"),\n    \"title\" : \"The Title\",\n    \"description\" : \"The Description\",\n    \"timeStamp\" : \"21/04/2015\",\n    \"category\" : \"news\",\n    \"url\" : \"http://www.example.com\",\n    \"source\" : \"Evening Times\",\n    \"mainStory\" : \"This is the main story.\"\n}\n</code></pre>\n\n<p>In my code, the structure is</p>\n\n<pre><code>type NewsData struct {\n    Title       string `bson: \"title\" json: \"title\"`\n    TimeStamp   string `bson: \"timeStamp\" json: \"timeStamp\"`\n    Description string `bson: \"description\" json: \"description\"`\n    MainStory   string `bson: \"mainStory\" json:\"mainStory\"`\n}\n</code></pre>\n\n<p>Then I use the following code to extract information</p>\n\n<pre><code>err = conn.Find(nil).Select(bson.M{\"title\": 1, \"timeStamp\": 1, \"description\": 1, \"mainStory\": 1}).All(&amp;result)\n</code></pre>\n\n<p>However, when I print <code>result</code> out, the value of <code>timeStamp</code> and <code>mainStory</code> is empty. I checked the documents, it says that mgo take the key as lowercase, so when the key in mongoDB contains uppercase, it would be a problem.</p>\n\n<p>How can I fix this problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435708410, "post_id": 31149940, "comment_id": 50310905, "body": "Writing a systemd unit file is going to (relatively) straightforward and give you a familar interface. As touched on by @Verran, you could also use <a href=\"http://elithrar.github.io/article/running-go-applications-in-the-background/\" rel=\"nofollow noreferrer\">Supervisor</a> (I wrote a blog post on how to set it up for a Go binary) as well; plus all of the other options like monit/runit/Upstart, etc."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435709416, "post_id": 31149940, "comment_id": 50311194, "body": "Cool. I&#39;d like to read that blog post, what is the url?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435709601, "post_id": 31149940, "comment_id": 50311242, "body": "Click the word Supervisor in my first comment (StackOverflow doesn&#39;t make links obvious!)"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435709977, "post_id": 31149940, "comment_id": 50311332, "body": "thanks man that is awesome!"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435755904, "post_id": 31149940, "comment_id": 50332748, "body": "for some reason I can&#39;t run as deamon with supervisord unless it is with root. Do you know anything about that elithrar?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435759704, "post_id": 31149940, "comment_id": 50335795, "body": "Your Go application shouldn&#39;t need root. Supervisor should not but it will depend if your Go app is trying to bind to port 80\u2014which requires root or the capability to do so. If that&#39;s what you&#39;re trying to do, <code>setcap cap_net_bind_service=+ep &#47;path&#47;to&#47;your&#47;go&#47;binary</code> will provide that. If you&#39;re still having issues raise a fresh question with your error messages under the [supervisor] tag here on SO."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435760879, "post_id": 31149940, "comment_id": 50336720, "body": "It worked, I want to donate for the help. Been trying for the whole day.."}], "answers": [{"tags": [], "owner": {"reputation": 3365, "user_id": 1736884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c85628cff13ad6178dee34c769fa727?s=128&d=identicon&r=PG", "display_name": "Verran", "link": "https://stackoverflow.com/users/1736884/verran"}, "is_accepted": true, "score": 0, "last_activity_date": 1435708042, "creation_date": 1435708042, "answer_id": 31150372, "question_id": 31149940, "link": "https://stackoverflow.com/questions/31149940/running-go-as-a-daemon-webserver-on-centos-7/31150372#31150372", "title": "Running Go as a daemon webserver on CentOS 7", "body": "<p>This is less of a Go question and more of a Systems Administration question. There are ways to add a command to systemd (like in <a href=\"https://scottlinux.com/2014/12/08/how-to-create-a-systemd-service-in-linux-centos-7/\" rel=\"nofollow\">this blog post</a>).</p>\n\n<p>Personally, I prefer to keep my applications separate from my services, so I tend to use <a href=\"http://supervisord.org/\" rel=\"nofollow\">supervisord</a> for my programs that tend to be started, stopped, or restarted frequently. The documentation for supervisord is pretty straightforward, but essentially you can create a config file to describe the services you want to run, the command used to run it (such as <code>/path/to/go/binary -flag</code>) how you want to handle starting, stopping, failure recovery, logging, etc....</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 0, "accepted_answer_id": 31150372, "answer_count": 1, "score": -1, "last_activity_date": 1435708042, "creation_date": 1435705236, "question_id": 31149940, "link": "https://stackoverflow.com/questions/31149940/running-go-as-a-daemon-webserver-on-centos-7", "title": "Running Go as a daemon webserver on CentOS 7", "body": "<p>I am trying to migrate from PHP to Go and planning to drop nginx alltogether. But I don't know how to run the go http webserver as a deamon in the background and I also don't know how to automatically start the webserver if I make a reboot, or how to kill the process.</p>\n\n<p>With nginx all I do is</p>\n\n<pre><code>$ systemctl start nginx.service\n$ systemctl restart nginx.service\n$ systemctl stop nginx.service\n$ systemctl enable nginx.service\n$ systemctl disable nginx.service\n</code></pre>\n\n<p>This is very convenient, but it seems like I can't do this with Go http server. I have to compile and run it as any other Go program. What solutions do exist for these concerns?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2684, "user_id": 800057, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/31b3500592afcf17828cbc1bf2275e73?s=128&d=identicon&r=PG", "display_name": "aacanakin", "link": "https://stackoverflow.com/users/800057/aacanakin"}, "edited": false, "score": 0, "creation_date": 1435705038, "post_id": 31149810, "comment_id": 50309930, "body": "well, I don&#39;t have to define a map struct. I may initialize a var and pass it&#39;s function to <code>app.GET()</code>. Is it more convenient to use that?"}, {"owner": {"reputation": 2684, "user_id": 800057, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/31b3500592afcf17828cbc1bf2275e73?s=128&d=identicon&r=PG", "display_name": "aacanakin", "link": "https://stackoverflow.com/users/800057/aacanakin"}, "edited": false, "score": 0, "creation_date": 1435705150, "post_id": 31149810, "comment_id": 50309973, "body": "btw, <code>ss[&quot;auth&quot;].(func(ctx *gin.Context)).Ping</code> doesn&#39;t work"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 2684, "user_id": 800057, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/31b3500592afcf17828cbc1bf2275e73?s=128&d=identicon&r=PG", "display_name": "aacanakin", "link": "https://stackoverflow.com/users/800057/aacanakin"}, "edited": false, "score": 0, "creation_date": 1435705237, "post_id": 31149810, "comment_id": 50310004, "body": "@aacanakin yeah, there was one thing I didn&#39;t really notice which is that you have a recieving type of <code>s *StatusService</code> for <code>Ping</code> so you actually need do the type assert for that. I&#39;ll update that example."}, {"owner": {"reputation": 2684, "user_id": 800057, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/31b3500592afcf17828cbc1bf2275e73?s=128&d=identicon&r=PG", "display_name": "aacanakin", "link": "https://stackoverflow.com/users/800057/aacanakin"}, "edited": false, "score": 0, "creation_date": 1435705415, "post_id": 31149810, "comment_id": 50310061, "body": "thanks. It works! <code>app.GET(&quot;&#47;ping&quot;, (*statusService).Ping)</code>"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 2, "last_activity_date": 1435705266, "last_edit_date": 1495535208, "creation_date": 1435704328, "answer_id": 31149810, "question_id": 31149756, "link": "https://stackoverflow.com/questions/31149756/calling-function-from-mapstringinterface-by-giving-key/31149810#31149810", "title": "calling function from map[string]interface{} by giving key", "body": "<p><code>interface{}</code> works for just about any type, the problem is that you've failed to assert which type the thing is. In this case you would need something like... <code>ss[\"auth\"].(*StatusService).Ping(myCtxInstance)</code>. This answer has a more thorough example which I'll refrain from duplicating; <a href=\"https://stackoverflow.com/questions/6769020/go-map-of-functions\">Go map of functions</a></p>\n\n<p>Couple other things; if your real use case is as simple as your example just stop what you're doing and add <code>func(ctx *gin.Context)</code> as a second argument. Also, depending on the nature of the functions you want to use (like if they all have the same args and return types) then you might want to use a second arg for the delegates, <code>map[string]func(argumentType)</code> would be more appropriate.</p>\n\n<p>The design you currently have pushes all errors to runtime which obviously is less desirable than the compile time safety you'd get from either of the options I touched on above.</p>\n"}], "owner": {"reputation": 2684, "user_id": 800057, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/31b3500592afcf17828cbc1bf2275e73?s=128&d=identicon&r=PG", "display_name": "aacanakin", "link": "https://stackoverflow.com/users/800057/aacanakin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 31149810, "answer_count": 1, "score": -2, "last_activity_date": 1435705266, "creation_date": 1435704010, "question_id": 31149756, "link": "https://stackoverflow.com/questions/31149756/calling-function-from-mapstringinterface-by-giving-key", "title": "calling function from map[string]interface{} by giving key", "body": "<p>I want to be able to pass function name to gin.Engine route handler. I have the following code;</p>\n\n<pre><code>// status service\ntype StatusService struct {\n    App *gin.Engine\n}\n\nfunc (s *StatusService) Ping(ctx *gin.Context) {\n    ctx.JSON(200, gin.H{\n        \"message\": \"pong\",\n    })\n}\n\napp := gin.Default()\n// define services\nstatusService := &amp;services.StatusService{\n    App: app,\n}\nss := make(map[string]interface{})\nss[\"auth\"] = statusService\n\napp.GET(\"/ping\", ss[\"auth\"].Ping)\n</code></pre>\n\n<p>The compiler gives the following error;</p>\n\n<pre><code>./app.go:60: ss[\"auth\"].Ping undefined (type interface {} has no field or method Ping)\n</code></pre>\n\n<p>Any ideas about how to fix that?</p>\n"}, {"tags": ["http", "url", "go"], "answers": [{"comments": [{"owner": {"reputation": 15015, "user_id": 1191635, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/I8bEt.jpg?s=128&g=1", "display_name": "Armeen Harwood", "link": "https://stackoverflow.com/users/1191635/armeen-harwood"}, "edited": false, "score": 0, "creation_date": 1435704425, "post_id": 31149664, "comment_id": 50309737, "body": "Thanks Tim totally just learning this by watching <a href=\"http://www.pluralsight.com/courses/creating-web-applications-go\" rel=\"nofollow noreferrer\">pluralsight.com/courses/creating-web-applications-go</a>  These are just questions popping up that I cannot seem to find simple answer to on stack! thanks again!"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1435704217, "last_edit_date": 1435704217, "creation_date": 1435703486, "answer_id": 31149664, "question_id": 31149304, "link": "https://stackoverflow.com/questions/31149304/how-to-remove-the-index-html-path-from-url-in-golang/31149664#31149664", "title": "How to remove the index.html path from url in golang", "body": "<p>Add a condition to serve index.html if the URL path is empty:</p>\n\n<pre><code>path := \"public\"\nif req.URL.Path == \"/\" {\n    path += \"/index.html\"\n} else {\n    path += req.URL.Path\n}\n</code></pre>\n\n<p>Also, it would be a good idea to use <a href=\"https://godoc.org/net/http#ServeFile\" rel=\"nofollow\"><code>net/http.ServeFile</code></a> over manually writing the data to the output stream (see <a href=\"https://godoc.org/net/http#ServeContent\" rel=\"nofollow\"><code>net/http#ServeContent</code></a>'s documentation to learn why this is a good idea).</p>\n\n<p>It's also worth noting that a <a href=\"https://godoc.org/net/http#FileServer\" rel=\"nofollow\">built-in handler for serving files</a> exists.</p>\n"}], "owner": {"reputation": 15015, "user_id": 1191635, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/I8bEt.jpg?s=128&g=1", "display_name": "Armeen Harwood", "link": "https://stackoverflow.com/users/1191635/armeen-harwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "accepted_answer_id": 31149664, "answer_count": 1, "score": 3, "last_activity_date": 1435704217, "creation_date": 1435701688, "last_edit_date": 1435703547, "question_id": 31149304, "link": "https://stackoverflow.com/questions/31149304/how-to-remove-the-index-html-path-from-url-in-golang", "title": "How to remove the index.html path from url in golang", "body": "<p>How do I remove the <code>index.html</code> from my URL bar e.g. <code>localhost:8000/index.html</code></p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n    http.Handle(\"/\", new(MyHandler))\n\n    http.ListenAndServe(\":8000\", nil)\n}\ntype MyHandler struct {\n    http.Handler\n}\n\nfunc (this *MyHandler) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    path := \"public\" + req.URL.Path\n    data, err := ioutil.ReadFile(string(path))\n\n    if err == nil {\n        w.Write(data)\n    } else {\n        w.WriteHeader(404)\n        w.Write([]byte(\"404 - \" + http.StatusText(404)))\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1435707381, "last_edit_date": 1592644375, "creation_date": 1435701860, "answer_id": 31149346, "question_id": 31149191, "link": "https://stackoverflow.com/questions/31149191/are-the-argument-passing-semantics-for-methods-on-structs-purely-determined-by-t/31149346#31149346", "title": "Are the argument passing semantics for methods on structs purely determined by the method and not by the caller?", "body": "<blockquote>\n<p>This behavior seems to imply that whether the argument v or a pointer to v to passed depends entirely on the definition of the method, rather than on what is actually being passed.</p>\n<p>Is this a correct interpretation, and will this always be the case? If not, what is the correct explanation for this behavior?</p>\n</blockquote>\n<p>No, this is not correct but it is almost correct.</p>\n<p>What gets passed to your method <strong>is</strong> a pointer, even if it looks like <code>v.Mutate()</code> with <code>v</code> a non-pointer. The reason is: Your <code>v</code> is &quot;addressable&quot; and thus its method set includes methods on the pointer type. See <a href=\"http://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">http://golang.org/ref/spec#Calls</a> for details. This is a kind of syntactic sugar. Because <code>v</code> is addressable you may take its address <code>&amp;v</code> and on this pointer you may invoke your method like <code>(&amp;v).Mutate</code>. This syntax is clumsy and Go automatically does it for you for addressable expressions.</p>\n<p>(If you are interested in such stuff, why not read the whole language specification? It can be done in 3 hours.)</p>\n"}], "owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 1, "accepted_answer_id": 31149346, "answer_count": 1, "score": 2, "last_activity_date": 1435707381, "creation_date": 1435701209, "question_id": 31149191, "link": "https://stackoverflow.com/questions/31149191/are-the-argument-passing-semantics-for-methods-on-structs-purely-determined-by-t", "title": "Are the argument passing semantics for methods on structs purely determined by the method and not by the caller?", "body": "<p>Consider the following simple program, where we define a method on a pointer to the struct <code>Vertex</code> and then invoke it with a pointer.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Vertex struct {\n    X, Y float64\n}\n\nfunc (v *Vertex) Mutate()  {\n    v.X = 8\n}\n\nfunc main() {\n    v := &amp;Vertex{3, 4}\n    v.Mutate()\n    fmt.Println(v.X)\n}\n</code></pre>\n\n<p>The output of this program is <code>8</code>, which we expect because we are passing a pointer to a method which takes a pointer. </p>\n\n<p>However, the following invocation also has an output of 8.</p>\n\n<pre><code>func main() {\n    v := Vertex{3, 4}\n    v.Mutate()\n    fmt.Println(v.X)\n}\n</code></pre>\n\n<p>Symmetrically, if we redefine the method <code>Mutate</code> to take a <code>Vertex</code> instead of a pointer, then the mutation fails regardless of whether a pointer or a struct is passed.</p>\n\n<p>This behavior seems to imply that whether the argument <code>v</code> or a pointer to <code>v</code> to passed depends entirely on the definition of the method, rather than on what is actually being passed.</p>\n\n<p>Is this a correct interpretation, and will this always be the case? If not, what is the correct explanation for this behavior?</p>\n"}, {"tags": ["go", "beego"], "answers": [{"tags": [], "owner": {"reputation": 2426, "user_id": 82906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ffe64eaead3a365bac8afa0272177526?s=128&d=identicon&r=PG", "display_name": "Sneal", "link": "https://stackoverflow.com/users/82906/sneal"}, "is_accepted": true, "score": 3, "last_activity_date": 1435697967, "creation_date": 1435697967, "answer_id": 31148404, "question_id": 31147471, "link": "https://stackoverflow.com/questions/31147471/beego-how-do-i-use-if-else-conditions-in-templates/31148404#31148404", "title": "Beego: How do I use If-else conditions in templates?", "body": "<p>From <a href=\"http://beego.me/docs/mvc/view/view.md\" rel=\"nofollow\">Beego Template Parsing</a> docs:</p>\n\n<blockquote>\n  <p>Beego uses Go\u2019s builtin package <a href=\"http://golang.org/pkg/html/template/\" rel=\"nofollow\">html/template</a> as the template parser.</p>\n</blockquote>\n\n<p><a href=\"https://github.com/beego/samples/blob/c9a2f4eabafd5260be184159a63aa279e5cf5093/WebIM/views/base/head.html#L10\" rel=\"nofollow\">Beego WebIM Sample</a>:</p>\n\n<pre><code>&lt;script src=\"/static/js/jquery-1.10.1.min.js\"&gt;&lt;/script&gt;\n{{if .IsLongPolling}}\n&lt;script src=\"/static/js/longpolling.js\"&gt;&lt;/script&gt;\n{{else}}\n&lt;script src=\"/static/js/websocket.js\"&gt;&lt;/script&gt;\n{{end}}\n</code></pre>\n"}], "owner": {"reputation": 1636, "user_id": 539133, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f66837101863aea91fd42192b0639c22?s=128&d=identicon&r=PG", "display_name": "Glstunna", "link": "https://stackoverflow.com/users/539133/glstunna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2237, "favorite_count": 0, "accepted_answer_id": 31148404, "answer_count": 1, "score": 1, "last_activity_date": 1435697967, "creation_date": 1435694599, "question_id": 31147471, "link": "https://stackoverflow.com/questions/31147471/beego-how-do-i-use-if-else-conditions-in-templates", "title": "Beego: How do I use If-else conditions in templates?", "body": "<p>How do I use conditions in beego's templating system?\nOr is it just expected that we use this for templating instead?</p>\n\n<p><a href=\"https://github.com/ipfans/beego-pongo2.v2\" rel=\"nofollow\">https://github.com/ipfans/beego-pongo2.v2</a></p>\n\n<p>I'd like to try my best first to do this Beego's way before latching something else on here. I mean....surely conditional rendering was thought of when creating beego's stock templating system right?</p>\n\n<p>While we're at it what about looping?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 15505, "user_id": 857238, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e7efe5b6a2b92bb52c23a639b88b544c?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/857238/chris"}, "is_accepted": true, "score": 3, "last_activity_date": 1435692128, "creation_date": 1435692128, "answer_id": 31146687, "question_id": 31146205, "link": "https://stackoverflow.com/questions/31146205/timeout-for-input-in-terminal-go-application/31146687#31146687", "title": "timeout for input in terminal go application", "body": "<p>The problem has to do with the way you're getting the user's input. On a timeout you spawn a new go routine asking for input, but the old one that you had spawned previously is still there grabbing input and sending it to a channel that no one is listening to any more.</p>\n\n<p>Changing it to something like this would fix the problem:</p>\n\n<pre><code>func getInput(input chan string) {\n    for {\n        in := bufio.NewReader(os.Stdin)\n        result, err := in.ReadString('\\n')\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        input &lt;- result\n    }\n}\n\nfunc main() {\n    input := make(chan string, 1)\n    go getInput(input)\n\n    for {\n        fmt.Println(\"input something\")\n\n        select {\n        case i := &lt;-input:\n            fmt.Println(\"result\")\n            fmt.Println(i)\n        case &lt;-time.After(4000 * time.Millisecond):\n            fmt.Println(\"timed out\")\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2085, "favorite_count": 2, "accepted_answer_id": 31146687, "answer_count": 1, "score": 1, "last_activity_date": 1435692128, "creation_date": 1435690434, "question_id": 31146205, "link": "https://stackoverflow.com/questions/31146205/timeout-for-input-in-terminal-go-application", "title": "timeout for input in terminal go application", "body": "<p>I am trying to make a terminal <code>golang</code> application, where a user has 4 seconds to input something. If he inputted something faster, print result and ask him input again for 4 seconds. </p>\n\n<p>If a user will not return input in 4 seconds, the program must write <code>time out</code> and ask him input again. </p>\n\n<p>My code does this, but only once. After the first <code>timeout</code> it won't return any result even if a user was faster that 4 seconds. I cannot figure out why this is so. </p>\n\n<p>The code</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"time\"\n)\n\nvar (\n    result string\n    err    error\n)\n\nfunc getInput(input chan string) {\n    in := bufio.NewReader(os.Stdin)\n    result, err := in.ReadString('\\n')\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    input &lt;- result\n}\n\nfunc main() {\n    for {\n        fmt.Println(\"input something\")\n        input := make(chan string, 1)\n        go getInput(input)\n\n        select {\n        case i := &lt;-input:\n            fmt.Println(\"result\")\n            fmt.Println(i)\n        case &lt;-time.After(4000 * time.Millisecond):\n            fmt.Println(\"timed out\")\n        }\n    }\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>input something\n123\nresult\n123\n\ninput something\n2\nresult\n2\n\ninput something\ntimed out\ninput something\n2\ntimed out\ninput something\ntimed out\ninput something\n</code></pre>\n"}, {"tags": ["struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1435691036, "creation_date": 1435691036, "answer_id": 31146358, "question_id": 31146179, "link": "https://stackoverflow.com/questions/31146179/using-a-struct-to-pass-multiple-values-go/31146358#31146358", "title": "Using a struct to pass multiple values GO", "body": "<p>You cannot do this, it is not possible.</p>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": true, "score": 0, "last_activity_date": 1435692071, "creation_date": 1435692071, "answer_id": 31146669, "question_id": 31146179, "link": "https://stackoverflow.com/questions/31146179/using-a-struct-to-pass-multiple-values-go/31146669#31146669", "title": "Using a struct to pass multiple values GO", "body": "<p>You can create a method on struct Pack, that will initialize the values. For example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Pack struct {\n    d, r int\n}\n\nfunc (p *Pack) init (a, b int) {\n    p.d = a / b\n    p.r = a ^ b\n}\n\nfunc main() {\n    pack := Pack{}   // d and r are initialized to 0 here\n    pack.init(10, 4)\n    fmt.Println(pack)\n\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>{2 14}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/twzvxHbPik\" rel=\"nofollow\">goplayground</a></p>\n"}], "owner": {"reputation": 109, "user_id": 3706719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c8d39e6e3960146c27e593ceb2f36ee?s=128&d=identicon&r=PG&f=1", "display_name": "Sapotero", "link": "https://stackoverflow.com/users/3706719/sapotero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 31146669, "answer_count": 2, "score": -2, "last_activity_date": 1435692071, "creation_date": 1435690359, "question_id": 31146179, "link": "https://stackoverflow.com/questions/31146179/using-a-struct-to-pass-multiple-values-go", "title": "Using a struct to pass multiple values GO", "body": "<p>I have just one question\nI wrote an example here</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\ntype PACK struct {\n  d, r int\n}\n\nfunc main() {\n\n  st := &amp;PACK{}\n  st.d, st.r = f(12, 32)\n}\n\nfunc f(a, b int) (d int, r int) {\n  d = a / b\n  r = a ^ b\n  return\n}\n</code></pre>\n\n<p>So, the question is - how can i make thing like this</p>\n\n<pre><code>st := &amp;PACK{ f(1,2) }\n</code></pre>\n\n<p>I want my function return arguments to be a struct initializer!</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 15015, "user_id": 1191635, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/I8bEt.jpg?s=128&g=1", "display_name": "Armeen Harwood", "link": "https://stackoverflow.com/users/1191635/armeen-harwood"}, "edited": false, "score": 1, "creation_date": 1435688724, "post_id": 31145564, "comment_id": 50301708, "body": "Why -1? Is this really a poorly asked question?"}, {"owner": {"reputation": 5634, "user_id": 2517730, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Xojng.jpg?s=128&g=1", "display_name": "Yar", "link": "https://stackoverflow.com/users/2517730/yar"}, "edited": false, "score": 0, "creation_date": 1451509918, "post_id": 31145564, "comment_id": 56816648, "body": "Actually that&#39;s a very good question imo"}], "answers": [{"comments": [{"owner": {"reputation": 15015, "user_id": 1191635, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/I8bEt.jpg?s=128&g=1", "display_name": "Armeen Harwood", "link": "https://stackoverflow.com/users/1191635/armeen-harwood"}, "edited": false, "score": 0, "creation_date": 1435689209, "post_id": 31145769, "comment_id": 50301974, "body": "yeah, The func literal was just the error it throws when you dont set it as a pointer."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 13, "last_activity_date": 1435688998, "creation_date": 1435688998, "answer_id": 31145769, "question_id": 31145564, "link": "https://stackoverflow.com/questions/31145564/why-must-the-http-request-argument-be-a-pointer/31145769#31145769", "title": "Why must the http.Request argument be a pointer?", "body": "<p>Because it's a large struct. Copying it would be expensive. So it's a pointer to a struct, which is common in Go when structs are large. Also it has some state, so it would likely be confusing if it were copied. It would make no sense to be a func literal; I don't understand why that would be an option.</p>\n"}, {"comments": [{"owner": {"reputation": 15015, "user_id": 1191635, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/I8bEt.jpg?s=128&g=1", "display_name": "Armeen Harwood", "link": "https://stackoverflow.com/users/1191635/armeen-harwood"}, "edited": false, "score": 1, "creation_date": 1435689400, "post_id": 31145772, "comment_id": 50302096, "body": "Lots of tasty bits in this that i&#39;ll have to dive into i.e. delegating, reflection, control flow lol but I&#39;ll assume this is the most correct answer.  Thanks for your efforts! I&#39;ll figure this all out :)"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 15015, "user_id": 1191635, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/I8bEt.jpg?s=128&g=1", "display_name": "Armeen Harwood", "link": "https://stackoverflow.com/users/1191635/armeen-harwood"}, "edited": false, "score": 1, "creation_date": 1435689757, "post_id": 31145772, "comment_id": 50302293, "body": "@MatthewHarwood bear in mind my description is fairly abstract. The code itself that does this is here; <a href=\"http://golang.org/src/net/http/server.go\" rel=\"nofollow noreferrer\">golang.org/src/net/http/server.go</a> if you want see what <code>HandleFunc</code> actually does with it&#39;s <code>func(w http.ResponseWriter, r *http.Request)</code> argument. Also, note that you can define a function with that sig normally elsewhere and pass it by name."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1435703240, "last_edit_date": 1435703240, "creation_date": 1435689015, "answer_id": 31145772, "question_id": 31145564, "link": "https://stackoverflow.com/questions/31145564/why-must-the-http-request-argument-be-a-pointer/31145772#31145772", "title": "Why must the http.Request argument be a pointer?", "body": "<p>Because that's how functions work. They have arguments and when you invoke them you must provide the required arguments. The types have to be the same as well.</p>\n\n<p>I think you're really asking; Why is it designed that way?</p>\n\n<p>Because you're providing a delegate for <code>http.HandleFunc</code> to invoke when a request is made to the root <code>\"/\"</code>. In most cases when a RESTful API is handling a request it needs to know information in the request, stuff like the headers, query parameters and/or post body... If you don't want to make use of that information you don't have to, it's not much overhead to pass a reference into a function. But for just about every real use case, the data is needed so it's included, so it is made an argument in the delegate you provide. From the persepctive of their implemenation, they need to know what the method signature is that you provide so they can invoke it.</p>\n\n<p>So to clarify, the thing you're looking at is the required signature for the <code>func</code> you provide as the second argument to <code>http.HandleFunc</code>. The first argument is the path. It invokes that method when an http request is made to the provided path. That code is going to call that argument call it <code>handler</code> and it needs a consistent definition so that it can do <code>handler(resp, req)</code> and not have to do reflection or a switch or some other control flow just to call into your code.</p>\n"}], "owner": {"reputation": 15015, "user_id": 1191635, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/I8bEt.jpg?s=128&g=1", "display_name": "Armeen Harwood", "link": "https://stackoverflow.com/users/1191635/armeen-harwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 3, "accepted_answer_id": 31145769, "answer_count": 2, "score": 5, "last_activity_date": 1435759081, "creation_date": 1435688312, "last_edit_date": 1435759081, "question_id": 31145564, "link": "https://stackoverflow.com/questions/31145564/why-must-the-http-request-argument-be-a-pointer", "title": "Why must the http.Request argument be a pointer?", "body": "<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request){\n        w.Write([]byte(\"hello world\"))\n    })\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>If I remove the <code>*</code> in <code>http.Request</code>:</p>\n\n<blockquote>\n  <p>github.com/creating_web_app_go/main.go:8: cannot use func literal (type func(http.ResponseWriter, http.Request)) as type func(http.ResponseWriter, *http.Request) in argument to http.HandleFunc</p>\n</blockquote>\n\n<p>I'm very new to both Go and pointers.</p>\n\n<p>So the Question is,\nwhy must <code>http.Request</code> be a pointer rather than a <code>func literal</code>?  Can anyone explain this in the simplest way possible, with perhaps a reference to source code?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 632, "user_id": 872227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ddef50299354758664f679265746cd?s=128&d=identicon&r=PG", "display_name": "freeformz", "link": "https://stackoverflow.com/users/872227/freeformz"}, "edited": false, "score": 0, "creation_date": 1435684122, "post_id": 31144153, "comment_id": 50299088, "body": "What are your trying to do?"}], "answers": [{"tags": [], "owner": {"reputation": 632, "user_id": 872227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ddef50299354758664f679265746cd?s=128&d=identicon&r=PG", "display_name": "freeformz", "link": "https://stackoverflow.com/users/872227/freeformz"}, "is_accepted": true, "score": 10, "last_activity_date": 1435684226, "creation_date": 1435684226, "answer_id": 31144308, "question_id": 31144153, "link": "https://stackoverflow.com/questions/31144153/go-build-does-not-generate-file-in-golang/31144308#31144308", "title": "&quot;go build&quot; does not generate file in golang", "body": "<p>From <code>go help build</code>:</p>\n\n<pre><code>When the command line specifies a single main package,\nbuild writes the resulting executable to output.\nOtherwise build compiles the packages but discards the results,\nserving only as a check that the packages can be built.\n</code></pre>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9618, "favorite_count": 0, "closed_date": 1435685671, "accepted_answer_id": 31144308, "answer_count": 1, "score": 9, "last_activity_date": 1435684226, "creation_date": 1435683659, "question_id": 31144153, "link": "https://stackoverflow.com/questions/31144153/go-build-does-not-generate-file-in-golang", "closed_reason": "Duplicate", "title": "&quot;go build&quot; does not generate file in golang", "body": "<p>I used <code>go build</code> to generate files. But I can only generate <code>main</code>, which mean <code>go build main.go</code> works while <code>go build dao.go</code> does not generate anything?</p>\n\n<p>How can I generate <code>dao</code>?</p>\n"}, {"tags": ["go", "compilation"], "comments": [{"owner": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "edited": false, "score": 1, "creation_date": 1435688295, "post_id": 31143399, "comment_id": 50301441, "body": "Tests should go in a file with the <code>_test</code> suffix. Like this, they are excluded from regular builds but are compiled and ran by <code>go test</code>."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1435681745, "creation_date": 1435681745, "answer_id": 31143603, "question_id": 31143399, "link": "https://stackoverflow.com/questions/31143399/go-compiler-flag-for-conditional-code/31143603#31143603", "title": "Go compiler flag for conditional code", "body": "<p>Consider using <a href=\"http://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow\">build constraints</a> instead of the <code>-X</code> flag. This, allows you to compile any code conditionally by doing something like</p>\n\n<pre><code>go install -tags 'foo bar'\n</code></pre>\n\n<p>If you still want to use the <code>-X</code> flag multiple times, do it like this:</p>\n\n<pre><code>go install -ldflags '-X main.Foo 1 -X main.Bar 2' main.go\n</code></pre>\n\n<p>or (<a href=\"https://github.com/golang/go/commit/12795c02f3d6fc54ece09a86e70aaa40a94d5131\" rel=\"nofollow\">added and recommended</a> in Go 1.5+)</p>\n\n<pre><code>go install -ldflags '-X main.Foo=1 -X main.Bar=2' main.go\n</code></pre>\n"}], "owner": {"reputation": 752, "user_id": 1593170, "user_type": "registered", "accept_rate": 3, "profile_image": "https://www.gravatar.com/avatar/c86385401d2a7d5b59a27f8e3af49093?s=128&d=identicon&r=PG", "display_name": "Omi", "link": "https://stackoverflow.com/users/1593170/omi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435758610, "creation_date": 1435681077, "last_edit_date": 1435758610, "question_id": 31143399, "link": "https://stackoverflow.com/questions/31143399/go-compiler-flag-for-conditional-code", "title": "Go compiler flag for conditional code", "body": "<p>I am new to Go and as a former C++ programmer am a little confused on how to do this in Go.\nI want to add a compile time flag based on which I may include some test code.</p>\n\n<p>I tried using <code>-ldflags</code>, but am unable to go beyond a single variable.</p>\n\n<p>This is what I tried: <code>-ldflags \"X main.var1 var1_value\" \"X main.var2 var2_value\"</code>.</p>\n\n<p>Am I doing the right thing here?</p>\n"}, {"tags": ["sorting", "go"], "comments": [{"owner": {"reputation": 4636, "user_id": 4411559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8792b137591b65d0ecdc3798c513369?s=128&d=identicon&r=PG&f=1", "display_name": "steveb", "link": "https://stackoverflow.com/users/4411559/steveb"}, "edited": false, "score": 1, "creation_date": 1579194758, "post_id": 31141202, "comment_id": 105693233, "body": "FYI, your <code>1, 3, 5, 4, 2</code>, should actually be <code>0, 2, 4, 3, 1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1435677643, "post_id": 31141540, "comment_id": 50295119, "body": "Nice! You gotta love embedding!"}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "edited": false, "score": 0, "creation_date": 1435678190, "post_id": 31141540, "comment_id": 50295512, "body": "@Ainar-G what if the data is [1.1 1.2] these float number. I changed IntSlice to Float64Slice, but it does not work"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1435679884, "post_id": 31141540, "comment_id": 50296647, "body": "Or, if you don&#39;t know what type of <code>sort.Interface</code> you&#39;ll have something like: <a href=\"https://play.golang.org/p/lRuKrhGxYM\" rel=\"nofollow noreferrer\">play.golang.org/p/lRuKrhGxYM</a> to wrap any <code>sort.Interface</code> rather than <code>sort.IntSlice</code>. The only user visible difference is the convenience <code>New\u2026</code> function that takes a variadic argument list."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1435681197, "post_id": 31141540, "comment_id": 50297468, "body": "@DaveC didn&#39;t think of that, thanks. Added to my answer."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 14, "last_activity_date": 1435681180, "last_edit_date": 1435681180, "creation_date": 1435675662, "answer_id": 31141540, "question_id": 31141202, "link": "https://stackoverflow.com/questions/31141202/get-the-indices-of-the-array-after-sorting-in-golang/31141540#31141540", "title": "Get the indices of the array after sorting in golang", "body": "<p>Make a wrapper for <code>sort.IntSlice</code> that remembers the indexes and swaps them when it swaps the values:</p>\n\n<pre><code>type Slice struct {\n    sort.IntSlice\n    idx []int\n}\n\nfunc (s Slice) Swap(i, j int) {\n    s.IntSlice.Swap(i, j)\n    s.idx[i], s.idx[j] = s.idx[j], s.idx[i]\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/LnSLfe-fXk\" rel=\"noreferrer\">http://play.golang.org/p/LnSLfe-fXk</a>.</p>\n\n<p><strong>EDIT:</strong> As DaveC mentioned in the comments, you can actually wrap around <code>sort.Interface</code> to create a data structure for any sortable type:</p>\n\n<pre><code>type Slice struct {\n    sort.Interface\n    idx []int\n}\n\nfunc (s Slice) Swap(i, j int) {\n    s.Interface.Swap(i, j)\n    s.idx[i], s.idx[j] = s.idx[j], s.idx[i]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1315, "user_id": 246621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a052cc7a43ee490418591ea10a0f7a7?s=128&d=identicon&r=PG", "display_name": "mkm", "link": "https://stackoverflow.com/users/246621/mkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1574703968, "creation_date": 1574703968, "answer_id": 59037444, "question_id": 31141202, "link": "https://stackoverflow.com/questions/31141202/get-the-indices-of-the-array-after-sorting-in-golang/59037444#59037444", "title": "Get the indices of the array after sorting in golang", "body": "<p>You can also just get the indices and avoid mutating the slice in-place, see <a href=\"https://github.com/mkmik/argsort\" rel=\"nofollow noreferrer\">https://github.com/mkmik/argsort</a></p>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2652, "favorite_count": 1, "accepted_answer_id": 31141540, "answer_count": 2, "score": 7, "last_activity_date": 1574703968, "creation_date": 1435674842, "question_id": 31141202, "link": "https://stackoverflow.com/questions/31141202/get-the-indices-of-the-array-after-sorting-in-golang", "title": "Get the indices of the array after sorting in golang", "body": "<p>I know we can use</p>\n\n<pre><code>sort.Sort(sort.Reverse(sort.IntSlice(example)))\n</code></pre>\n\n<p>to sort a array.</p>\n\n<p>But how can I get the indices of the array?</p>\n\n<p>e.g.</p>\n\n<pre><code>example := []int{1, 25, 3, 5, 4}\n</code></pre>\n\n<p>I want to get the output: 1, 3, 5, 4, 2</p>\n"}, {"tags": ["user-interface", "go", "gxui"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1435660671, "post_id": 31133071, "comment_id": 50282557, "body": "To where/how do you add <code>grid</code>? Can you show us full code?"}, {"owner": {"reputation": 1121, "user_id": 4381158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABb2u.jpg?s=128&g=1", "display_name": "Maxim Samburskiy", "link": "https://stackoverflow.com/users/4381158/maxim-samburskiy"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1435661113, "post_id": 31133071, "comment_id": 50282809, "body": "Yep, I have updated the question"}], "answers": [{"tags": [], "owner": {"reputation": 566, "user_id": 5091163, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100000663691395/picture?type=large", "display_name": "Barry McNamara", "link": "https://stackoverflow.com/users/5091163/barry-mcnamara"}, "is_accepted": true, "score": 1, "last_activity_date": 1436304507, "last_edit_date": 1436304507, "creation_date": 1436301165, "answer_id": 31278700, "question_id": 31133071, "link": "https://stackoverflow.com/questions/31133071/how-to-setsize-of-linearlayout-in-gxui/31278700#31278700", "title": "How to SetSize of LinearLayout in GXUI", "body": "<p>You don't need to resize anything. Setting up the LinearLayouts as you are trying to do should have the same effect, but you are making each LinearLayout contain a single label. To make a 4x4 grid, you want one row of 4 columns, with each column having 4 labels. That will make everything grid nicely. Here is code that does that.</p>\n\n<p>code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/google/gxui\"\n    \"github.com/google/gxui/drivers/gl\"\n    \"github.com/google/gxui/samples/flags\"\n    \"github.com/google/gxui/themes/dark\"\n)\n\nfunc appMain(driver gxui.Driver) {\n    theme := dark.CreateTheme(driver)\n\n    window := theme.CreateWindow(800, 600, \"Grid\")\n    window.SetScale(flags.DefaultScaleFactor)\n    window.OnClose(driver.Terminate)\n\n    row := theme.CreateLinearLayout()\n    row.SetDirection(gxui.LeftToRight)\n    for c := 0; c &lt; 4; c++ {\n        col := theme.CreateLinearLayout()\n        col.SetDirection(gxui.TopToBottom)\n        for r := 0; r &lt; 4; r++ {\n            cell := theme.CreateLabel()\n            cell.SetText(fmt.Sprintf(\"%d\", r*4+c))\n            col.AddChild(cell)\n        }\n        row.AddChild(col)\n    }\n\n    window.AddChild(row)\n}\n\nfunc main() {\n    gl.StartDriver(appMain)\n}\n</code></pre>\n"}], "owner": {"reputation": 1121, "user_id": 4381158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ABb2u.jpg?s=128&g=1", "display_name": "Maxim Samburskiy", "link": "https://stackoverflow.com/users/4381158/maxim-samburskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 31278700, "answer_count": 1, "score": 4, "last_activity_date": 1441037064, "creation_date": 1435652329, "last_edit_date": 1441037064, "question_id": 31133071, "link": "https://stackoverflow.com/questions/31133071/how-to-setsize-of-linearlayout-in-gxui", "title": "How to SetSize of LinearLayout in GXUI", "body": "<p>I'm trying to make a grid with <a href=\"https://github.com/google/gxui\" rel=\"nofollow noreferrer\">GXUI</a>, I use <a href=\"http://godoc.org/github.com/google/gxui#LinearLayout\" rel=\"nofollow noreferrer\"><code>LinearLayout</code></a> for rows and columns, but I have a problem with resizing it.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n\n  \"github.com/google/gxui\"\n  \"github.com/google/gxui/math\"\n  \"github.com/google/gxui/drivers/gl\"\n  \"github.com/google/gxui/samples/flags\"\n  \"github.com/google/gxui/themes/dark\"\n)\n\nfunc appMain(driver gxui.Driver)  {\n  theme := dark.CreateTheme(driver)\n\n  window := theme.CreateWindow(800, 600, \"Grid\")\n  window.SetScale(flags.DefaultScaleFactor)\n  window.OnClose(driver.Terminate)\n  size := window.Viewport().SizeDips()\n\n  grid := theme.CreateLinearLayout()\n  grid.SetDirection(gxui.TopToBottom)\n  grid.SetSizeMode(gxui.Fill)\n\n  for y := 0; y &lt; 4; y++ {\n    row := theme.CreateLinearLayout()\n    row.SetDirection(gxui.LeftToRight)\n\n    for x := 0; x &lt; 4; x++ {\n      label := theme.CreateLabel()\n      label.SetText(fmt.Sprintf(\"%d\", y*4+x))\n\n      cell := theme.CreateLinearLayout()\n      cell.SetDirection(gxui.TopToBottom)\n      cell.SetSize(math.Size{W: size.W/4, H: size.H/4}) // not actually resizes\n      cell.AddChild(label)\n\n      row.AddChild(cell)\n    }\n\n    grid.AddChild(row)\n  }\n\n  window.AddChild(grid)\n}\n\nfunc main() {\n  gl.StartDriver(appMain)\n}\n</code></pre>\n\n<p>This is the result:</p>\n\n<p><img src=\"https://i.stack.imgur.com/H7YAt.png\" alt=\"This is the result\"></p>\n\n<p><strong>Update:</strong> GXUI has <a href=\"https://github.com/google/gxui/blob/master/table_layout.go\" rel=\"nofollow noreferrer\">TableLayout</a> now</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 768714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4dd2e481fe489e55996896279ba52be?s=128&d=identicon&r=PG", "display_name": "Erik", "link": "https://stackoverflow.com/users/768714/erik"}, "edited": false, "score": 0, "creation_date": 1435677402, "post_id": 31131549, "comment_id": 50294954, "body": "Well, I feel dumb. I am fairly new to go if that wasn&#39;t obvious. Thank you very much for the very detailed answer. I knew the difference between exported fields but I guess I didn&#39;t make the connection that that was the problem here."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1535015825, "last_edit_date": 1535015825, "creation_date": 1435647299, "answer_id": 31131549, "question_id": 31131171, "link": "https://stackoverflow.com/questions/31131171/unmarshaling-nested-json-string-use-json-rawmessage/31131549#31131549", "title": "Unmarshaling nested json string use json.RawMessage", "body": "<p>The problem is simply that the <code>id</code> field of the <code>CreateMessage</code> struct is unexported, it starts with a lowercase letter. Change it to:</p>\n\n<pre><code>type CreateMessage struct {\n    Id int\n}\n</code></pre>\n\n<p>And it will work.</p>\n\n<p><strong>Notes:</strong></p>\n\n<p>Since <code>message2</code> is already a pointer (<code>new(CreateMessage)</code>), you don't have to pass its address to <code>json.Unmarshal()</code>, its value is enough:</p>\n\n<pre><code>var message2 = new(CreateMessage)\nif err := json.Unmarshal(message.Data, message2); err != nil {\n    panic(err)\n}\nlog.Printf(\"%+v\", message2)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2009/11/10 23:00:00 &amp;{Id:5}\n</code></pre>\n\n<p>Or don't use <code>new()</code> at all:</p>\n\n<pre><code>var message2 CreateMessage\nif err := json.Unmarshal(message.Data, &amp;message2); err != nil {\n    panic(err)\n}\nlog.Printf(\"%+v\", message2)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2009/11/10 23:00:00 {Id:5}\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/Bjg6Wg_ACP\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Also note that now the name of the field is <code>\"Id\"</code> and JSON contains <code>\"id\"</code> but the <code>json</code> package is \"intelligent\" enough to match them (same with <code>\"Event\"</code> and <code>\"event\"</code>). But know that if you would ever try to marshal your structs, the output would contain <code>\"Id\"</code> and not <code>\"id\"</code>.</p>\n\n<p>If you want to use a completely different field name or make sure it will be lowercased when you marshal your structs, you can use <a href=\"https://golang.org/ref/spec#Tag\" rel=\"nofollow noreferrer\">struct tags</a> to tell how it should appear in the JSON text, for example:</p>\n\n<pre><code>type CreateMessage struct {\n    MyId int `json:\"id\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 768714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4dd2e481fe489e55996896279ba52be?s=128&d=identicon&r=PG", "display_name": "Erik", "link": "https://stackoverflow.com/users/768714/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1535, "favorite_count": 0, "accepted_answer_id": 31131549, "answer_count": 1, "score": 2, "last_activity_date": 1535015825, "creation_date": 1435645885, "last_edit_date": 1495539837, "question_id": 31131171, "link": "https://stackoverflow.com/questions/31131171/unmarshaling-nested-json-string-use-json-rawmessage", "title": "Unmarshaling nested json string use json.RawMessage", "body": "<p>I'm having trouble wrapping my head around how to unmarshal a raw json string that was from a previously unmarshaled json byte array. I have the current code:</p>\n\n<pre><code>type Message struct {\n    Event string\n    Data json.RawMessage  // how data is parsed depends on the event\n}\n\ntype CreateMessage struct {\n    id int\n}\n\nvar evt = []byte(`{\"event\": \"create\", \"data\" :{\"id\":5 }}`)\n\nfunc main() {\n    var message Message\n    log.Println(string(evt))\n    json.Unmarshal(evt, &amp;message)\n\n    log.Println(message)\n    log.Println(message.Event)\n    log.Println(string(message.Data))\n    fmt.Printf(\"%+v\\n\", message)\n\n    var message2 = new(CreateMessage)\n    err := json.Unmarshal( message.Data, &amp;message2 )\n\n    log.Println(message2)\n    log.Println(err)\n}\n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code>2015/06/29 23:22:10 {\"event\": \"create\", \"data\" :{\"id\":5 }}\n2015/06/29 23:22:10 {create [123 34 105 100 34 58 53 32 125]}\n2015/06/29 23:22:10 create\n2015/06/29 23:22:10 {\"id\":5 }\n{Event:create Data:[123 34 105 100 34 58 53 32 125]}\n2015/06/29 23:22:10 &amp;{0}\n2015/06/29 23:22:10 &lt;nil&gt;\n</code></pre>\n\n<p>Why can't I unmarshal data as a <code>CreateMessage</code> object? I tried the example <a href=\"http://golang.org/pkg/encoding/json/#RawMessage.UnmarshalJSON\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://stackoverflow.com/questions/20101954/go-json-unmarshal-nested-object-into-string-or-byte\">here</a> but they don't unmarshal the nested raw json data and that is exactly what I'm trying to do.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4477, "user_id": 4673475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ff3c47715605701025a89d68849d6c?s=128&d=identicon&r=PG", "display_name": "kucing_terbang", "link": "https://stackoverflow.com/users/4673475/kucing-terbang"}, "edited": false, "score": 1, "creation_date": 1435649517, "post_id": 31130262, "comment_id": 50275374, "body": "wait, I&#39;m little confused here, Did you add this URL <code>https:&#47;&#47;plugins.jetbrains.com&#47;plugins&#47;alpha&#47;5047</code> or <code>https:&#47;&#47;github.com&#47;go-lang-plugin-org&#47;go-lang-idea-plugin</code>?"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 4477, "user_id": 4673475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ff3c47715605701025a89d68849d6c?s=128&d=identicon&r=PG", "display_name": "kucing_terbang", "link": "https://stackoverflow.com/users/4673475/kucing-terbang"}, "edited": false, "score": 0, "creation_date": 1435649767, "post_id": 31130262, "comment_id": 50275537, "body": "Yes I added the wrong url, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 0, "last_activity_date": 1448576885, "last_edit_date": 1448576885, "creation_date": 1448571213, "answer_id": 33946845, "question_id": 31130262, "link": "https://stackoverflow.com/questions/31130262/getting-error-when-trying-to-install-golang-plugin-for-intellij-idea/33946845#33946845", "title": "Getting error when trying to install Golang plugin for IntelliJ IDEA", "body": "<p>the plugin is now released in the official plugin repository for plugins so unless you really want to get the bleeding edge versions, I'd recommend you to use those versions.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 1, "accepted_answer_id": 33946845, "answer_count": 1, "score": 0, "last_activity_date": 1448576885, "creation_date": 1435642256, "question_id": 31130262, "link": "https://stackoverflow.com/questions/31130262/getting-error-when-trying-to-install-golang-plugin-for-intellij-idea", "title": "Getting error when trying to install Golang plugin for IntelliJ IDEA", "body": "<p>After installing the community version of IntelliJ IDEA for windows I go to settings -> plugins -> browse repositories -> manage repositories -> add url</p>\n\n<p>and then I add the url of</p>\n\n<p><a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin\" rel=\"nofollow noreferrer\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin</a></p>\n\n<p>click ok, but get the error message below.</p>\n\n<p><img src=\"https://i.stack.imgur.com/SSxvn.jpg\" alt=\"enter image description here\"></p>\n\n<p>I tried to look around everywhere but I couldn't find a solution.</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1435639070, "post_id": 31129584, "comment_id": 50270942, "body": "Does the Go JSON have any ability to override column mappings? (I expect such features from library like Json.NET; not sure if I should expect such in Go&#39;s implementation.)"}, {"owner": {"reputation": 3022, "user_id": 2855742, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7e0f6308b243a91de005292bc440d89c?s=128&d=identicon&r=PG", "display_name": "Rikki Gibson", "link": "https://stackoverflow.com/users/2855742/rikki-gibson"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1435639727, "post_id": 31129584, "comment_id": 50271136, "body": "Tags can be used to specify what key in a JSON object should be used to populate a property on a struct. This doesn&#39;t help with the JSON in the original post, though. An array is not a good format for this kind of structured data, where you have to remember that the item in position 0 has a totally different meaning than the item in position 1 and so on. <a href=\"http://stackoverflow.com/questions/19885162/xml-and-json-tags-for-a-golang-struct\" title=\"xml and json tags for a golang struct\">stackoverflow.com/questions/19885162/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3022, "user_id": 2855742, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7e0f6308b243a91de005292bc440d89c?s=128&d=identicon&r=PG", "display_name": "Rikki Gibson", "link": "https://stackoverflow.com/users/2855742/rikki-gibson"}, "is_accepted": false, "score": 1, "last_activity_date": 1435638569, "creation_date": 1435638569, "answer_id": 31129584, "question_id": 31129379, "link": "https://stackoverflow.com/questions/31129379/golang-unmarshal-complex-json/31129584#31129584", "title": "golang unmarshal complex json", "body": "<p>Your JSON contains an array literal and you're trying to deserialize it as a struct. You need to change the JSON to an object literal where the keys are the property names of your struct.</p>\n\n<pre><code>j := []byte(`{\n    \"Contig\": \"contig\",\n    \"Base\": \"32\",\n    \"PopMap\": {\"a\":[33,41,35], \"b\":[44,34,42]}\n}`)\n</code></pre>\n\n<p>If the JSON isn't something you have the ability to change, then you will need to deserialize it into an untyped array and perform your own transformation into the struct type.</p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 3803704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1eKg.jpg?s=128&g=1", "display_name": "Jay Crumb", "link": "https://stackoverflow.com/users/3803704/jay-crumb"}, "is_accepted": false, "score": 2, "last_activity_date": 1435639140, "creation_date": 1435639140, "answer_id": 31129668, "question_id": 31129379, "link": "https://stackoverflow.com/questions/31129379/golang-unmarshal-complex-json/31129668#31129668", "title": "golang unmarshal complex json", "body": "<p>Because you have an array literal rather than an object, the best way to parse is by unmarshaling first to a slice of <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow\">json.RawMessages</a>, and then go through the fields in the resulting slice:</p>\n\n<pre><code>package main\n\nimport (\n     \"encoding/json\"\n     \"fmt\"\n)\n\n\nfunc main() {\n    j := []byte(`[\"contig\", \"32\", {\"a\":[33,41,35], \"b\":[44,34,42]}]`)\n\n    var entries []json.RawMessage\n    err := json.Unmarshal(j, &amp;entries)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    var contig string\n    var num string\n    var obj struct {\n        A []int `json:\"a\"`\n        B []int `json:\"b\"`\n    }\n\n    err = json.Unmarshal(entries[0], &amp;contig)\n    err = json.Unmarshal(entries[1], &amp;num)\n    err = json.Unmarshal(entries[2], &amp;obj)\n\n    fmt.Println(contig)\n    fmt.Println(num)\n    fmt.Println(obj)\n}\n</code></pre>\n\n<p>This gives the correct result:</p>\n\n<p><code>contig\n32\n{[33 41 35] [44 34 42]}</code></p>\n\n<p>Playground: <a href=\"https://play.golang.org/p/jcYvINkTTn\" rel=\"nofollow\">https://play.golang.org/p/jcYvINkTTn</a></p>\n\n<p>If you have control over the source of the JSON though, changing it to an object literal would be the most straightforward way to go about it.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 6, "last_activity_date": 1476171964, "last_edit_date": 1476171964, "creation_date": 1435645271, "answer_id": 31130994, "question_id": 31129379, "link": "https://stackoverflow.com/questions/31129379/golang-unmarshal-complex-json/31130994#31130994", "title": "golang unmarshal complex json", "body": "<p>The JSON input you specified is an array of different types, so as it is, you can't unmarshal it into a <code>struct</code>, but only into a slice of different types: <code>[]interface{}</code>.</p>\n\n<pre><code>in := `[\"contig\", \"32\", {\"a\":[33,41,35], \"b\":[44,34,42]}]`\n\nvar arr []interface{}\nif err := json.Unmarshal([]byte(in), &amp;arr); err != nil {\n    panic(err)\n}\nfmt.Println(arr)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[contig 32 map[a:[33 41 35] b:[44 34 42]]]\n</code></pre>\n\n<h3>Filling the <code>struct</code></h3>\n\n<p>Good, you now have the values, just not in the <code>struct</code> you want them to be. You can use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a> to obtain the types you want:</p>\n\n<pre><code>l := Line{PopMap: map[string][]int{}}\nl.Contig = arr[0].(string)\nl.Base = arr[1].(string)\n\nm := arr[2].(map[string]interface{})\nfor k, v := range m {\n    nums := v.([]interface{})\n    pops := make([]int, len(nums))\n    for i, val := range nums {\n        pops[i] = int(val.(float64))\n    }\n    l.PopMap[k] = pops\n}\n\nfmt.Printf(\"%+v\", l)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/mApgu9Ner8\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>{Contig:contig Base:32 PopMap:map[a:[33 41 35] b:[44 34 42]]}\n</code></pre>\n\n<p><strong>Some notes:</strong></p>\n\n<p>The \"internal\" arrays of the values of <code>\"a\"</code> and <code>\"b\"</code> are unmarshaled into values of type <code>[]interface{}</code> which you cannot simply convert to <code>[]int</code> or <code>[]float64</code> hence the <code>for</code> loops to iterate over them and use type assertion on each of their elements. Also note that the <code>json</code> package unmarshals the numbers into values of type <code>float64</code> and not <code>int</code> (because not just integers can be in the JSON text so <code>float64</code> is used which can accommodate both).</p>\n\n<p>Also note that the success of type assertions are not checked in the above example. If the unmarshaled array has less than 3 elements, or any of the type assertion fails, a runtime panic occurs.</p>\n\n<h3>Using <code>recover()</code></h3>\n\n<p>You can add a <code>defer</code> function which calls <code>recover()</code> to catch this panic (try it on the <a href=\"http://play.golang.org/p/IZyx425RX9\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>defer func() {\n    if r := recover(); r != nil {\n        fmt.Println(\"Failed to unmarshal\")\n    }\n}()\n\nl := Line{PopMap: map[string][]int{}}\n// ...and here comes the code that uses type assertions\n// and stores values into...\n</code></pre>\n\n<h3>Code with checks</h3>\n\n<p>Or you can add checks for the type assertions. The type assertion has a special form <code>v, ok = x.(T)</code> which when used never panics, but rather if the type assertion doesn't hold, <code>ok</code> will be <code>false</code> (and will be <code>true</code> if type assertion holds).</p>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/T4SZYmAFzB\" rel=\"nofollow\">Go Playground</a>:</p>\n\n<pre><code>if len(arr) &lt; 3 {\n    return\n}\nvar ok bool\nl := Line{PopMap: map[string][]int{}}\nif l.Contig, ok = arr[0].(string); !ok {\n    return\n}\nif l.Base, ok = arr[1].(string); !ok {\n    return\n}\nif m, ok := arr[2].(map[string]interface{}); !ok {\n    return\n} else {\n    for k, v := range m {\n        var nums []interface{}\n        if nums, ok = v.([]interface{}); !ok {\n            return\n        }\n        pops := make([]int, len(nums))\n        for i, val := range nums {\n            if f, ok := val.(float64); !ok {\n                return\n            } else {\n                pops[i] = int(f)\n            }\n        }\n        l.PopMap[k] = pops\n    }\n}\n\nfmt.Printf(\"%+v\", l)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 1856955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60f1b690cdc247bac43cf09e726eda3?s=128&d=identicon&r=PG", "display_name": "user1856955", "link": "https://stackoverflow.com/users/1856955/user1856955"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4479, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1476171964, "creation_date": 1435637322, "last_edit_date": 1435648118, "question_id": 31129379, "link": "https://stackoverflow.com/questions/31129379/golang-unmarshal-complex-json", "title": "golang unmarshal complex json", "body": "<p>I have the following JSON blob, and I'm trying to decode it into Go.</p>\n\n<pre><code>[\"contig\", \"32\", {\"a\":[33,41,35], \"b\":[44,34,42]}]\n</code></pre>\n\n<p>I believe that I have to model the data structure of the JSON.  I tried using a struct called <code>Line</code>:</p>\n\n<pre><code>package main\n\nimport (\n\"encoding/json\"\n\"fmt\"\n)\n\ntype Line struct {\n    Contig string\n    Base   string\n    PopMap map[string][]int\n}\n\nfunc main() {\n    j := []byte(`[\"contig\", \"32\", {\"a\":[33,41,35], \"b\":[44,34,42]}]`)\n    var dat Line\n    err := json.Unmarshal(j, &amp;dat)\n    fmt.Println(dat)\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>I got the following error:</p>\n\n<pre><code>{  map[]}\njson: cannot unmarshal array into Go value of type main.Line\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p><a href=\"http://play.golang.org/p/ipcXbs5GUQ\" rel=\"nofollow\">Link to sandbox for trying out code</a></p>\n"}, {"tags": ["bash", "ubuntu", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1435612612, "post_id": 31125557, "comment_id": 50263861, "body": "Don&#39;t use <code>go run</code>. Build or install the binary you need. (your <code>ps aux | grep go</code> isn&#39;t getting the server process, it&#39;s the go tool process)"}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1435655616, "post_id": 31133281, "comment_id": 50279123, "body": "You should be compiling your Go program and running it via <code>RUN</code> or <code>ENTRYPOINT</code> in your Dockerfile. Using a shell script to exec go run is extremely flaky (as you are finding). See my example in this repo: <a href=\"https://github.com/elithrar/supervisord\" rel=\"nofollow noreferrer\">github.com/elithrar/supervisord</a>"}, {"owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435655886, "post_id": 31133281, "comment_id": 50279311, "body": "@elithrar - The Dockerfile is used once to build the relevant image. I could do what you suggest if the Go program to be run inside the Docker container were static. In my case the program will change as the container&#39;s user works. Rebuilding the docker image or compiling the Go program in the &quot;real&quot; machine as opposed to inside the running container are not options in the present instance"}], "tags": [], "owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "is_accepted": true, "score": -3, "last_activity_date": 1435723129, "last_edit_date": 1435723129, "creation_date": 1435653016, "answer_id": 31133281, "question_id": 31125557, "link": "https://stackoverflow.com/questions/31125557/starting-golang-webserver-inside-a-dockercontainer/31133281#31133281", "title": "Starting golang webserver inside a Dockercontainer", "body": "<p>This issue drove me round the bend with looming deadlines and it took me a whole 24h to figure out what was happening.  The problem is a rather subtle one. So here is an explanation for the benefit of anyone running into this thread.</p>\n\n<p><strong>Never forget</strong>: For Golang to deliver its magic the OS has to be able to find it.  Enter the $GOPATH environment variable.  If you are anything like me you will have followed instructions somewhere on the net on how to do this. I followed the instructions in <a href=\"https://www.vultr.com/docs/installing-golang-on-ubuntu-14-04\" rel=\"nofollow\">this post</a> on Vultr.  The gist of what they suggest</p>\n\n<pre><code>echo export GOPATH=/opt/gopkg &gt;&gt; ~/.bashrc\necho export GOROOT=/opt/go &gt;&gt; ~/.bashrc\necho export PATH=$PATH:$GOROOT/bin:$GOPATH/bin &gt;&gt; ~/.bashrc\n</code></pre>\n\n<p>Excellent instructions - thank you Vultr.  </p>\n\n<p><strong>The Key Isssue</strong></p>\n\n<p>As I mention in my original question what puzzled me was that when I executed the batch file <code>gorun</code> containing</p>\n\n<pre><code>go run /path/to/index.go &amp;\n</code></pre>\n\n<p>from a terminal session attached to the Docker session it worked. However, when I tried to execute it from a bash script executed at the start of the Docker session it did not.</p>\n\n<p>When you think about this a bit and look at what is happening in the Vultr instructions above it is all blindingly obvious. The path variables are being set <strong>ONLY WHEN AN INTERACTIVE TERMINAL IS OPEN!</strong> - i.e. NOT when you attempt to execute a <code>go dosomething</code> instruction from any old batch file - for instance the one you run when the Docker container is launched.</p>\n\n<p>If you want to have Golang operate correctly from within a Docker container right at the top of the bash script you run on container startup you will need to issue</p>\n\n<pre><code>export GOPATH=\"/opt/gopkg\"; \nexport GOROOT=\"/opt/go\";   \nexport PATH=$PATH:$GOPATH/bin:$GOROOT/bin; \n</code></pre>\n"}], "owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 31133281, "answer_count": 1, "score": -1, "last_activity_date": 1435723129, "creation_date": 1435611944, "question_id": 31125557, "link": "https://stackoverflow.com/questions/31125557/starting-golang-webserver-inside-a-dockercontainer", "title": "Starting golang webserver inside a Dockercontainer", "body": "<p>I am in the process of creating a service that, amongst other things, allows users start/stop a Golang web server at will.  To get a Nodejs server running under similar circumstances I  simply issue a <code>nodejs /path/to/index.js  &amp;disown</code> from within a batch file that I run when the container starts up.  The essential bits</p>\n\n<pre><code>ADD gorun.sh /usr/local/bin/gorun.sh\nRUN chmod +x /usr/local/bin/gorun.sh\n\n...\nENTRYPOINT [\"/bin/bash\"]\nCMD [\"/usr/local/bin/gorun.sh\"]\n</code></pre>\n\n<p>This works perfectly, every time. In <code>gorun.sh</code> I have the <code>nodejs /path/to/index.js &amp; disown</code> line.</p>\n\n<p>Now that I am trying to get a Golang web server running under similar conditions I thought I would try the same approach.  I modified the gorun.sh script to read</p>\n\n<pre><code>#! /bin/bash\ngo run /path/to/index.go &amp; disown;\nps aux | grep go\n</code></pre>\n\n<p>Now here is the odd thing.  I have tried to get the Go server started in two ways</p>\n\n<ul>\n<li>Purely as an experiment I started the Docker container with a terminal attached at called <code>gorun</code> from the terminal. The Golang server fired up right away and everything was hunkry-dory.</li>\n<li>To better emulate the way things work in the real world - I placed a file, startgo.txt at a pre-determined location which then gets picked up by a CRON job that calls gorun. This time round, no joy - the server does not start up.</li>\n</ul>\n\n<p>Why not just call <code>go run /path/to/index.go &amp; disown</code> from the Docker container startup script? Tried that too -same result: the server does not start up.</p>\n\n<p>It is not clear to me what is happening here.  Why does the Nodejs server fire up whilst the golang server refuses point blank?  Why does it fire up if I run the same script from within a terminal?  I'd much appreciate any help with these issues.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1435611324, "post_id": 31125352, "comment_id": 50263273, "body": "<code>Account</code> is in the <code>api</code> package, so you reference it as <code>api.Account</code>"}, {"owner": {"reputation": 718, "user_id": 3272411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e4bb9df7c1e36365bf8bc9a45d8a7dca?s=128&d=identicon&r=PG", "display_name": "alex-phillips", "link": "https://stackoverflow.com/users/3272411/alex-phillips"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435611406, "post_id": 31125352, "comment_id": 50263317, "body": "Wow... definitely overthought everything and missed that... That was it. Thanks!"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1435678386, "post_id": 31125352, "comment_id": 50295650, "body": "<code>api</code> is a <a href=\"https://blog.golang.org/package-names\" rel=\"nofollow noreferrer\">bad name for a package</a>, especially since you explicitly mention other users using your package."}, {"owner": {"reputation": 718, "user_id": 3272411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e4bb9df7c1e36365bf8bc9a45d8a7dca?s=128&d=identicon&r=PG", "display_name": "alex-phillips", "link": "https://stackoverflow.com/users/3272411/alex-phillips"}, "edited": false, "score": 0, "creation_date": 1435682211, "post_id": 31125352, "comment_id": 50298021, "body": "Yeah, it needs to change. This isn&#39;t really fleshed out, just wanted to make sure I had my structure right."}], "answers": [{"comments": [{"owner": {"reputation": 718, "user_id": 3272411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e4bb9df7c1e36365bf8bc9a45d8a7dca?s=128&d=identicon&r=PG", "display_name": "alex-phillips", "link": "https://stackoverflow.com/users/3272411/alex-phillips"}, "edited": false, "score": 0, "creation_date": 1435619301, "post_id": 31126964, "comment_id": 50266345, "body": "So just to clarify, anything in the &#39;main&#39; package and a &#39;main&#39; func will be added as an executable in the bin dir?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 718, "user_id": 3272411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e4bb9df7c1e36365bf8bc9a45d8a7dca?s=128&d=identicon&r=PG", "display_name": "alex-phillips", "link": "https://stackoverflow.com/users/3272411/alex-phillips"}, "edited": false, "score": 0, "creation_date": 1435619811, "post_id": 31126964, "comment_id": 50266478, "body": "Correct - it will get added to <code>$GOPATH&#47;bin</code> when you use <code>go get</code> to fetch the package."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 3, "last_activity_date": 1435618852, "creation_date": 1435618852, "answer_id": 31126964, "question_id": 31125352, "link": "https://stackoverflow.com/questions/31125352/building-cli-app-package-in-go/31126964#31126964", "title": "Building CLI app/package in Go", "body": "<p>There's no \"one way\", but the common approach is to make your top-level repo your library - i.e. <code>github.com/you/somelib</code> and then have a <code>cmd</code> directory underneath that contains your CLI (package mains) - there may even be many.</p>\n\n<p>e.g.</p>\n\n<pre><code>yourlib/\n    api.go\n    api_test.go\n    handler.go\n    handler_test.go\n    cmd/\n        command-name/\n            main.go // Builds a \"command-name\" binary\n        other-command/\n            main.go // Builds a \"other-command\" binary\n</code></pre>\n\n<p>Your CLI apps are just consumers of your library. Users can retrieve it via <code>go get github.com/you/yourlib/...</code> which will install the lib and the binaries onto their GOPATH.</p>\n\n<p>The Go <a href=\"https://github.com/golang/go/tree/master/src/cmd\" rel=\"nofollow\">source itself</a>, <a href=\"https://github.com/camlistore/camlistore\" rel=\"nofollow\">Camlistore</a> and <a href=\"https://github.com/boltdb/bolt\" rel=\"nofollow\">BoltDB</a> all use this approach (amongst many other libs).</p>\n"}], "owner": {"reputation": 718, "user_id": 3272411, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e4bb9df7c1e36365bf8bc9a45d8a7dca?s=128&d=identicon&r=PG", "display_name": "alex-phillips", "link": "https://stackoverflow.com/users/3272411/alex-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 31126964, "answer_count": 1, "score": 0, "last_activity_date": 1435618852, "creation_date": 1435611085, "question_id": 31125352, "link": "https://stackoverflow.com/questions/31125352/building-cli-app-package-in-go", "title": "Building CLI app/package in Go", "body": "<p>I may be going about this incorrectly (I've read How to Write Go Code), but here's what I'm trying to achieve: I want to write a golang package that also come with a CLI, so that a user can use the package in their own programs but also use the CLI that I've built with it.</p>\n\n<p>So what I have so far is this structure:</p>\n\n<pre><code>mypackage/\n  -api/\n    -account.go // package api\n    -node.go    // package api\n  -main.go // package main - this is where I want\n           // the executable code to be that is put in the `bin` folder.\n</code></pre>\n\n<p>This is a very crude file structure as I'm just starting out the project, but that's what I'm trying to achieve rather than build a package with the usable code in it and then build a separate repo with my CLI in it. But when I attempt to run <code>main.go</code>, it says <code>undefined: Account</code> (which is a struct in <code>account.go</code>).</p>\n\n<p>The contents of my code is unimportant right now, it's very basic as I'm just trying to get the code to work. Here's what I have.</p>\n\n<p>account.go</p>\n\n<pre><code>package api\n\nimport (\n    \"io/ioutil\"\n    \"net/http\"\n)\n\ntype Account struct {\n    email         string\n}\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/username/mypackage/api\"\n    \"fmt\"\n)\n\nfunc main() {\n    a := Account{}\n\n    fmt.Printf(\"%T\", a)\n}\n</code></pre>\n\n<p>If this is completely bad practice, I suppose I'll just make 2 repos, one with the CLI and another with my actual package code (again, usable in development by others by importing), but I'd really like it to be an all-in-one repo.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1435606985, "post_id": 31124135, "comment_id": 50260794, "body": "a <code>|</code> pipe is a shell construct. You can&#39;t use that in a command."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1435608142, "post_id": 31124135, "comment_id": 50261501, "body": "You have unnecessary single quotes around <code>*go*</code>, remove them."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1435607313, "creation_date": 1435607313, "answer_id": 31124313, "question_id": 31124135, "link": "https://stackoverflow.com/questions/31124135/run-find-using-exec-command/31124313#31124313", "title": "Run &#39;find&#39; using exec.Command", "body": "<p>You're using <code>|</code> which pipes the output of the previous command into the next. Instead you probably need two commands in Go. Use <code>string(out)</code> as input to the second one rather than trying to pipe it and compose the two bash commands into one Go command.</p>\n\n<pre><code>// this is pseudo code\ncmd2 := exec.Command(\"head\", \"args1\", string(out))\n</code></pre>\n\n<p>Basically, you have to do the piping yourself and use two separate commands rather than trying to invoke command once with commands that are composed using pipe.</p>\n"}], "owner": {"reputation": 656, "user_id": 1135795, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2673fde0b7068bf75f5143bca39376ee?s=128&d=identicon&r=PG", "display_name": "martin", "link": "https://stackoverflow.com/users/1135795/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1435607833, "creation_date": 1435606663, "last_edit_date": 1435607833, "question_id": 31124135, "link": "https://stackoverflow.com/questions/31124135/run-find-using-exec-command", "title": "Run &#39;find&#39; using exec.Command", "body": "<p>I am trying to run the <code>find</code> command using <code>exec.Command</code>:</p>\n\n<pre><code>cmd := exec.Command(\"find\", \"/usr/bin\", \"-maxdepth\", \n        \"2\", \"-iname\", \"'*go*'\", \"|\", \"head\", \"-10\")\nout, err := cmd.CombinedOutput()\nfmt.Println(err)\nfmt.Println(string(out))\n</code></pre>\n\n<p>Unfortunately this fails with the following output:</p>\n\n<pre><code>exit status 1\nfind: paths must precede expression: |\nUsage: find [-H] [-L] [-P] [-Olevel] [-D help|tree|search|stat|rates|opt|exec] [path...] [expression]\n</code></pre>\n\n<p>What am I missing here?</p>\n\n<p>EDIT:</p>\n\n<p>Even if I try it without piping this still fails:</p>\n\n<pre><code>cmd := exec.Command(\"find\", \"/usr/bin\", \"-maxdepth\", \"2\", \"-iname\", \"'*go*'\")\nout, err := cmd.CombinedOutput()\nfmt.Println(err)\nfmt.Println(string(out))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;nil&gt;\n</code></pre>\n"}, {"tags": ["file", "go", "generator"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1435596141, "post_id": 31120987, "comment_id": 50254920, "body": "Use <code>os.SEEK_END</code> rather than <code>2</code>. <code>time.Sleep(10)</code> sleeps for 10 nanoseconds, you probably meant <code>time.Sleep(10 * time.Millisecond)</code>. Once an <code>io.Reader</code> gives you <code>io.EOF</code> you shouldn&#39;t expect it ever give you more data; EOF == <b>end</b> of file/steam, no more data."}, {"owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1435596708, "post_id": 31120987, "comment_id": 50255257, "body": "Thank you, I edited the code."}], "answers": [{"comments": [{"owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "edited": false, "score": 1, "creation_date": 1503346404, "post_id": 31122253, "comment_id": 78567525, "body": "There are two things that I see are an error.... [1] the time.Sleep(10*time.Millisecond) is going to cause the system to generate heat instead of sitting quietly until there is actually some data. [2] When you are at the end of the file there is no signal to the main loop so that you can decide to exit. (I have a use-case where I send some commands to a service; then monitor the logs waiting for a positive reply; Since there is no negative reply I need to exhaust the data or check the timer. Goroutines and closing the data source are not an option."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 10, "last_activity_date": 1550893915, "last_edit_date": 1550893915, "creation_date": 1435600045, "answer_id": 31122253, "question_id": 31120987, "link": "https://stackoverflow.com/questions/31120987/tail-f-like-generator/31122253#31122253", "title": "&quot;tail -f&quot;-like generator", "body": "<p>I suggest creating a wrapper around a reader that sleeps on EOF:</p>\n\n<pre><code>type tailReader struct {\n    io.ReadCloser\n}\n\nfunc (t tailReader) Read(b []byte) (int, error) {\n    for {\n        n, err := t.ReadCloser.Read(b)\n        if n &gt; 0 {\n            return n, nil\n        } else if err != io.EOF {\n            return n, err\n        }\n        time.Sleep(10 * time.Millisecond)\n    }\n}\n\nfunc newTailReader(fileName string) (tailReader, error) {\n    f, err := os.Open(fileName)\n    if err != nil {\n        return tailReader{}, err\n    }\n\n    if _, err := f.Seek(0, 2); err != nil {\n        return tailReader{}, err\n    }\n    return tailReader{f}, nil\n}\n</code></pre>\n\n<p>This reader can be used anywhere an io.Reader can be used. Here's how loop over lines using <a href=\"http://godoc.org/bufio#Scanner\" rel=\"nofollow noreferrer\">bufio.Scanner</a>:</p>\n\n<pre><code>t, err := newTailReader(\"somefile\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer t.Close()\nscanner := bufio.NewScanner(t)\nfor scanner.Scan() {\n    fmt.Println(scanner.Text())\n}\nif err := scanner.Err(); err != nil {\n    fmt.Fprintln(os.Stderr, \"reading:\", err)\n}\n</code></pre>\n\n<p>The reader can also be used to loop over JSON values appended to the file:</p>\n\n<pre><code>t, err := newTailReader(\"somefile\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer t.Close()\ndec := json.NewDecoder(t)\nfor {\n    var v SomeType\n    if err := dec.Decode(&amp;v); err != nil {\n       log.Fatal(err)\n    }\n    fmt.Println(\"the value is \", v)\n}\n</code></pre>\n\n<p>There are a couple of advantages this approach has over the goroutine approach outlined in the question. The first is that shutdown is easy. Just close the file. There's no need to signal the goroutine that it should exit. The second advantage is that many packages work with io.Reader. </p>\n\n<p>The sleep time can be adjusted up or down to meet specific needs. Decrease the time for lower latency and increase the time to reduce CPU use. A sleep of 100ms is probably fast enough for data that's displayed to humans.</p>\n"}, {"tags": [], "owner": {"reputation": 1052, "user_id": 7768287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySIAC.png?s=128&g=1", "display_name": "Tiya Jose", "link": "https://stackoverflow.com/users/7768287/tiya-jose"}, "is_accepted": false, "score": 0, "last_activity_date": 1572424999, "last_edit_date": 1572424999, "creation_date": 1568352487, "answer_id": 57917745, "question_id": 31120987, "link": "https://stackoverflow.com/questions/31120987/tail-f-like-generator/57917745#57917745", "title": "&quot;tail -f&quot;-like generator", "body": "<p>Check out this Go package for reading from continuously updated files (tail -f): <a href=\"https://github.com/hpcloud/tail\" rel=\"nofollow noreferrer\">https://github.com/hpcloud/tail</a></p>\n\n<pre><code>t, err := tail.TailFile(\"filename\", tail.Config{Follow: true})\nfor line := range t.Lines {\n    fmt.Println(line.Text)\n}\n</code></pre>\n"}], "owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1192, "favorite_count": 1, "accepted_answer_id": 31122253, "answer_count": 2, "score": 10, "last_activity_date": 1572425010, "creation_date": 1435595770, "last_edit_date": 1572425010, "question_id": 31120987, "link": "https://stackoverflow.com/questions/31120987/tail-f-like-generator", "title": "&quot;tail -f&quot;-like generator", "body": "<p>I had this convenient function in Python:</p>\n\n<pre><code>def follow(path):\n    with open(self.path) as lines:\n        lines.seek(0, 2)  # seek to EOF\n\n        while True:\n            line = lines.readline()\n            if not line:\n                time.sleep(0.1)\n                    continue\n                yield line \n</code></pre>\n\n<p>It does something similar to UNIX <code>tail -f</code>: you get last lines of a file as they come. It's convenient because you can get the generator <em>without blocking</em> and pass it to another function.</p>\n\n<p>Then I had to do the same thing in Go. I'm new to this language, so I'm not sure whether what I did is idiomatic/correct enough for Go. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>func Follow(fileName string) chan string {\n\n    out_chan := make(chan string)\n\n    file, err := os.Open(fileName)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    file.Seek(0, os.SEEK_END)\n    bf := bufio.NewReader(file)\n\n    go func() {\n        for {\n            line, _, _ := bf.ReadLine()\n\n            if len(line) == 0 {\n                time.Sleep(10 * time.Millisecond)\n            } else {\n                out_chan &lt;- string(line)\n            }\n        }\n\n        defer file.Close()\n        close(out_chan)\n    }()\n\n    return out_chan\n}\n</code></pre>\n\n<p>Is there any cleaner way to do this in Go? I have a feeling that using an asynchronous call for such a thing is an overkill, and it really bothers me.</p>\n"}, {"tags": ["command-line", "go"], "answers": [{"comments": [{"owner": {"reputation": 10222, "user_id": 3950397, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJvXD.png?s=128&g=1", "display_name": "Sahil Kapoor", "link": "https://stackoverflow.com/users/3950397/sahil-kapoor"}, "edited": false, "score": 0, "creation_date": 1435595626, "post_id": 31119533, "comment_id": 50254628, "body": "Thanks but is there a way to export these values into my default environment?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 10222, "user_id": 3950397, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJvXD.png?s=128&g=1", "display_name": "Sahil Kapoor", "link": "https://stackoverflow.com/users/3950397/sahil-kapoor"}, "edited": false, "score": 1, "creation_date": 1435595804, "post_id": 31119533, "comment_id": 50254711, "body": "@SahilKapoor: In your .bashrc (or similar), you could add the line: <code>. &lt;(go env)</code>"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1435591398, "creation_date": 1435591398, "answer_id": 31119533, "question_id": 31118836, "link": "https://stackoverflow.com/questions/31118836/go-goos-and-goarch-not-recognised-in-environment/31119533#31119533", "title": "GO: {GOOS} and {GOARCH} not recognised in environment", "body": "<p><code>$GOOS</code> and <code>$GOARCH</code> will only be defined in your shell if you have exported them (which, unless you are doing cross compilation, is unlikely).</p>\n\n<p>When you run <code>go env</code>, default values are shown when they have not been overwritten by your environment. You should change your command to the following to get the desired results:</p>\n\n<pre><code>cd $(go env GOPATH)/pkg/$(go env GOOS)_$(go env GOARCH)\n</code></pre>\n"}], "owner": {"reputation": 10222, "user_id": 3950397, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJvXD.png?s=128&g=1", "display_name": "Sahil Kapoor", "link": "https://stackoverflow.com/users/3950397/sahil-kapoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1551, "favorite_count": 1, "accepted_answer_id": 31119533, "answer_count": 1, "score": 0, "last_activity_date": 1435591398, "creation_date": 1435589493, "last_edit_date": 1435590763, "question_id": 31118836, "link": "https://stackoverflow.com/questions/31118836/go-goos-and-goarch-not-recognised-in-environment", "title": "GO: {GOOS} and {GOARCH} not recognised in environment", "body": "<p>I want to change my diretory to <code>go/pkg/darwin_amd64</code> but <code>$ cd $GOPATH/pkg/${GOOS}_${GOARCH}</code> doesn't find the folder though directory exists.</p>\n\n<p><code>$ echo $GOPATH/pkg/${GOOS}_${GOARCH}</code> gives <code>/go/pkg/_</code> instead of <code>/go/pkg/darwin_amd64</code>.</p>\n\n<p><code>$ go env</code> prints: </p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/sahilkapoor/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>We can see that <code>GOOS</code> and <code>GOARCH</code> are defined here. I am using terminal on Mac OSX 10.10.3. What am I missing?</p>\n"}, {"tags": ["go", "network-programming", "gob"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1435589302, "post_id": 31117999, "comment_id": 50250551, "body": "Because the gob package is designed to encode streams of values, the package manages framing. Can you explain more about your concern of receiving a partial value?  The gob package sends entire values unless there&#39;s a panic or something while encoding.  There&#39;s no recovery if this happens."}, {"owner": {"reputation": 103, "user_id": 2883940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edb5f6ac5a83aee6204eb20060f8bbe1?s=128&d=identicon&r=PG&f=1", "display_name": "Cshark", "link": "https://stackoverflow.com/users/2883940/cshark"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435589490, "post_id": 31117999, "comment_id": 50250686, "body": "I tried encoding a struct using gob, took the output, copied it into a buffer twice and removed the last ~5 bytes to simulate a half transfered structure. This gives me an error, yet empties the buffer. Am I wrong in my assertion that this could happen? I did not expect gob to be adding framing."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1435589658, "post_id": 31117999, "comment_id": 50250804, "body": "Duplicating the output of the gob encoder is not the same as encoding the same value twice.  Use a single encoder to encode multiple values. Use a single decoder to decode multiple values.  What are you trying to simulate by chopping off the last 5 bytes?"}, {"owner": {"reputation": 103, "user_id": 2883940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edb5f6ac5a83aee6204eb20060f8bbe1?s=128&d=identicon&r=PG&f=1", "display_name": "Cshark", "link": "https://stackoverflow.com/users/2883940/cshark"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435590125, "post_id": 31117999, "comment_id": 50251168, "body": "I think I&#39;m an idiot! The overhead that I described only occurs once (describing the structures) and framing is added? I attempted to simulate the last structure being half send. I think I completely misunderstood gob - expected it to work like a protocol buffer."}, {"owner": {"reputation": 103, "user_id": 2883940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edb5f6ac5a83aee6204eb20060f8bbe1?s=128&d=identicon&r=PG&f=1", "display_name": "Cshark", "link": "https://stackoverflow.com/users/2883940/cshark"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435590438, "post_id": 31117999, "comment_id": 50251413, "body": "Also does the .Decode method block when the next value is not complete yet? E.g Only the first part of a large structure has been transfered."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1435590678, "post_id": 31117999, "comment_id": 50251587, "body": "The Decode method calls the reader&#39;s <a href=\"http://godoc.org/io#Reader.Read\" rel=\"nofollow noreferrer\">Read</a> method to get data.  An io.Reader blocks until data is available or there&#39;s an error (closed network connection for example). So yes, Decode blocks waiting for the value."}, {"owner": {"reputation": 103, "user_id": 2883940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edb5f6ac5a83aee6204eb20060f8bbe1?s=128&d=identicon&r=PG&f=1", "display_name": "Cshark", "link": "https://stackoverflow.com/users/2883940/cshark"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435591020, "post_id": 31117999, "comment_id": 50251843, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/81881/discussion-between-cshark-and-thundercat\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1435592094, "creation_date": 1435592094, "answer_id": 31119795, "question_id": 31117999, "link": "https://stackoverflow.com/questions/31117999/gob-over-the-wire/31119795#31119795", "title": "Gob over the wire", "body": "<blockquote>\n  <p>The gob documentation gives the impression that you can simply wrap your TCP connection in a gob decoder and read away. </p>\n</blockquote>\n\n<p>Correct. The package is designed to stream multiple values between an encoder and a decoder. </p>\n\n<blockquote>\n  <p>But what happens if you only received half a message?</p>\n</blockquote>\n\n<p>The decoder calls the underlying io.Reader to get data. If reader cannot return data, then the reader will return an error. The decoder returns this error to the application.</p>\n\n<p>There's no way to recover the decoding stream if the io.Reader returns an error.</p>\n\n<blockquote>\n  <p>Different types of messages</p>\n</blockquote>\n\n<p>You can encode pairs of messages where the first tells the application the type to expect in the second.</p>\n\n<p>You can also create a \"master\" type as you describe. The overhead that you see is incurred once per stream, not once per value.</p>\n"}], "owner": {"reputation": 103, "user_id": 2883940, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edb5f6ac5a83aee6204eb20060f8bbe1?s=128&d=identicon&r=PG&f=1", "display_name": "Cshark", "link": "https://stackoverflow.com/users/2883940/cshark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 31119795, "answer_count": 1, "score": 2, "last_activity_date": 1435592094, "creation_date": 1435587306, "question_id": 31117999, "link": "https://stackoverflow.com/questions/31117999/gob-over-the-wire", "title": "Gob over the wire", "body": "<p>I'm considering using gob (\"encoding/gob\") for serializing data in a network protocol, I have been searching around and can't seem to find any solution to these problems:</p>\n\n<p>Message framing - The gob documentation gives the impression that you can simply wrap your TCP connection in a gob decoder and read away. But what happens if you only received half a message? Can gob somehow deal with this or am I forced to add a message frame and copy over the message data into a buffer for gob to unserialize?</p>\n\n<p>Different types of messages - The protocol has different types of messages, how is this best handled with gob? By having an identifier before every gob blob indicating the type of the data? By putting all messages into a \"Master\" message which contains fields for all the different messages (reducing it to only one type of message)?\nI tried the latter (simpler) and it seems to have a HUGE overhead (>650 bytes).</p>\n"}, {"tags": ["templates", "go", "nested"], "answers": [{"comments": [{"owner": {"reputation": 328, "user_id": 1055865, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bd97b35a46cf0a82ac1b5b8096831b2d?s=128&d=identicon&r=PG", "display_name": "THM", "link": "https://stackoverflow.com/users/1055865/thm"}, "edited": false, "score": 0, "creation_date": 1435662203, "post_id": 31128173, "comment_id": 50283534, "body": "thanks, but that looks like a somewhat fragile workaround. isn&#39;t there a more robust pattern to apply to this very common problem?"}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 0, "last_activity_date": 1435628214, "creation_date": 1435628214, "answer_id": 31128173, "question_id": 31117988, "link": "https://stackoverflow.com/questions/31117988/go-how-to-manage-nested-templates/31128173#31128173", "title": "Go: How to Manage Nested Templates?", "body": "<p>My solution: </p>\n\n<p>Add a comment line like <code>\"templates/_base.tmpl\", \"templates/single.tmpl\", \"templates/meta.tmpl\"</code> at the begin of base template.</p>\n\n<p>Read the template files string and pass them to <code>template.ParseFiles()</code> dynamically.</p>\n"}], "owner": {"reputation": 328, "user_id": 1055865, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bd97b35a46cf0a82ac1b5b8096831b2d?s=128&d=identicon&r=PG", "display_name": "THM", "link": "https://stackoverflow.com/users/1055865/thm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1202, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1435628214, "creation_date": 1435587261, "question_id": 31117988, "link": "https://stackoverflow.com/questions/31117988/go-how-to-manage-nested-templates", "title": "Go: How to Manage Nested Templates?", "body": "<p>Trying to use templates in a sane way, but I think I'm holding it wrong.</p>\n\n<p>Base Template is</p>\n\n<pre><code>{{define \"base\"}}&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n{{template \"head\" .}}\n{{template \"meta\" . }}\n\n&lt;/head&gt;\n&lt;body&gt;\n&lt;!-- some html --&gt;\n    {{template \"body\" .}}   \n&lt;/body&gt;\n</code></pre>\n\n<p>Page Template is</p>\n\n<pre><code>{{define \"head\"}}&lt;title&gt;{{.Title}}&lt;/title&gt;{{end}}\n{{define \"body\"}}&lt;h2&gt;{{.Title}}&lt;/h2&gt;\n\n&lt;p&gt;{{.Content}}&lt;/p&gt;\n\n{{end}}\n</code></pre>\n\n<p>I can output the template like so</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"github.com/gin-gonic/gin\"\n    \"html/template\"\n)\n\nfunc singleHandler(db *sql.DB, r *gin.Engine) gin.HandlerFunc {\n\n    return gin.HandlerFunc(func(c *gin.Context) {\n\n        html := template.Must(template.ParseFiles(\"templates/_base.tmpl\", \"templates/single.tmpl\", \"templates/meta.tmpl\"))\n        r.SetHTMLTemplate(html)\n\n// get data from database\n\n        data := struct {\n            E *model.E\n            M []model.M\n        }{\n            e,\n            m,\n        }\n\n        c.Render(200, c.Engine.HTMLRender, \"base\", data)\n    })\n}\n</code></pre>\n\n<p>But this means that if I add some template for some other block of content in the future, I'll have to go through all other files and add in the new template into template.ParseFiles(\u2026). Also, I'd have to add in all the new code for filling in that template's data into every module that's supposed to do something else.</p>\n\n<p>What's the intended way of structuring modules and nested templates?</p>\n"}, {"tags": ["go", "binaryfiles"], "comments": [{"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1435585240, "post_id": 31117078, "comment_id": 50247643, "body": "<code>go run</code> changes current directory. Try <code>go build &amp;&amp; .&#47;executable</code> instead of <code>go run</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435585304, "post_id": 31117078, "comment_id": 50247690, "body": "You need to show more context, and the errors you receive. Where are you creating the <code>logs</code> directory?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1435585906, "post_id": 31117078, "comment_id": 50248099, "body": "@RoninDev: That&#39;s incorrect."}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1435586044, "post_id": 31117078, "comment_id": 50248198, "body": "@TimCooper I probably incorrectly expressed. I mean that <code>go run</code> executes binary from temp directory. So there is no &quot;logs/&quot; folder there"}, {"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "edited": false, "score": 3, "creation_date": 1435586053, "post_id": 31117078, "comment_id": 50248202, "body": "Try using the abolute path to the log file. If you move the binary anywhere it should still work. With your current code it will only work as long as the binary is ran in relative position to your log folder."}, {"owner": {"reputation": 6394, "user_id": 3060739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d3f6899a9bbad79b7c7c0e11b0800b5e?s=128&d=identicon&r=PG", "display_name": "Haven", "link": "https://stackoverflow.com/users/3060739/haven"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1435586193, "post_id": 31117078, "comment_id": 50248296, "body": "@RoninDev it is my fault, at first i did not explain correctly"}], "answers": [{"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": 1, "last_activity_date": 1435603245, "last_edit_date": 1435603245, "creation_date": 1435586351, "answer_id": 31117648, "question_id": 31117078, "link": "https://stackoverflow.com/questions/31117078/run-go-executable-file-with-file-i-o/31117648#31117648", "title": "run go executable file with file i/o", "body": "<p>The problem is the \"logs/\", which is a relative path. If you used an absolute path (create and use \"/logs/\" for instance) then that would solve the problem.</p>\n\n<p>I just installed and ran this successfully (after creating /logs/ and setting permissions):</p>\n\n<pre><code>package main\n\nimport (\n\n    \"log\"\n    \"os\"\n    \"time\"\n    \"strconv\"\n)\n\n\nfunc main() {\n\n    t := time.Now()\n    filename := \"/logs/\" + strconv.FormatInt(t.Unix(), 10) + \".txt\"\n    logFile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n    if err != nil {\n        panic(err)\n    }\n    defer logFile.Close()\n    log.SetOutput(logFile)\n}\n</code></pre>\n\n<p>If you leave the path relative then add: \"/src/tapi/logs\" in the directory structure and it will work.</p>\n\n<p>Under those circumstances this ran fine for me:</p>\n\n<pre><code>package main\n\nimport (\n\n    \"log\"\n    \"os\"\n    \"time\"\n    \"strconv\"\n)\n\n\nfunc main() {\n\n    t := time.Now()\n    filename := \"logs/\" + strconv.FormatInt(t.Unix(), 10) + \".txt\"\n    logFile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n    if err != nil {\n        panic(err)\n    }\n    defer logFile.Close()\n    log.SetOutput(logFile)\n}\n</code></pre>\n"}], "owner": {"reputation": 6394, "user_id": 3060739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d3f6899a9bbad79b7c7c0e11b0800b5e?s=128&d=identicon&r=PG", "display_name": "Haven", "link": "https://stackoverflow.com/users/3060739/haven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1435603245, "creation_date": 1435584734, "last_edit_date": 1435585631, "question_id": 31117078, "link": "https://stackoverflow.com/questions/31117078/run-go-executable-file-with-file-i-o", "title": "run go executable file with file i/o", "body": "<p>The executable file <code>tapi</code> under folder <code>bin</code> can't create the log file (in my Mac), btw. I already create the folder <code>logs</code></p>\n\n<pre><code>panic: open logs/1435584525.txt: no such file or directory\n</code></pre>\n\n<p>it runs correct with command line <code>tapi</code></p>\n\n<p>the code I use is:</p>\n\n<pre><code>t := time.Now()\nfilename := \"logs/\" + strconv.FormatInt(t.Unix(),10) + \".txt\"\nlogFile, err := os.OpenFile(filename, os.O_RDWR | os.O_CREATE | os.O_APPEND, 0666)\nif err != nil {\n    panic(err)\n}\ndefer logFile.Close()\nlog.SetOutput(logFile)\n</code></pre>\n\n<p>the structure of files is :</p>\n\n<p>bin/tapi</p>\n\n<p>pkg</p>\n\n<p>src/userName/tapi/tapi.go</p>\n"}, {"tags": ["http", "go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": false, "score": 4, "last_activity_date": 1435584372, "creation_date": 1435584372, "answer_id": 31116943, "question_id": 31116870, "link": "https://stackoverflow.com/questions/31116870/goroutine-execution-inside-an-http-handler/31116943#31116943", "title": "Goroutine execution inside an http handler", "body": "<p>Yes, it will complete totally independent of your request.</p>\n\n<p>This can be useful to complete slow operations such as database updates that are not relevant to your response (e.g.: update a view counter).</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1435705050, "last_edit_date": 1435705050, "creation_date": 1435584385, "answer_id": 31116947, "question_id": 31116870, "link": "https://stackoverflow.com/questions/31116870/goroutine-execution-inside-an-http-handler/31116947#31116947", "title": "Goroutine execution inside an http handler", "body": "<p>Yes, it will complete, there's nothing stopping it.</p>\n\n<p>The only thing that stops goroutines to finish <em>\"from the outside\"</em> is returning from the <code>main()</code> function (which also means finishing the execution of your program, but this never happens in your case). And other circumstances which lead to unstable states like running out of memory.</p>\n"}], "owner": {"reputation": 1389, "user_id": 547840, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d031826c72b27db3f6653b8f616dd7b5?s=128&d=identicon&r=PG", "display_name": "baijum", "link": "https://stackoverflow.com/users/547840/baijum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1395, "favorite_count": 1, "accepted_answer_id": 31116947, "answer_count": 2, "score": 4, "last_activity_date": 1435705050, "creation_date": 1435584156, "last_edit_date": 1435589601, "question_id": 31116870, "link": "https://stackoverflow.com/questions/31116870/goroutine-execution-inside-an-http-handler", "title": "Goroutine execution inside an http handler", "body": "<p>If I start a goroutine inside an http handler, is it going to complete even after returning the response ? Here is an example code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc worker() {\n    fmt.Println(\"worker started\")\n    time.Sleep(time.Second * 10)\n    fmt.Println(\"worker completed\")\n}\n\nfunc HomeHandler(w http.ResponseWriter, r *http.Request) {\n    go worker()\n    w.Write([]byte(\"Hello, World!\"))\n}\n\nfunc main() {\n    http.HandleFunc(\"/home\", HomeHandler)\n    http.ListenAndServe(\":8081\", nil)\n}\n</code></pre>\n\n<p>In the above example, is that <code>worker</code> goroutine going to complete in all situations ? Or is there any special case when it is not going to complete?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "edited": false, "score": 0, "creation_date": 1435615075, "post_id": 31116931, "comment_id": 50264935, "body": "In the structure, what does <code>bson:&quot;text&quot;</code> stand for? Is there any reference that I can check to have a better understand for this?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "edited": false, "score": 1, "creation_date": 1435615205, "post_id": 31116931, "comment_id": 50264996, "body": "See the <a href=\"http://godoc.org/labix.org/v2/mgo/bson#Marshal\" rel=\"nofollow noreferrer\">bson package</a> documentation for information on how the package uses field tags."}, {"owner": {"reputation": 648, "user_id": 555129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf5cbc92ee7d467ed5d9f26bd2a6a78?s=128&d=identicon&r=PG", "display_name": "Amol", "link": "https://stackoverflow.com/users/555129/amol"}, "edited": false, "score": 1, "creation_date": 1511931823, "post_id": 31116931, "comment_id": 82047575, "body": "Thanks! How does one select multiple columns? Just adding Select(bson.M{&quot;text&quot;: 1, &quot;anotherColumn&quot;:1}) does not work."}, {"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 0, "creation_date": 1523210363, "post_id": 31116931, "comment_id": 86455050, "body": "why <code>it returns in</code>type map[][] ` not as json"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 24, "last_activity_date": 1435584330, "creation_date": 1435584330, "answer_id": 31116931, "question_id": 31116528, "link": "https://stackoverflow.com/questions/31116528/select-column-from-mongodb-in-golang-using-mgo/31116931#31116931", "title": "Select column from Mongodb in golang using mgo", "body": "<p>Use the query <a href=\"http://godoc.org/labix.org/v2/mgo#Query.Select\" rel=\"noreferrer\">Select</a> method to specify the fields to return:</p>\n\n<pre><code>var result []struct{ Text string `bson:\"text\"` }\nerr := c.Find(nil).Select(bson.M{\"text\": 1}).All(&amp;result)\nif err != nil {\n    // handle error\n}\nfor _, v := range result {\n     fmt.Println(v.Text)\n}\n</code></pre>\n\n<p>In this example, I declared an anonymous type with the one selected field. It's OK to use a type with all document fields.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4879692, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206495985455569/picture?type=large", "display_name": "drrzmr", "link": "https://stackoverflow.com/users/4879692/drrzmr"}, "is_accepted": false, "score": 2, "last_activity_date": 1519406203, "creation_date": 1519406203, "answer_id": 48953080, "question_id": 31116528, "link": "https://stackoverflow.com/questions/31116528/select-column-from-mongodb-in-golang-using-mgo/48953080#48953080", "title": "Select column from Mongodb in golang using mgo", "body": "<p>to select multiple fields:</p>\n\n<pre><code>var result []struct{\n    Text string `bson:\"text\"`\n    Otherfield string `bson:\"otherfield\"`\n}\n\nerr := c.Find(nil).Select(bson.M{\"text\": 1, \"otherfield\": 1}).All(&amp;result)\nif err != nil {\n   // handle error\n}\nfor _, v := range result {\n    fmt.Println(v.Text)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11486905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GyrM.gif?s=128&g=1", "display_name": "Jyotsna Gupta", "link": "https://stackoverflow.com/users/11486905/jyotsna-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1558319026, "creation_date": 1558319026, "answer_id": 56213639, "question_id": 31116528, "link": "https://stackoverflow.com/questions/31116528/select-column-from-mongodb-in-golang-using-mgo/56213639#56213639", "title": "Select column from Mongodb in golang using mgo", "body": "<pre><code>var result interface{}\nerr = c.Find(nil).Select(bson.M{\"text\": 1}).All(&amp;result)\n\n</code></pre>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15519, "favorite_count": 1, "accepted_answer_id": 31116931, "answer_count": 3, "score": 15, "last_activity_date": 1558319026, "creation_date": 1435583157, "question_id": 31116528, "link": "https://stackoverflow.com/questions/31116528/select-column-from-mongodb-in-golang-using-mgo", "title": "Select column from Mongodb in golang using mgo", "body": "<p>As I know, we can use</p>\n\n<pre><code>&gt; db['twitter-3'].find({}, {\"text\": 1})\n</code></pre>\n\n<p>to select all texts in collection.</p>\n\n<p>How can we use mgo to find specific field in golang?\nI tried </p>\n\n<pre><code>var result []string\nerr = conn.Find(bson.M{}, bson.M{\"text\", 1}).All(&amp;result)\n</code></pre>\n\n<p>But it is not correct.</p>\n"}, {"tags": ["logging", "go"], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 2, "last_activity_date": 1511781720, "last_edit_date": 1511781720, "creation_date": 1435584333, "answer_id": 31116934, "question_id": 31116503, "link": "https://stackoverflow.com/questions/31116503/golang-logger-fatal/31116934#31116934", "title": "Golang logger fatal", "body": "<p><code>log.Fatalln</code> exits your app, so the second <code>fmt.Print(&amp;buf)</code> does not get executed.</p>\n\n<p>Change your logger to write to <code>os.Stderr</code> or something and you will see <code>Ut oh</code> print.</p>\n"}], "owner": {"reputation": 71, "user_id": 4389258, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db2b4999b0defd9d84f30e4a7b48c9a3?s=128&d=identicon&r=PG&f=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/4389258/gon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1511781720, "creation_date": 1435583092, "last_edit_date": 1435584259, "question_id": 31116503, "link": "https://stackoverflow.com/questions/31116503/golang-logger-fatal", "title": "Golang logger fatal", "body": "<pre><code>package main\n\nimport (\n        \"bytes\"\n        \"fmt\"\n        \"log\"\n)\n\nfunc main() {   \n        // Log into byte\n        var buf bytes.Buffer\n        logInfo := log.New(&amp;buf, \"[Info] \", log.Lshortfile)\n        logInfo.Print(\"Hello, log file!\")\n        logInfo.Printf(\"Hello, %s\", \"crazy\")\n        fmt.Print(&amp;buf)\n        logInfo.Fatalln(\"Ut oh\")\n        fmt.Print(&amp;buf)\n   }\n</code></pre>\n\n<p>Hello. I am trying to use log.Fatal or log.Fatalln instead of having log.New and os.Exit. However, it seems like the logger does not log \"Ut oh\" part (logInfo.Fatalln)</p>\n\n<p>Following is expected output:</p>\n\n<pre><code>[Info] main.go:17: Hello, log file!\n[Info] main.go:18: Hello, crazy\n[Info] main.go:17: Hello, log file!\n[Info] main.go:18: Hello, crazy\n[Info] main.go:xx: Ut oh\n</code></pre>\n\n<p>Following is what I got:</p>\n\n<pre><code>[Info] main.go:17: Hello, log file!\n[Info] main.go:18: Hello, crazy\n\nit seems like it didn't do anything from logInfo.Fatalln(\"Ut oh\")\n</code></pre>\n\n<p>Could you please tell me what I missed?\nThank you</p>\n"}, {"tags": ["go", "idioms"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1435577212, "post_id": 31114359, "comment_id": 50242262, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/28506013/idiomatic-golang-goroutines\">Idiomatic Golang goroutines</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1435577224, "post_id": 31114359, "comment_id": 50242266, "body": "Well, that depends. Go is not narrow minded: Whatever suites your problem more is the &quot;right&quot; solution.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": -1, "last_activity_date": 1435628845, "creation_date": 1435628845, "answer_id": 31128261, "question_id": 31114359, "link": "https://stackoverflow.com/questions/31114359/is-a-blocking-function-on-an-asynchronous-api-idiomatic/31128261#31128261", "title": "Is a blocking function on an asynchronous api idiomatic?", "body": "<p>For golang, I recommend <a href=\"http://golang.org/doc/effective_go.html#concurrency\" rel=\"nofollow\">Effective Go-concurrency</a>. Especially I think everyone using golang need to known the basics of <code>goroutine</code> and <code>parallelization</code>:</p>\n\n<p>Goroutines are multiplexed onto multiple OS threads so if one should block, such as while waiting for I/O, others continue to run. Their design hides many of the complexities of thread creation and management.</p>\n\n<p>The current implementation of the Go runtime dedicates only a single core to user-level processing. An arbitrary number of goroutines can be blocked in system calls, but by default only one can be executing user-level code at any time.</p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 557, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435628845, "creation_date": 1435576885, "last_edit_date": 1435577990, "question_id": 31114359, "link": "https://stackoverflow.com/questions/31114359/is-a-blocking-function-on-an-asynchronous-api-idiomatic", "title": "Is a blocking function on an asynchronous api idiomatic?", "body": "<p>Is it more idiomatic to have an async api, with a blocking function as the synchronous api that simply calls the async api and waits for an answer before returning, rather than using a non-concurrent api and let the caller run it in their own goroutine if they want it async?</p>\n\n<p>In my current case I have a worker goroutine that reads from a request channel and sends the return value down the response channel (that it got in a request struct from the request channel). </p>\n\n<p>This seems to differ from the linked question since I need the return values, or to synchronize so that I can be sure the api call finishes before I do something else, to avoid race conditions.</p>\n"}, {"tags": ["string", "go", "concatenation", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1471849217, "last_edit_date": 1471849217, "creation_date": 1435573896, "answer_id": 31113429, "question_id": 31113299, "link": "https://stackoverflow.com/questions/31113299/golang-append-string-in-string-slice/31113429#31113429", "title": "Golang append string in string slice", "body": "<p>The builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow\"><code>append()</code></a> function is for appending elements to a slice. If you want to append a <code>string</code> to a <code>string</code>, simply use the concatenation <code>+</code>. And if you want to store the result at the 0th index, simply assign the result to it:</p>\n\n<pre><code>s[0] = s[0] + \"dd\"\n</code></pre>\n\n<p>Or short:</p>\n\n<pre><code>s[0] += \"dd\"\n</code></pre>\n\n<p>Note also that you don't have to (can't) use <code>:=</code> which is a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">short variable declaration</a>, since your <code>s</code> slice already exists.</p>\n\n<p><code>fmt.Println(s)</code> output:</p>\n\n<pre><code>[filenamedd]\n</code></pre>\n\n<p>If you want to append to the slice and not to the first element, then write:</p>\n\n<pre><code>s = append(s, \"dd\")\n</code></pre>\n\n<p><code>fmt.Println(s)</code> output (continuing the previous example):</p>\n\n<pre><code>[filenamedd dd]\n</code></pre>\n\n<p>Try these on the <a href=\"http://play.golang.org/p/H7hfSg7rYM\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9809, "favorite_count": 0, "accepted_answer_id": 31113429, "answer_count": 1, "score": 2, "last_activity_date": 1471849217, "creation_date": 1435573549, "last_edit_date": 1435576007, "question_id": 31113299, "link": "https://stackoverflow.com/questions/31113299/golang-append-string-in-string-slice", "title": "Golang append string in string slice", "body": "<p>How to append string in a string sclice?\nI tried</p>\n\n<pre><code>s := make([]string, 1, 4)\ns[0] = \"filename\"\ns[0] := append(s[0], \"dd\")\n</code></pre>\n\n<p>But it is not correct. Then I tried</p>\n\n<pre><code>s[:1] := append(s[:1], \"dd\")\n</code></pre>\n\n<p>But it is not correct either.</p>\n\n<p>How can I append a string to <code>s[0]</code>?</p>\n"}, {"tags": ["dictionary", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1435571282, "post_id": 31112487, "comment_id": 50238718, "body": "@Intermernet Thanks! I used your code but with slightly changes."}, {"owner": {"reputation": 6394, "user_id": 3060739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d3f6899a9bbad79b7c7c0e11b0800b5e?s=128&d=identicon&r=PG", "display_name": "Haven", "link": "https://stackoverflow.com/users/3060739/haven"}, "edited": false, "score": 1, "creation_date": 1435571303, "post_id": 31112487, "comment_id": 50238725, "body": "what a meaningless comma, especially in the slice !"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 8, "creation_date": 1435571716, "post_id": 31112487, "comment_id": 50238968, "body": "I actually find this comma really convenient as it allows adding/removing/commenting out map/slice elements in the same way no matter whether they are in the middle or at the end."}], "tags": [], "owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "is_accepted": true, "score": 5, "last_activity_date": 1435571180, "last_edit_date": 1435571180, "creation_date": 1435571036, "answer_id": 31112487, "question_id": 31112426, "link": "https://stackoverflow.com/questions/31112426/create-map-of-string-slice-in-go/31112487#31112487", "title": "create map of string slice in go", "body": "<p>You have to add a comma <code>,</code> at the end of each initializer list.</p>\n\n<pre><code>newMap := map [string][]string{\n    \"first\" : {\n        \"good\", \"bad\",\n    },\n    \"second\" : {\n        \"top\", \"bottom\",\n    },\n}\n</code></pre>\n\n<p>You can find a working example <a href=\"http://play.golang.org/p/Uq1XJlS9LM\">here</a>.</p>\n"}], "owner": {"reputation": 6394, "user_id": 3060739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d3f6899a9bbad79b7c7c0e11b0800b5e?s=128&d=identicon&r=PG", "display_name": "Haven", "link": "https://stackoverflow.com/users/3060739/haven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 31112487, "answer_count": 1, "score": 2, "last_activity_date": 1435571180, "creation_date": 1435570842, "question_id": 31112426, "link": "https://stackoverflow.com/questions/31112426/create-map-of-string-slice-in-go", "title": "create map of string slice in go", "body": "<p>I am try to create a map of string slice with the code in GO</p>\n\n<pre><code>newMap := map [string][]string{\n    \"first\" : {\n        \"good\", \"bad\"\n    },\n    \"second\" : {\n        \"top\", \"bottom\"\n    }\n}\n</code></pre>\n\n<p>It seems not to be the right way, what is the wrong with it?</p>\n"}, {"tags": ["go", "package", "eof"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 20, "creation_date": 1435563898, "post_id": 31110191, "comment_id": 50234588, "body": "Did you saved your program.go source file before calling go run? And wouldn&#39;t it work better with <code>package main</code>?"}, {"owner": {"reputation": 1457, "user_id": 1402745, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/60f2d43e4fa314427bbc586922a1ef0a?s=128&d=identicon&r=PG", "display_name": "ThisIsErico", "link": "https://stackoverflow.com/users/1402745/thisiserico"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1435567226, "post_id": 31110191, "comment_id": 50236333, "body": "Thanks for the reply! Yes, <code>package main</code> would be more appropriate. That&#39;s how it used to be and was failing with the exact same error. Sure, the file was saved ;)"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1435567408, "post_id": 31110191, "comment_id": 50236425, "body": "Is there some kind of eol error (windows end of line instead of unix?)"}, {"owner": {"reputation": 1457, "user_id": 1402745, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/60f2d43e4fa314427bbc586922a1ef0a?s=128&d=identicon&r=PG", "display_name": "ThisIsErico", "link": "https://stackoverflow.com/users/1402745/thisiserico"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1435567655, "post_id": 31110191, "comment_id": 50236565, "body": "Not really either :("}, {"owner": {"reputation": 1457, "user_id": 1402745, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/60f2d43e4fa314427bbc586922a1ef0a?s=128&d=identicon&r=PG", "display_name": "ThisIsErico", "link": "https://stackoverflow.com/users/1402745/thisiserico"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1435568089, "post_id": 31110191, "comment_id": 50236816, "body": "Interesting... Of course I&#39;m getting an <code>EOF</code>... The files are indeed empty. The <code>go get</code> execution seems to be failing at some point."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1435570729, "post_id": 31110191, "comment_id": 50238379, "body": "Do not set GOROOT. GOROOT is cargo cult from the old days."}, {"owner": {"reputation": 1457, "user_id": 1402745, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/60f2d43e4fa314427bbc586922a1ef0a?s=128&d=identicon&r=PG", "display_name": "ThisIsErico", "link": "https://stackoverflow.com/users/1402745/thisiserico"}, "edited": false, "score": 0, "creation_date": 1435571974, "post_id": 31110191, "comment_id": 50239119, "body": "True thing, I was only setting <code>GOPATH</code>. <code>GOROOT</code> gets set automatically to the installation directory ( maybe it&#39;s the puppet module I&#39;m using the one setting it )."}], "answers": [{"tags": [], "owner": {"reputation": 1457, "user_id": 1402745, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/60f2d43e4fa314427bbc586922a1ef0a?s=128&d=identicon&r=PG", "display_name": "ThisIsErico", "link": "https://stackoverflow.com/users/1402745/thisiserico"}, "is_accepted": true, "score": 12, "last_activity_date": 1435569646, "creation_date": 1435569646, "answer_id": 31112032, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/31112032#31112032", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>The problem wasn't neither with <code>GOROOT</code> nor <code>GOPATH</code>. The go installation failed at some point, leaving the whole thing unstable ( files created but completely empty ). When provisioning the virtual machine again, the go module checked whether the files existed. As they did, it took by granted that the installation had already take place.</p>\n\n<p>A clean up and fresh installation from scratch solved the problem.</p>\n"}, {"comments": [{"owner": {"reputation": 6041, "user_id": 5138921, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f202e6926526d8b4ad819de30504e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Alf Moh", "link": "https://stackoverflow.com/users/5138921/alf-moh"}, "edited": false, "score": 1, "creation_date": 1596874368, "post_id": 38812470, "comment_id": 111955430, "body": "Thank you so much. All the other answers weren&#39;t working out for me and I couldn&#39;t have figured this out either. Such an unhelpful error message."}], "tags": [], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "is_accepted": false, "score": 26, "last_activity_date": 1470559812, "creation_date": 1470559812, "answer_id": 38812470, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/38812470#38812470", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>This usually happens when you have a file e.g. foo_test.go empty or without package declaration.</p>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 1873858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a258edaba9779169f1672557b9137c?s=128&d=identicon&r=PG", "display_name": "tdensmore", "link": "https://stackoverflow.com/users/1873858/tdensmore"}, "is_accepted": false, "score": 3, "last_activity_date": 1488255285, "creation_date": 1488255285, "answer_id": 42500113, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/42500113#42500113", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>For me, this also happened using Atom + Go Plus + Terminal Plus. The problem was that leading bracket was not on the \"correct\" line. </p>\n\n<p><strong>NOTE</strong>: Go Plus warns about syntax upon save, but I had imported this file after creating it locally with VIM, so I was never presented with the lint errors...</p>\n\n<p>Error:</p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main() \n{\n    fmt.Println(\"hello world\")\n}\n</code></pre>\n\n<p>Correct:</p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main() {\n    fmt.Println(\"hello world\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7796, "user_id": 2334254, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-6e2XuTZAjgM/AAAAAAAAAAI/AAAAAAAAABU/JpF2-AkHsH4/photo.jpg?sz=128", "display_name": "kpie", "link": "https://stackoverflow.com/users/2334254/kpie"}, "is_accepted": false, "score": -2, "last_activity_date": 1499229350, "creation_date": 1499229350, "answer_id": 44917108, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/44917108#44917108", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>As a new go user I came upon this answer looking for someone to tell me that I need to start my scripts with <code>package main</code> although my error was a little different, </p>\n\n<p>... <code>expected 'package', found 'import'</code></p>\n\n<p>It's real obvious now, but hey, that's how it goes.</p>\n"}, {"comments": [{"owner": {"reputation": 156, "user_id": 9652400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89cd8b30c323400b11551c887d506e88?s=128&d=identicon&r=PG", "display_name": "Ambareesh", "link": "https://stackoverflow.com/users/9652400/ambareesh"}, "edited": false, "score": 1, "creation_date": 1576378640, "post_id": 49067929, "comment_id": 104879325, "body": "Worked on Ubuntu too!"}, {"owner": {"reputation": 131, "user_id": 4784797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6753d8e2165204de6655310e13dc1a22?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Khan", "link": "https://stackoverflow.com/users/4784797/hamza-khan"}, "edited": false, "score": 1, "creation_date": 1598677758, "post_id": 49067929, "comment_id": 112543088, "body": "Worked on Mac OS as well"}, {"owner": {"reputation": 2272, "user_id": 5562045, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/rWILr.png?s=128&g=1", "display_name": "rustyMagnet", "link": "https://stackoverflow.com/users/5562045/rustymagnet"}, "edited": false, "score": 0, "creation_date": 1613143801, "post_id": 49067929, "comment_id": 116993268, "body": "That solved it for me, on macOS.  Now I selected <code>auto save</code> in VS Code to avoid this time waster...."}], "tags": [], "owner": {"reputation": 2158, "user_id": 1312265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2ffeafb08435f0369ea545b3f381e7ea?s=128&d=identicon&r=PG", "display_name": "Code_Yoga", "link": "https://stackoverflow.com/users/1312265/code-yoga"}, "is_accepted": false, "score": 72, "last_activity_date": 1519989012, "creation_date": 1519989012, "answer_id": 49067929, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/49067929#49067929", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>Using VS Code for GO, and faced the same issue.\nSaving the file 'Ctrl+S' on Windows fixed the issue.</p>\n\n<p>Reference : \n<a href=\"http://grokbase.com/t/gg/golang-nuts/151qdw7aqe/go-nuts-main-go-1-1-expected-package-found-eof\" rel=\"noreferrer\">Answered by Nico</a></p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 7880083, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gllzcanGrbY/AAAAAAAAAAI/AAAAAAAAAE4/fg9QBDdar0Y/photo.jpg?sz=128", "display_name": "sonu1986", "link": "https://stackoverflow.com/users/7880083/sonu1986"}, "is_accepted": false, "score": 0, "last_activity_date": 1545856629, "creation_date": 1545856629, "answer_id": 53936913, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/53936913#53936913", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>As said by already suggested by Nico, When you create a new project and new main.go file this error will appear when the file is not saved. Save the file (ctrl + s) and this error will disappear in both mac &amp; windows.\nI faced the same issue and just got it resolved by doing ctrl+S on the main.go file.  </p>\n"}, {"comments": [{"owner": {"reputation": 291, "user_id": 10856988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DDlHR.png?s=128&g=1", "display_name": "starzar", "link": "https://stackoverflow.com/users/10856988/starzar"}, "edited": false, "score": 0, "creation_date": 1566190773, "post_id": 57545606, "comment_id": 101563750, "body": "Why the downvote?...If there is some doubt about the above solution, try keeping  an Undeclared  .go file in the same  package folder .The  console flags &quot; expected package ,found EOF&quot; error (as asked in the above question)"}, {"owner": {"reputation": 86, "user_id": 249074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d143ffc2b7f4f28738d202709525e45c?s=128&d=identicon&r=PG", "display_name": "Manny T", "link": "https://stackoverflow.com/users/249074/manny-t"}, "edited": false, "score": 1, "creation_date": 1576164325, "post_id": 57545606, "comment_id": 104817860, "body": "This was the problem for me. it was such a simple miss but this comment helped, thank you."}], "tags": [], "owner": {"reputation": 291, "user_id": 10856988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DDlHR.png?s=128&g=1", "display_name": "starzar", "link": "https://stackoverflow.com/users/10856988/starzar"}, "is_accepted": false, "score": 2, "last_activity_date": 1566139358, "creation_date": 1566139358, "answer_id": 57545606, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/57545606#57545606", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>A <strong>separate Go file</strong> in the same package,<strong>didn't have the \"package main\" declaration</strong>\nand because of this the console was giving <strong>errors on running the Main GO file</strong>.</p>\n\n<p>On providing the <strong>package main declaration to the other Go file</strong> ,the error stopped showing.</p>\n"}, {"comments": [{"owner": {"reputation": 893, "user_id": 3556287, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000597544482/picture?type=large", "display_name": "Vyas Reddy", "link": "https://stackoverflow.com/users/3556287/vyas-reddy"}, "edited": false, "score": 3, "creation_date": 1569223361, "post_id": 58057305, "comment_id": 102512110, "body": "Every developer face this issue. Do cltr+s five times before you run"}], "tags": [], "owner": {"reputation": 297, "user_id": 5069192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fTJum.jpg?s=128&g=1", "display_name": "Javed", "link": "https://stackoverflow.com/users/5069192/javed"}, "is_accepted": false, "score": 17, "last_activity_date": 1569222627, "creation_date": 1569222627, "answer_id": 58057305, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/58057305#58057305", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>Just save the file first and than run the cammand.it is working.</p>\n\n<p>go run main.go </p>\n"}, {"comments": [{"owner": {"reputation": 1601, "user_id": 1907765, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed02bd6c00c0fb529136773bacdd072e?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1907765/lou"}, "edited": false, "score": 0, "creation_date": 1592739676, "post_id": 61326847, "comment_id": 110526652, "body": "Hi there, I&#39;ve tried this solution and it resulted in the error <code>Command &#39;Go: Restart Language Server&#39; resulted in an error (command &#39;go.languageserver.restart&#39; not found)</code>. Any idea why this might be?"}, {"owner": {"reputation": 1601, "user_id": 1907765, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed02bd6c00c0fb529136773bacdd072e?s=128&d=identicon&r=PG&f=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1907765/lou"}, "edited": false, "score": 1, "creation_date": 1592741310, "post_id": 61326847, "comment_id": 110527077, "body": "Actually never mind, it just turns out my environment variables weren&#39;t configured correctly. I changed the path and now it works!"}, {"owner": {"reputation": 462, "user_id": 6602159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/phhUH.jpg?s=128&g=1", "display_name": "M. Rostami", "link": "https://stackoverflow.com/users/6602159/m-rostami"}, "edited": false, "score": 0, "creation_date": 1607611550, "post_id": 61326847, "comment_id": 115331939, "body": "It doesn&#39;t work but gave an idea to reload the VSCode, then the problem has solved."}], "tags": [], "owner": {"reputation": 1226, "user_id": 1716905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf004baf04689322a8766ebc1efd5e07?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/1716905/luke"}, "is_accepted": false, "score": 7, "last_activity_date": 1587398521, "creation_date": 1587398521, "answer_id": 61326847, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/61326847#61326847", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>With gopls (v0.4.0 at the time of writing, so pretty unstable!) and vscode doing <code>cmd+shift+P &gt; Go: Restart language server</code> worked for me.</p>\n"}, {"tags": [], "owner": {"reputation": 104, "user_id": 8350081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/663b74baecd5d50bd9b2d1750140ad23?s=128&d=identicon&r=PG&f=1", "display_name": "Muthulakshmi M", "link": "https://stackoverflow.com/users/8350081/muthulakshmi-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1603936586, "creation_date": 1603936586, "answer_id": 64583857, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof/64583857#64583857", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>In my case i was solve the problem by Using <strong>&quot;VS Code&quot;</strong> <em>instead of</em> default <strong>&quot;text editor&quot;</strong></p>\n<p>The problem was some extra characters present in the file. Once we remove extra characters it will work.</p>\n<p>I wish it will solve to you also.</p>\n"}], "owner": {"reputation": 1457, "user_id": 1402745, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/60f2d43e4fa314427bbc586922a1ef0a?s=128&d=identicon&r=PG", "display_name": "ThisIsErico", "link": "https://stackoverflow.com/users/1402745/thisiserico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60605, "favorite_count": 7, "protected_date": 1569211373, "accepted_answer_id": 31112032, "answer_count": 10, "score": 36, "last_activity_date": 1603936586, "creation_date": 1435563410, "question_id": 31110191, "link": "https://stackoverflow.com/questions/31110191/go-failing-expected-package-found-eof", "title": "Go failing - expected &#39;package&#39;, found &#39;EOF&#39;", "body": "<p>I've been having a hard time trying to execute a simple golang program in a virtual machine powered by vagrant.\nThese are the relevant fields of my <code>go env</code>:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOPATH=\"/usr/local/src/go\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\"\n</code></pre>\n\n<p>This is the program I'm trying to execute ( located in /usr/local/src/go/program ):</p>\n\n<pre><code>package program\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Print(\"Aloha\")\n}\n</code></pre>\n\n<p>This, the output that I get:</p>\n\n<pre><code>main.go:4:5:\n/usr/local/go/src/fmt/doc.go:1:1: expected 'package', found 'EOF'\npackage runtime:\n/usr/local/go/src/runtime/alg.go:1:1: expected 'package', found 'EOF'\n</code></pre>\n\n<p>Take into account that this is a completely fake program. The weird thing is that it totally works in a different environment.\nWhat am I missing here?</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["python", "http", "web", "go", "flask"], "answers": [{"comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 3, "creation_date": 1435557801, "post_id": 31108761, "comment_id": 50231769, "body": "The source is a good reference too: <a href=\"http://golang.org/src/net/http/server.go?s=51504:51550#L1714\" rel=\"nofollow noreferrer\">golang.org/src/net/http/server.go?s=51504:51550#L1714</a>"}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 4, "last_activity_date": 1435557715, "creation_date": 1435557715, "answer_id": 31108761, "question_id": 31108408, "link": "https://stackoverflow.com/questions/31108408/go-web-server-requests-spawn-its-own-goroutine/31108761#31108761", "title": "Go web server requests spawn its own goroutine?", "body": "<p>Go's HTTP server (in <code>net/http</code>) spawns a goroutine (not a thread) per request as per the docs for <a href=\"http://golang.org/pkg/net/http/#Server.Serve\" rel=\"nofollow\">http://golang.org/pkg/net/http/#Server.Serve</a> -</p>\n\n<blockquote>\n  <p>Serve accepts incoming connections on the Listener l, creating a new service goroutine for each. The service goroutines read requests and then call srv.Handler to reply to them.</p>\n</blockquote>\n\n<p>Other languages handle this in many ways, including:</p>\n\n<ul>\n<li>Event-based architectures ala node.js<a href=\"https://nodesource.com/blog/understanding-the-nodejs-event-loop\" rel=\"nofollow\">1</a> and</li>\n<li>Multiple processes and/or threads (or both) where the \"manager\" switches between the active thread based on what is blocking (and what isn't)</li>\n</ul>\n\n<p>I'd suggest reading <a href=\"https://www.digitalocean.com/community/tutorials/a-comparison-of-rack-web-servers-for-ruby-web-applications\" rel=\"nofollow\">https://www.digitalocean.com/community/tutorials/a-comparison-of-rack-web-servers-for-ruby-web-applications</a> for an example of how some of the Ruby web servers do things (which include the approaches above), and <a href=\"https://www.digitalocean.com/community/tutorials/a-comparison-of-web-servers-for-python-based-web-applications\" rel=\"nofollow\">https://www.digitalocean.com/community/tutorials/a-comparison-of-web-servers-for-python-based-web-applications</a> for Python, which should give some insight.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1492, "favorite_count": 1, "accepted_answer_id": 31108761, "answer_count": 1, "score": 3, "last_activity_date": 1435557715, "creation_date": 1435555830, "question_id": 31108408, "link": "https://stackoverflow.com/questions/31108408/go-web-server-requests-spawn-its-own-goroutine", "title": "Go web server requests spawn its own goroutine?", "body": "<p>I want to know how exactly goroutine and go web server works whenever requests come in:</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>In this code, </p>\n\n<ol>\n<li><p>Every request to <code>/</code> calls the <code>handler</code>. Does this mean each request spawns its own goroutine? Or does it spawns its own <code>process</code> or <code>thread</code>? Is there any documentation on how those requests get its own goroutine?</p></li>\n<li><p>How do other languages handle this request? For example, does Python flask launch its own process for each request?</p></li>\n</ol>\n\n<p>Thanks,</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 2, "last_activity_date": 1435556736, "creation_date": 1435556736, "answer_id": 31108584, "question_id": 31108091, "link": "https://stackoverflow.com/questions/31108091/how-to-pass-byte-to-external-exiftool-via-stdin/31108584#31108584", "title": "How to pass []byte to external exiftool via stdin?", "body": "<p>Something like</p>\n\n<pre><code>out, err := os.Create(\"updated_image.jpg\")\nif err != nil {\n    log.Fatal(err)\n}\ncmd := exec.Command(\"exiftool\", \"-author=some_auth\", \"-\")\ncmd.Stdout = out\ncmd.Stdin = bytes.NewReader(img)\nerr = cmd.Run()\nif err != nil {\n    log.Fatal(err)\n}\nout.Close()\n</code></pre>\n\n<p>should work.</p>\n\n<p>Note that I haven't tested the code.</p>\n"}], "owner": {"reputation": 17, "user_id": 1178533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/930bf6bad1c81a47c505e8f1bdc9c15a?s=128&d=identicon&r=PG", "display_name": "munk", "link": "https://stackoverflow.com/users/1178533/munk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 31108584, "answer_count": 1, "score": 0, "last_activity_date": 1435561170, "creation_date": 1435554063, "last_edit_date": 1435561170, "question_id": 31108091, "link": "https://stackoverflow.com/questions/31108091/how-to-pass-byte-to-external-exiftool-via-stdin", "title": "How to pass []byte to external exiftool via stdin?", "body": "<p>I am trying to do in golang the  bash equivalent:</p>\n\n<pre><code>cat image.jpg | exiftool -author=some_auth - &gt; updated_image.jpg\n</code></pre>\n\n<p>The exiftool <strong>'-'</strong> option makes it read from stdin, but say I have the image stored in a variable like \n    <code>var img []bytes //in golang</code></p>\n\n<p>I want stdin to contain the bytes from img and the system call to exiftool to read these from stdin, save the result (stdout) in another []byte - I am new to golang, how what do i approach this ?</p>\n\n<p>I don't want to save to temp files on disk. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3995141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d70cf01b0ee5a6a0f7a8bf692215aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Ezra Umen", "link": "https://stackoverflow.com/users/3995141/ezra-umen"}, "edited": false, "score": 1, "creation_date": 1435550934, "post_id": 31107386, "comment_id": 50229811, "body": "I was under the impression that so long as I created a new Open on each function call, it wouldn&#39;t violate the libraries concurrency requirements, but I guess when the way Go multithreading works, it doesn&#39;t. Thanks for the info."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 3, "user_id": 3995141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d70cf01b0ee5a6a0f7a8bf692215aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Ezra Umen", "link": "https://stackoverflow.com/users/3995141/ezra-umen"}, "edited": false, "score": 0, "creation_date": 1435553295, "post_id": 31107386, "comment_id": 50230398, "body": "You&#39;re often better creating a single <code>*sql.DB</code> - be it global or explicitly passed to your handlers/functions from <code>main()</code> and re-using that instead of <code>Open(...); defer Close()</code> in each function. Less overhead."}, {"owner": {"reputation": 3, "user_id": 3995141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d70cf01b0ee5a6a0f7a8bf692215aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Ezra Umen", "link": "https://stackoverflow.com/users/3995141/ezra-umen"}, "edited": false, "score": 1, "creation_date": 1435553746, "post_id": 31107386, "comment_id": 50230514, "body": "Yea, that&#39;s what I&#39;m doing in the actual application I&#39;m writing at the moment. In this question, I was just playing around to see whether or not SQLite would hold up under concurrency. After repeating similar tests with the library you recommended, it looks like it does, and quite well too."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 2, "last_activity_date": 1435677904, "last_edit_date": 1592644375, "creation_date": 1435548998, "answer_id": 31107386, "question_id": 31107290, "link": "https://stackoverflow.com/questions/31107290/go-sqlite-concurrency-issue/31107386#31107386", "title": "Go SQlite Concurrency Issue", "body": "<p>The library you are using doesn't support concurrency as per <a href=\"https://code.google.com/p/go-sqlite/source/browse/go1/sqlite3/doc.go#29\" rel=\"nofollow noreferrer\">https://code.google.com/p/go-sqlite/source/browse/go1/sqlite3/doc.go#29</a> -</p>\n<blockquote>\n<p>Concurrency</p>\n<p>A single connection instance and all of its derived objects (prepared\nstatements, backup operations, etc.) may NOT be used concurrently from multiple\ngoroutines without external synchronization. The only exception is\nConn.Interrupt(), which may be called from another goroutine to abort a\nlong-running operation. It is safe to use separate connection instances\nconcurrently, even if they are accessing the same database file.</p>\n</blockquote>\n<p>As sqlite3 is a file-based database, the driver needs to manage concurrent access from multiple threads.</p>\n<p>The <a href=\"https://github.com/mattn/go-sqlite3\" rel=\"nofollow noreferrer\">https://github.com/mattn/go-sqlite3</a> library <a href=\"https://github.com/mattn/go-sqlite3/blob/master/sqlite3.go#L280\" rel=\"nofollow noreferrer\">should support thread-safe</a> operation provided your sqlite3 was compiled to do so.</p>\n"}], "owner": {"reputation": 3, "user_id": 3995141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d70cf01b0ee5a6a0f7a8bf692215aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Ezra Umen", "link": "https://stackoverflow.com/users/3995141/ezra-umen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2966, "favorite_count": 2, "accepted_answer_id": 31107386, "answer_count": 1, "score": 0, "last_activity_date": 1435677904, "creation_date": 1435548154, "question_id": 31107290, "link": "https://stackoverflow.com/questions/31107290/go-sqlite-concurrency-issue", "title": "Go SQlite Concurrency Issue", "body": "<p>I've been playing around with <a href=\"https://godoc.org/code.google.com/p/go-sqlite/go1/sqlite3\" rel=\"nofollow\">this</a> SQLite library for Go, and in doing some stress testing, have come across some odd errors. </p>\n\n<p>I'm attempting to run this code:</p>\n\n<pre><code>package main\n\nimport \"code.google.com/p/go-sqlite/go1/sqlite3\"\nimport \"fmt\"\nimport \"sync\"\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(100)\n    for i := 0; i &lt; 100; i++ {\n        query(&amp;wg, i)\n    }\n    wg.Wait()\n}\n\nfunc query(wg *sync.WaitGroup, id int) {\n    defer wg.Done()\n    c, _ := sqlite3.Open(\"sqlite.db\")\n    for i := 0; i &lt; 100; i++{\n        args := sqlite3.NamedArgs{\"$bval\": \"demo\"}\n        sql := \"SELECT rowid, * FROM x WHERE b = $bval\"\n        row := make(sqlite3.RowMap)\n        for s, err := c.Query(sql, args); err == nil; err = s.Next() {\n                var rowid int64\n                s.Scan(&amp;rowid, row)     // Assigns 1st column to rowid, the rest to row\n                fmt.Println(rowid, row) // Prints \"1 map[a:1 b:demo c:&lt;nil&gt;]\"\n        }\n    }\n    c.Close()\n    fmt.Println(\"Worker \", id, \" is done\")\n}\n</code></pre>\n\n<p>By default, there are no issues; But when I increase GOMAXPROCS to more than 1, the program crashes at arbitrary points, giving the error:</p>\n\n<pre><code>fatal error: unexpected signal during runtime execution\n[signal 0xb code=0x1 addr=0xc0000000d pc=0x4100b9]\n\nruntime stack:\nruntime.gothrow(0x5a1610, 0x2a)\n    /usr/lib/go/src/runtime/panic.go:503 +0x8e fp=0x7f4bd5ffa830 sp=0x7f4bd5ffa818\nruntime.sigpanic()\n    /usr/lib/go/src/runtime/sigpanic_unix.go:14 +0x5e fp=0x7f4bd5ffa880 sp=0x7f4bd5ffa830\n\ngoroutine 1 [syscall, locked to thread]:\nruntime.cgocall_errno(0x408043, 0xc20808fcf8, 0x0)\n    /usr/lib/go/src/runtime/cgocall.go:130 +0xf5 fp=0xc20808fcd8 sp=0xc20808fcb0\ncode.google.com/p/go-sqlite/go1/sqlite3._Cfunc_sqlite3_prepare_v2(0x7f4bc00023b8, 0xc2080483f0, 0xffffffff, 0xc20808fd30, 0xc20808fd28, 0x0)\n    /home/eumen/Programming/gocode/src/code.google.com/p/go-sqlite/go1/sqlite3/:534 +0x43 fp=0xc20808fcf8 sp=0xc20808fcd8\ncode.google.com/p/go-sqlite/go1/sqlite3.newStmt(0xc2080482d0, 0x599e90, 0x26, 0xc20804b8c8, 0x0, 0x0)\n    /home/eumen/Programming/gocode/src/code.google.com/p/go-sqlite/go1/sqlite3/sqlite3.go:583 +0xe4 fp=0xc20808fdb0 sp=0xc20808fcf8\ncode.google.com/p/go-sqlite/go1/sqlite3.(*Conn).Query(0xc2080482d0, 0x599e90, 0x26, 0xc20808fee0, 0x1, 0x1, 0xc20807a000, 0x0, 0x0)\n    /home/eumen/Programming/gocode/src/code.google.com/p/go-sqlite/go1/sqlite3/sqlite3.go:276 +0xc3 fp=0xc20808fe00 sp=0xc20808fdb0\nmain.query(0xc208022020, 0x16)\n    /home/eumen/Programming/Go/practice/sqlite-sync.go:26 +0x261 fp=0xc20808ff70 sp=0xc20808fe00\nmain.main()\n    /home/eumen/Programming/Go/practice/sqlite-sync.go:11 +0x66 fp=0xc20808ff98 sp=0xc20808ff70\nruntime.main()\n    /usr/lib/go/src/runtime/proc.go:63 +0xf3 fp=0xc20808ffe0 sp=0xc20808ff98\nruntime.goexit()\n    /usr/lib/go/src/runtime/asm_amd64.s:2232 +0x1 fp=0xc20808ffe8 sp=0xc20808ffe0\n\ngoroutine 2 [force gc (idle)]:\nruntime.gopark(0x496870, 0x831d30, 0x583f70, 0xf)\n    /usr/lib/go/src/runtime/proc.go:130 +0x105 fp=0xc20801e798 sp=0xc20801e768\nruntime.goparkunlock(0x831d30, 0x583f70, 0xf)\n    /usr/lib/go/src/runtime/proc.go:136 +0x48 fp=0xc20801e7c0 sp=0xc20801e798\nruntime.forcegchelper()\n    /usr/lib/go/src/runtime/proc.go:99 +0xce fp=0xc20801e7e0 sp=0xc20801e7c0\nruntime.goexit()\n    /usr/lib/go/src/runtime/asm_amd64.s:2232 +0x1 fp=0xc20801e7e8 sp=0xc20801e7e0\ncreated by runtime.init\u00b74\n    /usr/lib/go/src/runtime/proc.go:87 +0x25\n\ngoroutine 3 [GC sweep wait]:\nruntime.gopark(0x496870, 0x838ff8, 0x580b50, 0xd)\n    /usr/lib/go/src/runtime/proc.go:130 +0x105 fp=0xc208021f98 sp=0xc208021f68\nruntime.goparkunlock(0x838ff8, 0x580b50, 0xd)\n    /usr/lib/go/src/runtime/proc.go:136 +0x48 fp=0xc208021fc0 sp=0xc208021f98\nruntime.bgsweep()\n    /usr/lib/go/src/runtime/mgc0.go:98 +0xbc fp=0xc208021fe0 sp=0xc208021fc0\nruntime.goexit()\n    /usr/lib/go/src/runtime/asm_amd64.s:2232 +0x1 fp=0xc208021fe8 sp=0xc208021fe0\ncreated by gc\n    /usr/lib/go/src/runtime/mgc0.c:1386\n\ngoroutine 4 [finalizer wait]:\nruntime.gopark(0x496870, 0x838ff0, 0x583ad0, 0xe)\n    /usr/lib/go/src/runtime/proc.go:130 +0x105 fp=0xc20801d730 sp=0xc20801d700\nruntime.goparkunlock(0x838ff0, 0x583ad0, 0xe)\n    /usr/lib/go/src/runtime/proc.go:136 +0x48 fp=0xc20801d758 sp=0xc20801d730\nruntime.runfinq()\n    /usr/lib/go/src/runtime/malloc.go:727 +0xba fp=0xc20801d7e0 sp=0xc20801d758\nruntime.goexit()\n    /usr/lib/go/src/runtime/asm_amd64.s:2232 +0x1 fp=0xc20801d7e8 sp=0xc20801d7e0\ncreated by runtime.createfing\n    /usr/lib/go/src/runtime/malloc.go:707 +0x5e\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /usr/lib/go/src/runtime/asm_amd64.s:2232 +0x1 fp=0xc208032fe8 sp=0xc208032fe0\nsignal: aborted (core dumped)\n</code></pre>\n\n<p>This error only occurs when I increase GOMAXPROCS, and also occurs if I use <code>go query(&amp;wg, i)</code>. Oddly enough, the errors also do not occur if the loop isn't used, or if i is set to a small enough number. Would someone be able to shed some light about what is going on here?</p>\n"}, {"tags": ["angularjs", "rest", "google-app-engine", "go"], "comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1435551868, "post_id": 31107212, "comment_id": 50230036, "body": "what is the content of body?"}, {"owner": {"reputation": 704, "user_id": 3536948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50341f59bb4c3c845eb159056357aaf0?s=128&d=identicon&r=PG&f=1", "display_name": "poopoothegorilla", "link": "https://stackoverflow.com/users/3536948/poopoothegorilla"}, "edited": false, "score": 2, "creation_date": 1435552380, "post_id": 31107212, "comment_id": 50230165, "body": "Could you show your form? I am guessing that &quot;json:&quot;Key&quot;&quot; might not be named correctly, but unsure since I do not know what your form looks like. Go handles nils as 0 for ints... so I suspect it is not finding it in the json."}, {"owner": {"reputation": 6963, "user_id": 151316, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/549acdbbe6ac79e0684543945d83fcfb?s=128&d=identicon&r=PG", "display_name": "RiddlerDev", "link": "https://stackoverflow.com/users/151316/riddlerdev"}, "edited": false, "score": 0, "creation_date": 1435582733, "post_id": 31107212, "comment_id": 50245943, "body": "done. I added that I have also put a debugger before the http Post and verified that the article.Key was the right value."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435585446, "post_id": 31107212, "comment_id": 50247801, "body": "<code>%g</code> is for exponents. Print the body and text as a strings."}, {"owner": {"reputation": 6963, "user_id": 151316, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/549acdbbe6ac79e0684543945d83fcfb?s=128&d=identicon&r=PG", "display_name": "RiddlerDev", "link": "https://stackoverflow.com/users/151316/riddlerdev"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435586573, "post_id": 31107212, "comment_id": 50248586, "body": "Sorry @JimB ... not enough coffee for a Monday morning. Fixed."}], "answers": [{"comments": [{"owner": {"reputation": 6963, "user_id": 151316, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/549acdbbe6ac79e0684543945d83fcfb?s=128&d=identicon&r=PG", "display_name": "RiddlerDev", "link": "https://stackoverflow.com/users/151316/riddlerdev"}, "edited": false, "score": 0, "creation_date": 1435596842, "post_id": 31119092, "comment_id": 50255326, "body": "I rechecked my log, and do not see that error. Not sure why... that would have helped a lot. Updated as suggested and everything works. Thank you!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1435590191, "creation_date": 1435590191, "answer_id": 31119092, "question_id": 31107212, "link": "https://stackoverflow.com/questions/31107212/id-is-returning-0-for-rest-api-with-go/31119092#31119092", "title": "Id is Returning 0 for Rest API with Go", "body": "<p>You're ignoring the error when you Unmarshal into your Article. You should see <code>json: cannot unmarshal string into Go value of type int64</code>, because the <code>Key</code> value in the body is being formatted as a string.</p>\n\n<p>If it is what you expect, then you can tell the json package to make use of it by adding the <code>string</code> option to the tag:</p>\n\n<pre><code>type Article struct {\n    Key    int64    `json:\"Key,string\" datastore:\"-\"`\n    Title  string\n    Text   string   `datastore:\",noindex\"`\n    Author string\n    Tags   string\n    Posted time.Time\n}\n</code></pre>\n"}], "owner": {"reputation": 6963, "user_id": 151316, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/549acdbbe6ac79e0684543945d83fcfb?s=128&d=identicon&r=PG", "display_name": "RiddlerDev", "link": "https://stackoverflow.com/users/151316/riddlerdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 31119092, "answer_count": 1, "score": 0, "last_activity_date": 1435590191, "creation_date": 1435547616, "last_edit_date": 1435586539, "question_id": 31107212, "link": "https://stackoverflow.com/questions/31107212/id-is-returning-0-for-rest-api-with-go", "title": "Id is Returning 0 for Rest API with Go", "body": "<p>I have been trying to build some simple backend REST API using Go using the Google App Engine and its datastore and AngularJS on the frontend. I was able to get everything working but the edit. And I am not sure why the JSON is not un-marshaling correctly.</p>\n\n<p>Struct:</p>\n\n<pre><code>type Article struct {\n    Key    int64    `json:\"Key\" datastore:\"-\"`\n    Title  string\n    Text   string   `datastore:\",noindex\"`\n    Author string\n    Tags   string\n    Posted time.Time\n}\n</code></pre>\n\n<p>When I load the article, I populate the Key property with the id value from the datastore. Example: 5593215650496512</p>\n\n<p>I keep that field in a hidden input on my form, and submit the form's content as JSON through an HTTP Post to the Go backend.</p>\n\n<p>Before the submit, I can see that the Key holds the proper value. Here is the form though:</p>\n\n<pre><code>                &lt;form name=\"articleForm\" ng-submit=\"saveArticle(article)\"&gt;\n                    &lt;fieldset&gt;\n                        &lt;input type=\"hidden\" name=\"key\" ng-value=\"article.Key\" /&gt;\n                        &lt;div class=\"form-group\"&gt;\n                            &lt;input class=\"form-control\" ng-model=\"article.Title\" placeholder=\"Title\" name=\"title\" type=\"text\" required autofocus /&gt;\n                            &lt;div class=\"alert alert-danger\" ng-show=\"articleForm.Title.$invalid &amp;&amp; articleForm.Title.$dirty\"&gt;\n                                &lt;ul&gt;\n                                    &lt;li ng-show=\"articleForm.title.$error.required\"&gt;this field is required&lt;/li&gt;\n                                &lt;/ul&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n                        &lt;div class=\"form-group\"&gt;\n                            &lt;wysiwyg \n                                name=\"text\"\n                                textarea-id=\"articleText\" \n                                textarea-class=\"form-control\"  \n                                textarea-height=\"180px\" \n                                textarea-name=\"articleText\"\n                                ng-model=\"article.Text\" \n                                enable-bootstrap-title=\"true\" \n                                textarea-required&gt;\n                            &lt;/wysiwyg&gt;\n                            &lt;div class=\"alert alert-danger\" ng-show=\"articleForm.text.$invalid &amp;&amp; articleForm.text.$dirty\"&gt;\n                                &lt;ul&gt;\n                                    &lt;li ng-show=\"articleForm.text.$error.required\"&gt;this field is required&lt;/li&gt;\n                                &lt;/ul&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n                        &lt;div class=\"form-group\"&gt;\n                            &lt;tags-input ng-model=\"tags\"&gt;&lt;/tags-input&gt;\n                        &lt;/div&gt;\n                        &lt;button type=\"submit\" ng-disabled=\"!articleForm.$valid\" class=\"btn btn-primary\"&gt;\n                            Save Article\n                        &lt;/button&gt;\n                    &lt;/fieldset&gt;\n                &lt;/form&gt;\n</code></pre>\n\n<p>The $scope.article object right before the http post:</p>\n\n<blockquote>\n  <p>Author: \"Matt Ridley\"\n  Key: \"5593215650496512\"\n  Posted: \"2015-06-29T12:57:20.833525Z\"\n  Tags: \"test,so-cool\"\n  Text: \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. Mauris massa. Vestibulum lacinia arcu eget nulla.&nbsp;\"\n  Title: \"Example Article 8\"</p>\n</blockquote>\n\n<p>However, the Key property remains 0. I am able to pass that value in as a single id value with no issue for delete and load.</p>\n\n<p>Code for loading just the id (this was the load version, it works):</p>\n\n<pre><code>var id int64\njson.Unmarshal(body, &amp;id)\nc.Infof(\"ID: %v\", id)\n\nkey := datastore.NewKey(c, \"Article\", \"\", id, nil)\n</code></pre>\n\n<p>Code for the edit with additional values (does not work, id = 0):</p>\n\n<pre><code>var article Article\njson.Unmarshal(body, &amp;article)\nc.Infof(\"Article:%g\", article)\nc.Infof(\"Body:\" + string(body))\nc.Infof(\"Key:%v\", article.Key)\narticle.Posted = time.Now()\n</code></pre>\n\n<p>Here is a dump of the struct after json.Unmarshal:</p>\n\n<blockquote>\n  <p>2015/06/29 03:04:08 INFO: Article:{%!g(int64=0) %!g(string=Example Article 8)\n  %!g(string=Lorem ipsum dolor sit amet, consectetur adipiscing\n  elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam.\n  Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis\n  ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta.\n  Mauris massa. Vestibulum lacinia arcu eget\n  nulla.&nbsp;) %!g(string=Matt Ridley)\n  %!g(string=test,so-cool) {%!g(int64=63570890170) %!g(int32=842211000)\n  %!g(*time.Location=&amp;{UTC [] [] 0 0 })}}</p>\n</blockquote>\n\n<p>Key is logging as... </p>\n\n<blockquote>\n  <p>2015/06/29 03:04:08 INFO: Key:0</p>\n</blockquote>\n\n<p>The body dump:</p>\n\n<blockquote>\n  <p>2015/06/29 14:00:34 INFO: Body:{\"Key\":\"5593215650496512\",\"Title\":\"Example Article 8\",\"Text\":\"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. Mauris massa. Vestibulum lacinia arcu eget nulla.&nbsp;\",\"Author\":\"Matt Ridley\",\"Tags\":\"test,so-cool\",\"Posted\":\"2015-06-29T13:28:06.168062Z\"}</p>\n</blockquote>\n\n<p>I have been banging my head on this for a few days, so any insight would be appreciated. Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1435560112, "post_id": 31106153, "comment_id": 50232634, "body": "See the language specification the Slice blog entry and the Go Tour to understand the difference between slices and arrays."}], "answers": [{"comments": [{"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1435538904, "post_id": 31106286, "comment_id": 50227527, "body": "I think you need to use <code>make</code>, not <code>new</code>."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 0, "creation_date": 1435540739, "post_id": 31106286, "comment_id": 50227853, "body": "Thanks.  I&#39;ve made the fix."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 3, "last_activity_date": 1435540702, "last_edit_date": 1435540702, "creation_date": 1435538383, "answer_id": 31106286, "question_id": 31106153, "link": "https://stackoverflow.com/questions/31106153/set-array-value-into-structure-in-golang/31106286#31106286", "title": "Set array value into structure in golang", "body": "<p>As the error message says, the <code>Topics</code> field has type <code>[]string</code> (an arbitrary length slice of strings), and the <code>topics</code> variable has type <code>[2]string</code> (an string array of length 2).  These are not the same type, so you get the error.</p>\n\n<p>There are two ways you could go about solving this:</p>\n\n<ol>\n<li><p>make <code>topics</code> a slice:</p>\n\n<pre><code>topics = make([]string, 2)\ntopics[0] = \"Sport Nice\"\n...\n</code></pre></li>\n<li><p>Use a <a href=\"http://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow\">slice expression</a> to create a slice representing your array:</p>\n\n<pre><code>...\nreturn &amp;TopicModels{Topics: topics[:]}, nil\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 2, "creation_date": 1435553124, "post_id": 31107913, "comment_id": 50230350, "body": "Neither of those will work, because <code>TopicModels.Topics</code> expects a slice rather than an array."}, {"owner": {"reputation": 704, "user_id": 3536948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50341f59bb4c3c845eb159056357aaf0?s=128&d=identicon&r=PG&f=1", "display_name": "poopoothegorilla", "link": "https://stackoverflow.com/users/3536948/poopoothegorilla"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1435553163, "post_id": 31107913, "comment_id": 50230362, "body": "Yeh i forgot to mention to change the struct... Thanks @JamesHenstridge"}], "tags": [], "owner": {"reputation": 704, "user_id": 3536948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50341f59bb4c3c845eb159056357aaf0?s=128&d=identicon&r=PG&f=1", "display_name": "poopoothegorilla", "link": "https://stackoverflow.com/users/3536948/poopoothegorilla"}, "is_accepted": false, "score": 1, "last_activity_date": 1435553335, "last_edit_date": 1435553335, "creation_date": 1435552986, "answer_id": 31107913, "question_id": 31106153, "link": "https://stackoverflow.com/questions/31106153/set-array-value-into-structure-in-golang/31107913#31107913", "title": "Set array value into structure in golang", "body": "<p>You can also use an <code>array literal</code> by doing this...</p>\n\n<pre><code>topics := [2]string{\"Sport Nice\",\"Nice Sport\"}\nreturn &amp;TopicModels{Topics: topics}, nil\n</code></pre>\n\n<p>Here is a nice blog entry about array's and slices... <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">http://blog.golang.org/go-slices-usage-and-internals</a></p>\n\n<p>EDIT </p>\n\n<p>forgot to mention you need to change the struct</p>\n\n<pre><code>type TopicModels struct {\n    Topics [2]string\n}\n</code></pre>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3918, "favorite_count": 0, "accepted_answer_id": 31106286, "answer_count": 2, "score": -1, "last_activity_date": 1435553335, "creation_date": 1435537197, "question_id": 31106153, "link": "https://stackoverflow.com/questions/31106153/set-array-value-into-structure-in-golang", "title": "Set array value into structure in golang", "body": "<p>The structure is</p>\n\n<pre><code>type TopicModels struct {\n    Topics []string\n}\n</code></pre>\n\n<p>And I want to set the value into this structure like following approach</p>\n\n<pre><code>var topics [2]string\ntopics[0] = \"Sport Nice\"\ntopics[1] = \"Nice Sport\"\nreturn &amp;TopicModels{Topics: topics}, nil\n</code></pre>\n\n<p>However, it tells me that</p>\n\n<pre><code> cannot use topics (type [2]string) as type []string in field value\n</code></pre>\n\n<p>How can I change the code to make it correct?</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435527888, "post_id": 31104837, "comment_id": 50225266, "body": "I don&#39;t see anything wrong with the code above. Can you show the templates?  Here&#39;s a simlar  <a href=\"http://play.golang.org/p/BXOk_lpEr5\" rel=\"nofollow noreferrer\">example</a> that works as expected."}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435528093, "post_id": 31104837, "comment_id": 50225319, "body": "@ThunderCat The template is very simple. All other things is correct, just have null value for the {{.Topics}}.  In addition, when I put a value for page.Topics in viewHandler(), it looks like does not work at all.( page.Topics = &quot;test2&quot;)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435528464, "post_id": 31104837, "comment_id": 50225423, "body": "<code>fmt.Printf(&quot;%v\\n&quot;, page)</code> before executing the template to see if page is what you expect.  There&#39;s not enough information in the question to debug the issue.  I tried to replicate the application in the example linked above. It works."}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435529302, "post_id": 31104837, "comment_id": 50225663, "body": "@ThunderCat I get the correct answer when I print before executing the template. I think I need to re-edit the question, because there might something wrong with the template."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1435529891, "post_id": 31104837, "comment_id": 50225788, "body": "I copied more of your code to <a href=\"http://play.golang.org/p/t-yHWCn6gq\" rel=\"nofollow noreferrer\">my example</a>. Still no issue."}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435532455, "post_id": 31104837, "comment_id": 50226345, "body": "@ThunderCat I find something that really strange. When I comment on &quot;http.HandleFunc(&quot;/index&quot;, viewHandler)&quot; and &quot;http.ListenAndServe(&quot;:8090&quot;, nil)&quot;, the &quot;<a href=\"http://localhost:8090/index\" rel=\"nofollow noreferrer\">localhost:8090/index</a>&quot; still works. And when I change the html file, the changes also show on the browser!!! I think the solution may be related to this strange problem!!!"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1435532812, "post_id": 31104837, "comment_id": 50226441, "body": "Sounds to me like you&#39;re not actually building your source if it still works when you comment the whole thing out. Either that or you have a built copy sitting in your GOPATH somewhere. However the HTML changes because its a static file that the old code is serving. Perhaps look in your GOPATH/pkg directory for a <code>.a</code> file with your package name and delete it. Then try building again and see if that fixes it."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1435533052, "post_id": 31104837, "comment_id": 50226489, "body": "How are you running your Go programs? <code>go run file.go</code> on the command line? <code>go build &amp;&amp; .&#47;nameofyourbinary</code> on the command line? Or are you using <code>go install</code> and then running the <code>binaryname</code> from your $PATH?"}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1435533486, "post_id": 31104837, "comment_id": 50226586, "body": "@SimonWhitehead Thanks. When I kill the progress of go and restart it again, I found the value is set in browser. But when I changed the code and <code>go run main.go</code>, the value in the browser is not changed. The only way to make it is killing the progress and do <code>go run main.go</code>."}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435533526, "post_id": 31104837, "comment_id": 50226599, "body": "@elithrar I use go <code>run main.go</code>"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1435533801, "post_id": 31104837, "comment_id": 50226650, "body": "@Wyatt Correct - <code>go run</code> is just a shortcut for <code>go build &amp;&amp; .&#47;something.out</code>. It doesn&#39;t watch your file for changes; you must kill it and run it again if you make changes to your Go code."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1435533893, "post_id": 31104837, "comment_id": 50226666, "body": "Handle the error return from ListenAndServe.  You must stop, rebuild and rerun the program to see the results of changing the code."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435533969, "post_id": 31104837, "comment_id": 50226689, "body": "Separate from these issues, you should <code>go build &amp;&amp; .&#47;appname</code> instead of <code>go run main.go</code>.  The former builds the package in the directory and runs the result.  The latter builds and runs a pseudo-package consisting of the .go files listed on the command line."}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435534309, "post_id": 31104837, "comment_id": 50226756, "body": "@ThunderCat Thanks. But why I have to kill the progress and run the app, then the html page can be changed?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435534431, "post_id": 31104837, "comment_id": 50226790, "body": "As written, you can change the template without rebuilding or restarting the app.  Depending on the load, you may want to parse the template once when the application starts.  If you do parse the template at app startup, then you will need to stop-start the app."}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 458, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435529445, "creation_date": 1435526151, "last_edit_date": 1435529445, "question_id": 31104837, "link": "https://stackoverflow.com/questions/31104837/empty-value-when-serve-the-template", "title": "Empty value when serve the template", "body": "<p>The data structure is defined as:</p>\n\n<pre><code>type TopicModels struct {\n    Topics string\n}\n</code></pre>\n\n<p>and the viewHandler is:</p>\n\n<pre><code>func viewHandler(w http.ResponseWriter, r *http.Request) {\n    page, _ := loadTopicModels(\"topics\")\n\n    templates := template.Must(template.ParseGlob(\"./templates/*\"))\n    err := templates.ExecuteTemplate(w, \"indexPage\", page)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n}\n</code></pre>\n\n<p>For the page variable, the returned value is:</p>\n\n<pre><code>return &amp;TopicModels{Topics: \"test\"}, nil\n</code></pre>\n\n<p>Then, in html, I use {{.Topics}} to show the value inside.\nHowever, I do not get any value, which means null.</p>\n\n<p>The template is:</p>\n\n<pre><code>{{define \"indexPage\"}}\n&lt;html&gt;\n{{template \"header\"}}\n&lt;body onload=\"initialize()\"&gt;\n    &lt;nav class=\"navbar navbar-default\"&gt;\n        &lt;div class=\"container-fluid\"&gt;\n            &lt;div class=\"navbar-header\"&gt;\n                &lt;a class=\"navbar-brand\" href=\"#\"&gt;Welcome to TDT Project&lt;/a&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/nav&gt;\n\n    &lt;div class=\"block-center\"&gt;\n        &lt;div&gt;\n            &lt;div class=\"btn-group-vertical float-left\"&gt;\n                &lt;a href=\"#\" class=\"btn btn-default\"&gt;{{.Topics}}&lt;/a&gt;\n\n                &lt;p&gt;Date: &lt;input type=\"text\" id=\"datepicker\"&gt;&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;div id=\"googleMap\"&gt;&lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"bot-block\"&gt;\n            Global Semantic Graph\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>Where {{header}} is another html file, which contains</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/css/bootstrap.css\"&gt;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&lt;script src=\"http://code.jquery.com/jquery-1.10.2.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Is there anything that I need to notice when I use ExecuteTemplate()?\nHow can I fix this problem?</p>\n"}, {"tags": ["xml", "go", "encode", "unmarshalling"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1435583839, "post_id": 31104777, "comment_id": 50246708, "body": "I&#39;d say you might try looking at XSLT. May be <a href=\"http://godoc.org/?q=xslt\" rel=\"nofollow noreferrer\">this</a>? Unfortunately, this introduces a dependency on <code>libxml2</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5380, "user_id": 146620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba0c9119010302832e1d129b38228b?s=128&d=identicon&r=PG", "display_name": "Graham King", "link": "https://stackoverflow.com/users/146620/graham-king"}, "is_accepted": false, "score": 3, "last_activity_date": 1438296093, "creation_date": 1438296093, "answer_id": 31735274, "question_id": 31104777, "link": "https://stackoverflow.com/questions/31104777/golang-xml-processing/31735274#31735274", "title": "Golang XML processing", "body": "<p>Is it a constraint that you only use the standard library?</p>\n\n<p>If not, I'd recommend etree (<a href=\"https://github.com/beevik/etree\" rel=\"nofollow\">https://github.com/beevik/etree</a>) which puts a DOM on top of the standard library's XML processing. It has a basic xpath syntax to select nodes, and you can easily edit them once you have them.</p>\n"}], "owner": {"reputation": 21, "user_id": 5059021, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153439375919264/picture?type=large", "display_name": "Paul Poloskov", "link": "https://stackoverflow.com/users/5059021/paul-poloskov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1963, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1438296093, "creation_date": 1435525697, "last_edit_date": 1435526182, "question_id": 31104777, "link": "https://stackoverflow.com/questions/31104777/golang-xml-processing", "title": "Golang XML processing", "body": "<p>I am trying to process XML files with complicated structure in Go using the standart encoding/xml package, change values of couple of nodes and save the alternated file. For example:</p>\n\n<pre><code>&lt;description&gt;\n    &lt;title-info&gt;\n        &lt;genre&gt;Comedy&lt;/genre&gt;\n        &lt;author&gt;\n            &lt;first-name&gt;Kevin&lt;/first-name&gt;\n            &lt;last-name&gt;Smith&lt;/last-name&gt;\n        &lt;/author&gt;\n        &lt;movie-title&gt;Clerks&lt;/movie-title&gt;\n        &lt;annotation&gt;\n            &lt;p&gt;!!!&lt;/p&gt;\n        &lt;/annotation&gt;\n        &lt;keywords&gt;comedy,jay,bob&lt;/keywords&gt;\n        &lt;date&gt;&lt;/date&gt;\n    &lt;/description&gt;\n&lt;/title-info&gt;\n</code></pre>\n\n<p>And many more fields. I would like to change the node:</p>\n\n<pre><code>&lt;author&gt;\n    &lt;first-name&gt;Kevin&lt;/first-name&gt;\n    &lt;last-name&gt;Smith&lt;/last-name&gt;\n&lt;/author&gt;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>&lt;author&gt;\n    &lt;first-name&gt;K.&lt;/first-name&gt;\n    &lt;middle-name&gt;Patrick&lt;/middle-name&gt;\n    &lt;last-name&gt;Smith&lt;/last-name&gt;\n&lt;/author&gt;\n</code></pre>\n\n<p>However, since files are massive and uses more then 50 tags I really don't want to describe the complete structure to unmarshal them, so I have</p>\n\n<pre><code>type Result struct {\n    Title   string   `xml:\"description&gt;title-info&gt;movie-title\"`\n    Authors []Author `xml:\"description&gt;title-info&gt;author\"`\n}\n\ntype Author struct {\n    Fname string `xml:\"first-name\"`\n    Mname string `xml:\"middle-name\"`\n    Lname string `xml:\"last-name\"`\n}\n</code></pre>\n\n<p>for fields I need to work with, but don't know how to keep rest of the file untouched. Looks like I need to use xml.decode to select the nodes I need to change (like at <a href=\"http://blog.davidsingleton.org/parsing-huge-xml-files-with-go/\" rel=\"nofollow\">http://blog.davidsingleton.org/parsing-huge-xml-files-with-go/</a> post) while skipping unneeded tokens to xml.encode, but I can't convert this puzzle to some code. </p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 9827, "user_id": 675006, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PDlvs.png?s=128&g=1", "display_name": "voscausa", "link": "https://stackoverflow.com/users/675006/voscausa"}, "edited": false, "score": 0, "creation_date": 1435528022, "post_id": 31102871, "comment_id": 50225301, "body": "<a href=\"https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/getstarted\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/googlecloudstorageclient/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 269, "user_id": 2147271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eZtqJ.jpg?s=128&g=1", "display_name": "tmoore", "link": "https://stackoverflow.com/users/2147271/tmoore"}, "reply_to_user": {"reputation": 9827, "user_id": 675006, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PDlvs.png?s=128&g=1", "display_name": "voscausa", "link": "https://stackoverflow.com/users/675006/voscausa"}, "edited": false, "score": 0, "creation_date": 1435594667, "post_id": 31102871, "comment_id": 50254085, "body": "I already had that link in my post.  Do you know if cloud storage can be simulated locally or not?"}, {"owner": {"reputation": 9827, "user_id": 675006, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PDlvs.png?s=128&g=1", "display_name": "voscausa", "link": "https://stackoverflow.com/users/675006/voscausa"}, "edited": false, "score": 0, "creation_date": 1435598998, "post_id": 31102871, "comment_id": 50256452, "body": "I use the Python SDK cloudstorage client. It uses the blobstore for storing GCS buckets locally."}, {"owner": {"reputation": 269, "user_id": 2147271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eZtqJ.jpg?s=128&g=1", "display_name": "tmoore", "link": "https://stackoverflow.com/users/2147271/tmoore"}, "reply_to_user": {"reputation": 9827, "user_id": 675006, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PDlvs.png?s=128&g=1", "display_name": "voscausa", "link": "https://stackoverflow.com/users/675006/voscausa"}, "edited": false, "score": 0, "creation_date": 1435754677, "post_id": 31102871, "comment_id": 50331838, "body": "So the Go version does not support this?"}], "answers": [{"comments": [{"owner": {"reputation": 2178, "user_id": 2878004, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f808bd3121d4fe714d476f8cad18f9d5?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2878004/aaron"}, "edited": false, "score": 0, "creation_date": 1517722239, "post_id": 31688970, "comment_id": 84206614, "body": "Maybe they changed that tutorial since you posted the link. I can&#39;t find anything on there about how to get the local one to use the production bucket"}], "tags": [], "owner": {"reputation": 279, "user_id": 2700937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oK9nr.jpg?s=128&g=1", "display_name": "Glenn Lewis", "link": "https://stackoverflow.com/users/2700937/glenn-lewis"}, "is_accepted": true, "score": 1, "last_activity_date": 1438127120, "creation_date": 1438127120, "answer_id": 31688970, "question_id": 31102871, "link": "https://stackoverflow.com/questions/31102871/how-do-you-run-the-google-app-engine-dev-server-with-client-for-google-cloud-sto/31688970#31688970", "title": "How do you run the Google App Engine Dev Server with Client for Google Cloud Storage where everything is simulated locally?", "body": "<p>The Go dev_appserver does not currently support local Google Cloud Storage emulation. What is recommended is that you create a real GCS bucket for testing purposes and then you can start your dev_appserver to talk to the \"test\" GCS bucket.</p>\n\n<p>This tutorial: <a href=\"https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/getstarted\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/getstarted</a>\ngives detailed instructions on how you can set up your local app to use a real GCS bucket. (Make sure you carefully follow the linked instructions to enable the two Cloud Storage APIs and set up and download your private key.)</p>\n\n<p>Also, just FYI, the <a href=\"https://groups.google.com/forum/#!forum/google-appengine-go\" rel=\"nofollow\">google-appengine-go Google Group</a> is a great place to ask questions like this and also search through the posts to find answers.  There are a lot of really helpful people on that list to help you get up and running quickly.</p>\n"}], "owner": {"reputation": 269, "user_id": 2147271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eZtqJ.jpg?s=128&g=1", "display_name": "tmoore", "link": "https://stackoverflow.com/users/2147271/tmoore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1612, "favorite_count": 2, "accepted_answer_id": 31688970, "answer_count": 1, "score": 3, "last_activity_date": 1438127120, "creation_date": 1435513819, "question_id": 31102871, "link": "https://stackoverflow.com/questions/31102871/how-do-you-run-the-google-app-engine-dev-server-with-client-for-google-cloud-sto", "title": "How do you run the Google App Engine Dev Server with Client for Google Cloud Storage where everything is simulated locally?", "body": "<p>I'm running Google App Engine dev_appserver (golang) and have it working with the production Google Cloud Storage (GCS) such that it can read and write files via HTTPS to an actual GCS bucket.  But how do I get the local dev_appserver to simulate GCS locally?  I keep seeing people mention it's possible but can't find any documentation on how to set it up so that you can use the same cloud storage client library for development where all cloud files are stored locally.</p>\n\n<p>Even Google's documentation seems to imply it is possible with the devserver in that you can change the storage path for \"Google Cloud Storage Files\": <a href=\"https://cloud.google.com/appengine/docs/go/tools/devserver\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/tools/devserver</a></p>\n\n<p>So if I can specify where to save Google Cloud Storage files then how do I setup the Client for Google Cloud Storage (<a href=\"https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/</a>) to work locally? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2756, "user_id": 1246356, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7d476d83649961e573ff2000383d8f9?s=128&d=identicon&r=PG", "display_name": "nairware", "link": "https://stackoverflow.com/users/1246356/nairware"}, "edited": false, "score": 0, "creation_date": 1435518014, "post_id": 31102783, "comment_id": 50222221, "body": "Regarding your evaluation of my original code and my intentions: yes, you are spot on, so thank you for that.  Regarding the code you posted, I got some weird results.  Once I imported <code>path</code>, (required for <code>path.Join</code>), I was able to compile and run successfully.  Unfortunately, the only improvement I got was in being able to view images.  The css is still broken.  Also, interestingly, I can navigate to <code>&#47;image.png</code> and <code>&#47;style.css</code> and view those resources.  However, neither are rendered properly in a browser.  In the case of <code>&#47;image.png</code>, I just see encrypted characters/text."}, {"owner": {"reputation": 2756, "user_id": 1246356, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7d476d83649961e573ff2000383d8f9?s=128&d=identicon&r=PG", "display_name": "nairware", "link": "https://stackoverflow.com/users/1246356/nairware"}, "edited": false, "score": 1, "creation_date": 1435518330, "post_id": 31102783, "comment_id": 50222359, "body": "In addition to your changes, removing <code>w.Header().Add(&quot;Content Type&quot;, &quot;text&#47;html&quot;)</code> fixed the rendering problem for the image and css files."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 0, "last_activity_date": 1435513373, "creation_date": 1435513373, "answer_id": 31102783, "question_id": 31101814, "link": "https://stackoverflow.com/questions/31101814/http-handlefunc-with-static-files/31102783#31102783", "title": "http.HandleFunc with Static Files", "body": "<p>You've hard-coded your server to always return <code>index.html</code> for any GET request, no matter what is being requested. So if your <code>index.html</code> includes a reference to <code>style.css</code>, the browser is going to make a second request for <code>style.css</code> and you'll return <code>index.html</code> again.</p>\n\n<p>I assume what you're trying to do is have all <code>GET</code> requests return static files, while other verbs will do something else. You just need to pass those along to the file server:</p>\n\n<pre><code>root := \"static\"\n...\ncase \"GET\":\n    if r.URL.Path == \"\" || r.URL.Path == \"/\" {\n        http.ServeFile(w, r, path.Join(root, \"index.html\"))\n    } else {\n        http.ServeFile(w, r, path.Join(root, r.URL.Path))\n    }\n</code></pre>\n\n<p>Note that by the time your handler is called, all \"..\" references in the URL have been removed, attackers can't use this to escape your static tree. But <code>ServeFile()</code> will return directory listings, so you'll need to check for that if that's a problem.</p>\n"}], "owner": {"reputation": 2756, "user_id": 1246356, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7d476d83649961e573ff2000383d8f9?s=128&d=identicon&r=PG", "display_name": "nairware", "link": "https://stackoverflow.com/users/1246356/nairware"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2070, "favorite_count": 1, "accepted_answer_id": 31102783, "answer_count": 1, "score": 0, "last_activity_date": 1435513373, "creation_date": 1435507259, "question_id": 31101814, "link": "https://stackoverflow.com/questions/31101814/http-handlefunc-with-static-files", "title": "http.HandleFunc with Static Files", "body": "<p>I am building a webpage.  The page should be able to handle the different <code>http</code> methods (<code>GET</code>, <code>POST</code>...).  My page technically works and handles each type of request, but in the case of <code>GET</code> requests (serving <code>index.html</code> at the root <code>\"/\"</code> path), my page is not displaying properly.  None of the images or css are displaying correctly, presumably because those files cannot be found.</p>\n\n<p><img src=\"https://i.stack.imgur.com/95T4g.png\" alt=\"Ugly page\"></p>\n\n<p>I have noticed that <code>http.Handle</code> provides better results than <code>http.HandleFunc</code> when substituted into my <code>server.go</code> code below, in that the images and css do display correctly using:</p>\n\n<pre><code>http.FileServer(http.Dir(\"static\"))\nhttp.Handle(\"/\", http.StripPrefix(\"/\", fs))\n</code></pre>\n\n<p>The following is my web server with images and css not being displayed correctly.  In general, my intent is to use static files for everything, including html (ex. <code>index.html</code>) and to implement some solution using nothing but standard go.</p>\n\n<p><strong>server.go code</strong></p>\n\n<pre><code>package main\n\nimport (\n  \"net/http\"\n  \"fmt\"\n)\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n  w.Header().Add(\"Content Type\", \"text/html\")\n  switch r.Method {\n    case \"GET\":\n      http.ServeFile(w, r, \"./static/index.html\")\n    case \"POST\":\n      fmt.Pprintf(w, \"POST!\")\n    case \"PUT\":\n      fmt.Pprintf(w, \"PUT!\")\n    case \"DELETE\":\n      fmt.Pprintf(w, \"DELETE!\")\n    default:\n      fmt.Pprintf(w, \"Default!\")\n  }\n}\n\nfunc main() {\n  http.HandleFunc(\"/\", indexHandler)\n  http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n"}, {"tags": ["web", "go", "browser-cache"], "comments": [{"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 1, "creation_date": 1435496293, "post_id": 31100051, "comment_id": 50215403, "body": "How do you serve your html? Static files or templates?"}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1435498629, "post_id": 31100051, "comment_id": 50216111, "body": "@inf I use templates"}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1435499342, "post_id": 31100051, "comment_id": 50216325, "body": "@inf I do not think this is related to the ways that serve the html. Because even I change the content of html, the view in browser doesn&#39;t change.(e.g. &lt;h1&gt;test1&lt;h1&gt;  to &lt;h1&gt;test2&lt;h1&gt;, in the browser is &quot;test1&quot;)"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435499846, "post_id": 31100051, "comment_id": 50216466, "body": "Without any code it&#39;s hard to provide a definite answer, but it&#39;s extremely likely that you parse your templates only once on startup. This is good\u2014parsing on every request is really slow\u2014but explains why you don&#39;t see the updated template until an app restart. <a href=\"https://github.com/unrolled/render\" rel=\"nofollow noreferrer\">github.com/unrolled/render</a> can help this with a flag to reload templates during development only."}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435500299, "post_id": 31100051, "comment_id": 50216582, "body": "@elithrar I have made it clear :)"}], "answers": [{"tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 0, "last_activity_date": 1435502690, "creation_date": 1435502690, "answer_id": 31101070, "question_id": 31100051, "link": "https://stackoverflow.com/questions/31100051/why-views-are-same-when-i-run-main-go-again/31101070#31101070", "title": "Why views are same when I run main.go again", "body": "<p>You are rendering your templates only once as <code>templates</code> is a global variable. </p>\n\n<p>To re-render your templates each time you can move the rendering to your function. This however is bad for performance as rendering is quite expensive but it's ok during development. As an alternative you can for example use what @elithrar proposed. A further alternative would be to use <a href=\"https://github.com/codegangsta/gin\" rel=\"nofollow\">gin</a> and modify it to also scan for html files and not only go files.</p>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 31101070, "answer_count": 1, "score": -3, "last_activity_date": 1435502690, "creation_date": 1435496219, "last_edit_date": 1435500268, "question_id": 31100051, "link": "https://stackoverflow.com/questions/31100051/why-views-are-same-when-i-run-main-go-again", "title": "Why views are same when I run main.go again", "body": "<p>main.go</p>\n\n<pre><code>package main\nimport (\n    \"html/template\"\n    \"net/http\"\n)\nvar templates = template.Must(template.ParseGlob(\"./templates/*\"))\n\n    func viewHandler(w http.ResponseWriter, r *http.Request) {\n    err := templates.ExecuteTemplate(w, \"indexPage\", nil)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n}\n\nfunc main() {\n    http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n    http.HandleFunc(\"/index\", viewHandler)\n    http.ListenAndServe(\":8090\", nil)\n}\n</code></pre>\n\n<p>index.html</p>\n\n<pre><code>{{define \"indexPage\"}}\n&lt;html&gt;\n{{template \"header\"}}\n&lt;body&gt;\n    &lt;nav class=\"navbar navbar-default\"&gt;\n        &lt;div class=\"container-fluid\"&gt;\n            &lt;div class=\"navbar-header\"&gt;\n                &lt;a class=\"navbar-brand\" href=\"#\"&gt;Welcome to TDT Project&lt;/a&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/nav&gt;\n\n    &lt;div class=\"btn-group-vertical\"&gt;\n        &lt;a href=\"#\" class=\"btn btn-default\"&gt;Button&lt;/a&gt;\n        &lt;a href=\"#\" class=\"btn btn-default\"&gt;Button&lt;/a&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>another html file is header.html and is correct.</p>\n\n<p>When I change the html and run main.go again, why the views are always the same?(I have cleaned the cache of browser)For example, change \"Welcome\" to \"wwww\", the browser does change at all.</p>\n\n<p>Then I kill the progress of main.go and run it again, the view is changed.</p>\n\n<p>Is there a better way to stop the main.go rather than kill this progress?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1435500697, "post_id": 31099620, "comment_id": 50216729, "body": "As I wrote on my deleted answer, this is something unique to the C package and not a general problem, if you change the signature of Callback to use native go types everything will work. I don&#39;t know the exact reason for it, but perhaps you should change the title or something."}, {"owner": {"reputation": 137, "user_id": 5058093, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e80c9396e250c345163ee73e200d1c8d?s=128&d=identicon&r=PG&f=1", "display_name": "kov", "link": "https://stackoverflow.com/users/5058093/kov"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1435500704, "post_id": 31099620, "comment_id": 50216731, "body": "An update: it appears to be the use of the C types in the function, as it works with go <code>int</code> and <code>float32</code>.  When I stopped using the <code>Callback</code> type and just changed <code>Invoke</code> to take parameter of type <code>func (C.int,C.double)</code> then I get this error:       <code>src&#47;hello&#47;hello.go:9: cannot use foo (type func(C.int, C.double)) as type func(mypkg.C.int, mypkg.C.double) in argument to mypkg.Invoke</code>"}, {"owner": {"reputation": 137, "user_id": 5058093, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e80c9396e250c345163ee73e200d1c8d?s=128&d=identicon&r=PG&f=1", "display_name": "kov", "link": "https://stackoverflow.com/users/5058093/kov"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1435500792, "post_id": 31099620, "comment_id": 50216760, "body": "@Not_a_Golfer, yes that makes sense. I don&#39;t know why your answer was deleted, but thanks for your help."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1435500821, "post_id": 31099620, "comment_id": 50216767, "body": "I deleted it myself, since it answered your initial question (you didn&#39;t cast the func) but didn&#39;t solve your problem."}, {"owner": {"reputation": 137, "user_id": 5058093, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e80c9396e250c345163ee73e200d1c8d?s=128&d=identicon&r=PG&f=1", "display_name": "kov", "link": "https://stackoverflow.com/users/5058093/kov"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1435501397, "post_id": 31099620, "comment_id": 50216936, "body": "Yes, that works now. So if you really needed those types across the package boundary, within the package you can declare type aliases, e.g. <code>type MyInt C.int</code> etc. Maybe I should change the title to better reflect the real problem of using C types in package interfaces?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1435502386, "post_id": 31099620, "comment_id": 50217267, "body": "You should. I found nothing in the C docs to suggest what causes this, but my suspicion is that it involves the code generation going on behind the scenes, the C namespace of each package probably isn&#39;t the same."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1435539109, "post_id": 31099620, "comment_id": 50227552, "body": "like a built-in function is not really a function. for a &#39;compiling to native&#39; language, we bear it. thinking C language, has lot of nuts."}], "answers": [{"tags": [], "owner": {"reputation": 1641, "user_id": 3828156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scFYI.jpg?s=128&g=1", "display_name": "chendesheng", "link": "https://stackoverflow.com/users/3828156/chendesheng"}, "is_accepted": false, "score": 0, "last_activity_date": 1435502636, "creation_date": 1435502636, "answer_id": 31101061, "question_id": 31099620, "link": "https://stackoverflow.com/questions/31099620/trouble-using-exported-function-type-with-c-types-as-parameters/31101061#31101061", "title": "Trouble using exported function type with C types as parameters", "body": "<p>They are actually different types!</p>\n\n<p>Change your code to:</p>\n\n<pre><code>package main\n\nimport \"C\"\nimport \"mypkg\"\n\nfunc main() {\n    a := 1\n\n    mypkg.Inc(C.int(a))\n}\n</code></pre>\n\n<p>mypkg:</p>\n\n<pre><code>package mypkg\n\nimport \"C\"\n\nfunc Inc(a C.int) C.int {\n    return a + 1\n}\n</code></pre>\n\n<p>Compile first package will get error:\n./test.go:9: cannot use C.int(a) (type C.int) as type mypkg.C.int in argument to mypkg.Inc</p>\n"}], "owner": {"reputation": 137, "user_id": 5058093, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e80c9396e250c345163ee73e200d1c8d?s=128&d=identicon&r=PG&f=1", "display_name": "kov", "link": "https://stackoverflow.com/users/5058093/kov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1491976460, "creation_date": 1435493330, "last_edit_date": 1491976460, "question_id": 31099620, "link": "https://stackoverflow.com/questions/31099620/trouble-using-exported-function-type-with-c-types-as-parameters", "title": "Trouble using exported function type with C types as parameters", "body": "<p>EDIT: changed the title to better reflect the problem thanks to @Not_a_Golfer</p>\n\n<p>I have been experimenting with Go and cannot figure out this problem.</p>\n\n<p>The following works fine when it is contained within the main package:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Define a callback-function type, and define an invoker for it\ntype Callback func(i C.int, d C.double)\nfunc Invoke(cb Callback, i C.int, d C.double) {\n        cb(i, d)\n}\n//... then define my callback and pass it into the invoker\nfunc foo(i C.int, d C.double) {\n        fmt.Printf(\"i %d d %f\\n\", i, d)\n}\nfunc main() {\n        Invoke(foo, 2, 2.2)\n}\n</code></pre>\n\n<p>But when I define <code>type Callback</code> and <code>Invoke</code> in a package, import the package into main and call <code>mypkg.Invoker(foo, 2, 2.2)</code> I get the following build error:</p>\n\n<pre><code>src/hello/hello.go:9: cannot convert foo (type func(C.int, C.double)) to type mypkg.Callback\n</code></pre>\n\n<p>Edit: here's the main code for the hello package. I structured everything so that I can use the <code>go</code> command for build/install:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\nimport \"C\"\nimport \"mypkg\"\nimport \"fmt\"\nfunc foo(i C.int, d C.double) {\n        fmt.Printf(\"i %d d %f\\n\", i, d)\n}\nfunc main() {\n        mypkg.Invoke( mypkg.Callback(foo), 2, 2.2 )\n}\n</code></pre>\n\n<p>Anybody know if there's anything special to be done for a type exported from a package? I'm using C types in the arguments because eventually this will be a wrapper around a C-library, and I just wanted to be sure the C types were not part of the problem matching my callback function to the callback type. </p>\n\n<p>Here's the package code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package mypkg\nimport \"C\"\nimport \"fmt\"\ntype Callback func(i C.int, d C.double)\nfunc Invoke(cb Callback, i C.int, d C.double) {\n        fmt.Println(\"Calling cb\\n\")\n        cb( i, d )\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 2861, "user_id": 929510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z568f.png?s=128&g=1", "display_name": "Staven", "link": "https://stackoverflow.com/users/929510/staven"}, "edited": false, "score": 0, "creation_date": 1435489579, "post_id": 31098798, "comment_id": 50213577, "body": "What do you mean &quot;not included in html&quot;? According to the code, the server should serve the CSS file under <code>serveraddress.com&#47;static&#47;css&#47;bootstrap.css</code>, not include it in anything. I&#39;m pretty sure the file names you&#39;ve written here are wrong. &quot;index.go&quot;?"}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 2861, "user_id": 929510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z568f.png?s=128&g=1", "display_name": "Staven", "link": "https://stackoverflow.com/users/929510/staven"}, "edited": false, "score": 0, "creation_date": 1435490607, "post_id": 31098798, "comment_id": 50213842, "body": "@Staven Sorry, that is main.go. Actually, when I click <a href=\"http://localhost:8080/static/css/bootstrap.css\" rel=\"nofollow noreferrer\">localhost:8080/static/css/bootstrap.css</a>, it tells 404 error. How can I fix it?"}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1435490932, "post_id": 31098798, "comment_id": 50213918, "body": "@Wyatt I&#39;ve just tested your code and it serves the CSS file correctly on my machine. Are you sure you don&#39;t have any conflicts with port 8080 on your machine?"}, {"owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "reply_to_user": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 0, "creation_date": 1435491440, "post_id": 31098798, "comment_id": 50214035, "body": "@Intermernet Thank you very much. I changed it to 8090 and this problem is fixed"}], "answers": [{"tags": [], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "is_accepted": false, "score": 0, "last_activity_date": 1435491533, "creation_date": 1435491533, "answer_id": 31099345, "question_id": 31098798, "link": "https://stackoverflow.com/questions/31098798/go-template-include-external-css/31099345#31099345", "title": "Go template include external css", "body": "<p>Because of the conflicts of the port, the CSS file is not correctly included. Thanks to @Intermernet. :)</p>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1440, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1435491533, "creation_date": 1435487685, "question_id": 31098798, "link": "https://stackoverflow.com/questions/31098798/go-template-include-external-css", "title": "Go template include external css", "body": "<p>index.go</p>\n\n<pre><code>package main\nimport (\n    \"html/template\"\n    \"net/http\"\n)\nfunc viewHandler(w http.ResponseWriter, r *http.Request) {\n    t, _ := template.ParseFiles(\"index.html\")\n    t.Execute(w, nil)\n}\nfunc main() {\n    http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n    http.HandleFunc(\"/index\", viewHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>In my index.html, I used the following path</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/css/bootstrap.css\"&gt;\n</code></pre>\n\n<p>And the path for the .css is as follows,</p>\n\n<p>web(folder)</p>\n\n<p>|---index.go</p>\n\n<p>|---static/css/xxx.css</p>\n\n<p>But, the css is not included in the html. How can I change the code to fix this problem</p>\n"}, {"tags": ["heroku", "go"], "answers": [{"comments": [{"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1435485842, "post_id": 31098414, "comment_id": 50212483, "body": "Thanks, so a client of mine could just push to Heroku the binary and the app will be built from this?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1435486040, "post_id": 31098414, "comment_id": 50212541, "body": "Not quite\u2014they&#39;ll need to use a binary buildpack first to tell Heroku what to run as it otherwise expects a Git repo. See this repo for instructions on how to run just a binary: <a href=\"https://github.com/ph3nx/heroku-binary-buildpack\" rel=\"nofollow noreferrer\">github.com/ph3nx/heroku-binary-buildpack</a>"}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 3, "last_activity_date": 1435486530, "last_edit_date": 1435486530, "creation_date": 1435485513, "answer_id": 31098414, "question_id": 31097929, "link": "https://stackoverflow.com/questions/31097929/golang-binary-on-heroku/31098414#31098414", "title": "Golang binary on Heroku", "body": "<p>The <a href=\"https://github.com/heroku/heroku-buildpack-go\" rel=\"nofollow\">Heroku buildpack for Go</a> doesn't do anything special: it just <a href=\"https://github.com/heroku/heroku-buildpack-go/blob/master/bin/compile\" rel=\"nofollow\">calls out to the Go tool</a> to compile the binary based on whether you use godeps or not.</p>\n\n<p>Just call <code>go build</code> in the directory of your <code>package main</code> or <code>go build repo.com/you/yourmainpackage</code> to output a binary you can distribute. </p>\n\n<p>In addition, you'll want to see this buildpack if you want to have others run a provided binary <em>on Heroku</em>: <a href=\"https://github.com/ph3nx/heroku-binary-buildpack\" rel=\"nofollow\">https://github.com/ph3nx/heroku-binary-buildpack</a> \u2014 make sure the binary has been compiled for amd64 Linux if you are targeting Heroku.</p>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1406, "favorite_count": 1, "accepted_answer_id": 31098414, "answer_count": 1, "score": 3, "last_activity_date": 1435486530, "creation_date": 1435482558, "question_id": 31097929, "link": "https://stackoverflow.com/questions/31097929/golang-binary-on-heroku", "title": "Golang binary on Heroku", "body": "<p>I've made a Golang application and I've no problem getting it to work on Heroku using the buildpack but now I would like to distribute the compiled program to others without the source code.</p>\n\n<p>Is it possible to get the binary working on Heroku without the source code or does Heroku need the source code to create its own compiled version?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 2, "creation_date": 1435476684, "post_id": 31097200, "comment_id": 50210424, "body": "Your main routine exits. A server program has to live to handle connections."}, {"owner": {"reputation": 53, "user_id": 3218128, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e06817d5d61ace1f7e7531e3899e12a9?s=128&d=identicon&r=PG", "display_name": "qiwihui", "link": "https://stackoverflow.com/users/3218128/qiwihui"}, "reply_to_user": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1435501135, "post_id": 31097200, "comment_id": 50216872, "body": "That&#39;s right. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "is_accepted": true, "score": 2, "last_activity_date": 1435487248, "last_edit_date": 1435487248, "creation_date": 1435476958, "answer_id": 31097260, "question_id": 31097200, "link": "https://stackoverflow.com/questions/31097200/a-go-echo-server-using-go-channel-but-no-reply-from-the-server/31097260#31097260", "title": "A go echo server using go channel, but no reply from the server", "body": "<p>Just change your main a bit:</p>\n\n<pre><code>ch := make(chan net.Conn)\ngo handleClient(ch)\n\nfor {\n    conn, err := listen.Accept()\n    if err != nil {\n        fmt.Println(\"Error Accept: \", err.Error())\n        return\n    }\n    ch &lt;- conn\n}\n</code></pre>\n\n<p>The for loop is the server's main loop and will run forever if you do not exit the server somewhere else.</p>\n"}], "owner": {"reputation": 53, "user_id": 3218128, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e06817d5d61ace1f7e7531e3899e12a9?s=128&d=identicon&r=PG", "display_name": "qiwihui", "link": "https://stackoverflow.com/users/3218128/qiwihui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 31097260, "answer_count": 1, "score": 0, "last_activity_date": 1435490006, "creation_date": 1435476298, "last_edit_date": 1435490006, "question_id": 31097200, "link": "https://stackoverflow.com/questions/31097200/a-go-echo-server-using-go-channel-but-no-reply-from-the-server", "title": "A go echo server using go channel, but no reply from the server", "body": "<p>I am trying to use go channel and goroutine to write an echo server, but there is no reply from the server. The following server listens on port 9090, and create a channel <code>ch</code> to receive connection acceptances, then it pass to <code>handleClient</code> to handle the connection details. Is the following code wrong? It has no errors when under <code>go build</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\nconst (\n    CONN_HOST = \"localhost\"\n    CONN_PORT = \"9090\"\n    CONN_TYPE = \"tcp\"\n)\n\nfunc main() {\n    listen, err := net.Listen(CONN_TYPE, CONN_HOST + \":\" + CONN_PORT)\n    if err != nil {\n        fmt.Println(\"Error listening: \", err.Error())\n        return\n    }\n\n    ch := make(chan net.Conn)\n    go func() {\n        for {\n            conn, err := listen.Accept()\n            if err != nil {\n                fmt.Println(\"Error Accept: \", err.Error())\n                return\n            }\n            ch &lt;- conn\n        }\n    }()\n    go handleClient(ch)\n}\n\nfunc handleClient(connChan &lt;-chan net.Conn) {\n    var tcpConn net.Conn\n    // fmt.Println(\"Accepted new client: \", connChan.RemoteAddr().String())\n    for {\n        tcpConn = &lt;-connChan\n        go Serve(tcpConn)\n    }\n}\n\nfunc Serve(conn net.Conn) {\n  // handle the connection\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 17, "last_activity_date": 1435463886, "last_edit_date": 1435463886, "creation_date": 1435462658, "answer_id": 31095907, "question_id": 31095699, "link": "https://stackoverflow.com/questions/31095699/return-cmd-stdout-and-stderr-as-string-instead-of-printing-to-console-in-golang/31095907#31095907", "title": "return cmd stdout and stderr as string instead of printing to console in golang", "body": "<p>Set the output to a <a href=\"http://godoc.org/bytes#Buffer\">bytes.Buffer</a>:</p>\n\n<pre><code>var outbuf, errbuf bytes.Buffer\ncmd.Stdout = &amp;outbuf\ncmd.Stderr = &amp;errbuf\n</code></pre>\n\n<p>After running the command, you can get the stdout and stderr as a string by calling the <a href=\"http://godoc.org/bytes#Buffer.String\">Buffer.String()</a> method:</p>\n\n<pre><code>stdout := outbuf.String()\nstderr := errbuf.String()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30856, "user_id": 105562, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/e66ceae48943526967c5118011e58b63?s=128&d=identicon&r=PG", "display_name": "Travis Reeder", "link": "https://stackoverflow.com/users/105562/travis-reeder"}, "is_accepted": false, "score": 2, "last_activity_date": 1476141769, "creation_date": 1476141769, "answer_id": 39968217, "question_id": 31095699, "link": "https://stackoverflow.com/questions/31095699/return-cmd-stdout-and-stderr-as-string-instead-of-printing-to-console-in-golang/39968217#39968217", "title": "return cmd stdout and stderr as string instead of printing to console in golang", "body": "<p>You can simplify this quite a bit by using <code>cmd.Run()</code> instead of <code>cmd.Start()</code> to have it automatically wait for it to be finish, and use <code>exec.CommandContext()</code> to have it timeout. This will also output in the correct order, whereas the original program is out of order due to go routines. </p>\n\n<p>Here's the exact same program simplified and using @Mello Marmot's answer:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n    \"time\"\n\n    \"golang.org/x/net/context\"\n)\n\nfunc main() {\n    ctx := context.Background()\n    ok, outString, errString := runBashCommandAndKillIfTooSlow(ctx, \"ls -la\", 2000*time.Millisecond)\n    fmt.Println(\"ok\")\n    fmt.Println(ok)\n    fmt.Println(\"outString\")\n    fmt.Println(outString)\n    fmt.Println(\"errString\")\n    fmt.Println(errString)\n}\n\n/*\nrun bash command and kill it if it works longer than \"killIn\"\n*/\nfunc runBashCommandAndKillIfTooSlow(ctx context.Context, command string, killIn time.Duration) (okResult bool, stdout, stderr string) {\n    fmt.Println(\"running bash command...\")\n    fmt.Println(command)\n    ctx, _ = context.WithTimeout(ctx, killIn)\n    cmd := exec.CommandContext(ctx, \"sh\", \"-c\", command)\n\n    // Set output to Byte Buffers\n    var outb, errb bytes.Buffer\n    cmd.Stdout = &amp;outb\n    cmd.Stderr = &amp;errb\n\n    okResult = true\n    err := cmd.Run()\n    stdout = outb.String()\n    stderr = errb.String()\n    if err != nil {\n        log.Fatal(err)\n        okResult = false\n    }\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8976, "favorite_count": 1, "accepted_answer_id": 31095907, "answer_count": 2, "score": 7, "last_activity_date": 1476141769, "creation_date": 1435459948, "last_edit_date": 1435461016, "question_id": 31095699, "link": "https://stackoverflow.com/questions/31095699/return-cmd-stdout-and-stderr-as-string-instead-of-printing-to-console-in-golang", "title": "return cmd stdout and stderr as string instead of printing to console in golang", "body": "<p>I am executing bash commands from a <code>golang</code> application. Now the <code>stdout</code> and <code>stderr</code> go directly to console:</p>\n\n<pre><code>cmd.Stdout = os.Stdout \ncmd.Stderr = os.Stderr\n</code></pre>\n\n<p>But I would like <code>stdout</code> and <code>stderr</code> to be returned as string variables from the <code>runBashCommandAndKillIfTooSlow</code> function without printing to the console immediately. \nHow to implement this?</p>\n\n<p>The code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n    \"time\"\n)\n\nfunc main() {\n    ok, outString, errString := runBashCommandAndKillIfTooSlow(\"ls -la\", 2000)\n    fmt.Println(\"ok\")\n    fmt.Println(ok)\n    fmt.Println(\"outString\")\n    fmt.Println(outString)\n    fmt.Println(\"errString\")\n    fmt.Println(errString)\n}\n\n/*\nrun bash command and kill it if it works longer than \"killInMilliSeconds\" milliseconds\n*/\nfunc runBashCommandAndKillIfTooSlow(command string, killInMilliSeconds time.Duration) (okResult bool, stdout, stderr string) {\n    fmt.Println(\"running bash command...\")\n    fmt.Println(command)\n    cmd := exec.Command(\"sh\", \"-c\", command)\n\n    cmd.Stdout = os.Stdout // cmd.Stdout -&gt; stdout\n    cmd.Stderr = os.Stderr // cmd.Stderr -&gt; stderr\n\n    okResult = true\n\n    err := cmd.Start()\n    log.Printf(\"Waiting for command to finish...\")\n    done := make(chan error, 1)\n    go func() {\n        done &lt;- cmd.Wait()\n    }()\n    select {\n    case &lt;-time.After(killInMilliSeconds * time.Millisecond):\n        if err := cmd.Process.Kill(); err != nil {\n            log.Fatal(\"failed to kill: \", err)\n            okResult = false\n        }\n        &lt;-done // allow goroutine to exit\n        // log.Println(\"process killed\")\n    case err := &lt;-done:\n\n        if err != nil {\n            log.Printf(\"process done with error = %v\", err)\n            okResult = false\n        }\n    }\n    if err != nil {\n        log.Fatal(err)\n        okResult = false\n    }\n    return\n}\n</code></pre>\n\n<p>By the way, the program should keep its ability to kill the bash command if it was too slow (<code>killInMilliSeconds</code> parameter).</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1523285594, "last_edit_date": 1523285594, "creation_date": 1435568966, "answer_id": 31111792, "question_id": 31095395, "link": "https://stackoverflow.com/questions/31095395/can-i-run-appengine-apps-without-the-goapp-tool-builder/31111792#31111792", "title": "Can I run Appengine apps without the goapp tool/builder?", "body": "<p>The Go App Engine SDK contains the standard Go packages and tools, but a modified version of them.</p>\n\n<p>The GAE SDK also contains local versions of the GAE platform services API implementations which are not part of the SDK (not even the API). So you can't just use the standard Go SDK. When you build or test with the GAE SDK, the SDK takes care of a context mockup so your app will have everything (or most of the things) required to \"feel\" it is running in the GAE environment. The SDK also contains the sandbox restrictions that are in effect in the production environment (e.g. you can't write to local files).</p>\n\n<p>Also note that some features of the GAE SDK also rely on a Python runtime (because the Go GAE SDK was created using the existing Python GAE SDK), not everything is rewritten in go.</p>\n\n<p>So taking all these into consideration it would not be feasible to build/test using the standard Go SDK and it is not even possible.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1523285594, "creation_date": 1435456448, "question_id": 31095395, "link": "https://stackoverflow.com/questions/31095395/can-i-run-appengine-apps-without-the-goapp-tool-builder", "title": "Can I run Appengine apps without the goapp tool/builder?", "body": "<p>I'm wondering if there is any way to run and test GAE Go apps using the standard go test || go build etc tools and if it's not possible what's the technical reason.</p>\n"}, {"tags": ["mongodb", "go", "mgo", "revel"], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 5086822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853c6f82008ed7b4728c143159e206f1?s=128&d=identicon&r=PG", "display_name": "Zhuharev", "link": "https://stackoverflow.com/users/5086822/zhuharev"}, "is_accepted": true, "score": 1, "last_activity_date": 1436212586, "creation_date": 1436212586, "answer_id": 31254534, "question_id": 31094800, "link": "https://stackoverflow.com/questions/31094800/creating-a-new-mongodb-database-using-revel-framework-in-golang/31254534#31254534", "title": "Creating a new mongodb database using revel framework in golang", "body": "<p>you have access to <code>db.Session</code> and <code>db.Users</code> from controllers/app.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/revel/revel\"\n    \"myapp/app/db\"\n )\n\ntype App struct {\n    *revel.Controller\n}\n\nfunc init() {\n    db.Init(\"127.0.0.1\", \"mydb\")\n}\n\nfunc (c App) Hello() revel.Result{\n\n\n    //there use db\n    db.Session.Find(...)\n    return c.Render()\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5006980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d54535a82f4c2aab0d93f5e25813fcb?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi", "link": "https://stackoverflow.com/users/5006980/aditi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1412, "favorite_count": 0, "accepted_answer_id": 31254534, "answer_count": 1, "score": 1, "last_activity_date": 1436212586, "creation_date": 1435449654, "last_edit_date": 1435484010, "question_id": 31094800, "link": "https://stackoverflow.com/questions/31094800/creating-a-new-mongodb-database-using-revel-framework-in-golang", "title": "Creating a new mongodb database using revel framework in golang", "body": "<p>I am trying to create a new database in mongodb using revel framework and mgo driver. Here's my code in --> src/myapp/app/db/mgo.go</p>\n\n<pre><code>package db\n\nimport (\n    \"fmt\"\n    \"gopkg.in/mgo.v2\"\n)\n\nvar Session *mgo.Session\nvar Users   *mgo.Collection\n\nfunc Init(url, dbname string) {\n\n    var err error\n    Session,err = mgo.Dial(url)\n    if err!=nil{\n        panic(err)\n    }\n\n    Session.SetMode(mgo.Monotonic, true)\n    Users = Session.DB(dbname).C(\"users\")\n}\n</code></pre>\n\n<p>and here's the code from where the program runs --> src/myapp/app/controllers/app.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/revel/revel\"\n    \"myapp/app/db\"\n)\n\ntype App struct {\n    *revel.Controller\n}\n\nfunc (c App) Hello() revel.Result{\n\n    db.Init(\"127.0.0.1\", \"mydb\")\n    return c.Render()\n}\n</code></pre>\n\n<p>The problem is I am not able to create a database by these two parts of separate files of code, whereas when I merge them in one (i.e. just app.go) then it works well. Here's the code that works in --> src/myapp/app/controllers/app.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/revel/revel\"\n    \"gopkg.in/mgo.v2\"\n)\n\ntype App struct {\n    *revel.Controller\n}\n\nfunc (c App) Hello() revel.Result{\n\n    session,err:=mgo.Dial(\"127.0.0.1\")\n\n    if err != nil {\n        panic(err)\n    }\n\n    defer session.Close()\n\n    session.SetMode(mgo.Monotonic, true)\n\n    d:=session.DB(\"mydb\").C(\"anydata\")\n    return c.Render()\n}\n</code></pre>\n\n<p>So I would like someone to help me in correcting my first two parts of code</p>\n"}, {"tags": ["go", "build"], "answers": [{"tags": [], "owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "is_accepted": false, "score": -1, "last_activity_date": 1435449298, "creation_date": 1435449298, "answer_id": 31094769, "question_id": 31094751, "link": "https://stackoverflow.com/questions/31094751/go-cannot-find-goroot-directory-c-go/31094769#31094769", "title": "go: cannot find GOROOT directory: c:\\go", "body": "<p>I set GOROOT to point to the content of that dir:</p>\n\n<pre><code>AUTHORS      PATENTS      api          favicon.ico  misc         src\nCONTRIBUTORS README       bin          include      pkg          test\nLICENSE      VERSION      doc          lib          robots.txt\n</code></pre>\n\n<p>That's the dir which containts src, bin, doc, lib, etc...</p>\n"}, {"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 6, "last_activity_date": 1435504586, "last_edit_date": 1592644375, "creation_date": 1435503938, "answer_id": 31101257, "question_id": 31094751, "link": "https://stackoverflow.com/questions/31094751/go-cannot-find-goroot-directory-c-go/31101257#31101257", "title": "go: cannot find GOROOT directory: c:\\go", "body": "<p>From Dave Cheney's <a href=\"http://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"noreferrer\">You don\u2019t need to set GOROOT, really</a> article:</p>\n<blockquote>\n<p>There are only two cases that where you may have to set a <code>$GOROOT</code> environment. These are both described in the <a href=\"http://golang.org/doc/install#install\" rel=\"noreferrer\">installation page</a> on the golang.org website. For completeness I will recap them here</p>\n<ul>\n<li>You are a Linux, FreeBSD or OS\u00a0X user using the the zip or tarball binary downloads from the golang.org website. These binaries have a <code>$GOROOT</code> value of <code>/usr/local/go</code> and recommend you unpack them into that location. If you choose not to do this, then you must set <code>$GOROOT</code> to the location you chose.</li>\n<li>You are a Windows user using the zip binary download from the golang.org website. These binaries have a <code>$GOROOT</code> value of <code>C:\\Go</code>. <strong>If you place Go somewhere else on your system then you must set <code>$GOROOT</code> to the location you chose.</strong></li>\n</ul>\n</blockquote>\n<p>(The rest of the article is a good read if you want to learn the history that has caused confusion over <code>GOROOT</code>, the summary is it's due to outdated instructions mostly from pre-Go1.)</p>\n<p>So if you use a pre-built Go binary, <em>and</em> you want to put it somewhere other than where it &quot;wants&quot;, then you need <code>GOROOT</code>. Otherwise (i.e.\u00a0if you build Go from source, or if you put the binary distribution in the default location) you don't need or want to set <code>GOROOT</code> (the above article gives some reasons why not).</p>\n<p>If you're unsure, the easiest way to get it &quot;correct&quot; is to first <em>not</em> set anything other <code>GOPATH</code>. Then run <code>go env</code> and see what it says; if that shows reasonable entries for <code>GOROOT</code> and <code>GOPATH</code> then you're done; only set variables to override that if it's wrong.</p>\n"}, {"tags": [], "owner": {"reputation": 1726, "user_id": 5254103, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jF1hK.jpg?s=128&g=1", "display_name": "BaiJiFeiLong", "link": "https://stackoverflow.com/users/5254103/baijifeilong"}, "is_accepted": false, "score": -1, "last_activity_date": 1509825882, "creation_date": 1509825882, "answer_id": 47115095, "question_id": 31094751, "link": "https://stackoverflow.com/questions/31094751/go-cannot-find-goroot-directory-c-go/47115095#47115095", "title": "go: cannot find GOROOT directory: c:\\go", "body": "<p>Maybe the cache problem.</p>\n\n<p>For me, I reopen the MinGW (I installed go in msys2 by pacman), and it worked.</p>\n"}, {"tags": [], "owner": {"reputation": 4318, "user_id": 5166818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a98853514380fcf54f58a02b71c0a0?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Kaneria", "link": "https://stackoverflow.com/users/5166818/amit-kaneria"}, "is_accepted": false, "score": 1, "last_activity_date": 1558102817, "creation_date": 1558102817, "answer_id": 56188353, "question_id": 31094751, "link": "https://stackoverflow.com/questions/31094751/go-cannot-find-goroot-directory-c-go/56188353#56188353", "title": "go: cannot find GOROOT directory: c:\\go", "body": "<p>Once Go lang is installed, GOROOT is the root directory of the installation.</p>\n\n<p>When I exploded Go Lang binary in Windows C:\\ directory, my GOROOT should be C:\\go.\nIf Installed with Windows installer, it may be C:\\Program Files\\go (or C:\\Program Files (x86)\\go, for 64-bit packages)</p>\n\n<pre><code> GOROOT = C:\\go\n</code></pre>\n"}], "owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7910, "favorite_count": 0, "accepted_answer_id": 31101257, "answer_count": 4, "score": 4, "last_activity_date": 1558102817, "creation_date": 1435449131, "last_edit_date": 1495541796, "question_id": 31094751, "link": "https://stackoverflow.com/questions/31094751/go-cannot-find-goroot-directory-c-go", "title": "go: cannot find GOROOT directory: c:\\go", "body": "<p>I unzipped <a href=\"https://storage.googleapis.com/golang/go1.4.2.windows-amd64.zip\" rel=\"nofollow noreferrer\">the Go distribution</a> into <code>d:\\dev\\go</code>, added <code>d:\\dev\\go\\bin</code> to my path, created a file <code>d:\\projects\\hello\\hello.go</code> and set GOPATH to <code>d:\\projects\\hello</code>. Running <code>go build hello.go</code> tells me:</p>\n\n<pre><code>go: cannot find GOROOT directory: c:\\go\n</code></pre>\n\n<p>Now <a href=\"https://stackoverflow.com/a/21899482/476074\">several</a> <a href=\"http://golang.org/doc/articles/go_command.html#tmp_3\" rel=\"nofollow noreferrer\">different</a> <a href=\"http://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"nofollow noreferrer\">places</a> strongly urge me <em>not</em> to set GOROOT, setting GOPATH should be everything that is needed.</p>\n\n<p>Should I go against this recommendation or is there something I am missing?</p>\n"}, {"tags": ["postgresql", "go", "postgresql-9.4"], "answers": [{"tags": [], "owner": {"reputation": 473266, "user_id": 939860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed7cecf2bd835cf5670d271d0d104f51?s=128&d=identicon&r=PG", "display_name": "Erwin Brandstetter", "link": "https://stackoverflow.com/users/939860/erwin-brandstetter"}, "is_accepted": true, "score": 1, "last_activity_date": 1435447127, "creation_date": 1435447127, "answer_id": 31094519, "question_id": 31094386, "link": "https://stackoverflow.com/questions/31094386/how-do-i-parametarize-an-operator/31094519#31094519", "title": "How do I parametarize an operator?", "body": "<p>Prepared statements allow to parametrize <strong><em>values</em></strong>, nothing else. It wouldn't make sense to parametrize operators to begin with, a statement cannot be prepared without knowing involved operators. And it would be potentially dangerous, opening vectors for SQL injection.</p>\n\n<p>To switch operators, you'll have to <em>concatenate a new query string</em> in your client or use <em>dynamic SQL</em> with a server-side procedural language, the default being plpgsql.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 31094519, "answer_count": 1, "score": 0, "last_activity_date": 1435447127, "creation_date": 1435445971, "question_id": 31094386, "link": "https://stackoverflow.com/questions/31094386/how-do-i-parametarize-an-operator", "title": "How do I parametarize an operator?", "body": "<p>I have the following sql statement:</p>\n\n<pre><code>SELECT pk, up FROM mytable WHERE 2 &gt; 1 LIMIT 10\n</code></pre>\n\n<p>This is just for simplicity, obviously. I am able to parameterize any of the integers:</p>\n\n<pre><code>SELECT pk, up FROM mytable WHERE 2 &gt; $1 LIMIT 10\n</code></pre>\n\n<p>BUT, when I try to parameterize the operator, eg:</p>\n\n<pre><code>SELECT pk, up FROM mytable WHERE 2 $1 1 LIMIT 10\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>pq: syntax error at or near \"$1\"\n</code></pre>\n\n<p>Full Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    _ \"github.com/lib/pq\"\n    \"log\"\n)\n\nfunc main() {\n    log.SetFlags(log.Lshortfile)\n    Db, err := sql.Open(\"postgres\", \"user=yoitsmeletmein password=supersecretyo host=what.a.host dbname=mydb sslmode=require\")\n    if err != nil {\n        log.Fatal(\"Cannot connect to db: \", err)\n    }\n    q := `SELECT pk FROM mytable WHERE 2 $1 1 LIMIT 10`\n    params := []interface{}{\"&gt;\"}\n    rows, err := Db.Query(q, params...)\n    if err != nil {\n        log.Println(err)\n    } else {\n        defer rows.Close()\n        for rows.Next() {\n            var pk int64\n            if err := rows.Scan(&amp;pk); err != nil {\n                log.Fatal(err)\n            }\n            log.Println(pk)\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "openshift"], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 1400450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b88ceb5b3e470154f27b355fd862d71d?s=128&d=identicon&r=PG", "display_name": "DWils", "link": "https://stackoverflow.com/users/1400450/dwils"}, "edited": false, "score": 0, "creation_date": 1435447870, "post_id": 31094447, "comment_id": 50205562, "body": "These are not on github (at least not publicly), these are packages I have created that are local to my src/ folder. So go get github.com/user/project would not resolve. Even so, managing one application&#39;s dependencies in two separate repos makes no sense for this small of an application."}, {"owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "reply_to_user": {"reputation": 344, "user_id": 1400450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b88ceb5b3e470154f27b355fd862d71d?s=128&d=identicon&r=PG", "display_name": "DWils", "link": "https://stackoverflow.com/users/1400450/dwils"}, "edited": false, "score": 0, "creation_date": 1435452913, "post_id": 31094447, "comment_id": 50206485, "body": "Even if they are not on github you should be importing from the full src path. Github was just an example."}, {"owner": {"reputation": 344, "user_id": 1400450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b88ceb5b3e470154f27b355fd862d71d?s=128&d=identicon&r=PG", "display_name": "DWils", "link": "https://stackoverflow.com/users/1400450/dwils"}, "edited": false, "score": 1, "creation_date": 1435521447, "post_id": 31094447, "comment_id": 50223425, "body": "Ah, I did try the src path but it looks like openshift is copying files around in such a way based on the go path that immediately breaks these conventions."}, {"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1466578613, "post_id": 31094447, "comment_id": 63368512, "body": "having issues with this myself. in openshift i have a package routes. I have a main.go in the project root the main ackage is here too. not sue how to use the .godir either"}], "tags": [], "owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "is_accepted": false, "score": 2, "last_activity_date": 1435501018, "last_edit_date": 1435501018, "creation_date": 1435446461, "answer_id": 31094447, "question_id": 31094283, "link": "https://stackoverflow.com/questions/31094283/unrecognized-import-path-on-openshift/31094447#31094447", "title": "unrecognized import path on openshift", "body": "<p>You should use the full import path. For example <code>\"github.com/user/project/model/crud\"</code> </p>\n"}, {"comments": [{"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1466578691, "post_id": 31095149, "comment_id": 63368559, "body": "HectorJ do i find the [..] part??"}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 2, "last_activity_date": 1435453297, "creation_date": 1435453297, "answer_id": 31095149, "question_id": 31094283, "link": "https://stackoverflow.com/questions/31094283/unrecognized-import-path-on-openshift/31095149#31095149", "title": "unrecognized import path on openshift", "body": "<p>To find the import path you are supposed to use, take \"$GOPATH/src/[...]/model/crud\" and just remove the \"$GOPATH/src/\" part.</p>\n"}], "owner": {"reputation": 344, "user_id": 1400450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b88ceb5b3e470154f27b355fd862d71d?s=128&d=identicon&r=PG", "display_name": "DWils", "link": "https://stackoverflow.com/users/1400450/dwils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435501018, "creation_date": 1435445129, "question_id": 31094283, "link": "https://stackoverflow.com/questions/31094283/unrecognized-import-path-on-openshift", "title": "unrecognized import path on openshift", "body": "<p>I have some local packages defined within my application, for example, I have a crud model located at model/crud/crud.go</p>\n\n<p>Within my application I am calling upon them using <code>import(\"model/crud\")</code>, for all of my local dependencies.</p>\n\n<p>This resolves perfectly fine within the context of my application on my local machine, however when I try to push to openshift I get the following error:</p>\n\n<p><code>imports model/crud: unrecognized import path \"model/crud\"</code></p>\n\n<p>It looks like when openshift runs the build tool, it is attempting to run <code>go get</code> on these imports in order to include them in the build path when compiling. </p>\n\n<p>Is there a better way to resolve vendor specific dependencies without having to create a separate repo for them? I don't want to have to manage two separate repositories if I don't have to.</p>\n"}, {"tags": ["api", "design-patterns", "go"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1435443716, "post_id": 31093981, "comment_id": 50204654, "body": "You aren&#39;t being very clear here on how you would <i>like</i> the API to look. That said, just get used to how Go does APIs and use that. Look at how the included IO modules work with Reader, Writer, and the various kinds of Buffer. Don&#39;t try to copy a Java or C# or whatever pattern because it will feel WRONG to every other Go programmer."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1435443942, "post_id": 31093981, "comment_id": 50204709, "body": "Another comment about adding functions to interfaces. Consider adding another interface. If you need an object to be saved into a database you might have a second interface that does that and then you implement that on your BasicUser structure."}], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 3946803, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d224fe3dfe89701649d6920f3b794e92?s=128&d=identicon&r=PG&f=1", "display_name": "Vic", "link": "https://stackoverflow.com/users/3946803/vic"}, "edited": false, "score": 0, "creation_date": 1435477764, "post_id": 31094513, "comment_id": 50210662, "body": "But as soon as I add functions to access and modify the data I would mix up an object and a data structure, which is an antipattern <a href=\"http://programmers.stackexchange.com/questions/119352/does-the-activerecord-pattern-follow-encourage-the-solid-design-principles\" title=\"does the activerecord pattern follow encourage the solid design principles\">programmers.stackexchange.com/questions/119352/&hellip;</a> How to resolve this?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 92, "user_id": 3946803, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d224fe3dfe89701649d6920f3b794e92?s=128&d=identicon&r=PG&f=1", "display_name": "Vic", "link": "https://stackoverflow.com/users/3946803/vic"}, "edited": false, "score": 1, "creation_date": 1435592487, "post_id": 31094513, "comment_id": 50252787, "body": "@Vic: Is this antipattern concern of yours a real problem or a problem in some pie-in-the-sky theory? If it&#39;s a theory problem ignore it and do what works. Ignore the theory because it&#39;s useless."}], "tags": [], "owner": {"reputation": 1125, "user_id": 4224724, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XMleNi8A3cE/AAAAAAAAAAI/AAAAAAAACzU/_LZ3Rgct8Xk/photo.jpg?sz=128", "display_name": "Danver Braganza", "link": "https://stackoverflow.com/users/4224724/danver-braganza"}, "is_accepted": false, "score": 2, "last_activity_date": 1435447054, "creation_date": 1435447054, "answer_id": 31094513, "question_id": 31093981, "link": "https://stackoverflow.com/questions/31093981/basic-api-in-golang-antipattern/31094513#31094513", "title": "Basic API in golang antipattern?", "body": "<p>In Go, interfaces are behavioural. That is, they describe what a thing <em>does</em> more than what it <em>is</em>. Your example looks like you're trying to write C# in Go, with your heavy use of I in front of interface classes. However, an interface that is only implemented by one type is a bit of a waste of time.</p>\n\n<p>Instead, consider:</p>\n\n<pre><code>interface Deleteable {  // You'd probably be tempted to call this IDeleteable\n                        // Effective go suggests Deleter, but the grammar \n                        // sounds weird\n    Delete() err\n}\n</code></pre>\n\n<p>Now you can create a function to perform batch deletes:</p>\n\n<pre><code>func BatchDelete(victims []Deleteable) {\n    // Do some cool things for batching, connect to db, start a transaction\n    for _, victim := range(victims) {\n        victim.Delete()  // Or arrange for this function to be called somehow.\n    }\n}\n</code></pre>\n\n<p>You'd probably get started faster by creating an interface for Update, Serialize and so on, and <em>storing</em> your actual users/permissions/etc in concrete structs that implement those methods. (Note in Go you don't have to say that a type implements an interface, it happens \"automatically\"). You also don't have to have a single interface for each method (Updater, Serializable), but you can bundle them all into one interface:</p>\n\n<pre><code>type DBObject interface {\n    Update()\n    Serialize() RowType\n    Delete()\n}\n\ntype User struct {\n    Id int\n    Name string\n    // ... etc\n}\n</code></pre>\n\n<p>Remember, your model can always \"Fill in\" a User object to return from your API, even if the actual representation of the User object is something much more diffuse, e.g. RDF triples.</p>\n"}, {"tags": [], "owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1598259042, "creation_date": 1598259042, "answer_id": 63557675, "question_id": 31093981, "link": "https://stackoverflow.com/questions/31093981/basic-api-in-golang-antipattern/63557675#63557675", "title": "Basic API in golang antipattern?", "body": "<p>I agree with @ZanLynx comments. Go\u2019s standard library seems to favour the interface way for APIs.</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\ntype S string\ntype I interface{ M() S }\nfunc (s S) M() S { return s }\nfunc API(i I)            I { return i.M() }\n\nfunc main() {\n  s := S(&quot;interface way&quot;)\n  fmt.Println(API(s))\n}\n</code></pre>\n<p>It may be worth noting that APIs that take in a one-method interface could be re-written as taking a function type.</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc API(f func() string) string { return f() }\n\nfunc main() {\n  f := func() string { return &quot;higher-order way&quot; }\n  fmt.Println(API(f))\n}\n</code></pre>\n<p>As an API author, one could provide both mechanisms and let the API consumer decide the style of invocation. See <a href=\"http://aquaraga.github.io/functional-programming/golang/2016/11/19/golang-interfaces-vs-functions.html\" rel=\"nofollow noreferrer\">http://aquaraga.github.io/functional-programming/golang/2016/11/19/golang-interfaces-vs-functions.html</a>.</p>\n"}], "owner": {"reputation": 92, "user_id": 3946803, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d224fe3dfe89701649d6920f3b794e92?s=128&d=identicon&r=PG&f=1", "display_name": "Vic", "link": "https://stackoverflow.com/users/3946803/vic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1598279636, "creation_date": 1435442652, "last_edit_date": 1598279636, "question_id": 31093981, "link": "https://stackoverflow.com/questions/31093981/basic-api-in-golang-antipattern", "title": "Basic API in golang antipattern?", "body": "<p>Correct me if I'm wrong, but for my understanding of an API is that it is something that allows me to modify and request data through an interface,  which is what I want to do in Go. For example I have a user interface:</p>\n<pre><code>interface IUser {\n  GetId() int\n  GetName() string\n  GetSignupDate() time\n  GetPermissions() []IPermission\n  Delete()\n}\n</code></pre>\n<p>This already looks to me like active record and if I want to create a new user with a new id I would have to use <code>new</code> since Go doesn't support static functions as far as I know. This means I would also need a commit function in my interface, which makes it even worse for me. What am I doing wrong here?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2258, "user_id": 1952811, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3d2de061c9d12cd53ff7674556694d8a?s=128&d=identicon&r=PG", "display_name": "user1952811", "link": "https://stackoverflow.com/users/1952811/user1952811"}, "edited": false, "score": 0, "creation_date": 1435441825, "post_id": 31093792, "comment_id": 50204177, "body": "Thanks for the answer, but moving the group.go file into the same directory as the main.go file still causes the same error."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1435448528, "post_id": 31093792, "comment_id": 50205708, "body": "You&#39;re using <code>go build</code> to build the application, not go run, right? As long as all files are of the same package\u2014which is <code>package main</code> in this case\u2014it should work."}, {"owner": {"reputation": 2258, "user_id": 1952811, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3d2de061c9d12cd53ff7674556694d8a?s=128&d=identicon&r=PG", "display_name": "user1952811", "link": "https://stackoverflow.com/users/1952811/user1952811"}, "edited": false, "score": 0, "creation_date": 1435451452, "post_id": 31093792, "comment_id": 50206229, "body": "Yeah that seems to do the trick, thanks for all the help guys!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1435441204, "creation_date": 1435441204, "answer_id": 31093792, "question_id": 31093706, "link": "https://stackoverflow.com/questions/31093706/having-trouble-splitting-go-code-in-multiple-files/31093792#31093792", "title": "Having trouble splitting go code in multiple files", "body": "<p>There are two ways to fix this:</p>\n\n<ol>\n<li>Move group.go to the same directory as main.go.</li>\n<li><p>Import group.go as a package. Change the package declaration on group.go to:</p>\n\n<p>package routes // or the name of your choice</p></li>\n</ol>\n\n<p>Export the functions by starting them with a capital letter:</p>\n\n<pre><code>func GroupIndex(c *gin.Context) {\n</code></pre>\n\n<p>Import the package from main:</p>\n\n<pre><code> import \"path/to/routes\"\n ...\n groups.GET(\"/\", routes.GroupIndex)\n</code></pre>\n\n<p>The document <a href=\"http://golang.org/doc/code.html\" rel=\"nofollow\">How To Write Go Code</a> explains this and more.</p>\n"}], "owner": {"reputation": 2258, "user_id": 1952811, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3d2de061c9d12cd53ff7674556694d8a?s=128&d=identicon&r=PG", "display_name": "user1952811", "link": "https://stackoverflow.com/users/1952811/user1952811"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 837, "favorite_count": 0, "accepted_answer_id": 31093792, "answer_count": 1, "score": -2, "last_activity_date": 1435441204, "creation_date": 1435440620, "question_id": 31093706, "link": "https://stackoverflow.com/questions/31093706/having-trouble-splitting-go-code-in-multiple-files", "title": "Having trouble splitting go code in multiple files", "body": "<p>I have two files <code>main.go</code> and <code>group.go</code>... it looks something like this </p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n    \"net/http\"\n)\n\nfunc main() {\n    // Creates a gin router with default middlewares:\n    // logger and recovery (crash-free) middlewares\n    router := gin.Default()\n\n    v1 := router.Group(\"/v1\")\n    {\n        v1.GET(\"/\", func (c *gin.Context) {\n            c.JSON(http.StatusOK, \"{'sup': 'dup'}\")\n        })\n\n        groups := v1.Group(\"/groups\")\n        {\n            groups.GET(\"/\", groupIndex)\n\n            groups.GET(\"/:id\", groupShow)\n            groups.POST(\"/\", groupCreate)\n            groups.PUT(\"/:id\", groupUpdate)\n            groups.DELETE(\"/:id\", groupDelete)\n        }\n    }\n\n    // Listen and server on 0.0.0.0:8080\n    router.Run(\":3000\")\n}\n</code></pre>\n\n<p>So the methods <code>groupIndex</code>, <code>groupCreate</code>, <code>groupUpdate</code>, etc are located in another file under <code>routes/group.go</code></p>\n\n<pre><code>package main\n\nimport (\n  \"strings\"\n  \"github.com/gin-gonic/gin\"\n)\n\n\nfunc groupIndex(c *gin.Context) {\n  var group struct {\n    Name string\n    Description string\n  }\n\n  group.Name = \"Famzz\"\n  group.Description = \"Jamzzz\"\n\n  c.JSON(http.StatusOK, group)\n}\n\nfunc groupShow(c *gin.Context) {\n  c.JSON(http.StatusOK, \"{'groupShow': 'someContent'}\")\n}\n\nfunc groupCreate(c *gin.Context) {\n  c.JSON(http.StatusOK, \"{'groupShow': 'someContent'}\")\n}\n\nfunc groupUpdate(c *gin.Context) {\n  c.JSON(http.StatusOK, \"{'groupUpdate': 'someContent'}\")\n}\n\nfunc groupDelete(c *gin.Context) {\n  c.JSON(http.StatusOK, \"{'groupDelete': 'someContent'}\")\n}\n</code></pre>\n\n<p>But when I try to compile I get the following error </p>\n\n<pre><code>stuff/main.go:21: undefined: groupIndex\nstuff/main.go:23: undefined: groupShow\nstuff/main.go:24: undefined: groupCreate\nstuff/main.go:25: undefined: groupUpdate\nstuff/main.go:26: undefined: groupDelete\n</code></pre>\n\n<p>I'm super new to go, but I thought if you put files in the same package, then they'll have access to each other. What am I doing wrong here? </p>\n"}, {"tags": ["nginx", "go", "proxy", "websocket"], "answers": [{"tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1435492930, "creation_date": 1435492930, "answer_id": 31099565, "question_id": 31091390, "link": "https://stackoverflow.com/questions/31091390/go-websocket-nginx-proxy-is-this-correct/31099565#31099565", "title": "Go websocket, nginx proxy is this correct?", "body": "<p>I am no nginx expert but given that nobody else has answered I will present some of my research.</p>\n\n<p>1) Yes, nginx is definitely a good choice for that. You can find some <a href=\"http://nginx.com/blog/nginx-websockets-performance/\" rel=\"nofollow\">benchmarks</a> here. Possible caveats are mentioned in <a href=\"https://blog.martinfjordvald.com/2013/02/websockets-in-nginx/\" rel=\"nofollow\">this</a> (older) post. The most important point to consider is the timeout aspect. <a href=\"https://stackoverflow.com/questions/10550558/nginx-tcp-websockets-timeout-keepalive-config\">These</a> <a href=\"https://stackoverflow.com/questions/12102110/nginx-to-reverse-proxy-websockets-and-enable-ssl-wss\">two</a> answers give helpful information in that regard. </p>\n\n<p>2) Not exactly sure what you want to achieve by that but you could simply use a different port, as websockets are not subject to the same origin policy, or use the tcp forwarding module that is described in one of the answers above.</p>\n"}], "owner": {"reputation": 1374, "user_id": 560561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6c5947ff77ff642f370d78017cf04fc?s=128&d=identicon&r=PG", "display_name": "fzerorubigd", "link": "https://stackoverflow.com/users/560561/fzerorubigd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435492930, "creation_date": 1435425416, "question_id": 31091390, "link": "https://stackoverflow.com/questions/31091390/go-websocket-nginx-proxy-is-this-correct", "title": "Go websocket, nginx proxy is this correct?", "body": "<p>I have a RESTful server in go, and it's behind nginx. everything is fine and we are happy with this setup (nginx and go) but now we have a websocket route for this application. (Its currently works ok with nginx in our staging server, not real load yet.)\nThe questions :</p>\n\n<ol>\n<li><p>Is this good for my websocket route to be behind nginx too? is there any good reason for/against this? </p></li>\n<li><p>Is there any way to bypass this route from nginx proxy and serve it directly with go? not in another subdomain or another binary.</p></li>\n</ol>\n\n<p>Thanks!</p>\n"}, {"tags": ["http", "caching", "concurrency", "go", "request"], "answers": [{"comments": [{"owner": {"reputation": 1992, "user_id": 1313897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a90642da56ff524692c54a16449a3c2e?s=128&d=identicon&r=PG", "display_name": "Feras", "link": "https://stackoverflow.com/users/1313897/feras"}, "edited": false, "score": 0, "creation_date": 1435435033, "post_id": 31091700, "comment_id": 50202286, "body": "seems pretty much the same, in my case since the request is quite heavy the locks prob won&#39;t be the bottleneck, i was just wondering if there is a good lock free way of doing it"}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 3, "last_activity_date": 1435427464, "last_edit_date": 1495542185, "creation_date": 1435427464, "answer_id": 31091700, "question_id": 31091139, "link": "https://stackoverflow.com/questions/31091139/golang-detect-in-flight-requests/31091700#31091700", "title": "Golang detect in-flight requests", "body": "<p>It reminds me of one question where someone was implementing a similar thing:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30329178/coalescing-items-in-channel\">Coalescing items in channel</a></p>\n\n<p>I gave an answer with an example of implementing such a middle layer. I think this is in line with your ideas: have a routine keeping track of requests for the same resource and prevent them from being recalculating in parallel.</p>\n\n<p>If you have a separate routine responsible for taking requests and managing access to cache, you don't need an explicit lock (there is one buried in a channel though). Anyhow, I don't know specifics of your application, but considering you need to check cache (probably locked) and (occasionally) perform an expensive calculation of missing entry \u2013 lock on map lookups doesn't seem like a massive problem to me. You can also always span more such middle layer routines if you think this would help, but you would need a deterministic way of routing the requests (so each cache entry is managed by a single routine).</p>\n\n<p>Sorry for not bringing you a silver bullet solution, but it sounds like you're on a good way of solving your problem anyway.</p>\n"}, {"comments": [{"owner": {"reputation": 1992, "user_id": 1313897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a90642da56ff524692c54a16449a3c2e?s=128&d=identicon&r=PG", "display_name": "Feras", "link": "https://stackoverflow.com/users/1313897/feras"}, "edited": false, "score": 0, "creation_date": 1435434288, "post_id": 31091884, "comment_id": 50202086, "body": "I think that&#39;s pretty much what I&#39;m suggesting, however i think your approach with that: <code>map[resourceId]chan request</code> won&#39;t work, since you need multiple channels per resourceId, since you can have multiple future requests pending on the same resourceId, and you can&#39;t broadcast to multiple subscribers via one channel, so u need a channel per subsequent request, more like: <code>map [res_id] -&gt; [slice[channels_to_notify]]</code>"}, {"owner": {"reputation": 2911, "user_id": 702065, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae529fa78546d54e42c26bd3713946a2?s=128&d=identicon&r=PG", "display_name": "Johan Wikstr&#246;m", "link": "https://stackoverflow.com/users/702065/johan-wikstr%c3%b6m"}, "reply_to_user": {"reputation": 1992, "user_id": 1313897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a90642da56ff524692c54a16449a3c2e?s=128&d=identicon&r=PG", "display_name": "Feras", "link": "https://stackoverflow.com/users/1313897/feras"}, "edited": false, "score": 0, "creation_date": 1435438269, "post_id": 31091884, "comment_id": 50203209, "body": "@Feras yes I think it will work (but I haven&#39;t tested it). The broadcasting pattern is uncommon in Go, and this is not broadcasting. The goroutine is only aware of one request at a time. For each <code>request</code> from the input channel it puts one <code>*response</code> on the output channel. Having one input channel is a feature since it acts as a thread-safe queue when you send multiple inputs at once. Making it unbuffered would block execution as you wanted. In a real application you&#39;d probably want distinct output channels  which you can get like this <code>c &lt;- request{chan1}</code>,<code>c &lt;- request{chan2}</code> etc"}, {"owner": {"reputation": 2911, "user_id": 702065, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae529fa78546d54e42c26bd3713946a2?s=128&d=identicon&r=PG", "display_name": "Johan Wikstr&#246;m", "link": "https://stackoverflow.com/users/702065/johan-wikstr%c3%b6m"}, "reply_to_user": {"reputation": 1992, "user_id": 1313897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a90642da56ff524692c54a16449a3c2e?s=128&d=identicon&r=PG", "display_name": "Feras", "link": "https://stackoverflow.com/users/1313897/feras"}, "edited": false, "score": 0, "creation_date": 1435440485, "post_id": 31091884, "comment_id": 50203810, "body": "And as a bonus, when you close the input channel the goroutine will exit cleanly and the cached <code>*response</code> will be garbage collected. Useful if you only want to keep stuff in the cache for a limited time. So most of the complexity is kept in the goroutine which means less risk of having multithreaded stuff pollute your program."}, {"owner": {"reputation": 1992, "user_id": 1313897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a90642da56ff524692c54a16449a3c2e?s=128&d=identicon&r=PG", "display_name": "Feras", "link": "https://stackoverflow.com/users/1313897/feras"}, "edited": false, "score": 0, "creation_date": 1435542141, "post_id": 31091884, "comment_id": 50228122, "body": "You are actually right, I forgot that channels have this type of behaviour and close(chan) can be used for synchronization. IE all request with same reqID wait on the channel in the map for that reqID, as soon as its closed they unblock and continue their execution fetching from cache. Much simpler and dont need to broadcast..."}], "tags": [], "owner": {"reputation": 2911, "user_id": 702065, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae529fa78546d54e42c26bd3713946a2?s=128&d=identicon&r=PG", "display_name": "Johan Wikstr&#246;m", "link": "https://stackoverflow.com/users/702065/johan-wikstr%c3%b6m"}, "is_accepted": false, "score": 2, "last_activity_date": 1435428581, "creation_date": 1435428581, "answer_id": 31091884, "question_id": 31091139, "link": "https://stackoverflow.com/questions/31091139/golang-detect-in-flight-requests/31091884#31091884", "title": "Golang detect in-flight requests", "body": "<p>Caching and perfomance problems are always tricky and you should always make a basic solution to benchmark against to ensure that your assumptions are correct. But if we know that the bottleneck is fetching the resource and that caching will give significant returns you could use Go's channels to implement queuing. Assuming that <code>response</code> is the type of your resource.</p>\n\n<pre><code>type request struct {\n     back chan *response\n}\n\nfunc main() {\n    c := make(chan request,10) // non-blocking\n    go func(input chan request){\n        var cached *response\n        for _,i := range input {\n            if cached == nil { // only make request once\n                cached = makeLongRunningRequest()\n            }\n            i.back &lt;- cached\n        }\n    }(c)\n\n    resp := make(chan *response)\n\n    c &lt;- request{resp} // cache miss\n    c &lt;- request{resp} // will get queued\n    c &lt;- request{resp} // will get queued\n\n    for _,r := range resp {\n        // do something with response\n    }\n}\n</code></pre>\n\n<p>Here we're only fetching one resource but you could start one goroutine for each resource you want to fetch. Goroutines are cheap so unless you need millions of resources cached at the same time you should be ok. You could of course also kill your goroutines after a while.</p>\n\n<p>To keep track of which resource id belongs to which channel, I'd use a map</p>\n\n<pre><code>map[resourceId]chan request\n</code></pre>\n\n<p>with a mutex. Again, if fetching the resource is the bottle neck then the cost of locking the map should be negligible. If locking the map turns out to be a problem, consider using a <a href=\"https://github.com/streamrail/concurrent-map\" rel=\"nofollow\">sharded map</a>.</p>\n\n<p>In general you seem to be well on your way. I'd advise to try to keep your design as simple as possible and use channels instead of locks when possible. They do protect from terrible concurrency bugs.</p>\n"}, {"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": false, "score": 2, "last_activity_date": 1451817470, "creation_date": 1451817470, "answer_id": 34575570, "question_id": 31091139, "link": "https://stackoverflow.com/questions/31091139/golang-detect-in-flight-requests/34575570#34575570", "title": "Golang detect in-flight requests", "body": "<p>One solution is a concurrent non-blocking cache as discussed in detail in <a href=\"http://www.informit.com/store/go-programming-language-9780134190440\" rel=\"nofollow\">The Go Programming Language</a>, chapter 9. </p>\n\n<p>The <a href=\"https://github.com/adonovan/gopl.io/blob/master/ch9/memo1/memo.go\" rel=\"nofollow\">code samples</a> are well worth a look because the authors take you through several versions (memo1, memo2, etc), illustrating problems of race conditions, using mutexes to protect maps, and a version using just channels.</p>\n\n<p>Also consider <a href=\"https://blog.golang.org/context\" rel=\"nofollow\">https://blog.golang.org/context</a> as it has similar concepts and deals with cancellation of in flight requests.</p>\n\n<p>It's impractical to copy the content into this answer, so hopefully the links are of use.</p>\n"}, {"comments": [{"owner": {"reputation": 880, "user_id": 6632214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7a11555b6759a1bd6c0205720f6dda?s=128&d=identicon&r=PG", "display_name": "TheDiveO", "link": "https://stackoverflow.com/users/6632214/thediveo"}, "edited": false, "score": 0, "creation_date": 1563216216, "post_id": 56156642, "comment_id": 100618584, "body": "Thank you very, very much for pointing out this hidden gem in the Golang x libraries!"}], "tags": [], "owner": {"reputation": 217, "user_id": 5713047, "user_type": "registered", "profile_image": "https://graph.facebook.com/511702685666241/picture?type=large", "display_name": "Abhishek Srivastava", "link": "https://stackoverflow.com/users/5713047/abhishek-srivastava"}, "is_accepted": false, "score": 1, "last_activity_date": 1557949746, "creation_date": 1557949746, "answer_id": 56156642, "question_id": 31091139, "link": "https://stackoverflow.com/questions/31091139/golang-detect-in-flight-requests/56156642#56156642", "title": "Golang detect in-flight requests", "body": "<p>This is already provided by Golang as a feature <code>single flight</code>.</p>\n\n<p>For your use case just use some extra logic on top of single flight. Consider the code snippet below:</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/github\", func(w http.ResponseWriter, r *http.Request) {\n        var key = \"facebook\"\n        var requestGroup singleflight.Group\n        // Search The Cache, if found in cache return from cache, else make single flight request\n        if res, err := searchCache(); err != nil{\n            return res\n        } \n        // Cache Miss-&gt; Make Single Flight Request, and Cache it\n        v, err, shared := requestGroup.Do(key, func() (interface{}, error) {\n            // companyStatus() returns string, error, which statifies interface{}, error, so we can return the result directly.\n            if err != nil {\n                return interface{}, err\n            }\n            return companyStatus(), nil\n        })\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        //Set the Cache Here\n        setCache(key, v)\n\n        status := v.(string)\n\n        log.Printf(\"/Company handler requst: status %q, shared result %t\", status, shared)\n\n        fmt.Fprintf(w, \"Company Status: %q\", status)\n    })\n\n    http.ListenAndServe(\"127.0.0.1:8080\", nil)\n}\n\n// companyStatus retrieves Comapny's API status\nfunc getCompanyStatus() (string, error) {\n    log.Println(\"Making request to Some API\")\n    defer log.Println(\"Request to Some API Complete\")\n\n    time.Sleep(1 * time.Second)\n\n    resp, err := http.Get(\"Get URL\")\n    if err != nil {\n        return \"\", err\n    }\n    defer resp.Body.Close()\n\n    if resp.StatusCode != 200 {\n        return \"\", fmt.Errorf(\"Upstream response: %s\", resp.Status)\n    }\n\n    r := struct{ Status string }{}\n\n    err = json.NewDecoder(resp.Body).Decode(&amp;r)\n\n    return r.Status, err\n}\n\n</code></pre>\n\n<p>I hope the code snippet is self explanatory and you can refer to <a href=\"https://godoc.org/golang.org/x/sync/singleflight\" rel=\"nofollow noreferrer\">Single Flight Official Docs</a> to delve deep into single flight.</p>\n"}], "owner": {"reputation": 1992, "user_id": 1313897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a90642da56ff524692c54a16449a3c2e?s=128&d=identicon&r=PG", "display_name": "Feras", "link": "https://stackoverflow.com/users/1313897/feras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1557949746, "creation_date": 1435423879, "last_edit_date": 1435424390, "question_id": 31091139, "link": "https://stackoverflow.com/questions/31091139/golang-detect-in-flight-requests", "title": "Golang detect in-flight requests", "body": "<p>I was wondering if there is already a library to do that or maybe a suggestion which way to go for the following problem:</p>\n\n<p>Client A makes request for resource A, this is a long running request since resource A is expensive and it results in a cache miss. In the meantime client B makes request for resource A, now it's still a cache miss since client A's request hasn't returned and populated the cache yet. so instead of making a new request to generate resource A, client B should block and be notified when client A's request is complete and has populated the cache.</p>\n\n<p>I think the group cache library has something along those lines, but I haven't been able to browse through the code to figure out how they do it, I also don't wanna tie the implementation to it and use it as a dependency.</p>\n\n<p>The only solution I had so far is a pub-sub type of thing, where we have a global map of the current in-flight requests with the reqID as a key. When req1 comes it sets its ID in the map, req2 comes and checks if its id is in the map, since its requesting the same resource it is, so we block on a notifier channel. When req1 finishes it does 3 things: </p>\n\n<ol>\n<li>evicts its ID from the map</li>\n<li>saves the entry in the cache</li>\n<li>sends a broadcast with its ID to the notifier channel\nreq2 receives the notification, unblocks and fetches from the cache.</li>\n</ol>\n\n<p>Since go doesn't have built in support for broadcasts, theres probably 1 grouting listening on the broadcast channel and then keeping a list of subscribers to broadcast to for each request, or maybe we change the map to reqId => list(broadcastChannelSubscribers). Something along those lines.</p>\n\n<p>If you think there is a better way to do it with Go's primitives, any input would be appreciated. The only piece of this solution that bothers me is this global map, surrounded by locks, I assume it quickly is going to become a bottleneck. IF you have some non-locking ideas, even if they are probabilistic Im happy to hear them.</p>\n"}, {"tags": ["go", "switch-statement"], "answers": [{"comments": [{"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1435420665, "post_id": 31090454, "comment_id": 50197849, "body": "Thanks for the quote. Then I understood <code>fallthrough</code> firstly wrong. In <a href=\"https://play.golang.org/p/aZg0Qv8Ull\" rel=\"nofollow noreferrer\">this</a> code example I created a simple scenario were each person should guess the integer. Both Alice and Dan are right. Without <code>fallthrough</code> the script only prints Alice as the winner and Bob&#39;s case isn&#39;t checked. I expected, that <code>fallthrough</code> searches for other matches and only executes those instead of all. Is there a way to find more than one match in a switch statement without using a for loop?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1435424281, "post_id": 31090454, "comment_id": 50198955, "body": "@user3147268: No. However, a <code>switch</code> statement is special, limited form of <code>if</code> statements. Use <code>if</code> statements, for example, <a href=\"https://play.golang.org/p/l7NIEdP_Ic\" rel=\"nofollow noreferrer\">play.golang.org/p/l7NIEdP_Ic</a>"}, {"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1435427023, "post_id": 31090454, "comment_id": 50199774, "body": "Ironically is that the reason, why programmers use switch, in order to avoid the if-else clutter."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1435420223, "last_edit_date": 1435420223, "creation_date": 1435419549, "answer_id": 31090454, "question_id": 31090405, "link": "https://stackoverflow.com/questions/31090405/behavior-of-falltrough-in-switch-statement/31090454#31090454", "title": "Behavior of falltrough in switch statement", "body": "<blockquote>\n  <p><a href=\"http://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"http://golang.org/ref/spec#Switch_statements\" rel=\"nofollow\">Switch statements</a></p>\n  \n  <p>Expression switches</p>\n  \n  <p>In an expression switch, the switch expression is evaluated and the\n  case expressions, which need not be constants, are evaluated\n  left-to-right and top-to-bottom; the first one that equals the switch\n  expression triggers execution of the statements of the associated\n  case; the other cases are skipped. If no case matches and there is a\n  \"default\" case, its statements are executed. There can be at most one\n  default case and it may appear anywhere in the \"switch\" statement. A\n  missing switch expression is equivalent to the boolean value true.</p>\n\n<pre><code>ExprSwitchStmt = \"switch\" [ SimpleStmt \";\" ] [ Expression ] \"{\" { ExprCaseClause } \"}\" .\nExprCaseClause = ExprSwitchCase \":\" StatementList .\nExprSwitchCase = \"case\" ExpressionList | \"default\" .\n</code></pre>\n  \n  <p>In a case or default clause, the last non-empty statement may be a\n  (possibly labeled) \"fallthrough\" statement to indicate that control\n  should flow from the end of this clause to the first statement of the\n  next clause. Otherwise control flows to the end of the \"switch\"\n  statement. A \"fallthrough\" statement may appear as the last statement\n  of all but the last clause of an expression switch.</p>\n  \n  <p>The expression may be preceded by a simple statement, which executes\n  before the expression is evaluated.</p>\n</blockquote>\n\n<p>Evaluate case expressions top-to-bottom. <code>case 4</code> and <code>case 5</code> are <code>false</code>, <code>case 6</code> is <code>true</code>. <code>case 7</code>, <code>case 8</code>, and <code>default</code> are <code>false</code> but execute by flowing to the next clause via <code>fallthrough</code>.</p>\n"}], "owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 1, "accepted_answer_id": 31090454, "answer_count": 1, "score": -1, "last_activity_date": 1435420743, "creation_date": 1435419234, "last_edit_date": 1435420743, "question_id": 31090405, "link": "https://stackoverflow.com/questions/31090405/behavior-of-falltrough-in-switch-statement", "title": "Behavior of falltrough in switch statement", "body": "<p>I was reading a section of <a href=\"http://golangtutorials.blogspot.de/2011/06/control-structures-go-switch-case.html\" rel=\"nofollow\">this book</a> about the switch statement in Go. But this example confused me:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code> package main\n\n import \"fmt\"\n\n func main() {\n k := 6\n switch k {\n    case 4: fmt.Println(\"was &lt;= 4\"); fallthrough;\n    case 5: fmt.Println(\"was &lt;= 5\"); fallthrough;\n    case 6: fmt.Println(\"was &lt;= 6\"); fallthrough;\n    case 7: fmt.Println(\"was &lt;= 7\"); fallthrough;\n    case 8: fmt.Println(\"was &lt;= 8\"); fallthrough;\n    default: fmt.Println(\"default case\") \n    }\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>was &lt;= 6\nwas &lt;= 7\nwas &lt;= 8\ndefault case\n</code></pre>\n\n<p>And the book points out:</p>\n\n<blockquote>\n  <p>use the fallthrough statement to indicate that the case block following the current one has to be executed.</p>\n</blockquote>\n\n<p>Now I've to questions:</p>\n\n<ol>\n<li>Why does Go compare by default, in which case k is lower?</li>\n<li>The text mentions that the following cases are executed. Fine. But why aren't they only executed of the case matches k?</li>\n</ol>\n"}, {"tags": ["go", "println", "gofmt"], "comments": [{"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 4, "creation_date": 1435417212, "post_id": 31090022, "comment_id": 50196779, "body": "Why are you interested in using <code>println()</code>? This is not a formal part of the language spec and can disappear in the future. See: <a href=\"http://golang.org/ref/spec#Bootstrapping\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Bootstrapping</a>"}, {"owner": {"reputation": 830, "user_id": 2825080, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fe2698c9758371bed6eb355f888a391c?s=128&d=identicon&r=PG&f=1", "display_name": "koljanep", "link": "https://stackoverflow.com/users/2825080/koljanep"}, "edited": false, "score": 0, "creation_date": 1435417500, "post_id": 31090022, "comment_id": 50196864, "body": "Why is there a semicolon after <code>println(&quot;a&quot;)</code>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 830, "user_id": 2825080, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fe2698c9758371bed6eb355f888a391c?s=128&d=identicon&r=PG&f=1", "display_name": "koljanep", "link": "https://stackoverflow.com/users/2825080/koljanep"}, "edited": false, "score": 0, "creation_date": 1435418207, "post_id": 31090022, "comment_id": 50197078, "body": "@koljanep: The semicolon is not relevant to the question: <a href=\"http://golang.org/ref/spec#Semicolons\" rel=\"nofollow noreferrer\">Semicolons</a>."}], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 4, "creation_date": 1435418493, "post_id": 31090204, "comment_id": 50197167, "body": "To add color to this, standard error and standard out are two different output streams.  There is no guarantee as to the order they are displayed to your terminal.  If you chants fmt.Println to fmt.Fprintln(os.StdErr,&quot;b&quot;) then they will interleve as you expect"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1435418741, "post_id": 31090204, "comment_id": 50197262, "body": "This comment is the important part of the answer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1435418510, "last_edit_date": 1435418510, "creation_date": 1435418013, "answer_id": 31090204, "question_id": 31090022, "link": "https://stackoverflow.com/questions/31090022/need-help-while-tesing-println-and-fmt-println-of-golang/31090204#31090204", "title": "need help while tesing println and fmt.println of golang", "body": "<blockquote>\n  <p><a href=\"http://golang.org/pkg/builtin/\" rel=\"nofollow\">Builtin functions</a></p>\n  \n  <p><a href=\"http://golang.org/pkg/builtin/#println\" rel=\"nofollow\">func println</a></p>\n\n<pre><code>func println(args ...Type)\n</code></pre>\n  \n  <p>The println built-in function formats its arguments in an\n  implementation- specific way and writes the result to standard error.\n  Spaces are always added between arguments and a newline is appended.\n  Println is useful for bootstrapping and debugging; it is not\n  guaranteed to stay in the language. </p>\n  \n  <p><a href=\"http://golang.org/pkg/fmt/\" rel=\"nofollow\">Package fmt</a></p>\n  \n  <p><a href=\"http://golang.org/pkg/fmt/#Println\" rel=\"nofollow\">func Println</a></p>\n  \n  <p><code>func Println(a ...interface{}) (n int, err error)</code></p>\n  \n  <p>Println formats using the default formats for its operands and writes\n  to standard output. Spaces are always added between operands and a\n  newline is appended. It returns the number of bytes written and any\n  write error encountered.</p>\n</blockquote>\n\n<p><code>fmt.Println()</code> uses <code>stdout</code>; <code>println()</code> uses <code>stderr</code>.</p>\n\n<p>As expected, two different functions with different purposes give different results.</p>\n"}, {"tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": false, "score": 2, "last_activity_date": 1435419031, "creation_date": 1435419031, "answer_id": 31090371, "question_id": 31090022, "link": "https://stackoverflow.com/questions/31090022/need-help-while-tesing-println-and-fmt-println-of-golang/31090371#31090371", "title": "need help while tesing println and fmt.println of golang", "body": "<p>Best practice: only use <code>fmt.Println(\"My text...\")</code></p>\n\n<p>Do not use <code>println(\"My text...\")</code></p>\n"}], "owner": {"reputation": 45, "user_id": 1180696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a378c2ca728750b0c62218e8a166fa?s=128&d=identicon&r=PG", "display_name": "sillydong", "link": "https://stackoverflow.com/users/1180696/sillydong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 1, "accepted_answer_id": 31090204, "answer_count": 2, "score": 0, "last_activity_date": 1435454029, "creation_date": 1435416840, "last_edit_date": 1435454029, "question_id": 31090022, "link": "https://stackoverflow.com/questions/31090022/need-help-while-tesing-println-and-fmt-println-of-golang", "title": "need help while tesing println and fmt.println of golang", "body": "<p>I wrote simple codes to test println and fmt.Println, but when I ran the code, it printed different results almost everytime. I tried to google the difference between println and fmt.Println but got nothing. Is there any one who knows the real difference or the priority or the sequence of those two function?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n)\n\nfunc main(){\n    println(\"a\")\n    fmt.Println(\"b\")\n    println(\"c\")\n    fmt.Println(\"d\")\n\n    p()\n}\n\nfunc p(){\n    println(\"e\")\n    fmt.Println(\"f\")\n    println(\"g\")\n    fmt.Println(\"h\")\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "polymer"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1435407638, "post_id": 31088570, "comment_id": 50194195, "body": "Have to tried installing the dependencies?"}, {"owner": {"reputation": 621, "user_id": 3927379, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4057b6eaa9009f79452bfe2749c6a48e?s=128&d=identicon&r=PG&f=1", "display_name": "Ana F", "link": "https://stackoverflow.com/users/3927379/ana-f"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435407999, "post_id": 31088570, "comment_id": 50194277, "body": "I did an npm install, but I didnt install any go dependencies. How do you install those? I never used go before so I&#39;m pretty lost here"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1435408229, "post_id": 31088570, "comment_id": 50194337, "body": "It is <code>go get full&#47;package&#47;name</code> for all your missing dependencies, e.g. golang.org/x/net/context"}, {"owner": {"reputation": 621, "user_id": 3927379, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4057b6eaa9009f79452bfe2749c6a48e?s=128&d=identicon&r=PG&f=1", "display_name": "Ana F", "link": "https://stackoverflow.com/users/3927379/ana-f"}, "edited": false, "score": 0, "creation_date": 1435408963, "post_id": 31088570, "comment_id": 50194523, "body": "Thank you so much! :) I had somehow completely missed that I&#39;m supposed to get the dependencies myself and was completely stuck"}], "owner": {"reputation": 621, "user_id": 3927379, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4057b6eaa9009f79452bfe2749c6a48e?s=128&d=identicon&r=PG&f=1", "display_name": "Ana F", "link": "https://stackoverflow.com/users/3927379/ana-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459470541, "creation_date": 1435406893, "last_edit_date": 1459470541, "question_id": 31088570, "link": "https://stackoverflow.com/questions/31088570/failing-to-gulp-serve-on-ioweb2015-clone", "title": "Failing to gulp serve on ioweb2015 clone", "body": "<p>I cloned the <a href=\"https://github.com/GoogleChrome/ioweb2015\" rel=\"nofollow\">ioweb2015 git repository</a> and then tried to build it. But I can't get gulp serve to work. \nIt fails with</p>\n\n<pre><code> Starting 'sass'...\njwt.go:28:2: cannot find package \"github.com/dgrijalva/jwt-go\" in any of:\n    /usr/lib/go/src/github.com/dgrijalva/jwt-go (from $GOROOT)\n    /home/ana/woop/ioweb2015/src/github.com/dgrijalva/jwt-go (from $GOPATH)\nasync.go:23:2: cannot find package \"golang.org/x/net/context\" in any of:\n    /usr/lib/go/src/golang.org/x/net/context (from $GOROOT)\n    /home/ana/woop/ioweb2015/src/golang.org/x/net/context (from $GOPATH)\nauth.go:30:2: cannot find package \"golang.org/x/oauth2\" in any of:\n    /usr/lib/go/src/golang.org/x/oauth2 (from $GOROOT)\n    /home/ana/woop/ioweb2015/src/golang.org/x/oauth2 (from $GOPATH)\nauth.go:31:2: cannot find package \"golang.org/x/oauth2/jwt\" in any of:\n    /usr/lib/go/src/golang.org/x/oauth2/jwt (from $GOROOT)\n    /home/ana/woop/ioweb2015/src/golang.org/x/oauth2/jwt (from $GOPATH)\n</code></pre>\n\n<p>I'm on Ubuntu, and I installed go 1.4.2.  Go env looks like this: </p>\n\n<pre><code>GOARCH=\"386\"\nGOBIN=\"\"\nGOCHAR=\"8\"\nGOEXE=\"\"\nGOHOSTARCH=\"386\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/ana/woop/ioweb2015\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go\"\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_386\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m32 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>So, any ideas on this? </p>\n"}, {"tags": ["heroku", "web", "go", "server", "web-deployment"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1435404102, "post_id": 31088111, "comment_id": 50193242, "body": "Can you post your Go code? Does your app provide any logs via <code>heroku log --source app</code> at all? Based on the output above all we can see is the crash, not the reason."}, {"owner": {"reputation": 78, "user_id": 3502049, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3f8395910f46e92552edff6fc2681735?s=128&d=identicon&r=PG&f=1", "display_name": "KrithGhosh", "link": "https://stackoverflow.com/users/3502049/krithghosh"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435420155, "post_id": 31088111, "comment_id": 50197699, "body": "@elithrar Hi I have updated the code .."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435454490, "post_id": 31088111, "comment_id": 50206763, "body": "PS: You should reset your MongoDB credentials\u2014you appear to have pasted them with your code. A lesson to use config files or environmental variables to store sensitive config\u2014not in your source!"}], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 5, "last_activity_date": 1435448046, "creation_date": 1435448046, "answer_id": 31094627, "question_id": 31088111, "link": "https://stackoverflow.com/questions/31088111/facing-issue-after-deploying-go-app-on-heroku/31094627#31094627", "title": "Facing issue after deploying Go app on Heroku", "body": "<p>Heroku dynos <a href=\"https://devcenter.heroku.com/articles/dynos#network-interfaces\" rel=\"noreferrer\">dynamically assign a port</a>. It's likely your application is crashing because it can't bind to port 8080.</p>\n\n<p>Change this line:</p>\n\n<pre><code>log.Fatal(http.ListenAndServe(\":8080\", router))\n</code></pre>\n\n<p>... to this:</p>\n\n<pre><code>    port := \":\" + os.Getenv(\"PORT\")\n    log.Fatal(http.ListenAndServe(port, router))\n</code></pre>\n"}], "owner": {"reputation": 78, "user_id": 3502049, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3f8395910f46e92552edff6fc2681735?s=128&d=identicon&r=PG&f=1", "display_name": "KrithGhosh", "link": "https://stackoverflow.com/users/3502049/krithghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 1, "accepted_answer_id": 31094627, "answer_count": 1, "score": 2, "last_activity_date": 1435470665, "creation_date": 1435403591, "last_edit_date": 1435470665, "question_id": 31088111, "link": "https://stackoverflow.com/questions/31088111/facing-issue-after-deploying-go-app-on-heroku", "title": "Facing issue after deploying Go app on Heroku", "body": "<p>I have deployed the Go App on Heroku but on hitting the url.. its not giving proper response. The Heroku logs looks something like this : </p>\n\n<pre><code>2015-06-27T10:43:06.839094+00:00 heroku[web.1]: Starting process with command `FlickrImage`\n2015-06-27T10:43:08.998400+00:00 heroku[web.1]: State changed from starting to crashed\n2015-06-27T10:43:08.998400+00:00 heroku[web.1]: State changed from crashed to starting\n2015-06-27T10:43:08.985737+00:00 heroku[web.1]: Process exited with status 0\n2015-06-27T10:43:10.795684+00:00 heroku[web.1]: Starting process with command `FlickrImage`\n2015-06-27T10:43:13.837301+00:00 heroku[web.1]: Process exited with status 0\n2015-06-27T10:43:13.850141+00:00 heroku[web.1]: State changed from starting to crashed\n2015-06-27T10:44:41.914412+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/Index\" host=morning-ridge-1365.herokuapp.com request_id=89d2e794-a725-4ddf-b437-dbcbd988428c fwd=\"202.12.83.44\" dyno= connect= service= status=503 bytes=\n</code></pre>\n\n<p>FlickrImage is my go file and I have created a Procfile which contains \"web: FlickrImage\"</p>\n\n<p>EDIT :\nFlickrImageServer Code :</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"reflect\"\n    \"strconv\"\n    \"strings\"\n\n    \"github.com/gorilla/mux\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\ntype imageLinks struct {\n    Link     string `bson:\"link\"`\n    Upvote   int    `bson:\"upvote\"`\n    Downvote int    `bson:\"downvote\"`\n}\n\ntype Result struct {\n    Photos struct {\n        Page    int    `json: \"page\"`\n        Pages   int    `json: \"pages\"`\n        PerPage int    `json: \"perpage\"`\n        Total   string `json: \"total\"`\n        Photo   []struct {\n            Id       string `json: \"id\"`\n            Owner    string `json: \"owner\"`\n            Secret   string `json: \"secret\"`\n            Server   string `json: \"server\"`\n            Farm     int    `json: \"farm\"`\n            Title    string `json: \"title\"`\n            IsPublic int    `json: \"ispublic\"`\n            IsFriend int    `json: \"isfriend\"`\n            IsFamily int    `json: \"isfamily`\n        } `json: \"photo\"`\n    } `json: \"photos\"`\n    Stat string `json: \"stat\"`\n}\n\nfunc main() {\n\n    router := mux.NewRouter().StrictSlash(true)\n    router.HandleFunc(\"/Index\", Index)\n    router.HandleFunc(\"/UpVote\", UpVoteRoute)\n    router.HandleFunc(\"/DownVote\", DownVoteRoute)\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n\nfunc UpVoteRoute(w http.ResponseWriter, r *http.Request) {\n\n    link := r.URL.Query().Get(\"imagelink\")\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    session, err := mgo.Dial(\"mongodb://&lt;user&gt;:&lt;password&gt;@ds061631.mongolab.com:61631/flickrimagedb\")\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    }\n    defer session.Close()\n\n    session.SetMode(mgo.Monotonic, true)\n    c := session.DB(\"flickrimagedb\").C(\"image_links_votes\")\n\n    err = c.Update(bson.M{\"link\": link}, bson.M{\"$inc\": bson.M{\"upvote\": 1}})\n    if err != nil {\n        fmt.Printf(\"Can't update document %v\\n\", err)\n        os.Exit(1)\n    }\n}\n\nfunc DownVoteRoute(w http.ResponseWriter, r *http.Request) {\n\n    link := r.URL.Query().Get(\"imagelink\")\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    session, err := mgo.Dial(\"mongodb://*********:*******@ds061631.mongolab.com:61631/flickrimagedb\")\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    }\n    defer session.Close()\n\n    session.SetMode(mgo.Monotonic, true)\n    c := session.DB(\"flickrimagedb\").C(\"image_links_votes\")\n\n    err = c.Update(bson.M{\"link\": link}, bson.M{\"$inc\": bson.M{\"downvote\": 1}})\n    if err != nil {\n        fmt.Printf(\"Can't update document %v\\n\", err)\n        os.Exit(1)\n    }\n}\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    session, err := mgo.Dial(\"mongodb://*********:*********@ds061631.mongolab.com:61631/flickrimagedb\")\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n        os.Exit(1)\n    }\n\n    defer session.Close()\n\n    session.SetMode(mgo.Monotonic, true)\n    c := session.DB(\"flickrimagedb\").C(\"image_links_votes\")\n\n    checkResult := &amp;imageLinks{}\n    // Create a slice to begin with\n    myType := reflect.TypeOf(checkResult)\n    slice := reflect.MakeSlice(reflect.SliceOf(myType), 10, 10)\n    // Create a pointer to a slice value and set it to the slice\n    x := reflect.New(slice.Type())\n    x.Elem().Set(slice)\n    err = c.Find(bson.M{}).All(x.Interface())\n    if err != nil {\n        response, err := json.Marshal(x.Interface())\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(2)\n        }\n        fmt.Fprintf(w, string(response))\n    } else {\n        url := \"https://api.flickr.com/services/rest/?method=flickr.photos.search&amp;api_key=*****************************&amp;text=cute+puppies&amp;per_page=12&amp;format=json&amp;nojsoncallback=1\"\n        res, err := http.Get(url)\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(3)\n        }\n        body, err := ioutil.ReadAll(res.Body)\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(4)\n        }\n\n        jsonData := &amp;Result{}\n        err = json.Unmarshal(body, jsonData)\n\n        for value := range jsonData.Photos.Photo {\n            s1 := []string{\"https://farm\", \".staticflickr.com/\"}\n            s2 := []string{strings.Join(s1, strconv.Itoa(jsonData.Photos.Photo[value].Farm)), \"/\"}\n            s3 := []string{strings.Join(s2, jsonData.Photos.Photo[value].Server), \"_\"}\n            s4 := []string{strings.Join(s3, jsonData.Photos.Photo[value].Id), \".jpg\"}\n            s := strings.Join(s4, jsonData.Photos.Photo[value].Secret)\n            singleReuslt := imageLinks{}\n            err = c.Find(bson.M{\"link\": s}).One(&amp;singleReuslt)\n            if err != nil {\n                err = c.Insert(&amp;imageLinks{Link: s, Upvote: 0, Downvote: 0})\n                if err != nil {\n                    fmt.Printf(\"%s\", err)\n                    os.Exit(5)\n                }\n            }\n        }\n\n        allResult := &amp;imageLinks{}\n        // Create a slice to begin with\n        myType := reflect.TypeOf(allResult)\n        slice := reflect.MakeSlice(reflect.SliceOf(myType), 10, 10)\n        // Create a pointer to a slice value and set it to the slice\n        x := reflect.New(slice.Type())\n        x.Elem().Set(slice)\n        err = c.Find(bson.M{}).All(x.Interface())\n        response, err := json.Marshal(x.Interface())\n        if err != nil {\n            fmt.Printf(\"%s\", err)\n            os.Exit(6)\n        }\n        fmt.Fprintf(w, string(response))\n    }\n}\n</code></pre>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1435396425, "creation_date": 1435396425, "answer_id": 31087083, "question_id": 31087015, "link": "https://stackoverflow.com/questions/31087015/buffered-channel-worker-panics/31087083#31087083", "title": "Buffered channel worker panics", "body": "<p>The problem is that you have a value receiver in your reset function which means that <code>s</code> will be copied and you don't see the effects on your <code>t</code> variable in the loop.</p>\n\n<p>To fix that, make it a pointer receiver:</p>\n\n<pre><code>func (s *T) reset() {\n    close(s.ch)\n    s.ch = make(chan int, 2)\n}\n</code></pre>\n\n<p>For more info on this topic see <a href=\"https://golang.org/doc/effective_go.html#methods\" rel=\"nofollow\">Effective Go</a>.</p>\n"}], "owner": {"reputation": 166, "user_id": 4655777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8a0f4579bd4de4ad1e1e1abf555759?s=128&d=identicon&r=PG", "display_name": "stonith", "link": "https://stackoverflow.com/users/4655777/stonith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 31087083, "answer_count": 1, "score": 1, "last_activity_date": 1435426733, "creation_date": 1435395913, "last_edit_date": 1435426733, "question_id": 31087015, "link": "https://stackoverflow.com/questions/31087015/buffered-channel-worker-panics", "title": "Buffered channel worker panics", "body": "<p>I wrote a little worker queue using buffered channels.\nI want to have the ability to \"restart\" this worker.</p>\n\n<p>But when I do so I get a panic saying \"panic: close of closed channel\".</p>\n\n<p>Actually I don't understand why its a closed channel because it shouldn't be closed any more after the make.</p>\n\n<p>Here is the example code (<a href=\"http://play.golang.org/p/nLvNiMaOoA\" rel=\"nofollow\">http://play.golang.org/p/nLvNiMaOoA</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype T struct {\n    ch chan int\n}\n\nfunc (s T) reset() {\n    close(s.ch)\n    s.ch = make(chan int, 2)\n}\n\nfunc (s T) wrk() {\n    for i := range s.ch {\n        fmt.Println(i)\n    }\n    fmt.Println(\"close\")\n}\n\nfunc main() {\n    t := T{make(chan int, 2)}\n    for {\n        go t.wrk()\n        time.Sleep(time.Second)\n        t.reset()\n    }\n}\n</code></pre>\n\n<p>Can you tell me what I'm doing wrong there?</p>\n"}, {"tags": ["mongodb", "go", "routing"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1435399718, "post_id": 31086315, "comment_id": 50192071, "body": "You may not want to split these files into individual packages. Go&#39;s packages are meant to be reusable libraries (often stand alone). Don&#39;t think of them as means for namespace isolation."}, {"owner": {"reputation": 41, "user_id": 5055435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db8f2593ec0e3966cc337e4c67d583a?s=128&d=identicon&r=PG&f=1", "display_name": "Abdul Rehman Yousaf", "link": "https://stackoverflow.com/users/5055435/abdul-rehman-yousaf"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1435421118, "post_id": 31086315, "comment_id": 50198023, "body": "That&#39;s mean i can&#39;t define routes in a separate file and use them in another file?"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1435514565, "post_id": 31086315, "comment_id": 50220996, "body": "You can of course define them in a different file, just don&#39;t try to define them  in a different &quot;package&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 884, "user_id": 6651080, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EY45JeKlPi8/AAAAAAAAAAI/AAAAAAAAG8I/5bwaHIx2IoQ/photo.jpg?sz=128", "display_name": "Dzintars", "link": "https://stackoverflow.com/users/6651080/dzintars"}, "is_accepted": false, "score": 1, "last_activity_date": 1528829965, "creation_date": 1528829965, "answer_id": 50824075, "question_id": 31086315, "link": "https://stackoverflow.com/questions/31086315/split-routes-into-separate-package-in-golang-and-mongodb/50824075#50824075", "title": "split routes into separate package in Golang and MongoDB", "body": "<p>Not an programming expert but this is how I manage my routes/handlers.</p>\n\n<p>routes/routes.go</p>\n\n<pre><code>package routes\n\nimport (\n    \"github.com/gorilla/mux\"\n)\n\n//NewRouter is main routing entry point\nfunc NewRouter() *mux.Router {\n    r := mux.NewRouter()\n\n    indexHandler(r)  // Index handler\n    fileServer(r) // Fileserver to serve static files\n    otherLogicalHandler(r) // Other domain/business logic scoped handler\n\n    return r\n}\n</code></pre>\n\n<p>routes/indexHandler.go</p>\n\n<pre><code>package routes\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n    \"github.com/myusername/project/models\"\n)\n\nfunc indexHandler(r *mux.Router) {\n    r.HandleFunc(\"/\", indexMainHandler).Methods(\"GET\")\n    // Other endpoints goes there if you want to list it in this current indexHandler.go file\n    // Example: r.HandleFunc(\"/signup\", signupMainHandler).Methods(\"GET\")\n}\n\n// Handlers\n\nfunc indexMainHandler(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/html; charset=UTF-8\")\n\n    // Call your model/s there\n    mydata, err := models.GetMyDataFunction()\n    if err != nil {\n        // Handle your error there\n        return\n    }\n\n    utils.ExecuteTemplate(w, \"index.html\", struct {\n        Title                 string\n        // Use your model data for templates there\n        MyData             []models.MyData\n        // Other models/data can go there if multiple data objects used per page.\n    }{\n        Title: \"Main Page\",\n        MyData:             mydata,\n    })\n}\n\n// func signupMainHandler(w http.ResponseWriter, r *http.Request) ...\n// Basically repeat the same logic as in indexMainHandler function\n</code></pre>\n\n<p>routes/fileServer.go</p>\n\n<pre><code>package routes\n\nimport (\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n)\n\nfunc fileServer(r *mux.Router) {\n    fs := http.FileServer(http.Dir(\"static\"))\n    r.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", fs))\n}\n</code></pre>\n\n<p>routes/otherLogicalHandler.go</p>\n\n<p>... and so on.</p>\n\n<p>As you can see, all they belong to <code>package routes</code> but are divided into multiple files. File names doesn't actually matter. You can name them as you want.\nModels lives in <code>models</code> directory and also belongs to single <code>package models</code> package.\nEvery time you create new routes file, remember to call it in <code>routes.go</code> file.</p>\n\n<p>Hope this will help for somebody.</p>\n"}], "owner": {"reputation": 41, "user_id": 5055435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db8f2593ec0e3966cc337e4c67d583a?s=128&d=identicon&r=PG&f=1", "display_name": "Abdul Rehman Yousaf", "link": "https://stackoverflow.com/users/5055435/abdul-rehman-yousaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2346, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1528829965, "creation_date": 1435390405, "last_edit_date": 1435392534, "question_id": 31086315, "link": "https://stackoverflow.com/questions/31086315/split-routes-into-separate-package-in-golang-and-mongodb", "title": "split routes into separate package in Golang and MongoDB", "body": "<p>I'm new to Golang, i have been created an api in Golang and MongoDB.\nAfter a hard struggle successfully separate the controller and model packages ,Now i want to define routes in a separate package of routers and access them in main package same like controllers and models.I'm using gorilla/mux package for routing.Anyone can help me please, thanks in Advance!<br>\nand here is all of my code:</p>\n\n<p>RESTMONGOMVC/main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"RESTMONGOMVC/controllers\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/gorilla/mux\"\n\n    \"gopkg.in/mgo.v2\"\n)\n\nvar (\n    session    *mgo.Session\n    collection *mgo.Collection\n    err        error\n)\n\nfunc getSession() *mgo.Session {\n    // Connect to our local mongo\n    s, err := mgo.Dial(\"mongodb://localhost\")\n\n    // Check if connection error, is mongo running?\n    if err != nil {\n        panic(err)\n    }\n\n    // Deliver session\n    return s\n}\nfunc main() {\n    var err error\n    r := mux.NewRouter()\n    uc := controllers.NewNoteController(getSession())\n    r.HandleFunc(\"/api/notes\", uc.GetNotes).Methods(\"GET\")\n    r.HandleFunc(\"/api/notes\", uc.CreateNote).Methods(\"POST\")\n    r.HandleFunc(\"/api/notes/{id}\", uc.UpdateNote).Methods(\"PUT\")\n    r.HandleFunc(\"/api/notes/{id}\", uc.DeleteNote).Methods(\"DELETE\")\n    http.Handle(\"/api/\", r)\n    http.Handle(\"/\", http.FileServer(http.Dir(\".\")))\n    log.Println(\"Starting Mongodb Session\")\n    session, err = mgo.Dial(\"localhost\")\n    if err != nil {\n        panic(err)\n    }\n    defer session.Close()\n    session.SetMode(mgo.Monotonic, true)\n    collection = session.DB(\"notesdb\").C(\"notes\")\n    log.Println(\"Listening on 8080\")\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>controllers/note.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"RESTMONGOMVC/models\"\n    \"encoding/json\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/gorilla/mux\"\n\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\nvar (\n    session    *mgo.Session\n    collection *mgo.Collection\n    err        error\n)\n\ntype (\n    // UserController represents the controller for operating on the User resource\n    NoteController struct {\n        session *mgo.Session\n    }\n)\n\n// NewUserController provides a reference to a UserController with provided mongo session\nfunc NewNoteController(s *mgo.Session) *NoteController {\n    return &amp;NoteController{s}\n}\nfunc (uc NoteController) GetNotes(w http.ResponseWriter, r *http.Request) {\n    var notes []models.Note\n    iter := collection.Find(nil).Iter()\n    result := models.Note{}\n    for iter.Next(&amp;result) {\n        notes = append(notes, result)\n    }\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    j, err := json.Marshal(models.NotesResource{Notes: notes})\n    if err != nil {\n        panic(err)\n    }\n    w.Write(j)\n}\n\nfunc (uc NoteController) CreateNote(w http.ResponseWriter, r *http.Request) {\n    var noteResource models.NoteResource\n\n    err := json.NewDecoder(r.Body).Decode(&amp;noteResource)\n    if err != nil {\n        panic(err)\n    }\n    note := noteResource.Note\n    //get a new Id\n    obj_id := bson.NewObjectId()\n    note.Id = obj_id\n    note.CreatedOn = time.Now()\n    //Insert into document collection\n    err = collection.Insert(&amp;note)\n    if err != nil {\n        panic(err)\n    } else {\n        log.Printf(\"Inserted New Record with Title :%s\", note.Title)\n    }\n    j, err := json.Marshal(models.NoteResource{Note: note})\n    if err != nil {\n        panic(err)\n    }\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.Write(j)\n}\n\nfunc (uc NoteController) UpdateNote(w http.ResponseWriter, r *http.Request) {\n    var err error\n    //get id from incoming url\n    vars := mux.Vars(r)\n    id := bson.ObjectIdHex(vars[\"id\"])\n    //decode the incoming Note into json\n    var noteResource models.NoteResource\n    err = json.NewDecoder(r.Body).Decode(&amp;noteResource)\n    if err != nil {\n        panic(err)\n    }\n    //partial update on mongodb\n    err = collection.Update(bson.M{\"_id\": id},\n        bson.M{\"$set\": bson.M{\n            \"title\":      noteResource.Note.Title,\n            \"decription\": noteResource.Note.Description,\n        }})\n    if err == nil {\n        log.Printf(\"Updated Note : %s\", id, noteResource.Note.Title)\n    } else {\n        panic(err)\n    }\n    w.WriteHeader(http.StatusNoContent)\n}\nfunc (uc NoteController) DeleteNote(w http.ResponseWriter, r *http.Request) {\n    var err error\n    vars := mux.Vars(r)\n    id := vars[\"id\"]\n    //Remove from database\n    err = collection.Remove(bson.M{\"_id\": bson.ObjectIdHex(id)})\n    if err != nil {\n        log.Printf(\"Could not find the Note %s to delete\", id)\n    }\n    w.WriteHeader(http.StatusNoContent)\n}\n</code></pre>\n\n<p>models/note.go</p>\n\n<pre><code>package models \n import ( \n    \"time\" \n    \"gopkg.in/mgo.v2/bson\" \n  ) \n type Note struct { \n    Id          bson.ObjectId `bson:\"_id\" json:\"id\"` \n    Title       string        `json:\"title\"` \n    Description string        `json:\"description\"` \n    CreatedOn   time.Time     `json:\"craetedOn\"` \n } \n type NoteResource struct { \n    Note Note `json:\"note\"` \n } \n type NotesResource struct { \n    Notes []Note `json:\"notes\"` \n } \n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 4469122, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-4thRLUf3oUg/AAAAAAAAAAI/AAAAAAAABIk/-ICT6ma-GQs/photo.jpg?sz=128", "display_name": "RISHI KHANNA", "link": "https://stackoverflow.com/users/4469122/rishi-khanna"}, "edited": false, "score": 0, "creation_date": 1435393874, "post_id": 31086663, "comment_id": 50190615, "body": "But I could not understand the logic.. the meaning the this particular code string([]rune(word)[0])"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 311, "user_id": 4469122, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-4thRLUf3oUg/AAAAAAAAAAI/AAAAAAAABIk/-ICT6ma-GQs/photo.jpg?sz=128", "display_name": "RISHI KHANNA", "link": "https://stackoverflow.com/users/4469122/rishi-khanna"}, "edited": false, "score": 0, "creation_date": 1435394250, "post_id": 31086663, "comment_id": 50190688, "body": "@RISHIKHANNA Which specific part do you not understand?"}, {"owner": {"reputation": 311, "user_id": 4469122, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-4thRLUf3oUg/AAAAAAAAAAI/AAAAAAAABIk/-ICT6ma-GQs/photo.jpg?sz=128", "display_name": "RISHI KHANNA", "link": "https://stackoverflow.com/users/4469122/rishi-khanna"}, "edited": false, "score": 0, "creation_date": 1435394764, "post_id": 31086663, "comment_id": 50190821, "body": "string([]rune(word)[0])"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 311, "user_id": 4469122, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-4thRLUf3oUg/AAAAAAAAAAI/AAAAAAAABIk/-ICT6ma-GQs/photo.jpg?sz=128", "display_name": "RISHI KHANNA", "link": "https://stackoverflow.com/users/4469122/rishi-khanna"}, "edited": false, "score": 0, "creation_date": 1435394852, "post_id": 31086663, "comment_id": 50190840, "body": "@RISHIKHANNA I see, it&#39;s the way how to access individual characters of a string in Go. For more information check <a href=\"http://stackoverflow.com/q/15018545/893693\">this</a> question and the links it leads to."}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1435430551, "post_id": 31086663, "comment_id": 50200924, "body": "You actually don&#39;t need to convert to an array or runes before converting to a string"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1435430647, "post_id": 31086663, "comment_id": 50200957, "body": "@openwonk Did you check the comment to your answer?"}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1435452671, "post_id": 31086663, "comment_id": 50206442, "body": "That&#39;s fair.  I don&#39;t often have to think of acronyms in non-ASCII terms... See updated answer and comments in code.  I&#39;d still recommend applying <code>strings.Title(&quot;...&quot;)</code> to ensure capitalization."}], "tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 5, "last_activity_date": 1435393874, "last_edit_date": 1435393874, "creation_date": 1435393191, "answer_id": 31086663, "question_id": 31086007, "link": "https://stackoverflow.com/questions/31086007/golang-acronym-of-given-sentence/31086663#31086663", "title": "Golang: acronym of given sentence", "body": "<p>After you have split the strings you need to append the first letter of each word to your result string.</p>\n\n<pre><code>text := \"Hello World\"\nwords := strings.Split(text, \" \")\n\nres := \"\"\n\nfor _, word := range words {\n    res = res + string([]rune(word)[0])\n}\n\nfmt.Println(res)\n</code></pre>\n\n<p>Note that you might need to add some checks to catch the case if the input is empty which results in a <code>[\"\"]</code> from <code>strings.Split</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 1, "creation_date": 1435425286, "post_id": 31090494, "comment_id": 50199267, "body": "The problem is by using <code>string(word[0])</code> you dropped support for utf-8. That&#39;s why the other response is using <code>[]rune(word)[0]</code>. Compare with greek perspective <a href=\"http://play.golang.org/p/bkk_XkhtJr\" rel=\"nofollow noreferrer\">play.golang.org/p/bkk_XkhtJr</a>"}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "reply_to_user": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1435452703, "post_id": 31090494, "comment_id": 50206450, "body": "That&#39;s fair.  I don&#39;t often have to think of acronyms in non-ASCII terms... See updated answer and comments in code.   I&#39;d still recommend applying <code>strings.Title(&quot;...&quot;)</code> to ensure capitalization."}], "tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1435452542, "last_edit_date": 1435452542, "creation_date": 1435419773, "answer_id": 31090494, "question_id": 31086007, "link": "https://stackoverflow.com/questions/31086007/golang-acronym-of-given-sentence/31090494#31090494", "title": "Golang: acronym of given sentence", "body": "<p>Agree with first answer, but slightly different implementation; be sure to <code>import \"strings\"</code> at beginning of your code:</p>\n\n<pre><code>text := \"holur st\u00e1l fyrirt\u00e6ki\" // fake manufacturer, \"hollow steel company\"\nwords := strings.Split(text, \" \")\n\nres := \"\"\n\nfor _, word := range words {\n    // Convert to []rune before string to preserve UTF8 encoding\n    // Use \"Title\" from \"strings\" package to ensure capitalization of acronym\n    res += strings.Title(string([]rune(word)[0]))\n}\n\nfmt.Println(res) // =&gt; \"HSF\"\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 4469122, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-4thRLUf3oUg/AAAAAAAAAAI/AAAAAAAABIk/-ICT6ma-GQs/photo.jpg?sz=128", "display_name": "RISHI KHANNA", "link": "https://stackoverflow.com/users/4469122/rishi-khanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 987, "favorite_count": 0, "accepted_answer_id": 31086663, "answer_count": 2, "score": 0, "last_activity_date": 1435452542, "creation_date": 1435387528, "last_edit_date": 1435387996, "question_id": 31086007, "link": "https://stackoverflow.com/questions/31086007/golang-acronym-of-given-sentence", "title": "Golang: acronym of given sentence", "body": "<p>How to find, given a sentence, the acronym of that sentence using GO programming language. For example, \u201cHello, world!\u201d becomes \u201cHW\u201d. So far I have tried splitting the sentence:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n    \"os\"\n)\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter text: \")\n    text, _ := reader.ReadString('\\n')\n    fmt.Print(strings.Split(text,\" \"))\n    fmt.Print(strings.Index(text, ))\n}\n</code></pre>\n\n<ol>\n<li>Took input from the user</li>\n<li>Split on the occurrence of white space.</li>\n<li>What next?</li>\n</ol>\n\n<p>Any help is appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "go", "compilation", "pkg-config", "gokogiri"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1435399804, "post_id": 31085050, "comment_id": 50192090, "body": "Check if <code>libiconv</code> is available."}, {"owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1435401690, "post_id": 31085050, "comment_id": 50192578, "body": "Yes it is available. At the time I posted the question, I have downloaded <code>libiconv</code> separately, it is in path : <code>C:\\Lib\\iconv-1.14-win32-x86</code>."}], "owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5052, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1435401742, "creation_date": 1435378136, "last_edit_date": 1495541729, "question_id": 31085050, "link": "https://stackoverflow.com/questions/31085050/fatal-error-iconv-h-no-such-file-or-directory-on-compiling-libxml2", "title": "&quot;fatal error: iconv.h: No such file or directory&quot; on compiling libxml2", "body": "<p>I'm trying to install <a href=\"https://github.com/moovweb/gokogiri\" rel=\"nofollow noreferrer\">gokogiri</a> on Windows 8 PC by running this command : <code>go get github.com/moovweb/gokogiri</code>, but then I get the error in title (full error message at the bottom of question).</p>\n\n<p><a href=\"https://stackoverflow.com/questions/30960805/error-libxml2-not-found-on-installing-gokogiri-on-windows\"><code>gokogiri</code> has dependency to <code>libxml2</code></a> and in turn, <code>libxml2</code> seems dependent on <code>iconv</code>. I guess I need to change <code>libxml-2.0.pc</code> file, which looks like a configuration file, to tell location of <code>incov</code> files which I've downloaded separately. But I'm not sure which part of <code>libxml-2.0.pc</code> I need to modify and how? Every modification I've tried so far didn't solve the error.</p>\n\n<p><strong>libxml-2.0.pc</strong></p>\n\n<pre><code>prefix=/usr/local\nexec_prefix=${prefix}\nlibdir=${exec_prefix}/lib\nincludedir=${prefix}/include\nmodules=1\n\nName: libXML\nVersion: 2.9.2\nDescription: libXML library version2.\nRequires:\nLibs: -L${libdir} -lxml2\nLibs.private:   -L/usr/local/lib -lz  -L/usr/local/lib -liconv  -lws2_32 \nCflags: -I${includedir}/libxml2 -I/usr/local/include \n</code></pre>\n\n<p><strong>error message :</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/GFVjt.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1656, "user_id": 447288, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e42cf5cede6c23af88068ae4fa02fb4c?s=128&d=identicon&r=PG", "display_name": "Alex Reece", "link": "https://stackoverflow.com/users/447288/alex-reece"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435361532, "post_id": 31083572, "comment_id": 50185221, "body": "Yes, thats what I linked to above. As I asked above: &quot;In that case, what is the idiomatic way to iterate over the ticker channel?&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1435822777, "post_id": 31087935, "comment_id": 50363056, "body": "Your ticker uses Sleep with a fixed duration, so it is not quite accurate. Any drift will gradually add up. In particular, if the receiving end is busy, it will affect the ticker too. Instead you should compute the deadlines needed from the duration, and sleep only for the necessary time."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 2, "last_activity_date": 1435402381, "creation_date": 1435402381, "answer_id": 31087935, "question_id": 31083572, "link": "https://stackoverflow.com/questions/31083572/how-do-i-iterate-over-a-go-time-tick-channel/31087935#31087935", "title": "How do I iterate over a go time.Tick channel?", "body": "<p>You're right, ticker's channel is not being closed on stop, that's stated in a <a href=\"http://golang.org/pkg/time/#Ticker.Stop\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>Stop turns off a ticker. After Stop, no more ticks will be sent. Stop does not close the channel, to prevent a read from the channel succeeding incorrectly.</p>\n</blockquote>\n\n<p>I believe ticker is more about fire and forget and even if you want to stop it, you could even leave the routine hanging forever (depends on your application of course).</p>\n\n<p>If you really need a finite ticker, you can do tricks and provide a separate channel (per ThunderCat's answer), but what I would do is providing my own implementation of ticker. This should be relatively easy and will give you flexibility with its behaviour, things like what to pass on the channel or deciding what to do with missing ticks (i.e. when reader is falling behind).</p>\n\n<p>My example:</p>\n\n<pre><code>func finiteTicker(n int, d time.Duration) &lt;-chan time.Time {\n    ch := make(chan time.Time, 1)\n    go func() {\n        for i := 0; i &lt; n; i++ {\n            time.Sleep(d)\n            ch &lt;- time.Now()\n        }\n        close(ch)\n    }()\n    return ch\n}\n\nfunc main() {   \n    for range finiteTicker(10, 100*time.Millisecond) {\n        fmt.Println(\"hi\")\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/ZOwJlM8rDm\" rel=\"nofollow\">http://play.golang.org/p/ZOwJlM8rDm</a></p>\n"}, {"tags": [], "owner": {"reputation": 1656, "user_id": 447288, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e42cf5cede6c23af88068ae4fa02fb4c?s=128&d=identicon&r=PG", "display_name": "Alex Reece", "link": "https://stackoverflow.com/users/447288/alex-reece"}, "is_accepted": false, "score": 0, "last_activity_date": 1435434778, "last_edit_date": 1435434778, "creation_date": 1435433740, "answer_id": 31092759, "question_id": 31083572, "link": "https://stackoverflow.com/questions/31083572/how-do-i-iterate-over-a-go-time-tick-channel/31092759#31092759", "title": "How do I iterate over a go time.Tick channel?", "body": "<p>I asked on IRC as well, at got some useful insight from @Tv`.</p>\n\n<p>Despite <code>timer.Ticker</code> looking like it should be part of a go <a href=\"http://blog.golang.org/pipelines\" rel=\"nofollow\">pipeline</a>, it does not actually play well with the pipeline idioms:</p>\n\n<blockquote>\n  <p>Here are the guidelines for pipeline construction: </p>\n  \n  <ul>\n  <li>stages close their outbound channels when all the send operations are done.</li>\n  <li>stages keep receiving values from inbound channels until those channels are closed or the senders are unblocked.</li>\n  </ul>\n  \n  <p>Pipelines unblock senders either by ensuring there's enough buffer for all the values that are sent or by explicitly signalling senders when the receiver may abandon the channel.</p>\n</blockquote>\n\n<p>The reason for this inconsistency appears to be primarily to support the following idiom:</p>\n\n<pre><code>for {\n    select {\n    case &lt;-ticker.C:\n        // do something\n    case &lt;-done:\n        return\n    }\n}\n</code></pre>\n\n<p>I don't know why this is the case, and why the pipelining idiom wasn't used:</p>\n\n<pre><code>for {\n    select {\n    case _, ok := &lt;-ticker.C:\n        if ok {\n            // do something\n        } else {\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>(or more cleanly)</p>\n\n<pre><code>for _ = range ticker.C {\n    // do something\n}\n</code></pre>\n\n<p>But this is the way go is :(</p>\n"}], "owner": {"reputation": 1656, "user_id": 447288, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e42cf5cede6c23af88068ae4fa02fb4c?s=128&d=identicon&r=PG", "display_name": "Alex Reece", "link": "https://stackoverflow.com/users/447288/alex-reece"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2853, "favorite_count": 0, "accepted_answer_id": 31087935, "answer_count": 2, "score": 1, "last_activity_date": 1459316770, "creation_date": 1435361206, "question_id": 31083572, "link": "https://stackoverflow.com/questions/31083572/how-do-i-iterate-over-a-go-time-tick-channel", "title": "How do I iterate over a go time.Tick channel?", "body": "<p>I'm having difficulty using <code>time.Tick</code>. I expect this code to print \"hi\" 10 times then quit after 1 second, but instead it hangs:</p>\n\n<pre><code>ticker := time.NewTicker(100 * time.Millisecond)\ntime.AfterFunc(time.Second, func () {\n    ticker.Stop()\n})\n\nfor _ = range ticker.C {\n    go fmt.Println(\"hi\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/1p6-ViSvma\" rel=\"nofollow\">https://play.golang.org/p/1p6-ViSvma</a></p>\n\n<p>Looking at the <a href=\"http://golang.org/src/time/tick.go?s=1319:1342#L35\" rel=\"nofollow\">source</a>, I see that the channel isn't closed when <code>Stop()</code> is called. In that case, what is the idiomatic way to iterate over the ticker channel?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1435360677, "post_id": 31082662, "comment_id": 50185013, "body": "os.Create returns a *File and an error. Also it is not a &quot;qualified path&quot; but a package name (see <a href=\"http://golang.org/ref/spec#Qualified_identifiers\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Qualified_identifiers</a>). Nitpick: This has nothing to do with os.File, that&#39;s how accessing stuff from packages works."}], "tags": [], "owner": {"reputation": 1844, "user_id": 238074, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3fed50cc653f3ea8c50eb4c227237840?s=128&d=identicon&r=PG", "display_name": "Kevin Buchs", "link": "https://stackoverflow.com/users/238074/kevin-buchs"}, "is_accepted": false, "score": -2, "last_activity_date": 1435355294, "creation_date": 1435355294, "answer_id": 31082662, "question_id": 31082653, "link": "https://stackoverflow.com/questions/31082653/passing-file-pointer-in-go/31082662#31082662", "title": "passing File pointer in Go", "body": "<p>Give the qualified path to the struc File</p>\n\n<pre><code>import \"os\"\nfunc testfunc(fp *os.File) { ... }\nfp := os.Create(\"myfile\")\ntestfunc(fp)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 3278382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed48e3289161b5ce4ca1ccb7754256a8?s=128&d=identicon&r=PG&f=1", "display_name": "markotikvic", "link": "https://stackoverflow.com/users/3278382/markotikvic"}, "is_accepted": false, "score": 6, "last_activity_date": 1459714404, "creation_date": 1459714404, "answer_id": 36390597, "question_id": 31082653, "link": "https://stackoverflow.com/questions/31082653/passing-file-pointer-in-go/36390597#36390597", "title": "passing File pointer in Go", "body": "<p>Your testfunc declaration should look like this:</p>\n\n<pre><code>func testfunc(fp *os.File) { ... }\n</code></pre>\n\n<p>I was stuck about half an hour on this one.\nAnyway, I hope this helps some other people as well.</p>\n"}], "owner": {"reputation": 1844, "user_id": 238074, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3fed50cc653f3ea8c50eb4c227237840?s=128&d=identicon&r=PG", "display_name": "Kevin Buchs", "link": "https://stackoverflow.com/users/238074/kevin-buchs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5301, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1459714404, "creation_date": 1435355245, "question_id": 31082653, "link": "https://stackoverflow.com/questions/31082653/passing-file-pointer-in-go", "title": "passing File pointer in Go", "body": "<p>Ok, I've been programming in Go for a few days so I could be considered a newbie, but I cannot figure out how to import the definition of the File struct. I want to pass a *File into a func and I can't seem to get File defined. I'm importing \"os\" and calling os.Create in my main. How do I import the right item or declare the parameter in my func definition to pass a file pointer?</p>\n\n<pre><code>import \"os\"\nfunc testfunc(fp *File) { ... }\nfp := os.Create(\"myfile\")\ntestfunc(fp)\n</code></pre>\n"}, {"tags": ["shell", "go", "stream", "stdout"], "answers": [{"comments": [{"owner": {"reputation": 1125, "user_id": 4224724, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XMleNi8A3cE/AAAAAAAAAAI/AAAAAAAACzU/_LZ3Rgct8Xk/photo.jpg?sz=128", "display_name": "Danver Braganza", "link": "https://stackoverflow.com/users/4224724/danver-braganza"}, "edited": false, "score": 0, "creation_date": 1435351311, "post_id": 31081690, "comment_id": 50181947, "body": "OP probably saw that time * x doesn&#39;t work when x is of type int. There&#39;s no reason for <code>total_time := int64(...</code>,"}, {"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "reply_to_user": {"reputation": 1125, "user_id": 4224724, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XMleNi8A3cE/AAAAAAAAAAI/AAAAAAAACzU/_LZ3Rgct8Xk/photo.jpg?sz=128", "display_name": "Danver Braganza", "link": "https://stackoverflow.com/users/4224724/danver-braganza"}, "edited": false, "score": 0, "creation_date": 1435351413, "post_id": 31081690, "comment_id": 50181996, "body": "I am saying that multiplying it by Nanosecond is a no-op because Nanosecond = 1."}, {"owner": {"reputation": 451, "user_id": 1675673, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6fd210a9ebb6793c60bfbca1b3f1000?s=128&d=identicon&r=PG", "display_name": "brancz", "link": "https://stackoverflow.com/users/1675673/brancz"}, "edited": false, "score": 1, "creation_date": 1435351484, "post_id": 31081690, "comment_id": 50182024, "body": "Thanks for all your suggestions, I&#39;m very new to go and mostly copy and pasting things together from different sources."}, {"owner": {"reputation": 451, "user_id": 1675673, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6fd210a9ebb6793c60bfbca1b3f1000?s=128&d=identicon&r=PG", "display_name": "brancz", "link": "https://stackoverflow.com/users/1675673/brancz"}, "edited": false, "score": 0, "creation_date": 1435351615, "post_id": 31081690, "comment_id": 50182077, "body": "The Nanosecond thing originated from comments in this thread <a href=\"http://stackoverflow.com/questions/24122821/go-golang-time-now-unixnano-convert-to-milliseconds\" title=\"go golang time now unixnano convert to milliseconds\">stackoverflow.com/questions/24122821/&hellip;</a>"}, {"owner": {"reputation": 1125, "user_id": 4224724, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XMleNi8A3cE/AAAAAAAAAAI/AAAAAAAACzU/_LZ3Rgct8Xk/photo.jpg?sz=128", "display_name": "Danver Braganza", "link": "https://stackoverflow.com/users/4224724/danver-braganza"}, "edited": false, "score": 0, "creation_date": 1435351785, "post_id": 31081690, "comment_id": 50182152, "body": "Actually, nvm. My previous suggestion was wrong for all sorts of reasons."}], "tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": true, "score": 2, "last_activity_date": 1435351136, "last_edit_date": 1435351136, "creation_date": 1435350778, "answer_id": 31081690, "question_id": 31081387, "link": "https://stackoverflow.com/questions/31081387/streaming-os-exec-command/31081690#31081690", "title": "streaming os/exec.Command", "body": "<p>The best way is to avoid touching the stream altogether. You can pass your own file descriptors for stdout and stderr directly.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n    \"time\"\n)\n\nfunc main() {\n    command := os.Args[1]\n    args := os.Args[2:]\n    cmd := exec.Command(command, args...)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    start_time := time.Now()\n\n    err := cmd.Run()\n    if err != nil {\n        println(err.Error())\n        return\n    }\n\n    total_time := int64(time.Since(start_time) / time.Millisecond)\n    fmt.Println(total_time)\n}\n</code></pre>\n\n<hr>\n\n<p>Also, print() should never be used. Instead, use one of the fmt.Print* functions.</p>\n\n<hr>\n\n<pre><code>total_time := int64(time.Nanosecond) * (time.Now().UnixNano() - start_time) / int64(time.Millisecond)\n</code></pre>\n\n<p>This line is extremely confusing. <code>int64(time.Nanosecond) * x</code> resolves to <code>1 * x</code> or just <code>x</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1125, "user_id": 4224724, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XMleNi8A3cE/AAAAAAAAAAI/AAAAAAAACzU/_LZ3Rgct8Xk/photo.jpg?sz=128", "display_name": "Danver Braganza", "link": "https://stackoverflow.com/users/4224724/danver-braganza"}, "edited": false, "score": 0, "creation_date": 1435351195, "post_id": 31081719, "comment_id": 50181896, "body": "The OP wants to see the output of command to be piped to stdout and stderr."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1125, "user_id": 4224724, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XMleNi8A3cE/AAAAAAAAAAI/AAAAAAAACzU/_LZ3Rgct8Xk/photo.jpg?sz=128", "display_name": "Danver Braganza", "link": "https://stackoverflow.com/users/4224724/danver-braganza"}, "edited": false, "score": 0, "creation_date": 1435351281, "post_id": 31081719, "comment_id": 50181935, "body": "@DanverBraganza that&#39;s a simple change, I&#39;ll edit it."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1435351308, "last_edit_date": 1435351308, "creation_date": 1435350870, "answer_id": 31081719, "question_id": 31081387, "link": "https://stackoverflow.com/questions/31081387/streaming-os-exec-command/31081719#31081719", "title": "streaming os/exec.Command", "body": "<p>I'm not sure what you're attempting to do here with <code>print(string(stdout))</code> but it's unnecessary and the problems you're facing are likely a side effect of some misuse there.</p>\n\n<pre><code>func main() {\n    command := os.Args[1]\n    args := os.Args[2:]\n    cmd := exec.Command(command, args...)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    start_time := time.Now().UnixNano()\n\n    if err != nil {\n        fmt.Println(err.Error())\n        return\n    }\n\n    total_time := int64(time.Nanosecond) * (time.Now().UnixNano() - start_time) / int64(time.Millisecond)\n    fmt.Println(total_time)\n}\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 1675673, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6fd210a9ebb6793c60bfbca1b3f1000?s=128&d=identicon&r=PG", "display_name": "brancz", "link": "https://stackoverflow.com/users/1675673/brancz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 31081690, "answer_count": 2, "score": 0, "last_activity_date": 1435351308, "creation_date": 1435349584, "question_id": 31081387, "link": "https://stackoverflow.com/questions/31081387/streaming-os-exec-command", "title": "streaming os/exec.Command", "body": "<p>I want to build a benchmarking tool similar to the unix tool <code>time</code>. What I currently have is this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/exec\"\n    \"time\"\n)\n\nfunc main() {\n    command := os.Args[1]\n    args := os.Args[2:]\n    cmd := exec.Command(command, args...)\n    start_time := time.Now().UnixNano()\n    stdout, err := cmd.Output()\n\n    if err != nil {\n        println(err.Error())\n        return\n    }\n\n    print(string(stdout))\n    total_time := int64(time.Nanosecond) * (time.Now().UnixNano() - start_time) / int64(time.Millisecond)\n    fmt.Println(total_time)\n}\n</code></pre>\n\n<p>My problem with this is, that the output is not streaming, instead it is printed all at once, and weirdly enough for some programs not at all.</p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": true, "score": 2, "last_activity_date": 1435350811, "creation_date": 1435350811, "answer_id": 31081704, "question_id": 31080415, "link": "https://stackoverflow.com/questions/31080415/creating-objectid-vs-letting-db-create-it/31081704#31081704", "title": "Creating ObjectId vs letting DB create it", "body": "<p>I would go with the first approach, as you will not need to retrieve any ID in this case. </p>\n\n<p>If you will look at the description of <a href=\"http://docs.mongodb.org/manual/reference/object-id/\" rel=\"nofollow\">ObjectID</a>, you will see that it consists of:</p>\n\n<ul>\n<li>a 4-byte value representing the seconds since the Unix epoch,</li>\n<li>a 3-byte machine identifier,</li>\n<li>a 2-byte process id, and</li>\n<li>a 3-byte counter, starting with a random value.</li>\n</ul>\n\n<p>As you see, even if you use the same machine running on one process (making 2 and 3 the same), you still are able to insert 3 bytes integer per second.</p>\n\n<p>So if your writing speed is less than <code>(2^8)^3 - 1 = 16777215</code> per second, the collision will not happen.</p>\n\n<p>And having 16 million inserts per second is too unrealistic.</p>\n"}], "owner": {"reputation": 1800, "user_id": 2372663, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/D76OC.jpg?s=128&g=1", "display_name": "petomalina", "link": "https://stackoverflow.com/users/2372663/petomalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 31081704, "answer_count": 1, "score": 0, "last_activity_date": 1435350811, "creation_date": 1435345430, "question_id": 31080415, "link": "https://stackoverflow.com/questions/31080415/creating-objectid-vs-letting-db-create-it", "title": "Creating ObjectId vs letting DB create it", "body": "<p>I am using labix mgo module as a Go Mongo driver. Since Go is concurrent (and parallel), is it safe to generate ObjectId in application or should only database do that?</p>\n\n<p>It would be really straightforward if <code>.Insert()</code> could return <code>Id</code>. But this way when I need it, there are two approaches how I do that:</p>\n\n<p>1) generate ObjectId on client and use it</p>\n\n<pre><code>...\nuser.ID = bson.NewObjectId()\nUsers.Insert(user)\n// use user.ID normally\n</code></pre>\n\n<p>2) let the database generate the Id and retrieve it</p>\n\n<pre><code>...\nUsers.Insert(user)\nUsers.Find(user).One(&amp;user)\n// user user.ID normally\n</code></pre>\n\n<p>The second approach takes 2 database requests and the synchronous insert.</p>\n\n<p>Question is: Is first approach safe as second is? Or is there something better I should be working with?</p>\n"}, {"tags": ["list", "go", "slice"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1435345523, "post_id": 31080285, "comment_id": 50179344, "body": "let me clarify, you need to remove an item from slice or the container list  ?"}, {"owner": {"reputation": 5620, "user_id": 252218, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c6b551b65980ad7d5f2577687d5eafe9?s=128&d=identicon&r=PG", "display_name": "BoppreH", "link": "https://stackoverflow.com/users/252218/boppreh"}, "edited": false, "score": 0, "creation_date": 1435345597, "post_id": 31080285, "comment_id": 50179385, "body": "I currently have a slice, but I&#39;m willing to replace it with a container list or anything else that does the job."}], "answers": [{"comments": [{"owner": {"reputation": 2061, "user_id": 1520291, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9d8e7bdd418d0b727f76b47e655bc465?s=128&d=identicon&r=PG", "display_name": "Dmytro Titov", "link": "https://stackoverflow.com/users/1520291/dmytro-titov"}, "edited": false, "score": 0, "creation_date": 1618498805, "post_id": 31080520, "comment_id": 118624370, "body": "I would argue that using a set-based approach is not always suitable, because set is generally unordered. So when the task is: &quot;remove element by value from a sorted data collection&quot;, set won&#39;t help."}], "tags": [], "owner": {"reputation": 2911, "user_id": 702065, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae529fa78546d54e42c26bd3713946a2?s=128&d=identicon&r=PG", "display_name": "Johan Wikstr&#246;m", "link": "https://stackoverflow.com/users/702065/johan-wikstr%c3%b6m"}, "is_accepted": true, "score": 18, "last_activity_date": 1435345850, "creation_date": 1435345850, "answer_id": 31080520, "question_id": 31080285, "link": "https://stackoverflow.com/questions/31080285/remove-element-by-value-in-go-list/31080520#31080520", "title": "Remove element by value in Go list", "body": "<p>The idiomatic way to remove an element from a list is to loop through it exactly like you do in your example. Removing an element by value from a slice shouldn't be too common in your program since it is an <code>O(n)</code> operation and there are better data structures in the language for that. Therefore, Go does not provide a built-in remove function for slices.</p>\n\n<p>If you find yourself using removal by value often, consider using a set instead where removing and adding an element is <code>O(1)</code> while still being  iterable.</p>\n\n<pre><code>set := map[string]bool{\"apples\":true, \"oranges\":true, \"melon\":true}\ndelete(set,\"melon\") // is O(1)\n</code></pre>\n"}], "owner": {"reputation": 5620, "user_id": 252218, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c6b551b65980ad7d5f2577687d5eafe9?s=128&d=identicon&r=PG", "display_name": "BoppreH", "link": "https://stackoverflow.com/users/252218/boppreh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9387, "favorite_count": 3, "accepted_answer_id": 31080520, "answer_count": 1, "score": 9, "last_activity_date": 1435359361, "creation_date": 1435344932, "last_edit_date": 1435359361, "question_id": 31080285, "link": "https://stackoverflow.com/questions/31080285/remove-element-by-value-in-go-list", "title": "Remove element by value in Go list", "body": "<p>I have a list of elements and I want to remove one of them, by value. In Python this would be</p>\n\n<pre><code>l = [\"apples\", \"oranges\", \"melon\"]\nl.remove(\"melon\")\nprint(l) # [\"apples\", \"orange\"]\n</code></pre>\n\n<p>What is the equivalent in Go? I found a <a href=\"https://code.google.com/p/go-wiki/wiki/SliceTricks\" rel=\"noreferrer\">slice trick</a> to remove an element by index, but it's not very readable, still requires me to find the index manually and only works for a single item type:</p>\n\n<pre><code>func remove(l []string, item string) {\n    for i, other := range l {\n        if other == item {\n            return append(l[:i], l[i+1:]...)\n        }\n    }\n}\n</code></pre>\n\n<p>There's the <a href=\"https://code.google.com/p/go-wiki/wiki/SliceTricks\" rel=\"noreferrer\"><code>list.List</code></a> structure, but it's not generic and thus requires tons of type-castings to use.</p>\n\n<p>What is the idiomatic way of removing an element from a list?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1305, "user_id": 3377285, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eaa60f6024489bcf022e818ee1ac4c41?s=128&d=identicon&r=PG&f=1", "display_name": "user18007", "link": "https://stackoverflow.com/users/3377285/user18007"}, "edited": false, "score": 1, "creation_date": 1435341739, "post_id": 31079403, "comment_id": 50177471, "body": "thanks... it won&#39;t let me accept for 5 more minutes :P but i will!"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 9, "last_activity_date": 1435341747, "last_edit_date": 1435341747, "creation_date": 1435341630, "answer_id": 31079403, "question_id": 31079291, "link": "https://stackoverflow.com/questions/31079291/switch-over-enum-iota-based-type-in-golang/31079403#31079403", "title": "switch over enum / iota based type in golang", "body": "<p>you either do a <code>switch</code> with no value, and put comparison expressions in each <code>case</code>, or you treat each case as a <code>==</code> for the checked value. e.g.:</p>\n\n<pre><code>if node, ok := area.Nodes[coord]; ok {\n    switch node.Type {\n        case  City:\n            // do something for City\n        case Town:\n            // do something for Town\n        case Outpost:\n            // do something for Outpost\n    }\n}\n</code></pre>\n\n<p>The other <code>switch</code> syntax is used when you're switching between conditions that are not based on a single value. e.g.</p>\n\n<pre><code>switch {\n    case node.Type == City:\n        // do something for City\n    case node.OtherParam == \"foo\":\n        ///\n}\n</code></pre>\n\n<p>Which means basically you're switching between binary conditions. Personally, I use it just to remove clutter from long if/else blocks that don't rely on a single value, but I rarely use it.</p>\n"}], "owner": {"reputation": 1305, "user_id": 3377285, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eaa60f6024489bcf022e818ee1ac4c41?s=128&d=identicon&r=PG&f=1", "display_name": "user18007", "link": "https://stackoverflow.com/users/3377285/user18007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6238, "favorite_count": 0, "accepted_answer_id": 31079403, "answer_count": 1, "score": 2, "last_activity_date": 1435341747, "creation_date": 1435341168, "question_id": 31079291, "link": "https://stackoverflow.com/questions/31079291/switch-over-enum-iota-based-type-in-golang", "title": "switch over enum / iota based type in golang", "body": "<p>I defined an enumeration and struct type like so:</p>\n\n<pre><code>type NodeType int\nconst (\n        City NodeType = iota\n        Town\n        Village\n)\n\ntype AreaNode struct {\n        Location Coord2D\n        Type NodeType\n}\n</code></pre>\n\n<p>and now I'm iterating over a series of nodes that each have a type</p>\n\n<pre><code>if node, ok := area.Nodes[coord]; ok {\n    switch node.Type {\n        case node.Type == City:\n            // do something for City\n        case node.Type == Town:\n            // do something for Town\n        case node.Type == Outpost:\n            // do something for Outpost\n    }\n}\n</code></pre>\n\n<p>However I'm getting an error: incompatible types in binary expression.</p>\n\n<p>How can I resolve this?</p>\n"}, {"tags": ["macos", "go", "pycharm"], "comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1437123420, "post_id": 31077299, "comment_id": 50909316, "body": "I&#39;m not sure how you managed to install this version, you shouldn&#39;t be able to get it for pycharm 4.5+. Anyway, please follow the response from Andrew C. and you should be fine."}], "answers": [{"tags": [], "owner": {"reputation": 2980, "user_id": 454196, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0fd6a92775b8ccdcf488bc686869d618?s=128&d=identicon&r=PG", "display_name": "Andrew C", "link": "https://stackoverflow.com/users/454196/andrew-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1436902037, "creation_date": 1436902037, "answer_id": 31415607, "question_id": 31077299, "link": "https://stackoverflow.com/questions/31077299/how-to-config-golang-plugins-in-pycharm/31415607#31415607", "title": "how to config golang plugins in pycharm?", "body": "<p>Install the latest <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin\" rel=\"nofollow\">pre-release build of the new golang IDEA plugin</a>. There's been a lot of work recently on it by two Jetbrains employees and it's gotten much better than the currently released version.</p>\n"}, {"tags": [], "owner": {"reputation": 581, "user_id": 5751662, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qBgTvb_RFVQ/AAAAAAAAAAI/AAAAAAAAAPo/ja7XbkT8zFM/photo.jpg?sz=128", "display_name": "Sanjeev Kumar Rai", "link": "https://stackoverflow.com/users/5751662/sanjeev-kumar-rai"}, "is_accepted": false, "score": 3, "last_activity_date": 1459926544, "last_edit_date": 1459926544, "creation_date": 1459924580, "answer_id": 36443309, "question_id": 31077299, "link": "https://stackoverflow.com/questions/31077299/how-to-config-golang-plugins-in-pycharm/36443309#36443309", "title": "how to config golang plugins in pycharm?", "body": "<p>Create environment vairiables <code>gopath</code> and <code>goroot</code>.</p>\n\n<p>For example,</p>\n\n<pre><code>export GOPATH='goHomePath'\n\nexport GOROOT='&lt; goRootPath &gt;'\n</code></pre>\n"}], "owner": {"reputation": 2100, "user_id": 2351411, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CH50M.png?s=128&g=1", "display_name": "Karl Doenitz", "link": "https://stackoverflow.com/users/2351411/karl-doenitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2075, "favorite_count": 2, "accepted_answer_id": 31415607, "answer_count": 2, "score": 5, "last_activity_date": 1459926544, "creation_date": 1435333529, "last_edit_date": 1435339766, "question_id": 31077299, "link": "https://stackoverflow.com/questions/31077299/how-to-config-golang-plugins-in-pycharm", "title": "how to config golang plugins in pycharm?", "body": "<p>I want to develop Go use pycharm. My golang version is 1.4.2.And my pycharm version is 4.5.2.My operating system is Mac OSX 10.10.3.I have configured the GOROOT and GOPATH on my Mac.Like the pictures:\n<img src=\"https://i.stack.imgur.com/zzdqy.png\" alt=\"enter image description here\"></p>\n\n<p>I download the golang plugin from this <a href=\"https://plugins.jetbrains.com/plugin/5047\" rel=\"nofollow noreferrer\">url</a>. But when I installed the plugin and restart pycharm, the IDE show me that no gopath and goroot. The messages:</p>\n\n<p><img src=\"https://i.stack.imgur.com/GHoH0.png\" alt=\"enter image description here\"></p>\n\n<p>what's wrong?</p>\n"}, {"tags": ["javascript", "go"], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 278265, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5696342d767de0309614813f1fd4b3b0?s=128&d=identicon&r=PG", "display_name": "omarshariffdontlikeit", "link": "https://stackoverflow.com/users/278265/omarshariffdontlikeit"}, "is_accepted": true, "score": 2, "last_activity_date": 1435665751, "creation_date": 1435665751, "answer_id": 31137747, "question_id": 31075670, "link": "https://stackoverflow.com/questions/31075670/golang-otto-js-expose-host-object-to-javascript/31137747#31137747", "title": "Golang Otto JS - Expose host object to JavaScript", "body": "<p>Greg Rosebury on the Go-nuts mailing list answered this question for me. I've reproduced his answer here verbatim:</p>\n\n<blockquote>\n  <p>Hello, try putting a pointer to your object into the runtime. Use\n  *BensObject and change your methods to take pointer receivers: func (b *BensObject) SetName(name string) { ... } Change runtime.ToValue(*r) to runtime.ToValue(r). </p>\n  \n  <p>Basically BensObject is getting copied every time you call a method on\n  it, so changes aren't being reflected.</p>\n</blockquote>\n\n<p>This solved the problem and the object properly shared to the Otto runtime, and changes via the methods are reflected correctly.</p>\n"}], "owner": {"reputation": 107, "user_id": 278265, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5696342d767de0309614813f1fd4b3b0?s=128&d=identicon&r=PG", "display_name": "omarshariffdontlikeit", "link": "https://stackoverflow.com/users/278265/omarshariffdontlikeit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1820, "favorite_count": 1, "accepted_answer_id": 31137747, "answer_count": 1, "score": 1, "last_activity_date": 1435665751, "creation_date": 1435328568, "last_edit_date": 1435328863, "question_id": 31075670, "link": "https://stackoverflow.com/questions/31075670/golang-otto-js-expose-host-object-to-javascript", "title": "Golang Otto JS - Expose host object to JavaScript", "body": "<p>I'm trying to expose an existing Go Object to the Otto JavaSCript runtime. The object is exposed and I can see it, but when I call methods that affect the state of the exposed object, I get panics and errors or even just silent ignoring of it by Otto!</p>\n\n<p>Golang code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n\n    \"github.com/robertkrimen/otto\"\n)\n\ntype BensObject struct {\n    name string\n}\n\nfunc (b BensObject) SetName(name string) {\n    fmt.Println(\"INT: \", name)\n    b.name = name\n    fmt.Println(\"INT: \", b.name)\n}\n\nfunc (b BensObject) GetName() string {\n    fmt.Println(\"INT: \", b.name)\n    return b.name\n}\n\nfunc (b BensObject) Age() int {\n    return 36\n}\n\nfunc (b BensObject) AddToAge(n int) int {\n    return 36 + n\n}\n\nfunc main() {\n    runtime := loadPluginRuntime(\"plugins.js\")\n\n    // If we don't have a runtime all requests are accepted\n    if runtime == nil {\n        os.Exit(-1)\n    }\n\n    r := new(BensObject)\n    v, err := runtime.ToValue(*r)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // By convention we will require plugins have a set name\n    result, err := runtime.Call(\"checkRequest\", nil, v)\n    if err != nil {\n        log.Fatal(err)\n    }\n    // If the js function did not return a bool error out\n    // because the plugin is invalid\n    out, err := result.ToBoolean()\n    if err != nil {\n        log.Fatalf(\"\\\"checkRequest\\\" must return a boolean. Got %s\", err)\n    }\n\n    fmt.Println(out)\n}\n\nfunc loadPluginRuntime(name string) *otto.Otto {\n    f, err := os.Open(name)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return nil\n        }\n        log.Fatal(err)\n    }\n    defer f.Close()\n    buff := bytes.NewBuffer(nil)\n\n    if _, err := buff.ReadFrom(f); err != nil {\n        log.Fatal(err)\n    }\n    runtime := otto.New()\n    // Load the plugin file into the runtime before we\n    // return it for use\n    if _, err := runtime.Run(buff.String()); err != nil {\n        log.Fatal(err)\n    }\n    return runtime\n}\n</code></pre>\n\n<p>JavaScript code:</p>\n\n<pre><code>var getKeys = function(obj){\n   var keys = [];\n   for(var key in obj){\n      keys.push(key);\n   }\n   return keys;\n}\n\nfunction checkRequest(r) {\n    console.log(r);\n    r.SetName(\"Ben\");\n    console.log(r.GetName());\n\n    console.log(getKeys(r));\n    console.log(r.Name);\n    console.log(r.Age());\n    console.log(r.AddToAge(10));\n    return true\n}\n</code></pre>\n\n<p>Does anyone have any insight? Has anyone been able to expose an already existing large object structure with methods to Ottos runtime? I have a very large Go package I'd like to expose directly to the Otto runtime without have to do too much fiddly and fragile \"mapping\" to JS.</p>\n"}, {"tags": ["go", "bson", "mgo"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435331124, "post_id": 31075380, "comment_id": 50171483, "body": "How does the above code fail?  It does not use the Marshal function, so I am not sure what the issue is."}, {"owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1435331541, "post_id": 31075380, "comment_id": 50171773, "body": "The GetBSON function which implements bson.Getter returns [] when it should return the currency marshalled to a BSON float value. GetBSON is called in the bson.Marshal function."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435336786, "post_id": 31075380, "comment_id": 50174917, "body": "The application does not need to do the Marshal because mgo marshals the return value from GetBSON. If you want to encode the currency as a float64, then you should return a float64 as done in the code shown in the question. Are any errors returned when you use the code in the question? Is the value not saved?"}, {"owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435392767, "post_id": 31075380, "comment_id": 50190367, "body": "It always gives an empty interface and the error message: &quot;Document is corrupted&quot;"}], "owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 834, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435327749, "creation_date": 1435327749, "question_id": 31075380, "link": "https://stackoverflow.com/questions/31075380/getbson-method-for-individual-elements-go-mgo", "title": "GetBSON method for individual elements [Go + mgo]", "body": "<p>In Go, I get the json marshalling/unmarshalling. If a struct or type has a MarshalJSON method, when calling json.Marshal on another struct which has the former as a field, that structs's MarshalJSON method will be called. So from what I gather and have seen in practice...</p>\n\n<ol>\n<li><code>type MyType struct</code> has a MarshalJSON method to marshal itself a string.</li>\n<li><code>type MyDocument struct</code> has <code>MyType</code> as a field.</li>\n<li>When calling <code>json.Marshal()</code> on <code>MyDocument</code>, the <code>MyType</code> field will be marshalled as a string due to it implementing <code>json.Marshaller</code>.</li>\n</ol>\n\n<p>I'm trying to make my system database-agnostic and am implementing a service for MongoDB using the mgo driver, which means implementing <code>bson.Getter</code> and <code>bson.Setter</code> on all structs and things I want marshalled in a specific way. This is where it gets confusing.</p>\n\n<p>Because Go doesn't have native fixed-point arithmetic, I'm using Shopspring's decimal package (found <a href=\"https://github.com/shopspring/decimal\" rel=\"nofollow\">here</a>) to deal with currency values. Decimal marshals to JSON perfectly but I have a named type <code>type Currency decimal.Decimal</code> which I just can't get to marshal down to BSON.</p>\n\n<p>These are my implementations which convert the decimal to a float64 and try marshalling that in the same way I've done for json:</p>\n\n<pre><code>/*\nImplements the bson.Getter interface.\n*/\nfunc (c Currency) GetBSON() (interface{}, error) {\n    f, _ := decimal.Decimal(c).Float64()\n    return f, nil\n}\n\n/*\nImplements the bson.Setter interface.\n*/\nfunc (c *Currency) SetBSON(raw bson.Raw) error {\n    var f float64\n    e := raw.Unmarshal(&amp;f)\n    if e == nil {\n        *c = Currency(decimal.NewFromFloat(f))\n    }\n    return e\n}\n</code></pre>\n\n<p>Only problem is in the documentation for the bson package:</p>\n\n<blockquote>\n  <p>Marshal serializes the in value, which may be a map or a struct value.</p>\n</blockquote>\n\n<p>Because it's not a struct or a map it just produces an empty document.</p>\n\n<p>I'm just trying to marshal one bit of data which will only need to be marshalled as part of larger structs, but the package will only let me do it on whole documents. What should I do to get the results I need?</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1435325956, "post_id": 31074609, "comment_id": 50167928, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/6390585/in-golang-is-is-possible-get-reflect-type-from-the-type-itself-from-name-as-st\">in golang, is is possible get reflect.Type from the type itself? from name as string?</a>"}, {"owner": {"reputation": 1800, "user_id": 2372663, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/D76OC.jpg?s=128&g=1", "display_name": "petomalina", "link": "https://stackoverflow.com/users/2372663/petomalina"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1435339142, "post_id": 31074609, "comment_id": 50176138, "body": "I updated the question"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1435326796, "last_edit_date": 1495539828, "creation_date": 1435326486, "answer_id": 31074911, "question_id": 31074609, "link": "https://stackoverflow.com/questions/31074609/getting-reflect-type-of-structure/31074911#31074911", "title": "Getting reflect.Type of structure", "body": "<p>For the first part: it is a duplicate of <a href=\"https://stackoverflow.com/questions/6390585/in-golang-is-is-possible-get-reflect-type-from-the-type-itself-from-name-as-st\">in golang, is is possible get reflect.Type from the type itself? from name as string?</a></p>\n\n<p>For the second part: make slice of that type afterwards:</p>\n\n<p>You can get the <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>Type</code></a> of the slice whose elements' type is what you already have by using <a href=\"https://golang.org/pkg/reflect/#SliceOf\" rel=\"nofollow noreferrer\"><code>Type.SliceOf()</code></a>, and you can use the <a href=\"https://golang.org/pkg/reflect/#MakeSlice\" rel=\"nofollow noreferrer\"><code>reflect.MakeSlice()</code></a> function to create a slice of such type. It returns a <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\"><code>Value</code></a>, you can use its <a href=\"https://golang.org/pkg/reflect/#Value.Interface\" rel=\"nofollow noreferrer\"><code>Value.Interface()</code></a> method to obtain an <code>interface{}</code> on which you can use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> if you need the result as a type of <code>[]MyStruct</code>:</p>\n\n<pre><code>tt := reflect.TypeOf((*MyStruct)(nil)).Elem()\nfmt.Println(tt)\n\nms := reflect.MakeSlice(reflect.SliceOf(tt), 10, 20).Interface().([]MyStruct)\nms[0].Name=\"test\"\nfmt.Println(ms)\n</code></pre>\n\n<p>Output (<kbd><a href=\"http://play.golang.org/p/ec54Hyl_bS\" rel=\"nofollow noreferrer\">Go Playground</a></kbd>):</p>\n\n<pre><code>main.MyStruct\n[{test} {} {} {} {} {} {} {} {} {}]\n</code></pre>\n"}], "owner": {"reputation": 1800, "user_id": 2372663, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/D76OC.jpg?s=128&g=1", "display_name": "petomalina", "link": "https://stackoverflow.com/users/2372663/petomalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435335048, "creation_date": 1435325697, "last_edit_date": 1435335048, "question_id": 31074609, "link": "https://stackoverflow.com/questions/31074609/getting-reflect-type-of-structure", "title": "Getting reflect.Type of structure", "body": "<p>Is it possible in Go to retrieve reflect.Type from structure itself?</p>\n\n<p>pseudo:</p>\n\n<pre><code>type MyStruct struct {\n  Name string\n}\n\ntype := reflect.TypeOf(MyStruct)\n</code></pre>\n\n<p>And is it possible to make slice of that type afterwards?</p>\n\n<p><strong>Update:</strong>\nI am aware of <code>reflect.TypeOf((*t1)(nil)).Elem()</code> solution for this problem. I am looking for a better solution to this, as this seems to me pretty unfriendly. I'll try to explain the situation.</p>\n\n<p>While developing 'generic' dataservice above database model, I want to do something like:</p>\n\n<pre><code>ds := NewDataService(db.Collection(\"MyStruct\"), MyStruct)\n</code></pre>\n\n<p>where DataService is able to do Find, Insert etc. using that model. Therefore I need to pass the structure so the model can be used correctly (for example with http server).</p>\n\n<p>The second part is needed as <code>Find</code> should return slice of found objects.</p>\n\n<p>Because I am using Mongo, there is nothing like <em>schema</em> available within <em>db.Collection</em></p>\n"}, {"tags": ["go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1435332414, "post_id": 31074533, "comment_id": 50172286, "body": "It&#39;s better to use <a href=\"https://github.com/golang/go/blob/883bc6ed0ea815293fe6309d66f967ea60630e87/src/encoding/json/encode.go#L358-360\" rel=\"nofollow noreferrer\">a link to a specific revision</a> (or at least <a href=\"https://github.com/golang/go/blob/release-branch.go1.4/src/encoding/json/encode.go#L358-360\" rel=\"nofollow noreferrer\">to a specific release branch</a>) for such things. The link you give is to the whatever the current version of that file on the &quot;master&quot; branch looks like and tomorrow line 356 might be completely different (e.g. if a function is added/removed earlier in that file)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1435333162, "post_id": 31074533, "comment_id": 50172792, "body": "Note as well, that they are using the reflect package and <code>t</code> is a <code>reflect.Type</code>. It&#39;s more common to see something like: <code>x, ok := v.(someInterfaceType)</code>; e.g. <a href=\"https://play.golang.org/p/malSK3qwpV\" rel=\"nofollow noreferrer\">play.golang.org/p/malSK3qwpV</a>"}], "tags": [], "owner": {"reputation": 2336, "user_id": 1826232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DldsJ.png?s=128&g=1", "display_name": "Asdine", "link": "https://stackoverflow.com/users/1826232/asdine"}, "is_accepted": true, "score": 2, "last_activity_date": 1435352966, "last_edit_date": 1495539828, "creation_date": 1435325500, "answer_id": 31074533, "question_id": 31074404, "link": "https://stackoverflow.com/questions/31074404/golang-encoding-json-marshaler/31074533#31074533", "title": "Golang encoding/json Marshaler", "body": "<p>Here :</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31074404/golang-encoding-json-marshaler/31074533?noredirect=1#comment50172792_31074533\">Golang encoding/json Marshaler</a></p>\n\n<pre><code>if t.Implements(marshalerType) {\n    return marshalerEncoder\n}\n</code></pre>\n\n<p>Edit:\nThe link above has been updated to point to a specific version of Go, as @dave-c pointed out in comments below.</p>\n"}], "owner": {"reputation": 6756, "user_id": 1606248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0lXId.jpg?s=128&g=1", "display_name": "Pierre Prinetti", "link": "https://stackoverflow.com/users/1606248/pierre-prinetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 31074533, "answer_count": 1, "score": -1, "last_activity_date": 1435352966, "creation_date": 1435325138, "question_id": 31074404, "link": "https://stackoverflow.com/questions/31074404/golang-encoding-json-marshaler", "title": "Golang encoding/json Marshaler", "body": "<p>As stated in the <code>encoding/json</code> package documentation,</p>\n\n<blockquote>\n  <p>Marshal traverses the value v recursively.\n  If an encountered value implements the Marshaler interface\n  and is not a nil pointer, Marshal calls its MarshalJSON method\n  to produce JSON. </p>\n</blockquote>\n\n<p>Where exactly <a href=\"https://github.com/golang/go/blob/master/src/encoding/json/encode.go\" rel=\"nofollow\">in the code</a> is this test performed?</p>\n\n<p>In another terms, how does <code>encoding/json</code> check if a value <code>v</code> of type <code>t</code> implements the <code>Marshaller</code> interface?</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1435399968, "post_id": 31072961, "comment_id": 50192132, "body": "Take a look at <a href=\"http://github.com/alexedwards/stack\" rel=\"nofollow noreferrer\">github.com/alexedwards/stack</a> - It provides a nice abstracting for stacking middlewares (handlers) with an easy way to pass context through the chain."}, {"owner": {"reputation": 632, "user_id": 872227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ddef50299354758664f679265746cd?s=128&d=identicon&r=PG", "display_name": "freeformz", "link": "https://stackoverflow.com/users/872227/freeformz"}, "edited": false, "score": 0, "creation_date": 1435785457, "post_id": 31072961, "comment_id": 50351450, "body": "Gorilla itself has a context package."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 632, "user_id": 872227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ddef50299354758664f679265746cd?s=128&d=identicon&r=PG", "display_name": "freeformz", "link": "https://stackoverflow.com/users/872227/freeformz"}, "edited": false, "score": 1, "creation_date": 1436487557, "post_id": 31072961, "comment_id": 50646561, "body": "@freeformz Gorilla&#39;s context package is intended for request context, rather than program context. In particular, it is cleared automatically at the end of a request (if you are using gorilla/mux)."}], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 5, "last_activity_date": 1436488892, "last_edit_date": 1491982284, "creation_date": 1436488892, "answer_id": 31330658, "question_id": 31072961, "link": "https://stackoverflow.com/questions/31072961/passing-context-to-gorilla-mux-go-idioms/31330658#31330658", "title": "Passing context to gorilla mux - go idioms", "body": "<p>I am learning Go and currently in the middle of a nearly identical problem, and this is how I've dealt with it:</p>\n\n<hr>\n\n<p>First, I think you missed an important detail: There are no global variables in Go. The <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">widest scope you can have for a variable</a> is package scope. The only true globals in Go are <a href=\"https://golang.org/ref/spec#Predeclared_identifiers\" rel=\"nofollow noreferrer\">predeclared identifiers</a> like <code>true</code> and <code>false</code> (and you can't change these or make your own).</p>\n\n<p>So, it's perfectly fine to set a variable scoped to <code>package main</code> to hold context for your program. Coming from a C/C++ background this took me a little time to get used to. Since the variables are package scoped, they do not suffer from <a href=\"https://softwareengineering.stackexchange.com/q/148108/41651\">the problems of global variables</a>. If something in another package needs such a variable, you will have to pass it explicitly.</p>\n\n<p>Don't be afraid to use package variables when it makes sense. This can help you reduce complexity in your program, and in a lot of cases make your custom handlers much simpler (where calling <code>http.HandlerFunc()</code> and passing a closure will suffice).</p>\n\n<p>Such a simple handler might look like this:</p>\n\n<pre><code>func simpleHandler(c Context, next http.Handler) http.Handler {\n  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    // FIXME Do something with our context\n    next.ServeHTTP(w, r)\n  })\n}\n</code></pre>\n\n<p>and be used by:</p>\n\n<pre><code>r = mux.NewRouter()\nhttp.Handle(\"/\", simpleHandler(c, r))\n</code></pre>\n\n<hr>\n\n<p>If your needs are more complex, you may need to implement your own <code>http.Handler</code>. Remember that an <code>http.Handler</code> is just an interface which implements <code>ServeHTTP(w http.ResponseWriter, r *http.Request)</code>.</p>\n\n<p>This is untested but should get you about 95% of the way there:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\ntype complicatedHandler struct {\n    h    http.Handler\n    opts ComplicatedOptions\n}\n\ntype ComplicatedOptions struct {\n    // FIXME All of the variables you want to set for this handler\n}\n\nfunc (m complicatedHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    // FIXME Do stuff before serving page\n\n    // Call the next handler\n    m.h.ServeHTTP(w, r)\n\n    // FIXME Do stuff after serving page\n}\n\nfunc ComplicatedHandler(o ComplicatedOptions) func(http.Handler) http.Handler {\n    return func(h http.Handler) http.Handler {\n        return complicatedHandler{h, o}\n    }\n}\n</code></pre>\n\n<p>To use it:</p>\n\n<pre><code>r := mux.NewRouter()\n// FIXME: Add routes to the mux\n\nopts := ComplicatedOptions{/* FIXME */}\nmyHandler := ComplicatedHandler(opts)\n\nhttp.Handle(\"/\", myHandler(r))\n</code></pre>\n\n<p>For a more developed handler example see <a href=\"https://github.com/goji/httpauth/blob/master/basic_auth.go\" rel=\"nofollow noreferrer\">basicAuth in goji/httpauth</a>, from which this example was shamelessly ripped off.</p>\n\n<hr>\n\n<p>Some further reading:</p>\n\n<ul>\n<li><a href=\"http://www.alexedwards.net/blog/a-recap-of-request-handling\" rel=\"nofollow noreferrer\">A Recap of Request Handling</a></li>\n<li><a href=\"http://www.alexedwards.net/blog/making-and-using-middleware\" rel=\"nofollow noreferrer\">Making and Using HTTP Middleware</a></li>\n<li><a href=\"https://github.com/justinas/alice\" rel=\"nofollow noreferrer\">justinas/alice</a> (for chaining lots of handlers)</li>\n</ul>\n"}], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6027, "favorite_count": 3, "answer_count": 1, "score": 7, "last_activity_date": 1436488892, "creation_date": 1435320938, "last_edit_date": 1435325054, "question_id": 31072961, "link": "https://stackoverflow.com/questions/31072961/passing-context-to-gorilla-mux-go-idioms", "title": "Passing context to gorilla mux - go idioms", "body": "<p>I'm reasonably new to golang and am trying to do work out the best way to do this idiomatically.</p>\n\n<p>I have an array of routes I am statically defining and passing to <code>gorilla/mux</code>. I am wrapping each handler function with something to time the request and handle panics (mainly so I could understand how the wrapping worked).</p>\n\n<p>I want them each to be able to have access to a 'context' - a struct that's going to be one-per-http-server, which might have things like database handles, config etc. What I don't want to do is use a static global variable.</p>\n\n<p>The way I'm currently doing it I can give the wrappers access to the context structure, but I can't see how to get this into the actual handler, as it wants that to be an <code>http.HandlerFunc</code>. I thought what I could do is convert <code>http.HandlerFunc</code> into a type of my own that was a receiver for <code>Context</code> (and do similarly for the wrappers, but (after much playing about) I couldn't then get <code>Handler()</code> to accept this.</p>\n\n<p>I can't help but think I'm missing something obvious here. Code below.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"html\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\ntype Route struct {\n    Name        string\n    Method      string\n    Pattern     string\n    HandlerFunc http.HandlerFunc\n}\n\ntype Context struct {\n    route *Route\n    // imagine other stuff here, like database handles, config etc.\n}\n\ntype Routes []Route\n\nvar routes = Routes{\n    Route{\n        \"Index\",\n        \"GET\",\n        \"/\",\n        index,\n    },\n    // imagine lots more routes here\n}\n\nfunc wrapLogger(inner http.Handler, context *Context) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        start := time.Now()\n\n        inner.ServeHTTP(w, r)\n\n        log.Printf(\n            \"%s\\t%s\\t%s\\t%s\",\n            r.Method,\n            r.RequestURI,\n            context.route.Name,\n            time.Since(start),\n        )\n    })\n}\n\nfunc wrapPanic(inner http.Handler, context *Context) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        defer func() {\n            if err := recover(); err != nil {\n                log.Printf(\"panic caught: %+v\", err)\n                http.Error(w, http.StatusText(500), 500)\n            }\n        }()\n\n        inner.ServeHTTP(w, r)\n    })\n}\n\nfunc newRouter() *mux.Router {\n\n    router := mux.NewRouter().StrictSlash(true)\n    for _, route := range routes {\n        // the context object is created here\n        context := Context {\n            &amp;route,\n            // imagine more stuff here\n        }\n        router.\n            Methods(route.Method).\n            Path(route.Pattern).\n            Name(route.Name).\n            Handler(wrapLogger(wrapPanic(route.HandlerFunc, &amp;context), &amp;context))\n    }\n\n    return router\n}\n\nfunc index(w http.ResponseWriter, r *http.Request) {\n    // I want this function to be able to have access to 'context'\n    fmt.Fprintf(w, \"Hello, %q\", html.EscapeString(r.URL.Path))\n}\n\nfunc main() {\n    fmt.Print(\"Starting\\n\");\n    router := newRouter()\n    log.Fatal(http.ListenAndServe(\"127.0.0.1:8080\", router))\n}\n</code></pre>\n\n<p>Here's <em>a</em> way to do it, but it seems pretty horrible. I can't help but think there must be some better way to do it - perhaps to subclass (?) <code>http.Handler</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"html\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\ntype Route struct {\n    Name        string\n    Method      string\n    Pattern     string\n    HandlerFunc ContextHandlerFunc\n}\n\ntype Context struct {\n    route  *Route\n    secret string\n}\n\ntype ContextHandlerFunc func(c *Context, w http.ResponseWriter, r *http.Request)\n\ntype Routes []Route\n\nvar routes = Routes{\n    Route{\n        \"Index\",\n        \"GET\",\n        \"/\",\n        index,\n    },\n}\n\nfunc wrapLogger(inner ContextHandlerFunc) ContextHandlerFunc {\n    return func(c *Context, w http.ResponseWriter, r *http.Request) {\n        start := time.Now()\n\n        inner(c, w, r)\n\n        log.Printf(\n            \"%s\\t%s\\t%s\\t%s\",\n            r.Method,\n            r.RequestURI,\n            c.route.Name,\n            time.Since(start),\n        )\n    }\n}\n\nfunc wrapPanic(inner ContextHandlerFunc) ContextHandlerFunc {\n    return func(c *Context, w http.ResponseWriter, r *http.Request) {\n        defer func() {\n            if err := recover(); err != nil {\n                log.Printf(\"panic caught: %+v\", err)\n                http.Error(w, http.StatusText(500), 500)\n            }\n        }()\n\n        inner(c, w, r)\n    }\n}\n\nfunc newRouter() *mux.Router {\n\n    router := mux.NewRouter().StrictSlash(true)\n    for _, route := range routes {\n        context := Context{\n            &amp;route,\n            \"test\",\n        }\n        router.Methods(route.Method).\n            Path(route.Pattern).\n            Name(route.Name).\n            HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n            wrapLogger(wrapPanic(route.HandlerFunc))(&amp;context, w, r)\n        })\n    }\n\n    return router\n}\n\nfunc index(c *Context, w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello, %q secret is %s\\n\", html.EscapeString(r.URL.Path), c.secret)\n}\n\nfunc main() {\n    fmt.Print(\"Starting\\n\")\n    router := newRouter()\n    log.Fatal(http.ListenAndServe(\"127.0.0.1:8080\", router))\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1435321917, "post_id": 31072865, "comment_id": 50165220, "body": "Can you post the error message you get?"}, {"owner": {"reputation": 716, "user_id": 3721165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ksspy.jpg?s=128&g=1", "display_name": "Thomas F.", "link": "https://stackoverflow.com/users/3721165/thomas-f"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1435322346, "post_id": 31072865, "comment_id": 50165495, "body": "@icza Will update the OP with that info. Just need to teamviewer my computer at home real quick. Thanks!"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1435323027, "post_id": 31072865, "comment_id": 50165905, "body": "Sounds like a bug in the Go runtime for me. Consider making a bug report. Can you simplify the example in a way that you still receive an error? What version of Go are you using?"}, {"owner": {"reputation": 716, "user_id": 3721165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ksspy.jpg?s=128&g=1", "display_name": "Thomas F.", "link": "https://stackoverflow.com/users/3721165/thomas-f"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1435323143, "post_id": 31072865, "comment_id": 50165978, "body": "@FUZxxl I&#39;m using go1.4.2 windows/amd64. I&#39;ll have a look at simplifying it here real quick and see if it still does it."}, {"owner": {"reputation": 716, "user_id": 3721165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ksspy.jpg?s=128&g=1", "display_name": "Thomas F.", "link": "https://stackoverflow.com/users/3721165/thomas-f"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1435323611, "post_id": 31072865, "comment_id": 50166286, "body": "@FUZxxl Added a link to a simplified version on golang, obviously it won&#39;t run on golang itself though."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1435324010, "post_id": 31072865, "comment_id": 50166554, "body": "Surely. I can&#39;t reproduce your problem on Linux though."}, {"owner": {"reputation": 716, "user_id": 3721165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ksspy.jpg?s=128&g=1", "display_name": "Thomas F.", "link": "https://stackoverflow.com/users/3721165/thomas-f"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1435324155, "post_id": 31072865, "comment_id": 50166641, "body": "@FUZxxl Strange, I&#39;ll look into filing that in a bug report."}], "answers": [{"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1435325985, "post_id": 31074299, "comment_id": 50167951, "body": "On UNIX-like operaitng systems, it&#39;s possible to start a program with no file descriptors open. It&#39;s merely a convention that file descriptors 0, 1, and 2 are open. It&#39;s weird that this is not allowed on Windows. Notice that starting a process with an empty file slice on Linux causes the process to be started with no file descriptors open."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1435331967, "post_id": 31074299, "comment_id": 50172015, "body": "The documentation says &quot;StartProcess is a low-level interface. The os/exec package provides higher-level interfaces.&quot; It&#39;s these kinds of details that are handled for you by <code>os&#47;exec</code> so unless you have some need to muck with lower level details you should use that instead."}, {"owner": {"reputation": 716, "user_id": 3721165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ksspy.jpg?s=128&g=1", "display_name": "Thomas F.", "link": "https://stackoverflow.com/users/3721165/thomas-f"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1435344494, "post_id": 31074299, "comment_id": 50178829, "body": "@DaveC Thanks, I&#39;ll have a look at exec again as well."}], "tags": [], "owner": {"reputation": 565, "user_id": 438740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8538ea463355ac8e5abb1741541f5ca0?s=128&d=identicon&r=PG", "display_name": "xen", "link": "https://stackoverflow.com/users/438740/xen"}, "is_accepted": true, "score": 2, "last_activity_date": 1435324884, "creation_date": 1435324884, "answer_id": 31074299, "question_id": 31072865, "link": "https://stackoverflow.com/questions/31072865/runtime-error-index-out-of-range-when-attempting-to-os-startprocess/31074299#31074299", "title": "Runtime Error: Index out of range when attempting to os.StartProcess", "body": "<p>You are getting the error because you do not set the file descriptors for Stderr and Stdout on your os.ProcAttr. It seems those get set automatically on linux, but you need to set them on windows.</p>\n\n<p>This is a working example:</p>\n\n<pre><code>func (srv *Server) StartServer() {\n  // Some stuff to make sure paths are correct\n\n  path := srv.Path + \"server.exe\"\n  var args = []string{\n    \"ip=\" + srv.IP,\n    \"un=\" + srv.Username,\n    \"pw=\" + srv.Password\n  }\n  var attr os.ProcAttr\n  attr.Files = []*os.File{nil, os.Stdout, os.Stderr}\n  proc, err := os.StartProcess(path, args, &amp;attr)\n  if err != nil {\n    panic(err)\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 716, "user_id": 3721165, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ksspy.jpg?s=128&g=1", "display_name": "Thomas F.", "link": "https://stackoverflow.com/users/3721165/thomas-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 31074299, "answer_count": 1, "score": 1, "last_activity_date": 1435324884, "creation_date": 1435320626, "last_edit_date": 1435323577, "question_id": 31072865, "link": "https://stackoverflow.com/questions/31072865/runtime-error-index-out-of-range-when-attempting-to-os-startprocess", "title": "Runtime Error: Index out of range when attempting to os.StartProcess", "body": "<p>I can't seem to figure out why it's doing this:</p>\n\n<p>I have a function setup like this:</p>\n\n<pre><code>func (srv *Server) StartServer() {\n  // Some stuff to make sure paths are correct\n\n  path := srv.Path + \"server.exe\"\n  var args = []string{\n    \"ip=\" + srv.IP,\n    \"un=\" + srv.Username,\n    \"pw=\" + srv.Password\n  }\n  proc, err := os.StartProcess(path, args, new(os.ProcAttr))\n  if err != nil {\n    panic(err)\n  }\n}\n</code></pre>\n\n<p>The StartProcess method throws an index out of range.</p>\n\n<p>I'm probably just missing something, but I just can't see it.</p>\n\n<p>Exact error as requested:</p>\n\n<pre><code>panic: runtime error: index out of range\n\ngoroutine 1 [running]:\nsyscall.StartProcess(0xc082052b70, 0x21, 0xc08200a6e0, 0x5, 0x5, 0xc08201dd60, 0x0, 0x0, 0x0, 0x0)\n        c:/go/src/syscall/exec_windows.go:322 +0x94c\nos.startProcess(0xc082052b70, 0x21, 0xc08200a6e0, 0x5, 0x5, 0xc08200a730, 0x5217e0, 0x0, 0x0)\n        c:/go/src/os/exec_posix.go:45 +0x482\nos.StartProcess(0xc082052b70, 0x21, 0xc08200a6e0, 0x5, 0x5, 0xc08200a730, 0x0, 0x0, 0x0)\n        c:/go/src/os/doc.go:24 +0x79\nmain.(*Server).StartServer(0x5efae0)\n        E:/build_test/SrvMgr.go:85 +0x4e6\nmain.main()\n        E:/build_test/SrvMgr.go:54 +0x141\n\ngoroutine 2 [runnable]:\nruntime.forcegchelper()\n        c:/go/src/runtime/proc.go:90\nruntime.goexit()\n        c:/go/src/runtime/asm_amd64.s:2232 +0x1\n\ngoroutine 3 [runnable]:\nruntime.bgsweep()\n        c:/go/src/runtime/mgc0.go:82\nruntime.goexit()\n        c:/go/src/runtime/asm_amd64.s:2232 +0x1\n\ngoroutine 4 [runnable]:\nruntime.runfinq()\n        c:/go/src/runtime/malloc.go:712\nruntime.goexit()\n        c:/go/src/runtime/asm_amd64.s:2232 +0x1\nexit status 2\n</code></pre>\n\n<p>Edit: Link to a simplified play.golang post reproducing it. I'm running go version 1.4.2 win/amd64</p>\n\n<p><a href=\"http://play.golang.org/p/S6kRLMyd2I\" rel=\"nofollow\">http://play.golang.org/p/S6kRLMyd2I</a></p>\n"}, {"tags": ["go", "path", "glob"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1435318417, "post_id": 31071382, "comment_id": 50162906, "body": "File names returned by <code>filepath.Glob()</code> are already absolute, aren&#39;t they?"}], "answers": [{"comments": [{"owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "edited": false, "score": 1, "creation_date": 1435320030, "post_id": 31072203, "comment_id": 50163962, "body": "If you use the relative path to glob, the path is relative, try <a href=\"http://play.golang.org/p/XiOivBFEhE\" rel=\"nofollow noreferrer\">this</a>, but thank you, I can make glob path abs then do glob, the path will be abs."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1435320461, "last_edit_date": 1435320461, "creation_date": 1435318557, "answer_id": 31072203, "question_id": 31071382, "link": "https://stackoverflow.com/questions/31071382/how-can-i-get-the-top-path-of-glob-path/31072203#31072203", "title": "How can I get the top path of glob path?", "body": "<p>File names returned by <a href=\"https://golang.org/pkg/path/filepath/#Glob\" rel=\"nofollow\"><code>filepath.Glob()</code></a> are already absolute (but read below).</p>\n\n<p>See this example:</p>\n\n<pre><code>fs, err := filepath.Glob(\"/dev/../dev/*\")\nif err != nil {\n    panic(err)\n}\nfor _, f := range fs {\n    fmt.Println(f, filepath.IsAbs(f))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>/dev/null true\n/dev/random true\n/dev/urandom true\n/dev/zero true\n</code></pre>\n\n<p>Try it on the <kbd><a href=\"http://play.golang.org/p/ABFGMhhgV0\" rel=\"nofollow\">Go Playground</a></kbd>.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>The returned file names are only absolute if the glob pattern is absolute. So the easiest way is to make the glob pattern absolute.</p>\n"}], "owner": {"reputation": 5911, "user_id": 1870054, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/QJydN.jpg?s=128&g=1", "display_name": "wener", "link": "https://stackoverflow.com/users/1870054/wener"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 31072203, "answer_count": 1, "score": 1, "last_activity_date": 1435320461, "creation_date": 1435316107, "last_edit_date": 1435320228, "question_id": 31071382, "link": "https://stackoverflow.com/questions/31071382/how-can-i-get-the-top-path-of-glob-path", "title": "How can I get the top path of glob path?", "body": "<p>e.g.</p>\n\n<pre><code>a/b/c* -&gt; a/b\na/b/c*/*/*b -&gt; a/b\n</code></pre>\n\n<p>Why I need this is because I want to get the abs path of globed filename.\nCode example:</p>\n\n<pre><code>files, _ := filepath.Glob(p)\ntop := __magic here__\nfor _, f := range files {\n    abs, _ := filepath.Abs(path.Join(top, f))\n    fmt.Println(abs)\n}\n</code></pre>\n\n<p>Is there any exists method for this purpose? otherwise I have to implement by myself.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The magic is make glob path abs first, then the glob return abs path.</p>\n"}, {"tags": ["parsing", "time", "go"], "answers": [{"comments": [{"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1435320823, "post_id": 31070554, "comment_id": 50164481, "body": "Your code seems to be equals to mine, and working. How strange... Thanks for the answer."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 1, "creation_date": 1435321646, "post_id": 31070554, "comment_id": 50165012, "body": "@EzequielMoreno The problem in your case is that your input string contains a leading and trailing quotation mark as part of the string. Remove those and it will work. See the edited answer."}, {"owner": {"reputation": 298, "user_id": 2935870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1652437319/picture?type=large", "display_name": "Agniswar Bakshi", "link": "https://stackoverflow.com/users/2935870/agniswar-bakshi"}, "edited": false, "score": 0, "creation_date": 1527229073, "post_id": 31070554, "comment_id": 88057291, "body": "If the input string is like below: 2018-05-24 16:19:15 , the above solution does not work. Any idea how it can be solved?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1479375387, "last_edit_date": 1479375387, "creation_date": 1435313553, "answer_id": 31070554, "question_id": 31070301, "link": "https://stackoverflow.com/questions/31070301/time-parse-with-custom-layout/31070554#31070554", "title": "time.Parse with custom layout", "body": "<p>Don't know what you did wrong (should post your code), but it is really just a simple function call:</p>\n\n<pre><code>s := \"4-JAN-12 9:30:14\"\nt, err := time.Parse(\"2-JAN-06 15:04:05\", s)\nfmt.Println(t, err)\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>2012-01-04 09:30:14 +0000 UTC &lt;nil&gt;\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/XW-TifrHbH\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Note that <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\"><code>time.Parse()</code></a> returns 2 values: the parsed <code>time.Time</code> value (if parsing succeeds) and an optional <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"nofollow noreferrer\"><code>error</code></a> value (if parsing fails).</p>\n\n<p>See the following example where I intentionally specify a wrong input string:</p>\n\n<pre><code>s := \"34-JAN-12 9:30:14\"\n\nif t, err := time.Parse(\"2-JAN-06 15:04:05\", s); err == nil {\n    fmt.Println(\"Success:\", t)\n} else {\n    fmt.Println(\"Failure:\", err)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Failure: parsing time \"34-JAN-12 9:30:14\": day out of range\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/1TQ7psUB--\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Now that you posted code and error message, your problem is that your input string contains a leading and trailing quotation mark!</p>\n\n<p>Remove the leading and trailing quotation mark and it will work. This is your case:</p>\n\n<pre><code>s := `\"4-JAN-12 9:30:14\"`\n\ns = s[1 : len(s)-1]\nif t, err := time.Parse(\"2-JAN-06 15:04:05\", s); err == nil {\n    fmt.Println(\"Success:\", t)\n} else {\n    fmt.Println(\"Failure:\", err)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/84BB9cxFjx\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Success: 2012-01-04 09:30:14 +0000 UTC\n</code></pre>\n"}], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1077, "favorite_count": 0, "accepted_answer_id": 31070554, "answer_count": 1, "score": 1, "last_activity_date": 1479375387, "creation_date": 1435312812, "last_edit_date": 1466778187, "question_id": 31070301, "link": "https://stackoverflow.com/questions/31070301/time-parse-with-custom-layout", "title": "time.Parse with custom layout", "body": "<p>I'm trying to parse this string pattern <code>\"4-JAN-12 9:30:14\"</code> into a <code>time.Time</code>.</p>\n\n<p>Tried <code>time.Parse(\"2-JAN-06 15:04:05\", inputString)</code> and many others but cannot get it working.</p>\n\n<p>I've read <a href=\"http://golang.org/pkg/time/#Parse\" rel=\"nofollow\">http://golang.org/pkg/time/#Parse</a> and <a href=\"https://gobyexample.com/time-formatting-parsing\" rel=\"nofollow\">https://gobyexample.com/time-formatting-parsing</a> but it seems there aren't any examples like this.</p>\n\n<p>Thanks!</p>\n\n<p>Edit:\nfull code:</p>\n\n<pre><code>type CustomTime time.Time\n\nfunc (t *CustomTime) UnmarshalJSON(b []byte) error {\n    auxTime, err := time.Parse(\"2-JAN-06 15:04:05\", string(b))\n    *t = CustomTime(auxTime)\n    return err\n}\n</code></pre>\n\n<blockquote>\n  <p>parsing time \"\"10-JAN-12 11:20:41\"\" as \"2-JAN-06 15:04:05\": cannot\n  parse \"\"24-JAN-15 10:27:44\"\" as \"2\"</p>\n</blockquote>\n"}, {"tags": ["dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 0, "creation_date": 1435302385, "post_id": 31066361, "comment_id": 50153548, "body": "@AerofoilKite isn&#39;t that what Intersec does? Intersect map?"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1435300067, "creation_date": 1435300067, "answer_id": 31066361, "question_id": 31066043, "link": "https://stackoverflow.com/questions/31066043/how-to-check-if-a-map-can-match-another-partially-in-golang/31066361#31066361", "title": "How to check if a map can match another partially in golang", "body": "<p>You check if the cardinality of the intersection between those two maps is greater than 0.</p>\n\n<p>See for instance <a href=\"https://github.com/deckarep/golang-set/blob/ef32fa3046d9f249d399f98ebaf9be944430fd1d/set.go#L78-L85\" rel=\"nofollow\">set.go <code>Intersect</code></a> in <a href=\"https://github.com/deckarep/golang-set\" rel=\"nofollow\"><code>deckarep/golang-set</code></a>.</p>\n\n<pre><code>// Returns a new set containing only the elements\n// that exist only in both sets.\n//\n// Note that the argument to Intersect\n// must be of the same type as the receiver\n// of the method. Otherwise, Intersect will\n// panic.\nIntersect(other Set) Set\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 2, "last_activity_date": 1435311255, "last_edit_date": 1435311255, "creation_date": 1435310937, "answer_id": 31069616, "question_id": 31066043, "link": "https://stackoverflow.com/questions/31066043/how-to-check-if-a-map-can-match-another-partially-in-golang/31069616#31069616", "title": "How to check if a map can match another partially in golang", "body": "<p>For <a href=\"http://play.golang.org/p/OxNLrXsvgr\" rel=\"nofollow\">example</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc Max(x, y int) int {\n    if x &gt; y {\n        return x\n    }\n    return y\n}\n\nfunc Intersect(as, bs []string) []string {\n    i := make([]string, 0, Max(len(as), len(bs)))\n    for _, a := range as {\n        for _, b := range bs {\n            if a == b {\n                i = append(i, a)\n            }\n        }\n    }\n    return i\n}\n\nfunc main() {\n\n    MAP1 := map[string][]string{\n        \"User\": []string{\"11\", \"33\"},\n        \"Type\": []string{\"A\"},\n    }\n\n    MAP2 := map[string][]string{\n        \"User\": []string{\"11\", \"17\"},\n        \"Type\": []string{\"B\"},\n    }\n\n    MAP3 := make(map[string][]string)\n\n    for k, _ := range MAP1 {\n        MAP3[k] = Intersect(MAP1[k], MAP2[k])\n    }\n\n    fmt.Println(MAP3) // MAP3 contains commonalities between MAP1 and MAP2\n}\n</code></pre>\n\n<p>Note that this solution does not exploit any potential performance optimizations (like assuming that the string arrays will be sorted in some way, or else) and hence has a runtime performance of O(m&nbsp;&bull;&nbsp;n<sup>2</sup>), where:</p>\n\n<ul>\n<li>m is the number of keys in the map (assumed to be the same for both maps)</li>\n<li>n is the number of elements in each string slice (assumed to be the same for both corresponding map entries)</li>\n</ul>\n\n<p>Which is okay but not great.</p>\n"}], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2863, "favorite_count": 1, "accepted_answer_id": 31069616, "answer_count": 2, "score": 1, "last_activity_date": 1435311255, "creation_date": 1435298772, "question_id": 31066043, "link": "https://stackoverflow.com/questions/31066043/how-to-check-if-a-map-can-match-another-partially-in-golang", "title": "How to check if a map can match another partially in golang", "body": "<p>Suppose, I have two <code>map[string]([]string)</code></p>\n\n<pre><code> MAP1 := map[string]([]string) {\n    \"User\" : []string{\"11\", \"33\"},\n    \"Type\" : []string{\"A\"},\n    }\n\n\nMAP2 := map[string]([]string) {\n    \"User\" : []string{\"11\", \"17\"},\n    \"Type\" : []string{\"B\"},\n    }\n</code></pre>\n\n<p>Here, <code>MAP1</code> matches <code>MAP2</code> partially.</p>\n\n<pre><code>User = 11 is in both map\n</code></pre>\n\n<p>How can I check this in a easy way?</p>\n"}, {"tags": ["pointers", "go", "interface"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1435298899, "post_id": 31065917, "comment_id": 50151781, "body": "In addition to what icza stated: Interface are <b>types</b> in Go, they are <i>not</i> syntactical sugar or magical wrappers. An interface type has the same status as builtin types like int32 or a user defined struct."}], "answers": [{"comments": [{"owner": {"reputation": 416, "user_id": 3397796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a35edbf1149d21b1e9be504f0213e3f?s=128&d=identicon&r=PG&f=1", "display_name": "LeckieNi", "link": "https://stackoverflow.com/users/3397796/leckieni"}, "edited": false, "score": 0, "creation_date": 1435299559, "post_id": 31065973, "comment_id": 50152082, "body": "So <code>b</code> is a type of <code>Interface{&amp;a, *Integer}</code> , and <i>Interface</i> is a type of types?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 416, "user_id": 3397796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a35edbf1149d21b1e9be504f0213e3f?s=128&d=identicon&r=PG&f=1", "display_name": "LeckieNi", "link": "https://stackoverflow.com/users/3397796/leckieni"}, "edited": false, "score": 0, "creation_date": 1435300175, "post_id": 31065973, "comment_id": 50152388, "body": "@LeckieNi Schematically, yes. But what happens is that an interface value is created automatically/implicitly holding the pair <code>(&amp;a, *Integer)</code> and this interface value is assigned to <code>b</code>. See edited answer."}, {"owner": {"reputation": 416, "user_id": 3397796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a35edbf1149d21b1e9be504f0213e3f?s=128&d=identicon&r=PG&f=1", "display_name": "LeckieNi", "link": "https://stackoverflow.com/users/3397796/leckieni"}, "edited": false, "score": 0, "creation_date": 1435310528, "post_id": 31065973, "comment_id": 50158165, "body": "And then <code>b</code> calls <code>b.Less(2)</code>, it is actually calling <code>(&amp;a).Less(2)</code>. And here &#39;s where auto-dereference happens?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 416, "user_id": 3397796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a35edbf1149d21b1e9be504f0213e3f?s=128&d=identicon&r=PG&f=1", "display_name": "LeckieNi", "link": "https://stackoverflow.com/users/3397796/leckieni"}, "edited": false, "score": 0, "creation_date": 1435314131, "post_id": 31065973, "comment_id": 50160333, "body": "@LeckieNi <code>b</code> holds a pointer value, of type <code>*Integer</code>. Since <code>Less()</code> has value receiver, this pointer will be dereferenced, and a copy of the pointed value will be made and used/passed as the value receiver of the method. Since <code>b</code> holds a pointer that is <code>&amp;a</code>, the value of <code>a</code> will be used. See edited answer."}, {"owner": {"reputation": 2562, "user_id": 216636, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7e9e3684b967676457914eeed61598e?s=128&d=identicon&r=PG", "display_name": "Marko Kevac", "link": "https://stackoverflow.com/users/216636/marko-kevac"}, "edited": false, "score": 0, "creation_date": 1435396852, "post_id": 31065973, "comment_id": 50191332, "body": "So, output of fmt.Println(reflect.TypeOf(b)) is lying and printing wrong type?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2562, "user_id": 216636, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7e9e3684b967676457914eeed61598e?s=128&d=identicon&r=PG", "display_name": "Marko Kevac", "link": "https://stackoverflow.com/users/216636/marko-kevac"}, "edited": false, "score": 0, "creation_date": 1435434594, "post_id": 31065973, "comment_id": 50202167, "body": "@MarkoKevac No, <code>fmt.Println()</code> doesn&#39;t lie, but it will print the <i>dynamic</i> type of <code>b</code>. The dynamic type of <code>b</code> is indeed <code>*Integer</code>, but the <i>static</i> type of <code>b</code> is <code>LessAdder</code> and the static type is what determines what you can do with a value and what operators or methods are allowed on it. See edited answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 7, "last_activity_date": 1435434711, "last_edit_date": 1435434711, "creation_date": 1435298487, "answer_id": 31065973, "question_id": 31065917, "link": "https://stackoverflow.com/questions/31065917/confused-with-implicit-pointer-dereference-when-assigning-a-pointer-to-interface/31065973#31065973", "title": "Confused with implicit pointer dereference when assigning a pointer to interface in Go", "body": "<p>Your last sentence:</p>\n\n<blockquote>\n  <p><strong>\"Since <code>b</code> is a pointer type to <code>Integer</code>, then dereferencing it should work.\"</strong></p>\n</blockquote>\n\n<p>Stop right there. <code>b</code> is <strong>not</strong> a variable of pointer type and therefore you can't <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">dereference</a> it.</p>\n\n<p>It is a variable of <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow\">interface type</a> which is schematically a pair of a value and a type (value,type), holding <code>&amp;a</code> as the value and <code>*Integer</code> as the type (blog article <a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow\">The Laws of Reflection</a>, section <a href=\"http://blog.golang.org/laws-of-reflection#TOC_3.\" rel=\"nofollow\">The representation of an interface</a>).</p>\n\n<p>This is a declaration of a variable of pointer type, <code>*Integer</code>:</p>\n\n<pre><code>var ip *Integer\n</code></pre>\n\n<p>And this is one of an interface type:</p>\n\n<pre><code>var intf LessAdder\n</code></pre>\n\n<p>When you do this:</p>\n\n<pre><code>var b LessAdder = &amp;a\n</code></pre>\n\n<p>What happens is that an interface value (of type <code>LessAdder</code>) is created automatically/implicitly which will hold the value <code>&amp;a</code> (and the type <code>*Integer</code>). This is a valid operation because the type of <code>&amp;a</code> (which is <code>*Integer</code>) implements the interface <code>LessAdder</code>: the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow\">method set</a> of <code>*Integer</code> is a superset of the interface <code>LessAdder</code> (in this case they are equal, the method set of an interface type is its interface).</p>\n\n<p>Now when you call <code>b.Less(2)</code>, since <code>Less()</code> has a value receiver, the pointer will be dereferenced and a copy of the pointed value will be made and used/passed as the value receiver of the method <code>Less()</code>.</p>\n\n<p><code>fmt.Println(reflect.TypeOf(b))</code> doesn't lie, but it will print the <em>dynamic</em> type of <code>b</code>. The dynamic type of <code>b</code> is indeed <code>*Integer</code>, but the <em>static</em> type of <code>b</code> is <code>LessAdder</code> and the static type is what determines what you can do with a value and what operators or methods are allowed on it.</p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1435301555, "creation_date": 1435301555, "answer_id": 31066762, "question_id": 31065917, "link": "https://stackoverflow.com/questions/31065917/confused-with-implicit-pointer-dereference-when-assigning-a-pointer-to-interface/31066762#31066762", "title": "Confused with implicit pointer dereference when assigning a pointer to interface in Go", "body": "<p><code>LessAdder</code> is declared as an interface with the methods <code>Less</code> and <code>Add</code>. Since <code>Add</code> is declared with a receiver of <code>*Integer</code>, a <code>*Integer</code> can be a <code>LessAdder</code>; an <code>Integer</code> can't. When you do <code>var b LessAdder = &amp;a</code>, it's the pointer to <code>a</code> that's stored in the interface <code>b</code>.</p>\n\n<p>The automatic indirection occurs at the call to <code>b.Less(2)</code>, because both methods on <code>*Integer</code> and methods on <code>Integer</code> contribute to the method set of <code>*Integer</code>.</p>\n\n<p>You can't use <code>*b</code> because although <code>b</code> <em>contains</em> a <code>*Integer</code>, statically its type is <code>LessAdder</code>, not <code>*Integer</code>. Leaving aside the representation of interfaces, <code>LessAdder</code> isn't a pointer type, and <code>*b</code>, if it was allowed, would have no expressible type at all.</p>\n\n<p>You can use a <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a> to access <code>b</code> as an <code>Integer *</code> again; <code>b.(*Integer)</code> is an expression of type <code>*Integer</code>, and <code>*b.(*Integer)</code> is an <code>Integer</code>. Both of these will run-time panic if the value in <code>b</code> is not a <code>*Integer</code> after all.</p>\n"}], "owner": {"reputation": 416, "user_id": 3397796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a35edbf1149d21b1e9be504f0213e3f?s=128&d=identicon&r=PG&f=1", "display_name": "LeckieNi", "link": "https://stackoverflow.com/users/3397796/leckieni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 3, "answer_count": 2, "score": 4, "last_activity_date": 1435434711, "creation_date": 1435298178, "last_edit_date": 1435300591, "question_id": 31065917, "link": "https://stackoverflow.com/questions/31065917/confused-with-implicit-pointer-dereference-when-assigning-a-pointer-to-interface", "title": "Confused with implicit pointer dereference when assigning a pointer to interface in Go", "body": "<p>I am new to Go, and I am studying its interface feature.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"reflect\"\n)\n\ntype Integer int\n\nfunc (a Integer) Less(b Integer) bool {\n        return a &lt; b\n}\n\nfunc (a *Integer) Add(b Integer) {\n        *a += b\n}\n\ntype LessAdder interface {\n        Less(b Integer) bool\n        Add(b Integer)\n}\n\nvar a Integer = 1\n\nvar b LessAdder = &amp;a\n\nfunc main() {\n        fmt.Println(reflect.TypeOf(b))\n        fmt.Println(b.Less(2))\n        b.Add(a)\n        fmt.Println(a)\n\n}\n</code></pre>\n\n<p>And it will output the the following:</p>\n\n<pre><code>*main.Integer\ntrue\n2\n</code></pre>\n\n<p>Well, this works pretty well.</p>\n\n<p>The Point is:\nHow <code>var b LessAdder = &amp;a</code> works. Does the pointer auto-dereference happens right here, or when b invokes member method?</p>\n\n<p>The output <code>*main.Integer</code> tells us that b is a pointer to type <code>Integer</code>, hence it is the second case.</p>\n\n<p>Then the tricky thing comes:\nwhen I add <code>fmt.Pringln(*b)</code> to the code, the compiler comes with an error:</p>\n\n<pre><code> demo/demo1\n./demo1.go:31: invalid indirect of b (type LessAdder)\n</code></pre>\n\n<p>And it confuses me. <strong>Since <code>b</code> is a pointer type to <code>Integer</code>, then dereferencing it should work. But why not?</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2991, "user_id": 185371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8c6856daddead557c2ed499f3c028?s=128&d=identicon&r=PG", "display_name": "iwat", "link": "https://stackoverflow.com/users/185371/iwat"}, "edited": false, "score": 2, "creation_date": 1435299239, "post_id": 31064688, "comment_id": 50151920, "body": "Even <a href=\"http://stackoverflow.com/questions/16959992/creating-map-with-without-make\" title=\"creating map with without make\">stackoverflow.com/questions/16959992/&hellip;</a> may be the same question, @Jsor&#39;s answer is clearer for the question of why."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 39, "creation_date": 1435330586, "post_id": 31064737, "comment_id": 50171127, "body": "Note that the first specifies an <i>initial allocation</i>; it can still grow beyond the size specified with the same performance as not using a size. The benefit is that the first 15 (in this example) items added to the map will not require any map resizing. I mention this because I&#39;ve seen people refer to a map <code>make</code> and say it means &quot;make a map with at most 15 items&quot; when instead it should be interpreted as &quot;a map with room for at least 15 items&quot; or &quot;a map with around 15 items&quot;."}, {"owner": {"reputation": 860, "user_id": 4459261, "user_type": "registered", "profile_image": "https://graph.facebook.com/1038604900/picture?type=large", "display_name": "Bharath Ram", "link": "https://stackoverflow.com/users/4459261/bharath-ram"}, "edited": false, "score": 1, "creation_date": 1515016037, "post_id": 31064737, "comment_id": 83146112, "body": "I tried to time both the cases and looks like map literal is faster in all the cases. Sample code is <a href=\"https://repl.it/repls/CriticalRepentantAstrangiacoral\" rel=\"nofollow noreferrer\">repl.it/repls/CriticalRepentantAstrangiacoral</a> . Any thoughts on this?"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 860, "user_id": 4459261, "user_type": "registered", "profile_image": "https://graph.facebook.com/1038604900/picture?type=large", "display_name": "Bharath Ram", "link": "https://stackoverflow.com/users/4459261/bharath-ram"}, "edited": false, "score": 0, "creation_date": 1515389883, "post_id": 31064737, "comment_id": 83267558, "body": "@BharathRam if this is true, it&#39;s probably a compiler bug and will change from release to release. Also, have you tried swapping the order you do the two cases in? It&#39;s possible some string optimization stuff is happening behind the scenes, since you&#39;re using the same strings for both benchmarks."}, {"owner": {"reputation": 860, "user_id": 4459261, "user_type": "registered", "profile_image": "https://graph.facebook.com/1038604900/picture?type=large", "display_name": "Bharath Ram", "link": "https://stackoverflow.com/users/4459261/bharath-ram"}, "edited": false, "score": 0, "creation_date": 1515425329, "post_id": 31064737, "comment_id": 83285321, "body": "Looks like the result is kind of changing when I try it in the online compiler. However, your point also seems to be correct and it has some effect on the running time. It could be doing some kind of caching under the hood. Thanks."}, {"owner": {"reputation": 80, "user_id": 586081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jq043.jpg?s=128&g=1", "display_name": "asido", "link": "https://stackoverflow.com/users/586081/asido"}, "edited": false, "score": 0, "creation_date": 1566281259, "post_id": 31064737, "comment_id": 101595907, "body": "The benchmark is flawed. Swapping the loop order inverses the results making <code>make()</code> faster in most cases."}, {"owner": {"reputation": 185, "user_id": 7126092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1dde6979c03150ddb8275e5321d925d?s=128&d=identicon&r=PG&f=1", "display_name": "\u8fbd\u5317\u72e0\u4eba", "link": "https://stackoverflow.com/users/7126092/%e8%be%bd%e5%8c%97%e7%8b%a0%e4%ba%ba"}, "edited": false, "score": 0, "creation_date": 1582520307, "post_id": 31064737, "comment_id": 106792149, "body": "Just wonder the capacity of the second form"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 185, "user_id": 7126092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1dde6979c03150ddb8275e5321d925d?s=128&d=identicon&r=PG&f=1", "display_name": "\u8fbd\u5317\u72e0\u4eba", "link": "https://stackoverflow.com/users/7126092/%e8%be%bd%e5%8c%97%e7%8b%a0%e4%ba%ba"}, "edited": false, "score": 0, "creation_date": 1582520354, "post_id": 31064737, "comment_id": 106792160, "body": "@\u8fbd\u5317\u72e0\u4eba the same as the number of elements"}], "tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": true, "score": 181, "last_activity_date": 1561151470, "last_edit_date": 1561151470, "creation_date": 1435291723, "answer_id": 31064737, "question_id": 31064688, "link": "https://stackoverflow.com/questions/31064688/which-is-the-nicer-way-to-initialize-a-map/31064737#31064737", "title": "Which is the nicer way to initialize a map?", "body": "<p>One allows you to initialize capacity, one allows you to initialize values:</p>\n\n<pre><code>// Initializes a map with space for 15 items before reallocation\nm := make(map[string]int32, 15)\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>// Initializes a map with an entry relating the name \"bob\" to the number 5\nm := map[string]int{\"bob\": 5} \n</code></pre>\n\n<p>For an empty map with capacity 0, they're the same and it's just preference.</p>\n"}], "owner": {"reputation": 2991, "user_id": 185371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8c6856daddead557c2ed499f3c028?s=128&d=identicon&r=PG", "display_name": "iwat", "link": "https://stackoverflow.com/users/185371/iwat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94508, "favorite_count": 13, "closed_date": 1435299133, "accepted_answer_id": 31064737, "answer_count": 1, "score": 112, "last_activity_date": 1613568189, "creation_date": 1435291437, "last_edit_date": 1613568189, "question_id": 31064688, "link": "https://stackoverflow.com/questions/31064688/which-is-the-nicer-way-to-initialize-a-map", "closed_reason": "Duplicate", "title": "Which is the nicer way to initialize a map?", "body": "<p>As <code>map</code> is a reference type. What is difference between:?</p>\n\n<pre><code>m := make(map[string]int32)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>m := map[string]int32{}\n</code></pre>\n"}, {"tags": ["http", "go", "proxy"], "comments": [{"owner": {"reputation": 1344, "user_id": 1608670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b2ed05ecccc3ba0780dd388ae719cd?s=128&d=identicon&r=PG", "display_name": "Ivan Chau", "link": "https://stackoverflow.com/users/1608670/ivan-chau"}, "edited": false, "score": 1, "creation_date": 1435314166, "post_id": 31064399, "comment_id": 50160359, "body": "You can also look at <a href=\"http://golang.org/src/net/http/transport.go?h=proxy#L120\" rel=\"nofollow noreferrer\">func ProxyFromEnvironment</a> as a reference."}], "answers": [{"tags": [], "owner": {"reputation": 390, "user_id": 2027832, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/bhdnF.jpg?s=128&g=1", "display_name": "Buzz LIghtyear", "link": "https://stackoverflow.com/users/2027832/buzz-lightyear"}, "is_accepted": true, "score": 0, "last_activity_date": 1435316606, "last_edit_date": 1435316606, "creation_date": 1435298674, "answer_id": 31066020, "question_id": 31064399, "link": "https://stackoverflow.com/questions/31064399/golang-program-determine-if-user-uses-proxy/31066020#31066020", "title": "golang program determine if user uses proxy", "body": "<p>Thanks for the suggestion. Now I am able to make it work. Below is the modified code.</p>\n\n<pre><code>tr := &amp;http.Transport{}\ntr.DisableKeepAlives = true\nif len(proxy) != 0 { // Set the proxy only if the proxy param is specified\n    proxyUrl, err := url.Parse(proxy)\n    if err == nil {\n        tr.Proxy = http.ProxyURL(proxyUrl)\n    }\n }\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 2027832, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/bhdnF.jpg?s=128&g=1", "display_name": "Buzz LIghtyear", "link": "https://stackoverflow.com/users/2027832/buzz-lightyear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 31066020, "answer_count": 1, "score": 0, "last_activity_date": 1435316606, "creation_date": 1435289302, "last_edit_date": 1435300283, "question_id": 31064399, "link": "https://stackoverflow.com/questions/31064399/golang-program-determine-if-user-uses-proxy", "title": "golang program determine if user uses proxy", "body": "<p>I want my golang http client to use a proxy only if the user provides the proxy value.  </p>\n\n<pre><code>// Make HTTP GET/POST request\nproxyUrl, err := url.Parse(proxy)\ntr := &amp;http.Transport{\n      DisableKeepAlives: true,\n      Proxy:             http.ProxyURL(proxyUrl),\n}\n</code></pre>\n\n<p>The above code always tries to connect through proxy even if the proxy variable is blank. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1435287079, "post_id": 31063874, "comment_id": 50148307, "body": "copy whole HTTP package, rename it to MyHTTP, do whatever changes. not stupid at all. Go is just sources and a compiler. libraries or packages in go just set of sources."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1435300547, "post_id": 31063874, "comment_id": 50152538, "body": "Use <a href=\"http://godoc.org/net/http/httptest#Server\" rel=\"nofollow noreferrer\">godoc.org/net/http/httptest#Server</a>."}, {"owner": {"reputation": 2706, "user_id": 907060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/639864af1118b200b9de3765c2daa651?s=128&d=identicon&r=PG", "display_name": "saul.shanabrook", "link": "https://stackoverflow.com/users/907060/saul-shanabrook"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1435320441, "post_id": 31063874, "comment_id": 50164220, "body": "@ThunderCat that&#39;s perfect! If you add it as an answer I&#39;ll accept it. Don&#39;t know how I didn&#39;t find that package before..."}, {"owner": {"reputation": 2706, "user_id": 907060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/639864af1118b200b9de3765c2daa651?s=128&d=identicon&r=PG", "display_name": "saul.shanabrook", "link": "https://stackoverflow.com/users/907060/saul-shanabrook"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1435321604, "post_id": 31063874, "comment_id": 50164984, "body": "@JiangYD Yeah I guess that would work, it just doesn&#39;t seem very attractive. For one, if they update their http code, then I have to go in and re copy and paste. also in version control, it is a bit confusing to have all this code that I didn&#39;t write."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1435383611, "post_id": 31063874, "comment_id": 50188607, "body": "@saul.shanabrook that is...complete out of my understand to your question.<code>I wanna pass a context to the whole server, not just to each incoming request. Is this just impossible?</code>  I mean the the answer you accepted\u2013  Jiang YD"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1435324511, "creation_date": 1435324511, "answer_id": 31074169, "question_id": 31063874, "link": "https://stackoverflow.com/questions/31063874/go-context-with-http-server/31074169#31074169", "title": "Go Context with http.server", "body": "<p>Use <a href=\"http://godoc.org/net/http/httptest#Server\" rel=\"nofollow\">httptest.Server</a> to create a server that you can start and stop in tests.</p>\n\n<p>If you do use the <a href=\"http://godoc.org/net/http#Server\" rel=\"nofollow\">http.Server</a> directly, you can break the Serve loop by closing the <a href=\"http://godoc.org/net#Listener\" rel=\"nofollow\">net.Listener</a>. When a net.Listener is closed, any blocked Accept operations are unblocked and return errors. The Serve function returns if Accept returns a permanent error.</p>\n"}], "owner": {"reputation": 2706, "user_id": 907060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/639864af1118b200b9de3765c2daa651?s=128&d=identicon&r=PG", "display_name": "saul.shanabrook", "link": "https://stackoverflow.com/users/907060/saul-shanabrook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 31074169, "answer_count": 1, "score": 0, "last_activity_date": 1435324511, "creation_date": 1435285479, "question_id": 31063874, "link": "https://stackoverflow.com/questions/31063874/go-context-with-http-server", "title": "Go Context with http.server", "body": "<p>In order to test a server that I am writing, I want to be able to start and stop it in the testing framework.</p>\n\n<p>To do so, I am hoping I can integrate <a href=\"https://godoc.org/golang.org/x/net/context\" rel=\"nofollow\">the context package</a> in with the http.Server struct. I want to be able to stop the server when I call the <code>Done</code> function and the <code>ctx.Done()</code> channel returns something.</p>\n\n<p>What I would love to do would be to just modify <a href=\"https://github.com/golang/go/blob/release-branch.go1.4/src/net/http/server.go#L1721-L1753\" rel=\"nofollow\">the http.Server.Serve() method</a>, to accept a context.Context and check if it is done, on each iteration of the for loop, like this:</p>\n\n<pre><code>func (srv *server) Serve(ctx context.Context, l net.Listener) error {\n    defer l.Close()\n    var tempDelay time.Duration // how long to sleep on accept failure\n    for {\n        select {\n        case &lt;-ctx.Done():\n            return nil\n        default:\n        }\n        ... rest is same as original\n</code></pre>\n\n<p>However it seems like if I wanna add that check inside the for loop, I would have to rewrite a lot of the methods, because this method calls other private methods (like http.server.srv), which in turn call other private methods....</p>\n\n<p>I also notice that the for loop will stop when the Accept() method on the listener returns an error.</p>\n\n<p>However, I can't seem to figure out a way to get a listener to output an error from it's accept method without accessing its private methods as well.</p>\n\n<p>It seems like I am doing something very stupid and wrong if I have to copy and paste half the http library just to let the server stop using the context package.</p>\n\n<p>I know there are lots of solutions around for supporting context canceling for the ServeHTTP function, but that isn't what I am talking about. I wanna pass a context to the whole server, not just to each incoming request.</p>\n\n<p>Is this just impossible?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2889190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/520babd6a4afbb2fdcfd75223bb390f2?s=128&d=identicon&r=PG&f=1", "display_name": "eric", "link": "https://stackoverflow.com/users/2889190/eric"}, "edited": false, "score": 0, "creation_date": 1435272974, "post_id": 31062129, "comment_id": 50144792, "body": "That would be sensible, but this was just an example API response that was simplified. This approach wouldn&#39;t handle having nested objects, arrays, or numbers in the response."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 51, "user_id": 2889190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/520babd6a4afbb2fdcfd75223bb390f2?s=128&d=identicon&r=PG&f=1", "display_name": "eric", "link": "https://stackoverflow.com/users/2889190/eric"}, "edited": false, "score": 0, "creation_date": 1435273258, "post_id": 31062129, "comment_id": 50144886, "body": "@eric the option I linked to might better suit your needs then. The approach I mention could still work, it&#39;s just anywhere where the property names could change you need a <code>map[string]TheType</code>. Keep in mind you could have maps within maps or an object that is mainly static and has a couple of maps inside it for these particular properties that change."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1435273086, "last_edit_date": 1495540710, "creation_date": 1435272696, "answer_id": 31062129, "question_id": 31062088, "link": "https://stackoverflow.com/questions/31062088/decode-multiple-json-fields-into-one-in-golang/31062129#31062129", "title": "Decode Multiple JSON Fields into one in Golang", "body": "<p>Use a <code>map[string]string</code>. That is the equivalent structure in Go. You're looking at those as being structs because their objects, and that's the sensible thing to do. Anytime you see different values for the property names that's your clue that a map is the only reasonable representation of the data in Go.</p>\n\n<p>If you need to normalize/have static typing implement a helper function called <code>NameFromMap(data map[string]string) (*Name, error)</code>. Put the switch statement in there to deal with the various values you can have for the keys.</p>\n\n<p>Edit: you could also implement <code>UnmarshalJSON</code> for your type. You would just put this switch statement I allude to there. Here's an example; <a href=\"https://stackoverflow.com/questions/23798283/golang-unmarshal-json\">How do I Unmarshal JSON?</a></p>\n\n<p>I personally prefer the first method I said because this sort of abstracts a step that I'd rather see called explicitly.</p>\n"}], "owner": {"reputation": 51, "user_id": 2889190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/520babd6a4afbb2fdcfd75223bb390f2?s=128&d=identicon&r=PG&f=1", "display_name": "eric", "link": "https://stackoverflow.com/users/2889190/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1449, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1435273086, "creation_date": 1435272494, "question_id": 31062088, "link": "https://stackoverflow.com/questions/31062088/decode-multiple-json-fields-into-one-in-golang", "title": "Decode Multiple JSON Fields into one in Golang", "body": "<p>I am working with an API that, frustratingly, has field names that vary for the same value. For example, one API response could look like this:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>{\n  \"PersonFirstName\": \"John\",\n  \"PersonLastName\": \"Smith\"\n}\n</code></pre>\n\n\n\n<p>while another looks like this: </p>\n\n<pre class=\"lang-js prettyprint-override\"><code>{\n  \"FirstNm\": \"John\",\n  \"LastNm\": \"Smith\"\n}\n</code></pre>\n\n<p>\nSuppose then I had a struct which I would like to decode my JSON to. It might look like this:</p>\n\n<pre><code>type Name struct {\n    FirstName string\n    LastName  string\n}\n</code></pre>\n\n<p>Typically I would just be able to do the following if the API was consistent:</p>\n\n<pre><code>type Name struct {\n    FirstName string `json:\"PersonFirstName\"`\n    LastName  string `json:\"PersonLastName\"`\n}\n</code></pre>\n\n<p>and then use the built-in <a href=\"http://golang.org/pkg/encoding/json/#Decoder.Decode\" rel=\"noreferrer\">JSON decoder</a> to build the struct. When there are multiple field values like this, though, I don't know a clean way to decode the JSON into a struct. Any ideas?</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1435272097, "post_id": 31061994, "comment_id": 50144525, "body": "You could always produce the filtered results back in your Go code before this executes and remove the conditional altogether."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1435312256, "post_id": 31061994, "comment_id": 50159200, "body": "Use <code>*template.Template</code>&#39;s <code>Funcs</code> method to define a function that tests for even numbers and use that in your if statement."}, {"owner": {"reputation": 325, "user_id": 4491610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fee80b55b798ffc5a55c609828050b?s=128&d=identicon&r=PG&f=1", "display_name": "ryzhak", "link": "https://stackoverflow.com/users/4491610/ryzhak"}, "edited": false, "score": 0, "creation_date": 1435324445, "post_id": 31061994, "comment_id": 50166848, "body": "Thanks everybody for your help!"}], "owner": {"reputation": 325, "user_id": 4491610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21fee80b55b798ffc5a55c609828050b?s=128&d=identicon&r=PG&f=1", "display_name": "ryzhak", "link": "https://stackoverflow.com/users/4491610/ryzhak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435271902, "creation_date": 1435271902, "question_id": 31061994, "link": "https://stackoverflow.com/questions/31061994/how-can-i-show-elements-with-only-even-index-in-a-viewusing-beego-framework", "title": "How can I show elements with only even index in a view(using Beego framework)?", "body": "<p>So the problem is that I can not show even elements in my view file.\nI have the following code in my view file:</p>\n\n<pre>\n\n    {{range $i, $stream := .d}}\n        {{if $i % 2 == 0}}\n            {{$stream.Channel.Status}}\n        {{end}}\n    {{end}}\n\n</pre>\n\n<p>From the docs I've read that \"You CANNOT use conditional expressions in if. Only boolean values are acceptable.\"</p>\n\n<p>So how can I implement it?</p>\n\n<p>Thanks in advance</p>\n"}]