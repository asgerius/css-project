[{"tags": ["regex", "perl", "akamai"], "answers": [{"tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1573076847, "last_edit_date": 1573076847, "creation_date": 1573075309, "answer_id": 58738672, "question_id": 58737487, "link": "https://stackoverflow.com/questions/58737487/regex-to-filter-email-address-in-urls/58738672#58738672", "title": "Regex to filter email address in Urls", "body": "<p>Your examples are not very good at explanation of the problem. The main issue is how to identify 'mail' which you would like to remove.</p>\n\n<p>I would take other approach:</p>\n\n<pre><code>use strict;\nuse warnings;\n\nuse Data::Dumper;\n\nmy $debug = 0;\n\nmy %url;\n\nwhile( &lt;DATA&gt; ) {\n    print if $debug;\n\n    chomp;\n\n    m|(https{0,1})://([\\w\\d\\.]+)/(.*)\\?(.*)|;\n\n    @url{qw(proto dn path query)} = ($1,$2,$3,$4);\n\n    print Dumper(\\%url) if $debug;\n\n    # now do whatever your heart desire with $url{query}\n\n    $url{query} =~ /(.*=)/;\n    $url{query} = $1;\n\n    print Dumper(\\%url) if $debug;\n\n    printf \"%s://%s/%s/%s\\n\",\n                $url{proto},    # protocol\n                $url{dn},       # domain name\n                $url{path},     # directory path\n                $url{query};    # query\n\n}\n\n__DATA__\nhttp://www.example.org/en-us?email=abc@gmail.com\nhttps://www.example.org/en-us/sompePage/SomeStructure?query=abc.gmail.com\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1573097644, "post_id": 58739343, "comment_id": 103772746, "body": "not sure what the confusion is. All i want is to strip the email id from url.  the rest of the url remails same. I am trying to find the regex that would find the email in url"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1573098160, "post_id": 58739343, "comment_id": 103772844, "body": "Will you have any other parameters in query? What do you plan to do with them? See above <code>s&#47;[\\w\\d\\.\\-]@[\\w\\d\\.\\*]&#47;&#47;</code> it should strip e-mail address if there is no other parameters provided. Otherwise you need to provide some &#39;<i>stop</i>&#39; after e-mail and probably this &#39;<i>stop</i>&#39; will be <b>&amp;</b> symbol (you need to see how it encoded in query). For example <code>abc.gmail.com</code> does not <i>match</i> e-mail address (e-mail should look like <b>user@domain</b> where user can include <i>letters/digits/./-</i> and domain <i>letters/digits/./-</i>)."}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "edited": false, "score": 0, "creation_date": 1573098703, "post_id": 58739343, "comment_id": 103772944, "body": "Please check following <a href=\"https://stackoverflow.com/questions/37703864/regular-expression-to-validate-an-email-in-perl\">question</a> about verification of e-mail address. Particulary you should refer to <a href=\"https://www.w3.org/Protocols/rfc822/#z8\" rel=\"nofollow noreferrer\">RFC822 Section 6.1</a> for email address &#39;specification&#39;. Sorry, in previous reply please read <code>s&#47;[\\w\\d\\.\\-]+@[\\w\\d\\.]+&#47;&#47;</code>"}], "tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1573098838, "last_edit_date": 1573098838, "creation_date": 1573078893, "answer_id": 58739343, "question_id": 58737487, "link": "https://stackoverflow.com/questions/58737487/regex-to-filter-email-address-in-urls/58739343#58739343", "title": "Regex to filter email address in Urls", "body": "<p>Well I have read your question once more and realized that probably akamai allows only regex modification and do not includes full fledged perl scripts.</p>\n\n<p>Then probably what you looking for will be <code>s|=.*|=|</code> or <code>s/=.*/=/</code></p>\n\n<pre><code>use strict;\nuse warnings;\n\nwhile( &lt;DATA&gt; ) {\n    s|=.*|=|;\n    print;\n}\n\n__DATA__\nwww.mydomain.com/en-us?email=abc@gmail.com\nwww.mydomain.com/en-us/sompePage/SomeStructure?query=abc.gmail.com\n</code></pre>\n\n<p>But again this method does not identify <strong>e-mail</strong> in query. Your question is not complete to make full judgement on the problem.</p>\n\n<p>You could try <code>s/[\\w\\d\\.\\-]+@[\\w\\d\\.]+//</code> as <strong>e-mail</strong> matching substitute regex. </p>\n"}, {"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": -1, "last_activity_date": 1573118160, "creation_date": 1573118160, "answer_id": 58745434, "question_id": 58737487, "link": "https://stackoverflow.com/questions/58737487/regex-to-filter-email-address-in-urls/58745434#58745434", "title": "Regex to filter email address in Urls", "body": "<p>The code for <a href=\"https://metacpan.org/release/Email-Valid/source/lib/Email/Valid.pm\" rel=\"nofollow noreferrer\">Email::Valid</a> contains a <a href=\"https://metacpan.org/release/Email-Valid/source/lib/Email/Valid.pm#L402\" rel=\"nofollow noreferrer\">regex for validating an email address</a>. It's rather more complex than most people think though :-)</p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 8941283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rYiv3.jpg?s=128&g=1", "display_name": "Josh Cheshire", "link": "https://stackoverflow.com/users/8941283/josh-cheshire"}, "is_accepted": true, "score": 0, "last_activity_date": 1573154646, "last_edit_date": 1573154646, "creation_date": 1573152398, "answer_id": 58755165, "question_id": 58737487, "link": "https://stackoverflow.com/questions/58737487/regex-to-filter-email-address-in-urls/58755165#58755165", "title": "Regex to filter email address in Urls", "body": "<p><strong>EDIT:</strong> </p>\n\n<p>Looking more closely, I forgot we had added the Match with Regular Expressions. Our RegEx engine defaults to PCRE syntax, so you could theoretically make a comprehensive Match in the whole query string:\n<a href=\"https://i.stack.imgur.com/OfG3v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OfG3v.png\" alt=\"match on regular expression\"></a></p>\n\n<p>Double check and test on the Staging platform before you commit. And double check the RegEx. I took that from <a href=\"https://emailregex.com\" rel=\"nofollow noreferrer\">emailregex.com</a> and didn't test it myself.</p>\n\n<p><strong>ORIGINAL:</strong></p>\n\n<p>With Akamai, the Property Manager tool lets you do this with a new rule. You should check the documentation and test before deploying, or consult with your account team for more specific questions.</p>\n\n<p>In the rule, you'll want to add a match for the query string like so:\n<a href=\"https://i.stack.imgur.com/93jcQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/93jcQ.png\" alt=\"property manager with new rule and match\"></a></p>\n\n<p>From there, add the behavior to have the Akamai platform do what you want. If it's a simple redirect, then you can use the Redirect behavior and remove the query strings completely. Something like this:\n<a href=\"https://i.stack.imgur.com/WXQGd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WXQGd.png\" alt=\"redirect behavior\"></a></p>\n\n<p>As the info box says, this specific use case might be better handled with the Redirector Cloudlet. But there are many things you can do once you've matched on that query string.</p>\n"}], "owner": {"reputation": 690, "user_id": 3117325, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/IeWfn.jpg?s=128&g=1", "display_name": "Night Monger", "link": "https://stackoverflow.com/users/3117325/night-monger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 58755165, "answer_count": 4, "score": 1, "last_activity_date": 1573154646, "creation_date": 1573069635, "question_id": 58737487, "link": "https://stackoverflow.com/questions/58737487/regex-to-filter-email-address-in-urls", "title": "Regex to filter email address in Urls", "body": "<p>I need to filter out any spam requests in our url that has email address or any sort of personal information. </p>\n\n<p>For example : if anyone enters the url </p>\n\n<blockquote>\n  <p>www.mydomain.com/en-us?email=abc@gmail.com</p>\n</blockquote>\n\n<p>it should redirect to </p>\n\n<blockquote>\n  <p>www.mydomain.com/en-us?email=</p>\n</blockquote>\n\n<p>[Use regex to pattern match the email and remove that] \nbasically it should keep the url as is and remove emailaddress</p>\n\n<p><strong>another example</strong> </p>\n\n<p>Redirect </p>\n\n<blockquote>\n  <p>www.mydomain.com/en-us/sompePage/SomeStructure?query=abc.gmail.com</p>\n</blockquote>\n\n<p>to </p>\n\n<blockquote>\n  <p>www.mydomain.com/en-us/sompePage/SomeStructure?query=</p>\n</blockquote>\n\n<p>This is what I tried :</p>\n\n<p><code>(http|https)://mydomain.com/(^((?!\\.)[\\w-_.]*[^.])(@\\w+)(\\.\\w+(\\.\\w+)?[^.\\W])$</code>\n but throws an error\n<em>Back story and reasoning, if interested</em></p>\n\n<p>We looked at google analytics and realized that our website is getting with a random email address with a random query string. But Google is marking them as storing personal information and hence see it as a violation of policy. Sl we are trying to place some regex in akamai so that these requests never hit the server. \n(We also have a fallback javascript in place to handle the same) </p>\n"}, {"tags": ["arrays", "perl"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1573070971, "post_id": 58737373, "comment_id": 103765497, "body": "What is the format of the file <code>value.txt</code>? Are the pairs separated by space, tab, or newline? Are all pairs on a single line?"}, {"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1573071092, "post_id": 58737373, "comment_id": 103765560, "body": "tab separated for value and new line for each pair of alphabet"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1573071170, "post_id": 58737373, "comment_id": 103765604, "body": "ok, and on each line you have e.g. <code>AC 2</code> and not <code>AC = 2</code> ?"}, {"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1573071221, "post_id": 58737373, "comment_id": 103765622, "body": "That&#39;s Correct."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 2, "creation_date": 1573116791, "post_id": 58737373, "comment_id": 103779039, "body": "What have you tried? What problems are you having? Please show us your code."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1573074394, "post_id": 58738192, "comment_id": 103766953, "body": "thank you. I will try this. I thought this is much simpler program,  I am incorrect."}, {"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1573075025, "post_id": 58738192, "comment_id": 103767186, "body": "I realized you mention using OOP perl, will it be different if you are not using OOP concepts."}], "tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": false, "score": 0, "last_activity_date": 1573072929, "creation_date": 1573072929, "answer_id": 58738192, "question_id": 58737373, "link": "https://stackoverflow.com/questions/58737373/using-array-in-perl-to-taking-user-input-and-calculate-the-results/58738192#58738192", "title": "Using Array in perl to taking user input and calculate the results", "body": "<p>Here is an example (using object oriented Perl):</p>\n\n<pre><code>#! /usr/bin/env perl\n\nCompute-&gt;new( fn =&gt; 'value.txt' );\n\npackage Compute;\nuse feature qw(say);\nuse strict;\nuse warnings;\n\nsub new {\n    my ( $class, %args ) = @_;\n    my $self = bless \\%args, $class;\n\n    $self-&gt;read_map();\n    $self-&gt;cleanup_map();\n    $self-&gt;input_text();\n    $self-&gt;gen_pairs();\n    $self-&gt;compute_sum();\n}\n\nsub compute_sum {\n    my ( $self ) = @_;\n\n    my $map = $self-&gt;{map};\n    my $sum = 0;\n    for my $pair ( @{ $self-&gt;{pairs} } ) {\n        if ( exists $map-&gt;{$pair} ) {\n            $sum += $map-&gt;{$pair};\n        }\n        else {\n            die \"Undefined pair: '$pair'\\n\";\n        }\n    }\n    say \"Sum = \", $sum;\n}\n\nsub gen_pairs {\n    my ( $self ) = @_;\n\n    my $txt = $self-&gt;{txt};\n    my @chars = split //, $txt;\n    my @pairs;\n    for my $i (0..($#chars - 1)) {\n        push @pairs, $chars[$i] . $chars[$i+1];\n    }\n    $self-&gt;{pairs} = \\@pairs;\n}\n\nsub input_text {\n    my ( $self ) = @_;\n\n    print \"Enter text: \";\n    my $txt = &lt;STDIN&gt;;\n    if ( defined $txt ) {\n        $txt =~ s/^\\s+//;\n        $txt =~ s/\\s+$//;\n        if ( (length $txt) &gt;= 2 ) {\n            $self-&gt;{txt} = $txt;\n            return;\n        }\n    }\n    say \"No input.\";\n    exit;\n}\n\nsub cleanup_map {\n    my ( $self ) = @_;\n\n    my $map = $self-&gt;{map};\n    while (1) {\n        my $modified = 0;\n        for my $key ( keys %$map ) {\n            my $value = $map-&gt;{$key};\n            if ( $value =~ /^[A-Za-z]+$/ ) {\n                if ( exists $map-&gt;{$value} ) {\n                    $map-&gt;{$key} = $map-&gt;{$value};\n                    $modified = 1;\n                }\n                else {\n                     die \"Undefined value: '$value'\\n\";\n                }\n            }\n        }\n        last if !$modified; \n    }\n}\n\nsub read_map {\n    my ( $self ) = @_;\n\n    my $fn = $self-&gt;{fn};\n    my %map;\n    open ( my $fh, '&lt;', $fn ) or die \"Could not open file '$fn': $!\";\n    while( my $line = &lt;$fh&gt; ) {\n        chomp $line;\n        my ( $key, $value ) = split \" \", $line;\n        if ( (defined $key) &amp;&amp; (defined $value) ) {\n            if ( length $key != 2 ) {\n                die \"Bad input key\\n\";\n            }\n            $map{$key} = $value;\n        }\n    }\n    close $fh;\n    $self-&gt;{map} = \\%map;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1573148301, "post_id": 58745364, "comment_id": 103796319, "body": "I tried this and it is throwing an error at this line 11 which is  <code>$input =~ s&#47;[^ACGU]&#47;&#47;g;</code> . The error is &quot;Use of Uninitialized value $input in substitution (s///) at test.pl line 11."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1573149402, "post_id": 58745364, "comment_id": 103796772, "body": "It&#39;s a warning, not an error - so it wouldn&#39;t stop the code from going on to work. See the fix that I&#39;ve just made."}, {"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1573149945, "post_id": 58745364, "comment_id": 103796982, "body": "couple things here. That adjustment got rid of the warning but there is another at line 31, <code>Use of Uninitialized value at in subroutine entry at line 31 and Use of uninitialized value $values[2] in join string at line 31</code>. And the sum is incorect. It is adding only 2 values. For example I gave the input ACCGC, it only added for the pair AC+CC, but left remaining pairs (CG, GC)"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1573151419, "post_id": 58745364, "comment_id": 103797632, "body": "@MO12: I get 5. Another 1 from CG, but GC is not in the input file so it gives a warning (&quot;GC is not a valid map key&quot;) and is ignored. I don&#39;t see the &quot;Uninitialized value&quot; errors at all. Can I suggest that you try debugging the problem a bit. Add some <code>print()</code> statements. Perhaps use <code>Data::Dumper</code>."}, {"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1573155055, "post_id": 58745364, "comment_id": 103799153, "body": "Thank you. I am working on debugging. Yes, GC is not in the value.txt file I provided, but is in the original file I am using."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": true, "score": 1, "last_activity_date": 1573149351, "last_edit_date": 1573149351, "creation_date": 1573117934, "answer_id": 58745364, "question_id": 58737373, "link": "https://stackoverflow.com/questions/58737373/using-array-in-perl-to-taking-user-input-and-calculate-the-results/58745364#58745364", "title": "Using Array in perl to taking user input and calculate the results", "body": "<p>This seems to do what you want. You might want to add a bit more error checking.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\nuse feature 'say';\nuse List::Util 'sum';\n\nmy %value_map = load_value_map();\n\nmy $input = shift // '';\n$input =~ s/[^ACGU]//g;\n\nuntil ($input) {\n  print 'Give me a string of letters [ACGU]: ';\n  chomp ($input = &lt;STDIN&gt;);\n  $input =~ s/[^ACGU]//g;\n}\n\nmy @values;\n\nfor (0 .. length($input) - 2) {\n  my $str = substr $input, $_, 2;\n  if (exists $value_map{$str}) {\n    push @values, $value_map{$str};\n  } else {\n    warn \"$str is not a valid map key\\n\";\n    next;\n  }\n}\n\nsay 'total value is ', sum(@values), ' (', join('+', @values), ')';\n\nsub load_value_map {\n  open my $fh, '&lt;', 'value.txt' or die $!;\n\n  my %value_map = map { chomp; split } &lt;$fh&gt;;\n\n  for (keys %value_map) {\n    if ($value_map{$_} =~ /\\D+/) {\n      $value_map{$_} = $value_map{$value_map{$_}};\n    }\n  }\n\n  return %value_map;\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 58745364, "answer_count": 2, "score": -2, "last_activity_date": 1598195719, "creation_date": 1573069049, "last_edit_date": 1598195719, "question_id": 58737373, "link": "https://stackoverflow.com/questions/58737373/using-array-in-perl-to-taking-user-input-and-calculate-the-results", "title": "Using Array in perl to taking user input and calculate the results", "body": "<p>I have a moderately complex calculation to be made based on the user input and a value.txt file to be calculated using a perl script.  User has a choice of giving an input from the alphabets G C A U. Input can be of any length but a combination of the 4 alphabets mentioned. Based on input, I will need to pair each alphabet them with adjacent one until the last one and print them. An then each pair has a pre-determined value, which needs to be added and print the final output. For example:</p>\n<pre><code>&gt; input by user after script prompt : ACCGUA\n&gt; \n&gt; Script need to pair : AC CC CG GU UA\n&gt; \n&gt; read the value of each pair from a values file below:\n&gt; \n&gt; value.txt\n&gt; \n&gt; AC = 2 CC = 1 CG = AC  GU = UG UG = 4 UA = 0\n&gt; \n&gt; Output should be  \n&gt; \n&gt;  total value is  9 (2+1+2+4+0)\n</code></pre>\n<p>I tried something in shell by defining an array, but getting nowhere in perl.</p>\n"}, {"tags": ["perl", "regex-greedy", "fix-protocol"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12328865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a411626003e6b97bf14c4cefa2f51d?s=128&d=identicon&r=PG&f=1", "display_name": "perlstudent", "link": "https://stackoverflow.com/users/12328865/perlstudent"}, "edited": false, "score": 0, "creation_date": 1573061907, "post_id": 58735330, "comment_id": 103761627, "body": "Thank you! That did the trick!  I could have swore I tried something very similar.  Maybe I used &quot;?&quot; in all groups. I think I understand your suggestion to create a hash from the FIX msgs but I only care about the two timestamps and tag 11. What I&#39;m doing is comparing the two timestamps and if the first one is greater than certain threshold, send out an alert with the two time stamps along with tag 11.  My concern with hash is that what if the data set changes? I wouldn&#39;t be able to compare the two hashes b/c the two timestamps could end up in a different location."}, {"owner": {"reputation": 13, "user_id": 12328865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a411626003e6b97bf14c4cefa2f51d?s=128&d=identicon&r=PG&f=1", "display_name": "perlstudent", "link": "https://stackoverflow.com/users/12328865/perlstudent"}, "edited": false, "score": 0, "creation_date": 1573165269, "post_id": 58735330, "comment_id": 103803096, "body": "Why do we need to make it less greedy on the first group (.*?) and not the rest of the groups(*)?"}, {"owner": {"reputation": 2347, "user_id": 1717259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f70451a8ea5b380bf1a28fe529b190cc?s=128&d=identicon&r=PG", "display_name": "user1717259", "link": "https://stackoverflow.com/users/1717259/user1717259"}, "reply_to_user": {"reputation": 13, "user_id": 12328865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a411626003e6b97bf14c4cefa2f51d?s=128&d=identicon&r=PG&f=1", "display_name": "perlstudent", "link": "https://stackoverflow.com/users/12328865/perlstudent"}, "edited": false, "score": 0, "creation_date": 1573204969, "post_id": 58735330, "comment_id": 103813513, "body": "It&#39;s because you&#39;re using [^|]*, which is telling it to match as many non-&#39;|&#39; characters as possible. But it can only do this up to the next &#39;|&#39; so you don&#39;t see any greedy behaviour there."}], "tags": [], "owner": {"reputation": 2347, "user_id": 1717259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f70451a8ea5b380bf1a28fe529b190cc?s=128&d=identicon&r=PG", "display_name": "user1717259", "link": "https://stackoverflow.com/users/1717259/user1717259"}, "is_accepted": true, "score": 2, "last_activity_date": 1580214114, "last_edit_date": 1580214114, "creation_date": 1573060317, "answer_id": 58735330, "question_id": 58735168, "link": "https://stackoverflow.com/questions/58735168/perl-regex-too-greedy/58735330#58735330", "title": "perl regex too greedy", "body": "<p>Try this:\n<code>s/(.*?)\\|.*\\|52=([^|]*).*\\|11=([^|]*).*/$1 $2 $3/;</code></p>\n\n<p>There were a couple of pipe delimiters that needed escaping.</p>\n\n<p>You need to look at non-greedy matching <a href=\"https://docstore.mik.ua/orelly/perl/cookbook/ch06_16.htm\" rel=\"nofollow noreferrer\">https://docstore.mik.ua/orelly/perl/cookbook/ch06_16.htm</a></p>\n\n<p>The first matching group is <code>(.*?)</code> instead of <code>(.*)</code>. The <code>?</code> means we match as little as possible.</p>\n\n<p>In general, for parsing FIX in perl, as long as there are no repeating groups, I would recommend splitting on <code>|</code> first and then creating a hash of tag-value pairs.</p>\n"}, {"comments": [{"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1573065919, "post_id": 58736637, "comment_id": 103763438, "body": "If you would specify name of each field then <b>hash</b> would be more appropriate than array -- it would be easier to work with <b>key=value</b> pair. In case of <b>array</b> I had <b>to count</b> what <b>element of array</b> I need to address to change it."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573071151, "post_id": 58736637, "comment_id": 103765594, "body": "Parsing first (e.g. using <code>split</code>) is definitely a better approach."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573071248, "post_id": 58736637, "comment_id": 103765637, "body": "Tip: You could use <code>say</code> (with <code>use feature qw( say );</code> or <code>use 5.010;</code>) or <code>CORE::say</code> (without) instead of <code>printf &quot;%s\\n&quot;, </code>"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573072378, "post_id": 58736637, "comment_id": 103766139, "body": "Is there any problem with <b>printf</b>? Due which it is undesirable to use it? There are many ways to output information. Still thanks for <i>Tip</i>."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573074018, "post_id": 58736637, "comment_id": 103766800, "body": "No, <code>say</code> is simply simpler then <code>printf &quot;%s\\n&quot;,</code>. That&#39;s why it&#39;s a tip and not a bug fix :) (<code>printf $s</code> would be bad since it could result in garbled output, but that&#39;s something else.)"}], "tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 2, "last_activity_date": 1573071127, "last_edit_date": 1573071127, "creation_date": 1573065765, "answer_id": 58736637, "question_id": 58735168, "link": "https://stackoverflow.com/questions/58735168/perl-regex-too-greedy/58736637#58736637", "title": "perl regex too greedy", "body": "<p>I would do it a little bit different - split line into array and work on individual element of array. </p>\n\n<p>The regex may be an acceptable solution for one particular case if format of line predetermined and will never change.</p>\n\n<pre><code>use strict;\nuse warnings;\n\nuse Data::Dumper;\n\nmy $debug = 0;\n\nwhile( my $line = &lt;DATA&gt; ) {\n    my @array = split /\\|/, $line;\n\n    print Dumper(\\@array) if $debug;\n\n    $array[7]  =~ s/.+?-//;\n    $array[11] =~ s/\\d+=//;\n\n    printf \"%s\\n\", join '|', @array[0,7,11];\n\n}\n\n__DATA__\n09:30:00.063|IN:|8=FIX.4.2|9=206|35=D|34=5159|49=CLIENT|52=20191024-13:30:00.050|56=SERV|57=DEST|1=05033|11=ABZ5702|15=USD|21=1|38=2000|40=2|44=92.48|47=A|54=5|55=RC|60=20191024-13:30:00.050|111=0|114=N|336=X|5700=AP|9281=SOV|10=202\n09:37:21.208|IN:|8=FIX.4.2|9=170|35=D|34=5184|49=CLIENT|52=20191024-13:37:21.206|56=SERV|57=ATXB|1=J5129|11=136404|15=USD|21=1|38=100|40=2|44=1.39|47=A|54=2|55=DIW|59=2|60=20191024-13:30:00.206|10=029\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12328865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a411626003e6b97bf14c4cefa2f51d?s=128&d=identicon&r=PG&f=1", "display_name": "perlstudent", "link": "https://stackoverflow.com/users/12328865/perlstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58735330, "answer_count": 2, "score": 0, "last_activity_date": 1580214114, "creation_date": 1573059748, "last_edit_date": 1573061700, "question_id": 58735168, "link": "https://stackoverflow.com/questions/58735168/perl-regex-too-greedy", "title": "perl regex too greedy", "body": "<p>I went through similar questions asked by other members and applied (or tried to apply) solutions from their inquiry but they did not work on my issue.  My pattern match and grouping is too greedy and does not stop at first pipe(|).  If I get more specific, I think it can but I'm trying to figure out how I can stop the pattern match at the first instance of the pipe?</p>\n\n<p>Here are couple of lines </p>\n\n<pre><code>09:30:00.063|IN:|8=FIX.4.2|9=206|35=D|34=5159|49=CLIENT|52=20191024-13:30:00.050|56=SERV|57=DEST|1=05033|11=ABZ5702|15=USD|21=1|38=2000|40=2|44=92.48|47=A|54=5|55=RC|60=20191024-13:30:00.050|111=0|114=N|336=X|5700=AP|9281=SOV|10=202\n09:37:21.208|IN:|8=FIX.4.2|9=170|35=D|34=5184|49=CLIENT|52=20191024-13:37:21.206|56=SERV|57=ATXB|1=J5129|11=136404|15=USD|21=1|38=100|40=2|44=1.39|47=A|54=2|55=DIW|59=2|60=20191024-13:30:00.206|10=029\n</code></pre>\n\n<p>I'm expecting my perl script to return the following output from the above data:</p>\n\n<pre><code>09:30:00.063|13:30:00.050|ABZ5702\n09:37:21.208|13:37:21.206|136404\n</code></pre>\n\n<p>I tried all this and few other veriations but could not get it to produce the above output:</p>\n\n<pre><code>    #$msg =~ s/([^|]*).*|52=([^|]*).*|11=([^|]*).*/$1|$2|$3/;\n    $msg =~ s/(.+)\\|??.*|52=([^|]*).*|11=([^|]*).*/$1|$2|$3/;\n    #$msg =~ s/^([^|]*).??|52=([^|]*).??|11=([^|]*).*/$1|$2|$3/;\n    #$msg =~ s/^([^\\|??]*).*|52=([^\\|??]*).*|11=([^\\|??]*).*/$1|$2|$3/;\n    #$msg =~ s/(.*\\|??).*|52=(.+\\|??).*|11=(.+\\|??).*/one $1|two $2|three $3/;\n    #$msg =~ s/(.*?|).*|52=(.*?|).*|11=(.*|?).*/$1|$2|$3/;\n    #$msg =~ /(.*)|??.*|52=(.*)|??.*|11=(.*)|??.*/$1|$2|$3/;\n    #$msg =~ s/|.*-[0-3][0-9]:/|/;\n\nprint \"$msg\\n\";```\n</code></pre>\n\n<p>I realize there are other more than one way to skin the cat but there are cases where I need to use the pattern match approach.  How can I get it to produce the expected output using the pattern matching where it stops each group at first pipe(|)? Can someone tell me what am I doing wrong?  </p>\n"}, {"tags": ["perl", "strict"], "comments": [{"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1573055639, "post_id": 58732999, "comment_id": 103758136, "body": "Well, you <i>have</i> to do it without strict. You mean why would I do with strict? Because I like strict I guess and I need access to the symtab, and I just wanted to know if there is a less hacky way to do this?"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 4, "creation_date": 1573055804, "post_id": 58732999, "comment_id": 103758225, "body": "Disabling <code>strict</code> in a small, lexical scope is exactly the right thing to do here in my opinion. It is meant to stop you from doing these kinds of things, so disabling this part of the strict policy explicitly is supports that, and tells readers of the code you knew what you were doing."}, {"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 0, "creation_date": 1573057508, "post_id": 58732999, "comment_id": 103759187, "body": "You could certainly do it with XS code. Maybe there&#39;s a <code>B</code> based solution that can run under <code>strict</code>, too."}], "answers": [{"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 2, "last_activity_date": 1573059676, "creation_date": 1573059676, "answer_id": 58735155, "question_id": 58732999, "link": "https://stackoverflow.com/questions/58732999/is-it-possible-to-get-access-to-a-symbol-table-without-disabling-strict/58735155#58735155", "title": "Is it possible to get access to a symbol table without disabling strict?", "body": "<p>It's impossible to do with without turning off <code>strict</code>. But there are ways to hide that complexity. There are several modules that allow you to do this without actually turning off <code>strict</code> yourself - <a href=\"https://metacpan.org/pod/Symbol\" rel=\"nofollow noreferrer\">Symbol</a> (included in the standard distribution), <a href=\"https://metacpan.org/pod/Symbol::Get\" rel=\"nofollow noreferrer\">Symbol::Get</a> and <a href=\"https://metacpan.org/pod/Tie::Symbol\" rel=\"nofollow noreferrer\">Tie::Symbol</a> are three examples.</p>\n"}, {"comments": [{"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 0, "creation_date": 1573063063, "post_id": 58735981, "comment_id": 103762122, "body": "But to be clear here, given the name of the package name, getting access to the symbol table for that package requires &quot;constructing&quot; it (ie appending <code>::</code>) which is a violation of strict mode?"}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "reply_to_user": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 0, "creation_date": 1573063629, "post_id": 58735981, "comment_id": 103762392, "body": "Not necessarily; you can find it in the parent stash as well but it&#39;s a little convoluted; will update answer."}], "tags": [], "owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "is_accepted": false, "score": 3, "last_activity_date": 1573064351, "last_edit_date": 1573064351, "creation_date": 1573062949, "answer_id": 58735981, "question_id": 58732999, "link": "https://stackoverflow.com/questions/58732999/is-it-possible-to-get-access-to-a-symbol-table-without-disabling-strict/58735981#58735981", "title": "Is it possible to get access to a symbol table without disabling strict?", "body": "<p>Strict does not prevent access if you don't need to construct the stash name:</p>\n\n<pre><code>use strict;\nuse warnings;\n$Foo::Bar::baz = 42;\nmy $symtab = \\%Foo::Bar::;\nprint \"${$symtab-&gt;{baz}}\\n\";\n</code></pre>\n\n<p>You can also access it via the stash hierarchy without violating strict (it's globs all the way down):</p>\n\n<pre><code>use strict;\nuse warnings;\n$Foo::Bar::baz = 42;\nmy $main_stash = \\%::;\nmy $Foo_stash = $main_stash-&gt;{'Foo::'};\nmy $FooBar_stash = $Foo_stash-&gt;{'Bar::'};\nprint \"${$FooBar_stash-&gt;{baz}}\\n\";\n</code></pre>\n\n<p><a href=\"https://metacpan.org/pod/Package::Stash\" rel=\"nofollow noreferrer\">Package::Stash</a> provides a programmatic way to access stashes.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse Package::Stash;\n$Foo::Bar::baz = 42;\nmy $package = 'Foo::Bar';\nmy $stash = Package::Stash-&gt;new($package);\nprint \"${$stash-&gt;namespace-&gt;{baz}}\\n\"; # dereferencing the glob to access the scalar slot\nprint \"${$stash-&gt;get_symbol('$baz')}\\n\"; # retrieving the scalar slot of the glob directly\n</code></pre>\n\n<p>Caveat emptor: just because strict vars does not prevent stash hierarchy access does not mean this isn't hacky (and resistant to compile time optimizations), and in most cases just turning off strict 'refs' and constructing the symbol name is preferred.</p>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 1, "last_activity_date": 1573072051, "last_edit_date": 1573072051, "creation_date": 1573071715, "answer_id": 58737929, "question_id": 58732999, "link": "https://stackoverflow.com/questions/58732999/is-it-possible-to-get-access-to-a-symbol-table-without-disabling-strict/58737929#58737929", "title": "Is it possible to get access to a symbol table without disabling strict?", "body": "<p>Disguising the fact that you are doing something that isn't strict-safe by finding a way to do with with strict on is only fooling yourself and your readers. And that's a bad idea.</p>\n\n<hr>\n\n<p>First of all, it's not very common. It's done by a few low-level modules. The normal Perl programmer will never manipulate the symbol table directly.</p>\n\n<p>And yes, it is possible to do this without disabling <code>strict</code>. The symbol table is accessible via <code>%::</code>, so you could parse the package and navigate the symbol table that way. For example, <code>\\%{'Foo::Bar::'}</code> becomes <code>\\%{ $::{\"Foo::\"}{\"Bar::\"} }</code>, although that presupposes the existence of the package. You could also generate Perl code and use <code>eval</code>.</p>\n\n<p>BUT, there's no reason to do so. One turns on strict specifically to prevent oneself from accidentally doing this. Disguising the fact that you are doing something that isn't strict-safe is only fooling yourself and your readers. And that's a bad idea. One should strive to write self-documenting code, and nothing says \"this is tricky, dangerous code\" like <code>no strict 'refs';</code>.</p>\n"}], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1573072051, "creation_date": 1573052495, "question_id": 58732999, "link": "https://stackoverflow.com/questions/58732999/is-it-possible-to-get-access-to-a-symbol-table-without-disabling-strict", "title": "Is it possible to get access to a symbol table without disabling strict?", "body": "<p>In Perl the following code is very common. You can even see it in things like <a href=\"https://metacpan.org/pod/constant\" rel=\"nofollow noreferrer\"><code>constant.pm</code></a>.</p>\n\n<pre><code>my $symtab;\n{\n  no strict 'refs';                                                                                                                              \n  $symtab = \\%{$pkg . '::'};\n}\n</code></pre>\n\n<p>If I simply delete strict, I get</p>\n\n<blockquote>\n  <p>Can't use string (<code>main::</code>) as a HASH ref while \"strict refs\" in use</p>\n</blockquote>\n\n<p>Is it possible to do this at all, without turning off <code>strict</code>?</p>\n"}, {"tags": ["perl", "apache-fop"], "comments": [{"owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "edited": false, "score": 0, "creation_date": 1573047759, "post_id": 58731009, "comment_id": 103753509, "body": "Looks like the perl module <code>XML::ApacheFOP</code> is not installed in your system."}, {"owner": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "reply_to_user": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "edited": false, "score": 0, "creation_date": 1573048087, "post_id": 58731009, "comment_id": 103753695, "body": "@vinodk89 I have run for this command cpanm XML::ApacheFOP but not install this module. How can I install this Module?"}, {"owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "edited": false, "score": 0, "creation_date": 1573049424, "post_id": 58731009, "comment_id": 103754386, "body": "The documentation <a href=\"https://metacpan.org/pod/XML::ApacheFOP#SETUP\" rel=\"nofollow noreferrer\">SETUP</a> says you need java2 to be installed first before installing this module."}], "answers": [{"comments": [{"owner": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "edited": false, "score": 0, "creation_date": 1573111116, "post_id": 58732295, "comment_id": 103776350, "body": "Sir, if i am run the command &quot;cpan install XML::ApacheFOP&quot; in cmd prompt then last messasge showing &quot;You can&#39;t run these tests unless JavaServer is running\\n&quot; Do you want to continue? (Y/n) if i m given the Y then show &quot;Stopping: &#39;install&#39; faild for &#39;Java&#39;&quot;. I have already install Java my system."}, {"owner": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "edited": false, "score": 0, "creation_date": 1573111619, "post_id": 58732295, "comment_id": 103776588, "body": "And if i am another 2nd command &quot;cpanm XML::ApacheFOP&quot; then showing the message &quot;Building and testing Java-4.7 ....&quot; stop not continue."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "edited": false, "score": 0, "creation_date": 1573113845, "post_id": 58732295, "comment_id": 103777620, "body": "The SETUP section that I linked to in my answer says that the FOP JavaServer needs to be running in order to use (or, obviously, test) the module. Just installing FOP isn&#39;t enough, you need to start it."}, {"owner": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "edited": false, "score": 0, "creation_date": 1573126787, "post_id": 58732295, "comment_id": 103784347, "body": "Sir, i have Download fop-2.4-bin.zip and extract the file after that move the file in C:\\fop-2.4 but this avalon-framework-cvs-20020806.jar file missing in lib folder. how to add the classpath in System and afterthat run my perl script?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "edited": false, "score": 0, "creation_date": 1573129892, "post_id": 58732295, "comment_id": 103786066, "body": "@Sandy: I&#39;m afraid I know almost nothing about Java, FOP or developing on a Windows machine. I don&#39;t think I can be any more help here."}, {"owner": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "edited": false, "score": 0, "creation_date": 1573218391, "post_id": 58732295, "comment_id": 103819986, "body": "Sir, how to use this command =====/path/to/java -classpath \\ /path/to/JavaServer.jar\\ :/usr/local/xml-fop/build/fop.jar\\ :/usr/local/xml-fop/lib/avalon-framework-cvs-20020806.jar\\ :/usr/local/xml-fop/lib/batik.jar\\ :/usr/local/xml-fop/lib/xalan-2.4.1.jar\\ :/usr/local/xml-fop/lib/xercesImpl-2.2.1.jar \\ com.zzo.javaserver.JavaServer ========= for the server is connect?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "edited": false, "score": 0, "creation_date": 1573220021, "post_id": 58732295, "comment_id": 103820847, "body": "@Sandy: I know nothing about this area. I can&#39;t be any more help to you."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 1, "last_activity_date": 1573050240, "creation_date": 1573050240, "answer_id": 58732295, "question_id": 58731009, "link": "https://stackoverflow.com/questions/58731009/how-can-i-conversion-perl-to-create-pdf-files-using-xml-xslt-xsl-fo/58732295#58732295", "title": "How can I conversion Perl to create PDF files using XML/XSLT/XSL-FO", "body": "<p>This is almost certainly because <a href=\"https://metacpan.org/pod/XML::ApacheFOP\" rel=\"nofollow noreferrer\">XML::ApacheFOP</a> isn't installed. In a comment, you say that you have tried to install the module using <code>cpanm</code>, but it hasn't installed successfully. It would be useful to see the error messages that are displayed.</p>\n\n<p>The <a href=\"https://metacpan.org/pod/XML::ApacheFOP#SETUP\" rel=\"nofollow noreferrer\">SETUP section of the documentation</a> says that you will need <a href=\"https://xmlgraphics.apache.org/fop/\" rel=\"nofollow noreferrer\">FOP</a> installed before installing the module. If you're on Ubuntu, then that might be as easy as running <code>sudo apt-get install fop</code>. You should then try the module installation again. If it still fails, then ask a new question here, making sure to include the text of the error messages you get from <code>cpanm</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1573067175, "creation_date": 1573067175, "answer_id": 58736970, "question_id": 58731009, "link": "https://stackoverflow.com/questions/58731009/how-can-i-conversion-perl-to-create-pdf-files-using-xml-xslt-xsl-fo/58736970#58736970", "title": "How can I conversion Perl to create PDF files using XML/XSLT/XSL-FO", "body": "<p>The error indicates that your perl distro does not include <code>XML::ApacheFOP</code> module.</p>\n\n<p>The module can be installed in several ways:</p>\n\n<pre><code>cpan install XML::ApacheFOP\n</code></pre>\n\n<p>or</p>\n\n<pre><code>cpanm XML::ApacheFOP\n</code></pre>\n\n<p>or</p>\n\n<pre><code>perl -MCPAN -e install XML::ApacheFOP\n</code></pre>\n\n<p>or download module extract it and run makefile.</p>\n\n<p>It was pointed out that this particular module has <strong>java</strong> as pre-requisite and should be installed as well.</p>\n\n<p><a href=\"https://www.cpan.org/modules/INSTALL.html\" rel=\"nofollow noreferrer\">How to install CPAN modules</a></p>\n\n<p><a href=\"https://dadamailproject.com/support/documentation-11_5_0/FAQ-installing_CPAN_Perl_modules.pod.html\" rel=\"nofollow noreferrer\">FAQ installing CPAN perl modules</a></p>\n\n<p><a href=\"https://how-to.fandom.com/wiki/How_to_install_PERL_modules\" rel=\"nofollow noreferrer\">How to install perl modules</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/65865/whats-the-easiest-way-to-install-a-missing-perl-module\">What's the easiest way to install perl module?</a></p>\n"}], "owner": {"reputation": 797, "user_id": 10986032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b711d8c2c97fc9416b92cb816de45a1?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10986032/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573067175, "creation_date": 1573045959, "question_id": 58731009, "link": "https://stackoverflow.com/questions/58731009/how-can-i-conversion-perl-to-create-pdf-files-using-xml-xslt-xsl-fo", "title": "How can I conversion Perl to create PDF files using XML/XSLT/XSL-FO", "body": "<p>I want to create pdf using XSLT, ApacheFOP use in PERL. Can anyone Help me?</p>\n\n<pre><code>    use 5.010;\nuse warnings;\nuse strict;\nuse XML::ApacheFOP;\nmy $Fop = XML::ApacheFOP-&gt;new();\n$Fop-&gt;fop( xml =&gt; \"math.xml\", xsl =&gt; \"math.xsl\", outfile =&gt; \"temp.pdf\" ) or die \"cannot create pdf: \" . $Fop-&gt;errstr;\n</code></pre>\n\n<p>Error showing in cmd line <strong>can't locate XML/ApacheFOP.pm</strong></p>\n"}, {"tags": ["perl", "hash", "subroutine"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573029244, "post_id": 58725805, "comment_id": 103743349, "body": "Sorry, but I have no idea what exactly you are trying to do ... ?  The shown program fails, per <code>Can&#39;t use string (&quot;p&quot;) as a HASH ref ...</code> .  Can you state in words what you want?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573029316, "post_id": 58725805, "comment_id": 103743392, "body": "As for what you do say, <code>$h{key_with_sub}-&gt;();</code> ... is that all you need?"}, {"owner": {"reputation": 65, "user_id": 11944570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TogwW.jpg?s=128&g=1", "display_name": "inout", "link": "https://stackoverflow.com/users/11944570/inout"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573029572, "post_id": 58725805, "comment_id": 103743515, "body": "@zdim thanks for your reply. the goal is to call the anonymous subroutine. what i expect is that <code>&amp;$cref()</code> should work."}, {"owner": {"reputation": 12075, "user_id": 1137055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d7b43b9eb7d01bd8f7e51febe6053c?s=128&d=identicon&r=PG", "display_name": "dgw", "link": "https://stackoverflow.com/users/1137055/dgw"}, "edited": false, "score": 0, "creation_date": 1573029719, "post_id": 58725805, "comment_id": 103743582, "body": "You do not pass a hash ref. You are passing just a list. And then you only use the first element of that list."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573029734, "post_id": 58725805, "comment_id": 103743590, "body": "&quot;<i>call the anonymous subroutine</i>&quot;  --- OK, that&#39;s just about what I got, but I don&#39;t see in what exact context.  Once that code reference (the &quot;anonymous sub&quot;) is passed around it winds up in a variable somewhere; then you just say <code>$var_with_coderef-&gt;()</code>, so <code>-&gt;()</code> calls the sub. See my other comment for one example, where the sub would be stored in a hash under the key <code>key_with_sub</code> (so earlier you&#39;d have <code>$hash{key_with_sub} = sub { ... }</code>).  Have a look through <a href=\"https://perldoc.perl.org/perlreftut.html\" rel=\"nofollow noreferrer\">perlreftut</a> if you haven&#39;t; next up is <code>perlref</code>"}, {"owner": {"reputation": 65, "user_id": 11944570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TogwW.jpg?s=128&g=1", "display_name": "inout", "link": "https://stackoverflow.com/users/11944570/inout"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573030241, "post_id": 58725805, "comment_id": 103743822, "body": "@zdim i am aware of what you write, however i&#39;m trying to understand the error,       Can&#39;t use string (&quot;p&quot;) as a HASH ref while &quot;strict refs&quot; in use at ./hashfn.pl line 13.     main::fn(&quot;p&quot;, CODE(0x563b62a78578)) called at ./hashfn.pl line 24"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 12075, "user_id": 1137055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d7b43b9eb7d01bd8f7e51febe6053c?s=128&d=identicon&r=PG", "display_name": "dgw", "link": "https://stackoverflow.com/users/1137055/dgw"}, "edited": false, "score": 1, "creation_date": 1573031407, "post_id": 58725805, "comment_id": 103744400, "body": "OK. So: what you pass to your function is a list, as @dgw said, of: <code>p</code>, and the anon sub <code>sub {...}</code> (which is just a reference, a scalar). In the sub you take the first argument (<code>$_[0]</code>) so that&#39;s <code>p</code>, which is a mere string, just a letter. Then you try to &quot;dereference&quot; it into a hash (<code>%{ $href }</code>) -- well, it&#39;s not a reference ... that&#39;s the error at which the program exits. Why do you tnink that <code>p</code> is a hashref?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573031504, "post_id": 58725805, "comment_id": 103744455, "body": "Also note that the &quot;fat comma&quot; (<code>=&gt;</code>) effectively quotes that &quot;bare&quot; <code>p</code> that you have.  This is what <code>=&gt;</code> operator does, apart from being a fancy-looking comma, so that  <code>p =&gt; 1</code> is equivalent to <code>&quot;p&quot; =&gt; 1</code>. Without that you couldn&#39;t have just <code>p</code> (a &quot;bareword&quot;), it would have to be under quotes (like <code>&#39;p&#39;</code>, or some other form of quoting)."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 1, "creation_date": 1573033392, "post_id": 58725805, "comment_id": 103745535, "body": "... and <code>&quot;p&quot; =&gt; 1</code> is the same as <code>&quot;p&quot;, 1</code> (a list). See it <a href=\"https://perldoc.perl.org/perlop.html#Comma-Operator\" rel=\"nofollow noreferrer\">in perlop</a>"}, {"owner": {"reputation": 65, "user_id": 11944570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TogwW.jpg?s=128&g=1", "display_name": "inout", "link": "https://stackoverflow.com/users/11944570/inout"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573034537, "post_id": 58725805, "comment_id": 103746203, "body": "@zdim &#39;p&#39; is not a hashref. guess i missed the list assignment to a hash instead of a scalar. thanks for your time."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573035859, "post_id": 58725805, "comment_id": 103746919, "body": "&quot;<i>list assignment to a hash</i>&quot;  --- yeah, that would&#39;ve worked.  (I see now what you may have wanted).  Comments: 1) Can&#39;t nicely print a <code>%hash</code>. Either iterate over keys or use a module, <code>Data::Dumper</code>, <code>Data::Dump</code>, etc 2) no need for <code>1;</code> at the end; that&#39;s needed in modules"}], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 6, "last_activity_date": 1573034987, "last_edit_date": 1573034987, "creation_date": 1573033685, "answer_id": 58727219, "question_id": 58725805, "link": "https://stackoverflow.com/questions/58725805/call-perl-anonymous-subroutine-whose-reference-is-maintained-in-a-hash/58727219#58727219", "title": "call perl anonymous subroutine whose reference is maintained in a hash", "body": "<p>Your sub expects to be passed a hash reference, but you don't pass a hash reference. You pass a string (<code>p</code>) and a code ref. That's because</p>\n\n<pre><code>fn p =&gt; sub { print \"inside anon function\\n\" };\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>fn \"p\", sub { print \"inside anon function\\n\" };\n</code></pre>\n\n<p>Fix:</p>\n\n<pre><code>sub fn {\n   my %h = @_;\n   my $cref = $h{p};\n   $cref-&gt;();\n}\n\nfn p =&gt; sub { print \"inside anon function\\n\" };\n</code></pre>\n\n<p>That builds the hash on the inside of the sub. If you wanted to build the hash on the outside and pass a reference to it, it would look like this:</p>\n\n<pre><code>sub fn {\n   my $href = $_[0];\n   my $cref = $href-&gt;{p};\n   $cref-&gt;();\n}\n\nfn { p =&gt; sub { print \"inside anon function\\n\" } };\n</code></pre>\n\n<p>I avoided making a useless copy of the hash (<code>my %h = %{ $href };</code>).</p>\n\n<hr>\n\n<p><code>&amp;$cref()</code> (but not <code>&amp;$cref</code>) is fine too. I just prefer the arrow notation.</p>\n"}], "owner": {"reputation": 65, "user_id": 11944570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TogwW.jpg?s=128&g=1", "display_name": "inout", "link": "https://stackoverflow.com/users/11944570/inout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 58727219, "answer_count": 1, "score": 2, "last_activity_date": 1573034987, "creation_date": 1573028616, "question_id": 58725805, "link": "https://stackoverflow.com/questions/58725805/call-perl-anonymous-subroutine-whose-reference-is-maintained-in-a-hash", "title": "call perl anonymous subroutine whose reference is maintained in a hash", "body": "<p>How do i call an perl anonymous subroutine whose reference is maintained in a hash ?</p>\n\n<p>Here is the code</p>\n\n<pre><code>#!/usr/bin/perl -W\n\nuse strict;\nuse warnings 'FATAL';\nuse diagnostics;\nuse utf8;\n\n\nsub fn {\n  my $href = $_[0];\n\n  my %h = %{ $href };\n\n  print %h;\n\n  my $cref = $h{'p'};\n\n  &amp;$cref();\n}\n\n\nfn p =&gt; sub { print \"inside anon function\\n\" };\n\n\n1;\n</code></pre>\n\n<p>Thanks for your time.</p>\n"}, {"tags": ["regex", "csv", "perl", "parsing", "glob"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573023614, "post_id": 58724456, "comment_id": 103740969, "body": "That&#39;s one complicated program! So is the objective: given a file with lines like <code>&#47;path-to-proj&#47;...&#47;abc</code> check that files exist at those paths?  (But those files have more in their name, with that <code>0p765...</code>, right?).  Is that it?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573023707, "post_id": 58724456, "comment_id": 103741008, "body": "One thing: You do realize that a thing like <code>@ary = &lt;filehandle&gt;</code> imposes list context on <code>&lt;&gt;</code> -- because there is an array on the lefthand side -- so that <i>all lines are read</i> right at that point?  That still may work, since you then iterate over <code>@line</code> (bad name! it&#39;s <i>all lines</i>) but it&#39;s ... unusual, to say the least."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573023981, "post_id": 58724456, "comment_id": 103741124, "body": "The <code>glob</code> in scalar context -- which you impose on it by using it as <code>if</code> condition -- iterates over filename expansions.  I don&#39;t see precisely how that&#39;d fail you here but it&#39;s not what you want. Instead, retrieve filese, if any, in the condition: <code>if (my @files = glob(...)) { print ... }</code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573024845, "post_id": 58724456, "comment_id": 103741498, "body": "Tip: <code>while (my @lines = &lt;$file_data&gt;) { foreach my $path (@lines) { ... } }</code> is a weird way of writing <code>my @lines = &lt;$file_data&gt;; foreach my $path (@lines) { ... }</code>. Most people would use <code>while (my $path = &lt;$file_data&gt;) { ... }</code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573024970, "post_id": 58724456, "comment_id": 103741551, "body": "Tip: <code>my $file = &quot;$ENV{MODEL_ROOT}&#47;paths.csv&quot; or die &quot;CSV File is not present\\n&quot;;</code> is a very weird way of writing <code>my $file = &quot;$ENV{MODEL_ROOT}&#47;paths.csv&quot;;</code>. Why did you ignore the warning???"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573028972, "post_id": 58724456, "comment_id": 103743225, "body": "Also: All that work by <code>grep</code> and two <code>sed</code>&#39;s (that&#39;s a lot!) can nicely be done right in your script, in a short little loop over lines of that <code>$ENV...&#47;paths.tcl</code> file, in basic Perl."}, {"owner": {"reputation": 45, "user_id": 6190834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4f4d6abb8995c1528d03df04d3a996?s=128&d=identicon&r=PG&f=1", "display_name": "batssassin", "link": "https://stackoverflow.com/users/6190834/batssassin"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573029125, "post_id": 58724456, "comment_id": 103743283, "body": "@ikegami I did not receive any warning for <code>my $file = &quot;$ENV{MODEL_ROOT}&#47;paths.csv&quot; or die &quot;CSV File is not present\\n&quot;;</code>"}, {"owner": {"reputation": 45, "user_id": 6190834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4f4d6abb8995c1528d03df04d3a996?s=128&d=identicon&r=PG&f=1", "display_name": "batssassin", "link": "https://stackoverflow.com/users/6190834/batssassin"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573029179, "post_id": 58724456, "comment_id": 103743309, "body": "@zdim Thanks for your comments, I am still learning everything! :) Have to catch up on a lot."}, {"owner": {"reputation": 45, "user_id": 6190834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4f4d6abb8995c1528d03df04d3a996?s=128&d=identicon&r=PG&f=1", "display_name": "batssassin", "link": "https://stackoverflow.com/users/6190834/batssassin"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573029311, "post_id": 58724456, "comment_id": 103743390, "body": "@zdim In a given directory, there are mutiple files (around 50). I only need to check if file(s) matching the said pattern exist for what I am about to do later on."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573029563, "post_id": 58724456, "comment_id": 103743510, "body": "OK (that&#39;s not clear from the sample -- those <code>system</code> lines don&#39;t show &quot;<i>multiple files</i>&quot; ... unless <code>&lt;...&gt;</code> has shell globs?). Still, can do all that very nicely in Perl, is all I&#39;m saying; but we can&#39;t hash it out here in comments..."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573030614, "post_id": 58724456, "comment_id": 103743985, "body": "Re &quot;<i>did not receive any warning for</i>&quot;, Sorry, I miscopied the code when I tested it. The rest of the comment still applies, though."}, {"owner": {"reputation": 45, "user_id": 6190834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4f4d6abb8995c1528d03df04d3a996?s=128&d=identicon&r=PG&f=1", "display_name": "batssassin", "link": "https://stackoverflow.com/users/6190834/batssassin"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573031143, "post_id": 58724456, "comment_id": 103744272, "body": "@ikegami What is a better way to represent my code, should the said file (paths.csv) not exist?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573031230, "post_id": 58724456, "comment_id": 103744308, "body": "No need to check. The <code>open</code> will fail with <code>$!</code> set to <code>ENOENT</code> (<code>No such file or directory</code>). In fact, checking in advance is a bad practice. The file could be deleted between the check and the <code>open</code>, so you end up relying on <code>open</code> anyway."}], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 4, "last_activity_date": 1573027248, "last_edit_date": 1573027248, "creation_date": 1573024411, "answer_id": 58724857, "question_id": 58724456, "link": "https://stackoverflow.com/questions/58724456/unable-to-parse-file-correctly-glob-not-working/58724857#58724857", "title": "Unable to Parse file correctly; Glob not working", "body": "<p>Operators (such as <code>glob</code>) function differently depending on whether they are evaluated in scalar context or list context.</p>\n\n<p><code>glob</code> in scalar context acts as an iterator. It returns the next match until it returns undef to indicate there is nothing left to return. It doesn't matter if the argument changes.</p>\n\n<pre><code>$ perl -e'for (1..7) { my $glob = glob(\"*\"); CORE::say \"$_ $glob\"; }'\n1 a.xml\n2 b.xml\n3 \n4 a.xml\n5 b.xml\n6 \n7 a.xml\n</code></pre>\n\n<p>You don't want that. You want to call it in list context. So replace</p>\n\n<pre><code>if (glob (\"$path/*0p765v_125c*.ldb\")) {\n        @glob = glob (\"$path/*0p765v_125c*.ldb\");\n</code></pre>\n\n<p>with</p>\n\n<pre><code>if ( my @ldb_paths = glob(\"$path/*0p765v_125c*.ldb\") ) {\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if ( my ($ldb_path) = glob(\"$path/*0p765v_125c*.ldb\") ) {\n</code></pre>\n\n<p>The second option gets just the first match, ignoring the rest. The parens on the left-hand side of the assignment are crucial to creating the necessary list context for the right-hand side.</p>\n"}], "owner": {"reputation": 45, "user_id": 6190834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4f4d6abb8995c1528d03df04d3a996?s=128&d=identicon&r=PG&f=1", "display_name": "batssassin", "link": "https://stackoverflow.com/users/6190834/batssassin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 58724857, "answer_count": 1, "score": 2, "last_activity_date": 1573027248, "creation_date": 1573022627, "last_edit_date": 1573023026, "question_id": 58724456, "link": "https://stackoverflow.com/questions/58724456/unable-to-parse-file-correctly-glob-not-working", "title": "Unable to Parse file correctly; Glob not working", "body": "<p>I am trying to write a Perl script that basically checks if a particular file matching a regex exists in a particular directory. Here is my code:</p>\n\n<pre><code>use strict;\nuse warnings;\n\nsystem (\"grep PATH $ENV{MODEL_ROOT}/&lt;....&gt;/paths.tcl &gt; \\$MODEL_ROOT/hip_paths.csv\");\nsystem(\"sed -i 's/) /,/g' \\$MODEL_ROOT/paths.csv\");\nsystem(\"sed -i 's/set G_L.*,//g' \\$MODEL_ROOT/paths.csv\");\n\nmy @glob;\n\nmy $file = \"$ENV{MODEL_ROOT}/paths.csv\" or die \"CSV File is not present\\n\";\nopen(my $file_data, '&lt;', $file) or die \"Could not open '$file' $!\\n\";\n\nwhile (my @line = &lt;$file_data&gt;) {\n  system (\"printf \\\"@line\\\" &gt;&gt; fields\"); #For debug\n  foreach my $path (@line)\n {   \n     $path =~ m/^.*proj\\/(.*)\\/&lt;blah&gt;/; #To find 'name'\n     if (glob (\"$path/*0p765v_125c*.ldb\")) #Check if file exists in $path with said pattern\n     {   \n            @glob = glob (\"$path/*0p765v_125c*.ldb\");\n            print \"File exists for $1 in path $path: @glob\\n\"\n     } \n     else \n     {\n        print \"Does not exist for $1 in path $path\\n\";\n     } \n  }\n}\nclose $file_data\n</code></pre>\n\n<p><strong>paths.csv</strong> looks like this: (Cant post actual path due to TM and C issues)</p>\n\n<pre><code>/(path-to-proj)/proj/name1/version1/abc  \n/(path-to-proj)/proj/name2/version2/abc  \n/(path-to-proj)/proj/name3/version3/abc  \n/(path-to-proj)/proj/name4/version4/abc  \n/(path-to-proj)/proj/name5/version5/abc   \n</code></pre>\n\n<p>(path to proj) is alphanumeric,<br>\nproj is alphabets only,<br>\nname&lt;> is alpha-numeric and may contain underscores,<br>\nversion&lt;> is alpha-numeric  </p>\n\n<p>I know that all of these paths have a file that matches said pattern. However, the result of my code is something as shown below:</p>\n\n<pre><code>File exists for name1 in path /(path-to-proj)/proj/name1/version1/abc\n: /(path-to-proj)/proj/name1/version1/abc\nDoes not exist for name2 in path /(path-to-proj)/proj/name2/version2/abc\n\nFile exists for name3 in path /(path-to-proj)/proj/name3/version3/abc\n: /(path-to-proj)/proj/name3/version3/abc\nDoes not exist for name4 in path /(path-to-proj)/proj/name4/version4/abc\n</code></pre>\n\n<p>The results alternate between 'Exists' and 'Does not exist'.\nWhat am I doing wrong?</p>\n"}, {"tags": ["perl", "libxml2"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573002476, "post_id": 58720866, "comment_id": 103735961, "body": "Out of curiosity, why are you requiring 5.31.3? It&#39;s really odd to require a dev version unless it fixes some specific bug that affects your code. The code you posted doesn&#39;t even require anything newer than 5.8!"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573002512, "post_id": 58720866, "comment_id": 103735971, "body": "Tip: Note that <code>use 5.12.0;</code> and higher implies <code>use strict;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 3, "last_activity_date": 1573000349, "last_edit_date": 1592644375, "creation_date": 1573000349, "answer_id": 58721432, "question_id": 58720866, "link": "https://stackoverflow.com/questions/58720866/perl-libxml-tidy-html/58721432#58721432", "title": "Perl LibXML tidy HTML", "body": "<p>According to the documentation copied below, <code>toStringHTML</code> produces an encoded byte string, so you shouldn't be encoding it again. Replace</p>\n<pre><code>open(my $FH, &quot;&gt;:encoding(UTF-8)&quot;, &quot;2.html&quot;)\n</code></pre>\n<p>with</p>\n<pre><code>open(my $FH, &quot;&gt;:raw&quot;, &quot;2.html&quot;)\n</code></pre>\n<hr />\n<blockquote>\n<p><strong>toStringHTML</strong></p>\n<pre><code>$str = $document-&gt;toStringHTML();\n</code></pre>\n<p><em>toStringHTML</em> serialize the tree to a byte string in the document encoding as HTML. With this method indenting is automatic and managed by libxml2 internally.</p>\n</blockquote>\n"}], "owner": {"reputation": 784, "user_id": 1118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466905ee415e4cd9667f29eea987f15b?s=128&d=identicon&r=PG", "display_name": "jonah_w", "link": "https://stackoverflow.com/users/1118630/jonah-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 58721432, "answer_count": 1, "score": 1, "last_activity_date": 1573000349, "creation_date": 1572995676, "last_edit_date": 1572996050, "question_id": 58720866, "link": "https://stackoverflow.com/questions/58720866/perl-libxml-tidy-html", "title": "Perl LibXML tidy HTML", "body": "<p>I have this HTML snippet in the file: 1.html:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/&gt;&lt;/head&gt;\r\n&lt;body&gt;\r\nabash\r\n&lt;div&gt;a\u00b7bash\u00b7ment&lt;/span&gt;\r\n&lt;h6&gt;1&lt;/h6&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>In the code above, the tags are not matched(<code>&lt;div&gt;</code> and <code>&lt;/span&gt;</code>). I wrote the following XML::LibXML codes to correct and tidy the tags:</p>\n\n\n\n<pre><code>use 5.31.3;\nuse strict;\nuse warnings FATAL =&gt; 'all';\nuse XML::LibXML;\nuse utf8::all;\nopen(my $FH, \"&gt;:encoding(UTF-8)\", \"2.html\") or die \"Can't open '1.html': $!\";\n@ARGV = \"1.html\";\nmy $parser = XML::LibXML-&gt;new();\n$parser-&gt;recover(1); \nsay $FH $parser-&gt;parse_html_string(join \"\", &lt;&gt;)-&gt;toStringHTML();\n</code></pre>\n\n<p>The results is:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\"&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"&gt;&lt;/head&gt;\r\n&lt;body&gt;\r\nabash\r\n&lt;div&gt;a\u00c2\u00b7bash\u00c2\u00b7ment\r\n&lt;/div&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>As you can see, the content of <code>div</code> tag is not showing properly, which should be the same as the original <code>a\u00b7bash\u00b7ment</code>. I guess this should be an encoding issue.  I'm not sure where to change the encoding settings. Does someone run into this issue before? </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["perl", "warnings"], "comments": [{"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 1, "creation_date": 1572986217, "post_id": 58719012, "comment_id": 103731084, "body": "Specific warnings are listed in perldiag: <a href=\"https://perldoc.pl/perldiag#Name-%22%25s::%25s%22-used-only-once:-possible-typo\" rel=\"nofollow noreferrer\">perldoc.pl/&hellip;</a>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572986800, "post_id": 58719012, "comment_id": 103731315, "body": "Perl warnings are documented in <a href=\"http://perldoc.perl.org/perldiag.html\" rel=\"nofollow noreferrer\">perldiag</a>, accessible via <code>perldoc perldiag</code> and <code>man perldiag</code>"}], "answers": [{"tags": [], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "is_accepted": true, "score": 3, "last_activity_date": 1573052132, "last_edit_date": 1573052132, "creation_date": 1572985843, "answer_id": 58719013, "question_id": 58719012, "link": "https://stackoverflow.com/questions/58719012/what-is-the-once-warnings-in-perl/58719013#58719013", "title": "What is the &quot;once&quot; warnings in perl?", "body": "<p>So long as you don't have <code>strict</code> on, perl allows you to use a variable without declaring it.</p>\n\n<pre><code>perl -wE'$foo = 4;'\n</code></pre>\n\n<p>Which outputs,</p>\n\n<blockquote>\n  <p>Name <code>main::foo</code> used only once: possible typo at <code>-e</code> line 1.</p>\n</blockquote>\n\n<p>Note under <code>strict</code> this wouldn't even be permitted,</p>\n\n<blockquote>\n  <p>Global symbol <code>$foo</code> requires explicit package name (did you forget to declare <code>my $foo</code>?) at -e line 1.</p>\n</blockquote>\n\n<p>You <em>can</em> disable the warning though, without enabling <code>strict</code> by doing <code>no warnings \"once\";</code> Though I would suggest strongly <strong>you simply remove the unused code instead of silencing the warning.</strong></p>\n\n<pre><code>perl -wE'no warnings \"once\"; $foo = 4;'\n</code></pre>\n\n<p>Which both looks ugly and does nothing.</p>\n"}, {"comments": [{"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1573067881, "post_id": 58720525, "comment_id": 103764277, "body": "David thank you for good explanation -- now I have reason to use <b>diagnostics</b> module."}], "tags": [], "owner": {"reputation": 13399, "user_id": 716443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d13509991dbbd5467f01f55988ae4e?s=128&d=identicon&r=PG", "display_name": "DavidO", "link": "https://stackoverflow.com/users/716443/davido"}, "is_accepted": false, "score": 2, "last_activity_date": 1573003575, "last_edit_date": 1573003575, "creation_date": 1572993519, "answer_id": 58720525, "question_id": 58719012, "link": "https://stackoverflow.com/questions/58719012/what-is-the-once-warnings-in-perl/58720525#58720525", "title": "What is the &quot;once&quot; warnings in perl?", "body": "<p>If you run the following you will trigger the warning, plus a little extra explanation:</p>\n\n<pre><code>perl -Mdiagnostics -Mwarnings -e '$foo=1'\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>Name \"main::foo\" used only once: possible typo at -e line 1 (#1)\n    (W once) Typographical errors often show up as unique variable names.\n    If you had a good reason for having a unique name, then just mention it\n    again somehow to suppress the message.  The our declaration is\n    provided for this purpose.\n\n    NOTE: This warning detects symbols that have been used only once so $c, @c,\n    %c, *c, &amp;c, sub c{}, c(), and c (the filehandle or format) are considered\n    the same; if a program uses $c only once but also uses any of the others it\n</code></pre>\n\n<p>The warning applies to symbol table entries (not \"my\" lexical variables).  If you add <code>-Mstrict</code> to the above, you'll create a strict violation because your variable violates <code>strict 'vars'</code>, which prohibits you using a variable that hasn't been declared, with the exception of package globals referred to by their fully-qualified name.  If you were to pre-declare <code>$foo</code> with <code>our</code>, the warning goes away:</p>\n\n<pre><code>perl -Mdiagnostics -Mwarnings -Mstrict=vars -E 'our $foo=1'\n</code></pre>\n\n<p>This works just fine; it avoids a strict violation, and avoids the \"once\" warning.   So the purpose of the warning is to alert you to the use of identifiers that are not declared, not using a fully-qualified name, and also only used once.  The objective is to help prevent typos in symbol names, the assumption being that if you use a symbol name only once and have not declared it, it may be a mistake.</p>\n\n<p>Special (punctuation) variables are exempted from this check. You can, therefore, refer to <code>$_</code> or <code>$/</code> only once and not trigger a warning. Also, <code>$a</code> and <code>$b</code> are exempt because they are considered special, for use in <code>sort {$a &lt;=&gt; $b} @list</code>; in such constructs they may appear only a single time yet it wouldn't be useful to raise a warning for what is fairly typical code.</p>\n\n<p>You can find the 'once' warning listed in the Warnings Hierarchy here: <a href=\"https://perldoc.perl.org/warnings.html#Category-Hierarchy\" rel=\"nofollow noreferrer\">perldoc warnings</a>.</p>\n\n<p>A list of all diagnostic blurbs is available in <a href=\"https://perldoc.perl.org/perldiag.html\" rel=\"nofollow noreferrer\">perldoc perldiag</a>.</p>\n"}], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 58719013, "answer_count": 2, "score": 0, "last_activity_date": 1573052132, "creation_date": 1572985843, "question_id": 58719012, "link": "https://stackoverflow.com/questions/58719012/what-is-the-once-warnings-in-perl", "title": "What is the &quot;once&quot; warnings in perl?", "body": "<p>I have code that has,</p>\n\n<pre><code>no warnings 'once';\n</code></pre>\n\n<p>Reading <code>man warnings</code> I don't see an occurrence of <code>/once/</code> what does this do?</p>\n"}, {"tags": ["perl", "hash", "file-comparison"], "answers": [{"tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": true, "score": 1, "last_activity_date": 1572987726, "creation_date": 1572987726, "answer_id": 58719419, "question_id": 58718487, "link": "https://stackoverflow.com/questions/58718487/perl-extract-columns-from-two-files-based-on-condition/58719419#58719419", "title": "Perl extract columns from two files based on condition", "body": "<p>Here is an example using array of arrays as values in <code>%hash1</code> (since the keys are not unique):</p>\n\n<pre><code>use feature qw(say);\nuse strict;\nuse warnings;\n\nmy %hash1;\nopen(FH1, \"file1.txt\");\nwhile(&lt;FH1&gt;){\n    chomp($_);\n    my @val = split(' ', $_);\n    push @{ $hash1{$val[2]} }, [ @val[0,1] ];\n}\n\nopen(FH2, \"file2.txt\");\nwhile(&lt;FH2&gt;){\n    chomp($_);\n    my @array = split(',', $_);\n    if ( exists $hash1{$array[2]} ) {\n        for my $item ( @{ $hash1{$array[2]} } ) {\n            say join ',',  @$item, @array[0,1,3,4,5];\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>RAC2,GK2,R1,PAAE,TESTA,COLA,NO\nRAC1,GK4,R1,PAAE,TESTA,COLA,NO\nRAC1,GK1,R2,RWWG,TESTB,COLM,YES\nRAC2,GK5,R2,RWWG,TESTB,COLM,YES\n</code></pre>\n"}], "owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58719419, "answer_count": 1, "score": 0, "last_activity_date": 1572987726, "creation_date": 1572983464, "last_edit_date": 1572985474, "question_id": 58718487, "link": "https://stackoverflow.com/questions/58718487/perl-extract-columns-from-two-files-based-on-condition", "title": "Perl extract columns from two files based on condition", "body": "<p>I have 2 files, say file1 and file2.</p>\n\n<p>file1.txt</p>\n\n<pre><code>RAC1 GK1 111\nRAC2 GK2 222\nRAC1 GK3 333\nRAC1 GK4 222\nRAC2 GK5 111\n</code></pre>\n\n<p>file2.txt</p>\n\n<pre><code>R1,PAAE,222,TESTA,COLA,NO\nR2,RWWG,111,TESTB,COLM,YES\nR3,TDAS,444,TESTC,COLZ,NO\n</code></pre>\n\n<p>I am comparing 2 files and trying to extract data from them. Condition here is if Column3 value of file1 matches with Column3 value of file2 then print the following output -</p>\n\n<pre><code>RAC1,GK1,111,R2,RWWG,TESTB,COLM,YES\nRAC2,GK5,111,R2,RWWG,TESTB,COLM,YES\nRAC2,GK2,222,R1,PAAE,TESTA,COLA,NO\nRAC1,GK4,222,R1,PAAE,TESTA,COLA,NO\n</code></pre>\n\n<p>I have written a script for the same, by taking file1 column2 value as key. But this column value doesn't exists in file2. So comparison is not working. </p>\n\n<p>Even I am not able to take column3(from file1) as key, because its having duplicated values.</p>\n\n<p>Code below - </p>\n\n<pre><code>my %hash1 = ();\n\nopen(FH1, \"file1.txt\");\n\nwhile(&lt;FH1&gt;){\n    chomp($_);\n    my @val = split(' ', $_);\n\n    $hash1{$val[1]}{'RAC_VAL'}   = $val[0];\n    $hash1{$val[1]}{'ID'} = $val[2];\n}\n\n#print Dumper(\\%hash1);\n\n\nopen(FH2, \"file2.txt\");\nwhile(&lt;FH2&gt;){\n    chomp($_);\n    my @array = split(',', $_);\n    print \"$hash1{$array[2]}{'RAC_VAL'},,$hash1{$array[2]}{'ID'},$array[0],$array[1],$array[3],$array[4],$array[5]\\n\" if(exists $hash1{$array[2]}{'ID'});   \n}\n</code></pre>\n\n<p>Please help me to get output for above data files based on the above said condition.</p>\n"}, {"tags": ["perl", "perl-pod"], "comments": [{"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 2, "creation_date": 1572972992, "post_id": 58714935, "comment_id": 103725363, "body": "I&#39;m not recommending this (I prefer documentation to be statically written, since it is not as dynamic as code) but <a href=\"https://metacpan.org/pod/Pod::Weaver\" rel=\"nofollow noreferrer\">Pod::Weaver</a> can generate pod and can be invoked with <a href=\"https://metacpan.org/pod/Dist::Zilla::Plugin::PodWeaver\" rel=\"nofollow noreferrer\">Dist::Zilla</a> or <a href=\"https://metacpan.org/pod/App::podweaver\" rel=\"nofollow noreferrer\">App::podweaver</a>."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1572984591, "post_id": 58714935, "comment_id": 103730413, "body": "You could also generate the pod from a template. Some template language (e.g. Template-Toolkit) are pretty rich and could definitely achieve what you want. But it wouldn&#39;t have the feel of code."}, {"owner": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "edited": false, "score": 0, "creation_date": 1591048788, "post_id": 58714935, "comment_id": 109904242, "body": "As a reader, seeing the same text over and over again annoys me. As a writer, I think you&#39;re doing something wrong. Looking for a technical solution to a bad idea is also a bad idea."}, {"owner": {"reputation": 618, "user_id": 2057516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sEoLL.jpg?s=128&g=1", "display_name": "hepcat72", "link": "https://stackoverflow.com/users/2057516/hepcat72"}, "reply_to_user": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "edited": false, "score": 0, "creation_date": 1591048920, "post_id": 58714935, "comment_id": 109904291, "body": "@brian d foy - If you&#39;re reading perlpod as a book instead of as a lookup reference, I&#39;d agree."}], "answers": [{"comments": [{"owner": {"reputation": 618, "user_id": 2057516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sEoLL.jpg?s=128&g=1", "display_name": "hepcat72", "link": "https://stackoverflow.com/users/2057516/hepcat72"}, "edited": false, "score": 0, "creation_date": 1591050347, "post_id": 58715336, "comment_id": 109904766, "body": "Is there a way to make those links do anything in a terminal? I&#39;ve never seen them have any utility for navigation in a pager.  What pager do you use (if those links do anything for you)?"}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": true, "score": 7, "last_activity_date": 1572970388, "creation_date": 1572970388, "answer_id": 58715336, "question_id": 58714935, "link": "https://stackoverflow.com/questions/58714935/is-there-a-way-to-re-use-text-in-perlpod-documentation/58715336#58715336", "title": "Is there a way to re-use text in perlpod documentation?", "body": "<p>As you've realised, <a href=\"https://perldoc.perl.org/perlpod.html\" rel=\"noreferrer\">Pod</a> is (deliberately) a very simple markup language. It doesn't have any particularly complicated feature and one of the things it is missing is a way to embed text from another source.</p>\n\n<p>I'd suggest moving the repeated text to its own section and linking to that section (using <code>L&lt;...&gt;</code>) whenever you want to reference that text.</p>\n"}, {"comments": [{"owner": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "edited": false, "score": 0, "creation_date": 1591048908, "post_id": 58717000, "comment_id": 109904286, "body": "Note that <code>perldoc</code> will preferentially chose a <i>.pod</i> file over a <i>.pm</i> file, which means <code>perldoc -m</code> doesn&#39;t get you to the code anymore. It&#39;s not wrong to have use <i>.pod</i> files, but it certainly annoys me."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "edited": false, "score": 0, "creation_date": 1591055333, "post_id": 58717000, "comment_id": 109906055, "body": "@briandfoy Thank you for the comment, that needed be mentioned.  (I don&#39;t use <code>-m</code> on code with docs prepared this way so I didn&#39;t know.)  I fear that if I can only use in-file docs (so to call them) then I get restricted quite a bit. The project I mention would then need a non-native tool for its intended documentation, while the use of separate <code>.pod</code> files made POD itself fully adequate."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "edited": false, "score": 1, "creation_date": 1591055782, "post_id": 58717000, "comment_id": 109906138, "body": "@briandfoy Please note that the other option I offer doesn&#39;t have that problem (<code>perldoc</code> works with it) and yet allows full use of Perl on generating and processing documentation text.  I find it silly to be reduced to quoting exact text in order to be able to use docs for more than formatting.  While POD is basic it is not <i>that</i> basic.  I added a note on all this at the end, thank you."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 4, "last_activity_date": 1591056003, "last_edit_date": 1591056003, "creation_date": 1572976826, "answer_id": 58717000, "question_id": 58714935, "link": "https://stackoverflow.com/questions/58714935/is-there-a-way-to-re-use-text-in-perlpod-documentation/58717000#58717000", "title": "Is there a way to re-use text in perlpod documentation?", "body": "<p>While Pod markup is meant to be very basic, we don't have to literally type it all by hand.</p>\n\n<p>Text for documentation can be processed like any other text in Perl, using its extensive set of tools, to create a string with pod-formatted text. That string can then be displayed using core <a href=\"https://perldoc.perl.org/Pod/Usage.html\" rel=\"nofollow noreferrer\">Pod::Usage</a>, via a file (that can be removed or kept), or directly by using core <a href=\"https://perldoc.perl.org/Pod/Simple.html\" rel=\"nofollow noreferrer\">Pod::Simple</a>.</p>\n\n<p><strong>Display the Pod string by writing a file</strong></p>\n\n<pre><code>use warnings;\nuse strict;\nuse feature 'say';\nuse Path::Tiny;    # convenience, to \"spew\" a file    \n\nmy $man = shift;        \nshow_pod() if $man;\nsay \"done $$\";\n\nsub show_pod {\n    require Pod::Usage; Pod::Usage-&gt;import('pod2usage');\n\n    my $pod_text = make_pod();\n    my $pod_file = $0 =~ s/\\.pl$/.pod/r;\n    path($pod_file)-&gt;spew($pod_text);\n\n    pod2usage( -verbose =&gt; 2, -input =&gt; $pod_file );  # exits by default\n}\n\nsub make_pod {\n    my $repeated = q(lotsa text that gets repeated);\n    my $doc_text = &lt;&lt;EOD;\n=head1 NAME\n\n$0 - demo perldoc\n\n=head1 SYNOP...\n\nText that is also used elsewhere: $repeated...\n\n=cut\nEOD\n\n    return $doc_text;\n}\n</code></pre>\n\n<p>The <code>.pod</code> file can be removed: add <code>-exitval =&gt; 'NOEXIT'</code> to <code>pod2usage</code> arguments so that it doesn't exit and then remove the file.  Or, rather, keep it available for other tools and uses. </p>\n\n<p>I've split the job into two subs as a hint, since it can be useful to be able to only write a <code>.pod</code> file, which can then also be used and viewed in other ways and formats.<sup>&dagger;</sup>  This isn't needed to just show docs, and all Pod business can be done in one sub.</p>\n\n<p><strong>Dispaly the Pod string directly</strong></p>\n\n<p>If there is no desire to keep a <code>.pod</code> file around then we don't have to make it</p>\n\n<pre><code>sub show_pod {\n    my $pod_text = make_pod();\n\n    require Pod::Simple::Text;\n    Pod::Simple::Text-&gt;filter( \\$pod_text );  # doesn't exit so add that\n}\n</code></pre>\n\n<p>(the rest of the program above is the same) &nbsp; The <code>-&gt;filter</code> call is a shortcut for creating an object, setting a filehandle, and processing the contents. See docs for a whole lot more.</p>\n\n<p>Either of these approaches provides you with far more flexibility.  </p>\n\n<p>Also, while one can indeed solve the repeated text by referencing a separate section with that text, that of course doesn't allow us to use variables or do any Perl processing -- what is all available when you write a Pod string, which is then passed over to <code>perlpod</code> to dispaly.</p>\n\n<p><strong>Note</strong> &nbsp; Use of <code>.pod</code> files affects <code>perldoc</code>.  Thanks to <code>@briandfoy</code> for a comment. </p>\n\n<p>For smaller documentation, that has no particular benefit of using separate <code>.pod</code> files, I recommend the second approach, as hinted in the answer. It only differs in how the docs text is organized in the file while still allowing one to process it as any text is normally processed with Perl.</p>\n\n<p>For use cases where <code>.pod</code> files are of good value I still find it an acceptable trade-off but that is my call. Be aware that <code>perldoc</code> is affected and assess how much that matters in your project.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup> I use a system like this in a large project, with <code>.pod</code> files in their directory. There is also a simple separate script for overall documentation management, that invokes  individual programs with options to write/update their <code>.pod</code>s, in HTML with CPAN's style-file, for the main web page.  Any program can also simply display its docs in a desired format.</p>\n"}], "owner": {"reputation": 618, "user_id": 2057516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/sEoLL.jpg?s=128&g=1", "display_name": "hepcat72", "link": "https://stackoverflow.com/users/2057516/hepcat72"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 58715336, "answer_count": 2, "score": 4, "last_activity_date": 1591056003, "creation_date": 1572969058, "question_id": 58714935, "link": "https://stackoverflow.com/questions/58714935/is-there-a-way-to-re-use-text-in-perlpod-documentation", "title": "Is there a way to re-use text in perlpod documentation?", "body": "<p>I have a bunch of repeated text in my perlpod documentation.  I could of course create a separate section and reference it, but I was wondering if there's a way to enter the text once somewhere and have it inserted in multiple places?</p>\n\n<p>I don't think this is possible, but thought I'd ask to make sure I'm not missing anything.</p>\n\n<p>Or - perhaps there's a better perl documentation technique?</p>\n"}, {"tags": ["perl", "automated-tests", "cpan"], "comments": [{"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1572972775, "post_id": 58714832, "comment_id": 103725246, "body": "Are you setting the <a href=\"https://metacpan.org/pod/CPANPLUS::Config#cpantest\" rel=\"nofollow noreferrer\">cpantest</a> option? It doesn&#39;t specify whether it will report pass or fail, it seems like an oversight if it only reports fails."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1572972856, "post_id": 58714832, "comment_id": 103725291, "body": "There is <a href=\"https://metacpan.org/pod/App::cpanminus::reporter\" rel=\"nofollow noreferrer\">metacpan.org/pod/App::cpanminus::reporter</a> for <code>cpanm</code>. Is there a similar one for <code>cpanp</code> maybe?"}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "reply_to_user": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1573059168, "post_id": 58714832, "comment_id": 103760169, "body": "@Grinnz Yes, I have cpantest option set. It&#39;s not an oversight to have pass reports disabled by default. Most people use cpanp on every deployment, as opposed to building packages.So the desision not to send passes avoids flooding of cpantesters which has limited capacity."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1573062107, "post_id": 58714832, "comment_id": 103761702, "body": "It seems unfortunate, PASS reports are just as important to determine the cause of a problem."}], "answers": [{"tags": [], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "is_accepted": false, "score": 1, "last_activity_date": 1573058804, "creation_date": 1573058804, "answer_id": 58734916, "question_id": 58714832, "link": "https://stackoverflow.com/questions/58714832/how-do-i-send-pass-reports-to-cpan-testers-from-cpanplus/58734916#58734916", "title": "How do I send PASS reports to CPAN Testers from CPANPLUS?", "body": "<p>So far the best solution I've found is to use <a href=\"https://metacpan.org/pod/CPANPLUS::YACSmoke\" rel=\"nofollow noreferrer\">https://metacpan.org/pod/CPANPLUS::YACSmoke</a>. It lets me test individual distributions specified on the command line while avoiding retesting the same version over and over.</p>\n"}], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573058804, "creation_date": 1572968710, "question_id": 58714832, "link": "https://stackoverflow.com/questions/58714832/how-do-i-send-pass-reports-to-cpan-testers-from-cpanplus", "title": "How do I send PASS reports to CPAN Testers from CPANPLUS?", "body": "<p>CPANPLUS has a plugin to report failures to CPAN Testers. However it doesn't report passes, only failures. How do I report passes for some modules I'm interested in?</p>\n\n<p>Ideally I'd like to have an ability to smoke some modules from a predefined whitelist whenever a new versions of them are available. I don't want to constantly monitor the new versions, as I don't have a constantly running box, but I'd like to regularly test the modules I'm interested in.</p>\n\n<p>Ideally I'd like to do that from <code>cpanp</code> because it does other things for me, such as finding outdated modules and building various binary packages of modules before installing them. So if it's some other tool than cpanp, I'd like to avoid the need to install the modules in the process. In case it's needed I can install the dependencies using cpanp and then run the tests using other tools. </p>\n"}, {"tags": ["perl", "jenkins"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572974045, "post_id": 58713784, "comment_id": 103725832, "body": "Re &quot;<i>Error number 65280, error message: &quot;No such file or directory&quot;</i>&quot;, <code>$!</code> (&quot;No such file or directory&quot;) is meaningless when the error isn&#39;t <code>-1</code>. 65280 (0xFF00) means the child ran, but returned exit code 255 (0xFF)"}, {"owner": {"reputation": 815, "user_id": 1852977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TzpUe.png?s=128&g=1", "display_name": "Shai Alon", "link": "https://stackoverflow.com/users/1852977/shai-alon"}, "edited": false, "score": 0, "creation_date": 1572985524, "post_id": 58713784, "comment_id": 103730804, "body": "And if I have variables inside the cmd?     &quot;xcopy /Y \\&quot;$text_file\\&quot; $text_local_shared_path&quot; ?"}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572974517, "post_id": 58713899, "comment_id": 103726038, "body": "Re &quot;<i>Perl recognises forward slashes in Windows paths</i>&quot;, Not really. Perl doesn&#39;t know anything about paths. It&#39;s Windows itself that recognizes forward slashes as a valid path separator. That said, many Windows commands require paths using <code>&#47;</code> as a separator to be quoted since <code>&#47;</code> normally denotes the start of a command line option. Unfortunately, that trick doesn&#39;t work with <code>xcopy</code>. It simply doesn&#39;t accept <code>&#47;</code> as a path separator."}, {"owner": {"reputation": 815, "user_id": 1852977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TzpUe.png?s=128&g=1", "display_name": "Shai Alon", "link": "https://stackoverflow.com/users/1852977/shai-alon"}, "edited": false, "score": 0, "creation_date": 1572985427, "post_id": 58713899, "comment_id": 103730762, "body": "And if I have variables inside the cmd?     &quot;xcopy /Y \\&quot;$text_file\\&quot; $text_local_shared_path&quot; ?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 815, "user_id": 1852977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TzpUe.png?s=128&g=1", "display_name": "Shai Alon", "link": "https://stackoverflow.com/users/1852977/shai-alon"}, "edited": false, "score": 0, "creation_date": 1572987278, "post_id": 58713899, "comment_id": 103731513, "body": "@ShaiAlon: Or use <code>qq[...]</code> instead of <code>&quot;...&quot;</code> to simplify things."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 3, "last_activity_date": 1572967653, "last_edit_date": 1572967653, "creation_date": 1572965518, "answer_id": 58713899, "question_id": 58713784, "link": "https://stackoverflow.com/questions/58713784/perl-system-command-fails-with-bad-file-descriptor-when-running-via-jenkins/58713899#58713899", "title": "Perl SYSTEM command fails with &quot;Bad file descriptor&quot; when running via Jenkins", "body": "<p>A backslash has a special meaning in a Perl quoted string. It is used to escape the following character - to \"turn off\" any special meaning. If you want to use a backslash in a Perl quoted string, then you need to use another backslash to escape it.</p>\n\n<pre><code>my $cmd = 'xcopy /Y c:\\\\DBs\\\\Support\\\\db.bak c:\\\\jenkins\\\\workdir\\\\sql-bak-files';\n</code></pre>\n\n<p>Alternatively, Perl recognises forward slashes in Windows paths, so it might be easier to replace your code with this:</p>\n\n<pre><code>my $cmd = 'xcopy /Y c:/DBs/Support/db.bak c:/jenkins/workdir/sql-bak-files';\n</code></pre>\n\n<p>Note that in both cases I have replaced your double-quotes with single-quotes. This has no effect on your problem, but it seems strange to use double-quoted strings if you're not using any of their special characteristics (like the expansion of variables).</p>\n\n<p><strong>Update:</strong> To debug a problem like this, you can try <code>print</code>ing the string.</p>\n\n<pre><code>$ perl -E'say \"xcopy /Y c:\\DBs\\Support\\db.bak c:\\jenkins\\workdir\\sql-bak-files\"'\nxcopy /Y c:DBsSupportdb.bak c:jenkinsworkdirsql-bak-files\n</code></pre>\n"}], "owner": {"reputation": 815, "user_id": 1852977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TzpUe.png?s=128&g=1", "display_name": "Shai Alon", "link": "https://stackoverflow.com/users/1852977/shai-alon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572967653, "creation_date": 1572965108, "question_id": 58713784, "link": "https://stackoverflow.com/questions/58713784/perl-system-command-fails-with-bad-file-descriptor-when-running-via-jenkins", "title": "Perl SYSTEM command fails with &quot;Bad file descriptor&quot; when running via Jenkins", "body": "<p>I have a simple system command to copy file from one folder to another:</p>\n\n<p><code>my $cmd = \"xcopy /Y c:\\DBs\\Support\\db.bak c:\\jenkins\\workdir\\sql-bak-files\";</code></p>\n\n<p>When I try to run the following system commands, all fails:</p>\n\n<p><code>1. my $res = qx/$cmd/;\n 2. my $res = qx($cmd);\n 3. using back ticks\n</code>\nAll tries returned the error: <code>Error number -1, error message: \"Bad file descriptor\"</code>.</p>\n\n<p>When trying to use system($cmd) the error was <code>Error number 65280, error message: \"No such file or directory\"</code>.</p>\n\n<p>This perl code is running via Jenkins (ver 2.190.1) and perl v5.26.0.\nThis problem started after migrating the code from mercurial to git, but I don't think it's related.\nIt worked before, but now always fail :(</p>\n"}, {"tags": ["perl", "design-patterns", "output", "extract", "ncbi"], "comments": [{"owner": {"reputation": 2415, "user_id": 4251338, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/UNbCO.png?s=128&g=1", "display_name": "ssr1012", "link": "https://stackoverflow.com/users/4251338/ssr1012"}, "edited": false, "score": 0, "creation_date": 1572961747, "post_id": 58712339, "comment_id": 103718728, "body": "$content =~ /Query((?:(?!Alignments).)*)Alignments$/gs;"}, {"owner": {"reputation": 85, "user_id": 11562346, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0HbOdHQ-ZcI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfC6LLHMkb1SiGuqx_42piI2fmZCw/mo/photo.jpg?sz=128", "display_name": "RebiKirl", "link": "https://stackoverflow.com/users/11562346/rebikirl"}, "reply_to_user": {"reputation": 2415, "user_id": 4251338, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/UNbCO.png?s=128&g=1", "display_name": "ssr1012", "link": "https://stackoverflow.com/users/4251338/ssr1012"}, "edited": false, "score": 0, "creation_date": 1572962327, "post_id": 58712339, "comment_id": 103719074, "body": "Thank you for your answer. I formatted the script according to your suggestion by replacing &quot;$content =~ /Query\\s+([A-Z0-9_.]+)Alignments$/; &quot; with &quot;$content =~ /Query((?:(?!Alignments).)*)Alignments$/gs; &quot; but the alignment (paragraph &quot;alignment&quot; and next &quot;Query&quot;) is still printed in the output. Do you have any suggestion ?"}], "answers": [{"tags": [], "owner": {"reputation": 2415, "user_id": 4251338, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/UNbCO.png?s=128&g=1", "display_name": "ssr1012", "link": "https://stackoverflow.com/users/4251338/ssr1012"}, "is_accepted": true, "score": 2, "last_activity_date": 1572962908, "creation_date": 1572962908, "answer_id": 58713108, "question_id": 58712339, "link": "https://stackoverflow.com/questions/58712339/extract-matching-pattern-from-input-file-and-print-to-output-file-in-perl/58713108#58713108", "title": "Extract matching pattern from input file and print to output file in Perl", "body": "<p>Please try this:</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nuse warnings;\n\nopen(GENBANK, \"txt.txt\") or die \"\";\nlocal $/; $_= &lt;GENBANK&gt;; my $content = $_;\n\nmy $outfile = 'output.txt';\nopen(OUT,\"&gt;\",$outfile) or die \"Could not open $outfile : $!\";\nmy (@fetch) = $content=~m{(Query\\s*\\#((?:(?!Alignments\\:\\n).)*)\\nAlignments\\:\\n)}gs;\n#print OUT @fetch;\nprint OUT join \"\\n\", @fetch;\n</code></pre>\n\n<p>Please change wherever you need.</p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 85, "user_id": 11562346, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0HbOdHQ-ZcI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfC6LLHMkb1SiGuqx_42piI2fmZCw/mo/photo.jpg?sz=128", "display_name": "RebiKirl", "link": "https://stackoverflow.com/users/11562346/rebikirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58713108, "answer_count": 1, "score": 1, "last_activity_date": 1572962908, "creation_date": 1572960434, "question_id": 58712339, "link": "https://stackoverflow.com/questions/58712339/extract-matching-pattern-from-input-file-and-print-to-output-file-in-perl", "title": "Extract matching pattern from input file and print to output file in Perl", "body": "<p>I have huge input file from ncbi blastn in this form:</p>\n\n<pre><code>&lt;ul id=\"msgFrm\" class=\" msg\"&gt;\nJob Title: otu0                  \nDatabase: rRNA_typestrains/prokaryotic_16S_ribosomal_RNA 16S ribosomal RNA (Bacteria and Archaea)\nQuery #1: otu0 Query ID: lcl|Query_16950 Length: 460\n\nSequences producing significant alignments:\n                                                                  Max    Total Query   E   Per.                  \nDescription                                                       Score  Score cover Value Ident  Accession        \nBacteroides dorei strain 175 16S ribosomal RNA, partial sequence  839    839   100%  0.0   99.57  NR_041351.1      \n\nAlignments:\n&gt;Bacteroides dorei strain 175 16S ribosomal RNA, partial sequence\nSequence ID: NR_041351.1 Length: 1493 \nRange 1: 341 to 800\n\nScore:839 bits(454), Expect:0.0, \nIdentities:458/460(99%),  Gaps:0/460(0%), Strand: Plus/Plus\n\nQuery  1    CCTACGGGGGGCAGCAGTGAGGAATATTGGTCAATGGGCGATGGCCTGAACCAGCCAAGT  60\n            |||||||| |||||||||||||||||||||||||||||||||||||||||||||||||||\nSbjct  341  CCTACGGGAGGCAGCAGTGAGGAATATTGGTCAATGGGCGATGGCCTGAACCAGCCAAGT  400\n\n\nQuery #2: otu1 Query ID: lcl|Query_16951 Length: 460\n\nSequences producing significant alignments:\n                                                                  Max    Total Query   E   Per.                  \nDescription                                                       Score  Score cover Value Ident  Accession          \nBacteroides vulgatus ATCC 8482 16S ribosomal RNA, partial...      811    811   100%  0.0   98.48  NR_074515.1      \nBacteroides paurosaccharolyticus strain WK042 16S ribosomal RN... 673    673   100%  0.0   93.06  NR_112668.1      \n\n\nAlignments:\n&gt;Bacteroides dorei strain 175 16S ribosomal RNA, partial sequence\nSequence ID: NR_041351.1 Length: 1493 \nRange 1: 341 to 800\n\nScore:833 bits(451), Expect:0.0, \nIdentities:457/460(99%),  Gaps:0/460(0%), Strand: Plus/Plus\n\nQuery  1    CCTACGGGGGGCAGCAGTGAGGAATATTGGTCAATGGGCGATGGCCTGAACCAGCCAAGT  60\n            |||||||| |||||||||||||||||||||||||||||||||||||||||||||||||||\nSbjct  341  CCTACGGGAGGCAGCAGTGAGGAATATTGGTCAATGGGCGATGGCCTGAACCAGCCAAGT  400\n\n\nQuery #3: otu2 Query ID: lcl|Query_16952 Length: 460\n\nSequences producing significant alignments:\n                                                                  Max    Total Query   E   Per.                  \nDescription                                                       Score  Score cover Value Ident  Accession             \nBacteroides sartorii JCM 16497 16S ribosomal RNA, partial...      684    684   100%  0.0   93.48  NR_113064.1      \nBacteroides paurosaccharolyticus strain WK042 16S ribosomal RN... 678    678   100%  0.0   93.28  NR_112668.1      \n\n\nAlignments:\n&gt;Bacteroides dorei strain 175 16S ribosomal RNA, partial sequence\nSequence ID: NR_041351.1 Length: 1493 \nRange 1: 341 to 800\n\nScore:839 bits(454), Expect:0.0, \nIdentities:458/460(99%),  Gaps:0/460(0%), Strand: Plus/Plus\n\nQuery  1    CCTACGGGTGGCAGCAGTGAGGAATATTGGTCAATGGGCGATGGCCTGAACCAGCCAAGT  60\n            |||||||| |||||||||||||||||||||||||||||||||||||||||||||||||||\nSbjct  341  CCTACGGGAGGCAGCAGTGAGGAATATTGGTCAATGGGCGATGGCCTGAACCAGCCAAGT  400\n</code></pre>\n\n<p>...and so one.</p>\n\n<p>Now, for each \"Query #\" in the file, I need to extract the paragraph information included between \"Query #\" and \"Alignments\" and print in another output file.</p>\n\n<p>I tried with the following basic code but I am encountering some difficulties in Perl programming .  Can someone help me in resolving the issue? Thank you a lot</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nuse warnings;\n\nopen(GENBANK, \"Bact_ncbi_output.txt\") or die;\n\nmy $outfile = 'output.txt';\nopen OUT,'&gt;',$outfile \n  or die \"Could not open $outfile : $!\";\n\n$content = join(\"\", &lt;GENBANK&gt;);   \nclose GENBANK;\n\n$content =~ /Query\\s+([A-Z0-9_.]+)Alignments$/;         \n\nprint OUT \"$content\\n\";\n</code></pre>\n"}, {"tags": ["regex", "perl", "grep", "binary", "hex"], "comments": [{"owner": {"reputation": 4590, "user_id": 3120884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/116656a5f0b09d1a524808706d709d9c?s=128&d=identicon&r=PG&f=1", "display_name": "stevesliva", "link": "https://stackoverflow.com/users/3120884/stevesliva"}, "edited": false, "score": 0, "creation_date": 1572976688, "post_id": 58711809, "comment_id": 103727011, "body": "<code>grep -z &#39;^&#39;$&#39;\\xff\\xd8&#39;</code> ?"}, {"owner": {"reputation": 105, "user_id": 7418850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8960959514a539266d3acad288f8323c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7418850/brian"}, "reply_to_user": {"reputation": 4590, "user_id": 3120884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/116656a5f0b09d1a524808706d709d9c?s=128&d=identicon&r=PG&f=1", "display_name": "stevesliva", "link": "https://stackoverflow.com/users/3120884/stevesliva"}, "edited": false, "score": 0, "creation_date": 1573002209, "post_id": 58711809, "comment_id": 103735909, "body": "stevesliva - I see -z to interpret nulls as EOL instead of normal LF as EOL but I&#39;m not sure why one or the other matters.  The regex carat (^) anchors to the beginning of line, but I do not want that.  I want to anchor to the beginning of the entire sequence of characters (\\A)."}, {"owner": {"reputation": 11918, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 0, "creation_date": 1573102533, "post_id": 58711809, "comment_id": 103773676, "body": "Consider using <code>-a -b</code> to get the byte offset for the match with the &#39;false positive&#39;. <code>LC_ALL=C grep -P -a -b &quot;\\A\\xff\\xd8&quot; junk.txt</code>. It should report the offset of the match, which might give you some clue."}, {"owner": {"reputation": 11918, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 0, "creation_date": 1573102622, "post_id": 58711809, "comment_id": 103773690, "body": "Also, consider the for big binary files, grep will have to somehow split the files into multiple blocks, which will run against the RE. May be the false positive comes from one of those blocks."}, {"owner": {"reputation": 105, "user_id": 7418850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8960959514a539266d3acad288f8323c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7418850/brian"}, "edited": false, "score": 0, "creation_date": 1573136292, "post_id": 58711809, "comment_id": 103789587, "body": "dash-o, Thanks for your ideas!  I looked into -a and -b, and they make some differences without addressing the core problem.  I did look through the files and yes, some of them had the byte sequence later in the file, so I got the same info differently.  But knowing that, uhh... same problem exists."}, {"owner": {"reputation": 105, "user_id": 7418850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8960959514a539266d3acad288f8323c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7418850/brian"}, "edited": false, "score": 0, "creation_date": 1573136405, "post_id": 58711809, "comment_id": 103789647, "body": "dash-o, I&#39;m not sure what you mean &quot;run up against the RE&quot;.  Help me understand what you&#39;re thinking about block reads."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7418850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8960959514a539266d3acad288f8323c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7418850/brian"}, "edited": false, "score": 0, "creation_date": 1573093405, "post_id": 58731628, "comment_id": 103771911, "body": "dash-o,  Thank you. In the post I showed links specifying the /A option.  The file utility is cool, but is kind of reverse - I want to search recursive files for a certain byte sequence, whereas file searches many byte sequences against a single or limited set of files."}, {"owner": {"reputation": 11918, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "reply_to_user": {"reputation": 105, "user_id": 7418850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8960959514a539266d3acad288f8323c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7418850/brian"}, "edited": false, "score": 0, "creation_date": 1573102762, "post_id": 58731628, "comment_id": 103773724, "body": "I would note that file can work on arbitrary list of files, and you can customize the list of test to perform only one test. The <code>magic</code> search patterns are more powerful (vs. grep) for assertiong on binary data. I&#39;ll post an example as separate answer"}, {"owner": {"reputation": 105, "user_id": 7418850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8960959514a539266d3acad288f8323c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7418850/brian"}, "edited": false, "score": 0, "creation_date": 1573136543, "post_id": 58731628, "comment_id": 103789737, "body": "dash-o, are you thinking maybe generate a list of all recurse files at run-time, and maybe create my own magic search pattern in the config file?  I need to go read about file magic search patterns..."}, {"owner": {"reputation": 11918, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "reply_to_user": {"reputation": 105, "user_id": 7418850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8960959514a539266d3acad288f8323c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7418850/brian"}, "edited": false, "score": 0, "creation_date": 1573144202, "post_id": 58731628, "comment_id": 103794185, "body": "Exactly as you described."}], "tags": [], "owner": {"reputation": 11918, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1573048005, "creation_date": 1573048005, "answer_id": 58731628, "question_id": 58711809, "link": "https://stackoverflow.com/questions/58711809/grep-list-files-that-start-with-regex-binary-byte-sequence/58731628#58731628", "title": "Grep - list files that start with regex binary byte sequence?", "body": "<p>According to <code>grep</code> manual, there is no support for '\\A` anchoring, only for '^' and '$'</p>\n\n<pre><code>3.4 Anchoring\n=============\nThe caret \u2018^\u2019 and the dollar sign \u2018$\u2019 are meta-characters that\nrespectively match the empty string at the beginning and end of a line.\nThey are termed \u201canchors\u201d, since they force the match to be \u201canchored\u201d\nto beginning or end of a line, respectively.\n</code></pre>\n\n<p>Also, recall that grep is a line oriented search utility. It has few options to handle binary files (--binary-files=binary, text, without-match). None of them changes the 'nature' of the search - it will still look for regexp in <code>lines</code></p>\n\n<p>Two option to consider</p>\n\n<ol>\n<li>If you are looking for a search on 'file types' (JPEG, PDF), consider using the <code>file</code> utility. It uses the 'magic' database to examine the file content, and determinte the 'file type'. It included JPEG, PDF and more types.</li>\n<li>Use other utility (sed, perl), which allows more control over location (e.g., you can limit search to the first line of the file, etc). You will need to spend more on setting those filters. Personally, I would go with Perl, if you take this route.</li>\n</ol>\n"}], "owner": {"reputation": 105, "user_id": 7418850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8960959514a539266d3acad288f8323c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7418850/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573093482, "creation_date": 1572958458, "last_edit_date": 1573093482, "question_id": 58711809, "link": "https://stackoverflow.com/questions/58711809/grep-list-files-that-start-with-regex-binary-byte-sequence", "title": "Grep - list files that start with regex binary byte sequence?", "body": "<p>I want to list files that start with a certain byte sequence.  My ideas are failing with identical behavior:</p>\n\n<pre><code>grep -Rl $'\\A\\xff\\xd8' .\ngrep -Rl \\A$'\\xff\\xd8' .\ngrep -RlP \"\\A\\xff\\xd8\" .\n</code></pre>\n\n<p>A test file starting with ff d8 is not found, while 3 other files are found that have the byte sequence elsewhere in the file. My test file first few bytes are confirmed with hexdump -C.</p>\n\n<pre><code>00000000  ff d8 ff e0 00 10 4a 46  49 46 00 01 01 00 00 01  |......JFIF......|\n</code></pre>\n\n<p>I found multiple \"almost\" answers.  I've explored hexdump, but prefer the speed of directly grepping rather than a lot of piping and looping through recursive filenames, with wrap around text exceptions. A prior question 2-1/2 years ago \"File carving with Bash can't find hex values FFD8 or FFD9 with grep\" is very close but LC_ALL=C doesn't change behavior. Playing with -a and -b doesn't change behavior. </p>\n\n<p>What is the right way to do this? I'm using GNU grep 3.1.</p>\n\n<p>///\nFurther study makes me think grep maybe has as problem.  The code below shows\nthat the 2-byte sequence is not found when it's not at the beginning.\nThen 2-byte sequence IS found when it IS at the beginnning.\nAlso on a real jpg file, the match is found when it is at the beginning\nSo far, so good.</p>\n\n<pre><code>dell@DELL-E6440:~$ echo $'\\xffThis is a short test file I\\xff\\xd8 made' &gt; junk.txt\ndell@DELL-E6440:~$ hexdump -C junk.txt | head -n1\n00000000  ff 54 68 69 73 20 69 73  20 61 20 73 68 6f 72 74  |.This is a short|\ndell@DELL-E6440:~$ LC_ALL=C grep -lP \"\\A\\xff\\xd8\" junk.txt\ndell@DELL-E6440:~$ echo $'\\xff\\xd8This is a short test file I\\xff\\xd8 made' &gt; junk.txt\ndell@DELL-E6440:~$ hexdump -C junk.txt | head -n1\n00000000  ff d8 54 68 69 73 20 69  73 20 61 20 73 68 6f 72  |..This is a shor|\ndell@DELL-E6440:~$ LC_ALL=C grep -lP \"\\A\\xff\\xd8\" junk.txt\njunk.txt\ndell@DELL-E6440:~$ hexdump -C avoid-powered.jpg | head -n1\n00000000  ff d8 ff e0 00 10 4a 46  49 46 00 01 01 00 00 01  |......JFIF......|\ndell@DELL-E6440:~$ LC_ALL=C grep -lP \"\\A\\xff\\xd8\" avoid-powered.jpg\navoid-powered.jpg\ndell@DELL-E6440:~$ \n</code></pre>\n\n<p>So, why is it matched in a larger file when it's NOT at the beginng? \nFirst show that a file without the necessary 2-byte sequence is matched.\nThen, keep only the beginning of the real file, and the 2-byte sequence is properly not found.</p>\n\n<pre><code>dell@DELL-E6440:~$ cp 130913-SEMSA.pdf junk.txt\ndell@DELL-E6440:~$ hexdump -C junk.txt | head -n1\n00000000  25 50 44 46 2d 31 2e 34  0a 31 20 30 20 6f 62 6a  |%PDF-1.4.1 0 obj|\ndell@DELL-E6440:~$ LC_ALL=C grep -lP \"\\A\\xff\\xd8\" junk.txt\njunk.txt\ndell@DELL-E6440:~$ dd if=130913-SEMSA.pdf bs=10 count=1 of=junk.txt\n1+0 records in\n1+0 records out\n10 bytes copied, 0.0062894 s, 1.6 kB/s\ndell@DELL-E6440:~$ hexdump -C junk.txt | head -n1\n00000000  25 50 44 46 2d 31 2e 34  0a 31                    |%PDF-1.4.1|\ndell@DELL-E6440:~$ LC_ALL=C grep -lP \"\\A\\xff\\xd8\" junk.txt\ndell@DELL-E6440:~$\n</code></pre>\n\n<p>What can possibly be in the full size file that makes a false match?  grep should be looking only at the first 2-bytes of the file with \\A option.</p>\n\n<p>Responding to dash-o's answer...</p>\n\n<p>I considered the grep v3.3 manual <a href=\"https://www.gnu.org/software/grep/manual/grep.html\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/grep/manual/grep.html</a> which says,</p>\n\n<pre><code>-P Interpret patterns as Perl-compatible regular expressions (PCREs)\n</code></pre>\n\n<p>and a perl regex guide <a href=\"https://www.tutorialspoint.com/perl/perl_regular_expressions.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/perl/perl_regular_expressions.htm</a> says,</p>\n\n<pre><code>\\A Matches beginning of string.\n</code></pre>\n\n<p>Also, the \\A idea works as it's supposed to for printable byte sequences and no documentation makes an exception for certain byte values or suggests \"line oriented\" should negate the idea.  Looking at the file utility, it's pretty cool to ID file types, but I see no easy way to recurse directories and get a path/filename printed out, one per line if and only if it has an arbitrary leading byte sequence. Lastly, I'm sort of a bash guy .. yea.. I need to go learn perl and python more ..but I'd sure like the universal bash/grep combo to work as documented.</p>\n"}, {"tags": ["perl"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12202768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd53800ae63b1ec922d629cd88789e4?s=128&d=identicon&r=PG&f=1", "display_name": "Lance", "link": "https://stackoverflow.com/users/12202768/lance"}, "edited": false, "score": 0, "creation_date": 1572962011, "post_id": 58712564, "comment_id": 103718884, "body": "Thanks! My work around before your answer was to return the last 2 elements of the array using splice from my initial solution. I need to read up more on regex because i didn&#39;t think that would return the needed value. So basically it matches the digits using the regex specified only and only returns the numbers? Intuitively, this is hard to understand why without reading up on perl regex specifically."}, {"owner": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "reply_to_user": {"reputation": 11, "user_id": 12202768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd53800ae63b1ec922d629cd88789e4?s=128&d=identicon&r=PG&f=1", "display_name": "Lance", "link": "https://stackoverflow.com/users/12202768/lance"}, "edited": false, "score": 0, "creation_date": 1572987736, "post_id": 58712564, "comment_id": 103731694, "body": "The regex matches all the bits detailled in it, including the &lt;, : and &gt;. The bits within parentheses () are captures and in list context, are returned as a list."}], "tags": [], "owner": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "is_accepted": false, "score": 1, "last_activity_date": 1572961211, "creation_date": 1572961211, "answer_id": 58712564, "question_id": 58711784, "link": "https://stackoverflow.com/questions/58711784/how-to-extract-numbers-enclosed-in-angle-brackets-in-a-string-that-might-have-nu/58712564#58712564", "title": "How to extract numbers enclosed in angle brackets in a string that might have numbers", "body": "<p>Assuming there's only one range:</p>\n\n<pre><code>my $sig = 'wrp1&lt;0:4&gt;';\n@range_nums = $sig =~/&lt;(\\d+):(\\d+)&gt;/;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12202768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd53800ae63b1ec922d629cd88789e4?s=128&d=identicon&r=PG&f=1", "display_name": "Lance", "link": "https://stackoverflow.com/users/12202768/lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572961211, "creation_date": 1572958379, "question_id": 58711784, "link": "https://stackoverflow.com/questions/58711784/how-to-extract-numbers-enclosed-in-angle-brackets-in-a-string-that-might-have-nu", "title": "How to extract numbers enclosed in angle brackets in a string that might have numbers", "body": "<p>I want to extract the numbers within angle brackets only in a string that can contain numbers as well.</p>\n\n<p>I have a string $sig = wrp1&lt;0:4> and i want to only extract the numbers enclosed in the angle brackets. \nI tried @range_nums=$sig=~/(\\d+)/g; unfortunately this gives me 1 0 4...which means it also extracted the 1 in front of the wrp1 which is not what i want because it deletes all the non-digit characters...i wanted it to treat \"wrp1\" as a word.</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>my $sig = wrp1&lt;0:4&gt;;\n@range_nums = $sig =~/(\\d+)/g; ## extracts 1 0 4 but i want only 0 and 4. Please NOTE $sig can be also wrp&lt;0:4&gt; for example. key is to just extract the numbers in the angle bracket.\n</code></pre>\n\n<p>0 4 is expected</p>\n"}, {"tags": ["perl", "ssh"], "comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 2, "creation_date": 1572958358, "post_id": 58711695, "comment_id": 103716972, "body": "As already mentioned in the <a href=\"https://stackoverflow.com/questions/58710497/executing-command-in-remote-server-gives-cant-call-method-send-on-an-undefine?noredirect=1#comment103716829_58710497\">earlier duplicate</a> you end up with an undefined value in <code>$ssh</code>. Probably the previous line of output contains an error message from your subroutine."}, {"owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1572959026, "post_id": 58711695, "comment_id": 103717336, "body": "What could be the reason for that. Because if I run this script for 5 times, 2 times it is getting failed."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572959452, "post_id": 58711695, "comment_id": 103717555, "body": "@vinodk89 I think maybe <code>my $ssh = Net::SSH::Expect-&gt;new (...)</code> returns <code>undef</code>.. but you are not checking for that, so the <code>sub</code> returns <code>$ssh</code> (which is <code>undef</code>)"}, {"owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572959750, "post_id": 58711695, "comment_id": 103717694, "body": "@H&#229;konH&#230;gland, I agree. So how can I improve my script in this case."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1572960518, "post_id": 58711695, "comment_id": 103718089, "body": "@vinodk89 Hmm, from the <a href=\"https://metacpan.org/release/Net-SSH-Expect/source/lib/Net/SSH/Expect.pm#L25\" rel=\"nofollow noreferrer\">source</a> it seems <code>new()</code> will not return <code>undef</code>, however it croaks on illegal arguments.."}], "owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572958519, "creation_date": 1572958020, "last_edit_date": 1572958519, "question_id": 58711695, "link": "https://stackoverflow.com/questions/58711695/cant-call-method-send-on-an-undefined-value-at-netsshexpect-perl-error", "title": "Can&#39;t call method \u201csend\u201d on an undefined value at - Net::SSH::Expect Perl error", "body": "<p>I am running some commands in a remote server by connecting from my local server. To achieve this I am connecting to remote server using <code>Net::SSH::Expect</code> perl module. Connection is establishing here, but sometimes when I execute the command the following error comes up - </p>\n\n<pre><code>Can't call method \"send\" on an undefined value at .....\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>my ($ip, $user, $passwd) = (\"my.ip.address.here\",\"user\", \"password\");\nmy $ssh = SSH_Connection( $ip, $user, $passwd );\n\nmy $command_to_execute = \"&lt;Command to be executed will build here&gt;\";\nprint \"$command_to_execute\\n\";\n$str = 'Bye';\n$ssh-&gt;send(\"$command_to_execute; echo $str\");\n$output = $ssh-&gt;waitfor($str, undef);\n$ssh-&gt;close();\nprint \"END\\n\";\n\nsub SSH_Connection {\n    my ( $host, $user, $passwd ) = @_;\n\n    my $ssh = Net::SSH::Expect-&gt;new (\n        host =&gt; $host, #ip\n        user =&gt; $user, #'user'\n        password =&gt; $passwd, #'password'\n        raw_pty =&gt; 1,\n        no_terminal =&gt; 0,\n    );\n\n    my $login_output;\n    my $handledie = eval {\n        $login_output = $ssh-&gt;login();\n    };\n\n    if ( $@ ) {\n        if ($@ =~ m/SSHConnectionError/i ) {\n            print  \"SSH Connection Error\\n\";\n        } elsif ( $@ =~ m/SSHProcessError/ix ) {\n            print \"SSH Process Error\\n\";\n        } elsif ( $@ =~ m/SSHConnectionAborted/ix ) {\n            print \"SSH Connection Aborted\\n\";\n        } else {\n            print \"SSH Unknown Error: $@\\n\";\n        }\n    }\n    if ($login_output !~ /Last login/) {\n        die \"Login has failed.\";\n    } else {\n        return $ssh;\n    }\n    print \"SSH to ip - $host failed\\n\";\n}\n\n</code></pre>\n\n<p>First I'm building the command and storing it in <code>$command_to_execute</code> variable.</p>\n\n<p>At the end of command execution I'll get keyword <code>Bye</code>. So I am waiting for that keyword to match.</p>\n\n<p>My question is - </p>\n\n<ol>\n<li>Why I am getting above mentioned error?</li>\n<li>Suppose if my command execution is failed, will the control will come back to my script ? Because its waiting for <code>$str</code> word.</li>\n</ol>\n\n<p>I doubt about the error catching method is not proper. Please suggest a better solution.</p>\n"}, {"tags": ["perl", "environment-variables"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1572932076, "post_id": 58705017, "comment_id": 103704939, "body": "you mean <code>$ENV{ $ENV{a} }</code> ...?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 8011998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb04b457cf5c72d85b67699326f28b7?s=128&d=identicon&r=PG&f=1", "display_name": "michael_J", "link": "https://stackoverflow.com/users/8011998/michael-j"}, "edited": false, "score": 0, "creation_date": 1572938791, "post_id": 58705112, "comment_id": 103707174, "body": "thank you. Another question is if &quot;a=T&quot; is exported on the current shell, and in my Perl script : $test=a; print &quot;$ENV{$ENV{test}}&quot;; and then i run this script but it prints nothing. Can you help it again?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 113, "user_id": 8011998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb04b457cf5c72d85b67699326f28b7?s=128&d=identicon&r=PG&f=1", "display_name": "michael_J", "link": "https://stackoverflow.com/users/8011998/michael-j"}, "edited": false, "score": 0, "creation_date": 1572939444, "post_id": 58705112, "comment_id": 103707411, "body": "@michael_J Ah ... no, can&#39;t do that -- that shell&#39;s <i>environment</i> variable <code>a</code> is provided in the <code>%ENV</code> hash, as a key.  But to use it as a &quot;normal&quot; variable in the Perl script you have to somehow pass it to the script; can&#39;t use either <code>a</code> or <code>$a</code>. One way to pass variables from the shell to a Perl script is in fact precisely by using the environment (you export the variable in the shell and then Perl script can use it via <code>%ENV</code>).  Or, you can pass it as an argument for the script (in two ways)"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 113, "user_id": 8011998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb04b457cf5c72d85b67699326f28b7?s=128&d=identicon&r=PG&f=1", "display_name": "michael_J", "link": "https://stackoverflow.com/users/8011998/michael-j"}, "edited": false, "score": 0, "creation_date": 1572941600, "post_id": 58705112, "comment_id": 103708313, "body": "@michael_J  For how to pass Bash variables to a Perl one-liner, see for example <a href=\"https://stackoverflow.com/a/51713578/4653379\">this post</a> and <a href=\"https://stackoverflow.com/a/56200990/4653379\">this post</a> (perhaps <a href=\"https://stackoverflow.com/a/54059744/4653379\">this</a> can also be useful).  If you call a full Perl script (not one-liner) then I&#39;d do away with all that and just nicely use command-line arguents via <a href=\"https://perldoc.perl.org/Getopt/Long.html\" rel=\"nofollow noreferrer\">Getopt::Long</a>"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 113, "user_id": 8011998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb04b457cf5c72d85b67699326f28b7?s=128&d=identicon&r=PG&f=1", "display_name": "michael_J", "link": "https://stackoverflow.com/users/8011998/michael-j"}, "edited": false, "score": 0, "creation_date": 1572942688, "post_id": 58705112, "comment_id": 103708814, "body": "@michael_J Added comments on this to my answer."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 113, "user_id": 8011998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb04b457cf5c72d85b67699326f28b7?s=128&d=identicon&r=PG&f=1", "display_name": "michael_J", "link": "https://stackoverflow.com/users/8011998/michael-j"}, "edited": false, "score": 0, "creation_date": 1572944890, "post_id": 58705112, "comment_id": 103709923, "body": "@michael_J Updated/edited the addition with with discussion on passing the <i>name</i> of the variable"}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": true, "score": 12, "last_activity_date": 1573109448, "last_edit_date": 1573109448, "creation_date": 1572932455, "answer_id": 58705112, "question_id": 58705017, "link": "https://stackoverflow.com/questions/58705017/envvariable-in-perl/58705112#58705112", "title": "$ENV{$variable} in perl", "body": "<p>Those environment variables should be chained you say, so </p>\n\n<pre><code>$ENV{ $ENV{a} };\n</code></pre>\n\n<p>Note: not <code>$a</code> but <code>a</code>, like <code>$ENV{USER}</code> etc. This uses the hash <code>%ENV</code> (see <a href=\"https://perldoc.perl.org/perlvar.html\" rel=\"nofollow noreferrer\">perlvar</a>), which has the current environment, so with keys being names of environment variables.</p>\n\n<hr>\n\n<p>It is apparently of interest to use a Perl variable (for the shell variable's name<sup>&dagger;</sup>) in <code>%ENV</code>, and not a string literal as above. In that case we need to pass that shell variable, its name or the value, to the Perl program somehow so to have it stored in a variable; can't just use it directly.</p>\n\n<p>Incidentally, one of the ways to pass a variable from shell to Perl is precisely by exporting it, what then makes it available via <code>%ENV</code>.  However, it can also be passed as usual, via command line. Assuming the use of a Perl one-liner (common in shell scripts), we have two options for how to pass</p>\n\n<ul>\n<li><p>As an argument, <code>perl -we'...'  \"$var\"</code>, in which case it is available in <code>@ARGV</code></p></li>\n<li><p>Via the <a href=\"https://perldoc.perl.org/perlrun.html#Command-Switches\" rel=\"nofollow noreferrer\"><code>-s</code> command switch</a>, <code>perl -s -we'...' -- -shv=\"$var\"</code>, what sets up <code>$shv</code> variable in the one-liner, with the value <code>$var</code>.  The <code>--</code> mark the start of arguments.</p></li>\n</ul>\n\n<p>See <a href=\"https://stackoverflow.com/a/51713578/4653379\">this post</a> for details, and perhaps <a href=\"https://stackoverflow.com/a/54059744/4653379\">this one</a> for another, more involved, example.</p>\n\n<p><strong>Note</strong> &nbsp;A comment asks how to pass variable's <em>name</em> (string <code>a</code>), not its value (<code>$a</code>). This doesn't seem as the best design to me; if the name of a variable for some reason need be passed around then it makes sense to store <em>that</em> in a variable (<code>var=\"a\"</code>) and pass that variable, as above.  </p>\n\n<p>But if the idea is indeed to pass the name itself around, then do that instead, so either of</p>\n\n<pre><code>perl -we'...' \"a\"\nperl -we'...' -s -- -shv=\"a\"\n</code></pre>\n\n<p>The rest is the same and <code>%ENV</code> uses the variable that got assigned the input.</p>\n\n<p>If a full Perl script is used (not a one-liner) then use <a href=\"https://perldoc.perl.org/Getopt/Long.html\" rel=\"nofollow noreferrer\">Getopt::Long</a> to nicely handle arugments.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup>&thinsp;A comment asks about passing the shell variable's <em>name</em> to a Perl variable &mdash; so <code>a</code> from the OP, not its value <code>$a</code>. I am a little uncertain of the utility of that but it is of course possible.  </p>\n\n<p>The two ways for how to pass a variable from shell to Perl then differ in what is passed.</p>\n"}], "owner": {"reputation": 113, "user_id": 8011998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb04b457cf5c72d85b67699326f28b7?s=128&d=identicon&r=PG&f=1", "display_name": "michael_J", "link": "https://stackoverflow.com/users/8011998/michael-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "accepted_answer_id": 58705112, "answer_count": 1, "score": 3, "last_activity_date": 1573109448, "creation_date": 1572931762, "question_id": 58705017, "link": "https://stackoverflow.com/questions/58705017/envvariable-in-perl", "title": "$ENV{$variable} in perl", "body": "<p>Is that anyway in Perl to expand the variable by in $ENV{$variable}?</p>\n\n<p>I exported \"a=T\" and \"T=b\" in shell, and I run the Perl script in which print \"$ENV{$a}\\n\", but nothing printed. I want to \"b\" can be printed, then how should I do in Perl? </p>\n"}, {"tags": ["perl", "wrapper"], "comments": [{"owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572930976, "post_id": 58701098, "comment_id": 103704657, "body": "system() spawns a new process and any variables in the calling code are therefore inaccessible.  To do what you want, you would have to put the variables into the environment before spawning.  $ENV{variable} = &quot;a&quot;; etc.  But the right way to do this kind of thing is with a module as choroba described."}], "answers": [{"tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 6, "last_activity_date": 1572902236, "creation_date": 1572902236, "answer_id": 58701191, "question_id": 58701098, "link": "https://stackoverflow.com/questions/58701098/in-perl-how-do-i-extract-out-the-declaration-of-variables-into-a-wrapper-script/58701191#58701191", "title": "In Perl, how do I extract out the declaration of variables into a wrapper script?", "body": "<p>Extract the common code into a module, not a script. Save it as e.g. <code>MyCommon.pm</code>.\nExport a function from the module that does what you need:</p>\n\n<pre><code>package MyCommon;\nuse Exporter qw{ import };\nour @EXPORT = qw{ common_code };\n\nsub common_code {\n    my ($var1, $var2) = @_;\n    # Common code goes here...\n}\n</code></pre>\n\n<p>Then, in various scripts, write</p>\n\n<pre><code>use MyCommon qw{ common_code };\n\ncommon_code('a', 'b');  # &lt;- insert the specific values here.\n</code></pre>\n\n<p>There are more advanced ways, e.g. you can use \"object orientation\": construct an object from the specific values, then run a method that implements the common code - but for simple use cases, you probably don't need it.</p>\n"}, {"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573004025, "post_id": 58704579, "comment_id": 103736281, "body": "Only use <code>require</code>/<code>use</code> for files with a <code>package</code>. Use <code>do</code> for files without. But you really shouldn&#39;t have such files. This is a model that was supplanted by modules over 20 years ago!"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573064383, "post_id": 58704579, "comment_id": 103762730, "body": "@ ikegami - Documentation for <b>do</b> states <i>It also differs in that code evaluated with &#39;do FILE&#39; cannot see lexicals in the enclosing scope; &#39;eval STRING&#39; does.</i>. You should provide a sample code to prove your point. A test run of a script demonstrated that a variable from <i>external</i> script is not accessible on <i>inner</i> script."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573069090, "post_id": 58704579, "comment_id": 103764749, "body": "The documentation is 100% correct. Files included via <code>do</code>, <code>require</code> or <code>use</code> can&#39;t access lexicals in the scope in which the <code>do</code>/<code>require</code>/<code>use</code> is located. <a href=\"https://pastebin.com/KzqinAzK\" rel=\"nofollow noreferrer\">Demonstration</a> I&#39;m not sure what that has to do with anything."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573069097, "post_id": 58704579, "comment_id": 103764751, "body": "As for why <code>do</code> is more appropriate, see how it uses <code>%INC</code> compared to <code>require</code>."}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573072972, "post_id": 58704579, "comment_id": 103766388, "body": "I assume that the author of the question will use variables from <i>outer</i> script in <i>inner</i> common code. In case of <b>do</b> they are not accessible."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573073839, "post_id": 58704579, "comment_id": 103766739, "body": "If that&#39;s what you believe, then your solution doesn&#39;t work. Like I said and proved above, they&#39;re not accessible when using <code>require</code> either. In both cases, they would need to be passed as arguments. Only <code>eval</code> allows you to access the surrounding scope (and even then, there are limits)."}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573076032, "post_id": 58704579, "comment_id": 103767530, "body": "@ikegami - here I must agree with you. In my original test I have passed arguments and used them in code - it works fine. But then when you referred to <b>do</b> as I never used this approach I went right to read documentation. The quote I referred to earlier been caught by my eye -- and I mentioned it. A few seconds ago I run a quick test and indeed <b>require</b> hides global scope variables - it can be looked as an advantage and from other point a disadvantage. But to pass variables is more correct approach (only module might have global variable - Yahoo had such variable to extract stock quotes)"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573076124, "post_id": 58704579, "comment_id": 103767565, "body": "It hides <i>lexical</i> vars. Global vars, by definition, are visible everywhere"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573076317, "post_id": 58704579, "comment_id": 103767628, "body": "Ok, you caught me here -- I never looked before definition of lexical variable (any variable declared with <b>my</b>). Then could you demonstrate what would be <b>global</b> variable in perl?"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1573076474, "post_id": 58704579, "comment_id": 103767680, "body": "Ok, I found that only <b>Package</b> variables can have global scope -- hmm, different from C,C++. [<a href=\"https://stackoverflow.com/questions/19100106/local-and-global-variables-in-perl]\" title=\"local and global variables in perl%5d\">stackoverflow.com/questions/19100106/&hellip;</a>"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1573078337, "post_id": 58704579, "comment_id": 103768346, "body": "&quot;<i>different from C,C++</i>&quot; ... yeah ... go figure.  I can&#39;t help it but add: this post is a terrible advice in this day. It&#39;s all told in the very first comment, &quot;<i>This is a model that was supplanted by modules over 20 years ago</i>&quot;.  One can&#39;t really hash out all the whys in comments but using modules is just (far) better.  (In fact, simply having &quot;common code&quot; be a full program that&#39;s called with suitable arguments would also be better in this case.)"}], "tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 1, "last_activity_date": 1572928599, "creation_date": 1572928599, "answer_id": 58704579, "question_id": 58701098, "link": "https://stackoverflow.com/questions/58701098/in-perl-how-do-i-extract-out-the-declaration-of-variables-into-a-wrapper-script/58704579#58704579", "title": "In Perl, how do I extract out the declaration of variables into a wrapper script?", "body": "<p>Desired behavior for simple case as yours can be achieved with with <a href=\"https://perldoc.perl.org/functions/require.html\" rel=\"nofollow noreferrer\">required</a> function of perl</p>\n\n<p>Put common code in a file, for example <strong>common.inc</strong> end the file with <code>1;</code> (requirement for modules and include files)</p>\n\n<pre><code>sub commonFunction {\n    my $data = shift;\n\n    print \"DATA: $data\\n\";\n}\n\n1;\n</code></pre>\n\n<p>Copy/move <strong>common.inc</strong> file into one of <strong>@INC</strong> directory (probably <strong>site</strong> directory best fit for this purpose).</p>\n\n<p>Check your perl <strong>@INC</strong> configuration setting with following command</p>\n\n<pre><code>perl -e \"print qw(@INC)\"\n</code></pre>\n\n<p>Now you can <em>reuse</em> <strong>common.inc</strong> file in your <em>user interface</em> script</p>\n\n<pre><code>#!/usr/bin/perl\n\nrequire 'common.inc';\n\nmy $a = 7;\n\ncommonFunction($a);\n</code></pre>\n\n<p>Already was suggested to place the common code which will be reused multiple times  in form of <strong>.pm</strong> module. </p>\n\n<p>By doing so you gain more control what functions/variables are visible (exported) to avoid <em>namespace</em> clash/collision [the modules can have functions/variables with same name].</p>\n\n<p>Short <a href=\"https://www.perltutorial.org/perl-module/\" rel=\"nofollow noreferrer\">tutorial</a> how to create a module is available. Next natural step will be <a href=\"https://www.perltutorial.org/perl-oop/\" rel=\"nofollow noreferrer\">OOP programming</a>.</p>\n\n<p>Book: <a href=\"https://www.manning.com/books/object-oriented-perl\" rel=\"nofollow noreferrer\">Object Oriented Perl</a></p>\n\n<p><a href=\"https://perldoc.perl.org/perlootut.html\" rel=\"nofollow noreferrer\">perlootut</a>, <a href=\"https://www.tutorialspoint.com/perl/perl_modules.htm\" rel=\"nofollow noreferrer\">Writing perl modules</a>, Chapter <a href=\"https://blob.perl.org/books/beginning-perl/3145_Chap11.pdf\" rel=\"nofollow noreferrer\">Object Oriented Perl</a></p>\n"}], "owner": {"reputation": 1140, "user_id": 8981474, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5S2rF.png?s=128&g=1", "display_name": "isakbob", "link": "https://stackoverflow.com/users/8981474/isakbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 58701191, "answer_count": 2, "score": 2, "last_activity_date": 1572928599, "creation_date": 1572901783, "question_id": 58701098, "link": "https://stackoverflow.com/questions/58701098/in-perl-how-do-i-extract-out-the-declaration-of-variables-into-a-wrapper-script", "title": "In Perl, how do I extract out the declaration of variables into a wrapper script?", "body": "<h1>Background</h1>\n\n<p>I have a perl script, called main.pl that is currently in several branched states on clear case like so:</p>\n\n<p>Branch 1:</p>\n\n<pre><code>my %hash\nmy $variable = \"a\"\nmy $variable2 = \"c\"\n\nsub codeIsOtherwiseTheSame()\n....\n</code></pre>\n\n<p>Branch 2:</p>\n\n<pre><code>my %hash2\nmy $variable = \"b\"\n\nsub codeIsOtherwiseTheSame()\n....\n</code></pre>\n\n<p>Branch 3</p>\n\n<pre><code>my %hash\nmy $variable2 = \"d\"\n\nsub codeIsOtherwiseTheSame()\n....\n</code></pre>\n\n<p>Right now, each branch of the script has the same code.  The only differences are the kind of variables that are declared and what their initialized value is. What I want to do is extract these differing variables out to a wrapper script (for each variation) so that the main script does not have to be changed. I am doing this because several users will be using this script, but have only minor differences based on their use case. Thus I want each kind of user to have their own simplified interface.  At the same time, I want the main script to still be aware of these variable once it is called.  Below is an example of what I want:</p>\n\n<h1>Desired Solution</h1>\n\n<p>Wrapper Script 1:</p>\n\n<pre><code> my %hash;\n my $variable = \"a\";\n my $variable2 = \"c\";\n system(\"main.pl\");\n</code></pre>\n\n<p>Wrapper Script 2:</p>\n\n<pre><code> my %hash2;\n my $variable = \"b\";\n system(\"main.pl\");\n</code></pre>\n\n<p>Wrapper Script  3:</p>\n\n<pre><code>my %hash;\nmy $variable2 = \"d\";\nsystem(\"main.pl\");\n</code></pre>\n\n<p>Main.pl</p>\n\n<pre><code>sub codeIsOtherwiseTheSame()\n</code></pre>\n\n<h1>Question</h1>\n\n<p>How do I extract out a wrapper script to obtain the organization and behavior I want above?</p>\n"}, {"tags": ["oracle", "perl", "encoding", "character", "dbi"], "comments": [{"owner": {"reputation": 13167, "user_id": 546205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d7dd187ae1f4400664cbc0e66c8a2ce?s=128&d=identicon&r=PG", "display_name": "Miguel Prz", "link": "https://stackoverflow.com/users/546205/miguel-prz"}, "edited": false, "score": 2, "creation_date": 1572876826, "post_id": 58694885, "comment_id": 103686945, "body": "The problem is related to the print layer, you need to enable utf8. See this question: <a href=\"https://stackoverflow.com/questions/627661/how-can-i-output-utf-8-from-perl\" title=\"how can i output utf 8 from perl\">stackoverflow.com/questions/627661/&hellip;</a>"}, {"owner": {"reputation": 4133, "user_id": 836215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96343cdb1ae4d50aa89067f4427dccca?s=128&d=identicon&r=PG", "display_name": "ibre5041", "link": "https://stackoverflow.com/users/836215/ibre5041"}, "edited": false, "score": 0, "creation_date": 1572879170, "post_id": 58694885, "comment_id": 103688201, "body": "Can you also add output from <code>locale</code> on Linux? The <code>$ENV{NLS_LANG} = &quot;GERMAN_GERMANY.AL32UTF8&quot;; </code> instruct Oracle client library to store result in UTF-8 format (including umlauts) in you app&#39;s buffer. The rest up for Perl to deal with."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572925676, "post_id": 58695357, "comment_id": 103703636, "body": "Re &quot;<i>You are working with utf8 encoding</i>&quot;, Obviously not. <code>binmode(STDOUT, &quot;:utf8&quot;);</code> is used when you <i>aren&#39;t</i> working with UTF-8. It&#39;s used to convert decoded text (Unicode Code Points) to UTF-8."}], "tags": [], "owner": {"reputation": 13167, "user_id": 546205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d7dd187ae1f4400664cbc0e66c8a2ce?s=128&d=identicon&r=PG", "display_name": "Miguel Prz", "link": "https://stackoverflow.com/users/546205/miguel-prz"}, "is_accepted": true, "score": 4, "last_activity_date": 1572877284, "creation_date": 1572877284, "answer_id": 58695357, "question_id": 58694885, "link": "https://stackoverflow.com/questions/58694885/missing-wrong-characters-returnd-via-cpan-perl-dbioracle-missing-umlauts/58695357#58695357", "title": "Missing / Wrong characters returnd via CPAN Perl DBI:Oracle ( missing umlauts)", "body": "<p>You are working with utf8 encoding, so the simplest way to fix it may be this one:</p>\n\n<pre><code>binmode(STDOUT, \":utf8\");\n</code></pre>\n\n<p>Before the print sentence. More details in this question <a href=\"https://stackoverflow.com/questions/627661/how-can-i-output-utf-8-from-perl\">How can I output UTF-8 from Perl?</a></p>\n"}], "owner": {"reputation": 114, "user_id": 9032032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc363d457232bc557f3c6988c60918fc?s=128&d=identicon&r=PG&f=1", "display_name": "MarcelS", "link": "https://stackoverflow.com/users/9032032/marcels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 58695357, "answer_count": 1, "score": 2, "last_activity_date": 1572877284, "creation_date": 1572875695, "question_id": 58694885, "link": "https://stackoverflow.com/questions/58694885/missing-wrong-characters-returnd-via-cpan-perl-dbioracle-missing-umlauts", "title": "Missing / Wrong characters returnd via CPAN Perl DBI:Oracle ( missing umlauts)", "body": "<p>Enviroment:\nOracle DB 12.2,  NLS_LANG: AL32UTF8\nLinux Client with OracleClient 12.2 installed, also Perl CPAN DBI installed V: 1.636</p>\n\n<p>Windows 10 Client with Oracle Client 12.2</p>\n\n<p>Actually we test a new application which connects vie DBI:Oracle and noticed that the special chatracters ( for example: \u00e4,\u00f6,\u00fc ) are missing / returned incorrectly.</p>\n\n<p>So i have done some tests:\non linux client:</p>\n\n<pre><code>root@test:~# locale\nLANG=de_DE.UTF-8\nLANGUAGE=\nLC_CTYPE=\"de_DE.UTF-8\"\nLC_NUMERIC=\"de_DE.UTF-8\"\nLC_TIME=\"de_DE.UTF-8\"\nLC_COLLATE=\"de_DE.UTF-8\"\nLC_MONETARY=\"de_DE.UTF-8\"\nLC_MESSAGES=\"de_DE.UTF-8\"\nLC_PAPER=\"de_DE.UTF-8\"\nLC_NAME=\"de_DE.UTF-8\"\nLC_ADDRESS=\"de_DE.UTF-8\"\nLC_TELEPHONE=\"de_DE.UTF-8\"\nLC_MEASUREMENT=\"de_DE.UTF-8\"\nLC_IDENTIFICATION=\"de_DE.UTF-8\"\nLC_ALL=\nroot@test:~# export NLS_LANG=GERMAN_GERMANY.AL32UTF8\nroot@test:~# sqlplus connectstring\n\nSQL*Plus: Release 12.2.0.1.0 Production on Mo Nov 4 14:36:14 2019\n\nCopyright (c) 1982, 2016, Oracle.  All rights reserved.\n\nKennwort eingeben:\nLetzte erfolgreiche Anmeldezeit: Mo Nov 04 2019 14:35:53 +01:00\n\nVerbunden mit:\nOracle Database 12c Standard Edition Release 12.2.0.1.0 - 64bit Production\n\nSQL&gt; create table testchar (\n  2  ttext varchar2(10));\n\nTabelle wurde erstellt.\n\nSQL&gt; insert into testchar values ('\u00c4');\n\n1 Zeile wurde erstellt.\n\nSQL&gt; insert into testchar values ('\u00d6');\n\n1 Zeile wurde erstellt.\n\nSQL&gt; insert into testchar values ('\u00dc');\n\n1 Zeile wurde erstellt.\n\nSQL&gt; insert into testchar values ('\u00df');\n\n1 Zeile wurde erstellt.\n\nSQL&gt; insert into testchar values ('\u20ac');\n\n1 Zeile wurde erstellt.\n\nSQL&gt; commit;\n\nTransaktion mit COMMIT abgeschlossen.\n\nSQL&gt; select * from testchar;\n\nTTEXT\n----------\n\u00c4\n\u00d6\n\u00dc\n\u00df\n\u20ac\n\nSQL&gt;\n</code></pre>\n\n<p>on windows client:</p>\n\n<pre><code>C:\\Users\\t&gt;set NLS_LANG=GERMAN_GERMANY.AL32UTF8\n\nC:\\Users\\t&gt;chcp 65001\nAktive Codepage: 65001.\n\nC:\\Users\\t&gt;sqlplus connectstring\n\nSQL*Plus: Release 12.2.0.1.0 Production on Mo Nov 4 14:39:43 2019\n\nCopyright (c) 1982, 2017, Oracle.  All rights reserved.\n\nKennwort eingeben:\nLetzte erfolgreiche Anmeldezeit: Mo Nov 04 2019 14:37:11 +01:00\n\nVerbunden mit:\nOracle Database 12c Standard Edition Release 12.2.0.1.0 - 64bit Production\n\nSQL&gt; select * from testchar;\n\nTTEXT\n----------\n\u00c4\n\u00d6\n\u00dc\n\u00df\n\u20ac\n\nSQL&gt;\n</code></pre>\n\n<p>now on the same linux client i wrote a little perl script to demonstrate the issue:</p>\n\n<pre><code>root@test:~# cat testumlaut.pl\n#!/usr/bin/perl\n#use strict;\n#use warnings;\n\nuse DBI;\n$ENV{NLS_LANG} = \"GERMAN_GERMANY.AL32UTF8\";\nmy $dbh = DBI-&gt;connect( connectstring ) || die($DBI::errstr . \"\\n\");\nmy $sql = 'select * from testchar';\nmy $sth = $dbh-&gt;prepare($sql);\n$sth-&gt;execute();\nwhile (my @row = $sth-&gt;fetchrow_array) {\n        print \"Umlaut: $row[0]\\n\";\n}\n</code></pre>\n\n<p>The output looks like this</p>\n\n<pre><code>root@test :~# perl testumlaut.pl\nUmlaut: \u2592\nUmlaut: \u2592\nUmlaut: \u2592\nUmlaut: \u2592\nWide character in print at testumlaut.pl line 12.\nUmlaut: \u20ac\n</code></pre>\n\n<p>At this point it looks like an error with the Perl DBI Modules.\nAnyone an idea how to solve this?</p>\n\n<p>thanks for your help.</p>\n"}, {"tags": ["linux", "shell", "perl"], "comments": [{"owner": {"reputation": 3269, "user_id": 93745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8F5Wc.jpg?s=128&g=1", "display_name": "tinita", "link": "https://stackoverflow.com/users/93745/tinita"}, "edited": false, "score": 1, "creation_date": 1572874709, "post_id": 58694393, "comment_id": 103685862, "body": "Please read the <a href=\"https://metacpan.org/pod/DBI\" rel=\"nofollow noreferrer\">DBI documentation</a> for how to use <code>prepare</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13167, "user_id": 546205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d7dd187ae1f4400664cbc0e66c8a2ce?s=128&d=identicon&r=PG", "display_name": "Miguel Prz", "link": "https://stackoverflow.com/users/546205/miguel-prz"}, "is_accepted": true, "score": 2, "last_activity_date": 1572875807, "last_edit_date": 1572875807, "creation_date": 1572875148, "answer_id": 58694721, "question_id": 58694393, "link": "https://stackoverflow.com/questions/58694393/perl-print-sql-row/58694721#58694721", "title": "perl - print sql row", "body": "<p>Change this line:</p>\n\n<pre><code>my $sth = $prepare($query);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>my $sth = $dbh-&gt;prepare($query);\n</code></pre>\n\n<p>and don't forget to close the <code>$sth</code> and <code>$dbh</code> handles after the while loop with:</p>\n\n<pre><code>$sth-&gt;finish;\n$dbh-&gt;disconnect;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 45481, "user_id": 197758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628da6ba2a6c70e35c009b7e3c3a430a?s=128&d=identicon&r=PG", "display_name": "toolic", "link": "https://stackoverflow.com/users/197758/toolic"}, "edited": false, "score": 0, "creation_date": 1572984830, "post_id": 58699348, "comment_id": 103730515, "body": "Well, you have changed your question [portion of it is removed now]. In original question you had added &#39;extra&#39; question where in SQL statement you had <b>\u0435</b> field commented out -- what caused an error. It was a reason why I have pointed you to the cause of the error."}], "tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1572893093, "creation_date": 1572893093, "answer_id": 58699348, "question_id": 58694393, "link": "https://stackoverflow.com/questions/58694393/perl-print-sql-row/58699348#58699348", "title": "perl - print sql row", "body": "<p>In your last post there is only one reference to <strong>e</strong> in the following comment</p>\n\n<pre><code>#INNER JOIN events e ON (e.objectid = t.triggerid)\n</code></pre>\n\n<p>probably it is better to use syntax <code>INNER JOIN events as e ON (e.objectid = t.triggerid)</code> -- more readable</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1572986376, "creation_date": 1572986376, "answer_id": 58719140, "question_id": 58694393, "link": "https://stackoverflow.com/questions/58694393/perl-print-sql-row/58719140#58719140", "title": "perl - print sql row", "body": "<p>I do not have a database at hand available right at this moment. The following example should work in theory. I have replaced <strong>fetch_array</strong> on <strong>fetch_hashref</strong> the output will provide information about each row </p>\n\n<p><code>ddddd column=value\\tcolumn=value\\t...</code></p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy $query = qq(SELECT * FROM tb_test);\n\ndb_query($query);\n\nsub db_query {\n    my $query = shift;\n\n    my $count = 1;\n\n    my $dbh = DBI-&gt;connect(\n                    \"DBI:mysql:database=database;host=ip\",\n                    \"login\", 'password',\n                    {'RaiseError' =&gt; 1}\n              );\n\n    my $sth = $dbh-&gt;prepare($query);\n\n    $sth-&gt;execute();\n\n    while ( my $row = $sth-&gt;fetchrow_hashref() ) {\n\n            print \"%5d \", $count++; # rows count\n\n            while( my($k,$v) = each %$row ) { print \"%s=%s\\t\",$k,$v; }\n\n            print \"\\n\"; # we done with current row\n    }\n\n    $sth-&gt;finish;\n    $dbh-&gt;disconnect;\n}\n</code></pre>\n\n<p>You need look into <a href=\"https://metacpan.org/pod/DBI\" rel=\"nofollow noreferrer\">DBI</a> documentation to get full understanding how it works.</p>\n"}], "owner": {"reputation": 33, "user_id": 10612524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fxl6Ivr29yo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAbkx1bOAmgHQ48SDOLTH2hyhBSqg/mo/photo.jpg?sz=128", "display_name": "jack94", "link": "https://stackoverflow.com/users/10612524/jack94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 58694721, "answer_count": 3, "score": 0, "last_activity_date": 1572986376, "creation_date": 1572873981, "last_edit_date": 1572875748, "question_id": 58694393, "link": "https://stackoverflow.com/questions/58694393/perl-print-sql-row", "title": "perl - print sql row", "body": "<p>I want to print all sql result of my perl script, I've connected to the database and I want to show the result of my sql query :</p>\n\n<pre><code>MySQL(\"SELECT * FROM test\");\n\n# define subroutine to submit MySQL command\n sub MySQL\n {   \n     #Connect to the database.\n     my $dbh = DBI-&gt;connect(\"DBI:mysql:database=database;host=ip\",\n     \"login\", 'password',\n     {'RaiseError' =&gt; 1});\n\n     my $query = $_[0];  #assign argument to string\n\n     my $sth = $prepare($query);   #prepare query\n\n     $sth-&gt;execute();   #execute query\n\n     while (my @row = $sth-&gt;fetchrow_array)\n        {\n            print \"@row\\n\";\n        }\n}\n</code></pre>\n\n<p>I have this errors :</p>\n\n<pre><code>Global symbol \"$prepare\" requires explicit package name at test3.pl line 34.\nsyntax error at test3.pl line 34, near \"$prepare(\"\nGlobal symbol \"$sth\" requires explicit package name at test3.pl line 36.\nExecution of test3.pl aborted due to compilation errors.\n</code></pre>\n"}, {"tags": ["json", "perl"], "answers": [{"comments": [{"owner": {"reputation": 13167, "user_id": 546205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d7dd187ae1f4400664cbc0e66c8a2ce?s=128&d=identicon&r=PG", "display_name": "Miguel Prz", "link": "https://stackoverflow.com/users/546205/miguel-prz"}, "edited": false, "score": 0, "creation_date": 1572849082, "post_id": 58685863, "comment_id": 103674679, "body": "<code>$e</code> should be <code>$element</code>"}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 1, "last_activity_date": 1572863518, "last_edit_date": 1572863518, "creation_date": 1572827240, "answer_id": 58685863, "question_id": 58685696, "link": "https://stackoverflow.com/questions/58685696/perl-create-json-string-in-a-specific-format/58685863#58685863", "title": "Perl Create JSON string in a specific format", "body": "<p>You don't want to push directly, you want to push under a key taken from the <code>ci_name</code>, and you only want to copy the app id and name.</p>\n\n<pre><code>for my $element (@$hosts) {\n    push @{ $output-&gt;{ $element-&gt;{ci_name} } },\n        { map { $_ =&gt; $element-&gt;{$_} } qw( app_id app_name ) };\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 6667387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4567bca091a3ec2a3cdf68b76233bb?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi M", "link": "https://stackoverflow.com/users/6667387/ravi-m"}, "edited": false, "score": 0, "creation_date": 1573351111, "post_id": 58699110, "comment_id": 103853444, "body": "Before pushing the elements into %data, is there a way to check if the app_id already exists for the ci_name element in %data?"}], "tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1572891917, "creation_date": 1572891917, "answer_id": 58699110, "question_id": 58685696, "link": "https://stackoverflow.com/questions/58685696/perl-create-json-string-in-a-specific-format/58699110#58699110", "title": "Perl Create JSON string in a specific format", "body": "<p>Probably the code will look like following snippet</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\n\nuse JSON;\nuse Data::Dumper;\n\nmy $debug = 0;\n\nmy %data;\n\nwhile( &lt;DATA&gt; ) {\n    chomp;\n    next if /app_id/;\n\n    my ($app_id,$ci_name,$app_name) = split /,/;\n\n    push @{$data{hosts}{$ci_name}}, {app_id =&gt; $app_id, app_name =&gt; $app_name };\n}\n\nprint Dumper(\\%data) if $debug;\n\nmy $json = encode_json \\%data;\n\nprint $json;\n\n__DATA__\napp_id,ci_name,app_name\n1234,hosta7,Managed File Transfer\n1235,hosta7,Patrtol\n1236,hosta7,RELATIONAL DATA WAREHOUSE\n1237,hosta7,Managed File Transfer\n1238,hosta7,Initio Application\n1239,hosta7,Data Warehouse Operations Infrastructure\n2345,hostb,Tableou\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6667387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4567bca091a3ec2a3cdf68b76233bb?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi M", "link": "https://stackoverflow.com/users/6667387/ravi-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58685863, "answer_count": 2, "score": -1, "last_activity_date": 1572891917, "creation_date": 1572825359, "last_edit_date": 1572826191, "question_id": 58685696, "link": "https://stackoverflow.com/questions/58685696/perl-create-json-string-in-a-specific-format", "title": "Perl Create JSON string in a specific format", "body": "<p>I have a table with 3 fields that I query and put the values in a JSON. The table has hostname to application name and application id. I currently have a perl script that outputs the following json string.</p>\n\n<pre><code>[\n   {\n      \"app_id\" : \"1234\",\n      \"app_name\" : \"Managed File Transfer\",\n      \"ci_name\" : \"hosta7\"\n   },\n   {\n      \"app_name\" : \"Patrtol\",\n      \"app_id\" : \"1235\",\n      \"ci_name\" : \"hosta7\"\n   },\n   {\n      \"app_id\" : \"1236\",\n      \"app_name\" : \"RELATIONAL DATA WAREHOUSE\",\n      \"ci_name\" : \"hosta7\"\n   },\n   {\n      \"ci_name\" : \"hosta7\",\n      \"app_id\" : \"1237\",\n      \"app_name\" : \"Managed File Transfer\"\n   },\n   {\n      \"app_id\" : \"1238\",\n      \"app_name\" : \"Initio Application\",\n      \"ci_name\" : \"hosta7\"\n   },\n   {\n      \"app_id\" : \"1239\",\n      \"app_name\" : \"Data Warehouse Operations Infrastructure\",\n      \"ci_name\" : \"hosta7\"\n   },\n   {\n      \"app_id\" : \"2345\",\n      \"app_name\" : \"Tableou\",\n      \"ci_name\" : \"hostb\"\n   }\n]\n</code></pre>\n\n<p>I want the resulting json string like the following where if the ci_name already exists, I want the new item to be added to the current entry of the host in the JSON string. So essentially, I want this JSON string</p>\n\n<pre><code>{ \n  \"hosts\" : [{\n    \"hosta\" :[\n      {\n        \"app_id\": \"1234\",\n        \"app_name\": \"Managed File Transfer\"\n      },\n      {\n        \"app_id\": \"1235\",\n        \"app_name\": \"Patrol\"\n      },\n      {\n        \"app_id\": \"1236\",\n        \"app_name\": \"RELATIONAL DATA WAREHOUSE\"\n      },\n      {\n        \"app_id\": \"1237\",\n        \"app_name\": \"Managed File Transfer\"\n      },\n      {\n        \"app_id\": \"1238\",\n        \"app_name\": \"Initio Application\"\n      },\n      {\n        \"app_id\": \"1239\",\n        \"app_name\": \"Data Warehouse Operations Infrastructure\"\n      }\n      ],\n    \"hostb\" : [\n      {\n        \"app_id\": \"2345\",\n        \"app_name\": \"Tableou\"\n      }\n      ]\n    }]\n}\n</code></pre>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\nuse JSON;\n\nmy $hosts = [\n   {\n      'app_id' =&gt; '1234',\n      'app_name' =&gt; 'Managed File Transfer',\n      'ci_name' =&gt; 'hosta7'\n   },\n   {\n      'app_name' =&gt; 'Patrtol',\n      'app_id' =&gt; '1235',\n      'ci_name' =&gt; 'hosta7'\n   },\n   {\n      'app_id' =&gt; '1236',\n      'app_name' =&gt; 'RELATIONAL DATA WAREHOUSE',\n      'ci_name' =&gt; 'hosta7'\n   },\n   {\n      'ci_name' =&gt; 'hosta7',\n      'app_id' =&gt; '1237',\n      'app_name' =&gt; 'Managed File Transfer'\n   },\n   {\n      'app_id' =&gt; '1238',\n      'app_name' =&gt; 'Initio Application',\n      'ci_name' =&gt; 'hosta7'\n   },\n   {\n      'app_id' =&gt; '1239',\n      'app_name' =&gt; 'Data Warehouse Operations Infrastructure',\n      'ci_name' =&gt; 'hosta7'\n   },\n   {\n      'app_id' =&gt; '2345',\n      'app_name' =&gt; 'Tableou',\n      'ci_name' =&gt; 'hostb'\n   }\n];\nmy $output;\n\nforeach my $row (@$hosts) {\n        push @$output, $row;\n}\nmy $json = new JSON;\n$json-&gt;pretty(1);\nprint $json-&gt;encode($output);\n</code></pre>\n"}, {"tags": ["regex", "perl", "replace"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10245970, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8AUrCqEXdJQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaND5Q2Ksu-jQ_fziamHHhhcfvVZRA/mo/photo.jpg?sz=128", "display_name": "Bill Ross", "link": "https://stackoverflow.com/users/10245970/bill-ross"}, "edited": false, "score": 1, "creation_date": 1572792487, "post_id": 58681087, "comment_id": 103662211, "body": "Thanks, Worked! That&#39;s -&quot;zero&quot;777 and, not &quot;oh&quot;, do not place between -e and command..."}], "tags": [], "owner": {"reputation": 7444, "user_id": 967621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zOso6.jpg?s=128&g=1", "display_name": "Timur Shtatland", "link": "https://stackoverflow.com/users/967621/timur-shtatland"}, "is_accepted": true, "score": 0, "last_activity_date": 1572791112, "creation_date": 1572791112, "answer_id": 58681087, "question_id": 58680472, "link": "https://stackoverflow.com/questions/58680472/perl-one-liner-add-html-tags-around-matched-html-element/58681087#58681087", "title": "perl one liner -add html tags around matched html element", "body": "<p>Add this to your Perl command line flags to read the entire file instead of line by line: <code>-0777</code></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10245970, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8AUrCqEXdJQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaND5Q2Ksu-jQ_fziamHHhhcfvVZRA/mo/photo.jpg?sz=128", "display_name": "Bill Ross", "link": "https://stackoverflow.com/users/10245970/bill-ross"}, "edited": false, "score": 0, "creation_date": 1572803536, "post_id": 58682846, "comment_id": 103665427, "body": "no backup: cuz original file from windoze PC, script on linux/server, already backed up filename: nada, cuz part of bash script, $1 is filename, batch processing"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 11, "user_id": 10245970, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8AUrCqEXdJQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaND5Q2Ksu-jQ_fziamHHhhcfvVZRA/mo/photo.jpg?sz=128", "display_name": "Bill Ross", "link": "https://stackoverflow.com/users/10245970/bill-ross"}, "edited": false, "score": 0, "creation_date": 1572804040, "post_id": 58682846, "comment_id": 103665549, "body": "Well original post did not specify that this one liner was a part of batch file (I suspected that probably it is). Well then &#39;orig_*&#39; is unnecessary, retyping also is unnecessary and at least for me my version is easier to understand <i>wrap</i> stored value into <code>&lt;pre&gt;&lt;code&gt;</code>  <b>stored value</b> <code>&lt;&#47;pre&gt;&lt;&#47;code&gt;</code>."}], "tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": -1, "last_activity_date": 1572802620, "creation_date": 1572802620, "answer_id": 58682846, "question_id": 58680472, "link": "https://stackoverflow.com/questions/58680472/perl-one-liner-add-html-tags-around-matched-html-element/58682846#58682846", "title": "perl one liner -add html tags around matched html element", "body": "<p>Why not to make the code a little bit more readable? And may be it is not bad idea to have <strong>backup</strong> of original file</p>\n\n<pre><code>perl -pi 'orig_*' -0777  -e 's|(&lt;table class=Code1 .*?&lt;/table&gt;)|&lt;pre&gt;&lt;code&gt;$1&lt;/pre&gt;&lt;/code&gt;|sg' filename\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10245970, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8AUrCqEXdJQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaND5Q2Ksu-jQ_fziamHHhhcfvVZRA/mo/photo.jpg?sz=128", "display_name": "Bill Ross", "link": "https://stackoverflow.com/users/10245970/bill-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 58681087, "answer_count": 2, "score": 0, "last_activity_date": 1572847854, "creation_date": 1572786694, "last_edit_date": 1572847854, "question_id": 58680472, "link": "https://stackoverflow.com/questions/58680472/perl-one-liner-add-html-tags-around-matched-html-element", "title": "perl one liner -add html tags around matched html element", "body": "<p>I am using MS word to generate (Web page, filtered) html and have a code style which I want to wrap with <code>&lt;pre&gt;&lt;code&gt;content&lt;/pre&gt;&lt;/code&gt;</code> to have preformatted text (including tabs and spaces) so visitors can copy and paste code from my site.</p>\n\n<p>I am aware of the cautions / dangers of using regex on html / xml, but, not an issue, since I control content.</p>\n\n<p>Input html looks like this:</p>\n\n<p><code>&lt;table class=Code1 PLAIN_MULTILINE_TEXT_AND_FORMATTING&lt;/table&gt;</code></p>\n\n<p>Output html should look like this:</p>\n\n<pre><code>&lt;pre&gt;&lt;code&gt;\n&lt;table class=Code1 PLAIN_MULTILINE_TEXT_AND_FORMATTING&lt;/table&gt;\n&lt;/pre&gt;&lt;/code&gt;\n</code></pre>\n\n<p>here is my one-liner, in bash script, $1 is filename:</p>\n\n<pre><code>perl -pi -e 's|&lt;table class=Code1 (.*?)&lt;/table&gt;|&lt;pre&gt;&lt;code&gt;&lt;table class=Code1 $1&lt;/table&gt;&lt;/pre&gt;&lt;/code&gt;|sg' $1\n</code></pre>\n\n<p>Which has no effect. Appears to not match.</p>\n\n<p>Questions:</p>\n\n<p>1 - What is wrong?</p>\n\n<p>2 - Do I need /s (multiline) modifier</p>\n\n<p>3 - Is there a better way (ultimately, will add this to a pre-cache / rendering script, along with existing auto table of contents and auto popup definitions creation)?</p>\n\n<p>site: www.rossco.org</p>\n\n<p>Thanks;\nBill</p>\n"}, {"tags": ["perl", "goto", "method-resolution-order", "perlguts"], "comments": [{"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572807018, "post_id": 58677042, "comment_id": 103666337, "body": "I&#39;m here because I have failed to isolate the problem. I&#39;m wanting to know how these three things interact so I can better understand this and isolate the problem. The problem here isn&#39;t driven by an effect I&#39;m trying to gain. I&#39;m trying to explain why three things behave differently."}], "answers": [{"comments": [{"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 0, "creation_date": 1572752155, "post_id": 58677174, "comment_id": 103655268, "body": "I&#39;m not sure that answers the question. Explain to me why this doesn&#39;t pass the Mojo test suite following the same logic, <code>foreach my $k ( keys %patch ) { *{&quot;${class}::$k&quot;} = set_subname(&quot;${class}::$k&quot;, sub {goto $patch{$k}) }</code>"}, {"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 1, "creation_date": 1572753023, "post_id": 58677174, "comment_id": 103655357, "body": "I&#39;ve updated the question with the actual error messages."}, {"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 0, "creation_date": 1572807170, "post_id": 58677174, "comment_id": 103666378, "body": "I also had a hard time isolating it. I can just say that it seems to occur by changing that one line (that I first linked too and that you copied into your answer) with the other methods in my answer. Why it&#39;s happening is the basis of the question. I can&#39;t isolate it. If you could explain how <code>mro::_nextcan()&#39;s</code> method treats the three examples differently I would be satisfied with the answer and mark it as chosen. That may be exactly what I don&#39;t understand."}], "tags": [], "owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "is_accepted": false, "score": 2, "last_activity_date": 1572759726, "last_edit_date": 1572759726, "creation_date": 1572751156, "answer_id": 58677174, "question_id": 58677042, "link": "https://stackoverflow.com/questions/58677042/how-does-mro-goto-and-set-subname-interact/58677174#58677174", "title": "How does mro, goto, and set_subname interact?", "body": "<p>That is indeed complicated, but maybe you overcomplicated it? </p>\n\n<p>Remember that MRO is only concerned with locating a method, which is just a symbol table entry to a coderef, through a defined order of package names. The internal subname only has to do with what caller() reports AFAIK. </p>\n\n<p>From: Mojo</p>\n\n<pre><code>*{\"${class}::$_\"} =          ## symbol table entry\nset_subname(\"${class}::$_\",  ## an internal name\n   $patch{$_})               ## for a code ref\nfor keys %patch;\n</code></pre>\n\n<p>HTH</p>\n\n<p>Edit After Seeing Error Messages:</p>\n\n<p>The subroutines have not been validly installed.  I suspect that since in option 2 and 3 you are deferring the calls to set_subname() to call time, the coderef $patch{$k} never has a subname assigned to it and that breaks a link in the chain of mro::_nextcan()'s XS magic.  Particularly if $patch{$k} calls next::method.  The closures seem to be valid though.</p>\n\n<p>Although I must say my testing seems to show that option 2 is valid.</p>\n\n<pre><code>Enter command: my ($class, $k) = qw/W S/; my %patch = (S =&gt;\nsub {print \"patch here\\n\"; decall;}); *{\"${class}::$k\"} = \nsub { print \"goto'r here\\n\";  my $cr = set_subname(\"${class}::$k\",\n$patch{$k}); goto $cr;};\n\n\nEnter command: decall\n0       \"console\"\n1       \"console.pl\"\n2       \"114\"\n3       \"(eval)\"\n4       \"0\"\n5       0\n6       \"package W; decall\"\n7       \"\"\n8       \"256\"\n9       \"\\020\\001\\000\\000\\000P\\004\\000\\000\\000\\000\\000\\000U\\025U\\005\"\n10      0\n\nEnter command: S\ngoto'r here\npatch here\n0       \"W\"\n1       \"(eval 110)\"\n2       \"1\"\n3       \"W::S\"\n4       \"1\"\n5       0\n6       0\n7       0\n8       \"256\"\n9       \"\\020\\001\\000\\000\\000P\\004\\000\\000\\000\\000\\000\\000U\\025U\\005\"\n10      0\n</code></pre>\n\n<p>You might have to start looking farther afield for the problem with option 2.</p>\n"}, {"comments": [{"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 0, "creation_date": 1572816991, "post_id": 58684777, "comment_id": 103668873, "body": "Wow!! So the prototypes are throwing it off. Is there anyway to achieve what I want with regard to wrapping a prototyped sub?"}, {"owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572841785, "post_id": 58684777, "comment_id": 103673006, "body": "Ah, it hadn&#39;t occurred to me that the error could have been thrown from a function call rather than a method. The error msg however is from <code>$tx-&gt;send(&#39;test1&#39;)</code> which is a method call. The prototype is ignored there. Evan, try using Carp::Always in the test and you&#39;ll get a full stack trace when it dies."}, {"owner": {"reputation": 201, "user_id": 829550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d171edb8b959fe8a4564c636bdd2d9e8?s=128&d=identicon&r=PG", "display_name": "haarg", "link": "https://stackoverflow.com/users/829550/haarg"}, "edited": false, "score": 0, "creation_date": 1572874655, "post_id": 58684777, "comment_id": 103685834, "body": "The problem happens because without the correct prototype on <code>steady_time</code>, all timers resolve immediately.  This results in the transaction getting resolved before it has time to be upgraded to a websocket transaction, which is needed for the <code>-&gt;send</code> call."}], "tags": [], "owner": {"reputation": 201, "user_id": 829550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d171edb8b959fe8a4564c636bdd2d9e8?s=128&d=identicon&r=PG", "display_name": "haarg", "link": "https://stackoverflow.com/users/829550/haarg"}, "is_accepted": true, "score": 2, "last_activity_date": 1572818637, "last_edit_date": 1572818637, "creation_date": 1572816480, "answer_id": 58684777, "question_id": 58677042, "link": "https://stackoverflow.com/questions/58677042/how-does-mro-goto-and-set-subname-interact/58684777#58684777", "title": "How does mro, goto, and set_subname interact?", "body": "<p>Your second option is not working because the sub you are using as a wrapper does not match the prototype of the inner sub.  <code>monkey_patch</code> is not only used for methods, and this changes how some functions are parsed.  In particular, <code>Mojo::Util::steady_time</code> has an empty prototype and is often called without using parenthesis.</p>\n\n<pre><code>*{\"${class}::$k\"} = Sub::Util::set_prototype(\n  Sub::Util::prototype( $patch{$k} ),\n  Sub::Util::set_subname(\n    \"${class}::$k\",\n    sub {\n      my $cr = Sub::Util::set_subname(\"${class}::$k\", $patch{$k});\n      goto $cr;\n    }\n  )\n);\n</code></pre>\n\n<p>The third construct is not working because you are using <code>goto</code> to remove the renamed wrapper sub from the call stack, leaving only the inner sub which has no name.  This breaks <code>next::method</code>'s ability to find the correct method name.</p>\n"}, {"tags": [], "owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "is_accepted": false, "score": 0, "last_activity_date": 1572845867, "creation_date": 1572845867, "answer_id": 58687730, "question_id": 58677042, "link": "https://stackoverflow.com/questions/58677042/how-does-mro-goto-and-set-subname-interact/58687730#58687730", "title": "How does mro, goto, and set_subname interact?", "body": "<p>After modifying Mojo/Util.pm with</p>\n\n<pre><code>  foreach my $k (keys %patch) {\n    *{\"${class}::$k\"} = sub {\n      my $cr = set_subname(\"${class}::$k\", $patch{$k});\n      goto $cr;\n    };\n   }\n</code></pre>\n\n<p>and isolating the test case, I get:</p>\n\n<pre><code>$ perl -MCarp::Always t/mojo/websocket_proxy2.t\nMojo::Reactor::Poll: Timer failed: Can't locate object method \"send\" via package \"Mojo::Transaction::HTTP\" at t/mojo/websocket_proxy2.t line 59.\n        main::__ANON__(Mojo::UserAgent=HASH(0x60280dad0), Mojo::Transaction::HTTP=HASH(0x6029ee7b0)) called at blib/lib/Mojo/UserAgent.pm line 252\n        Mojo::UserAgent::_finish(Mojo::UserAgent=HASH(0x60280dad0), \"927210c53042c6142eda3f4010c8b17c\", 1) called at blib/lib/Mojo/UserAgent.pm line 220\n        Mojo::UserAgent::_error(Mojo::UserAgent=HASH(0x60280dad0), \"927210c53042c6142eda3f4010c8b17c\", \"Connect timeout\") called at blib/lib/Mojo/UserAgent.pm line 128\n        Mojo::UserAgent::__ANON__(Mojo::IOLoop=HASH(0x601f9abb8), \"Connect timeout\", undef) called at blib/lib/Mojo/IOLoop.pm line 63\n        Mojo::IOLoop::__ANON__(Mojo::IOLoop::Client=HASH(0x601e34598)) called at blib/lib/Mojo/EventEmitter.pm line 15\n        Mojo::EventEmitter::emit(Mojo::IOLoop::Client=HASH(0x601e34598), \"error\", \"Connect timeout\") called at blib/lib/Mojo/IOLoop/Client.pm line 39\n        Mojo::IOLoop::Client::__ANON__(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/Reactor/Poll.pm line 143\n        eval {...} called at blib/lib/Mojo/Reactor/Poll.pm line 143\n        Mojo::Reactor::Poll::_try(Mojo::Reactor::Poll=HASH(0x6001a8390), \"Timer\", CODE(0x601e24ca0)) called at blib/lib/Mojo/Reactor/Poll.pm line 81\n        Mojo::Reactor::Poll::one_tick(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/Reactor/Poll.pm line 99\n        Mojo::Reactor::Poll::start(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/IOLoop.pm line 134\n        Mojo::IOLoop::start(\"Mojo::IOLoop\") called at t/mojo/websocket_proxy2.t line 62\n at blib/lib/Mojo/IOLoop.pm line 23.\n        Mojo::IOLoop::__ANON__(Mojo::Reactor::Poll=HASH(0x6001a8390), \"Timer failed: Can't locate object method \\\"send\\\" via package \\\"Mojo::Transaction::HTTP\\\" at t/mojo/websocket_proxy2.t line 59.\\x{a}\\x{9}main::__ANON__(Mojo::UserAgent=HASH(0x60280dad0), Mojo::Transaction::HTTP=HASH(0x6029ee7b0)) called at blib/lib/Mojo/UserAgent.pm line 252\\x{a}\\x{9}Mojo::UserAgent::_finish(Mojo::UserAgent=HASH(0x60280dad0), \\\"927210c53042c6142eda3f4010c8b17c\\\", 1) called at blib/lib/Mojo/UserAgent.pm line 220\\x{a}\\x{9}Mojo::UserAgent::_error(Mojo::UserAgent=HASH(0x60280dad0), \\\"927210c53042c6142eda3f4010c8b17c\\\", \\\"Connect timeout\\\") called at blib/lib/Mojo/UserAgent.pm line 128\\x{a}\\x{9}Mojo::UserAgent::__ANON__(Mojo::IOLoop=HASH(0x601f9abb8), \\\"Connect timeout\\\", undef) called at blib/lib/Mojo/IOLoop.pm line 63\\x{a}\\x{9}Mojo::IOLoop::__ANON__(Mojo::IOLoop::Client=HASH(0x601e34598)) called at blib/lib/Mojo/EventEmitter.pm line 15\\x{a}\\x{9}Mojo::EventEmitter::emit(Mojo::IOLoop::Client=HASH(0x601e34598), \\\"error\\\", \\\"Connect timeout\\\") called at blib/lib/Mojo/IOLoop/Client.pm line 39\\x{a}\\x{9}Mojo::IOLoop::Client::__ANON__(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/Reactor/Poll.pm line 143\\x{a}\\x{9}eval {...} called at blib/lib/Mojo/Reactor/Poll.pm line 143\\x{a}\\x{9}Mojo::Reactor::Poll::_try(Mojo::Reactor::Poll=HASH(0x6001a8390), \\\"Timer\\\", CODE(0x601e24ca0)) called at blib/lib/Mojo/Reactor/Poll.pm line 81\\x{a}\\x{9}Mojo::Reactor::Poll::one_tick(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/Reactor/Poll.pm line 99\\x{a}\\x{9}Mojo::Reactor::Poll::start(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/IOLoop.pm line 134\\x{a}\\x{9}Mojo::IOLoop::start(\\\"Mojo::IOLoop\\\") called at t/mojo/websocket_proxy2.t line 62\\x{a}\") called at blib/lib/Mojo/EventEmitter.pm line 15\n        Mojo::EventEmitter::emit(Mojo::Reactor::Poll=HASH(0x6001a8390), \"error\", \"Timer failed: Can't locate object method \\\"send\\\" via package \\\"Mojo::Transaction::HTTP\\\" at t/mojo/websocket_proxy2.t line 59.\\x{a}\\x{9}main::__ANON__(Mojo::UserAgent=HASH(0x60280dad0), Mojo::Transaction::HTTP=HASH(0x6029ee7b0)) called at blib/lib/Mojo/UserAgent.pm line 252\\x{a}\\x{9}Mojo::UserAgent::_finish(Mojo::UserAgent=HASH(0x60280dad0), \\\"927210c53042c6142eda3f4010c8b17c\\\", 1) called at blib/lib/Mojo/UserAgent.pm line 220\\x{a}\\x{9}Mojo::UserAgent::_error(Mojo::UserAgent=HASH(0x60280dad0), \\\"927210c53042c6142eda3f4010c8b17c\\\", \\\"Connect timeout\\\") called at blib/lib/Mojo/UserAgent.pm line 128\\x{a}\\x{9}Mojo::UserAgent::__ANON__(Mojo::IOLoop=HASH(0x601f9abb8), \\\"Connect timeout\\\", undef) called at blib/lib/Mojo/IOLoop.pm line 63\\x{a}\\x{9}Mojo::IOLoop::__ANON__(Mojo::IOLoop::Client=HASH(0x601e34598)) called at blib/lib/Mojo/EventEmitter.pm line 15\\x{a}\\x{9}Mojo::EventEmitter::emit(Mojo::IOLoop::Client=HASH(0x601e34598), \\\"error\\\", \\\"Connect timeout\\\") called at blib/lib/Mojo/IOLoop/Client.pm line 39\\x{a}\\x{9}Mojo::IOLoop::Client::__ANON__(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/Reactor/Poll.pm line 143\\x{a}\\x{9}eval {...} called at blib/lib/Mojo/Reactor/Poll.pm line 143\\x{a}\\x{9}Mojo::Reactor::Poll::_try(Mojo::Reactor::Poll=HASH(0x6001a8390), \\\"Timer\\\", CODE(0x601e24ca0)) called at blib/lib/Mojo/Reactor/Poll.pm line 81\\x{a}\\x{9}Mojo::Reactor::Poll::one_tick(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/Reactor/Poll.pm line 99\\x{a}\\x{9}Mojo::Reactor::Poll::start(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/IOLoop.pm line 134\\x{a}\\x{9}Mojo::IOLoop::start(\\\"Mojo::IOLoop\\\") called at t/mojo/websocket_proxy2.t line 62\\x{a}\") called at blib/lib/Mojo/Reactor/Poll.pm line 143\n        Mojo::Reactor::Poll::_try(Mojo::Reactor::Poll=HASH(0x6001a8390), \"Timer\", CODE(0x601e24ca0)) called at blib/lib/Mojo/Reactor/Poll.pm line 81\n        Mojo::Reactor::Poll::one_tick(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/Reactor/Poll.pm line 99\n        Mojo::Reactor::Poll::start(Mojo::Reactor::Poll=HASH(0x6001a8390)) called at blib/lib/Mojo/IOLoop.pm line 134\n        Mojo::IOLoop::start(\"Mojo::IOLoop\") called at t/mojo/websocket_proxy2.t line 62\n</code></pre>\n\n<p>I can also confirm that setting the prototype fixes it.</p>\n"}], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 58684777, "answer_count": 3, "score": 3, "last_activity_date": 1572845867, "creation_date": 1572749396, "last_edit_date": 1572822462, "question_id": 58677042, "link": "https://stackoverflow.com/questions/58677042/how-does-mro-goto-and-set-subname-interact", "title": "How does mro, goto, and set_subname interact?", "body": "<p><strong>This is a complex question with regard to <code>mro.pm</code>, and the interplay with <code>set_subname</code>, and <code>goto</code></strong></p>\n\n<p>In troubleshooting a problem, I think the core of my misunderstanding relates to how <code>mro.pm</code> works -- especially with regard to <code>set_subname</code>. </p>\n\n<p>What is the difference between these three constructs,</p>\n\n<ol>\n<li><p>Plain call to <code>set_subname</code></p>\n\n<pre><code>*Foo::bar = set_subname( 'Foo::bar', $codeRef );\n</code></pre></li>\n<li><p>Anon sub which wraps a <code>set_subname</code></p>\n\n<pre><code>*Foo::bar = sub {\n  my $codeRef2 = set_subname('Foo::bar', $codeRef);\n  goto $codeRef2\n};\n</code></pre></li>\n<li><p>Anon sub which has its name set with <code>set_subname</code></p>\n\n<pre><code>*Foo::bar = set_subname(\n  'Foo::bar',\n  sub { goto $codeRef }\n);\n</code></pre></li>\n</ol>\n\n<p>Specifically, the Mojo test suits fails with either of these modifications with anon subs applied to <a href=\"https://metacpan.org/source/SRI/Mojolicious-8.25/lib/Mojo/Util.pm#L179\" rel=\"nofollow noreferrer\"><code>Mojo::Utils</code>'s <code>monkey_patch</code></a> Running the two variants above against <code>t/mojo/websocket_proxy.t</code>,</p>\n\n<ul>\n<li><p>With the 2 (second) option I have</p>\n\n<pre><code>*{\"${class}::$k\"} = sub {                                                                                                                          \n  my $cr = set_subname(\"${class}::$k\", $patch{$k});                                                                                                \n  goto $cr;                                                                                                                                        \n}; \n</code></pre>\n\n<p>And I get</p>\n\n<pre><code>Mojo::Reactor::Poll: Timer failed: Can't locate object method \"send\" via package \"Mojo::Transaction::HTTP\" at t/mojo/websocket_proxy.t line 66.\n</code></pre></li>\n<li><p>With the 3 (third) option I have,</p>\n\n<pre><code>*{\"${class}::$k\"} = set_subname(\"${class}::$k\", sub { goto $patch{$k} })\n</code></pre>\n\n<p>And I get</p>\n\n<pre><code>No next::method 'new' found for Mojolicious::Routes at /usr/lib/x86_64-linux-gnu/perl/5.28/mro.pm line 30.\n</code></pre></li>\n</ul>\n\n<p>Obviously, the first version works (it's from the code I linked), the question is why are the other two variants giving me different errors (especially the second variant) and what's happening there -- why don't they work?</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 13399, "user_id": 716443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d13509991dbbd5467f01f55988ae4e?s=128&d=identicon&r=PG", "display_name": "DavidO", "link": "https://stackoverflow.com/users/716443/davido"}, "edited": false, "score": 0, "creation_date": 1572739438, "post_id": 58676330, "comment_id": 103653714, "body": "Each invocation of the regex engine will clobber previous states for the capture variables. You need to copy $3 into a new variable before split."}, {"owner": {"reputation": 784, "user_id": 1118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466905ee415e4cd9667f29eea987f15b?s=128&d=identicon&r=PG", "display_name": "jonah_w", "link": "https://stackoverflow.com/users/1118630/jonah-w"}, "reply_to_user": {"reputation": 13399, "user_id": 716443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d13509991dbbd5467f01f55988ae4e?s=128&d=identicon&r=PG", "display_name": "DavidO", "link": "https://stackoverflow.com/users/716443/davido"}, "edited": false, "score": 0, "creation_date": 1572739665, "post_id": 58676330, "comment_id": 103653758, "body": "Do you mean $5? I split the $5. @DavidO"}, {"owner": {"reputation": 784, "user_id": 1118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466905ee415e4cd9667f29eea987f15b?s=128&d=identicon&r=PG", "display_name": "jonah_w", "link": "https://stackoverflow.com/users/1118630/jonah-w"}, "reply_to_user": {"reputation": 13399, "user_id": 716443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d13509991dbbd5467f01f55988ae4e?s=128&d=identicon&r=PG", "display_name": "DavidO", "link": "https://stackoverflow.com/users/716443/davido"}, "edited": false, "score": 0, "creation_date": 1572739822, "post_id": 58676330, "comment_id": 103653781, "body": "I tried <code>dclone</code> the $3 into an array, it also didn&#39;t work."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572742371, "post_id": 58676330, "comment_id": 103654077, "body": "You didn&#39;t say what you are trying to do. If you trying to return the original <code>$3</code>, you will need to make a backup of it because the latter matches and substitutions clear or replace its value. <code>s#...# my $three = $3; ...; $three 3#eg</code>. But that can&#39;t possibly be what you want to do because you never use <code>@m</code> or <code>$new2</code>. So what are you trying to do? Maybe you should be returning <code>$new2</code> instead of <code>$3</code>???"}, {"owner": {"reputation": 784, "user_id": 1118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466905ee415e4cd9667f29eea987f15b?s=128&d=identicon&r=PG", "display_name": "jonah_w", "link": "https://stackoverflow.com/users/1118630/jonah-w"}, "edited": false, "score": 0, "creation_date": 1572743048, "post_id": 58676330, "comment_id": 103654170, "body": "<a href=\"https://stackoverflow.com/a/22896/1118630\">stackoverflow.com/a/22896/1118630</a> According to this post, <code>my $new = $3 =~ s&#47;^\\s+|\\s+$&#47;&#47;mgr;</code> shouldn&#39;t change $3 value, right?"}, {"owner": {"reputation": 13399, "user_id": 716443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d13509991dbbd5467f01f55988ae4e?s=128&d=identicon&r=PG", "display_name": "DavidO", "link": "https://stackoverflow.com/users/716443/davido"}, "edited": false, "score": 2, "creation_date": 1572746870, "post_id": 58676330, "comment_id": 103654617, "body": "Your first substitution <code>s#...##</code> captures into $3. Your split invoked the regex engine again (that&#39;s what the <code>&#47;...&#47;</code> are there for).  So split clobbers $3. But even if it didn&#39;t (which it does), your next line, <code>map{s,...,,}</code> does clobber $3. You don&#39;t need to dclone it. You just need to, before your split line, copy $3 over to some other variable using the assignment operator (<code>=</code>), and then use it later on instead of relying on $3."}], "answers": [{"tags": [], "owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "is_accepted": true, "score": 3, "last_activity_date": 1572748565, "creation_date": 1572748565, "answer_id": 58676984, "question_id": 58676330, "link": "https://stackoverflow.com/questions/58676330/perl-do-substitution-in-substitution-itself/58676984#58676984", "title": "Perl do substitution in substitution itself", "body": "<p>I'm not going to try to really fix the logic of what you're trying to accomplish because it's rather ill advised.  What I will do is offer some semantic and coding advice.</p>\n\n<p>1: Use Regexp::Common and URI to deal with URLs.  It is almost never worth it to write your own regexes.  Parsing HTML with regex requires that you seriously know what you're doing. <a href=\"https://metacpan.org/search?q=regexp%3A%3Acommon\" rel=\"nofollow noreferrer\">https://metacpan.org/search?q=regexp%3A%3Acommon</a></p>\n\n<p>2: Always only use {} and // to wrap regex. (A 99% rule)</p>\n\n<p>3: Always immediately copy the numbered variables into meaningfully named my() variables unless the expression is trivial.</p>\n\n<p>4: Modify arrays inplace with postfix foreach.</p>\n\n<p>5: Spread out the code formatting to make it visually appealing.</p>\n\n<p>6: Use sprintf for complicated variable recombinations.  It makes it a lot easier to see what variable is used where and for what.</p>\n\n<p>HTH</p>\n\n<pre><code>#  1                        2                                     3        4           5\ns{(class=\"p_hw\"&gt;&lt;a href=\\\")(http://[^&lt;&gt;\"]*?xxxx\\.com/[^&lt;&gt;\"]*[=/])([^&lt;&gt;\\\"]*)(\\\"&gt;(?:&lt;b&gt;)?)(.*?)(?=&lt;)}{\n    my ($m1, $m2, $m3, $m4, $m5) = ($1, $2, $3, $4, $5);\n    my @n = split /[,|;]/, $m5;\n    s/^\\s+|\\s+$//mg foreach @n;\n    (my $new = $m3) =~ s/^\\s+|\\s+$//mg;\n    (my $new2 = $new) =~ s/\\+/ /g;\n    exists $hw_f{$new2} ?\n        sprintf \"%sentry://%s%s%s\", $m1, $new2, $m4, $m5 :\n        exists $hw_f{$n[0]} ? \n        sprintf \"%sentry://%s%s%s\", $m1, $n[0], $m4, $m5 :\n        \"$m1$m2$m3$m4$m5\";\n}ige;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 784, "user_id": 1118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466905ee415e4cd9667f29eea987f15b?s=128&d=identicon&r=PG", "display_name": "jonah_w", "link": "https://stackoverflow.com/users/1118630/jonah-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1572748645, "creation_date": 1572748645, "answer_id": 58676992, "question_id": 58676330, "link": "https://stackoverflow.com/questions/58676330/perl-do-substitution-in-substitution-itself/58676992#58676992", "title": "Perl do substitution in substitution itself", "body": "<p>Update:\n</p>\n\n<pre><code>while (&lt;DICT&gt;) {\ns#(class=\"p_hw\"&gt;&lt;a href=\")(http://[^&lt;&gt;\"]*?wordinfo\\.info\\/[^&lt;&gt;\"]*[=/])([^&lt;&gt;\"]*)(\"&gt;(?:&lt;b&gt;)?)(.*?)(?=&lt;)#\n        my $one = $1;\n    my $two = $2;\n    my $three = $3;\n    my $four = $4;\n    my $five = $5;\n        my @n = split(/\\,|;/, $5);\n    my @m = map {s,^\\s+|\\s+$,,mgr} @n;\n    my $new = $3 =~ s/^\\s+|\\s+$//mgr;\n    my $new2 = $new =~ s/\\+/ /mgr;\n    exists $hw_f{$new2} ? $one.\"entry://$new2$four$five\" : (exists $hw_f{$m[0]} ? $one.\"entry://$m[0]$four$five\" : \"$one$two$three$four$five\") #eg;\n\n    print $FH $_;\n}\n</code></pre>\n\n<p>Assigning all the capture variables before all the regex engine invocation as @DavidO in the comment mentioned, it finally works. Thanks.</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1572774659, "creation_date": 1572774659, "answer_id": 58679009, "question_id": 58676330, "link": "https://stackoverflow.com/questions/58676330/perl-do-substitution-in-substitution-itself/58679009#58679009", "title": "Perl do substitution in substitution itself", "body": "<p>from your post it is not obvious what you try to achieve. If you would describe the problem in following format it would be easier to understand</p>\n\n<p>--- Example -----------------------</p>\n\n<p>I extract from web page a snippet with <code>&lt;a href=\"http:\\\\.......</code> which I would like to convert/transform into following format <code>&lt;a href=\"http:\\\\.......</code>.</p>\n\n<p>At least in this way we know what is <em>INPUT</em> and what <em>OUTPUT</em> expected.</p>\n\n<p>--- End of the example ------------</p>\n\n<p>When you apply regex with <em>memory</em> it is easier to store <em>remembered</em> values in an array or better hash</p>\n\n<pre><code>use strict;\nuse warnings;\n\nuse Data::Dumper;\n\nmy %href;\n\n$data = shift;\n\nif( $data =~ /&lt;a href=\"(\\w+):\\\\\\\\([\\w\\d\\.]+)\\\\([\\w\\d\\.]+)\\\\(.+)\"&gt;([^&lt;]+)&lt;/ ) {\n    @href{qw(protocol dns dir rest desc)} = ($1,$2,$3,$4,$5);\n    print Dumper(\\%href);\n} else {\n    print \"No match found\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 784, "user_id": 1118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466905ee415e4cd9667f29eea987f15b?s=128&d=identicon&r=PG", "display_name": "jonah_w", "link": "https://stackoverflow.com/users/1118630/jonah-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58676984, "answer_count": 3, "score": 0, "last_activity_date": 1572829510, "creation_date": 1572739178, "last_edit_date": 1572829510, "question_id": 58676330, "link": "https://stackoverflow.com/questions/58676330/perl-do-substitution-in-substitution-itself", "title": "Perl do substitution in substitution itself", "body": "<p>I was doing some regex substitution operation with the html snippet using Perl.</p>\n\n<p>This is how I match the wanted part: <code>(class=\"p_hw\"&gt;&lt;a href=\")(http://[^&lt;&gt;\"]*?xxxx\\.com\\/[^&lt;&gt;\"]*[=/])([^&lt;&gt;\"]*)(\"&gt;(?:&lt;b&gt;)?)(.*?)(?=&lt;)</code></p>\n\n<p>I need to replace the <code>http://</code> with <code>entry://</code> followed by certain parameter value of the http url(<code>$3</code> for that matter) if that value exists in a hash(<code>%hw_f</code>), or else the first word(or phrase) from <code>$5</code> will be used when it exists in <code>%hw_f</code>. If all conditions are not matched, the snippet will stay unchanged.</p>\n\n<p>I have tried the following:</p>\n\n\n\n<pre><code>s#(class=\"p_hw\"&gt;&lt;a href=\")(http://[^&lt;&gt;\"]*?xxxx\\.com\\/[^&lt;&gt;\"]*[=/])([^&lt;&gt;\"]*)(\"&gt;(?:&lt;b&gt;)?)(.*?)(?=&lt;)#\n        my @n = split(/\\,|;/, $5);\n    my @m = map {s,^\\s+|\\s+$,,mgr} @n;\n    my $new = $3 =~ s/^\\s+|\\s+$//mgr;\n    my $new2 = $new =~ s/\\+/ /mgr;\n    exists $hw_f{$new2} ? \"$1entry://$new2$4$5\" : (exists $hw_f{$m[0]} ? \"$1entry://$m[0]$4$5\" : \"$1$2$3$4$5\") #eg;\n</code></pre>\n\n<blockquote>\n  <p><code>%hw_f</code> is where all conditions will be matched against. </p>\n</blockquote>\n\n<p>It gives the following error:</p>\n\n<blockquote>\n  <p>Use of uninitialized value $1 in concatenation (.) or string </p>\n</blockquote>\n\n<p>I need to obtain a new value based on <code>$3</code> within the substitution, continue with that new value. How could I do that?</p>\n"}, {"tags": ["perl", "hash"], "comments": [{"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 45481, "user_id": 197758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628da6ba2a6c70e35c009b7e3c3a430a?s=128&d=identicon&r=PG", "display_name": "toolic", "link": "https://stackoverflow.com/users/197758/toolic"}, "edited": false, "score": 0, "creation_date": 1572722971, "post_id": 58674386, "comment_id": 103650578, "body": "Hi,  <code>use strict;</code> -- is not a solution, it warns that first form of access does refer to %data hash which is not declared ($data is a reference to hash in my case).  Polar Bear"}, {"owner": {"reputation": 2414, "user_id": 5379657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab4a9ac2ee2c7a27f5d976d6a787970?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Y", "link": "https://stackoverflow.com/users/5379657/jeff-y"}, "edited": false, "score": 0, "creation_date": 1572899459, "post_id": 58674386, "comment_id": 103697229, "body": "You can&#39;t use perl syntax inside a string that way, without using <code>eval</code>. You can save the location as a reference directly by getting rid of <code>$index</code> and just saying <code>$slice = $data-&gt;{playList}[1];</code>. Same with your longer &quot;index&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572734299, "post_id": 58675634, "comment_id": 103652910, "body": "Hello H&#229;kon H&#230;gland,  thanks for your input, I will investigate <code>use Data::Diver</code> (it is new to me).  Unfortunately your solution does not <b>utilize</b> my <code>$index</code> variable.  Please look into my <b>NOTE</b> to see what I have to deal with.  JSON structure is quite complicated and to find required <b>slice</b> going through the code visually is not easy and takes time.Beyond that the website can change JSON structure any time and the code will require reworking.  In case of my <b>find</b> function I need specify only block I am interested in get <b>index</b> then extract <b>slice</b>.  Thank you"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572734538, "post_id": 58675634, "comment_id": 103652955, "body": "The code uses <code>qw( playList 1 )</code> which seems quite similar to your <code>$index</code> variable <code>&#39;{playList}[1]&#39;</code>. How do you create <code>$index</code>? Maybe you could just as easily create the array <code>$index = [&#39;playList&#39;, 1]</code>. As the latter can be passed to <code>DiveVal()</code>.."}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572735083, "post_id": 58675634, "comment_id": 103653054, "body": "Real index looks like following  <code>my $index = &quot;{contents}{twoColumnBrowseResultsRenderer}{tabs}[0]{tabRend&zwnj;&#8203;erer}{content}{secti&zwnj;&#8203;onListRenderer}{cont&zwnj;&#8203;ents}[0]{itemSection&zwnj;&#8203;Renderer}{contents}[&zwnj;&#8203;0]{playlistVideoList&zwnj;&#8203;Renderer}{contents}[&zwnj;&#8203;0]{playlistVideoRend&zwnj;&#8203;erer}{title}{accessi&zwnj;&#8203;bility}{accessibilit&zwnj;&#8203;yData}{label}&quot;;</code>  it is more complicated than in the <b>example</b> but idea is the same.  Polar Bear"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572735183, "post_id": 58675634, "comment_id": 103653072, "body": "Yes that is fine. It is no problem, just use <code>qw( contents twoColumnBrowseResultsRenderer tabs 0 ..... )</code> instead"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572735310, "post_id": 58675634, "comment_id": 103653098, "body": "I am more interested in <b>slice</b> at <code>my $index = &quot;{contents}{twoColumnBrowseResultsRenderer}{tabs}[0]{tabRend&zwnj;&#8203;erer}{content}{secti&zwnj;&#8203;onListRenderer}{cont&zwnj;&#8203;ents}[0]{itemSection&zwnj;&#8203;Renderer}{contents}[&zwnj;&#8203;0]{playlistVideoList&zwnj;&#8203;Renderer}{contents}</code> which is an array.-- I know that the <b>value</b> is in it.   Polar Bear"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572735396, "post_id": 58675634, "comment_id": 103653111, "body": "sorry I did not get your last comment"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 1, "creation_date": 1572735412, "post_id": 58675634, "comment_id": 103653114, "body": "So, you suggest I push into an array all <b>components</b> of index and feed it into <code>DiveVal</code>? I need to try it and see what will <b>come out</b> of it.   Thank you Polar Bear"}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572735700, "post_id": 58675634, "comment_id": 103653171, "body": "sorry, yes it is not obvious from the post which you could not understand -- I need an access to block where the value was found and not to value itself, I need whole playlist and not just one item in the playlist. With your solution I need to change how I <b>build</b> the index (convert it into array) and pop few elements out of array to get into <b>required level</b> to extract <i>*slice</i>.  Polar Bear"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572735961, "post_id": 58675634, "comment_id": 103653219, "body": "I think it is difficult to discuss these issues in the comments here. I am not sure exactly what you mean without seeing more of your code. You may contact me by email if you like (my email address is in my profile).."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572902245, "post_id": 58675634, "comment_id": 103698229, "body": "@Polar Bear, Re &quot;<i>Unfortunately your solution does not utilize my $index variable.</i>&quot;, Because we&#39;re not here to write code for you. If you want to use that format, you&#39;ll need to define the language and write a parser for it. This parser will generate the list of keys and indexes H&#229;kon H&#230;gland&#39;s code takes as input, so his answer is quite pertinent."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572974855, "post_id": 58675634, "comment_id": 103726199, "body": "@Polar Bear, I answered the unanswered question you asked above about why an input format different than the one you requested was used (&quot;<i>Real index looks like following ...</i>&quot;). And I also explained how you could get about using that format if you wanted. Sorry that you deem answering your questions (and providing useful additional advice about achieving what you want that wasn&#39;t already covered) to be useless. I&#39;ll make a point of never doing it again."}], "tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": false, "score": 1, "last_activity_date": 1572731661, "creation_date": 1572731661, "answer_id": 58675634, "question_id": 58674386, "link": "https://stackoverflow.com/questions/58674386/how-to-access-a-hash-value-by-index-stored-in-variable/58675634#58675634", "title": "How to access a hash value by index stored in variable", "body": "<p>You can use <a href=\"https://metacpan.org/pod/Data::Diver\" rel=\"nofollow noreferrer\">Data::Diver</a> :</p>\n\n<pre><code>use Data::Diver   qw( DiveVal );\nuse JSON qw(decode_json);\n\nmy $data = decode_json( join '', &lt;DATA&gt; );\nmy $slice = DiveVal( $data, qw( playList 1 ) );\nprintf \"TITLE: %-15s TIME: %5s TIMES: %5s FAVORITE: %s\\n\",\n        $slice-&gt;{title},\n        $slice-&gt;{time},\n        $slice-&gt;{played},\n        $slice-&gt;{favorite} ? \"yes\" : \"no\";\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>TITLE: Song name 2     TIME:  4:12 TIMES:    30 FAVORITE: no\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572767925, "post_id": 58677225, "comment_id": 103657017, "body": "Thank you, indeed you did not fully understand my question. I have another function (<b>get</b>) which returns reference to slice of hash based on known <b>key</b>, exactly what you suggested. My original question was <b>if it is possible to use the index in that form to access data</b>? I tried different ways and probably <b>eval</b> can do it but as you have mentioned it is not safe. <code>Data::Dumper</code> when outputs hash, inserts some structure in form <code>$VAR1-&gt;{key1}[0]{key2}{key3}.....[8]{keyn}</code> which I guess somehow works."}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572768248, "post_id": 58677225, "comment_id": 103657056, "body": "In my case I know what value I am looking for in <b>huge hash</b> but I do not know <b>location</b> in the hash yet. I wrote function which &quot;traverse&quot; the hash until it finds the value of interest. The function returns <b>index</b> to this value -- now I need go a few <b>levels up</b> to extract hash slice. To do so I have to manually analyse returned <b>index</b>, remove part of it and then I can extract <b>hash slice</b>. But what if tomorrow website changes the structure -- I have to do it manually again and put it in the code (hard coded location)."}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572768755, "post_id": 58677225, "comment_id": 103657135, "body": "To make it easier to comprehend look at YouTube playlist webpage. I know the name of the movie in the playlist but initially I am not aware where in the JSON it is encoded. I run my <b>find</b> subroutine and it returns me <b>index</b> of the location. Now I have an idea where the <b>slice</b> located but how on program level get to the <b>slice</b> where playlist is kept? I have other subroutine which can be <b>fed</b> with <b>key</b> if it is known to get back reference of <b>hash slice</b> and it works fine. If tomorrow name of the <b>key</b> changes the parameter <b>key</b> must be altered in the code again."}, {"owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "reply_to_user": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572835018, "post_id": 58677225, "comment_id": 103671914, "body": "It is not possible to directly use your index string except with eval(). What I would recommend is to rewrite your find function to return a reference to the desired data. Because with any kind of index you produce, you must re-walk the data structure to actually retrieve it which is a waste of time. Alternatively you can use an XPath style module like Data::DPath or Data::Diver."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572845178, "post_id": 58677225, "comment_id": 103673641, "body": "@Polar Bear, Re &quot;<i>but I do not know location in the hash yet.</i>&quot;, The question you asked is about accessing a value given a known location. If the question is wrong, fix the question by editing it. The comments are not the place for this."}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572855190, "post_id": 58677225, "comment_id": 103676712, "body": "Please read my question once again - <i>function &#39;find&#39; returns an index, how to use this index to access data?</i>. No any sentence with <i>access value given a known location</i>. The script demonstrates that data can be accessed if the location is known in advance, just to confirm that <i>data</i> is there. If the <i>index</i> is <i>calculated</i> I could not find a way to use it (probably with <b>eval</b> this behavior can be achieved but it is insecure and should be avoided). For a clarification I added a note with a sample of the index -- what I get in real code."}, {"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "edited": false, "score": 0, "creation_date": 1572986868, "post_id": 58677225, "comment_id": 103731349, "body": "You probably did not see that the index was a string? You could write <i>split each component of &#39;string index&#39; into array and feed it in form of array to Data::Diver function</i> -- then it would make some sense to me. My point is that you did not answered the question asked -- &#39;how to use the index in this form to access the data&#39;, and I have pointed out it to you (and not once)."}], "tags": [], "owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "is_accepted": false, "score": 0, "last_activity_date": 1572886756, "last_edit_date": 1572886756, "creation_date": 1572751911, "answer_id": 58677225, "question_id": 58674386, "link": "https://stackoverflow.com/questions/58674386/how-to-access-a-hash-value-by-index-stored-in-variable/58677225#58677225", "title": "How to access a hash value by index stored in variable", "body": "<p>The problem is that your code is returning all of the keys and elements to find the given element but not the element value itself.  The simplest answer is to return a reference to that located value.</p>\n\n<pre><code>... bunch of lookdown code\nreturn \\ $this_level-&gt;{the_key_I_want}\n</code></pre>\n\n<p>That way the caller can have direct read/write access to the leaf value.</p>\n\n<p>If you want to use the list of keys and elements directly to access a deep value, you will have to do a string eval.  This is NOT recommended unless you 1000% percent trust the data because some joker can name a hash key \"; system qw{rm -rf /}\".</p>\n\n<pre><code>$index = \"{contents}{twoColumnBrowseResultsRenderer}{tabs}[0]{tabRenderer}{content}{sectionListRenderer}{contents}[0]{itemSectionRenderer}{contents}[0]{playlistVideoListRenderer}{contents}[0]{playlistVideoRenderer}{title}{accessibility}{accessibilityData}{label}\"\n$value = eval \"\\$HASH$index\";\n</code></pre>\n\n<p>The right way to use a list like that is another lookdown function that takes the list of keys etc and accesses them one by one.</p>\n\n<p>HTH</p>\n\n<p>PS: I slightly misunderstood your original question.  Just write in your code:</p>\n\n<p><code>$slice = $data-&gt;{playList}[1];</code></p>\n\n<p>2nd Edit to actually use $index:</p>\n\n<pre><code>use Data::Diver qw/Dive/; # or Data::DPath, etc\nmy $data = ...;\nmy $index = \"{contents}{twoColumnBrowseResultsRenderer}{tabs}[0]{tabRenderer}{content}{sectionListRenderer}{contents}[0]{itemSectionRenderer}{contents}[0]{playlistVideoListRenderer}{contents}[0]{playlistVideoRenderer}{title}{accessibility}{accessibilityData}{label}\";\nmy @index = split /[{}[\\]]+/, $index;\nshift @index;\npop @index for 1..2 # however many levels to back up to\nmy $slice = Dive( $data, @index );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 1, "last_activity_date": 1572976594, "last_edit_date": 1572976594, "creation_date": 1572845618, "answer_id": 58687684, "question_id": 58674386, "link": "https://stackoverflow.com/questions/58674386/how-to-access-a-hash-value-by-index-stored-in-variable/58687684#58687684", "title": "How to access a hash value by index stored in variable", "body": "<p>In the comments, you said you had a function that finds the an element in your JSON data structure and returns a \"path\" to that element, and that your question is about finding a higher-level container of that element.</p>\n\n<p>If this was XML, I'd use an XPath to do both the search and finding the right container. But worry not, someone has devlopped an <a href=\"https://goessner.net/articles/JsonPath/\" rel=\"nofollow noreferrer\">XPath-like language for JSON</a>, and someone has provide this functionality via Perl module <a href=\"https://metacpan.org/pod/JSON::Path\" rel=\"nofollow noreferrer\">JSON::Path</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 1, "last_activity_date": 1572909615, "creation_date": 1572909615, "answer_id": 58702420, "question_id": 58674386, "link": "https://stackoverflow.com/questions/58674386/how-to-access-a-hash-value-by-index-stored-in-variable/58702420#58702420", "title": "How to access a hash value by index stored in variable", "body": "<p>I would like to extend <strong>my '<em>thank you</em>'</strong> to H\u00e5kon H\u00e6gland and lordadmira for offered solution</p>\n\n<pre><code>use Data::Diver qw/Dive/; # or Data::DPath, etc\n\nmy $data = ...;\n\nmy $index = \"{contents}{twoColumnBrowseResultsRenderer}{tabs}[0]{tabRenderer}{content}{sectionListRenderer}{contents}[0]{itemSectionRenderer}{contents}[0]{playlistVideoListRenderer}{contents}[0]{playlistVideoRenderer}{title}{accessibility}{accessibilityData}{label}\";\n\n$index =~ s/[{\\[]//g;\n\nmy @index = split /[}\\]]/, $index;\n\npop @index for 1..8 # 8 levels to back up to\n\nmy $slice = Dive( $data, @index );\n\nmy $playlist = $slice-&gt;{playlistVideoListRenderer}{contents};\n\n\nforeach ( @$playlist ) {\n    my $video = $_-&gt;{playlistVideoRenderer};\n    printf \"%s %8s %s\\n\",\n            $video-&gt;{videoId},\n            $video-&gt;{lengthText}{simpleText},\n            $video-&gt;{title}{simpleText};\n}\n</code></pre>\n\n<p>Both of them referred me to <code>use Data::Dive</code> with help of this module I can do <em>back up</em> few levels from the depth of the hash and extract <strong>slice</strong> of interest.</p>\n\n<p>It was learned that by utilizing this module the index in form of <strong>array</strong> is easier to work with. Due this factor I will <em>alter</em> my find function to return an index <strong>array</strong>.</p>\n"}], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1584580836, "creation_date": 1572721632, "last_edit_date": 1584580836, "question_id": 58674386, "link": "https://stackoverflow.com/questions/58674386/how-to-access-a-hash-value-by-index-stored-in-variable", "title": "How to access a hash value by index stored in variable", "body": "<p>I am working on some code to extract data stored in JSON format from web page. JSON data extracted and decode properly into hash. </p>\n\n<p>The structure of JSON data is very complex, I wrote some assisting code/function which 'traverse' through the hash and helps finds 'index' (location) of a value of interest in the hash. </p>\n\n<p>The 'find' function returns 'index' (location) of the data in the hash which stored in a variable.</p>\n\n<p>I attempt to use this variable (stored 'index') in other operations but so far without any success.</p>\n\n<p>Please see included simple demo snippet code for explanation of the problem.</p>\n\n<p>Thank you,\nPolar Bear  </p>\n\n<pre><code>use strict;\nuse warnings;\n\nuse JSON qw(decode_json);\n\nmy $index;\nmy $slice;\n\nmy $data = decode_json( join '', &lt;DATA&gt; );\n\nprintf \"TITLE: %-15s TIME: %5s TIMES: %5s FAVORITE: %s\\n\",\n        $data-&gt;{playList}[1]{title},\n        $data-&gt;{playList}[1]{time},\n        $data-&gt;{playList}[1]{played},\n        $data-&gt;{playList}[1]{favorite} ? \"yes\" : \"no\";\n\n$index = '{playList}[1]';\n\n$slice = $data{$index};     # does not pass 'use strict' compilation error\n$slice = $data-&gt;{$index};   # empty slice \n$slice = $data-&gt;$index;     # Can't call method \"{playList}[1]\" on unblessed reference at\n\nprintf \"TITLE: %-15s TIME: %5s TIMES: %5s FAVORITE: %s\\n\",\n        $slice-&gt;{title},\n        $slice-&gt;{time},\n        $slice-&gt;{played},\n        $slice-&gt;{favorite} ? \"yes\" : \"no\";\n\n__DATA__\n{\n    \"playList\": [\n      {\n        \"title\": \"Song name 1\",\n        \"time\": \"3:25\",\n        \"played\": \"240\",\n        \"favorite\": \"1\"\n      },\n      {\n        \"title\": \"Song name 2\",\n        \"time\": \"4:12\",\n        \"played\": \"30\",\n        \"favorite\": \"0\"\n      },\n      {\n        \"title\": \"Song name 3\",\n        \"time\": \"2:56\",\n        \"played\": \"85\",\n        \"favorite\": \"0\"\n      }\n    ]\n}\n</code></pre>\n\n<p>I expect to access data by utilizing 'index' stored in a variable but I could not find a way to achieve this result. See comments in the code for details.</p>\n\n<p>NOTE: In real life the index looks as following</p>\n\n<pre><code>my $index = \"{contents}{twoColumnBrowseResultsRenderer}{tabs}[0]{tabRenderer}{content}{sectionListRenderer}{contents}[0]{itemSectionRenderer}{contents}[0]{playlistVideoListRenderer}{contents}[0]{playlistVideoRenderer}{title}{accessibility}{accessibilityData}{label}\";\n</code></pre>\n\n<p>SOLUTION:</p>\n\n<p>I would like to extend <strong>my '<em>thank you</em>'</strong> to H\u00e5kon H\u00e6gland and lordadmira for offered solution</p>\n\n<pre><code>use Data::Diver qw/Dive/; # or Data::DPath, etc\n\n# Capture web page, extract data JSON, convert to hash, assign hash ref to $data\nmy $data = ...; \n\n# Find index/location in the hash\n#my $index = find($data, $value);\n\nmy $index = \"{contents}{twoColumnBrowseResultsRenderer}{tabs}[0]{tabRenderer}{content}{sectionListRenderer}{contents}[0]{itemSectionRenderer}{contents}[0]{playlistVideoListRenderer}{contents}[0]{playlistVideoRenderer}{title}{accessibility}{accessibilityData}{label}\";\n\n$index =~ s/[{\\[]//g; # throw away opening brackets\n\nmy @index = split /[}\\]]/, $index; # split into array on closing brackets\n\npop @index for 1..8 # 8 levels to back up to\n\nmy $slice = Dive( $data, @index ); # extract hash slice of interest\n\n# extract playlist\nmy $playlist = $slice-&gt;{playlistVideoListRenderer}{contents};\n\n# go through playlist and extract information of our interest\nforeach ( @$playlist ) {\n    my $video = $_-&gt;{playlistVideoRenderer};\n    printf \"%s %8s %s\\n\",\n            $video-&gt;{videoId},\n            $video-&gt;{lengthText}{simpleText},\n            $video-&gt;{title}{simpleText};\n}\n</code></pre>\n\n<p>Both of them referred me to <code>use Data::Dive</code> with help of this module I can do <em>back up</em> few levels from the depth of the hash and extract <strong>slice</strong> of interest.</p>\n\n<p>It was learned that by utilizing this module the index in form of <strong>array</strong> is easier to work with. Due this factor I will <em>alter</em> my find function to return an index <strong>array</strong>.</p>\n"}, {"tags": ["perl", "lwp-useragent"], "comments": [{"owner": {"reputation": 360, "user_id": 9696928, "user_type": "registered", "profile_image": "https://graph.facebook.com/565264017190206/picture?type=large", "display_name": "Mobrine Hayde", "link": "https://stackoverflow.com/users/9696928/mobrine-hayde"}, "edited": false, "score": 0, "creation_date": 1572738267, "post_id": 58673271, "comment_id": 103653582, "body": "What do you want to store using mirror??? Webpage? File?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6604123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4e3ec4d138ee4ebabc4fc62c6b2bbb?s=128&d=identicon&r=PG&f=1", "display_name": "steve2k2", "link": "https://stackoverflow.com/users/6604123/steve2k2"}, "edited": false, "score": 0, "creation_date": 1573139181, "post_id": 58684711, "comment_id": 103791249, "body": "Thank you for this."}], "tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": false, "score": 1, "last_activity_date": 1572815932, "creation_date": 1572815932, "answer_id": 58684711, "question_id": 58673271, "link": "https://stackoverflow.com/questions/58673271/can-i-decode-gzip-when-using-the-mirror-function-in-lwp-useragent/58684711#58684711", "title": "Can I decode gzip when using the mirror function in LWP Useragent?", "body": "<p>When using <a href=\"https://metacpan.org/pod/LWP::UserAgent#mirror\" rel=\"nofollow noreferrer\"><code>mirror()</code></a> the received data is not added to the response object directly, but instead written directly to the mirror file. This means that <a href=\"https://metacpan.org/pod/HTTP::Response\" rel=\"nofollow noreferrer\"><code>decoded_content()</code></a> will not work. However, you can add a <a href=\"https://metacpan.org/pod/LWP::UserAgent#add_handler\" rel=\"nofollow noreferrer\"><code>response_header</code></a> that enables the storage of the received data:</p>\n\n<pre><code>use strict;\nuse warnings;\nuse LWP::UserAgent ();\n\nmy $ua = LWP::UserAgent-&gt;new;\n\nmy $fn = 'libwww-perl-6.41.tar.gz';  # Example file..\nmy $url = 'https://cpan.metacpan.org/authors/id/O/OA/OALDERS/'. $fn;\n$ua-&gt;add_handler(\n    response_header =&gt; sub {\n        my($response, $ua, $handler) = @_;\n        $response-&gt;{default_add_content} = 1;\n    }\n);\nmy $response = $ua-&gt;mirror($url, $fn);\nif ( $response-&gt;is_success ) {\n    if ( $response-&gt;header('Content-Type') eq 'application/x-gzip') {\n        $response-&gt;header('Content-Encoding' =&gt; 'gzip');\n    }\n    my $decoded_content = $response-&gt;decoded_content;\n    # Do someting with the decoded content here ...\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6604123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4e3ec4d138ee4ebabc4fc62c6b2bbb?s=128&d=identicon&r=PG&f=1", "display_name": "steve2k2", "link": "https://stackoverflow.com/users/6604123/steve2k2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572815932, "creation_date": 1572713903, "question_id": 58673271, "link": "https://stackoverflow.com/questions/58673271/can-i-decode-gzip-when-using-the-mirror-function-in-lwp-useragent", "title": "Can I decode gzip when using the mirror function in LWP Useragent?", "body": "<p>Can I use something like $response->decoded_content within a LWP UserAgent 'mirror' request?  Thank you.</p>\n"}, {"tags": ["regex", "perl", "while-loop", "cygwin", "do-while"], "comments": [{"owner": {"reputation": 1323, "user_id": 2030808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRrvi.png?s=128&g=1", "display_name": "pmqs", "link": "https://stackoverflow.com/users/2030808/pmqs"}, "edited": false, "score": 2, "creation_date": 1572649608, "post_id": 58666703, "comment_id": 103636560, "body": "Your sample code has multiple syntax errors."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1572649718, "post_id": 58666816, "comment_id": 103636576, "body": "Thank you @pmqs . I will try this now and get back to you"}, {"owner": {"reputation": 1323, "user_id": 2030808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRrvi.png?s=128&g=1", "display_name": "pmqs", "link": "https://stackoverflow.com/users/2030808/pmqs"}, "reply_to_user": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1572651221, "post_id": 58666816, "comment_id": 103636845, "body": "No, that isn&#39;t necessary. I tested the script before I posted it to check it worked, so there shouldn&#39;t be any syntax errors. What is the syntax error you are getting?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1572652063, "post_id": 58666816, "comment_id": 103636996, "body": "@MO12, More importantly, what did you change?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1572652188, "post_id": 58666816, "comment_id": 103637021, "body": "@MO12, <code>if</code> statement: <code>if (COND_EXPR) BLOCK</code> // <code>if</code> statement modifier: <code>EXPR if COND_EXPR;</code>"}, {"owner": {"reputation": 1323, "user_id": 2030808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRrvi.png?s=128&g=1", "display_name": "pmqs", "link": "https://stackoverflow.com/users/2030808/pmqs"}, "reply_to_user": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1572652327, "post_id": 58666816, "comment_id": 103637049, "body": "@MO12 I&#39;ve copied the code I posted &amp; ran it again, just in case I did a cut-and-paste error. Still works fine for me.  Can you check again that you haven&#39;t accidentally changed it while you copied it?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572652473, "post_id": 58666816, "comment_id": 103637074, "body": "<code>open(my $FILE, &quot;$filename&quot;)</code> should be <code>open(my $FILE, &quot;&lt;&quot;, $filename)</code>. (Needless use of stringification. Needless use of problematic two-arg <code>open</code>.)"}, {"owner": {"reputation": 1323, "user_id": 2030808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRrvi.png?s=128&g=1", "display_name": "pmqs", "link": "https://stackoverflow.com/users/2030808/pmqs"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572652648, "post_id": 58666816, "comment_id": 103637109, "body": "@ikegami -that&#39;s a valid change to make, but not enough to trigger the syntax error"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572652745, "post_id": 58666816, "comment_id": 103637130, "body": "Correct. It just makes the code nicer (more or less). It doesn&#39;t fix any syntax errors because there are no syntax errors to fix."}, {"owner": {"reputation": 1323, "user_id": 2030808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRrvi.png?s=128&g=1", "display_name": "pmqs", "link": "https://stackoverflow.com/users/2030808/pmqs"}, "reply_to_user": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1572653324, "post_id": 58666816, "comment_id": 103637236, "body": "Running on cygwin shouldn&#39;t make any difference @MO12. Perl syntax is the same on all platforms. Also the format of the data you are reading is not relevant -- the syntax error means the code will not get a chance to run and read &quot;data.txt&quot;."}, {"owner": {"reputation": 1323, "user_id": 2030808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRrvi.png?s=128&g=1", "display_name": "pmqs", "link": "https://stackoverflow.com/users/2030808/pmqs"}, "edited": false, "score": 0, "creation_date": 1572654789, "post_id": 58666816, "comment_id": 103637502, "body": "Make sure the line that is testing for the AVERAGES OVER is this --&gt;  if $str =~ /AVERAGES OVER/ ;"}, {"owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "edited": false, "score": 0, "creation_date": 1572660429, "post_id": 58666816, "comment_id": 103638268, "body": "@pmqs when you get a chance can you explain this. /AVERAGES OVER/  (what are the forward slashes doing."}, {"owner": {"reputation": 1323, "user_id": 2030808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRrvi.png?s=128&g=1", "display_name": "pmqs", "link": "https://stackoverflow.com/users/2030808/pmqs"}, "edited": false, "score": 0, "creation_date": 1572702797, "post_id": 58666816, "comment_id": 103645281, "body": "The forward slashes are used to delimit a &quot;regular expression&quot; (see <a href=\"https://perldoc.perl.org/perlre.html\" rel=\"nofollow noreferrer\">perldoc.perl.org/perlre.html</a>). In this instance there are no special regular expression meta characters being used, so the expression $str =~ /AVERAGES OVER/ can be read as &quot;Does $str contain the literal string &#39;AVERAGES OVER&#39; anywhere."}], "tags": [], "owner": {"reputation": 1323, "user_id": 2030808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iRrvi.png?s=128&g=1", "display_name": "pmqs", "link": "https://stackoverflow.com/users/2030808/pmqs"}, "is_accepted": false, "score": 1, "last_activity_date": 1572651443, "last_edit_date": 1572651443, "creation_date": 1572649416, "answer_id": 58666816, "question_id": 58666703, "link": "https://stackoverflow.com/questions/58666703/extract-text-from-a-file-until-a-matching-line-in-perl/58666816#58666816", "title": "extract text from a file until a matching line in perl", "body": "<p>You are making it more complicated than it needs to be. You only need a single loop to achieve what you need</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy $filename= \"data.txt\";\nopen(my $FILE, \"$filename\") \n    || die \"cannot open the file $filename: $!\\n\";\n\nwhile (my $str = &lt;$FILE&gt;)\n{\n    print substr($str, 1,-55). \"\\n\"\n        if $str =~ /Etot/;\n\n    last \n        if $str =~ /AVERAGES OVER/;\n}\nclose($FILE);\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 5460375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b3f17b1be46bd905d8a6c181edf9d5?s=128&d=identicon&r=PG&f=1", "display_name": "MO12", "link": "https://stackoverflow.com/users/5460375/mo12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572651443, "creation_date": 1572648344, "question_id": 58666703, "link": "https://stackoverflow.com/questions/58666703/extract-text-from-a-file-until-a-matching-line-in-perl", "title": "extract text from a file until a matching line in perl", "body": "<p>I have a large file. I am trying that is parse it to extract the value that is associated with the word Etot.There are multiple entries of Etot. i want to extract all the values until the search hits the line \"AVERAGES OVER\". I am using cygwin. Here is what I have so far</p>\n\n<pre><code>$filename= \"data.txt\";\nopen($FILE. \"$filename\") ||die \"cannot open the file $filename: $!\";\ndo {\n\nwhile ($str = &lt;$FILE&gt;)\nchomp $str;\n\nif ( $str =~ /Etot/) {\nprint substr($str, 1,-55). \"\\n\";\n}\n\nuntil ($str =~ \"AVERAGES OVER\")\n\n}\nclose($FILE);\n\nclose($fh);\n</code></pre>\n"}, {"tags": ["perl", "soap", "wsdl"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572637693, "post_id": 58664062, "comment_id": 103633261, "body": "Note: The problem is reproduceable by simply changing <code>&quot;link_to_wsdl&quot;</code> to something <code>&quot;file:&#47;&#47;&#47;home&#47;ikegam&#47;a.wsdl&quot;</code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572637947, "post_id": 58664062, "comment_id": 103633343, "body": "I think the module wants <code>{http:&#47;&#47;schemas.xmlsoap.org&#47;wsdl&#47;soap&#47;}operation</code> elements rather than <code>{http:&#47;&#47;schemas.xmlsoap.org&#47;wsdl&#47;soap12&#47;}operation</code> elements. Redefining <code>soap12</code> seems to go further. That said, the module&#39;s docs does mention support for 1.2"}], "owner": {"reputation": 43, "user_id": 4170058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0668908b8b09b5a1b23f4cf068d7649c?s=128&d=identicon&r=PG", "display_name": "cb49747", "link": "https://stackoverflow.com/users/4170058/cb49747"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1572633087, "creation_date": 1572632568, "last_edit_date": 1572633087, "question_id": 58664062, "link": "https://stackoverflow.com/questions/58664062/soapwsdl-returns-error-cant-use-an-undefined-value-as-an-array-reference", "title": "SOAP::WSDL returns error Can&#39;t use an undefined value as an ARRAY reference", "body": "<p>I have a perl program that is accessing a soap server.  when testing the soap server via SoapUI it works, but when using my perl program I get </p>\n\n<p>Can't use an undefined value as an ARRAY reference at /Library/Perl/5.18/SOAP/WSDL.pm line 222.</p>\n\n<p>Here is my perl script.</p>\n\n<pre><code>use SOAP::WSDL;\n\nmy $data = 'some data here';\n\n$ENV{PERL_LWP_SSL_VERIFY_HOSTNAME} = 0;\n\nmy $client = SOAP::WSDL-&gt;new( 'wsdl' =&gt; \"link_to_wsdl\" );\nmy $result = $client-&gt;call('MyMethod', $data);\n\nuse Data::Dumper;\nprint Dumper($result);\n</code></pre>\n\n<p>Here is the WSDL</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;wsdl:definitions \n    name=\"Test\"\n    xmlns:wsdl=\"http://schemas.xmlsoap.org/wsdl/\"\n    xmlns:soap12=\"http://schemas.xmlsoap.org/wsdl/soap12/\"\n    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n    xmlns:tns=\"urn:APISoapServer\"\n    targetNamespace=\"urn:APISoapServer\"\n&gt; \n  &lt;wsdl:types&gt;\n    &lt;xsd:schema xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n      targetNamespace=\"urn:APISoapServer\"&gt;\n      &lt;xsd:element name=\"MyMethod\"&gt;\n        &lt;xsd:complexType&gt;\n          &lt;xsd:complexContent mixed=\"true\"&gt;\n            &lt;xsd:restriction base=\"xsd:anyType\"&gt;\n              &lt;xsd:sequence&gt;\n                &lt;xsd:element name=\"operand1\" type=\"xsd:string\" maxOccurs=\"unbounded\"/&gt;\n              &lt;/xsd:sequence&gt;\n            &lt;/xsd:restriction&gt;\n          &lt;/xsd:complexContent&gt;\n        &lt;/xsd:complexType&gt;\n      &lt;/xsd:element&gt;\n      &lt;xsd:element name=\"MyMethodResponse\"&gt;\n        &lt;xsd:complexType&gt;\n          &lt;xsd:sequence&gt;\n            &lt;xsd:element name=\"Confirmation\" maxOccurs=\"unbounded\"&gt;\n              &lt;xsd:complexType&gt;\n                &lt;xsd:complexContent&gt;\n                  &lt;xsd:restriction base=\"xsd:anyType\"&gt;\n                    &lt;xsd:attribute name=\"response\" type=\"xsd:string\"/&gt;\n                  &lt;/xsd:restriction&gt;\n                &lt;/xsd:complexContent&gt;\n              &lt;/xsd:complexType&gt;\n            &lt;/xsd:element&gt;\n          &lt;/xsd:sequence&gt;\n        &lt;/xsd:complexType&gt;\n      &lt;/xsd:element&gt;\n    &lt;/xsd:schema&gt;\n  &lt;/wsdl:types&gt;      \n\n  &lt;wsdl:message name=\"MYAPIRequest\"&gt;\n    &lt;wsdl:part name=\"MYAPIRequestPart\" element=\"tns:MyMethod\"/&gt;\n  &lt;/wsdl:message&gt;\n  &lt;wsdl:message name=\"MYAPIResponse\"&gt;\n    &lt;wsdl:part name=\"MYAPIResponsePart\" element=\"tns:MyMethodResponse\"/&gt;\n  &lt;/wsdl:message&gt;\n\n  &lt;wsdl:portType name=\"MYAPIServerPort\"&gt;\n    &lt;wsdl:operation name=\"MyMethod\"&gt;\n      &lt;wsdl:input name=\"MyMethodInput\" message=\"tns:MYAPIRequest\"/&gt;\n      &lt;wsdl:output name=\"MyMethodOutput\" message=\"tns:MYAPIResponse\"/&gt;\n    &lt;/wsdl:operation&gt;\n  &lt;/wsdl:portType&gt;\n\n  &lt;wsdl:binding name=\"MYAPIServerBinding\" type=\"tns:MYAPIServerPort\"&gt;\n    &lt;soap12:binding transport=\"http://schemas.xmlsoap.org/soap/http\"/&gt;\n    &lt;wsdl:operation name=\"MyMethod\"&gt;\n      &lt;soap12:operation style=\"document\" soapAction=\"urn:APISoapServer#MyMethod\" /&gt;\n      &lt;wsdl:input name=\"MyMethodInput\"&gt;\n        &lt;soap12:body use=\"literal\"/&gt;\n      &lt;/wsdl:input&gt;\n      &lt;wsdl:output name=\"MyMethodOutput\"&gt;\n        &lt;soap12:body use=\"literal\"/&gt;\n      &lt;/wsdl:output&gt;\n    &lt;/wsdl:operation&gt;\n  &lt;/wsdl:binding&gt;\n\n  &lt;wsdl:service name=\"MYAPIService\"&gt;\n    &lt;wsdl:port name=\"MYAPIPort\" binding=\"tns:MYAPIServerBinding\"&gt;\n      &lt;soap12:address location=\"https://my.site.com/api/my_api_server.pl\"/&gt;\n    &lt;/wsdl:port&gt;\n  &lt;/wsdl:service&gt;\n\n&lt;/wsdl:definitions&gt;\n</code></pre>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12097764"}, "edited": false, "score": 0, "creation_date": 1572642361, "post_id": 58663971, "comment_id": 103634841, "body": "The big thing is that <code>&#47;&#47;</code> are <i>quote-like-operators</i> parsed by the language. So <code>&#47;^current.*$&#47;</code> is parsed as a regex object <code>^current.*$</code> where as <code>&quot;&#47;^current.*$&#47;&quot;</code> is parsed as the string <code>&#47;^current.*$&#47;</code> not a regex object."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1574358299, "post_id": 58663971, "comment_id": 104214488, "body": "See <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>  If there are still issues please let us know"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 1692643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc10cb7dedaf10fec02e2bb253d45f81?s=128&d=identicon&r=PG", "display_name": "ZamanX90", "link": "https://stackoverflow.com/users/1692643/zamanx90"}, "edited": false, "score": 0, "creation_date": 1572635372, "post_id": 58664063, "comment_id": 103632416, "body": "this regex pattern coming from the user input, like set_parameter regex &quot;/^current.*$/&quot;,"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 31, "user_id": 1692643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc10cb7dedaf10fec02e2bb253d45f81?s=128&d=identicon&r=PG", "display_name": "ZamanX90", "link": "https://stackoverflow.com/users/1692643/zamanx90"}, "edited": false, "score": 0, "creation_date": 1572637752, "post_id": 58664063, "comment_id": 103633280, "body": "@ZamanX90  Users should not be putting those <code>&#47;</code> around -- they aren&#39;t a part of the pattern.  (If they do then your regex will then have <i>that</i> as a part of the pattern! It will try to match a slash  in the beginning and end. So you may actually want to strip slashes in the script, if they surround input for the pattern?)"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 31, "user_id": 1692643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc10cb7dedaf10fec02e2bb253d45f81?s=128&d=identicon&r=PG", "display_name": "ZamanX90", "link": "https://stackoverflow.com/users/1692643/zamanx90"}, "edited": false, "score": 0, "creation_date": 1572639010, "post_id": 58664063, "comment_id": 103633772, "body": "@ZamanX90  That&#39;s a good point that may be tricky, since you <i>don&#39;t want</i> &quot;delimiters&quot; to be submitted around a pattern -- while one may actually want surrounding slashes as a part of a pattern! Updated the answer with a comment."}, {"owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572756133, "post_id": 58664063, "comment_id": 103655653, "body": "Users should be writing a pattern on the command line just as they would with grep.  <code>grep -P &#39;^ *current(?:foo|bar)?$&#39; </code>  or  <code>script.pl &#39;^ *current(?:foo|bar)?$&#39; &#39;string&#39;</code>"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572757510, "post_id": 58664063, "comment_id": 103655788, "body": "@lordadmira Well, yes, that&#39;s what I say in the answer as well (&quot;<i>...they need to supply a pattern alone...</i>&quot;) -- but the question is, what if/when they don&#39;t?  If the program simply takes input and the user gave it with <code>&#47;</code>&#39;s then the program will happily use the whole thing as a pattern and so the regex will look for a leading <code>&#47;</code> and just quietly fail. So the program should check for (wrong) delimiters, but then again, the <code>&#47;</code>s <i>may</i> also be legit; thus the conundrum.  That&#39;s what I comment on in the last paragraphs."}, {"owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572760058, "post_id": 58664063, "comment_id": 103656043, "body": "It should simply print <code>Error: PEBCAK</code> in those cases."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572762534, "post_id": 58664063, "comment_id": 103656285, "body": "@lordadmira  No, I&#39;m saying that it may not be an error -- it is completely possible to have a pattern with actual slashes (not to mention curlies or square brackets).  So if a program checks and sees delimiters it&#39;s not certain that it&#39;s an error.  (One can then say that legit <code>&#47;</code> should be escaped ... but <code>{}</code> needn&#39;t be in older engines for example)"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572766597, "post_id": 58664063, "comment_id": 103656856, "body": "@lordadmira (While <code>&#47;</code> need not be escaped either since the pattern&#39;s in a variable ... and I can totally search for <code>&#47;dirname&#47;</code> in some config file, or whatnot; leading+trailing <code>&#47;</code>s can be legit in a pattern)"}, {"owner": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572833925, "post_id": 58664063, "comment_id": 103671740, "body": "Obviously whatever constitutes a valid pattern needs to be specified in the code.  You either have to accept anything - and accept the security holes - or validate it with another regex or use the re module."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 1461, "user_id": 11413106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb804df0cd07dea005f85e7b3e9a0d42?s=128&d=identicon&r=PG&f=1", "display_name": "lordadmira", "link": "https://stackoverflow.com/users/11413106/lordadmira"}, "edited": false, "score": 0, "creation_date": 1572848565, "post_id": 58664063, "comment_id": 103674532, "body": "@lordadmira Well it&#39;s not that simple -- it is clear what a valid pattern is but the problem is that a pebcak-style error (that the OP says may come) looks exactly the same as a valid pattern (<code>&#47;abc&#47;</code>). So what to do with such input? And that&#39;s on the OP, how to resolve that, since there is no clear-cut solution; i just brought it up for them."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 6, "last_activity_date": 1574358226, "last_edit_date": 1574358226, "creation_date": 1572632568, "answer_id": 58664063, "question_id": 58663971, "link": "https://stackoverflow.com/questions/58663971/how-to-use-regular-expression-in-perl-if-both-regular-expression-and-strings-are/58664063#58664063", "title": "How to use Regular expression in perl if both regular expression and strings are variables", "body": "<p>The <a href=\"https://perldoc.perl.org/perlop.html#Quote-and-Quote-like-Operators\" rel=\"nofollow noreferrer\">double-quotes</a> that you use <em>interpolate</em> -- they first evaluate what's inside them (variables, escapes, etc) and return a string built with evaluations' results and remaining literals. See <a href=\"https://perldoc.perl.org/perlop.html#Gory-details-of-parsing-quoted-constructs\" rel=\"nofollow noreferrer\">Gory details of parsing quoting constructs</a> for an illuminating discussion, with lots of detail.</p>\n\n<p>And your example string happens to have a <code>$/</code> there, which is one of Perl's global variables (see <a href=\"https://perldoc.perl.org/perlvar.html\" rel=\"nofollow noreferrer\">perlvar</a>) so <code>$pattern</code> is different than expected; print it to see. (In this case the <code>/</code> is erroneous as discussed below but the point stands.)</p>\n\n<p>Instead, either use single quotes to avoid interpretation of characters like <code>$</code> and <code>\\</code> (etc) so that they are used in regex as such</p>\n\n<pre><code>my $pattern = q(^current.*$);\n</code></pre>\n\n<p>or, better, use the regex-specific <a href=\"https://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators\" rel=\"nofollow noreferrer\"><code>qr</code> operator</a></p>\n\n<pre><code>my $pattern = qr/^current.*$/;\n</code></pre>\n\n<p>which builds from its string a proper regex pattern (a special type of Perl value), and allows use of modifiers.  In this case you need to escape characters that have a special meaning in regex if you want them to be treated as literals.</p>\n\n<p>Note that there's no need for <code>//</code> for the regex, and they wouldn't be a part of the pattern anyway -- having them around the actual pattern is wrong.</p>\n\n<p>Also, carefully consider all circumstances under which user input may end up being used.</p>\n\n<hr>\n\n<p>It is brought up in a comment that users may submit a \"pattern\" with extra <code>/</code>'s. That'd be wrong, as mentioned above; only the pattern itself should be given (surrounded on the command-line by <code>'</code>, so that the shell doesn't interpret particular characters in it).  More detail follows.</p>\n\n<p>The <code>/</code>'s are clearly not meant as a part of the pattern, but are rather intended to come with the match operator, to delimit (quote) the regex pattern itself (in the larger expression) so that one can use string literals in the pattern. Or they are used for clarity, and/or to be able to specify global modifiers (even though those can be specified inside patterns as well).</p>\n\n<p>But then if users still type them around the pattern the regex will use those characters as a part of the pattern and will try to match a leading <code>/</code>, etc; it will fail, quietly. Make sure that users know that they need to give a pattern alone, with no delimiters.  </p>\n\n<p>If this is likely to be a problem I'd check for delimiters and if found  carry on with a \"loud\" (clear) warning. What makes this tricky is the fact that a pattern starting and ending with a slash is legitimate -- it is possible, if somewhat unlikely, that a user <em>may want actual <code>/</code>'s in their pattern</em>.  So you can only ask, or raise a warning, not abort.</p>\n\n<p>Note that with a pattern given in a variable, or with an expression yielding a pattern at runtime, the explicit match operator and delimiters aren't needed for matching; the variable or the expression's return is taken as a search pattern and used for matching.   See <a href=\"https://perldoc.perl.org/perlre.html#The-Basics\" rel=\"nofollow noreferrer\">The basics (perlre)</a> and <a href=\"https://perldoc.perl.org/perlop.html#Binding-Operators\" rel=\"nofollow noreferrer\">Binding Operators (perlop)</a>.  </p>\n\n<p>So you can do simply <code>$name =~ $pattern</code>. Of course <code>$name =~ /$pattern/</code> is fine as well, where you can then give global modifiers after the closing <code>/</code></p>\n"}, {"tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": false, "score": 2, "last_activity_date": 1572635754, "creation_date": 1572635754, "answer_id": 58664691, "question_id": 58663971, "link": "https://stackoverflow.com/questions/58663971/how-to-use-regular-expression-in-perl-if-both-regular-expression-and-strings-are/58664691#58664691", "title": "How to use Regular expression in perl if both regular expression and strings are variables", "body": "<p>The slashes are part of the matching operator <code>m//</code>, not part of the regex.</p>\n\n<p>When I populate the regex from user input</p>\n\n<pre><code>my $pattern = shift;\n</code></pre>\n\n<p>and run the script as</p>\n\n<pre><code>58663971.pl '^current.*$'\n</code></pre>\n\n<p>it matches.</p>\n"}], "owner": {"reputation": 31, "user_id": 1692643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc10cb7dedaf10fec02e2bb253d45f81?s=128&d=identicon&r=PG", "display_name": "ZamanX90", "link": "https://stackoverflow.com/users/1692643/zamanx90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1574358226, "creation_date": 1572632042, "question_id": 58663971, "link": "https://stackoverflow.com/questions/58663971/how-to-use-regular-expression-in-perl-if-both-regular-expression-and-strings-are", "title": "How to use Regular expression in perl if both regular expression and strings are variables", "body": "<p>I have two variables coming from some user inputs. One is a string that needs to be checked and other one is a regular expression as below.</p>\n\n<p>Following code doesn't work.</p>\n\n<pre><code>my $pattern = \"/^current.*$/\";\nmy $name = \"currentStateVector\";\n\nif($name =~ $pattern) {\n    print \"matches \\n\";\n} else {\n    print \"doesn't match \\n\";\n}\n</code></pre>\n\n<p>And following does.</p>\n\n<pre><code>if($name =~ /^current.*$/) {\n    print \"matches \\n\";\n} else {\n    print \"doesn't match \\n\";\n}\n</code></pre>\n\n<p>What's the reason for this. I've the regular expression stored in a variable. Is there another way to store this variable or modify it?</p>\n"}, {"tags": ["perl", "perl-pod", "metacpan"], "comments": [{"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1572618334, "post_id": 58660214, "comment_id": 103624915, "body": "<code>https:&#47;&#47;metacpan.org&#47;release&#47;App-TimeTracker&#47;source&#47;bin&#47;trac&zwnj;&#8203;ker</code> maybe?"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1572618676, "post_id": 58660214, "comment_id": 103625065, "body": "Hi @choroba, thanks for the suggestion, but it <a href=\"https://metacpan.org/release/App-TimeTracker/source/bin/tracker\" rel=\"nofollow noreferrer\">shows</a> the source code of the script not the Pod documentation"}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 1, "creation_date": 1572619100, "post_id": 58660214, "comment_id": 103625238, "body": "So <a href=\"https://metacpan.org/pod/distribution/App-TimeTracker/bin/tracker\" rel=\"nofollow noreferrer\">metacpan.org/pod/distribution/App-TimeTracker/bin/tracker</a> ?"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1572619939, "post_id": 58660214, "comment_id": 103625606, "body": "@choroba Yes this works I think :)"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1572631402, "post_id": 58660214, "comment_id": 103630932, "body": "1) If you&#39;re linking within a distribution, you <i>should</i> be linking to a specific version. It makes no sense for the local documentation to be for a different version than the one installed. 2) This is an XY problem. The real problem is the creation of two pods with the same name. Fix that, and continue using <code>L&lt;tracker&gt;</code>."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572632040, "post_id": 58660214, "comment_id": 103631172, "body": "@ikegami Thanks for the comment. I am not sure I understand: <i>&quot;The real problem is the creation of two pods with the same name&quot;</i> which two pods did you mean?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1572632559, "post_id": 58660214, "comment_id": 103631407, "body": "<a href=\"https://i.stack.imgur.com/u6iT6.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/u6iT6.png</a> If only the second doc existed, surely it would link to it?"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572633885, "post_id": 58660214, "comment_id": 103631859, "body": "@ikegami Yes, but why did the two files get the same pod name? These two files: <a href=\"https://metacpan.org/source/DOMM/App-TimeTracker-3.001/bin/tracker\" rel=\"nofollow noreferrer\">tracker</a> and <a href=\"https://metacpan.org/source/DOMM/App-TimeTracker-3.001/bin/tracker_bash_autocomplete\" rel=\"nofollow noreferrer\">tracker_bash_autocomplete</a>. Is it a bug in metacpan.org or in the source distribution?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572637574, "post_id": 58660214, "comment_id": 103633219, "body": "I&quot;m not sure why there are two. I looked a little bit earlier, but nothing jumped out at me."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1572631505, "post_id": 58661479, "comment_id": 103630978, "body": "This makes no sense! Don&#39;t make the local documentation point to something other than the local version. It&#39;s bad enough that you require switching from <code>man</code>/<code>perldoc</code> to a web browser; at least link to the right version."}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572635433, "post_id": 58661479, "comment_id": 103632434, "body": "@ikegami: Links don&#39;t work in my local version of <code>man</code> / <code>perldoc</code>."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572643842, "post_id": 58661479, "comment_id": 103635234, "body": "I have to agree with @ikegami - MetaCPAN has logic to link within the same release of the distribution, but using the full &quot;versionless&quot; link bypasses this ability and will cause the reader to unexpectedly jump versions."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572644272, "post_id": 58661479, "comment_id": 103635367, "body": "@choroba, Which brings up an even bigger problem: <code>man tracker</code> and <code>perldoc tracker</code> bring  up the wrong page. This is particularly bad because you see a link named &quot;tracker&quot;."}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 3, "last_activity_date": 1572620744, "creation_date": 1572620744, "answer_id": 58661479, "question_id": 58660214, "link": "https://stackoverflow.com/questions/58660214/how-to-make-a-pod-link-from-a-module-to-a-script-within-the-same-distribution/58661479#58661479", "title": "How to make a Pod link from a module to a script within the same distribution?", "body": "<p>Use the full path without the version number: <a href=\"https://metacpan.org/pod/distribution/App-TimeTracker/bin/tracker\" rel=\"nofollow noreferrer\"><code>https://metacpan.org/pod/distribution/App-TimeTracker/bin/tracker</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572644114, "post_id": 58666119, "comment_id": 103635324, "body": "So spaces are not allowed in the string before the hyphen?"}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1572644248, "post_id": 58666119, "comment_id": 103635359, "body": "It&#39;s not specifically documented by perlpodstyle or man(7) but I believe this is the case (for each single program). Programs are separated by both a comma and a space."}], "tags": [], "owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "is_accepted": false, "score": 2, "last_activity_date": 1572643698, "creation_date": 1572643698, "answer_id": 58666119, "question_id": 58660214, "link": "https://stackoverflow.com/questions/58660214/how-to-make-a-pod-link-from-a-module-to-a-script-within-the-same-distribution/58666119#58666119", "title": "How to make a Pod link from a module to a script within the same distribution?", "body": "<p>The problem is that tracker_bash_autocomplete is not being indexed correctly as documentation by MetaCPAN. The <code>NAME</code> section has a very specific format based on manpages which must be adhered to for MetaCPAN to know how to link to your documentation. Putting <code>tracker bash autocomplete</code> before the hyphen makes MetaCPAN index it as <code>tracker</code>.</p>\n\n<pre><code>=head1 NAME\n\ntracker_bash_autocomplete - whatever\n</code></pre>\n"}], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58661479, "answer_count": 2, "score": 1, "last_activity_date": 1609686240, "creation_date": 1572615629, "last_edit_date": 1609686240, "question_id": 58660214, "link": "https://stackoverflow.com/questions/58660214/how-to-make-a-pod-link-from-a-module-to-a-script-within-the-same-distribution", "title": "How to make a Pod link from a module to a script within the same distribution?", "body": "<p>Consider this module <a href=\"https://metacpan.org/pod/App::TimeTracker\" rel=\"nofollow noreferrer\">App::TimeTracker</a>. If you click on the <code>tracker</code> link in the <code>SYNOPSIS</code> section you end up <a href=\"https://metacpan.org/pod/distribution/App-TimeTracker/bin/tracker_bash_autocomplete\" rel=\"nofollow noreferrer\">here</a> whereas you should have ended up <a href=\"https://metacpan.org/pod/release/DOMM/App-TimeTracker-3.000/bin/tracker\" rel=\"nofollow noreferrer\">here</a>. The Pod source code responsible for the behavior is given <a href=\"https://metacpan.org/release/App-TimeTracker/source/lib/App/TimeTracker.pm#L314\" rel=\"nofollow noreferrer\">here</a>, which shows that the following Pod formatting code was used:</p>\n\n<pre><code>L&lt;tracker&gt;\n</code></pre>\n\n<p>I can fix the problem by providing an absolute link instead:</p>\n\n<pre><code>L&lt;tracker|https://metacpan.org/pod/release/DOMM/App-TimeTracker-3.000/bin/tracker&gt;\n</code></pre>\n\n<p>but this fixes the link to version 3.000 which may change in the future. </p>\n\n<p>So how should this be done in general?</p>\n"}, {"tags": ["javascript", "jquery", "html", "perl", "selenium-webdriver"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12307218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lNunpff_wXg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCComAe99jwTQUqPLiJ8iq7pKmQg/photo.jpg?sz=128", "display_name": "Manicks", "link": "https://stackoverflow.com/users/12307218/manicks"}, "edited": false, "score": 0, "creation_date": 1572773455, "post_id": 58665454, "comment_id": 103657930, "body": "Thanks for the answer. The issue was not related to firefox,but using <code>find_element_by_name</code>. Now I&#39;m able to progress to the next screen."}], "tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": true, "score": 0, "last_activity_date": 1572639768, "creation_date": 1572639768, "answer_id": 58665454, "question_id": 58656687, "link": "https://stackoverflow.com/questions/58656687/using-perl-seleniumremotedriver-for-javascript-that-loads-page-later/58665454#58665454", "title": "Using Perl Selenium::Remote::Driver for Javascript that loads page later", "body": "<p>I tested this with <a href=\"https://metacpan.org/pod/Selenium::Chrome\" rel=\"nofollow noreferrer\">Selenium::Chrome</a> and it seems to work fine:</p>\n\n<pre><code>use strict;\nuse warnings;\nuse Selenium::Chrome;\n# Enter your driver path here. See https://sites.google.com/a/chromium.org/chromedriver/\n#  for download instructions\nmy $driver_path = '/home/hakon/chromedriver/chromedriver';\nmy $driver = Selenium::Chrome-&gt;new( binary =&gt; $driver_path );\n$driver-&gt;get(\"https://strade.sharekhan.com/\");\n$driver-&gt;find_element_by_name('emailLoginId')-&gt;send_keys(\"abcdefg\");\nsleep 45;\n</code></pre>\n\n<p>Screen shot taken while sleeping (see last line in code above):</p>\n\n<p><a href=\"https://i.stack.imgur.com/JmupJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JmupJ.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 12307218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lNunpff_wXg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCComAe99jwTQUqPLiJ8iq7pKmQg/photo.jpg?sz=128", "display_name": "Manicks", "link": "https://stackoverflow.com/users/12307218/manicks"}, "edited": false, "score": 0, "creation_date": 1572773657, "post_id": 58666302, "comment_id": 103657960, "body": "Thanks for the code. I have <code>$driver-&gt;pause(1000)</code> and <code>sleep(2)</code> during/before clicking."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 13, "user_id": 12307218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lNunpff_wXg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCComAe99jwTQUqPLiJ8iq7pKmQg/photo.jpg?sz=128", "display_name": "Manicks", "link": "https://stackoverflow.com/users/12307218/manicks"}, "edited": false, "score": 0, "creation_date": 1572792672, "post_id": 58666302, "comment_id": 103662269, "body": "That&#39;s just an inefficient version of what I posted. It always waits the full 2 s, whereas mine only waits as long as needed (with a configurable granularity I set to 100 ms)."}, {"owner": {"reputation": 13, "user_id": 12307218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lNunpff_wXg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCComAe99jwTQUqPLiJ8iq7pKmQg/photo.jpg?sz=128", "display_name": "Manicks", "link": "https://stackoverflow.com/users/12307218/manicks"}, "edited": false, "score": 0, "creation_date": 1572814419, "post_id": 58666302, "comment_id": 103668313, "body": "Yeah,I get that. But as of now,I&#39;m running on a Windows laptop &amp; would prefer to reduce CPU usage/number of system calls."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 13, "user_id": 12307218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lNunpff_wXg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCComAe99jwTQUqPLiJ8iq7pKmQg/photo.jpg?sz=128", "display_name": "Manicks", "link": "https://stackoverflow.com/users/12307218/manicks"}, "edited": false, "score": 0, "creation_date": 1572815751, "post_id": 58666302, "comment_id": 103668613, "body": "If your running of of battery, then I guess. But 100 ms is an eternity for a computer"}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 1, "last_activity_date": 1572792616, "last_edit_date": 1572792616, "creation_date": 1572645027, "answer_id": 58666302, "question_id": 58656687, "link": "https://stackoverflow.com/questions/58656687/using-perl-seleniumremotedriver-for-javascript-that-loads-page-later/58666302#58666302", "title": "Using Perl Selenium::Remote::Driver for Javascript that loads page later", "body": "<p>You can always wait for it to show up.</p>\n\n<p>The following was written for Selenium::Chrome, but it demonstrates a portable principle.</p>\n\n<pre><code>use constant POLL_INTERVAL =&gt; 0.1;\n\nuse Time::HiRes qw( sleep time );\n\nsub wait_for {\n   my ($xpath, $max_wait) = @_;\n   my $wait_until = time() + $max_wait;\n   while (1) {\n      if ( my $nodes = nf_find_elements($xpath) ) {\n         return wantarray ? @$nodes : $nodes-&gt;[0];\n      }\n\n      my $time_left = $wait_until -  time();\n      return () if $time_left &lt;= 0;\n\n      sleep(min($time_left, POLL_INTERVAL));\n   }\n}\n\n\n# Version of `find_elements` that doesn't die (non-fatal) when the element isn't found.\nsub nf_find_elements {\n   my $nodes;\n   if (!eval {\n      $nodes = $web_driver-&gt;find_elements(@_);\n      return 1;  # No exception.\n   }) {\n      return undef if $@ =~ /Unable to locate element|An element could not be located on the page using the given search parameters/;\n      die($@);\n   }\n\n   return wantarray ? @$nodes : $nodes;\n}\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>my $node = wait_for('//some/path', 4.0)   # Wait up to 4s\n   or die(\"Login was unsuccessful.\\n\");\n</code></pre>\n\n<hr>\n\n<p>Time::HiRes's <code>sleep</code> doesn't get interrupted by signals, so I used the following to make my Ctrl-C handler responsive:</p>\n\n<pre><code>use Time::HiRes qw( );\n\nuse constant SLEEP_INTERVAL =&gt; 0.1;\n\n# Hi-res sleep that gives signal handlers a chance to run.\nuse subs qw( sleep );\nsub sleep {\n   if (!$_[0]) {\n      Time::HiRes::sleep(SLEEP_INTERVAL) while 1;\n      return;  # Never reached.\n   }\n\n   my $sleep_until = time() + $_[0];\n   while (1) {\n      my $time_left = $sleep_until - Time::HiRes::time();\n      return if $time_left &lt;= 0;\n\n      Time::HiRes::sleep(min($time_left, SLEEP_INTERVAL));\n   }\n}\n</code></pre>\n\n<p>Make sure not to import <code>sleep</code> from Time::HiRes.</p>\n"}], "owner": {"reputation": 13, "user_id": 12307218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lNunpff_wXg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCComAe99jwTQUqPLiJ8iq7pKmQg/photo.jpg?sz=128", "display_name": "Manicks", "link": "https://stackoverflow.com/users/12307218/manicks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 58665454, "answer_count": 2, "score": 1, "last_activity_date": 1572792616, "creation_date": 1572599653, "question_id": 58656687, "link": "https://stackoverflow.com/questions/58656687/using-perl-seleniumremotedriver-for-javascript-that-loads-page-later", "title": "Using Perl Selenium::Remote::Driver for Javascript that loads page later", "body": "<p>I'm trying to automate login into \n<a href=\"https://strade.sharekhan.com\" rel=\"nofollow noreferrer\">https://strade.sharekhan.com</a></p>\n\n<pre><code>my $driver = Selenium::Remote::Driver-&gt;new;\n$driver-&gt;get(\"https://strade.sharekhan.com/\");\n</code></pre>\n\n<p>I'm able to successfully open the firefox browser and fetch the page.\nBut the input elements aren't visible.</p>\n\n<pre><code>my $page_source = $driver-&gt;get_page_source();\n\n$driver-&gt;find_element('emailLoginId')-&gt;send_keys(\"abcdefg\");\n</code></pre>\n\n<p>The login section seems to be inside a separate class item,whose html source appears in the browser debugger,but when trying via selenium,the class item is empty.\nI only know basic Javascript/jQuery... kindly help me out,what is it that I'm missing</p>\n\n<pre><code>my $login_element = $driver-&gt;find_element_by_class('loginresponsive');\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5749114"}, "reply_to_user": {"reputation": 45481, "user_id": 197758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628da6ba2a6c70e35c009b7e3c3a430a?s=128&d=identicon&r=PG", "display_name": "toolic", "link": "https://stackoverflow.com/users/197758/toolic"}, "edited": false, "score": 0, "creation_date": 1572565978, "post_id": 58652431, "comment_id": 103609724, "body": "So how will that change each line of perl script inside the text file? How to make it all run at one time?"}, {"owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1572568587, "post_id": 58652431, "comment_id": 103610214, "body": "I don&#39;t know CYGWIN but you can probably run <code>bash YOURTEXTFILE</code>"}, {"owner": {"reputation": 360, "user_id": 9696928, "user_type": "registered", "profile_image": "https://graph.facebook.com/565264017190206/picture?type=large", "display_name": "Mobrine Hayde", "link": "https://stackoverflow.com/users/9696928/mobrine-hayde"}, "edited": false, "score": 0, "creation_date": 1572570649, "post_id": 58652431, "comment_id": 103610581, "body": "Are you sure you want to launch all scripts at one go? that would use all the memory if the list is too big"}, {"owner": {"reputation": 360, "user_id": 9696928, "user_type": "registered", "profile_image": "https://graph.facebook.com/565264017190206/picture?type=large", "display_name": "Mobrine Hayde", "link": "https://stackoverflow.com/users/9696928/mobrine-hayde"}, "edited": false, "score": 0, "creation_date": 1572570816, "post_id": 58652431, "comment_id": 103610625, "body": "If you want to launch multiple tasks using threads at one time you can use <code>Thread::Semaphore</code> it is pretty simple : <a href=\"https://metacpan.org/pod/Thread::Semaphore\" rel=\"nofollow noreferrer\">metacpan.org/pod/Thread::Semaphore</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3051, "user_id": 6237339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e4c4dd2523d09028942a397df378237?s=128&d=identicon&r=PG&f=1", "display_name": "Skeeve", "link": "https://stackoverflow.com/users/6237339/skeeve"}, "is_accepted": true, "score": 3, "last_activity_date": 1572596755, "last_edit_date": 1572596755, "creation_date": 1572596367, "answer_id": 58656093, "question_id": 58652431, "link": "https://stackoverflow.com/questions/58652431/running-perl-files-from-a-text-file/58656093#58656093", "title": "Running perl files from a text file", "body": "<ol>\n<li>Put them into a file <code>makeall</code> (or whatever you want to call it.</li>\n<li>Put as a first line <code>#!/bin/bash</code> into the file</li>\n<li>In cygwin enter <code>chmod +x makeall</code></li>\n<li>in cygwin enter <code>./makeall</code></li>\n</ol>\n\n<p>With this you've created a bash script which'll do all your calls of the perl script.</p>\n\n<p>Another option would to just put all the user information into a csv file and read that one in order to call your script.</p>\n\n<p>WAIT! Even easier!</p>\n\n<p>Put into the <code>makeall</code> script this:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/bin/bash\nfor user in \\\n        JSmith \\\n        PTesk \\\n        CMorris \\\n        JLawrence \\\n        TCruise \\\n; do\n        perl IdGeneratorTool.pl \"$user\" -i userInfo.adb -o \"$user\".txt\ndone\n</code></pre>\n\n<p>Now you just need to add any additional user the same way I did for your examples.</p>\n"}, {"tags": [], "owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "is_accepted": false, "score": 0, "last_activity_date": 1572598649, "creation_date": 1572598649, "answer_id": 58656483, "question_id": 58652431, "link": "https://stackoverflow.com/questions/58652431/running-perl-files-from-a-text-file/58656483#58656483", "title": "Running perl files from a text file", "body": "<p>Without seeing the source for <code>IdGeneratorTool.pl</code> it's hard to give any specific advice; but it is generally not hard to turn something like</p>\n\n<pre><code>do_stuff($ARGV[0], $opt_i, $opt_o);\n</code></pre>\n\n<p>into</p>\n\n<pre><code>while (&lt;&gt;) {\n    chomp;\n    $user, $adb, $outputfile = split('\\t');\n    do_stuff($user, $adb, $outputfile);\n}\n</code></pre>\n\n<p>to read the input from a tab-delimited file instead of from command-line arguments.</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1572734804, "last_edit_date": 1572734804, "creation_date": 1572727386, "answer_id": 58675127, "question_id": 58652431, "link": "https://stackoverflow.com/questions/58652431/running-perl-files-from-a-text-file/58675127#58675127", "title": "Running perl files from a text file", "body": "<p>You can create text file with list of users (one per line) for example <strong>user_list.txt</strong></p>\n\n<pre><code>JSmith\nPTesk\nCMorris\nJLawrence\nTCruise\n</code></pre>\n\n<p>Then create bash script <strong>process_list.sh</strong> with following content in same directory</p>\n\n<pre><code>#!/bin/bash\n\nfor user in `cat user_list.txt`\ndo\n    perl IdGeneratorTool.pl $user -i userInfo.adb -o ${user}.txt\ndone\n</code></pre>\n\n<p>Now make bash script executable <code>chmod +x process_list.sh</code> and it is ready for execution.</p>\n\n<p>Once you need to add new user edit <strong>user_list.txt</strong> to add one more line into the file.</p>\n\n<p>Polar Bear</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5749114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 58656093, "answer_count": 3, "score": -1, "last_activity_date": 1572734804, "creation_date": 1572564947, "question_id": 58652431, "link": "https://stackoverflow.com/questions/58652431/running-perl-files-from-a-text-file", "title": "Running perl files from a text file", "body": "<p>There're multiple perl scripts that is ran from CYGWIN terminal. An example is,</p>\n\n<pre><code>$ perl IdGeneratorTool.pl JSmith -i userInfo.adb -o JSmith.txt\n</code></pre>\n\n<p>The above is an example. Were based on input parameter <strong><em>JSmith</em></strong>, it reads a db file, generate an ID and output that to a text file.</p>\n\n<p>Now these perl scripts running on the CYGWIN keeps growing and it's added to a text file like shown below,</p>\n\n<pre><code>$ perl IdGeneratorTool.pl JSmith -i userInfo.adb -o JSmith.txt\n$ perl IdGeneratorTool.pl PTesk -i userInfo.adb -o PTesk.txt\n$ perl IdGeneratorTool.pl CMorris -i userInfo.adb -o CMorris.txt\n$ perl IdGeneratorTool.pl JLawrence -i userInfo.adb -o JLawrence.txt\n$ perl IdGeneratorTool.pl TCruise -i userInfo.adb -o TCruise.txt\n...\n....\n......\n.......\n.........\n</code></pre>\n\n<p>And the list keeps growing.</p>\n\n<p>I would like to know whether there's a way to execute all these perl scripts which are in a text file in one go.</p>\n\n<p>I'm new to perl and doesn't have much idea as to what are the options.</p>\n\n<p>An ideal scenario might be, a tool where i can open this text file and click a <strong>execute</strong> button and then it executes all the scripts and output multiple *.txt files into the same directory.</p>\n\n<p>Or maybe a simple perl script that can do it. </p>\n"}, {"tags": ["windows", "perl", "cmd", "colors", "windows-console"], "comments": [{"owner": {"reputation": 4590, "user_id": 3120884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/116656a5f0b09d1a524808706d709d9c?s=128&d=identicon&r=PG&f=1", "display_name": "stevesliva", "link": "https://stackoverflow.com/users/3120884/stevesliva"}, "edited": false, "score": 0, "creation_date": 1572534845, "post_id": 58646054, "comment_id": 103597789, "body": "If you put the heredoc end string in double quotes, I believe you&#39;ll get variable expansion that&#39;s not happening now. ie <code>&lt;&lt;&quot;PRINT_HELP&quot;</code> is functionally different than what you have now."}, {"owner": {"reputation": 43, "user_id": 12303569, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FtOuWe3yWRA/AAAAAAAAAAI/AAAAAAACULA/KnjdQXmpJ-o/photo.jpg?sz=128", "display_name": "RG boomer", "link": "https://stackoverflow.com/users/12303569/rg-boomer"}, "reply_to_user": {"reputation": 4590, "user_id": 3120884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/116656a5f0b09d1a524808706d709d9c?s=128&d=identicon&r=PG&f=1", "display_name": "stevesliva", "link": "https://stackoverflow.com/users/3120884/stevesliva"}, "edited": false, "score": 2, "creation_date": 1572536659, "post_id": 58646054, "comment_id": 103598776, "body": "Unfortunately it appears that having the heredoc in quotes does not affect functionality in this case. Variable expansion was already occurring in the heredoc, it is just the subroutines are all executing before anything prints out. Since the color changes are being made at the time of the function call, rather than printing out a special character, all the changes are made before any of the text gets printed."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12303569, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FtOuWe3yWRA/AAAAAAAAAAI/AAAAAAACULA/KnjdQXmpJ-o/photo.jpg?sz=128", "display_name": "RG boomer", "link": "https://stackoverflow.com/users/12303569/rg-boomer"}, "edited": false, "score": 0, "creation_date": 1572876231, "post_id": 58662713, "comment_id": 103686636, "body": "This solution does have some pitfalls, IE: you need to put spaces on the end of the line if the next line starts with a variable, and you need spaces after variables, but doing something similar, except splitting on curly braces may work better. Thanks for a solution!"}], "tags": [], "owner": {"reputation": 4590, "user_id": 3120884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/116656a5f0b09d1a524808706d709d9c?s=128&d=identicon&r=PG&f=1", "display_name": "stevesliva", "link": "https://stackoverflow.com/users/3120884/stevesliva"}, "is_accepted": false, "score": 2, "last_activity_date": 1572637098, "last_edit_date": 1572637098, "creation_date": 1572625967, "answer_id": 58662713, "question_id": 58646054, "link": "https://stackoverflow.com/questions/58646054/coloring-perl-output-on-windows-command-prompt/58662713#58662713", "title": "Coloring Perl output on windows command prompt", "body": "<p>This sort of hack might be along the lines of what you need.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse warnings;\nuse strict;\n\nmy $alice = sub  { return 'ALICE'; };\n\nmy $bob = sub { return 'BOB'; };\n\nmy $test = &lt;&lt;'ENDTEST';\nlineone\nline2 ${\\$alice-&gt;()} endline\nline3 startline ${\\$bob-&gt;()}\nlinefour\nlinefive\nENDTEST\n\n# Add spaces around newline, split on horizontal whitespace\n$test =~ s/\\n/ \\n /g;\nmy @testtokens = split /\\h/, $test;\n\n# Print '%s ' for each of the testtokens\n# Print newlines, evaluate all testtokens beginning with '$', otherwise print\nmap { /\\n/ ? print : printf '%s ', /^\\$/ ? eval $_ : $_} @testtokens;\n</code></pre>\n\n<p>Takes the ENDTEST heredoc and prints this on the last line:</p>\n\n<pre><code>$ heretest.pl\nlineone \nline2 ALICE endline \nline3 startline BOB \nlinefour \nlinefive \n</code></pre>\n\n<p><em>Maybe</em> that will evaluate things in order.</p>\n"}, {"comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572769439, "post_id": 58664649, "comment_id": 103657239, "body": "Out of curiosity, what is the purpose of the <code>::</code> at the end of <code>our @ISA = My::Console::Base::</code> ? Why not just <code>our @ISA = My::Console::Base</code>?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572769668, "post_id": 58664649, "comment_id": 103657279, "body": "@H&#229;konH&#230;gland That&#39;s not valid Perl (unless strict is turned off)"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572773951, "post_id": 58664649, "comment_id": 103658006, "body": "Hmm.. according to <a href=\"https://perldoc.perl.org/perlobj.html\" rel=\"nofollow noreferrer\">perlbobj</a> it should be valid? Also <a href=\"https://perldoc.perl.org/perlmod.html#Symbol-Tables\" rel=\"nofollow noreferrer\">perlmod</a> mentions symbol tables that are stored in hashes with the same name as the package with two colons appended. But it does not mention that these hashes are to be used in <code>@ISA</code>. Also I could not find any examples on google that uses <code>@ISA</code> in that way... Am I missing something?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572794294, "post_id": 58664649, "comment_id": 103662692, "body": "@H&#229;kon H&#230;gland, I don&#39;t see why you think any of that is relevant, or why you think package names are valid expressions, but <a href=\"https://stackoverflow.com/q/58263206/589924\">they&#39;re not</a>. Just like <code>my $x = foo;</code> is generally an error under strict, so is my <code>$x = Foo::Bar;</code>. (<code>My::Console::Base</code> would be valid if it named a sub, but that would be produce the wrong result since we&#39;re trying to produce the string <code>My::Console::Base</code>.)"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572816215, "post_id": 58664649, "comment_id": 103668727, "body": "Sorry that was a typo. I agree, I meant <code>our @ISA = qw(My::Console::Base)</code> not <code>our @ISA = My::Console::Base</code>."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1572816325, "post_id": 58664649, "comment_id": 103668753, "body": "@H&#229;kon H&#230;gland, The way I used is shorter, and will warn if you provide a non-existing package. It is otherwise equivalent (returns the string <code>My::Console::Base</code>)."}, {"owner": {"reputation": 43, "user_id": 12303569, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FtOuWe3yWRA/AAAAAAAAAAI/AAAAAAACULA/KnjdQXmpJ-o/photo.jpg?sz=128", "display_name": "RG boomer", "link": "https://stackoverflow.com/users/12303569/rg-boomer"}, "edited": false, "score": 0, "creation_date": 1572875859, "post_id": 58664649, "comment_id": 103686477, "body": "@ikegami Although your solution is elegant and works well, I am looking for  a standalone script implementation for my usage case. Thank you for the great answer though!"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572902436, "post_id": 58664649, "comment_id": 103698293, "body": "It&#39;s already setup to look for module in the same directory as the script. But you could always inline the modules. You would have to make some changes to avoid loading Win32::Console on non-Windows machines, though. The reason I wrote the code i did was to avoid such problems"}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 2, "last_activity_date": 1572637330, "last_edit_date": 1572637330, "creation_date": 1572635562, "answer_id": 58664649, "question_id": 58646054, "link": "https://stackoverflow.com/questions/58646054/coloring-perl-output-on-windows-command-prompt/58664649#58664649", "title": "Coloring Perl output on windows command prompt", "body": "<p>You are calling <code>red</code>, <code>reset</code>, <code>blue</code> and <code>reset</code> before you even start printing. You could use a template. Here's a robust implementation:</p>\n\n<pre><code>use FindBin qw( $RealBin );\nuse lib \"$RealBin/lib\";\n\nuse My::Console qw( );\n\nmy $console = My::Console-&gt;new;\n\nmy $print_help = &lt;&lt;'__END_OF_HELP__';\nUsage:  $toolname [-Options] [-fields name1,[name2],...]\n{{red}}toolname version VERSION{{reset}}\n{{blue}}options:{{reset}}\n\n__END_OF_HELP__\n\n$console-&gt;print_with_color($print_help);\n</code></pre>\n\n<p><code>lib/My/Console.pm</code>:</p>\n\n<pre><code>package My::Console;\n\nuse strict;\nuse warnings;\n\nmy $console;\nBEGIN {\n   if (!-t STDOUT) {\n      require My::Console::Dumb;\n      $console = My::Console::Dumb::;\n   }\n   elsif ($^O eq 'Win32') {\n      require My::Console::Win32;\n      $console = My::Console::Win32::;\n   }\n   else {\n      require My::Console::ANSI;\n      $console = My::Console::ANSI::;\n   }\n}\n\nsub new { $console }\n\n1;\n</code></pre>\n\n<p><code>lib/My/Console/Base.pm</code>:</p>\n\n<pre><code>package My::Console::Base;\n\nuse strict;\nuse warnings;\n\nuse Carp qw( croak );\n\nmy %allowed_cmds = map { $_ =&gt; 1 } qw( red blue reset );\n\nsub red   { }\nsub blue  { }\nsub reset { }\n\nsub print { print(STDOUT @_); }\n\nsub print_with_color {\n   my $self = shift;\n\n   for (@_) {\n      /\\G ( (?: [^{] | \\{(?!\\{) )+ ) /xgc\n         and $self-&gt;print($1);\n\n      /\\G \\z /xgc\n         and next;\n\n      /\\G \\{\\{ /xgc;\n\n      /\\G ( (?: [^}] | \\}(?!\\}) )* ) \\}\\} /xgc\n         or croak(\"Bad template\");\n\n      my $cmd = $1;\n      if ($cmd eq \"\") {\n         # An escape mechanism. Use \"{{}}\" to output \"{{\".\n         $self-&gt;print(\"{{\");\n         redo;\n      }\n\n      $allowed_cmds{$cmd}\n         or croak(\"Unrecognized command \\\"$cmd\\\"\");\n\n      $self-&gt;$cmd();\n      redo;\n   }\n}\n\n1;\n</code></pre>\n\n<p><code>lib/My/Console/Win32.pm</code>:</p>\n\n<pre><code>package My::Console::Win32;\n\nuse strict;\nuse warnings;\n\nuse My::Console::Base qw( );\nuse Win32::Console;\n\nour @ISA = My::Console::Base::;\n\nmy $CONSOLE = Win32::Console-&gt;new(STD_OUTPUT_HANDLE);\nmy $initial_console_attr = $CONSOLE-&gt;Attr();\n\nsub red   { STDOUT-&gt;flush; $CONSOLE-&gt;Attr($FG_RED); }\nsub blue  { STDOUT-&gt;flush; $CONSOLE-&gt;Attr($FG_BLUE); }\nsub reset { STDOUT-&gt;flush; $CONSOLE-&gt;Attr($initial_console_attr); }\n\n1;\n</code></pre>\n\n<p><code>lib/My/Console/ANSI.pm</code>:</p>\n\n<pre><code>package My::Console::ANSI;\n\nuse strict;\nuse warnings;\n\nuse My::Console::Base qw( );\nuse Term::ANSIColor   qw( );\n\nour @ISA = My::Console::Base::;\n\nsub red   { print(Term::ANSIColor::red()); }\nsub blue  { print(Term::ANSIColor::blue()); }\nsub reset { print(Term::ANSIColor::reset()); }\n\n1;\n</code></pre>\n\n<p><code>lib/My/Console/Dumb.pm</code>:</p>\n\n<pre><code>package My::Console::Dumb;\n\nuse strict;\nuse warnings;\n\nuse My::Console::Base qw( );\n\nour @ISA = My::Console::Base::;\n\n1;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 12303569, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FtOuWe3yWRA/AAAAAAAAAAI/AAAAAAACULA/KnjdQXmpJ-o/photo.jpg?sz=128", "display_name": "RG boomer", "link": "https://stackoverflow.com/users/12303569/rg-boomer"}, "edited": false, "score": 0, "creation_date": 1572886189, "post_id": 58676261, "comment_id": 103691882, "body": "so far as I can tell, POD would probably work for this, but I have not worked with it before. I&#39;ll look into it, thanks~"}], "tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 0, "last_activity_date": 1572738357, "creation_date": 1572738357, "answer_id": 58676261, "question_id": 58646054, "link": "https://stackoverflow.com/questions/58646054/coloring-perl-output-on-windows-command-prompt/58676261#58676261", "title": "Coloring Perl output on windows command prompt", "body": "<p>my console does not support colors but I can see ESCAPE codes which on console which supports colors should work. I do wonder if it works for you?</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse Term::ANSIColor;\nuse Win32::Console;\n\nif (!(-f STDOUT)) {\n    if ($^O =~ /win/) {\n        our $FG_BLUE;\n        our $FG_YELLOW;\n        our $FG_RED;\n        our $BG_GREEN;\n        my $CONSOLE = Win32::Console-&gt;new(STD_OUTPUT_HANDLE);\n        my $attr = $CONSOLE-&gt;Attr(); # Get current console colors\n        $blue   = sub {$CONSOLE-&gt;Attr($FG_BLUE);return};\n        $reset  = sub {$CONSOLE-&gt;Attr($attr);return};\n        $yellow = sub {$CONSOLE-&gt;Attr($FG_YELLOW);return};\n        $red    = sub {$CONSOLE-&gt;Attr($FG_RED);return};\n    } else {\n        $blue   = sub {return color('bold blue')};\n        $reset  = sub {return color('reset')};\n        $yellow = sub {return color('yellow')};\n        $red    = sub {return color('red')};\n    }\n}\n\nhelp();\n\nsub help {\n    print \n\"\n    Usage:  $toolname [-Options] [-fields name1,[name2],...]\n    ${\\$red-&gt;()} toolname version VERSION ${\\$reset-&gt;()} \n    ${\\$blue-&gt;()} options: ${\\$reset-&gt;()}\n\n\";\n}\n</code></pre>\n\n<p>Question: why do not use <a href=\"https://perldoc.perl.org/perlpod.html\" rel=\"nofollow noreferrer\">POD</a> for this purpose?</p>\n"}], "owner": {"reputation": 43, "user_id": 12303569, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FtOuWe3yWRA/AAAAAAAAAAI/AAAAAAACULA/KnjdQXmpJ-o/photo.jpg?sz=128", "display_name": "RG boomer", "link": "https://stackoverflow.com/users/12303569/rg-boomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 58664649, "answer_count": 3, "score": 3, "last_activity_date": 1572738357, "creation_date": 1572533716, "question_id": 58646054, "link": "https://stackoverflow.com/questions/58646054/coloring-perl-output-on-windows-command-prompt", "title": "Coloring Perl output on windows command prompt", "body": "<p>This question is related to the question:\n<a href=\"https://stackoverflow.com/questions/1087248/how-do-i-color-output-text-from-perl-script-on-windows/58645659#58645659\">How do I color output text from Perl script on Windows?</a></p>\n\n<p>But is a bit more specific. I have gotten cross-platform colorization working, to some extent:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use Term::ANSIColor;\nuse Win32::Console;\n\nif (!(-f STDOUT)) {\n    if ($^O =~ /win/) {\n        our $FG_BLUE;\n        our $FG_YELLOW;\n        our $FG_RED;\n        our $BG_GREEN;\n        my $CONSOLE = Win32::Console-&gt;new(STD_OUTPUT_HANDLE);\n        my $attr = $CONSOLE-&gt;Attr(); # Get current console colors\n        $blue   = sub {$CONSOLE-&gt;Attr($FG_BLUE);return};\n        $reset  = sub {$CONSOLE-&gt;Attr($attr);return};\n        $yellow = sub {$CONSOLE-&gt;Attr($FG_YELLOW);return};\n        $red    = sub {$CONSOLE-&gt;Attr($FG_RED);return};\n    } else {\n        $blue   = sub {return color('bold blue')};\n        $reset  = sub {return color('reset')};\n        $yellow = sub {return color('yellow')};\n        $red    = sub {return color('red')};\n    }\n}\n</code></pre>\n\n<p>but The Terminal colors do not change immediately when the functions are called from inside strings, thus:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>    print \"${\\$blue-&gt;()} this is blue\\n\";\n    print \"${\\$blue-&gt;()}This is... not blue${\\$reset-&gt;()}\\n\";\n    print \"this is Blue ${\\$blue-&gt;()}\\n\";\n    print \"this is reset${\\$reset-&gt;()}\\n\";\n</code></pre>\n\n<p>I am wondering if it is possible to do things such as:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>    my $print_help = &lt;&lt;PRINT_HELP;\n    Usage:  $toolname [-Options] [-fields name1,[name2],...]\n    ${\\$red-&gt;()} toolname version VERSION ${\\$reset-&gt;()} \n    ${\\$blue-&gt;()} options: ${\\$reset-&gt;()}\n\n    PRINT_HELP\n\n    print $print_help;\n</code></pre>\n\n<p>prints with no colors. I have tried setting $| = 1 with no luck.</p>\n\n<p>I do not have the option to install Win32::Console::ANSI on the system in question, so I am not able to make any solutions that use that module work.</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 1, "creation_date": 1572533688, "post_id": 58645821, "comment_id": 103597055, "body": "In this example string <code>35AABCS1429B1AX</code>, if you expect GST Number is valid then the A in <code>AX</code> should be a <code>Z</code> because you expect it in <code>Z[A-Z\\d]</code> right?"}, {"owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "edited": false, "score": 0, "creation_date": 1572540105, "post_id": 58645821, "comment_id": 103600538, "body": "You have mentioned <code>The fourteenth digit will be Z by default</code> in your rule and in the variable <code>$gst_number_input = &#39;35AABCS1429B1AX&#39;</code> you have <code>A</code> in fourteenth position."}, {"owner": {"reputation": 133, "user_id": 10500417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lqs2wuzb-tM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVT92HTL5zhuL3XXyhn4btxjojg6A/mo/photo.jpg?sz=128", "display_name": "SaAsh Techs", "link": "https://stackoverflow.com/users/10500417/saash-techs"}, "edited": false, "score": 0, "creation_date": 1572616429, "post_id": 58645821, "comment_id": 103623986, "body": "Thank you and sorry about the blunder"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 10500417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lqs2wuzb-tM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVT92HTL5zhuL3XXyhn4btxjojg6A/mo/photo.jpg?sz=128", "display_name": "SaAsh Techs", "link": "https://stackoverflow.com/users/10500417/saash-techs"}, "edited": false, "score": 0, "creation_date": 1572616443, "post_id": 58651277, "comment_id": 103623994, "body": "Thank you and sorry about the blunder"}], "tags": [], "owner": {"reputation": 2209, "user_id": 88056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4dc48a2044368d6b349c942ef2c4be?s=128&d=identicon&r=PG", "display_name": "Powertieke", "link": "https://stackoverflow.com/users/88056/powertieke"}, "is_accepted": true, "score": 1, "last_activity_date": 1572556725, "creation_date": 1572556725, "answer_id": 58651277, "question_id": 58645821, "link": "https://stackoverflow.com/questions/58645821/gst-validation-through-state-code-in-regex-is-not-working-in-perl/58651277#58651277", "title": "GST Validation through state code in regex is not working in Perl", "body": "<p>You state that the fourteenth character is a 'Z'.</p>\n\n<p>So your code works. The fourteenth character in <code>$gst_number_input</code> is an 'A'.</p>\n\n<p>Change the input code so that your input has a Z in the right spot and you will get <code>GST Number is valid</code>.</p>\n\n<pre><code>my $gst_number_input = '35AABCS1429B1ZX';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "reply_to_user": {"reputation": 133, "user_id": 10500417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lqs2wuzb-tM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVT92HTL5zhuL3XXyhn4btxjojg6A/mo/photo.jpg?sz=128", "display_name": "SaAsh Techs", "link": "https://stackoverflow.com/users/10500417/saash-techs"}, "edited": false, "score": 0, "creation_date": 1572800658, "post_id": 58675838, "comment_id": 103664581, "body": "Technically speaking last two checks are unnecessary as they was done in regex earlier -- but make code more readable and easier to understand. You can expand the code further if it will require to do so to make more checks."}], "tags": [], "owner": {"reputation": 4234, "user_id": 12313309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fPDo.jpg?s=128&g=1", "display_name": "Polar Bear", "link": "https://stackoverflow.com/users/12313309/polar-bear"}, "is_accepted": false, "score": 1, "last_activity_date": 1572733560, "creation_date": 1572733560, "answer_id": 58675838, "question_id": 58645821, "link": "https://stackoverflow.com/questions/58645821/gst-validation-through-state-code-in-regex-is-not-working-in-perl/58675838#58675838", "title": "GST Validation through state code in regex is not working in Perl", "body": "<p>Probably you would prefer to have the check in form of subroutine</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\n\nmy $debug = 0;\n\nmy @gst_numbers = &lt;DATA&gt;;\n\nmy $state_code = 35;\n\nforeach my $gst_number (@gst_numbers) {\n    chomp $gst_number;\n    printf \"%s %s\\n\",\n            $gst_number, \n            validate_gst($gst_number,$state_code) \n            ? \"valid\" : \"invalid\";\n}\n\nsub validate_gst {\n    my $gst_number = shift;\n    my $state_code = shift;\n\n    my %code;\n\n    printf \"%s : %s\\n\", \n            $gst_number, $state_code\n            if $debug;\n\n    my $gst_regex = qr/(\\d{2})([A-Z\\d]{10})(\\d)(Z)([A-Z\\d])/;\n\n    return 0 if length $gst_number &lt; 15;\n\n    if( $gst_number =~ $gst_regex ) {\n        @code{qw(st pan d z x)} = ($1,$2,$3,$4,$5);\n\n        printf \"ST: %s PAN: %s D: %s Z: %s X: %s\\n\", \n                $code{st},  # state code\n                $code{pan}, # PAN number\n                $code{d},   # state reg number\n                $code{z},   # Z\n                $code{x}    # check code\n                if $debug;\n\n        return 0 if $code{st}+0 != $state_code;             # state match?\n        return 0 if $code{pan}  !~ /[A-Z]{5}\\d{4}[A-Z\\d]/;  # PAN correct?\n        return 0 if $code{d}    !~ /\\d/;                    # state reg number?\n        return 0 if $code{z}    !~ /Z/;                     # Z?\n                                                            # check code?\n        return 1;   # check passed\n    } else {\n        return 0;   # check not passed\n    }\n}\n\n__DATA__\n1234567890123Z5\n35AABCS1429B1AX\n121234567890DZD\n37AABCS6428B1AX\n35AABCS2439B1ZX\n42AABCS1429B1AX\n35AABCS1729B1ZX\n</code></pre>\n\n<p>Polar Bear</p>\n"}], "owner": {"reputation": 133, "user_id": 10500417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lqs2wuzb-tM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVT92HTL5zhuL3XXyhn4btxjojg6A/mo/photo.jpg?sz=128", "display_name": "SaAsh Techs", "link": "https://stackoverflow.com/users/10500417/saash-techs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58651277, "answer_count": 2, "score": 0, "last_activity_date": 1572733560, "creation_date": 1572532964, "question_id": 58645821, "link": "https://stackoverflow.com/questions/58645821/gst-validation-through-state-code-in-regex-is-not-working-in-perl", "title": "GST Validation through state code in regex is not working in Perl", "body": "<p>I have written Perl code for validating GSTIN Number through State code selected by customer according to the following rules:</p>\n\n<ul>\n<li><p>The first two digits represent the state code as per Indian Census 2011. Every state has a unique code.</p></li>\n<li><p>The next ten digits will be the PAN number of the taxpayer</p></li>\n<li><p>The thirteenth digit will be assigned based on the number of registration within a state</p></li>\n<li><p>The fourteenth digit will be Z by default</p></li>\n<li><p>The last digit will be for check code. It may be an alphabet or a number.</p></li>\n</ul>\n\n<p>Following is the code:</p>\n\n<pre><code>my $gst_number_input = '35AABCS1429B1AX';\n\nmy $gst_number_character_count = length($gst_number_input);\n\nmy $state_code = '35';\n\nmy $gst_validation = qr/$state_code[A-Z]{5}\\d{4}[A-Z][A-Z\\d]Z[A-Z\\d]/;\n\nif ($gst_number_character_count == 15 &amp;&amp; $gst_number_input =~ $gst_validation) {\n\n    print \"GST Number is valid\";\n\n} else {\n\n    print \"Invalid GST Number\";\n}\n</code></pre>\n\n<p>I have GSTIN input which matches with the state code in the script. So when I run the script, I get:</p>\n\n<p><code>Invalid GST Number</code></p>\n\n<p>Instead I should get:</p>\n\n<p><code>GST Number is valid</code></p>\n\n<p>Can anyone please help ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["python", "perl"], "answers": [{"tags": [], "owner": {"reputation": 64597, "user_id": 1453822, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2c8db97d2ecdfe5e044cee4c470abb60?s=128&d=identicon&r=PG", "display_name": "DeepSpace", "link": "https://stackoverflow.com/users/1453822/deepspace"}, "is_accepted": true, "score": 1, "last_activity_date": 1572530033, "creation_date": 1572530033, "answer_id": 58644859, "question_id": 58644804, "link": "https://stackoverflow.com/questions/58644804/output-from-perl-cli-regex-save-into-file/58644859#58644859", "title": "Output from Perl CLI regex save into file", "body": "<p>Just use an xml parser, your life will be so much easier:</p>\n\n<pre><code>import xml.etree.ElementTree as ET\n\nxml_doc = ET.parse('test-01.kismet.netxml')\n\nfor client_mac_node in xml_doc.iter('client_mac'):\n    print(client_mac_node.text)\n</code></pre>\n\n<p>Outputting to a file is not any harder:</p>\n\n<pre><code>clients_macs = [client_mac_node.text for client_mac_node in xml_doc.iter('client_mac')]\n\nwith open('clients.txt', 'w') as f:\n    f.write('\\n'.join(clients_macs))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12303442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df63b1f7decd43813cc25d600f5e3f9c?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/12303442/john-doe"}, "edited": false, "score": 0, "creation_date": 1572530934, "post_id": 58645054, "comment_id": 103595384, "body": "Thanks for it! A lot!"}], "tags": [], "owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "is_accepted": false, "score": 1, "last_activity_date": 1572530677, "creation_date": 1572530677, "answer_id": 58645054, "question_id": 58644804, "link": "https://stackoverflow.com/questions/58644804/output-from-perl-cli-regex-save-into-file/58645054#58645054", "title": "Output from Perl CLI regex save into file", "body": "<p>OK, you've tagged this as perl, and you've already got a python answer.</p>\n\n<p>So here's how you'd do it with perl: </p>\n\n<pre><code>#!/usr/bin/env perl\n\nuse strict;\nuse warnings;\n\nuse XML::Twig;\n\nmy $xml = XML::Twig -&gt; parsefile ('test-01.kismet.netxml'); \nprint $xml -&gt; get_xpath('//client-mac', 0) -&gt; text; \n</code></pre>\n\n<p>But if you're embedding it in python, whilst I appreciate the cruel irony of 'shelling out' to perl, really you should just stick with Python's parser. </p>\n\n<p>The key point being that XML is contextual, but regular expressions are not. A parser is the tool you should be using. </p>\n"}], "owner": {"reputation": 3, "user_id": 12303442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df63b1f7decd43813cc25d600f5e3f9c?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/12303442/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58644859, "answer_count": 2, "score": 0, "last_activity_date": 1572530677, "creation_date": 1572529806, "question_id": 58644804, "link": "https://stackoverflow.com/questions/58644804/output-from-perl-cli-regex-save-into-file", "title": "Output from Perl CLI regex save into file", "body": "<p>I would like to print output into text file with Python code.</p>\n\n<pre><code>cat test-01.kismet.netxml | perl -ne 'while(m/(?&lt;\\client-mac\\&gt;)(.*)(?=\\&lt;\\/client-mac\\&gt;)/g{print $&amp;; print \"\\n\"})'\n</code></pre>\n\n<p>The ouput is what I want:</p>\n\n<pre><code>FF:FF:FF:FF:FF:FF\nFF:FF:FF:FF:FF:FF\n</code></pre>\n\n<p>I would like to have something like this:</p>\n\n<pre><code>proc = subprocess.Popen([[\"cat\", \"test-01.kismet.netxml\", \"|\", \"perl\", \"-new\", \"'while(m/(?&lt;\\client-mac\\&gt;)(.*)(?=\\&lt;\\/client-mac\\&gt;)/g{print $&amp; &gt; clients.txt; print \"\\n\" &gt; clients.txt})'\"], stdout=subprocess.PIPE, shell=True)\n</code></pre>\n\n<p>But it does not work.</p>\n\n<p>The problem will be in this part:</p>\n\n<pre><code>'while(m/(?&lt;\\client-mac\\&gt;)(.*)(?=\\&lt;\\/client-mac\\&gt;)/g{print $&amp; &gt; clients.txt; print \"\\n\" &gt; clients.txt})'\n</code></pre>\n\n<p>Thanks for any help or any hint!</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "edited": false, "score": 0, "creation_date": 1572528894, "post_id": 58644243, "comment_id": 103594267, "body": "it is nice to refer to another Q&amp;A, but add all details related to current question in this post itself.. for ex: it is not clear why you need to run the script multiple times.. in any case, your given example might work with <code>s&#47;http$&#47;https&#47;</code> so that <code>http</code> is changed only if it is at the end of line"}, {"owner": {"reputation": 481636, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1572530307, "post_id": 58644243, "comment_id": 103595051, "body": "You may use word boundaries in GNU <code>sed</code>: <code>sed &#39;&#47;\\[MARATHON\\]&#47;{N;N;N;s&#47;\\&lt;http\\&gt;&#47;https&#47;;}&#39; </code>"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1572530633, "post_id": 58644243, "comment_id": 103595218, "body": "Added a non-perl answer to your first question."}], "answers": [{"tags": [], "owner": {"reputation": 481636, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 2, "last_activity_date": 1572530610, "creation_date": 1572530610, "answer_id": 58645031, "question_id": 58644243, "link": "https://stackoverflow.com/questions/58644243/edit-match-a-string-n-lines-below-some-specific-match-in-perl/58645031#58645031", "title": "Edit/Match a string n lines below some specific match in Perl?", "body": "<p>If you are using a GNU sed, the solution can be using word boundaries:</p>\n\n<pre><code>sed '/\\[MARATHON\\]/{N;N;N;s/\\&lt;http\\&gt;/https/;}' file \n#                          ^^     ^^\n</code></pre>\n\n<p>You may also leverage context details. As the <code>http</code> is after <code>PROTOCOL</code> you may simply use this to reset the value:</p>\n\n<pre><code>sed '/\\[MARATHON\\]/{N;N;N;s/\\(.*= *\\).*/\\1https/;}' file \n</code></pre>\n\n<p>The <code>\\(.*= *\\).*</code> will match and capture the key with <code>=</code> and optional spaces and its value is restored with <code>\\1</code> while <code>https</code> will always re-write the value.</p>\n"}, {"tags": [], "owner": {"reputation": 7444, "user_id": 967621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zOso6.jpg?s=128&g=1", "display_name": "Timur Shtatland", "link": "https://stackoverflow.com/users/967621/timur-shtatland"}, "is_accepted": false, "score": 2, "last_activity_date": 1572564505, "last_edit_date": 1572564505, "creation_date": 1572544660, "answer_id": 58648927, "question_id": 58644243, "link": "https://stackoverflow.com/questions/58644243/edit-match-a-string-n-lines-below-some-specific-match-in-perl/58648927#58648927", "title": "Edit/Match a string n lines below some specific match in Perl?", "body": "<p>Try this one-liner, which does exactly what you asked for: <em>edit a string n lines below some specific match in Perl</em>. But also consider <strong>NOTES</strong> below.</p>\n\n<pre><code>cat file | perl -lpe '\n$seen = 1 if m{\\[MARATHON\\]}xms;\n$num_lines++ if $seen;\ns{ \\A ( PROTOCOL \\s+ = \\s+ ) http }{${1}https}xms if $num_lines == 4;\n'\n</code></pre>\n\n<p><strong>NOTES:</strong></p>\n\n<p>The code above answers the question, but it is poor code. Why? It is generally a bad idea to parse a known, widely used format relying <em>only</em> on the expected patterns and the expected number of lines. Here, the format seems to be <code>.ini</code>, so consider searching for modules/libraries used for parsing/reading/writing <code>config ini</code> files. For example: </p>\n\n<ul>\n<li><p>Config::IniFiles - A module for reading .ini-style configuration files: <a href=\"https://metacpan.org/pod/Config::IniFiles\" rel=\"nofollow noreferrer\">https://metacpan.org/pod/Config::IniFiles</a></p></li>\n<li><p>Config::INI - simple .ini-file format: <a href=\"https://metacpan.org/pod/Config::INI\" rel=\"nofollow noreferrer\">https://metacpan.org/pod/Config::INI</a></p></li>\n</ul>\n\n<p>If you do not want to use the modules such as the ones above, at least consider the possible future changes to the input and using fewer assumptions in your code. In this case, the assumption of the <em>n</em>th line from the section header seems the <strong>least</strong> robust to change. The <code>ini</code> parsers in the upstream code that write this file may not care about the order of the lines. The section headers are more robust. Perhaps read the entire file (<code>slurp</code>) and change to <code>https</code> using a non-greedy multi-line regex from <code>[MARATHON]</code> to <code>PROTOCOL = http</code>. Do not specify the exact number of lines, just make sure the line you change is in the same section. <strong>But this is still reinventing the wheel - avoid doing it if you can.</strong></p>\n\n<p><strong>SEE ALSO:</strong></p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/52432889\">Parse INI in Perl (list format)</a></li>\n<li><a href=\"https://stackoverflow.com/q/2014862\">How can I access INI files from Perl?</a></li>\n</ul>\n"}], "owner": {"reputation": 741, "user_id": 7486005, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2D0EARArylA/AAAAAAAAAAI/AAAAAAAAAZk/PSi6YyGObek/photo.jpg?sz=128", "display_name": "Adil Saju", "link": "https://stackoverflow.com/users/7486005/adil-saju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1572564505, "creation_date": 1572527902, "last_edit_date": 1572545424, "question_id": 58644243, "link": "https://stackoverflow.com/questions/58644243/edit-match-a-string-n-lines-below-some-specific-match-in-perl", "title": "Edit/Match a string n lines below some specific match in Perl?", "body": "<p>Hi recently I've posted a problem.\n<a href=\"https://stackoverflow.com/questions/58587929/edit-match-a-string-n-lines-below-some-specific-match-in-bash/58589173?noredirect=1#comment103491842_58589173\">edit nth line below a line match in bash?</a><br>\n(Problem: I have to edit the <code>PROTOCOL</code> line 3 lines below <code>[MARATHON]</code>)</p>\n\n<p>This is the file:</p>\n\n<pre><code># /etc/ndxconfig.ini will override this file\n# if APP_ID is added in service propery, service discovery will be using marathon;\n# HOST/PORT specified will override values retrieved from marathon\n\n[MARATHON]\nHOSTS = {{ ','.join(groups['marathon'])}}\nPORT = 8080\nPROTOCOL = http\nSECRET = SGpQIcjK2P7RYnrdimhhhGg7i8MdmUqwvA2JlzbyujFS4mR8M88svI7RfNWt5rnKy4WHnAihEZmmIUb940bnlYmnu47HdUHE\n\n\n[MYSQL]\n; APP_ID = /neon/infra/mysql\nHOST = {{keepalived_mysql_virtual_ip}}\nPORT = 3306\nSECRET = tIUFN1rjjDBdEXUsOJjPEtdieg8KhwTzierD48JsgDeYc84DD6Uy5a6kzHfKolq1MNS1DKwlSqxENk33UulJd9DPHPzYCxFm\n</code></pre>\n\n<p>The problem is if I rerun the script in some case, the<br>\n<code>sed '/\\[MARATHON\\]/{N;N;N;s/http/https/;}' &lt;file&gt;</code> will append more and more <code>s</code> to <code>http</code> (<code>httpsssss</code>).<br>\nSo I would add a positive lookahead in regex for <code>s</code>. \nI can do it with <strong>perl -pe</strong> but do not know how I <strong>do it on nth line below a match</strong>.\nPlease Help. How can I do it?</p>\n"}, {"tags": ["regex", "perl", "validation"], "comments": [{"owner": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1572522272, "post_id": 58642382, "comment_id": 103590585, "body": "This is invalid <code>35AABCS1429B1AX</code> because the the value ends on <code>AX</code> where the A should be a Z according to the pattern. Note that you can omit <code>{1}</code> from the pattern and the Z does not have to be between square brackets <code>[Z]</code>"}, {"owner": {"reputation": 133, "user_id": 10500417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lqs2wuzb-tM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVT92HTL5zhuL3XXyhn4btxjojg6A/mo/photo.jpg?sz=128", "display_name": "SaAsh Techs", "link": "https://stackoverflow.com/users/10500417/saash-techs"}, "reply_to_user": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1572522487, "post_id": 58642382, "comment_id": 103590695, "body": "I know its invalid. I want the code to be corrected , so that if i enter the valid input, it says valid , or else invalid"}, {"owner": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1572522586, "post_id": 58642382, "comment_id": 103590745, "body": "Change the <code>[Z]</code> to <code>A</code> or use <code>[A-Z]</code> See <a href=\"https://regex101.com/r/UHaSTb/1\" rel=\"nofollow noreferrer\">regex101.com/r/UHaSTb/1</a>"}, {"owner": {"reputation": 133, "user_id": 10500417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lqs2wuzb-tM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVT92HTL5zhuL3XXyhn4btxjojg6A/mo/photo.jpg?sz=128", "display_name": "SaAsh Techs", "link": "https://stackoverflow.com/users/10500417/saash-techs"}, "reply_to_user": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1572522654, "post_id": 58642382, "comment_id": 103590781, "body": "No, as per the rules, 14th character is always Z. I want to know what&#39;s wrong in the code . Not to manipulate the regex based on the input"}], "answers": [{"tags": [], "owner": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": true, "score": 2, "last_activity_date": 1572523549, "creation_date": 1572523549, "answer_id": 58643007, "question_id": 58642382, "link": "https://stackoverflow.com/questions/58642382/gstin-validation-through-condition-not-working-in-perl/58643007#58643007", "title": "GSTIN Validation through condition not working in Perl", "body": "<p>In this part you are using <code>=~</code> where is should be an equals sign <code>=</code></p>\n\n<p><code>my $gst_validation =~ /\\d{2}[A-Z]{5}\\d{4}[A-Z]{1}[A-Z\\d]{1}[Z]{1}[A-Z\\d]{1}/;</code></p>\n\n<p>If you want to use is as a variable, you could use <code>qr</code></p>\n\n<p>Note that you can omit <code>{1}</code> from the pattern and you don't have to use the square brackets around <code>[Z]</code></p>\n\n<p>You code might look like</p>\n\n<pre><code>my $gst_number_input = '35AABCS1429B1AX';\nmy $gst_number_character_count = length($gst_number_input);\nmy $gst_validation = qr/\\d{2}[A-Z]{5}\\d{4}[A-Z][A-Z\\d]Z[A-Z\\d]/;\n\nif ($gst_number_character_count == 15 &amp;&amp; $gst_number_input =~ $gst_validation) {\n    print \"GST Number is valid\";\n} else {\n    print \"Invalid GST Number\";\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 10500417, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lqs2wuzb-tM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVT92HTL5zhuL3XXyhn4btxjojg6A/mo/photo.jpg?sz=128", "display_name": "SaAsh Techs", "link": "https://stackoverflow.com/users/10500417/saash-techs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58643007, "answer_count": 1, "score": 0, "last_activity_date": 1572523549, "creation_date": 1572521262, "last_edit_date": 1572521602, "question_id": 58642382, "link": "https://stackoverflow.com/questions/58642382/gstin-validation-through-condition-not-working-in-perl", "title": "GSTIN Validation through condition not working in Perl", "body": "<p>I have written Perl code for validating GSTIN Number which is related to India\u2019s tax according to the following rules:</p>\n\n<ul>\n<li><p>The first two digits represent the state code as per Indian Census 2011. Every state has a unique code.</p></li>\n<li><p>The next ten digits will be the PAN number of the taxpayer</p></li>\n<li><p>The thirteenth digit will be assigned based on the number of registration within a state</p></li>\n<li><p>The fourteenth digit will be Z by default</p></li>\n<li><p>The last digit will be for check code. It may be an alphabet or a number.</p></li>\n</ul>\n\n<p>Following is the code:</p>\n\n<pre><code>my $gst_number_input = '35AABCS1429B1AX';\n\nmy $gst_number_character_count = length($gst_number_input);\n\nmy $gst_validation =~ /\\d{2}[A-Z]{5}\\d{4}[A-Z]{1}[A-Z\\d]{1}[Z]{1}[A-Z\\d]{1}/;\n\nif ($gst_number_character_count == 15 &amp;&amp; $gst_number_input =~ $gst_validation) {\n    print \"GST Number is valid\";\n} else {\n    print \"Invalid GST Number\";\n}\n</code></pre>\n\n<p>I have an invalid GSTIN input entered in the code. So when I run the script, I get:</p>\n\n<p><code>GST Number is valid</code></p>\n\n<p>Instead I should get the error because the GSTIN input is invalid:</p>\n\n<p><code>Invalid GST Number</code></p>\n\n<p>Can anyone please help ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["mysql", "linux", "perl", "rounding", "dbi"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572526773, "post_id": 58640607, "comment_id": 103593069, "body": "Try insert 1798.00001, what does DBI display now? Does it round the value?"}, {"owner": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572529769, "post_id": 58640607, "comment_id": 103594734, "body": "Shortly - yes, it rounds. I&#39;ve tested - round happens when getting data from DB by DBI. Not by some other data manipulation methods I use. For example, if I feed MySQL 1798.6356 it rounds to 1798.64 and DBI gets 1798.64. If 1798.00001 - MySQL shows 1798.00 and DBI shows 1798 But I do need 1798.00, the same way as it is in MySQL is shown."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572536936, "post_id": 58640607, "comment_id": 103598919, "body": "hmm.. Can&#39;t you just postprocess it then:  <code>$var = sprintf &quot;%.2f\\n&quot;, $var</code> ?"}, {"owner": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572590880, "post_id": 58640607, "comment_id": 103614154, "body": "OFC sprintf prints 1798.00. Roundation is done directly when I get data from MySQL using DBI. And the main question is: can I somehow avoid maipulation with numbers when using DBI and simply get all data as strings (as wrote in DBI docs)?"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572591227, "post_id": 58640607, "comment_id": 103614227, "body": "Sorry, from your comment above it seemed to me it was MySQL (not DBI) that rounded 1798.6356 to 1798.64?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572593452, "post_id": 58640607, "comment_id": 103614867, "body": "Re &quot;<i>I lose precision</i>&quot;, uh, no you don&#39;t. You get exactly the number stored in the DB. You are asking how to format the number as the <code>mysql</code> client does. DBI does provide ways of querying information about the field, which would allow you to build a format string for <code>sprintf</code>, or you could just hardcode it (<code>sprintf(&quot;%.2f&quot;, $n)</code>)."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1572594424, "post_id": 58640607, "comment_id": 103615149, "body": "You might be able to convince the mysql server to perform the conversion for you by requesting a string (by binding parameters or by adjusting the <code>SELECT</code> to cast the number to a string)."}, {"owner": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "edited": false, "score": 0, "creation_date": 1572597893, "post_id": 58640607, "comment_id": 103616172, "body": "Thanks, ikegami, you&#39;re right - I just reading about DBI binding and thinking if it can help me. Or, maybe something like CAST, or STR in queries..."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "edited": false, "score": 0, "creation_date": 1572595100, "post_id": 58655652, "comment_id": 103615346, "body": "Thanks a lot for all for info and help. This question about getting data with DBI and rounding occurs &#39;cause we already have Python script doing things, and it gets data the SAME as mysql client shows (&#39;0.00&#39; shows as &#39;0.00&#39;, not &#39;0&#39;). I DON&#39;T know, how our another applications (C#, PHP, etc) will work with  this &quot;rounded&quot; data (greetings to our developers!). So I tried to create the same behavior with DBI."}, {"owner": {"reputation": 2209, "user_id": 88056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4dc48a2044368d6b349c942ef2c4be?s=128&d=identicon&r=PG", "display_name": "Powertieke", "link": "https://stackoverflow.com/users/88056/powertieke"}, "reply_to_user": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "edited": false, "score": 0, "creation_date": 1572595342, "post_id": 58655652, "comment_id": 103615418, "body": "Do you have any insights in how this python script handles the data from the database? Maybe it&#39;s never converting it to a numeric type in the first place?"}, {"owner": {"reputation": 2209, "user_id": 88056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4dc48a2044368d6b349c942ef2c4be?s=128&d=identicon&r=PG", "display_name": "Powertieke", "link": "https://stackoverflow.com/users/88056/powertieke"}, "reply_to_user": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "edited": false, "score": 0, "creation_date": 1572596941, "post_id": 58655652, "comment_id": 103615880, "body": "The way this table is configured, you will always get the formatted, rounded value back unless the databaseconnector has a way of getting the float directly. Also, this way of setting floating point types in mysql (with defining the output) is deprecated, so switching to standard syntax in your table creation really is the better option."}, {"owner": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "edited": false, "score": 0, "creation_date": 1572597719, "post_id": 58655652, "comment_id": 103616126, "body": "I&#39;m not familiar with Python at all, but have source codes of this script. And found next code: <code>def make_query_head(self):         self.query_head = &quot;REPLACE INTO </code>{0}` ({1}) VALUES &quot;.format(             self.table, &quot;, &quot;.join(map(lambda x: &quot;<code>%s</code>&quot; % x, self.fields))         )` - here it seems to make convertion?"}, {"owner": {"reputation": 2209, "user_id": 88056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4dc48a2044368d6b349c942ef2c4be?s=128&d=identicon&r=PG", "display_name": "Powertieke", "link": "https://stackoverflow.com/users/88056/powertieke"}, "reply_to_user": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "edited": false, "score": 0, "creation_date": 1572621487, "post_id": 58655652, "comment_id": 103626375, "body": "Could you post the python code where the data is getting fetched from the database? Looks to me like the fetched data is never converted into a corresponding numeric type. The python code <code>print(&quot;%s&quot; % (2.0000))</code> would print <code>2.0</code>, so either you never had two trailing zeroes, or the value is a string at the moment of output."}], "tags": [], "owner": {"reputation": 2209, "user_id": 88056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad4dc48a2044368d6b349c942ef2c4be?s=128&d=identicon&r=PG", "display_name": "Powertieke", "link": "https://stackoverflow.com/users/88056/powertieke"}, "is_accepted": false, "score": 1, "last_activity_date": 1572593481, "creation_date": 1572593481, "answer_id": 58655652, "question_id": 58640607, "link": "https://stackoverflow.com/questions/58640607/perl-dbi-mysql-value-precision/58655652#58655652", "title": "perl dbi mysql - value precision", "body": "<p>The rounding you see is happening because of the way you create the columns.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>  `kurs` double(20,4) NOT NULL DEFAULT '0.0000'\n  `summ` double(20,2) NOT NULL DEFAULT '0.00'\n</code></pre>\n\n<p>If you look at the <a href=\"https://dev.mysql.com/doc/refman/8.0/en/floating-point-types.html\" rel=\"nofollow noreferrer\">mysql floating point type documentation</a> you will see that you are using the non-standard syntax <code>double(m, d)</code>, where the two parameters define how the float is being output.</p>\n\n<p>So in your case the values stored in <code>summ</code> will be displayed with 2 digits behind the point. This means that when perl gets a value out of the table which is 1.0001 in the database, the value that perl gets delivered by the database is rounded to the set number of digits (in this case .00).</p>\n\n<p>Perl in turn interprets this value (\"1.00\") as a float, and when printed, will not show any trailing zeroes. If you want these you should accommodate for this in your output. </p>\n\n<p>For example: <code>print sprintf(\"%.2f\\n\", $summ);</code> </p>\n\n<p>The way I see it you have two ways you can go (if you want to avoid this loss of precision):</p>\n\n<ul>\n<li>Only add numbers with the correct precision to the database (so for <code>'summ'</code> only two trailing digits, and four for <code>'kurs'</code>.)</li>\n<li>Alter your table creation to the standard syntax for floats and determine the output formatting in Perl (which you will be doing either way): </li>\n</ul>\n\n<pre><code>`kurs` double() NOT NULL DEFAULT '0.0'\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7413366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Chsap.png?s=128&g=1", "display_name": "Someone", "link": "https://stackoverflow.com/users/7413366/someone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572593481, "creation_date": 1572515386, "question_id": 58640607, "link": "https://stackoverflow.com/questions/58640607/perl-dbi-mysql-value-precision", "title": "perl dbi mysql - value precision", "body": "<p><strong>user@host:~#</strong> <code>mysql -V</code> - mysql  Ver 14.14 Distrib 5.7.25-28, for debian-linux-gnu (x86_64) using  7.0 running under debian-9,9</p>\n\n<p><strong>user@host:~#</strong> <code>uname -a</code> - Linux 4.9.0-8-amd64 #1 SMP Debian 4.9.144-3.1 (2019-02-19) x86_64 GNU/Linux</p>\n\n<p><strong>user@host:~#</strong> <code>perl -MDBI -e 'print $DBI::VERSION .\"\\n\";'</code> - 1.636</p>\n\n<p><strong>user@host:~#</strong> <code>perl -v</code> This is perl 5, version 24, subversion 1 (v5.24.1) built for x86_64-linux-gnu-thread-multi</p>\n\n<p><strong>mysql></strong> <code>SHOW CREATE TABLE tbl1;</code></p>\n\n<pre>\ntbl1 | CREATE TABLE `tbl1` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `main_id` bigint(20) NOT NULL DEFAULT '0',\n  `debet` varchar(255) NOT NULL DEFAULT '',\n  `kurs` double(20,4) NOT NULL DEFAULT '0.0000',\n  `summ` double(20,2) NOT NULL DEFAULT '0.00',\n  `is_sync` int(11) NOT NULL DEFAULT '0',\n  PRIMARY KEY (`id`),\n  KEY `main_id` (`main_id`)\n  ) ENGINE=InnoDB AUTO_INCREMENT=70013000018275 DEFAULT CHARSET=utf8 </pre>\n\n<p><strong>mysql></strong> <code>SELECT * FROM tbl1 WHERE id=70003020040132;</code></p>\n\n<pre>\n-+---------------+----------------+-------+--------+---------+---------+\n| id             | main_id        | debet | kurs   | summ    | is_sync | \n+----------------+----------------+-------+--------+---------+---------+\n| 70003020040132 | 70003020038511 |       | 0.0000 | 1798.00 | 0       |\n+----------------+----------------+-------+--------+---------+---------+\n</pre>\n\n<p>But when I get this data by perl::DBI module I lose precisions, and values <code>0.0000</code> and <code>1798.00</code> becomes <code>0</code> and <code>1798</code>. </p>\n\n<p>Code is next:</p>\n\n<pre><code>#### \n#These 3 subs are connecting to DB, executing query and get data by fetchall_arrayref and coverting undef to NULL.\n####\nsub DB_connect {\n    # DataBase Handler\n    my $dbh = DBI-&gt;connect(\"DBI:mysql:$DBNAME\", $DBUSER, $DBPWD,{RaiseError =&gt; 0, PrintError =&gt; 0, mysql_enable_utf8 =&gt; 1}) or die \"Error connecting to database: $DBI::errstr\";\n    return $dbh;\n}\nsub DB_executeQuery {\n    # Executes SQL query. Return reference to array, or array, according to argv[0]\n    # argv[0] - \"A\" returns array, \"R\" - reference to array\n    # argv[1] - DB handler from DB_connect\n    # argv[2] - query to execute\n\n    my $choice=shift @_;\n    my $dbh=shift @_;\n    my $query=shift @_;\n    print \"$query\\n\" if $DEBUG&gt;2;\n    my $sth=$dbh-&gt;prepare($query) or die \"Error preparing $query for execution: $DBI::errstr\";\n    $sth-&gt;execute;\n    my $retval = $sth-&gt;fetchall_arrayref;\n\n    if ($choice eq \"A\" ) {\n    my @ret_arr=();\n    foreach my $value (@{ $retval }) {\n        push @ret_arr,@{ $value };\n    }\n    return @ret_arr;\n    }\n    elsif ($choice eq \"R\") {\n    return $retval;\n    }\n}\n\nsub undef2null {\n    # argv[1] - reference ro array of values where undef\n    # values has to be changed to NULL\n    # Returns array of prepared values: (...) (...) ...\n    my $ref=shift @_;\n    my @array=();\n    foreach my $row (@{ $ref }) {\n    my $str=\"\";\n    foreach my $val ( @{ $row} ) {\n        if (! defined ( $val )) {\n        $str=\"$str, NULL\";\n        }\n        else {\n        # Escape quotes and other symbols listed in square brackets\n        $val =~ s/([\\\"\\'])/\\\\$1/g; \n        $str=\"$str, \\'$val\\'\";\n        }\n    }\n    # Remove ', ' at the beginning of each VALUES substring\n    $str=substr($str,2);\n    push @array,\"($str)\";\n    } # End foreach my $row (@{ $ref_values })\n    return @array;\n} # End undef2null\n\n#### Main call\n#...\n# Somewhere in code I get data from DB and print it to out file\nmy @arr_values=();\nmy @arr_col_names=DB_executeQuery(\"A\",$dbh,qq(SELECT column_name FROM `information_schema`.`columns` WHERE `table_schema` = '$DBNAME' AND `table_name` = '@{ $table }'));\n@arr_ids=DB_executeQuery(\"A\",$dbh,qq(SELECT `id` FROM `@{ $table }` WHERE `is_sync`=0));\nmy $ref_values=DB_executeQuery(\"R\",$dbh,\"SELECT * FROM \\`@{ $table }\\` WHERE \\`id\\` IN(\".join(\",\",@arr_ids).\")\");\n        @arr_values=undef2null($ref_values);\nprint FOUT  \"REPLACE INTO \\`@{ $table }\\` (`\".join(\"`, `\",@arr_col_names).\"`) VALUES  \".(join \", \",@arr_values).\";\\n\";\n</code></pre>\n\n<p></p>\n\n<p>and as a result I get next string:</p>\n\n<pre>REPLACE INTO `pko_plat` (`id`, `main_id`, `debet`, `kurs`, `summ`, `is_sync`) VALUES  ('70003020040132', '70003020038511', '', '0', '1798', '0')</pre>\n\n<p>in DB it was <code>0.0000</code> - become <code>0</code>, was <code>1798.00</code>, become <code>1798</code></p>\n\n<p>Perl's DBI documentation says it gets data 'as is' into strings, no translations made. But, then, who rounded values?</p>\n"}, {"tags": ["oracle", "perl", "perlscript"], "comments": [{"owner": {"reputation": 387, "user_id": 12249903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iG1n9avc_TI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcagZBFTq-iyeUh83mZhSQFOvACI1A/mo/photo.jpg?sz=128", "display_name": "Pratheesh", "link": "https://stackoverflow.com/users/12249903/pratheesh"}, "reply_to_user": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1572516661, "post_id": 58640333, "comment_id": 103587484, "body": "@Dada No luck .still the value not coming to sid=&#39;&#39;This part&#39;"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1572517142, "post_id": 58640333, "comment_id": 103587793, "body": "@xaglez You should show what changes you made to your code after reading that."}], "answers": [{"comments": [{"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 387, "user_id": 12249903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iG1n9avc_TI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcagZBFTq-iyeUh83mZhSQFOvACI1A/mo/photo.jpg?sz=128", "display_name": "Pratheesh", "link": "https://stackoverflow.com/users/12249903/pratheesh"}, "edited": false, "score": 1, "creation_date": 1572521695, "post_id": 58641676, "comment_id": 103590249, "body": "@xaglez: But that&#39;s exactly what Dada suggested in his comment above. And you said that didn&#39;t work."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": true, "score": 4, "last_activity_date": 1572518857, "creation_date": 1572518857, "answer_id": 58641676, "question_id": 58640333, "link": "https://stackoverflow.com/questions/58640333/how-can-i-acces-shell-environment-variables-in-a-perl-script/58641676#58641676", "title": "How can i acces shell environment variables in a Perl script", "body": "<blockquote>\n<pre><code>print \"exported variable=$ORACLE_SID\";\n</code></pre>\n</blockquote>\n\n<p>This works because you have a double-quoted string. And variables are expanded in doubled-quoted strings.</p>\n\n<blockquote>\n<pre><code>my $dbh = DBI-&gt;connect('dbi:Oracle:host=oracle;sid=$ORACLE_SID;port=1521', 'books_admin/MyPassword', '',{ RaiseError =&gt; 1, AutoCommit =&gt; 0 })or die print (\"could not connect! $DBI::errstr \\n\");\n</code></pre>\n</blockquote>\n\n<p>Here, your <code>$ORACLE_SID</code> is inside a single-quoted string. And variables are not expanded in single-quoted strings. You need to change:</p>\n\n<pre><code>'dbi:Oracle:host=oracle;sid=$ORACLE_SID;port=1521'\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>\"dbi:Oracle:host=oracle;sid=$ORACLE_SID;port=1521\"\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 12249903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iG1n9avc_TI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcagZBFTq-iyeUh83mZhSQFOvACI1A/mo/photo.jpg?sz=128", "display_name": "Pratheesh", "link": "https://stackoverflow.com/users/12249903/pratheesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "closed_date": 1572681090, "accepted_answer_id": 58641676, "answer_count": 1, "score": 2, "last_activity_date": 1573463961, "creation_date": 1572514410, "last_edit_date": 1573463961, "question_id": 58640333, "link": "https://stackoverflow.com/questions/58640333/how-can-i-acces-shell-environment-variables-in-a-perl-script", "closed_reason": "Duplicate", "title": "How can i acces shell environment variables in a Perl script", "body": "<h2>What i have</h2>\n\n<p>I have a Perl script that check connection to oracle database .Here is my code </p>\n\n<pre><code>#!/usr/bin/perl\nuse DBI;\nmy $ORACLE_SID =  $ENV{'ORACLE_SID'};\n$\\=\"\\n\";\nprint \"exported variable=$ORACLE_SID\";\nprint \"Connecting to DB..\";\nmy $dbh = DBI-&gt;connect('dbi:Oracle:host=oracle;sid=$ORACLE_SID;port=1521', 'books_admin/MyPassword', '',{ RaiseError =&gt; 1, AutoCommit =&gt; 0 })or die print (\"could not connect! $DBI::errstr \\n\");\n</code></pre>\n\n<p>I have exported ORACLE_SID by <code>export ORACLE_SID=ORCLCDB</code> \nThe output of this code is</p>\n\n<pre><code>    exported variable=ORCLCDB\n    Connecting to DB..\n    DBI connect('host=oracle;sid=$ORACLE_SID;port=1521','books_admin/MyPassword',...) failed: ORA-12505: TNS:listener does not currently know of SID given in connect descriptor (DBD ERROR: OCIServerAttach) at perl.pl line 8. \n</code></pre>\n\n<p>Seems like ORACLE_SID is picked up by Perl but it is not used in sid=$ORACLE_SID.\nWhy print function can use $ORACLE_SID and sid=$ORACLE_SID can't fetch the value </p>\n"}, {"tags": ["arrays", "postgresql", "perl"], "comments": [{"owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "edited": false, "score": 0, "creation_date": 1572516035, "post_id": 58640163, "comment_id": 103587155, "body": "What is the data type of <code>tag_list</code>? From your insert statement it looks like it would be an array of arrays."}, {"owner": {"reputation": 113, "user_id": 5714031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd26a47a88d2cddc3fa825499c80527?s=128&d=identicon&r=PG&f=1", "display_name": "Denis.A", "link": "https://stackoverflow.com/users/5714031/denis-a"}, "reply_to_user": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "edited": false, "score": 0, "creation_date": 1572516192, "post_id": 58640163, "comment_id": 103587237, "body": "&quot;Tag_List&quot; character varying(128)[]. I&#39;ve tried to create a two-dimensional array with [][] but it seems to have failed."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5714031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd26a47a88d2cddc3fa825499c80527?s=128&d=identicon&r=PG&f=1", "display_name": "Denis.A", "link": "https://stackoverflow.com/users/5714031/denis-a"}, "edited": false, "score": 0, "creation_date": 1572519073, "post_id": 58641131, "comment_id": 103588859, "body": "Yes, great, it works. Many thanks. I&#39;ll now open a new subject for creating a 2-dim array and fill it :-)"}], "tags": [], "owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "is_accepted": true, "score": 3, "last_activity_date": 1572517135, "creation_date": 1572517135, "answer_id": 58641131, "question_id": 58640163, "link": "https://stackoverflow.com/questions/58640163/perl-postgres-column-array-and-quotes/58641131#58641131", "title": "Perl-Postgres column array and quotes", "body": "<p>You can insert the whole array as a string:</p>\n\n<pre><code>CREATE TABLE arr (\n   id integer PRIMARY KEY,\n   tag_list character varying(128)[]\n);\n\nINSERT INTO arr (id, tag_list) VALUES\n   (1,\n    '{normal_string,string with spaces,\"string,with,comma\",\"string\\\"with\\\"quote\",\"string''with''apostrophe\"}'\n   );\n</code></pre>\n\n<p>This will result in entries like:</p>\n\n<pre><code>SELECT u.* FROM arr CROSS JOIN unnest(tag_list) AS u;\n           u            \n------------------------\n normal_string\n string with spaces\n string,with,comma\n string\"with\"quote\n string'with'apostrophe\n(5 rows)\n</code></pre>\n\n<p>An alternative is to insert each array entry individually:</p>\n\n<pre><code>INSERT INTO arr (\n   id,\n   tag_list[1],\n   tag_list[2],\n   tag_list[3],\n   tag_list[4],\n   tag_list[5]\n) VALUES (\n   2,\n   'normal_string',\n   'string with spaces',\n   'string,with,comma',\n   'string\"with\"quote',\n   'string''with''apostrophe'\n);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1572541422, "creation_date": 1572541422, "answer_id": 58648161, "question_id": 58640163, "link": "https://stackoverflow.com/questions/58640163/perl-postgres-column-array-and-quotes/58648161#58648161", "title": "Perl-Postgres column array and quotes", "body": "<p>Use bound parameters. (<strong>Always</strong> use parameter binding to send data into a database.) DBD::Pg supports array parameters by default.</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy $query = 'INSERT INTO \"table-name\" (\"Date\",\"Time\"...,\"Tag_List\"[1],\"Tag_List\"[2],\"Tag_List\"[3],\"Tag_List\"[4],\"Tag_List\"[5]) (?,?,...,?,?,?,?,?)';\n$dbh-&gt;insert($query, undef, $date, $time, ... ['TAG1',\"tag value'with quote\"], ...);\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5714031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd26a47a88d2cddc3fa825499c80527?s=128&d=identicon&r=PG&f=1", "display_name": "Denis.A", "link": "https://stackoverflow.com/users/5714031/denis-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 58641131, "answer_count": 2, "score": 1, "last_activity_date": 1572541422, "creation_date": 1572513828, "question_id": 58640163, "link": "https://stackoverflow.com/questions/58640163/perl-postgres-column-array-and-quotes", "title": "Perl-Postgres column array and quotes", "body": "<p>I want to populate in Perl a postgres column defined as a character array (<code>Tag_List[]</code>) </p>\n\n<p>Values may contains single-quote, so when constructing the SQL string, I cannot get the right syntax to enquote these kind of values, since I already must double-enquote string values and single-enquote array type (because of the curly brackets).</p>\n\n<p>I've tried to escape the single-quote (with a <code>$VAL =~ s/\\x27/\\x5c\\x27/g;</code>) but no way :</p>\n\n<p><code>INSERT INTO \"table-name\" (\"Date\",\"Time\"...,\"Tag_List\"[1],\"Tag_List\"[2],\"Tag_List\"[3],\"Tag_List\"[4],\"Tag_List\"[5])</code>\n<code>VALUES ('2019/10/30', '14:17:59', .... ,'{\"LastSuccessfulBackup-com.dellemc.avamar\",\"2019-10-29 20:00:22 UTC\"}','{\"TAG1\",\"tag value\\'with quote\"}',...</code></p>\n\n<p><code>ERROR:  syntax error at or near \"with\"</code><br>\n<code>LIGNE 1 : ...20:00:22 UTC\"}','{\"TAG1\",\"tag value\\'with quote\"}','{...</code>  </p>\n\n<p>Any clue ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["docker", "perl", "dockerfile"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1572516042, "post_id": 58638435, "comment_id": 103587161, "body": "Probably not related but: I tested installing the module from GitHub: <code>git clone git@github.com:JJ&#47;Test-Text.git &amp;&amp; cd Test-Text &amp;&amp; cpanm .</code> but it failed due to <code>Building and testing Alien-autoconf-0.14 ... FAIL</code>, however installing <code>Alien::autoconf</code> separately worked: <code>cpanm Alien::autoconf &amp;&amp; cpanm .</code>.."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572519125, "post_id": 58638435, "comment_id": 103588893, "body": "I tried run <code>docker build -t test-text .</code> locally on my laptop and <code>cpanm .</code> failed with <code>Running Makefile.PL \\\\\\ --&gt; Working on . \\\\\\Configuring &#47; ... &#47;proc&#47;12&#47;cwd is a recursive symbolic link at &#47;usr&#47;share&#47;perl&#47;5.22&#47;File&#47;Find.pm line 88.\\\\\\Checking if your kit is complete...\\\\\\! Configure failed for .. See &#47;root&#47;.cpanm&#47;work&#47;1572518663.8&#47;build.log for details. \\\\\\N&#47;A \\\\\\The command &#39;&#47;bin&#47;sh -c cpanm -v .&#39; returned a non-zero code: 1</code>"}, {"owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1572527004, "post_id": 58638435, "comment_id": 103593205, "body": "@H&#229;konH&#230;gland you need minimum perl 5.22 to make it work... That wasn&#39;t a problem, and in fact is included as one of the Ubuntu modules. Your second comment clarifies what&#39;s the matter a bit, but I&#39;m still kinda baffled about how to fix it..."}], "answers": [{"comments": [{"owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "edited": false, "score": 0, "creation_date": 1572885081, "post_id": 58697400, "comment_id": 103691343, "body": "But since /test is going to be overlayed with the host files, I can&#39;t actually copy anything there."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "edited": false, "score": 0, "creation_date": 1572885427, "post_id": 58697400, "comment_id": 103691514, "body": "I am not sure how your setup is, and what you mean by &quot;overlayed&quot;, but you already copied the files from the host with the <code>ADD</code> commands right? .. do you mean the <code>VOLUME</code> command? Why can&#39;t you copy anything there?"}, {"owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "edited": false, "score": 0, "creation_date": 1572959645, "post_id": 58697400, "comment_id": 103717646, "body": "It basically means that the user&#39;s directory is going to overwite whatever has been written in the container. At any rate, that&#39;s not relevant to the error, I think."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "edited": false, "score": 0, "creation_date": 1572959805, "post_id": 58697400, "comment_id": 103717722, "body": "Maybe try another directory then? At least, I would not use the root <code>&#47;</code> as it is now"}, {"owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "edited": false, "score": 0, "creation_date": 1583312349, "post_id": 58697400, "comment_id": 107069557, "body": "I&#39;ve changed that, and it fixes other problems, but not the one I&#39;m talking about. Theoretically, the environment where the Dockerfile is built should be the same independently of where it happens, right?"}], "tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": false, "score": 1, "last_activity_date": 1572884629, "creation_date": 1572884629, "answer_id": 58697400, "question_id": 58638435, "link": "https://stackoverflow.com/questions/58638435/problems-building-an-ubuntu-docker-container-for-a-distribution/58697400#58697400", "title": "Problems building an Ubuntu docker container for a distribution", "body": "<p>I think the problem is that you do <code>WORKDIR /test</code> too late. In the beginning of <code>Dockerfile</code> you do <code>ADD . .</code> this will copy all files from the current directory of your local filesystem to the root directory of the image. The problem is that there can be conflicts between the directories already present in the root of the image, like <code>/lib</code>. Try instead something like this:</p>\n\n<pre><code>FROM ubuntu:16.04\nLABEL version=\"1.0\" maintainer=\"JJ Merelo &lt;jjmerelo@GMail.com&gt;\" perl5version=\"5.22\"\n\nWORKDIR /test\nADD data/* ./\nADD . .\nRUN apt-get update \\\n    &amp;&amp; apt-get install -y build-essential curl hunspell-en-us libtext-hunspell-perl myspell-es libencode-perl cpanminus libfile-slurp-tiny-perl libversion-perl\\\n    &amp;&amp; curl https://raw.githubusercontent.com/SublimeText/Dictionaries/master/Spanish.dic -o Spanish.dic\n\nRUN perl --version\nRUN cpanm Test::More\nRUN cpanm .\nVOLUME /test\n\n# Will run this\nENTRYPOINT prove\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "is_accepted": true, "score": 1, "last_activity_date": 1583314354, "creation_date": 1583314354, "answer_id": 60522904, "question_id": 58638435, "link": "https://stackoverflow.com/questions/58638435/problems-building-an-ubuntu-docker-container-for-a-distribution/60522904#60522904", "title": "Problems building an Ubuntu docker container for a distribution", "body": "<p>The problem is that we don't use a working directory for copying the files we want to have included in the directory, and then we do <code>ADD . .</code>. That includes a <code>lib</code> directory, so we are then copying the contents of our module to the lib directory, that is, the image <code>/lib</code> directory.</p>\n\n<p>That's not bad per se. The problem is that the Perl installation procedure is then copying the contents of its own lib directory (which is the system's lib directory) onto <code>blib</code>, and then again, copyint that to some directory of <code>/usr/lib</code>. Somehow there's installation happening in other directories, which means that that certificate mentioned in the error is eventually copied somewhere else, hence the duplicate. </p>\n\n<p>That does not explain why it was working locally, and as a matter of fact working in subsequent builds in Docker Hub. Maybe some slightly different version of <code>runc</code>. But even if it works, you end up with stuff duplicated, and a bigger image than you should have.</p>\n\n<p>Baseline is: don't use root as working directory. Use WORKDIR from the very beginning, even more so if that directory is going to have stuff that's going to be installed somewhere else.</p>\n"}], "owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 60522904, "answer_count": 2, "score": 1, "last_activity_date": 1583314354, "creation_date": 1572506070, "question_id": 58638435, "link": "https://stackoverflow.com/questions/58638435/problems-building-an-ubuntu-docker-container-for-a-distribution", "title": "Problems building an Ubuntu docker container for a distribution", "body": "<p>I'm trying to build a Docker container for <a href=\"https://metacpan.org/pod/Test::Text\" rel=\"nofollow noreferrer\">this module</a>. Main idea is that I'm trying to use, as much as possible, the packages provided by Ubuntu to avoid problem; I'm also using the default perl that comes with the container, which apparently is 5.22.</p>\n\n<p>This is the Dockerfile:</p>\n\n<pre><code>FROM ubuntu:16.04\nLABEL version=\"1.0\" maintainer=\"JJ Merelo &lt;jjmerelo@GMail.com&gt;\" perl5version=\"5.22\"\n\nADD data/* ./\nADD . .\nRUN mkdir /test \\\n    &amp;&amp; apt-get update \\\n    &amp;&amp; apt-get install -y build-essential curl hunspell-en-us libtext-hunspell-perl myspell-es libencode-perl cpanminus libfile-slurp-tiny-perl libversion-perl\\\n    &amp;&amp; curl https://raw.githubusercontent.com/SublimeText/Dictionaries/master/Spanish.dic -o Spanish.dic\n\nRUN cpanm .\nRUN perl --version\nVOLUME /test\nWORKDIR /test\n\n# Will run this\nENTRYPOINT prove\n</code></pre>\n\n<p>It builds locally without a problem (using <code>Docker version 17.05.0-ce, build 89658be</code>). However, it does not work in Docker hub due to <a href=\"https://cloud.docker.com/repository/registry-1.docker.io/jjmerelo/perl-test-text/builds/e63b99e6-4440-48d0-aa39-7d6ba0ae5922\" rel=\"nofollow noreferrer\">this problem</a></p>\n\n<pre><code>/etc/ssl/certs/AddTrust_Low-Value_Services_Root.pem is encountered a second time at /usr/share/perl/5.22/File/Find.pm line 79.\n</code></pre>\n\n<p>Which seems to happen in a line where I do <code>perl Makefile.PL &amp;&amp; make install</code></p>\n\n<p>I really have no idea what could be the cause for that, of why it works locally and fails there. Any idea?</p>\n"}, {"tags": ["oracle", "perl", "perlscript"], "comments": [{"owner": {"reputation": 5144, "user_id": 12115778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oC38b.jpg?s=128&g=1", "display_name": "richyen", "link": "https://stackoverflow.com/users/12115778/richyen"}, "edited": false, "score": 0, "creation_date": 1572503872, "post_id": 58637987, "comment_id": 103582146, "body": "If you put the command in an <code>eval</code> block, you can capture the output with <code>$@</code> -- see <a href=\"https://perldoc.perl.org/functions/eval.html\" rel=\"nofollow noreferrer\">perldoc.perl.org/functions/eval.html</a>"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1572510692, "post_id": 58637987, "comment_id": 103584590, "body": "Peruse <a href=\"https://perldoc.perl.org/perlvar.html\" rel=\"nofollow noreferrer\">perlvar</a> for a variety of goodies (<code>$?</code> among them). Otherwise, it depends on the library / function (etc) and how it behaves; so read docs to see what they do on failure and then work with that. Also, complex libraries (like <code>DBI</code>) often have specific methods to query status."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 5144, "user_id": 12115778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oC38b.jpg?s=128&g=1", "display_name": "richyen", "link": "https://stackoverflow.com/users/12115778/richyen"}, "edited": false, "score": 0, "creation_date": 1572511755, "post_id": 58637987, "comment_id": 103585008, "body": "@richyen The <code>eval</code> block and <code>$@</code> are useful if code in the block throws an exception (<code>die</code>s), since we get the control back (the program isn&#39;t terminated); the exception gets &quot;caught.&quot;  Without an exception raised there should be nothing in <code>$@</code> so it can&#39;t be used for general queries of status of previous commands (see it under <a href=\"https://perldoc.perl.org/perlvar.html#Error-Variables\" rel=\"nofollow noreferrer\">Error Variables in perlvar</a>).  And many (most) libraries <i>don&#39;t</i> throw (<code>die</code>) on error but (may) set <code>$?</code> (and perhaps other related globals, see <code>perlvar</code>) and may return codes."}], "answers": [{"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": true, "score": 3, "last_activity_date": 1572942017, "last_edit_date": 1592644375, "creation_date": 1572518473, "answer_id": 58641578, "question_id": 58637987, "link": "https://stackoverflow.com/questions/58637987/how-to-check-status-of-previously-executed-command-in-perl/58641578#58641578", "title": "How to check status of previously executed command in perl", "body": "<p>The <a href=\"https://metacpan.org/pod/DBI#connect\" rel=\"nofollow noreferrer\">documentation for the <code>connect()</code> method</a> says this:</p>\n<blockquote>\n<p>Establishes a database connection, or session, to the requested <code>$data_source</code>. Returns a database handle object if the connection succeeds. Use <code>$dbh-&gt;disconnect</code> to terminate the connection.</p>\n<p>If the connect fails (see below), it returns <code>undef</code> and sets both <code>$DBI::err</code> and <code>$DBI::errstr</code>. (It does not explicitly set <code>$!</code>.) You should generally test the return status of <code>connect</code> and print <code>$DBI::errstr</code> if it has failed.</p>\n</blockquote>\n<p>So your code could be as obvious as:</p>\n<pre><code>my $dbh = DBI-&gt;connect(...);\nif ($dbh) {\n  say 'Connection ok';\n} else {\n  die &quot;Connection error: $DBI::errstr&quot;;\n}\n</code></pre>\n<p>However, you're using <code>RaiseError =&gt; 1</code>, so your program will <code>die</code> rather than returning <code>undef</code>. So if your program gets past that line, you know the connection was successful.</p>\n<pre><code>my $dbh = DBI-&gt;connect(...);\nsay 'Connection ok';\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 12249903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iG1n9avc_TI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcagZBFTq-iyeUh83mZhSQFOvACI1A/mo/photo.jpg?sz=128", "display_name": "Pratheesh", "link": "https://stackoverflow.com/users/12249903/pratheesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 58641578, "answer_count": 1, "score": 1, "last_activity_date": 1573464009, "creation_date": 1572503706, "last_edit_date": 1573464009, "question_id": 58637987, "link": "https://stackoverflow.com/questions/58637987/how-to-check-status-of-previously-executed-command-in-perl", "title": "How to check status of previously executed command in perl", "body": "<p>I am completely new to Perl . I have a Perl script which check connection to a oracle database running in a container . Here is my code </p>\n\n<pre><code>#!/usr/bin/perl\nuse DBI;\n\n$\\=\"\\n\";\n\nprint \"Connecting to DB..\";\n\n\nmy $dbh = DBI-&gt;connect('dbi:Oracle:host=oracle;sid=ORCLCDB;port=1521', 'books_admin/MyPassword', '',{ RaiseError =&gt; 1, AutoCommit =&gt; 0 })or die print (\"could not connect! $DBI::errstr \\n\");\n</code></pre>\n\n<p>Using this script I'm able to connect with  oracle database . But this script doesn't give any status  output to my terminal . How can i check the script is connected to database?. I know bash has $? for checking the status of previously executed cmd. Do we have something similar in Perl?</p>\n\n<p>Here is what i want \nOutput \"Successfully connected to Oracle-db\" when the connection is OK and failed status when script can't connect to database </p>\n\n<p>Note:This code give  error status to my terminal. \nMy Perl version is v5.16.3</p>\n"}]