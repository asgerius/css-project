[{"tags": ["perl"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9124475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056df70e0c073c65a72aaa7308871042?s=128&d=identicon&r=PG&f=1", "display_name": "user9124475", "link": "https://stackoverflow.com/users/9124475/user9124475"}, "edited": false, "score": 0, "creation_date": 1513817644, "post_id": 47915832, "comment_id": 82800866, "body": "I apologize for the sloppy formatting, and I am sorry you had to spend time fixing it. I do sincerely appreciate the time you have put into helping me. I am trying to get your example to work, but there is something going on in the loop where in the output file, there are nine fasta sequences instead of 3. Anyway, I am trying to figure it out now. Your example is much more concise and easier to understand."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 23, "user_id": 9124475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056df70e0c073c65a72aaa7308871042?s=128&d=identicon&r=PG&f=1", "display_name": "user9124475", "link": "https://stackoverflow.com/users/9124475/user9124475"}, "edited": false, "score": 0, "creation_date": 1513915282, "post_id": 47915832, "comment_id": 82840706, "body": "@user: Okay, the problem is that every line from the FASTA file is paired with every line from the pos file. I wrote it like that because that&#39;s what your own code does, but it looks like you need the lines paired together by sequence ID.  I&#39;ll fix it in the morning."}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": true, "score": 2, "last_activity_date": 1513815210, "last_edit_date": 1513815210, "creation_date": 1513812828, "answer_id": 47915832, "question_id": 47914407, "link": "https://stackoverflow.com/questions/47914407/perl-script-to-subset-multiple-dna-sequences/47915832#47915832", "title": "Perl script to subset multiple DNA sequences", "body": "<p>There are many problems with your code</p>\n\n<ul>\n<li><p>Your comments don't correspond to the code. For instance, you have <code>Read in the complete FASTA file</code> when the code just accepts the file name from STDIN and trims it. It is usually best to write clean code with well-chosen identifiers; that way the program explains itself</p></li>\n<li><p>You are using the two-parameter form of <code>open</code> and global file handles. You also don't have the <em>reason</em> for failure in the <code>die</code> string, and you have a newline at the end, which will prevent Perl from giving you the source file name and line number where the error occurred</p>\n\n<p>Something like</p>\n\n<pre><code>open( FASTA, $fasta ) || die \"\\n Unable to open the file!\\n\"\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>open my $fasta_fh, '&lt;', $fasta_file or die qq{Unable to open \"$fasta_file\" for input: $!}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>open( OUTFILE, \"&gt;&gt;$out\" );\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>open my $out_fh, '&gt;&gt;', $output_file or die qq{Unable to open \"$output_file\" for appending: $!}\n</code></pre></li>\n<li><p>You should avoid putting quotes around variable names.</p>\n\n<pre><code>print OUTFILE \"$seq1\"\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>print OUTFILE $seq1\n</code></pre></li>\n<li><p>You set the input record separator to <code>\"\\n&gt;\"</code>. That means that every time you call <code>&lt;FASTA&gt;</code> Perl will read up to the next occurrence of that string. It also means that <code>chomp</code> will remove exactly that string from the end of the line, if it is there</p></li>\n</ul>\n\n<p>The biggest problem is that you never reset <code>$/</code> before reading from <code>POS</code>. Remember that its setting affects <em>every</em> <code>readline</code> (or <code>&lt;&gt;</code>) and <em>every</em> <code>chomp</code>. And because your <code>$text</code> file probably contains no <code>&gt;</code> characters at the start of a line, you will read the entire file in one go</p>\n\n<p>That is why you are seeing newlines in your output without asking for them. You have read the whole file, together with all embedded newlines, and <code>chomp</code> is useless here because you have modified the string that it removes</p>\n\n<p><code>local</code> is named that way for a reason. It alters the value temporarily and <em>locally</em> to the current scope. But your \"current scope\" is the entirety of the rest of the file and you are reading both files with the modified terminator</p>\n\n<p>Use some braces <code>{</code> ... <code>}</code> to limit the scope of the <code>local</code> modification. Alternatively, because file handles in more recent versions of Perl behave as <code>IO::Handle</code> objects, you can write</p>\n\n<pre><code>$fasta_fh-&gt;input_record_separator(\"\\n&gt;\")\n</code></pre>\n\n<p>and the change will apply <em>only</em> to that file handle, and there is no need to localise <code>$/</code> at all</p>\n\n<p>Here's an amended version of your program which also addresses some poor choices of identifier as well as a few other things. <strong><em>Please note</em></strong> that this code is <strong><em>untested</em></strong>. I am working on the train at present and can only check what I'm writing mentally</p>\n\n<p>Note that things like <code>while ( &lt;$fasta_fh&gt; )</code> and <code>for ( @pos_records )</code> use the default variable <code>$_</code> when no loop variable is specified. Likewise, operators like <code>chomp</code> and <code>split</code> will apply to <code>$_</code> when the corresponding parameter is missing. That way there is never any need to mention any variable explicitly, and it leads to more concise and readable code. <code>$_</code> is equivalent to <strong><em>it</em></strong> in the English language</p>\n\n<p>I encourage you to <em>understand</em> what the things you're writing actually do. It is becoming common practice to copy code from one part of the internet and offer it to some kind souls elsewhere to get it working for you. That isn't \"learning to program\", and you will not understand anything unless you study the language and put your mind to it</p>\n\n<p>And <em>please</em> take more care with laying out your code. I hope you can see that the edit I made to your question, and the code in my solution, is more more comfortable to read than the program that you posted? While you're welcome to make your own job as awkward as you like, it's unfair and impolite to offer a mess like that to a world of total strangers whom you're asking for free programming help. A nice middle line is to alter your editor to use an indent of <em>four spaces</em> when the tab key is pressed. <strong>Never use tab characters in source code!</strong></p>\n\n<pre><code>use strict;\nuse warnings 'all';\n\nprint \"Name of the FASTA contig file: \";\nchomp( my $fasta_file = &lt;STDIN&gt; );\n\nprint \"Name file with SNP position info: \";\nchomp( my $pos_file = &lt;STDIN&gt; );\n\nprint \"Name of the output file: \";\nchomp( my $out_file = &lt;STDIN&gt; );\n\nopen my $out_fh, '&gt;', $out_file die qq{Unable to open \"$out_file\" for output: $!};\n\nmy @pos_records = do {\n    open $pos_, '&lt;', $pos_file or die qq{Unable to open \"$pos_file\" for input: $!};\n    &lt;$pos_fh&gt;;\n};\nchomp @pos_records; # Remove all newlines\n\n{\n    open my $fasta_fh, '&lt;', $fasta_file or die qq{Unable to open \"$fasta_file\" for input: $!};\n\n    local $/ = \"\\n&gt;\"; # Reading FASTA format now\n\n    while ( &lt;$fasta_fh&gt; ) {\n\n        chomp;    # Remove \"\"&gt;\\n\" from the end\n\n        my ( $header, $seq ) = split /\\n/; # Separate the two lines\n\n        $header =~ s/^&gt;?/&gt;/; # Replace any chomped &gt;\n\n        for ( @pos_records ) {\n\n            my ( $name, $beg, $end, $pos ) = split /\\t/;\n            my $subseq = substr $seq, $beg-1, $end-$beg;\n\n            print $out_fh \"$header\\n\";\n            print $out_fh \"pos=$pos\\n\";\n            print $out_fh \"$subseq\\n\";\n        }\n    }\n} # local $/ expires here\n\nclose $out_fh or die $!;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513915466, "post_id": 47916663, "comment_id": 82840733, "body": "I&#39;m glad you got it working, b&#250;t you haven&#39;t heeded what I wrote about your indentation. This is dreadful and very inconsistent, and very difficult to read. It really is important to get this right as it makes bugs much less visible."}], "tags": [], "owner": {"reputation": 23, "user_id": 9124475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056df70e0c073c65a72aaa7308871042?s=128&d=identicon&r=PG&f=1", "display_name": "user9124475", "link": "https://stackoverflow.com/users/9124475/user9124475"}, "is_accepted": false, "score": 0, "last_activity_date": 1513819797, "creation_date": 1513819797, "answer_id": 47916663, "question_id": 47914407, "link": "https://stackoverflow.com/questions/47914407/perl-script-to-subset-multiple-dna-sequences/47916663#47916663", "title": "Perl script to subset multiple DNA sequences", "body": "<p>Okay, with a couple very minor edits, your code worked perfectly. This is the solution that worked for me:</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nprint \"Name of the FASTA contig file: \";\nchomp( my $fasta_file = &lt;STDIN&gt; );\n\nprint \"Name file with SNP position info: \";\nchomp( my $pos_file = &lt;STDIN&gt; );\n\nprint \"Name of the output file: \";\nchomp( my $out_file = &lt;STDIN&gt; );\n\nopen my $out_fh, '&gt;', $out_file or die qq{Unable to open \"out_file\" for output: $!};\n\n\nmy @pos_records = do {\n    open my $pos_, '&lt;' , $pos_file or die qq{Unable to open \"$pos_file\" for input: $!};\n    &lt;$pos_&gt;;\n};\nchomp @pos_records; #remove all newlines  \n\n{\n     open my $fasta_fh, '&lt;', $fasta_file or die qq{Unable to open \"$fasta_file\" for input: $!};\n\n     local $/ = \"\\n&gt;\"; #Reading FASTA format now\n\n     for ( &lt;$fasta_fh&gt; ) {\n\n         chomp; #Remove \"&gt;\\n\" from the end\n\n         my ( $header, $seq) = split /\\n/; #separate the two lines\n\n         $header = \"&gt;$header\" unless $header =~ /^&gt;/; # Replace any chomped &gt;\n\n\n     for ( @pos_records ) {\n\n             my ($name,$beg,$end,$pos) = split /\\t/;\n             my $subseq = substr $seq, $beg-1, $end-$beg;\n             my $final_SNP = $end - $pos; \n\n             if($header =~ /$name/){\n\n               print $out_fh \"$header\\n\";\n               print $out_fh \"pos=$final_SNP\\n\";\n               print $out_fh \"$subseq\\n\";\n     }\n    } \n  }\n} #local expires here\n\nclose $out_fh or die $!;\n</code></pre>\n\n<p>The only substantive thing I changed was the addition of an if statement. Without that, each fasta sequence was being written three times, each one with one with one of the three SNP positions. I also slightly changed what I was doing to notate the SNP position, which after excising the sequence, was actually $end - $pos and not just $pos. </p>\n\n<p>Again, I can't thank you enough, as it is obvious you spent a fair bit of time helping me. For what its worth, I sincerely appreciate it. Your solution will serve as a template for my future efforts (which will likely be similar manipulations of fasta files), and your explanations have helped me to better understand things like what local does in a way that my pea brain can comprehend.  </p>\n"}], "owner": {"reputation": 23, "user_id": 9124475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056df70e0c073c65a72aaa7308871042?s=128&d=identicon&r=PG&f=1", "display_name": "user9124475", "link": "https://stackoverflow.com/users/9124475/user9124475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 47915832, "answer_count": 2, "score": 1, "last_activity_date": 1513819797, "creation_date": 1513804297, "last_edit_date": 1592644375, "question_id": 47914407, "link": "https://stackoverflow.com/questions/47914407/perl-script-to-subset-multiple-dna-sequences", "title": "Perl script to subset multiple DNA sequences", "body": "\n<p>I have a FASTA file of ~500 DNA sequences, each of which has target position for a <em>Single-Neucleotide Polymorphism</em> (SNP) of interest that is known to me.</p>\n<p>For each entry in the file, I have a separate tab-delimited text file that has on each line</p>\n<ol>\n<li>The FASTA sequence name</li>\n<li>The start position</li>\n<li>The end position</li>\n<li>The SNP position</li>\n</ol>\n<p>The sequences and the positions in the text file are in the same order.</p>\n<p>The dummy FASTA file is:</p>\n<pre class=\"lang-none prettyprint-override\"><code>&gt;AOS-94_S25_L002_R1_001_trimmed_contig_767\nGACACACACTGATTGTTAGTGGTGTACAGACATTGCTTCAAACTGCA\n&gt;AOS-94_S25_L002_R1_001_trimmed_contig_2199\nTAGGTTTTCTTTCCCATGTCCCCTGAATAACATGGGATTCCCTGTGACTGTGGGGACCCCTGAGAGCCTGGT\n&gt;AOS-94_S25_L002_R1_001_trimmed_contig_2585\nGATAAGGAGCTCACAGCAACCCACATGAGTTGTCC\n</code></pre>\n<p>and the dummy position file is</p>\n<pre class=\"lang-none prettyprint-override\"><code>AOS-94_S25_L002_R1_001_trimmed_contig_767   5   15  10\nAOS-94_S25_L002_R1_001_trimmed_contig_2199  8   19  11\nAOS-94_S25_L002_R1_001_trimmed_contig_2585  4   20  18\n</code></pre>\n<p>This is the script I have written and tried</p>\n<pre class=\"lang-perl prettyprint-override\"><code>use warnings;\nuse strict; \n\n# Read in the complete FASTA file:\nprint &quot;What is the name of the fasta contig file?\\n&quot;;\nmy $fasta = &lt;STDIN&gt;;\nchomp $fasta;\n\n# Read in file of contig name, start pos, stop pos, SNP pos in tab delimited \ntext:\nprint &quot;Name of text file with contig name and SNP position info? \\n&quot;;\nmy $text = &lt;STDIN&gt;;\nchomp $text;\n\n# Output file\nprint &quot;What are we calling the output? \\n&quot;;\nmy $out= &lt;STDIN&gt;;\nchomp $out;\n\nlocal $/ = &quot;\\n&gt;&quot;; #Read by fasta record\n\nmy $seq1 = (); \n\nopen(FASTA,$fasta) || die &quot;\\n Unable to open the file!\\n&quot;;\nopen(POS,$text) || die &quot;\\n Unable to open the file! \\n&quot;;\nmy @fields = &lt;POS&gt;;\n    while (my $seq = &lt;FASTA&gt;){\n        chomp $seq;\n        my @seq = split(/\\n/,$seq);\n            if($seq[0] =~ /^&gt;/){\n                $seq1 = $seq[0];\n            }elsif($seq[0] =~ /[^&gt;]/){ #matches any character except the &gt;\n                $seq1 = &quot;&gt;&quot;.$seq[0];\n            }\n    for my $pos (@fields){\n        chomp $pos;\n        my @field = split(/\\t/,$pos);\n    open(OUTFILE,&quot;&gt;&gt;$out&quot;);\n    print OUTFILE &quot;$seq1&quot;;\n    my $subseq = substr $seq[1], $field[1] -1, $field[2] - $field[1]; \n    print OUTFILE &quot;$subseq\\n&quot;;\n    }   \n}\nclose FASTA;\nclose POS;\nclose OUTFILE; \n</code></pre>\n<p>This is what I get out, which is what I sort of want:</p>\n<pre class=\"lang-none prettyprint-override\"><code>&gt;AOS-94_S25_L002_R1_001_trimmed_contig_767\nCACACTGATT\n&gt;AOS-94_S25_L002_R1_001_trimmed_contig_2199\nTTTTCTTTCC\n&gt;AOS-94_S25_L002_R1_001_trimmed_contig_2585\nAGGAGCTCAC\n</code></pre>\n<p>However, I need to also print out the SNP position (column 4) after the sequence name, e.g.,</p>\n<pre class=\"lang-none prettyprint-override\"><code>&gt;AOS-94_S25_L002_R1_001_trimmed_contig_767\npos=10\nCACACTGATT\n&gt;AOS-94_S25_L002_R1_001_trimmed_contig_2199\npos=11\nTTTTCTTTCC\n&gt;AOS-94_S25_L002_R1_001_trimmed_contig_2585\npos=18\nAGGAGCTCAC\n</code></pre>\n<p>I tried inserting <code>print OUTFILE &quot;pos= $field[3]\\n&quot;;</code>after <code>print OUTFILE &quot;$seq1&quot;;</code> and I get the following:</p>\n<pre class=\"lang-none prettyprint-override\"><code>&gt;AOS-94_S25_L002_R1_001_trimmed_contig_767\n10\nAOS-94_S25_L002_R1_001_trimmed_contig_2199\nCACACTGATT\n&gt;AOS-94_S25_L002_R1_001_trimmed_contig_2199\n10\nAOS-94_S25_L002_R1_001_trimmed_contig_2199\nTTTTCTTTCC\n&gt;AOS-94_S25_L002_R1_001_trimmed_contig_2585\n10\nAOS-94_S25_L002_R1_001_trimmed_contig_2199\nAGGAGCTCAC\n</code></pre>\n<p>Obviously I have messed up my loops, and probably some <code>chomp</code> commands.</p>\n<p>For instance, when I <code>print &quot;$seq1&quot;</code> to a file, why does it not need a <code>&quot;\\n&quot;</code> included in the printed string? There must already be a hard return in the string?</p>\n<p>I know I am missing some basics of how this is structured, but I so far can't figure out how to fix my mistakes. Can anyone provide any suggestions?</p>\n<h3>Update</h3>\n<p>Perl code reformatted for legibility</p>\n<pre class=\"lang-perl prettyprint-override\"><code>use warnings;\nuse strict;\n\n# Read in the complete FASTA file:\nprint &quot;What is the name of the fasta contig file?\\n&quot;;\nmy $fasta = &lt;STDIN&gt;;\nchomp $fasta;\n\n# Read in file of contig name, start pos, stop pos, SNP pos in tab delimited\ntext:\nprint &quot;Name of text file with contig name and SNP position info? \\n&quot;;\nmy $text = &lt;STDIN&gt;;\nchomp $text;\n\n#Output file\nprint &quot;What are we calling the output? \\n&quot;;\nmy $out = &lt;STDIN&gt;;\nchomp $out;\n\nlocal $/ = &quot;\\n&gt;&quot;;    # Read by FASTA record\n\nmy $seq1 = ();\n\nopen( FASTA, $fasta ) || die &quot;\\n Unable to open the file!\\n&quot;;\nopen( POS,   $text )  || die &quot;\\n Unable to open the file! \\n&quot;;\n\nmy @fields = &lt;POS&gt;;\n\nwhile ( my $seq = &lt;FASTA&gt; ) {\n\n    chomp $seq;\n    my @seq = split( /\\n/, $seq );\n\n    if ( $seq[0] =~ /^&gt;/ ) {\n        $seq1 = $seq[0];\n    }\n    elsif ( $seq[0] =~ /[^&gt;]/ ) {    # matches any character except the &gt;\n        $seq1 = &quot;&gt;&quot; . $seq[0];\n    }\n\n    for my $pos ( @fields ) {\n        chomp $pos;\n        my @field = split( /\\t/, $pos );\n        \n        open( OUTFILE, &quot;&gt;&gt;$out&quot; );\n        print OUTFILE &quot;$seq1&quot;;\n\n        my $subseq = substr $seq[1], $field[1] - 1, $field[2] - $field[1];\n        print OUTFILE &quot;$subseq\\n&quot;;\n    }\n}\n\nclose FASTA;\nclose POS;\nclose OUTFILE;\n</code></pre>\n"}, {"tags": ["bash", "perl", "unix"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 2, "creation_date": 1513803439, "post_id": 47914179, "comment_id": 82796339, "body": "Please show us what you have tried?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 5, "creation_date": 1513815956, "post_id": 47914179, "comment_id": 82800497, "body": "<i>Stack Overflow</i> isn&#39;t a source of free programming effort (although there are always people who value their own points count beyond the integrity if the site). Sometimes, no matter how well you know your job, you will come across situations that you cannot surpass. Languages, libraries and systems always have undocumented corners, and there is occasionally a bug that makes nonsense of what documentation there is. Such situations can often be resolved only by  persistence and dogged refusal to accept defeat. It is in situations like that where <i>Stack Overflow</i> comes into its own."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513816510, "post_id": 47914179, "comment_id": 82800630, "body": "But it doesn&#39;t look like you&#39;re in a situation like that. As far as I know you may be completely unable to write a line of code. If that&#39;s the case then please don&#39;t just take a chance on getting the attention of someone who will answer any question thrown at them for the sake of a few points. Instead, please do what you would if you needed any other professional advice: seek out someone who can help you and pay them a fair fee for their trouble. &quot;Mates rates&quot; apply only to a select few friends and acquaintances, and asking for professional help from a world of complete strangers is just rude."}], "answers": [{"tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": false, "score": 0, "last_activity_date": 1513804255, "creation_date": 1513804255, "answer_id": 47914402, "question_id": 47914179, "link": "https://stackoverflow.com/questions/47914179/manipulating-lines-in-a-text-file/47914402#47914402", "title": "Manipulating lines in a text file", "body": "<pre><code>use strict;\nuse warnings;\n\nmy @out;\nwhile (my $line = &lt;DATA&gt;) {\n    chomp $line;\n    # regex to check for NUMBER ^Y; \n    if ($line =~ /^\\d+\\s+\\^Y/) {\n        push @out, $line;\n    } else {\n        # append to the last element of the array\n        $out[-1] .= ' *chars to add* '.$line;\n    }\n}\n\nprint $_.\"\\n\" for @out;\n\n__DATA__\n1234  ^Y DATA ^Y DATA\n1235  ^Y DATA ^Y DATA\n1236  ^Y DATA ^Y DATA\n/text text\n/more text\n1237  ^Y DATA ^Y DATA\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513879789, "post_id": 47914647, "comment_id": 82829562, "body": "awk wasn&#39;t an option. If you&#39;re going to post awk solutions the please refrain from opening with <i>to the rescue</i> which adds nothing except to saythat you don&#39;t know Perl. You should also properly document your code and describe it limitations and usage on the command line."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513881589, "post_id": 47914647, "comment_id": 82830430, "body": "for a new joiner, lack of <code>awk</code> tag may mean the lack of knowledge that it exists. <code>awk</code> predates <code>perl</code> a decade and much easier to learn. My answers here have nothing to do whether I use/like/know <code>perl</code> or not.  I definitely appreciate its <code>regex</code> capabilities."}, {"owner": {"reputation": 21, "user_id": 9124480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6042283eafbcc4d576705bd5b8642b37?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/9124480/mike"}, "edited": false, "score": 1, "creation_date": 1514398843, "post_id": 47914647, "comment_id": 82961790, "body": "Thanks for not flaming my first post on this site. I tried your command like this:  awk &#39;{if(/\\^Y/){if(p) print p; p=$0} else p=p $0}   END{print p}&#39; &lt;MY_FILENAME&gt;  I get:  awk: syntax error near line 1 awk: illegal statement near line 1 awk: syntax error near line 1 awk: bailing out near line 1  I&#39;ll pay someone if it can be done correctly, because that is what I need."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1514401807, "post_id": 47914647, "comment_id": 82962970, "body": "it should work as is if you copy/pasted it into a bash shell with you input file.  If you&#39;re not familiar with CLI, perhaps ask a friend/colleague to get you started."}, {"owner": {"reputation": 21, "user_id": 9124480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6042283eafbcc4d576705bd5b8642b37?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/9124480/mike"}, "edited": false, "score": 0, "creation_date": 1514402822, "post_id": 47914647, "comment_id": 82963388, "body": "Perhaps the issue is because the delimiter ^Y is actually hex 19 in the file?"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1513805511, "creation_date": 1513805511, "answer_id": 47914647, "question_id": 47914179, "link": "https://stackoverflow.com/questions/47914179/manipulating-lines-in-a-text-file/47914647#47914647", "title": "Manipulating lines in a text file", "body": "<p><code>awk</code> to the rescue!</p>\n\n<pre><code>$ awk '{if(/\\^Y/){if(p) print p; p=$0} else p=p $0} \n    END{print p}' file\n\n1234  ^Y DATA ^Y DATA\n1235  ^Y DATA ^Y DATA\n1236  ^Y DATA ^Y DATA/text text/more text\n1237  ^Y DATA ^Y DATA\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2415, "user_id": 4251338, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/UNbCO.png?s=128&g=1", "display_name": "ssr1012", "link": "https://stackoverflow.com/users/4251338/ssr1012"}, "is_accepted": false, "score": 0, "last_activity_date": 1585058645, "creation_date": 1585058645, "answer_id": 60832662, "question_id": 47914179, "link": "https://stackoverflow.com/questions/47914179/manipulating-lines-in-a-text-file/60832662#60832662", "title": "Manipulating lines in a text file", "body": "<p>Here we are using <code>s</code> modifier to check and remove the entermark before the not equal to number which is starting from the line.</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy $text = do { local $/; &lt;DATA&gt; };\n\n$text=~s/\\n([^\\d])/ &lt;INSERT TEXT&gt; $1/sg;\n\nprint $text;\n\n__DATA__\n1234  ^Y DATA ^Y DATA\n1235  ^Y DATA ^Y DATA\n1236  ^Y DATA ^Y DATA\n/text text\n/more text\n1237  ^Y DATA ^Y DATA\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>1234  ^Y DATA ^Y DATA\n1235  ^Y DATA ^Y DATA\n1236  ^Y DATA ^Y DATA &lt;INSERT TEXT&gt; /text text &lt;INSERT TEXT&gt; /more text\n1237  ^Y DATA ^Y DATA\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9124480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6042283eafbcc4d576705bd5b8642b37?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/9124480/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 3, "score": -7, "last_activity_date": 1585058645, "creation_date": 1513803084, "question_id": 47914179, "link": "https://stackoverflow.com/questions/47914179/manipulating-lines-in-a-text-file", "title": "Manipulating lines in a text file", "body": "<p>I have a text file with the following:</p>\n\n<pre><code>1234  ^Y DATA ^Y DATA\n1235  ^Y DATA ^Y DATA\n1236  ^Y DATA ^Y DATA\n/text text\n/more text\n1237  ^Y DATA ^Y DATA\n</code></pre>\n\n<p>Line numbers 4 and 5 belong at the end of line 3, but they are written as newlines in the text file. Is there a way to append the previous line if it does not adhere to NUMBER ^Y, as well as add a specific set of characters when this happens?</p>\n\n<p>^Y is the field delimiter in this case.</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513801549, "post_id": 47913737, "comment_id": 82795424, "body": "using <code>pp</code>, I&#39;ve sometimes had to explicitly include modules in the command i.e. <code>pp -M Crypt::SSLeay -o script.exe script.pl</code> not sure why that is, but can&#39;t hurt to try"}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 1, "creation_date": 1513817540, "post_id": 47913737, "comment_id": 82800843, "body": "I suspect SSLeay.dll depends on an openssl dll; maybe see what <code>dumpbin &#47;dependents SSLeay.dll</code> says on your system?"}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1513817703, "post_id": 47913737, "comment_id": 82800883, "body": "here&#39;s someone who got it working, albeit 13 years ago: <a href=\"http://www.tek-tips.com/viewthread.cfm?qid=972688\" rel=\"nofollow noreferrer\">tek-tips.com/viewthread.cfm?qid=972688</a>"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 2, "creation_date": 1513854518, "post_id": 47913737, "comment_id": 82814810, "body": "Please don&#39;t show us images of text. How is that supposed to be useful? Your error messages are text - so why not just include the text in your question?"}], "answers": [{"tags": [], "owner": {"reputation": 113221, "user_id": 100754, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7804ebae32fbadef38537d74a915c22f?s=128&d=identicon&r=PG", "display_name": "Sinan &#220;n&#252;r", "link": "https://stackoverflow.com/users/100754/sinan-%c3%9cn%c3%bcr"}, "is_accepted": false, "score": 2, "last_activity_date": 1513960255, "creation_date": 1513960255, "answer_id": 47944605, "question_id": 47913737, "link": "https://stackoverflow.com/questions/47913737/why-does-a-packed-perl-script-not-work-on-a-different-machine/47944605#47944605", "title": "Why does a packed Perl script not work on a different machine?", "body": "<p>First off, <a href=\"https://metacpan.org/pod/Crypt::SSLeay#DO-YOU-NEED-Crypt::SSLeay?\" rel=\"nofollow noreferrer\">you probably do not need and should not use Crypt::SSLeay</a>. However, both the modern <a href=\"https://metacpan.org/pod/Net::SSLeay\" rel=\"nofollow noreferrer\">Net::SSLeay</a> and <code>Crypt::SSLeay</code> require <a href=\"https://www.openssl.org/\" rel=\"nofollow noreferrer\">OpenSSL</a> binaries to be installed on the machine to run.</p>\n\n<blockquote>\n  <p>both will create executables that run just fine on the machine I'm using that has perl, but whenever I transfer it to a different computer I get the error ...</p>\n</blockquote>\n\n<p>That's because the target machine does not have <code>OpenSSL</code> installed in the same location on which compiled the modules you are bundling.</p>\n"}], "owner": {"reputation": 9, "user_id": 9124326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fu2XM.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/9124326/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513960377, "creation_date": 1513800901, "last_edit_date": 1513960377, "question_id": 47913737, "link": "https://stackoverflow.com/questions/47913737/why-does-a-packed-perl-script-not-work-on-a-different-machine", "title": "Why does a packed Perl script not work on a different machine?", "body": "<p>I have been trying to compile a script that was written in perl by someone other than myself into an executable format that can be used without having perl installed. There seems to be some sort of issue with <code>Crypt::SSLeay</code> packaging but I'm not sure what the error means. Here is a <a href=\"https://i.stack.imgur.com/g3FBM.png\" rel=\"nofollow noreferrer\">screenshot of the error message</a>.</p>\n\n<p>I've tried using PAR <code>pp</code> and <code>cava</code> to package, both will create executables that run just fine on the machine I'm using that has perl, but whenever I transfer it to a different computer I get the error seen in the screenshot. It's been the same error each time after changing compiler settings, and I'm not sure what to do at this point. If I have left anything out that may assist in answer please let me know and I will be happy to provide, coding is not my field so I am still learning and this is my first encounter with Perl. </p>\n"}, {"tags": ["perl", "text", "replace"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 3, "creation_date": 1513791141, "post_id": 47911342, "comment_id": 82790487, "body": "(1) How is the &quot;<i>text below</i>&quot; (the <code>DIFF_COEFF</code> and the following 5 lines) distinguished from the &quot;<i>other text</i>&quot;? For example, what follows the last line with numbers? (2) Do you need to multiply each number by 2, as in the example, or to literally replace by text?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513791916, "post_id": 47911342, "comment_id": 82790881, "body": "Does the list of values really end with a comma?"}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 3, "creation_date": 1513792678, "post_id": 47911342, "comment_id": 82791288, "body": "Drop the <code>&#47;</code> at the end of your replacement, i.e. <code>s:\u2026:\u2026:igs</code>, not <code>s:\u2026:\u2026:&#47;igs</code>."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513795128, "post_id": 47911342, "comment_id": 82792466, "body": "So you don&#39;t want to do calculations, you just want to literally replace?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513798607, "post_id": 47911342, "comment_id": 82794126, "body": "This sounds like a job for a text editor."}, {"owner": {"reputation": 161, "user_id": 3798292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556ddc89758d8208d780fdf04f5acfa?s=128&d=identicon&r=PG&f=1", "display_name": "PeterW", "link": "https://stackoverflow.com/users/3798292/peterw"}, "edited": false, "score": 0, "creation_date": 1513808771, "post_id": 47911342, "comment_id": 82798531, "body": "Thanks for the comments. To respond to them in turn:  - the text below the DIFF_COEFF lines is unfortunately very similar to the lines shown (it differs only in that it starts with DIFF_COEFF_Q) - I need to search and replace the specific lines shown. - I will usually be multiplying the numbers, so a way to get the result by doing a calculation would be helpful. But the more general method of replacing the text would be valuable for cases when I don&#39;t just want to multiply the numbers. - yes the list ends in a comma. ..."}, {"owner": {"reputation": 161, "user_id": 3798292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556ddc89758d8208d780fdf04f5acfa?s=128&d=identicon&r=PG&f=1", "display_name": "PeterW", "link": "https://stackoverflow.com/users/3798292/peterw"}, "edited": false, "score": 0, "creation_date": 1513808838, "post_id": 47911342, "comment_id": 82798565, "body": "... - if I drop the slash, it gets rid of the error message, so thanks for pointing that out. But then the perl command does not change the file. - I will have to do this many times, so a scripted solution would be preferred to a text editor."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513811741, "post_id": 47911342, "comment_id": 82799409, "body": "So you need to replace text from <code>DIFF_COEFF</code> to <code>DIFF_COEFF_Q</code>? That&#39;s good, it is unambigous.  Where does the replacement text for each such passage (that is to be replaced) come from?  I presume that there are multiple ones, and that it&#39;s not always the same text?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513812594, "post_id": 47911342, "comment_id": 82799648, "body": "Can these files ever be huge?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513814412, "post_id": 47911342, "comment_id": 82800094, "body": "Also: I suggest to edit your question and add those clarifications."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513877073, "post_id": 47911342, "comment_id": 82828279, "body": "<i>&quot;the text below the <code>DIFF_COEFF</code> lines is unfortunately very similar to the lines shown&quot;</i> You seem reluctant to reveal anything but the most trivial of information, and <b>zdim</b> is hinting about what may be useful. The data that you want to replace is only part of a file, and from what you&#39;ve written that file may contain identical data in many formats. It is most unlikely that a simple (very long) string replacement will do what you want, and in general you must <i>parse</i> the data to extract its semantics, modify that data, and reencode the result. Anything less would be a stab in the dark."}, {"owner": {"reputation": 161, "user_id": 3798292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556ddc89758d8208d780fdf04f5acfa?s=128&d=identicon&r=PG&f=1", "display_name": "PeterW", "link": "https://stackoverflow.com/users/3798292/peterw"}, "edited": false, "score": 1, "creation_date": 1513898360, "post_id": 47911342, "comment_id": 82837285, "body": "Borodin - Why reluctant? I have answered everyone&#39;s questions as I understood them. I presume you don&#39;t want me to paste the whole text file here, so I said what I thought would be important. &quot;The text below the DIFF_COEFF lines is unfortunately very similar to the lines shown (it differs only in that it starts with DIFF_COEFF_Q)&quot; is unambiguous about what the text below is as far as I can see. This was sufficient for zdim to provide a solution. A long string replacement worked perfectly. The pieces of text I mentioned are not repeated, if that&#39;s what you&#39;re getting at (it&#39;s not clear)."}], "answers": [{"comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513933933, "post_id": 47915948, "comment_id": 82846527, "body": "@PeterW Added code for the other ways that were mentioned."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": true, "score": 1, "last_activity_date": 1514080530, "last_edit_date": 1514080530, "creation_date": 1513813778, "answer_id": 47915948, "question_id": 47911342, "link": "https://stackoverflow.com/questions/47911342/replace-multiple-lines-in-text-file/47915948#47915948", "title": "Replace multiple lines in text file", "body": "<p>Copy the file over to a new one, except that within the range of text between these markers drop the replacement text instead.  Then move that file to replace the original, as it may be needed judging by the attempted <code>perl -0 -i</code> in the question.</p>\n\n<p>Note that when changing a file we have to build new content and then replace the file. There are a few ways to do this and modules that make it easier, shown further below.</p>\n\n<p>The code below uses the <a href=\"https://perldoc.perl.org/perlop.html#Range-Operators\" rel=\"nofollow noreferrer\">range operator</a> and the fact that it returns the counter for lines within the range, <code>1</code> for the first and the number ending with <code>E0</code> for the last. So we don't copy lines inside that region while we write the replacement text (and the post-region-end marker) on the last line.</p>\n\n<p>I consider the region of interest to end right before <code>DIFF_COEFF_Q=</code> line, per the question edit.</p>\n\n<pre><code>use warnings;\nuse strict;\nuse feature 'say';\nuse File::Copy 'move';\n\nmy $replacement = \"replacement text\";\n\nmy $file     = 'input.txt';\nmy $out_file = 'new_' . $file;\n\nopen my $fh_out, '&gt;', $out_file or die \"Can't open $out_file: $!\";\nopen my $fh,     '&lt;', $file     or die \"Can't open $file: $!\";\n\nwhile (&lt;$fh&gt;) \n{\n    if (my $range_cnt = /^\\s*DIFF_COEFF\\s*=/ .. /^\\s*DIFF_COEFF_Q\\s*=/) #/\n    {\n        if ($range_cnt =~ /E0$/)\n        {\n            print $fh_out $replacement;  # may need a newline\n            print $fh_out $_;         \n        }\n    }   \n    else { \n        print $fh_out $_; \n    }\n}\nclose $fh     or die \"Can't close $file: $!\";      # don't overwrite original\nclose $fh_out or die \"Can't close $out_file: $!\";  # if there are problems\n\n#move $out_file, $file or die \"Can't move $file to $out_file: $!\";\n</code></pre>\n\n<p>Uncomment the <code>move</code> line once this has been tested well enough on your actual files, if you want to replace the original. You may or may not need a newline after <code>$replacement</code>, depending on it.</p>\n\n<p>An alternative is to use flags for entering/leaving that range. But this won't be cleaner since there are two distinct actions, to stop copying when entering the range and write replacement when leaving. Thus multiple flags need be set and checked, what may end up messier.</p>\n\n<p>If the files can't ever be huge it is simpler to read and process the file in memory. Then open the same file for writing and dump the new content</p>\n\n<pre><code>my $text = do {  # slurp file into a scalar\n    local $/; \n    open my $fh, '&lt;', $file or die \"Can't open $file: $!\"; \n    &lt;$fh&gt; \n};\n\n$text =~ s/^\\s*DIFF_COEFF\\s*=.*?(\\n\\s*DIFF_COEFF_Q)/$replacement$1/ms;\n\n# Change $out_file to $file to overwrite\nopen my $fh_out, '&gt;', $out_file or die \"Can't open $out_file: $!\";\nprint $fh_out $text;\n</code></pre>\n\n<p>Here <code>/m</code> modifier is for <em>multiline mode</em> in which we can use <code>^</code> for the beginning of a line (not the whole string), what is helpful here. The <code>/s</code> makes <code>.</code> match a newline, too. Also note that we can slurp a file with <code>Path::Tiny</code> as simply as: &nbsp;<code>my $text = path($file)-&gt;slurp;</code></p>\n\n<p>Another option is to use <a href=\"http://search.cpan.org/~dagolden/Path-Tiny-0.104/lib/Path/Tiny.pm\" rel=\"nofollow noreferrer\">Path::Tiny</a>, which in newer versions has <a href=\"http://search.cpan.org/~dagolden/Path-Tiny-0.104/lib/Path/Tiny.pm#edit,_edit_raw,_edit_utf8\" rel=\"nofollow noreferrer\">edit</a> and <a href=\"http://search.cpan.org/~dagolden/Path-Tiny-0.104/lib/Path/Tiny.pm#edit_lines,_edit_lines_utf8,_edit_lines_raw\" rel=\"nofollow noreferrer\">edit_lines</a> methods</p>\n\n<pre><code>use Path::Tiny;\n                      # NOTE: edits $file in place (changes it)\npath($file)-&gt;edit( \n    sub { s/DIFF_COEFF=.*?(\\n\\s*DIFF_COEFF_Q)/$replacement$1/s } \n);\n</code></pre>\n\n<p>For more on this see, for example, <a href=\"https://stackoverflow.com/a/42576026/4653379\">this post</a> and <a href=\"https://stackoverflow.com/a/42888459/4653379\">this post</a> and <a href=\"https://stackoverflow.com/a/46723567/4653379\">this post</a>.</p>\n\n<p>The first and last way change the inode number of the file. See <a href=\"https://stackoverflow.com/a/40269154/4653379\">this post</a> if that is a problem.</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 3798292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556ddc89758d8208d780fdf04f5acfa?s=128&d=identicon&r=PG&f=1", "display_name": "PeterW", "link": "https://stackoverflow.com/users/3798292/peterw"}, "edited": false, "score": 0, "creation_date": 1513849099, "post_id": 47921362, "comment_id": 82811436, "body": "Thanks Dave. You&#39;re right about my silly mistake. However, if I remove the final &#39;/&#39;, the result is that I now don&#39;t get the error message, but no change is made to the file."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 161, "user_id": 3798292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556ddc89758d8208d780fdf04f5acfa?s=128&d=identicon&r=PG&f=1", "display_name": "PeterW", "link": "https://stackoverflow.com/users/3798292/peterw"}, "edited": false, "score": 1, "creation_date": 1513850035, "post_id": 47921362, "comment_id": 82812023, "body": "@PeterW: I think we&#39;ve answered your question. I suggest you accept an answer here and post a new question with more details about exactly what you&#39;re trying to do."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 1, "last_activity_date": 1513874600, "last_edit_date": 1513874600, "creation_date": 1513846678, "answer_id": 47921362, "question_id": 47911342, "link": "https://stackoverflow.com/questions/47911342/replace-multiple-lines-in-text-file/47921362#47921362", "title": "Replace multiple lines in text file", "body": "<p>It's an interesting error that you've made and I can see what has led you to make it. But I don't think I've ever seen anyone else make the same mistake :-)</p>\n\n<p>Your substitution statement is this:</p>\n\n<pre><code>s:\\Q${s_orig}\\E:${s_new}:/igs\n</code></pre>\n\n<p>So you've decided to use <code>:</code> as the delimiter of the substitution operator. But you want to use the options <code>i</code>, <code>g</code> and <code>s</code> and everywhere you've seen people talk about options on a substitution operator, they talk about using <code>/</code> to introduce the options. So you've added <code>/igs</code> to your substitution operator.</p>\n\n<p>But what you've missed (and I completely understand why) is that the <code>/</code> that comes before the options is actually the closing delimiter of the standard, <code>s/.../.../</code>, version of the substitution operator. If you change the delimiter (as you have done) then your altered closing delimiter is all you need.</p>\n\n<p>In your case, Perl doesn't expect the <code>/</code> as it has already seen the closing delimiter. It, therefore, decides that the <code>/</code> is a division operator and tries to divide the result of your substitution by <code>igs</code>. It interprets <code>igs</code> as zero and you get your error.</p>\n\n<p>The fix is to remove that <code>/</code> so:</p>\n\n<pre><code>s:\\Q${s_orig}\\E:${s_new}:/igs\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>s:\\Q${s_orig}\\E:${s_new}:igs\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 3798292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556ddc89758d8208d780fdf04f5acfa?s=128&d=identicon&r=PG&f=1", "display_name": "PeterW", "link": "https://stackoverflow.com/users/3798292/peterw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 47915948, "answer_count": 2, "score": 0, "last_activity_date": 1514080530, "creation_date": 1513790569, "last_edit_date": 1513870265, "question_id": 47911342, "link": "https://stackoverflow.com/questions/47911342/replace-multiple-lines-in-text-file", "title": "Replace multiple lines in text file", "body": "\n\n<p>I have text files containing the text below (amongst other text)</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>DIFF_COEFF= 1.000e+07,1.000e+07,1.000e+07,1.000e+07,\n1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,\n1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,\n1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,\n1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,\n1.000e+07,1.000e+07,1.000e+07,1.000e+07,1.000e+07,4.000e+05,\n</code></pre>\n\n<p>and I need to replace it with the following text:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>DIFF_COEFF= 2.000e+07,2.000e+07,2.000e+07,2.000e+07,\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,8.000e+05,\n</code></pre>\n\n<p>Each line above corresponds to a new line in the text file.</p>\n\n<p>After some googling, I thought making use of Perl in the following might work, but it did not. I got the error message</p>\n\n<blockquote>\n  <p>Illegal division by zero at -e line 1, &lt;> chunk 1</p>\n</blockquote>\n\n<pre class=\"lang-none prettyprint-override\"><code>s_orig='DIFF_COEFF=*4.000e+05,'\n\ns_new='DIFF_COEFF= 2.000e+07,2.000e+07,2.000e+07,2.000e+07,\\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,\\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,\\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,\\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,\\n2.000e+07,2.000e+07,2.000e+07,2.000e+07,2.000e+07,8.000e+05,'\n\nperl -0 -i -pe \"s:\\Q${s_orig}\\E:${s_new}:/igs\" file.txt\n</code></pre>\n\n<p>Does anyone here know the right way to do this?</p>\n\n<p>Edit - some more details: the text after this block is \"DIFF_COEFF_Q=\" followed by the same set of numbers, so I need to search for and replace the specific lines shown. The text files are not very large in size.</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1513785429, "post_id": 47909787, "comment_id": 82787352, "body": "Hard to tell what you&#39;re asking, but if UtilModule isn&#39;t a submodule within UsedEverywhereMod, why is it in a subdirectory of it? And if it is, then you just use it like normal ie <code>use UsedEverywhereMod::Something::UtilModule;</code>"}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1513785605, "post_id": 47909787, "comment_id": 82787455, "body": "If you have several <code>lib</code> directories and you want to include modules from all of them, add all the directories to <code>PERL5LIB</code>, or run <code>perl -I lib1 -I lib2</code>, or symlink the needed modules for each program to its lib and use just that, or ..."}], "owner": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1513788998, "answer_count": 0, "score": 0, "last_activity_date": 1513787885, "creation_date": 1513784792, "last_edit_date": 1513787885, "question_id": 47909787, "link": "https://stackoverflow.com/questions/47909787/including-a-module-from-another-module", "closed_reason": "Duplicate", "title": "Including a module from another module", "body": "<p>This is a pretty basic requirement, but I don't really know the \"right way\" to get this to happen, even though I've gotten it to work in practice.</p>\n\n<p>Say you have a Perl module that you know will be used by multiple programs within the same overall environment. That module needs to include a second utilities module, say in a subdirectory of the directory containing the first module. How do you make sure Perl can always find it?</p>\n\n<p><code>FindBin</code> comes to mind, but if your modules will be used by multiple programs in potentially different directories, you can't just say <code>use lib $RealBin/path/to/subdir</code>.</p>\n\n<p>What I really need is something that says <code>use lib [location of module 1]/path/to/module2</code>. But I don't know how to do that, or whether that would be considered bad practice.</p>\n"}, {"tags": ["perl", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 4111, "user_id": 23033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b6c69cae4d2061cafe851676f8d262?s=128&d=identicon&r=PG", "display_name": "Dre", "link": "https://stackoverflow.com/users/23033/dre"}, "edited": false, "score": 0, "creation_date": 1513789117, "post_id": 47908736, "comment_id": 82789437, "body": "Adding the curly braces around <code>local $YAML::Numify = 1;</code> without moving anything else completely removes its point. <code>$YAML::Numify</code> will no longer have that value as soon as Perl hits the <code>}</code>.  You will have to move the <code>LoadFile</code> call inside the block if that is what you intend.  Even with that corrected, the value of <code>::Numify</code> seems to make no difference."}], "tags": [], "owner": {"reputation": 962, "user_id": 4204127, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1241595301/picture?type=large", "display_name": "Ed Dunn", "link": "https://stackoverflow.com/users/4204127/ed-dunn"}, "is_accepted": true, "score": 2, "last_activity_date": 1513782302, "last_edit_date": 1513782302, "creation_date": 1513781651, "answer_id": 47908736, "question_id": 47907095, "link": "https://stackoverflow.com/questions/47907095/force-yamltiny-values-to-be-numbers/47908736#47908736", "title": "Force YAML::Tiny values to be numbers", "body": "<p>There does not seem to be a way around this and looks like a bug has been submitted here --- </p>\n\n<p><a href=\"https://rt.cpan.org/Public/Bug/Display.html?id=111027\" rel=\"nofollow noreferrer\">YAML::Tiny</a></p>\n\n<p>However this can be accomplished using YAML like so:</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse warnings;\nuse strict;\nuse YAML;\n\n{\n    no warnings;\n    local $YAML::Numify = 1;\n}\n\nmy $file = YAML::LoadFile('test.yml');\n\nopen my $fh, '&gt;', 'output.yml';\nprint $fh YAML::Dump $file;\nclose($fh);\n</code></pre>\n\n<ul>\n<li>Using warnings produces a message, wrapping the local YAML::Numify is curly braces with no warnings suppresses this.  The output is indeed as expected either way</li>\n</ul>\n\n<p><strong>test.yml</strong></p>\n\n<pre><code>---\ntask:\n  '1':\n    desc: '85'\n    command: '&lt;task1_command&gt;'\n  2:\n    desc: '100'\n    command: '&lt;task2_command&gt;'\n</code></pre>\n\n<p><strong>output.yml</strong></p>\n\n<pre><code>---\ntask:\n  1:\n    command: '&lt;task1_command&gt;'\n    desc: 85\n  2:\n    command: '&lt;task2_command&gt;'\n    desc: 100\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1513789133, "post_id": 47910734, "comment_id": 82789442, "body": "You&#39;re right, everything is just fine with the application behaviour... the problem is that the application can change some tasks values and when it recreates the YAML file ($TASKS-&gt;write(&lt;YAML_file&gt;)) the single quotes are unnecessarily added to all tasks numbers."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1513791687, "post_id": 47910734, "comment_id": 82790763, "body": "@Marcelo: And is that a problem to the receiving program, or do you just not like it?"}, {"owner": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1513793451, "post_id": 47910734, "comment_id": 82791680, "body": "It&#39;s not a big problem (the file with quotes works the same way) but sometimes people execute a &quot;diff&quot; between files and find a lot of &quot;differences&quot; due to these added quotes."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1513799266, "post_id": 47910734, "comment_id": 82794409, "body": "@Marcelo: Then I suggest you should change whatever is creating the source YAML to use strings instead, then everyone is happy. What language is the target of this new YAML data written in? Many languages allow only strings for the keys of their dictionary-like structures and, like Perl, there is no way to generate YAML with numeric keys. If all else fails then you could just post-process it with <code>perl -i -pe &#39;s&#47;^\\s*\\K&#39;(\\d+)&#39;:&#47;$1:&#47;&#39; myfile.yaml</code> or warn people that that may be necessary before a <code>diff</code>."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "edited": false, "score": 1, "creation_date": 1513799916, "post_id": 47910734, "comment_id": 82794684, "body": "@Marcelo: Note that, in particular, it is a very bad idea to compare two YAML data structures using <code>diff</code>, as the same data may be represented in many different ways. The simplest example is that the order of keys within a mapping is irrelevant to the semantics, so they may appear in any order and remain equivalent. A useful alternative would be to write a simple Perl tool <code>yaml_diff</code> that used <a href=\"https://metacpan.org/pod/Data::Diff\" rel=\"nofollow noreferrer\"><code>Data::Diff</code></a> to read and compare the contents of two YAML files. That sounds like the best solution over all to me."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1513800009, "post_id": 47910734, "comment_id": 82794723, "body": "@Marcelo: A quick google reveals <a href=\"https://github.com/sahilm/yamldiff\" rel=\"nofollow noreferrer\"><code>yamldiff</code></a>"}, {"owner": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1513817891, "post_id": 47910734, "comment_id": 82800916, "body": "Thanks a lot for your very useful suggestions, I voted +1 to your answer."}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 2, "last_activity_date": 1513788244, "creation_date": 1513788244, "answer_id": 47910734, "question_id": 47907095, "link": "https://stackoverflow.com/questions/47907095/force-yamltiny-values-to-be-numbers/47910734#47910734", "title": "Force YAML::Tiny values to be numbers", "body": "<p>The <code>1</code> and <code>2</code> in your data are used as hash keys in the corresponding Perl data structure, and so always have to be strings. The result of your <code>read</code> call will be this</p>\n\n<pre><code>bless([\n  {\n    task =&gt; {\n      1 =&gt; { command =&gt; \"&lt;task1_command&gt;\", desc =&gt; \"&lt;task1_description&gt;\" },\n      2 =&gt; { command =&gt; \"&lt;task2_command&gt;\", desc =&gt; \"&lt;task2_description&gt;\" },\n    },\n  },\n], \"YAML::Tiny\")\n</code></pre>\n\n<p>However, Perl will always do the right thing if you just use a numeric string as if it were a number, so I'm wondering what it is about your application that requires these values to be \"numbers\"</p>\n"}], "owner": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 47908736, "answer_count": 2, "score": 3, "last_activity_date": 1513788244, "creation_date": 1513776354, "last_edit_date": 1513783835, "question_id": 47907095, "link": "https://stackoverflow.com/questions/47907095/force-yamltiny-values-to-be-numbers", "title": "Force YAML::Tiny values to be numbers", "body": "<p>Suppose I've the following YAML file:</p>\n\n<pre><code>---\ntask:\n  1:\n    command: '&lt;task1_command&gt;'\n    desc: '&lt;task1_description&gt;'\n  2:\n    command: '&lt;task2_command&gt;'\n    desc: '&lt;task2_description&gt;'\n</code></pre>\n\n<p>I read the file using Perl and YAML::Tiny:</p>\n\n<pre><code>$TASKS = YAML::Tiny-&gt;read(&lt;YAML_file&gt;);\n</code></pre>\n\n<p>And I'm able to use the desc/command values normally but if I write the TASKS data using:</p>\n\n<pre><code>$TASKS-&gt;write(&lt;YAML_file&gt;);\n</code></pre>\n\n<p>I got the following:</p>\n\n<pre><code>---\ntask:\n  '1':\n    command: '&lt;task1_command&gt;'\n    desc: '&lt;task1_description&gt;'\n  '2':\n    command: '&lt;task2_command&gt;'\n    desc: '&lt;task2_description&gt;'\n</code></pre>\n\n<p>The task numbers are between single quotes! Is there a way to \"force\" YAML::Tiny to treat the tasks values as \"numbers\" instead of \"strings\"?</p>\n"}, {"tags": ["perl", "visual-c++", "swig", "perl-module"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514374104, "post_id": 47904536, "comment_id": 82950958, "body": "What&#39;s the <i>Perl</i> package and version you have installed (as there are many) ? Also please post the full error, and if possible the <i>compile</i> (and also <i>link</i>) command(s)."}], "owner": {"reputation": 379, "user_id": 4533661, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0c9c418921324d71b4d9b1380ab4990?s=128&d=identicon&r=PG&f=1", "display_name": "Semonit", "link": "https://stackoverflow.com/users/4533661/semonit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1513851836, "creation_date": 1513767719, "last_edit_date": 1513851836, "question_id": 47904536, "link": "https://stackoverflow.com/questions/47904536/swig-perl5-error-compiling-simplest-swig-module-with-vc15", "title": "Swig -&gt; Perl5 : Error compiling simplest SWIG-Module with VC15", "body": "<p>I have a quite simple Swig Module for Demo purposes but can't get the wrapper/stub to get compiled.</p>\n\n<p>Swigtest.h:</p>\n\n<pre><code>#pragma once\nclass Swigtest {\n\npublic:\n    Swigtest() {};\n    int func1(int param1);\n};\n</code></pre>\n\n<p>Swigtest.cpp</p>\n\n<pre><code>#include \"Swigtest.h\"\n\nint Swigtest::func1(int param1)\n{\n    return param1 + 1;\n}\n</code></pre>\n\n<p>Swigtest.i</p>\n\n<pre><code>%module Swigtest\n\n%{\n    #include \"Swigtest.h\"\n%}\n\n%include \"Swigtest.h\"\n</code></pre>\n\n<p>The wrapper ist generated with <code>swig.exe -c++ -perl5 Swigtest.i</code> and then the compilation of the wrapper <code>Swigtest_wrap.cxx</code> fails with the following first error:</p>\n\n<blockquote>\n  <p>[path_to_perl_lib]\\lib\\core\\win32.h(371): error C2061: syntax error: identifier 'STRLEN'</p>\n</blockquote>\n\n<p>I'm using VisualStudio 2015 Toolset (acutally running on VS17) with Target Platform Version 8.1 and Swigwin 3.0.12.</p>\n\n<p>Thank's for your help!</p>\n"}, {"tags": ["arrays", "perl", "extract"], "comments": [{"owner": {"reputation": 377, "user_id": 6583638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zobe.jpg?s=128&g=1", "display_name": "Flying_whale", "link": "https://stackoverflow.com/users/6583638/flying-whale"}, "edited": false, "score": 0, "creation_date": 1513760994, "post_id": 47901798, "comment_id": 82771335, "body": "can you add the line with the print and the result you got ? :)"}, {"owner": {"reputation": 2415, "user_id": 4251338, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/UNbCO.png?s=128&g=1", "display_name": "ssr1012", "link": "https://stackoverflow.com/users/4251338/ssr1012"}, "edited": false, "score": 0, "creation_date": 1513761903, "post_id": 47901798, "comment_id": 82771878, "body": "its a tab delimit?"}, {"owner": {"reputation": 377, "user_id": 6583638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zobe.jpg?s=128&g=1", "display_name": "Flying_whale", "link": "https://stackoverflow.com/users/6583638/flying-whale"}, "edited": false, "score": 0, "creation_date": 1513762419, "post_id": 47901798, "comment_id": 82772200, "body": "yeah, forgot that, if the &quot;space&quot; can vary between all possibles espacements (tab, space, \\n, ...) use \\s+ instead of \\t ;) Don&#39;t think this is the reason your code fails, but it could be useful for further use :)"}, {"owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "edited": false, "score": 2, "creation_date": 1513764652, "post_id": 47901798, "comment_id": 82773657, "body": "<code>DATA</code> is a special file handle in perl. You probably shouldn&#39;t use that."}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 6583638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zobe.jpg?s=128&g=1", "display_name": "Flying_whale", "link": "https://stackoverflow.com/users/6583638/flying-whale"}, "edited": false, "score": 1, "creation_date": 1513766484, "post_id": 47903674, "comment_id": 82774868, "body": "woh, didn&#39;t know about hash slices, i will thank you even i&#39;m not the OP :) but I don&#39;t understand how the <code>split</code> in <code>@row{@header} = split;</code> is equivalent to <code>split(&#47;\\s+&#47;, $_)</code>"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 377, "user_id": 6583638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zobe.jpg?s=128&g=1", "display_name": "Flying_whale", "link": "https://stackoverflow.com/users/6583638/flying-whale"}, "edited": false, "score": 3, "creation_date": 1513772067, "post_id": 47903674, "comment_id": 82778348, "body": "@Flying_whale: I suggest you spend some time reading the <a href=\"https://perldoc.perl.org/functions/split.html\" rel=\"nofollow noreferrer\">documentation for split</a>. It makes it clear that a) omitting the string means that the contents of <code>$_</code> are split, b) omitting the pattern uses <code>&quot; &quot;</code> as the default pattern and that c) using <code>&quot; &quot;</code> as the pattern is equilvalent to using <code>\\s+</code>. (Using <code>&quot; &quot;</code> also removes leading whitespace - but that&#39;s not important in this example. Perl&#39;s standard documentation is clear and detailed. I recommend it highly."}, {"owner": {"reputation": 377, "user_id": 6583638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zobe.jpg?s=128&g=1", "display_name": "Flying_whale", "link": "https://stackoverflow.com/users/6583638/flying-whale"}, "reply_to_user": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1513772852, "post_id": 47903674, "comment_id": 82778842, "body": "thanks a lot @DaveCross :) I&#39;m kind of new to perl (less than 3 month) and I still have a lot to learn ;)"}, {"owner": {"reputation": 311, "user_id": 9097452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8073dda6ba748ee30788aed8a1e82f0d?s=128&d=identicon&r=PG", "display_name": "abraham", "link": "https://stackoverflow.com/users/9097452/abraham"}, "edited": false, "score": 0, "creation_date": 1513884481, "post_id": 47903674, "comment_id": 82831935, "body": "thanks so much, it is how I want it, I&#39;m learning perl by my self and some times it hard to me, again Thanks So Much to all of you  !!!!"}], "tags": [], "owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "is_accepted": false, "score": 4, "last_activity_date": 1513765128, "creation_date": 1513765128, "answer_id": 47903674, "question_id": 47901798, "link": "https://stackoverflow.com/questions/47901798/extract-multiples-columns-from-txt-file-perl/47903674#47903674", "title": "extract multiples columns from txt file perl", "body": "<p>You can simplify like this and using <a href=\"https://perldoc.perl.org/perldata.html#Slices\" rel=\"nofollow noreferrer\">hash slices</a>. </p>\n\n<pre><code>#!/usr/bin/env perl\nuse strict;\nuse warnings;\n\nmy @wanted = ( '#Genera' , qw (  columnA columnC columnN ));\n\nopen my $input, '&lt;', \"file.txt\" or die $!;\n\nchomp ( my @header = split ' ', &lt;$input&gt; ); \n\nprint join \"\\t\", @wanted, \"\\n\";\nwhile ( &lt;$input&gt; ) { \n   my %row;\n   @row{@header} = split; \n   print join \"\\t\", @row{@wanted}, \"\\n\";\n}\n</code></pre>\n\n<p>Which outputs: </p>\n\n<pre><code>#Genera columnA columnC columnN \nx1  1   7   2   \nx2  5   13  5   \nx3  0.1 7   0.4 \n</code></pre>\n\n<p>If you want to exactly match your indentation then add <code>sprintf</code> to the mix:</p>\n\n<p>E.g.:</p>\n\n<pre><code>print join \"\\t\", map { sprintf \"%8s\", $_} @wanted, \"\\n\";\nwhile ( &lt;$input&gt; ) { \n   my %row;\n   @row{@header} = split; \n   print join \"\\t\", map { sprintf \"%8s\", $_} @row{@wanted}, \"\\n\";\n}\n</code></pre>\n\n<p>Which then gives:</p>\n\n<pre><code> #Genera     columnA     columnC     columnN           \n      x1           1           7           2           \n      x2           5          13           5           \n      x3         0.1           7         0.4    \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 311, "user_id": 9097452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8073dda6ba748ee30788aed8a1e82f0d?s=128&d=identicon&r=PG", "display_name": "abraham", "link": "https://stackoverflow.com/users/9097452/abraham"}, "edited": false, "score": 0, "creation_date": 1513884835, "post_id": 47904625, "comment_id": 82832096, "body": "@abraham: Thank you: you&#39;re welcome. But you should eventually choose one of the answers and <i>accept</i> it if any of them has been useful to you."}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 2, "last_activity_date": 1513768052, "creation_date": 1513768052, "answer_id": 47904625, "question_id": 47901798, "link": "https://stackoverflow.com/questions/47901798/extract-multiples-columns-from-txt-file-perl/47904625#47904625", "title": "extract multiples columns from txt file perl", "body": "<p>This program does as you ask. It expects the path to the input file as a parameter on the command line, which can then be read using the empty \"diamond operator\" <code>&lt;&gt;</code> without explicitly opening it</p>\n\n<p>Each non-blank line of the file is split into fields, and the header line is identified by the first starting with a hash symbol <code>#</code></p>\n\n<p>A call to <code>map</code> converts the <code>@wanted_fields</code> array into a list of indexes into <code>@fields</code> where those column headers appear and stores it in array <code>@idx</code></p>\n\n<p>This array is then used to slice the wanted columns from <code>@fields</code> for every line of input. The fields are printed, separated by tabs</p>\n\n<pre><code>use strict;\nuse warnings 'all';\n\nuse List::Util 'first';\n\nmy @wanted_fields = qw/ columnA columnC columnN /;\n\nmy @idx;\n\nwhile ( &lt;&gt; ) {\n    next unless /\\S/;\n\n    my @fields = split;\n\n    if ( $fields[0] =~ /^#/ ) {\n\n        @idx = ( 0, map {\n            my $wanted = $_;\n            first { $fields[$_] eq $wanted } 0 .. $#fields;\n        } @wanted_fields );\n    }\n\n    print join( \"\\t\", @fields[@idx] ), \"\\n\" if @idx;\n}\n</code></pre>\n\n<h3>output</h3>\n\n<pre><code>#Genera columnA columnC columnN\nx1  1   7   2\nx2  5   13  5\nx3  0.1 7   0.4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": false, "score": 2, "last_activity_date": 1513803088, "creation_date": 1513803088, "answer_id": 47914181, "question_id": 47901798, "link": "https://stackoverflow.com/questions/47901798/extract-multiples-columns-from-txt-file-perl/47914181#47914181", "title": "extract multiples columns from txt file perl", "body": "<p>There are command line switches that are used for this kind of application:</p>\n\n<pre><code>perl -lnae 'print join \"\\t\", @F[1,3,5]' file.txt\n</code></pre>\n\n<p>Switch <code>-a</code> automatically creates variable <code>@F</code> for each line, split by whitespace. So <code>@F[1,3,5]</code> is an array slice of elements 1, 3, and 5. </p>\n\n<p>The downside of this, of course, is that you have to use the column numbers instead of the names. </p>\n"}], "owner": {"reputation": 311, "user_id": 9097452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8073dda6ba748ee30788aed8a1e82f0d?s=128&d=identicon&r=PG", "display_name": "abraham", "link": "https://stackoverflow.com/users/9097452/abraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1513803088, "creation_date": 1513759012, "question_id": 47901798, "link": "https://stackoverflow.com/questions/47901798/extract-multiples-columns-from-txt-file-perl", "title": "extract multiples columns from txt file perl", "body": "<p>I have a txt file like this: </p>\n\n<pre><code>#Genera columnA columnB columnC columnD columnN\nx1       1       3       7      0.9      2\nx2       5       3       13     7        5\nx3       0.1     0.8     7      1        0.4\n</code></pre>\n\n<p>and I want to extract X determinate number of columns, just suppose that we want columnA, columnC and columnN (this could be a matrix with  1, 2, 20, 100 or more columns) and What I want to print OUT (this example is just 3 but could be more):  </p>\n\n<pre><code>#Genera columnA columnC columnN\n    x1   1       7       2\n    x2   5       13      5\n    x3   0.1     7       0.4\n</code></pre>\n\n<p>I have tried </p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\n\n\nmy @wanted_fields = qw/columnA columnC columnN/;\n\nopen DATA, '&lt;', \"columns.txt\" or die \"cant open file\\n\";\n\n\nmy @datain = &lt;DATA&gt;;\nclose DATA;\n\nmy (@unit_name, $names, @lines, @conteo, @match_names, @columnas);\n\nforeach (@datain){\n    if ($_=~ m/^$/g)            {   next;           }\n    elsif ($_=~ m/#Genera/g)    {   $names= $_;     }\n    else                        {   push @lines, $_ }\n}\n\n\n@unit_name = split (/\\t/, $names);\nshift @unit_name;\nmy $count =0;\n\n    foreach (@wanted_fields){\n        my $unit_wanted =$_;\n        chomp $unit_wanted;\n        foreach (@unit_name){\n            if ($_ =~ m/$unit_wanted/g){\n                $count++;\n                 push (@conteo, $count);\n                 push (@match_names, $_);\n                }\n        }\n    }\n\n\n    foreach (@lines){\n        chomp;\n        @columnas = split (/\\t/, $_);\n            #push @xx, $columnas[0][3];\n\n    }\n</code></pre>\n\n<p>I used the count to determinate the column to extract but in this case the number 2 do no correspond to columnC and 3 do not correspond to columnN well...... it is a any simple way to select any given columns, in this case I just want 3 but depend of the case could be 1,2 5, 10, 100 or more columns.</p>\n\n<p>Thanks  </p>\n"}, {"tags": ["perl", "mocking"], "answers": [{"comments": [{"owner": {"reputation": 4644, "user_id": 1431720, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1431720/robert"}, "edited": false, "score": 0, "creation_date": 1513798364, "post_id": 47912355, "comment_id": 82794023, "body": "Thanks, that did it! Well, almost. It even makes a difference how you call the <code>Net::Twitter</code> constructor: without arguments, it&#39;s a <code>Net::Twitter_v4_01042_with__Legacy</code>, like you wrote, but if you pass <code>traits =&gt; [qw&#47;API::RESTv1_1&#47;]</code>, it&#39;s a <code>Net::Twitter_v4_01042_with__API_RESTv1_1</code>. So the constructor call in the code under test must match the mock object creation. Weird, even for Perl..."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 4644, "user_id": 1431720, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1431720/robert"}, "edited": false, "score": 0, "creation_date": 1513798511, "post_id": 47912355, "comment_id": 82794085, "body": "@Robert it&#39;s weird indeed. But th architecture is interesting. I suggest going through their github and reading the commit history to learn more about the architecture and why they made these decisions. I believe there are good reasons. Often this kind of complexity is overengineering, but from what I&#39;ve seen in there this might be pretty smart."}], "tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": true, "score": 5, "last_activity_date": 1513794810, "creation_date": 1513794810, "answer_id": 47912355, "question_id": 47898527, "link": "https://stackoverflow.com/questions/47898527/testmockmodule-claims-method-does-not-exist/47912355#47912355", "title": "Test::MockModule claims &quot;method does not exist&quot;", "body": "<p>The error message means that it can't find <code>Net::Twitter::update</code> to overwrite. That's pretty clear. The question is, <em>why?</em>.</p>\n\n<p>If you take a look at a <a href=\"https://metacpan.org/pod/Net::Twitter\" rel=\"noreferrer\">Net::Twitter</a> object with <a href=\"https://metacpan.org/pod/Data::Printer\" rel=\"noreferrer\">Data::Printer</a>, you'll see that there is indeed no <code>update</code> method apparent. In fact, it's not even an object of the type <code>Net::Twitter</code>.</p>\n\n<pre><code>use Net::Twitter;\nuse Data::Printer;\n\nmy $t = Net::Twitter-&gt;new;\np $t;\n</code></pre>\n\n<p>On my machine with the currently newest Net::Twitter installed, it's a <code>Net::Twitter_v4_01042_with__Legacy</code>, which is likely a dynamically created package.</p>\n\n<pre><code>Net::Twitter_v4_01042_with__Legacy  {\n    Parents       Net::Twitter::Core\n    public methods (22) : apihost, apirealm, apiurl, arrayref_on_error, BUILD, DESTROY, has_error, http_code, http_message, is_list_member, is_list_subscriber, is_subscribed_list, meta, new, searchapiurl, trends, tvhost, tvrealm, tvurl, twittervision, update_twittervision, upload_url\n    private methods (5) : _clear_error, _error_return_val, _http_response, _parse_result, _twitter_error\n    internals: {\n        apirealm               \"Twitter API\",\n        apiurl                 \"https://api.twitter.com/1\",\n        arrayref_on_error      0,\n        clientname             \"Perl Net::Twitter\",\n        clienturl              \"http://search.cpan.org/dist/Net-Twitter/\",\n        clientver              4.01042,\n        decode_html_entities   0,\n        _error_return_val      undef,\n        _json_handler          Cpanel::JSON::XS,\n        &lt;&lt;MOP&gt;&gt;                Class::MOP::Class::Immutable::Moose::Meta::Class,\n        netrc_machine          \"api.twitter.com\",\n        searchapiurl           \"https://search.twitter.com\",\n        source                 \"twitterpm\",\n        ssl                    1,\n        tvhost                 \"twittervision.com:80\",\n        tvrealm                \"Web Password\",\n        tvurl                  \"http://twittervision.com\",\n        twittervision          0,\n        upload_url             \"https://upload.twitter.com/1\",\n        useragent              \"Net::Twitter/4.01042 (Perl)\",\n        useragent_args         {},\n        useragent_class        \"LWP::UserAgent\"\n    }\n}\n</code></pre>\n\n<p>If you try <a href=\"https://grep.metacpan.org/search?q=sub%20update&amp;qd=Net-Twitter&amp;qft=\" rel=\"noreferrer\">looking for a <code>sub update</code> in the entire Net::Twitter distribution</a>, you'll find nothing. It's not part of a role, it just doesn't exist.</p>\n\n<p>But that does not mean it's not there. I dug a little deeper, and found <a href=\"https://metacpan.org/source/MMIMS/Net-Twitter-4.01042/lib/Net/Twitter/Role/API/REST.pm#L195\" rel=\"noreferrer\">an <code>update</code> in Net::Twitter::Role::API::REST</a>. It's defined using the <a href=\"https://metacpan.org/source/Net::Twitter::API#L26\" rel=\"noreferrer\"><code>twitter_api_method</code> function from Net::Twitter::API</a>. It does a bunch of things and then uses Moose's meta layer to install the method into some class \u2013 probably <code>Net::Twitter_v4_01042_with__Legacy</code> on my machine` \u2013 and even brings its own meta method class <a href=\"https://metacpan.org/source/MMIMS/Net-Twitter-4.01042/lib/Net/Twitter/API.pm#L119\" rel=\"noreferrer\">Net::Twitter::Meta::Method</a>. </p>\n\n<p>So it's fairly obvious why <a href=\"https://metacpan.org/pod/Test::MockModule\" rel=\"noreferrer\">Test::MockModule</a> wouldn't find <code>Net::Twitter::update</code>. It simply never </p>\n\n<p>But how do we mock it for testing?</p>\n\n<p>I believe the simplest approach, though certainly not a very nice one, is to overwrite <code>update</code> in the package that it exists in. For that, you need to create an object and check.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse Test::MockModule;\nuse Net::Twitter;\n\nmy $mock = Test::MockModule-&gt;new( ref( Net::Twitter-&gt;new ) );\n$mock-&gt;redefine(\n    'update',\n    sub {\n         ... # will die with 'unimplemented'\n    }\n);\n\nmy $nt = Net::Twitter-&gt;new-&gt;update;\n</code></pre>\n\n<p>This code is a little wasteful, because it needs to create an object just to check  what package it ended up in, but it works.</p>\n\n<blockquote>\n  <p>Unimplemented at /home/simbabque/code/scratch/scratch.pl line 236.</p>\n</blockquote>\n"}], "owner": {"reputation": 4644, "user_id": 1431720, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1431720/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 47912355, "answer_count": 1, "score": 2, "last_activity_date": 1513794810, "creation_date": 1513741857, "question_id": 47898527, "link": "https://stackoverflow.com/questions/47898527/testmockmodule-claims-method-does-not-exist", "title": "Test::MockModule claims &quot;method does not exist&quot;", "body": "<p>I try to mock a function in <a href=\"http://search.cpan.org/dist/Net-Twitter/lib/Net/Twitter.pod\" rel=\"nofollow noreferrer\">Net::Twitter</a>:</p>\n\n<pre><code>use strict;\nuse warnings;\nuse Test::MockModule;\n\nmy $mock = Test::MockModule-&gt;new('Net::Twitter');\n$mock-&gt;redefine('update', sub {\n    # ...\n});\n</code></pre>\n\n<p>but when I run this, I get:</p>\n\n<blockquote>\n  <p>Net::Twitter::update does not exist! at wtf.pl line 8.</p>\n</blockquote>\n\n<p>Why is that and how can I actually mock the <code>Net::Twitter::update</code> function?</p>\n"}, {"tags": ["perl", "xargs"], "comments": [{"owner": {"reputation": 6068, "user_id": 1799189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4Pcu.jpg?s=128&g=1", "display_name": "xxfelixxx", "link": "https://stackoverflow.com/users/1799189/xxfelixxx"}, "edited": false, "score": 2, "creation_date": 1513740678, "post_id": 47898243, "comment_id": 82763529, "body": "You don&#39;t need either xargs or parallel, you just need to pipe directly to perl, it will loop over your filenames and print them if they fit your regex rules."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513746850, "post_id": 47898243, "comment_id": 82764948, "body": "Or even <code>find ... -exec perl -ne &#39;...&#39; {} +</code> to avoid the pipe, too."}, {"owner": {"reputation": 3269, "user_id": 93745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8F5Wc.jpg?s=128&g=1", "display_name": "tinita", "link": "https://stackoverflow.com/users/93745/tinita"}, "reply_to_user": {"reputation": 6068, "user_id": 1799189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4Pcu.jpg?s=128&g=1", "display_name": "xxfelixxx", "link": "https://stackoverflow.com/users/1799189/xxfelixxx"}, "edited": false, "score": 1, "creation_date": 1513760349, "post_id": 47898243, "comment_id": 82770981, "body": "@xxfelixxx without xargs, you have to open the files in perl, and because of  <code>-print0</code> you won&#39;t get them line by line. Maybe it&#39;s better to simply use a perl script with <a href=\"https://metacpan.org/pod/File::Find\" rel=\"nofollow noreferrer\">File::Find</a>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513778000, "post_id": 47898243, "comment_id": 82782273, "body": "So it takes 55x longer, but you spawn between 100x and 8000x more <code>perl</code> interpreters..."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513779040, "post_id": 47898243, "comment_id": 82782944, "body": "@tripleee, While you can avoid xargs by using you use <code>-exec</code> instead of <code>-print0</code>, <code>-exec ;</code> should perform similarly to <code>xargs -n 1</code> (and <code>-exec +</code> should perform similary to <code>xargs</code> without <code>-n 1</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1513794502, "post_id": 47898347, "comment_id": 82792168, "body": "Yeah, I&#39;ve used <code>-P8</code> before, and it speeds up things quite a lot.  sed I&#39;m not really familiar with beyond simple single regex commands.  I think doing the line reading loop manually in perl or using awk are both good options"}], "tags": [], "owner": {"reputation": 7980, "user_id": 1213907, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ksAFh.png?s=128&g=1", "display_name": "KeepCalmAndCarryOn", "link": "https://stackoverflow.com/users/1213907/keepcalmandcarryon"}, "is_accepted": false, "score": 1, "last_activity_date": 1513740371, "creation_date": 1513740371, "answer_id": 47898347, "question_id": 47898243, "link": "https://stackoverflow.com/questions/47898243/perl-xargs-terrible-performance-with-xargs-n1-i/47898347#47898347", "title": "Perl / xargs terrible performance with xargs -n1/-i", "body": "<p>xargs will invoke a new process for every line it processes, so in your case it will be spinning up perl 5802 times and doing this in series</p>\n\n<p>You could try in <a href=\"http://offbytwo.com/2011/06/26/things-you-didnt-know-about-xargs.html\" rel=\"nofollow noreferrer\">parallel</a> </p>\n\n<blockquote>\n  <p>You might be using xargs to invoke a compute intensive command for\n  every line of input. Wouldn\u2019t it be nice if xargs allowed you to take\n  advantage of the multiple cores in your machine? That\u2019s what -P is\n  for. It allows xargs to invoke the specified command multiple times in\n  parallel. You might use this for example to run multiple ffmpeg\n  encodes in parallel. However I\u2019m just going to show you yet another\n  contrived example.</p>\n</blockquote>\n\n<p>Or on the other hand, you could use <a href=\"https://linux.die.net/man/1/sed\" rel=\"nofollow noreferrer\">sed</a> which is much lighter to spin up</p>\n"}, {"tags": [], "owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "is_accepted": true, "score": 0, "last_activity_date": 1513798995, "creation_date": 1513798995, "answer_id": 47913317, "question_id": 47898243, "link": "https://stackoverflow.com/questions/47898243/perl-xargs-terrible-performance-with-xargs-n1-i/47913317#47913317", "title": "Perl / xargs terrible performance with xargs -n1/-i", "body": "<p>Okay, my fundamental misunderstanding was an assumption that the max command line length would be something in the 2000 range.  So I was assuming a perl instance for every 20 files or so (being about 120 characters each).  This was incredibly incorrect.</p>\n\n<p><code>getconf ARG_MAX</code> shows you the actual acceptable length.  In my case:</p>\n\n<blockquote>\n  <p>2097152</p>\n</blockquote>\n\n<p>So, I'm looking at 1 perl instance vs. 5802 instances.  The only perl solution I can think of would be to remove <code>-n</code> and implement the loop by hand, explicitly closing each file.</p>\n\n<p>Better solutions, I think, are awk:</p>\n\n<pre><code> find . -name '*.cpp' 2&gt;/dev/null -print0 | xargs -0 awk '{if (/\\+\\+\\S*[cC]ursor\\S*/ &amp;&amp; !/[!=]=\\s*DB_NULL_CURSOR/) {print FILENAME \":\" FNR \"  \" $0}}'\n</code></pre>\n\n<p>or grep:</p>\n\n<pre><code>find . -name '*.cpp' 2&gt;/dev/null -print0 | xargs -0 grep -nE '\\+\\+\\S*[cC]ursor\\S*' | grep -v '[!=]=\\s*DB_NULL_CURSOR'\n</code></pre>\n\n<p>Both of which execute in the 2 or 3 second range.</p>\n"}], "owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 47913317, "answer_count": 2, "score": 1, "last_activity_date": 1513798995, "creation_date": 1513739428, "last_edit_date": 1513740320, "question_id": 47898243, "link": "https://stackoverflow.com/questions/47898243/perl-xargs-terrible-performance-with-xargs-n1-i", "title": "Perl / xargs terrible performance with xargs -n1/-i", "body": "<p>I have a little perl one-liner I wrote:</p>\n\n<pre><code>find . -name '*.cpp' -print0 2&gt;/dev/null | xargs -0 -i perl -ne 'if (/\\+\\+\\S*[cC]ursor\\S*/ &amp;&amp; !/[!=]=\\s*DB_NULL_CURSOR/) {print \"$ARGV:$.\\n $_\\n\";}' {}\n</code></pre>\n\n<p>In the directory I'm running this, the <code>find</code> portion returns 5802 results.  </p>\n\n<p>Now, I understand <code>xargs -i</code> (or <code>-n1</code>) is going to have a performance impact, but with <code>-i</code>:</p>\n\n<pre><code>find . -name '*.cpp' -print0 2&gt; /dev/null  0.33s user 1.12s system 0% cpu 3:12.57 total\nxargs -0 -i perl -ne  {}  4.12s user 32.80s system 16% cpu 3:42.22 total\n</code></pre>\n\n<p>And without:</p>\n\n<pre><code>find . -name '*.cpp' -print0 2&gt; /dev/null  0.27s user 1.22s system 95% cpu 1.556 total\nxargs -0 perl -ne   0.62s user 0.69s system 61% cpu 2.117 total\n</code></pre>\n\n<p>Minutes vs. a couple seconds (order of testing confirmed not to matter).  The actual perl results are identical other than the line numbers which are obviously incorrect in the second instance.</p>\n\n<p>Behavior is identical in Cygwin/bash/perl5v26, and WSL Ubuntu 16.04/zsh/perl5v22.  File system is NTFS in both cases.  But...I'm kind of assuming the little one-liner I wrote must have some sort of bug in it and that stuff is irrelevant?</p>\n\n<p>EDIT:  It occurred to me that disabling sitecustomize.pl at startup with <code>-f</code> --an option I'd vaguely remembered seeing with <code>perl --help</code>--might help.  It did not.  Also, I'm aware that the performance impact of <code>-i</code> is going to be <em>significant</em> due to perl compiling the regex.  This still seems out of control.</p>\n"}, {"tags": ["json", "perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513710704, "post_id": 47893579, "comment_id": 82753891, "body": "Probably not. Are you averse to just walking the data structure and reencoding the strings?"}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513710924, "post_id": 47893579, "comment_id": 82753993, "body": "@Borodin I&#39;m afraid that&#39;s what I will end up doing; just asking in case someone had solved this problem in some json module I haven&#39;t found"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513716665, "post_id": 47893579, "comment_id": 82756667, "body": "It would be nice if there were a JSON parser that offered hooks at the various syntax points. There&#39;s no shortage of XML parsers that do exactly this, and even <code>File::Find</code> has a similar facility. Perhaps I&#39;ll write something."}], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 5, "last_activity_date": 1513809016, "last_edit_date": 1513809016, "creation_date": 1513712983, "answer_id": 47894221, "question_id": 47893579, "link": "https://stackoverflow.com/questions/47893579/decode-json-without-utf8-flagged-strings/47894221#47894221", "title": "Decode JSON without UTF8-flagged strings", "body": "<p>The safest approach is to fix the data structure after the fact.</p>\n\n<pre><code># The following apply to each of decode_struct_inplace, encode_struct_inplace, downgrade_struct_inplace and upgrade_struct_inplace:\n# - Errors are silently ignored. The scalar is left unchanged.\n# - Recognizes references to arrays, hashes and scalars. More esoteric references won't processed, and a warning will be issued.\n# - Overloaded objects and magical variables are not supported. They may induce incorrect behaviour.\n# - The structure is changed in-place. You can use Storable::dclone to make a copy first if need be.\n# - For convenience, returns its argument.\n\n# Decodes all strings in a data structure from UTF-8 to Unicode Code Points.\nsub decode_struct_inplace { _convert_struct_inplace($_[0], \\&amp;utf8::decode) }\n\n# Encodes all strings in a data structure from Unicode Code Points to UTF-8.\nsub encode_struct_inplace { _convert_struct_inplace($_[0], \\&amp;utf8::encode) }\n\n# \"Downgrades\" the string storage format of all scalars containing strings in\n# a data structure to the UTF8=0 format if they aren't already in that format.\nsub downgrade_struct_inplace { _convert_struct_inplace($_[0], \\&amp;utf8::downgrade) }\n\n# \"Upgrades\" the string storage format of all scalars containing strings in\n# a data structure to the UTF8=1 format if they aren't already in that format.\nsub upgrade_struct_inplace { _convert_struct_inplace($_[0], \\&amp;utf8::upgrade) }\n</code></pre>\n\n<p>&#x20;</p>\n\n<pre><code>sub _convert_struct_inplace {\n    # Make $arg an alias to $_[0]. Changes to $arg (like changes to $_[0]) will be reflected in the parent.\n    our $arg; local *arg = \\shift;\n    my $converter        =  shift;\n\n    my $caller = (caller(1))[3];\n    $caller =~ s/^.*:://;    # /\n\n    my %seen;    # Only decode each variable once.\n    my %warned;  # Only emit each warning once.\n\n    # Using \"my\" would introduce a memory cycle we'd have to work to break to avoid a memory leak.\n    local *_visitor = sub {\n        # Make $arg an alias to $_[0]. Changes to $arg (like changes to $_[0]) will be reflected in the parent.\n        our $arg; local *arg = \\$_[0];\n\n        # Don't decode the same variable twice.\n        # Also detects referential loops.\n        return $arg if $seen{refaddr(\\$arg)}++;\n\n        my $reftype = reftype($arg);\n        if (!defined($reftype)) {\n            if (defined($arg)) {\n                my $sv = B::svref_2object(\\$arg);  # Meta object.\n                if ($sv-&gt;isa('B::PV') &amp;&amp; ($sv-&gt;FLAGS &amp; B::SVf_POK)) {  # Can it contain a string? And does it?\n                    $converter-&gt;($arg);\n                }\n            }\n        }\n        elsif ($reftype eq 'ARRAY') {\n            _visitor($_) for @$arg;\n        }\n        elsif ($reftype eq 'HASH') {\n            # Usually, we can avoid converting the keys.\n            my $ascii = 1;\n            for (keys(%$arg)) {\n                if (/[^\\x00-\\x7F]/) {\n                    $ascii = 0;\n                    last;\n                }\n            }\n\n            if (!$ascii) {\n                %$arg = map {\n                        $converter-&gt;( my $new_key = $_ );\n                        $new_key =&gt; $arg-&gt;{$_}\n                    } keys(%$arg);\n            }\n\n            _visitor($_) for values(%$arg);\n        }\n        elsif ($reftype eq 'SCALAR') {\n            _visitor($$arg);\n        }\n        elsif ($reftype eq 'REF') {\n            _visitor($$arg);\n        }\n        else {\n            warn(\"Reference type $reftype not supported by $caller\\n\")\n                if !$warned{$reftype}++;\n        }\n\n        return $arg;\n    };\n\n    return _visitor($arg);\n}\n</code></pre>\n\n<p>This is existing code that can be simplified a little since it handles things not present in data structures created by JSON modules.</p>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 7, "last_activity_date": 1513779732, "last_edit_date": 1513779732, "creation_date": 1513717392, "answer_id": 47895147, "question_id": 47893579, "link": "https://stackoverflow.com/questions/47893579/decode-json-without-utf8-flagged-strings/47895147#47895147", "title": "Decode JSON without UTF8-flagged strings", "body": "<p>You could monkey-patch JSON::PP to produce the desired effect.</p>\n\n<pre><code>use JSON::PP qw( );\n\nuse vars qw( $JSON_PP_DOWNGRADE );\n\nBEGIN {\n   $JSON_PP_DOWNGRADE //= 0;\n   my $old_string = \\&amp;JSON::PP::string;\n   my $new_string = sub {\n      my $s = $old_string-&gt;(@_);\n      utf8::downgrade($s) if $JSON_PP_DOWNGRADE;\n      $s\n   };\n\n   no warnings qw ( redefine );\n   *JSON::PP::string = $new_string;\n}\n</code></pre>\n\n<p>Where you want JSON::PP to produce a \"downgraded structure\", add the following before the call to decode:</p>\n\n<pre><code>local $JSON_PP_DOWNGRADE = 1;\n</code></pre>\n"}], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1513809016, "creation_date": 1513710143, "last_edit_date": 1513748803, "question_id": 47893579, "link": "https://stackoverflow.com/questions/47893579/decode-json-without-utf8-flagged-strings", "title": "Decode JSON without UTF8-flagged strings", "body": "<p>I am using some XS modules that are expecting latin1 string data (and ignoring perl's UTF8 flag).  In some cases, I am passing the result of JSON decoding, which should only include latin1 characters, but in some cases has them escaped (e.g. <code>[\"co\\u00f6perative\"]</code>).</p>\n\n<p>Is there a JSON decoding module that offers an option to return strings downgraded (at least where possible)?  I'm not finding such an option in JSON, JSON::XS, or Cpanel::JSON::XS.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse Cpanel::JSON::XS;\nuse Devel::Peek;\nmy $got = Cpanel::JSON::XS-&gt;new-&gt;decode('[\"co\\u00f6perative\"]')-&gt;[0];\nDump $got;\nmy $wanted = $got;\nutf8::downgrade($wanted);\nDump $wanted;\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>SV = PV(0xd6cbf0) at 0xd8a460\n  REFCNT = 1\n  FLAGS = (POK,IsCOW,pPOK,UTF8)\n  PV = 0xd83b40 \"co\\303\\266perative\"\\0 [UTF8 \"co\\x{f6}perative\"]\n  CUR = 12\n  LEN = 14\n  COW_REFCNT = 0\nSV = PV(0xd6cb20) at 0xd977f0\n  REFCNT = 1\n  FLAGS = (POK,pPOK)\n  PV = 0xe0d120 \"co\\366perative\"\\0\n  CUR = 11\n  LEN = 14\n</code></pre>\n"}, {"tags": ["python", "perl", "awk", "sed", "chef-infra"], "comments": [{"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 1, "creation_date": 1513714310, "post_id": 47893288, "comment_id": 82755601, "body": "You shouldn&#39;t use regexes or sed/awk for this task at all. Using a decent JSON parser is the only reliable way to parse and modify JSON data."}, {"owner": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 0, "creation_date": 1513747665, "post_id": 47893288, "comment_id": 82765189, "body": "There is even <a href=\"https://stedolan.github.io/jq/\" rel=\"nofollow noreferrer\"><code>jq</code></a>, a tiny yet powerful command line tool to read and write JSON."}], "answers": [{"comments": [{"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 1, "creation_date": 1513716044, "post_id": 47893538, "comment_id": 82756388, "body": "Versus <i>sed</i> and <i>AWK</i> this IS the best approach. Versus <i>Perl</i> we could argue ;-) Python (afaik) already ships with a JSON module whereas Perl needs one from e.g. CPAN installed."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 1, "creation_date": 1513729013, "post_id": 47893538, "comment_id": 82760936, "body": "@PerlDuck actually Perl ships with JSON::PP since 5.13.9. See <a href=\"http://perldoc.perl.org/corelist.html\" rel=\"nofollow noreferrer\">the <code>corelist</code> utility</a>. :)"}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513776303, "post_id": 47893538, "comment_id": 82781151, "body": "@simbabque That&#39;s very good to know. Thank you. Sometimes (at work) I had to decide between Perl and Python for processing JSON and chose Python for its built-in support. Now I can pick Perl as well ;-)"}, {"owner": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "edited": false, "score": 0, "creation_date": 1513869210, "post_id": 47893538, "comment_id": 82823935, "body": "Is there anyway to force json.dumps to use Unix style LF only as a line break when running on Windows ?"}, {"owner": {"reputation": 32007, "user_id": 5858851, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yXFCX.jpg?s=128&g=1", "display_name": "pault", "link": "https://stackoverflow.com/users/5858851/pault"}, "reply_to_user": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "edited": false, "score": 0, "creation_date": 1513869496, "post_id": 47893538, "comment_id": 82824070, "body": "@eramm This post should help: <a href=\"https://stackoverflow.com/questions/41842875/how-to-explicitly-set-carriage-return-when-doing-json-dump\">How to explicitly set carriage return when doing json.dump?</a>"}, {"owner": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "edited": false, "score": 0, "creation_date": 1513870675, "post_id": 47893538, "comment_id": 82824798, "body": "Yes I saw that previously but it doesn&#39;t seem to be working for me. d = json.loads(open(&#39;servername.json&#39;, &#39;r&#39;, newline=&#39;\\n&#39;).read())"}, {"owner": {"reputation": 32007, "user_id": 5858851, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yXFCX.jpg?s=128&g=1", "display_name": "pault", "link": "https://stackoverflow.com/users/5858851/pault"}, "edited": false, "score": 0, "creation_date": 1513870896, "post_id": 47893538, "comment_id": 82824928, "body": "You asked about <code>json.dumps</code> - that&#39;s called for the <code>write()</code>, not the <code>read()</code>: <code>open(&#39;new_servername.json&#39;, &#39;w&#39;, newline=&#39;\\n&#39;).write(json.dumps(d, indent=2))</code>"}, {"owner": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "edited": false, "score": 0, "creation_date": 1513872814, "post_id": 47893538, "comment_id": 82826027, "body": "Facepalm ! I had previously tried putting it in the write() section thinking that&#39;s where it should go :-( works perfectly now. Thank You"}], "tags": [], "owner": {"reputation": 32007, "user_id": 5858851, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/yXFCX.jpg?s=128&g=1", "display_name": "pault", "link": "https://stackoverflow.com/users/5858851/pault"}, "is_accepted": true, "score": 3, "last_activity_date": 1513710458, "last_edit_date": 1513710458, "creation_date": 1513710009, "answer_id": 47893538, "question_id": 47893288, "link": "https://stackoverflow.com/questions/47893288/add-a-new-role-to-a-chef-json-file-with-sed/47893538#47893538", "title": "Add a new role to a Chef .json file with Sed", "body": "<p>I don't know if this is the best approach (vs sed, AWK, or Perl) but it is straightforward to do what you're asking using python's <code>json</code> library.</p>\n\n<pre><code>import json\n\n# read the file as a dict using json.loads\nd = json.loads(open('servername.json', 'r').read())\n\n# add your new role to the end of the run_list\nd['run_list'].append('role[My_New_Role]')\n\n# write new json to file (specify a new file, or overwrite if you prefer)\nopen('new_servername.json', 'w').write(json.dumps(d, indent=2))\n</code></pre>\n\n<p>The output file looks like:</p>\n\n<pre><code>{\n  \"chef_environment\": \"test\", \n  \"name\": \"myserver123\", \n  \"run_list\": [ \n    \"role[base-pkg]\", \n    \"role[interesting_stuff]\", \n    \"role[user_apps]\",\n    \"role[My_New_Role]\"\n  ]\n}\n</code></pre>\n\n<p>It's pretty easy to modify this code into a script with the filename as an input so that it's easy to run multiple times.</p>\n"}, {"tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": false, "score": 5, "last_activity_date": 1513713549, "creation_date": 1513713549, "answer_id": 47894338, "question_id": 47893288, "link": "https://stackoverflow.com/questions/47893288/add-a-new-role-to-a-chef-json-file-with-sed/47894338#47894338", "title": "Add a new role to a Chef .json file with Sed", "body": "<p>Perl with the <code>JSON</code> module:</p>\n\n<pre><code>cat servername.json | perl -MJSON -0 -ne '$j = decode_json($_); push @{$j-&gt;{run_list}}, q&lt;role[My_New_Role]&gt;; print encode_json($j)'\n</code></pre>\n\n<p>you can pretty-print it by replacing the print command with <code>print to_json($j, {pretty =&gt; 1})</code></p>\n"}], "owner": {"reputation": 161, "user_id": 863389, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68b9fa9f319c2e42bcc7fd568f8bed5f?s=128&d=identicon&r=PG&f=1", "display_name": "eramm", "link": "https://stackoverflow.com/users/863389/eramm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 47893538, "answer_count": 2, "score": 1, "last_activity_date": 1513713549, "creation_date": 1513708920, "question_id": 47893288, "link": "https://stackoverflow.com/questions/47893288/add-a-new-role-to-a-chef-json-file-with-sed", "title": "Add a new role to a Chef .json file with Sed", "body": "<p>I have a typical .json file for Chef e.g. servername.json</p>\n\n<pre><code>{\n\n  \"name\": \"myserver123\",\n\n  \"chef_environment\": \"test\",\n\n  \"run_list\": [\n\n    \"role[base-pkg]\",\n\n    \"role[interesting_stuff]\",\n\n    \"role[user_apps]\"\n\n\n  ]\n\n}\n</code></pre>\n\n<p>What I would like to do is use a \"one liner\" to add a new role <strong>after</strong> the last role found in the file. Since I never know what roles or how many are in a file i thought to search for the final closing <code>\"]\"</code> bracket and add the new role above that.</p>\n\n<p>I tried the following: </p>\n\n<pre><code>tac servername.json | sed -i '0,/\\]/a \"role[My_New_Role]\"'\n</code></pre>\n\n<p>thinking that this would find the (now) first \"]\" and add the new line after it. However when I run the cmd it adds the line \"role[My_New_Role]\" 3 times. <strong>Twice</strong> before the <code>\"]\"</code> and <strong>once</strong> in the correct place after the <code>\"]\"</code></p>\n\n<p>Questions:</p>\n\n<p>1) Why is the line added 3 times when the \"0\" says match once ?</p>\n\n<p>2) Would this be better done using AWK, Perl or Python (2.7.5) ? How ?</p>\n\n<p>3) Should I use regex lookahead/behind instead of tac ?</p>\n\n<p>4) Since I will need to process the file again to add a comma to the second to last role perhapes my whole approach is wrong ? What would be a better approach ?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 3, "creation_date": 1513707124, "post_id": 47892665, "comment_id": 82752257, "body": "You will have to run it in its own process that doesn&#39;t use <code>threads</code>. Why did you delete your previous question?"}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513707397, "post_id": 47892665, "comment_id": 82752404, "body": "I decided to re ask here since I figured using non threadsafe modules with threads is a common mistake."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1513707995, "post_id": 47892911, "comment_id": 82752723, "body": "I have a module imported in main which can&#39;t be modified that uses Win32:OLE. If I require that module within a new thread I assume I won&#39;t be able to use functions defined inside that module in main right? Could I still export the functions that module defines but not the Win32:OLE functions to a global scope?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 1, "creation_date": 1513708650, "post_id": 47892911, "comment_id": 82752998, "body": "@TheAschr: If you&#39;re talking about the <code>InHouseModule</code> from your deleted question that <code>uses</code> dozens of other modules then you should do all you can to get that changed. It&#39;s very bad practice and will make all your Perl programs larger unnecessarily. There will also be multiple compatability problems such as the one you&#39;re experiencing here."}, {"owner": {"reputation": 4111, "user_id": 23033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b6c69cae4d2061cafe851676f8d262?s=128&d=identicon&r=PG", "display_name": "Dre", "link": "https://stackoverflow.com/users/23033/dre"}, "edited": false, "score": 0, "creation_date": 1513708798, "post_id": 47892911, "comment_id": 82753055, "body": "Unfortunately, there is no way to do that. The act of loading the <code>Win32::OLE</code> module itself is what causes the thread-unsafe behavior, not the fact that the functions are imported."}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513708833, "post_id": 47892911, "comment_id": 82753072, "body": "@Borodin: I believe it uses all of them though. The module is over 12,000 lines. Is there a better way to handle importing them?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 1, "creation_date": 1513708974, "post_id": 47892911, "comment_id": 82753146, "body": "@TheAschr: That&#39;s also unmanageably big. You should at least split it into chunks with related functionality. You might want to rewrite the functions so that they <code>require</code> and import from the modules they need."}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513709371, "post_id": 47892911, "comment_id": 82753318, "body": "@Borodin: Unfortunately the guy who wrote the module left like 10 years ago and management is scared to let anyone touch it because of legacy issues."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 1, "creation_date": 1513709543, "post_id": 47892911, "comment_id": 82753383, "body": "@TheAschr: Well at least you can be grateful that he&#39;s gone. Management need to get a proper test suite written for that module and then allow it to be amended and split up. It&#39;s mad to rely on a single gigantic core library that no one may ever change."}], "tags": [], "owner": {"reputation": 4111, "user_id": 23033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b6c69cae4d2061cafe851676f8d262?s=128&d=identicon&r=PG", "display_name": "Dre", "link": "https://stackoverflow.com/users/23033/dre"}, "is_accepted": true, "score": 1, "last_activity_date": 1513707715, "last_edit_date": 1513707715, "creation_date": 1513707156, "answer_id": 47892911, "question_id": 47892665, "link": "https://stackoverflow.com/questions/47892665/is-there-a-way-to-ignore-a-non-threadsafe-module-in-perl/47892911#47892911", "title": "Is there a way to ignore a non threadsafe module in perl?", "body": "<p>You cannot use <code>Win32::OLE</code> on your main thread, unless you create <strong>all</strong> other threads first. You can, however, use the module in a child thread.  Do note <code>require</code> instead of <code>use</code> here.</p>\n\n<pre><code>my $ole_thread = threads-&gt;create(sub {\n    require Win32::OLE;\n    # do OLE stuff\n});\nmy $result = $ole_thread-&gt;join();\n</code></pre>\n\n<p>[ citing <a href=\"http://www.perlmonks.org/?node_id=595491\" rel=\"nofollow noreferrer\">http://www.perlmonks.org/?node_id=595491</a> ]</p>\n\n<p>This same method may work on other modules that are not threadsafe. But you should use care to only use the module from a single non-main thread.</p>\n"}], "owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 47892911, "answer_count": 1, "score": 0, "last_activity_date": 1513707715, "creation_date": 1513706136, "question_id": 47892665, "link": "https://stackoverflow.com/questions/47892665/is-there-a-way-to-ignore-a-non-threadsafe-module-in-perl", "title": "Is there a way to ignore a non threadsafe module in perl?", "body": "<p>I'm trying to find a way to ignore a module within a certain portion of code so that I can use the threads module with the non thread safe module Win32::OLE. </p>\n\n<pre><code>use strict;\nuse warnings;\nuse Win32::OLE;\n\n#Do some OLE stuff\n\n#unimport Win32::OLE\nuse threads;\n\nmy $exec_command = threads-&gt;create(sub{});\n$exec_command-&gt;join();\n#reimport Win32::OLE\n</code></pre>\n"}, {"tags": ["regex", "perl", "sed"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513704346, "post_id": 47892015, "comment_id": 82750919, "body": "I have edited your question to try to understand it. Is the incoming data really on only two lines?"}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 1, "creation_date": 1513710696, "post_id": 47892015, "comment_id": 82753887, "body": "I upvoted as countermeasures"}, {"owner": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513758044, "post_id": 47892015, "comment_id": 82769706, "body": "@Borodin. Thank you for your edits. The provided incoming data is extracted from a stream. These have been selected to be a representative sample of input."}], "answers": [{"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 3, "last_activity_date": 1513706651, "last_edit_date": 1513706651, "creation_date": 1513705976, "answer_id": 47892630, "question_id": 47892015, "link": "https://stackoverflow.com/questions/47892015/regex-parsing-of-dns-answer/47892630#47892630", "title": "Regex parsing of DNS answer", "body": "\n\n<p>This does as you ask with the sample data</p>\n\n<p>I first build a regex pattern <code>$url_re</code> that matches numeric URLs to make the following code more concise. Then I search for the first URL immediately after <code>&gt;</code>, the named URL right after <code>A?</code>, and all of the following URLs which are preceded by <code>A</code></p>\n\n<p>They are all stored in array <code>@urls</code> and printed</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings 'all';\nuse 5.010;\n\nmy $url_re = qr/(?:\\d+\\.){3}\\d+/;\n\nwhile ( &lt;DATA&gt; ) {\n\n    my @urls = ( /&gt;\\s+($url_re)/, /A\\?\\s+([-\\w.]+\\w)/, /(A\\s+$url_re)/g );\n\n    say \"@urls\";\n}\n\n__DATA__\n8.8.19.12.53 &gt; 125.15.15.9.40583: [udp sum ok] 62639 q: A? mp.microsoft.com. 6/5/9 mp.microsoft.com. CNAME .mp.microsoft.com.c.footprint.net., mp.microsoft.com.c.footprint.net. A 8.250.143.254, mp.microsoft.com.c.footprint.net. A 8.250.157.254 ns: c.footprint.net. NS d.ns.c.footprint.net. ar: d.ns.c.footprint.net. A 4.26.235.155 (439)\n8.8.19.12.53 &gt; 125.15.15.9.42091: [udp sum ok] 46555 q: A? www.toto.net. 1/0/0 www.toto.net. A 120.33.1.11 (47)\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>125.15.15.9 mp.microsoft.com A 8.250.143.254 A 8.250.157.254 A 4.26.235.155\n125.15.15.9 www.toto.net A 120.33.1.11\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513765822, "post_id": 47892647, "comment_id": 82774451, "body": "I just ran on a larger input sample (500k  lines) and I found a case that was not included in the description. Would it be possible to discard lines matching <code>NXDomain\\*?-? q:</code> ?"}, {"owner": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513767309, "post_id": 47892647, "comment_id": 82775398, "body": "Sorry I add one more case : I also would like to discard lines with no returned IP record (A xx.xx.xx.xx). I know this is possible with post processing treatment (<code>grep -v</code> and <code>awk</code>)."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513778630, "post_id": 47892647, "comment_id": 82782699, "body": "I wrote the code so it&#39;s easy to make such changes, and you announced you upvoted someone specifically for making it hard for you. Then, you don&#39;t even make an attempt to make the change yourself? That&#39;s pretty insulting."}, {"owner": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513780138, "post_id": 47892647, "comment_id": 82783682, "body": "I didn&#39;t mean to insult you. I upvoted other replies because they meet my initial need. However I chose your reply as the source of my script, as it is pretty clear compared to the other, even if I do not understand all details. That&#39;s why I added two more queries (comments) to your reply and not to all replies. Moreover, your code may seem simple to you, although this is not the case for me. I tried few hours (and still trying) to modify your code to fit all my need with regex101 without success. In fact I&#39;m not familiar with such complex regex."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513780989, "post_id": 47892647, "comment_id": 82784276, "body": "I didn&#39;t say the code was simple; I said the changes was simple (because I already did the complex job of parsing your text). I see you still haven&#39;t made an attempt."}, {"owner": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513782981, "post_id": 47892647, "comment_id": 82785696, "body": "Changes are simple for you. Even the ` field_value_re` is incomprehensible for me. However I guess that this is the part I should modify to meet my first new need. I grope for ways to achieve it."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513784446, "post_id": 47892647, "comment_id": 82786665, "body": "No, the changes are simple, period. /// Again, it doesn&#39;t matter that <code>field_value_re</code> is incompresensible; you just need to know it matches the field value. /// Again, you should not be modifying that at all."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513787942, "post_id": 47892647, "comment_id": 82788801, "body": "The only regex change that was needed was the addition of a capture. Now, I&#39;ve even done that for you."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1514055828, "post_id": 47892647, "comment_id": 82879746, "body": "All you needed to add was <code>next if $id_val =~ &#47;\\bNXDomain\\b&#47;;</code> and <code>next if !@answers;</code>. Like I said, the necessary change was elementary."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 2, "last_activity_date": 1514055770, "last_edit_date": 1514055770, "creation_date": 1513706065, "answer_id": 47892647, "question_id": 47892015, "link": "https://stackoverflow.com/questions/47892015/regex-parsing-of-dns-answer/47892647#47892647", "title": "Regex parsing of DNS answer", "body": "<p>Each line appears to be of the form</p>\n\n<pre><code>{\"id\" with spaces}: {stuff} [ {key}: {stuff} ]*\n</code></pre>\n\n<p>You appear to be interested in information inside the \"id\", and inside the field named <code>q</code>. The value of the <code>q</code> field appears to be of the form</p>\n\n<pre><code>A? {word} {word} {ns_return} [, {ns_return} ]*\n</code></pre>\n\n<p>Here's a robust solution that handles the format described above.</p>\n\n<pre><code>perl -nle'\n   my $field_value_re = qr/(?![^\\s:]++:(?!\\S)) \\S++ (?: (?! \\s++ [^\\s:]++:(?!\\S) ) \\s++ \\S++ )*+/x;\n\n   my ($id, $id_val, $rest) = /^ ( [^:]++ ) : \\s++ ( $field_value_re ) ( .* ) /sx\n      or next;\n\n   next if $id_val =~ /\\bNXDomain\\b/;\n\n   my ($ip) = $id =~ /^ \\S++ \\s++ \\S++ \\s++ ( [^\\s\\.]++\\.[^\\s\\.]++\\.[^\\s\\.]++\\.[^\\s\\.]++ )\\.[^\\s\\.]++ \\z /x\n      or next;\n\n   my %fields = $rest =~ /\\G \\s++ ( [^\\s:]++ ) :(?!\\S) \\s++ ( $field_value_re ) /gsx;\n\n   my ($query, $answers) = $fields{q} =~ /^ A\\? \\s++ ( \\S++ ) \\s++ \\S++ \\s++ ( .* ) /sx\n      or next;\n\n   $query =~ s/\\.\\z//;\n\n   my @answers =\n      map { /^\\S++\\s++A\\s++(\\S++)/ }\n         split(/\\s*+,\\s*+/, $answers);\n\n   next if !@answers;\n\n   print join \" \", $ip, $query, map { \"A $_\" } @answers;\n' log\n125.15.15.9 mp.microsoft.com A 8.250.143.254 A 8.250.157.254\n125.15.15.9 www.toto.net A 120.33.1.11\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513721461, "post_id": 47893229, "comment_id": 82758654, "body": "@ikegami OK well, I fixed it by confining the second and third regexes to the <code>q:</code> field, as you pointed out in your answer. it&#39;s ugly but it should work."}, {"owner": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513759318, "post_id": 47893229, "comment_id": 82770395, "body": "The difference with the desired output is that the <b>/(A [\\d\\.]+)/g</b> should stop after matching a potential &quot;ns:&quot; field"}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "reply_to_user": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513773551, "post_id": 47893229, "comment_id": 82779327, "body": "@vera yup fixed now"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "edited": false, "score": 0, "creation_date": 1513778590, "post_id": 47893229, "comment_id": 82782672, "body": "@vera, Why would you reward fragility and lack of maintainability?! (Worse, the OP already wants two changes!)"}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513781233, "post_id": 47893229, "comment_id": 82784462, "body": "I didn&#39;t claim this is the superior answer, it&#39;s just one of many possible answers. I defer to @ikegami on what is fragile and maintainable"}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513781329, "post_id": 47893229, "comment_id": 82784545, "body": "it would perhaps be helpful to explain why you say that though."}], "tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": false, "score": 1, "last_activity_date": 1513773819, "last_edit_date": 1513773819, "creation_date": 1513708659, "answer_id": 47893229, "question_id": 47892015, "link": "https://stackoverflow.com/questions/47892015/regex-parsing-of-dns-answer/47893229#47893229", "title": "Regex parsing of DNS answer", "body": "<p>This prints the desired output by using the <code>map</code> function in a somewhat unorthodox way to ignore any fields after <code>q:</code></p>\n\n<pre><code>perl -lne 'print join qq/\\t/, m/&gt; ([\\d\\.]+)\\./, map {/A\\? ([^\\s]+)\\./, /(A [\\d\\.]+)/g} / q:([^:]+)/' log.txt\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0b79065e9a14098fcada1e18f29419?s=128&d=identicon&r=PG&f=1", "display_name": "vera", "link": "https://stackoverflow.com/users/8647014/vera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 47892647, "answer_count": 3, "score": -1, "last_activity_date": 1514055770, "creation_date": 1513703555, "last_edit_date": 1513782730, "question_id": 47892015, "link": "https://stackoverflow.com/questions/47892015/regex-parsing-of-dns-answer", "title": "Regex parsing of DNS answer", "body": "\n\n<p>I would like to parse the following lines</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>8.8.19.12.53 &gt; 125.15.15.9.40583: [udp sum ok] 62639 q: A? mp.microsoft.com. 6/5/9 mp.microsoft.com. CNAME .mp.microsoft.com.c.footprint.net., mp.microsoft.com.c.footprint.net. A 8.250.143.254, mp.microsoft.com.c.footprint.net. A 8.250.157.254 ns: c.footprint.net. NS d.ns.c.footprint.net. ar: d.ns.c.footprint.net. A 4.26.235.155 (439)\n8.8.19.12.53 &gt; 125.15.15.9.42091: [udp sum ok] 46555 q: A? www.toto.net. 1/0/0 www.toto.net. A 120.33.1.11 (47)\n</code></pre>\n\n<p>and  get the following output</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>125.15.15.9 mp.microsoft.com A 8.250.143.254 A 8.250.157.254\n125.15.15.9 www.toto.net A 120.33.1.11\n</code></pre>\n\n<p>I succeeded in parsing the first two fields with command</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>sed -Eun 's/[^&gt;]+&gt; ([0-9.]+)\\.[0-9]+:.+q: A\\? ([a-z0-9.-]+)\\.([^:]+).*/\\1:\\2:\\3/pg\n</code></pre>\n\n<p>` </p>\n\n<p>But I cannot get the resolved IPs (A xx.xx.xx.xx). In fact there may be several.</p>\n\n<p>Would it be possible to get such output using sed or Perl ?</p>\n\n<p><strong>EDIT</strong>:\nAs I added in comments, parsing of a larger input sample, I also require several lines to be discarded in the output. This lines can be characterized by :</p>\n\n<ul>\n<li>the number of A records (\"A xx.xx.xx.xx\") is non null</li>\n<li>or the line must not contains <code>NXDomain\\*?-</code> </li>\n</ul>\n\n<p>I succeed in meeting the new first need, but not for the second.</p>\n\n<p>Following the @ikegami reply, here is my attempt:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>  perl -nle '\n     my $field_value_re = qr/(?![^\\s:]++:(?!\\S)) \\S++ (?: (?! \\s++ [^\\s:]++:(?!\\S) ) \\s++ \\S++ )*+/x;\n\n     my ($id, $rest) = /^ \\s+ ( [^:]++ ) : \\s++ $field_value_re ( .* ) /sx\n        or next;\n\n     my ($ip) = $id =~ /^ \\S++ \\s++ \\S++ \\s++ ( [^\\s\\.]++\\.[^\\s\\.]++\\.[^\\s\\.]++\\.[^\\s\\.]++ )\\.[^\\s\\.]++ \\z /x\n        or next;\n\n     my %fields = $rest =~ /\\G \\s++ ( [^\\s:]++ ) :(?!\\S) \\s++ ( $field_value_re ) /gsx;\n\n     my ($query, $answers) = $fields{q} =~ /^ A\\? \\s++ ( \\S++ ) \\s++ \\S++ \\s++ ( .* ) /sx\n        or next;\n\n     $query =~ s/\\.\\z//;\n\n     my @answers = split(/\\s*+,\\s*+/, $answers);\n     my ($afield) = join \" \", map { /^\\S++\\s++A\\s++(\\S++)/ } @answers;\n     if ( length($afield) != 0)\n     {\n             print join \" \", $ip, $query, $afield;\n     }\n  ' dns.sample\n</code></pre>\n"}, {"tags": ["apache", "perl", "console", "mod-perl", "komodo"], "answers": [{"comments": [{"owner": {"reputation": 362, "user_id": 6182181, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/12dc314285354ddaccb1342824def21d?s=128&d=identicon&r=PG&f=1", "display_name": "Miko\u0142aj Wa\u015bniewski", "link": "https://stackoverflow.com/users/6182181/miko%c5%82aj-wa%c5%9bniewski"}, "edited": false, "score": 0, "creation_date": 1513706558, "post_id": 47892560, "comment_id": 82751977, "body": "Thanks. Unfortunately I didn&#39;t found anything in Komodo documentation about running commands when making some action, i.e. saving a file."}, {"owner": {"reputation": 319, "user_id": 1596011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77061ba6a8415bd278e827949b8a1495?s=128&d=identicon&r=PG", "display_name": "th3coop", "link": "https://stackoverflow.com/users/1596011/th3coop"}, "reply_to_user": {"reputation": 362, "user_id": 6182181, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/12dc314285354ddaccb1342824def21d?s=128&d=identicon&r=PG&f=1", "display_name": "Miko\u0142aj Wa\u015bniewski", "link": "https://stackoverflow.com/users/6182181/miko%c5%82aj-wa%c5%9bniewski"}, "edited": false, "score": 0, "creation_date": 1513723139, "post_id": 47892560, "comment_id": 82759280, "body": "Oh that was silly.  I was thinking <a href=\"http://docs.activestate.com/komodo/11/manual/macros.html#specifying-userscript-triggers\" rel=\"nofollow noreferrer\">Userscripts</a>.  You can either implement it in JS and use the Komodo SDK which will easily allow you to run a terminal command using <a href=\"http://docs.activestate.com/komodo/11/sdk/api/module-ko_shell.html\" rel=\"nofollow noreferrer\">ko/shell</a> or use Python&#39;s <code>os.system</code> to execute the command.  Userscripts support both languages.  You would then set the <b>Trigger</b> property for the <b>Userscript</b> to <i>After file save</i>.  I hope that&#39;s makes sense.  Sorry for the confusing original Answer."}, {"owner": {"reputation": 362, "user_id": 6182181, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/12dc314285354ddaccb1342824def21d?s=128&d=identicon&r=PG&f=1", "display_name": "Miko\u0142aj Wa\u015bniewski", "link": "https://stackoverflow.com/users/6182181/miko%c5%82aj-wa%c5%9bniewski"}, "edited": false, "score": 0, "creation_date": 1513877251, "post_id": 47892560, "comment_id": 82828384, "body": "Thank you very much. I was trying to write a user script using Komodo SDK, but unfortunately I think it is really bad described how to run this commands and I&#39;m confused now. There are no examples in whole Internet. Did you use this Komodo SDK? Can you write a simple script which performs some operations in cmd (Windows)?"}, {"owner": {"reputation": 319, "user_id": 1596011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77061ba6a8415bd278e827949b8a1495?s=128&d=identicon&r=PG", "display_name": "th3coop", "link": "https://stackoverflow.com/users/1596011/th3coop"}, "reply_to_user": {"reputation": 362, "user_id": 6182181, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/12dc314285354ddaccb1342824def21d?s=128&d=identicon&r=PG&f=1", "display_name": "Miko\u0142aj Wa\u015bniewski", "link": "https://stackoverflow.com/users/6182181/miko%c5%82aj-wa%c5%9bniewski"}, "edited": false, "score": 0, "creation_date": 1513964642, "post_id": 47892560, "comment_id": 82860489, "body": "I help write Komodo so yes I&#39;ve used the SDK :). I don&#39;t have a computer with me for about two weeks so I can&#39;t write something for you.  There are examples of using the SDK in the docs.  If you need more help ask in the Komodo forums. Someone will answer within a day I&#39;m sure."}, {"owner": {"reputation": 319, "user_id": 1596011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77061ba6a8415bd278e827949b8a1495?s=128&d=identicon&r=PG", "display_name": "th3coop", "link": "https://stackoverflow.com/users/1596011/th3coop"}, "reply_to_user": {"reputation": 362, "user_id": 6182181, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/12dc314285354ddaccb1342824def21d?s=128&d=identicon&r=PG&f=1", "display_name": "Miko\u0142aj Wa\u015bniewski", "link": "https://stackoverflow.com/users/6182181/miko%c5%82aj-wa%c5%9bniewski"}, "edited": false, "score": 0, "creation_date": 1516140168, "post_id": 47892560, "comment_id": 83566147, "body": "As i said above, there are examples in the docs if you look.   This is the module you&#39;ll want to use here.  <a href=\"http://docs.activestate.com/komodo/11/sdk/api/module-ko_shell.html\" rel=\"nofollow noreferrer\">docs.activestate.com/komodo/11/sdk/api/module-ko_shell.html</a>  So it&#39;ll be something like <code>require(&quot;ko&#47;shell&quot;).exec(&quot;ls -la&quot;, {}, ()=&gt;{console.log(&quot;I ran&quot;)})</code>.  You put that in a macro, set the trigger property to run on save and you&#39;re done."}], "tags": [], "owner": {"reputation": 319, "user_id": 1596011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77061ba6a8415bd278e827949b8a1495?s=128&d=identicon&r=PG", "display_name": "th3coop", "link": "https://stackoverflow.com/users/1596011/th3coop"}, "is_accepted": false, "score": 0, "last_activity_date": 1556462829, "last_edit_date": 1556462829, "creation_date": 1513705688, "answer_id": 47892560, "question_id": 47891430, "link": "https://stackoverflow.com/questions/47891430/komodo-11-run-script-when-saving-a-file/47892560#47892560", "title": "Komodo 11 - run script when saving a file", "body": "<p><strong>Edited to Userscrips, not Run Commands</strong></p>\n\n<p>You're looking for <em>Userscripts</em> in the Toolbox:\n<a href=\"http://docs.activestate.com/komodo/11/manual/macros.html\" rel=\"nofollow noreferrer\">http://docs.activestate.com/komodo/11/manual/macros.html</a></p>\n\n<p>Then use the <em>shell</em> module from the Komodo Javascript SDK:\n<a href=\"http://docs.activestate.com/komodo/11/sdk/api/module-ko_shell.html\" rel=\"nofollow noreferrer\">http://docs.activestate.com/komodo/11/sdk/api/module-ko_shell.html</a></p>\n\n<p>Example:</p>\n\n<pre><code>require(\"ko/shell\").exec(\"ls -la\", {}, ()=&gt;{console.log(\"I ran\")})\n</code></pre>\n\n<p>That will run <code>ls -la</code>.  You can try that in the Komodo Console, <em>View Menu > Tabs &amp; Sidebars > Console</em>.  </p>\n\n<p>If you need more information have a look at the docs or post in the Komodo forums.  We answer questions almost daily:\ncommunity.komodoide.com</p>\n"}], "owner": {"reputation": 362, "user_id": 6182181, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/12dc314285354ddaccb1342824def21d?s=128&d=identicon&r=PG&f=1", "display_name": "Miko\u0142aj Wa\u015bniewski", "link": "https://stackoverflow.com/users/6182181/miko%c5%82aj-wa%c5%9bniewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556462829, "creation_date": 1513701669, "question_id": 47891430, "link": "https://stackoverflow.com/questions/47891430/komodo-11-run-script-when-saving-a-file", "title": "Komodo 11 - run script when saving a file", "body": "<p>In my company we are using Komodo 11 for our project written in Perl on the backend and Javascript on the frontend. And there's a problem because we are using mod_perl module on Apache server and every time when we make change in our Perl files we have to restart Apache server to clear cache and see our changes on the server.</p>\n\n<p>Is there a solution in Komodo to run every time console command (restarting Apache server) when saving a file? Because I don't want to restart Apache manually after every change in Perl file.</p>\n"}, {"tags": ["perl", "teradata", "dbi"], "comments": [{"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 3, "creation_date": 1513700427, "post_id": 47891005, "comment_id": 82748514, "body": "Where is <code>@lines</code> coming from? What database driver do you use? How do you populate <code>$rows</code>?"}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "reply_to_user": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1513700677, "post_id": 47891005, "comment_id": 82748672, "body": "Sorry I missed some code. I am splitting it: @lines = split/,/,$st;   Since the first result is coming from all in one line and I am breaking part. I am using Teradata ODBC driver, &#39;dbi:ODBC. I am populating with selectall_arrayref($sql) and I have also tried: fetch_all_array.  Thanks!"}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 3, "creation_date": 1513701403, "post_id": 47891005, "comment_id": 82749092, "body": "Please, update the code in the question accordingly."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 1, "creation_date": 1513701930, "post_id": 47891005, "comment_id": 82749433, "body": "I&#39;ve edited your code to add some indentation (and a little bit of whitespace). You&#39;re welcome, but please do it yourself in the future. Good indentation is an important tool to help people (including you!) understand your code. If you&#39;re asking a large group of strangers to read and understand your code, it&#39;s only polite to make that as easy as possible for them."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513703879, "post_id": 47891005, "comment_id": 82750656, "body": "You probably want <code>for my $st ( @$h ) { ... } </code> but it&#39;s very hard to tell with such a tiny sample of code and no data."}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1513707779, "post_id": 47891005, "comment_id": 82752602, "body": "I have updated the code again .Please let me know what should I change."}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513708403, "post_id": 47891005, "comment_id": 82752899, "body": "<b><code>INNIER</code></b> join?"}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513708962, "post_id": 47891005, "comment_id": 82753137, "body": "@PerlDuck, the SQL can be anything but with a show prefix in Teradata should display all the object name and it&#39;s definition (DDL) one after another. Say on this Inner join if there are 2 tables (table and table1) the result you expect two ddls for the above tables. Hope that explains and thanks!"}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513710258, "post_id": 47891005, "comment_id": 82753715, "body": "Before doing fancy things with your results (like <code>s&#47;&#47;&#47;</code> and <code>split</code>) I&#39;d make sure that the (unprocessed!) result actually contains what you expect it to. Add <code>use Data::Dumper;</code> somewhere at the top and <code>print Data::Dumper::Dumper( $rows );</code> right after your <code>my $rows = $dbh-&gt;selectall_arrayref(\u2026)</code>. /// I&#39;m pretty sure the SQL after <code>show</code> can <i>not</i> be anything. I presume it must be valid SQL at least."}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513710752, "post_id": 47891005, "comment_id": 82753921, "body": "@PerlDuck, did that and somehow it is printing 1 ddl still. Here it looks like: $VAR1 = [           [       DDL1,           ]         ];   That makes me wonder if Selectall_arrayref () is not the right method to use? Any thoughts? thanks"}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513710913, "post_id": 47891005, "comment_id": 82753986, "body": "Then perhaps the DB driver for Teradata doesn&#39;t properly support the <code>show</code> statement. I cannot tell; I never heard of Teradata before."}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513712066, "post_id": 47891005, "comment_id": 82754573, "body": "@PerlDuck The odbc driver does support it as I am able to use other third party tool and getting proper results. I think its is the selectall_array method has the issue of not returning all contents. Are there anything else I can try? Also beside DBI library are there any other way to do this? thanks"}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513712333, "post_id": 47891005, "comment_id": 82754724, "body": "The <a href=\"http://search.cpan.org/~timb/DBI-1.637/DBI.pm#selectall_arrayref\" rel=\"nofollow noreferrer\">docs say</a> <code>selectall_arrayref</code> is just a shortcut for <code>prepare</code>, <code>execute</code> and <code>fetchall_arrayref</code>. You can try, but I have doubts."}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513712883, "post_id": 47891005, "comment_id": 82755014, "body": "@PerlDuck, I tried that fetchall_arrayref too but same thing. I am definitely missing something....."}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1513731922, "post_id": 47891005, "comment_id": 82761635, "body": "Any other suggestions? Appreciate any help"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1513772687, "post_id": 47891005, "comment_id": 82778749, "body": "@AftabKhan: I&#39;ve fixed the indentation in your code for a second time. Why did you break the work I had previously done? I also fixed a typo (<code>INNER</code> vs <code>INNIER</code>). Please don&#39;t just type code into your question - cut and paste your <b>actual</b> code to avoid wasting our time."}, {"owner": {"reputation": 962, "user_id": 4204127, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1241595301/picture?type=large", "display_name": "Ed Dunn", "link": "https://stackoverflow.com/users/4204127/ed-dunn"}, "edited": false, "score": 0, "creation_date": 1513777822, "post_id": 47891005, "comment_id": 82782156, "body": "I always refer to this post <a href=\"http://www.perlmonks.org/?node_id=284436\" rel=\"nofollow noreferrer\">perlmonks.org/?node_id=284436</a> when dealing with DBI."}], "answers": [{"comments": [{"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513791356, "post_id": 47909233, "comment_id": 82790597, "body": "I already asked something similar <a href=\"https://stackoverflow.com/questions/47891005/how-to-return-multiple-records-from-a-result-set#comment82753715_47891005\">in a comment</a>. They say it prints just one record (<code>scalar(@$rows) == 1</code>)."}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1513802406, "post_id": 47909233, "comment_id": 82795872, "body": "Also to add my query result of that &quot;Show&quot; command should be two DDLs that is two create table statement with all the columns indexes etc. Thanks!"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 1, "creation_date": 1513837102, "post_id": 47909233, "comment_id": 82805643, "body": "@AftabKhan: Why have you ignored my request?"}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1513864319, "post_id": 47909233, "comment_id": 82820585, "body": "@DaveCross, I am sorry I did not see your post. It was in intentional. Next time I will follow the indenting you recommended only reason I was not posting all the query is to avoid any proprietary issue since some of the code could be exposed and violate some guidelines of the company. Any way back to the point, I think SELECTALL_ARRAYREF is not handling my request properly. Are there anything else I can try? thanks"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1513864716, "post_id": 47909233, "comment_id": 82820828, "body": "@AftabKhan: You did not see my post, but you replied to it. That seems... unlikely :-) It also seems unlikely that <code>selectall_arrayref()</code> doesn&#39;t work for your question when it works for every other query in the universe, ever! There are, of course, many other DBI methods that you can use for fetching the results of a query, but I suspect they will all be broken in exactly the same way. If you don&#39;t want to share the output of your query with us, then I&#39;m afraid I can&#39;t be any more help to you."}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1513954831, "post_id": 47909233, "comment_id": 82856526, "body": "@DaveCross sorry if I have felt you confused or made me confused but I am lost and did not get it to work.  I did edit my question and put the output there. Not sure what else do I need to do.  If you give me your email may be I can talk to you direct"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1513954995, "post_id": 47909233, "comment_id": 82856596, "body": "@AftabKhan: You included the output of your code. What I asked for was the output of my code - along with an example of what you want the output to be. I&#39;d be happy to help you privately over email, but private help isn&#39;t free."}, {"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1515678554, "post_id": 47909233, "comment_id": 83398006, "body": "@DaveCross, Sorry for the delay as I was in vacation. However I did run as you suggested and the results are the same. See below:                   --------------------------------------------                              --------------------------------------------                              PRIMARY INDEX ( UserId );RACTER                                       SET                              LATIN                                UPPERCASE NOT CASESPECIFIC NOT NULL),"}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 0, "last_activity_date": 1513783111, "creation_date": 1513783111, "answer_id": 47909233, "question_id": 47891005, "link": "https://stackoverflow.com/questions/47891005/how-to-return-multiple-records-from-a-result-set/47909233#47909233", "title": "How to return multiple records from a result set?", "body": "<p>[This probably counts as \"not an answer\", but I'm trying to extract more useful information from the OP, and it's far easier to show him the code I want him to run in an answer]</p>\n\n<p>We still really have no idea what you are trying to do here. And, to be honest, I'm not convinced that you do either :-)</p>\n\n<p>Let's have a look at the raw data - without any of the processing that you're adding. Please try running the following code and then <a href=\"https://stackoverflow.com/posts/47891005/edit\">edit your question</a> to add the output (if it returns a number of rows, you only need to include a couple).</p>\n\n<pre><code>my $rows = $dbh-&gt;selectall_arrayref\n                  (\"show SELECT * FROM TABLE\n                   INNER JOIN TABLE1 \n                   ON bla bla ;\");\n\nforeach my $row (@$rows) {\n  print join(' / ', @$row), \"\\n\";\n}\n</code></pre>\n\n<p>Then, please tell us (using those rows as an example) what output you want.</p>\n"}], "owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513802322, "creation_date": 1513700190, "last_edit_date": 1513802322, "question_id": 47891005, "link": "https://stackoverflow.com/questions/47891005/how-to-return-multiple-records-from-a-result-set", "title": "How to return multiple records from a result set?", "body": "<p>I am using perl dbi and getting the sql results however it's coming as an array. The problem is , it only returns 1 array element. I tried to push to get the next element but there is nothing. I am sure (with other tool) I can see there are more then one values. It is (from other tool) I get multiple ddls. With my query I am only getting one of them.  Here is my query:</p>\n\n<pre><code>my $rows = $dbh-&gt;selectall_arrayref\n                  (\"show SELECT * FROM TABLE\n                   INNER JOIN TABLE1 \n                   ON bla bla ;\");\n\nmy $len = @$rows;\nprint  $len;\nforeach $h (@$rows) {\n    $st = $h-&gt;[0];\n    $st =~ s/(\\d),(\\d)/\\1|\\2/g;\n    @lines = split/,/,$st;\n    foreach $x (@lines) {\n        print FH $x . \"\\n\";\n    }\n}\n</code></pre>\n\n<p>My question is how do I shift the same array and get next result set from same row?  Thanks!</p>\n\n<p>The result of the above code is below:</p>\n\n<h2>    PRIMARY INDEX ( ProcID ,CollectTimeStamp );ONE)NICODE NOT CASESPECIFIC,,OT    NULL,C,</h2>\n\n<p>I don't think it brings back the entire content, somehow it is not complete</p>\n"}, {"tags": ["regex", "perl", "unicode"], "comments": [{"owner": {"reputation": 10858, "user_id": 788700, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f02925eef8f737905a8702b9cc21ff07?s=128&d=identicon&r=PG", "display_name": "Adobe", "link": "https://stackoverflow.com/users/788700/adobe"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513699150, "post_id": 47890641, "comment_id": 82747785, "body": "@ikegami: yeap, I&#39;m passing UTF-8. But isn&#39;t world is mostly UTF-8 now?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1513700782, "post_id": 47890641, "comment_id": 82748730, "body": "No, the world works with decoded text (<code>String</code> instead of <code>byte[]</code>, <code>Reader</code>s over <code>Stream</code>s, etc). That way, they are encoding-agnostic, and they can be much simpler since they don&#39;t worry about the encoded-width of a character."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513709567, "post_id": 47891439, "comment_id": 82753397, "body": "Technically, <code>&#209;</code> is also a <code>\\w</code> char, so the <code>\\b</code> should match, but it doesn&#39;t because of a bug in Perl that&#39;s fixed by adding <code>use feature qw( unicode_strings );</code> or <code>use 5.014;</code>. I didn&#39;t mention this because this bug in Perl is rendered moot once we fix your problem the right way."}, {"owner": {"reputation": 10858, "user_id": 788700, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f02925eef8f737905a8702b9cc21ff07?s=128&d=identicon&r=PG", "display_name": "Adobe", "link": "https://stackoverflow.com/users/788700/adobe"}, "edited": false, "score": 0, "creation_date": 1513710240, "post_id": 47891439, "comment_id": 82753700, "body": "Thanks. I think I&#39;ll use <code>-CSDA -Mutf8</code> from this day on."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 6, "last_activity_date": 1513702826, "last_edit_date": 1513702826, "creation_date": 1513701693, "answer_id": 47891439, "question_id": 47890641, "link": "https://stackoverflow.com/questions/47890641/unicode-aware-word-boundary-in-perl/47891439#47891439", "title": "Unicode-aware word-boundary in perl", "body": "<p>You told <code>s///</code> to match against the following:</p>\n\n<pre><code>22.22.74.65.73.74.22.22.20.22.22.D1.82.D0.B5.D1.81.D1.82.22.22.A\n</code></pre>\n\n<p><code>s///</code> (or more specifically, <code>\\b</code>), expects Unicode Code Points, so that means the above is treated as</p>\n\n<pre><code>\"\"test\"\" \"\"\u00d1&lt;82&gt;\u00d0\u00b5\u00d1&lt;81&gt;\u00d1&lt;82&gt;\"\"\n</code></pre>\n\n<p>That's obviously not what you want the string to be.</p>\n\n<hr>\n\n<p>Similarly, you claim your code contains the following:</p>\n\n<pre><code>s/\"\"\\b/\u201c/g\n</code></pre>\n\n<p>Perl expects the script to be encoded using ASCII unless you encode the script using UTF-8 and add <code>use utf8;</code> to let it know.</p>\n\n<hr>\n\n<p><strong>Decode inputs. Encode outputs.</strong></p>\n\n<pre><code>$ echo '\"\"test\"\" \"\"\u0442\u0435\u0441\u0442\"\"' | perl -pe'\n    use utf8;\n    use open \":std\", \":encoding(UTF-8)\";\n    s/\"\"\\b/\u201c/g\n'\n\u201ctest\"\" \u201c\u0442\u0435\u0441\u0442\"\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>$ echo '\"\"test\"\" \"\"\u0442\u0435\u0441\u0442\"\"' | perl -CSDA -Mutf8 -pe's/\"\"\\b/\u201c/g'\n\u201ctest\"\" \u201c\u0442\u0435\u0441\u0442\"\"\n</code></pre>\n"}], "owner": {"reputation": 10858, "user_id": 788700, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f02925eef8f737905a8702b9cc21ff07?s=128&d=identicon&r=PG", "display_name": "Adobe", "link": "https://stackoverflow.com/users/788700/adobe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 47891439, "answer_count": 1, "score": 0, "last_activity_date": 1513702826, "creation_date": 1513698844, "question_id": 47890641, "link": "https://stackoverflow.com/questions/47890641/unicode-aware-word-boundary-in-perl", "title": "Unicode-aware word-boundary in perl", "body": "<p>I'm on perl-5.24 and I stumbled upon <code>\\b</code> being not unicode aware:</p>\n\n<pre><code>$ echo '\"\"test\"\" \"\"\u0442\u0435\u0441\u0442\"\"' | perl -pe 's/\"\"\\b/\u201c/g'\n\u201ctest\"\" \"\"\u0442\u0435\u0441\u0442\"\"\n</code></pre>\n\n<p>where as I expected it to be <code>\u201ctest\"\" \u201c\u0442\u0435\u0441\u0442\"\"</code>.</p>\n\n<p>Then I learned about unicode extensions in perl-5.22.1 regex, in particular this one: <code>\\b{wb}</code>. But with these extensions I still get wrong results:</p>\n\n<pre><code>$ echo '\"\"test\"\" \"\"\u0442\u0435\u0441\u0442\"\"' | perl -pe 's/\"\"\\b{wb}/\u201c/g'\n\u201ctest\u201c \u201c\u0442\u0435\u0441\u0442\u201c\n</code></pre>\n\n<p>where as I expected it to be <code>\u201ctest\"\" \u201c\u0442\u0435\u0441\u0442\"\"</code>.</p>\n\n<p>My question is: who do I transform <code>\"\"test\"\" \"\"\u0442\u0435\u0441\u0442\"\"</code> to <code>\u201ctest\"\" \u201c\u0442\u0435\u0441\u0442\"\"</code> via perl regex?</p>\n"}, {"tags": ["regex", "perl", "replace"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1513697175, "post_id": 47890125, "comment_id": 82746518, "body": "Where is your attempt? What have you explored?"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 1, "creation_date": 1513697191, "post_id": 47890125, "comment_id": 82746526, "body": "Since this is an XML structure, I would recommend looking at an XML solution rather than a Perl solution."}, {"owner": {"reputation": 167, "user_id": 1894592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QcTJ2.jpg?s=128&g=1", "display_name": "Mariano", "link": "https://stackoverflow.com/users/1894592/mariano"}, "edited": false, "score": 0, "creation_date": 1513697267, "post_id": 47890125, "comment_id": 82746594, "body": "i want replace &lt;PMRQ:InstrId&gt;94&lt;/PMRQ:InstrId&gt; but only when &lt;PMRQ:InstrId&gt; is found after match &quot;Mario Rossi&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 811, "user_id": 4410202, "user_type": "registered", "profile_image": "https://graph.facebook.com/1226166414/picture?type=large", "display_name": "Eduardo Lynch Araya", "link": "https://stackoverflow.com/users/4410202/eduardo-lynch-araya"}, "edited": false, "score": 0, "creation_date": 1513697627, "post_id": 47890238, "comment_id": 82746834, "body": "Good answer, but he is asking for help with Perl."}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "reply_to_user": {"reputation": 811, "user_id": 4410202, "user_type": "registered", "profile_image": "https://graph.facebook.com/1226166414/picture?type=large", "display_name": "Eduardo Lynch Araya", "link": "https://stackoverflow.com/users/4410202/eduardo-lynch-araya"}, "edited": false, "score": 0, "creation_date": 1513698721, "post_id": 47890238, "comment_id": 82747540, "body": "@EduardoLynchAraya: <code>xsh</code> is written in Perl, it&#39;s a wrapper around its <a href=\"http://p3rl.org/XML::LibXML\" rel=\"nofollow noreferrer\">XML::LibXML</a> library. You can include this code into your Perl script as a parameter to the <code>xsh</code> function."}, {"owner": {"reputation": 167, "user_id": 1894592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QcTJ2.jpg?s=128&g=1", "display_name": "Mariano", "link": "https://stackoverflow.com/users/1894592/mariano"}, "edited": false, "score": 0, "creation_date": 1513700528, "post_id": 47890238, "comment_id": 82748584, "body": "i need a into perl script, have you any idea?"}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "reply_to_user": {"reputation": 167, "user_id": 1894592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QcTJ2.jpg?s=128&g=1", "display_name": "Mariano", "link": "https://stackoverflow.com/users/1894592/mariano"}, "edited": false, "score": 0, "creation_date": 1513701328, "post_id": 47890238, "comment_id": 82749051, "body": "@Mariano: Yes, install <a href=\"http://p3rl.org/XML::XSH2\" rel=\"nofollow noreferrer\">XML::XSH2</a>, put <code>xsh &#39;...&#39;</code> around my code, and that&#39;s it."}, {"owner": {"reputation": 167, "user_id": 1894592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QcTJ2.jpg?s=128&g=1", "display_name": "Mariano", "link": "https://stackoverflow.com/users/1894592/mariano"}, "edited": false, "score": 0, "creation_date": 1513701812, "post_id": 47890238, "comment_id": 82749355, "body": "thanks if i need to replace PMRQ:InstrId with &lt;PMRQ:Amt Ccy=&quot;VAL&quot;&gt;"}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1513702029, "post_id": 47890238, "comment_id": 82749491, "body": "Use <code>set ...&#47;PMRQ:Amt&#47;@Ccy value</code> to set an attribute value."}, {"owner": {"reputation": 167, "user_id": 1894592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QcTJ2.jpg?s=128&g=1", "display_name": "Mariano", "link": "https://stackoverflow.com/users/1894592/mariano"}, "edited": false, "score": 0, "creation_date": 1513702059, "post_id": 47890238, "comment_id": 82749509, "body": "<a href=\"https://pastebin.com/qx6GNqtQ\" rel=\"nofollow noreferrer\">pastebin.com/qx6GNqtQ</a> this is the real XML, which is the code that i can replace 1529.27 only after Mario Rossi? Really thanks Choroba"}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": false, "score": 1, "last_activity_date": 1513697433, "creation_date": 1513697433, "answer_id": 47890238, "question_id": 47890125, "link": "https://stackoverflow.com/questions/47890125/replace-content-regex-perl-multiline/47890238#47890238", "title": "Replace content regex - Perl (multiline)", "body": "<p>For example, in <a href=\"http://metacpan.org/pod/distribution/XML-XSH2/xsh\" rel=\"nofollow noreferrer\">xsh</a> you can write</p>\n\n<pre><code>open file.xml ;\nfor //PMRQ:Name[.=\"Mario Rossi\"]\n    set following-sibling::PMRQ:PmtId[1]/PMRQ:InstrId 98 ;\nsave :b ;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 9104374, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ygq-6V5SbSo/AAAAAAAAAAI/AAAAAAAAABk/zU76uLLrcVU/photo.jpg?sz=128", "display_name": "GiulioP", "link": "https://stackoverflow.com/users/9104374/giuliop"}, "is_accepted": false, "score": 0, "last_activity_date": 1513873313, "creation_date": 1513873313, "answer_id": 47928916, "question_id": 47890125, "link": "https://stackoverflow.com/questions/47890125/replace-content-regex-perl-multiline/47928916#47928916", "title": "Replace content regex - Perl (multiline)", "body": "<p>This works, no extra modules required.</p>\n\n<p>Assume $text contains the multiline data you want to modify. Then just do:</p>\n\n<pre><code>$text=~s/&lt;PMRQ:Name&gt;Mario Rossi&lt;\\/PMRQ:Name&gt;\\s*&lt;PMRQ:PmtId&gt;\\s*&lt;PMRQ:InstrId&gt;\\K\\d+/98/msg;\n</code></pre>\n\n<p>The 'g' (global) modifier at the end is needed to perform multiple matches (but does not hurt if you have zero or one matches).</p>\n"}], "owner": {"reputation": 167, "user_id": 1894592, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QcTJ2.jpg?s=128&g=1", "display_name": "Mariano", "link": "https://stackoverflow.com/users/1894592/mariano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1513873313, "creation_date": 1513697046, "question_id": 47890125, "link": "https://stackoverflow.com/questions/47890125/replace-content-regex-perl-multiline", "title": "Replace content regex - Perl (multiline)", "body": "<p>how can i replace this value only when i catch Name = \"Mario Rossi\"?</p>\n\n<p>i need to replace 94 with 98 only for </p>\n\n<pre><code>&lt;PMRQ:Name&gt;John Smith&lt;/PMRQ:Name&gt;\n&lt;PMRQ:PmtId&gt;                                                                    \n&lt;PMRQ:InstrId&gt;95&lt;/PMRQ:InstrId&gt;                                                 \n&lt;PMRQ:EndToEndId&gt;45700100523011712061901541&lt;/PMRQ:EndToEndId&gt;                   \n&lt;/PMRQ:PmtId&gt; \n\n&lt;PMRQ:Name&gt;Mario Rossi&lt;/PMRQ:Name&gt;\n&lt;PMRQ:PmtId&gt;                                                                    \n&lt;PMRQ:InstrId&gt;94&lt;/PMRQ:InstrId&gt;                                                 \n&lt;PMRQ:EndToEndId&gt;45700100522011712061901541&lt;/PMRQ:EndToEndId&gt;                  \n&lt;/PMRQ:PmtId&gt; \n</code></pre>\n\n<p>Thanks for help!!</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1513717888, "post_id": 47889822, "comment_id": 82757188, "body": "It makes no sense to add a shebang (<code>#!</code>) line to a .pm file."}], "answers": [{"comments": [{"owner": {"reputation": 2415, "user_id": 4251338, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/UNbCO.png?s=128&g=1", "display_name": "ssr1012", "link": "https://stackoverflow.com/users/4251338/ssr1012"}, "edited": false, "score": 1, "creation_date": 1513780171, "post_id": 47889915, "comment_id": 82783701, "body": "This should be in comment not an answer"}], "tags": [], "owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "is_accepted": false, "score": -1, "last_activity_date": 1513696280, "creation_date": 1513696280, "answer_id": 47889915, "question_id": 47889822, "link": "https://stackoverflow.com/questions/47889822/in-perl-why-do-i-get-undefined-subroutine-in-a-perl-module-but-not-in-main/47889915#47889915", "title": "In Perl, why do I get &quot;undefined subroutine&quot; in a perl module but not in main ?", "body": "<p>I think I figured it out.  If, in the perl module, I prefix the \"capture_exec_combined\" with \"::\", it works.  </p>\n\n<p>Still, why isn't this needed in the main, try.pl ?</p>\n"}, {"comments": [{"owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "edited": false, "score": 0, "creation_date": 1513699258, "post_id": 47890062, "comment_id": 82747859, "body": "Hmmmm...  So one way to get everything into the main space would be to omit the &quot;package&quot; statement altogether ?   I have 2 different main scripts that are going to use the stuff in this perl module.  I&#39;m beginning to wonder what the point is in using the &quot;package&quot; statement at all."}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "reply_to_user": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "edited": false, "score": 5, "creation_date": 1513699956, "post_id": 47890062, "comment_id": 82748257, "body": "Omitting the <code>package</code> statement would cause more troubles in the long run than it would solve. Learn to write proper Perl modules (see <a href=\"http://p3rl.org/perlmod\" rel=\"nofollow noreferrer\">perlmod</a>)."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "edited": false, "score": 1, "creation_date": 1513702326, "post_id": 47890062, "comment_id": 82749694, "body": "@daveg, For the same reason as you are using multiple files: For separation of unrelated things. This separation allows modules to have subs with the same name, for example. There&#39;s no way you can guarantee that your module won&#39;t have the same as any other module your program might use. /// It also allows the program to have more than one class."}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513717784, "post_id": 47890062, "comment_id": 82757142, "body": "@ikegami \u2026 which can make them more <i>classy</i> ;-)"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513717820, "post_id": 47890062, "comment_id": 82757156, "body": "@PerlDuck, You&#39;re so \ud83c\udf3dy."}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513718182, "post_id": 47890062, "comment_id": 82757309, "body": "@ikegami Errr \u2026 thank you. They force you to write that, right?"}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 6, "last_activity_date": 1513696867, "creation_date": 1513696867, "answer_id": 47890062, "question_id": 47889822, "link": "https://stackoverflow.com/questions/47889822/in-perl-why-do-i-get-undefined-subroutine-in-a-perl-module-but-not-in-main/47890062#47890062", "title": "In Perl, why do I get &quot;undefined subroutine&quot; in a perl module but not in main ?", "body": "<p>You imported <code>capture_exec_combined</code> by the <code>use</code> clause before declaring the package, so it was imported into the <code>main</code> package, not the <code>try_common</code>. Move the package declaration further up.</p>\n"}, {"comments": [{"owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "edited": false, "score": 0, "creation_date": 1513699429, "post_id": 47890287, "comment_id": 82747957, "body": "Thanks you for this detailed explanation.  I&#39;m cutting and pasting it into my notes now :-)"}, {"owner": {"reputation": 1672, "user_id": 4355253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee8cbfecfb7686f370b07eea52273c5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Elices", "link": "https://stackoverflow.com/users/4355253/javier-elices"}, "reply_to_user": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "edited": false, "score": 0, "creation_date": 1513703398, "post_id": 47890287, "comment_id": 82750361, "body": "Sure, have a look at the links too. This is only a brief summary."}], "tags": [], "owner": {"reputation": 1672, "user_id": 4355253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee8cbfecfb7686f370b07eea52273c5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Elices", "link": "https://stackoverflow.com/users/4355253/javier-elices"}, "is_accepted": false, "score": 4, "last_activity_date": 1513697973, "last_edit_date": 1513697973, "creation_date": 1513697566, "answer_id": 47890287, "question_id": 47889822, "link": "https://stackoverflow.com/questions/47889822/in-perl-why-do-i-get-undefined-subroutine-in-a-perl-module-but-not-in-main/47890287#47890287", "title": "In Perl, why do I get &quot;undefined subroutine&quot; in a perl module but not in main ?", "body": "<p>You should take a look at the <a href=\"https://perldoc.perl.org/perlmod.html\" rel=\"nofollow noreferrer\">perlmod</a> document to understand how modules work. In short:</p>\n\n<ol>\n<li><p>When you use <code>package A</code> (in Perl 5), you change the namespace of the following code to <code>A</code>, and all global symbol (e.g. subroutine) definitions after that point will go into that package. Subroutines inside a scope need not be <em>exported</em> and may be used preceded by their scope name: <code>A::function</code>. This you seem to have found.</p></li>\n<li><p>Perl uses <code>package</code> as a way to create <em>modules</em> and split code in different files, but also as the basis for its object orientation features.</p></li>\n<li><p>Most of the times, <em>modules</em> are handled by a special core module called <code>Exporter</code>. See <a href=\"http://perldoc.perl.org/Exporter.html\" rel=\"nofollow noreferrer\">Exporter</a>. This module uses some variables to know what to do, like <code>@EXPORT</code>, <code>@EXPORT_OK</code> or <code>@ISA</code>. The first defines the names that should be exported by default when you <em>include</em> the module with <code>use Module</code>. The second defines the names that may be exported (but need to be mentioned with <code>use Module qw(name1 name2)</code>. The last tells in an object oriented fashion what your module <em>is</em>. If you don't care about object orientation, your module typically \"is a\" <code>Exporter</code>.</p></li>\n</ol>\n\n<p>Also, as stated in another answer, when you define a module, the <code>package module</code> declaration should be the first thing to be in the file so anything after it will be under that scope.</p>\n"}, {"tags": [], "owner": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "is_accepted": false, "score": 0, "last_activity_date": 1513710151, "creation_date": 1513710151, "answer_id": 47893583, "question_id": 47889822, "link": "https://stackoverflow.com/questions/47889822/in-perl-why-do-i-get-undefined-subroutine-in-a-perl-module-but-not-in-main/47893583#47893583", "title": "In Perl, why do I get &quot;undefined subroutine&quot; in a perl module but not in main ?", "body": "<p>I hate when I make this mistake although I don't make it much anymore. There are two habits you can develop:</p>\n\n<p>Most likely, make the entire file the package. The first lines will be the <code>package</code> statement and no other <code>package</code> statements show up in the file.</p>\n\n<p>Or, use the new PACKAGE BLOCK syntax and put everything for that package inside the block. I do this for small classes that I might need only locally:</p>\n\n<pre><code>package Foo {\n    # everything including use statements go in this block\n    }\n</code></pre>\n"}], "owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4842, "favorite_count": 1, "accepted_answer_id": 47890062, "answer_count": 4, "score": 0, "last_activity_date": 1513710151, "creation_date": 1513695909, "question_id": 47889822, "link": "https://stackoverflow.com/questions/47889822/in-perl-why-do-i-get-undefined-subroutine-in-a-perl-module-but-not-in-main", "title": "In Perl, why do I get &quot;undefined subroutine&quot; in a perl module but not in main ?", "body": "<p>I'm getting an \"undefined subroutine\" for sub2 in the code below but not for sub1.</p>\n\n<p>This is the perl script (try.pl)...</p>\n\n<pre><code>#!/usr/bin/env perl\n\nuse strict;\nuse IO::CaptureOutput qw(capture_exec_combined);\n\nuse FindBin qw($Bin);\nuse lib \"$Bin\";\nuse try_common;\n\nprint \"Running try.pl\\n\";\nsub1(\"echo \\\"in sub1\\\"\");\nsub2(\"echo \\\"in sub2\\\"\");\n\nexit;\n\nsub sub1 {\n\n(my $cmd) = @_;\n\nprint \"Executing... \\\"${cmd}\\\"\\n\";\nmy ($stdouterr, $success, $exit_code) = capture_exec_combined($cmd);\nprint \"${stdouterr}\\n\";\n\nreturn;\n}\n</code></pre>\n\n<p>This is try_common.pm...</p>\n\n<pre><code>#! /usr/bin/env perl\n\nuse strict;\nuse IO::CaptureOutput qw(capture_exec_combined);\n\npackage try_common;\n\nuse Exporter;\nour @ISA = qw(Exporter);\nour @EXPORT = qw(\n  sub2\n);\n\nsub sub2 {\n\n    (my $cmd) = @_;\n\n    print \"Executing... \\\"${cmd}\\\"\\n\";\n    my ($stdouterr, $success, $exit_code) = capture_exec_combined($cmd);\n    print \"${stdouterr}\\n\";\n\n    return;\n}\n\n1;\n</code></pre>\n\n<p>When I run try.pl I get...</p>\n\n<pre><code>% ./try.pl\nRunning try.pl\nExecuting... \"echo \"in sub1\"\"\nin sub1\n\nExecuting... \"echo \"in sub2\"\"\nUndefined subroutine &amp;try_common::capture_exec_combined called at \n/home/me/PERL/try_common.pm line 20.\n</code></pre>\n\n<p>This looks like some kind of scoping issue because if I cut/paste the \"use IO::CaptureOutput qw(capture_exec_combined);\" as the first line of sub2, it works.  This is not necessary in the try.pl (it runs sub1 OK), but a problem in the perl module.   Hmmmm....  </p>\n\n<p>Thanks in Advance for any help!</p>\n"}, {"tags": ["perl", "split"], "comments": [{"owner": {"reputation": 11816, "user_id": 443523, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/i2GmF.jpg?s=128&g=1", "display_name": "Mark Baijens", "link": "https://stackoverflow.com/users/443523/mark-baijens"}, "edited": false, "score": 0, "creation_date": 1513685666, "post_id": 47886735, "comment_id": 82739190, "body": "split on position. all columns seem to have the same width."}, {"owner": {"reputation": 173, "user_id": 6649485, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10154029558157928/picture?type=large", "display_name": "Andreas Tosstorff", "link": "https://stackoverflow.com/users/6649485/andreas-tosstorff"}, "reply_to_user": {"reputation": 11816, "user_id": 443523, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/i2GmF.jpg?s=128&g=1", "display_name": "Mark Baijens", "link": "https://stackoverflow.com/users/443523/mark-baijens"}, "edited": false, "score": 0, "creation_date": 1513685968, "post_id": 47886735, "comment_id": 82739369, "body": "Thanks for your suggestion. They do not have all the same width though. E.g. column 5 (where it says &#39;C&#39;) has the length of 1 digit."}, {"owner": {"reputation": 11816, "user_id": 443523, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/i2GmF.jpg?s=128&g=1", "display_name": "Mark Baijens", "link": "https://stackoverflow.com/users/443523/mark-baijens"}, "edited": false, "score": 0, "creation_date": 1513696937, "post_id": 47886735, "comment_id": 82746346, "body": "the columns are the same length for each row i mean. Column 5 has length of 1 for each row. So each column always start at the same place. Therefor you can split on position. This is at least true for the example you showed."}], "answers": [{"comments": [{"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1513712081, "post_id": 47887162, "comment_id": 82754583, "body": "Nice solution. But there are also <a href=\"https://www.google.de/search?q=perl+read+pdb\" rel=\"nofollow noreferrer\">some Perl modules</a> out there that do parse PDB files, for instance <a href=\"http://search.cpan.org/~rulix/Bio-PDB-Structure-0.02/lib/Bio/PDB/Structure.pm\" rel=\"nofollow noreferrer\"><code>Bio::PDB::Structure</code></a>. No idea whether they are good, but they exist."}], "tags": [], "owner": {"reputation": 173, "user_id": 6649485, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10154029558157928/picture?type=large", "display_name": "Andreas Tosstorff", "link": "https://stackoverflow.com/users/6649485/andreas-tosstorff"}, "is_accepted": false, "score": 4, "last_activity_date": 1513686838, "creation_date": 1513686838, "answer_id": 47887162, "question_id": 47886735, "link": "https://stackoverflow.com/questions/47886735/split-a-line-into-its-components/47887162#47887162", "title": "split a line into its components", "body": "<p>I solved it by using unpack and defining the length of each column.\n$format = 'A6 A6 A5 A4 A1 A5';\n($ATOM, $atom_num, $atom_type, $res, $chain, $res_num) = unpack($format, $pdb);</p>\n"}], "owner": {"reputation": 173, "user_id": 6649485, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10154029558157928/picture?type=large", "display_name": "Andreas Tosstorff", "link": "https://stackoverflow.com/users/6649485/andreas-tosstorff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513686838, "creation_date": 1513685468, "question_id": 47886735, "link": "https://stackoverflow.com/questions/47886735/split-a-line-into-its-components", "title": "split a line into its components", "body": "<p>I need to split the lines of an input file into its columns. </p>\n\n<pre><code>ATOM      0  HB3 ALA C 999      28.811  -7.680  12.279  1.00 57.53           H   \n\nATOM   7637  N   PRO C1000      27.299  -5.667  10.647  1.00216.82           N\n</code></pre>\n\n<p>The code I have works fine, as long as the 6th column is &lt;1000, or shorter than 4 digits:</p>\n\n<pre><code>($ATOM, $atom_num, $atom_type, $res, $chain, $res_num) = split(\" \", $pdb)\n</code></pre>\n\n<p>However as soon as column 6 reaches 1000, it will no longer discriminate the two columns. I am no expert in perl, but the code I am dealing with is perl, so I need to figure out how to split this e.g. by the number of digits of each column.\nAny suggestions?</p>\n"}, {"tags": ["perl", "ubuntu", "mojolicious", "hypnotoad"], "comments": [{"owner": {"reputation": 2496, "user_id": 2469275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7EZh.png?s=128&g=1", "display_name": "janh", "link": "https://stackoverflow.com/users/2469275/janh"}, "edited": false, "score": 1, "creation_date": 1513686249, "post_id": 47885236, "comment_id": 82739526, "body": "Is the app running on port 8081? Are you accessing nginx via ipv6? What error do you get in the browser?"}, {"owner": {"reputation": 151, "user_id": 1145355, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/98f45fcc0c319071fac5ff3d18ce4076?s=128&d=identicon&r=PG", "display_name": "manashb", "link": "https://stackoverflow.com/users/1145355/manashb"}, "reply_to_user": {"reputation": 2496, "user_id": 2469275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7EZh.png?s=128&g=1", "display_name": "janh", "link": "https://stackoverflow.com/users/2469275/janh"}, "edited": false, "score": 0, "creation_date": 1513687259, "post_id": 47885236, "comment_id": 82740158, "body": "Hi @janh, App is running on port 8081. Browser error - server not found. What is accessing nginx via ipv6? can you help me to understand this"}, {"owner": {"reputation": 2496, "user_id": 2469275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7EZh.png?s=128&g=1", "display_name": "janh", "link": "https://stackoverflow.com/users/2469275/janh"}, "edited": false, "score": 1, "creation_date": 1513691241, "post_id": 47885236, "comment_id": 82742711, "body": "<code>listen [::]:80;</code> tells nginx to listen on ipv6, port 80. Maybe change that to <code>listen 80;</code> to have it listen on all interfaces."}, {"owner": {"reputation": 151, "user_id": 1145355, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/98f45fcc0c319071fac5ff3d18ce4076?s=128&d=identicon&r=PG", "display_name": "manashb", "link": "https://stackoverflow.com/users/1145355/manashb"}, "reply_to_user": {"reputation": 2496, "user_id": 2469275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7EZh.png?s=128&g=1", "display_name": "janh", "link": "https://stackoverflow.com/users/2469275/janh"}, "edited": false, "score": 0, "creation_date": 1513698977, "post_id": 47885236, "comment_id": 82747674, "body": "Added both the line listen 80 and listen [::]:80 so that server is available to both ipv4 and ipv6. But still not accessible from browser. Thanks for the ipv6 thing. It was not in my notice."}], "owner": {"reputation": 151, "user_id": 1145355, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/98f45fcc0c319071fac5ff3d18ce4076?s=128&d=identicon&r=PG", "display_name": "manashb", "link": "https://stackoverflow.com/users/1145355/manashb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513680522, "creation_date": 1513680522, "question_id": 47885236, "link": "https://stackoverflow.com/questions/47885236/mojolicious-hypnotoad-nginx-reverse-proxy-is-not-accessible-form-browser", "title": "Mojolicious Hypnotoad Nginx reverse proxy is not accessible form browser", "body": "<p>Application is running in server. But it is not accessible from browser.</p>\n\n<p>sample config file --</p>\n\n<pre><code>server {\n  listen [::]:80;\n  server_name ..;\n  access_log /var/log/..;\n  error_log /var/log/..;\n\n  location / {\n    proxy_pass http://localhost-app;\n    proxy_http_version 1.1;\n    proxy_read_timeout 150s;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_set_header Host $host;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-HTTPS 0;\n  }\n}\n\nupstream localhost-app {\n  server 127.0.0.1:8081;\n}\n</code></pre>\n\n<p>nginx version: nginx/1.10.3</p>\n\n<p>Ubuntu 16.04.3 LTS</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513666985, "post_id": 47881508, "comment_id": 82728959, "body": "That error points to a bug in an XS module. (It&#39;s extremely unlikely, but it could also be a bug in Perl itself.)"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513667551, "post_id": 47881508, "comment_id": 82729170, "body": "Are you really passing <code>perl.pl</code> as the path to the spreadsheet?"}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513668118, "post_id": 47881508, "comment_id": 82729372, "body": "no sir actual path is C:\\Users\\adm\\OneDrive\\filename.xlsm"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513668157, "post_id": 47881508, "comment_id": 82729388, "body": "Still not a spreadsheet!"}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513668213, "post_id": 47881508, "comment_id": 82729412, "body": "C;\\Users\\adm\\onedrive\\filename.xlsm"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513671599, "post_id": 47881508, "comment_id": 82730932, "body": "There are bug reports on very similar behavior, related to <code>Carp</code> hooking into the debugger I believe. I&#39;ve seen a comment that it disappeared in v5.16.  What version of Perl are you running?"}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "edited": false, "score": 0, "creation_date": 1513674099, "post_id": 47881508, "comment_id": 82732210, "body": "I have installed active perl version perl 5.24.2 in windows"}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "edited": false, "score": 0, "creation_date": 1513679026, "post_id": 47881508, "comment_id": 82735224, "body": "can anyone help me its urgent!!!!!"}, {"owner": {"reputation": 2092, "user_id": 2678168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5a048ca5e77e9683d0197b5455b3a9?s=128&d=identicon&r=PG&f=1", "display_name": "Georg Mavridis", "link": "https://stackoverflow.com/users/2678168/georg-mavridis"}, "edited": false, "score": 1, "creation_date": 1513690282, "post_id": 47881508, "comment_id": 82742096, "body": "I guess it is in the line <code>die $workbook-&gt;error(), &quot;.\\n&quot;;</code> where  $workbook-&gt;error() in list-context returns something weird. replace the , with a . and see if this helps"}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "edited": false, "score": 0, "creation_date": 1513696423, "post_id": 47881508, "comment_id": 82746048, "body": "i changed but not working."}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "edited": false, "score": 0, "creation_date": 1513699169, "post_id": 47881508, "comment_id": 82747798, "body": "is it solvable bug? or i have change my code"}], "owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1513674134, "creation_date": 1513666624, "last_edit_date": 1513674134, "question_id": 47881508, "link": "https://stackoverflow.com/questions/47881508/bizarre-copy-of-array-in-list-assignment-at-cperl64-lib-carp-pm-line-229", "title": "bizarre copy of array in list assignment at c:perl64/lib/carp.pm line 229", "body": "<p>i wrote this code in windows active Perl  to read Excel-XML file and while \n executing the same code some times its giving me error as mentioned above \n and when i keep on running it.  sometime time it will run and again raise \n same error.   </p>\n\n<pre><code>    use strict;\n    use warnings;\n\n\n    use Spreadsheet::Reader::ExcelXML;\n    my $workbook =  Spreadsheet::Reader::ExcelXML-&gt;new( file=&gt;'perl.pl', group_return_type =&gt; 'value',);\n\n    if ( !$workbook-&gt;file_opened ) {\n            die $workbook-&gt;error(), \".\\n\";\n    }\n\n    my  $worksheet = $workbook-&gt;worksheet( 'Sheet5' );                                      \n\n    my $value;\n    while( !$value or $value ne 'EOF' ){\n            $value = $worksheet-&gt;fetchrow_arrayref;\n            my @a=@{$value};\n            Function(@a);\n    }\n\n    sub Function {\n            my @rows =@_;\n            print \"@rows\\n\";\n    }\n</code></pre>\n"}, {"tags": ["perl", "hex", "ascii"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 2, "creation_date": 1513638633, "post_id": 47877703, "comment_id": 82721415, "body": "Paul, the code you have posted is unreadable and will not compile. You are asking for free help from a world full of strangers. Please be respectful to us: indent properly what you have and correct the syntax errors."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513639016, "post_id": 47877703, "comment_id": 82721530, "body": "<i>&quot;The ASCII file contains only 12 characters with ASCII characters from 0 thru F&quot;</i> That is a list of 23 characters <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code>, <code>5</code>, <code>6</code>, <code>7</code>, <code>8</code>, <code>9</code>, <code>:</code>, <code>;</code>, <code>&lt;</code>, <code>=</code>, <code>&gt;</code>, <code>?</code>, <code>@</code>, <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>F</code>. What do you really mean? How should they be &quot;converted to binary&quot;? Someone has told you to use <code>unpack &#39;C*&#39;</code>. Do you know what it does?"}, {"owner": {"reputation": 19, "user_id": 6327657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207954188905352/picture?type=large", "display_name": "Paul Gigliotti", "link": "https://stackoverflow.com/users/6327657/paul-gigliotti"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513641160, "post_id": 47877703, "comment_id": 82722196, "body": "I have not used this site before and had issues getting it to format correctly.  It does compile and run.  I have made some progress in that it properly stores values x01 for 1, x02 for 2, etc. but cannot get x0A for A, x0B for B, etc. I don&#39;t seem to be able to edit my original post to fix indentation."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 2, "creation_date": 1513641527, "post_id": 47877703, "comment_id": 82722302, "body": "@PaulGigliotti I&#39;ve done it for you -- only the indentation, of course; it&#39;s your code as it was posted. (Please look through the help pages in the future. They are very good, short and clear.)  Now can you see what is there and fix it?"}, {"owner": {"reputation": 19, "user_id": 6327657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207954188905352/picture?type=large", "display_name": "Paul Gigliotti", "link": "https://stackoverflow.com/users/6327657/paul-gigliotti"}, "edited": false, "score": 0, "creation_date": 1513642459, "post_id": 47877703, "comment_id": 82722552, "body": "Sorry for the confusion.  I need the script to convert an ASCII 0 thru 9 (0x30 thru 0x39) to 0x00 thru 0x09 and store in the output file as such.  I have that part now working.  The issue is converting ASCII A thru F (0x41/0x61 thru 0x46/66) to 0x0A thru 0X0F and storing it as such in the output file."}, {"owner": {"reputation": 19, "user_id": 6327657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207954188905352/picture?type=large", "display_name": "Paul Gigliotti", "link": "https://stackoverflow.com/users/6327657/paul-gigliotti"}, "edited": false, "score": 0, "creation_date": 1513642629, "post_id": 47877703, "comment_id": 82722611, "body": "When I run the script the print out looks great, but the contents of the out file for A thru F are incorrect.     123456789abc      49505152535455565797989932     between 0x30 and 0x39     1     between 0x30 and 0x39     2     between 0x30 and 0x39     3    between 0x30 and 0x39    4    between 0x30 and 0x39    5    between 0x30 and 0x39    6    between 0x30 and 0x39    7    between 0x30 and 0x39    8    between 0x30 and 0x39    9    between 0x61 and 0x66    A    between 0x61 and 0x66    B    between 0x61 and 0x66    C Done"}, {"owner": {"reputation": 19, "user_id": 6327657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207954188905352/picture?type=large", "display_name": "Paul Gigliotti", "link": "https://stackoverflow.com/users/6327657/paul-gigliotti"}, "edited": false, "score": 0, "creation_date": 1513644599, "post_id": 47877703, "comment_id": 82723086, "body": "With an input ascii file of 123456789ABC, (303132 etc) my output is now 010203040506070809101112.  The desired output is of course 123456789ABC"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513648881, "post_id": 47877703, "comment_id": 82724048, "body": "Your last comment says that the desired output for <code>123456789ABC</code> is <code>123456789ABC</code>. Are you really claiming you just want to copy the file?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513650261, "post_id": 47877703, "comment_id": 82724376, "body": "@zdim: Your amended code doesn&#39;t compile either!"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513656054, "post_id": 47877703, "comment_id": 82725623, "body": "@Borodin  I tried to be clear, sorry if that failed: <i>I didn&#39;t change their code</i>, I only corrected indentation.  (For one, they left out a closing brace.)  If I start fixing that then I&#39;d have to also make sure that all else is well ... etc. I just made it more readable, and warned them in a comment to fix the rest."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513660717, "post_id": 47877703, "comment_id": 82726699, "body": "@zdim: Yes, I&#39;m sorry that I was unclear. You made pretty much the same edits that I would have done. I was referring to the OP&#39;s first comment, <i>&quot;It does compile and run&quot;</i> which is untrue. It may have been useful to describe the syntax errors that you had to ignore when reformatting, but it&#39;s also a warning for me as I often make similar edits without comment."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513660922, "post_id": 47877703, "comment_id": 82726756, "body": "@Borodin  Good point. I should have absolutely stated in that comment that it does not compile and noted at least what I spotted. Not to forget in the future."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6327657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207954188905352/picture?type=large", "display_name": "Paul Gigliotti", "link": "https://stackoverflow.com/users/6327657/paul-gigliotti"}, "edited": false, "score": 0, "creation_date": 1513694118, "post_id": 47878939, "comment_id": 82744505, "body": "Exactly. Thank you. It seems to be packing them correctly.  I just can&#39;t seem to get those values to write out the file.  I have this code  my $filename = &#39;Hub_Device_ID.txt&#39;; my $outfile= &#39;Hub_Device_ID.bin&#39;; open(my $fh, &#39;&lt;:encoding(UTF-8)&#39;, $filename)   or die &quot;Could not open file &#39;$filename&#39; $!&quot;; open(my $of, &#39;&gt;:raw&#39;, $outfile)   or die &quot;Could not open file &#39;$outfile&#39; $!&quot;;  binmode($of);    while (my $row = &lt;$fh&gt;){    chomp $row;   \tprint &quot;Chomped row\\n&quot;; \tprint $row, &quot;\\n&quot;; \t  \tmy $bytes = pack &#39;H*&#39;, $row; \tprint $bytes, &quot;\\n&quot;; \tprintf $of pack(&quot;NN&quot;, $bytes);"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 19, "user_id": 6327657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207954188905352/picture?type=large", "display_name": "Paul Gigliotti", "link": "https://stackoverflow.com/users/6327657/paul-gigliotti"}, "edited": false, "score": 0, "creation_date": 1513699092, "post_id": 47878939, "comment_id": 82747743, "body": "Why are you printing <code>pack(&quot;NN&quot;, $bytes)</code> instead of <code>$bytes</code>?"}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": -1, "last_activity_date": 1513667673, "last_edit_date": 1513667673, "creation_date": 1513648239, "answer_id": 47878939, "question_id": 47877703, "link": "https://stackoverflow.com/questions/47877703/converting-ascii-text-to-binary/47878939#47878939", "title": "Converting ASCII TEXT to Binary", "body": "<p>I believe you want to convert</p>\n\n<pre><code>my $hex = \"0123456789aBcDeF\";\n</code></pre>\n\n<p>into</p>\n\n<pre><code>my $bytes = \"\\x01\\x23\\x45\\x67\\x89\\xAB\\xCD\\xEF\";\n</code></pre>\n\n<p>To do that, simply use</p>\n\n<pre><code>my $bytes = pack 'H*', $hex;\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6327657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207954188905352/picture?type=large", "display_name": "Paul Gigliotti", "link": "https://stackoverflow.com/users/6327657/paul-gigliotti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 782, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513695047, "creation_date": 1513638137, "last_edit_date": 1513695047, "question_id": 47877703, "link": "https://stackoverflow.com/questions/47877703/converting-ascii-text-to-binary", "title": "Converting ASCII TEXT to Binary", "body": "<p>I have to convert an ASCII file to Binary. The ASCII file contains a twelve digit hex number in ASCII format. For an input string of 123456789ABC,  I need a six byte output of 0x12\\0x34\\0x56\\0x78\\0x9a\\0xbc.  Here is the solution that worked. Thanks for the help.</p>\n\n<pre><code>my $filename = 'Hub_Device_ID.txt';\nmy $outfile= 'Hub_Device_ID.bin';\nopen(my $fh, '&lt;:encoding(UTF-8)', $filename)\n         or die \"Could not open file '$filename' $!\";\nopen(my $of, '&gt;:raw', $outfile)\n         or die \"Could not open file '$outfile' $!\";\n  binmode($of);\n\n  while (my $row = &lt;$fh&gt;){\n\n    chomp $row;\n    print \"Chomped row\\n\";\n    print $row, \"\\n\";\n\n\n    my $bytes = pack 'H*', $row;\n    print $bytes, \"\\n\";\n    print $of $bytes;\n\n\n    close $of;\n    close $fh;\n\n    print \"Done\\n\";\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["perl", "imagemagick", "imagemagick-identify"], "comments": [{"owner": {"reputation": 89568, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1513632776, "post_id": 47876642, "comment_id": 82719008, "body": "Also, use system (or open etc) with a list not a string in order to avoid interpretation inside the shell, e.g. <code>system(&#39;identify&#39;,&#39;-format&#39;,&#39;%w&#39;,$curPic)</code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513634951, "post_id": 47876642, "comment_id": 82720060, "body": "By the way, you should print error messages to STDERR (not STDOUT)."}, {"owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513781037, "post_id": 47876642, "comment_id": 82784315, "body": "Are you maybe stumbling on <code>.</code> and <code>..</code>? <a href=\"https://stackoverflow.com/a/21203371/2836621\">stackoverflow.com/a/21203371/2836621</a>"}], "answers": [{"comments": [{"owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513675347, "post_id": 47877003, "comment_id": 82732909, "body": "I am not that familiar with <code>capturex</code> and the <code>&quot;--&quot;</code> you have used to separate the filenames from the parameters may be a feature of that, if so, I apologise and will remove this comment. Otherwise though, <code>identify</code> itself does not accept <code>--</code> as a marker for the end of parameters."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513692209, "post_id": 47877003, "comment_id": 82743287, "body": "It tells <code>identify</code> the remaining arguments aren&#39;t options. Or at least it does on my machine."}, {"owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513692887, "post_id": 47877003, "comment_id": 82743676, "body": "Oh, interesting, under macOS and <b>ImageMagick</b> version 7.0.7 if I run <code>identify -format %h -- a.jpg</code> I get <code>identify: unrecognized option &quot;--&quot; @ error&#47;identify.c&#47;IdentifyImageCommand&#47;920.</code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513702539, "post_id": 47877003, "comment_id": 82749822, "body": "@Mark Setchell, On those, you&#39;d need something like <code>&quot;$folder&#47;$curPic&quot; =~ s{^-}{.&#47;-}r</code> instead of <code>&quot;--&quot;, &quot;$folder&#47;$curPic&quot;</code>."}, {"owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513703126, "post_id": 47877003, "comment_id": 82750175, "body": "I just typed it into the Terminal, no Perl involved."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513704594, "post_id": 47877003, "comment_id": 82751052, "body": "@Mark Setchell, I was providing the adjustment to my answer needed for your system. It&#39;s now in the answer too."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 3, "last_activity_date": 1516560509, "last_edit_date": 1516560509, "creation_date": 1513634140, "answer_id": 47877003, "question_id": 47876642, "link": "https://stackoverflow.com/questions/47876642/passing-arguments-to-system-commands-from-perl/47877003#47877003", "title": "Passing arguments to system commands from perl", "body": "<p>As the message says, you are passing the path to a non-existent file. Instead of passing </p>\n\n<pre><code>if0W211.jpg\n</code></pre>\n\n<p>you should be passing</p>\n\n<pre><code>/media/sf_Pictures_from_Reddit/if0W211.jpg\n</code></pre>\n\n<p>That still leaves you with the following problems:</p>\n\n<ul>\n<li>An injection bug</li>\n<li>Possible misinterpretation of the path as an option.</li>\n<li>A lack of error handling</li>\n<li>Lack of capture of the output of the program.</li>\n<li>Repeated executions of an external process.</li>\n</ul>\n\n<p>All these can be fixed by using <a href=\"http://search.cpan.org/perldoc?Image::Size\" rel=\"nofollow noreferrer\">Image::Size</a> instead.</p>\n\n<p>But if you insist on using <code>identify</code>,</p>\n\n<pre><code>use IPC::System::Simple qw( capturex );\n\nmy $dimensions = eval { capturex(\"identify\", \"-format\", \"%h,%w\", \"--\", \"$folder/$curPic\") }\n    or do {\n       warn(\"Can't determine the dimensions of \\\"$folder/$curPic\\\": $@\");\n       next;\n    };\n\nmy ($height, $width) = $dimensions =~ /^(\\d+),(\\d+)$/\n   or do {\n       warn(\"Can't determine the dimensions of \\\"$folder/$curPic\\\": Unexpected output from \\\"identify\\\": $dimensions\\n\");\n       next;\n   };\n</code></pre>\n\n<p>If your <code>identify</code> doesn't support <code>--</code> (or even if it does), you can replace</p>\n\n<pre><code>\"--\", \"$folder/$curPic\"\n</code></pre>\n\n<p>with</p>\n\n<pre><code>\"$folder/$curPic\" =~ s{^-}{./-}r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": false, "score": 1, "last_activity_date": 1513774707, "creation_date": 1513774707, "answer_id": 47906631, "question_id": 47876642, "link": "https://stackoverflow.com/questions/47876642/passing-arguments-to-system-commands-from-perl/47906631#47906631", "title": "Passing arguments to system commands from perl", "body": "<p>As it stands, you are creating two new processes (one to identify the width and another to identify the height) for each and every image, so that potentially causes a considerable load on your system if you have large numbers of images.</p>\n\n<p>As an alternative, you can just invoke one single <code>identify</code> process and pass it all the image names, like this:</p>\n\n<pre><code>identify -format \"%w:%h:%f\\n\" *jpg\n</code></pre>\n\n<p><strong>Sample Output</strong></p>\n\n<pre><code>2000:1200:ok.jpg\n1200:2000:toolow2.jpg\n1000:500:vert.jpg\n</code></pre>\n\n<p>You can then parse that with <code>bash</code> or <code>Perl</code>:</p>\n\n<pre><code>#!/bin/bash\n\nVERT=\"/tmp\"\nTOOLOW=\"/tmp\" \n\nidentify -format \"%w:%h:%f\\n\" *jpg | \n   while IFS=: read w h name; do\n      echo \"DEBUG: $name, $w, $h\"\n      [[ $h -gt $(( (8*w)/10 )) ]] &amp;&amp;         { mv \"$name\" \"$VERT\";   &gt;&amp;2 echo \"Too tall: $name\"; continue; }\n      [[ ($h -lt 1080) || ($w -lt 1920) ]] &amp;&amp; { mv \"$name\" \"$TOOLOW\"; &gt;&amp;2 echo \"Low res: $name\";  continue; }\n      echo \"$name approved\"\n   done\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513840664, "post_id": 47916488, "comment_id": 82807090, "body": "Your <code>elsif</code> might as well be an <code>if</code> as there is a <code>next</code> on the alternate preceding branch, it also is missing its second <code>|</code>."}], "tags": [], "owner": {"reputation": 45, "user_id": 5089863, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2c1c71f4c3e82174a05e16839e7a7a10?s=128&d=identicon&r=PG", "display_name": "burnst14", "link": "https://stackoverflow.com/users/5089863/burnst14"}, "is_accepted": false, "score": 0, "last_activity_date": 1513818257, "creation_date": 1513818257, "answer_id": 47916488, "question_id": 47876642, "link": "https://stackoverflow.com/questions/47876642/passing-arguments-to-system-commands-from-perl/47916488#47916488", "title": "Passing arguments to system commands from perl", "body": "<p>Here is the final script that works for my purposes. I have added definition checks and non-zero checks to make sure that the variables are receiving the proper input before moving forward.</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nuse strict;\nuse diagnostics;\nuse File::Copy;\nuse Image::Size;\n\nmy $folder = \"/media/sf_Pictures_from_Reddit\";\nmy $oriFolder = \"/media/sf_WrongOrientation\";\nmy $resFolder = \"/media/sf_LowRes\";\n\nmy $height = 0;\nmy $width = 0;\n\n#Collect all the files\nopendir DIR, $folder or die \"Cannot open directory: $!\";\nmy @files = readdir(DIR);\nclosedir(DIR);\n\n#Iterate through each file and check its orientation and resolution\nforeach my $curPic (@files) {\n\n    ($width, $height) = imgsize(\"$folder/$curPic\") or die \"Couldn't get the image dimensions for $curPic: $!\";\n\n    if($curPic eq \".\" || $curPic eq \"..\"){ next;}\n    if((defined $height) &amp; (defined $width)){\n        if(($height != 0) &amp; ($width != 0)) {\n\n            print \"File: $curPic\\nHeight: $height\\nWidth: $width\\n\";\n            #sleep(0.5);\n\n            #move those that are vertically oriented to a different folder\n            if($height &gt;= ($width*0.8)) {\n                move(\"$folder/$curPic\", \"$oriFolder/$curPic\") or die \"The ori move operation failed for $curPic: $!\";\n                print \"$curPic was not approved because of its orientation.\\n\\n\";\n                next;\n            }\n            #move those that are low res to a third folder\n            elsif(($height &lt; 1080) | ($width &lt; 1920)) {\n                move(\"$folder/$curPic\", \"$resFolder/$curPic\") or die \"The res move operation failed for $curPic: $!\";\n                print \"$curPic was not approved because of its resolution.\\n\\n\";\n                next;\n            }\n            print \"$curPic is approved as a desktop background.\\n\\n\";\n            $height = 0;\n            $width = 0;\n        }\n        else{\n            print \"Variables failed to initialize.\\n\\n\";\n        }\n    }\n    else{\n        print \"Variables are undefined.\\n\\n\";\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5089863, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2c1c71f4c3e82174a05e16839e7a7a10?s=128&d=identicon&r=PG", "display_name": "burnst14", "link": "https://stackoverflow.com/users/5089863/burnst14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 47877003, "answer_count": 3, "score": 0, "last_activity_date": 1516560509, "creation_date": 1513632374, "last_edit_date": 1513780472, "question_id": 47876642, "link": "https://stackoverflow.com/questions/47876642/passing-arguments-to-system-commands-from-perl", "title": "Passing arguments to system commands from perl", "body": "<p>I'm writing a perl script that uses some ImageMagick commands, specifically identify. The relevant code is here:</p>\n\n<pre><code>my $height = system(\"identify -format %h $curPic\");\nmy $width = system(\"identify -format %w $curPic\");\n</code></pre>\n\n<p>When I run the whole script,it gets hung up on these lines and this is the output:</p>\n\n<pre><code>identify: unable to open image 'if0W211.jpg': No such file or directory @ error/blob.c/OpenBlob/3323\nidentify: unable to open image 'if0W211.jpg': No such file or directory @ error/blob.c/OpenBlob/3323\n</code></pre>\n\n<p>At first, the problem was related to ImageMagick not have the correct format delegates to work with jpg images, but after fixing that, I'm still getting this error. I can't find any error documentation related to \"error/blob.c/OpenBlob/3323\". After writing some test code to see what the problem might be, I think I've determined that it has something to do with the way perl passes arguments to system commands, because when I write that system command <code>identify -format %h xxxx.jpg</code> in the terminal, it works just fine. I also noticed that when I <code>print \"$curPic\\n</code>, a 256 is prepended to the filename during the print. I don't know why this would be.</p>\n\n<p>For reference, here is how I collect the filenames:</p>\n\n<pre><code>opendir DIR, $folder or die \"Cannot open directory: $!\";\nmy @files = readdir(DIR);\nclosedir(DIR);\n</code></pre>\n\n<p>And here is the full script:</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nuse strict;\nuse diagnostics;\nuse File::Copy;\n\nmy $folder = \"/media/sf_Pictures_from_Reddit\";\nmy $oriFolder = \"/media/sf_WrongOrientation\";\nmy $resFolder = \"/media/sf_LowRes\";\n\n#Collect all the files\nopendir DIR, $folder or die \"Cannot open directory: $!\";\nmy @files = readdir(DIR);\nclosedir(DIR);\n\n#Iterate through each file and check its orientation and resolution\nforeach my $curPic (@files) {\n    my $height = system(\"identify -format %h $curPic\");\n    my $width = system(\"identify -format %w $curPic\");\n\n    #move those that are vertically oriented to a different folder\n    if ($height &gt;= ($width*0.8)) {\n    move($curPic, $oriFolder//$curPic) or die \"The ori move operation     failed for image $curPic: $!\";\n        print \"$curPic was not approved because of its orientation.\";\n        next;\n    }\n    #move those that are low res to a third folder\n    elsif (($height &lt; 1080) | ($width &lt; 1920)) {\n    move($curPic, $resFolder//$curPic) or die \"The res move operation     failed for image $curPic: $!\";\n        print \"$curPic was not approved because of its resolution.\";\n        next;\n    }\n    print \"$curPic is approved as a desktop background\";\n}\n</code></pre>\n\n<p>EDIT:\nI'm switching to the recommended Image::Size library, so here is my updated script. It works for a time, giving me the output I want, but suddenly breaks and says the variables are uninitialized. \"Use of uninitialized variable...\" There's an error for $height and $width, but once again they both happen after about 20 successful iterations. And it seems to vary if I run the script multiple times back to back.</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nuse strict;\nuse diagnostics;\nuse File::Copy;\nuse Image::Size;\n\nmy $folder = \"/media/sf_Pictures_from_Reddit\";\nmy $oriFolder = \"/media/sf_WrongOrientation\";\nmy $resFolder = \"/media/sf_LowRes\";\n\nmy $height = 0;\nmy $width = 0;\n\n#Collect all the files\nopendir DIR, $folder or die \"Cannot open directory: $!\";\nmy @files = readdir(DIR);\nclosedir(DIR);\n\n#Iterate through each file and check its orientation and resolution\nforeach my $curPic (@files) {\n    ($width, $height) = imgsize(\"$folder/$curPic\");\n\n    #move those that are vertically oriented to a different folder\n    if ($height &gt;= ($width*0.8)) {\n        move(\"$folder/$curPic\", \"$oriFolder/$curPic\") or die \"The ori move operation failed for image $curPic: $!\";\n        print \"$curPic was not approved because of its orientation.\\n\";\n        next;\n    }\n    #move those that are low res to a third folder\n    elsif (($height &lt; 1080) | ($width &lt; 1920)) {\n        move(\"$folder/$curPic\", \"$resFolder/$curPic\") or die \"The res move operation failed for image $curPic: $!\";\n        print \"$curPic was not approved because of its resolution.\\n\";\n        next;\n    }\n    print \"$curPic is approved as a desktop background.\\n\";\n}\n</code></pre>\n"}, {"tags": ["perl", "nginx"], "comments": [{"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 2, "creation_date": 1513630957, "post_id": 47876173, "comment_id": 82718189, "body": "<a href=\"https://stackoverflow.com/questions/11667489/how-to-run-cgi-scripts-on-nginx\" title=\"how to run cgi scripts on nginx\">stackoverflow.com/questions/11667489/&hellip;</a>, <a href=\"https://www.scalescale.com/tips/nginx/serve-perl-scripts-nginx/#\" rel=\"nofollow noreferrer\">scalescale.com/tips/nginx/serve-perl-scripts-nginx/#</a>"}, {"owner": {"reputation": 33, "user_id": 8491432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5036060c9666e6932498cab27a11278?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisBoyd", "link": "https://stackoverflow.com/users/8491432/chrisboyd"}, "reply_to_user": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 0, "creation_date": 1513634775, "post_id": 47876173, "comment_id": 82719995, "body": "@mob Hello, thank you for these links, they helped me solve my issue!"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513635632, "post_id": 47876173, "comment_id": 82720325, "body": "@ChrisBoyd: If you have a solution then please post it as an answer. Any question you post should be much more useful to others searching for a solution to a similar issue, and at present this page is pretty much empty."}], "owner": {"reputation": 33, "user_id": 8491432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5036060c9666e6932498cab27a11278?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisBoyd", "link": "https://stackoverflow.com/users/8491432/chrisboyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "closed_date": 1513637431, "answer_count": 0, "score": 1, "last_activity_date": 1513635527, "creation_date": 1513630004, "last_edit_date": 1513635527, "question_id": 47876173, "link": "https://stackoverflow.com/questions/47876173/nginx-not-executing-pl-extensions-it-downloads-the-file-instead", "closed_reason": "Duplicate", "title": "Nginx not executing .pl extensions. It downloads the file instead", "body": "<p>I am using an Nginx server.</p>\n\n<p>If I access <code>index.pl</code> it downloads the file instead of executing it.</p>\n\n<p>I'm pretty sure this is to do with <code>/etc/nginx/sites-available/default</code></p>\n\n<p>Here is a copy</p>\n\n<pre><code>listen 80;\nlisten [::]:80;\n\nserver_name domain.com;\n\nroot /var/www/domain.com;\nindex index.html index.php index.pl;\n\nlocation / {\n    try_files $uri $uri/ =404;\n}\n\nlocation ~ \\.php$ {\n    include snippets/fastcgi-php.conf;\n\n    # With php-fpm (or other unix sockets):\n    fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;\n    # With php-cgi (or other tcp sockets):\n    #fastcgi_pass 127.0.0.1:9000;\n}\n</code></pre>\n\n<p>As you can see, I have already added <code>index.pl</code> to the end of the <code>index</code> list.</p>\n\n<p>What else do I need to get it working?</p>\n"}, {"tags": ["perl", "stdout", "stderr", "tee"], "answers": [{"comments": [{"owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "edited": false, "score": 0, "creation_date": 1513624822, "post_id": 47874666, "comment_id": 82715432, "body": "Thank You mob for this explanation and suggestion.  I also found another way using capture_exec in  IO:CaptureOutput.  I tested it with a sub that looks like this....      sub tee_sys_cmd {         (my $cmd) = @_;          print $tee &quot;Executing... \\&quot;$cmd\\&quot;\\n&quot;;         my ($stdout, $stderr, $success, $exit_code) = capture_exec($cmd); \tprint $tee &quot;$stdout\\n$stderr\\n&quot;;          return;     }  This seems to work too."}], "tags": [], "owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "is_accepted": false, "score": 1, "last_activity_date": 1513623039, "creation_date": 1513623039, "answer_id": 47874666, "question_id": 47874188, "link": "https://stackoverflow.com/questions/47874188/in-perl-how-can-i-tee-output-to-stdout-and-a-file-for-system-return-vals/47874666#47874666", "title": "In perl, how can I tee output to stdout and a file for system() return vals?", "body": "<p>Perl is buffering output to the <code>$tee</code> filehandle and the cursor position of <code>$tee</code> is not adjusted after you make a <code>system</code> call that writes to the same file, so it is likely that Perl is overwriting whatever output the <code>system</code> call writes to the file.</p>\n\n<p>A sequence of calls like this is safer. You may be able to be more concise with more judicious seeking and flushing.</p>\n\n<pre><code>use IO:Tee;\nmy $teelog = \"tee.log\"\nopen my $tee, \"&gt;\", $teelog or die \"open tee failed.\\n\";\n$tee = new IO:Tee(\\*STDOUT, $tee);\nprint $tee \"First line in log\\n\";\nclose $tee;\n\nsystem(\"date | tee -a ${teelog}\");\nsystem(\"jibberish 2&gt;&amp;1 | tee -a ${teelog}\");\n\nopen $tee, \"&gt;&gt;\", $teelog or die \"open tee failed.\\n\";  # append mode\n$tee = new IO:Tee(\\*STDOUT, $tee);\n\nprint $tee \"Last line in log\\n\";\n\nexit;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": -1, "last_activity_date": 1513624842, "creation_date": 1513624842, "answer_id": 47875060, "question_id": 47874188, "link": "https://stackoverflow.com/questions/47874188/in-perl-how-can-i-tee-output-to-stdout-and-a-file-for-system-return-vals/47875060#47875060", "title": "In perl, how can I tee output to stdout and a file for system() return vals?", "body": "<p>You're discarding the status returned by <code>system</code>, so I would use backticks instead:</p>\n\n<pre><code>print $tee `date`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "is_accepted": false, "score": 0, "last_activity_date": 1513624855, "creation_date": 1513624855, "answer_id": 47875066, "question_id": 47874188, "link": "https://stackoverflow.com/questions/47874188/in-perl-how-can-i-tee-output-to-stdout-and-a-file-for-system-return-vals/47875066#47875066", "title": "In perl, how can I tee output to stdout and a file for system() return vals?", "body": "<p>Thank You mob for this explanation and suggestion.</p>\n\n<p>I also found another way using capture_exec in  IO:CaptureOutput.  I tested it with a sub that looks like this....</p>\n\n<pre><code>sub tee_sys_cmd {\n    (my $cmd) = @_;\n\n    print $tee \"Executing... \\\"$cmd\\\"\\n\";\n    my ($stdout, $stderr, $success, $exit_code) = capture_exec($cmd);\nprint $tee \"$stdout\\n$stderr\\n\";\n\n    return;\n}\n</code></pre>\n\n<p>This seems to work too.</p>\n"}], "owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1513627858, "creation_date": 1513620900, "last_edit_date": 1513627858, "question_id": 47874188, "link": "https://stackoverflow.com/questions/47874188/in-perl-how-can-i-tee-output-to-stdout-and-a-file-for-system-return-vals", "title": "In perl, how can I tee output to stdout and a file for system() return vals?", "body": "<p>I'm successfully using\n<a href=\"https://metacpan.org/pod/IO::Tee\" rel=\"nofollow noreferrer\"><code>IO::Tee</code></a>\nto tee print messages to both stdout and a log file. I'd like to also be able to capture and tee stdout and stderr from a system() commands to the same file.</p>\n\n<p>I tried various combinations of redirection and/or pipes with no luck</p>\n\n<p>Simple script witha few commented out failed attempts...</p>\n\n<pre><code>#!/usr/bin/env perl\n\nuse IO:Tee;\n\nmy $teelog = \"tee.log\"\nopen my $tee, \"&gt;\", $teelog or die \"open tee failed.\\n\";\nmy $tee = new IO:Tee(\\*STDOUT, $tee);\n\nprint $tee \"First line in log\\n\";\n\n# This command should work.  I want the date to go to screen and tee.log\n#system(\"date | tee -a ${teelog}\");  &lt;- nothing goes to tee.log\n#system(\"date &gt;&amp; ${teelog}\") &lt;- clobbers tee.log\n#system(\"date &gt;&amp; $tee\") &lt;- generates syntax errors\n\n\n# This command should fail.  I want error msg to go to screen and tee.log\n#system(\"jibberish | tee -a ${teelog}\"); &lt;- nothing goes to tee.log\n#system(\"jibberish &gt;&amp; ${teelog}\") &lt;- clobbers tee.log\nsystem(\"kibberish &gt;&amp; $tee\") &lt;- generates syntax errors\n\nprint $tee \"Last line in log\\n\";\n\nexit;\n</code></pre>\n"}, {"tags": ["perl", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "edited": false, "score": 0, "creation_date": 1513746602, "post_id": 47875254, "comment_id": 82764895, "body": "Yes, I can see the <code>rect</code> methods.  <code>$content-&gt;rect($x1, $y1, $w1, $h1, ..., $xn, $yn, $wn, $hn)</code> and  <code>$content-&gt;rectxy($x1, $y1, $x2, $y2);</code>  I am feeling difficulty in understanding the arguments. Can you please explain it ?"}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 1, "last_activity_date": 1513625734, "creation_date": 1513625734, "answer_id": 47875254, "question_id": 47873651, "link": "https://stackoverflow.com/questions/47873651/generate-a-rectangular-box/47875254#47875254", "title": "Generate a rectangular box", "body": "<p>See\n<a href=\"https://metacpan.org/pod/PDF::API2::Content\" rel=\"nofollow noreferrer\"><code>PDF::API2::Content</code></a>\nfor <em>Methods for adding graphics</em></p>\n\n<p>In particular, the section <em>Path Construction</em> describes the <code>rect</code> method which will draw one or more rectangles</p>\n"}, {"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513627591, "post_id": 47875634, "comment_id": 82716711, "body": "This isn&#39;t an answer to the question asked. It should be a comment on the question."}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513627743, "post_id": 47875634, "comment_id": 82716766, "body": "I beleive it is, OP is using <code>PDF::Table</code> (although they neglected to <code>use PDF::Table</code> in their example code). this is how you put data in a <code>PDF::Table</code> object"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513633375, "post_id": 47875634, "comment_id": 82719319, "body": "Are you saying that your code will generate a rectangular box as described? If you are certain that the OP is using a module that they haven&#39;t mentioned then you should at least mention the fact in your answer, and probably edit the question as well."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513633514, "post_id": 47875634, "comment_id": 82719383, "body": "Please add e.g. <code>@Borodin</code> to comments so that their recipients receive notification that they have a message waiting."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513633600, "post_id": 47875634, "comment_id": 82719435, "body": "It would help readability a lot if you would capitalise your English correctly and use the markup consistently."}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513635836, "post_id": 47875634, "comment_id": 82720417, "body": "@Borodin I am certain they are using the module. if you look again, you&#39;ll see it is in fact in their code."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513641423, "post_id": 47875634, "comment_id": 82722262, "body": "As I said, <i>&quot;If you are certain that the OP is using a module that they haven&#39;t mentioned then you should at least mention the fact in your answer, and probably edit the question as well&quot;</i>. Answers that don&#39;t state such significant assumptions are all but useless. Please keep <i>Stack Overflow</i> correct, clean, and useful."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513641509, "post_id": 47875634, "comment_id": 82722294, "body": "And will your solution generate a rectangular box as described?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513641596, "post_id": 47875634, "comment_id": 82722317, "body": "I suggest that you create exemplary data and code and show the output. <i>Then</i> this page will be useful to others who arrive here from Google or similar"}], "tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": false, "score": 1, "last_activity_date": 1513867869, "last_edit_date": 1592644375, "creation_date": 1513627508, "answer_id": 47875634, "question_id": 47873651, "link": "https://stackoverflow.com/questions/47873651/generate-a-rectangular-box/47875634#47875634", "title": "Generate a rectangular box", "body": "<p>The third argument to the <code>PDF::Table</code> object constructor, in your example <code>\\@tbl</code>, is where you put the text to be written to the table. It is <strong>not</strong> an array of hashes as you you state. It's an array of arrays.</p>\n<p>To be more precise, it's an array reference. Each element is another array ref, which represents each row of the table. The elements of each nested array will be the cells of that row.</p>\n<pre><code>use strict;\nuse warnings;\nuse PDF::API2;\nuse PDF::Table;    \n\nmy $pdf = new PDF::API2(-file =&gt; &quot;mydata.pdf&quot;);\nmy $page = $pdf-&gt;page;\nmy $pdftable = new PDF::Table;\n\nmy @tbl = (\n    [&quot;1\\tNAME:ABC\\n\\tGRADE:4&quot;],\n    [&quot;2\\tNAME:XYZ\\n\\tGRADE:5&quot;],\n);\n\n$pdftable-&gt;table(\n     $pdf,\n     $page,\n     \\@tbl,\n     x             =&gt; 50,\n     w             =&gt; 400,\n     start_y       =&gt; 630,\n     start_h       =&gt; 630,\n     next_y        =&gt; 630,\n     next_h        =&gt; 630,\n     padding       =&gt; 5,\n     padding_right =&gt; 10,\n);\n\n$pdf-&gt;saveas('mydata.pdf');\n</code></pre>\n\n"}], "owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513867869, "creation_date": 1513618630, "last_edit_date": 1513627291, "question_id": 47873651, "link": "https://stackoverflow.com/questions/47873651/generate-a-rectangular-box", "title": "Generate a rectangular box", "body": "<p>I am using Perl to generate a PDF file with the module\n<a href=\"https://metacpan.org/pod/PDF::API2\" rel=\"nofollow noreferrer\"><code>PDF::API2</code></a>.\nI want to draw rectangular boxes, each of which should contain a set of data based on a hash. I am displaying data using the following method, which is displayed in tabular format.</p>\n\n<pre><code>my $pdf = new PDF::API2(-file =&gt; \"mydata.pdf\");\nmy $page = $pdf-&gt;page;\n.............\n.............\nmy $pdftable = new PDF::Table;\n\n$pdftable-&gt;table(\n     $pdf,\n     $page,\n     \\@tbl,\n     x             =&gt; 50,\n     w             =&gt; 400,\n     start_y       =&gt; 630,\n     start_h       =&gt; 630,\n     next_y        =&gt; 630,\n     next_h        =&gt; 630,\n     padding       =&gt; 5,\n     padding_right =&gt; 10,\n);\n</code></pre>\n\n<p>where <code>@tbl</code> contains the data as an array of hashes.</p>\n\n<p>The rectangular boxes should be drawn based on the hash keys. If I have N keys, then N boxes should be drawn with their values.</p>\n\n<p>How can I draw boxes in PDF using Perl? I am unable to find any functions in <code>PDF::API2</code>.</p>\n\n<p>Here is an example diagram of how it should appear:</p>\n\n<p><img src=\"https://i.stack.imgur.com/6mWKa.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["linux", "perl", "centos7"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1513617187, "post_id": 47873097, "comment_id": 82711910, "body": "Did you check all the files in /etc/profile.d/ ?"}, {"owner": {"reputation": 669, "user_id": 4607616, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f3449d8e3d0e9aaea054bc3f7700af03?s=128&d=identicon&r=PG&f=1", "display_name": "lcikgl", "link": "https://stackoverflow.com/users/4607616/lcikgl"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513617572, "post_id": 47873097, "comment_id": 82712104, "body": "&#39;grep -i perl5 /etc/profile.d/*&#39; comes up empty"}, {"owner": {"reputation": 669, "user_id": 4607616, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f3449d8e3d0e9aaea054bc3f7700af03?s=128&d=identicon&r=PG&f=1", "display_name": "lcikgl", "link": "https://stackoverflow.com/users/4607616/lcikgl"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513617616, "post_id": 47873097, "comment_id": 82712126, "body": "...although that may have been on track, /etc/profile.d/perl-homedir.{csh,sh} have PERL_HOMEDIR set to &#39;1&#39;"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1513618409, "post_id": 47873097, "comment_id": 82712543, "body": "That looks promising. Try setting that to 0 and re-login?"}, {"owner": {"reputation": 669, "user_id": 4607616, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f3449d8e3d0e9aaea054bc3f7700af03?s=128&d=identicon&r=PG&f=1", "display_name": "lcikgl", "link": "https://stackoverflow.com/users/4607616/lcikgl"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513618648, "post_id": 47873097, "comment_id": 82712674, "body": "That worked. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 669, "user_id": 4607616, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f3449d8e3d0e9aaea054bc3f7700af03?s=128&d=identicon&r=PG&f=1", "display_name": "lcikgl", "link": "https://stackoverflow.com/users/4607616/lcikgl"}, "is_accepted": false, "score": 3, "last_activity_date": 1513619610, "creation_date": 1513619610, "answer_id": 47873888, "question_id": 47873097, "link": "https://stackoverflow.com/questions/47873097/how-to-disable-automatic-perl5lib-setting-in-centos7-4/47873888#47873888", "title": "How to disable automatic PERL5LIB setting in CentOS7.4", "body": "<p>Thanks @Chris Turner in comments above. The solution is to modify the two files <code>/etc/profile.d/perl-homedir.sh</code> and <code>/etc/profile.d/perl-homedir.csh</code>, changing the setting of <code>PERL_HOMEDIR</code> from <code>1</code> to <code>0</code>. After logging out and logging back in, the <code>PERL5LIB</code> environment variable is no longer set. </p>\n"}, {"tags": [], "owner": {"reputation": 702, "user_id": 1597592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e95be1e45ce44c35155324ac4548f5f?s=128&d=identicon&r=PG", "display_name": "Qinsi", "link": "https://stackoverflow.com/users/1597592/qinsi"}, "is_accepted": false, "score": 2, "last_activity_date": 1533264135, "last_edit_date": 1592644375, "creation_date": 1533263586, "answer_id": 51664537, "question_id": 47873097, "link": "https://stackoverflow.com/questions/47873097/how-to-disable-automatic-perl5lib-setting-in-centos7-4/51664537#51664537", "title": "How to disable automatic PERL5LIB setting in CentOS7.4", "body": "<p>Create a file $HOME/.perl-homedir:</p>\n<blockquote>\n<p>PERL_HOMEDIR=0</p>\n</blockquote>\n<p>This solution works even <strong>without root privileges</strong>.</p>\n<hr />\n<p>My system version:</p>\n<blockquote>\n<p>$ uname -a</p>\n<p>Linux login 3.10.0-693.el7.x86_64 #1 SMP Tue Aug 22 21:09:27 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</p>\n</blockquote>\n"}], "owner": {"reputation": 669, "user_id": 4607616, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f3449d8e3d0e9aaea054bc3f7700af03?s=128&d=identicon&r=PG&f=1", "display_name": "lcikgl", "link": "https://stackoverflow.com/users/4607616/lcikgl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1226, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1533264135, "creation_date": 1513616433, "last_edit_date": 1513617798, "question_id": 47873097, "link": "https://stackoverflow.com/questions/47873097/how-to-disable-automatic-perl5lib-setting-in-centos7-4", "title": "How to disable automatic PERL5LIB setting in CentOS7.4", "body": "<p>I just installed CentOS 7.4. </p>\n\n<p>All users on the system, regardless of whether they're running /bin/bash or /bin/tcsh, seem to automatically inherit a setting for the PERL5LIB environment variable pointing to <code>/home/&lt;user&gt;/perl5/lib/perl5</code>, together with an automatically-created perl5 subdirectory in their home directory. </p>\n\n<p>How can I turn the above system-wide behavior off, so that all users who log in have PERL5LIB unset? </p>\n\n<p>I've searched dot files for each user, system setup files, and all over the web but seem to be missing the secret. I know this is possible since I've managed this before, but have lost the details of the treasure hunt and would appreciate if someone could provide the key hint in a StackOverflow answer. </p>\n"}, {"tags": ["perl", "file"], "owner": {"reputation": 605, "user_id": 2016789, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/21b9a413e492a4004c3c1b430508ec10?s=128&d=identicon&r=PG", "display_name": "Orpheus", "link": "https://stackoverflow.com/users/2016789/orpheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1513617667, "answer_count": 0, "score": 2, "last_activity_date": 1513616547, "creation_date": 1513616402, "last_edit_date": 1513616547, "question_id": 47873082, "link": "https://stackoverflow.com/questions/47873082/filehandle-stored-in-hash-variable-reading-as-glob", "closed_reason": "Duplicate", "title": "Filehandle stored in hash variable reading as GLOB", "body": "<p>Perl version 5.22</p>\n\n<p>When I try to do a simple output like this, it works. File outputs fine, can continue:</p>\n\n<pre><code>open my $IN, '&lt;', 'somefile.txt' or die ('Failed to open');\nwhile (my $line = &lt;$IN&gt;) {\n  chomp $line;\n  print $line;\n}\nclose ($IN);\n</code></pre>\n\n<p>The following, however, does not work:</p>\n\n<pre><code>my %filehandles;\nopen $filehandles{'IN'}, '&lt;', 'somefile.txt' or die ('Failed to open');\nwhile (my $line = &lt;$filehandles{'IN'}&gt;) {\n  chomp $line;\n  print $line;\n}\nclose ($filehandles{'IN'});\n</code></pre>\n\n<p>When <code>$line</code> is printed in the second example, it only outputs something like GLOB(0x...), which I assume is just the type. <strong>In the second example, I don't want the GLOB, but the file contents.</strong></p>\n\n<p>I want to use the hash approach because my code might need to open a variable number of file handlers, and I should be able to close them all cleanly at the end of the function. So is there something small that I'm missing?</p>\n"}, {"tags": ["xml", "perl", "libxml2"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3425928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d845763744903c786576a38357e54c0?s=128&d=identicon&r=PG&f=1", "display_name": "tcdaly", "link": "https://stackoverflow.com/users/3425928/tcdaly"}, "edited": false, "score": 0, "creation_date": 1513616039, "post_id": 47871763, "comment_id": 82711302, "body": "Many thanks Dave for spotting that bug.  I was closer to the solution than I thought."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": true, "score": 5, "last_activity_date": 1513612036, "last_edit_date": 1513612036, "creation_date": 1513611695, "answer_id": 47871763, "question_id": 47871738, "link": "https://stackoverflow.com/questions/47871738/add-new-nodes-to-a-set-of-existing-nodes-perl-xmllibxml/47871763#47871763", "title": "Add new nodes to a set of existing nodes (Perl XML::LibXML)", "body": "<p>You need to make up your mind whether your <code>for</code> loop iterator variable is <code>$node</code> or <code>$_</code> :-)</p>\n\n<p>If I replace <code>$_-&gt;addChild($elm)</code> with <code>$node-&gt;addChild($elm)</code> your code works and gives this output:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;poem&gt;\n  &lt;stanza&gt;\n    &lt;v&gt;As I was going to Bonner,&lt;newnode&gt;This is a new node&lt;/newnode&gt;&lt;/v&gt;\n    &lt;v&gt;Upon my word of honor,&lt;newnode&gt;This is a new node&lt;/newnode&gt;&lt;/v&gt;\n    &lt;v&gt;I met a pig&lt;newnode&gt;This is a new node&lt;/newnode&gt;&lt;/v&gt;\n    &lt;v&gt;Without a wig,&lt;newnode&gt;This is a new node&lt;/newnode&gt;&lt;/v&gt;\n    &lt;v&gt;As I was going to Bonner.&lt;newnode&gt;This is a new node&lt;/newnode&gt;&lt;/v&gt;\n  &lt;/stanza&gt;\n&lt;/poem&gt;\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3425928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d845763744903c786576a38357e54c0?s=128&d=identicon&r=PG&f=1", "display_name": "tcdaly", "link": "https://stackoverflow.com/users/3425928/tcdaly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 47871763, "answer_count": 1, "score": 2, "last_activity_date": 1513612036, "creation_date": 1513611615, "question_id": 47871738, "link": "https://stackoverflow.com/questions/47871738/add-new-nodes-to-a-set-of-existing-nodes-perl-xmllibxml", "title": "Add new nodes to a set of existing nodes (Perl XML::LibXML)", "body": "<p>Using the Perl XML::LibXML library, I'm trying to add a new node to each of a set of existing nodes in an XML document, using a loop.  This is my attempt so far:</p>\n\n<pre><code>#!/usr/bin/perl -w\nuse 5.14.2;\nuse XML::LibXML;\n\nmy $filename = \"xml_doc.xml\";\nmy $parser = XML::LibXML-&gt;new();\n$parser-&gt;keep_blanks(0);\nmy $dom = $parser-&gt;parse_file($filename);\n\nfor my $node ($dom-&gt;findnodes(\"/poem/stanza/v\"))\n{\n    my $elm = $dom-&gt;createElement('newnode');\n    $elm-&gt;appendText('This is a new node');\n    $_-&gt;addChild($elm);\n}\n\nsay $dom-&gt;toString(1);\n</code></pre>\n\n<p>File 'xml_doc.xml':</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;poem&gt;\n&lt;stanza&gt;\n&lt;v&gt;As I was going to Bonner,&lt;/v&gt;\n&lt;v&gt;Upon my word of honor,&lt;/v&gt;\n&lt;v&gt;I met a pig&lt;/v&gt;\n&lt;v&gt;Without a wig,&lt;/v&gt;\n&lt;v&gt;As I was going to Bonner.&lt;/v&gt;\n&lt;/stanza&gt;\n&lt;/poem&gt;\n</code></pre>\n\n<p>The program fails with the error 'Can't call method \"addChild\" on an undefined value at batch_add_nodes.pl line 16.'</p>\n\n<p>Any tips would be welcome.</p>\n"}, {"tags": ["python", "perl"], "comments": [{"owner": {"reputation": 68674, "user_id": 41316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c31ca37c09ab42763f690e0d1355d7?s=128&d=identicon&r=PG", "display_name": "bruno desthuilliers", "link": "https://stackoverflow.com/users/41316/bruno-desthuilliers"}, "edited": false, "score": 1, "creation_date": 1513612007, "post_id": 47871639, "comment_id": 82709055, "body": "&quot;limit search of an file to specific block of text&quot; is quite vague, and we don&#39;t necessarily know enough perl to know what this &quot;if (/start_line/ ... /end_line/&quot;)&quot; stuff <b>really</b> does.  Also the best answer might depends on the context (what&#39;s in the file, how you want to use it etc)."}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513619848, "post_id": 47871639, "comment_id": 82713282, "body": "this is known as the &quot;flip-flop operator&quot; in Perl (and it&#39;s two dots <code>..</code>, not three). google &quot;flip-flop operator in Python&quot; for more info"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 3, "creation_date": 1513625858, "post_id": 47871639, "comment_id": 82715931, "body": "@beasy: It is <i>either</i> two dots <i>or</i> three, depending on how you want it to behave at the end of the range."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 68674, "user_id": 41316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c31ca37c09ab42763f690e0d1355d7?s=128&d=identicon&r=PG", "display_name": "bruno desthuilliers", "link": "https://stackoverflow.com/users/41316/bruno-desthuilliers"}, "edited": false, "score": 0, "creation_date": 1513626017, "post_id": 47871639, "comment_id": 82716007, "body": "@bruno: <i>&quot;we don&#39;t necessarily know enough perl to know what this ... stuff really does&quot;</i> That&#39;s fine, but it&#39;s not a reason to avoid asking the question just because some people (like you, presumably) don&#39;t know the answer."}, {"owner": {"reputation": 68674, "user_id": 41316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c31ca37c09ab42763f690e0d1355d7?s=128&d=identicon&r=PG", "display_name": "bruno desthuilliers", "link": "https://stackoverflow.com/users/41316/bruno-desthuilliers"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513671255, "post_id": 47871639, "comment_id": 82730785, "body": "@Borodin did I mean the OP shouldn&#39;t have asked this ??? Please re-read, I just ask for clarifications about what he&#39;s trying to do so he has <i>more</i> chances to get a good answer."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 68674, "user_id": 41316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c31ca37c09ab42763f690e0d1355d7?s=128&d=identicon&r=PG", "display_name": "bruno desthuilliers", "link": "https://stackoverflow.com/users/41316/bruno-desthuilliers"}, "edited": false, "score": 0, "creation_date": 1513800353, "post_id": 47871639, "comment_id": 82794884, "body": "@bruno: Then it seems odd to attack the contents of the OP, instead of simply asking questions to clarify your doubts as usual."}, {"owner": {"reputation": 68674, "user_id": 41316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c31ca37c09ab42763f690e0d1355d7?s=128&d=identicon&r=PG", "display_name": "bruno desthuilliers", "link": "https://stackoverflow.com/users/41316/bruno-desthuilliers"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513847218, "post_id": 47871639, "comment_id": 82810327, "body": "@Borodin I didn&#39;t &quot;attack&quot; anything nor anyone."}], "answers": [{"comments": [{"owner": {"reputation": 68674, "user_id": 41316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c31ca37c09ab42763f690e0d1355d7?s=128&d=identicon&r=PG", "display_name": "bruno desthuilliers", "link": "https://stackoverflow.com/users/41316/bruno-desthuilliers"}, "edited": false, "score": 1, "creation_date": 1513612090, "post_id": 47871858, "comment_id": 82709107, "body": "You shouldn&#39;t post answers based on wild guesses."}, {"owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "reply_to_user": {"reputation": 68674, "user_id": 41316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c31ca37c09ab42763f690e0d1355d7?s=128&d=identicon&r=PG", "display_name": "bruno desthuilliers", "link": "https://stackoverflow.com/users/41316/bruno-desthuilliers"}, "edited": false, "score": 5, "creation_date": 1513612274, "post_id": 47871858, "comment_id": 82709198, "body": "@brunodesthuilliers Just because you don&#39;t know Perl doesn&#39;t mean that others don&#39;t. This answer is a fairly accurate translation of Perl&#39;s flip-flop operator <code>...</code> into Python. It is not a wild guess."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 3, "creation_date": 1513614006, "post_id": 47871858, "comment_id": 82710153, "body": "The second one is wrong. If a sought block doesn&#39;t exist, then you crash, and if there are several, you only report the first one."}], "tags": [], "owner": {"reputation": 858, "user_id": 4048585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n2JQS.jpg?s=128&g=1", "display_name": "davis", "link": "https://stackoverflow.com/users/4048585/davis"}, "is_accepted": false, "score": 2, "last_activity_date": 1513629051, "last_edit_date": 1513629051, "creation_date": 1513612021, "answer_id": 47871858, "question_id": 47871639, "link": "https://stackoverflow.com/questions/47871639/python-repetitive-blocks-of-text/47871858#47871858", "title": "Python - repetitive blocks of text", "body": "<p>What if you try something like that?</p>\n\n<pre><code>start_line = \"line 1\"\nend_line = \"line 2\"\nin_block = False\nline_block = []\n\nwith open(\"file.txt\") as search:\n    for line in search:\n        line = line.rstrip()  # remove '\\n' at end of line\n        if line == start_line:\n            in_block = True\n        elif line == end_line:\n            line_block.append(line)\n            in_block = False\n\n       if in_block:\n           line_block.append(line)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16763, "user_id": 2749397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/rcNMz.png?s=128&g=1", "display_name": "gboffi", "link": "https://stackoverflow.com/users/2749397/gboffi"}, "is_accepted": false, "score": 0, "last_activity_date": 1513641297, "last_edit_date": 1513641297, "creation_date": 1513614579, "answer_id": 47872577, "question_id": 47871639, "link": "https://stackoverflow.com/questions/47871639/python-repetitive-blocks-of-text/47872577#47872577", "title": "Python - repetitive blocks of text", "body": "<p>I initially wrote a generator that yielded lines from the \ufb01rst\nmatching block <em>only</em> (see edit history) but an edit made me\nreconsider my first proposal, because the expected behaviour is to\nexecute the <code>if</code> body on every matching block of text.</p>\n\n<p>My new proposal is again a generator that, of course, by default\nyields the lines from the matching text blocks \"forever\" but, using an\noptional keyword argument, can also process the matching blocks a\nmaximum number (<code>count</code>) of times.</p>\n\n<p>A proof of concept follows</p>\n\n<pre><code>def from_beg_to_end(filename, beg, end, count=0):\n\n    '''Yields the lines from `filename` like in `sed -n /beg/,/end/p`\n\n    By default (for `count=0`) if the file contains multiple blocks\n    all the blocks are output, for `count` greater than zero the number\n    of blocks whose lines are returned is _at most_ `count.\n\n    Example of use:\n\n    for line in from_beg_to_end(filename, 'a', b'):\n        ...```\n\n    inside = False\n    for line in open(filename):\n        if not inside:\n            if beg in line: inside = True\n        if inside:\n            yield line\n            if end in line:\n                count = count-1\n                if count==0: return\n                inside = False\n</code></pre>\n\n<p>that uses a simple string match.  It should be easy to adapt the code\nabove to support regular expressions.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 2739902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72afad35e6f4206dbde8350b1abf8884?s=128&d=identicon&r=PG&f=1", "display_name": "ZDZ", "link": "https://stackoverflow.com/users/2739902/zdz"}, "edited": false, "score": 0, "creation_date": 1513625858, "post_id": 47874334, "comment_id": 82715929, "body": "for some reason I cant make it work this way but seems simplier !"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1513628527, "post_id": 47874334, "comment_id": 82717096, "body": "@melpomene, Fixed."}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513628663, "post_id": 47874334, "comment_id": 82717155, "body": "I had also accidentally flipped the args to the regex match. that&#39;s why it didn&#39;t work for OP. fixed now"}], "tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": true, "score": 2, "last_activity_date": 1513628683, "last_edit_date": 1513628683, "creation_date": 1513621526, "answer_id": 47874334, "question_id": 47871639, "link": "https://stackoverflow.com/questions/47871639/python-repetitive-blocks-of-text/47874334#47874334", "title": "Python - repetitive blocks of text", "body": "<p>You're referring to the Perl's flip-flop operator (<code>..</code>). Basically, it sets a boolean flag to true when it encounters the first condition, and back to false after it encounters the second (start and end lines inclusive). Looking at it that way, it's fairly simple to implement.</p>\n\n<pre><code>import re\n\nflip = False;\nfor line in open(filename):\n    if not flip and re.match('start-text',line): flip = True\n    if flip:\n        print(line)\n        if re.match('end-text',line): flip = False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 2739902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72afad35e6f4206dbde8350b1abf8884?s=128&d=identicon&r=PG&f=1", "display_name": "ZDZ", "link": "https://stackoverflow.com/users/2739902/zdz"}, "edited": false, "score": 0, "creation_date": 1513666526, "post_id": 47876278, "comment_id": 82728763, "body": "somehow I have issue to understand classes but this solution also works ! Cheers"}], "tags": [], "owner": {"reputation": 638, "user_id": 2116081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063968396b1387924cee71c29ef4d6?s=128&d=identicon&r=PG", "display_name": "SigmaPiEpsilon", "link": "https://stackoverflow.com/users/2116081/sigmapiepsilon"}, "is_accepted": false, "score": 0, "last_activity_date": 1513630474, "creation_date": 1513630474, "answer_id": 47876278, "question_id": 47871639, "link": "https://stackoverflow.com/questions/47871639/python-repetitive-blocks-of-text/47876278#47876278", "title": "Python - repetitive blocks of text", "body": "<p>The Perl solution implements flip flop operator which retains the state between successive loops. The other solutions have already implemented this by updating a flag variable. One can also write a class so that the status of previous matches are retained in the instance variable. An example is given below. This is the closest I could get to the elegant Perl syntax</p>\n\n<pre><code>#Fileblock.py\nimport re\n\nclass Block_Extract:\n    def __init__(self):\n        self.state = False\n    def test(self, lines, start, end):\n        if not self.state:\n            self.m1 = re.search(start, lines)\n        self.m2 = re.search(end, lines)\n        if self.m1 and not self.m2:\n            self.state = True\n            return self.state\n        if self.m2:\n            self.state = False\n            return True\n\n\nstart = \"line3\"\nend = \"line7\"\nfileblock = Block_Extract()\nwith open(\"Block_Test\") as fp:\n    for lines in fp:\n        lines = lines.rstrip()\n        if fileblock.test(lines, start, end):\n            print lines\n\n$ cat Block_Test \nThis is line1\nThis is line2\nThis is line3\nThis is line4\nThis is line5\nThis is line6\nThis is line7\nThis is line8\nThis is line9\nThis is line10\n$ python Fileblock.py \nThis is line3\nThis is line4\nThis is line5\nThis is line6\nThis is line7\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 2739902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72afad35e6f4206dbde8350b1abf8884?s=128&d=identicon&r=PG&f=1", "display_name": "ZDZ", "link": "https://stackoverflow.com/users/2739902/zdz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 47874334, "answer_count": 4, "score": 0, "last_activity_date": 1513641297, "creation_date": 1513611264, "last_edit_date": 1513612592, "question_id": 47871639, "link": "https://stackoverflow.com/questions/47871639/python-repetitive-blocks-of-text", "title": "Python - repetitive blocks of text", "body": "<p>I am new to Python but I have been using Perl for some time. In Perl, in order to limit search of an file to specific block of text, I would write something like below:</p>\n\n<pre><code>if (/start_line/ ... /end_line/) {\n   do something here\n}\n</code></pre>\n\n<p>The condition <code>/start_line/ ... /end_line/</code> starts being true once the <code>/start_line/</code> regex matches and then continues being true until after the <code>/end_line/</code> regex matches. In a loop that reads input line by line, this would execute the if-block for all lines between the start line and the end line, inclusive.</p>\n\n<p>How can I express the same condition in Python?</p>\n"}, {"tags": ["perl", "role", "moo"], "answers": [{"tags": [], "owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "is_accepted": true, "score": 3, "last_activity_date": 1513768032, "creation_date": 1513768032, "answer_id": 47904620, "question_id": 47870386, "link": "https://stackoverflow.com/questions/47870386/how-to-handle-mooroles-before-modifier-silently-skipped-due-to-circular-im/47904620#47904620", "title": "How to handle: Moo::Role&#39;s `before` modifier silently skipped due to circular imports?", "body": "<p>Circular imports can get rather tricky, but behave consistently. The crucial points are:</p>\n\n<ol>\n<li><code>use Some::Module</code> behaves like <code>BEGIN { require Some::Module; Some::Module-&gt;import }</code></li>\n<li>When a module is loaded, it is compiled and executed. <code>BEGIN</code> blocks are executed during parsing of the surrounding code.</li>\n<li>Each module is only <code>require</code>'d once. When it is required again, that <code>require</code> is <em>ignored</em>.</li>\n</ol>\n\n<p>Knowing that, we can combine your four files into a single file that includes the <code>require</code>d files in a BEGIN block.</p>\n\n<p>Let's start with your main file:</p>\n\n<pre><code>use MyA;\nuse MyB;\nMyB-&gt;new()-&gt;the_method();\n</code></pre>\n\n<p>We can transform the <code>use</code> to <code>BEGIN { require ... }</code> and include the <code>MyA</code> contents. For clarity, I will ignore any <code>-&gt;import</code> calls on <code>MyA</code> and <code>MyB</code> because they are not relevant in this case.</p>\n\n<pre><code>BEGIN { # use MyA;\n  package MyA;\n  use Moo;\n  with ( 'MyRole' );\n  sub the_method { die; }\n}\nBEGIN { # use MyB;\n  require MyB;\n}\nMyB-&gt;new()-&gt;the_method();\n</code></pre>\n\n<p>The <code>with('MyRole')</code> also does a <code>require MyRole</code>, which we can make explicit:</p>\n\n<pre><code>  ...\n  require MyRole;\n  with( 'MyRole ');\n</code></pre>\n\n<p>So let's expand that:</p>\n\n<pre><code>BEGIN { # use MyA;\n  package MyA;\n  use Moo;\n  { # require MyRole;\n    package MyRole;\n    use Moo::Role;\n    use MyB;\n    requires 'the_method';\n    before the_method =&gt; sub { die 'This has been correctly executed'; };\n  }\n  with ( 'MyRole' );\n  sub the_method { die; }\n}\nBEGIN { # use MyB;\n  require MyB;\n}\nMyB-&gt;new()-&gt;the_method();\n</code></pre>\n\n<p>We can then expand the <code>use MyB</code>, also expanding MyB's <code>with('MyRole')</code> to a  <code>require</code>:</p>\n\n<pre><code>BEGIN { # use MyA;\n  package MyA;\n  use Moo;\n  { # require MyRole;\n    package MyRole;\n    use Moo::Role;\n    BEGIN { # use MyB;\n      package MyB;\n      use Moo;\n      require MyRole;\n      with ( 'MyRole' );\n      sub the_method { die 'The code should have died before this point'; }\n    }\n    requires 'the_method';\n    before the_method =&gt; sub { die 'This has been correctly executed'; };\n  }\n  with ( 'MyRole' );\n  sub the_method { die; }\n}\nBEGIN { # use MyB;\n  require MyB;\n}\nMyB-&gt;new()-&gt;the_method();\n</code></pre>\n\n<p>Within <code>MyB</code> we have a <code>require MyRole</code>, but that module has already been required. Therefore, this doesn't do anything. At that point during the execution, <code>MyRole</code> only consists of this:</p>\n\n<pre><code>package MyRole;\nuse Moo::Role;\n</code></pre>\n\n<p>So the role is empty. The <code>requires 'the_method'; before the_method =&gt; sub { ... }</code> has not yet been compiled at that point.</p>\n\n<p>As a consequence <code>MyB</code> composes an empty role, which does not affect the <code>the_method</code>.</p>\n\n<hr>\n\n<p>How can this be avoided? It is often helpful to avoid a <code>use</code> in these cases because that interrupts parsing, before the current module has been initialized. This leads to unintuitive behaviour.</p>\n\n<p>When the modules you <code>use</code> are just classes and do not affect how your source code is parsed (e.g. by importing subroutines), then you can often defer the require to run time. Not just the run time of the module where top-level code is executed, but to the run time of the main application. This means sticking your <code>require</code> into the subroutine that needs to use the imported class. Since a <code>require</code> still has some overhead even when the required module is already imported, you can guard the require like <code>state $require_once = require Some::Module</code>. That way, the require has no run-time overhead.</p>\n\n<p>In general: you can avoid many problems by doing as little initialization as possible in the top-level code of your modules. Prefer being lazy and deferring that initialization. On the other hand, this laziness can also make your system more dynamic and less predictable: it is difficult to tell what initialization has already happened.</p>\n\n<p>More generally, think hard about your design. Why is this circular dependency needed? You should decide to either stick to a layered architecture where high-level code depends on low-level code, or use dependency inversion where low-level code depends on high-level interfaces. Mixing both will result in a horrible tangled mess (exhibit A: this question).</p>\n\n<p>I do understand that some data models necessarily feature co-recursive classes. In that case it can be clearest to sort out the order manually by placing the interdependent classes in a single file.</p>\n"}], "owner": {"reputation": 83, "user_id": 9113407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YjRgZ.jpg?s=128&g=1", "display_name": "Tony E Lewis", "link": "https://stackoverflow.com/users/9113407/tony-e-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 47904620, "answer_count": 1, "score": 6, "last_activity_date": 1513768032, "creation_date": 1513606761, "question_id": 47870386, "link": "https://stackoverflow.com/questions/47870386/how-to-handle-mooroles-before-modifier-silently-skipped-due-to-circular-im", "title": "How to handle: Moo::Role&#39;s `before` modifier silently skipped due to circular imports?", "body": "<p>Using <code>Moo::Role</code>, I'm finding that circular imports are silently preventing the execution of the <code>before</code> modifier of my method.</p>\n\n<p>I have a <code>Moo::Role</code> in <code>MyRole.pm</code> :</p>\n\n<pre><code>package MyRole;\nuse Moo::Role;\nuse MyB;\nrequires 'the_method';\nbefore the_method =&gt; sub { die 'This has been correctly executed'; };\n1;\n</code></pre>\n\n<p>...a consumer in <code>MyA.pm</code> :</p>\n\n<pre><code>package MyA;\nuse Moo;\nwith ( 'MyRole' );\nsub the_method { die; }\n1;\n</code></pre>\n\n<p>..and another in <code>MyB.pm</code> :</p>\n\n<pre><code>package MyB;\nuse Moo;\nwith ( 'MyRole' );\nsub the_method { die 'The code should have died before this point'; }\n1;\n</code></pre>\n\n<p>When I run this <code>script.pl</code>:</p>\n\n<pre><code>#!/usr/bin/env perl\npackage main;\nuse MyA;\nuse MyB;\nMyB-&gt;new()-&gt;the_method();\n</code></pre>\n\n<p>...I get <code>The code should have died before this point at MyB.pm line 4.</code> but would expect to see <code>This has been correctly executed at MyRole.pm line 5</code>.</p>\n\n<p>I think this problem is caused by the circular imports. It goes away if I switch the order of the <code>use</code> statements in <code>script.pl</code> or if I change the <code>use MyB;</code> in <code>MyRole.pm</code> to be a <code>require</code> within <code>the_method</code>.</p>\n\n<p>Is this behaviour expected? If so, what is the best way to handle it where circular imports can't be avoided?</p>\n\n<p>I can workaround the problem but it feels worryingly easy to inadvertently trigger (particularly since it causes <code>before</code> functions, which often contain checking code, to be silently skipped).</p>\n\n<p>(I'm using Moo version 2.003004. Obviously the <code>use MyB;</code> in <code>MyRole.pm</code> is superfluous here but only after I've simplified the code for this repro example.)</p>\n"}, {"tags": ["xml", "perl"], "comments": [{"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 1, "creation_date": 1513604560, "post_id": 47869706, "comment_id": 82704559, "body": "I have fixed the formatting of your code (this included adding the missing closing <code>}</code>). You&#39;re welcome, but please do it yourself in the future. If you are asking a group of strangers to read and understand your code, then it is only polite to make that task as easy as possible for them."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1513605051, "post_id": 47869706, "comment_id": 82704814, "body": "The obvious mistake is that the example input doesn&#39;t match what you&#39;re looking for in your code"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513609092, "post_id": 47869706, "comment_id": 82707288, "body": "<i>&quot;I ... have made some mistake withe the xml tag path for Grand total&quot;</i> But your code doesn&#39;t show any &quot;xml tag path&quot; at all. You will need to show your real code and data to get proper help."}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513610307, "post_id": 47869938, "comment_id": 82708072, "body": "Not sure your first update is entirely correct since the OP code is looking for lines that contain the &quot;EquipSalesTotalChargeIncTax&quot; tag"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513610632, "post_id": 47869938, "comment_id": 82708267, "body": "@ChrisTurner: Yeah, I based it on the sample data, not the code. That&#39;s why I said I think he has oversimplified the problem (and, probably, confused himself in the process)."}, {"owner": {"reputation": 1, "user_id": 7145937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/641711f34149fb981d0316233722afeb?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay", "link": "https://stackoverflow.com/users/7145937/vijay"}, "edited": false, "score": 0, "creation_date": 1513668405, "post_id": 47869938, "comment_id": 82729503, "body": "Thanks Chris &amp; Dave  for all your suggestions and help and you people  are right , I tried to oversimplified it since the sample  have given is a part of a very large XML file also there are many &#39;GrandTotal&#39; tags , but I needed to fetch the one comes under &lt;TotalForServiceSummary&gt;."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 4, "last_activity_date": 1513606026, "last_edit_date": 1513606026, "creation_date": 1513605096, "answer_id": 47869938, "question_id": 47869706, "link": "https://stackoverflow.com/questions/47869706/xml-data-fetch-using-perl/47869938#47869938", "title": "XML data fetch using Perl", "body": "<p>There is quite a lot of misunderstanding going on here.</p>\n\n<p>You don't need to read your XML file a line at a time. You should let <code>XMLIn()</code> work on all of your XML at once - in fact you can pass it a filename and it will open the file and read all of the XML from it.</p>\n\n<p>However, you should also note this section from the <a href=\"https://metacpan.org/pod/XML::Simple#STATUS-OF-THIS-MODULE\" rel=\"nofollow noreferrer\">XML::Simple documentation</a>:</p>\n\n<blockquote>\n  <p><strong>STATUS OF THIS MODULE</strong></p>\n  \n  <p>The use of this module in new code is discouraged. Other modules are\n  available which provide more straightforward and consistent\n  interfaces. In particular, <a href=\"https://metacpan.org/pod/XML::LibXML\" rel=\"nofollow noreferrer\">XML::LibXML</a> is highly recommended and\n  <a href=\"https://metacpan.org/pod/XML::Twig\" rel=\"nofollow noreferrer\">XML::Twig</a> is an excellent alternative.</p>\n  \n  <p>The major problems with this module are the large number of options\n  (some of which have unfortunate defaults) and the arbitrary ways in\n  which these options interact - often producing unexpected results.</p>\n  \n  <p>Patches with bug fixes and documentation fixes are welcome, but new\n  features are unlikely to be added.</p>\n</blockquote>\n\n<p>You should seriously consider switching to one of the alternative libraries mentioned above.</p>\n\n<p>Also, these two lines make no sense:</p>\n\n<pre><code>my $ref3 = $xml-&gt;XMLin($line);\n$return = $return . $ref3;\n</code></pre>\n\n<p><code>$ref3</code> will contain a reference (probably to a hash). The string representation of that will look like <code>HASH(0x12345678)</code> and that's very unlikely to be what you want.</p>\n\n<p><strong>Update:</strong> Solving this problem with XML::LibXML looks like this. But I suspect you are oversimplifying your question, so this solution might not work for you.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\nuse feature 'say';\n\nuse XML::LibXML;\n\n# My XML is in \"total.xml\".\nmy $doc = XML::LibXML-&gt;new-&gt;parse_file('total.xml');\n\nsay $doc-&gt;findvalue('//TotalForServiceSummary/GrandTotal');\n</code></pre>\n\n<p><strong>Update 2:</strong> A few other points about your code.</p>\n\n<p>Your lines:</p>\n\n<pre><code>my $salesOrderNumber =shift @ARGV;\nmy $billRunID = shift @ARGV;\n</code></pre>\n\n<p>and so on...</p>\n\n<p>Are better written as:</p>\n\n<pre><code>my ($salesOrderNumber, $billRunID, $customerNodeID,\n    $invoiceID, $billRunDate) = @ARGV;\n</code></pre>\n\n<p>The <code>glob()</code> function is a cross-platform way to get lists of filenames - without using an external program like <code>ls</code>.</p>\n\n<p>Please use lexical filehandles and the three-arg version of <code>open()</code>.</p>\n\n<pre><code>open my $xml_fh, '&lt;', $file\n  or die \"Can't open $file: $!\\n\";\n</code></pre>\n\n<p>The \"indirect object\" way of calling a constructor (<code>new XML::Simple</code>) will potentially cause you hard-to-find problems at some point. It's better to use <code>XML::Simple-&gt;new</code> instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 7145937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/641711f34149fb981d0316233722afeb?s=128&d=identicon&r=PG&f=1", "display_name": "Vijay", "link": "https://stackoverflow.com/users/7145937/vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513606026, "creation_date": 1513604262, "last_edit_date": 1513604470, "question_id": 47869706, "link": "https://stackoverflow.com/questions/47869706/xml-data-fetch-using-perl", "title": "XML data fetch using Perl", "body": "<p>I have to fetch the value of \"Grand Total\" value from xml , i have written perl script for it  ,but have made some mistake withe the xml tag path for Grand total. Please guide for the correct path.</p>\n\n<p>Below are the XML.</p>\n\n<pre><code>&lt;TotalForServiceSummary&gt;\n  &lt;GrandTotal&gt;&lt;![CDATA[1246.00]]&gt;&lt;/GrandTotal&gt;\n&lt;/TotalForServiceSummary&gt;\n</code></pre>\n\n<p>Script:</p>\n\n<pre><code>my $salesOrderNumber =s hift @ARGV;\nmy $billRunID = shift @ARGV;\nmy $customerNodeID = shift @ARGV;\nmy $invoiceID = shift @ARGV;\nmy $billRunDate =shift @ARGV;\n\nmy $filename = \"So_\".$salesOrderNumber.\"_\".$billRunID.\"_\".$customerNodeID.\"_\".$invoiceID.\"_\".$billRunDate;\n\nmy $file = `ls /svw/svwsit2b/data/server/invoices/sap_equip_invoice/$filename\\*.xml`;\n\nmy $return;\n\nopen(XML, $file) or die \"Cannot open $file for reading: $!\\n\";\n\nwhile (my $line = &lt;XML&gt;) {\n\n    if ($line =~ /\\&lt;EquipSalesTotalChargeIncTax\\&gt;/i) {\n        my $xml = new XML::Simple;\n        my $ref3 = $xml-&gt;XMLin($line);\n        $return = $return . $ref3;\n    }    \n}\n</code></pre>\n"}, {"tags": ["perl", "stdout"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513964174, "post_id": 47867497, "comment_id": 82860326, "body": "Welcome to Stackoverflow. See <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a> And look around <a href=\"https://stackoverflow.com/help\">help pages</a>, which are short and clear. If you have questions about posted answers it is expected to speak up and people will normally respond and clarify things."}], "answers": [{"comments": [{"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1514131821, "post_id": 47873987, "comment_id": 82893473, "body": "thanks, I never knew you could redirect STDOUT. it strikes me that technically you could still use <code>warn</code> to print to the console though"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 1, "creation_date": 1514148006, "post_id": 47873987, "comment_id": 82897158, "body": "@beasy One of the standard docs for background on this is <a href=\"http://tldp.org/LDP/abs/html/io-redirection.html\" rel=\"nofollow noreferrer\">I/O redirection (bash)</a>. But note that modules make that much easier. For example, I can readily find <a href=\"https://stackoverflow.com/a/47045913/4653379\">this post</a> and <a href=\"https://stackoverflow.com/a/43501427/4653379\">this post</a>"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1514180137, "post_id": 47873987, "comment_id": 82901611, "body": "@beasy Indeed. The warn goes to STDERR, a different stream (fd 2). That stream does come out on the console unless it is redirected as well. When I have STDOUT redirected for a program I usual also redirect STDERR (in the exact same manner), and usually to a different file. This is because such programs run unattended, out of cron or other tools, and I need all their output in files. Then the program can check in the end whether the STDERR-file is emtpy, and if it isn&#39;t it sends me an email warning me that there were errors (otherwise it deletes the file)."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 2, "last_activity_date": 1513665699, "last_edit_date": 1513665699, "creation_date": 1513620054, "answer_id": 47873987, "question_id": 47867497, "link": "https://stackoverflow.com/questions/47867497/how-to-redirect-output-of-some-commands-to-a-file-but-keep-some-in-the-console/47873987#47873987", "title": "How to redirect output of some commands to a file but keep some in the console?", "body": "<p>You <a href=\"http://perldoc.perl.org/functions/open.html\" rel=\"nofollow noreferrer\"><em>redirect</em> the standard output stream</a> to a file with <code>open STDOUT, '&gt;', $file</code>.  After that there is no simple way to print to the console.</p>\n\n<p>Some ways to print to both a file and the console</p>\n\n<ul>\n<li><p>Save <code>STDOUT</code> before redirecting and restore it later when needed. Again, see <a href=\"http://perldoc.perl.org/functions/open.html\" rel=\"nofollow noreferrer\">open</a></p>\n\n<pre><code>open SAVEOUT, \"&gt;&amp;STDOUT\"  or warn \"Can't dup STDOUT: $!\";\nopen *STDOUT, \"&gt;\", $logfile or warn \"Can't redirect STDOUT to $logfile: $!\";\nsay \"goes to file\"; \n...\nopen STDOUT, \"&gt;&amp;SAVEOUT\"  or warn \"Can't reopen STDOUT: $!\";  # restore\nsay \"goes to console\";\n</code></pre></li>\n<li><p>Print to a variable what you intend for console; use <a href=\"https://perldoc.perl.org/functions/select.html\" rel=\"nofollow noreferrer\">select</a> to switch the default for where prints go</p>\n\n<pre><code>open my $fh_so, '&gt;', \\my $for_stdout;\nselect $fh_so;\nsay \"goes to variable \\$for_stdout\";\nsay STDOUT \"goes to console\";\n...\nselect STDOUT;    # make STDOUT default again\nsay $for_stdout;  # goes to console (all accumulated $fh_so prints)\n</code></pre>\n\n<p>With this you can reach the console by specifying <code>STDOUT</code>, otherwise you would put out all STDOUT-intended prints once you <code>select</code> back to <code>STDOUT</code></p></li>\n<li><p>Print logs to a file directly, as in <a href=\"https://stackoverflow.com/a/47867537/4653379\">Jens's answer</a></p>\n\n<pre><code>open my $fh_log, '&gt;', $logfile or die \"Can't open $logfile: $!\";\nsay $fh_log \"goes to $logfile\";\nsay         \"goes to console\";\n...\nclose $fh_log;\n</code></pre>\n\n<p>where the default <code>print</code> (or rather <code>say</code> above) keeps going to the console</p></li>\n</ul>\n\n<p>The first two seem a little cumbersome, don't they.  I'd recommend to print logs directly to a log file, unless <code>STDOUT</code> needs to be redirected for the most of the program, or you have a compelling reason to <code>select</code> filehandles around.</p>\n\n<p>For <code>say</code>, which adds newline to what is printed, you need <code>use feature 'say';</code> at the beginning. </p>\n\n<p>Always start your programs with <code>use warnings;</code> and <code>use strict;</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 9113141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9436c5b483a814dd2527fbe03c165ae?s=128&d=identicon&r=PG&f=1", "display_name": "jayashreerajendran", "link": "https://stackoverflow.com/users/9113141/jayashreerajendran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513964000, "creation_date": 1513596328, "last_edit_date": 1513964000, "question_id": 47867497, "link": "https://stackoverflow.com/questions/47867497/how-to-redirect-output-of-some-commands-to-a-file-but-keep-some-in-the-console", "title": "How to redirect output of some commands to a file but keep some in the console?", "body": "<p>I am using below perl script, </p>\n\n<pre><code>open (STDOUT, '&gt;',\"log.txt\")|| die \"ERROR: opening log.txt\\n\";\nprint \"\\n inside\";\nclose (STDOUT);\nprint \"\\noutside\";\n</code></pre>\n\n<p>I need string \"inside\" need to be printed inside log.txt. string \"outside\" need to be printed in the console.</p>\n\n<p>But with my script string \"inside\" is printed inside log.txt, but string \"outside\" is not printed on the console.</p>\n\n<p>Can anyone help me on this</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513622561, "post_id": 47866111, "comment_id": 82714457, "body": "it&#39;s hard to know from your example why you wouldn&#39;t just do the operation outside the regex"}], "answers": [{"tags": [], "owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "is_accepted": true, "score": 1, "last_activity_date": 1513592573, "creation_date": 1513592573, "answer_id": 47866355, "question_id": 47866111, "link": "https://stackoverflow.com/questions/47866111/how-do-i-use-operations-inside-a-perl-regex/47866355#47866355", "title": "How do I use operations inside a Perl regex?", "body": "<p>Variable interpolation in regexes works pretty much the same as variable interpolation in strings. Given <code>my $x = 2</code>, the string <code>\"$x $x+1\"</code> would be <code>\"2 2+1\"</code>. The variable is expanded, but code in the string is not executed.</p>\n\n<p>One trick around this is to use dereference a reference inside the string. This allows us to include arbitrary expressions, but the syntax is a bit cumbersome. Usually, we create an array reference with the value we want to include <code>[$x + 1]</code>, then immediately dereference it: <code>@{[$x + 1]}</code>. This is similar to Ruby's <code>#{...}</code> interpolation, or to Bash <code>$(...)</code> command substitution.</p>\n\n<p>So the regex <code>/$x @{[$x + 1]}/x</code> would work.</p>\n\n<p>But in most cases, it's going to be much clearer to perform all calculations outside of the regex:</p>\n\n<pre><code>my $x = 2;\nmy $y = $x + 1;\n/$x $y/x;\n</code></pre>\n\n<p>The Perl regex syntax also has syntax that can generate parts of the regex dynamically. With variable interpolation as above the variable contents are interpolated, and then the regex is compiled. But advanced regexes may change the value of a variable during the pattern match. These delayed regexes can be written with the <code>(??{ ... })</code> syntax. Here: <code>/$x (??{ $x + 1 })/x</code>. However, this is a very advanced and error-prone regex feature. This will also be slower than an ordinary regex.</p>\n"}, {"tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 1, "last_activity_date": 1513629535, "last_edit_date": 1513629535, "creation_date": 1513593979, "answer_id": 47866787, "question_id": 47866111, "link": "https://stackoverflow.com/questions/47866111/how-do-i-use-operations-inside-a-perl-regex/47866787#47866787", "title": "How do I use operations inside a Perl regex?", "body": "<p>There is <a href=\"https://perldoc.perl.org/perlre.html#%28%3f%3f%7B-code-%7D%29\" rel=\"nofollow noreferrer\">an extended pattern</a> that provides for code execution in the match operator <code>m/</code> or in the matching part of the substitution operator <code>s///</code>. </p>\n\n<p>Its version that substitutes the code's return and goes on to treat it as a pattern is</p>\n\n<pre><code>/(??{ code })/\n</code></pre>\n\n<p>so in your case</p>\n\n<pre><code>$_ = 23;\nmy $x = 2;\nmy ($m) = /(2(??{ $x+1 }))/;\nsay $m;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>RE_EVAL: {\n    use re 'eval';\n    my ($m) = /($x(??{ $x+1 }))/;\n    say $m;\n}\n</code></pre>\n\n<p>matches and captures <code>23</code>.  </p>\n\n<p>Here <a href=\"https://perldoc.perl.org/re.html#%27eval%27-mode\" rel=\"nofollow noreferrer\">use re 'eval'</a> specifically allows this, normally disallowed for security reasons.</p>\n\n<p>This is a very involved capability which comes with complex warnings.  Apart from its entry at the above link also follow the link in that text and read about <a href=\"https://perldoc.perl.org/perlre.html#Embedded-Code-Execution-Frequency\" rel=\"nofollow noreferrer\">Embedded Code Execution frequency</a>.</p>\n\n<p>Please don't use this complex tool for convenience, or to substitute for properly written code. </p>\n"}], "owner": {"reputation": 3, "user_id": 6367649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376c584fd314c818f1aadb6871158474?s=128&d=identicon&r=PG&f=1", "display_name": "mdagtek", "link": "https://stackoverflow.com/users/6367649/mdagtek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47866355, "answer_count": 2, "score": 0, "last_activity_date": 1513629535, "creation_date": 1513591785, "question_id": 47866111, "link": "https://stackoverflow.com/questions/47866111/how-do-i-use-operations-inside-a-perl-regex", "title": "How do I use operations inside a Perl regex?", "body": "<p>For example let's say I have something like this: </p>\n\n<pre><code> $_ = 23;\n $a = 2;\n print /$a $a+1/x;\n</code></pre>\n\n<p>should print 1. Basically, is it possible to use functions inside the regex string? </p>\n"}, {"tags": ["arrays", "perl", "hash", "error-handling", "scripting"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1513590698, "post_id": 47865547, "comment_id": 82696466, "body": "FYI, you don&#39;t need to call subroutines with an &amp; before them any more - that&#39;s very old school perl."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513590830, "post_id": 47865547, "comment_id": 82696559, "body": "Also...your code doesn&#39;t have 68 lines so that error message is meaningless"}, {"owner": {"reputation": 13, "user_id": 7388590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc1fabeeae853daddcf3bb5e179e04b?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/7388590/george"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1513591128, "post_id": 47865547, "comment_id": 82696724, "body": "The error is from the print_file subroutine, and is refering to the next line: print $fout join(&quot;,&quot;, $ref-&gt;{code}, [@{$ref-&gt;{tar_rec}}]), &quot;\\n&quot;;  Sorry for the created confusion. I took out only the code that was referring to the steps that intend to follow."}], "answers": [{"tags": [], "owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "is_accepted": false, "score": 0, "last_activity_date": 1513596234, "last_edit_date": 1513596234, "creation_date": 1513592608, "answer_id": 47866367, "question_id": 47865547, "link": "https://stackoverflow.com/questions/47865547/adding-a-key-value-pair-in-hash-by-assigning-an-array-in-the-value-cant-use/47866367#47866367", "title": "Adding a key value pair in hash, by assigning an array in the value =&gt; Can&#39;t use an undefined value as an ARRAY reference", "body": "<p>Until the second regex in your forloop block is matched, the <code>$ref-&gt;{tar_rec}</code> key will not be assigned a value - and will be undefined. The following snippet - based on your own code - highlights the issue.</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nmy @tar_records = (15,35,20);\n\nmy $ref = {\n    code =&gt; 'Cork',\n    tar_rec =&gt; \\@tar_records,\n};\n\nsub print_info {\n    my $ref = shift;\n    print join(\", \", $ref-&gt;{code}, (@{$ref-&gt;{tar_rec}})), $/;\n}\n\nprint_info($ref);\n\n# Once we 'undefine' the relevant key, we witness the afore-\n#  mentioned error.\nundef $ref-&gt;{tar_rec};\n\nprint_info($ref);\n</code></pre>\n\n<p>To avoid this error, you could assign an anonymous array reference to <code>$ref-&gt;{tar_rec}</code> key <em>before</em> the for loop (since <code>$ref-&gt;{tar_rec}</code> is a cumulative value).</p>\n\n<pre><code># Be sure not to declare $ref twice!\nmy ($read, $val_county, $val_rec, $val_tar, $val_print, @test_values, $status);\nmy $ref = {\n    code =&gt; '',\n    tar_rec =&gt; [],\n}\n</code></pre>\n\n<p>P.S. Notice also that I used round brackets rather than square brackets in the <code>join()</code> function (although you actually don't need either).</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7388590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc1fabeeae853daddcf3bb5e179e04b?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/7388590/george"}, "edited": false, "score": 0, "creation_date": 1513598382, "post_id": 47866416, "comment_id": 82700976, "body": "Thanks to all for help. Chris, your solution is doing the right thing now. Thanks for helping and for your time.  It seems that Perl does me to many tricks !! :)"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": -1, "last_activity_date": 1513592752, "creation_date": 1513592752, "answer_id": 47866416, "question_id": 47865547, "link": "https://stackoverflow.com/questions/47865547/adding-a-key-value-pair-in-hash-by-assigning-an-array-in-the-value-cant-use/47866416#47866416", "title": "Adding a key value pair in hash, by assigning an array in the value =&gt; Can&#39;t use an undefined value as an ARRAY reference", "body": "<p>The problem is that you're calling <code>print_file</code> in the wrong place.</p>\n\n<p>Imagine that you're parsing the file a line at a time. Your code parses the first line and that populates <code>$ref-&gt;{code}</code>. But then you call <code>print_file</code> on a partially populated <code>$ref</code> so it doesn't work.</p>\n\n<p>Your code is also not resetting any of the variables used, so as it progresses through the file, the contents of <code>$ref</code> are going to grow. </p>\n\n<p>The code below fixes the first problem by implicitly setting an empty array in <code>$ref-&gt;{tar_rec}</code> and only printing out the record when it's starting a new one or when it's finished reading in the file. Since <code>$ref-&gt;{tar_rec}</code> is an array it solves the other problem by allowing you to directly push into it rather than relying upon <code>@test_values</code>. Just for added safety it assigns an empty hash to <code>$ref</code>. </p>\n\n<pre><code>if(open(my $fh, '&lt;', $in_file)) {\n    my $ref;\n    my $val_county;\n\n    foreach(&lt;$fh&gt;) {\n        # print $_;\n        if ($_ =~ /\\t+(?&lt;county_name&gt;(?!Total).+)\\s+/i) {\n            if(defined($val_county)) {\n                print_file($ref);\n            }\n\n            $ref={};\n            $val_county = $+{county_name};\n            $ref-&gt;{code} = $val_county;\n            $ref-&gt;{tar_rec} = [];\n        } elsif ($_ =~ /^Total\\s+records\\s+in\\s+TAR\\s+\\(pr.+\\)\\:\\s+(?&lt;tar_records&gt;.+)$\n            push @{$ref-&gt;{tar_rec}}, $+{tar_records};\n        }\n    }\n    if(defined($ref)) {\n        print_file($ref);\n    }\n    close($fh);\n\n} else {\n    die \"Could not open file '$in_file' $!\";\n}\n</code></pre>\n\n<p>You're also printing out the array incorrectly </p>\n\n<pre><code>print $fout join(\",\", $ref-&gt;{code}, [@{$ref-&gt;{tar_rec}}]), \"\\n\";\n</code></pre>\n\n<p>you don't need any brackets around <code>@{$ref-&gt;{tar_rec}}</code> - it'll be treated as a list of values to pass to <code>join</code> as is.</p>\n\n<pre><code>print $fout join(\",\", $ref-&gt;{code}, @{$ref-&gt;{tar_rec}}), \"\\n\";\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7388590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc1fabeeae853daddcf3bb5e179e04b?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/7388590/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 47866416, "answer_count": 2, "score": 1, "last_activity_date": 1513609487, "creation_date": 1513589904, "last_edit_date": 1513609487, "question_id": 47865547, "link": "https://stackoverflow.com/questions/47865547/adding-a-key-value-pair-in-hash-by-assigning-an-array-in-the-value-cant-use", "title": "Adding a key value pair in hash, by assigning an array in the value =&gt; Can&#39;t use an undefined value as an ARRAY reference", "body": "<p>I'm trying to assign an array in a hash key-value pair as a value of a key. After assigning it i'm trying to dereference it and print the array values from the specific key in an output file as you can see from the code below.</p>\n\n<p>The code is not working well on the array manipulation part. Can someone tell me what I'm doing wrong?</p>\n\n<pre><code>use strict; \nuse warnings;\nuse Data::Dumper;\n\n# File input\nmy $in_file = 'log.txt';\n\n# Output file\nmy $out_file_name = 'output.csv';\n\nopen(my $fout, '&gt;', $out_file_name);\n# print header csv\nprint $fout \"Col1\\,Col2\\,Col3\\,Col4\\,Col5\\n\";\n\n# Read the input file\nopen(FH, '&lt;', $in_file) or die \"Could not open file '$in_file' $!\";\nmy @log_file = &lt;FH&gt;;\n# print Dumper(@log_file),\"\\n\";\nclose (FH);\n\n# my @test_val;\n\nmy ($read, $ref, $val_county, $val_rec, $val_tar, $val_print, @test_values, $status);\n\nforeach(@log_file) {\n    # print $_;\n    if ($_ =~ /\\t+(?&lt;county_name&gt;(?!Total).+)\\s+/i) {           \n        $ref-&gt;{code} = $+{county_name};\n        $val_county = $ref-&gt;{code};\n    } elsif ($_ =~ /^Total\\s+records\\s+in\\s+TAR\\s+\\(pr.+\\)\\:\\s+(?&lt;tar_records&gt;.+)$/i) {\n        $ref-&gt;{code} = $val_county;\n        push(@test_values, $+{tar_records});\n        $ref-&gt;{tar_rec} = \\@test_values;\n        # $val_rec = $ref-&gt;{tar_rec};\n        # $val_rec =~ s/\\.//g;\n    }\n\n    &amp;print_file($ref);\n\n}\n\n\nsub print_file {\n    my $ref = shift;    \n    my $status = shift; \n    print $fout join(\",\", $ref-&gt;{code}, [@{$ref-&gt;{tar_rec}}]), \"\\n\";  # Line 68\n    print Dumper($ref);\n}\n\nclose $fout;\n\nprint \"Done!\",\"\\n\";\n</code></pre>\n\n<p>The code is a providing an error like:\n\"Can't use an undefined value as an ARRAY reference at test_array_val_hash.pl line 68.\"</p>\n"}, {"tags": ["perl", "dist-zilla"], "answers": [{"tags": [], "owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "is_accepted": false, "score": 0, "last_activity_date": 1513575327, "creation_date": 1513575327, "answer_id": 47862631, "question_id": 47862156, "link": "https://stackoverflow.com/questions/47862156/distzilla-getting-install-instructions-into-readme-mkdn/47862631#47862631", "title": "Dist::Zilla: Getting install instructions into Readme.mkdn", "body": "<p>OK, I thought it would use weaver.ini from my profile. Apparently, that isn't the case. I had to put the file in the root of the repo directory.</p>\n"}], "owner": {"reputation": 2287, "user_id": 1641112, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/00bee18fb974a0057fb61a56faf66052?s=128&d=identicon&r=PG", "display_name": "StevieD", "link": "https://stackoverflow.com/users/1641112/stevied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520194721, "creation_date": 1513571472, "last_edit_date": 1520194721, "question_id": 47862156, "link": "https://stackoverflow.com/questions/47862156/distzilla-getting-install-instructions-into-readme-mkdn", "title": "Dist::Zilla: Getting install instructions into Readme.mkdn", "body": "<p>I'm using Dist::Zilla to generate a README.mkdn file. I want to inject installation instructions into it using <a href=\"https://metacpan.org/pod/Pod::Weaver::Section::Installation\" rel=\"nofollow noreferrer\">Pod::Weaver::Section::Installation</a>. Not sure if this can be done. There's probably a better way to do this.</p>\n\n<p>Here is my weaver.ini file in my Dist::Zilla profile:</p>\n\n<pre><code>[@CorePrep]\n\n[Name]\n[Version]\n\n[Generic / SYNOPSIS]\n[Generic / DESCRIPTION]\n\n[Collect / ATTRIBUTES]\ncommand = attr\n\n[Collect / METHODS]\ncommand = method\n\n[Generic / CONFIGURATION AND ENVIRONMENT]\n[Generic / DEPENDENCIES]\n[Generic / INCOMPATIBILITIES]\n[Generic / BUGS AND LIMITATIONS]\n\n[Installation]\n[Authors]\n[Legal]\n\n[-Transformer]\ntransformer = List\n</code></pre>\n"}, {"tags": ["perl", "join", "dbix-class", "prefetch"], "comments": [{"owner": {"reputation": 946, "user_id": 1765406, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Koqta.jpg?s=128&g=1", "display_name": "vanHoesel", "link": "https://stackoverflow.com/users/1765406/vanhoesel"}, "edited": false, "score": 3, "creation_date": 1513578983, "post_id": 47861406, "comment_id": 82691365, "body": "To be honest, I think you make your life over complicated. <code>DBIx::Class</code> is an ORM, where R stands for &#39;Relational&#39;. It would expect relations in your schema, like <code>has_many</code> or <code>belongs_to</code>. Once you have those, you no longer have to do any off the looping manually. Just a query on <code>product_model</code> that selects those rows that belong <code>products</code> where name <code>eq</code> &#39;Product 2&#39; ... hope this will give you enough hints."}, {"owner": {"reputation": 542, "user_id": 1150133, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ed8e50a887128bd9a3e01a5dd291111e?s=128&d=identicon&r=PG", "display_name": "gypark", "link": "https://stackoverflow.com/users/1150133/gypark"}, "reply_to_user": {"reputation": 946, "user_id": 1765406, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Koqta.jpg?s=128&g=1", "display_name": "vanHoesel", "link": "https://stackoverflow.com/users/1765406/vanhoesel"}, "edited": false, "score": 0, "creation_date": 1513641429, "post_id": 47861406, "comment_id": 82722266, "body": "@vanHoesel Thank you for the advice. However I&#39;m looking for ALL products, not a specific product. Anyway I could start from <code>product_model</code> and <code>prefetch =&gt; { product =&gt; &#39;product_models&#39; }</code> to get all supported models. In fact I didn&#39;t because there are several more condition to apply in my real work. I&#39;ll think more and consider what you said. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 2, "creation_date": 1513621723, "post_id": 47874335, "comment_id": 82714128, "body": "Free hand circles with a touchpad are really hard to make circly."}], "tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": true, "score": 6, "last_activity_date": 1513621532, "creation_date": 1513621532, "answer_id": 47874335, "question_id": 47861406, "link": "https://stackoverflow.com/questions/47861406/dbixclass-get-all-relationship-that-was-used-as-a-condition-using-prefetch/47874335#47874335", "title": "DBIx::Class - get all relationship that was used as a condition using prefetch?", "body": "<p>If you have the correct relationships in your schema, this is possible with a single query. But it's tricky. Let's assume your database looks like this:</p>\n\n<pre><code>CREATE TABLE product\n (`id` VARCHAR(2) PRIMARY KEY, `name` VARCHAR(9))\n;\nINSERT INTO product\n (`id`, `name`) VALUES\n ('p1', 'Product 1'),\n ('p2', 'Product 2')\n;\nCREATE TABLE product_model (\n  `product_id` VARCHAR(2),\n  `model_id` VARCHAR(2),\n  PRIMARY KEY (product_id, model_id),\n  FOREIGN KEY(product_id) REFERENCES product(id),\n  FOREIGN KEY(model_id) REFERENCES model(id)\n)\n;\nINSERT INTO product_model\n (`product_id`, `model_id`) VALUES\n ('p1', 'm1'),\n ('p2', 'm1'),\n ('p2', 'm2')\n;\nCREATE TABLE model\n (`id` VARCHAR(2) PRIMARY KEY, `name` VARCHAR(7))\n;\nINSERT INTO model\n (`id`, `name`) VALUES\n ('m1', 'Model 1'),\n ('m2', 'Model 2')\n;\n</code></pre>\n\n<p>This is essentially your DB from the question. I added primary keys and foreign keys. You probably have those anyway.</p>\n\n<p>We can now create a schema from that. I've written a simple program that uses <a href=\"https://metacpan.org/pod/DBIx::Class::Schema::Loader#make_schema_at\" rel=\"noreferrer\">DBIx::Class::Schema::Loader</a> to do that. It creates an SQLite database on the fly. (If no-one has put this on CPAN, I will).</p>\n\n<p>The SQL from above will go in the <code>__DATA__</code> section.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse DBIx::Class::Schema::Loader qw/ make_schema_at /;\n\n# create db\nunlink 'foo.db';\nopen my $fh, '|-', 'sqlite3 foo.db' or die $!;\nprint $fh do { local $/; &lt;DATA&gt; };\nclose $fh;\n\n$ENV{SCHEMA_LOADER_BACKCOMPAT} = 1;\n\n# create schema\nmy $dsn = 'dbi:SQLite:foo.db';\nmake_schema_at(\n    'DB',\n    {\n        #    debug =&gt; 1,\n    },\n    [ $dsn, 'sqlite', '', ],\n);\n\n$ENV{DBIC_TRACE} = 1;\n\n# connect schema\nmy $schema = DB-&gt;connect($dsn);\n\n# query goes here\n\n__DATA__\n# SQL from above\n</code></pre>\n\n<p>Now that we have that, we can concentrate on the query. At first this will look scary, but I'll try to explain.</p>\n\n<pre><code>my $rs     = $schema-&gt;resultset('Product')-&gt;search(\n    { 'product_models.model_id' =&gt; 'm2' },\n    {\n        'prefetch' =&gt; {\n            product_models =&gt; {\n                product_id =&gt; {\n                    product_models =&gt; 'model_id'\n                }\n            }\n        }\n    },\n);\n\nwhile ( my $product = $rs-&gt;next ) {\n    foreach my $product_model ( $product-&gt;product_models-&gt;all ) {\n        my @models;\n        foreach my $supported_model ( $product_model-&gt;product_id-&gt;product_models-&gt;all ) {\n            push @models, $supported_model-&gt;model_id-&gt;id;\n        }\n        printf \"%s: %s\\n\", $product-&gt;id, join ', ', @models;\n    }\n}\n</code></pre>\n\n<p>The <code>prefetch</code> means <em>join on this relation, and keep the data around for later</em>. So to get all models for your product, we have to write</p>\n\n<pre><code>#          1                   2\n{ prefetch =&gt; { product_models =&gt; 'product_id' } }\n</code></pre>\n\n<p>Where <code>product_models</code> is the N:M table, and <code>product_id</code> is the name of the relation to the Models table. The arrow <code>=&gt;</code> <em>1</em> is for the first join from <code>Product</code> to <code>ProductModel</code>. The <em>2</em> is for <code>ProductModel</code> back to every product that has the model <em>m2</em>. See the drawing of the ER model for an illustration.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uOB7W.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/uOB7W.jpg\" alt=\"ER model\"></a></p>\n\n<p>Now we want to have all the <code>ProductModel</code>s that this <code>Product</code> has. That's arrow <em>3</em>.</p>\n\n<pre><code>#          1                   2               3\n{ prefetch =&gt; { product_models =&gt; { product_id =&gt; 'product_models' } } }\n</code></pre>\n\n<p>And finally, to get the <code>Model</code>s for that N:M relation, we have to use the <code>model_id</code> relationshop with arrow <em>4</em>.</p>\n\n<pre><code>{\n    'prefetch' =&gt; {                            # 1\n        product_models =&gt; {                    # 2\n            product_id =&gt; {                    # 3\n                product_models =&gt; 'model_id'   # 4\n            }\n        }\n    }\n},\n</code></pre>\n\n<p>Looking at the ER model drawing should make that clear. Remember that each of those joins is a <code>LEFT OUTER</code> join by default, so it will always fetch all the rows, without loosing anything. DBIC just takes care of that for you.</p>\n\n<p>Now to access all of that, we need to iterate. DBIC gives us some tools to do that.</p>\n\n<pre><code>while ( my $product = $rs-&gt;next ) {\n\n    #                                   1\n    foreach my $product_model ( $product-&gt;product_models-&gt;all ) {\n        my @models;\n\n        #                                           2           3\n        foreach my $supported_model ( $product_model-&gt;product_id-&gt;product_models-&gt;all ) {\n\n            #                             4 \n            push @models, $supported_model-&gt;model_id-&gt;id;\n        }\n        printf \"%s: %s\\n\", $product-&gt;id, join ', ', @models;\n    }\n}\n</code></pre>\n\n<p>First we grab all the <code>ProductModel</code> entries (<em>1</em>). For each of those, we take the <code>Product</code> (<em>2</em>). There is always only one <code>Product</code> in every line, because that way we have a 1:N relation, so we can directly access it. This <code>Product</code> in turn has a <code>ProductModel</code> relation. That's <em>3</em>. Because this is the N side, we need to take all of them and iterate. We then push the <code>id</code> of every <code>Model</code> (<em>4</em>) into our list of models for this product. After that, it's just printing.</p>\n\n<p>Here's another way to look at it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6RYv4.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/6RYv4.png\" alt=\"enter image description here\"></a></p>\n\n<p>We could eliminate that last <code>model_id</code> in the <code>prefetch</code>, but then we'd have to use <code>get_column('model_id')</code> to get the ID. It would save us a join.</p>\n\n<p>Now if we turn on <code>DBIC_TRACE=1</code>, we get this SQL statement:</p>\n\n<pre><code>SELECT me.id, me.name, product_models.product_id, product_models.model_id, product_id.id, product_id.name, product_models_2.product_id, product_models_2.model_id, model_id.id, model_id.name\nFROM product me\nLEFT JOIN product_model product_models ON product_models.product_id = me.id\nLEFT JOIN product product_id ON product_id.id = product_models.product_id\nLEFT JOIN product_model product_models_2 ON product_models_2.product_id = product_id.id\nLEFT JOIN model model_id ON model_id.id = product_models_2.model_id\nWHERE (product_models.model_id = 'm2')\nORDER BY me.id\n</code></pre>\n\n<p>If we run this against our DB, we have these rows:</p>\n\n<pre><code>p2|Product 2|p2|m2|p2|Product 2|p2|m1|m1|Model 1\np2|Product 2|p2|m2|p2|Product 2|p2|m2|m2|Model 2\n</code></pre>\n\n<p>Of course that's pretty useless if we do it manually, but DBIC's magic really helps us, because all the weird joining and combining is completely abstracted away, and we only need one single query to get all the data.</p>\n"}], "owner": {"reputation": 542, "user_id": 1150133, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ed8e50a887128bd9a3e01a5dd291111e?s=128&d=identicon&r=PG", "display_name": "gypark", "link": "https://stackoverflow.com/users/1150133/gypark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 3, "accepted_answer_id": 47874335, "answer_count": 1, "score": 5, "last_activity_date": 1516189019, "creation_date": 1513564086, "last_edit_date": 1516189019, "question_id": 47861406, "link": "https://stackoverflow.com/questions/47861406/dbixclass-get-all-relationship-that-was-used-as-a-condition-using-prefetch", "title": "DBIx::Class - get all relationship that was used as a condition using prefetch?", "body": "<p>Here are three tables: <code>product</code>, <code>model</code>, and <code>product_model</code> that maps products and models in N:M relationship.</p>\n\n<pre><code>product          product_model            model\n\nid name          product_id model_id      id name\n------------     -------------------      ----------\np1 Product 1     p1         m1            m1 Model 1\np2 Product 2     p2         m1            m2 Model 2\n...              p2         m2\n</code></pre>\n\n<p>What I want to do: Find all products that support Model 2(eg. <code>product 2</code>). Then, for each product, show the list of model_ids that the product supports(<code>product 2</code> => [ <code>m1</code>,<code>m2</code> ])</p>\n\n<p>This was my first try. I needed N more queries to search <code>model_id</code>s for each product.</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code># 1 query for searching products\nmy @products = $schema-&gt;resultset('Product')-&gt;search(\n   { 'product_models.model_id' =&gt; 'm2' },\n   { 'join' =&gt; 'product_model' },\n)\n# N queries for searching product_models for each product\nforeach my $product ( @products ) {\n   my @model_ids = map { $_-&gt;model_id } $product-&gt;product_models;\n   # @model_ids = ( 'm1', 'm2' ) for p2\n}\n</code></pre>\n\n<p>I looked for a way to get the result using only one query. Replacing <code>join</code> with <code>prefetch</code> didn't work.</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>my @products = $schema-&gt;resultset('Product')-&gt;search(\n   { 'product_models.model_id' =&gt; 'm2' },\n   { 'prefetch' =&gt; 'product_model' },      # here\n)\n\n# no additional queries, but...\nforeach my $product ( @products ) {\n   my @model_ids = map { $_-&gt;model_id } $product-&gt;product_models;\n   # now, @model_ids contains only ( `m2` )\n}\n</code></pre>\n\n<p>Next, I tried \"prefetch same table twice\":</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>my @products = $schema-&gt;resultset('Product')-&gt;search(\n    { 'product_models.model_id' =&gt; 'm2' },\n    { 'prefetch' =&gt; [ 'product_models', 'product_models' ] },\n);\n\nforeach my $product ( @products ) {\n    my @model_ids = map { $_-&gt;model_id } $product-&gt;product_models;\n}\n</code></pre>\n\n<p>It seemed that I succeeded. Only one query was executed and I got all model IDs from it.</p>\n\n<p><strong>However I wasn't so sure that this is the right(?) way. Is this a correct approach?</strong></p>\n\n<p>For example, if I used <code>join</code> instead of <code>prefetch</code>ing, <code>Product 2</code> appears in the loop twice. I understand that, because the joined table is like:</p>\n\n<pre><code>id name      p_m.p_id p_m.m_id p_m_2.p_id p_m_2.m_id\np2 Product 2 p2       m2       p2         m1\np2 Product 2 p2       m2       p2         m2   -- Product 2, one more time\n</code></pre>\n\n<p>Why does <code>Product 2</code> appear only once when I use <code>prefetch</code>?</p>\n\n<p>The resulting queries are almost same, except the difference of <code>SELECT</code> fields:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \"me\".\"id\", \"me\".\"name\",\n \"product_models\".\"product_id\", \"product_models\".\"model_id\",    -- only in prefetch\n \"product_models_2\".\"product_id\", \"product_models_2\".\"model_id\" --\n  FROM \"product\" \"me\"\n  LEFT JOIN \"product_model\" \"product_models\"\n    ON \"product_models\".\"product_id\" = \"me\".\"id\"\n  LEFT JOIN \"product_model\" \"product_models_2\"\n    ON \"product_models_2\".\"product_id\" = \"me\".\"id\"\nWHERE \"product_models\".\"model_id\" = 'm2'\n</code></pre>\n"}, {"tags": ["regex", "perl", "extract", "text-mining", "twitch"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1513546390, "post_id": 47859506, "comment_id": 82684039, "body": "Oh, I see. You should <code>push(@array2, $1)</code> inside the loop. And, $mylist only gets the match result bool. So, if $mylist, then print and store $1."}, {"owner": {"reputation": 52821, "user_id": 632407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AfGWW.jpg?s=128&g=1", "display_name": "jm666", "link": "https://stackoverflow.com/users/632407/jm666"}, "edited": false, "score": 3, "creation_date": 1513546651, "post_id": 47859506, "comment_id": 82684109, "body": "It is valid JSON - so IMHO better to use some JSON parser."}, {"owner": {"reputation": 1523, "user_id": 4204037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab78fa882cbf4a03c4fd2a0b92622dc5?s=128&d=identicon&r=PG&f=1", "display_name": "bytepusher", "link": "https://stackoverflow.com/users/4204037/bytepusher"}, "edited": false, "score": 0, "creation_date": 1513547317, "post_id": 47859506, "comment_id": 82684291, "body": "This code does not compile as posted. <code>$array[$time]</code> should be <code>$array-&gt;[$time]</code> as it&#39;s an arrayref. Then: Why return an array <code>@array2</code> if it&#39;s got nothing in it? Or, conversely, why do all that code if you&#39;re returning <code>my @array2</code> anyway :P. On top of that: yes, do use a parser for JSON."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 1, "creation_date": 1516688341, "post_id": 47859506, "comment_id": 83778238, "body": "See <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 52821, "user_id": 632407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AfGWW.jpg?s=128&g=1", "display_name": "jm666", "link": "https://stackoverflow.com/users/632407/jm666"}, "edited": false, "score": 0, "creation_date": 1513552048, "post_id": 47859870, "comment_id": 82685411, "body": "or using <a href=\"https://metacpan.org/pod/ojo\" rel=\"nofollow noreferrer\">ojo</a>: <code>perl -Mojo -E &#39;my $d=j( g(q{https:&#47;&#47;tmi.twitch.tv&#47;group&#47;user&#47;twitchpresents&#47;chatters&zwnj;&#8203;})-&gt;body );say &quot;@$_&quot; for @{$d-&gt;{chatters}}{qw(moderators viewers)}&#39;</code>"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 52821, "user_id": 632407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AfGWW.jpg?s=128&g=1", "display_name": "jm666", "link": "https://stackoverflow.com/users/632407/jm666"}, "edited": false, "score": 0, "creation_date": 1513553037, "post_id": 47859870, "comment_id": 82685602, "body": "@jm666 Sure :) But they went with <code>LWP::Simple</code> so I kept that approach"}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 3, "last_activity_date": 1526921135, "last_edit_date": 1526921135, "creation_date": 1513547947, "answer_id": 47859870, "question_id": 47859506, "link": "https://stackoverflow.com/questions/47859506/twitch-tmi-extract-all-users/47859870#47859870", "title": "Twitch TMI, extract all users", "body": "<p>I assume that you get the page with <code>get</code> from <a href=\"http://search.cpan.org/~ether/libwww-perl-6.31/lib/LWP/Simple.pm\" rel=\"nofollow noreferrer\">LWP::Simple</a>. Please always show relevant includes.</p>\n\n<p>Since this is valid JSON, use a module for that</p>\n\n<pre><code>use warnings;\nuse strict;\nuse feature 'say';\nuse Data::Dump qw(dd);\n\nuse LWP::Simple;    \nuse JSON;\n\nmy $data_json = get($url);\n\nmy $data = JSON-&gt;new-&gt;decode($data_json);\n#dd $data;\n\nmy @names = @{ $data-&gt;{chatters}{moderators} };             # get \"moderators\"\nsay \"@names\";\n# my @all_names = map { @$_ } values %{$data-&gt;{chatters}};  # or get all names\n</code></pre>\n\n<p>This prints the line: &nbsp; <code>cliccer cuda hnlbot nixi93 scorpy0 somppe</code> </p>\n\n<p>I print \"names\" of <em>moderators</em> as an example of getting one category out; the commented out line gets all names in one array. Once you have a hashref there are various ways to extract what you need. </p>\n\n<p>Your code seems to be trying to parse that JSON string. It is very easy with a module.</p>\n\n<p>One can view complex data structures with <a href=\"https://perldoc.perl.org/Data/Dumper.html\" rel=\"nofollow noreferrer\">Data::Dumper</a> or such. I use <a href=\"http://search.cpan.org/~gaas/Data-Dump-1.23/lib/Data/Dump.pm\" rel=\"nofollow noreferrer\">Data::Dump</a>.</p>\n\n<p>Here <a href=\"http://search.cpan.org/~ishigaki/JSON-2.97000/lib/JSON.pm\" rel=\"nofollow noreferrer\">JSON</a> is used, which delegates to <a href=\"http://search.cpan.org/~mlehmann/JSON-XS-3.02/XS.pm\" rel=\"nofollow noreferrer\">JSON::XS</a> if installed or to the \"pure Perl\" (and slower) <a href=\"http://search.cpan.org/~ishigaki/JSON-PP-2.97001/lib/JSON/PP.pm\" rel=\"nofollow noreferrer\">JSON::PP</a> otherwise. Another option is <a href=\"http://search.cpan.org/~rurban/Cpanel-JSON-XS-3.0239/XS.pm\" rel=\"nofollow noreferrer\">Cpanel::JSON::XS</a>.</p>\n\n<hr>\n\n<p>For convenience, the structure printed by <code>dd $data</code> is</p>\n\n<pre>\n{\n  _links => {},\n  chatter_count => 15,\n  chatters => {\n    admins      => [],\n    global_mods => [],\n    moderators  => [\n                     \"cliccer\",\n                     \"cuda\",\n                     \"hnlbot\",\n                     \"joffy95\",\n                     \"nixi93\",\n                     \"scorpy0\",\n                     \"somppe\",\n                   ],\n    staff       => [],\n    viewers     => [\n                     \"coldblood94\",\n                     \"coldbot\",\n                     \"gabenator\",\n                     \"gharokk\",\n                     \"reconcrusadershadow\",\n                     \"scrubnubslulz\",\n                     \"shai_the_panda\",\n                     \"sonadourge\",\n                   ],\n  },\n}\n</pre>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 0, "last_activity_date": 1513556760, "last_edit_date": 1513556760, "creation_date": 1513554258, "answer_id": 47860552, "question_id": 47859506, "link": "https://stackoverflow.com/questions/47859506/twitch-tmi-extract-all-users/47860552#47860552", "title": "Twitch TMI, extract all users", "body": "\n\n<p>I recommend that you use\n<a href=\"https://metacpan.org/pod/Mojo::UserAgent\" rel=\"nofollow noreferrer\"><code>Mojo::UserAgent</code></a>\nfor this, as it contains a JSON decoder as well as an HTTP user agent and makes the code much more concise</p>\n\n<p>I assume you want the names of all the different categories of <em>chatters</em> so that's what the <code>map</code> statement does: simply flattening all of the categories\u2014<code>admins</code>, <code>global_mods</code>, <code>moderators</code>, <code>staff</code>, and <code>viewers</code>\u2014into a single list</p>\n\n<p>If anything goes wrong with the HTTP transfer then the subroutine will simply return an empty list, so you may want to add some proper error handling</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings;\nuse feature 'say';\n\nuse Mojo::UserAgent;\n\nmy @list_users = chatters();\nsay for @list_users;\n\nsub chatters {\n\n    my $url = 'https://tmi.twitch.tv/group/user/twitchpresents/chatters';\n    return unless my $data = Mojo::UserAgent-&gt;new-&gt;get($url)-&gt;res-&gt;json;\n\n    map { @$_ } values %{ $data-&gt;{chatters} };\n}\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>girlonduty\nmoobot\nravager\n100tesports\n123mickeypr\n13eebo\n13urnxcalibur\n2dmoody\n2l33t\n2tony79\n3nticed\n...\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8908532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/36055d44d0fc35a955aeaa075ccd166c?s=128&d=identicon&r=PG&f=1", "display_name": "Mikster", "link": "https://stackoverflow.com/users/8908532/mikster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1526921135, "creation_date": 1513545111, "last_edit_date": 1513580123, "question_id": 47859506, "link": "https://stackoverflow.com/questions/47859506/twitch-tmi-extract-all-users", "title": "Twitch TMI, extract all users", "body": "<p>I'm trying to extract all the user names from the source (<a href=\"https://tmi.twitch.tv/group/user/twitchpresents/chatters\" rel=\"nofollow noreferrer\">https://tmi.twitch.tv/group/user/twitchpresents/chatters</a>), but so far I'm only able to get like the first \"name\". \nGoal is to get all the names into an array, and then just remove the \"viewers\", \"admins\", \"staff\", etc. names.</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy @listusers = userlist();\nsub userlist {\n    my $url = \"https://tmi.twitch.tv/group/user/twitchpresents/chatters\";\n    my $array = get($url);\n    my @array2;\n    my $time = 0;\n\n    while ($time != 2){\n       my $mylist = (join \"\",grep(/\"\\s*(.*?)\\s*\"/, $array[$time])) =~ /\"\\s*(.*?)\\s*\"/;\n       print $1;\n       $time++;\n    }\n    return @array2;\n\n}\n\nprint @listusers;\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1513529330, "post_id": 47857254, "comment_id": 82678863, "body": "There is no &quot;awk command&quot; in Perl. Where did you get that from?"}, {"owner": {"reputation": 7570, "user_id": 17945, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e8cbc0b9ed29b027a127d8df309af5a6?s=128&d=identicon&r=PG", "display_name": "reinierpost", "link": "https://stackoverflow.com/users/17945/reinierpost"}, "edited": false, "score": 0, "creation_date": 1513588278, "post_id": 47857254, "comment_id": 82695170, "body": "By <code>awk &#39;&#47;$fld1&#47; &amp;&amp; &#47;host&#47; &amp;&amp; &#47;$fld2&#47; &amp;&amp; &#47;$fld3&#47; &amp;&amp; &#47;$fld4&#47; &amp;&amp; &#47;$fld5&#47;&#39; $line1</code>, you presumably mean <code>grep { &#47;$fld1&#47; &amp;&amp; &#47;host&#47; &amp;&amp; &#47;$fld2&#47; &amp;&amp; &#47;$fld3&#47; &amp;&amp; &#47;$fld4&#47; &amp;&amp; &#47;$fld5&#47; } ( $line1 )</code> (Perl has no <code>awk</code> command, but <a href=\"http://perldoc.perl.org/functions/grep.html\" rel=\"nofollow noreferrer\">it has a <code>grep</code> command</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1513533184, "post_id": 47857869, "comment_id": 82680110, "body": "<code>split &#47;\\s+&#47;</code> is almost never what you want. <code>split &#39; &#39;</code> is what you should use if you want to turn a string into a list of whitespace-separated words."}, {"owner": {"reputation": 1672, "user_id": 4355253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee8cbfecfb7686f370b07eea52273c5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Elices", "link": "https://stackoverflow.com/users/4355253/javier-elices"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1513533564, "post_id": 47857869, "comment_id": 82680253, "body": "@melpomene, I leave the <code>split</code> as you say. It is true that the input may contain <i>empty</i> columns and those will not be treated right with <code>split &#47;\\s+&#47;</code>. For that <code>split &#47;\\s&#47;</code> maybe better. But it is hard to say if we don&#39;t know the input file format."}, {"owner": {"reputation": 52821, "user_id": 632407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AfGWW.jpg?s=128&g=1", "display_name": "jm666", "link": "https://stackoverflow.com/users/632407/jm666"}, "edited": false, "score": 2, "creation_date": 1513533645, "post_id": 47857869, "comment_id": 82680275, "body": "@JavierElices <code>perldoc -f split</code>: <i>As another special case, split emulates the default behavior of the command line tool awk when the PATTERN is either omitted or a string composed of a single space character (such as &#39; &#39; or &quot;\\x20&quot; , but not e.g. / / ). In this case, any leading whitespace in EXPR is removed before splitting occurs, and the PATTERN is instead treated as if it were /\\s+/ ;</i>"}, {"owner": {"reputation": 1672, "user_id": 4355253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee8cbfecfb7686f370b07eea52273c5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Elices", "link": "https://stackoverflow.com/users/4355253/javier-elices"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1513533882, "post_id": 47857869, "comment_id": 82680344, "body": "@melpomene, I did not have that one in mind but you are right. Perl is full of tricks... :-) Thank you for reminding me (and others that may read this)."}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 1, "creation_date": 1513541110, "post_id": 47857869, "comment_id": 82682514, "body": "you have to reset the file iteration on <code>$fh2</code> with <code>seek $fh2,0,0</code>otherwise it will only iterate once."}], "tags": [], "owner": {"reputation": 1672, "user_id": 4355253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee8cbfecfb7686f370b07eea52273c5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Elices", "link": "https://stackoverflow.com/users/4355253/javier-elices"}, "is_accepted": true, "score": 0, "last_activity_date": 1513544762, "last_edit_date": 1513544762, "creation_date": 1513532980, "answer_id": 47857869, "question_id": 47857254, "link": "https://stackoverflow.com/questions/47857254/awk-search-fields-from-one-file-within-other-from-inside-a-perl-script/47857869#47857869", "title": "awk search fields from one file within other from inside a Perl script", "body": "<p>Although I am not sure why this \"comparison\" is useful to you, the following code does what your code seems to be attempting to do:</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\n\nmy $file1 = shift || '/home/amp/surevy01/file1';\nmy $file2 = shift || '/home/amp/surevy01/file2';\n\nmy @cols = (4, 5, 6, 7, 9);\n\nopen(my $fh1, \"&lt;$file1\") or die \"Cannot open source: $file1\\n\";\nopen(my $fh2, \"&lt;$file1\") or die \"Cannot open destination: $file2\\n\";\n\nwhile( my $line1 = &lt;$fh1&gt; ) {\n  chomp $line1;\n  my @cols1 = split ' ', $line1;\n\n  while( my $line2 = &lt;$fh2&gt; ) {\n    chomp $line2;\n    my @cols2 = split ' ', $line2;\n\n    my $count = 0;\n    foreach my $i ( @cols ) {\n      if( $cols1[$i] eq $cols2[$i] ) {\n        $count++;\n      }\n    }\n    if( $count == scalar @cols ) {\n      print \"All duplicate\\n\";\n    }\n  }\n  seek $fh2, 0, 0;\n}\n</code></pre>\n\n<p>Regarding your code, please note:</p>\n\n<ol>\n<li>As stated in comments to your question, <code>awk</code> is not a Perl command. It is a different programming language. That explains the first error you get.</li>\n<li>The <em>string</em> comparison in Perl is <code>eq</code>; <code>==</code> is used to compare numbers. So you should use <code>$line eq $line1</code>.</li>\n<li>You might use <code>awk</code> within a Perl script by using <code>system</code> and then get the return status using <code>$?</code>, but that would be terribly inefficient.</li>\n</ol>\n\n<p>Also please note that the code as it stands will compare each line of the first file with all lines of the second file, giving no context to know when the <code>All duplicate</code> string is printed. Maybe you mean to compare both files side by side. For that you may want to check <code>diff</code> which combined with something that would choose the right columns like <code>cut</code>, <code>awk</code> or even <code>perl</code> would make a side by side comparison relatively easy.</p>\n\n<p>If you need something else done you may want to edit your question and state what exactly you are trying to achieve and give longer input files to illustrate along with an expected output.</p>\n"}], "owner": {"reputation": 33, "user_id": 8191890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10210222397819480/picture?type=large", "display_name": "Vibes", "link": "https://stackoverflow.com/users/8191890/vibes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 47857869, "answer_count": 1, "score": 0, "last_activity_date": 1513545935, "creation_date": 1513529019, "last_edit_date": 1513545935, "question_id": 47857254, "link": "https://stackoverflow.com/questions/47857254/awk-search-fields-from-one-file-within-other-from-inside-a-perl-script", "title": "awk search fields from one file within other from inside a Perl script", "body": "\n\n<p>I'm comparing below two files for duplicates</p>\n\n<h3>file1</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>ac-list hostname permit tcp host 110.185.35.111 host 10.185.38.220 eq 1222\n</code></pre>\n\n<h3>file2</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>ac-list hostname permit tcp host 10.185.35.111 host 10.185.38.220 eq 1222\n</code></pre>\n\n<p>My script is as below</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>#!/usr/bin/perl\n\nopen( SOURCE,      \"&lt;/home/amp/surevy01/file1\" );\nopen( DESTINATION, \"&lt;/home/amp/surevy01/file2\" );\n\nwhile ( my $line = &lt;SOURCE&gt; ) {\n\n    while ( my $line1 = &lt;DESTINATION&gt; ) {\n\n        chomp( $line );\n        chomp( $line1 );\n\n        my @columns = split( ' ', $line );\n        my @gitcols = split( ' ', $line1 );\n\n        my $fld1    = $columns[4];\n        my $fld2    = $columns[5];\n        my $fld3    = $columns[6];\n        my $fld4    = $columns[7];\n        my $fld5    = $columns[9];\n\n        my $gitfld1 = $gitcols[4];\n        my $gitfld2 = $gitcols[5];\n        my $gitfld3 = $gitcols[6];\n        my $gitfld4 = $gitcols[7];\n        my $gitfld5 = $gitcols[9];\n\n        if ( $line == $line1\n            || awk '/$fld1/ &amp;&amp; /host/ &amp;&amp; /$fld2/ &amp;&amp; /$fld3/ &amp;&amp; /$fld4/ &amp;&amp; /$fld5/' $line1 ) {\n\n            print \"\\n All duplicate\";\n        }\n    }\n}\n</code></pre>\n\n<p>I'm getting the below error:</p>\n\n<blockquote>\n  <p>String found where operator expected at ./perltest line 25, near \"awk '/$fld1/ &amp;&amp; /host/ &amp;&amp; /$fld2/ &amp;&amp; /$fld3/ &amp;&amp; /$fld4/ &amp;&amp; /$fld5/'\" (Do you need to predeclare awk?)<br>\n  Scalar found where operator expected at ./perltest line 25, near \"'/$fld1/ &amp;&amp; /host/ &amp;&amp; /$fld2/ &amp;&amp; /$fld3/ &amp;&amp; /$fld4/ &amp;&amp; /$fld5/' $line1\" (Missing operator before $line1?)<br>\n  syntax error at ./perltest line 25, near \"awk '/$fld1/ &amp;&amp; /host/ &amp;&amp; /$fld2/ &amp;&amp; /$fld3/ &amp;&amp; /$fld4/ &amp;&amp; /$fld5/'\"<br>\n  syntax error at ./perltest line 30, near \"}\"<br>\n  Execution of ./perltest aborted due to compilation errors.  </p>\n</blockquote>\n\n<p>However without using the <code>awk</code> command my script is working perfectly fine.</p>\n"}, {"tags": ["perl", "floating-point"], "answers": [{"comments": [{"owner": {"reputation": 513, "user_id": 5210701, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f87a03ad3e95aeb2d1f4ac6307adeb57?s=128&d=identicon&r=PG&f=1", "display_name": "m. vokhm", "link": "https://stackoverflow.com/users/5210701/m-vokhm"}, "edited": false, "score": 0, "creation_date": 1513512754, "post_id": 47854337, "comment_id": 82673944, "body": "Thanks! That&#39;s exactly what I need. I&#39;ve heard about <code>pack&#47;unpack</code>, even have read the perldoc, but have not understood too much at a glance. You see, Perl is not my speciality :)"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 3, "creation_date": 1513543389, "post_id": 47854337, "comment_id": 82683196, "body": "Or just: <code>say unpack H*&#39;, pack &#39;d&#39;, 0.15;</code>"}], "tags": [], "owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "is_accepted": true, "score": 10, "last_activity_date": 1513507873, "creation_date": 1513507873, "answer_id": 47854337, "question_id": 47854212, "link": "https://stackoverflow.com/questions/47854212/how-do-i-convert-a-floating-point-number-into-a-hex-string-in-perl/47854337#47854337", "title": "How do I convert a floating-point number into a hex string in Perl?", "body": "<p>Perl's <a href=\"http://perldoc.perl.org/functions/pack.html\" rel=\"noreferrer\">pack()</a> and <a href=\"http://perldoc.perl.org/functions/unpack.html\" rel=\"noreferrer\">unpack()</a> functions allow you to cast binary representations back and forth.</p>\n\n<pre><code>my $double_bits = unpack \"Q\", pack \"d\", 0.15;\nprintf \"%x\\n\", $double_bits;\n# Output: 3fc3333333333333\n</code></pre>\n\n<p>The <code>pack \"d\"</code> packs a double as its binary representation. With <code>unpack \"Q\"</code> we unpack this bit pattern as an unsigned 64-bit integer. So this reinterprets/casts the bit pattern of a double to an integer, which we can then output with hex digits.</p>\n\n<p>Perl also has a formatting option to display hexadecimal floating point:</p>\n\n<pre><code>printf \"%a\\n\", 0.15;\n# Output: 0x1.3333333333333p-3\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 5210701, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f87a03ad3e95aeb2d1f4ac6307adeb57?s=128&d=identicon&r=PG&f=1", "display_name": "m. vokhm", "link": "https://stackoverflow.com/users/5210701/m-vokhm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "accepted_answer_id": 47854337, "answer_count": 1, "score": 8, "last_activity_date": 1513507873, "creation_date": 1513506718, "question_id": 47854212, "link": "https://stackoverflow.com/questions/47854212/how-do-i-convert-a-floating-point-number-into-a-hex-string-in-perl", "title": "How do I convert a floating-point number into a hex string in Perl?", "body": "<p>To be quite certain that my calculations are correct for all cases, I want to see the result (a double precision number) as a hex or binary string. How can I get a hex/binary string or a byte representation of this number in <code>Perl</code>? In <code>Java</code>, I could use, for instance,  </p>\n\n<pre><code>double d = performMyCalculations();\nSystem.out.format(\"%x\\n\", Double.doubleToLongBits(d));  \n</code></pre>\n\n<p>for this purpose, and it will print <code>3fc3333333333333</code> for <code>0.15</code>. How can I get a similar result in <code>Perl</code>? </p>\n"}, {"tags": ["perl", "yaml", "difference"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1513415379, "post_id": 47841786, "comment_id": 82652328, "body": "The whitespace in YAML is important, but how much of it there is is not, as long as it&#39;s consistent. You should really use a YAML parser. I assume you are not only new to Perl, but also new to programing, so here&#39;s some advice from a veteran in both. Programming is solving problems. If the problem seems to hard, try to break it down into smaller pieces. In your case, you want to compare data. First, you need to get it. YAML is serialization format. Deserialize it to put it into a data structure that Perl likes. Then compare. Now you have two smaller problems that are easier to tackle."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513415627, "post_id": 47841786, "comment_id": 82652398, "body": "In addition to that, your desired output shows errors or mismatches (with a difference in whitespace, please <i>be consistent</i> and <a href=\"https://stackoverflow.com/posts/47841786/edit\">edit</a> that), but your actual program deals with matches. That&#39;s not really not working, but rather doing something entirely different that you told it to. You&#39;re probably still in the process of getting to the right thing and got stuck. Please tell us where you got stuck. How were you thinking to get to the solution, why are you now stuck at this particular step?"}, {"owner": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513417838, "post_id": 47841786, "comment_id": 82652887, "body": "Thank you so much for giving some very important basic information. :) I am stuck at the point after i do the if condition. if condition checks for the for the matching module in both the files. Once i get the matching modules, i want to increment a line and compare the next line for  their version. Then print the modules that are present in both the file with different versions."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513430274, "post_id": 47841786, "comment_id": 82656123, "body": "You say you&#39;re trying to compare two files according to some rules, but all you have written is <code>$line1[$i] =~ $line2[$j]</code>. Surely you can&#39;t expect that to ignore commented lines and compare the versions of matching modules? You really need to make an attempt at writing some code before we can help you with it."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513421519, "post_id": 47844311, "comment_id": 82653777, "body": "Thank you so much for such a clear explanation! it helps me a lot. I tried the code you gave here but i dont see anything printing! i tried inserting other say statements through out the code, it all got printed but the say commands after &quot;foreach&quot; condition doesnt  not print! :("}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513421573, "post_id": 47844311, "comment_id": 82653789, "body": "@user3798648 are the files there? Did you install the YAML module?"}, {"owner": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513422552, "post_id": 47844311, "comment_id": 82654049, "body": "Yes, the files are there. But i am sure if the YAML is installed. If it is not installed, shouldn&#39;t i be getting error when executing the file?"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513425685, "post_id": 47844311, "comment_id": 82654872, "body": "@user3798648 yeah in theory you should. Do <code>perl -MYAML\\ 99</code> on the command line. What does it say? Do you get any other errors? Did you check if the <code>$file1</code> and <code>$file2</code> variables are set? Are the keys <i>Modules</i> and <i>PATH</i> the same in the files?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513430639, "post_id": 47844311, "comment_id": 82656222, "body": "You&#39;re assuming that there is only a single module per language, but that is not the nature of modules. I think the OP needs to split each <code>PATH</code> into <code>my ( $module, $version ) = $path =~ m|(.*)&#47;(.*)|</code> and compare <code>$version</code> if <code>$path</code> matches."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513430717, "post_id": 47844311, "comment_id": 82656250, "body": "@Borodin that&#39;s entirely possible. But they only gave us this example, so I worked with it."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513430904, "post_id": 47844311, "comment_id": 82656310, "body": "Sure, but in the example <code>$module</code> is always the same for a given language, so either interpretation would work. I guess we&#39;ll find out if it&#39;s the wrong guess!"}, {"owner": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513566820, "post_id": 47844311, "comment_id": 82688276, "body": "This is what it says: perl -MYAML\\ 99 YAML version 99 required--this is only version 0.84. BEGIN failed--compilation aborted. Is there a way to do this script without using YAML?"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513580769, "post_id": 47844311, "comment_id": 82691990, "body": "@user3798648 we just proved you have a recent version of YAML. It must be something else. Is there really no error message? Are your files exactly like the ones you showed on the question? ."}, {"owner": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513624807, "post_id": 47844311, "comment_id": 82715422, "body": "No, there is no error message! and i tried dumping the contents with Dumper, it works."}, {"owner": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 1, "creation_date": 1513643914, "post_id": 47844311, "comment_id": 82722925, "body": "Its working :) I had my &quot;Modules&quot; is full caps . Once i changes that, it worked :) Thank you so much @simbabque, i really learnt some useful stuff :)"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "edited": false, "score": 0, "creation_date": 1513674711, "post_id": 47844311, "comment_id": 82732532, "body": "@user3798648 you&#39;re welcome. Probably the most important lesson you learned is that in programming tiny details matter. :-) Please have a look at <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to see what to do here on Stack Overflow when someone answers your question. Thanks."}], "tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": true, "score": 4, "last_activity_date": 1513417088, "creation_date": 1513417088, "answer_id": 47844311, "question_id": 47841786, "link": "https://stackoverflow.com/questions/47841786/read-two-yaml-files-and-compare-the-modules-that-appear-in-both/47844311#47844311", "title": "Read two YAML files and compare the modules that appear in both", "body": "<p>There is technically not really anything wrong with your program, so I am not going to offer a fix or an explanation. You wrote different code than what you were trying to solve.</p>\n\n<p>Instead, I will show you a different approach, step by step. First, remember that YAML is a data structure description. You can read that into Perl and convert it to a native data structure that Perl understands, instead of working with text comparison. Both your files have a similar structure, which makes this very simple.</p>\n\n<p>Reading a data structure and converting it to a different format is hard. Luckily, one of Perl's many strengths is that a lot of problems have been solved already, and are available on the CPAN.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse YAML 'LoadFile';\n\nmy $file1 = LoadFile('file1.yml');\nmy $file2 = LoadFile('file2.yml');\n</code></pre>\n\n<p>This program will read both your files and convert the YAML data structures inside to Perl hash references using <a href=\"https://metacpan.org/pod/distribution/YAML/lib/YAML.pod#LoadFile(filepath)\" rel=\"nofollow noreferrer\"><code>LoadFile</code> from the YAML module</a>.</p>\n\n<p>On its own that is of course not very useful. So let's check what these structures look like. <a href=\"https://metacpan.org/pod/Data::Dumper\" rel=\"nofollow noreferrer\">Data::Dumper</a> is very useful for that, and it comes with your Perl installation. (Personally I would use <a href=\"https://metacpan.org/pod/Data::Printer\" rel=\"nofollow noreferrer\">Data::Printer</a>, as I consider the output more readable, but that's up to you).</p>\n\n<pre><code>use Data::Dumper;\n\nprint Dumper $file1;\nprint Dumper $file2;\n</code></pre>\n\n<p>This will show us:</p>\n\n<pre><code>$VAR1 = {\n          'Modules' =&gt; {\n                       'java' =&gt; {\n                                 'PATH' =&gt; '/cfg/java/version-2.157'\n                               },\n                       'c' =&gt; {\n                              'PATH' =&gt; '/cfg/c/release-1.2.0'\n                            },\n                       'c++' =&gt; {\n                                'PATH' =&gt; '/cfg/c++/release-1.1.5'\n                              },\n                       'python' =&gt; {\n                                   'PATH' =&gt; '/cfg/python/verison-1.0'\n                                 }\n                     }\n        };\n$VAR1 = {\n          'Modules' =&gt; {\n                       'c' =&gt; {\n                              'PATH' =&gt; '/cfg/c/release-1.2.0'\n                            },\n                       'java' =&gt; {\n                                 'PATH' =&gt; '/cfg/java/version-2.161'\n                               },\n                       'python' =&gt; {\n                                   'PATH' =&gt; '/cfg/python/verison-1.1'\n                                 },\n                       'eclipse' =&gt; {\n                                    'PATH' =&gt; '/cfg/eclipse/version-4.5'\n                                  }\n                     }\n        };\n</code></pre>\n\n<p>Notice how the keys are not in the same order they were in the files. That's because hashes in Perl are <em>unordered</em>. That's a feature. To get output that is consistently the same, we need to <a href=\"http://perldoc.perl.org/functions/sort.html\" rel=\"nofollow noreferrer\"><code>sort</code></a> those keys later on.</p>\n\n<p>So we see that both structures have a key <em>Modules</em>. Inside, there is another hash reference, that has the languages as keys, and in each of those, there is another hash reference with exactly one <em>PATH</em> key and a value. We are interested in the value of each <em>PATH</em> for every language.</p>\n\n<p>To get the languages, we iterate the <code>keys</code> of the <em>Modules</em> of one of the two files. We can then compare the values all the way down. If they are <a href=\"http://perldoc.perl.org/functions/ne.html\" rel=\"nofollow noreferrer\">not equal</a>, we print the error message.</p>\n\n<pre><code>use v5.10; # to get say\n\n# get shortcuts so the lines are not as long\nmy $modules1 = $file1-&gt;{Modules};\nmy $modules2 = $file2-&gt;{Modules};\nforeach my $language (sort keys %{ $file1-&gt;{Modules} }) {\n    if ($modules1-&gt;{$language}-&gt;{PATH} ne $modules2-&gt;{$language}-&gt;{PATH} ) {\n        say \"Error:\";\n        say \"file1.yml - $language: PATH: $modules1-&gt;{$language}-&gt;{PATH}\";\n        say \"file2.yml - $language: PATH: $modules2-&gt;{$language}-&gt;{PATH}\";\n    }\n}\n</code></pre>\n\n<p>I'm using <a href=\"http://perldoc.perl.org/functions/say.html\" rel=\"nofollow noreferrer\"><code>say</code></a> instead of <a href=\"http://perldoc.perl.org/functions/print.html\" rel=\"nofollow noreferrer\"><code>print</code></a>, which attaches a newline at the end for us. The additional variables <code>$modules1</code> and <code>$modules2</code> are just to make the code easier to read, because <code>$file1-&gt;{Modules}-&gt;{$language}-&gt;{PATH}</code> is quite long.</p>\n\n<p>Now if we run our program up to this point, we will get the following output.</p>\n\n<pre><code>Error:\nfile1.yml - c++: PATH: /cfg/c++/release-1.1.5\nfile2.yml - c++: PATH: \nError:\nfile1.yml - java: PATH: /cfg/java/version-2.157\nfile2.yml - java: PATH: /cfg/java/version-2.161\nError:\nfile1.yml - python: PATH: /cfg/python/verison-1.0\nfile2.yml - python: PATH: /cfg/python/verison-1.1\nUse of uninitialized value in string ne at /home/simbabque/code/scratch/scratch.pl line 133.\nUse of uninitialized value in concatenation (.) or string at /home/simbabque/code/scratch/scratch.pl line 136.\n</code></pre>\n\n<p>That's almost what we want, but there are some pesky warnings (because we have <code>use warnings</code> turned on), and there is no value for <em>c++</em>. We need to filter out languages that only exist in one of the two files.</p>\n\n<p>The languages that only exist in <em>file2.yml</em> are already not considered, because we only look at keys from <em>file1.yml</em>. To remove the ones from the first file, we have to check if they <a href=\"http://perldoc.perl.org/functions/exists.html\" rel=\"nofollow noreferrer\"><code>exist</code></a> in the other before we access them.</p>\n\n<pre><code>next unless exists $modules2-&gt;{$language};\n</code></pre>\n\n<p>The <a href=\"http://perldoc.perl.org/functions/unless.html\" rel=\"nofollow noreferrer\"><code>unless</code> keyword</a> is like <code>if (not ...)</code>, and I consider it much easier to read, especially in this very concise <a href=\"https://en.wikipedia.org/wiki/Reverse_Polish_notation\" rel=\"nofollow noreferrer\"><em>post-fix notation</em></a>. Now the program gives the expected output.</p>\n\n<pre><code>Error:\nfile1.yml - java: PATH: /cfg/java/version-2.157\nfile2.yml - java: PATH: /cfg/java/version-2.161\nError:\nfile1.yml - python: PATH: /cfg/python/verison-1.0\nfile2.yml - python: PATH: /cfg/python/verison-1.1\n</code></pre>\n\n<p>Here is the whole thing. Don't forget to remove Data::Dumper from the code, as it has nothing to do in a production program. We were using it solely as a debugging aide.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse YAML 'LoadFile';\n\nmy $file1 = LoadFile('file1.yml');\nmy $file2 = LoadFile('file2.yml');\n\nuse v5.10;\n\n# get shortcuts so the lines are not as long\nmy $modules1 = $file1-&gt;{Modules};\nmy $modules2 = $file2-&gt;{Modules};\nforeach my $language (sort keys %{ $file1-&gt;{Modules} }) {\n    next unless exists $modules2-&gt;{$language};\n    if ($modules1-&gt;{$language}-&gt;{PATH} ne $modules2-&gt;{$language}-&gt;{PATH} ) {\n        say \"Error:\";\n        say \"file1.yml - $language: PATH: $modules1-&gt;{$language}-&gt;{PATH}\";\n        say \"file2.yml - $language: PATH: $modules2-&gt;{$language}-&gt;{PATH}\";\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3798648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68cbb8773768b7ec0d74afc291080e?s=128&d=identicon&r=PG&f=1", "display_name": "user3798648", "link": "https://stackoverflow.com/users/3798648/user3798648"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5400, "favorite_count": 0, "accepted_answer_id": 47844311, "answer_count": 1, "score": 2, "last_activity_date": 1513429870, "creation_date": 1513388211, "last_edit_date": 1513429870, "question_id": 47841786, "link": "https://stackoverflow.com/questions/47841786/read-two-yaml-files-and-compare-the-modules-that-appear-in-both", "title": "Read two YAML files and compare the modules that appear in both", "body": "\n\n<p>I am trying to compare two YAML files as follows</p>\n\n<ul>\n<li><p>Ignore all commented lines</p></li>\n<li><p>If the files have the same modules then compare those modules' versions</p></li>\n<li><p>If the versions are different then print the differences to file <code>output.log</code> and raise an error</p></li>\n</ul>\n\n<h3>file1.yml</h3>\n\n<pre class=\"lang-yaml prettyprint-override\"><code>Modules:\n     python:\n         PATH: /cfg/python/version-1.0\n     c:\n         PATH: /cfg/c/release-1.2.0\n     c++:\n         PATH: /cfg/c++/release-1.1.5\n     java:\n         PATH: /cfg/java/version-2.157\n     #connect:\n     #    PATH: /cfg/connect/release-1.2.3\n</code></pre>\n\n<h3>file2.yml</h3>\n\n<pre class=\"lang-yaml prettyprint-override\"><code>Modules:\n     python:\n         PATH: /cfg/python/version-1.1\n     c:\n         PATH: /cfg/c/release-1.2.0\n     java:\n         PATH: /cfg/java/version-2.161\n     eclipse:\n         PATH: /cfg/eclipse/version-4.5\n     #connect:\n     #    PATH: /cfg/connect/release-1.2.0\n</code></pre>\n\n<h3>Desired output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>Error:\n  File1.yml - python: PATH: /cfg/python/verison-1.0\n  file2.yml - python: PATH: /cfg/python/verison-1.1\nError:\n  file1.yml - java: PATH: /cfg/java/version-2.157\n  file2.yml - java: PATH: /cfg/java/version-2.161\n</code></pre>\n\n<h3>My code</h3>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings;\n\nopen f1, \"file1.yml\" or die \"couldn't open the file: $! \\n \";\nmy @line1 = &lt;f1&gt;;\nclose(f1);\n\nopen f2, \"file2.yml\" or die \"couldn't open the file: $! \\n \";\nmy @line2 = &lt;f2&gt;;\nclose(f2);\n\nopen( OUT, \"&gt;\", \"error.txt\" );\n\nfor ( my $i = 0; $i &lt; @line1; $i++ ) {\n\n    for ( my $j = 0; $j &lt; @line2; $j++ ) {\n\n        if ( $line1[$i] =~ $line2[$j] ) {\n            print OUT \"Match Found: \\n $line1[$i] \\n $line2[$j]\";\n        }\n    }\n}\nclose OUT;    \n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>Match Found:\n    Modules:\n    Modules:\n Match Found:\n    python:\n    python:\n Match Found:\n    c:\n    c: \n Match Found:\n    java:\n    java:\n Match Found:\n    #connect:\n    #connect:\n</code></pre>\n"}, {"tags": ["regex", "perl", "multiline"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513444996, "post_id": 47841701, "comment_id": 82660645, "body": "Is this JSON data?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513454579, "post_id": 47841701, "comment_id": 82663376, "body": "It&#39;s not JSON; it requires quoted strings for keys."}], "answers": [{"tags": [], "owner": {"reputation": 35763, "user_id": 183181, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f6642797870d2dd20e4a5c8df347562c?s=128&d=identicon&r=PG", "display_name": "vol7ron", "link": "https://stackoverflow.com/users/183181/vol7ron"}, "is_accepted": false, "score": -3, "last_activity_date": 1513536722, "last_edit_date": 1513536722, "creation_date": 1513388891, "answer_id": 47841841, "question_id": 47841701, "link": "https://stackoverflow.com/questions/47841701/extract-data-whose-pattern-spans-across-lines-in-perl/47841841#47841841", "title": "Extract data whose pattern spans across lines in Perl", "body": "<p><a href=\"https://regex101.com/r/n2VLSO/2\" rel=\"nofollow noreferrer\">https://regex101.com/r/n2VLSO/2</a></p>\n\n<p><code>/^value\\d+[:\\w ]*\\[\\s*?(\\d+)\\s*?\\]/gm</code></p>\n\n<hr>\n\n<p>I'm not sure why this has garnered so many negative votes without a comment.  This is simple and the answer does not need to be major or super explanatory.  If you don't think it works, run it yourself (<a href=\"https://ideone.com/OPV8no\" rel=\"nofollow noreferrer\">https://ideone.com/OPV8no</a>):</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse 5.014;\nuse strict;\nuse warnings;\n\n# Example of string setup\nmy $str = qq{\nvalue1: [\n\n    2018\n  ],\nvalue2: [              2019\n     ], \n};\n\n# Iterate over string and store desired values\nmy $search_values = [1,2];\nmy $matches = {};\nforeach my $number (@$search_values){\n  if ($str =~ m/^value${number}[:\\w ]*\\[\\s*?(\\d+)\\s*?\\]/gm){\n    $matches-&gt;{qq{value$number}} = $1;\n  }\n}\n\n# Example of result\nuse Data::Dumper;\nsay Dumper($matches);\n</code></pre>\n\n<p>So, <code>$matches-&gt;{'value1'}</code> would yield <code>2018</code></p>\n"}, {"tags": [], "owner": {"reputation": 52821, "user_id": 632407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AfGWW.jpg?s=128&g=1", "display_name": "jm666", "link": "https://stackoverflow.com/users/632407/jm666"}, "is_accepted": false, "score": 1, "last_activity_date": 1513469840, "creation_date": 1513469840, "answer_id": 47851139, "question_id": 47841701, "link": "https://stackoverflow.com/questions/47841701/extract-data-whose-pattern-spans-across-lines-in-perl/47851139#47851139", "title": "Extract data whose pattern spans across lines in Perl", "body": "<p>It looks like as some 'pseudo-json'. Exists the <a href=\"https://metacpan.org/pod/JSON::Relaxed\" rel=\"nofollow noreferrer\">JSON::Relaxed</a> module, which could parse such data. From the docs,</p>\n\n<blockquote>\n  <p>Strings can be quoted with either single or double quotes. Space-less\n  strings are also parsed as strings.</p>\n</blockquote>\n\n<pre><code>use 5.014;\nuse warnings;\nuse JSON::Relaxed 'from_rjson';\n\nmy $rstr = do { local $/; &lt;DATA&gt; };       # load the json-like data\nmy $d = from_rjson( '{' . $rstr . '}' );  # make a hash and parse\n\nsay $d-&gt;{value2}-&gt;[0];  # 2019\n\n__DATA__\nvalue1: [\n\n    2018\n  ],\nvalue2: [              2019\n     ],\n</code></pre>\n\n<p>Of course, the sample data is very small, maybe the full set would not be parseable with the above module.</p>\n"}], "owner": {"reputation": 1, "user_id": 2048662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/279ca6a3b6ba0cc80e4816f8328e2ac0?s=128&d=identicon&r=PG", "display_name": "Eric Schwa Pivnik", "link": "https://stackoverflow.com/users/2048662/eric-schwa-pivnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1513536722, "creation_date": 1513386977, "question_id": 47841701, "link": "https://stackoverflow.com/questions/47841701/extract-data-whose-pattern-spans-across-lines-in-perl", "title": "Extract data whose pattern spans across lines in Perl", "body": "<p>I have a multi-line strings that looks like:</p>\n\n<pre><code>value1: [\n\n    2018\n  ],\nvalue2: [              2019\n     ],\n</code></pre>\n\n<p>how would I grab just the number for value1 between the two square brackets when there could be a variable number of whitespace and newlines surrounding the number?  Is there a easy regex, or should I strip out all the whitespace and then search?</p>\n"}, {"tags": ["arrays", "perl", "file"], "comments": [{"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 2, "creation_date": 1513423422, "post_id": 47840317, "comment_id": 82654279, "body": "I&#39;ve edited both of your code examples to add indentation. You&#39;re welcome, but please do it yourself in the future. Proper indentation is an important tool to help people understand your code. If you&#39;re asking a large group of strangers to read and understand your code, then surely it is only polite to make that as simple as possible for them."}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "reply_to_user": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 1, "creation_date": 1513453314, "post_id": 47840317, "comment_id": 82663031, "body": "Hmm. It&#39;s very kind that you edited your question and now show your working code after you applied @tinita&#39;s proposal. I do understand that you want to share that and tell us &quot;look how I made it working&quot;. But now it&#39;s no longer a question. It already includes an answer. People will try to figure out what&#39;s wrong with your 2nd code snippet and find \u2026 nothing. /// I&#39;m not sure how to handle this. Anybody an idea? @Dave?"}, {"owner": {"reputation": 163, "user_id": 8574255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TW2pg.jpg?s=128&g=1", "display_name": "Pjoern", "link": "https://stackoverflow.com/users/8574255/pjoern"}, "reply_to_user": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1513454696, "post_id": 47840317, "comment_id": 82663403, "body": "Uh, I edited my question because I actually thought it would be polite to show that I appreciated the answer. I can delete the second code example, if its reasonable. @DaveCross: Sure, I&#180;ll look at it."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 1, "creation_date": 1513456314, "post_id": 47840317, "comment_id": 82663854, "body": "@PerlDuck: I think the question is still as clear as it was. And there are still obvious problems in the second code example - for example <code>print $writeto &quot;$fh&quot;</code> is very strange :-)"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513456923, "post_id": 47840317, "comment_id": 82664028, "body": "@Pjoern You added <code>print $writeto &quot;$fh&quot;;</code>.  That prints to <code>$writeto</code> alright, but what it prints is the filehandle <code>$fh</code> itself (evaluating it under <code>&quot;&quot;</code> is not needed and doesn&#39;t change anything.); so it print something like <code>GLOB(0x1820a68)</code>. Instead, read from that input, process the line, and print that to output <code>while(my $line = &lt;$fh&gt;) { process-$line; print $writeto $line; }</code>"}, {"owner": {"reputation": 163, "user_id": 8574255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TW2pg.jpg?s=128&g=1", "display_name": "Pjoern", "link": "https://stackoverflow.com/users/8574255/pjoern"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513458124, "post_id": 47840317, "comment_id": 82664325, "body": "@zdim Your&#180;re right, I&#180;m getting GLOB... as return. Cant get the solution. I&#180;ll look at your answer and try to figure it out."}, {"owner": {"reputation": 163, "user_id": 8574255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TW2pg.jpg?s=128&g=1", "display_name": "Pjoern", "link": "https://stackoverflow.com/users/8574255/pjoern"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513460027, "post_id": 47840317, "comment_id": 82664820, "body": "@zdim Works now! Thanks. Your hint helped finally ..."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513469692, "post_id": 47840317, "comment_id": 82666661, "body": "@Pjoern Great. So .. a <a href=\"https://perldoc.perl.org/perlintro.html#Files-and-I/O\" rel=\"nofollow noreferrer\">filehandle</a> is your &quot;handle&quot; to a resource, in this case a file. To read from a file you normally use <a href=\"https://perldoc.perl.org/perlop.html#I/O-Operators\" rel=\"nofollow noreferrer\"><code>&lt;&gt;</code> operator</a>, as <code>while (my $line = &lt;$fh&gt;) { ... }</code> to read one line at a time or <code>@lines = &lt;$fh&gt;;</code> to get all of them. To print to a file you say <code>print $fh &#39;what-to-print&#39;;</code> When you do <code>print &#39;output&#39;;</code> it goes to the default filehandle, <code>STDOUT</code> (so to the terminal). See the explanation in <a href=\"http://perldoc.perl.org/functions/print.html\" rel=\"nofollow noreferrer\">print</a>."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513480102, "post_id": 47840317, "comment_id": 82668050, "body": "@Pjoern Finally, you actually send a list to <code>print</code> (what may be just one item), like <code>print &#39;this&#39;, &#39;that&#39;, &#39;more&#39;;</code> or <code>print @lines;</code> (same for <code>print $fh LIST;</code>). And normally you&#39;d eventually add a newline, <code>&quot;\\n&quot;</code> (here you need double quotes).  Or, if you say <code>use feature &#39;say&#39;;</code> on top of your program then you can do <code>say @lines;</code> and a newline gets appended."}, {"owner": {"reputation": 163, "user_id": 8574255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TW2pg.jpg?s=128&g=1", "display_name": "Pjoern", "link": "https://stackoverflow.com/users/8574255/pjoern"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513516592, "post_id": 47840317, "comment_id": 82675041, "body": "@zdim Thanks for explanation. I theoretically know about scalars and arrays. But i got confused by using a variable as filename for open file for reading. Now the problem is solved. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 8574255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TW2pg.jpg?s=128&g=1", "display_name": "Pjoern", "link": "https://stackoverflow.com/users/8574255/pjoern"}, "reply_to_user": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 1, "creation_date": 1513422932, "post_id": 47840414, "comment_id": 82654161, "body": "@tinita: Thanks for your answer, with your example I think I can get my code working - although I didn&#180;t understand every detail. My usage of readdir() is the crucial error I think. Thanks for your tips to modern code, too :). I&#180;ve posted my code so far in my question (@Dave Cross). Im working on it."}], "tags": [], "owner": {"reputation": 3269, "user_id": 93745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8F5Wc.jpg?s=128&g=1", "display_name": "tinita", "link": "https://stackoverflow.com/users/93745/tinita"}, "is_accepted": true, "score": 8, "last_activity_date": 1513375192, "creation_date": 1513375192, "answer_id": 47840414, "question_id": 47840317, "link": "https://stackoverflow.com/questions/47840317/perl-open-files-with-variable-in-filename/47840414#47840414", "title": "perl open files with variable in filename", "body": "<p>You have several issues in your code.</p>\n\n<p>The first, causing the error, probably, is that <code>readdir()</code> will return <code>.</code> and <code>..</code> also, but these are directories. So you try to write to <code>directory/.</code>.</p>\n\n<p>Second, your error message contains <code>$!</code>, which is good, but you don't output the filename. Then you would have seen your mistake.</p>\n\n<p>Third, you call a filehandle you open for writing <code>READ</code>.</p>\n\n<p>Also, you should use lexical filehandles nowadays.</p>\n\n<pre><code>use strict;\nuse warnings;\n\nopendir my $dh, \"dir\" or die $!;\n# read all files, not directories\nmy @folderlist = grep { -f \"dir/$_\" } readdir $dh;\nclose $dh;\nmy @sorted_folderlist = sort @folderlist;\n\nforeach my $filename (@sorted_folderlist) {\n    open my $fh, \"&gt;\", \"dir/$filename\" or die \"Could not write to dir/$filename: $!\";\n    print $fh \"foo...\\n\";\n    close $fh;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3432, "user_id": 604642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48daad611ba387f8473b0c1e5792aa3f?s=128&d=identicon&r=PG", "display_name": "shawnhcorey", "link": "https://stackoverflow.com/users/604642/shawnhcorey"}, "edited": false, "score": 0, "creation_date": 1513433995, "post_id": 47840576, "comment_id": 82657185, "body": "<code>glob</code> is the preferred method for scanning a directory; <code>File::Find</code> is preferred for scanning sub-directories too."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 7, "last_activity_date": 1515749022, "last_edit_date": 1515749022, "creation_date": 1513376157, "answer_id": 47840576, "question_id": 47840317, "link": "https://stackoverflow.com/questions/47840317/perl-open-files-with-variable-in-filename/47840576#47840576", "title": "perl open files with variable in filename", "body": "<p>You've got errors and good practices cleared up in <a href=\"https://stackoverflow.com/a/47840414/4653379\">tinita's answer</a>.</p>\n\n<p>I'd like to comment on a possible improvement, of building the file list with full paths to start with.</p>\n\n<ul>\n<li><p>Use <a href=\"http://perldoc.perl.org/functions/map.html\" rel=\"nofollow noreferrer\">map</a> on the output of <code>readdir</code> to add directory to each file, then filter that</p>\n\n<pre><code>my @files = grep { -f } map { \"$dir/$_\" } readdir $dh;\n</code></pre>\n\n<p>or, implementing <a href=\"http://perldoc.perl.org/functions/grep.html\" rel=\"nofollow noreferrer\">grep</a>'s (filtering) functionality in the  <code>map</code> block</p>\n\n<pre><code>my @files = map { my $fp = \"$dir/$_\"; -f $fp ? $fp : () } readdir $dh;\n</code></pre>\n\n<p>Here if <code>$fp</code> isn't <a href=\"https://perldoc.perl.org/functions/-X.html\" rel=\"nofollow noreferrer\"><code>-f</code></a> we return an empty list which gets flattened in output, thus vanishing.</p></li>\n<li><p>Use <a href=\"http://perldoc.perl.org/functions/glob.html\" rel=\"nofollow noreferrer\">glob</a>, which directly gives you the full path <sup>&dagger;</sup></p>\n\n<pre><code>use File::Glob ':bsd_glob';\nmy @files = grep { -f } glob \"$dir/*\";\n</code></pre>\n\n<p>where <a href=\"https://perldoc.perl.org/File/Glob.html\" rel=\"nofollow noreferrer\">File::Glob</a>'s <code>bsd_glob()</code> overrides <code>glob</code> and handles spaces in names nicely.</p></li>\n</ul>\n\n<p>Note a difference: the <code>*</code> in <code>glob</code> does not pick entries that start with dot (<code>.</code>). If you want those as well, change it to <code>glob \"$dir/{*,.*}\"</code>. See linked <code>File::Glob</code> docs.</p>\n\n<hr>\n\n<p><strong>Update</strong> &nbsp; to correct the edit (addition made) to the question, also discussed in comments</p>\n\n<p>Once the full-path filenames have been read into <code>@files</code></p>\n\n<pre><code>foreach my $file (@files) {\n    my $out_file = 'new_' . $file;\n    open my $writeto '&gt;', $outfile or die \"Can't open $outfile: $!\";\n    open my $fh,     '&lt;', $file    or die \"Can't open $file: $!\";\n    while (my $line = &lt;$fn&gt;) {\n        # process $line and build what need be written to the new file\n        my $new_line = ...   \n        print $writeto $new_line;\n    }\n    close $writeto;\n    close $fh;\n}\n</code></pre>\n\n<p>(Or, if the filenames aren't full path build the full path in the <code>open</code> call.)</p>\n\n<p>Filehandles get closed when opened again so you need an explicit <code>close</code> only for the last files.  Then you can declare <code>my ($fh, $writeto);</code> variables before the loop, use <code>open $fh ...</code> (no <code>my</code>), and close the filehandles after it. But then you have those variables outside of <code>foreach</code> scope.</p>\n\n<p>Documentation:</p>\n\n<ul>\n<li><p><a href=\"https://perldoc.perl.org/perlintro.html#Files-and-I/O\" rel=\"nofollow noreferrer\">Files and I/O in perlintro</a></p></li>\n<li><p><a href=\"https://perldoc.perl.org/perlopentut.html\" rel=\"nofollow noreferrer\">perlopentut</a> and \n<a href=\"https://perldoc.perl.org/functions/open.html\" rel=\"nofollow noreferrer\">open</a> (and <a href=\"http://perldoc.perl.org/functions/print.html\" rel=\"nofollow noreferrer\">print</a>)</p></li>\n<li><p><a href=\"https://perldoc.perl.org/perlop.html#I/O-Operators\" rel=\"nofollow noreferrer\"><code>&lt;&gt;</code> operator in perlop</a></p></li>\n</ul>\n\n<hr>\n\n<p><sup>&dagger;</sup> &nbsp; The <code>glob \"$dir/*\"</code> carries the possibility for injection bug, for very particular directory names.\nWhile this can come about only wiht rather unusual names it is safer to use <a href=\"https://perldoc.perl.org/perlre.html#Quoting-metacharacters\" rel=\"nofollow noreferrer\">escape sequence</a></p>\n\n<pre><code>my @files = grep { -f } glob \"\\Q$dir\\E/*\"\n</code></pre>\n\n<p>Since this escapes spaces as well the <code>File::Glob</code> with its <code>bsd_glob()</code> isn't needed.</p>\n"}], "owner": {"reputation": 163, "user_id": 8574255, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TW2pg.jpg?s=128&g=1", "display_name": "Pjoern", "link": "https://stackoverflow.com/users/8574255/pjoern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 0, "accepted_answer_id": 47840414, "answer_count": 2, "score": 5, "last_activity_date": 1515749022, "creation_date": 1513374584, "last_edit_date": 1513423299, "question_id": 47840317, "link": "https://stackoverflow.com/questions/47840317/perl-open-files-with-variable-in-filename", "title": "perl open files with variable in filename", "body": "<p>I try to open a list of files in a folder. Eventually I want to insert a HTML-Snippet in it. So far I can open the folder and read the list in an array. That\u00b4s fine. But when I try to open the files by using a variable as filename, I get an error message every time (\"permission denied\"). No matter if I use $_ or other variations of putting the values of list items in variables. I have found similar questions here, but didnt find the solution so far. Here is my code:</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy ($line);\n\nopendir (FOLDER,\"path/to/folder/./\") or die \"$!\";\nmy @folderlist = readdir(FOLDER);\nmy @sorted_folderlist = sort @folderlist;\nclose(FOLDER);\n\nforeach (@sorted_folderlist) {\n  my $filename = $_;\n  open (READ, \"&gt;\", \"path/to/folder/$filename\") or die \"$!\";\n  # do something\n  close (READ);\n}\n</code></pre>\n\n<p>What is the mistake here? And how would I open files with using a variable as filename?  </p>\n\n<p>Pjoern</p>\n\n<p>Here is my changed code in order to answer 1:</p>\n\n<pre><code>my $dh; \nopendir $dh, \"dir/./\" or die ... \nmy @folderlist = grep { -f \"dir/$_\" } readdir $dh; \nclose $dh; \nmy @sorted_folderlist = sort @folderlist; \n\nforeach my $filename (@sorted_folderlist) { \n  open my $fh, \"&lt;\", \"dir/$filename\" or die ... \n  open my $writeto, \"&gt;\", \"new/$filename\" or die ... \n  print $writeto \"$fh\"; \n  close $fh; \n  close $writeto; \n}\n</code></pre>\n"}, {"tags": ["perl", "bioinformatics", "fasta"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1513371948, "post_id": 47839809, "comment_id": 82643703, "body": "You should start every Perl file with <code>use strict; use warnings;</code>. And don&#39;t use <code>-w</code>; it&#39;s been obsolete since 2000."}, {"owner": {"reputation": 4905, "user_id": 4701887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2f933a5923f4decadfb0775c23c4912?s=128&d=identicon&r=PG", "display_name": "MAPK", "link": "https://stackoverflow.com/users/4701887/mapk"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1513372438, "post_id": 47839809, "comment_id": 82643928, "body": "@melpomene Thanks! I  followed your suggestion and still not getting the right results."}, {"owner": {"reputation": 4905, "user_id": 4701887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2f933a5923f4decadfb0775c23c4912?s=128&d=identicon&r=PG", "display_name": "MAPK", "link": "https://stackoverflow.com/users/4701887/mapk"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1513372600, "post_id": 47839809, "comment_id": 82644000, "body": "@melpomene Use of uninitialized value in concatenation (.) or string at count.pl is the error message."}], "answers": [{"comments": [{"owner": {"reputation": 4905, "user_id": 4701887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2f933a5923f4decadfb0775c23c4912?s=128&d=identicon&r=PG", "display_name": "MAPK", "link": "https://stackoverflow.com/users/4701887/mapk"}, "edited": false, "score": 0, "creation_date": 1513380595, "post_id": 47840843, "comment_id": 82646489, "body": "Thank you so much. How do you aggregate the number of sequences with the same length and the total frequency of each of 4 nucleotides for each sequence length type as shown in the output I have above?"}, {"owner": {"reputation": 52821, "user_id": 632407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AfGWW.jpg?s=128&g=1", "display_name": "jm666", "link": "https://stackoverflow.com/users/632407/jm666"}, "reply_to_user": {"reputation": 4905, "user_id": 4701887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2f933a5923f4decadfb0775c23c4912?s=128&d=identicon&r=PG", "display_name": "MAPK", "link": "https://stackoverflow.com/users/4701887/mapk"}, "edited": false, "score": 1, "creation_date": 1513391212, "post_id": 47840843, "comment_id": 82648188, "body": "@MAPK I haven&#39;t idea about <b>your</b> output from some mysterious <i>big file with many sequences</i> . I can only work with data you provided - and I provided some demo code - for using modules and counting letters. I know nothing about <i>nucleotides</i> and so on..."}], "tags": [], "owner": {"reputation": 52821, "user_id": 632407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AfGWW.jpg?s=128&g=1", "display_name": "jm666", "link": "https://stackoverflow.com/users/632407/jm666"}, "is_accepted": false, "score": 3, "last_activity_date": 1513392819, "last_edit_date": 1513392819, "creation_date": 1513378074, "answer_id": 47840843, "question_id": 47839809, "link": "https://stackoverflow.com/questions/47839809/counting-nucleotide-frequency-using-perl-script/47840843#47840843", "title": "Counting nucleotide frequency using perl script", "body": "<p>Trying do not reinvent the wheel, so, using the <a href=\"https://metacpan.org/release/FAST\" rel=\"nofollow noreferrer\">FAST</a> module, got:</p>\n\n<pre><code>use 5.014;\nuse warnings;\nuse FAST::Bio::SeqIO;\n\nmy $fasta  = FAST::Bio::SeqIO-&gt;new(-file =&gt; \"infile.fasta\", -format =&gt; 'Fasta');\nmy $seqnum=0;\nwhile ( my $seq = $fasta-&gt;next_seq() ) {\n    my $stats;\n    $stats-&gt;{len} = length($seq-&gt;seq);\n    $stats-&gt;{$_}++ for split //, $seq-&gt;seq;\n    say ++$seqnum, \" @$stats{qw(len A C G T)}\";\n}\n</code></pre>\n\n<p>The above, for your demo <code>infile.fasta</code> prints:</p>\n\n<pre><code>1 20 1 5 5 9\n2 19 6 4 6 3\n3 22 4 2 7 9\n4 21 3 5 4 9\n5 23 5 7 5 6\n6 22 6 8 3 5\n7 22 7 7 3 5\n8 22 10 8 3 1\n9 21 9 5 2 5\n10 22 10 8 3 1\n11 21 1 9 2 9\n12 24 8 3 8 5\n13 20 4 4 5 7\n</code></pre>\n\n<p>or the</p>\n\n<pre><code>use 5.014;\nuse warnings;\nuse FAST::Bio::SeqIO;\n\nmy $fasta  = FAST::Bio::SeqIO-&gt;new(-file =&gt; \"file.fasta\", -format =&gt; 'Fasta');\nmy $stats;\nwhile ( my $seq = $fasta-&gt;next_seq() ) {\n    my $len = length($seq-&gt;seq);\n    $stats-&gt;{$len}{count}++;\n    $stats-&gt;{$len}{$_}++ for split //, $seq-&gt;seq;\n}\nsay \"Length $_ ($stats-&gt;{$_}-&gt;{count} times) Letters freq: @{$stats-&gt;{$_}}{qw(A C G T)}\" for sort { $a &lt;=&gt; $b }  keys %$stats;\n</code></pre>\n\n<p>produce:</p>\n\n<pre><code>Length 19 (1 times) Letters freq: 6 4 6 3\nLength 20 (2 times) Letters freq: 5 9 10 16\nLength 21 (3 times) Letters freq: 13 19 8 23\nLength 22 (5 times) Letters freq: 37 33 19 21\nLength 23 (1 times) Letters freq: 5 7 5 6\nLength 24 (1 times) Letters freq: 8 3 8 5\n</code></pre>\n\n<p>and so on...</p>\n"}], "owner": {"reputation": 4905, "user_id": 4701887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2f933a5923f4decadfb0775c23c4912?s=128&d=identicon&r=PG", "display_name": "MAPK", "link": "https://stackoverflow.com/users/4701887/mapk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "closed_date": 1513543741, "answer_count": 1, "score": -3, "last_activity_date": 1513392819, "creation_date": 1513371680, "last_edit_date": 1513372771, "question_id": 47839809, "link": "https://stackoverflow.com/questions/47839809/counting-nucleotide-frequency-using-perl-script", "closed_reason": "Not suitable for this site", "title": "Counting nucleotide frequency using perl script", "body": "<p>I have this perl script below to calculate sequence length and their frequency along with nucleotide frequency(<code>A</code>,<code>T</code>,<code>G</code> and <code>C</code>). This script works fine for a file with large number of sequences, but it does not give the right result for a file of small size like this: </p>\n\n<p><code>infile.fasta</code></p>\n\n<pre><code>&gt;NC_013116_1051_1114\nTTGTCCCTTTGAGTCTCTGG\n&gt;NC_013116_1051_1114\nGCGCAGCCGATATGGATAA\n&gt;NC_013116_1051_1114\nTCGAGACTTTGTAATGTTTGGG\n&gt;NC_013116_1051_1114\nTATTCCACGTCAGGTGCTTTT\n&gt;NC_013116_1051_1114\nTAGAGCCGATTCCAGACTGTTCC\n&gt;NC_013116_1051_1114\nTACAGGACCAAGCTCTTCACTC\n&gt;NC_013116_1051_1114\nCCGTCAAGTTCAGCTCCAATAA\n&gt;NC_013116_6_301\nCCACGCAACGGACAATCAAACA\n&gt;NC_013116_6_301\nGGACACTTCCAACTATAAATA\n&gt;NC_013116_6_301\nCCACGCAACGGACAATCAAACA\n&gt;NC_013116_1051_1114\nGCTCTTCACTCTTCCTCGTCT\n&gt;NC_013116_1051_1114\nTTGGGAAAAAGAAGTTGCTGCAGC\n&gt;NC_013116_1051_1114\nTCGCAGTATCTCTGAAGTTG\n</code></pre>\n\n<p>count.pl</p>\n\n<pre><code>#!/usr/bin/perl -w\n\n#usage ./count.pl infile min_length max_length\n#usage ./count.pl infile 18 34\n\nmy $min_len = $ARGV[1];\nmy $max_len = $ARGV[2];\nmy $read_len = 0;\nmy @lines = (\"header1\",\"sequence\",\"header2\",\"quality\");\nmy @lray = ();\nmy $count = 0;\nmy $total = 0;\nmy $i = 0;\n\nmy @Aray = ();\nmy @Cray = ();\nmy @Gray = ();\nmy @Tray = ();\n\nmy$FN = \"\";\n\nfor ($i=$min_len; $i&lt;=$max_len; $i++){\n   $lray[$i] = 0;\n}\n\nopen (INFILE, \"&lt;$ARGV[0]\") || die \"couldn't open input file!\";\n   while (&lt;INFILE&gt;) {\n      $lines[$count] = $_;\n      chomp($lines[$count]);\n      $count++;\n      if($count eq 4){\n         $read_len = length($lines[1]); \n#         print \"$read_len $lines[1]\\n\";\n         $FN = substr $lines[1], 0, 1;  \n         $lray[$read_len]++;\n         if ($FN eq \"T\") { $Tray[$read_len]++;} \n         else {        \n            if ($FN eq \"A\"){ $Aray[$read_len]++;}\n            else {\n               if ($FN eq \"C\"){ $Cray[$read_len]++;}\n               else {\n                 if ($FN eq \"G\"){ $Gray[$read_len]++;}\n               }   \n            }\n         }           \n         $count = 0;\n      }\n   }\nprint \"length\\tnumber\\tA\\tC\\tG\\tT\\n\";\nfor ($i=$min_len; $i&lt;=$max_len; $i++){\n   print \"$i\\t$lray[$i]\\t$Aray[$i]\\t$Cray[$i]\\t$Gray[$i]\\t$Tray[$i]\\n\";\n}\nexit;\n</code></pre>\n\n<p>This is the type of result I get from a big file with many sequences. </p>\n\n<pre><code>length  number  A   C   G   T\n18  4473    542 710 471 2750\n19  12647   990 1680    1103    8874\n20  31194   3010    3354    2743    22087\n21  61214   6288    7196    5784    41946\n22  128642  14596   11902   12518   89626\n23  65190   6859    6525    7773    44033\n24  10012   611 1401    1112    6888\n25  1406    231 192 435 548\n26  661 169 91  105 296\n27  407 126 81  65  135\n28  602 391 49  68  94\n29  520 54  30  370 66\n30  175 26  93  18  38\n31  156 35  28  29  64\n32  106 22  16  24  44\n33  97  45  17  16  19\n34  0           \n</code></pre>\n\n<p>I would really appreciate if you could help me correct this code. Thanks    </p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1513371106, "post_id": 47839695, "comment_id": 82643353, "body": "My Data looks like :   My Text1 (  some text 2 ) and some text 3;"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1513371744, "post_id": 47839695, "comment_id": 82643621, "body": "Are you not using <code>strict</code> and <code>warnings</code>?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 1, "creation_date": 1513414274, "post_id": 47839695, "comment_id": 82652056, "body": "What have you tried? What problems are you having?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 2, "creation_date": 1513428861, "post_id": 47839695, "comment_id": 82655758, "body": "It sounds like you need just <code>$x =~ s&#47;\\)&#47;)\\n&#47;g</code>"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513438328, "post_id": 47839695, "comment_id": 82658495, "body": "There&#39;s no need to read the entire file into an array before iterating over the lines, and <code>$x</code> is a dreadful identifier for a variable containing a line of text."}], "answers": [{"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 0, "last_activity_date": 1513588412, "creation_date": 1513588412, "answer_id": 47865179, "question_id": 47839695, "link": "https://stackoverflow.com/questions/47839695/perl-adding-new-line-after-parenthesis/47865179#47865179", "title": "perl adding new line after parenthesis", "body": "<p>It gets a little easier if you use the default, <code>$_</code> variable.</p>\n\n<pre><code>foreach (@lines) { # For every record in @lines\n  s/\\)/)\\n/g;      # Replace every \")\" with \")\\n\"\n  print;           # Print the value in $_\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4383989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec895a03ac7a1c2163e723b89cc1f120?s=128&d=identicon&r=PG&f=1", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/4383989/aftab-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1513588412, "creation_date": 1513371069, "question_id": 47839695, "link": "https://stackoverflow.com/questions/47839695/perl-adding-new-line-after-parenthesis", "title": "perl adding new line after parenthesis", "body": "<p>I have a variable that contents a large texts. I want to add a new line whenever the line has a closing parenthesis.  How do I do that?\nThis is what I have now without the new line:</p>\n\n<pre><code>     foreach $x (@lines) {\n     print $x . \"\\n\"; \n     }\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["perl", "combinations"], "answers": [{"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": true, "score": 2, "last_activity_date": 1513372271, "creation_date": 1513372271, "answer_id": 47839902, "question_id": 47838658, "link": "https://stackoverflow.com/questions/47838658/generate-all-combinations-of-up-to-n-digits-including-repeating-digits-in-perl/47839902#47839902", "title": "Generate all combinations of up to N digits, including repeating digits, in Perl", "body": "<p></p>\n\n<p>As its name suggests,\n<a href=\"https://metacpan.org/pod/Algorithm::Permute\" rel=\"nofollow noreferrer\"><code>Algorithm::Permute</code></a>\noffers <em>permutations</em>. There are many mathematical variations on selecting <strong><em>k</em></strong> items from a population of <strong><em>N</em></strong>: with and without replacement, with and without repetition, ignoring order or not</p>\n\n<p>It's hard to be certain, but you probably want\n<a href=\"https://metacpan.org/pod/Algorithm::Combinatorics\" rel=\"nofollow noreferrer\"><code>Algorithm::Combinatorics</code></a></p>\n\n<p>Here's some example code that reproduces at least the part of your expected data that you have shown. It's pretty much the same as <strong>zdim's</strong> solution but there may be something extra useful to you here</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings 'all';\nuse feature 'say';\n\nuse Algorithm::Combinatorics 'variations_with_repetition';\n\nmy @data = 0 .. 2;\n\nfor my $k ( 1 .. @data ) {\n    say @$_ for variations_with_repetition(\\@data, $k);\n}\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>0\n1\n2\n00\n01\n02\n10\n11\n12\n20\n21\n22\n000\n001\n002\n010\n011\n012\n020\n021\n022\n100\n101\n102\n110\n111\n112\n120\n121\n122\n200\n201\n202\n210\n211\n212\n220\n221\n222\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": false, "score": -1, "last_activity_date": 1513491513, "creation_date": 1513491513, "answer_id": 47852699, "question_id": 47838658, "link": "https://stackoverflow.com/questions/47838658/generate-all-combinations-of-up-to-n-digits-including-repeating-digits-in-perl/47852699#47852699", "title": "Generate all combinations of up to N digits, including repeating digits, in Perl", "body": "<pre><code>my @digits = 0..2;\nmy $len = 3;\nmy @combinations = map glob(\"{@{[join ',', @digits]}}\" x $_), 1..$len;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9105016, "user_type": "registered", "profile_image": "https://graph.facebook.com/312267052604085/picture?type=large", "display_name": "Vengant", "link": "https://stackoverflow.com/users/9105016/vengant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 47839902, "answer_count": 2, "score": 0, "last_activity_date": 1513913044, "creation_date": 1513365645, "question_id": 47838658, "link": "https://stackoverflow.com/questions/47838658/generate-all-combinations-of-up-to-n-digits-including-repeating-digits-in-perl", "title": "Generate all combinations of up to N digits, including repeating digits, in Perl", "body": "<p>What's the best way to generate all combinations of 1 to N digits, where digits could be repeated in the combination? E.g, given array 0..2, the result should be:</p>\n\n<p>0<br>\n1<br>\n2<br>\n00<br>\n01<br>\n02<br>\n10<br>\n11<br>\n12<br>\n20<br>\n21<br>\n22<br>\n000<br>\n001<br>\n002<br>\n010<br>\n011<br>\netc.<br></p>\n\n<p>I've played with Algorithm::Permute, but it looks likt it could generate just unique combinations of N numbers:</p>\n\n<pre><code>for( my $a = 0; $a &lt; 3; $a++ ) {\n        for( my $b = 0; $b &lt; 3; $b++ ) {\n                my @array = $a..$b;\n                Algorithm::Permute::permute {\n                        my $Num = join(\"\", @array);\n                        print $Num;\n                        sleep 1;\n                } @array;\n        }\n}\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["mysql", "perl", "sql-delete", "dbi"], "comments": [{"owner": {"reputation": 3269, "user_id": 93745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8F5Wc.jpg?s=128&g=1", "display_name": "tinita", "link": "https://stackoverflow.com/users/93745/tinita"}, "edited": false, "score": 1, "creation_date": 1513368882, "post_id": 47838024, "comment_id": 82642451, "body": "I can&#39;t see a mistake in the code. Can you do a <code>SELECT</code> after the delete with the same arguments to see if you still get the row that should have been deleted?"}, {"owner": {"reputation": 2496, "user_id": 2469275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7EZh.png?s=128&g=1", "display_name": "janh", "link": "https://stackoverflow.com/users/2469275/janh"}, "edited": false, "score": 4, "creation_date": 1513374428, "post_id": 47838024, "comment_id": 82644697, "body": "That code will not run, you&#39;re missing a semicolon on the line containing the SQL statement (try to copy paste code, don&#39;t build it in the editor here, or you might leave out important stuff). Maybe try to build a minimal test case including the create table so we can reproduce the problem."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 4, "creation_date": 1513432732, "post_id": 47838024, "comment_id": 82656809, "body": "Are you certain that you&#39;re not doing this within a transaction that hasn&#39;t yet been committed? What is the value of <code>$dbh-&gt;{AutoCommit}</code>?"}, {"owner": {"reputation": 1523, "user_id": 4204037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab78fa882cbf4a03c4fd2a0b92622dc5?s=128&d=identicon&r=PG&f=1", "display_name": "bytepusher", "link": "https://stackoverflow.com/users/4204037/bytepusher"}, "edited": false, "score": 0, "creation_date": 1513457500, "post_id": 47838024, "comment_id": 82664172, "body": "Are there any triggers defined?"}, {"owner": {"reputation": 190, "user_id": 2469173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C3JHo.jpg?s=128&g=1", "display_name": "Arties", "link": "https://stackoverflow.com/users/2469173/arties"}, "edited": false, "score": 3, "creation_date": 1513520585, "post_id": 47838024, "comment_id": 82676181, "body": "@ Borodin, thanks there was my mistake! $dbh-&gt;{AutoCommit} was 0, so a $dbh-&gt;commit() after the $dbh-&gt;do(...) was needed and now it works.  @jahn, you don&#39;t need a semicolon for a single sql-statment with Perl/DBI"}, {"owner": {"reputation": 6468, "user_id": 293652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820308d5db420d7f0e1d0ba97e09f520?s=128&d=identicon&r=PG", "display_name": "Grant McLean", "link": "https://stackoverflow.com/users/293652/grant-mclean"}, "edited": false, "score": 1, "creation_date": 1513542183, "post_id": 47838024, "comment_id": 82682842, "body": "@Arties you do need a semicolon on the end of the line that starts <code>my $sql_query = ...</code> (after the closing quote). The code you provided is obviously not <i>exactly</i> the code you&#39;re running because it has a syntax error and wouldn&#39;t even run. Which meant that before someone could help you they first had to debug that unrelated problem."}], "owner": {"reputation": 190, "user_id": 2469173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C3JHo.jpg?s=128&g=1", "display_name": "Arties", "link": "https://stackoverflow.com/users/2469173/arties"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1513371074, "creation_date": 1513362727, "last_edit_date": 1513371074, "question_id": 47838024, "link": "https://stackoverflow.com/questions/47838024/perl-dbi-mysql-delete-statement-with-strange-effect", "title": "perl DBI MySQL Delete Statement with strange effect", "body": "<p>I have a very strange effect when trying to delete a row of a MySQL table.</p>\n\n<p>The table relPartner has the following structure:</p>\n\n<pre><code>|-------------------------------------------|\n| id | keyArtikel | keyPartner | Date       |\n|.....................................------|\n|  1 |      19670 |        116 | 2017-06-25 |\n|  2 |      17942 |        116 | 2017-06-25 |\n|  3 |      19416 |        116 | 2017-06-25 |\n|  4 |      12286 |        116 | 2017-06-26 |\n|  5 |      19848 |        127 | 2017-06-26 |\n|  6 |      12968 |        127 | 2017-06-26 |\n|  7 |      19859 |        127 | 2017-12-15 |\n|  8 |      17942 |        119 | 2017-12-15 |\n|  9 |      19678 |        119 | 2017-12-15 |\n|-------------------------------------------|\n</code></pre>\n\n<p>The relevant perl code snippet:</p>\n\n<pre><code>my $relPartner = 9; # for testing try to delete row with id 9\n\nmy $data-&gt;{Result} = 'Success'; # Ajax Response\n\nmy $sql_query = 'DELETE FROM relPartner WHERE id = ?'\n\nmy $in = $dbh-&gt;do( $sql_query, undef, $relPartner );\n\nif ((!defined ($in)) || (!$in)) {  \n    $data-&gt;{Result} = 'Failed' \n} else {\n    $data-&gt;{data}-&gt;{affectedRows} = $in;\n    $data-&gt;{data}-&gt;{relPartner} = $relPartner;\n}\n</code></pre>\n\n<p>I get the following result</p>\n\n<pre><code>{\n    \"data\":\n        {\n            \"affectedRows\":\"1\",\n            \"relPartner\":\"9\"\n        },\n    \"Result\":\"Success\"\n}\n</code></pre>\n\n<p>And DBI logging the following result:</p>\n\n<pre><code>DEBUG - $do(0) = ['DELETE FROM relPartner WHERE id = ?\n',undef,9];\nDEBUG - affected(0): 1\nDEBUG - disconnect(0)\n</code></pre>\n\n<p>So i thought the row #9 was deleted. But when i look at the table, the row #9 still exists.</p>\n\n<p>I tested it on two different systems MySQL Server Version: 5.5.54-0ubuntu0.12.04.1 and 5.7.20-0ubuntu0.17.04.1 and get on both the same effect/result.</p>\n\n<p>But on other tables the delete command with the same code work like expected.</p>\n\n<p>So i hope anyone have an idea and can explain where my misunderstandig is.</p>\n"}, {"tags": ["perl", "session", "ssh", "nonblocking", "poe"], "comments": [{"owner": {"reputation": 9262, "user_id": 124951, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c46d5911a8fb4ffd5fb8523d56a60de0?s=128&d=identicon&r=PG", "display_name": "salva", "link": "https://stackoverflow.com/users/124951/salva"}, "edited": false, "score": 0, "creation_date": 1513586160, "post_id": 47837582, "comment_id": 82694153, "body": "Set <code>$Net::OpenSSH::debug = -1</code> at the beginning of your script, run it against one of the machines with the wrong password and then append the output to your question here. Also, instead of using <a href=\"https://metacpan.org/pod/POE::Component::OpenSSH\" rel=\"nofollow noreferrer\">POE::Component::OpenSSH</a>, you can follow the instructions given on <a href=\"https://metacpan.org/pod/Net::OpenSSH\" rel=\"nofollow noreferrer\">Net::OpenSSH</a> docs about <a href=\"https://metacpan.org/pod/Net::OpenSSH#AnyEvent-(and-similar-frameworks)\" rel=\"nofollow noreferrer\">how to use it from an event oriented framework</a>."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1513815398, "post_id": 47837582, "comment_id": 82800354, "body": "Perhaps you could pass <code>timeout</code> and <code>kill_ssh_on_timeout</code> arguments in the Net::OpenSSH <code>args</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 7891473, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154651349836848/picture?type=large", "display_name": "Rizwan Qureshi", "link": "https://stackoverflow.com/users/7891473/rizwan-qureshi"}, "is_accepted": true, "score": 0, "last_activity_date": 1513941377, "last_edit_date": 1513941377, "creation_date": 1513940058, "answer_id": 47940295, "question_id": 47837582, "link": "https://stackoverflow.com/questions/47837582/openssh-poe-session-stuck/47940295#47940295", "title": "OpenSSH POE session stuck", "body": "<p>Thanks for the messages. Found the solution myself though. I had to add the <code>timeout</code> when constructing POE::Component::OpenSSH so that it called the _stop event for every session. But the script was still not exiting.</p>\n\n<p>Since POE::Component::OpenSSH is using POE::Component::Generic to spawn blocking Net::OpenSSH process as POE session, I just had to call the <code>shutdown</code> method of POE::Component::Generic for openssh component object that were stuck (bcoz of wrong password or whatever) and all of the sessions ended cleanly and the script exited.</p>\n\n<p>please see the solution below:</p>\n\n<pre><code>$_[HEAP]{'ssh'} = POE::Component::OpenSSH-&gt;new(\n                args =&gt; [user@domain, passwd =&gt; '123', timeout =&gt; 180, async =&gt; 1, master_opts =&gt; [-o =&gt; \"StrictHostKeyChecking=no\"]],\n        );\n</code></pre>\n\n<p>and then when in _stop</p>\n\n<pre><code>my ($kernel, $session, $heap) = @_[KERNEL, SESSION, HEAP];\ndelete $heap-&gt;{wheel};\n$kernel-&gt;alias_remove($heap-&gt;{alias});\n$kernel-&gt;alarm_remove_all();\n$_[HEAP]{'ssh'}-&gt;object-&gt;shutdown;\ndelete($_[HEAP]{'ssh'});\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7891473, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154651349836848/picture?type=large", "display_name": "Rizwan Qureshi", "link": "https://stackoverflow.com/users/7891473/rizwan-qureshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 47940295, "answer_count": 1, "score": 0, "last_activity_date": 1513941377, "creation_date": 1513360722, "last_edit_date": 1513677851, "question_id": 47837582, "link": "https://stackoverflow.com/questions/47837582/openssh-poe-session-stuck", "title": "OpenSSH POE session stuck", "body": "<p>I am doing non-blocking ssh into over 300 radio devices on our network using POE::Component::OpenSSH and a separate POE::Session for every device. The script I have is in working form BUT some of the devices have not been configured with the correct password (we keep same password for all devices for simplicity hence use same password to ssh into every device). Some times the engineers make a mistake and install device with a NON-STANDARD ssh password. In this case if OpenSSH fails to authenticate, then POE::Session gets stuck (_stop never gets called and script never exits). I know its not a pure programmatic problem. We install few devices every day on our network and I cannot count on our engineers to put in the correct password every time. So even if I correct the password on our existing devices, its inevitable to have a devices in future with a wrong password which will cause my process to hang.</p>\n\n<p>I can do $kernel->stop but I dont like that. I would like the session to clear itself. Is there a way to clear the resources/services used by POE::Component::OpenSSH inside the session using a watcher session? Any help is appreciated. Please see my code below.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse POE;\nuse POE::Component::OpenSSH;\nuse POE::Component::Client::Ping;\nuse Data::Dumper;\n\nmy $domain = shift;\nmy @args = ($domain);\nmy $session = POE::Session-&gt;create(\n        args =&gt; \\@args,\n        inline_states =&gt; {\n                _start =&gt; \\&amp;start,\n                configcapture =&gt; \\&amp;configcapture,\n                activecapture =&gt; \\&amp;activecapture,\n                detectdfs =&gt; \\&amp;dfs,\n                pong =&gt; \\&amp;pingresult,\n                handlerror =&gt; \\&amp;handlerror,\n                _stop   =&gt; \\&amp;stop,\n        },\n);\n\nPOE::Kernel-&gt;run();\nexit;\n\nsub start {\n        $_[KERNEL]-&gt;sig( DIE =&gt; 'sig_DIE' );\n        print \"STARTING ... for $_[ARG0] \\n\";\n        $_[HEAP]{'domain'} = $domain;\n\n        my $ssh = POE::Component::OpenSSH-&gt;new(\n                args =&gt; ['user@'.$domain.':6022', passwd =&gt; '123' ],\n        );\n\n        $ssh-&gt;capture({event =&gt; 'configcapture', timeout =&gt; 2},\n                      'cat /tmp/system.cfg | grep radio.1.freq');\n        $ssh-&gt;capture({event =&gt; 'activecapture', timeout =&gt; 2},\n                      '/usr/www/status.cgi');\n        $_[KERNEL]-&gt;delay(detectdfs =&gt; 5);\n}\n\nsub configcapture {\n        $_[HEAP]{'configfreq'} = $_[ARG0]{'result'}[0];\n}\n\nsub activecapture {\n        $_[HEAP]{'activefreq'} = $_[ARG0]{'result'}[0];\n}\n\nsub dfs {\n        if(defined($_[HEAP]{'configfreq'}) &amp;&amp;\n           defined($_[HEAP]{'activefreq'})) {\n                print \"CONFIG: $_[HEAP]{'configfreq'}\\n\";\n                print \"ACTIVE: $_[HEAP]{'activefreq'}\\n\";\n        }\n}\n\nsub stop {\n        my ($self, $output) = @_;\n        print \"Ending Session Here \\n\";\n}\n</code></pre>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 3, "user_id": 8470609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9c7a65ad3927ee46a7e8983f7f9df1?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Inishev", "link": "https://stackoverflow.com/users/8470609/oleg-inishev"}, "reply_to_user": {"reputation": 45481, "user_id": 197758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628da6ba2a6c70e35c009b7e3c3a430a?s=128&d=identicon&r=PG", "display_name": "toolic", "link": "https://stackoverflow.com/users/197758/toolic"}, "edited": false, "score": 0, "creation_date": 1513346632, "post_id": 47833888, "comment_id": 82630870, "body": "I need small example"}, {"owner": {"reputation": 3, "user_id": 8470609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9c7a65ad3927ee46a7e8983f7f9df1?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Inishev", "link": "https://stackoverflow.com/users/8470609/oleg-inishev"}, "reply_to_user": {"reputation": 45481, "user_id": 197758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628da6ba2a6c70e35c009b7e3c3a430a?s=128&d=identicon&r=PG", "display_name": "toolic", "link": "https://stackoverflow.com/users/197758/toolic"}, "edited": false, "score": 0, "creation_date": 1513347861, "post_id": 47833888, "comment_id": 82631578, "body": "Good! that&#39;s what I need"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513432964, "post_id": 47833888, "comment_id": 82656890, "body": "Just <code>print &quot;$&amp;\\n&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 2, "last_activity_date": 1513454669, "last_edit_date": 1513454669, "creation_date": 1513355675, "answer_id": 47836421, "question_id": 47833888, "link": "https://stackoverflow.com/questions/47833888/how-set-found-text-in-variable-in-perl/47836421#47836421", "title": "How set found text in variable in Perl", "body": "<p>Use captures (<code>(...)</code>).</p>\n\n<pre><code>if ( my ($capture) = $x =~ /(NY)/ ) {\n    say $capture;\n}\n</code></pre>\n\n<hr>\n\n<p>By the way, <em>always</em> use <code>use strict; use warnings qw( all );</code>.</p>\n\n<p>The above program also needs <code>use feature qw( say );</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 8470609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9c7a65ad3927ee46a7e8983f7f9df1?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Inishev", "link": "https://stackoverflow.com/users/8470609/oleg-inishev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 47836421, "answer_count": 1, "score": -8, "last_activity_date": 1513454669, "creation_date": 1513346351, "last_edit_date": 1513433184, "question_id": 47833888, "link": "https://stackoverflow.com/questions/47833888/how-set-found-text-in-variable-in-perl", "title": "How set found text in variable in Perl", "body": "<p>I have a text string that I want to search for a word.</p>\n\n<p>I need to set a variable to the word found.</p>\n\n<p>My text is <code>Cat dog Jim NY You</code></p>\n\n<p>My search word is <code>NY</code></p>\n\n<p>I need to put the matched substring into a variable.</p>\n\n<pre><code>#!/usr/bin/perl\n\n$x = \"Cat dog Jim NY You\";\n\nif ( $x=~/NY/ ) {\n    print \"???\\n\";\n}\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 6, "creation_date": 1513345171, "post_id": 47833420, "comment_id": 82630026, "body": "<code>$val = $h{$val} &#47;&#47; -1</code>"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 3, "creation_date": 1513345280, "post_id": 47833420, "comment_id": 82630076, "body": "@Borodin: Oh. Snap :-)"}], "answers": [{"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": true, "score": 6, "last_activity_date": 1513345247, "creation_date": 1513345247, "answer_id": 47833567, "question_id": 47833420, "link": "https://stackoverflow.com/questions/47833420/perl-value-mapping-in-a-perlish-way/47833567#47833567", "title": "Perl: value-mapping in a &quot;perl&#39;ish&quot; way", "body": "<p>I think <code>exists</code> is probably a safer check than <code>defined</code>.</p>\n\n<pre><code>my %translate = (ok =&gt; 1, nok =&gt; 0);\n\n$val = exists $translate{$val} ? $translate{$val} : -1;\n</code></pre>\n\n<p>But if you can be sure that none of the hash values will ever be <code>undef</code>, you can use the \"defined-or\" operator:</p>\n\n<pre><code>$val = $translate{$val} // -1;\n</code></pre>\n"}], "owner": {"reputation": 8001, "user_id": 307297, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/e28FD.png?s=128&g=1", "display_name": "chris01", "link": "https://stackoverflow.com/users/307297/chris01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 47833567, "answer_count": 1, "score": 2, "last_activity_date": 1513345247, "creation_date": 1513344694, "question_id": 47833420, "link": "https://stackoverflow.com/questions/47833420/perl-value-mapping-in-a-perlish-way", "title": "Perl: value-mapping in a &quot;perl&#39;ish&quot; way", "body": "<p>I like to map content from one presentation to another and I am looking for a \"perl'ish\" way to do it.</p>\n\n<p><strong>Sample:</strong></p>\n\n<pre><code>\"ok\" -&gt; 1 \n\"nok\" -&gt; 0 \nelse -&gt; -1\n</code></pre>\n\n<p>My solution is clear but not very elegant. And it is a pain if there are more than 3 possible mappings (0, 1, -1).</p>\n\n<pre><code>my $val = \"ok\";\nif ($val eq \"ok\")\n{\n    $val = 1;\n}\nelsif ($val eq \"nok\")\n{\n    $val = 0;\n}\nelse\n{\n    $val = -1;\n}\n</code></pre>\n\n<p>I can use a hash but I still need to handle the else-part.</p>\n\n<pre><code>$val = \"ok\";\nmy %h = (\"ok\" =&gt; 1, \"nok\" =&gt; 0);\nif (defined ($h {$val})\n{\n    $val = $h {$val};\n}\nelse\n{\n    $val = -1;\n}\n</code></pre>\n\n<p>Any way to do it in a one-liner but still keep it readable??</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["perl", "imagemagick"], "comments": [{"owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 4, "creation_date": 1513335904, "post_id": 47830780, "comment_id": 82624729, "body": "Do you have a multi-core CPU? If so, you could consider parallelising with multiple threads."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513341063, "post_id": 47830780, "comment_id": 82627708, "body": "You can consider switching to <a href=\"https://metacpan.org/pod/Imager\" rel=\"nofollow noreferrer\">Imager</a>, which should be way faster than Image::Magic."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1513341084, "post_id": 47830780, "comment_id": 82627725, "body": "A word on your code, the <code>undef $image</code> is not needed. Your <code>my $image</code> is lexical within the loop and will go out of scope anyway."}, {"owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1513349624, "post_id": 47830780, "comment_id": 82632728, "body": "You could consider using <code>libvips</code> which is extremely fast and less demanding on memory than ImageMagick. For example, to resize a 6000x4000 pixel jpeg to 1500px takes 1.7s with ImageMagick on my iMac, but 0.4s with <code>VipsThumbnail -s 1500 input.jpg</code>"}], "owner": {"user_type": "does_not_exist", "display_name": "user5861285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513335987, "creation_date": 1513335081, "last_edit_date": 1513335987, "question_id": 47830780, "link": "https://stackoverflow.com/questions/47830780/resizing-images-with-perls-imagemagick-in-foreach-loop-is-too-slow", "title": "Resizing images with Perls Image::Magick in foreach loop is too slow", "body": "<p>With Image:Magick from cpan I'm resizing a set of images with foreach:</p>\n\n<pre><code>use Image::Magick;\nmy @files = split(',', $cgi-&gt;param(\"img\"));\n\nforeach my $file (@files) {\n    # do something\n    my $image = Image::Magick-&gt;new;\n    my $x = $image-&gt;Read($file );\n        my ($width, $height, $size, $format) = $image-&gt;Ping($file);\n        my $dimension;\n        if ($width &gt; $height) {\n            $dimension = 'x1500';\n        } else {\n            $dimension = '1500x';\n        }       \n        $x = $image-&gt;Resize(geometry=&gt;$dimension);\n            warn \"$x\" if \"$x\";\n        $x = $image-&gt;Write($destination);\n            warn \"$x\" if \"$x\";\n        undef $image;\n}\n</code></pre>\n\n<p>This will correctly resize the images. But thats takes a long time. Is there a way to speed up this process?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1513324430, "post_id": 47827877, "comment_id": 82618147, "body": "The diagnostic output mentions &quot;line 5&quot;. What&#39;s in the other lines in your script?"}, {"owner": {"reputation": 31, "user_id": 5413692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3794cecf5f1cf9d588b9717bfbc18bb?s=128&d=identicon&r=PG&f=1", "display_name": "Peter V.", "link": "https://stackoverflow.com/users/5413692/peter-v"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1513325983, "post_id": 47827877, "comment_id": 82618863, "body": "Yes, I omitted a few lines, such as:   <code>#!&#47;usr&#47;bin&#47;perl</code>   <code>use strict;</code>   <code>use warnings;</code>"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1513327811, "post_id": 47827877, "comment_id": 82619799, "body": "I&#39;ve got the 4th and the 6th edition here. There is no significant difference in the 6th edition. The <code>&#47;^Fred&#47;</code> has <code>&#47;\\AFred&#47;</code>, and it&#39;s <code>use 5.010001</code>."}, {"owner": {"reputation": 31, "user_id": 5413692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3794cecf5f1cf9d588b9717bfbc18bb?s=128&d=identicon&r=PG&f=1", "display_name": "Peter V.", "link": "https://stackoverflow.com/users/5413692/peter-v"}, "edited": false, "score": 0, "creation_date": 1513328413, "post_id": 47827877, "comment_id": 82620087, "body": "So you also tend to think that given example is incorrect?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513328458, "post_id": 47827877, "comment_id": 82620116, "body": "I get the same behavior, which is correct; the <code>&#39;Fred&#39;</code> needs an exact string (true for <code>&#39;Fred&#39;</code> not for <code>&#39;Frede&#39;</code>), it&#39;s not a regex match.  Is that the question?"}, {"owner": {"reputation": 31, "user_id": 5413692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3794cecf5f1cf9d588b9717bfbc18bb?s=128&d=identicon&r=PG&f=1", "display_name": "Peter V.", "link": "https://stackoverflow.com/users/5413692/peter-v"}, "edited": false, "score": 0, "creation_date": 1513328809, "post_id": 47827877, "comment_id": 82620333, "body": "Can you please explain why the default block is runs?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 1, "creation_date": 1513328902, "post_id": 47827877, "comment_id": 82620383, "body": "@PeterV. If you are asking me -- because <code>&#39;Fred&#39;</code> is not <code>Frederick</code> (while <code>&#47;Fred&#47;</code> would be a regex so it would <i>match</i> it) so it falls through"}, {"owner": {"reputation": 31, "user_id": 5413692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3794cecf5f1cf9d588b9717bfbc18bb?s=128&d=identicon&r=PG&f=1", "display_name": "Peter V.", "link": "https://stackoverflow.com/users/5413692/peter-v"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513329412, "post_id": 47827877, "comment_id": 82620675, "body": "@zdim I think I understood, - it&#39;s because the default block is really a when a condition which is always true."}, {"owner": {"reputation": 793701, "user_id": 19068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d3229ed1961d2bd81853242493247?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/19068/quentin"}, "edited": false, "score": 1, "creation_date": 1513329997, "post_id": 47827877, "comment_id": 82621007, "body": "Learning Perl 5th edition was written for Perl 5.10. <code>given</code>/<code>when</code> has changed a lot since then. 7th edition covers up to Perl 5.24."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 793701, "user_id": 19068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d3229ed1961d2bd81853242493247?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/19068/quentin"}, "edited": false, "score": 2, "creation_date": 1513364798, "post_id": 47827877, "comment_id": 82640686, "body": "@Quentin, That&#39;s not true. Not only does the OP&#39;s program produce the same output in 5.10.1 and 5.26.0 (except for the experimental warnings), I&#39;m pretty sure the only changes to <code>given</code>/<code>when</code> since 5.10.1 is the addition of experimental warnings, and that <code>given</code> now localizes and sets the global $_ instead of creating and setting a lexical $_ (since lexical $_ no longer exists)."}], "answers": [{"tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 5, "last_activity_date": 1556125597, "last_edit_date": 1556125597, "creation_date": 1513329495, "answer_id": 47829161, "question_id": 47827877, "link": "https://stackoverflow.com/questions/47827877/given-when-statement-doesnt-work-properly-learning-perl-chapter-15-issue/47829161#47829161", "title": "given - when statement doesn&#39;t work properly (&#39;Learning Perl&#39; Chapter 15 issue)", "body": "<p>First, while exploration and play is good I must repeat what <a href=\"https://perldoc.perl.org/perlsyn.html#Experimental-Details-on-given-and-when\" rel=\"nofollow noreferrer\">perlsyn says</a></p>\n\n<blockquote>\n  <p>As previously mentioned, the \"switch\" feature is considered highly\n    experimental; it is subject to change with little notice.</p>\n</blockquote>\n\n<p>If that isn't enough, here is a bit more, earlier <a href=\"https://perldoc.perl.org/perlsyn.html#Switch-Statements\" rel=\"nofollow noreferrer\">in perlsyn</a></p>\n\n<blockquote>\n  <p>Exactly what the <em>EXPR</em> argument to <code>when</code> does is hard to describe\n      precisely, but in general, it tries to guess what you want done. Sometimes\n      it is interpreted as <code>$_ ~~ EXPR</code>, and sometimes it does not. It also\n      behaves differently when lexically enclosed by a <code>given</code> block than it\n      does when dynamically enclosed by a <code>foreach</code> loop. The rules are far too\n      difficult to understand to be described here. See <a href=\"https://perldoc.perl.org/perlsyn.html#Experimental-Details-on-given-and-when\" rel=\"nofollow noreferrer\">Experimental Details on\n      given and when</a> later on.</p>\n</blockquote>\n\n<p>I don't know what to think about a feature which \"<em>is hard to describe precisely</em>.\" Also note that \"<em>Most of the power comes from the implicit smartmatching</em>\" (same page). What matters is that it seems crystal clear that this <em>will</em> change, and very likely significantly.</p>\n\n<p>Having cleared that up, the behavior you show is expected. From the <a href=\"https://perldoc.perl.org/perlsyn.html#Experimental-Details-on-given-and-when\" rel=\"nofollow noreferrer\">example in perlsyn</a></p>\n\n<blockquote>\n<pre><code>given ($foo) {\n    when (undef) {\n        say '$foo is undefined';\n    }\n    when (\"foo\") {\n       say '$foo is the string \"foo\"';\n    }\n    ...\n}\n</code></pre>\n</blockquote>\n\n<p>where <code>$foo</code> need be <em>equal to</em> the string <code>\"foo\"</code>, not matched by it; this isn't a regex match but string equality.</p>\n\n<p>In  your examples the <em>string</em> <code>'Fred'</code> <em>is not equal</em> to <code>Frederick</code>. In the second one there is that <code>continue</code> so it does go to the next branch, but in the first one there isn't (while it's also last before <code>default</code>). Run the program with input <code>Fred</code> to see.</p>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 1, "last_activity_date": 1513498721, "last_edit_date": 1513498721, "creation_date": 1513363626, "answer_id": 47838223, "question_id": 47827877, "link": "https://stackoverflow.com/questions/47827877/given-when-statement-doesnt-work-properly-learning-perl-chapter-15-issue/47838223#47838223", "title": "given - when statement doesn&#39;t work properly (&#39;Learning Perl&#39; Chapter 15 issue)", "body": "<p>Without <code>continue</code>, <code>when</code> and <code>default</code> exit the surrounding <code>given</code> or move to the next item of the surrounding <code>for</code>.</p>\n\n<p>With <code>continue</code>, execution proceeds with the next statement.</p>\n\n<p>The <code>default</code> block is unconditionally executed when reached. </p>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>given ($ARGV[0]) {\n    say \"Checking for 'x'\";\n    when (/x/) { say 'contains an x'; continue; }\n    say \"Checking for 'y'\";\n    when (/y/) { say 'contains a y';            }\n    default    { say 'does not contain a y';    }\n}\n</code></pre>\n\n<p>For <code>y</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Checking for 'x'\nChecking for 'y'\ncontains a y\n</code></pre>\n\n<p>For <code>x</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Checking for 'x'\ncontains an x\nChecking for 'y'\ndoes not contain a y\n</code></pre>\n\n<p>For <code>xy</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Checking for 'x'\ncontains an x\nChecking for 'y'\ncontains a y\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5413692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3794cecf5f1cf9d588b9717bfbc18bb?s=128&d=identicon&r=PG&f=1", "display_name": "Peter V.", "link": "https://stackoverflow.com/users/5413692/peter-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 47838223, "answer_count": 2, "score": 0, "last_activity_date": 1556125597, "creation_date": 1513323944, "question_id": 47827877, "link": "https://stackoverflow.com/questions/47827877/given-when-statement-doesnt-work-properly-learning-perl-chapter-15-issue", "title": "given - when statement doesn&#39;t work properly (&#39;Learning Perl&#39; Chapter 15 issue)", "body": "<p>The example of using the given-when statement presented in chapter 15 of the  \"Learning Perl\" book does not work properly.\nI'm using Perl v5.22.1. and I tried to reproduce the following code (see \"Learning Perl\", fifth edition, page 227.):</p>\n\n<pre><code>    use 5.010;\n    given ($ARGV[0])\n    {\n       when(/fred/i) {say \"Name has fred in it\"; continue}\n       when(/^Fred/) {say \"Name starts with Fred\"; continue}\n       when('Fred')  {say \"Name is Fred\";}\n       default {say \"I don't see a Fred\"}\n    }\n</code></pre>\n\n<p>When I run the script, I get the following result:</p>\n\n<pre><code>D:\\&gt;Perl D:\\Perl\\Example113.pl Frederick\ngiven is experimental at D:\\Perl\\Example113.pl line 5.\nwhen is experimental at D:\\Perl\\Example113.pl line 7.\nwhen is experimental at D:\\Perl\\Example113.pl line 8.\nwhen is experimental at D:\\Perl\\Example113.pl line 9.\nName has fred in it\nName starts with Fred\nI don't see a Fred\n</code></pre>\n\n<p>As you can see, the default block works contrary to expectations.\nAt the same time if you swap first and last blocks 'when', it is works almost as described in the book:</p>\n\n<pre><code>    use 5.010;\n    given ($ARGV[0])\n    {\n       when('Fred')  {say \"Name is Fred\"; continue}\n       when(/^Fred/) {say \"Name starts with Fred\"; continue}\n       when(/fred/i) {say \"Name has fred in it\"; }\n       default {say \"I don't see a Fred\"}\n    }\n</code></pre>\n\n<p>What gives us the next output:</p>\n\n<pre><code>D:\\&gt;Perl D:\\Perl\\Example113.pl Frederick\ngiven is experimental at D:\\Perl\\Example113.pl line 5.\nwhen is experimental at D:\\Perl\\Example113.pl line 7.\nwhen is experimental at D:\\Perl\\Example113.pl line 8.\nwhen is experimental at D:\\Perl\\Example113.pl line 9.\nName starts with Fred\nName has fred in it\n</code></pre>\n\n<p>Am I doing something wrong or in the book is an incorrect example?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1513290722, "post_id": 47823069, "comment_id": 82608935, "body": "And you&#39;re sure that the query will actually return data, yes? (just making sure ...)"}, {"owner": {"reputation": 2964, "user_id": 4485955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d31f821e9c645e34ff7ee6f729843076?s=128&d=identicon&r=PG&f=1", "display_name": "prgrm", "link": "https://stackoverflow.com/users/4485955/prgrm"}, "reply_to_user": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1513290979, "post_id": 47823069, "comment_id": 82609020, "body": "@AntonH Well if it does not return data then $new_name will not be equal to $row[0], $repeating would be set to 0 and the loop would end. That&#39;s what I think..."}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1513291042, "post_id": 47823069, "comment_id": 82609045, "body": "I meant outside of the program. You&#39;re sure that the database has the right table and the table contains the right data for this query to return a result?"}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513291042, "post_id": 47823069, "comment_id": 82609046, "body": "if the sql doesn&#39;t return data, then the second while loop will never even start"}, {"owner": {"reputation": 2964, "user_id": 4485955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d31f821e9c645e34ff7ee6f729843076?s=128&d=identicon&r=PG&f=1", "display_name": "prgrm", "link": "https://stackoverflow.com/users/4485955/prgrm"}, "reply_to_user": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1513291151, "post_id": 47823069, "comment_id": 82609088, "body": "@AntonH Yes it sure does and the table is correct. I copypasted it from a working statement"}, {"owner": {"reputation": 2964, "user_id": 4485955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d31f821e9c645e34ff7ee6f729843076?s=128&d=identicon&r=PG&f=1", "display_name": "prgrm", "link": "https://stackoverflow.com/users/4485955/prgrm"}, "reply_to_user": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513291174, "post_id": 47823069, "comment_id": 82609094, "body": "@beasy How could I check if something is even return?"}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513291307, "post_id": 47823069, "comment_id": 82609144, "body": "try <code>use Data::Dumper; print Dumper $dbh-&gt;selectall_arrayref($sql_statement);</code>"}, {"owner": {"reputation": 2964, "user_id": 4485955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d31f821e9c645e34ff7ee6f729843076?s=128&d=identicon&r=PG&f=1", "display_name": "prgrm", "link": "https://stackoverflow.com/users/4485955/prgrm"}, "reply_to_user": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513291675, "post_id": 47823069, "comment_id": 82609268, "body": "@beasy shows VAR1 = []"}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 1, "creation_date": 1513291959, "post_id": 47823069, "comment_id": 82609369, "body": "yeah so your SQL satemtent doesn&#39;t return any data. so like I said, the second while loop never starts."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513291878, "post_id": 47823315, "comment_id": 82609344, "body": "<code>$sth-&gt;rows</code> is not guaranteed to be meaningful for <code>SELECT</code> statements. Replace <code>if($sth-&gt;rows == 0) { $repeating = 0; }</code> with <code>last if !$sth-&gt;fetch;  $sth-&gt;finish;</code>"}], "tags": [], "owner": {"reputation": 2496, "user_id": 2469275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7EZh.png?s=128&g=1", "display_name": "janh", "link": "https://stackoverflow.com/users/2469275/janh"}, "is_accepted": true, "score": 2, "last_activity_date": 1513293624, "last_edit_date": 1513293624, "creation_date": 1513291720, "answer_id": 47823315, "question_id": 47823069, "link": "https://stackoverflow.com/questions/47823069/perl-wont-execute-sql-statement-in-a-while-loop/47823315#47823315", "title": "Perl won&#39;t execute SQL statement in a while loop", "body": "<p>The problem is that you won't get any rows back if the name does not exist. The solution is to just check if you do get any rows - otherwise the file name mus be unused. BTW, let DBI escape stuff you sent to the database. This should work:</p>\n\n<pre><code>while ($repeating == 1) {\n        $new_name = $i . \"_\" . $file;\n        # the question marks are placeholders\n        my $sql= \"SELECT file_name FROM PDFdocument WHERE user_id = ? AND file_name = ? \";\n        my $sth = $dbh-&gt;prepare($sql);\n        # filling the placeholders while executing\n        $sth-&gt;execute($id, $new_name); \n        if(!$sth-&gt;fetch) {\n        # no rows found? this name must be fresh\n              $repeating = 0;\n        }\n        $i++;\n    }\n</code></pre>\n\n<p>Edit: As @ikegami mentioned in a comment, the behavior of <code>$sth-&gt;rows</code> depends on the driver, so it might return different values for different database engines when dealing with SELECT statements (see also <a href=\"http://search.cpan.org/~timb/DBI-1.637/DBI.pm#rows\" rel=\"nofollow noreferrer\">the DBI docs</a>. Asking the driver to fetch a row should work the same on all drivers.</p>\n\n<p>Keep in mind that this is susceptible to race conditions, i.e. if two scripts run at the same time, they might both chose the same \"unused\" filename. Make sure you're using some kind of locking mechanism to avoid that.</p>\n"}, {"comments": [{"owner": {"reputation": 2964, "user_id": 4485955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d31f821e9c645e34ff7ee6f729843076?s=128&d=identicon&r=PG&f=1", "display_name": "prgrm", "link": "https://stackoverflow.com/users/4485955/prgrm"}, "edited": false, "score": 0, "creation_date": 1513294971, "post_id": 47823388, "comment_id": 82610261, "body": "I did this for all my queries although there was not risk for injection attack ; there is no user input. Thanks."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 2964, "user_id": 4485955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d31f821e9c645e34ff7ee6f729843076?s=128&d=identicon&r=PG&f=1", "display_name": "prgrm", "link": "https://stackoverflow.com/users/4485955/prgrm"}, "edited": false, "score": 1, "creation_date": 1513295033, "post_id": 47823388, "comment_id": 82610275, "body": "The fact that there&#39;s no user input doesn&#39;t mean there&#39;s no bug. You actually have to make sure the string will never have any special characters. Why go through the extra work of making sure of that (and risking that it changes) instead of always using placeholders (which actually make things more readable)?"}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1513295549, "last_edit_date": 1513295549, "creation_date": 1513292143, "answer_id": 47823388, "question_id": 47823069, "link": "https://stackoverflow.com/questions/47823069/perl-wont-execute-sql-statement-in-a-while-loop/47823388#47823388", "title": "Perl won&#39;t execute SQL statement in a while loop", "body": "<p>When you finally find the <code>$i</code> you should use, <code>$sth-&gt;fetchrow_array</code> returns an empty list, so <code>=</code> returns <code>0</code>, so the loop isn't entered.</p>\n\n<hr>\n\n<p>Solution 1:</p>\n\n<pre><code>my $new_name;\nfor (my $i=1; ; ++$i) {\n   $new_name = $i . \"_\" . $file;\n   $dbh-&gt;selectrow_arrayref(\n      \"SELECT 1 FROM `PDFdocument` WHERE `user_id` = ? AND `file_name` = ?\",\n      undef,\n      $id, $new_name,\n   )\n      and last;\n}\n</code></pre>\n\n<hr>\n\n<p>Solution 2:</p>\n\n<pre><code>my $i = $dbh-&gt;selectrow_array(\n   \"\n      SELECT CAST(LEFT(`file_name`, LOCATE(\"_\", `file_name`)-1) AS INT) AS `i`\n        FROM `PDFdocument`\n       WHERE `user_id` = ?\n         AND `file_name` LIKE ?\n       ORDER BY DESC `i`\n       LIMIT 1\n   \",\n   undef,\n   $id, \"%\\\\_\\Q$file\\E\"\n);\n++$i;\nmy $new_name = $i . \"_\" . $file;\n</code></pre>\n\n<hr>\n\n<p>Note the use of placeholders. Your buggy way of building the SQL statement leaves you vulnerable to malfunctions if not attacks.</p>\n"}], "owner": {"reputation": 2964, "user_id": 4485955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d31f821e9c645e34ff7ee6f729843076?s=128&d=identicon&r=PG&f=1", "display_name": "prgrm", "link": "https://stackoverflow.com/users/4485955/prgrm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 47823315, "answer_count": 2, "score": 0, "last_activity_date": 1513295549, "creation_date": 1513290417, "question_id": 47823069, "link": "https://stackoverflow.com/questions/47823069/perl-wont-execute-sql-statement-in-a-while-loop", "title": "Perl won&#39;t execute SQL statement in a while loop", "body": "<p>I wrote this piece of code: it is supposed to keep checking names until it finds one that does not exist, and then it should go on.</p>\n\n<pre><code> while ($repeating == 1) {\n            $new_name = $i . \"_\" . $file;\n            my $sql= \"SELECT file_name FROM PDFdocument WHERE user_id = '$id' AND file_name = '$new_name' \";\n            my $sth = $dbh-&gt;prepare($sql);\n            $sth-&gt;execute();\n            while (my @row = $sth-&gt;fetchrow_array) {\n                  //never enters here\n                if ($new_name ne $row[0]) {\n\n                    $repeating = 0;\n\n                }\n            }\n            $i++;\n        }\n</code></pre>\n\n<p>It never enters the second <code>while</code> loop, so it gets stuck in this repeating loop. I don't know why it does not work; I do some other sql statements before and they all work. This is the only one that does not work.</p>\n\n<p>Any help?</p>\n"}, {"tags": ["linux", "shell", "perl", "unix"], "comments": [{"owner": {"reputation": 6953, "user_id": 4541045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfffa01cff641ad93fa459b26d3cdb4?s=128&d=identicon&r=PG&f=1", "display_name": "ti7", "link": "https://stackoverflow.com/users/4541045/ti7"}, "edited": false, "score": 0, "creation_date": 1513282052, "post_id": 47821231, "comment_id": 82604984, "body": "You may be able to use logrotate for this."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1513283549, "post_id": 47821231, "comment_id": 82605676, "body": "To create a directory if it does not exist, just do <code>mkdir -p 20171213</code>.  If the directory already exists, it&#39;s a no-op."}, {"owner": {"reputation": 13181, "user_id": 17300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6913044c5e536029098ce2d5c9b841e?s=128&d=identicon&r=PG", "display_name": "Stephen P", "link": "https://stackoverflow.com/users/17300/stephen-p"}, "edited": false, "score": 0, "creation_date": 1513287138, "post_id": 47821231, "comment_id": 82607376, "body": "To periodically run the script, create a <code>cron</code> job (see <code>man 1 crontab</code> - you&#39;ll use <code>crontab -e</code>) ... don&#39;t loop and sleep within the script itself as someone suggested.  You can do a <code>mkdir -p &#47;path&#47;to&#47;$(date +%Y%m%d)</code> to create the dir if it doesn&#39;t already exist (or extract the YYYYMMDD from the filename)."}], "answers": [{"tags": [], "owner": {"reputation": 2576, "user_id": 501011, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/5876A.png?s=128&g=1", "display_name": "MechMK1", "link": "https://stackoverflow.com/users/501011/mechmk1"}, "is_accepted": false, "score": 0, "last_activity_date": 1513282528, "creation_date": 1513282528, "answer_id": 47821363, "question_id": 47821231, "link": "https://stackoverflow.com/questions/47821231/housekeeping-script-to-create-folder-and-move-files/47821363#47821363", "title": "&#39;Housekeeping&#39; script to create folder and move files", "body": "<p>You can use <code>if [ ! -d \"$DIRNAME ]\"</code> to see if a directory called <code>$DIRNAME</code> exists. Further you can use <code>mkdir</code> to create directories.</p>\n\n<p>Alternatively, you can just use <code>mkdir</code> and ignore any error that a directory already exists. Other than that, there are no negative side effects.</p>\n"}, {"tags": [], "owner": {"reputation": 2694, "user_id": 61248, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ee4vJ.jpg?s=128&g=1", "display_name": "JoshuaD", "link": "https://stackoverflow.com/users/61248/joshuad"}, "is_accepted": false, "score": 0, "last_activity_date": 1513282567, "creation_date": 1513282567, "answer_id": 47821370, "question_id": 47821231, "link": "https://stackoverflow.com/questions/47821231/housekeeping-script-to-create-folder-and-move-files/47821370#47821370", "title": "&#39;Housekeeping&#39; script to create folder and move files", "body": "<p>I won't be able to write the script for you because you don't have enough specific information in your post, but here are the tools I think you'll need:</p>\n\n<ul>\n<li><a href=\"https://linuxconfig.org/bash-scripting-tutorial\" rel=\"nofollow noreferrer\">Bash</a> - Bash, for writing your script (<a href=\"https://www.gnu.org/software/bash/manual/html_node/Bash-Conditional-Expressions.html\" rel=\"nofollow noreferrer\">Here's</a> another useful reference)</li>\n<li><a href=\"https://www.unixtutorial.org/commands/mkdir/\" rel=\"nofollow noreferrer\">Mkdir</a> - For making a directory if its missing (look at the -p flag). </li>\n<li><a href=\"http://www.unixgeeks.org/security/newbie/unix/cron-1.html\" rel=\"nofollow noreferrer\">Cron</a> - For scheduling the hourly execution of your script.</li>\n<li><a href=\"http://www.grymoire.com/Unix/Sed.html\" rel=\"nofollow noreferrer\">Sed</a> - For creating the new file names from the old ones</li>\n</ul>\n\n<p>The basic code will look something like this:</p>\n\n<pre><code>#!/bin/bash\nFILES=/home/joshua/photos/sort-me\n\nfor photo in $FILES/*.jpg; do\n    if [[ -f photo ]]; then\n        new_photo_location= #&lt;figure this part out based on your needs&gt;\n        echo \"I would move $photo to $new_photo_location\"\n        #mv $photo $new_photo_location\n    fi\ndone\n</code></pre>\n\n<p>I recommend running it with that echo only until you see exactly what you like, then comment that line out and uncommont the <code>mv</code> line. </p>\n\n<p>Finally, to run the script every hour on the hour, your cron entry will look something like this. (Type <code>crontab -e</code> to edit your crontab):</p>\n\n<pre><code> #   Min   Hour  Day    Month   Day-of-Wk  Year  Must use absolute path\n     0     *     *      *       *          *     /home/joshua/bin/sort-photos.sh\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9100675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4324a549aaa372df7910fe5fb3811465?s=128&d=identicon&r=PG&f=1", "display_name": "wrighty", "link": "https://stackoverflow.com/users/9100675/wrighty"}, "edited": false, "score": 0, "creation_date": 1513629550, "post_id": 47821775, "comment_id": 82717519, "body": "Are you able to tweak it to run as cronjob script rather than a loop? Thanks."}], "tags": [], "owner": {"reputation": 1, "user_id": 3061730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pdnyK.png?s=128&g=1", "display_name": "cbjr84", "link": "https://stackoverflow.com/users/3061730/cbjr84"}, "is_accepted": false, "score": 0, "last_activity_date": 1513340538, "last_edit_date": 1513340538, "creation_date": 1513284401, "answer_id": 47821775, "question_id": 47821231, "link": "https://stackoverflow.com/questions/47821231/housekeeping-script-to-create-folder-and-move-files/47821775#47821775", "title": "&#39;Housekeeping&#39; script to create folder and move files", "body": "<pre><code>VDIR=$( date +%F )\nVFILESFX=Camera*\n[ ! -d $VDIR ] &amp;&amp; mkdir $VDIR\nwhile true ; do\n   LTMP=$( ls $VFILESFX )\n   for i in $LTMP ; do\n        fuser ${i}\n        [ $? -ne 0 ] &amp;&amp; mv $i $VDIR/;\n        echo \"File ${i} moved to ${VDIR}\";\n   done\n   sleep 3600\ndone\n</code></pre>\n\n<p>Just some explanation about this script...\nThe first part set the current date into a variable VDIR and the prefix Camera* into VFILESFX.\nThe conditional command create a directory with the value existent in VDIR if this directory does not exist, after that go to a while command interacting every hour listing all the file with the prefix setted into VFILESFX and moving this files to the directory with the current date</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9100675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4324a549aaa372df7910fe5fb3811465?s=128&d=identicon&r=PG&f=1", "display_name": "wrighty", "link": "https://stackoverflow.com/users/9100675/wrighty"}, "is_accepted": true, "score": 0, "last_activity_date": 1515180471, "creation_date": 1515180471, "answer_id": 48120064, "question_id": 47821231, "link": "https://stackoverflow.com/questions/47821231/housekeeping-script-to-create-folder-and-move-files/48120064#48120064", "title": "&#39;Housekeeping&#39; script to create folder and move files", "body": "<p>I finally went with a perl script which I could more easily trigger from a cron job:</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nuse strict;\nuse Data::Dumper;\nuse File::Copy;\n\nmain();\n\nsub main\n{\n    my $dir = \"/srv/NAS1/Camera1\";\n\n    opendir(my $fh, $dir) or die(\"Could not open '$dir' for reading: $!\\n\");\n\n    my @files = readdir($fh);\n\n    closedir($fh);\n\n    foreach my $file(@files)\n    {\n        if(-d $file)\n        {\n            next; # skip file if its a folder\n        }\n\n        if($file =~ /Camera1_01_(\\d{8})\\d{9}\\.(jpg|mp4)/)\n        {\n            my $date = $1;\n\n            $date =~ /(\\d{4})(\\d{2})(\\d{2})/;\n\n            my $folder = \"$1-$2-$3\";\n\n            # if the directory doesn't exist\n            if(!(-e -d \"${dir}/${folder}\"))\n            {\n                mkdir(\"${dir}/${folder}\");\n            }\n\n            move(\"${dir}/$file\",\"${dir}/${folder}\");\n        }\n    }\n}\n</code></pre>\n\n<p>Thanks for the contributions.</p>\n"}], "owner": {"reputation": 11, "user_id": 9100675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4324a549aaa372df7910fe5fb3811465?s=128&d=identicon&r=PG&f=1", "display_name": "wrighty", "link": "https://stackoverflow.com/users/9100675/wrighty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 48120064, "answer_count": 4, "score": 1, "last_activity_date": 1515180537, "creation_date": 1513281903, "last_edit_date": 1515180537, "question_id": 47821231, "link": "https://stackoverflow.com/questions/47821231/housekeeping-script-to-create-folder-and-move-files", "title": "&#39;Housekeeping&#39; script to create folder and move files", "body": "<p>I have been trying to investigate how to automate a script (shell or other) that periodically (once an hour for example) moves files with a constant naming convention to a folder (which is automatically created if not already there).\nThe files are like this:</p>\n\n<p>Camera1_01_20171213221830928.jpg<br/>\nCamera1_01_20171213223142881.mp4</p>\n\n<p>Basically it will be doing 'housekeeping'.</p>\n\n<p>I'm new to shell scripts, and I just can't work out how to create a folder if it is not there (folder called 20171213 for example), then move the relevant files into it?</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 170445, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1513290465, "post_id": 47820813, "comment_id": 82608844, "body": "Is there any reason you can&#39;t use the copy of Perl that&#39;s already present as part of your OS installation?"}, {"owner": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "reply_to_user": {"reputation": 170445, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1513607475, "post_id": 47820813, "comment_id": 82706235, "body": "@duskwuff this is for a Heroku app, or technically for something like a Heroku app hosted by a company internally. I was advised not to rely on system perl since it can change and in theory break things. The idea behind these sorts of apps is that they&#39;re supposed to be totally self-contained, and that extends to pegging Perl and its libraries to specific versions, with the code owned by the app. One could argue that it&#39;s a bit paranoid, but it is what it is."}], "answers": [{"comments": [{"owner": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "edited": false, "score": 0, "creation_date": 1513289591, "post_id": 47821895, "comment_id": 82608451, "body": "Thanks, that gives me something similar to the download I&#39;m trying to replicate. Do you know, for the -Dprefix value, do I need to make sure it is equal to the directory where I will ultimately place perl, or can it just be any directory where I want the resulting files to be placed in the short term?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "edited": false, "score": 0, "creation_date": 1513289890, "post_id": 47821895, "comment_id": 82608594, "body": "Final destination (though that can be changed if you pass <code>-Duserelocatableinc</code> to <code>Configure</code>). Additionally pass <code>DESTDIR=&#47;staging&#47;dir</code> to <code>make install</code> to place them somewhere else temporarily."}, {"owner": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "edited": false, "score": 0, "creation_date": 1513608351, "post_id": 47821895, "comment_id": 82706829, "body": "Sorry I am quite unfamiliar with this. In my case, I need to build a copy of Perl which will work when placed in several different directories. So are you saying that it would break if I don&#39;t use -Duserelocatableinc, but it should be fine if I do use it?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "edited": false, "score": 1, "creation_date": 1513610615, "post_id": 47821895, "comment_id": 82708256, "body": "Correct. . . . ."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 3, "last_activity_date": 1513804306, "last_edit_date": 1513804306, "creation_date": 1513284964, "answer_id": 47821895, "question_id": 47820813, "link": "https://stackoverflow.com/questions/47820813/how-to-generate-a-copy-of-this-binary-perl-distribution/47821895#47821895", "title": "how to generate a copy of this binary perl distribution", "body": "<blockquote>\n  <p><em>I don't know how to build from source</em></p>\n</blockquote>\n\n<p>This is documented in <a href=\"https://metacpan.org/pod/distribution/perl/INSTALL\" rel=\"nofollow noreferrer\"><code>INSTALL</code></a> in the distribution.</p>\n\n<p>It's quite simple on a unix system:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>cd /tmp\nwget https://cpan.metacpan.org/authors/id/S/SH/SHAY/perl-5.26.1.tar.bz2\ntar xvjf perl-5.26.1.tar.bz2\ncd perl-5.26.1\nsh Configure -des -Dusethreads -Dprefix='/some/dir'\nmake\nmake test\nmake install\n</code></pre>\n\n<p>You might also want to pass <code>-Duserelocatableinc</code> to make the install relocatable.</p>\n\n<p>You can also use <a href=\"https://metacpan.org/pod/distribution/App-perlbrew/bin/perlbrew\" rel=\"nofollow noreferrer\"><code>perlbrew</code></a> or <a href=\"https://github.com/tokuhirom/plenv/releases\" rel=\"nofollow noreferrer\"><code>plenv</code></a> to assist you with installing <code>perl</code> and managing multiple installs of <code>perl</code>.</p>\n"}], "owner": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 47821895, "answer_count": 1, "score": 0, "last_activity_date": 1513804306, "creation_date": 1513279889, "question_id": 47820813, "link": "https://stackoverflow.com/questions/47820813/how-to-generate-a-copy-of-this-binary-perl-distribution", "title": "how to generate a copy of this binary perl distribution", "body": "<p>I'm working with an application that downloads its own copy of Perl from a 3rd party website as a sort of bootstrap. I'd like to get a different copy from a more trusted source like CPAN, but I can't find any precompiled copies of Perl (only full source distributions) and I don't know how to build from source. Is there anywhere I can get a precompiled copy?</p>\n\n<p>Another problem is that I don't know for sure that this download is just \"a compiled copy of Perl\". I'm <em>assuming</em> that, but I don't know what it's supposed to look like.</p>\n\n<p>It comes in a .tar.gz which really only has two directories populated:</p>\n\n<pre><code>/bin (contains perl, cpan, perldoc, enc2xs, etc)\n/lib/5.16.3 (contains subdirectories for various CPAN modules)\n</code></pre>\n\n<p>So to summarize: 1) Is this what Perl looks like when it is compiled? 2) Where can I get a pre-compiled version of Perl for my OS (RHEL 7), or if this isn't possible, how can I best generate a compiled version?</p>\n\n<p>PS: For those who are curious, this is the copy of Perl that is downloaded by Miyagawa's Heroku Perl buildpack (<a href=\"https://github.com/miyagawa/heroku-buildpack-perl\" rel=\"nofollow noreferrer\">https://github.com/miyagawa/heroku-buildpack-perl</a>), which I am using for a project. He downloads copies of Perl stored on a website cache.bulknews.net, which might just be his own hosting, not sure.</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 3, "creation_date": 1513272630, "post_id": 47819049, "comment_id": 82600031, "body": "Should be <code>\\d</code> instead of <code>d</code>."}, {"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 1, "creation_date": 1513273280, "post_id": 47819049, "comment_id": 82600370, "body": "Besides the missing backslash, the RE doesn&#39;t look right -- what output do you expect for <code>12.340123</code>?"}, {"owner": {"reputation": 33, "user_id": 3064085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e091281ca9a2922839692a8c9ac62bc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3064085", "link": "https://stackoverflow.com/users/3064085/user3064085"}, "reply_to_user": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 0, "creation_date": 1513273365, "post_id": 47819049, "comment_id": 82600415, "body": "That was it.  Thank you @Benjamin W.  Here&#39;s the regex from the book: !<a href=\"https://imgur.com/a/fy3zk\" rel=\"nofollow noreferrer\">book excerpt</a>"}, {"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 0, "creation_date": 1513276156, "post_id": 47819049, "comment_id": 82601940, "body": "O&#39;Reilly ebooks often mess up source code, in my experience with them. I always double check the PDF version when in doubt (and it&#39;s available)."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3064085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e091281ca9a2922839692a8c9ac62bc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3064085", "link": "https://stackoverflow.com/users/3064085/user3064085"}, "edited": false, "score": 1, "creation_date": 1513274004, "post_id": 47819209, "comment_id": 82600781, "body": "Thank you that was it  !<a href=\"https://imgur.com/a/fy3zk\" rel=\"nofollow noreferrer\">book image</a>   \u201cPrettifying a Stock Price    always take the first two digits after the decimal point, and take the third digit only if it is not zero. Then, remove any other digits.\u201d"}, {"owner": {"reputation": 38072, "user_id": 46395, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce828f20abb195ef5d971205ee36c27?s=128&d=identicon&r=PG", "display_name": "daxim", "link": "https://stackoverflow.com/users/46395/daxim"}, "edited": false, "score": 0, "creation_date": 1513676715, "post_id": 47819209, "comment_id": 82733780, "body": "This is a <a href=\"http://www.oreilly.com/catalog/errata.csp?isbn=9780596528126#page81\" rel=\"nofollow noreferrer\">known erratum</a>. If you read a technical book, IETF RFC or similar, it is always a good idea to check for errata."}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": true, "score": 1, "last_activity_date": 1513273173, "creation_date": 1513273173, "answer_id": 47819209, "question_id": 47819049, "link": "https://stackoverflow.com/questions/47819049/perl-substitution-example-from-mastering-regular-expressions-book-not-working-fo/47819209#47819209", "title": "Perl substitution example from Mastering Regular Expressions book not working for me", "body": "<p>Your substitution is wrong.</p>\n\n<pre><code>$price =~ s/(\\.\\d\\d[1-9]?)d*/$1/;\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>$price =~ s/(\\.\\d\\d[1-9]?)\\d*/$1/;\n</code></pre>\n\n<p>Your own version matches because <code>d*</code> can match an empty string, which it does because there are no <code>d</code> characters after the third decimal place</p>\n\n<p>It seems odd to insist that any third decimal digit must be non-zero. So <code>0.00</code> is fine, but <code>0.000</code> is not, and will be truncated to the former. Is that what you intended?</p>\n"}, {"tags": [], "owner": {"reputation": 24167, "user_id": 7388477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e42e688ade97076d4fdd1939946e7c7b?s=128&d=identicon&r=PG&f=1", "display_name": "Valdi_Bo", "link": "https://stackoverflow.com/users/7388477/valdi-bo"}, "is_accepted": false, "score": 0, "last_activity_date": 1513273842, "creation_date": 1513273842, "answer_id": 47819373, "question_id": 47819049, "link": "https://stackoverflow.com/questions/47819049/perl-substitution-example-from-mastering-regular-expressions-book-not-working-fo/47819373#47819373", "title": "Perl substitution example from Mastering Regular Expressions book not working for me", "body": "<p>Indeed, you missed only a backslash before the last \"d\".</p>\n\n<p>Change the first substiturion instruction to:</p>\n\n<pre><code>$price =~ s/(\\.\\d\\d[1-9]?)\\d*/$1/;\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3064085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e091281ca9a2922839692a8c9ac62bc2?s=128&d=identicon&r=PG&f=1", "display_name": "user3064085", "link": "https://stackoverflow.com/users/3064085/user3064085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 47819209, "answer_count": 2, "score": 3, "last_activity_date": 1513297521, "creation_date": 1513272598, "last_edit_date": 1513297521, "question_id": 47819049, "link": "https://stackoverflow.com/questions/47819049/perl-substitution-example-from-mastering-regular-expressions-book-not-working-fo", "title": "Perl substitution example from Mastering Regular Expressions book not working for me", "body": "<p>I'm probably just missing something simple but the <code>s///</code> isn't assigning the changed string to my variable.  I try a more simple <code>s///</code> and it does work.</p>\n\n<p>This example should trim the any digits after the decimal if there are more than three.</p>\n\n<pre><code>my $price = 12.34567;\nprint \"$price\\n\";\n$price =~ s/(\\.\\d\\d[1-9]?)d*/$1/;\nprint \"$1\\n\";           # This is printing .345 correctly.\nprint \"$price\\n\";       # This should be 12.345 but is unchanged.\n\nmy $story = \"dog\";\n$story =~ s/(do)g/$1/;\nprint \"$story\\n\"; # This works.  It's changed to \"do\"\n</code></pre>\n\n<p>Edit: If the third digit is a zero it should trim it after two digits.</p>\n\n<p>\"Prettifying a stock Price:\n...always take the first two digits after the decimal point, and take the third digit only if it is not zero. Then, remove any other digits.</p>\n"}, {"tags": ["bash", "perl"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 3, "creation_date": 1513273662, "post_id": 47819045, "comment_id": 82600592, "body": "seems a bit odd having perl call grep when it&#39;s more than capable of doing what grep does itself"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513275138, "post_id": 47819045, "comment_id": 82601384, "body": "Especially since calling <code>grep</code> correctly would have to involve far more code than provided. (injection bugs, lack of error handling)"}], "answers": [{"tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": true, "score": 1, "last_activity_date": 1513284986, "creation_date": 1513284986, "answer_id": 47821897, "question_id": 47819045, "link": "https://stackoverflow.com/questions/47819045/grep-did-not-search-properly/47821897#47821897", "title": "grep did not search properly", "body": "<p>The directly used bash code can't work, because <code>$'\\s{0,}'</code> does not what you think it does. The <code>$'...'</code> interpolates C escape sequences, e.g. <code>$'\\n'</code> expands to a newline. <code>$'\\s'</code> is simply undefined and substituted as <code>\\s</code>. If you need to grep for zero or more space characters, use</p>\n\n<pre><code>grep '...[[:space:]]*...'\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4760272, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-JQ5vdeNdWmQ/AAAAAAAAAAI/AAAAAAAADMo/KlSms3irUXQ/photo.jpg?sz=128", "display_name": "Leon WANG", "link": "https://stackoverflow.com/users/4760272/leon-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 47821897, "answer_count": 1, "score": 2, "last_activity_date": 1513284986, "creation_date": 1513272574, "last_edit_date": 1513284667, "question_id": 47819045, "link": "https://stackoverflow.com/questions/47819045/grep-did-not-search-properly", "title": "grep did not search properly", "body": "<p>In my Perl scripts, I run bash code below</p>\n\n<pre><code>$tmp=`grep -E -n 'FRAME.*$atom_id'\\$'\\\\s{1,}''$spc_lbl{$all_species}' $file_o_nghb_refine |wc -l`\n</code></pre>\n\n<p>where, <code>$tmp</code>, <code>$atom_id</code>, <code>$spc_lbl[]</code>, <code>$all_species</code> are variables or elements of an array. Normally (all other files show the result properly except one file, all files are generated by my program without any interruption), the result would show values like below if removing \"wc -l\"</p>\n\n<pre><code>FRAME     0 11687 Fe  7744AL \nFRAME     1 11687 Fe  7744AL \nFRAME     2 11687 Fe  7744AL \nFRAME     3 11687 Fe  7744AL \nFRAME     4 11687 Fe  7744AL \nFRAME     5 11687 Fe  7744AL \nFRAME     6 11687 Fe  7744AL \nFRAME     7 11687 Fe  7744AL \nFRAME     8 11687 Fe  7744AL \nFRAME     9 11687 Fe  7744AL \nFRAME    10 11687 Fe  7744AL \n......\n</code></pre>\n\n<p>However, above code cannot show one file properly. In fact, if I use bash code directly,<br>\n<code>grep 'FRAME     0 11687'$'\\s{0,}''Fe' 15x200.lammpstrj.o_neighbors.raw.dat</code>\nI could not find the results, either. If I use </p>\n\n<pre><code>grep 'FRAME.*11687.*Fe' 15x200.lammpstrj.o_neighbors.raw.dat\n</code></pre>\n\n<p>The results would be shown like above. </p>\n\n<p>Is there anything wrong or improperly? How can I improve the scripts? Why the same scripts could work for the other files except for this one? Any further suggestion would be highly appreciated.</p>\n"}, {"tags": ["regex", "postgresql", "perl"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1513263344, "post_id": 47816081, "comment_id": 82593987, "body": "Surely you want to print out every line that isn&#39;t the header or row count and you don&#39;t need a multiline regular expression for that"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513268246, "post_id": 47816081, "comment_id": 82597314, "body": "It would be better to write this whole thing in Perl using the DBI module"}], "answers": [{"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 0, "last_activity_date": 1513263330, "creation_date": 1513263330, "answer_id": 47816286, "question_id": 47816081, "link": "https://stackoverflow.com/questions/47816081/extracting-field-from-multiline-text-that-is-piped-into-perl/47816286#47816286", "title": "Extracting field from multiline text that is piped into Perl", "body": "<p>From your sample data, it looks like you want the integer on lines that only contain that integer and some white space. So something like this will work:</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\n\nwhile (&lt;&gt;) {\n  /^\\s*(\\d+)\\s*$/ and print $1;\n}\n</code></pre>\n\n<p>You can put that in a file, make it executable and then run it using:</p>\n\n<pre><code>$ psql ... | your_extract_program\n</code></pre>\n\n<p>But if you really want to retype the Perl code every time, you could use:</p>\n\n<pre><code>$ psql ... | perl -n -e 'print $1 if /^\\s*(\\d+)\\s*$/'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "is_accepted": true, "score": 2, "last_activity_date": 1513264017, "creation_date": 1513264017, "answer_id": 47816504, "question_id": 47816081, "link": "https://stackoverflow.com/questions/47816081/extracting-field-from-multiline-text-that-is-piped-into-perl/47816504#47816504", "title": "Extracting field from multiline text that is piped into Perl", "body": "<p>The problem you're having with your <code>perl -e</code> is that at no point are you reading <code>STDIN</code>, and thus perl isn't 'seeing' your data.</p>\n\n<p>You can use <code>-ne</code> which tells perl to wrap your snippet in a <code>while ( &lt;&gt; ) { }</code> loop. That's maybe of limited use though, because it's working line by line.</p>\n\n<p>So then you need to set the 'end of line delimiter' (<code>-0</code> flag) and then apply your regex:</p>\n\n<pre><code>perl -0777 -ne 'print $1 if m/received_tli\\D*(\\d+)/' \n</code></pre>\n\n<p>Or written in a longer perl script (but hopefully more readable):</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nlocal $/;\nwhile (&lt;&gt;) {\n   print $1,\"\\n\" if m/received_tli\\D*(\\d+)/;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 1, "last_activity_date": 1513272800, "creation_date": 1513272800, "answer_id": 47819101, "question_id": 47816081, "link": "https://stackoverflow.com/questions/47816081/extracting-field-from-multiline-text-that-is-piped-into-perl/47819101#47819101", "title": "Extracting field from multiline text that is piped into Perl", "body": "<p>There is no need to involve Perl at all. Just use the <code>-t</code> or <code>--tuples-only</code> option in <code>psql</code>:</p>\n\n<pre><code>psql -t -c \"SELECT received_tli FROM pg_stat_wal_receiver\"\n</code></pre>\n"}], "owner": {"reputation": 526, "user_id": 8481953, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8e55deee10d1354662d231ac3caa8390?s=128&d=identicon&r=PG&f=1", "display_name": "rookie09", "link": "https://stackoverflow.com/users/8481953/rookie09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 47816504, "answer_count": 3, "score": 1, "last_activity_date": 1513272800, "creation_date": 1513262760, "last_edit_date": 1513263273, "question_id": 47816081, "link": "https://stackoverflow.com/questions/47816081/extracting-field-from-multiline-text-that-is-piped-into-perl", "title": "Extracting field from multiline text that is piped into Perl", "body": "<p>I would like to extract a number (<code>7</code>, in this example) from input of the following kind:</p>\n\n<pre><code> received_tli \n--------------\n            7\n(1 row)\n</code></pre>\n\n<p>I've seen <a href=\"https://stackoverflow.com/questions/6764350/extract-text-from-a-multiline-string-using-perl\">recipes</a> for the case where the multi-line string exists as a Perl variable. However, I would prefer invoking the expression like this:</p>\n\n<pre><code>psql -c \"SELECT received_tli FROM pg_stat_wal_receiver\" | \\\n  perl -e 'print $1 if /&lt;expression&gt;/'\n</code></pre>\n\n<p>I've tried e.g. <code>\\s^received_tli\\s*\\n-+\\n\\s*([0-9])+\\s*\\n(1 row)</code> as expression, but this does not seem to work. How can I parse multiline input that is piped into Perl with a (multiline) regular expression?</p>\n"}, {"tags": ["perl", "utf-8"], "comments": [{"owner": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "edited": false, "score": 0, "creation_date": 1513251148, "post_id": 47811813, "comment_id": 82585846, "body": "Your sample text is incomplete, I&#39;m getting &quot;\ufffd \u0430\u0431\u044b\u043d\u0438.avi&quot;. Also, check if your terminal supports UTF-8"}, {"owner": {"reputation": 1333, "user_id": 3530848, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a8bd944494c29c3be75f932f36aeca76?s=128&d=identicon&r=PG&f=1", "display_name": "hamidi", "link": "https://stackoverflow.com/users/3530848/hamidi"}, "reply_to_user": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "edited": false, "score": 0, "creation_date": 1513252863, "post_id": 47811813, "comment_id": 82586950, "body": "I didn&#39;t find what you meant by saying that my sample test is incomplete. what sample text you meant? I tried redirecting output to a file. I tried also linux. none seem to work."}, {"owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "edited": false, "score": 0, "creation_date": 1513254228, "post_id": 47811813, "comment_id": 82587816, "body": "If I copy-and-paste your script into my linux terminal, I see the Cyrillic text. So I think this must be a windows support thing."}, {"owner": {"reputation": 1333, "user_id": 3530848, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a8bd944494c29c3be75f932f36aeca76?s=128&d=identicon&r=PG&f=1", "display_name": "hamidi", "link": "https://stackoverflow.com/users/3530848/hamidi"}, "edited": false, "score": 0, "creation_date": 1513254503, "post_id": 47811813, "comment_id": 82588006, "body": "yes, ur right. in cmd.exe, i can&#39;t see cyrillic texts as they should be shown. but as far as the output is redirected to a file, the terminal is not dependent. the terminal just used to run the perl script. but even in this case, the output file includes the same input."}, {"owner": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "edited": false, "score": 0, "creation_date": 1513259950, "post_id": 47811813, "comment_id": 82591593, "body": "use Encode; $str = &quot;&#208;&#176;&#208;&#189;&#208;&#179;&#208;&#181;&#208;&#187;&#208;&#190;&#208;&#178;.avi&quot;; $str = decode(&#39;utf8&#39;,$str);  open(H,&#39;&gt;&#39;,&#39;pradeep.txt&#39;); print H $str; close H; This works for me."}, {"owner": {"reputation": 1333, "user_id": 3530848, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a8bd944494c29c3be75f932f36aeca76?s=128&d=identicon&r=PG&f=1", "display_name": "hamidi", "link": "https://stackoverflow.com/users/3530848/hamidi"}, "edited": false, "score": 0, "creation_date": 1513261076, "post_id": 47811813, "comment_id": 82592368, "body": "yes, it does. but it still doesn&#39;t work for &#208;&#176;&#208;&#177;&#209;\u2039&#208;&#189;&#208;&#184;"}], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 5, "last_activity_date": 1513275865, "last_edit_date": 1513275865, "creation_date": 1513271750, "answer_id": 47818841, "question_id": 47811813, "link": "https://stackoverflow.com/questions/47811813/converting-a-sequence-of-bytes-into-proper-characters/47818841#47818841", "title": "Converting a sequence of bytes into proper characters", "body": "<p>Encoding <code>\u0420\u0430\u0431\u044b\u043d\u0438</code> using UTF-8 gives <code>D0.<b>A0</b>.D0.B0.D0.B1.D1.<b>8B</b>.D0.BD.D0.B8</code>.</p>\n\n<p>However, <code>\u00d0 \u00d0\u00b0\u00d0\u00b1\u00d1\u2039\u00d0\u00bd\u00d0\u00b8</code> is <code>D0.<b>20</b>.D0.B0.D0.B1.D1.<b>2039</b>.D0.BD.D0.B8</code>.</p>\n\n<p>The main problem is that <code>utf8::decode($str);</code> is failing because <code>\u00d0 \u00d0\u00b0\u00d0\u00b1\u00d1\u2039\u00d0\u00bd\u00d0\u00b8</code> isn't valid UTF-8. The encoding of <code>\u0420\u0430\u0431\u044b\u043d\u0438</code> has been irreversibly corrupted.</p>\n\n<hr>\n\n<p>As for Windows,</p>\n\n<pre><code>#!/usr/bin/perl\n\nmy $terminal_enc_layer;\nBEGIN {\n    $terminal_enc_layer = $^O eq 'MSWin32'\n        ? do { require Win32; \":encoding(cp\".Win32::GetACP().\")\" }\n        : \":locale\";\n}\n\nuse utf8;\nuse open ':std', $terminal_enc_layer;\n\nuse strict;\nuse warnings;\n\nmy $str = \"\\xD0\\xA0\\xD0\\xB0\\xD0\\xB1\\xD1\\x8B\\xD0\\xBD\\xD0\\xB8\";\n\nutf8::decode($str)\n   or die \"Bad data\";\n\nprint \"$str\\n\";\n</code></pre>\n"}], "owner": {"reputation": 1333, "user_id": 3530848, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a8bd944494c29c3be75f932f36aeca76?s=128&d=identicon&r=PG&f=1", "display_name": "hamidi", "link": "https://stackoverflow.com/users/3530848/hamidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 47818841, "answer_count": 1, "score": 1, "last_activity_date": 1513275865, "creation_date": 1513249577, "question_id": 47811813, "link": "https://stackoverflow.com/questions/47811813/converting-a-sequence-of-bytes-into-proper-characters", "title": "Converting a sequence of bytes into proper characters", "body": "<p>I use this <a href=\"https://software.hixie.ch/utilities/cgi/unicode-decoder/utf8-decoder\" rel=\"nofollow noreferrer\">site</a> to convert sequence of bytes like this:</p>\n\n<p>\u00d0\u00a0\u00d0\u00b0\u00d0\u00b1\u00d1\u2039\u00d0\u00bd\u00d0\u00b8</p>\n\n<p>into proper character sequences like this:</p>\n\n<p>\u0420\u0430\u0431\u044b\u043d\u0438</p>\n\n<p>It seems that the site decodes the UTF8 sequences into their original characters. For some reason, some of my files names are corrupted and I need to convert them back to their original.</p>\n\n<p>Since number of files is not less, I decided to write a perl script for this purpose. I tried this</p>\n\n<pre><code>#!/usr/bin/perl\nuse utf8;\n$str = \"\u00d0\u00a0\u00d0\u00b0\u00d0\u00b1\u00d1\u2039\u00d0\u00bd\u00d0\u00b8.avi\";\nutf8::decode($str);\nbinmode STDOUT, \":utf8\";\nprint \"$str\\n\";\n</code></pre>\n\n<p>as a test on one file name. When running the script, I redirect the output to a file. When I see the content of the file, I see that the content is the same as the input string and no conversion is made. This is while the output is consistent to what the site converts for sequences like this:</p>\n\n<p>\u00d0\u00b0\u00d0\u00bd\u00d0\u00b3\u00d0\u00b5\u00d0\u00bb\u00d0\u00be\u00d0\u00b2</p>\n\n<p>I tried running the script on both Linux (Ubuntu) and Windows by using ActivePerl and both give the same result. Concentrating on Windows, what do you think to be the error of the script?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "edited": false, "score": 1, "creation_date": 1513257531, "post_id": 47809922, "comment_id": 82589994, "body": "This looks rather a lot like XML. Is it?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513340700, "post_id": 47809922, "comment_id": 82627489, "body": "@Thorsten: You really shouldn&#39;t remove useful information from your question to prevent people from identifying that you have taken the wrong approach. Regular expressions are the <i>wrong tool</i> for processing XML, and such a solution is liable to backfire on you and your company. Making wholesale changes to your question like that also makes nonsense of people&#39;s existing comments and solutions."}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513356441, "post_id": 47809922, "comment_id": 82636844, "body": "@Borodin The underlying textual file format is in no way needed for my question, it is not about how to properly parse XML, it is about variable interpolation in regular expressions in Perl. Your want to discuss things which are totally off-topic and unnecessary to the question. Something which my edit has easily proven..."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513356729, "post_id": 47809922, "comment_id": 82636992, "body": "@Thorsten: So it <i>is</i> XML? If so then <code>qr&#39;...&#39;</code> is not the answer you should be looking for: it is an error-prone hack. The best answers correct misconceptions in the question as well as providing a working solution to the stated problem. <b>Sobrique&#39;s</b> answer should not be down voted just because you insist on using a faulty solution."}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513357021, "post_id": 47809922, "comment_id": 82637115, "body": "@Borodin You simply don&#39;t get it, <code>qr&#39;...&#39;</code> of course is the one best answer for this concrete problem: Just look at the <code>if</code> where Sobrique matches the regular expression and input my regexp from the question there. Exactly the same problem even with XML parser and only solved by <code>quotemeta</code>. But like the down-vote of the other answer suggesting to use <code>quotemeta</code> shows, this is not the best/easiest solution, which is <code>qr&#39;..&#39;</code>. This discussion is pointless and your revert of the removal of the XML example is pointless as well."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513357136, "post_id": 47809922, "comment_id": 82637176, "body": "@Thorsten: It is you who isn&#39;t &quot;getting it&quot;. You clearly have no real experience with handling XML data properly, and you should have sufficient humility to accept the advice of those who do. Please take your aggression elsewhere."}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513357325, "post_id": 47809922, "comment_id": 82637270, "body": "@Borodin You don&#39;t have any clue about what I know or don&#39;t know or am I capable of doing or whatever... :-D That&#39;s easily proven by the fact that you are discussing a completely off-topic part of the question where my problem could have easily occurred as well."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513357555, "post_id": 47809922, "comment_id": 82637382, "body": "@Thorsten: I&#39;m afraid your capabilities with XML are clearly very limited as evidenced by your words and the position you&#39;re taking here. All you&#39;re doing is repeating nonsense, and I have no more to say."}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513357835, "post_id": 47809922, "comment_id": 82637529, "body": "@Borodin Don&#39;t be afraid, you are just wrong, that happens to a lot of people on the internet. :-) Just ask you one question: Does my question makes sense without the XML example text? What benefit provides the XML example text to the question? It&#39;s pretty easy in the end, because the only correct answer of course is, that the XML example doesn&#39;t provide any benefit and the only error I made was using it simply because it was available in the beginning. I should have known the risk for this off-topic nonsense we are having right now. ;-)"}, {"owner": {"reputation": 59971, "user_id": 1835379, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/i63aC.gif?s=128&g=1", "display_name": "Cerbrus", "link": "https://stackoverflow.com/users/1835379/cerbrus"}, "edited": false, "score": 4, "creation_date": 1513374978, "post_id": 47809922, "comment_id": 82644908, "body": "Note: This question is <a href=\"https://meta.stackoverflow.com/questions/360744/when-am-i-wiser-than-the-op/360745#360745\">being discussed on meta</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4639281"}, "edited": false, "score": 5, "creation_date": 1513375727, "post_id": 47809922, "comment_id": 82645172, "body": "Contrary to popular belief, <a href=\"https://stackoverflow.com/a/4286326\">using patterns on little, limited pieces of reasonably well-defined pieces of HTML is quick and easy</a>. The stigma here is unnecessary and wrong. Sure, if you want to perform complicated tasks on potentially malformed HTML (note that XML is much easier to deal with than HTML) you&#39;re probably better off with a parser, but if you just need to do a simple text replacement, you probably don&#39;t need a parser and RegEx is OK."}, {"owner": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 0, "creation_date": 1523193080, "post_id": 47809922, "comment_id": 86449198, "body": "Related: <i><a href=\"https://stackoverflow.com/questions/576435/how-do-i-handle-special-characters-in-a-perl-regex\">How do I handle special characters in a Perl regex?</a></i>."}], "answers": [{"comments": [{"owner": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "edited": false, "score": 2, "creation_date": 1513249206, "post_id": 47810705, "comment_id": 82584624, "body": "Still this might cause an issue as $ is a special character for regex, and it is not escaped"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "edited": false, "score": 0, "creation_date": 1513250165, "post_id": 47810705, "comment_id": 82585170, "body": "@Pradeep combined with quotemeta or <code>\\Q</code> and <code>\\E</code> it should be fine."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "edited": false, "score": 0, "creation_date": 1513421115, "post_id": 47810705, "comment_id": 82653664, "body": "@AlvaroJoao there&#39;s no difference. You can pass a list of imports to <code>use</code> after the module name. <code>feature</code> is a pragma, but that&#39;s kind of like a module with a lower case name really. The <code>&#39;say&#39;</code> is just one scalar. If you do <code>qw&#47;say&#47;</code> it will create a list of scalars with words that are automatically quoted, with one scalar in it. In list context, everything is a list in Perl. So essentially they are two ways of importing one thing. People often use <code>qw&#47;&#47;</code> directly, because <code>use Foo &#39;bar&#39;, &#39;baz&#39;</code> looks weird, and <code>use Foo qw&#47;bar baz&#47;</code> is nicer to read."}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "edited": false, "score": 1, "creation_date": 1513421203, "post_id": 47810705, "comment_id": 82653690, "body": "My reason for accepting this answer seems to have &quot;magically&quot; disappeared: <code>qr&#39;...&#39;</code> is exactly what I was looking for and is even documented to prevent my kind of problem: &quot;If &quot;&#39;&quot; is used as the delimiter, no variable interpolation is done.&quot; <a href=\"https://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators\" rel=\"nofollow noreferrer\">perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators</a>"}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "edited": false, "score": 1, "creation_date": 1514579614, "post_id": 47810705, "comment_id": 83026212, "body": "Combining <code>qr&#39;...&#39;</code> and <code>\\Q...\\E</code> doesn&#39;t work: <code>Unrecognized escape \\E passed through in regex;[...]</code> Using <code>qr&#47;\\Q...\\E&#47;</code> with ... being the result of <code>qr&#39;&#39;</code> doesn&#39;t work as well. Therefore one either needs to escape <code>$</code>, {<code>, &#180;}</code> and <code>.</code> individually or use <code>quotemeta</code> right from the start. <code>qr&#39;...&#39;</code> isn&#39;t saving anything in the end, because <code>quotemeta</code> doesn&#39;t suffer from my  problem and quoting individually prevents Perl from thinking of variable interpolation as well. So this answers my question by word, but was actually not was I hoped to find. :-)"}], "tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": true, "score": 1, "last_activity_date": 1513246150, "creation_date": 1513246150, "answer_id": 47810705, "question_id": 47809922, "link": "https://stackoverflow.com/questions/47809922/how-to-escape-plain-text-looking-like-variable-interpolation-in-perl-regular-exp/47810705#47810705", "title": "How to escape plain text looking like variable interpolation in Perl regular expressions?", "body": "<p>The <code>\\Q</code> and <code>\\E</code> are for quoting regex meta characters. They have nothing to do with variable interpolation.</p>\n\n<p>If you construct your pattern with <code>qr''</code> with single quotes <code>''</code>, Perl will not interpolate variables.</p>\n\n<pre><code>use feature 'say';\n\nmy $foo = 1;\nmy $bar = qr/$foo/;\nsay $bar;\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>(?^:1)\n</code></pre>\n\n<p>But with <code>qr''</code>:</p>\n\n<pre><code>my $foo = 1;\nmy $bar = qr'$foo';\nsay $bar;\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>(?^:$foo)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "edited": false, "score": 2, "creation_date": 1514579758, "post_id": 47811777, "comment_id": 83026264, "body": "This answer doesn&#39;t deserve all the down votes, <code>quotemeta</code> seems the only solution to handle escaping and non-variable-interpolation in one easy way. See my other comment: <a href=\"https://stackoverflow.com/questions/47809922/how-to-escape-plain-text-looking-like-variable-interpolation-in-perl-regular-exp#comment83026212_47810705\" title=\"how to escape plain text looking like variable interpolation in perl regular exp%23comment83026212_47810705\">stackoverflow.com/questions/47809922/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "is_accepted": false, "score": -2, "last_activity_date": 1513249477, "creation_date": 1513249477, "answer_id": 47811777, "question_id": 47809922, "link": "https://stackoverflow.com/questions/47809922/how-to-escape-plain-text-looking-like-variable-interpolation-in-perl-regular-exp/47811777#47811777", "title": "How to escape plain text looking like variable interpolation in Perl regular expressions?", "body": "<p>Escape the pattern with <em>quotemeta</em> and then compile the regex. Something like this, it works...</p>\n\n<pre><code>my $s = q[&lt;timestamp key=\"byYearMonth\" datePattern=\"yyyy-MM\" /&gt;\n&lt;appender name=\"FILE\" class=\"ch.qos.logback.core.FileAppender\"&gt;\n    &lt;File&gt;logs/${byYearMonth}.log&lt;/File&gt;\n    &lt;Append&gt;true&lt;/Append&gt;\n\n    &lt;encoder class=\"ch.qos.logback.classic.encoder.PatternLayoutEncoder\"&gt;\n        &lt;Pattern&gt;%date %-5level %logger.%M: %msg%n&lt;/Pattern&gt;\n    &lt;/encoder&gt;\n&lt;/appender&gt;];\n\nmy $pat = quotemeta('${byYearMonth}.log');\nmy $re = qr[$pat];\n\n$s =~ s/$re/pop/g;\n\nprint $s;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "edited": false, "score": 4, "creation_date": 1513270896, "post_id": 47814525, "comment_id": 82599035, "body": "Down vote because the RegExp vs. XML-Parser discussion is off-topic and not relevant to my question, which is about variable interpolation only. Will change my text example to prevent that kind of discussion."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "edited": false, "score": 1, "creation_date": 1513340810, "post_id": 47814525, "comment_id": 82627552, "body": "@Thorsten: Your downvote is highly inappropriate. <b>Sobrique</b> has shown you a <i>correct</i> way to process your data."}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1513356187, "post_id": 47814525, "comment_id": 82636725, "body": "@Borodin My question is not related to XML processing, but his answer focusses on that and doesn&#39;t even provide the answer I was really looking for, <code>qr&#39;...&#39;</code>. He is addressing my question only by the <code>quotemeta</code>side note."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "edited": false, "score": 0, "creation_date": 1513356297, "post_id": 47814525, "comment_id": 82636779, "body": "@Thorsten: Are you saying that your data is <i>not</i> XML?"}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 2, "creation_date": 1513356757, "post_id": 47814525, "comment_id": 82637006, "body": "@Borodin Nope, I&#39;m saying that I don&#39;t asked how to properly parse XML and therefore it doesn&#39;t make sense to explain how to properly parse XML, while addressing the concrete question only in a side note, if at all. Other answerers didn&#39;t care for XML or not, but focussed on the concrete question..."}, {"owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "edited": false, "score": 1, "creation_date": 1513615860, "post_id": 47814525, "comment_id": 82711196, "body": "The reason I answered about parsing XML, is because your first question actually was about parsing XML. There are other ways to select fields within XML that regex cannot do - <code>xpath</code> is more fully featured. You were tackling an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>. The fact that you&#39;ve edited your question to remove that context and then down voted my answer afterwards is disappointing."}, {"owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "edited": false, "score": 0, "creation_date": 1513797576, "post_id": 47814525, "comment_id": 82793635, "body": "@Sobrique You are wrong, I first down voted and than edited and my comment makes that clear, so I&#39;m not hiding anything. I know about XML and XPath and decided against their usage in this case for various reasons and can live with the risks just fine. How unnecessary and off-topic my XML example was is shown by the <code>if</code> in your example as well, my problem would have occurred there exactly as described in my question, so XPath didn&#39;t change anything and therefore it was valid to provide a better example. Should have done that from the beginning."}], "tags": [], "owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "is_accepted": false, "score": 2, "last_activity_date": 1513258479, "last_edit_date": 1513258479, "creation_date": 1513258129, "answer_id": 47814525, "question_id": 47809922, "link": "https://stackoverflow.com/questions/47809922/how-to-escape-plain-text-looking-like-variable-interpolation-in-perl-regular-exp/47814525#47814525", "title": "How to escape plain text looking like variable interpolation in Perl regular expressions?", "body": "<p>I am going to call the other answers wrong, on the basis that manipulating what looks a lot like XML via regex is a bad idea. </p>\n\n<p>And if it's actually not XML, then using a data format that looks like XML but isn't is an <em>even worse</em> idea. </p>\n\n<p>So the answer is 'use a parser' (or alternatively, hit whoever generated the file with a rolled up copy of the XML spec). </p>\n\n<p>Something like this will change the contents of the <code>&lt;File&gt;</code> element:</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nuse XML::Twig;\n\nmy $xml = XML::Twig -&gt; new -&gt; parsefile ( 'your_file.xml'); \n\nmy $file_elt = $xml -&gt; get_xpath ('//File',0);\n\nprint \"Original value:\", $file_elt -&gt; text,\"\\n\";\n$file_elt -&gt; set_text('some/other/path/${byWeek}.log');\n\n$xml -&gt; set_pretty_print ( 'indented' ); \n$xml -&gt; print;\n</code></pre>\n\n<p>Note - <code>get_xpath</code> only finds the first instance of <code>&lt;File&gt;</code> anywhere in the tree. If you need to be more specific, you can either iterate or add additional qualifiers to the <code>xpath</code>. </p>\n\n<p>So for example:</p>\n\n<pre><code>my $target_text = quotemeta '${byYearMonth}'; \nmy $search_regex = qr/$target_text/; \n\nforeach my $file_elt ( $xml -&gt; get_xpath('//File') ) { \n  if ( $file_elt -&gt; text =~ /$search_regex/ ) { \n      ## set it to something else. \n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 2566, "user_id": 2055163, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/38e40a8a1f83778784f9ffbed05584ed?s=128&d=identicon&r=PG", "display_name": "Thorsten Sch&#246;ning", "link": "https://stackoverflow.com/users/2055163/thorsten-sch%c3%b6ning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 47810705, "answer_count": 3, "score": -1, "last_activity_date": 1513420700, "creation_date": 1513243697, "last_edit_date": 1513420700, "question_id": 47809922, "link": "https://stackoverflow.com/questions/47809922/how-to-escape-plain-text-looking-like-variable-interpolation-in-perl-regular-exp", "title": "How to escape plain text looking like variable interpolation in Perl regular expressions?", "body": "<p>I have the following lines of text in some configuration file, need to parse that file using Perl, find the <code>File:</code> line and replace its content using some regular expression to add some text etc.</p>\n\n<pre><code>File: logs/${byYearMonth}.log\n</code></pre>\n\n<p>The problem I have is with the regular expression, because I would like to use <code>${byYearMonth}.log</code> in it, as it's easy to read, can easily be quoted etc. But this looks like variable interpolation to Perl and I get the following compilation error for the following simplified reg exp:</p>\n\n<pre><code>... =~ s/...\\Q${byYearMonth}.log\\E.../.../m;\n</code></pre>\n\n<p><code>Global symbol \"$byYearMonth\" requires explicit package name (did you forget to declare \"my $byYearMonth\"?)</code></p>\n\n<p>Of course I can rework the reg exp to not let Perl think it's a variable name, but the provided version above is the most easiest to read and search for in my opinion. Thinking and researching about the problem, I didn't find any solution which would allow me to keep the reg exp as is and prevent the Perl compilation error by only adding some flag or whatever.</p>\n\n<p>So, is there any (easy) way to tell Perl that some plain and already quoted text is not to be interpolated to get rid of the compilation error?</p>\n\n<p>I have the feeling I'm missing something really easy, so thanks for your hints! :-)</p>\n"}, {"tags": ["regex", "perl"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4633061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d646e325b66fbb768b48deda886f66b9?s=128&d=identicon&r=PG", "display_name": "Jessica Paloma", "link": "https://stackoverflow.com/users/4633061/jessica-paloma"}, "edited": false, "score": 0, "creation_date": 1513240354, "post_id": 47808610, "comment_id": 82578978, "body": "forfiles /s /m *.html /c &quot;perl -pi -e s,&lt;head(?:.|\\n|\\r)+?&lt;/head&gt;,,g @path&quot;"}, {"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "reply_to_user": {"reputation": 43, "user_id": 4633061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d646e325b66fbb768b48deda886f66b9?s=128&d=identicon&r=PG", "display_name": "Jessica Paloma", "link": "https://stackoverflow.com/users/4633061/jessica-paloma"}, "edited": false, "score": 0, "creation_date": 1513240439, "post_id": 47808610, "comment_id": 82579025, "body": "it may not work for many reasons what is the error? seems you missed -0777 : <code>perl -0777 -pi -e ...</code>"}, {"owner": {"reputation": 43, "user_id": 4633061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d646e325b66fbb768b48deda886f66b9?s=128&d=identicon&r=PG", "display_name": "Jessica Paloma", "link": "https://stackoverflow.com/users/4633061/jessica-paloma"}, "edited": false, "score": 0, "creation_date": 1513240559, "post_id": 47808610, "comment_id": 82579084, "body": "not given any error in terminal but doesn&#39;t work not change any file"}, {"owner": {"reputation": 43, "user_id": 4633061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d646e325b66fbb768b48deda886f66b9?s=128&d=identicon&r=PG", "display_name": "Jessica Paloma", "link": "https://stackoverflow.com/users/4633061/jessica-paloma"}, "edited": false, "score": 0, "creation_date": 1513240642, "post_id": 47808610, "comment_id": 82579145, "body": "when I tried forfiles /s /m *.html /c &quot;perl -0777 -pi -e s,&lt;head(?:.|\\n|\\r)+?&lt;/head&gt;,,g&quot; give this error &quot;-i used with no filenames on the command line, reading from STDIN.&quot;"}, {"owner": {"reputation": 43, "user_id": 4633061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d646e325b66fbb768b48deda886f66b9?s=128&d=identicon&r=PG", "display_name": "Jessica Paloma", "link": "https://stackoverflow.com/users/4633061/jessica-paloma"}, "edited": false, "score": 0, "creation_date": 1513240716, "post_id": 47808610, "comment_id": 82579179, "body": "this -0777 work in windows 10? this command is not for unix systems ?"}, {"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "reply_to_user": {"reputation": 43, "user_id": 4633061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d646e325b66fbb768b48deda886f66b9?s=128&d=identicon&r=PG", "display_name": "Jessica Paloma", "link": "https://stackoverflow.com/users/4633061/jessica-paloma"}, "edited": false, "score": 0, "creation_date": 1513241070, "post_id": 47808610, "comment_id": 82579386, "body": "no from <code>perl -h</code> <code>-0[octal]         specify record separator (\\0, if no argument)</code>, however 777 is a special value which means no input record separator, -00 is another special which means &quot;paragraph mode&quot; input record separator is more than 2 consecutive newlines,otherwise <code>-0</code>can also be used if there is no nul byte in input file"}], "tags": [], "owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "is_accepted": false, "score": 1, "last_activity_date": 1513238971, "creation_date": 1513238971, "answer_id": 47808610, "question_id": 47808493, "link": "https://stackoverflow.com/questions/47808493/perl-error-in-search-and-replace-windows/47808610#47808610", "title": "Perl error in search and replace windows", "body": "<p><code>/</code> in <code>&lt;/head&gt;</code> must be escaped with <code>\\</code> because <code>/</code> is the substitute delimiter or another delimiter can be used. for example <code>s,&lt;head(?:.|\\n|\\r)+?&lt;/head&gt;,,g</code>.</p>\n\n<p>also as regex seems to be multi line perl switch <code>-0777</code> can be used to unset record separator and read the whole file, otherwise input is split bynewlines before applying regex.</p>\n"}], "owner": {"reputation": 43, "user_id": 4633061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d646e325b66fbb768b48deda886f66b9?s=128&d=identicon&r=PG", "display_name": "Jessica Paloma", "link": "https://stackoverflow.com/users/4633061/jessica-paloma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513238971, "creation_date": 1513238439, "question_id": 47808493, "link": "https://stackoverflow.com/questions/47808493/perl-error-in-search-and-replace-windows", "title": "Perl error in search and replace windows", "body": "<p>I am trying to remove tag head using regex of mutiples files recursive in windows 10 using perl</p>\n\n<pre><code>forfiles /s /m *.html /c \"perl -pi -e s/&lt;head(?:.|\\n|\\r)+?&lt;/head&gt;//g @path\"\n</code></pre>\n\n<p>but I get this message and I dont understand what I wrong</p>\n\n<pre><code>Illegal division by zero at -e line 1.\n</code></pre>\n"}, {"tags": ["perl", "subroutine"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1513236611, "post_id": 47807696, "comment_id": 82577194, "body": "You can use <a href=\"http://perldoc.perl.org/functions/splice.html\" rel=\"nofollow noreferrer\"><code>splice</code></a> to push the <code>grep</code>&#39;d data into <code>extract</code>.  You could simply use <code>push @extract, @match;</code> too."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 2, "creation_date": 1513236658, "post_id": 47807696, "comment_id": 82577217, "body": "Looks like you&#39;re doing an excercise from <i>Learning Perl</i>. That&#39;s a good resource. :) Don&#39;t use <code>-w</code> on the shebang though. Use the <code>use warnings</code> pragma instead."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1513236762, "post_id": 47807696, "comment_id": 82577269, "body": "For the subroutine part of your question, you need to tell us which data is lexical (so only available inside of) the subroutine and always the same, which data comes in as parameters, and if there is anything that&#39;s available outside and inside the subroutine. There are a million ways to do that, but we don&#39;t know what you want to do."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1513236974, "post_id": 47807696, "comment_id": 82577379, "body": "You can use <a href=\"http://perldoc.perl.org/functions/splice.html\" rel=\"nofollow noreferrer\"><code>splice</code></a> to push the <code>grep</code>&#39;d data into <code>extract</code>.  You could simply use <code>push @extract, @match;</code> too, and the explicit <code>@match</code> is superfluous: <code>push @extract, grep &#47;$unit&#47;, @array1;</code> does what&#39;s needful in one line.  The <code>chomp</code> isnt needed here, and you can name the values from <code>@list</code> with <code>foreach my $unit (@list) { push @extract, grep &#47;$unit&#47;, @array1; }</code>."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 3, "creation_date": 1513238518, "post_id": 47807696, "comment_id": 82578094, "body": "Can you show us a failed subroutine attempt so we can see which part is hard?"}, {"owner": {"reputation": 311, "user_id": 9097452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8073dda6ba748ee30788aed8a1e82f0d?s=128&d=identicon&r=PG", "display_name": "abraham", "link": "https://stackoverflow.com/users/9097452/abraham"}, "edited": false, "score": 0, "creation_date": 1513298110, "post_id": 47807696, "comment_id": 82610997, "body": "Hi, thanks for all. I want to make a subroutine to extract a given list of scientific name of bacteria as array (@array1) and taxonomic assignation obtained from metagenomics (QIIME) analyses (@array2),  I need a piece of code that compare the list with the taxonomic file and extract it, this scrip has the same principle (compare two list), and I just want a subroutine that take 2 array (list) and extract the list that match, the point is that I have like 5 variant but at the end I always have 2 array (list and taxonomic assignation) I tried to make a sub extract"}], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 4, "last_activity_date": 1513293969, "last_edit_date": 1513293969, "creation_date": 1513238515, "answer_id": 47808513, "question_id": 47807696, "link": "https://stackoverflow.com/questions/47807696/convert-to-a-subroutine-in-perl/47808513#47808513", "title": "Convert to a subroutine in Perl", "body": "<pre><code>#!/usr/bin/perl -w\nuse strict;\n\nsub build_re { \"(?:\".( join '|', map quotemeta, @_ ).\")\" }\n\nmy @strings = ( \"Fred Flinstone\", \"Wilma Flinstone\", \"Barney Rubble\", \"Betty Rubble\" );\nmy @substrings = ( \"Ba\", \"Wil\" );\n\nmy $re = build_re(@substrings);\nmy @matches = grep /$re/, @strings;\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>This code includes a sub (as requested).</li>\n<li>This approach is much faster.</li>\n<li>This approach fixes your duplicates problem. (For example, it doesn't add  <code>William Bates</code> to <code>@matches</code> twice like your code does.)</li>\n<li>This approach is stable. (The outputs are in the same order as the inputs.)</li>\n<li>This code uses somewhat more reasonable variable names.</li>\n</ul>\n\n<hr>\n\n<blockquote>\n  <p><em>how to add all the results to the @match array without using a <code>foreach (@match){ push (@extract, $_)</code>?</em></p>\n</blockquote>\n\n<pre><code>foreach (@match) { push (@extract, $_); }\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>push @extract, @match;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": false, "score": 0, "last_activity_date": 1513294375, "last_edit_date": 1513294375, "creation_date": 1513290511, "answer_id": 47823087, "question_id": 47807696, "link": "https://stackoverflow.com/questions/47807696/convert-to-a-subroutine-in-perl/47823087#47823087", "title": "Convert to a subroutine in Perl", "body": "<pre><code>use strict;\nuse warnings;\n\nsub multi_grep {\n    my $checks = shift;\n    my %seen;\n    for my $check (@$checks) {\n        ++$seen{$_} for grep $check, @_;\n    }\n\n    # This ensures we don't remove duplicates.\n    # It also happens to make this approach stable.\n    return grep $seen{$_}, @_;\n}\n\nmy @array1 = ( \"Fred Flinstone\", \"Wilma Flinstone\", \"Barney Rubble\", \"Betty Rubble\" );\nmy @list = ( \"Ba\", \"Wil\" );  # Expected to be regex patterns.\n\nmy @matches = multi_grep(\\@list, @array1);\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>This code moves the code into a sub (as requested).</li>\n<li>This approach fixes your duplicates problem. (For example, it doesn't add <code>William Bates</code> to <code>@matches</code> twice like your code does.)</li>\n<li>This approach is stable. (The outputs are in the same order as the inputs.)</li>\n</ul>\n"}], "owner": {"reputation": 311, "user_id": 9097452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8073dda6ba748ee30788aed8a1e82f0d?s=128&d=identicon&r=PG", "display_name": "abraham", "link": "https://stackoverflow.com/users/9097452/abraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513322330, "creation_date": 1513235182, "last_edit_date": 1513236453, "question_id": 47807696, "link": "https://stackoverflow.com/questions/47807696/convert-to-a-subroutine-in-perl", "title": "Convert to a subroutine in Perl", "body": "<p>I have this code, to extract in this case names, using a given list: </p>\n\n<p>I want to convert this code in a subroutine, I have tried in a different ways but it just doesn't give me what I want.  And the other question is, how to add all the results (in this case: Barney Rubble, Wilma Flinstone) to the @match array without using a <code>foreach (@match){ push (@extract, $_)</code>?</p>\n\n<pre><code>#!/usr/bin/perl -w\nuse strict;\nmy @array1 = ( \"Fred Flinstone\", \"Wilma Flinstone\", \"Barney Rubble\", \"Betty Rubble\" );\nmy @list = (\"Ba\", \"Wil\");\nmy (@match, @extract);\n\nfor (@list){\n    my $unit = $_;\n    chomp $unit;\n\n    @match = grep (/$unit/, @array1);\n\n    foreach (@match){\n        push (@extract, $_);\n    }\n}\n\nforeach (@extract){\n    print \"$_\\n\";\n}\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 1, "creation_date": 1513230026, "post_id": 47806533, "comment_id": 82574400, "body": "What does it mean to read a sheet &quot;line by line&quot; when a &quot;line&quot; contains potentially many cells of varying datatype?  What exactly do you want to receive for a &quot;line&quot;?"}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "reply_to_user": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1513230220, "post_id": 47806533, "comment_id": 82574460, "body": "each row of data at once"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1513236865, "post_id": 47806533, "comment_id": 82577320, "body": "Why do you want to do that? Do you assume it will be faster? Less code? More readable?"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 2, "creation_date": 1513237256, "post_id": 47806533, "comment_id": 82577514, "body": "I found both of the things you want to do within five minutes of skimming the documentation. Since I did not know this module before, and I believe others also might not, I will write a short answer for the benefit of future readers. Next time, <b>please read the documentation yourself!</b>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "edited": false, "score": 0, "creation_date": 1513241856, "post_id": 47808318, "comment_id": 82579807, "body": "sir i am getting output like this:-$VAR1 = 1; $VAR1 = 58; $VAR1 = 52; $VAR1 = 52; $VAR1 = 52; $VAR1 = 26; $VAR1 = 1; $VAR1 = 58; $VAR1 = 52; $VAR1 = 52; $VAR1 = 52; $VAR1 = 26; $VAR1 = 1; $VAR1 = 58; $VAR1 = 52; $VAR1 = 52; $VAR1 = 52; $VAR1 = 26; $VAR1 = 1; $VAR1 = 58; $VAR1 = 52; $VAR1 = 52; $VAR1 = 52; $VAR1 = 26; $VAR1 = 1; $VAR1 = 58; $VAR1 = 52; $VAR1 = 52; $VAR1 = 52; $VAR1 = 26; $VAR1 = 1; $VAR1 = 58; $VAR1 = 52; $VAR1 = 52; $VAR1 = 52; $VAR1 = 26; $VAR1 = 1; $VAR1 = 58; $VAR1 = 52; $VAR1 = 52;"}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "edited": false, "score": 0, "creation_date": 1513241981, "post_id": 47808318, "comment_id": 82579875, "body": "i am using Active perl in windows"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "edited": false, "score": 0, "creation_date": 1513245689, "post_id": 47808318, "comment_id": 82582233, "body": "@Anand looks like you used <code>fetchrow_array</code>, not <code>fetchrow_array_ref</code>. That seems to be the number of elements in the array, because my example used a scalar <code>$row</code>. Without example input I cannot help you further. I read the documentation for you already. I cannot do your job for you unfortunately."}, {"owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "edited": false, "score": 0, "creation_date": 1513246868, "post_id": 47808318, "comment_id": 82583038, "body": "my data is in second sheet of .xlsm i.e 12-10-2017 xyz 10-2-1992 +91999999999 and so on in all the rows"}], "tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": false, "score": 3, "last_activity_date": 1513237744, "creation_date": 1513237744, "answer_id": 47808318, "question_id": 47806533, "link": "https://stackoverflow.com/questions/47806533/how-to-read-xlsm-file-line-by-line-in-perl/47808318#47808318", "title": "how to read .xlsm file line by line in perl", "body": "<p>According to the documentation, you can use the <a href=\"https://metacpan.org/pod/Spreadsheet::Reader::ExcelXML::Worksheet#fetchrow_arrayref(-$row-)\" rel=\"nofollow noreferrer\"><code>fetchrow_arrayref</code></a> and <a href=\"https://metacpan.org/pod/Spreadsheet::Reader::ExcelXML::Worksheet#fetchrow_array(-$row-)\" rel=\"nofollow noreferrer\"><code>fetchrow_array</code></a> methods on the <a href=\"https://metacpan.org/pod/Spreadsheet::Reader::ExcelXML::Worksheet\" rel=\"nofollow noreferrer\">workbook level</a> to get a full row.</p>\n\n<blockquote>\n  <p><strong><code>fetchrow_arrayref( $row )</code></strong></p>\n  \n  <p>Definition: In an homage to DBI I included this function to return an\n  array ref of the cells or values in the requested $row. If no row is\n  requested this returns the 'next' row. In the array ref any empty cell\n  will show as 'undef'.</p>\n  \n  <p>Accepts: undef = next|$row = a row integer indicating the desired row\n  See the attribute \"count_from_zero\" in Spreadsheet::Reader::ExcelXML\n  to understand which row is returned for $row.</p>\n  \n  <p>Returns: an array ref of all possible column positions in that row\n  with data filled in per the attribute \"group_return_type\" in\n  Spreadsheet::Reader::ExcelXML.</p>\n</blockquote>\n\n<p>Note that this module has its own definition of what a row is, and you can change that on import.</p>\n\n<p>To load a specific worksheet, use the <a href=\"https://metacpan.org/pod/Spreadsheet::Reader::ExcelXML#worksheet(-$name-)\" rel=\"nofollow noreferrer\"><code>worksheet</code></a> method on the workbook object. You need to know the name of the worksheet beforehand, or you can get all of the names with <a href=\"https://metacpan.org/pod/Spreadsheet::Reader::ExcelXML#get_sheet_names\" rel=\"nofollow noreferrer\"><code>get_sheet_names</code></a>.</p>\n\n<blockquote>\n  <p><strong><code>worksheet( $name )</code></strong> </p>\n  \n  <p>Definition: This method will return an object to read values in the\n  identified worksheet. If no value is passed to $name then the 'next'\n  worksheet in physical order is returned. 'next' will NOT wrap It also\n  only iterates through the 'worksheets' in the workbook (not the\n  'chartsheets').</p>\n  \n  <p>Accepts: the $name string representing the name of the worksheet\n  object you want to open. This name is the word visible on the tab when\n  opening the spreadsheet in Excel. (not the underlying zip member file\n  name - which can be different. It will not accept chart tab names.)</p>\n  \n  <p>Returns: a Worksheet object with the ability to read the worksheet of\n  that name. It returns undef and sets the error attribute if a\n  'chartsheet' is requested. Or in 'next' mode it returns undef if past\n  the last sheet.</p>\n  \n  <p>Example: using the implied 'next' worksheet;</p>\n</blockquote>\n\n<p>Here is a quick, untested example that will open a specific worksheet, get the data line by line and dump out the results.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse Spreadsheet::Reader::ExcelXML qw( :just_the_data);\nuse Data::Dumper;\n\nmy $workbook  = Spreadsheet::Reader::ExcelXML-&gt;new( \n    file =&gt; 'filename.xlsm' );\n\nmy $worksheet = $workbook-&gt;worksheet('foo');\n\nwhile (my $row = $worksheet-&gt;fetchrow_array_ref) {\n    print Dumper $row;\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7646267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2f6a39f0f166d665a713516230982f?s=128&d=identicon&r=PG&f=1", "display_name": "Anand ", "link": "https://stackoverflow.com/users/7646267/anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513237744, "creation_date": 1513229927, "last_edit_date": 1513230069, "question_id": 47806533, "link": "https://stackoverflow.com/questions/47806533/how-to-read-xlsm-file-line-by-line-in-perl", "title": "how to read .xlsm file line by line in perl", "body": "<p>This code reads the data from .xlsm file .this read data each cell by cell like cell(0,0) and like so on from this code i am not able to read data of whole line .I want to read .xlsm file line by line and also only of specified worksheet not all.</p>\n\n<pre><code>#!/usr/bin/env perl\nuse strict;\nuse warnings;\nuse Spreadsheet::Reader::ExcelXML qw( :just_the_data);\n\nmy $workbook  = Spreadsheet::Reader::ExcelXML-&gt;new( file =&gt; 'filename.xlsm' \n);\n\nif ( !$workbook-&gt;file_opened ) {\n     die $workbook-&gt;error(), \"\\n\";\n }\n\nfor my $worksheet ( $workbook-&gt;worksheets) {\n\n    print \"Reading worksheet named: \" . $worksheet-&gt;get_name . \"\\n\";\n\n    while( 1 ){\n            my $cell = $worksheet-&gt;get_next_value;\n\n            print \"Cell is: $cell\\n\";\n            last if $cell eq 'EOF';\n     }\n }\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>    # SYNOPSIS Screen Output\n    # 01: Row, Col    = (0, 0)\n    # 02: Value       = Category\n    # 03: Unformatted = Category\n    # 04:\n    # 05: Row, Col    = (0, 1)\n    # 06: Value       = Total\n    # 07: Unformatted = Total\n    # 08:\n    # 09: Row, Col    = (0, 2)\n    # 10: Value       = Date\n    # 11: Unformatted = Date\n    # 12:\n    # 13: Row, Col    = (1, 0)\n    # 14: Value       = Red\n    # 16: Unformatted = Red\n    # 17:\n    # 18: Row, Col    = (1, 1)\n    # 19: Value       = 5\n    # 20: Unformatted = 5\n    # 21:\n    # 22: Row, Col    = (1, 2)\n    # 23: Value       = 2017-2-14 #(shows as 2/14/2017 in the sheet)\n    # 24: Unformatted = 41318\n    # 25:\n    # More intermediate rows ...\n    # 82:\n    # 83: Row, Col    = (6, 2)\n    # 84: Value       = 2016-2-6 #(shows as 2/6/2016 in the sheet)\n    # 85: Unformatted = 40944\n</code></pre>\n"}, {"tags": ["perl", "awk", "sed"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513227782, "post_id": 47805906, "comment_id": 82573705, "body": "<code>perl -pe&#39;$f=&#47;^=head&#47;..&#47;^=cut&#47;;$_=$&#47;if$f&gt;1&amp;&amp;$f!~&#47;E&#47;&#39;</code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513227789, "post_id": 47805906, "comment_id": 82573708, "body": "<code>perl -pe&#39;$_=$&#47;if$f&amp;&amp;=!&#47;^=cut&#47;;$f||=&#47;^=head&#47;&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8433606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc85aae3cd695c30f82fa1e0327eedc?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchu", "link": "https://stackoverflow.com/users/8433606/sanchu"}, "edited": false, "score": 1, "creation_date": 1513226116, "post_id": 47805967, "comment_id": 82573283, "body": "Hi Akshay, tried ur command, working as expected. Can u please explain how this command works...please"}, {"owner": {"reputation": 14904, "user_id": 3161993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56e8M.png?s=128&g=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3161993/akshay"}, "reply_to_user": {"reputation": 39, "user_id": 8433606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc85aae3cd695c30f82fa1e0327eedc?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchu", "link": "https://stackoverflow.com/users/8433606/sanchu"}, "edited": false, "score": 0, "creation_date": 1513226133, "post_id": 47805967, "comment_id": 82573286, "body": "@Sanchu explained"}], "tags": [], "owner": {"reputation": 14904, "user_id": 3161993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56e8M.png?s=128&g=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3161993/akshay"}, "is_accepted": false, "score": 0, "last_activity_date": 1513226541, "last_edit_date": 1513226541, "creation_date": 1513225894, "answer_id": 47805967, "question_id": 47805906, "link": "https://stackoverflow.com/questions/47805906/how-to-replace-a-block-of-code-between-two-patterns-with-blank-lines/47805967#47805967", "title": "How to replace a block of code between two patterns with blank lines?", "body": "<pre><code>awk '/=cut/{found=0}found{print \"\";next}/=head/{found=1}1' infile\n\n# OR\n# ^ to take care of line starts with regexp\nawk '/^=cut/{found=0}found{print \"\";next}/^=head/{found=1}1' infile\n</code></pre>\n\n<p>Explanation:</p>\n\n<pre><code>awk '/=cut/{                    # if line contains regexp \n        found=0                 # set variable found = 0\n     }\n     found{                     # if variable found is nonzero value\n       print \"\";                # print \"\"\n       next                     # go to next line\n     }\n     /=head/{                   # if line contains regexp\n       found=1                  # set variable found = 1\n     }1                         # 1 at the end does default operation\n                                # print current line/row/record\n   ' infile\n</code></pre>\n\n<p>Test Results:</p>\n\n<pre><code>$ cat infile\n=head\nhello\nhello world\nworld\nmorning\ngud\n=cut\n\n$ awk '/=cut/{found=0}found{print \"\";next}/=head/{found=1}1' infile\n=head\n\n\n\n\n\n=cut\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "is_accepted": false, "score": 1, "last_activity_date": 1513227426, "creation_date": 1513227426, "answer_id": 47806143, "question_id": 47805906, "link": "https://stackoverflow.com/questions/47805906/how-to-replace-a-block-of-code-between-two-patterns-with-blank-lines/47806143#47806143", "title": "How to replace a block of code between two patterns with blank lines?", "body": "<pre><code>$ awk '/=cut/{f=0} {print (f ? \"\" : $0)} /=head/{f=1}' file\n=head\n\n\n\n\n\n=cut\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "is_accepted": false, "score": 1, "last_activity_date": 1513227687, "creation_date": 1513227687, "answer_id": 47806182, "question_id": 47805906, "link": "https://stackoverflow.com/questions/47805906/how-to-replace-a-block-of-code-between-two-patterns-with-blank-lines/47806182#47806182", "title": "How to replace a block of code between two patterns with blank lines?", "body": "<p>To modify the given <code>sed</code> command, try</p>\n\n<pre><code>$ sed '/=head/,/=cut/{//! s/.*//}' ip.txt\n=head\n\n\n\n\n\n=cut\n</code></pre>\n\n<ul>\n<li><code>//!</code> to match other than start/end ranges, might depend on <code>sed</code> implementation whether it dynamically matches both the ranges or statically only one of them. Works on <code>GNU sed</code>\n\n<ul>\n<li><code>s/.*//</code> to clear these lines</li>\n</ul></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "is_accepted": false, "score": 0, "last_activity_date": 1513271790, "creation_date": 1513271790, "answer_id": 47818853, "question_id": 47805906, "link": "https://stackoverflow.com/questions/47805906/how-to-replace-a-block-of-code-between-two-patterns-with-blank-lines/47818853#47818853", "title": "How to replace a block of code between two patterns with blank lines?", "body": "<p>This might work for you (GNU sed):</p>\n\n<pre><code>sed '/=head/,/=cut/{//!z}' file\n</code></pre>\n\n<p>Zap the lines between <code>=head</code> and <code>=cut</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 8433606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc85aae3cd695c30f82fa1e0327eedc?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchu", "link": "https://stackoverflow.com/users/8433606/sanchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1513662028, "creation_date": 1513225459, "question_id": 47805906, "link": "https://stackoverflow.com/questions/47805906/how-to-replace-a-block-of-code-between-two-patterns-with-blank-lines", "title": "How to replace a block of code between two patterns with blank lines?", "body": "<p>I am trying  replace a block of code between two patterns with blank lines\nTried using below command</p>\n\n<pre><code>sed '/PATTERN-1/,/PATTERN-2/d' input.pl\n</code></pre>\n\n<p>But it only removes the lines between the patterns</p>\n\n<p>PATTERN-1 : \"=head\"\nPATTERN-2 : \"=cut\"</p>\n\n<p>input.pl contains below text </p>\n\n<pre><code>=head\nhello\nhello world\nworld\nmorning\ngud\n=cut\n</code></pre>\n\n<p>Required output :</p>\n\n<pre><code>=head\n\n\n\n\n\n=cut\n</code></pre>\n\n<p>Can anyone help me on this?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513224751, "post_id": 47805467, "comment_id": 82572934, "body": "Good question, just to nitpick at the terminology: he behavior of signals among processes <i>is</i> involved but sensible, not &quot;<i>strange</i>&quot;"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513225961, "post_id": 47805467, "comment_id": 82573248, "body": "What&#39;s your OS?"}], "answers": [{"comments": [{"owner": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "edited": false, "score": 0, "creation_date": 1513224445, "post_id": 47805617, "comment_id": 82572867, "body": "Well the thing is, it seems like it&#39;s going directly to some of the children. I can&#39;t prove this, but it&#39;s almost like it&#39;s going to whatever child happens to be printing on the screen at the moment. Could that be the &quot;foreground process&quot; you&#39;re referring to? My children are definitely not starting their own process groups."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "edited": false, "score": 0, "creation_date": 1513226311, "post_id": 47805617, "comment_id": 82573325, "body": "Re &quot;<i>Could that be the &quot;foreground process&quot; you&#39;re referring to?</i>&quot;, I never referred to &quot;foreground process&quot;."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1513239278, "last_edit_date": 1513239278, "creation_date": 1513223422, "answer_id": 47805617, "question_id": 47805467, "link": "https://stackoverflow.com/questions/47805467/write-a-perl-program-so-that-ctrl-c-kills-all-forks/47805617#47805617", "title": "write a Perl program so that Ctrl-C kills all forks", "body": "<p>As per the <a href=\"http://pubs.opengroup.org/onlinepubs/000095399/basedefs/xbd_chap11.html#tag_11_01_09\" rel=\"nofollow noreferrer\">POSIX specification</a>, when the terminal (tty) receives the <code>INTR</code> character (usually Ctrl-C) on input and the terminal's <code>ISIG</code> flag is set<sup>[1]</sup>, it sends <code>SIGINT</code> signal to all processes in the foreground process group for which the terminal is the controlling terminal.</p>\n\n<p>Demo:</p>\n\n<pre><code>use strict;\nuse warnings;\nuse feature qw( say );\n\nuse Parallel::ForkManager qw( );\n\nmy $id = 0;\nsub _say { say sprintf \"[%s %s %s] %s\", $id, $$, getpgrp(), \"@_\"; }\n\nmy $n = 4;\nmy $wait = 5;\nmy $new_pgrp = $ARGV[0];\n\nmy $pm = Parallel::ForkManager-&gt;new($n);\nfor (1..$n) {\n   $pm-&gt;start() and next;\n\n   $id = $_;\n   _say \"Child\";\n   $SIG{INT} = sub { _say \"Caught SIGINT in child\"; };\n   if ($new_pgrp) {\n      setpgrp() or die $!;\n      _say \"Created process group\";\n   }\n\n   sleep($wait);\n   $pm-&gt;finish();\n}\n\n_say \"Parent\";\n$SIG{INT} = sub { _say \"Caught SIGINT in parent\"; };\nsay \"Now! (You have $wait seconds to press Ctrl-C)\";\nsleep($wait);\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ perl a.pl 0\n[1 16590 16587] Child\n[2 16591 16587] Child\n[3 16592 16587] Child\n[0 16587 16587] Parent\n[4 16593 16587] Child\nNow! (You have 5 seconds to press Ctrl-C)\n^C[4 16593 16587] Caught SIGINT in child\n[3 16592 16587] Caught SIGINT in child\n[2 16591 16587] Caught SIGINT in child\n[0 16587 16587] Caught SIGINT in parent\n[1 16590 16587] Caught SIGINT in child\n</code></pre>\n\n<p>If the parent process gets the signal, but not the child processes, then perhaps your children are starting their own process groups.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ perl a.pl 1\n[1 16766 16763] Child\n[1 16766 16766] Created process group\n[2 16767 16763] Child\n[2 16767 16767] Created process group\n[3 16768 16763] Child\n[3 16768 16768] Created process group\n[0 16763 16763] Parent\n[4 16769 16763] Child\nNow! (You have 5 seconds to press Ctrl-C)\n[4 16769 16769] Created process group\n^C[0 16763 16763] Caught SIGINT in parent\n</code></pre>\n\n<hr>\n\n<ol>\n<li><p>You can observe the terminal's settings for <code>INTR</code> and <code>ISIG</code> using <code>stty -a</code>.</p>\n\n<ul>\n<li><code>isig</code> (as opposed to <code>-isig</code>) means the <code>ISIG</code> flag is set.</li>\n<li><code>intr = ^C</code> means the <code>INTR</code> character is Ctrl-C.</li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 5937, "user_id": 783314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b3d5692064779f501f7c2a639dc0076c?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/783314/stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1513239278, "creation_date": 1513222260, "question_id": 47805467, "link": "https://stackoverflow.com/questions/47805467/write-a-perl-program-so-that-ctrl-c-kills-all-forks", "title": "write a Perl program so that Ctrl-C kills all forks", "body": "<p>I have a program which forks a lot using Parallel::ForkManager. The way it does it is pretty simple:</p>\n\n<pre><code>my $pm = new Parallel::ForkManager($NUM_PROCESSES);\n\nmy $j = 0;\nwhile ($j &lt; $NUM_PROCESSES) {\n    $j++;\n\n    my $pid = $pm-&gt;start and next;\n\n    [application code here]\n\n    $pm-&gt;finish;\n}\n$pm-&gt;wait_all_children;\n</code></pre>\n\n<p>This works fine, but sometimes after running this, I need to kill it. The behavior when pressing Ctrl-C is strange, I think it might only kill one fork at a time. </p>\n\n<p>Do I need to write my code differently somehow to make Ctrl-C propagate to all forks? Or perhaps use a different command? Or is what I'm looking to do not possible?</p>\n"}]