[{"tags": ["java", "perl", "cygwin"], "comments": [{"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 1, "creation_date": 1514390117, "post_id": 47994966, "comment_id": 82958109, "body": "I&#39;m not very familiar with cygwin (any more) but: do you have a shebang line in your script (<code>#!&#47;usr&#47;bin&#47;perl</code>)? And: does it work when you issue <code>perl .&#47;canarybot.pl</code>?"}, {"owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1514390575, "post_id": 47994966, "comment_id": 82958303, "body": "I entirety of my script is posted above. I dont know what a shebang line is but I&#39;ll google it now."}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 2, "creation_date": 1514390737, "post_id": 47994966, "comment_id": 82958381, "body": "The shebang line tells the system which program to use to interpret the rest of your script. In your case you want <code>perl</code> to process the script (as opposed to <code>bash</code> for example). Try adding the line <code>#!&#47;usr&#47;bin&#47;perl</code> or just <code>#!perl</code> as the very first line to your script. (The two lines you show look good, btw.)"}, {"owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1514391180, "post_id": 47994966, "comment_id": 82958594, "body": "OK. That gets rid of the errors. But then nothing happens. I expect the java code to have some effect at that point. I will see if I can generate some output to an out file."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1514391601, "post_id": 47994966, "comment_id": 82958777, "body": "Does it work if you issue <code>java -jar canarybot.jar localhost 55001</code> from the Cygwin command line?"}, {"owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "edited": false, "score": 1, "creation_date": 1514392870, "post_id": 47994966, "comment_id": 82959345, "body": "No. In that case it says - bash: java: command not found. I&#39;m currently looking for java.exe and will try it with the full path"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514408063, "post_id": 47994966, "comment_id": 82965385, "body": "@Steve: Please tag your posts with e.g. <code>@Borodin</code> so that we get a notification of your comment. It sounds like you haven&#39;t installed Java on your system. You must do some basic debugging before you ask for free help. Every question and its answers here are supposed to be a a useful resource for the whole world. Please don&#39;t post monuments to carelessness."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1514411913, "post_id": 47994966, "comment_id": 82966709, "body": "@Steve: <i>Stack Overflow</i> is not a forum, and any question posted here should be relevant to everyone else who has encountered something similar. If you have a proper resolution and can explain it then please post it as an answer to your question. Please don&#39;t edit your question to include its own answer, and try to write your posts so that they are applicable to everyone with a similar problem who may arrive here via a search. I have rolled back your edit so that it contains just the most recent  version of your question."}], "answers": [{"comments": [{"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1514392092, "post_id": 47995365, "comment_id": 82959003, "body": "I used to use Cygwin as well years ago because it has a proper shell with tab-tab-tab-completion and other fancy things. I didn&#39;t care about how Windows would start my scripts because I started them from the Cygwin shell. Perhaps the OP is cast in the same mould. (I had to look up that phrase ;-))"}, {"owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "edited": false, "score": 0, "creation_date": 1514392779, "post_id": 47995365, "comment_id": 82959296, "body": "If I run canarybot.pl from a cmd window it opens it in notepad :)"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 1, "creation_date": 1514403433, "post_id": 47995365, "comment_id": 82963632, "body": "@PerlDuck: The most recent version of Windows 10 provides a bash shell. There is no longer any reason to use Cygwin, and if you&#39;re developing for Windows then you shouldn&#39;t assume a bash shell in the first place. Tribals will insist that you must pretend that your Windows platform is really a Linux system, but they are deluded."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "edited": false, "score": 0, "creation_date": 1514403582, "post_id": 47995365, "comment_id": 82963690, "body": "@Steve: If <code>canarybot.pl</code> starts Notepad then your registry is messed up. Try <code>perl canarybot.pl</code>."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "edited": false, "score": 1, "creation_date": 1514408274, "post_id": 47995365, "comment_id": 82965450, "body": "@Steve: Everything seems to surprise you. What <i>do</i> you know? Have you ever written a working program?"}, {"owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "edited": false, "score": 0, "creation_date": 1514493228, "post_id": 47995365, "comment_id": 82996867, "body": "Yes, I&#39;ve written some pretty good programs in java and c#. However, I&#39;m totally unfamiliar with perl and command line stuff"}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": true, "score": 3, "last_activity_date": 1514391535, "creation_date": 1514391535, "answer_id": 47995365, "question_id": 47994966, "link": "https://stackoverflow.com/questions/47994966/running-java-file-with-2-args-using-perl-script-launched-in-cygwin/47995365#47995365", "title": "Running Java file with 2 args using perl script launched in Cygwin", "body": "<p>The error <code>syntax error near unexpected token</code> is a shell error. You are asking the Cygwin shell to execute a Perl program, and of course it makes nonsense in that context</p>\n\n<p>You may use</p>\n\n<pre><code>    perl canarybot.pl\n</code></pre>\n\n<p>or you can add a\n<a href=\"https://en.wikipedia.org/wiki/Shebang_(Unix)\" rel=\"nofollow noreferrer\"><em>shebang line</em></a></p>\n\n<pre><code>#!perl\n</code></pre>\n\n<p>to the start of your program, which will cause the Cygwin shell to look for <code>perl</code> on the PATH and use it to execute the subsequent code instead of trying to interpret it itself</p>\n\n<p>But I don't see any reason to use Cygwin here. From the Windows <code>cmd</code> prompt you can use the command</p>\n\n<pre><code>canarybot.pl\n</code></pre>\n\n<p>Windows will start searching in the current working directory for the file, and the it will use the registry to determine how to process the <code>.pl</code> file type. There is no need for a shebang line at all</p>\n"}, {"tags": [], "owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1514550594, "creation_date": 1514550594, "answer_id": 48022664, "question_id": 47994966, "link": "https://stackoverflow.com/questions/47994966/running-java-file-with-2-args-using-perl-script-launched-in-cygwin/48022664#48022664", "title": "Running Java file with 2 args using perl script launched in Cygwin", "body": "<p>This was resolved by editing the Perl script to use a shebang line along with an exact path to the java.exe file as follows:</p>\n\n<pre><code>#!/usr/bin/perl\nmy @args = (\"/cygdrive/c/Program\\ Files/Java/jdk1.8.0_152/bin/java.exe\", \"-jar\", \"canarybot.jar\", \"localhost\", \"55001\");\nmy $ret = system(@args);\n</code></pre>\n"}], "owner": {"reputation": 864, "user_id": 3410340, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/520663230/picture?type=large", "display_name": "Steve W", "link": "https://stackoverflow.com/users/3410340/steve-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 47995365, "answer_count": 2, "score": 0, "last_activity_date": 1514550594, "creation_date": 1514389839, "last_edit_date": 1514411780, "question_id": 47994966, "link": "https://stackoverflow.com/questions/47994966/running-java-file-with-2-args-using-perl-script-launched-in-cygwin", "title": "Running Java file with 2 args using perl script launched in Cygwin", "body": "<p>I'm trying to write a Perl script to launch my Java program.</p>\n\n<p>I'm trying to execute it using Cygwin in Windows 10.</p>\n\n<p>The Java program's main method requires two arguments.</p>\n\n<p>The main method looks like this</p>\n\n<pre><code>public static void main(String[] args) throws InterruptedException, IOException\n{\n    String ipAddress = args[0];\n    int port = Integer.parseInt(args[1]);\n    ACPCGame acpc1 = new ACPCGame();\n    acpc1.play(ipAddress, port);\n}\n</code></pre>\n\n<p>I then have my Perl script called <code>canarybot.pl</code>.</p>\n\n<pre><code>my @args = (\"java\", \"-jar\", \"canarybot.jar\", \"localhost\", \"55001\");\nsystem(@args);\n</code></pre>\n\n<p><code>localhost</code> and <code>55001</code> are supposed to be the two arguments expected by the Java main method.</p>\n\n<p>I then open a Cygwin bash prompt in the directory containing the Perl script and <code>jar</code> file and attempt to execute it like this</p>\n\n<pre><code>./canarybot.pl\n</code></pre>\n\n<p>This results in the error</p>\n\n<blockquote>\n  <p>./canarybot.pl: line 1: syntax error near unexpected token '('<br>\n  ./canarybot.pl: line 1: my @args = (\"java\", \"-jar\", \"canarybot.jar\", \"localhost', \"55001\");  </p>\n</blockquote>\n"}, {"tags": ["perl", "pdf", "formattable", "dynamicpdf-table2"], "answers": [{"comments": [{"owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "edited": false, "score": 0, "creation_date": 1515143210, "post_id": 47997630, "comment_id": 83195848, "body": "Thank you @beasy.  How can I print data in different tables rather displaying it in same table separating it with - -."}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "reply_to_user": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "edited": false, "score": 0, "creation_date": 1515446462, "post_id": 47997630, "comment_id": 83295848, "body": "Create a new <code>PDF::Table</code> in each loop"}], "tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": false, "score": -1, "last_activity_date": 1514404089, "last_edit_date": 1514404089, "creation_date": 1514402972, "answer_id": 47997630, "question_id": 47992648, "link": "https://stackoverflow.com/questions/47992648/rearrange-data-in-a-pdf-file/47997630#47997630", "title": "Rearrange data in a PDF file", "body": "<p>The <code>PDF::Table</code> <a href=\"http://search.cpan.org/~omega/PDF-Table-0.9.14/lib/PDF/Table.pm#table()\" rel=\"nofollow noreferrer\">table</a> function takes an \"array or arrays\" as its third argument. You currently have it strucutred like:</p>\n\n<pre><code>my @tbl = ( [$name,$addr,$grade], [...] )\n</code></pre>\n\n<p>Each nested array (what's inside the <code>[]</code> brackets) is a new row of the table, and the elements to that array are the cells of that row. So instead, you want it structured:</p>\n\n<pre><code>my @tbl = ( ['NAME',$name], ['ADDR1',$addr], ['GRADE',$grade], [...] ) \n</code></pre>\n\n<p>To construct it using your <code>%data</code> structure:</p>\n\n<pre><code>for my $id (sort keys %data) {\n    push @tbl, [$_, $data{$id}-&gt;{$_}] for qw/NAME ADDR1 GRADE/;\n    push @tbl, [qw/- -/]; # to add a blank row as a separator\n}\n</code></pre>\n"}], "owner": {"reputation": 2402, "user_id": 6124824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc81b6fda21a94d3f337e2e28463295e?s=128&d=identicon&r=PG", "display_name": "vkk05", "link": "https://stackoverflow.com/users/6124824/vkk05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1514404089, "creation_date": 1514379585, "last_edit_date": 1514387412, "question_id": 47992648, "link": "https://stackoverflow.com/questions/47992648/rearrange-data-in-a-pdf-file", "title": "Rearrange data in a PDF file", "body": "<p>I am using Perl to generate a PDF file with the\n<a href=\"https://metacpan.org/pod/PDF::API2\" rel=\"nofollow noreferrer\"><code>PDF::API2</code></a> module.</p>\n\n<p>I am having difficulty writing data to the file in the required format.</p>\n\n<p>Currently this is how it appears in the PDF file.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Dl5Vo.png\" alt=\"Currently looks like this in PDF\"></p>\n\n<p>Here's my script</p>\n\n<pre><code>my %data = (\n    '1' =&gt; {\n        'SEQUENCE' =&gt; '1',\n        'NAME'     =&gt; 'John',\n        'ADDR1'    =&gt; 'Road 1',\n        'GRADE'    =&gt; '5'\n    },\n    '2' =&gt; {\n        'SEQUENCE' =&gt; '2',\n        'NAME'     =&gt; 'Smith',\n        'ADDR1'    =&gt; 'Road 2',\n        'GRADE'    =&gt; '6'\n    }\n);\n\n...\n...\n\nmy @rows = qw( NAME ADDR1 GRADE );\n\nfor my $id (sort keys %data){\n    push @tbl, [ @{$data{$id}}{@rows} ];\n    ($name, $addr, $grade) = ($data{$id}{'NAME'}, $data{$id}{'ADDR1'}, $data{$id}{'GRADE'});\n} \n\n...\n...\n\nmy $pdftable = new PDF::Table;\n$pdftable-&gt;table(\n     $pdf,\n     $page,\n     \\@tbl,\n     x =&gt; 50,\n     w =&gt; 400,\n     start_y =&gt; 630,\n     start_h =&gt; 630,\n     next_y  =&gt; 630,\n     next_h  =&gt; 630,\n     padding =&gt; 5,\n     border =&gt; 1,\n     padding_right =&gt; 10,\n);\n$pdf-&gt;saveas();\n</code></pre>\n\n<p>But I want it to to appear like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/C294d.png\" alt=\"It should be formatted like this\"></p>\n\n<p>I know I have to make a modification to <code>@tbl</code> data, but how?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514389717, "post_id": 47991341, "comment_id": 82957914, "body": "Any source that says <i>&quot;Next it has a silly -00 command line option&quot;</i> is not to be trusted."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1514420068, "post_id": 47991341, "comment_id": 82968711, "body": "The second <code>0</code> is the argument to <code>-e</code>, i.e. the program to run."}], "answers": [{"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514415356, "post_id": 47991632, "comment_id": 82967632, "body": "This is excellent except that you don&#39;t explain properly what <code>-l</code> does and how it affects <code>perl -lpe &#39;s&#47;^\\s+$&#47;&#47;&#39;</code>"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514415469, "post_id": 47991632, "comment_id": 82967658, "body": "<code>$in_sep = ! print</code> is horrible"}, {"owner": {"reputation": 10448, "user_id": 784980, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d9c4540c5478352227f3ed3c3316ad8c?s=128&d=identicon&r=PG", "display_name": "rapt", "link": "https://stackoverflow.com/users/784980/rapt"}, "edited": false, "score": 0, "creation_date": 1514426507, "post_id": 47991632, "comment_id": 82969982, "body": "What does the <code>--</code> mean? I want to have this script change the original file, not just push the output to the console, so I try <code>perl -lpe &#39;s&#47;^\\s+$&#47;&#47;&#39; -- file | perl -i -00pe0</code> however the output still goes to the console, why is that? Maybe it&#39;s because in the last part of the pipe the input file is stdout, so how can I push the changes to the original file?"}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1514467187, "post_id": 47991632, "comment_id": 82984647, "body": "Either try the one call version, or redirect output to a temp file and rename it to the original afterwards. That&#39;s what <code>-i</code> does, anyway."}, {"owner": {"reputation": 10448, "user_id": 784980, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d9c4540c5478352227f3ed3c3316ad8c?s=128&d=identicon&r=PG", "display_name": "rapt", "link": "https://stackoverflow.com/users/784980/rapt"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514493987, "post_id": 47991632, "comment_id": 82997181, "body": "@Borodin what is horrible about it?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 10448, "user_id": 784980, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d9c4540c5478352227f3ed3c3316ad8c?s=128&d=identicon&r=PG", "display_name": "rapt", "link": "https://stackoverflow.com/users/784980/rapt"}, "edited": false, "score": 0, "creation_date": 1514517668, "post_id": 47991632, "comment_id": 83003193, "body": "@rapt: Can you explain what it does?"}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": false, "score": 6, "last_activity_date": 1514375875, "last_edit_date": 1514375875, "creation_date": 1514375277, "answer_id": 47991632, "question_id": 47991341, "link": "https://stackoverflow.com/questions/47991341/remove-all-consecutive-blank-lines-leaving-just-one-perl-00-pe/47991632#47991632", "title": "Remove all consecutive blank lines, leaving just one: perl -00 -pe &#39;&#39;", "body": "<p>It's better to read the official documentation when in doubt. See <code>-0</code> in <a href=\"http://p3rl.org/perlrun\" rel=\"noreferrer\">perlrun</a> and <code>$/</code> in <a href=\"http://p3rl.org/perlvar\" rel=\"noreferrer\">perlvar</a>.</p>\n\n<p>The text should have said</p>\n\n<blockquote>\n  <p>A paragraph is text <strong>delimited</strong> by two <strong>or more</strong> newlines. </p>\n</blockquote>\n\n<p>\"All other newlines\" then become the newlines that don't come in pairs. \"Ignored\" means they don't separate paragraphs, but they are included in the strings read from the input.</p>\n\n<p><code>-e0</code> just executes <code>0</code> as the code. 0 and 1 are exempt from <a href=\"http://p3rl.org/warnings\" rel=\"noreferrer\">warnings</a>, any other value would work too, but with <code>-w</code> would warn you:</p>\n\n<pre><code>Useless use of a constant (2) in void context at -e line 1.\n</code></pre>\n\n<p>To achieve what you want, you can process the file in two steps: First, remove any whitespace from whitespace only lines</p>\n\n<pre><code>perl -lpe 's/^\\s+$//'\n</code></pre>\n\n<p>(The <code>-l</code> is needed not to remove the newlines together with all the whitespace ).</p>\n\n<p>Then run the already known</p>\n\n<pre><code>perl -00pe0\n</code></pre>\n\n<p>So, the whole pipeline becomes </p>\n\n<pre><code>perl -lpe 's/^\\s+$//' -- file | perl -00pe0\n</code></pre>\n\n<p>You can, of course, do all the work in one call to <code>perl</code>:</p>\n\n<pre><code>perl -ne 'if (/\\S/)         { $in_sep = ! print }\n          elsif (! $in_sep) { $in_sep = print \"\\n\" }' -- file\n</code></pre>\n\n<p>$in_sep remembers whether we are \"in a separator\", only the first time we enter such a whitespace block a newline is printed.</p>\n"}, {"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514390744, "post_id": 47993121, "comment_id": 82958382, "body": "Please don&#39;t compress your code when writing an answer. While you may want to inflict illegible code on yourself, it is inappropriate to do make an answer on <i>Stack Overflow</i> so opaque."}, {"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514391271, "post_id": 47993121, "comment_id": 82958632, "body": "@Borodin, thank you for your feedback, the reason of short code was one-liner, i agree with some space it&#39;s easier to understand."}, {"owner": {"reputation": 10448, "user_id": 784980, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d9c4540c5478352227f3ed3c3316ad8c?s=128&d=identicon&r=PG", "display_name": "rapt", "link": "https://stackoverflow.com/users/784980/rapt"}, "edited": false, "score": 0, "creation_date": 1514427267, "post_id": 47993121, "comment_id": 82970109, "body": "@NahuelFouilleul The first one you suggested was actually easier to understand, once I figured out the regex :) Is the second one going to work if the chunk cuts a white paragraph in the middle? Could I not get at least 2 newlines for it?"}, {"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "edited": false, "score": 0, "creation_date": 1514442356, "post_id": 47993121, "comment_id": 82973467, "body": "just for info <code>\\s</code> matches also <code>\\n</code> and because of greediness by default matches the longest match, the case of a chunk which ends in the middle of a white paragraph is handled by while loop, i just added this answer to show it existed another way to do it but the other answer may be easier in case of large files (more than 100M). Note that any delimiter other than newline or blank can be used for example <code>perl -0056pe&#39;s&#47;\\n\\s+\\n&#47;\\n\\n&#47;g&#39;</code> should work also"}], "tags": [], "owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "is_accepted": false, "score": 1, "last_activity_date": 1514442681, "last_edit_date": 1514442681, "creation_date": 1514381587, "answer_id": 47993121, "question_id": 47991341, "link": "https://stackoverflow.com/questions/47991341/remove-all-consecutive-blank-lines-leaving-just-one-perl-00-pe/47993121#47993121", "title": "Remove all consecutive blank lines, leaving just one: perl -00 -pe &#39;&#39;", "body": "<p>The <a href=\"https://metacpan.org/pod/B::Deparse\" rel=\"nofollow noreferrer\"><code>B::Deparse</code></a> module\nmay be used to reveal the effective code behind a one-line program.\nIt can be enabled in a one-liner by adding <code>-MO=Deparse</code> like this</p>\n\n<pre><code>perl -MO=Deparse -00 -p -e 0\n</code></pre>\n\n<p>The <code>-0</code> option sets the value of <code>$/</code>: the <em>input record separator</em>, and setting it to empty string <code>\"\"</code> with <code>-00</code> enables \"paragraph mode\" which means the input will be split at one or more blank lines</p>\n\n<p>Another special values for <code>-0</code> are <code>-0777</code>, which disables the record separator so that the whole file is read. And <code>$/</code> may be set to <code>\\&lt;number&gt;</code>, like <code>\\8192</code>, so as to input records with a fixed length, but this is unavailable through the <code>-0</code> option</p>\n\n<p>If the file is not too long, read the whole file</p>\n\n<pre><code>perl -0777 -pe 's/\\n\\s+\\n/\\n\\n/g'\n</code></pre>\n\n<p>Otherwise the file can be read in chunks of, say, 8192 bytes, but in certain cases the next chunk must be read before processing.</p>\n\n<pre><code>perl -pe 'BEGIN { $/ = \\8192} $_ .= &lt;&gt; while /\\n\\s*$/ &amp;&amp; ! eof; s/\\n\\s+\\n/\\n\\n/g'\n</code></pre>\n"}], "owner": {"reputation": 10448, "user_id": 784980, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d9c4540c5478352227f3ed3c3316ad8c?s=128&d=identicon&r=PG", "display_name": "rapt", "link": "https://stackoverflow.com/users/784980/rapt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1514442681, "creation_date": 1514373963, "question_id": 47991341, "link": "https://stackoverflow.com/questions/47991341/remove-all-consecutive-blank-lines-leaving-just-one-perl-00-pe", "title": "Remove all consecutive blank lines, leaving just one: perl -00 -pe &#39;&#39;", "body": "<p>I try to understand the following Perl command to \"remove all consecutive blank lines, leaving just one\":</p>\n\n<pre><code>perl -00 -pe ''\n</code></pre>\n\n<p>From <a href=\"http://www.catonmat.net/blog/perl-one-liners-explained-part-one/\" rel=\"nofollow noreferrer\">Perl One-Liners Explained</a>:</p>\n\n<blockquote>\n  <p>First of all it does not have any code, the -e is empty. Next it has a\n  silly -00 command line option. This command line option turns\n  paragraph slurp mode on. A paragraph is text between two newlines. All\n  the other newlines get ignored. The paragraph gets put in \"$_\" and the\n  \"-p\" option prints it out.</p>\n</blockquote>\n\n<p>I do not follow this explanation. Maybe the wording is not accurate.</p>\n\n<p>So <code>\"A paragraph is text between two newlines.\"</code> But every line is text between two newlines.</p>\n\n<p><code>\"All the other newlines get ignored.\"</code> But there are no newlines between two successive newlines.</p>\n\n<p><code>\"The paragraph gets put in \"$_\" and the \"-p\" option prints it out.\"</code> Since it does it to the text between every two newlines, that would cram together the whole file into one long line. How does it look like what they say this command is supposed to do?</p>\n\n<p>It also says that an alternative way to write it is</p>\n\n<pre><code>perl -00pe0\n</code></pre>\n\n<p>What does the rightmost <code>0</code> represent?</p>\n\n<p>Anyway, What I actually want to achieve is to <strong>remove all consecutive white lines</strong>, leaving just <strong>one empty line</strong>. By white line I mean a line that may be not empty, but only has whitespace characters (and newline).\nIs it possible to modify the above command to match this case?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 14615, "user_id": 1684868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab2875ba0868842943b778ecd75c588?s=128&d=identicon&r=PG", "display_name": "Guru", "link": "https://stackoverflow.com/users/1684868/guru"}, "edited": false, "score": 0, "creation_date": 1514374005, "post_id": 47991200, "comment_id": 82950918, "body": "What is your expected output?"}, {"owner": {"reputation": 416, "user_id": 2950354, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NQdzV.jpg?s=128&g=1", "display_name": "Noosrep", "link": "https://stackoverflow.com/users/2950354/noosrep"}, "reply_to_user": {"reputation": 14615, "user_id": 1684868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab2875ba0868842943b778ecd75c588?s=128&d=identicon&r=PG", "display_name": "Guru", "link": "https://stackoverflow.com/users/1684868/guru"}, "edited": false, "score": 0, "creation_date": 1514374331, "post_id": 47991200, "comment_id": 82951066, "body": "@Guru Added the expected output to the question"}], "answers": [{"comments": [{"owner": {"reputation": 416, "user_id": 2950354, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NQdzV.jpg?s=128&g=1", "display_name": "Noosrep", "link": "https://stackoverflow.com/users/2950354/noosrep"}, "edited": false, "score": 0, "creation_date": 1514388073, "post_id": 47991825, "comment_id": 82957195, "body": "Could you explain the subfunction?"}], "tags": [], "owner": {"reputation": 14615, "user_id": 1684868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab2875ba0868842943b778ecd75c588?s=128&d=identicon&r=PG", "display_name": "Guru", "link": "https://stackoverflow.com/users/1684868/guru"}, "is_accepted": false, "score": 0, "last_activity_date": 1514376044, "creation_date": 1514376044, "answer_id": 47991825, "question_id": 47991200, "link": "https://stackoverflow.com/questions/47991200/perl-which-line-belongs-to-which-category/47991825#47991825", "title": "Perl which line belongs to which category", "body": "<p>One way:</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\nuse Data::Dumper;\n$\\=\"\\n\";\n\nsub getEmptyIfNull{\n    my $val = shift;\n    if (not defined $val){\n        return \"\";\n    }else{\n        return $val . \"\\n\";\n    }\n}\n\n\nmy %data;\nmy ($tagged,$untagged)=(\"\",\"\");\nwhile(&lt;DATA&gt;){\n    chomp;\n    if (/^Tagged/){\n        $tagged=\"Y\";\n        $untagged=\"N\";\n    }elsif (/^Untagged/){\n        $untagged=\"Y\";\n        $tagged=\"N\";\n    }\n\n    if (/\\d+\\/\\d+\\/\\d+/){\n        if ($tagged eq \"Y\"){\n            $data{\"Tagged\"} = getEmptyIfNull($data{\"Tagged\"}) . $_;\n        }elsif ($untagged eq \"Y\"){\n            $data{\"Untagged\"} = getEmptyIfNull($data{\"Untagged\"}) . $_;\n        }\n    }\n}\n    print Dumper \\%data;\n\n\n__DATA__\ndis vlan 100\nVLAN ID: 100\nVLAN Type: static\nRoute Interface: configured\nIP Address: x.x.x.\nSubnet Mask: y.y.y.y\nDescription: Text\nName: SomeMoreText\nTagged   Ports:\nBridge-Aggregation1      Bridge-Aggregation2      Bridge-Aggregation3\nBridge-Aggregation6\nTen-GigabitEthernet1/0/18\nTen-GigabitEthernet1/0/20\nTen-GigabitEthernet1/0/21\nUntagged Ports:\nTen-GigabitEthernet1/0/1\nTen-GigabitEthernet1/0/2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 416, "user_id": 2950354, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NQdzV.jpg?s=128&g=1", "display_name": "Noosrep", "link": "https://stackoverflow.com/users/2950354/noosrep"}, "edited": false, "score": 0, "creation_date": 1514383196, "post_id": 47991958, "comment_id": 82955051, "body": "Mmmh, my dumper is empty now but could be that I did something wrong. Will check further"}, {"owner": {"reputation": 416, "user_id": 2950354, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NQdzV.jpg?s=128&g=1", "display_name": "Noosrep", "link": "https://stackoverflow.com/users/2950354/noosrep"}, "edited": false, "score": 0, "creation_date": 1514388046, "post_id": 47991958, "comment_id": 82957181, "body": "Can&#39;t seem to get it working this way @choroba. Could you try your code with mine? So not through a while &lt;DATA&gt; but with my foreach"}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "reply_to_user": {"reputation": 416, "user_id": 2950354, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NQdzV.jpg?s=128&g=1", "display_name": "Noosrep", "link": "https://stackoverflow.com/users/2950354/noosrep"}, "edited": false, "score": 0, "creation_date": 1514413504, "post_id": 47991958, "comment_id": 82967155, "body": "Just replace <code>while (&lt;DATA&gt;)</code> by <code>for (split &#47;\\n&#47;, $getSpecificVlanValue)</code>."}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 0, "last_activity_date": 1514386141, "last_edit_date": 1514386141, "creation_date": 1514376600, "answer_id": 47991958, "question_id": 47991200, "link": "https://stackoverflow.com/questions/47991200/perl-which-line-belongs-to-which-category/47991958#47991958", "title": "Perl which line belongs to which category", "body": "<p>Create a \"flag\" variable that remembers the port type ($mode in the example below):</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nmy $vlan_id = 'id';\nmy %data;\n\nmy $mode;\nwhile (&lt;DATA&gt;) {\n    chomp;\n    if (/Tagged   Ports:/) {\n        $mode = 'tagged';\n    } elsif (/Untagged Ports:/) {\n        $mode = 'untagged';\n    } elsif (my ($key, $value) = /(.*):(.*)/) {\n        $data{$vlan_id}{$key} = $value;\n    } elsif (m{\\d/\\d+/\\d} &amp;&amp; $mode) {\n        push @{ $data{$vlan_id}{$mode} }, $_;\n    }\n}\n\nuse Data::Dumper; print Dumper \\%data;\n\n__DATA__\ndis vlan 100\nVLAN ID: 100\nVLAN Type: static\nRoute Interface: configured\nIP Address: x.x.x.\nSubnet Mask: y.y.y.y\nDescription: Text\nName: SomeMoreText\nTagged   Ports:\nBridge-Aggregation1      Bridge-Aggregation2      Bridge-Aggregation3\nBridge-Aggregation6\nTen-GigabitEthernet1/0/18\nTen-GigabitEthernet1/0/20\nTen-GigabitEthernet1/0/21\nUntagged Ports:\nTen-GigabitEthernet1/0/1\nTen-GigabitEthernet1/0/2\n</code></pre>\n"}], "owner": {"reputation": 416, "user_id": 2950354, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NQdzV.jpg?s=128&g=1", "display_name": "Noosrep", "link": "https://stackoverflow.com/users/2950354/noosrep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 47991958, "answer_count": 2, "score": 1, "last_activity_date": 1514386141, "creation_date": 1514373363, "last_edit_date": 1514374306, "question_id": 47991200, "link": "https://stackoverflow.com/questions/47991200/perl-which-line-belongs-to-which-category", "title": "Perl which line belongs to which category", "body": "<p>I have following output:</p>\n\n<pre><code>dis vlan 100\nVLAN ID: 100\nVLAN Type: static\nRoute Interface: configured\nIP Address: x.x.x.\nSubnet Mask: y.y.y.y\nDescription: Text\nName: SomeMoreText\nTagged   Ports:\nBridge-Aggregation1      Bridge-Aggregation2      Bridge-Aggregation3\nBridge-Aggregation6\nTen-GigabitEthernet1/0/18\nTen-GigabitEthernet1/0/20\nTen-GigabitEthernet1/0/21\nUntagged Ports:\nTen-GigabitEthernet1/0/1\nTen-GigabitEthernet1/0/2\n</code></pre>\n\n<p>and I'm trying to map which ports are know to the vlan and in what kind of way (tagged or untagged). I'm having some problems with determing if a port is tagged or untagged. The code:</p>\n\n<pre><code>foreach my $specificVlanLine (split \"\\n\",$getSpecificVlanValue){\n    chomp $specificVlanLine ;\n    if ( $specificVlanLine =~ m/dis vlan/ ){\n        #do nothing\n    } else {\n        if ( index($specificVlanLine, \":\" ) != -1) {\n            my @specificVlanSplit = split(\":\", $specificVlanLine) ;\n            $specificVlanSplit[0] =~ s/\\s+//g;\n            $data{$vlanID}{$specificVlanSplit[0]} = $specificVlanSplit[1] ;\n        } elsif ( $specificVlanLine =~ m/\\d+\\/\\d+\\/\\d+/ ) {\n            $specificVlanLine =~ s/\\s+//g;\n            $data{$vlanID}{\"TaggedPorts\"} .= \"$specificVlanLine \\n\" ;\n    }\n}\n</code></pre>\n\n<p><code>$getSpecificVlanValue</code> is the complete output with which I started this question. </p>\n\n<p>The problem is that every interface is put in taggedPorts. Which makes sense but how can I determine which Ethernet port is Tagged and which is Untagged?</p>\n\n<pre><code>TaggedPorts' =&gt; 'Ten-GigabitEthernet1/0/18\n  Ten-GigabitEthernet1/0/20\n  Ten-GigabitEthernet1/0/21\n  Ten-GigabitEthernet2/0/18\n  Ten-GigabitEthernet1/0/1\n  Ten-GigabitEthernet1/0/2\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>TaggedPorts' =&gt; 'Ten-GigabitEthernet1/0/18\n  Ten-GigabitEthernet1/0/20\n  Ten-GigabitEthernet1/0/21\n  Ten-GigabitEthernet2/0/18\nUntaggedPorts' =&gt; 'Ten-GigabitEthernet1/0/1\n  Ten-GigabitEthernet1/0/2\n</code></pre>\n"}, {"tags": ["macos", "perl", "cpan", "getopts", "cpanm"], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 5247484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74ee6c59550a64a34726176580d6baed?s=128&d=identicon&r=PG&f=1", "display_name": "sirius", "link": "https://stackoverflow.com/users/5247484/sirius"}, "edited": false, "score": 0, "creation_date": 1514469377, "post_id": 47991210, "comment_id": 82985702, "body": "Are there any document sites where I can search for the module that I need?"}, {"owner": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "reply_to_user": {"reputation": 375, "user_id": 5247484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74ee6c59550a64a34726176580d6baed?s=128&d=identicon&r=PG&f=1", "display_name": "sirius", "link": "https://stackoverflow.com/users/5247484/sirius"}, "edited": false, "score": 0, "creation_date": 1526312057, "post_id": 47991210, "comment_id": 87684319, "body": "@sirius, you can find the details in the answer below, but the quick version is:   <a href=\"http://search.cpan.org\" rel=\"nofollow noreferrer\">http://search.cpan.org</a>  or   <a href=\"https://metacpan.org\" rel=\"nofollow noreferrer\">https://metacpan.org</a>."}], "tags": [], "owner": {"reputation": 185733, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 3, "last_activity_date": 1514373410, "creation_date": 1514373410, "answer_id": 47991210, "question_id": 47990911, "link": "https://stackoverflow.com/questions/47990911/which-module-do-i-need-when-i-got-error-info-cant-locate-getopts-pl-in-inc/47991210#47991210", "title": "Which module do I need when I got error info &quot;Can&#39;t locate getopts.pl in @INC...&quot;", "body": "<p>It's <a href=\"https://metacpan.org/pod/Perl4::CoreLibs\" rel=\"nofollow noreferrer\">Perl4::CoreLibs</a>. In general the Debian package <code>libthis-that-perl</code> corresponds to a module named <code>This::That</code>, although it's up to you to figure out the capitalization :)</p>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "is_accepted": false, "score": 2, "last_activity_date": 1526311957, "last_edit_date": 1526311957, "creation_date": 1526088079, "answer_id": 50302034, "question_id": 47990911, "link": "https://stackoverflow.com/questions/47990911/which-module-do-i-need-when-i-got-error-info-cant-locate-getopts-pl-in-inc/50302034#50302034", "title": "Which module do I need when I got error info &quot;Can&#39;t locate getopts.pl in @INC...&quot;", "body": "<p>I'm not sure how the package manager works with macOS, but a platform-independent way of installing the <code>getopts</code> package.</p>\n\n<p>To answer the question you put as a comment to the answer from @hobbs, the way I searche for a module I need is either through the site that @hobbs linked, <a href=\"https://metacpan.org\" rel=\"nofollow noreferrer\">https://metacpan.org</a>, or, alternatively, <a href=\"http://search.cpan.org/\" rel=\"nofollow noreferrer\">http://search.cpan.org</a>. It was at the second that I found what I needed. </p>\n\n<p>Searching for <code>getopts.pl</code> gave a link to \"Perl4::CoreLibs\". In the upper-right-hand corner, there was a link that said Perl4-CoreLibs-0.003.tar.gz (though it looks like there is a 0.004 now). I right-clicked and selected \"copy link address\", which gave me </p>\n\n<p><code>http://search.cpan.org/CPAN/authors/id/Z/ZE/ZEFRAM/Perl4-CoreLibs-0.004.tar.gz</code> </p>\n\n<p>Whatever your link is, you'll need to untar it and find all the <code>*.pl</code> files in the <code>lib</code> directory into a directory, and either</p>\n\n<p>1) Link to them from the command line, e.g.</p>\n\n<pre><code>perl -I /path/to/where/you/untarred/lib ~/Desktop/blif2cnf.pl\n</code></pre>\n\n<p>or</p>\n\n<p>2) Add them to your <code>PERLLIB</code> environment variable.</p>\n\n<p>I think that more details will be helpful.</p>\n\n<hr>\n\n<h3>Detailed Instructions</h3>\n\n<p>Figure out a directory where you want to download your <code>*.pl</code> files. I used <code>$HOME/new_perl_stuff</code></p>\n\n<pre><code>cd ~\n\nmkdir new_perl_stuff\n\ncd new_perl_stuff\n</code></pre>\n\n<p>Now, get the tarball</p>\n\n<pre><code>wget http://search.cpan.org/CPAN/authors/id/Z/ZE/ZEFRAM/Perl4-CoreLibs-0.004.tar.gz\n</code></pre>\n\n<p>untar it, go into the directory, and make sure <code>lib</code> is there</p>\n\n<pre><code>$ tar -xzf Perl4-CoreLibs-0.004.tar.gz\n\n$ cd Perl4-CoreLibs-0.004\n\n$ ls\n</code></pre>\n\n<p>You should see <code>lib</code> in the list.</p>\n\n<p>It's possible to add your newly downloaded <code>lib</code> directory (in my case, <code>$HOME/new_perl_stuff/Perl4-CoreLibs-0.004/lib</code>) to the <code>perl</code> search path, but this just makes me worry about another directory that I might delete at some time. I made a new folder in the <code>/usr/lib</code> directory. I decided to name the new directory <code>libperl4-corelibs-perl</code>, since that seemed standard. First, I checked to make sure that there wasn't already a directory with that name.</p>\n\n<pre><code>$ stat /usr/lib/libperl4-corelibs-perl\nstat: cannot stat '/usr/lib/libperl4-corelibs-perl': No such file or directory\n</code></pre>\n\n<p>Then I made the directory.</p>\n\n<pre><code>mkdir /usr/lib/libperl4-corelibs-perl\n</code></pre>\n\n<p>The next step was copying all the <code>*.pl</code> files into this directory. I hope to explain this next command later. I ran it this way to make sure all of the files I needed were there. From my <code>$HOME/new_perl_stuff/Perl4-CoreLibs-0.004</code> directory, I ran the following command, which I plan to come back and explain.</p>\n\n<pre><code>find ./lib -type f -name \"*.pl\" -print0 | xargs -I'{}' -0 \\\nbash -c 'new_dir=/usr/lib/libperl4-corelibs-perl/; chmod +x {}; \\\necho \"Moving {}\"; mv {} ${new_dir} &amp;&amp; echo -e \"success\\n\" || \\\necho -e \"failure\\n\"' | tee moving_day.log\n</code></pre>\n\n<p>Run that one if you want to see that everything got copied successfully. A shorter command that does everything necessary is:</p>\n\n<pre><code>find ./lib -type f -name \"*.pl\" -print0 | xargs -I'{}' -0 \\\nbash -c 'new_dir=/usr/lib/libperl4-corelibs-perl/; chmod +x {}; \\\nmv {} ${new_dir}'  \n</code></pre>\n\n<p>It's not a bad idea to run</p>\n\n<pre><code>ls -lah /usr/lib/libperl4-corelibs-perl\n</code></pre>\n\n<p>to check that the <code>*.pl</code> files are there.</p>\n\n<p>You can now run</p>\n\n<pre><code>perl -I /usr/lib/libperl4-corelibs-perl ~/Desktop/blif2cnf.pl\n</code></pre>\n\n<p>but there's an easier way.</p>\n\n<p>Finally, I made it so that this directory will become part of the <code>perl</code> search path every time I use a terminal by adding the following line to my <code>~/.bashrc</code>\nThis command adds the path to the <code>PERLLIB</code> environment variable. Different flavors of Linux have different syntax for adding to environment variables, <strong>make sure to find out what yours is!</strong></p>\n\n<pre><code>export PERLLIB=\"/usr/bin/libperl4-corelibs-perl:$PERLLIB\"\n</code></pre>\n\n<p>The commands I ran for this were</p>\n\n<pre><code>$ echo -e \"\\n\\n## allow Perl to use the files in Perl4::CoreLibs\" &gt;&gt; $HOME/.bashrc\n\n$ echo -e \"export PERLLIB=\\\"/usr/lib/libperl4_corelibs_perl:$PERLLIB\\\"\" &gt;&gt; $HOME/.bashrc\n\n$ source .bashrc\n</code></pre>\n\n<p>Now, you can simply run</p>\n\n<pre><code>perl ~/Desktop/blif2cnf.pl\n</code></pre>\n\n<hr/>\n\n<p><strong>Note</strong>: It's probably a good idea to go back and remove unwanted extras:</p>\n\n<pre><code>rm -rf $HOME/new_perl_stuff\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 5247484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74ee6c59550a64a34726176580d6baed?s=128&d=identicon&r=PG&f=1", "display_name": "sirius", "link": "https://stackoverflow.com/users/5247484/sirius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2283, "favorite_count": 1, "accepted_answer_id": 47991210, "answer_count": 2, "score": 1, "last_activity_date": 1526311957, "creation_date": 1514372094, "last_edit_date": 1514373076, "question_id": 47990911, "link": "https://stackoverflow.com/questions/47990911/which-module-do-i-need-when-i-got-error-info-cant-locate-getopts-pl-in-inc", "title": "Which module do I need when I got error info &quot;Can&#39;t locate getopts.pl in @INC...&quot;", "body": "<p>I run this command in my macOS</p>\n\n<pre><code>$ perl ~/Desktop/blif2cnf.pl\n</code></pre>\n\n<p>and got this error info:</p>\n\n<pre><code>Can't locate getopts.pl in @INC (@INC contains: /Library/Perl/5.18/darwin-thread-multi-2level /Library/Perl/5.18 /Network/Library/Perl/5.18/darwin-thread-multi-2level /Network/Library/Perl/5.18 /Library/Perl/Updates/5.18.2 /System/Library/Perl/5.18/darwin-thread-multi-2level /System/Library/Perl/5.18 /System/Library/Perl/Extras/5.18/darwin-thread-multi-2level /System/Library/Perl/Extras/5.18 .) at /Users/Frank/Desktop/blif2cnf.pl line 10.\n</code></pre>\n\n<p>In my linux 16.04, such problem can be solved by following <a href=\"https://unix.stackexchange.com/a/233386\">this answer</a></p>\n\n<p>Is there a module like <code>libperl4-corelibs-perl</code> in macOS?</p>\n\n<p>I know CPAN, but I don't know which module should I install.</p>\n"}, {"tags": ["perl", "dbi", "dbix-class"], "answers": [{"tags": [], "owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "is_accepted": false, "score": 0, "last_activity_date": 1514368823, "last_edit_date": 1592644375, "creation_date": 1514368823, "answer_id": 47990045, "question_id": 47989825, "link": "https://stackoverflow.com/questions/47989825/setting-dbi-longreadlen-in-dbicdump/47990045#47990045", "title": "Setting DBI LongReadLen in dbicdump", "body": "<p>You set that parameter in <a href=\"http://search.cpan.org/%7Epythian/DBD-Oracle-1.74/lib/DBD/Oracle.pm#LongReadLen\" rel=\"nofollow noreferrer\">DBD::Oracle</a></p>\n<blockquote>\n<h1>LongReadLen</h1>\n<p>The maximum size of long or longraw columns to retrieve. If one of these columns is longer than LongReadLen then either a data truncation error will be raised (LongTrunkOk is false) or the column will be silently truncated (LongTruncOk is true).</p>\n<p>DBI currently defaults this to 80.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 166, "user_id": 1335338, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/33c6c05b8eb848b74e33ca48c5a63a74?s=128&d=identicon&r=PG", "display_name": "kuronue", "link": "https://stackoverflow.com/users/1335338/kuronue"}, "edited": false, "score": 0, "creation_date": 1514436526, "post_id": 47990639, "comment_id": 82971888, "body": "I tried it but it does not work. I even used with <code>LongTruncOk</code>. Both did not take effect: <code>dbicdump -o dump_directory=.&#47;lib -o components=&#39;[&quot;InflateColumn::DateTime&quot;]&#39; -o debug=1  My::Schema -o preserve_case=1 &#39;dbi:Oracle:mydbhost&#47;mydbsid&#39; user password &#39;{ on_connect_do =&gt; sub { shift-&gt;_dbh-&gt;{LongTruncOk} = 1 }&#39;</code>   Am i missing anything?"}], "tags": [], "owner": {"reputation": 185733, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1514370972, "creation_date": 1514370972, "answer_id": 47990639, "question_id": 47989825, "link": "https://stackoverflow.com/questions/47989825/setting-dbi-longreadlen-in-dbicdump/47990639#47990639", "title": "Setting DBI LongReadLen in dbicdump", "body": "<p>DBD::Oracle doesn't seem to take handle attributes as arguments to <code>connect</code>, which makes this a little bit difficult, but luckily DBIC and dbicdump have a way to work around it. Run dbicdump like this:</p>\n\n<pre><code>dbicdump &lt;options&gt; dbi:Oracle:blah username password \\\n'{ on_connect_do =&gt; sub { shift-&gt;_dbh-&gt;{LongReadLen} = 123456 }'\n</code></pre>\n\n<p>dbicdump recognizes if an extra parameter (after the DSN, username, and password) looks like a perl data structure or subroutine and runs it through <code>eval</code> if so, and DBIx::Class::Storage::DBI has <a href=\"https://metacpan.org/pod/DBIx::Class::Storage::DBI#on_connect_do\" rel=\"nofollow noreferrer\">on_connect_do</a> which can run either SQL or arbitrary code against the handle whenever a connection is made. In this case we can use it to set the LongReadLen attr to whatever value you want.</p>\n\n<p>If you are using the 1-arg version of dbicdump to get options from a config file, you're probably out of luck, unless your loader is <code>Config::Any::Perl</code>, in which case you can specify the sub the same way, via the <code>connect_info</code>/<code>options</code>/<code>on_connect_do</code> key.</p>\n"}], "owner": {"reputation": 166, "user_id": 1335338, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/33c6c05b8eb848b74e33ca48c5a63a74?s=128&d=identicon&r=PG", "display_name": "kuronue", "link": "https://stackoverflow.com/users/1335338/kuronue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1514370972, "creation_date": 1514367981, "question_id": 47989825, "link": "https://stackoverflow.com/questions/47989825/setting-dbi-longreadlen-in-dbicdump", "title": "Setting DBI LongReadLen in dbicdump", "body": "<p>I'm trying to dump my Oracle schema but unfortunately hit with the <code>ORA-24345</code> error. From my reading it looks like I need to set the <code>LongReadLen</code> option on the database handle. </p>\n\n<p>However, I cannot find the way to set this parameter in <code>dbicdump</code>. Appreciate any help on this. </p>\n\n<p>Thanks for the help. </p>\n"}, {"tags": ["bash", "perl"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1514361524, "post_id": 47988085, "comment_id": 82945491, "body": "Tip: <code>-0</code> doesn&#39;t actually slurp the file. You should use <code>-0777</code> instead."}, {"owner": {"reputation": 10448, "user_id": 784980, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d9c4540c5478352227f3ed3c3316ad8c?s=128&d=identicon&r=PG", "display_name": "rapt", "link": "https://stackoverflow.com/users/784980/rapt"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1514362899, "post_id": 47988085, "comment_id": 82945940, "body": "@ikegami How was it able then to process the file not line by line?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1514544075, "post_id": 47988085, "comment_id": 83011551, "body": "Read up on the difference between <code>$&#47; = &quot;\\0&quot;;</code> (<code>-0</code>) and <code>$&#47; = undef;</code> (<code>-0777</code>). It&#39;s not the intent of the first to slurp (and won&#39;t always)."}], "answers": [{"comments": [{"owner": {"reputation": 10448, "user_id": 784980, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d9c4540c5478352227f3ed3c3316ad8c?s=128&d=identicon&r=PG", "display_name": "rapt", "link": "https://stackoverflow.com/users/784980/rapt"}, "edited": false, "score": 0, "creation_date": 1514362123, "post_id": 47988230, "comment_id": 82945694, "body": "Thank you! Now it makes sense!"}], "tags": [], "owner": {"reputation": 14615, "user_id": 1684868, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dab2875ba0868842943b778ecd75c588?s=128&d=identicon&r=PG", "display_name": "Guru", "link": "https://stackoverflow.com/users/1684868/guru"}, "is_accepted": true, "score": 2, "last_activity_date": 1514360729, "last_edit_date": 1514360729, "creation_date": 1514360388, "answer_id": 47988230, "question_id": 47988085, "link": "https://stackoverflow.com/questions/47988085/redirect-perl-command-output-to-file/47988230#47988230", "title": "Redirect Perl command output to file", "body": "<p>You are trying to read from a file and trying to re-direct the output to the same file. This does not work. Shell first opens the file for writing, now when Perl tries to read from the file, there is nothing present, and hence no output.</p>\n\n<p>You can use the <code>-i</code> option of Perl to do in-place edit.</p>\n\n<pre><code>perl -i.bak -0pe 's|//.*?\\n|\\n|g; s#/\\*(.|\\n)*?\\*/##g; s/\\n\\n+/\\n\\n/g' \"$file\"\n</code></pre>\n\n<p>This will edit the file directly and also have the original copy of the file with a .bak extension. If you do not need any backup, simply use <code>-i</code> in place of <code>-i.bak</code></p>\n"}], "owner": {"reputation": 10448, "user_id": 784980, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d9c4540c5478352227f3ed3c3316ad8c?s=128&d=identicon&r=PG", "display_name": "rapt", "link": "https://stackoverflow.com/users/784980/rapt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 47988230, "answer_count": 1, "score": 0, "last_activity_date": 1514360729, "creation_date": 1514359579, "question_id": 47988085, "link": "https://stackoverflow.com/questions/47988085/redirect-perl-command-output-to-file", "title": "Redirect Perl command output to file", "body": "<p>In a bash script, I try to call the following Perl command on each file, and then I want to redirect the Perl command's output to that file.</p>\n\n<p>The Perl command simply <a href=\"https://stackoverflow.com/a/24911378/784980\">removes the comments from the file</a>. When it prints to the console it seems to work. But when I try to redirect the output to each individual file, the file becomes empty. What am I doing wrong here?</p>\n\n<pre><code>#!/usr/bin/env bash\n\nshopt -s globstar\nfor file in ./**/*.java; do\n    perl -0pe 's|//.*?\\n|\\n|g; s#/\\*(.|\\n)*?\\*/##g; s/\\n\\n+/\\n\\n/g' \"$file\" &gt; \"$file\";\ndone\n</code></pre>\n"}, {"tags": ["apache", "perl", "mod-perl", "mod-perl2"], "comments": [{"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1514355385, "post_id": 47986595, "comment_id": 82943197, "body": "maybe with <a href=\"https://metacpan.org/pod/Apache2::RequestRec#subprocess_env\" rel=\"nofollow noreferrer\">metacpan.org/pod/Apache2::RequestRec#subprocess_env</a> ? I can&#39;t tell for sure."}, {"owner": {"reputation": 170, "user_id": 5389125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MOQuJ.png?s=128&g=1", "display_name": "Rossman", "link": "https://stackoverflow.com/users/5389125/rossman"}, "reply_to_user": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1514375645, "post_id": 47986595, "comment_id": 82951611, "body": "@ysth - That&#39;s what I thought too, but I can&#39;t seem to access any variables from that method. To be clear, that table appears to be empty."}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1514398047, "post_id": 47986595, "comment_id": 82961467, "body": "don&#39;t have time to try, but this looks like it: <a href=\"https://perl.apache.org/docs/2.0/api/Apache2/ServerUtil.html#C_dir_config_\" rel=\"nofollow noreferrer\">perl.apache.org/docs/2.0/api/Apache2/&hellip;</a>"}, {"owner": {"reputation": 170, "user_id": 5389125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MOQuJ.png?s=128&g=1", "display_name": "Rossman", "link": "https://stackoverflow.com/users/5389125/rossman"}, "reply_to_user": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1514401132, "post_id": 47986595, "comment_id": 82962712, "body": "@ysth - Unfortunately that method only works with variables set using PerlSetVar and PerlAddVar in the Apache config. I&#39;m trying to get a value set with SetEnv because the value is also used outside of mod_perl. I&#39;m trying to avoid having to configure the variable twice, once with SetEnv and once with PerlSetVar."}], "owner": {"reputation": 170, "user_id": 5389125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MOQuJ.png?s=128&g=1", "display_name": "Rossman", "link": "https://stackoverflow.com/users/5389125/rossman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 823, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514351124, "creation_date": 1514351124, "question_id": 47986595, "link": "https://stackoverflow.com/questions/47986595/access-apache-environment-variables-from-mod-perl-without-env", "title": "Access Apache environment variables from mod_perl without %ENV", "body": "<p>I using Apache 2.2 and mod_perl 2.0.4.  I want to retrieve the value of an environment variable named \"A_VARIABLE\" in a mod_perl handler which was set in an Apache configuration file as:</p>\n\n<pre><code>SetEnv A_VARIABLE  \"some value\"\n</code></pre>\n\n<p>In the <a href=\"https://perl.apache.org/docs/1.0/guide/config.html#PerlSetupEnv\" rel=\"nofollow noreferrer\">mod_perl documentation about the PerlSetEnv configuration option</a>, it says the following:</p>\n\n<blockquote>\n  <p>PerlSetupEnv On will allow you to access the environment variables like $ENV{REQUEST_URI}, which are available under CGI. However, when programming handlers, there are always better ways to access these variables through the Apache API. Therefore, it is recommended to turn it Off except for scripts which absolutely require it. See PerlSetupEnv Off.</p>\n</blockquote>\n\n<p>Is there a way to access to read that variable <strong>without</strong> using the %ENV hash as the documentation implies?  If so, please provide a short example on how to do so.</p>\n"}, {"tags": ["perl", "sorting", "join", "hash", "printing"], "comments": [{"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 2, "creation_date": 1514321929, "post_id": 47983542, "comment_id": 82936154, "body": "I just reformatted your code because it was totally unreadable. You are welcome but please do so yourself next time."}, {"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 1, "creation_date": 1514322217, "post_id": 47983542, "comment_id": 82936257, "body": "What is your output and what do you want it to be instead?"}, {"owner": {"reputation": 3, "user_id": 9142836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd892f103f428644d0dd138f31bd45b1?s=128&d=identicon&r=PG&f=1", "display_name": "keremmmmmm", "link": "https://stackoverflow.com/users/9142836/keremmmmmm"}, "reply_to_user": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 0, "creation_date": 1514324701, "post_id": 47983542, "comment_id": 82936988, "body": "I&#39;m new at perl sorry .Firstly thank you for interest.I tried to edit I used splice command for deleting items from array but its getting so long.That&#39;s enough for me thanks again.I was trying to make output ascending order and sort command enough to do that .."}], "answers": [{"tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 1, "last_activity_date": 1514323246, "last_edit_date": 1514323246, "creation_date": 1514322734, "answer_id": 47983750, "question_id": 47983542, "link": "https://stackoverflow.com/questions/47983542/two-dimensional-hash-data-output/47983750#47983750", "title": "two dimensional hash data output?", "body": "<p>You seem to duplicate some information in your code. Once you populate the %grades, there's no need to create the %hash - it can be extracted from the %grades directly.</p>\n\n<p>To populate the hashes, you don't have to repeat the keys all the time, describe the substructure as shown below.</p>\n\n<p>Also, your code contains \"\u0131\", which isn't an ASCII character. It would be nicer to tell Perl that by using <a href=\"http://p3rl.org/utf8\" rel=\"nofollow noreferrer\">utf8</a> and also declaring the encoding of the output. </p>\n\n<p>To sort the output by sums, use the <a href=\"http://p3rl.org/sort\" rel=\"nofollow noreferrer\">sort</a> function with a custom block that compares the hash elements:</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\nuse utf8;\nuse open ':encoding(UTF-8)', ':std';\n\nuse List::Util qw( sum );\n\nmy %grades = (\n    Ahmet =&gt; {\n        quiz1 =&gt; 97,\n        quiz2 =&gt; 67,\n        quiz3 =&gt; 93,\n    },\n    Mehmet =&gt; {\n        quiz1  =&gt; 88,\n        quiz2  =&gt; 82,\n        quiz3  =&gt; 99,\n    }\n);\n\nmy %sum;\nfor my $name (keys %grades)\n  {\n    $sum{$name} = sum(values %{ $grades{$name} });\n}\nfor my $name (sort { $sum{$a} &lt;=&gt; $sum{$b} } keys %sum)\n  {\n    print $name, ' ', $sum{$name}, \"\\n\";\n  }\n\nmy %grades2 = (\n    Merve =&gt; {\n        quiz1 =&gt; 33,\n        quiz2 =&gt; 41,\n        quiz3 =&gt; 59,\n    },\n    Asl\u0131 =&gt; {\n        quiz1 =&gt; 79,\n        quiz2 =&gt; 31,\n        quiz3 =&gt; 62,\n    },\n);\n\nmy %sum2;\nfor my $name (keys %grades2)\n  {\n    $sum2{$name} = sum(values %{ $grades2{$name} });\n  }\nfor my $name (sort { $sum2{$a} &lt;=&gt; $sum2{$b} } keys %sum2)\n  {\n    print $name, ' ', $sum2{$name}, \"\\n\";\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1672, "user_id": 4355253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee8cbfecfb7686f370b07eea52273c5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Elices", "link": "https://stackoverflow.com/users/4355253/javier-elices"}, "is_accepted": false, "score": 1, "last_activity_date": 1514324124, "last_edit_date": 1514324124, "creation_date": 1514323803, "answer_id": 47983892, "question_id": 47983542, "link": "https://stackoverflow.com/questions/47983542/two-dimensional-hash-data-output/47983892#47983892", "title": "two dimensional hash data output?", "body": "<p>Here is a way to do it. You are creating a hash of hash ref, which is explicitly done like this (I have added one more student to make the example more interesting):</p>\n\n<pre><code>my %grades = (\n  'Ahmet' =&gt; {\n    quiz1 =&gt; 97,\n    quiz2 =&gt; 67,\n    quiz3 =&gt; 93,\n  },\n  'Mehmet' =&gt; {\n    quiz1 =&gt; 88,\n    quiz2 =&gt; 82,\n    quiz3 =&gt; 99,\n  },\n  'Abdul' =&gt; {\n    quiz1 =&gt; 99,\n    quiz2 =&gt; 89,\n    quiz3 =&gt; 99,\n  },\n);\n</code></pre>\n\n<p>To print the students and their grades, you may use:</p>\n\n<pre><code># Printing the students and grades\nforeach my $student ( keys %grades ) {\n  print $student, \":\\n\";\n  foreach my $test ( keys %{$grades{$student}} ) {\n    print \" - \", $test, \"\\t\", $grades{$student}{$test}, \"\\n\";\n  }\n}\n</code></pre>\n\n<p>To generate the sum for each student:</p>\n\n<pre><code># Generating a sum for each student\nmy %sums;\nforeach my $student ( keys %grades ) {\n  $sums{$student} = sum0 map { $grades{$student}{$_} } keys %{$grades{$student}};\n}\n</code></pre>\n\n<p>I use <code>sum0</code> which will return <code>0</code> instead of <code>undef</code> when the list it is given is empty. You should use <code>use List::Util qw( sum0 );</code> at the beginning.</p>\n\n<p>Then printing the generated sum in ascending order:</p>\n\n<pre><code># Printing the sum\nforeach my $student ( sort { $sums{$a} &lt;=&gt; $sums{$b} } keys %sums ) {\n  print $student, \":\\t\", $sums{$student}, \"\\n\";\n}\n</code></pre>\n\n<p>For the opposite order, you may use <code>sort { $sums{$b} &lt;=&gt; $sums{$a} } keys %sums</code>. For the rest of your code, you would do the same...</p>\n\n<p>The output of the students:</p>\n\n<pre><code>Ahmet:\n - quiz1        97\n - quiz3        93\n - quiz2        67\nMehmet:\n - quiz2        82\n - quiz3        99\n - quiz1        88\nAbdul:\n - quiz2        89\n - quiz3        99\n - quiz1        99\n</code></pre>\n\n<p>Then the sum of the grades:</p>\n\n<pre><code>Ahmet:  257\nMehmet: 269\nAbdul:  287\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9142836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd892f103f428644d0dd138f31bd45b1?s=128&d=identicon&r=PG&f=1", "display_name": "keremmmmmm", "link": "https://stackoverflow.com/users/9142836/keremmmmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 47983750, "answer_count": 2, "score": 0, "last_activity_date": 1514324124, "creation_date": 1514321143, "last_edit_date": 1514321855, "question_id": 47983542, "link": "https://stackoverflow.com/questions/47983542/two-dimensional-hash-data-output", "title": "two dimensional hash data output?", "body": "<p>this my code.At the end of this process I want to collect name and sum results with ascending order and want to print.I tried to take the as @sum1 and @sum2 but it couldn't know @sum functions.How can I do that or any idea will be very valuable.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\nuse List::Util qw( sum );\nuse Data::Dumper qw(Dumper);\n\nmy %grades;\n$grades{\"Ahmet\"}{quiz1}  = 97;\n$grades{\"Ahmet\"}{quiz2}  = 67;\n$grades{\"Ahmet\"}{quiz3}  = 93;\n$grades{\"Mehmet\"}{quiz1} = 88;\n$grades{\"Mehmet\"}{quiz2} = 82;\n$grades{\"Mehmet\"}{quiz3} = 99;\n\nprint Dumper \\%grades;\nprint \"----------------\\n\";\n\nforeach my $name ( sort keys %grades ) {\n    my %hash1 = (\n        'Ahmet'  =&gt; [ 97, 67, 93 ],\n        'Mehmet' =&gt; [ 88, 82, 99 ],\n    );\n\n    my @sums;\n    for my $key ( keys %hash1 ) {\n        my $sum = sum @{ $hash1{$key} };\n        push @sums, \"$key: $sum\\n\";\n    }\n\n    foreach my $sum ( keys %{ $grades{$name} } ) {\n        print \"$name : $grades{$name}{$sum}\\n\";\n    }\n\n    print @sums;\n}\n\nforeach my $name ( sort keys %grades ) {\n    print \"$grades{$name}\\n\";\n}\n\nmy %grades2;\n$grades2{\"Merve\"}{quiz1} = 33;\n$grades2{\"Merve\"}{quiz2} = 41;\n$grades2{\"Merve\"}{quiz3} = 59;\n$grades2{\"Asl\u0131\"}{quiz1} = 79;\n$grades2{\"Asl\u0131\"}{quiz2} = 31;\n$grades2{\"Asl\u0131\"}{quiz3} = 62;\n\nprint Dumper \\%grades2;\nprint \"----------------\\n\";\n\nforeach my $name2 ( sort keys %grades2 ) {\n    my %hash = (\n        'Merve' =&gt; [ 33, 41, 59 ],\n        'Asl\u0131' =&gt; [ 79, 31, 62 ],\n    );\n\n    my @sums2;\n    for my $key ( keys %hash ) {\n        my $sum = sum @{ $hash{$key} };\n        push @sums2, \"$key: $sum\\n\";\n    }\n\n    foreach my $sum ( keys %{ $grades2{$name2} } ) {\n        print \"$name2 : $grades2{$name2}{$sum}\\n\";\n    }\n\n    print @sums2;\n\n}\n\nforeach my $name2 ( sort keys %grades2 ) {\n    print \"$grades2{$name2}\\n\";\n}\n\nmy %info;\n\n$info{$_} .= \"A\" for keys %grades;\n$info{$_} .= \"B\" for keys %grades2;\n\nfor ( sort keys %info ) {\n    print \"$_ : $info{$_}\\n\";\n}\n</code></pre>\n"}, {"tags": ["python", "linux", "perl", "tap", "perl-prove"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1514939355, "post_id": 47983165, "comment_id": 83113106, "body": "<code>prove</code> is really App::Prove. You can subclass it and turn buffering on, and then use your subclass I believe."}], "answers": [{"comments": [{"owner": {"reputation": 2484, "user_id": 1672565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/OEMWS.png?s=128&g=1", "display_name": "s-m-e", "link": "https://stackoverflow.com/users/1672565/s-m-e"}, "edited": false, "score": 0, "creation_date": 1514720187, "post_id": 48040922, "comment_id": 83054833, "body": "Thanks for your help and suggestions. I edited my question accordingly."}, {"owner": {"reputation": 1546, "user_id": 2989337, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/JoDFi.png?s=128&g=1", "display_name": "JawguyChooser", "link": "https://stackoverflow.com/users/2989337/jawguychooser"}, "reply_to_user": {"reputation": 2484, "user_id": 1672565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/OEMWS.png?s=128&g=1", "display_name": "s-m-e", "link": "https://stackoverflow.com/users/1672565/s-m-e"}, "edited": false, "score": 0, "creation_date": 1514736859, "post_id": 48040922, "comment_id": 83058919, "body": "You&#39;re welcome.  And with the edited title, it looks like you attracted a working answer.  I tried <code>unbuffered</code> and I got the output @PerlDuck suggested!"}], "tags": [], "owner": {"reputation": 1546, "user_id": 2989337, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/JoDFi.png?s=128&g=1", "display_name": "JawguyChooser", "link": "https://stackoverflow.com/users/2989337/jawguychooser"}, "is_accepted": false, "score": 3, "last_activity_date": 1514707124, "creation_date": 1514707124, "answer_id": 48040922, "question_id": 47983165, "link": "https://stackoverflow.com/questions/47983165/how-do-i-run-perls-prove-tap-harness-in-unbuffered-mode/48040922#48040922", "title": "How do I run Perl&#39;s ``prove`` TAP harness in unbuffered mode?", "body": "<p>This is a start of an answer, it has more info than I could squeeze into a comment.</p>\n\n<p>The issue you laid out isn't really related to bash, it's related to Perl.  On my system, <code>which prove</code> points to <code>/usr/bin/prove</code>, which is a perl script.  The real question here is generally about perl scripts, not even specific to <code>prove</code>.  I copied your files above and tested that I can reproduce what you're seeing, then I created a third test:</p>\n\n<pre><code>$ cat job.pl\n#!/usr/bin/perl\nforeach (1..20){\n  print \"$_\\n\";   \n  sleep 1;\n}\n</code></pre>\n\n<p>Cool, then I added this to the demo program:</p>\n\n<p>(After importing <code>shlex</code> as well`):</p>\n\n<pre><code>cmdargs = shlex.split('sudo -b '+os.path.join(os.getcwd(), 'job.pl'))\nrun_demo(cmdargs, timeout_sec, signal.SIGINT)\n</code></pre>\n\n<p>And, to be sure, this simple perl script faile to produce output when killed.</p>\n\n<pre><code>$ python3 demo.py\n...(output as you wrote above followed by)... \nDEMO: sudo -b /home/jawguychooser/job.pl\nKILLED!\nGot our/err:  \n$\n</code></pre>\n\n<p>So, that means that your problem is really a specific instance of how to capture the output from a killed perl program running in the background controlled by a Python program.</p>\n\n<p>As a next step, I set <code>job.pl</code> to unbuffer stdout:</p>\n\n<pre><code>$ cat job.pl\n#!/usr/bin/perl\n$| = 1;\nforeach (1..20){\n  print \"$_\\n\"; \n  sleep 1;\n}\n</code></pre>\n\n<p>And then, I rerun demo.py and voila!</p>\n\n<pre><code>$ python3 demo.py \nDEMO: sudo -b /home/jawguychooser/job.pl\nKILLED!\nGot our/err: 1\n2\n3\n4\n5\n6\n$ \n</code></pre>\n\n<p>So, perhaps if you hack into the prove script and set things up to run unbuffered that will do what you want.  In any case, I think your question is now \"how can I run <code>prove -v</code> in unbuffered mode\".</p>\n\n<p>I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "is_accepted": true, "score": 5, "last_activity_date": 1514861733, "last_edit_date": 1514861733, "creation_date": 1514723223, "answer_id": 48042420, "question_id": 47983165, "link": "https://stackoverflow.com/questions/47983165/how-do-i-run-perls-prove-tap-harness-in-unbuffered-mode/48042420#48042420", "title": "How do I run Perl&#39;s ``prove`` TAP harness in unbuffered mode?", "body": "<p>By default, the STDOUT of many programs (including <code>perl</code>) is line-buffered (flushed on newline) when the STDOUT is connected to a terminal, and block-buffered (flushed when the file's buffer is full) otherwise (e.g. when it's connected to a pipe).</p>\n\n<p>You can fool such programs into using line-buffering by using a pseudo-tty (ptty) instead of a pipe. To that end, <strong><code>unbuffer</code></strong> is your friend. On Ubuntu, this is part of the <code>expect</code> package (<code>sudo apt install expect</code>).</p>\n\n<p>From the <a href=\"https://linux.die.net/man/1/unbuffer\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p><strong>unbuffer</strong> disables the output buffering \n  that occurs when program output is redirected \n  from non-interactive programs. For example, \n  suppose you are watching the output from a \n  fifo by running it through od and then more.</p>\n\n<pre><code>od -c /tmp/fifo | more\n</code></pre>\n  \n  <p>You will not see anything until a full page \n  of output has been produced.</p>\n  \n  <p>You can disable this automatic buffering as follows:</p>\n\n<pre><code>unbuffer od -c /tmp/fifo | more\n</code></pre>\n</blockquote>\n\n<p>I tried your example code and got the same result as you describe (thanks to your <a href=\"https://stackoverflow.com/help/mcve\"><em>Minimal, Complete, and Verifiable example</em></a>!).</p>\n\n<p>I then changed</p>\n\n<pre><code>run_demo(['sudo', '-b', 'prove', '-v', os.path.join(os.getcwd(), 'job.t')], timeout_sec, signal.SIGINT)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>run_demo(['sudo', '-b', 'unbuffer', 'prove', '-v', os.path.join(os.getcwd(), 'job.t')], timeout_sec, signal.SIGINT)\n</code></pre>\n\n<p>That is: I simply prepended <code>unbuffer</code> to the <code>prove</code> command. The output then was:</p>\n\n<pre><code>DEMO: sudo -b python job.py\nKILLED!\nGot our/err: 1..20\nok 1\nok 2\nok 3\nok 4\nok 5\nok 6\n Traceback (most recent call last):\n  File \"job.py\", line 8, in &lt;module&gt;\n    time.sleep(1)\nKeyboardInterrupt\n\nDEMO: sudo -b unbuffer prove -v /home/dirk/w/sam/p/job.t\nKILLED!\nGot our/err: /home/dirk/w/sam/p/job.t .. \n1..20\nok 1\nok 2\nok 3\nok 4\nok 5\n</code></pre>\n"}], "owner": {"reputation": 2484, "user_id": 1672565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/OEMWS.png?s=128&g=1", "display_name": "s-m-e", "link": "https://stackoverflow.com/users/1672565/s-m-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 48042420, "answer_count": 2, "score": 10, "last_activity_date": 1514861733, "creation_date": 1514318230, "last_edit_date": 1514720129, "question_id": 47983165, "link": "https://stackoverflow.com/questions/47983165/how-do-i-run-perls-prove-tap-harness-in-unbuffered-mode", "title": "How do I run Perl&#39;s ``prove`` TAP harness in unbuffered mode?", "body": "<p>As part of a test suite written in Python <strong>3</strong>[.4-.6] on Linux, I have to run a number 3rd-party tests. The 3rd-party tests are bash scripts. They are designed to run with <a href=\"https://perldoc.perl.org/TAP/Harness.html\" rel=\"noreferrer\">Perl's <code>prove</code> TAP harness</a>. One bash script can contain up to a few thousands of individual tests - and some of them can hang indefinitely. After a timeout, I want to kill the test script and gather some information on where it got stuck. </p>\n\n<p>Because the bash scripts create processes of their own, I try to isolate the entire <code>prove</code> process tree into a new process group, so I can eventually kill the entire process group as a whole if things go wrong. Because the tests must run with root privileges, I use <code>sudo -b</code> for creating a new process group with root privileges. This strategy (as opposed to using <code>setsid</code> in one way or the other) is a result of the comments I received on <a href=\"https://unix.stackexchange.com/questions/411036/sudo-setsid-command-does-not-spawn-new-process-group\">this question at SE Unix&amp;Linux</a></p>\n\n<p>The problem is that I loose all output from the <code>prove</code> TAP harness if I kill it 'prematurely' when launched with <code>sudo -b</code> through Python's <code>subprocess.Popen</code>. </p>\n\n<p>I isolated it into a simple test case. The following is a bash test script named <code>job.t</code>:</p>\n\n<pre><code>#!/bin/bash\n\nMAXCOUNT=20\necho \"1..$MAXCOUNT\"\nfor (( i=1; i&lt;=$MAXCOUNT; i++ ))\ndo\n   echo \"ok $i\"\n   sleep 1\ndone\n</code></pre>\n\n<p>Just for comparison, I also wrote a Python script named <code>job.py</code> producing more or less the same output and exhibiting the same behavior:</p>\n\n<pre><code>import sys\nimport time\nif __name__ == '__main__':\n    maxcount = 20\n    print('1..%d' % maxcount)\n    for i in range(1, maxcount + 1):\n        sys.stdout.write('ok %d\\n' % i)\n        time.sleep(1)\n</code></pre>\n\n<p>Last but not least, the following is my stripped-down \"Python test infrastructure\" named <code>demo.py</code>:</p>\n\n<pre><code>import psutil # get it with \"pip install psutil\"\nimport os\nimport signal\nimport subprocess\n\ndef run_demo(cmd, timeout_after_seconds, signal_code):\n    print('DEMO: %s' % ' '.join(cmd))\n    proc = subprocess.Popen(cmd, stdout = subprocess.PIPE, stderr = subprocess.PIPE)\n    try:\n        outs, errs = proc.communicate(timeout = timeout_after_seconds)\n    except subprocess.TimeoutExpired:\n        print('KILLED!')\n        kill_pid = _get_pid(cmd)\n        subprocess.Popen(['sudo', 'kill', '-%d' % signal_code, '--', '-%d' % os.getpgid(kill_pid)]).wait()\n        outs, errs = proc.communicate()\n    print('Got our/err:', outs.decode('utf-8'), errs.decode('utf-8'))\n\ndef _get_pid(cmd_line_list):\n    for pid in psutil.pids():\n        proc = psutil.Process(pid)\n        if cmd_line_list == proc.cmdline():\n            return proc.pid\n    raise # TODO some error ...\n\nif __name__ == '__main__':\n    timeout_sec = 5\n    # Works, output is captured and eventually printed\n    run_demo(['sudo', '-b', 'python', 'job.py'], timeout_sec, signal.SIGINT)\n    # Failes, output is NOT captured (i.e. printed) and therefore lost\n    run_demo(['sudo', '-b', 'prove', '-v', os.path.join(os.getcwd(), 'job.t')], timeout_sec, signal.SIGINT)\n</code></pre>\n\n<p>When <code>demo.py</code> is launched, it runs the routine <code>run_demo</code> twice - with different configurations. Both times, a new process group with root privileges is started. Both times, a \"test job\" prints a new line (<code>ok [line number]</code>) once a second - theoretically for 20 seconds / 20 lines. However, there is a timeout of 5 seconds for both scripts and the entire process group is killed after this timeout.</p>\n\n<p>When <code>run_demo</code> runs for the first time with my little Python script <code>job.py</code>, all output of that script all the way up to the point when it is killed is captured and printed successfully. When <code>run_demo</code> runs for the second time with the demo bash test script <code>job.t</code> on top of <code>prove</code>, no output is captured and only empty strings are printed. </p>\n\n<pre><code>user@computer:~&gt; python demo.py \nDEMO: sudo -b python job.py\nKILLED!\nGot our/err: 1..20\nok 1\nok 2\nok 3\nok 4\nok 5\nok 6\n Traceback (most recent call last):\n  File \"job.py\", line 11, in &lt;module&gt;\n    time.sleep(1)\nKeyboardInterrupt\n\nDEMO: sudo -b prove -v /full/path/to/job.t\nKILLED!\nGot our/err:  \nuser@computer:~&gt;\n</code></pre>\n\n<p>What is happening here and how can I fix it?</p>\n\n<p>I.e. how can I interrupt / terminate the bash test script running with <code>prove</code> (and its entire process group) in such a manner that I can capture its output?</p>\n\n<p><strong>EDIT: It was <a href=\"https://stackoverflow.com/a/48040922/1672565\">suggested in an answer</a> that the observed behavior happens because of Perl buffering its output. Within an individual Perl script, this can be turned off. However, there is no apparent option allowing to switch off buffering for <code>prove</code> [-v]. How can I achieve this?</strong></p>\n\n<hr>\n\n<p>I can work around this issue by running my test job with <code>bash</code> directly. The following command has to be changed from </p>\n\n<pre><code>run_demo(['sudo', '-b', 'prove', '-v', os.path.join(os.getcwd(), 'job.t')], timeout_sec, signal.SIGINT)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>run_demo(['sudo', '-b', 'bash', os.path.join(os.getcwd(), 'job.t')], timeout_sec, signal.SIGINT)\n</code></pre>\n\n<p>This way, I do not get the test statistics printed by <code>prove</code>, but I can generate them myself.</p>\n"}, {"tags": ["linux", "apache", "perl", "permissions"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 4401, "user_id": 6484851, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bd11c011c9a94229018130c04526c5ab?s=128&d=identicon&r=PG&f=1", "display_name": "yoctotutor.com", "link": "https://stackoverflow.com/users/6484851/yoctotutor-com"}, "edited": false, "score": 0, "creation_date": 1514319287, "post_id": 47974622, "comment_id": 82935280, "body": "@Vadalasetti: Please delete your misinformation."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1514309483, "post_id": 47977362, "comment_id": 82932023, "body": "Probably best to give permission to the admin group if you have one. (It&#39;s called <code>adm</code> on Ubuntu.) <code>chown www-data:adm ...</code> and <code>chmod 660 ...</code>"}], "tags": [], "owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "is_accepted": false, "score": 2, "last_activity_date": 1514285654, "last_edit_date": 1514285654, "creation_date": 1514284906, "answer_id": 47977362, "question_id": 47974622, "link": "https://stackoverflow.com/questions/47974622/linux-read-and-write-permissions-only-through-application/47977362#47977362", "title": "Linux Read and Write Permissions only through application", "body": "<p>There is no such concept of giving an <em>application</em> permissions to read or write a file. Only users can.\nThus you need to give the logfile permissions so that only <em>the user that runs the cgi script</em> can read and write to it.</p>\n\n<p>So if your cgi script is run by the (webserver's) user <code>www-data</code> (for example) then you need to:</p>\n\n<pre><code>sudo chown www-data /usr/share/log/iplog.txt\nsudo chmod 600 /usr/share/log/iplog.txt\n</code></pre>\n\n<p>Then only the user <code>www-data</code> can read and write to the file.\nNote that this also means that you (as user <code>dwayne</code>) cannot read the file, just as you asked.</p>\n\n<p>To figure out the webserver's user you can issue</p>\n\n<pre><code>ps aux | egrep '(apache|httpd)'\n</code></pre>\n\n<p>Common apache users are <code>www-data</code>, <code>nobody</code>, <code>apache</code>.</p>\n"}], "owner": {"reputation": 1927, "user_id": 1437138, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/b4b0218d953886fed95ef07799da6580?s=128&d=identicon&r=PG", "display_name": "Smith Dwayne", "link": "https://stackoverflow.com/users/1437138/smith-dwayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514285654, "creation_date": 1514269158, "question_id": 47974622, "link": "https://stackoverflow.com/questions/47974622/linux-read-and-write-permissions-only-through-application", "title": "Linux Read and Write Permissions only through application", "body": "<p>I wrote a simple CGI web application to create a server log file to store the IP addresses which access my web page. My Cgi script location is </p>\n\n<blockquote>\n  <p>'/usr/lib/cgi-bin/iplog.cgi'</p>\n</blockquote>\n\n<p>My Log file location is,</p>\n\n<blockquote>\n  <p>'/usr/share/log/iplog.txt'</p>\n</blockquote>\n\n<p>My Question is, the log file 'iplog.txt' only should Read and Write through my application script 'iplog.cgi'. Now I gave permission as '777' to 'iplog.txt'. I know it will give permission to all to do anything. But I wish to Read and Write this file only through my cgi application script. How can i do this?</p>\n"}, {"tags": ["perl", "unit-testing", "perl-module"], "comments": [{"owner": {"reputation": 3130, "user_id": 2064808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d819efdb2d3f9983a1437f3c1b9f710?s=128&d=identicon&r=PG", "display_name": "David Knipe", "link": "https://stackoverflow.com/users/2064808/david-knipe"}, "edited": false, "score": 0, "creation_date": 1514160092, "post_id": 47964727, "comment_id": 82899267, "body": "Maybe you could run it in an <code>eval</code> block?"}, {"owner": {"reputation": 42833, "user_id": 18914, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a20a39ae2ef47ae042a3eddd5b5bd19?s=128&d=identicon&r=PG", "display_name": "Dave Sherohman", "link": "https://stackoverflow.com/users/18914/dave-sherohman"}, "reply_to_user": {"reputation": 3130, "user_id": 2064808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d819efdb2d3f9983a1437f3c1b9f710?s=128&d=identicon&r=PG", "display_name": "David Knipe", "link": "https://stackoverflow.com/users/2064808/david-knipe"}, "edited": false, "score": 2, "creation_date": 1514193856, "post_id": 47964727, "comment_id": 82904104, "body": "@DavidKnipe - Nope, <code>eval</code> only catches <code>die</code>, not <code>exit</code>. If you want to test this for yourself, <code>perl -E &#39;eval { exit } ; say &quot;caught&quot;&#39;</code> will not produce any output."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1516003276, "post_id": 47964727, "comment_id": 83500423, "body": "Thank you for the credit (I assume for the idea). A comment: the code will print <code>@_</code> elements with nothing between them.  I imagine that that&#39;s not the intent, so maybe <code>print {*STDERR} &quot;@_\\n&quot; if @_;</code>. An array under quotes gets interpolated whereby the value of <a href=\"https://perldoc.perl.org/perlvar.html#%24,\" rel=\"nofollow noreferrer\"><code>$,</code> variable</a>, a space by default, is added between elements."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1516115040, "post_id": 47964727, "comment_id": 83552315, "body": "Great point! Thanks again @zdim!"}], "answers": [{"tags": [], "owner": {"reputation": 3269, "user_id": 93745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8F5Wc.jpg?s=128&g=1", "display_name": "tinita", "link": "https://stackoverflow.com/users/93745/tinita"}, "is_accepted": false, "score": 15, "last_activity_date": 1516083181, "last_edit_date": 1516083181, "creation_date": 1514160154, "answer_id": 47964793, "question_id": 47964727, "link": "https://stackoverflow.com/questions/47964727/in-testmore-is-it-possible-to-test-a-subroutine-that-exits-at-the-end/47964793#47964793", "title": "In Test::More, is it possible to test a subroutine that exit()&#39;s at the end?", "body": "<p>You can use <a href=\"https://metacpan.org/pod/Test::Exit\" rel=\"nofollow noreferrer\">Test::Exit</a>.</p>\n\n<p>If for any reason you cannot use it, just copy the code below:</p>\n\n<pre><code>our $exit_handler = sub {\n    CORE::exit $_[0];\n};\n\nBEGIN {\n    *CORE::GLOBAL::exit = sub (;$) {\n        $exit_handler-&gt;(@_ ? 0 + $_[0] : 0)\n    };\n}\n\n{\n    my $exit = 0;\n    local $exit_handler = sub {\n        $exit = $_[0];\n        no warnings qw( exiting );\n        last TEST;\n    };\n\n    TEST: {\n       # Your test here\n    }\n\n    cmp_ok($exit, '==', 1, \"exited with 1\");\n}\n</code></pre>\n\n<p>Be sure to load your module after the BEGIN block.</p>\n"}, {"tags": [], "owner": {"reputation": 19192, "user_id": 257635, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/El2tc.jpg?s=128&g=1", "display_name": "Chankey Pathak", "link": "https://stackoverflow.com/users/257635/chankey-pathak"}, "is_accepted": true, "score": 2, "last_activity_date": 1514294317, "creation_date": 1514294317, "answer_id": 47979224, "question_id": 47964727, "link": "https://stackoverflow.com/questions/47964727/in-testmore-is-it-possible-to-test-a-subroutine-that-exits-at-the-end/47979224#47979224", "title": "In Test::More, is it possible to test a subroutine that exit()&#39;s at the end?", "body": "<p>Alternatively, you can use <a href=\"https://perldoc.perl.org/perlmod.html#BEGIN%2C-UNITCHECK%2C-CHECK%2C-INIT-and-END\" rel=\"nofollow noreferrer\">END</a> block to handle exit calls.</p>\n\n<blockquote>\n  <p>Inside an END code block, $? contains the value that the program is\n  going to pass to exit(). You can modify $? to change the exit value of\n  the program.</p>\n</blockquote>\n\n<pre><code>usage();\n\nEND {\n    use Test::More;\n    ok($?);\n    done_testing();\n}\n</code></pre>\n\n<p>Demo: <a href=\"https://ideone.com/AQx395\" rel=\"nofollow noreferrer\">https://ideone.com/AQx395</a></p>\n"}], "owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 1, "accepted_answer_id": 47979224, "answer_count": 2, "score": 8, "last_activity_date": 1516083181, "creation_date": 1514158723, "last_edit_date": 1514294395, "question_id": 47964727, "link": "https://stackoverflow.com/questions/47964727/in-testmore-is-it-possible-to-test-a-subroutine-that-exits-at-the-end", "title": "In Test::More, is it possible to test a subroutine that exit()&#39;s at the end?", "body": "<p>I have a module that I wrote with some utility functions.</p>\n\n<p>One of the functions is just a usage statement (recommended by user @zdim)</p>\n\n<pre><code>use 5.008_008;\nuse strict;\nuse warnings;\n\n# Function Name:        'usage'\n# Function Inputs:      'none'\n# Function Returns:     'none'\n# Function Description: 'Prints usage on STDERR, for when invalid options are passed'\nsub usage ## no critic qw(RequireArgUnpacking)\n{\n    require File::Basename;\n    my $PROG = File::Basename::basename($0);\n    for (@_)\n    {\n        print {*STDERR} $_;\n    }\n    print {*STDERR} \"Try $PROG --help for more information.\\n\";\n    exit 1;\n}\n</code></pre>\n\n<p>I know the subroutine works as expected, and it's simple enough to test, but... For coverage reports, I'd like to include it in my unit tests.\nIs there any way to test it using <code>Test::More</code>?</p>\n"}, {"tags": ["json", "perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514129567, "post_id": 47961108, "comment_id": 82892970, "body": "Please show a reasonable amount of code. What is <code>$hash</code>?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514129645, "post_id": 47961108, "comment_id": 82892985, "body": "Your JSON data must start with <code>[</code> or <code>{</code>."}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 1, "creation_date": 1514130633, "post_id": 47961108, "comment_id": 82893215, "body": "Your title and example refer to json, but your code shows a Perl data structure.  Which do you actually need help with?"}, {"owner": {"reputation": 35, "user_id": 7993095, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/79b3cdce65901b3f183b942eca87c964?s=128&d=identicon&r=PG&f=1", "display_name": "temp44", "link": "https://stackoverflow.com/users/7993095/temp44"}, "edited": false, "score": 0, "creation_date": 1514130857, "post_id": 47961108, "comment_id": 82893265, "body": "The paste has been formatted with Dumper in perl to make it easier to view. I want to use perl to pull out the key and doc_count starting at line 818."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514132640, "post_id": 47961108, "comment_id": 82893663, "body": "It would be better to show the JSON data that you&#39;re using. Please show the code that populates <code>$hash</code>."}, {"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1514135652, "post_id": 47961108, "comment_id": 82894346, "body": "The title of this question is misleading, since OP is really just asking how to access the data structure"}], "answers": [{"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514129791, "post_id": 47961296, "comment_id": 82893021, "body": "You&#39;ve presented your solution as a complete program, but there&#39;s a lot missing. There&#39;s no <code>@buckets</code> declared, for instance"}, {"owner": {"reputation": 1523, "user_id": 4204037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab78fa882cbf4a03c4fd2a0b92622dc5?s=128&d=identicon&r=PG&f=1", "display_name": "bytepusher", "link": "https://stackoverflow.com/users/4204037/bytepusher"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1514132345, "post_id": 47961296, "comment_id": 82893590, "body": "I&#39;ve put in a comment indicating what I expect has already happened, and declared <code>@buckets</code>"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1514132546, "post_id": 47961296, "comment_id": 82893642, "body": "Thanks. I&#39;ve added a couple of breaks to underline that it&#39;s not a stand-alonefunctioning program"}], "tags": [], "owner": {"reputation": 1523, "user_id": 4204037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab78fa882cbf4a03c4fd2a0b92622dc5?s=128&d=identicon&r=PG&f=1", "display_name": "bytepusher", "link": "https://stackoverflow.com/users/4204037/bytepusher"}, "is_accepted": false, "score": 0, "last_activity_date": 1514132485, "last_edit_date": 1514132485, "creation_date": 1514124730, "answer_id": 47961296, "question_id": 47961108, "link": "https://stackoverflow.com/questions/47961108/perl-json-check-if-value-exists-before-recording-result/47961296#47961296", "title": "Perl JSON - check if value exists before recording result", "body": "<p>Given your last sentence, this seems to do what you need.</p>\n\n<pre><code>use strict;\nuse warnings;\n\nuse List::Util qw( sum );\n</code></pre>\n\n\n\n<pre><code># Existing code to build the hash with buckets ...\n</code></pre>\n\n\n\n<pre><code>my @buckets = @{ $hash-&gt;{buckets} };\nmy %count_keys = (\n        tls =&gt; 1,\n        dns =&gt; 1,\n        http =&gt; 1,\n    ); # lookup: which keys do I count\nmy %doc_count;\n\nfor my $proto ( @buckets ){\n    my $key = $proto-&gt;{key};\n    next unless $count_keys{ $key }; # not to be counted: skip this\n    $doc_count{ $key }+= $proto-&gt;{doc_count}; # counting per type\n}\n\nprint \"$_: $doc_count{$_}\\n\" for sort keys(%doc_count); # output count per type\nprint \"overall: \" . sum(values(%doc_count)); # count of all doc counts\n</code></pre>\n\n<p>I am not certain, though, whether there are other questions / problems: have you decoded the JSON at all? It would be much more helpful if you had some more code to go on.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 7993095, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/79b3cdce65901b3f183b942eca87c964?s=128&d=identicon&r=PG&f=1", "display_name": "temp44", "link": "https://stackoverflow.com/users/7993095/temp44"}, "edited": false, "score": 0, "creation_date": 1514134495, "post_id": 47962391, "comment_id": 82894072, "body": "This works, thanks a lot. I didn&#39;t have the &quot;spi&quot; part myself."}], "tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": true, "score": -1, "last_activity_date": 1514176830, "last_edit_date": 1514176830, "creation_date": 1514134019, "answer_id": 47962391, "question_id": 47961108, "link": "https://stackoverflow.com/questions/47961108/perl-json-check-if-value-exists-before-recording-result/47962391#47962391", "title": "Perl JSON - check if value exists before recording result", "body": "<p>Given your pastebin data structure (which looks to actually be a decoded JSON structure), the \"buckets\" array you specify starting on line 818 can be accessed using its hash keys like this:</p>\n\n<pre><code>my $buckets = $hash-&gt;{'spi'}-&gt;{'prot-term'}-&gt;{'buckets'}; \nfor my $proto (@$buckets) {\n    # access proto-&gt;{'key'}, $proto-&gt;{'doc_count'}\n} \n</code></pre>\n\n<p>If you wanted all the \"buckets\" arrays, <strong>assuming the \"buckets\" arrays are always on the third level</strong> of <code>$hash</code>:</p>\n\n<pre><code>for my $l1 (keys %$hash) {\n    for my $l2 (keys %{$hash-&gt;{$l1}}) {\n        my $buckets = $hash-&gt;{$l1}-&gt;{$l2}-&gt;{'buckets'};\n        for my $proto (@$buckets) {\n            # $proto-&gt;{'key'}, $proto-&gt;{'doc_count'}\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7993095, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/79b3cdce65901b3f183b942eca87c964?s=128&d=identicon&r=PG&f=1", "display_name": "temp44", "link": "https://stackoverflow.com/users/7993095/temp44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "accepted_answer_id": 47962391, "answer_count": 2, "score": -1, "last_activity_date": 1514176830, "creation_date": 1514123196, "last_edit_date": 1514132981, "question_id": 47961108, "link": "https://stackoverflow.com/questions/47961108/perl-json-check-if-value-exists-before-recording-result", "title": "Perl JSON - check if value exists before recording result", "body": "<p>I'm trying to pull out the doc_count value from the following json output if the key = tls, dns, or http.</p>\n\n<p>JSON: <a href=\"https://pastebin.com/T5Cu3w79\" rel=\"nofollow noreferrer\">https://pastebin.com/T5Cu3w79</a></p>\n\n<p>So far I've attempted to print out the values for \"key\" but I could not get it to return a result. $hash is the JSON output stored as an array(s).</p>\n\n<pre><code>my @buckets = @{ $hash-&gt;{'buckets'} };\nforeach my $proto (@buckets) {\n    print $proto-&gt;{\"key\"} . \"\\n\";\n}\n</code></pre>\n\n<p>EDIT: See the JSON file here: <a href=\"https://pastebin.com/T5Cu3w79\" rel=\"nofollow noreferrer\">https://pastebin.com/T5Cu3w79</a>. The information I want are the \"key\" and \"doc_count\" values starting at line 818 and ends 859.</p>\n"}, {"tags": ["perl", "pipe", "fork"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user180100"}, "edited": false, "score": 0, "creation_date": 1514014369, "post_id": 47950036, "comment_id": 82870788, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10765311/how-to-read-to-and-write-from-a-pipe-in-perl\">How to read to and write from a pipe in Perl?</a>"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1514017498, "post_id": 47950036, "comment_id": 82871399, "body": "You do not flush a pipe by reading from it (in <code>flush_pipe</code>) but by sending a newline when writing to it (or, effectively, when the-probably-64Kb buffer gets full). Also, you must close <code>$in</code> in the child process and <code>$out</code> in the parent, before anything else. I can&#39;t try with this module on Windows right now."}], "answers": [{"tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": true, "score": 5, "last_activity_date": 1558335507, "last_edit_date": 1558335507, "creation_date": 1514018475, "answer_id": 47951060, "question_id": 47950036, "link": "https://stackoverflow.com/questions/47950036/unable-to-read-pipe/47951060#47951060", "title": "Unable to read pipe", "body": "<p>A pipe is unidirectional. Each of the processes it connects can either read or write.</p>\n\n<p>After <a href=\"https://perldoc.perl.org/functions/pipe.html\" rel=\"nofollow noreferrer\">pipe</a> you have two filehandles, and both the parent and the child see them both.  If the child is going to write and the parent to read, as in your code, then the child must first close the handle it won't use (<code>$in</code>) and the parent must close its unused one, <code>$out</code>. Otherwise you'll <a href=\"https://perldoc.perl.org/perlipc.html#Avoiding-Pipe-Deadlocks\" rel=\"nofollow noreferrer\">have deadlocks</a>.</p>\n\n<p>The <code>spawn</code> from the module starts a child process (or, rather, a Windows approximation of it) and redirects its <code>STDOUT</code> to the writing end of the pipe, <code>$out</code>.</p>\n\n<p>Some very basic code that should cover this</p>\n\n<pre><code>use strict;\nuse warnings;\nuse feature 'say';\n\npipe my $in, my $out;\n\nmy $pid = fork // die \"Can't fork: $!\";\n\nif ($pid == 0) { # child\n    close $in;\n    print $out \"hi \";         # can't read this yet (no newline) ...\n    sleep 1;\n    say   $out \"from child\";  # now the other end can read it\n    close $out;\n    exit;\n}\n\n# parent\nclose $out;\n\nsay while &lt;$in&gt;;\nclose $in;\n\nwait;\n</code></pre>\n\n<p>When you want prints to become available to the reader right away (up to buffering outside your code) send a newline. Close unused ends of the pipe in each process before doing anything else. </p>\n\n<p>I can't write code on Windows now, but in your code parent must <code>close $out</code> (after <code>spawn</code>).</p>\n\n<p>The term \"flush\" here can relate to the code in the writer or to Perl's clearing of IO buffers; the code in your <code>flush_pipe()</code> merely reads the pipe. So I'd change that name, to <code>read_pipe</code> or such. </p>\n"}], "owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 47951060, "answer_count": 1, "score": 1, "last_activity_date": 1558335507, "creation_date": 1514007179, "last_edit_date": 1558335477, "question_id": 47950036, "link": "https://stackoverflow.com/questions/47950036/unable-to-read-pipe", "title": "Unable to read pipe", "body": "<p>I don't know if I accidentally deleted or put in a typo somewhere but all of the sudden some of my code stopped working. For some reason no lines are ever read from $in.</p>\n\n<pre><code>use Win32::Job;\nuse IO::Handle; \n\nSTDOUT-&gt;autoflush;\n\npipe my $in, my $out;\n\nmy $job = Win32::Job-&gt;new;\n\nsub flush_pipe{\n    while (defined(my $line = &lt;$in&gt;)) {\n       chomp($line);\n       print($line);\n\n    }\n}\nmy $pid = $job-&gt;spawn(\"cmd\", \"cmd /C \\\"ipconfig\\\"\",\n    {\n        stdout=&gt;$out\n    }\n);\nflush_pipe();\n</code></pre>\n\n<p>Edit:\nThrough trial and error I eventually found out I have to close the $out filehandle before flushing the pipe.</p>\n"}, {"tags": ["arrays", "perl", "initialization"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513996296, "post_id": 47946510, "comment_id": 82868396, "body": "<code>my $successDOM = !grep { !defined($_) } $mailinglist, $firstname, $lastname, $mail;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": true, "score": 3, "last_activity_date": 1514164407, "last_edit_date": 1514164407, "creation_date": 1513974838, "answer_id": 47947076, "question_id": 47946510, "link": "https://stackoverflow.com/questions/47946510/use-of-uninitialized-values-in-a-list/47947076#47947076", "title": "Use of uninitialized values in a list", "body": "<p>You have at least four problems with your code:</p>\n\n<p>First, {} makes an anonymous hash and returns a reference to it; this is a single value that ends up in @DOM.  The warnings are because hash keys have to be strings, and warn if they are undef.  You should be assigning like</p>\n\n<pre><code>my @DOM = ( $mailinglist, $firstname, $lastname, $mail );\n</code></pre>\n\n<p>Second, <code>eq</code> compares strings, so it would convert <code>undef</code> to <code>''</code>.  To test if $data is undef, do</p>\n\n<pre><code>if (! defined $data) {\n</code></pre>\n\n<p>Third, you are checking if all the array elements were successful inside the for loop (where that will not be true on any but the last iteration of the loop).  Move the <code>if ($successDOM...</code> block to after the for loop.</p>\n\n<p>Fourth, <code>=</code> is just an assignment operator; use <code>==</code> for numeric comparison:</p>\n\n<pre><code>if ($successDOM == @DOM) {\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 7473663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x93kx.png?s=128&g=1", "display_name": "siery", "link": "https://stackoverflow.com/users/7473663/siery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 47947076, "answer_count": 1, "score": -2, "last_activity_date": 1529973540, "creation_date": 1513971209, "last_edit_date": 1529973540, "question_id": 47946510, "link": "https://stackoverflow.com/questions/47946510/use-of-uninitialized-values-in-a-list", "title": "Use of uninitialized values in a list", "body": "<p>I load some variables from the URL and want to check in my CGI script whether are they initialized. I quickly found out that I can not put uninitialized values into an list in Perl.</p>\n\n<p>My approach was simply to iterate through the list and use a switch variable <code>$sucessDOM</code> (1 if all data had been initialized and 0 elsewhere).</p>\n\n<p>I came up with this:</p>\n\n<pre><code>### Read data from HTML\nmy $mailinglist = param( 'mailinglist' );\nmy $firstname   = param( 'firstname' );\nmy $lastname    = param( 'lastname' );\nmy $mail        = param( 'mail' );\n\nmy $sucessDOM = 0;\n\nmy @DOM = { $mailinglist, $firstname, $lastname, $mail };\n\n### Data validation\nfor my $data ( @DOM ) {\n\n    if ( $data eq undef ) {\n        $sucessDOM = $sucessDOM + 1;\n    }\n\n    if ( $sucessDOM = @DOM ) {\n        print \"@DOM\\n\";\n        $sucessDOM = 1;\n    }\n    else {\n        $sucessDOM = 0;\n    }\n}\n</code></pre>\n\n<p>The output is as follows</p>\n\n<pre><code>[Fri Dec 22 20:30:40 2017] read_form.cgi: Use of uninitialized value $mailinglist in anonymous hash ({}) at ./read_form.cgi line 20.\n[Fri Dec 22 20:30:40 2017] read_form.cgi: Use of uninitialized value $lastname in anonymous hash ({}) at ./read_form.cgi line 20.\n[Fri Dec 22 20:30:40 2017] read_form.cgi: Use of uninitialized value in string eq at ./read_form.cgi line 24.\nHASH(0x55c8a73eeea8)\n</code></pre>\n\n<p>I also cannot understand why are there errors for only two values in the array if they are all uninitialized, as I run the script directly without passing any values.</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 3, "creation_date": 1513953487, "post_id": 47943184, "comment_id": 82855958, "body": "What have you tried? What problems are you having? Please show us your code and some sample data. If you don&#39;t have any code, then Stack Overflow is probably not the best place for your question."}, {"owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "edited": false, "score": 0, "creation_date": 1513955968, "post_id": 47943184, "comment_id": 82856988, "body": "My suggestion would be - look at &quot;input record separator&quot; on perldoc. Then try writing some code, and asking a question when you hit problems."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1513968979, "post_id": 47943184, "comment_id": 82862040, "body": "@Flintlock: I&#39;ve had a go at fixing the formatting of your input file and code. Please be more careful in future."}, {"owner": {"reputation": 1, "user_id": 9128645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504a180873ed08cf4d276bff968d8af1?s=128&d=identicon&r=PG&f=1", "display_name": "Flintlock", "link": "https://stackoverflow.com/users/9128645/flintlock"}, "reply_to_user": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1514048569, "post_id": 47943184, "comment_id": 82877882, "body": "@Dave Cross - Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 5334, "user_id": 5830574, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/kCmqs.png?s=128&g=1", "display_name": "PerlDuck", "link": "https://stackoverflow.com/users/5830574/perlduck"}, "edited": false, "score": 2, "creation_date": 1513962340, "post_id": 47944777, "comment_id": 82859700, "body": "It&#39;s also possible that the asker isn&#39;t interested in any explanation."}, {"owner": {"reputation": 1, "user_id": 9128645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504a180873ed08cf4d276bff968d8af1?s=128&d=identicon&r=PG&f=1", "display_name": "Flintlock", "link": "https://stackoverflow.com/users/9128645/flintlock"}, "edited": false, "score": 0, "creation_date": 1513965286, "post_id": 47944777, "comment_id": 82860667, "body": "Thanks - maybe I am not asking the proper question or just the wrong way.  What I have tried is next to nothing because I am not sure how to do what I need other than define a start point, and the infile and outfile."}, {"owner": {"reputation": 1, "user_id": 9128645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504a180873ed08cf4d276bff968d8af1?s=128&d=identicon&r=PG&f=1", "display_name": "Flintlock", "link": "https://stackoverflow.com/users/9128645/flintlock"}, "edited": false, "score": 0, "creation_date": 1513966319, "post_id": 47944777, "comment_id": 82861046, "body": "Thanks for your help.  I am at a loss how to explain this any better maybe I can scrub some of the data and remove personal information.  I will edit my original post."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 1, "last_activity_date": 1513969050, "last_edit_date": 1513969050, "creation_date": 1513961131, "answer_id": 47944777, "question_id": 47943184, "link": "https://stackoverflow.com/questions/47943184/extract-blocks-of-text-from-a-file-and-write-each-block-to-a-new-file-using-perl/47944777#47944777", "title": "Extract blocks of text from a file and write each block to a new file using perl, but it is not working", "body": "<p>If you're not going to put any effort into explaining what you have tried, I'm not going to put any effort into explaining my solution.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\n\nlocal $/ = '&gt;' . ('-' x 146) . \"\\n\";\nmy $year = (localtime)[5] + 1900;\n\n# &lt;&gt; reads from STDIN or a filename given as an argument\nwhile (&lt;&gt;) {\n  next unless /\\S/; # Ignore empty records (like the first one)\n\n  my ($acct) = /Acct:(\\d+)/;\n\n  my $file = \"${acct}_${year}.txt\";\n  open my $fh, '&gt;', $file\n    or die \"Can't open $file: $!\\n\";\n\n  print $fh;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9128645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504a180873ed08cf4d276bff968d8af1?s=128&d=identicon&r=PG&f=1", "display_name": "Flintlock", "link": "https://stackoverflow.com/users/9128645/flintlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "closed_date": 1513962802, "answer_count": 1, "score": -4, "last_activity_date": 1514048409, "creation_date": 1513953260, "last_edit_date": 1514048409, "question_id": 47943184, "link": "https://stackoverflow.com/questions/47943184/extract-blocks-of-text-from-a-file-and-write-each-block-to-a-new-file-using-perl", "closed_reason": "Not suitable for this site", "title": "Extract blocks of text from a file and write each block to a new file using perl, but it is not working", "body": "<p>I have a large data file (text) that contains records from a database.\nEach record is is delimited by \"-\" (146 of them) \nI would like to write the text between each delimiter to a new file based on data from that block.  The new file name should contain a piece of the data followed be the year (ie 2017)</p>\n\n<p>For instance with this sample file:   </p>\n\n<pre><code>1. 12/18/17                                                       \nCompany                                      \n                     PAGE 2\n    1:14 PM  GET                                              CURRENTLY SELECTED DEBTORS\n\n------------------------------------------------------------------------------------------------------------------------\n----------------------------- STATUS              **Acct:1234**       Disposition:9000 CANCEL                      Wait: 04/11/17\n\nDEBTOR              Name:Doe John                         \nSsn:123456789   Cbr:  Ph:555-555-555\n                      Rp:Doe John                           Ssn:               Rp Ph: \n                    Adr1:211 some road     POE:                      Lgl:   POE Ph: \n                    City:anytown                Cty:                     Canc:UNC  Born:01/01/1937\n                      St: VA  Zip:54321        St:     Zip:             COF:N     Sal:\n\n                    Clnt:00248 Someplace, 93076                         Org:    4\n80.00\n                    List:01/05/17 Srv:08/25/16 Pl95:    Time:9    Calls:0   Con:0   Bal:    480.00\n\nCo-Maker's Previous Address Spouse's Previous Address MULTIPLE\nACCOUNTS RM# Acct      Name / Client     Chk# / Lst   Srv      Lpy  \nCol Disp        Bal      Check Reason          Drivers Licen se #\n      PRN      INT      LI3      LI4     AIN      CC     ATY      MS1     PJI 1   142424*   Doe John                                  \n93076/00248/Somewhere  01/05/17 08/25/16            0 9000    \n480.00\n   480.00     0.00     0.00     0.00    0.00    0.00    0.00     0.00    0.00\n\n2. ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n</code></pre>\n\n<p>So from the above is need to extract this block and write it to a new file named 1234_2017.txt based on the Acct:1234 data for that record- then move to the next block.  I have counted the number of records for the first file at 754 records, and I have a total of 10 files such as this.</p>\n\n<pre><code>#! / usr/bin/perl -w\n\nuse strict;\nuse warnings;\n\nuse POSIX 'strftime';\n\nmy $filename = \"Facs_Data.txt\";\nmy $outfile = \"Acct_\".strftime '%Y', localtime;\nmy $start = \"'-' x 146\";\n\nopen (INFILE, \"&lt;$filename\"); open (OUTFILE, \"&gt;$outfile\");\n\nwhile ($start) {\n\n  print $outfile;\n  next\n}\nclose (INFILE);\nclose (OUTFILE);\n</code></pre>\n\n<p>Any suggestions will be greatly appreciated.</p>\n"}, {"tags": ["perl", "unicode", "file-io"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 2, "creation_date": 1513941968, "post_id": 47940662, "comment_id": 82850604, "body": "Your <code>use utf8</code> tells Perl the source code file has utf8 chars in it. You need to open <code>STDOUT</code> with utf8 support or <code>binmode</code> it."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513943811, "post_id": 47940662, "comment_id": 82851518, "body": "@simbabque: This doesn&#39;t seem to have anything to do with <code>use utf8</code>: the code is entirely ASCII. Most likely the first line of <code>&#47;tmp&#47;xx</code> contains extended characters."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513943939, "post_id": 47940662, "comment_id": 82851578, "body": "I know @Borodin. That was my point."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513944081, "post_id": 47940662, "comment_id": 82851640, "body": "@simbabque: Ah. I read it as the problem being because the code has <code>use utf8</code> but <code>STDOUT</code> is in byte mode."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513944153, "post_id": 47940662, "comment_id": 82851687, "body": "@Borodin no, I mentioned the <code>use utf8</code> because it looked like OP thinks it&#39;s useful here."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1513944219, "post_id": 47940662, "comment_id": 82851719, "body": "@simbabque: Yes, I see your meaning now"}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 7, "creation_date": 1513960338, "post_id": 47940728, "comment_id": 82858866, "body": "<code>use open &quot;:std&quot;, &quot;:encoding(UTF-8)&quot;;</code> is better. This also binmodes STDIN and STDERR, and sets the default encoding layer for <code>open</code> in its lexical scope (so, for example, you could use <code>open my $fh, &#39;&lt;&#39;, &#39;&#47;tmp&#47;xxx&#39;</code> instead of <code>open my $fh, &#39;&lt;:encoding(UTF-8)&#39;, &#39;&#47;tmp&#47;xxx&#39;</code>)."}], "tags": [], "owner": {"reputation": 2496, "user_id": 2469275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7EZh.png?s=128&g=1", "display_name": "janh", "link": "https://stackoverflow.com/users/2469275/janh"}, "is_accepted": true, "score": 13, "last_activity_date": 1513942018, "creation_date": 1513942018, "answer_id": 47940728, "question_id": 47940662, "link": "https://stackoverflow.com/questions/47940662/how-to-get-rid-of-wide-character-in-print-at/47940728#47940728", "title": "how to get rid of `Wide character in print at`?", "body": "<p>You're printing to STDOUT which isn't expecting UTF8. \nAdd </p>\n\n<pre><code>binmode(STDOUT, \"encoding(UTF-8)\");\n</code></pre>\n\n<p>to change that on the already opened handle.</p>\n"}, {"tags": [], "owner": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "is_accepted": false, "score": 13, "last_activity_date": 1618502783, "last_edit_date": 1618502783, "creation_date": 1513971859, "answer_id": 47946606, "question_id": 47940662, "link": "https://stackoverflow.com/questions/47940662/how-to-get-rid-of-wide-character-in-print-at/47946606#47946606", "title": "how to get rid of `Wide character in print at`?", "body": "<p>The <code>use utf8</code> means Perl expects your source code to be UTF-8.</p>\n<p>The <code>open</code> pragma can change the encoding of the standard filehandles:</p>\n<pre><code>use open qw( :std :encoding(UTF-8) );\n</code></pre>\n"}], "owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9917, "favorite_count": 2, "accepted_answer_id": 47940728, "answer_count": 2, "score": 8, "last_activity_date": 1618502783, "creation_date": 1513941711, "question_id": 47940662, "link": "https://stackoverflow.com/questions/47940662/how-to-get-rid-of-wide-character-in-print-at", "title": "how to get rid of `Wide character in print at`?", "body": "<p>I have file <code>/tmp/xxx</code> with next content:</p>\n\n<pre><code>00000000 D0 BA D0 B8 \u2502 D1 80 D0 B8 \u2502 D0 BB D0 B8 \u2502 D0 BA     \u043a \u0438 \u0440 \u0438 \u043b \u0438 \u043a\n</code></pre>\n\n<p>When I read content of file and print it I get the error:</p>\n\n<pre><code>Wide character in print at ...\n</code></pre>\n\n<p>The source is:</p>\n\n<pre><code>use utf8;\nopen my $fh, '&lt;:encoding(UTF-8)', '/tmp/xxx';\nprint scalar &lt;$fh&gt;\n</code></pre>\n\n<p>The output from print is:</p>\n\n<pre><code>\u043a\u0438\u0440\u0438\u043b\u0438\u043a  \n</code></pre>\n"}, {"tags": ["perl"], "answers": [{"comments": [{"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1513924668, "post_id": 47936378, "comment_id": 82843045, "body": "The parens are not needed"}], "tags": [], "owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "is_accepted": false, "score": 1, "last_activity_date": 1513921271, "creation_date": 1513921271, "answer_id": 47936378, "question_id": 47936204, "link": "https://stackoverflow.com/questions/47936204/reduce-array-to-anonymous-hash-code/47936378#47936378", "title": "Reduce array to anonymous hash code", "body": "<p>You can turn it into a hash <em>reference</em> easily with just</p>\n\n<pre><code>{@a}\n</code></pre>\n\n<p>and dereference entries with, for example</p>\n\n<pre><code>({@a})-&gt;{key}\n</code></pre>\n\n<p>Here's a debugger log:</p>\n\n<pre><code>$ perl -de0\n\nLoading DB routines from perl5db.pl version 1.49_001\nEditor support available.\n\nEnter h or 'h h' for help, or 'man perldebug' for more help.\n\nmain::(-e:1):   0\n  DB&lt;1&gt; @a = ('a',1,'b',2,'c',3)\n\n  DB&lt;2&gt; x @a\n0  'a'\n1  1\n2  'b'\n3  2\n4  'c'\n5  3\n  DB&lt;3&gt; x {@a}\n0  'a'\n1  1\n2  'b'\n3  2\n4  'c'\n5  3\n  DB&lt;4&gt; x ({@a})\n0  HASH(0x804d82e0)\n   'a' =&gt; 1\n   'b' =&gt; 2\n   'c' =&gt; 3\n  DB&lt;5&gt; x ({@a})-&gt;{c}\n0  3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1513921579, "post_id": 47936381, "comment_id": 82842166, "body": "Im using like javascript passes errors to callbacks. I will update question to explain."}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1513923785, "post_id": 47936381, "comment_id": 82842764, "body": "the main part that I think is ugly is encapsulating the callback within an anonymouse subroutine but from what I can tell, I can&#39;t pass a subroutine reference with parameters as the callback ( fail_cb =&gt;\\&amp;error(({@_})-&gt;{err})   ). This idea is that I can have a subroutine success(),exit(), etc.. that will display the message differently or I can define a completely new one as an anonymose subroutine and still have the err functionality."}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1513924038, "post_id": 47936381, "comment_id": 82842835, "body": "The callback is still called within the do_something function in this case and the above code seems to work correctly as far as I can tell."}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1513924905, "post_id": 47936381, "comment_id": 82843129, "body": "I think I understand the code (barely) but I am not sure how to apply it to what I&#39;m trying to do. Would the subs defined in $_[0] be error, success, etc..? Also would it make more sense to define $_[0] hash outside tt so that it can be reused with multiple tt calls?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1513925140, "post_id": 47936381, "comment_id": 82843211, "body": "@TheAschr For example, if you have <code>$rh = { error =&gt; sub { say &quot;got error: @_&quot; } }</code>, then yes, <code>func($hr, &quot;error&quot;, $cb_args)</code> will run <code>sub { say &quot;...: @_&quot; }</code> with whatever is in arrayref <code>$cb_args</code>. You can have a default for <code>$cb_args</code> refarray so that it&#39;s optional."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1513925390, "post_id": 47936381, "comment_id": 82843288, "body": "@TheAschr As for the rest of your comment -- yes, this is what I show in the edit and one-liner; the hashref (<code>$_[0]</code> in the sub) is built somewhere else, so <code>func(...)</code> can dynamically select which one to run and how (with what arguments). All this is only a sketch; what is shown can easily be done otherwise but I assume that you have more elaborate needs, passing these things further etc."}, {"owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "edited": false, "score": 0, "creation_date": 1513925510, "post_id": 47936381, "comment_id": 82843325, "body": "Thanks alot for your help! This was super helpful."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": true, "score": 2, "last_activity_date": 1514080769, "last_edit_date": 1514080769, "creation_date": 1513921281, "answer_id": 47936381, "question_id": 47936204, "link": "https://stackoverflow.com/questions/47936204/reduce-array-to-anonymous-hash-code/47936381#47936381", "title": "Reduce array to anonymous hash code", "body": "<p>Yes, by making it into a reference and then dereferencing</p>\n\n<pre><code>sub func { say ${{@_}}{key} }\n</code></pre>\n\n<p>(I must ask, do you really want to be doing this?)</p>\n\n<p>The <code>{@_}</code> creates a hash reference, while <code>${ ... }{}</code> syntax <a href=\"https://perldoc.perl.org/perlref.html#Using-References\" rel=\"nofollow noreferrer\">dereferences it (item 2)</a>.</p>\n\n<hr>\n\n<p><strong>Update to the question edit</strong></p>\n\n<p>Apparently, the intent is to run a callback. But then you need to <em>run</em> that callback</p>\n\n<pre><code>sub func { ${{@_}}{key}-&gt;() }\n\nfunc( key =&gt; sub { say \"cb here\" } );\n</code></pre>\n\n<p>If you were to print the value, as asked, you'd get the code-reference itself, <code>CODE(0x...)</code></p>\n\n<p>Or, pass the hashref with a key and (the reference of) arguments for the callback</p>\n\n<pre><code>my $hr = { k1 =&gt; sub { .. }, k2 =&gt; sub { .. }, .. };\n...\nfunc($hr, $key, $arrayref_cb_args);\n\nsub func { $_[0]-&gt;{$_[1]}-&gt;(@{$_[2]}) }\n</code></pre>\n\n<p>where now <code>func</code> can decide dynamically what to run. This gives you far more flexibility in design.</p>\n\n<p>For a ready test</p>\n\n<pre><code>perl -wE'\n    sub tt { $_[0]-&gt;{$_[1]}-&gt;(@{$_[2]}) };\n    tt( { k1 =&gt; sub { say \"args: @_\" }}, \"k1\", [qw(cb here)] )\n'\n</code></pre>\n\n<p>prints the line &nbsp; <code>args: cb here</code></p>\n"}], "owner": {"reputation": 565, "user_id": 5026330, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-7PNIbZa6ycw/AAAAAAAAAAI/AAAAAAAAADA/tOhkqIJQUrQ/photo.jpg?sz=128", "display_name": "TheAschr", "link": "https://stackoverflow.com/users/5026330/theaschr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 47936381, "answer_count": 2, "score": 1, "last_activity_date": 1514080769, "creation_date": 1513920081, "last_edit_date": 1513922743, "question_id": 47936204, "link": "https://stackoverflow.com/questions/47936204/reduce-array-to-anonymous-hash-code", "title": "Reduce array to anonymous hash code", "body": "<p>Is there anyway to do something like this in perl (convert array hash and use it in one line)?</p>\n\n<pre><code>sub func{\n #from this\n my %args = @_;\n print $args{test};\n\n #to this\n print %{@_}{test};\n}\n</code></pre>\n\n<p>Im using it for passing errors to callbacks like javascript\n    use strict;\n    use warnings;</p>\n\n<pre><code>sub error{\n my $msg = shift;\n print(\"ERROR: $msg\\n\");\n}\n\nsub parse_args{\n    my %args = @_;\n    return $args{args};\n}\n\nsub do_something{\n   my $args = parse_args(\n     args=&gt;{@_},\n     optional_args=&gt;[\"fail_cb\"]\n   );\n   if(!0){\n    return(exists $args-&gt;{fail_cb} ? $args-&gt;{fail_cb}-&gt;(err=&gt;\"not good\") : 0);\n   }\n}\n\ndo_something(\n fail_cb =&gt; sub{error(({@_})-&gt;{err});}\n);\n</code></pre>\n"}, {"tags": ["postgresql", "perl"], "comments": [{"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513909236, "post_id": 47934441, "comment_id": 82839656, "body": "can you edit your post to give more clear examples of the input and desired output?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9124659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd09bff41dec1a407487f01985841076?s=128&d=identicon&r=PG&f=1", "display_name": "Sherman", "link": "https://stackoverflow.com/users/9124659/sherman"}, "is_accepted": false, "score": 1, "last_activity_date": 1513954018, "creation_date": 1513954018, "answer_id": 47943328, "question_id": 47934441, "link": "https://stackoverflow.com/questions/47934441/prepend-the-next-read-in-line-with-information-from-the-previous-read-in-line/47943328#47943328", "title": "prepend the next read in line with information from the previous read in line", "body": "<p>I will fix this by capturing the value to a file. Upon the next line read I will extract the value and prepend it to the string. Thank you for looking at this. I don't know why I didn't think of this before.</p>\n\n<p>Thank you;</p>\n\n<p>Sherman</p>\n"}], "owner": {"reputation": 11, "user_id": 9124659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd09bff41dec1a407487f01985841076?s=128&d=identicon&r=PG&f=1", "display_name": "Sherman", "link": "https://stackoverflow.com/users/9124659/sherman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1513954018, "creation_date": 1513902099, "last_edit_date": 1513937752, "question_id": 47934441, "link": "https://stackoverflow.com/questions/47934441/prepend-the-next-read-in-line-with-information-from-the-previous-read-in-line", "title": "prepend the next read in line with information from the previous read in line", "body": "<p>Development Platform: Ubuntu 17.10 mainly command line work</p>\n\n<p>Tools: perl 5.26 and postgresql 9.6</p>\n\n<p>goal: Convert a file so I can \\COPY it into postgresql</p>\n\n<p>Information: Line delimiter is the # sign</p>\n\n<p>Database table columns: <code>id work composer artist conductor orchestra album_title</code></p>\n\n<p>problem: append next info line to current id line</p>\n\n<p>In the following how do I preserve the 'mmfmm01#' so upon the next line iteration I can prepend it to that next line? As this is my first post please let me know if the code example is too much or too little.</p>\n\n<p>I am going from this:</p>\n\n<blockquote>\n  <p>Le Nozze di Figaro, K. 492 / The Marriage of Figaro: Le Nozze di\n  Figaro, K. 492 / The Marriage of Figaro: Cinque ... dieci ... venti /\n  Five ...Ten ...Twenty</p>\n</blockquote>\n\n<p>Eventually to this:</p>\n\n<blockquote>\n  <p>mfmm01#Cinque dieci venti#Mozart####Entertaining Made Simple Merlot,\n  Filet Mignon, Mozart</p>\n</blockquote>\n\n<p>After running the script I have the following:</p>\n\n<blockquote>\n  <p>mfmm01#</p>\n</blockquote>\n\n<p>How do I have to preserve the 'mfmm01#' so upon the next line iteration I can prepend it to that next line?</p>\n\n<pre><code>    #!/usr/bin/perl \n    # use clauses for File, cwd, etc#\n    # usage statment\n\n    # Variables - append _orig to input_file\n    my $id = $ARGV[1];\n    my $input_file = $ARGV[0];\n    my $album_title = $ARGV[2];\n    my $output_file = output_file;\n    my $input_file_orig = $input_file;\n    $input_file_orig = $input_file_orig .= _orig;\n\n    ##############################################\n    # Ensure that the provided input file exists #\n    ##############################################\n\n    ##########################################################\n    # Read all file lines into an array                      #\n    ##########################################################\n\n   ###########################################################\n   # Modify each line to meet the following specs:           #\n   # id#work#composer#artist#conductor#orchestra#album_title #\n   ###########################################################\n     for my $line (@lines) {\n        $line =~ s/[\\n\\r\\t]+//g;\n        ######################################################\n        # Ignore lines with num:num, lines that begin with $ #\n        # and emptry string lines                            #\n        # ####################################################\n        if ( $line =~ /[0-9]:/m ) {\n            next;\n        } elsif ( $line =~ /^\\$/m ) {\n            next;\n        } else {\n        if ( $line =~ /^\\s*$/m ) {\n                next;\n        }\n        }\n        ########################################################\n        # If line is a number followed by a space, prepend id  #\n        # and replace space with the # character               #\n        ########################################################\n        if ( $line =~ /^\\d\\d\\s/m ) {\n            $id_num = $line;\n            $id_num =~ s/(\\d\\d)\\s/$id$1#/g; \n        } else {\n            if ( $line =~ /^\\d\\s/m ) {\n            $id_num = $line;\n            $id_num =~ s/(\\d)\\s/$id$1#/g;\n   #        print (\"\\$line after removing space: \\\"$line\\\"\\n\");\n        }\n    }\n    ####################################################\n    # If line begins with an alphabetic character then #\n    # prepend id_num and append album_title            #\n    ####################################################\n    if ( $line =~ /Sold/m ) {\n        next;\n    }\n    if ( $line =~ /^[A-Z]/m ) {\n        ################################################i##\n    # At this point $line exists but $id_num is empty #\n    # I thought $id_num would live through the next   #\n    # line read                                       #\n    ###################################################\n           $prepend_line =~ s/($line)/$id_num$1/g; \n           print(\"$prepend_line\");\n           $append_line =~ s/($prepend_line)/$1#Mozart###$album_title/g;\n           open my $ofh, '&gt;&gt;', $output_file or die $!;\n           print $ofh \"$append_line\\n\";\n           close $ofh or die $!;\n           print(\"\\$append_line: $append_line\\n\");\n        }\n    }\n\n    1;\n</code></pre>\n"}, {"tags": ["perl", "xml-parsing", "xml-simple"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1513886385, "post_id": 47929127, "comment_id": 82832863, "body": "If I ever needed to handle documents that didn&#39;t fit into memory, I&#39;d use XML::LibXML::Reader (and its <code>copyCurrentNode(1)</code>) or XML::Twig (using <code>twig_roots</code>)."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1513890285, "post_id": 47929127, "comment_id": 82834402, "body": "I have no idea what <code>XML::Simple</code> does when you call <code>XMLin</code> multiple times on the same object. But you may get some mileage from moving <code>my $xml = XML::Simple-&gt;new</code> <i>inside</i> the <code>while</code> loop immediately before the call to <code>XMLin</code>."}], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 4810570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e7lh0mX9YsA/AAAAAAAAAAI/AAAAAAAAApY/EGaDNC0uGEI/photo.jpg?sz=128", "display_name": "Curt Evans", "link": "https://stackoverflow.com/users/4810570/curt-evans"}, "is_accepted": false, "score": -1, "last_activity_date": 1514480209, "creation_date": 1514480209, "answer_id": 48011345, "question_id": 47929127, "link": "https://stackoverflow.com/questions/47929127/xmlsimple-returns-out-of-memory-error-for-large-xmls/48011345#48011345", "title": "XML::Simple returns &quot;Out of memory&quot; error for large XMLs", "body": "<p>First off, if the file contains newlines, </p>\n\n<pre><code>  while (my $row = &lt;$fh_i&gt;){\n  $row =~ s/\\R//g;\n  my $data = $xml-&gt;XMLin($row);\n</code></pre>\n\n<p>is going to read one line at a time from the file and attempt to do an XML conversion on that line alone instead of the whole document. I would recommend that you slurp each file into a buffer and use regex to eliminate newlines and carriage returns before XMLin conversion. Also, XMLin will <strong>die</strong> unceremoniously if there are any XML errors in the file, so you want to run it in an eval block.</p>\n"}, {"tags": [], "owner": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "is_accepted": false, "score": 0, "last_activity_date": 1514489109, "creation_date": 1514489109, "answer_id": 48013198, "question_id": 47929127, "link": "https://stackoverflow.com/questions/47929127/xmlsimple-returns-out-of-memory-error-for-large-xmls/48013198#48013198", "title": "XML::Simple returns &quot;Out of memory&quot; error for large XMLs", "body": "<p>I recommend that people stop using <code>XML::Simple</code> when they have a problem using it. That module is nice to get started but its not meant to be a long term solution. Even then, see <a href=\"https://stackoverflow.com/questions/33267765/why-is-xmlsimple-discouraged\">Why is XML::Simple \u201cDiscouraged\u201d?</a></p>\n\n<p><code>XML::Twig</code> is what I often use for these tasks. You can set up handlers for tags and get that part of the tree. You process it and move on. That might be as simple as something like this where I set up a subroutine to process each <code>EDI_DC40</code> as I encounter it: </p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use Text::CSV_XS;\nuse XML::Twig;\n\nmy $csv = Text::CSV_XS-&gt;new;\n\nmy $twig = XML::Twig-&gt;new(   \n    twig_handlers =&gt; { \n        'EDI_DC40' =&gt; \\&amp;process_EDI_DC40,\n        },\n    );\n\n$twig-&gt;parsefile( $ARGV[0] );\n\nsub process_EDI_DC40 {\n    my( $twig, $thingy ) = @_;\n\n    my @values = map { $thingy-&gt;first_child( $_ )-&gt;text } \n        qw(DOCNUM RCVPRN SNDPRN);\n\n    $csv-&gt;say( *STDOUT, \\@values );\n    }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8574762, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5afecf6b5c18343b46bf7619d07ec35e?s=128&d=identicon&r=PG&f=1", "display_name": "Kaladin", "link": "https://stackoverflow.com/users/8574762/kaladin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1514489163, "creation_date": 1513874029, "last_edit_date": 1514489163, "question_id": 47929127, "link": "https://stackoverflow.com/questions/47929127/xmlsimple-returns-out-of-memory-error-for-large-xmls", "title": "XML::Simple returns &quot;Out of memory&quot; error for large XMLs", "body": "<p>This might take a while to explain, but I have a file (XMLList.txt) that contains the paths to multiple IDOC XMLs. The contents of the XMLList.txt look like this:</p>\n\n<blockquote>\n  <p>/usr/local/sterlingcommerce/data/archive/SFGprdr/SFTPGET/2017/Dec/week_4/AU_DHL_PW_Inbound_Delivery_from_Pfizer_20171220071754.xml\n  /usr/local/sterlingcommerce/data/archive/SFGprdr/SFTPGET/2017/Dec/week_4/AU_DHL_PW_Inbound_Delivery_from_Pfizer_20171220083310.xml\n  /usr/local/sterlingcommerce/data/archive/SFGprdr/SFTPGET/2017/Dec/week_4/CCMastOut_MQ_GLB_1_20171220154826.xml</p>\n</blockquote>\n\n<p>I'm attempting to create a Perl script that reads each XML and parses just the values of the tags DOCNUM, SNDPRN and RCVPRN from each XML file into a pipe delimited file \"report.csv\" </p>\n\n<p>Another thing to note is that my XML files could be:\nAll on a single line - example</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;ZDELVRY073PL&gt;&lt;IDOC BEGIN=\"1\"&gt;\n    &lt;EDI_DC40 SEGMENT=\"1\"&gt;&lt;TABNAM&gt;EDI_DC40&lt;/TABNAM&gt;&lt;MANDT&gt;400&lt;/MANDT&gt;\n    &lt;DOCNUM&gt;0000000443474886&lt;/DOCNUM&gt;&lt;DOCREL&gt;731&lt;/DOCREL&gt;&lt;STATUS&gt;30&lt;/STATUS&gt;\n    &lt;DIRECT&gt;1&lt;/DIRECT&gt;&lt;OUTMOD&gt;4&lt;/OUTMOD&gt;&lt;IDOCTYP&gt;DELVRY07&lt;/IDOCTYP&gt;\n    &lt;CIMTYP&gt;ZDELVRY073PL&lt;/CIMTYP&gt;&lt;MESTYP&gt;ZIBDADV&lt;/MESTYP&gt;&lt;MESCOD&gt;IBG&lt;/MESCOD&gt;\n    &lt;SNDPOR&gt;SAPQ01&lt;/SNDPOR&gt;&lt;SNDPRT&gt;LS&lt;/SNDPRT&gt;&lt;SNDPRN&gt;Q01CLNT400&lt;/SNDPRN&gt;\n    &lt;RCVPOR&gt;XMLDIST_MT&lt;/RCVPOR&gt;&lt;RCVPRT&gt;LS&lt;/RCVPRT&gt;&lt;RCVPFC&gt;LS&lt;/RCVPFC&gt;\n    &lt;RCVPRN&gt;AU_DHL&lt;/RCVPRN&gt;.... &lt;/EDI_DC40&gt;&lt;/IDOC&gt;\n</code></pre>\n\n<p>or multiline XML:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>  &lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\" ?&gt;\n    &lt;INVOIC02&gt;\n      &lt;IDOC&gt;\n        &lt;EDI_DC40&gt;\n      &lt;TABNAM/&gt;\n      &lt;DOCNUM&gt;0000000658056255&lt;/DOCNUM&gt;\n      &lt;DIRECT/&gt;\n      &lt;IDOCTYP&gt;INVOIC02&lt;/IDOCTYP&gt;\n      &lt;MESTYP&gt;INVOIC&lt;/MESTYP&gt;\n      &lt;SNDPOR&gt;SAPP01&lt;/SNDPOR&gt;\n      &lt;SNDPRT/&gt;\n      &lt;SNDPRN&gt;ALE400&lt;/SNDPRN&gt;\n      &lt;RCVPOR&gt;XMLINVOICE&lt;/RCVPOR&gt;\n      &lt;RCVPRT&gt;KU&lt;/RCVPRT&gt;\n      &lt;RCVPRN&gt;C18BASWARE&lt;/RCVPRN&gt;\n      &lt;CREDAT&gt;20171220&lt;/CREDAT&gt;\n      &lt;CRETIM&gt;222323&lt;/CRETIM&gt;\n    &lt;/EDI_DC40&gt;\n</code></pre>\n\n<p>The script I've used so far seems to work for small XMLs. However, some XMLs > 50 MB throw this error:</p>\n\n<blockquote>\n  <p>Out of memory! Out of memory! Callback called exit at\n  /usr/opt/perl5/lib/site_perl/5.10.1/XML/SAX/Base.pm\n          line 1941 (#1)\n      (F) A subroutine invoked from an external package via call_sv()\n      exited by calling exit.</p>\n  \n  <p>Out of memory!</p>\n</blockquote>\n\n<p>So, here's the code I'm using. Would like your help tweaking this:</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\nuse diagnostics;\n# use module\nuse XML::Simple;\nuse Data::Dumper;\n\n# create object\nmy $xml = new XML::Simple; \n\nmy $file_list = 'XMLList.txt';\nopen(my $fh_i, '&lt;:encoding(UTF-8)', $file_list)\n  or die \"Could not open file '$file_list' $!\";\n\nmy $csv_out = 'report.csv';\nopen(my $fh_o, '&gt;', $csv_out)\n  or die \"Could not open file '$csv_out' $!\"; \n\nwhile (my $row = &lt;$fh_i&gt;) {\n  $row =~ s/\\R//g;\n  my $data = $xml-&gt;XMLin($row);\n  print $fh_o \"$data-&gt;{IDOC}-&gt;{EDI_DC40}-&gt;{DOCNUM}|\";\n  print $fh_o \"$data-&gt;{IDOC}-&gt;{EDI_DC40}-&gt;{SNDPRN}|\";\n  print $fh_o \"$data-&gt;{IDOC}-&gt;{EDI_DC40}-&gt;{RCVPRN}\\n\";\n}\n\nclose $fh_o;\n</code></pre>\n"}, {"tags": ["regex", "perl", "grep"], "answers": [{"comments": [{"owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "edited": false, "score": 0, "creation_date": 1513880621, "post_id": 47928127, "comment_id": 82829954, "body": "I don&#39;t think so, OP is asking how to populate the hash automatically instead of hard coding it"}], "tags": [], "owner": {"reputation": 5729, "user_id": 8332344, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LPhKe.jpg?s=128&g=1", "display_name": "Matheus Lacerda", "link": "https://stackoverflow.com/users/8332344/matheus-lacerda"}, "is_accepted": false, "score": 0, "last_activity_date": 1513870322, "creation_date": 1513870322, "answer_id": 47928127, "question_id": 47928075, "link": "https://stackoverflow.com/questions/47928075/perl-regex-hash-to-match-string/47928127#47928127", "title": "Perl regex hash to match string", "body": "<p>If I undestood you correctly, </p>\n\n<pre><code>b\\d+\n</code></pre>\n\n<p>This will match \"b\" followed by any string of only numbers.</p>\n"}, {"tags": [], "owner": {"reputation": 377, "user_id": 6583638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zobe.jpg?s=128&g=1", "display_name": "Flying_whale", "link": "https://stackoverflow.com/users/6583638/flying-whale"}, "is_accepted": false, "score": 0, "last_activity_date": 1513873229, "last_edit_date": 1513873229, "creation_date": 1513872511, "answer_id": 47928684, "question_id": 47928075, "link": "https://stackoverflow.com/questions/47928075/perl-regex-hash-to-match-string/47928684#47928684", "title": "Perl regex hash to match string", "body": "<pre><code>my %strings = ('a' =&gt; 'x',\n         map{(\"b$_\" , 'y') } 0..63,\n         'c' =&gt; 'z');\n</code></pre>\n\n<p>should do the trick ;)</p>\n\n<p>if it is what you want</p>\n\n<p>if you need to add a 'b value' later in the code, you still can do <code>$strings{\"b$value\"} = 'y';</code> to add the new value in the hash</p>\n"}, {"tags": [], "owner": {"reputation": 1672, "user_id": 4355253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee8cbfecfb7686f370b07eea52273c5?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Elices", "link": "https://stackoverflow.com/users/4355253/javier-elices"}, "is_accepted": true, "score": 4, "last_activity_date": 1513879786, "last_edit_date": 1513879786, "creation_date": 1513878380, "answer_id": 47930190, "question_id": 47928075, "link": "https://stackoverflow.com/questions/47928075/perl-regex-hash-to-match-string/47930190#47930190", "title": "Perl regex hash to match string", "body": "<p>If you want to use a regular expression, nothing prevents you from doing so:</p>\n\n<pre><code>%strings = (\n  'a'    =&gt; 'x',\n  'b\\d+' =&gt; 'y',\n  'c'    =&gt; 'z'\n);\n...\n\nif( grep { $line[0] =~ /^$_$/ } keys %strings ) {\n  ...\n}\n</code></pre>\n\n<p>The <code>^</code> and <code>$</code> are necessary to make sure the full string <code>$line[0]</code> matches and not only a part of it.</p>\n\n<p>Bear in mind that this will be much slower than the <code>eq</code> comparison. On the other hand, the number of expressions to evaluate by <code>grep</code> will be much lower, so you may want to profile different options if the speed of execution is an issue.</p>\n\n<p>Also, keep in mind that you may want to refine the regular expression. For instance, <code>^b\\d{1,2}$</code> will match a <code>b</code> followed by one or two digits. Or even <code>^b[1-6]?\\d$</code>...</p>\n"}], "owner": {"reputation": 345, "user_id": 3880362, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/42e3eaa9029285b2071ee9c314125164?s=128&d=identicon&r=PG&f=1", "display_name": "Sharki", "link": "https://stackoverflow.com/users/3880362/sharki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 47930190, "answer_count": 3, "score": 1, "last_activity_date": 1513879786, "creation_date": 1513870155, "question_id": 47928075, "link": "https://stackoverflow.com/questions/47928075/perl-regex-hash-to-match-string", "title": "Perl regex hash to match string", "body": "<p>Right now I have the following code...</p>\n\n<pre><code>%strings = ( 'a' =&gt; 'x',\n             'b0' =&gt; 'y',\n             'b1' =&gt; 'y',\n             'b2' =&gt; 'y',\n                 ...\n             'bN' =&gt; 'y'\n             'c' =&gt; 'z');\n               ....\n\n\nif(grep { $_ eq $line[0] } keys %strings){\n   ....\n}\n</code></pre>\n\n<p>So over all I setup this hash. $line is created by reading a file. I then look to see if the first string in the line is contained within my hash. This code works perfectly. However, my problem arises with the fact that in the hash, b is growing. For instance right now I have to explicitly list out b0 - b63. This is 64 different definitions that all just need to have the same value. Is there a way to have a regex for the hash key like <code>b\\/d\\</code>? </p>\n"}, {"tags": ["perl", "mojolicious"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513871954, "post_id": 47927935, "comment_id": 82825542, "body": "In <a href=\"https://groups.google.com/forum/#!topic/mojolicious/f1SLFXSGRVk\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/mojolicious/f1SLFXSGRVk</a> sri suggests to use <code>&lt;%= __FILE__ %&gt;</code>."}, {"owner": {"reputation": 3574, "user_id": 676192, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fcef8c55deae46cc0bfe986b2c189f70?s=128&d=identicon&r=PG", "display_name": "simone", "link": "https://stackoverflow.com/users/676192/simone"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1513872532, "post_id": 47927935, "comment_id": 82825875, "body": "@simbabque it does not work if used in a wrapper template (layout) - see the question"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513872596, "post_id": 47927935, "comment_id": 82825905, "body": "Sri also calls doing this a code smell in the thread. It seems they haven&#39;t implemented anything that allows you to do it by now."}], "answers": [{"tags": [], "owner": {"reputation": 3574, "user_id": 676192, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fcef8c55deae46cc0bfe986b2c189f70?s=128&d=identicon&r=PG", "display_name": "simone", "link": "https://stackoverflow.com/users/676192/simone"}, "is_accepted": false, "score": 1, "last_activity_date": 1515237302, "last_edit_date": 1515237302, "creation_date": 1515110244, "answer_id": 48105299, "question_id": 47927935, "link": "https://stackoverflow.com/questions/47927935/how-can-i-access-the-current-template-name-in-mojolicious/48105299#48105299", "title": "How can I access the current template name in Mojolicious?", "body": "<p>This can be done in two slightly different ways:</p>\n\n<p>First by adding a <code>before_render</code> hook and setting a variable. It's easy to pack it all inside a plugin like so:</p>\n\n<pre><code>package Mojolicious::Plugin::TemplateName;\n\nuse Mojo::Base 'Mojolicious::Plugin';\n\nsub register {\n    my ($self, $app, $conf) = @_;\n\n    $app-&gt;helper('template' =&gt; sub { return shift-&gt;stash('mojo.template') });\n    $app-&gt;hook(before_render =&gt; sub {\n           my $c = shift;\n           $c-&gt;stash('mojo.template', $_[0]-&gt;{template} )\n           });\n}\n\n1;\n</code></pre>\n\n<p>and use it inside a template like this</p>\n\n<pre><code>&lt;%= template %&gt;\n</code></pre>\n\n<p>Second, it can be done inside the templates - by setting the variable inside the template itself:</p>\n\n<pre><code>% stash('template', __FILE__);\n</code></pre>\n\n<p>and then reusing the variable in the layout:</p>\n\n<pre><code>&lt;%= $template %&gt;        \n</code></pre>\n\n<p>In this case you get the file name with suffix and all - not just the template.</p>\n\n<p>Inspired by the answer <a href=\"https://stackoverflow.com/questions/47798400/how-to-postpone-head-rendering/47798601#47798601\">here</a> about templates being rendered inside-out.</p>\n"}], "owner": {"reputation": 3574, "user_id": 676192, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fcef8c55deae46cc0bfe986b2c189f70?s=128&d=identicon&r=PG", "display_name": "simone", "link": "https://stackoverflow.com/users/676192/simone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1515237302, "creation_date": 1513869660, "question_id": 47927935, "link": "https://stackoverflow.com/questions/47927935/how-can-i-access-the-current-template-name-in-mojolicious", "title": "How can I access the current template name in Mojolicious?", "body": "<p>I'd like to access the template name in Mojolicious <em>from inside the template itself</em> for debugging purposes, in the same way the Template Toolkit does (see <a href=\"http://www.template-toolkit.org/docs/manual/Variables.html#section_template\" rel=\"noreferrer\">here</a>)</p>\n\n<p>The variable <code>__FILE__</code> works neatly but it refers to the <em>current</em> file and not to the top level template, which means it's useless inside a layout template.</p>\n\n<p>I've also tried</p>\n\n<pre><code>&lt;%= app-&gt;renderer-&gt;template_name %&gt;\n</code></pre>\n\n<p>but no result</p>\n\n<p>Is it possible at all in Mojolicious?</p>\n"}, {"tags": ["linux", "perl", "cron", "stdout"], "comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513861654, "post_id": 47925653, "comment_id": 82818969, "body": "How is this Perl script invoked, and how exactly are you calling <code>system()</code>?"}, {"owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513861915, "post_id": 47925653, "comment_id": 82819131, "body": "From crontab:      * * * * * /home/username/perl/myscript.pl  Manually:      ./home/username/perl/myscript.pl  Executable is called from inside the script like:      system( @array_executable_and_parameters);"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513862152, "post_id": 47925653, "comment_id": 82819292, "body": "Your interactive example has a dot before <code>&#47;home</code> so those are not equivalent unless you are in the root directory; but I assume that&#39;s a spurious detail.  Can you <a href=\"https://stackoverflow.com/posts/47925653/edit\">edit</a> your question with a simple <code>system()</code> call in the demo script which fails to do what you expect?"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513862244, "post_id": 47925653, "comment_id": 82819357, "body": "For your second question, <a href=\"https://stackoverflow.com/questions/2813092/can-i-find-a-filename-from-a-filehandle-in-perl\" title=\"can i find a filename from a filehandle in perl\">stackoverflow.com/questions/2813092/&hellip;</a>"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513862367, "post_id": 47925653, "comment_id": 82819437, "body": "Thanks for the edit, We&#39;d still need a good example of what&#39;s in the array in order to make this a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513862629, "post_id": 47925653, "comment_id": 82819614, "body": "The contents are pretty long line of relative path to the executable and a pretty long list of arguments, I can not provide at the moment. But they do not matter as the print command acts same, it does not output to the logfile when run from cron, but works as expected when run manually. I hope that helps."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513863020, "post_id": 47925653, "comment_id": 82819811, "body": "As the link in my previous comment explains, you don&#39;t need to show us <i>exactly</i> the code you are having trouble with. You can, and should, specify a <i>minimal</i> code snippet which behaves the way you describe. Can you repro with e.g. <code>@array_executable_and_parameters = qw&#47;echo foo&#47;</code> or for stderr <code>qw&#47;perl -e die&#47;</code>??"}, {"owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513863483, "post_id": 47925653, "comment_id": 82820106, "body": "When adding the echo foo, output from cron runs went to /var/spool/mail/username."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513864014, "post_id": 47925653, "comment_id": 82820392, "body": "I also get it to stdout in interactive use. Are you running this in a directory where the directory <code>log</code> does not exist? You are not logging errors from attempting to open the file so we don&#39;t know if that is succeeding."}], "answers": [{"comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513866156, "post_id": 47926390, "comment_id": 82821783, "body": "What about <code>select</code>?"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1513868422, "post_id": 47926390, "comment_id": 82823414, "body": "Haven&#39;t tested that specifically but yeah, TMTOWTDI."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 3, "creation_date": 1513873065, "post_id": 47926390, "comment_id": 82826154, "body": "@simbabque, <code>select</code> won&#39;t affect <code>system</code> either. Only <code>open (STDOUT, &#39;&gt;&amp;&#39;, $log_fh)</code> and <code>open (STDOUT, &#39;&gt;&#39;, &quot;...&quot;)</code> will change fd 1"}, {"owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "edited": false, "score": 0, "creation_date": 1513925746, "post_id": 47926390, "comment_id": 82843400, "body": "Adding <code>open (STDOUT, &#39;&gt;&gt;&#39;, &quot;$logfilename&quot;);</code> after <code>open(LOGFILEHANDLE, &quot;&gt;&gt;$logfilename&quot; );</code> works same way - all good when run manually, but outputs everything to mail file when run from cron. I can not use strict, as the script is failry old and big beast, which needs some improvements many places. I probably am completely unaware of some more missed stuff, thanks for your patience with a Perl beginner here :)"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513925823, "post_id": 47926390, "comment_id": 82843429, "body": "So, repeat; are you running it from <code>cron</code> in a directory where the <code>log</code> directory exists, and are you sure that you were successfully able to open the log file?"}, {"owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "edited": false, "score": 0, "creation_date": 1513928143, "post_id": 47926390, "comment_id": 82844196, "body": "Yes, it is run from cron of same user as run manually. Cronline has full path to script file. Same folder that has the script file also has a log folder which already has logfiles in them, from previous manual runs. It makes no difference whether the logfiles exist or not. The problem is that the script does not write to the files when run from cron. Ohh, I get it now! When run manually with full path, then it spits out to STDOUT - my console, not the logfiles!"}, {"owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "edited": false, "score": 0, "creation_date": 1513928545, "post_id": 47926390, "comment_id": 82844319, "body": "Works as expected only when I am in the script folder, both run with <code>.&#47;scriptname.pl</code> or full path. When I run it from other folder, with full path and scriptname, then it spits out to STDOUT - console."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513929355, "post_id": 47926390, "comment_id": 82844636, "body": "Exactly, because it cannot create the file in a directory which does not exist. What I&#39;m trying to say is that this is probably what&#39;s happening when you run it from <code>crontab</code>. Maybe don&#39;t hard-code a directory for the log file (though it could still fail if you run it where you don&#39;t have write access ... though that&#39;s of course less likely).  For the record, <code>cron</code> jobs run in your home directory. Updated the answer to make this explicit."}, {"owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "edited": false, "score": 0, "creation_date": 1513929952, "post_id": 47926390, "comment_id": 82844865, "body": "That is a bit strange, as my original script has at start <code>chdir(&quot;$ENV{HOME}&#47;perl&quot;);</code>. As well it can write to the relative logfile itself, just the STDOUT from external binary program that refuses to go there. So what is there to do?"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513930931, "post_id": 47926390, "comment_id": 82845203, "body": "<i>For a start, <b>log your errors</i></b> so you can see what&#39;s going wrong. Without access to your environment, we don&#39;t know if <code>$HOME&#47;perl</code> exists, either."}, {"owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "edited": false, "score": 0, "creation_date": 1513932628, "post_id": 47926390, "comment_id": 82845910, "body": "Yes, it works now, had forgotten in the big script (not test one) <code>*STDOUT = $log_fh;</code>. Solution was in multiple details, following few lines were essential: <code>chdir(&quot;$ENV{HOME}&#47;perl&quot;); open(LOGFILEHANDLE, &quot;&gt;&gt;$logfilename&quot; ); open (STDOUT, &#39;&gt;&gt;&#39;, &quot;$logfilename&quot;); open (STDERR, &#39;&gt;&gt;&#39;, &quot;$logfilename&quot;);</code>. Big thanks for the effort and time spent ;)"}], "tags": [], "owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "is_accepted": true, "score": 4, "last_activity_date": 1513929527, "last_edit_date": 1513929527, "creation_date": 1513864273, "answer_id": 47926390, "question_id": 47925653, "link": "https://stackoverflow.com/questions/47925653/perl-script-does-not-output-stdout-to-file-when-run-from-cron/47926390#47926390", "title": "Perl script does not output STDOUT to file when run from cron", "body": "<p>Reassigning <code>*STDOUT</code> is only affecting the Perl-internal <code>STDOUT</code> scalar's binding.  The proper way to redirect standard output on the system level is something like</p>\n\n<pre><code>open (STDOUT, '&gt;&amp;', $log_fh) or die \"$0: could not: $!\";\n</code></pre>\n\n<p>You should similarly report errors from your other system calls which could fail (and <code>use strict</code> and etc).</p>\n\n<p><code>cron</code> runs your job in your home directory, so if the path <code>$HOME/log</code> does not exist, the script will fail to open the log file handle (silently, because you are not logging <code>open</code> errors!)</p>\n"}], "owner": {"reputation": 109, "user_id": 4255834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/31da357b5bc58c73b14b5580f6fd9d22?s=128&d=identicon&r=PG", "display_name": "uldics", "link": "https://stackoverflow.com/users/4255834/uldics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 47926390, "answer_count": 1, "score": 1, "last_activity_date": 1513929527, "creation_date": 1513861507, "last_edit_date": 1513863775, "question_id": 47925653, "link": "https://stackoverflow.com/questions/47925653/perl-script-does-not-output-stdout-to-file-when-run-from-cron", "title": "Perl script does not output STDOUT to file when run from cron", "body": "<p>Fairly new to Perl.\nI have a Perl script on a Linux machine, which has own logfile. Logfile name can change, dependent on data the script is working on (date, filename, datatype, etc.)</p>\n\n<p>The script at some pionts is calling a native executable with system() call, which gives some information out to STDOUT and STDERR - few tens to few hundreds lines over many minutes. After the executable is done, the script continues and logs some other info to the logfile.</p>\n\n<p>Until now the script only logged its own output, without the native executables output, which I want to log in same files as the Perl script logs to. Tried it with following two methods:</p>\n\n<pre><code>#!/usr/bin/perl\n#some other code\n@array_executable_and_parameters = qw/echo foo/ ;\nopen $log_fh, '&gt;&gt;', 'log/logfile1.txt';\n*STDOUT = $log_fh;\n*STDERR = $log_fh;\nprint \"log_fh=$log_fh\\n\";\nsystem( @array_executable_and_parameters);\n\n$logfilename='log/logfile2.txt';\nopen(LOGFILEHANDLE, \"&gt;&gt;$logfilename\" );\n*STDOUT = LOGFILEHANDLE;\n*STDERR = LOGFILEHANDLE;\nprint LOGFILEHANDLE \"Somethinglogged\\n\";\nsystem( @array_executable_and_parameters);\n</code></pre>\n\n<p>It works when I run the script manually, but not when run from cron.</p>\n\n<p>I know it is possible to redirect in the crontab by Linux means, but then I have to know the filename to log to, which only will be known when some data arrives, so seems to me not feasible. I also would like to have as much as possible inside the script, without many dependencies on the Linux etc. I have also no possibility to install any extra modules, libraries for Perl to use, suppose it is bare minimum install.</p>\n\n<p>How do I get STDOUT and STDERR redirected to a specific file from inside the Perl script?</p>\n\n<p>And if possible, how do I detect filename the STDOUT currently goes to?</p>\n"}, {"tags": ["perl", "unicode", "emoji"], "comments": [{"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "edited": false, "score": 1, "creation_date": 1513861277, "post_id": 47924985, "comment_id": 82818732, "body": "which version of perl are you using? <code>perl -v</code> and which platform?"}, {"owner": {"reputation": 175, "user_id": 5186623, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206691161224996/picture?type=large", "display_name": "Chedi Bechikh", "link": "https://stackoverflow.com/users/5186623/chedi-bechikh"}, "reply_to_user": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "edited": false, "score": 0, "creation_date": 1513861577, "post_id": 47924985, "comment_id": 82818914, "body": "@Flying_whale: I did all what you recommended , but nothing changed."}, {"owner": {"reputation": 175, "user_id": 5186623, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206691161224996/picture?type=large", "display_name": "Chedi Bechikh", "link": "https://stackoverflow.com/users/5186623/chedi-bechikh"}, "reply_to_user": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "edited": false, "score": 0, "creation_date": 1513861623, "post_id": 47924985, "comment_id": 82818942, "body": "@Nahuel Fouilleul : This is perl 5, version 22, subversion 1 (v5.22.1) built for MSWin32-x64-multi-thread"}, {"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "edited": false, "score": 0, "creation_date": 1513861670, "post_id": 47924985, "comment_id": 82818983, "body": "see my answer add <code>-C</code> option"}, {"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "edited": false, "score": 1, "creation_date": 1513862524, "post_id": 47924985, "comment_id": 82819549, "body": "note that <code>U+</code> is missing betwen <code>\\N{</code> .. <code>}</code>"}, {"owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "edited": false, "score": 0, "creation_date": 1513863149, "post_id": 47924985, "comment_id": 82819881, "body": "How did you open the <code>FIC</code> file handle? Did you use an I/O layer to decode the input from octets to Unicode? If so did you use the correct encoding? Please show the output of <code>use Data::Dumper; $Data::Dumper::Useqq = 1; print Dumper $ligne;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5186623, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206691161224996/picture?type=large", "display_name": "Chedi Bechikh", "link": "https://stackoverflow.com/users/5186623/chedi-bechikh"}, "edited": false, "score": 0, "creation_date": 1513860224, "post_id": 47925108, "comment_id": 82818060, "body": "sorry but this also don&#39;t work, it is the same thing, you only added m. also i tested with \\x and don&#39;t work."}, {"owner": {"reputation": 3269, "user_id": 93745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8F5Wc.jpg?s=128&g=1", "display_name": "tinita", "link": "https://stackoverflow.com/users/93745/tinita"}, "reply_to_user": {"reputation": 175, "user_id": 5186623, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206691161224996/picture?type=large", "display_name": "Chedi Bechikh", "link": "https://stackoverflow.com/users/5186623/chedi-bechikh"}, "edited": false, "score": 2, "creation_date": 1513863880, "post_id": 47925108, "comment_id": 82820316, "body": "I did not only add m. Take a closer look please. I added <code>U+</code>"}, {"owner": {"reputation": 175, "user_id": 5186623, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206691161224996/picture?type=large", "display_name": "Chedi Bechikh", "link": "https://stackoverflow.com/users/5186623/chedi-bechikh"}, "edited": false, "score": 1, "creation_date": 1513865556, "post_id": 47925108, "comment_id": 82821392, "body": "Thank you very much, the issue was with the openin of the file, so what solved my problem is that command my $ligne = decode_utf8 $_; , thank you"}], "tags": [], "owner": {"reputation": 3269, "user_id": 93745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8F5Wc.jpg?s=128&g=1", "display_name": "tinita", "link": "https://stackoverflow.com/users/93745/tinita"}, "is_accepted": true, "score": 9, "last_activity_date": 1513864267, "last_edit_date": 1513864267, "creation_date": 1513859636, "answer_id": 47925108, "question_id": 47924985, "link": "https://stackoverflow.com/questions/47924985/how-to-detect-emoji-as-unicode-in-perl/47925108#47925108", "title": "How to detect emoji as unicode in Perl?", "body": "<p>If you look at <a href=\"https://perldoc.perl.org/perlre.html\" rel=\"noreferrer\">perldoc perlre</a> for <code>\\N</code>, you see that it means \"named Unicode character or character sequence\".</p>\n\n<p>You can use this instead:</p>\n\n<pre><code>if ($ligne =~ m/\\N{U+1F60D}/)\n# or\nif ($ligne =~ m/\\x{1F60D}/)\n</code></pre>\n\n<p>Edit: It's also described in the link you posted,\n <a href=\"https://perldoc.perl.org/perluniintro.html\" rel=\"noreferrer\">https://perldoc.perl.org/perluniintro.html</a></p>\n\n<p>Edit:\nThe content you read is probably not decoded. You want:</p>\n\n<pre><code>use Encode;\n...\nmy $ligne = decode_utf8 $_;\n</code></pre>\n\n<p>or simply open the file directly in utf8 mode:</p>\n\n<pre><code>open my $fh, \"&lt;:encoding(UTF-8)\", $filename or die \"Could not open $filename: $!\";\nwhile (my $ligne = &lt;$fh&gt;) {\n    if ($ligne =~ m/\\N{U+1F60D}/) { ... }\n}\n</code></pre>\n\n<p>You never showed how you open the filehandle called <code>FIC</code>, so I assumed it was utf8 decoded.\nHere is another good tutorial about unicode in perl: <a href=\"https://perlgeek.de/en/article/encodings-and-unicode\" rel=\"noreferrer\">https://perlgeek.de/en/article/encodings-and-unicode</a></p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 5186623, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206691161224996/picture?type=large", "display_name": "Chedi Bechikh", "link": "https://stackoverflow.com/users/5186623/chedi-bechikh"}, "edited": false, "score": 0, "creation_date": 1513863123, "post_id": 47925693, "comment_id": 82819873, "body": "i try perl -C, but nothing happened, it take long time, i think this blocked the terminal, if i add in my program #!/usr/bin/perl -C, but I have the same result, the second command i don&#39;t understand how to use it"}, {"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "reply_to_user": {"reputation": 175, "user_id": 5186623, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206691161224996/picture?type=large", "display_name": "Chedi Bechikh", "link": "https://stackoverflow.com/users/5186623/chedi-bechikh"}, "edited": false, "score": 0, "creation_date": 1513863627, "post_id": 47925693, "comment_id": 82820176, "body": "the given examples are to test from command line, without -e or -E + command the perl program is waiting for input to read commands, if it doesn&#39;t work it may be because of <code>U+</code> missing"}], "tags": [], "owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "is_accepted": false, "score": 2, "last_activity_date": 1513863818, "last_edit_date": 1513863818, "creation_date": 1513861635, "answer_id": 47925693, "question_id": 47924985, "link": "https://stackoverflow.com/questions/47924985/how-to-detect-emoji-as-unicode-in-perl/47925693#47925693", "title": "How to detect emoji as unicode in Perl?", "body": "<p>use <code>perl -C</code> can be used to enable unicode features</p>\n\n<pre><code>perl -C -E 'say \"\\N{U+263a}\"'|perl -C -ne 'print if /\\N{U+263a}/'\n</code></pre>\n\n<p><a href=\"https://perldoc.perl.org/perlrun.html\" rel=\"nofollow noreferrer\">from perl run</a></p>\n\n<blockquote>\n  <p>-C [number/list]</p>\n  \n  <p>The -C flag controls some of the Perl Unicode features.\n  ...</p>\n</blockquote>\n\n<p>The reason why the second code works is that perl matches UTF-8 binary sequence:  as in <code>perl -ne 'print if /\\xf0\\x9f\\x98\\x8d/'</code>.</p>\n\n<p>Following should work</p>\n\n<pre><code>#!/usr/bin/perl -C\nopen(FIC1, \"&gt;$fic\");\n\nwhile (&lt;FIC&gt;) {\n    my $ligne=$_;\n\n    if( $ligne=~/\\N{U+1F60D}/  ) {\n        print \"heart \";\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52821, "user_id": 632407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AfGWW.jpg?s=128&g=1", "display_name": "jm666", "link": "https://stackoverflow.com/users/632407/jm666"}, "is_accepted": false, "score": 7, "last_activity_date": 1513869751, "creation_date": 1513869751, "answer_id": 47927967, "question_id": 47924985, "link": "https://stackoverflow.com/questions/47924985/how-to-detect-emoji-as-unicode-in-perl/47927967#47927967", "title": "How to detect emoji as unicode in Perl?", "body": "<p>For detecting emoji, I would use unicode properties in regexes, e.g.:</p>\n\n<ul>\n<li><code>\\p{Emoticons}</code> or</li>\n<li><code>\\p{Block: Emoticons}</code></li>\n</ul>\n\n<p>For example, print out only emoji</p>\n\n<pre><code>perl -CSDA -nlE 'say for( /(\\p{Emoticons})/g )' &lt;&lt;&lt; 'abc\ud83d\ude26\ud83d\ude27\ud83d\ude2e\u03b1\u03b2\u03b3'\n</code></pre>\n\n<p>will print</p>\n\n<pre><code>\ud83d\ude26\n\ud83d\ude27\n\ud83d\ude2e\n</code></pre>\n\n<p>For more info see <a href=\"https://perldoc.perl.org/perluniprops.html\" rel=\"noreferrer\">perluniprops</a></p>\n"}], "owner": {"reputation": 175, "user_id": 5186623, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10206691161224996/picture?type=large", "display_name": "Chedi Bechikh", "link": "https://stackoverflow.com/users/5186623/chedi-bechikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1458, "favorite_count": 0, "accepted_answer_id": 47925108, "answer_count": 3, "score": 3, "last_activity_date": 1513869751, "creation_date": 1513859172, "question_id": 47924985, "link": "https://stackoverflow.com/questions/47924985/how-to-detect-emoji-as-unicode-in-perl", "title": "How to detect emoji as unicode in Perl?", "body": "<p>i have text file that contain emoji unicode caracter for exemple \ud83d\ude24,  \u2639\ufe0f, \ud83d\ude14, \ud83d\ude05, \ud83d\ude03, \ud83d\ude09, \ud83d\ude1c, \ud83d\ude0d.</p>\n\n<p>For example the code \\N{1F60D} correspond to \ud83d\ude0d\nI use recommendation as in <a href=\"https://perldoc.perl.org/perluniintro.html\" rel=\"nofollow noreferrer\">https://perldoc.perl.org/perluniintro.html</a> section Creating Unicode.\nMy program must detect them and do some treatments, but if i use</p>\n\n<pre><code>open(FIC1, \"&gt;$fic\");\n\nwhile (&lt;FIC&gt;) {\nmy $ligne=$_;\n\nif( $ligne=~/\\N{1F60D}/  )\n{print \"heart \";\n    }\n}\n</code></pre>\n\n<p>Now I do this, it work</p>\n\n<pre><code>open(FIC1, \"&gt;$fic\");\n\nwhile (&lt;FIC&gt;) {\nmy $ligne=$_;\n\nif( $ligne=~/\ud83d\ude0d/  )\n{print \"Heart \";\n    }\n}\n</code></pre>\n\n<p>What is the problem with the first code\n Regards</p>\n"}, {"tags": ["xml", "linux", "perl", "curl", "soap"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8874892, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c7b100cb701ff72d15bae08d104d54c3?s=128&d=identicon&r=PG&f=1", "display_name": "Robbac", "link": "https://stackoverflow.com/users/8874892/robbac"}, "edited": false, "score": 0, "creation_date": 1513860084, "post_id": 47925089, "comment_id": 82817969, "body": "Not yet sure how to use it, I see that xsltproc is installed on our Linux machine though."}], "tags": [], "owner": {"reputation": 1720, "user_id": 8903393, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HwMCG.png?s=128&g=1", "display_name": "Amrendra Kumar", "link": "https://stackoverflow.com/users/8903393/amrendra-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1513859572, "creation_date": 1513859572, "answer_id": 47925089, "question_id": 47924918, "link": "https://stackoverflow.com/questions/47924918/how-to-manipulate-data-from-soap-xml-with-regex/47925089#47925089", "title": "How to manipulate data from SOAP XML with regex", "body": "<p>If you can use XSLT 2.0 then use this code.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n    xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\n    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    exclude-result-prefixes=\"xs\"\n    version=\"2.0\"&gt;\n\n    &lt;xsl:template match=\"/\"&gt;\n        &lt;xsl:for-each select=\"//*:AssetLifecycleStatus\"&gt;\n            &lt;xsl:text&gt;&amp;#x000A;&lt;/xsl:text&gt;&lt;xsl:value-of select=\".\"/&gt;\n        &lt;/xsl:for-each&gt;\n    &lt;/xsl:template&gt;\n\n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>OUTPUT IS:</p>\n\n<p>Deployed <br/>Being Assembled<br/>Deployed</p>\n"}, {"comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513865048, "post_id": 47926620, "comment_id": 82821052, "body": "Of course this does not handle the SOAP part. You&#39;d need something more sophisticated for that."}], "tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": false, "score": 2, "last_activity_date": 1513865020, "creation_date": 1513865020, "answer_id": 47926620, "question_id": 47924918, "link": "https://stackoverflow.com/questions/47924918/how-to-manipulate-data-from-soap-xml-with-regex/47926620#47926620", "title": "How to manipulate data from SOAP XML with regex", "body": "<p>If you've got the <a href=\"https://metacpan.org/pod/Mojolicious\" rel=\"nofollow noreferrer\">Mojolicious framework</a> installed, you can use the <a href=\"https://metacpan.org/pod/ojo\" rel=\"nofollow noreferrer\">ojo</a> package to write a simple Perl one-liner. It's called <code>ojo</code> because when you use it one the command line with <code>-M</code>, it will become <code>-Mojo</code>.</p>\n\n<p>This program assumes there's a file called <code>foo.xml</code> with your XML content in the same directory.</p>\n\n<pre><code>$ perl -Mojo -E 'x(f(\"foo.xml\")-&gt;slurp)-&gt;find(\"AssetLifecycleStatus\")-&gt;map(sub{say $_-&gt;text})'\nDeployed\nBeing Assembled\nDeployed\n</code></pre>\n\n<p>I'll walk you through the program.</p>\n\n<pre><code>perl                               # call the Perl interpreter\n  -Mojo                            # load module ojo\n  -E '                             # run the following program with all features turned on\n    x(                             # ojo function to turn string into Mojo::DOM object\n      f(\"foo.xml\")                 # ojo function to create a Mojo::File object\n        -&gt;slurp                    # read in the whole file and return content\n    )\n    -&gt;find(\"AssetLifecycleStatus\") # find all instances of string in DOM with CSS selector\n    -&gt;map(                         # iterate and run on all instances ...\n      sub {                        # ... this function ...\n        say $_-&gt;text               # ... output text node of element with newline attached\n      }\n    )\n  '\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1228, "user_id": 4709524, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wGrTV.jpg?s=128&g=1", "display_name": "beasy", "link": "https://stackoverflow.com/users/4709524/beasy"}, "is_accepted": false, "score": 3, "last_activity_date": 1513866902, "creation_date": 1513866902, "answer_id": 47927141, "question_id": 47924918, "link": "https://stackoverflow.com/questions/47924918/how-to-manipulate-data-from-soap-xml-with-regex/47927141#47927141", "title": "How to manipulate data from SOAP XML with regex", "body": "<p>There's not really a best language for parsing XML. Perl is known for its regex but parsing XML is much better done with a dedicated parser. In perl, <code>XML::LibXML</code> is a widely used one. There are other parsers for Perl, as well as Python, Ruby, JS, etc.</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\nuse XML::LibXML;\n\nmy $doc = XML::LibXML-&gt;load_xml(IO =&gt; *DATA);\n    # can also load with (string =&gt; $xml_string) or (location =&gt; 'file.xml');\nmy @nodes = $doc-&gt;getElementsByTagName('ns0:AssetLifecycleStatus');\n\nfor my $node (@nodes) {\n    print $node-&gt;textContent.\"\\n\";\n}\n\n\n__DATA__\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;&lt;soapenv:Body&gt;&lt;ns0:GetList_Operation_0Response xmlns:ns0=\"urn:TEST:AST:Attributes\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n&lt;ns0:getListValues&gt;\n        &lt;ns0:AssetLifecycleStatus&gt;Deployed&lt;/ns0:AssetLifecycleStatus&gt;\n        &lt;ns0:ReconciliationIdentity&gt;OI-ASDAQWDASDWA&lt;/ns0:ReconciliationIdentity&gt;\n        &lt;ns0:instanceId&gt;OI-SDWDSDWDSDWD&lt;/ns0:instanceId&gt;\n        &lt;ns0:ModifiedDate&gt;2017-12-12T03:31:32+01:00&lt;/ns0:ModifiedDate&gt;\n        &lt;ns0:ClassId&gt;BMC_COMPUTERSYSTEM&lt;/ns0:ClassId&gt;\n    &lt;/ns0:getListValues&gt;\n    &lt;ns0:getListValues&gt;\n        &lt;ns0:AssetLifecycleStatus&gt;Being Assembled&lt;/ns0:AssetLifecycleStatus&gt;\n        &lt;ns0:ReconciliationIdentity&gt;OI-ASDQWAWDSADW&lt;/ns0:ReconciliationIdentity&gt;\n        &lt;ns0:instanceId&gt;OI-SDWDSWDSWDWD&lt;/ns0:instanceId&gt;\n        &lt;ns0:ModifiedDate&gt;2017-12-10T03:30:21+01:00&lt;/ns0:ModifiedDate&gt;\n        &lt;ns0:ClassId&gt;BMC_COMPUTERSYSTEM&lt;/ns0:ClassId&gt;\n    &lt;/ns0:getListValues&gt;\n    &lt;ns0:getListValues&gt;\n        &lt;ns0:AssetLifecycleStatus&gt;Deployed&lt;/ns0:AssetLifecycleStatus&gt;\n        &lt;ns0:ReconciliationIdentity&gt;OI-ASDWASDWDASDW&lt;/ns0:ReconciliationIdentity&gt;\n        &lt;ns0:instanceId&gt;OI-SDWDSDWDSDWD&lt;/ns0:instanceId&gt;\n        &lt;ns0:ModifiedDate&gt;2017-12-12T03:31:31+01:00&lt;/ns0:ModifiedDate&gt;\n        &lt;ns0:ClassId&gt;BMC_COMPUTERSYSTEM&lt;/ns0:ClassId&gt;\n    &lt;/ns0:getListValues&gt;\n&lt;/ns0:GetList_Operation_0Response&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8874892, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c7b100cb701ff72d15bae08d104d54c3?s=128&d=identicon&r=PG&f=1", "display_name": "Robbac", "link": "https://stackoverflow.com/users/8874892/robbac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1513866902, "creation_date": 1513858909, "question_id": 47924918, "link": "https://stackoverflow.com/questions/47924918/how-to-manipulate-data-from-soap-xml-with-regex", "title": "How to manipulate data from SOAP XML with regex", "body": "<p>I'm planning to write a script which gets data through SOAP. I can get a file which contains a lot of following data, example:</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;&lt;soapenv:Body&gt;&lt;ns0:GetList_Operation_0Response xmlns:ns0=\"urn:TEST:AST:Attributes\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n&lt;ns0:getListValues&gt;\n        &lt;ns0:AssetLifecycleStatus&gt;Deployed&lt;/ns0:AssetLifecycleStatus&gt;\n        &lt;ns0:ReconciliationIdentity&gt;OI-ASDAQWDASDWA&lt;/ns0:ReconciliationIdentity&gt;\n        &lt;ns0:instanceId&gt;OI-SDWDSDWDSDWD&lt;/ns0:instanceId&gt;\n        &lt;ns0:ModifiedDate&gt;2017-12-12T03:31:32+01:00&lt;/ns0:ModifiedDate&gt;\n        &lt;ns0:ClassId&gt;BMC_COMPUTERSYSTEM&lt;/ns0:ClassId&gt;\n    &lt;/ns0:getListValues&gt;\n    &lt;ns0:getListValues&gt;\n        &lt;ns0:AssetLifecycleStatus&gt;Being Assembled&lt;/ns0:AssetLifecycleStatus&gt;\n        &lt;ns0:ReconciliationIdentity&gt;OI-ASDQWAWDSADW&lt;/ns0:ReconciliationIdentity&gt;\n        &lt;ns0:instanceId&gt;OI-SDWDSWDSWDWD&lt;/ns0:instanceId&gt;\n        &lt;ns0:ModifiedDate&gt;2017-12-10T03:30:21+01:00&lt;/ns0:ModifiedDate&gt;\n        &lt;ns0:ClassId&gt;BMC_COMPUTERSYSTEM&lt;/ns0:ClassId&gt;\n    &lt;/ns0:getListValues&gt;\n    &lt;ns0:getListValues&gt;\n        &lt;ns0:AssetLifecycleStatus&gt;Deployed&lt;/ns0:AssetLifecycleStatus&gt;\n        &lt;ns0:ReconciliationIdentity&gt;OI-ASDWASDWDASDW&lt;/ns0:ReconciliationIdentity&gt;\n        &lt;ns0:instanceId&gt;OI-SDWDSDWDSDWD&lt;/ns0:instanceId&gt;\n        &lt;ns0:ModifiedDate&gt;2017-12-12T03:31:31+01:00&lt;/ns0:ModifiedDate&gt;\n        &lt;ns0:ClassId&gt;BMC_COMPUTERSYSTEM&lt;/ns0:ClassId&gt;\n    &lt;/ns0:getListValues&gt;\n&lt;/ns0:GetList_Operation_0Response&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>Could you suggest how to only extract the status between \"AssetLifecycleStatus\", example: Deployed. And it should go through every part of this line and give output to a new line. Example:</p>\n\n<p>Deployed</p>\n\n<p>Being Assembled</p>\n\n<p>Deployed</p>\n\n<p>Which is the best language to manipulate such data, is it Perl?\nThanks for the information! </p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1513858513, "post_id": 47923981, "comment_id": 82817053, "body": "Please <a href=\"https://stackoverflow.com/posts/47923981/edit\">edit</a> your question and include example calls to your <code>pairGroupBy</code> function."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1513878226, "post_id": 47923981, "comment_id": 82828838, "body": "No, no better way really if you want that behavior.  The package has that code <code>eval</code>-ed if XS doesn&#39;t load and that global <code>$a</code>, <code>$b</code> are declared (with <code>use vars</code>, which &quot;<i>has been superseded by <code>our</code></i>&quot;)"}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 1, "creation_date": 1513924537, "post_id": 47923981, "comment_id": 82842995, "body": "You should just do <code>no strict &#39;refs&#39;;</code> (in the smallest possible scope).  List::Util doesn&#39;t need to do so because it is not using strict at all, but you don&#39;t want to follow it in doing <i>that</i>."}], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 2956276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9adef652f5bc71a8610a58ef4b81c7f0?s=128&d=identicon&r=PG", "display_name": "eNca", "link": "https://stackoverflow.com/users/2956276/enca"}, "edited": false, "score": 0, "creation_date": 1513870994, "post_id": 47926645, "comment_id": 82824984, "body": "You are right that while loop is better in this case than pairmap in void context. But my question is still not answered. In this case I&#39;m able to access <code>$k</code> and <code>$v</code> variables from the <code>$irCode-&gt;()</code> callback only when the caller and this subroutine are both in the same package."}, {"owner": {"reputation": 535, "user_id": 2956276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9adef652f5bc71a8610a58ef4b81c7f0?s=128&d=identicon&r=PG", "display_name": "eNca", "link": "https://stackoverflow.com/users/2956276/enca"}, "edited": false, "score": 0, "creation_date": 1513873321, "post_id": 47926645, "comment_id": 82826302, "body": "According to you updated answer: You mean that functions like <a href=\"http://perldoc.perl.org/functions/sort.html\" rel=\"nofollow noreferrer\">sort</a> or <a href=\"https://perldoc.perl.org/List/Util.html#reduce\" rel=\"nofollow noreferrer\">reduce</a> are wrong and I should not create these kind of functions?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 535, "user_id": 2956276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9adef652f5bc71a8610a58ef4b81c7f0?s=128&d=identicon&r=PG", "display_name": "eNca", "link": "https://stackoverflow.com/users/2956276/enca"}, "edited": false, "score": 0, "creation_date": 1513873530, "post_id": 47926645, "comment_id": 82826436, "body": "No. I mean that features like <code>sort</code> or <code>reduce</code> should only be created when absolutely necessary. And in this case, it really doesn&#39;t look at all necessary. Unless you have a very good reason, a subroutine should only ever access data that is passed to it."}, {"owner": {"reputation": 535, "user_id": 2956276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9adef652f5bc71a8610a58ef4b81c7f0?s=128&d=identicon&r=PG", "display_name": "eNca", "link": "https://stackoverflow.com/users/2956276/enca"}, "edited": false, "score": 0, "creation_date": 1513874181, "post_id": 47926645, "comment_id": 82826838, "body": "OK. Let imagine that I have some good reason. How I can do it? My question is not about the reason but about the way ho I can pass variables to the callback in the same way as the sort function does."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 3, "last_activity_date": 1513871314, "last_edit_date": 1513871314, "creation_date": 1513865103, "answer_id": 47926645, "question_id": 47923981, "link": "https://stackoverflow.com/questions/47923981/perl-define-variable-in-caller-context/47926645#47926645", "title": "Perl: Define variable in caller context", "body": "<p>I'm not sure why you're seeing that problem, but I suspect you're overthinking matters. Using <code>pairmap</code> in void context like that seems a bad idea.</p>\n\n<p>Can't you just convert your array into a hash and then iterate across that?</p>\n\n<pre><code>my %iaItemsHash = @iaItams;\n\nwhile (my ($k, $v) = each %iaItemsHash) {\n  my $lsKey = $irCode-&gt;();\n  if (!defined($lsKey)) {\n    die \"Trying to pairGroup by nonexisting key '$lsKey'\";\n  }\n  push @{$laResult{$lsKey}}, $k =&gt; $v;\n}\n</code></pre>\n\n<p><strong>Update:</strong> In light of your comment, I've re-read your original question and spotted that you are talking about accessing the variables with the <code>$irCode-&gt;()</code> call.</p>\n\n<p>The problem with my solution is that <code>$k</code> and <code>$v</code> are lexical variables and, therefore, aren't available outside of their lexical scope (this is generally seen as a feature!) The solution is to resort to good programming practice and to send the values into the subroutine as parameters.</p>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1518477765, "last_edit_date": 1518477765, "creation_date": 1513887290, "answer_id": 47932135, "question_id": 47923981, "link": "https://stackoverflow.com/questions/47923981/perl-define-variable-in-caller-context/47932135#47932135", "title": "Perl: Define variable in caller context", "body": "<blockquote>\n  <p><em>Is there some better way how to define <code>$a</code> and <code>$b</code> variables in the caller's context without using <code>no strict 'refs';?</code></em></p>\n</blockquote>\n\n<p>You're asking us how to perform symbolic dereferences while asking Perl to prevent you from symbolic deferences. There's no reason to do that. If you want to perform symbolic dereferences, don't ask Perl to prevent you from doing it.</p>\n\n<p>Even if Perl doesn't catch you doing it (i.e. if you manage to find a way to not trigger <code>use strict qw( refs );</code>), you'll still be using symbolic dereferences! You'd just be lying to yourself and to your readers. </p>\n\n<p>Instead, it's best to document what you are doing. Use <code>no strict qw( refs );</code> to signal that you are using doing something <code>use strict qw( refs );</code> is suppose to block.</p>\n\n<hr>\n\n<p>The following approach for building the same structure as your code is much less wasteful:</p>\n\n<pre><code>my %laGrouped;\nfor my $key (keys(%laHoH)) {\n   my $rec = $laHoH{$key};\n   next if !$rec-&gt;{active};\n   push @{ $laGrouped{ $rec-&gt;{color} } }, $key, $rec;\n}\n</code></pre>\n\n<p>But let's improve the structure as well. The following approach produces a structure that's easier to use:</p>\n\n<pre><code>my %laGrouped;\nfor my $key (keys(%laHoH)) {\n   my $rec = $laHoH{$key};\n   next if !$rec-&gt;{active};\n   $laGrouped{ $rec-&gt;{color} }{$key} = $rec;\n}\n</code></pre>\n\n<hr>\n\n<p>If you find yourself using <code>pairGroupBy</code>, you've probably went wrong somewhere. But here's a better implementation of it for educational purposes:</p>\n\n<pre><code>sub pairGroupBy(&amp;@) {\n   my $cb = shift;\n\n   my $caller = caller;\n   my $ap = do { no strict 'refs'; \\*{ $caller.'::a' } };  local *$ap;\n   my $bp = do { no strict 'refs'; \\*{ $caller.'::b' } };  local *$bp;\n\n   my %groups;\n   while (@_) {\n      *$ap = \\shift;\n      *$bp = \\shift;\n      my $group = $cb-&gt;();\n      push @{ $groups{$group} }, $a, $b;\n   }\n\n   return %groups;\n}\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 2956276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9adef652f5bc71a8610a58ef4b81c7f0?s=128&d=identicon&r=PG", "display_name": "eNca", "link": "https://stackoverflow.com/users/2956276/enca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1518477765, "creation_date": 1513855671, "last_edit_date": 1513872871, "question_id": 47923981, "link": "https://stackoverflow.com/questions/47923981/perl-define-variable-in-caller-context", "title": "Perl: Define variable in caller context", "body": "<p>I have created this simple subroutine.</p>\n\n<pre><code>use List::Util qw(pairmap);\n\nsub pairGroupBy(&amp;@) {\n  my($irCode, @iaItems) = @_;\n\n  my %laResult = ();\n  pairmap {\n    my $lsKey = $irCode-&gt;();\n    if (!defined($lsKey)) {\n      die \"Trying to pairGroup by nonexisting key '$lsKey'\";\n    }\n    push @{$laResult{$lsKey}}, $a =&gt; $b;\n  } @iaItems;\n\n  return %laResult;\n}\n</code></pre>\n\n<p>It works well until the subroutine is used from the same file where it is defined. When I move it to some package then variables <code>$a</code> and <code>$b</code> becomes undefined inside the <code>$irCode-&gt;()</code> callback.</p>\n\n<p>I have learned from the <a href=\"http://cpansearch.perl.org/src/JHI/perl-5.8.1/ext/List/Util/lib/List/Util.pm\" rel=\"nofollow noreferrer\">List::Util source code</a> that this code do the trick:</p>\n\n<pre><code>my $caller = caller;\nlocal(*{$caller.\"::a\"}) = \\my $a;\nlocal(*{$caller.\"::b\"}) = \\my $b;\n</code></pre>\n\n<p>So I'have modified my subroutine in this way:</p>\n\n<pre><code>use List::Util qw(pairmap);\n\nsub pairGroupBy(&amp;@) {\n  my($irCode, @iaItems) = @_;\n\n  my $caller = caller;\n\n  my %laResult = ();\n  pairmap {\n\n    no strict 'refs';\n    local(*{$caller.\"::a\"}) = \\$a; # &lt;---- the line 96\n    local(*{$caller.\"::b\"}) = \\$b;\n\n    my $lsKey = $irCode-&gt;();\n    if (!defined($lsKey)) {\n      die \"Trying to pairGroup by nonexisting key '$lsKey'\";\n    }\n    push @{$laResult{$lsKey}}, $a =&gt; $b;\n  } @iaItems;\n\n  return %laResult;\n}\n</code></pre>\n\n<p>But I need to use the <code>no strict 'refs';</code> line (the <a href=\"http://cpansearch.perl.org/src/JHI/perl-5.8.1/ext/List/Util/lib/List/Util.pm\" rel=\"nofollow noreferrer\">List::Util source code</a> does not use it). Otherwise the error message appears:</p>\n\n<pre><code>Can't use string (\"main::a\") as a symbol ref while \"strict refs\" in use at /home/.../bin/SatFunc.pm line 96.\n</code></pre>\n\n<p>My question is: Is there some better way how to define <code>$a</code> and <code>$b</code> variables in the caller's context without using <code>no strict 'refs';</code>?</p>\n\n<p>I want my function will be used in the same way as <a href=\"https://perldoc.perl.org/List/Util.html#pairmap\" rel=\"nofollow noreferrer\">pairmap</a>, <a href=\"https://perldoc.perl.org/List/Util.html#pairgrep\" rel=\"nofollow noreferrer\">pairgrep</a> etc.</p>\n\n<p><strong>EDIT</strong>:\n@simbabque asked for an example, how the function is used. So this is an example:</p>\n\n<pre><code>my %laHoH = (\n  aa =&gt; {\n    color =&gt; 'yellow',\n    item =&gt; 'sun',\n    active =&gt; 1\n  },\n  bb =&gt; {\n    color =&gt; 'blue',\n    item =&gt; 'sky',\n    active =&gt; 1\n  },\n  cc =&gt; {\n    color =&gt; 'green',\n    item =&gt; 'grass',\n    active =&gt; 0\n  },\n  dd =&gt; {\n    color =&gt; 'blue',\n    item =&gt; 'watter',\n    active =&gt; 1\n  }\n);\n\n\nmy %laGrouped = pairGroupBy {\n  $b-&gt;{color}\n} pairgrep {\n  $b-&gt;{active}\n} %laHoH;\n</code></pre>\n\n<p>The function then returns this structure:</p>\n\n<pre><code>{\n  'yellow' =&gt; [\n                'aa',\n                {\n                  'color' =&gt; 'yellow',\n                  'item' =&gt; 'sun',\n                  'active' =&gt; 1\n                }\n              ],\n  'blue' =&gt; [\n              'dd',\n              {\n                'active' =&gt; 1,\n                'item' =&gt; 'watter',\n                'color' =&gt; 'blue'\n              },\n              'bb',\n              {\n                'color' =&gt; 'blue',\n                'item' =&gt; 'sky',\n                'active' =&gt; 1\n              }\n            ]\n};\n</code></pre>\n"}, {"tags": ["bash", "perl", "substitution"], "comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1513855196, "post_id": 47923625, "comment_id": 82815162, "body": "Don&#39;t put your command in a variable <a href=\"http://mywiki.wooledge.org/BashFAQ/050\" rel=\"nofollow noreferrer\">mywiki.wooledge.org/BashFAQ/050</a> (and if you do anyway, <a href=\"https://stackoverflow.com/questions/10067266/when-to-wrap-quotes-around-a-shell-variable\">quote it properly</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 1411, "user_id": 1459111, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2bcbb9035379459702dcff8736051b54?s=128&d=identicon&r=PG", "display_name": "user7417", "link": "https://stackoverflow.com/users/1459111/user7417"}, "edited": false, "score": 0, "creation_date": 1513855760, "post_id": 47923746, "comment_id": 82815478, "body": "Great! And if I want to substitute a string by a string saved in a variable? Let&#39;s say the variable NewTitle contains the desired new string. perlcmd=(perl -i -pe &#39;s/OldTitle/$NewTitle/&#39; ./file.txt) does not work, so what other modification is necessary?"}, {"owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "reply_to_user": {"reputation": 1411, "user_id": 1459111, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2bcbb9035379459702dcff8736051b54?s=128&d=identicon&r=PG", "display_name": "user7417", "link": "https://stackoverflow.com/users/1459111/user7417"}, "edited": false, "score": 0, "creation_date": 1513855937, "post_id": 47923746, "comment_id": 82815587, "body": "because of single quote preventing parameter expansion , just close single quotes open double then close double open single &#39;s/OldTitle/&#39;&quot;$NewTitle&quot;&#39;/&#39;, but code generation, is tricky to maintain and may be not safe regarding code injection"}], "tags": [], "owner": {"reputation": 16761, "user_id": 1454708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSzgk.png?s=128&g=1", "display_name": "Nahuel Fouilleul", "link": "https://stackoverflow.com/users/1454708/nahuel-fouilleul"}, "is_accepted": true, "score": 0, "last_activity_date": 1513856782, "last_edit_date": 1513856782, "creation_date": 1513854879, "answer_id": 47923746, "question_id": 47923625, "link": "https://stackoverflow.com/questions/47923625/perl-command-works-on-command-line-but-not-within-a-bash-script/47923746#47923746", "title": "Perl command works on command line but not within a bash script", "body": "<p>because the single quotes in prelcmd variable are interpreted literally and not syntacticaly (because of shell command line processing not specific to bash but <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html\" rel=\"nofollow noreferrer\">posix shell</a> quoting is before parameter expansion), easiest is to use an array instead :</p>\n\n<pre><code>perlcmd=(perl -i -pe 's/2005-03-31T19:13:30/'\"$(date +\"%Y-%m-%dT%H:%M:%S\")\"'/' ./file.txt)\necho \"${perlcmd[*]}\"\n\"${perlcmd[@]}\"\n</code></pre>\n\n<p>another solution is to reinterpret perlcmd using <code>eval</code></p>\n\n<pre><code>perlcmd=\"perl -i -pe 's/2005-03-31T19:13:30/$(date +\"%Y-%m-%dT%H:%M:%S\")/' ./file.txt\"\necho \"$perlcmd\"\neval \"$perlcmd\"\n</code></pre>\n\n<p>Following comment: if <code>$NewTitle</code> may contain any character including <code>/</code>, perl code will break or code can be injected. To avoid this problem data can be passed by parameter or by environment, also if data can be used in a regex pattern and can contain meta character it can be quoted <code>\\Q</code> .. <code>\\E</code>:</p>\n\n<p>by parameter:</p>\n\n<pre><code>perl -i -pe 'BEGIN{$old=shift@ARGV;$new=shift@ARGV}s/\\Q$old\\E/$new/' \"$old_title\" \"$new_title\" ./file.txt\n</code></pre>\n\n<p>by environment:</p>\n\n<pre><code>old_title=$old_title new_title=$new_title perl -i -pe 's/\\Q$ENV{old_title}\\E/$ENV{new_title}/' ./file.txt\n</code></pre>\n"}], "owner": {"reputation": 1411, "user_id": 1459111, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2bcbb9035379459702dcff8736051b54?s=128&d=identicon&r=PG", "display_name": "user7417", "link": "https://stackoverflow.com/users/1459111/user7417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 47923746, "answer_count": 1, "score": 0, "last_activity_date": 1513856782, "creation_date": 1513854469, "question_id": 47923625, "link": "https://stackoverflow.com/questions/47923625/perl-command-works-on-command-line-but-not-within-a-bash-script", "title": "Perl command works on command line but not within a bash script", "body": "<p>Within a larger bash script I use a line with a perl command to substitute a time stamp in a text file with the current date and time. I use the following the lines:</p>\n\n<pre><code>perlcmd=\"perl -i -pe 's/2005-03-31T19:13:30/$(date +\"%Y-%m-%dT%H:%M:%S\")/' ./file.txt\"\necho $perlcmd\n$perlcmd\n</code></pre>\n\n<p>The echo command shows me that the perl command is okay, its output is:</p>\n\n<pre><code>perl -i -pe 's/2005-03-31T19:13:30/2017-12-21T11:33:44/' ./file.txt\n</code></pre>\n\n<p>The time stamp, however, is not substituted. When I paste the echoed line to the command line it is executed properly and the time stamp is substituted. How to I have to change the code in the bash script to make it work?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1513834548, "post_id": 47918529, "comment_id": 82804830, "body": "What is your expected output?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 1, "creation_date": 1513836242, "post_id": 47918529, "comment_id": 82805357, "body": "Your &quot;<i>expected output</i>&quot; completely disagrees with your description"}], "answers": [{"comments": [{"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1513841480, "post_id": 47918883, "comment_id": 82807459, "body": "That regex is inadequate to split csv fields"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 1, "creation_date": 1513841672, "post_id": 47918883, "comment_id": 82807542, "body": "@ysth  Um ... of course -- I am considering OP-style strings, not a CSV file in general.  Otherwise regex just doesn&#39;t make sense."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1513841949, "post_id": 47918883, "comment_id": 82807657, "body": "@ysth Right, thank you ... they did say &quot;CSV file&quot; ... sigh"}, {"owner": {"reputation": 1, "user_id": 8919651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d951b864d368b980417a6a9ef244ef19?s=128&d=identicon&r=PG", "display_name": "CodeSeeker", "link": "https://stackoverflow.com/users/8919651/codeseeker"}, "edited": false, "score": 0, "creation_date": 1513855365, "post_id": 47918883, "comment_id": 82815261, "body": "Hi zdim..thanks for answer.Can u please explain the regex s/^\\s+//; s/\\s+$//; ?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 1, "user_id": 8919651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d951b864d368b980417a6a9ef244ef19?s=128&d=identicon&r=PG", "display_name": "CodeSeeker", "link": "https://stackoverflow.com/users/8919651/codeseeker"}, "edited": false, "score": 0, "creation_date": 1513886905, "post_id": 47918883, "comment_id": 82833099, "body": "@CodeSeeker The first of these two statements finds all consecutive spaces (<code>\\s+</code>) at the beginning of the string (<code>&#47;^..&#47;</code>) and substitutes nothing for them <code>s&#47;...&#47;&#47;</code>) -- so it removes them.  The second one finds all consecutive spaces at the end of the string (<code>$</code> in regex) and removes them."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 2, "last_activity_date": 1513844827, "last_edit_date": 1513844827, "creation_date": 1513836385, "answer_id": 47918883, "question_id": 47918529, "link": "https://stackoverflow.com/questions/47918529/how-to-remove-leading-and-trailing-spaces-for-specific-field-in-the-string-in-cs/47918883#47918883", "title": "how to remove leading and trailing spaces for specific field in the string in csv file by using regular expression", "body": "<p><strong>Note</strong> &nbsp; This relates to strings more or less as shown, <strong>with strictly no commas inside fields</strong>. </p>\n\n<p>If the problem relates to a general CSV file, please do not even consider regex. Use a module to parse the file and pick fields that you want. Here is the most <a href=\"https://stackoverflow.com/a/47544851/4653379\">recent post</a> that comes to mind (where you <em>don't</em> want <code>allow_whitespace</code> for your purpose). There are many more, please search.</p>\n\n<hr>\n\n<p>Capture all fields, with spaces, as non-comma chars</p>\n\n<pre><code>my @m = $string =~ /([^,]+)/g;\n</code></pre>\n\n<p>then clean up what you want and join them back</p>\n\n<pre><code>$m[2] =~ s/^\\s+|\\s+$//g;\n$string = join '', @m;\n</code></pre>\n\n<p>Note: it is faster to remove spaces separately, <code>s/^\\s+//; s/\\s+$//;</code></p>\n\n<hr>\n\n<p>Or, for strings without multiple words in trimmed fields</p>\n\n<pre><code>perl -Mstrict -wE'\n    $_ = q( xxx ,   yyy ,hey,zz ,  aaa); say;\n    my $N = 2;\n    my $c; \n    s/(\\s*([^, ]+)\\s*)/++$c==$N ? $2 : $1/eg; say\n'\n</code></pre>\n\n<p>prints </p>\n\n<pre>\n xxx ,   yyy ,hey,zz  ,  aaa\n xxx ,yyy,hey,zz  ,  aaa\n</pre>\n\n<hr>\n\n<p>Or, if strings may have multiple words in fields</p>\n\n<pre><code>perl -Mstrict -wE'\n    $_ = q( xxx ,   yyy more ,hey,zz oo ,  aaa); say;\n    my $N = 2;\n    my $c; \n    s/(\\s*( (?:[^,]+)?[^, ] )\\s*)/++$c==2 ? $2 : $1/gex; say\n'\n</code></pre>\n\n<p>These work for all <code>$N</code> from <code>1..5</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8919651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d951b864d368b980417a6a9ef244ef19?s=128&d=identicon&r=PG", "display_name": "CodeSeeker", "link": "https://stackoverflow.com/users/8919651/codeseeker"}, "edited": false, "score": 0, "creation_date": 1514268607, "post_id": 47939057, "comment_id": 82918371, "body": "Thanks Sobrique...its really helpful. But one more challenge I have is  the input data ended with comas for example X,XXXXX,XXXXXX,  YYYYYY ,TTTTTTT,XXXXXXX,XXXXX  XXXX,,,,,,,, Y,YYYYY,YYYYYY,YYY, XXXXXXX    ,TTTTTT,XX XXXX,XX,,,,,,,,,,, I just want to remove the trailing and leading space..with splitting and joining back to a row not exactly giving the output what I am expecting for. I tried to add space at the end of the input string. Please suggest If you have better idea to resole this"}], "tags": [], "owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1513935156, "creation_date": 1513935156, "answer_id": 47939057, "question_id": 47918529, "link": "https://stackoverflow.com/questions/47918529/how-to-remove-leading-and-trailing-spaces-for-specific-field-in-the-string-in-cs/47939057#47939057", "title": "how to remove leading and trailing spaces for specific field in the string in csv file by using regular expression", "body": "<p>So I have two possible answers. One uses <code>split</code> and is fine AS LONG as your CSV file is 'basic' - no quoted commas/linefeeds etc. </p>\n\n<p>That covers most of them though, so  I would recommend them as a good starting point. </p>\n\n<pre><code>#!/usr/bin/env perl\nuse strict;\nuse warnings;\n\n\nwhile ( &lt;DATA&gt; ) {    \n   my @row = split /,/;\n   s/^\\s+// for @row;\n   s/\\s+$// for @row; \n   print join (\",\", @row),\"\\n\";\n}\n\n__DATA__\nX,XXXXX,XXXXXX,  YYYYYY ,TTTTTTT,XXXXXXX,XXXXX  XXXX\nY,YYYYY,YYYYYY,YYY, XXXXXXX    ,TTTTTT,XX XXXX,XX\n</code></pre>\n\n<p>If it's anything slightly more complicated though, it's time to break out <code>Text::CSV</code>:</p>\n\n<pre><code>#!/usr/bin/env perl\nuse strict;\nuse warnings;\n\nuse Text::CSV; \n\nmy $csv = Text::CSV -&gt; new (); \n\nwhile ( my $row = $csv -&gt; getline ( \\*DATA ) )  {    \n   s/^\\s+// for @$row;\n   s/\\s+$// for @$row; \n   print join (\",\", @$row),\"\\n\";\n}\n\n\n__DATA__\nX,XXXXX,XXXXXX,  YYYYYY ,TTTTTTT,XXXXXXX,XXXXX  XXXX\nY,YYYYY,YYYYYY,YYY, XXXXXXX    ,TTTTTT,XX XXXX,XX\n</code></pre>\n\n<p>With <code>Text::CSV</code> you'll either have to feed it <code>STDIN</code> or open the file to your CSV file. With <code>split</code> you can use <code>&lt;&gt;</code>. </p>\n\n<p>Neither is really a 'regex' solution though, as that's IMO entirely the wrong tool for the job. </p>\n"}], "owner": {"reputation": 1, "user_id": 8919651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d951b864d368b980417a6a9ef244ef19?s=128&d=identicon&r=PG", "display_name": "CodeSeeker", "link": "https://stackoverflow.com/users/8919651/codeseeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1513935156, "creation_date": 1513834413, "last_edit_date": 1513874938, "question_id": 47918529, "link": "https://stackoverflow.com/questions/47918529/how-to-remove-leading-and-trailing-spaces-for-specific-field-in-the-string-in-cs", "title": "how to remove leading and trailing spaces for specific field in the string in csv file by using regular expression", "body": "<p>Here we go input:</p>\n\n<pre><code>X,XXXXX,XXXXXX,  YYYYYY ,TTTTTTT,XXXXXXX,XXXXX  XXXX\nY,YYYYY,YYYYYY,YYY, XXXXXXX    ,TTTTTT,XX XXXX,XX\n</code></pre>\n\n<p>I tried regex: <code>s/\\s//g</code>  But this substitute will replaces ALL whitespace ANYWHERE within the string.</p>\n\n<p>Please suggest the regex which will only trim and trail the specific field in the whole string??</p>\n\n<p>expected output is:</p>\n\n<pre><code>X,XXXXX,XXXXXX,YYYYYY,TTTTTTT,XXXXXXX,XXXXX  XXXX\nY,YYYYY,YYYYYY,YYY,XXXXXXX,TTTTTT,XX XXXX,XX\n</code></pre>\n\n<p>Removing the spaces before and after for that specific field. And it will not disturb the other fields which already having the spaces in it.</p>\n"}, {"tags": ["json", "perl"], "comments": [{"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 2, "creation_date": 1513816732, "post_id": 47916191, "comment_id": 82800684, "body": "hashes are not ordered, so they don&#39;t have &quot;first key&quot;s and you can&#39;t do <code>-&gt;[0]</code> on them.  you will have to figure out which key you want, perhaps by finding the minimum string?"}], "answers": [{"tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 5, "last_activity_date": 1579153208, "last_edit_date": 1579153208, "creation_date": 1513817635, "answer_id": 47916408, "question_id": 47916191, "link": "https://stackoverflow.com/questions/47916191/decode-json-and-return-first-key-in-hash/47916408#47916408", "title": "decode_json and return first key in hash", "body": "<p>You are picking among hashref keys, not array (sequential container) elements. Since hashes are inherently unordered you can't index into that list but need to sort keys as needed.</p>\n\n<p>With the exact format you show this works</p>\n\n<pre><code>my $top = (sort { $b cmp $a } keys %{ $decoded-&gt;{'Time Series (Daily)'} } )[0];\nsay $decoded-&gt;{'Time Series (Daily)'}{$top}{'1. open'};\n</code></pre>\n\n<p>It gets the list of keys, inverse-sorts them (alphabetically), and takes the first element of that list.</p>\n\n<p>If your date-time format may vary then you'll need to parse it for sorting.</p>\n\n<p>If you will really ever only want the most-recent one this is inefficient since it sorts the whole list.  Then use a more specific tool to extract only the \"largest\" element, like</p>\n\n<pre><code>use List::Util qw(reduce);\n\nmy $top = reduce { $a gt $b ? $a : $b } \n          keys %{ $decoded-&gt;{'Time Series (Daily)'} };\n</code></pre>\n\n<p>But then in your case this can be done simply by <code>maxstr</code> from the same <a href=\"https://perldoc.perl.org/List/Util.html\" rel=\"nofollow noreferrer\">List::Util</a> module, as shown in ikegami's answer. On the other hand, if the datetime format doesn't lend itself to a direct lexicographical comparison used by <code>strmax</code> then the <code>reduce</code> allows use of custom comparisons.</p>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 4, "last_activity_date": 1513817766, "creation_date": 1513817766, "answer_id": 47916425, "question_id": 47916191, "link": "https://stackoverflow.com/questions/47916191/decode-json-and-return-first-key-in-hash/47916425#47916425", "title": "decode_json and return first key in hash", "body": "<p>Problem 1: <code>{</code> denotes the start of a JSON object, which gets decoded into a hash. Trying to derefence an array is going to fail.</p>\n\n<p>Problem 2: Like Perl hashes, JSON objects are unordered, so talking about the \n\"first key\" makes no sense. Perhaps you want the most recent date?</p>\n\n<pre><code>use List::Util qw( maxstr );\n\nmy $time_series_daily = $decoded-&gt;{'Time Series (Daily)'};\nmy $latest_date = maxstr @$time_series_daily;\nmy $open = $time_series_daily-&gt;{$latest_date}{'1. open'};\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5261613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc4568e73eabf7f9b4d16156de4b4ac?s=128&d=identicon&r=PG&f=1", "display_name": "mroth7684", "link": "https://stackoverflow.com/users/5261613/mroth7684"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1579153208, "creation_date": 1513815823, "question_id": 47916191, "link": "https://stackoverflow.com/questions/47916191/decode-json-and-return-first-key-in-hash", "title": "decode_json and return first key in hash", "body": "<p>JSON string input: <a href=\"https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&amp;symbol=MSFT&amp;apikey=demo\" rel=\"nofollow noreferrer\">https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&amp;symbol=MSFT&amp;apikey=demo</a></p>\n\n<p>I am trying to return just the first key (current day) in the hash but have been unable to do so. My code looks like the following</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\nuse LWP::Simple;\nuse Data::Dumper;\nuse JSON;\n\nmy $html = get(\"https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&amp;symbol=AMD&amp;apikey=CMDPTEHVYH7W5VSZ\");\n\nmy $decoded = decode_json($html);\nmy ($open) = $decoded-&gt;{'Time Series (Daily)'}-&gt;[0]-&gt;{'1. open'};\n</code></pre>\n\n<p>I keep getting \"Not an ARRAY reference\" which I researched and got more confused.</p>\n\n<p>I can access what I want directly with the below code but I want to access just the first result or the current day:</p>\n\n<pre><code>my ($open) = $decoded-&gt;{'Time Series (Daily)'}{'2017-12-20'}{'1. open'};\n</code></pre>\n\n<p>Also if I do something like this:</p>\n\n<pre><code>my ($open) = $decoded-&gt;{'Time Series (Daily)'};\nprint Dumper($open);\n</code></pre>\n\n<p>The output is as follows:</p>\n\n<pre><code>$VAR1 = {\n      '2017-09-07' =&gt; {\n                        '1. open' =&gt; '12.8400',\n                        '5. volume' =&gt; '35467788',\n                        '2. high' =&gt; '12.9400',\n                        '4. close' =&gt; '12.6300',\n                        '3. low' =&gt; '12.6000'\n                      },\n      '2017-11-15' =&gt; {\n                        '3. low' =&gt; '10.7700',\n                        '4. close' =&gt; '11.0700',\n                        '2. high' =&gt; '11.1300',\n                        '5. volume' =&gt; '33326871',\n                        '1. open' =&gt; '11.0100'\n                      },\n      '2017-11-30' =&gt; {\n                        '1. open' =&gt; '10.8700',\n                        '2. high' =&gt; '11.0300',\n                        '5. volume' =&gt; '43101899',\n                        '3. low' =&gt; '10.7600',\n                        '4. close' =&gt; '10.8900'\n                      },\n</code></pre>\n\n<p>Thank you in advance for any help you can provide a noob. </p>\n"}]